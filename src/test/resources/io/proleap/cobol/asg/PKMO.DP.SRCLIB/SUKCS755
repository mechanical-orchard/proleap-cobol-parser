000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS755.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  MARCH, 2003.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S755 - STORE UNIT ADJUSTMENTS - PO ACTIVITY LIST           * 00100000
001100*---------------------------------------------------------------* 00110000
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00112007
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00113007
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00114007
001130*                                                                 00114108
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00114208
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00114308
263968*---------------------------------------------------------------* 00115007
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-DEFAULT-ALPHA-BEGIN    PIC  X(01)      VALUE 'A'.     00170000
001800     05  DK-DEFAULT-ALPHA-END      PIC  X(01)      VALUE 'Z'.     00180000
001900     05  DK-DEFAULT-BEGIN          PIC S9(09) COMP VALUE ZERO.    00190000
002000     05  DK-DEFAULT-END-LINE      PIC S9(09) COMP VALUE 999999999.00200000
002100     05  DK-DEFAULT-END-STR        PIC S9(04) COMP VALUE 9999.    00210000
002200     05  DK-DEFAULT-END-UPC PIC S9(15) COMP VALUE 999999999999999.00220000
002300     05  DK-UNT-ADJ-TYP-BEGIN      PIC  X(01)      VALUE SPACE.   00230000
002400     05  DK-UNT-ADJ-TYP-END        PIC  X(01)      VALUE SPACE.   00240000
002500     05  DK-FAIL-SUCC-BEGIN        PIC  X(01)      VALUE SPACE.   00250000
002600     05  DK-FAIL-SUCC-END          PIC  X(01)      VALUE SPACE.   00260000
002700     05  DK-GROUP-BEGIN            PIC  X(01)      VALUE SPACE.   00270000
002800     05  DK-GROUP-END              PIC  X(01)      VALUE SPACE.   00280000
002900     05  DK-RSLV-BY-BEGIN          PIC  X(08)      VALUE SPACE.   00290000
003000     05  DK-RSLV-BY-END            PIC  X(08)      VALUE SPACE.   00300000
003100     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE ZERO.    00310000
003200     05  DK-PO-NBR                 PIC S9(09) COMP VALUE ZERO.    00320000
003300     05  DK-RCVR-SEQ-NBR           PIC S9(09) COMP VALUE ZERO.    00330000
003400     05  DK-SHIPT-UNT-ID           PIC S9(18) COMP-3 VALUE ZERO.  00340000
003500     05  DK-LINE-NBR               PIC S9(09) COMP VALUE ZERO.    00350000
003600     05  DK-STR-NBR                PIC S9(04) COMP VALUE ZERO.    00360000
003700     05  DK-STR-BEGIN              PIC S9(04) COMP VALUE ZERO.    00370000
003800     05  DK-STR-END                PIC S9(04) COMP VALUE ZERO.    00380000
003900     05  DK-AUDIT-NBR              PIC S9(09) COMP VALUE ZERO.    00390000
004000     05  DK-UPC-NBR                PIC S9(15)V COMP-3 VALUE ZERO. 00400000
004100     05  DK-SKU-NBR                PIC S9(08) COMP-3.             00410000
004200                                                                  00420000
004300     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00430000
004400                                                    COMP.         00440000
004500     05  DK-PO-TRN-NBR                  PIC 9(09) VALUE ZEROES.   00450000
004600     05  DK-PO-RCVR-NBR-N               PIC 9(09) VALUE ZEROES.   00460000
004700     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00470000
004800         10  DK-RCVR-NBR-X                PIC X(09).              00480000
004900     05  DK-RCVR-NBR-9.                                           00490000
005000         10  FILLER                       PIC 9(06) VALUE ZEROES. 00500000
005100         10  DK-RCVR-NBR-3                PIC 9(03) VALUE ZEROES. 00510000
005200                                                                  00520000
005300     05  DK-PO-RCVR.                                              00530000
005400         10  DK-TRN-NBR                   PIC Z(09) VALUE ZEROES. 00540000
005500         10  FILLER                       PIC X(01) VALUE '-'.    00550000
005600         10  DK-RCVR-NBR                  PIC X(03) VALUE SPACES. 00560000
005700                                                                  00570000
005800     05  DK-DISPLAY-DATE.                                         00580000
005900         10  DK-DIS-MM                    PIC X(02) VALUE SPACES. 00590000
006000         10  FILLER                       PIC X(01) VALUE '/'.    00600000
006100         10  DK-DIS-DD                    PIC X(02) VALUE SPACES. 00610000
006200         10  FILLER                       PIC X(01) VALUE '/'.    00620000
006300         10  DK-DIS-YY                    PIC X(04) VALUE SPACES. 00630000
006400                                                                  00640000
006500 01  PC-PROGRAM-CONSTANTS.                                        00650000
006600     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU755A  '.  00660000
006700     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM755'.   00670000
006800     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS755'.  00680000
006900     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00690000
007000     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00700000
007100     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00710000
007200     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00720000
007300     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +11          00730000
007400                                               COMP SYNC.         00740000
007500     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00750000
007600                                               COMP SYNC.         00760000
007700     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00770000
007800                                               COMP-3.            00780000
007900     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00790000
008000                                               COMP SYNC.         00800000
008100     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00810000
008200                                               COMP-3.            00820000
008300     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00830000
008400     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00840000
008500     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00850000
008600     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00860000
008700     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00870000
008800     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00880000
008900                                               COMP.              00890000
009000     05  PC-01                     PIC  X(02)  VALUE '01'.        00900000
009100     05  PC-A                      PIC  X(01)  VALUE 'A'.         00910000
009200*                                                                 00920000
009300*----------------------------------------------------------------*00930000
009400*  SYSTEM MESSAGES                                               *00940000
009500*----------------------------------------------------------------*00950000
009600*   00005 = INVALID VALUE                                        *00960000
009700*   00008 = MUST BE NUMERIC                                      *00970000
009800*   00009 = INVALID DATE                                         *00980000
009900*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00990000
010000*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01000000
010100*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01010000
010200*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01020000
010300*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01030000
010400*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01040000
010500*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01050000
010600*   00069 - TOP OF LIST                                          *01060000
010700*   00070 - BOTTOM OF LIST                                       *01070000
010800*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01080000
010900*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01090000
011000*   00279 - MORE ITEMS TO DISPLAY                                *01100000
011100*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *01110000
011200*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01120000
011300*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01130000
011400*   99901 = INVALID COMMAND WAS ENTERED                          *01140000
011500*----------------------------------------------------------------*01150000
011600     05  PC-TSYMSG-NUMBERS.                                       01160000
011700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01170000
011800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01180000
011900         10  PC-TSYMSG-00009            PIC  9(05)  VALUE 00009.  01190000
012000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01200000
012100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01210000
012200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01220000
012300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01230000
012400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01240000
012500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01250000
012600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01260000
012700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01270000
012800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01280000
012900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01290000
013000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01300000
013100         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01310000
013200         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01320000
013300         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01330000
013400         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01340000
013500         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01350000
013600         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01360000
013700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01370000
013800*                                                                 01380000
013900 01  PS-PROGRAM-SWITCHES.                                         01390000
014000     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01400000
014100         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01410000
014200         88  PS-BLOCK-ERROR                         VALUE 'N'.    01420000
014300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01430000
014400         88  PS-NO-ERROR                            VALUE 'Y'.    01440000
014500         88  PS-ERROR                               VALUE 'N'.    01450000
014600     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01460000
014700         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01470000
014800         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01480000
014900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01490000
015000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01500000
015100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01510000
015200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01520000
015300         88  PS-DONE                                VALUE 'Y'.    01530000
015400         88  PS-NOT-DONE                            VALUE 'N'.    01540000
015500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01550000
015600         88  PS-LIST-END                            VALUE  'Y'.   01560000
015700         88  PS-NO-LIST-END                         VALUE  'N'.   01570000
015800     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01580000
015900         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01590000
016000         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01600000
016100     05  PS-FAIL-UNACKNOW-SW            PIC  X(01)  VALUE  'N'.   01610000
016200         88  PS-FAIL-UNACKNOW                       VALUE  'Y'.   01620000
016300         88  PS-NO-FAIL-UNACKNOW                    VALUE  'N'.   01630000
016400     05  PS-FAIL-ACKNOW-SW              PIC  X(01)  VALUE  'N'.   01640000
016500         88  PS-FAIL-ACKNOW                         VALUE  'Y'.   01650000
016600         88  PS-NO-FAIL-ACKNOW                      VALUE  'N'.   01660000
016700*                                                                 01670000
016800 01  PV-PROGRAM-VARIABLES.                                        01680000
016900     05  PV-ONE                         PIC S9(09) COMP.          01690000
017000     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      01700000
017100                                                    COMP SYNC.    01710000
017200     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       01720000
017300     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       01730000
017400     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01740000
017500     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01750000
017600                                          COMP SYNC.              01760000
017700     05  PV-SUB                         PIC S9(04)  VALUE +0      01770000
017800                                                    COMP SYNC.    01780000
017900     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01790000
018000                                                    COMP SYNC.    01800000
018100     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01810000
018200                                                    COMP-3.       01820000
018300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01830000
018400                                                    COMP-3.       01840000
018500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01850000
018600                                                    COMP-3.       01860000
018700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01870000
018800                                                    COMP-3.       01880000
018900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01890000
019000                                                    COMP-3.       01900000
019100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01910000
019200                                                    COMP-3.       01920000
019300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01930000
019400                                                    COMP-3.       01940000
019500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01950000
019600                                                    COMP SYNC.    01960000
019700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01970000
019800                                                    COMP SYNC.    01980000
019900     05  PV-ITEM                        PIC S9(04)  VALUE +0      01990000
020000                                                    COMP SYNC.    02000000
020100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02010000
020200                                                    COMP SYNC.    02020000
020300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02030000
020400                                                    COMP SYNC.    02040000
020500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02050000
020600                                                    COMP SYNC.    02060000
020700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02070000
020800                                                    COMP SYNC.    02080000
020900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02090000
021000                                                    COMP SYNC.    02100000
021100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02110000
021200                                                    COMP SYNC.    02120000
021300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02130000
021400                                                    COMP SYNC.    02140000
021500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02150000
021600                                                    COMP SYNC.    02160000
021700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02170000
021800                                                    COMP SYNC.    02180000
021900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02190000
022000                                                    COMP SYNC.    02200000
022100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02210000
022200                                                    COMP SYNC.    02220000
022300     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02230000
022400                                                    COMP SYNC.    02240000
022500     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02250000
022600                                                    COMP SYNC.    02260000
022700     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02270000
022800                                                    COMP.         02280000
022900     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02290000
023000                                                    COMP.         02300000
023100     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02310000
023200                                                    COMP.         02320000
023300     05  PV-SOFT-ABORT-MSG.                                       02330000
023400         10  FILLER            PIC X(12) VALUE ' SUKCS755 - '.    02340000
023500         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02350000
023600         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02360000
023700         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02370000
023800         10  PV-SOFT-PARAGRAPH PIC X(30).                         02380000
023900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02390000
024000                                                     COMP SYNC.   02400000
024100     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02410000
024200     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02420000
024300     05  PV-CICS-MSG-HOLD.                                        02430000
024400         10  FILLER                      PIC  X(01)  VALUE SPACE. 02440000
024500         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02450000
024600     05  PV-CICS-MSG-HOLD2.                                       02460000
024700         10  FILLER                      PIC  X(01)  VALUE SPACE. 02470000
024800         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02480000
024900                                                                  02490000
025000     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02500000
025100     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02510000
025200     05  PV-SEL-TERM-ID                  PIC  X(04).              02520000
025300     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02530000
025400     05  PV-SEL-SEQ                      PIC  9(01).              02540000
025500     05  PV-NET-ADJ                      PIC S9(04) COMP.         02550000
025600     05  PV-FROM-TMST                    PIC  X(26) VALUE SPACES. 02560000
025700     05  PV-FROM-TMST-X.                                          02570000
025800         10  PV-FROM-YY                  PIC  X(04).              02580000
025900         10  FILLER                      PIC  X(01) VALUE '-'.    02590000
026000         10  PV-FROM-MM                  PIC  X(02).              02600000
026100         10  FILLER                      PIC  X(01) VALUE '-'.    02610000
026200         10  PV-FROM-DD                  PIC  X(02).              02620000
026300         10  FILLER                      PIC  X(01) VALUE '-'.    02630000
026400         10  PV-FROM-HR                  PIC  X(02) VALUE ZERO.   02640000
026500         10  FILLER                      PIC  X(01) VALUE '.'.    02650000
026600         10  PV-FROM-MN                  PIC  X(02) VALUE ZERO.   02660000
026700         10  FILLER                      PIC  X(01) VALUE '.'.    02670000
026800         10  PV-FROM-SS                  PIC  X(02) VALUE ZERO.   02680000
026900         10  FILLER                      PIC  X(01) VALUE '.'.    02690000
027000         10  PV-FROM-REST                PIC  X(06) VALUE ZERO.   02700000
027100     05  PV-TO-TMST                      PIC  X(26) VALUE SPACES. 02710000
027200     05  PV-TO-TMST-X.                                            02720000
027300         10  PV-TO-YY                    PIC  X(04).              02730000
027400         10  FILLER                      PIC  X(01) VALUE '-'.    02740000
027500         10  PV-TO-MM                    PIC  X(02).              02750000
027600         10  FILLER                      PIC  X(01) VALUE '-'.    02760000
027700         10  PV-TO-DD                    PIC  X(02).              02770000
027800         10  FILLER                      PIC  X(01) VALUE '-'.    02780000
027900         10  PV-TO-HR                    PIC  X(02) VALUE '23'.   02790000
028000         10  FILLER                      PIC  X(01) VALUE '.'.    02800000
028100         10  PV-TO-MN                    PIC  X(02) VALUE '59'.   02810000
028200         10  FILLER                      PIC  X(01) VALUE '.'.    02820000
028300         10  PV-TO-SS                    PIC  X(02) VALUE '59'.   02830000
028400         10  FILLER                      PIC  X(01) VALUE '.'.    02840000
028500         10  PV-TO-REST                 PIC  X(06) VALUE '999999'.02850000
028600     05  PV-OPER-UNT-ID            PIC S9(04) COMP VALUE ZERO.    02860000
028700     05  PV-PO                     PIC S9(09) COMP VALUE ZERO.    02870000
028800     05  PV-RCVR                   PIC S9(09) COMP VALUE ZERO.    02880000
028900     05  PV-LINE                   PIC S9(09) COMP VALUE ZERO.    02890000
029000     05  PV-UPC                    PIC S9(15)V COMP-3 VALUE ZERO. 02900000
029100                                                                  02910000
029200******************************************************************02920000
029300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02930000
029400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02940000
029500**  APPLICATION-SPECIFIC COMMAREA.                              **02950000
029600******************************************************************02960000
029700 01  LQW-LIST-QUEUE-WORK-AREA.                                    02970000
029800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02980000
029900     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           02990000
030000                                        INDEXED BY LQW-IDX.       03000000
030100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03010000
030200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03020000
030300         10  LQW-SELECTED-SW            PIC  X(01).               03030000
030400             88  LQW-SELECT                         VALUE 'S'.    03040000
030500             88  LQW-DESELECT                       VALUE ' '.    03050000
030600         10  LQW-ACTION                 PIC  X(03).               03060000
030700             88  LQW-DEL                            VALUE 'DEL'.  03070000
030800             88  LQW-INQ                            VALUE 'INQ'.  03080000
030900             88  LQW-UPD                            VALUE 'UPD'.  03090000
031000             88  LQW-ERR                            VALUE 'ERR'.  03100000
031100         10  LQW-OPER-UNT-ID            PIC  9(04).               03110000
031200         10  LQW-PO-RCVR                PIC  X(13).               03120000
031300         10  LQW-LINE-NBR               PIC  9(04).               03130000
031400         10  LQW-UPC-NBR                PIC  9(15).               03140000
031500         10  LQW-SKU-NBR                PIC  9(08).               03150000
031600         10  LQW-NET-ADJ                PIC  9(07).               03160000
031700         10  LQW-ADJ-SOURCE             PIC  X(08).               03170000
031800         10  LQW-FAIL-SUCCSS            PIC  X(01).               03180000
031900         10  LQW-ACKNOWLEDGE            PIC  X(01).               03190000
032000                                                                  03200000
032100*---------------------------------------------------------------* 03210000
032200* SELECTON QUEUE LAYOUT                                         * 03220000
032300*---------------------------------------------------------------* 03230000
032400     COPY SUWS039.                                                03240000
032500                                                                  03250000
032600*---------------------------------------------------------------* 03260000
032700*    MAP LAYOUT                                                 * 03270000
032800*---------------------------------------------------------------* 03280000
032900     COPY SUKM755.                                                03290000
033000*                                                                 03300000
033100 01  MR-OCCURS-LAYOUT                   REDEFINES  SU755AO.       03310000
033200     05  FILLER                         PIC X(191).               03320000
033300     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          03330000
033400         10  MR-SELECTL                 PIC S9(04) COMP.          03340000
033500         10  MR-SELECTA                 PIC  X(01).               03350000
033600         10  MR-SELECTC                 PIC  X(01).               03360000
033700         10  MR-SELECTH                 PIC  X(01).               03370000
033800         10  MR-SELECTI                 PIC  X(01).               03380000
033900                                                                  03390000
034000         10  MR-ACTIONL                 PIC S9(04) COMP.          03400000
034100         10  MR-ACTIONA                 PIC  X(01).               03410000
034200         10  MR-ACTIONC                 PIC  X(01).               03420000
034300         10  MR-ACTIONH                 PIC  X(01).               03430000
034400         10  MR-ACTION                  PIC  X(03).               03440000
034500                                                                  03450000
034600         10  MR-OPER-UNT-IDL            PIC S9(04) COMP.          03460000
034700         10  MR-OPER-UNT-IDA            PIC  X(01).               03470000
034800         10  MR-OPER-UNT-IDC            PIC  X(01).               03480000
034900         10  MR-OPER-UNT-IDH            PIC  X(01).               03490000
035000         10  MR-OPER-UNT-ID             PIC  Z(04).               03500000
035100                                                                  03510000
035200         10  MR-PO-RCVRL                PIC S9(04) COMP.          03520000
035300         10  MR-PO-RCVRA                PIC  X(01).               03530000
035400         10  MR-PO-RCVRC                PIC  X(01).               03540000
035500         10  MR-PO-RCVRH                PIC  X(01).               03550000
035600         10  MR-PO-RCVR                 PIC  X(13).               03560000
035700                                                                  03570000
035800         10  MR-LINEL                   PIC S9(04) COMP.          03580000
035900         10  MR-LINEA                   PIC  X(01).               03590000
036000         10  MR-LINEC                   PIC  X(01).               03600000
036100         10  MR-LINEH                   PIC  X(01).               03610000
036200         10  MR-LINE                    PIC  Z(04).               03620000
036300                                                                  03630000
036400         10  MR-UPCL                    PIC S9(04) COMP.          03640000
036500         10  MR-UPCA                    PIC  X(01).               03650000
036600         10  MR-UPCC                    PIC  X(01).               03660000
036700         10  MR-UPCH                    PIC  X(01).               03670000
036800         10  MR-UPC                     PIC  Z(15).               03680000
036900                                                                  03690000
037000         10  MR-SKUL                    PIC S9(04) COMP.          03700000
037100         10  MR-SKUA                    PIC  X(01).               03710000
037200         10  MR-SKUC                    PIC  X(01).               03720000
037300         10  MR-SKUH                    PIC  X(01).               03730000
037400         10  MR-SKU                     PIC  Z(08).               03740000
037500                                                                  03750000
037600         10  MR-NET-ADJL                PIC S9(04) COMP.          03760000
037700         10  MR-NET-ADJA                PIC  X(01).               03770000
037800         10  MR-NET-ADJC                PIC  X(01).               03780000
037900         10  MR-NET-ADJH                PIC  X(01).               03790000
038000         10  MR-NET-ADJ                 PIC  X(07).               03800000
038100                                                                  03810000
038200         10  MR-ADJ-SOURCEL             PIC S9(04) COMP.          03820000
038300         10  MR-ADJ-SOURCEA             PIC  X(01).               03830000
038400         10  MR-ADJ-SOURCEC             PIC  X(01).               03840000
038500         10  MR-ADJ-SOURCEH             PIC  X(01).               03850000
038600         10  MR-ADJ-SOURCE              PIC  X(08).               03860000
038700                                                                  03870000
038800         10  MR-FAIL-SUCCSSL            PIC S9(04) COMP.          03880000
038900         10  MR-FAIL-SUCCSSA            PIC  X(01).               03890000
039000         10  MR-FAIL-SUCCSSC            PIC  X(01).               03900000
039100         10  MR-FAIL-SUCCSSH            PIC  X(01).               03910000
039200         10  MR-FAIL-SUCCSS             PIC  X(01).               03920000
039300                                                                  03930000
039400         10  MR-ACKNOWLEDGEL            PIC S9(04) COMP.          03940000
039500         10  MR-ACKNOWLEDGEA            PIC  X(01).               03950000
039600         10  MR-ACKNOWLEDGEC            PIC  X(01).               03960000
039700         10  MR-ACKNOWLEDGEH            PIC  X(01).               03970000
039800         10  MR-ACKNOWLEDGE             PIC  X(01).               03980000
039900                                                                  03990000
040000*-----------------------------------------------------------------04000000
040100*  COPYBOOK FOR LOGISTIC MODULE XLKUT001                          04010000
040200*-----------------------------------------------------------------04020000
040300     COPY XLWS001.                                                04030000
040400                                                                  04040000
040500*---------------------------------------------------------------* 04050000
040600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04060000
040700*---------------------------------------------------------------* 04070000
040800     COPY DPWS015.                                                04080000
040900                                                                  04090000
041000*---------------------------------------------------------------* 04100000
041100*    FUNCTION KEYS COPYBOOK.                                    * 04110000
041200*---------------------------------------------------------------* 04120000
041300     COPY DPWS016.                                                04130000
041400                                                                  04140000
041500*---------------------------------------------------------------* 04150000
041600*    NUMERIC EDIT LAYOUT.                                       * 04160000
041700*---------------------------------------------------------------* 04170000
041800     COPY DPWS010I.                                               04180000
041900                                                                  04190000
042000*----------------------------------------------------------------*04200000
042100**  SECURITY SUBROUTINE PARAMETERS                                04210000
042200*----------------------------------------------------------------*04220000
042300     COPY DPWS008.                                                04230000
042400                                                                  04240000
042500*---------------------------------------------------------------* 04250000
042600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04260008
042700*---------------------------------------------------------------* 04270000
042800     COPY DPWS030.                                                04280000
042800     COPY DPWS930.                                                04281008
042900                                                                  04290000
043000*---------------------------------------------------------------* 04300000
043100*    STANDARD COMMAREA.                                         * 04310000
043200*---------------------------------------------------------------* 04320000
043300     COPY DPWS020.                                                04330000
043400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04340000
043500                                                                  04350000
043600*---------------------------------------------------------------* 04360000
043700* INTER-APPLICATION COMMAREA.                                   * 04370000
043800*   SUWS037 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04380000
043900*             SPEC SCREEN.                                      * 04390000
044000*   SUWS038 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04400000
044100*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04410000
044200*---------------------------------------------------------------* 04420000
044300                                                                  04430000
044400         10  INTER-APPL-COMM-AREA       PIC X(200).               04440000
044500     COPY SUWS037.                                                04450000
044600     COPY SUWS038.                                                04460000
044700*---------------------------------------------------------------* 04470000
044800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04480000
044900*---------------------------------------------------------------* 04490000
045000         10  ASC-SPECIFIC-COMMAREA.                               04500000
045100             15  ASC-CURSOR-SW                       PIC  X(01).  04510000
045200                 88  ASC-OP-PO-RC-LN-ST-CSR          VALUE 'A'.   04520000
045300                 88  ASC-OP-PO-REC-LNE-CSR           VALUE 'B'.   04530000
045400                 88  ASC-OPER-PO-REC-CSR             VALUE 'C'.   04540000
045500                 88  ASC-OPER-PO-CSR                 VALUE 'D'.   04550000
045600                 88  ASC-OPER-CSR                    VALUE 'E'.   04560000
045700                 88  ASC-PO-REC-LNE-DST-CSR          VALUE 'F'.   04570000
045800                 88  ASC-PO-REC-LNE-CSR              VALUE 'G'.   04580000
045900                 88  ASC-PO-REC-CSR                  VALUE 'H'.   04590000
046000                 88  ASC-PO-CSR                      VALUE 'I'.   04600000
046100                 88  ASC-OPER-UPC-CSR                VALUE 'J'.   04610000
046200                 88  ASC-UPC-CSR                     VALUE 'K'.   04620000
046300                 88  ASC-AUDIT-CSR                   VALUE 'L'.   04630000
046400                 88  ASC-SHIPT-UNT-CSR               VALUE 'M'.   04640000
046500                 88  ASC-OPER-SKU-CSR                VALUE 'N'.   04650000
046600                 88  ASC-SKU-CSR                     VALUE 'O'.   04660000
046700             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          04670000
046800             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 04680000
046900                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          04690000
047000             15  ASC-UNT-ADJ-TYP             PIC  X(01).          04700000
047100                 88  ASC-UNT-ADJ-ALL               VALUE 'A'.     04710000
047200                 88  ASC-UNT-ADJ-CNFRM             VALUE 'C'.     04720000
047300                 88  ASC-UNT-ADJ-POSTV             VALUE 'P'.     04730000
047400                 88  ASC-UNT-ADJ-VERFY             VALUE 'V'.     04740000
047500                 88  ASC-UNT-ADJ-P2L               VALUE 'Q'.     04750000
047600             15  ASC-FAIL-SUCCESS-IND        PIC X(01).           04760000
047700                 88  ASC-FAIL-SUCC-ALL             VALUE 'A'.     04770000
047800                 88  ASC-FAIL                      VALUE 'F'.     04780000
047900                 88  ASC-SUCCESS                   VALUE 'S'.     04790000
048000                 88  ASC-UNACKNOWLEDGED            VALUE 'U'.     04800000
048100             15  ASC-FROM-DATE.                                   04810000
048200                 20  ASC-FROM-MM             PIC  X(02).          04820000
048300                 20  ASC-FROM-DD             PIC  X(02).          04830000
048400                 20  ASC-FROM-YY             PIC  X(04).          04840000
048500             15  ASC-TO-DATE.                                     04850000
048600                 20  ASC-TO-MM               PIC  X(02).          04860000
048700                 20  ASC-TO-DD               PIC  X(02).          04870000
048800                 20  ASC-TO-YY               PIC  X(04).          04880000
048900             15  ASC-TOTAL-NET-ADJUST        PIC S9(10).          04890000
049000             15  ASC-ADJ-SRC-NAME            PIC  X(50).          04900000
049100             15  ASC-ADJ-SRC-NAME-HOLD       PIC  X(50).          04910000
049200             15  ASC-OPER-UNT-ID-X           PIC  X(04).          04920000
049300             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID-X.   04930000
049400                 20  ASC-OPER-UNT-ID         PIC  9(04).          04940000
049500             15  ASC-OPER-NAME               PIC  X(25).          04950000
049600             15  ASC-PO-RCVR-13              PIC  X(13).          04960000
049700             15  ASC-PO-RCVR-N REDEFINES ASC-PO-RCVR-13.          04970000
049800                 20  ASC-PO-Z                PIC  9(08).          04980000
049900                 20  FILLER                  PIC  X(01).          04990000
050000                 20  ASC-RCVR-Z              PIC  9(04).          05000000
050100             15  ASC-PO-X                    PIC  X(09).          05010000
050200             15  ASC-PO-N REDEFINES ASC-PO-X.                     05020000
050300                 20  ASC-PO                  PIC  9(09).          05030000
050400             15  ASC-RCVR-X                  PIC  X(04).          05040000
050500             15  ASC-RCVR-N REDEFINES ASC-RCVR-X.                 05050000
050600                 20  ASC-RCVR                PIC  9(04).          05060000
050700             15  ASC-LINE-X                  PIC X(04).           05070000
050800             15  ASC-LINE-N REDEFINES ASC-LINE-X.                 05080000
050900                 20  ASC-LINE                PIC  9(04).          05090000
051000             15  ASC-STR-NBR-X               PIC  X(04).          05100000
051100             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           05110000
051200                 20  ASC-STR-NBR             PIC  9(04).          05120000
051300             15  ASC-STR-NAME                PIC  X(20).          05130000
051400             15  ASC-AUDIT-NBR-X             PIC  X(09).          05140000
051500             15  ASC-AUDIT-NBR-N REDEFINES ASC-AUDIT-NBR-X.       05150000
051600                 20  ASC-AUDIT-NBR           PIC  9(09).          05160000
051700             15  ASC-SKU-X                   PIC  X(08).          05170000
051800             15  ASC-SKU-N REDEFINES ASC-SKU-X.                   05180000
051900                 20  ASC-SKU                  PIC  9(08).         05190000
052000             15  ASC-UPC-X                   PIC  X(15).          05200000
052100             15  ASC-UPC-N REDEFINES ASC-UPC-X.                   05210000
052200                 20  ASC-UPC                 PIC  9(15).          05220000
052300             15 ASC-SHIPT-UNT-ID             PIC S9(18) COMP-3.   05230000
052400             15  ASC-NET-ADJ                 PIC S9(06).          05240000
052500             15  ASC-ADJ-SOURCE              PIC  X(08).          05250000
052600             15  ASC-ACKNOWLEDGED            PIC  X(01).          05260000
052700             15  ASC-PROCESS-GROUP           PIC X(01).           05270000
052800                 88  ASC-GROUP-ALL                 VALUE 'A'.     05280000
052900                 88  ASC-GROUP-CRTN                VALUE 'C'.     05290000
053000                 88  ASC-GROUP-P2L                 VALUE 'P'.     05300000
053100             15  ASC-PROCESS-GRP-DESC        PIC X(25).           05310000
053200                                                                  05320000
053300*-----------------------------------------------------------------05330000
053400             15  ASC-BLK-SUB                  PIC S9(04) COMP     05340000
053500                                                         SYNC.    05350000
053600             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05360000
053700                                                         SYNC.    05370000
053800             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05380000
053900             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05390000
054000             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05400000
054100             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05410000
054200             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05420000
054300             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05430000
054400                                                         SYNC.    05440000
054500             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05450000
054600             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05460000
054700             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05470000
054800                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05480000
054900                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05490000
055000             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05500000
055100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05510000
055200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05520000
055300             15  ASC-LIST-QUEUE-NAME.                             05530000
055400                 20  ASC-LIST-TERM-ID         PIC  X(04).         05540000
055500                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05550000
055600                 20  ASC-LIST-SEQ             PIC  9(01).         05560000
055700                                                                  05570000
055800             15  ASC-START-ITEM-REQUEST.                          05580000
055900                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05590000
056000                                                                  05600000
056100             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05610000
056200             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05620000
056300             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05630000
056400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05640000
056500             15  ASC-SEL-QUEUE-NAME-IN        PIC X(08).          05650002
056600             15  ASC-SEL-QUEUE-NAME.                              05660000
056700                 20  ASC-SEL-TERM-ID          PIC  X(04).         05670000
056800                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05680000
056900                 20  ASC-SEL-SEQ              PIC  9(01).         05690000
057000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05700000
057100                                                                  05710000
057200*-----------------------------------------------------------------05720000
057300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05730000
057400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05740000
057500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05750000
057600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05760000
057700                                                                  05770000
057800                 20  ASC-ITEM-ARRAY.                              05780000
057900                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        05790000
058000                         30  ASC-LIST-ITEM-NUMBER                 05800000
058100                                                     PIC S9(09)   05810000
058200                                                     COMP-3.      05820000
058300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05830000
058400                             88  ASC-VALID-SELECT    VALUE ' '    05840000
058500                                                           'S'    05850000
058600                                                           'B'    05860000
058700                                                           'E'.   05870000
058800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05880000
058900                             88  ASC-TEMP-SELECT     VALUE 'S'.   05890000
059000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05900000
059100                             88  ASC-TEMP-END        VALUE 'E'.   05910000
059200                         30  ASC-SELECTED-SW         PIC  X(01).  05920000
059300                             88  ASC-NO-SELECT       VALUE ' '.   05930000
059400                             88  ASC-SELECT          VALUE 'S'.   05940000
059500                             88  ASC-BEGIN           VALUE 'B'.   05950000
059600                             88  ASC-END             VALUE 'E'.   05960000
059700                         30  ASC-ACTION              PIC  X(03).  05970000
059800                         30  ASC-OPER-UNT            PIC  9(04).  05980000
059900                         30  ASC-PO-RCVR             PIC  X(13).  05990000
060000                         30  ASC-LINE-NBR            PIC  9(04).  06000000
060100                         30  ASC-UPC-NBR             PIC  9(15).  06010000
060200                         30  ASC-SKU-NBR             PIC  9(08).  06020000
060300                         30  ASC-TOT-NET-ADJ         PIC ZZZZZ9-. 06030000
060400                         30  ASC-ADJ-SRCE            PIC  X(08).  06040000
060500                         30  ASC-FAIL-SUCCSS         PIC  X(01).  06050000
060600                         30  ASC-ACKNOWLEDGE         PIC  X(01).  06060000
060700                                                                  06070000
060800*---------------------------------------------------------------* 06080000
060900*    ABEND PROCESSING COPYBOOK.                                 * 06090000
061000*---------------------------------------------------------------* 06100000
061100     COPY DPWS013.                                                06110000
061200                                                                  06120000
061300*---------------------------------------------------------------* 06130000
061400*    DB2 AREA FOR SYSDUMMY TABLE                                  06140000
061500*---------------------------------------------------------------* 06150000
061600     EXEC SQL                                                     06160000
061700          INCLUDE SYSDUMMY                                        06170000
061800     END-EXEC.                                                    06180000
061900                                                                  06190000
062000*---------------------------------------------------------------* 06200000
062100*    FINANCIAL ADJUSTMENT TABLE - SUT_FINCL_ADJ                   06210000
062200*---------------------------------------------------------------* 06220000
062300     EXEC SQL                                                     06230000
062400          INCLUDE SUT00030                                        06240000
062500     END-EXEC.                                                    06250000
062600                                                                  06260000
062700*---------------------------------------------------------------* 06270000
062800*    OUTBOUND CARTON TABLE - SUT_OTBND_CART                       06280000
062900*---------------------------------------------------------------* 06290000
063000     EXEC SQL                                                     06300000
063100          INCLUDE SUT00024                                        06310000
063200     END-EXEC.                                                    06320000
063300                                                                  06330000
063400*---------------------------------------------------------------* 06340000
063500*    THE TSURSNC TABLE                                            06350000
063600*---------------------------------------------------------------* 06360000
063700     EXEC SQL                                                     06370000
063800          INCLUDE TSURSNC                                         06380000
063900     END-EXEC.                                                    06390000
064000                                                                  06400000
064100*---------------------------------------------------------------* 06410000
064200*    THE XLT_SKU TABLE                                            06420000
064300*---------------------------------------------------------------* 06430000
064400     EXEC SQL                                                     06440000
064500          INCLUDE XLT00003                                        06450000
064600     END-EXEC.                                                    06460000
064700                                                                  06470000
064800*---------------------------------------------------------------* 06480000
064900*    THE XLT_UPC TABLE                                            06490000
065000*---------------------------------------------------------------* 06500000
065100     EXEC SQL                                                     06510000
065200          INCLUDE XLT00006                                        06520000
065300     END-EXEC.                                                    06530000
065400                                                                  06540000
065500*---------------------------------------------------------------* 06550000
065600*    THE LIST CURSOR                                              06560000
065700*---------------------------------------------------------------* 06570000
065800*    EXEC SQL                                                     06580000
065900*         DECLARE LIST-CSR CURSOR FOR                             06590000
066000*             SELECT  A.ORGN_LOC_NBR                              06600000
066100*                    ,A.PO_NBR                                    06610000
066200*                    ,A.RCVR_SEQ_NBR                              06620000
066300*                    ,A.RCVR_LNE_NBR                              06630000
066400*                    ,A.UPC_NBR                                   06640000
066500*                    ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      06650000
066600*               FROM  SUT_FINCL_ADJ A                             06660000
066700*                    ,TSURSNC B                                   06670000
066800*             WHERE  A.PO_NBR             = :DK-PO-NBR            06680000
066900*               AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      06690000
067000*               AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          06700000
067100*               AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       06710000
067200*               AND  A.AUD_CNTL_NBR       = :DK-AUDIT-NBR         06720000
067300*               AND  A.UPC_NBR            = :DK-UPC-NBR           06730000
067400*               AND  A.SHIPT_UNT_ID      >= :DK-SHIPT-UNT-ID      06740000
067500*               AND  A.CRE_TMST          >= :PV-FROM-TMST         06750000
067600*               AND  A.CRE_TMST          <= :PV-TO-TMST           06760000
067700*               AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 06770000
067800*               AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   06780000
067900*               AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   06790000
068000*               AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     06800000
068100*               AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     06810000
068200*               AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       06820000
068300*               AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          06830000
068400*               AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       06840000
068500*               AND  B.PRC_GP_CDE        <= :DK-GROUP-END         06850000
068600*     GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          06860000
068700*              A.RCVR_LNE_NBR, A.UPC_NBR                          06870000
068800*    END-EXEC.                                                    06880000
068900                                                                  06890000
069000*---------------------------------------------------------------* 06900000
069100*    THE OPER CURSOR                                              06910000
069200*---------------------------------------------------------------* 06920000
069300     EXEC SQL                                                     06930000
069400          DECLARE OPER-CSR CURSOR FOR                             06940000
069500              SELECT  A.ORGN_LOC_NBR                              06950000
069600                     ,A.PO_NBR                                    06960000
069700                     ,A.RCVR_SEQ_NBR                              06970000
069800                     ,A.RCVR_LNE_NBR                              06980000
069900                     ,A.UPC_NBR                                   06990000
070000                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      07000000
070100                FROM  SUT_FINCL_ADJ A                             07010000
070200                     ,TSURSNC B                                   07020000
070300              WHERE  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       07030000
070400                AND  A.CRE_TMST          >= :PV-FROM-TMST         07040000
070500                AND  A.CRE_TMST          <= :PV-TO-TMST           07050000
070600                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 07060000
070700                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   07070000
070800                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   07080000
070900                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     07090000
071000                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     07100000
071100                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       07110000
071200                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          07120000
071300                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       07130000
071400                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         07140000
071500      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          07150000
071600               A.RCVR_LNE_NBR, A.UPC_NBR                          07160000
071700     END-EXEC.                                                    07170000
071800                                                                  07180000
071900*---------------------------------------------------------------* 07190000
072000*    THE OPER PO CURSOR                                           07200000
072100*---------------------------------------------------------------* 07210000
072200     EXEC SQL                                                     07220000
072300          DECLARE OPER-PO-CSR CURSOR FOR                          07230000
072400              SELECT  A.ORGN_LOC_NBR                              07240000
072500                     ,A.PO_NBR                                    07250000
072600                     ,A.RCVR_SEQ_NBR                              07260000
072700                     ,A.RCVR_LNE_NBR                              07270000
072800                     ,A.UPC_NBR                                   07280000
072900                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      07290000
073000                FROM  SUT_FINCL_ADJ A                             07300000
073100                     ,TSURSNC B                                   07310000
073200              WHERE  A.PO_NBR             = :DK-PO-NBR            07320000
073300                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       07330000
073400                AND  A.CRE_TMST          >= :PV-FROM-TMST         07340000
073500                AND  A.CRE_TMST          <= :PV-TO-TMST           07350000
073600                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 07360000
073700                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   07370000
073800                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   07380000
073900                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     07390000
074000                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     07400000
074100                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       07410000
074200                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          07420000
074300                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       07430000
074400                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         07440000
074500      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          07450000
074600               A.RCVR_LNE_NBR, A.UPC_NBR                          07460000
074700     END-EXEC.                                                    07470000
074800                                                                  07480000
074900*---------------------------------------------------------------* 07490000
075000*    THE OPER PO RECEIVER CURSOR                                  07500000
075100*---------------------------------------------------------------* 07510000
075200     EXEC SQL                                                     07520000
075300          DECLARE OPER-PO-REC-CSR CURSOR FOR                      07530000
075400              SELECT  A.ORGN_LOC_NBR                              07540000
075500                     ,A.PO_NBR                                    07550000
075600                     ,A.RCVR_SEQ_NBR                              07560000
075700                     ,A.RCVR_LNE_NBR                              07570000
075800                     ,A.UPC_NBR                                   07580000
075900                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      07590000
076000                FROM  SUT_FINCL_ADJ A                             07600000
076100                     ,TSURSNC B                                   07610000
076200              WHERE  A.PO_NBR             = :DK-PO-NBR            07620000
076300                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      07630000
076400                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       07640000
076500                AND  A.CRE_TMST          >= :PV-FROM-TMST         07650000
076600                AND  A.CRE_TMST          <= :PV-TO-TMST           07660000
076700                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 07670000
076800                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   07680000
076900                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   07690000
077000                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     07700000
077100                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     07710000
077200                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       07720000
077300                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          07730000
077400                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       07740000
077500                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         07750000
077600      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          07760000
077700               A.RCVR_LNE_NBR, A.UPC_NBR                          07770000
077800     END-EXEC.                                                    07780000
077900                                                                  07790000
078000*---------------------------------------------------------------* 07800000
078100*    THE OPER PO RECEIVER LINE CURSOR                             07810000
078200*---------------------------------------------------------------* 07820000
078300     EXEC SQL                                                     07830000
078400          DECLARE OP-PO-REC-LNE-CSR CURSOR FOR                    07840000
078500              SELECT  A.ORGN_LOC_NBR                              07850000
078600                     ,A.PO_NBR                                    07860000
078700                     ,A.RCVR_SEQ_NBR                              07870000
078800                     ,A.RCVR_LNE_NBR                              07880000
078900                     ,A.UPC_NBR                                   07890000
079000                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      07900000
079100                FROM  SUT_FINCL_ADJ A                             07910000
079200                     ,TSURSNC B                                   07920000
079300              WHERE  A.PO_NBR             = :DK-PO-NBR            07930000
079400                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      07940000
079500                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          07950000
079600                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       07960000
079700                AND  A.CRE_TMST          >= :PV-FROM-TMST         07970000
079800                AND  A.CRE_TMST          <= :PV-TO-TMST           07980000
079900                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 07990000
080000                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   08000000
080100                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   08010000
080200                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     08020000
080300                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     08030000
080400                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       08040000
080500                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          08050000
080600                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       08060000
080700                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         08070000
080800      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          08080000
080900               A.RCVR_LNE_NBR, A.UPC_NBR                          08090000
081000     END-EXEC.                                                    08100000
081100                                                                  08110000
081200*---------------------------------------------------------------* 08120000
081300*    THE OPER PO RECEIVER LINE DEST CURSOR                        08130000
081400*---------------------------------------------------------------* 08140000
081500     EXEC SQL                                                     08150000
081600          DECLARE OP-PO-RC-LN-ST-CSR CURSOR FOR                   08160000
081700              SELECT  A.ORGN_LOC_NBR                              08170000
081800                     ,A.PO_NBR                                    08180000
081900                     ,A.RCVR_SEQ_NBR                              08190000
082000                     ,A.RCVR_LNE_NBR                              08200000
082100                     ,A.UPC_NBR                                   08210000
082200                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      08220000
082300                FROM  SUT_FINCL_ADJ A                             08230000
082400                     ,TSURSNC B                                   08240000
082500              WHERE  A.PO_NBR             = :DK-PO-NBR            08250000
082600                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      08260000
082700                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          08270000
082800                AND  A.DEST_LOC_NBR       = :DK-STR-NBR           08280000
082900                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       08290000
083000                AND  A.CRE_TMST          >= :PV-FROM-TMST         08300000
083100                AND  A.CRE_TMST          <= :PV-TO-TMST           08310000
083200                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 08320000
083300                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   08330000
083400                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   08340000
083500                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     08350000
083600                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     08360000
083700                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       08370000
083800                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          08380000
083900                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       08390000
084000                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         08400000
084100      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          08410000
084200               A.RCVR_LNE_NBR, A.UPC_NBR                          08420000
084300     END-EXEC.                                                    08430000
084400                                                                  08440000
084500*---------------------------------------------------------------* 08450000
084600*    THE OPER UPC CURSOR                                          08460000
084700*---------------------------------------------------------------* 08470000
084800     EXEC SQL                                                     08480000
084900          DECLARE OPER-UPC-CSR CURSOR FOR                         08490000
085000              SELECT  A.ORGN_LOC_NBR                              08500000
085100                     ,A.PO_NBR                                    08510000
085200                     ,A.RCVR_SEQ_NBR                              08520000
085300                     ,A.RCVR_LNE_NBR                              08530000
085400                     ,A.UPC_NBR                                   08540000
085500                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      08550000
085600                FROM  SUT_FINCL_ADJ A                             08560000
085700                     ,TSURSNC B                                   08570000
085800              WHERE  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       08580000
085900                AND  A.UPC_NBR            = :DK-UPC-NBR           08590000
086000                AND  A.CRE_TMST          >= :PV-FROM-TMST         08600000
086100                AND  A.CRE_TMST          <= :PV-TO-TMST           08610000
086200                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 08620000
086300                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   08630000
086400                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   08640000
086500                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     08650000
086600                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     08660000
086700                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       08670000
086800                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          08680000
086900                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       08690000
087000                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         08700000
087100      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          08710000
087200               A.RCVR_LNE_NBR, A.UPC_NBR                          08720000
087300     END-EXEC.                                                    08730000
087400                                                                  08740000
087500*---------------------------------------------------------------* 08750000
087600*    THE PO CURSOR                                                08760000
087700*---------------------------------------------------------------* 08770000
087800     EXEC SQL                                                     08780000
087900          DECLARE PO-CSR CURSOR FOR                               08790000
088000              SELECT  A.ORGN_LOC_NBR                              08800000
088100                     ,A.PO_NBR                                    08810000
088200                     ,A.RCVR_SEQ_NBR                              08820000
088300                     ,A.RCVR_LNE_NBR                              08830000
088400                     ,A.UPC_NBR                                   08840000
088500                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      08850000
088600                FROM  SUT_FINCL_ADJ A                             08860000
088700                     ,TSURSNC B                                   08870000
088800              WHERE  A.PO_NBR             = :DK-PO-NBR            08880000
088900                AND  A.CRE_TMST          >= :PV-FROM-TMST         08890000
089000                AND  A.CRE_TMST          <= :PV-TO-TMST           08900000
089100                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 08910000
089200                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   08920000
089300                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   08930000
089400                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     08940000
089500                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     08950000
089600                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       08960000
089700                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          08970000
089800                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       08980000
089900                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         08990000
090000      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          09000000
090100               A.RCVR_LNE_NBR, A.UPC_NBR                          09010000
090200     END-EXEC.                                                    09020000
090300                                                                  09030000
090400*---------------------------------------------------------------* 09040000
090500*    THE PO RECEIVER CURSOR                                       09050000
090600*---------------------------------------------------------------* 09060000
090700     EXEC SQL                                                     09070000
090800          DECLARE PO-REC-CSR CURSOR FOR                           09080000
090900              SELECT  A.ORGN_LOC_NBR                              09090000
091000                     ,A.PO_NBR                                    09100000
091100                     ,A.RCVR_SEQ_NBR                              09110000
091200                     ,A.RCVR_LNE_NBR                              09120000
091300                     ,A.UPC_NBR                                   09130000
091400                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      09140000
091500                FROM  SUT_FINCL_ADJ A                             09150000
091600                     ,TSURSNC B                                   09160000
091700              WHERE  A.PO_NBR             = :DK-PO-NBR            09170000
091800                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      09180000
091900                AND  A.CRE_TMST          >= :PV-FROM-TMST         09190000
092000                AND  A.CRE_TMST          <= :PV-TO-TMST           09200000
092100                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 09210000
092200                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   09220000
092300                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   09230000
092400                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     09240000
092500                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     09250000
092600                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       09260000
092700                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          09270000
092800                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       09280000
092900                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         09290000
093000      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          09300000
093100               A.RCVR_LNE_NBR, A.UPC_NBR                          09310000
093200     END-EXEC.                                                    09320000
093300                                                                  09330000
093400*---------------------------------------------------------------* 09340000
093500*    THE PO RECEIVER LINE CURSOR                                  09350000
093600*---------------------------------------------------------------* 09360000
093700     EXEC SQL                                                     09370000
093800          DECLARE PO-REC-LNE-CSR CURSOR FOR                       09380000
093900              SELECT  A.ORGN_LOC_NBR                              09390000
094000                     ,A.PO_NBR                                    09400000
094100                     ,A.RCVR_SEQ_NBR                              09410000
094200                     ,A.RCVR_LNE_NBR                              09420000
094300                     ,A.UPC_NBR                                   09430000
094400                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      09440000
094500                FROM  SUT_FINCL_ADJ A                             09450000
094600                     ,TSURSNC B                                   09460000
094700              WHERE  A.PO_NBR             = :DK-PO-NBR            09470000
094800                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      09480000
094900                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          09490000
095000                AND  A.CRE_TMST          >= :PV-FROM-TMST         09500000
095100                AND  A.CRE_TMST          <= :PV-TO-TMST           09510000
095200                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 09520000
095300                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   09530000
095400                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   09540000
095500                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     09550000
095600                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     09560000
095700                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       09570000
095800                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          09580000
095900                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       09590000
096000                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         09600000
096100      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          09610000
096200               A.RCVR_LNE_NBR, A.UPC_NBR                          09620000
096300     END-EXEC.                                                    09630000
096400                                                                  09640000
096500*---------------------------------------------------------------* 09650000
096600*    THE PO RECEIVER LINE DEST CURSOR                             09660000
096700*---------------------------------------------------------------* 09670000
096800     EXEC SQL                                                     09680000
096900          DECLARE PO-REC-LNE-DST-CSR CURSOR FOR                   09690000
097000              SELECT  A.ORGN_LOC_NBR                              09700000
097100                     ,A.PO_NBR                                    09710000
097200                     ,A.RCVR_SEQ_NBR                              09720000
097300                     ,A.RCVR_LNE_NBR                              09730000
097400                     ,A.UPC_NBR                                   09740000
097500                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      09750000
097600                FROM  SUT_FINCL_ADJ A                             09760000
097700                     ,TSURSNC B                                   09770000
097800              WHERE  A.PO_NBR             = :DK-PO-NBR            09780000
097900                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      09790000
098000                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          09800000
098100                AND  A.DEST_LOC_NBR       = :DK-STR-NBR           09810000
098200                AND  A.CRE_TMST          >= :PV-FROM-TMST         09820000
098300                AND  A.CRE_TMST          <= :PV-TO-TMST           09830000
098400                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 09840000
098500                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   09850000
098600                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   09860000
098700                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     09870000
098800                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     09880000
098900                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       09890000
099000                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          09900000
099100                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       09910000
099200                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         09920000
099300      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          09930000
099400               A.RCVR_LNE_NBR, A.UPC_NBR                          09940000
099500     END-EXEC.                                                    09950000
099600                                                                  09960000
099700*---------------------------------------------------------------* 09970000
099800*    THE UPC CURSOR                                               09980000
099900*---------------------------------------------------------------* 09990000
100000     EXEC SQL                                                     10000000
100100          DECLARE UPC-CSR CURSOR FOR                              10010000
100200              SELECT  A.ORGN_LOC_NBR                              10020000
100300                     ,A.PO_NBR                                    10030000
100400                     ,A.RCVR_SEQ_NBR                              10040000
100500                     ,A.RCVR_LNE_NBR                              10050000
100600                     ,A.UPC_NBR                                   10060000
100700                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      10070000
100800                FROM  SUT_FINCL_ADJ A                             10080000
100900                     ,TSURSNC B                                   10090000
101000              WHERE  A.UPC_NBR            = :DK-UPC-NBR           10100000
101100                AND  A.CRE_TMST          >= :PV-FROM-TMST         10110000
101200                AND  A.CRE_TMST          <= :PV-TO-TMST           10120000
101300                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 10130000
101400                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   10140000
101500                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   10150000
101600                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     10160000
101700                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     10170000
101800                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       10180000
101900                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          10190000
102000                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       10200000
102100                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         10210000
102200      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          10220000
102300               A.RCVR_LNE_NBR, A.UPC_NBR                          10230000
102400     END-EXEC.                                                    10240000
102500                                                                  10250000
102600*---------------------------------------------------------------* 10260000
102700*    THE AUDIT CURSOR                                             10270000
102800*---------------------------------------------------------------* 10280000
102900     EXEC SQL                                                     10290000
103000          DECLARE AUDIT-CSR CURSOR FOR                            10300000
103100              SELECT  A.ORGN_LOC_NBR                              10310000
103200                     ,A.PO_NBR                                    10320000
103300                     ,A.RCVR_SEQ_NBR                              10330000
103400                     ,A.RCVR_LNE_NBR                              10340000
103500                     ,A.UPC_NBR                                   10350000
103600                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      10360000
103700                FROM  SUT_FINCL_ADJ A                             10370000
103800                     ,TSURSNC B                                   10380000
103900              WHERE  A.AUD_CNTL_NBR       = :DK-AUDIT-NBR         10390000
104000**              AND  A.CRE_TMST          >= :PV-FROM-TMST         10400000
104100**              AND  A.CRE_TMST          <= :PV-TO-TMST           10410000
104200                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 10420000
104300                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   10430000
104400                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   10440000
104500                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     10450000
104600                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     10460000
104700                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       10470000
104800                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          10480000
104900                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       10490000
105000                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         10500000
105100      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          10510000
105200               A.RCVR_LNE_NBR, A.UPC_NBR                          10520000
105300     END-EXEC.                                                    10530000
105400                                                                  10540000
105500*---------------------------------------------------------------* 10550000
105600*    THE SHIPT UNIT CURSOR                                        10560000
105700*---------------------------------------------------------------* 10570000
105800     EXEC SQL                                                     10580000
105900          DECLARE SHIPT-UNIT-CSR CURSOR FOR                       10590000
106000              SELECT  A.ORGN_LOC_NBR                              10600000
106100                     ,A.PO_NBR                                    10610000
106200                     ,A.RCVR_SEQ_NBR                              10620000
106300                     ,A.RCVR_LNE_NBR                              10630000
106400                     ,A.UPC_NBR                                   10640000
106500                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      10650000
106600                FROM  SUT_FINCL_ADJ A                             10660000
106700                     ,TSURSNC B                                   10670000
106800              WHERE  A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID      10680000
106900                AND  A.CRE_TMST          >= :PV-FROM-TMST         10690000
107000                AND  A.CRE_TMST          <= :PV-TO-TMST           10700000
107100                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 10710000
107200                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   10720000
107300                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   10730000
107400                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     10740000
107500                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     10750000
107600                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       10760000
107700                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          10770000
107800                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       10780000
107900                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         10790000
108000      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          10800000
108100               A.RCVR_LNE_NBR, A.UPC_NBR                          10810000
108200     END-EXEC.                                                    10820000
108300                                                                  10830000
108400*---------------------------------------------------------------* 10840000
108500*    THE OPER SKU CURSOR                                          10850000
108600*---------------------------------------------------------------* 10860000
108700     EXEC SQL                                                     10870000
108800          DECLARE OPER-SKU-CSR CURSOR FOR                         10880000
108900              SELECT  A.ORGN_LOC_NBR                              10890000
109000                     ,A.PO_NBR                                    10900000
109100                     ,A.RCVR_SEQ_NBR                              10910000
109200                     ,A.RCVR_LNE_NBR                              10920000
109300                     ,A.UPC_NBR                                   10930000
109400                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      10940000
109500                FROM  SUT_FINCL_ADJ A                             10950000
109600                     ,TSURSNC B                                   10960000
109700                     ,XLT_SKU C                                   10970000
109800                     ,XLT_UPC D                                   10980000
109900              WHERE  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       10990000
110000                AND  C.SKU_NBR            = :DK-SKU-NBR           11000000
110100                AND  C.INTR_UPC_ID        = D.INTR_UPC_ID         11010000
110200                AND  A.UPC_NBR            = D.UPC_NBR             11020000
110300                AND  A.CRE_TMST          >= :PV-FROM-TMST         11030000
110400                AND  A.CRE_TMST          <= :PV-TO-TMST           11040000
110500                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 11050000
110600                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   11060000
110700                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   11070000
110800                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     11080000
110900                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     11090000
111000                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       11100000
111100                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          11110000
111200                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       11120000
111300                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         11130000
111400      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          11140000
111500               A.RCVR_LNE_NBR, A.UPC_NBR                          11150000
111600     END-EXEC.                                                    11160000
111700                                                                  11170000
111800*---------------------------------------------------------------* 11180000
111900*    THE SKU CURSOR                                               11190000
112000*---------------------------------------------------------------* 11200000
112100     EXEC SQL                                                     11210000
112200          DECLARE SKU-CSR CURSOR FOR                              11220000
112300              SELECT  A.ORGN_LOC_NBR                              11230000
112400                     ,A.PO_NBR                                    11240000
112500                     ,A.RCVR_SEQ_NBR                              11250000
112600                     ,A.RCVR_LNE_NBR                              11260000
112700                     ,A.UPC_NBR                                   11270000
112800                     ,SUM (A.FINCL_AFT_QTY -A.FINCL_BEF_QTY)      11280000
112900                FROM  SUT_FINCL_ADJ A                             11290000
113000                     ,TSURSNC B                                   11300000
113100                     ,XLT_SKU C                                   11310000
113200                     ,XLT_UPC D                                   11320000
113300              WHERE  C.SKU_NBR            = :DK-SKU-NBR           11330000
113400                AND  C.INTR_UPC_ID        = D.INTR_UPC_ID         11340000
113500                AND  A.UPC_NBR            = D.UPC_NBR             11350000
113600                AND  A.CRE_TMST          >= :PV-FROM-TMST         11360000
113700                AND  A.CRE_TMST          <= :PV-TO-TMST           11370000
113800                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 11380000
113900                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   11390000
114000                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   11400000
114100                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     11410000
114200                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     11420000
114300                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       11430000
114400                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          11440000
114500                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       11450000
114600                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         11460000
114700      GROUP BY A.ORGN_LOC_NBR, A.PO_NBR, A.RCVR_SEQ_NBR,          11470000
114800               A.RCVR_LNE_NBR, A.UPC_NBR                          11480000
114900     END-EXEC.                                                    11490000
115000                                                                  11500000
115100*---------------------------------------------------------------* 11510000
115200*    CURSOR TO FIND ADJUSTMENT SOURCE                             11520000
115300*    IF THERE ARE DIFFERENT ONES, JUST SHOW MULTIPLE              11530000
115400*---------------------------------------------------------------* 11540000
115500      EXEC SQL                                                    11550000
115600        DECLARE SOURCE-CSR CURSOR FOR                             11560000
115700          SELECT A.PRC_RSN_DESC                                   11570000
115800          FROM  TSURSNC A                                         11580000
115900              , SUT_FINCL_ADJ B                                   11590000
116000        WHERE  A.PRC_RSN_CDE    =  B.CRE_PGM_NM                   11600000
116100          AND  B.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN       11610000
116200          AND  B.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END         11620000
116300          AND  B.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN         11630000
116400          AND  B.AUTO_APL_IND      <= :DK-FAIL-SUCC-END           11640000
116500          AND  B.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN           11650000
116600          AND  B.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END             11660000
116700          AND  B.CRE_TMST          >= :PV-FROM-TMST               11670000
116800          AND  B.CRE_TMST          <= :PV-TO-TMST                 11680000
116900          AND  B.ORGN_LOC_NBR       = :PV-OPER-UNT-ID             11690000
117000          AND  B.PO_NBR             = :PV-PO                      11700000
117100          AND  B.RCVR_SEQ_NBR       = :PV-RCVR                    11710000
117200          AND  B.RCVR_LNE_NBR       = :PV-LINE                    11720000
117300          AND  B.DEST_LOC_NBR      >= :DK-STR-BEGIN               11730000
117400          AND  B.DEST_LOC_NBR      <= :DK-STR-END                 11740000
117500          AND  B.UPC_NBR            = :PV-UPC                     11750000
117600          AND  A.PRC_GP_CDE        >= :DK-GROUP-BEGIN             11760000
117700          AND  A.PRC_GP_CDE        <= :DK-GROUP-END               11770000
117800      END-EXEC.                                                   11780000
117900                                                                  11790000
118000*---------------------------------------------------------------* 11800000
118100*---------------------------------------------------------------* 11810000
118200     EXEC SQL                                                     11820000
118300          INCLUDE SQLCA                                           11830000
118400     END-EXEC.                                                    11840000
118500                                                                  11850000
118600*-----------------------------------------------------------------11860000
118700 LINKAGE SECTION.                                                 11870000
118800                                                                  11880000
118900 01  DFHCOMMAREA.                                                 11890000
119000     05  FILLER                         OCCURS  1 TO 4072 TIMES   11900000
119100                                        DEPENDING ON EIBCALEN.    11910000
119200         10  FILLER                     PIC X.                    11920000
119300                                                                  11930000
119400                                                                  11940000
119500 PROCEDURE DIVISION.                                              11950000
119600******************************************************************11960000
119700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **11970000
119800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **11980000
119900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **11990000
120000******************************************************************12000000
120100 0000-MAIN-MODULE.                                                12010000
120200     INITIALIZE DP030-CICS-API-FIELDS.                            12020000
120300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       12030000
120400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          12040000
120500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         12050000
120600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       12060000
120700     MOVE LENGTH OF SU755AI        TO DP030-MAP-LENGTH (1).       12070000
120800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     12080000
120900     PERFORM 0001-CALL-CICS-ARCH-API.                             12090000
121000                                                                  12100000
121100     PERFORM 1000-CONTROL-PROCESSING                              12110000
121200*                                                                 12120000
121300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12130000
121400     PERFORM 0001-CALL-CICS-ARCH-API.                             12140000
121500                                                                  12150000
121600******************************************************************12160000
121700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **12170000
121800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **12180000
121900******************************************************************12190000
122000 0001-CALL-CICS-ARCH-API.                                         12200000
122100*    CALL 'DPKCS030' USING DFHEIBLK                               12210008
122100     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      12211008
122200                           DFHCOMMAREA                            12220000
122300                           DP030-CICS-API-FIELDS                  12230000
122400                           DP020-STANDARD-COMMAREA                12240000
122500                           SU755AI.                               12250000
122600*                                                                 12260000
122700     IF  DP030-RC-CALL-SUCCESSFUL                                 12270000
122800         CONTINUE                                                 12280000
122900     ELSE                                                         12290000
123000         SET DP013-NO-ROLLBACK                                    12300000
123100             DP013-XCTL-DISPLAY-RESTART                           12310000
123200             DP013-CICS-ABEND      TO TRUE                        12320000
123300         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        12330000
123400*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX12340008
123500*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      12350008
123400         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O12351008
123500-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      12352008
123600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      12360000
123700         PERFORM DP013-0000-PROCESS-ABEND                         12370000
123800     END-IF.                                                      12380000
123900                                                                  12390000
124000*----------------------------------------------------------------*12400000
124100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *12410000
124200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *12420000
124300*                                                                *12430000
124400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *12440000
124500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *12450000
124600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *12460000
124700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *12470000
124800*----------------------------------------------------------------*12480000
124900 1000-CONTROL-PROCESSING.                                         12490000
125000                                                                  12500000
125100     EVALUATE TRUE                                                12510000
125200         WHEN DP020-NEXT-ACT-INITIAL                              12520000
125300             INITIALIZE ASC-SPECIFIC-COMMAREA                     12530000
125400             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            12540000
125500                                      ASC-SEL-TERM-ID             12550000
125600             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   12560000
125700                                           ASC-SEL-TASK-NUMBER    12570000
125800             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              12580000
125900             MOVE PC-SEL-QUEUE-SEQ   TO ASC-SEL-SEQ               12590000
126000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 12600000
126100             PERFORM 4000-BUILD-INITIAL-PANEL                     12610000
126200                                                                  12620000
126300         WHEN DP020-NEXT-ACT-READ-MAP                             12630000
126400             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         12640000
126500             PERFORM 2000-PROCESS-PANEL                           12650000
126600                                                                  12660000
126700         WHEN DP020-NEXT-ACT-RETURN                               12670000
126800             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         12680000
126900             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               12690000
127000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 12700000
127100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12710000
127200                                                                  12720000
127300         WHEN OTHER                                               12730000
127400             SET DP013-LOGIC-ABEND TO TRUE                        12740000
127500             SET DP013-NO-ROLLBACK TO TRUE                        12750000
127600             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    12760000
127700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12770000
127800                                   TO DP013-MESSAGE-TEXT(1)       12780000
127900             PERFORM DP013-0000-PROCESS-ABEND                     12790000
128000     END-EVALUATE.                                                12800000
128100                                                                  12810000
128200*----------------------------------------------------------------*12820000
128300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *12830000
128400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *12840000
128500*----------------------------------------------------------------*12850000
128600 1100-PROCESS-INTER-APPL-COMM.                                    12860000
128700                                                                  12870000
128800     SET PS-COMMAREA-VALID         TO TRUE.                       12880000
128900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     12890000
129000                                                                  12900000
129100     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          12910000
129200         MOVE SU037-CURR-OPER-UNT-ID  TO ASC-CURR-OPER-UNT-ID     12920000
129300         MOVE SU037-UNT-ADJ-TYP       TO ASC-UNT-ADJ-TYP          12930000
129400         MOVE SU037-FAIL-SUCCESS-IND  TO ASC-FAIL-SUCCESS-IND     12940000
129500         MOVE SU037-PROCESS-GROUP     TO ASC-PROCESS-GROUP        12950000
129600         MOVE SU037-PROCESS-GRP-DESC  TO ASC-PROCESS-GRP-DESC     12960000
129700         MOVE SU037-REQUEST-FROM-DATE TO ASC-FROM-DATE            12970000
129800         MOVE SU037-REQUEST-TO-DATE   TO ASC-TO-DATE              12980000
129900         MOVE SU037-OPER-UNT-ID       TO ASC-OPER-UNT-ID          12990000
130000         MOVE SU037-OPER-NAME         TO ASC-OPER-NAME            13000000
130100         MOVE SU037-PO                TO ASC-PO                   13010000
130200         MOVE SU037-RCVR              TO ASC-RCVR                 13020000
130300         MOVE SU037-LINE              TO ASC-LINE                 13030000
130400         MOVE SU037-STR-NBR           TO ASC-STR-NBR              13040000
130500         MOVE SU037-STR-NAME          TO ASC-STR-NAME             13050000
130600         MOVE SU037-AUDIT-NBR         TO ASC-AUDIT-NBR            13060000
130700         MOVE SU037-UPC               TO ASC-UPC                  13070000
130800         MOVE SU037-SKU               TO ASC-SKU                  13080000
130900         MOVE SU037-SML               TO ASC-SHIPT-UNT-ID         13090000
131000     ELSE                                                         13100000
131100         SET ASC-USE-SELECTION-QUEUE TO TRUE                      13110000
131200         MOVE SU038-NUMBER-OF-SELECTED-ITEMS TO                   13120000
131300                                      ASC-NUMBER-OF-SELECTED-ITEMS13130000
131400         MOVE SU038-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  13140000
131500         MOVE SU038-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   13150002
131600         MOVE SU038-UNT-ADJ-TYP        TO ASC-UNT-ADJ-TYP         13160000
131700         MOVE SU038-FAIL-SUCCSS        TO ASC-FAIL-SUCCESS-IND    13170000
131800         MOVE SU038-PROCESS-GROUP      TO ASC-PROCESS-GROUP       13180000
131900         MOVE SU038-PROCESS-GRP-DESC   TO ASC-PROCESS-GRP-DESC    13190000
132000         MOVE SU038-STR-NBR            TO ASC-STR-NBR             13200000
132100         MOVE SU038-FROM-DATE          TO ASC-FROM-DATE           13210000
132200         MOVE SU038-TO-DATE            TO ASC-TO-DATE             13220000
132300         MOVE SU038-TOT-NET-ADJ        TO ASC-NET-ADJ             13230000
132400         MOVE SU038-PO-RCVR            TO ASC-PO-RCVR-13          13240000
132500         MOVE ASC-PO-Z                 TO ASC-PO                  13250000
132600         MOVE ASC-RCVR-Z               TO ASC-RCVR                13260000
132700         MOVE SU038-LINE               TO ASC-LINE                13270000
132800         PERFORM 1120-PREPARE-LIST-ENTRY                          13280000
132900     END-IF.                                                      13290000
133000                                                                  13300000
133100*-----------------------------------------------------------------13310000
133200*  PREPARE LIST ENTRY                                             13320000
133300*-----------------------------------------------------------------13330000
133400 1120-PREPARE-LIST-ENTRY.                                         13340000
133500                                                                  13350000
133600     MOVE SU039-MAX-ITEMS          TO ASC-SEL-SUB.                13360000
133700     MOVE ZERO                     TO ASC-SEL-ITEM.               13370000
133800     PERFORM 1130-GET-NEXT-RECORD.                                13380000
133900                                                                  13390000
134000*-----------------------------------------------------------------13400000
134100*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*13410000
134200*-----------------------------------------------------------------13420000
134300 1130-GET-NEXT-RECORD.                                            13430000
134400     ADD +1                       TO ASC-SEL-SUB.                 13440000
134500                                                                  13450000
134600     IF  ASC-SEL-SUB > SU039-MAX-ITEMS                            13460000
134700         ADD +1                   TO ASC-SEL-ITEM                 13470000
134800         MOVE +1                  TO ASC-SEL-SUB                  13480000
134900     END-IF.                                                      13490000
135000                                                                  13500000
135100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                13510000
135200         PERFORM 9100-READ-SEL-QUEUE                              13520000
135300         IF  SU039-ITEM (ASC-SEL-SUB) > ZERO                      13530000
135400            IF SU039-OPER-UNT-ID(ASC-SEL-SUB) = ZEROES            13540000
135500               MOVE SU039-LINE (ASC-SEL-SUB)    TO ASC-LINE       13550000
135600            ELSE                                                  13560000
135700               MOVE SU039-OPER-UNT-ID(ASC-SEL-SUB)                13570000
135800                                       TO ASC-OPER-UNT-ID         13580000
135900               MOVE SU039-PO-RCVR (ASC-SEL-SUB)                   13590000
136000                                       TO ASC-PO-RCVR-13          13600000
136100               MOVE ASC-PO-Z           TO ASC-PO                  13610000
136200               MOVE ASC-RCVR-Z         TO ASC-RCVR                13620000
136300               MOVE SU039-LINE (ASC-SEL-SUB)                      13630000
136400                                       TO ASC-LINE                13640000
136500               MOVE SU039-SKU (ASC-SEL-SUB)                       13650000
136600                                       TO ASC-SKU                 13660000
136700               MOVE SU039-UPC (ASC-SEL-SUB)                       13670000
136800                                       TO ASC-UPC                 13680000
136900               MOVE SU039-NET-ADJ (ASC-SEL-SUB)                   13690000
137000                                       TO ASC-NET-ADJ             13700000
137100               MOVE SU039-ADJ-SOURCE (ASC-SEL-SUB)                13710000
137200                                       TO ASC-ADJ-SOURCE          13720000
137300               MOVE SU039-FAIL-SUCCSS(ASC-SEL-SUB)                13730000
137400                                       TO ASC-FAIL-SUCCESS-IND    13740000
137500               MOVE SU039-PROCESS-GROUP(ASC-SEL-SUB)              13750000
137600                                       TO  ASC-PROCESS-GROUP      13760000
137700               MOVE SU039-PROCESS-GRP-DESC(ASC-SEL-SUB)           13770000
137800                                       TO ASC-PROCESS-GRP-DESC    13780000
137900               MOVE SU039-ACKNOWLEDGE(ASC-SEL-SUB)                13790000
138000                                       TO ASC-ACKNOWLEDGED        13800000
138100            END-IF                                                13810000
138200            SET SU039-INQ (ASC-SEL-SUB) TO TRUE                   13820000
138300            PERFORM 9200-REWRITE-SEL-QUEUE                        13830000
138400         ELSE                                                     13840000
138500             SUBTRACT +1 FROM ASC-SEL-SUB                         13850000
138600             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             13860000
138700             SET DP020-MSG-INFORMATIONAL                          13870000
138800                 PS-LIST-END             TO TRUE                  13880000
138900         END-IF                                                   13890000
139000     ELSE                                                         13900000
139100         SUBTRACT +1 FROM ASC-SEL-ITEM                            13910000
139200         MOVE SU039-MAX-ITEMS     TO ASC-SEL-SUB                  13920000
139300         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             13930000
139400         SET DP020-MSG-INFORMATIONAL                              13940000
139500             PS-LIST-END             TO TRUE                      13950000
139600     END-IF.                                                      13960000
139700                                                                  13970000
139800*----------------------------------------------------------------*13980000
139900*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *13990000
140000*    PROCESSED.                                                  *14000000
140100*----------------------------------------------------------------*14010000
140200 1140-GET-PREV-RECORD.                                            14020000
140300     SUBTRACT +1 FROM ASC-SEL-SUB.                                14030000
140400                                                                  14040000
140500     IF  ASC-SEL-SUB < +1                                         14050000
140600         SUBTRACT +1 FROM ASC-SEL-ITEM                            14060000
140700         MOVE SU039-MAX-ITEMS     TO ASC-SEL-SUB                  14070000
140800     END-IF.                                                      14080000
140900                                                                  14090000
141000     IF  ASC-SEL-ITEM > ZERO                                      14100000
141100         PERFORM 9100-READ-SEL-QUEUE                              14110000
141200         IF SU039-OPER-UNT-ID(ASC-SEL-SUB) = ZEROES               14120000
141300            MOVE SU039-LINE (ASC-SEL-SUB)    TO ASC-LINE          14130000
141400         ELSE                                                     14140000
141500            MOVE SU039-OPER-UNT-ID(ASC-SEL-SUB)                   14150000
141600                                             TO ASC-OPER-UNT-ID   14160000
141700            MOVE SU039-PO-RCVR (ASC-SEL-SUB) TO ASC-PO-RCVR-13    14170000
141800            MOVE ASC-PO-Z                    TO ASC-PO            14180000
141900            MOVE ASC-RCVR-Z                  TO ASC-RCVR          14190000
142000            MOVE SU039-LINE (ASC-SEL-SUB)    TO ASC-LINE          14200000
142100            MOVE SU039-SKU (ASC-SEL-SUB)     TO ASC-SKU           14210000
142200            MOVE SU039-UPC (ASC-SEL-SUB)     TO ASC-UPC           14220000
142300            MOVE SU039-NET-ADJ (ASC-SEL-SUB) TO ASC-NET-ADJ       14230000
142400            MOVE SU039-ADJ-SOURCE (ASC-SEL-SUB) TO ASC-ADJ-SOURCE 14240000
142500            MOVE SU039-FAIL-SUCCSS(ASC-SEL-SUB) TO                14250000
142600                                            ASC-FAIL-SUCCESS-IND  14260000
142700            MOVE SU039-PROCESS-GROUP(ASC-SEL-SUB) TO              14270000
142800                                            ASC-PROCESS-GROUP     14280000
142900            MOVE SU039-PROCESS-GRP-DESC(ASC-SEL-SUB) TO           14290000
143000                                      ASC-PROCESS-GRP-DESC        14300000
143100           MOVE SU039-ACKNOWLEDGE(ASC-SEL-SUB) TO ASC-ACKNOWLEDGED14310000
143200         END-IF                                                   14320000
143300         SET SU039-INQ (ASC-SEL-SUB) TO TRUE                      14330000
143400         PERFORM 9200-REWRITE-SEL-QUEUE                           14340000
143500     ELSE                                                         14350000
143600         MOVE +1                  TO ASC-SEL-ITEM                 14360000
143700                                     ASC-SEL-SUB                  14370000
143800         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             14380000
143900         SET DP020-MSG-INFORMATIONAL                              14390000
144000             PS-LIST-END             TO TRUE                      14400000
144100     END-IF.                                                      14410000
144200                                                                  14420000
144300*----------------------------------------------------------------*14430000
144400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *14440000
144500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *14450000
144600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *14460000
144700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *14470000
144800* FUNCTION KEYS CAN GET THIS FAR.                                *14480000
144900*----------------------------------------------------------------*14490000
145000 2000-PROCESS-PANEL.                                              14500000
145100     EVALUATE TRUE                                                14510000
145200         WHEN DP020-SRC-AID = DP016-CLEAR                         14520000
145300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    14530000
145400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14540000
145500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14550000
145600                                                                  14560000
145700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    14570000
145800             MOVE ZEROES TO ASC-TOTAL-NET-ADJUST                  14580000
145900             PERFORM 2050-DELETE-LIST-QUEUE                       14590000
146000             PERFORM 4000-BUILD-INITIAL-PANEL                     14600000
146100                                                                  14610000
146200         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    14620000
146300             PERFORM 2140-DESELECT-ALL-ITEMS                      14630000
146400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14640000
146500                                                                  14650000
146600         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  14660000
146700             PERFORM 2150-SELECT-ALL-ITEMS                        14670000
146800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14680000
146900                                                                  14690000
147000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             14700000
147100             MOVE ZEROES TO ASC-TOTAL-NET-ADJUST                  14710000
147200             IF  ASC-USE-SELECTION-QUEUE                          14720000
147300                 PERFORM 1130-GET-NEXT-RECORD                     14730000
147400                 IF PS-LIST-END                                   14740000
147500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14750000
147600                     SET PS-NO-LIST-END TO TRUE                   14760000
147700                 ELSE                                             14770000
147800                     PERFORM 2050-DELETE-LIST-QUEUE               14780000
147900                     PERFORM 3200-RESET-ATTRIBUTES                14790000
148000                     PERFORM 4000-BUILD-INITIAL-PANEL             14800000
148100                 END-IF                                           14810000
148200              ELSE                                                14820000
148300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14830000
148400*                --- BOTTOM OF LIST ---                           14840000
148500                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         14850000
148600                 SET DP020-MSG-INFORMATIONAL TO TRUE              14860000
148700             END-IF                                               14870000
148800                                                                  14880000
148900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             14890000
149000             MOVE ZEROES TO ASC-TOTAL-NET-ADJUST                  14900000
149100             IF  ASC-USE-SELECTION-QUEUE                          14910000
149200                 PERFORM 1140-GET-PREV-RECORD                     14920000
149300                 IF PS-LIST-END                                   14930000
149400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14940000
149500                     SET PS-NO-LIST-END TO TRUE                   14950000
149600                 ELSE                                             14960000
149700                     PERFORM 2050-DELETE-LIST-QUEUE               14970000
149800                     PERFORM 3200-RESET-ATTRIBUTES                14980000
149900                     PERFORM 4000-BUILD-INITIAL-PANEL             14990000
150000                 END-IF                                           15000000
150100             ELSE                                                 15010000
150200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15020000
150300                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         15030000
150400                 SET DP020-MSG-INFORMATIONAL TO TRUE              15040000
150500             END-IF                                               15050000
150600                                                                  15060000
150700         WHEN OTHER                                               15070000
150800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 15080000
150810             IF  PS-NO-ERROR                                      15081005
150900                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               15090005
150910             END-IF                                               15091005
151000                                                                  15100000
151100             IF  PS-NO-ERROR                                      15110000
151200                 SET DP030-CONTINUE-GO TO TRUE                    15120000
151300                 PERFORM 2100-CHECK-FUNCTION-KEY                  15130000
151400             ELSE                                                 15140000
151500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15150000
151600                 SET DP030-OVERRIDE-GO TO TRUE                    15160000
151700             END-IF                                               15170000
151800     END-EVALUATE.                                                15180000
151900                                                                  15190000
152000*----------------------------------------------------------------*15200000
152100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *15210000
152200*----------------------------------------------------------------*15220000
152300 2050-DELETE-LIST-QUEUE.                                          15230000
152400                                                                  15240000
152500     EXEC CICS                                                    15250000
152600         DELETEQ TS                                               15260000
152700             QUEUE (ASC-LIST-QUEUE-NAME)                          15270000
152800             RESP  (PV-CICS-RESP)                                 15280000
152900     END-EXEC.                                                    15290000
153000                                                                  15300000
153100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15310000
153200        (PV-CICS-RESP = DFHRESP(QIDERR))                          15320000
153300         CONTINUE                                                 15330000
153400     ELSE                                                         15340000
153500         SET DP013-CICS-ABEND      TO TRUE                        15350000
153600         SET DP013-NO-ROLLBACK     TO TRUE                        15360000
153700                                                                  15370000
153800         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         15380000
153900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    15390000
154000                                   TO DP013-MESSAGE-TEXT (1)      15400000
154100         PERFORM DP013-0000-PROCESS-ABEND                         15410000
154200     END-IF.                                                      15420000
154300                                                                  15430000
154400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  15440000
154500                                                                  15450000
154600*----------------------------------------------------------------*15460000
154700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*15470000
154800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *15480000
154900* CICS ARCHITECTURE API.                                         *15490000
155000*----------------------------------------------------------------*15500000
155100 2100-CHECK-FUNCTION-KEY.                                         15510000
155200                                                                  15520000
155300     EVALUATE TRUE                                                15530000
155400                                                                  15540000
155500*F24 = STORE UNIT ADJUSTMENT TRANSACTION LIST                     15550000
155600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              15560000
155700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15570000
155800                     INITIALIZE SU038-INTER-APPL-COMMAREA         15580004
155900                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            15590004
156000                                 TO SU038-NUMBER-OF-SELECTED-ITEMS15600000
156100                     MOVE ASC-UNT-ADJ-TYP                         15610004
156110                                           TO SU038-UNT-ADJ-TYP   15611004
156200                     MOVE ASC-FAIL-SUCCESS-IND                    15620004
156210                                           TO SU038-FAIL-SUCCSS   15621004
156300                     MOVE ASC-PROCESS-GROUP                       15630004
156310                                           TO SU038-PROCESS-GROUP 15631004
156400                     MOVE ASC-PROCESS-GRP-DESC TO                 15640004
156500                                           SU038-PROCESS-GRP-DESC 15650000
156600                     MOVE ASC-STR-NBR      TO SU038-STR-NBR       15660004
156700                     MOVE ASC-AUDIT-NBR    TO SU038-AUDIT         15670004
156800                     MOVE ASC-FROM-DATE    TO SU038-FROM-DATE     15680004
156900                     MOVE ASC-TO-DATE      TO SU038-TO-DATE       15690004
157000                     MOVE ASC-NET-ADJ      TO SU038-TOT-NET-ADJ   15700004
157100                     PERFORM 5000-PREPARE-SEL-QUEUE               15710004
157200             ELSE                                                 15720006
157300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15730000
157400                 SET DP030-OVERRIDE-GO TO TRUE                    15740000
157500                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         15750000
157600                 SET DP020-MSG-WARNING TO TRUE                    15760000
157700             END-IF                                               15770005
157800                                                                  15780000
157900*                                                                 15790000
158000* F6 - FIRST PAGE                                                 15800000
158100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  15810000
158200             MOVE +1               TO PV-TOP-ITEM                 15820000
158300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15830000
158400*                                                                 15840000
158500* F7 - PREVIOUS PAGE                                              15850000
158600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   15860000
158700             PERFORM 2110-BROWSE-BACKWARD                         15870000
158800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15880000
158900*                                                                 15890000
159000* F8 - NEXT PAGE                                                  15900000
159100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   15910000
159200             PERFORM 2120-BROWSE-FORWARD                          15920000
159300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15930000
159400*                                                                 15940000
159500* ENTER KEY                                                       15950000
159600         WHEN DP020-SRC-AID = DP016-ENTER                         15960000
159700             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15970000
159800             IF  PS-ERROR                                         15980000
159900                 CONTINUE                                         15990000
160000             ELSE                                                 16000000
160100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16010000
160200             END-IF                                               16020000
160300                                                                  16030000
160400         WHEN OTHER                                               16040000
160500             SET DP013-NO-ROLLBACK                                16050000
160600                 DP013-XCTL-DISPLAY-RESTART                       16060000
160700                 DP013-CICS-ABEND  TO TRUE                        16070000
160800             MOVE '2100-CHECK-FUNCTION-KEY'                       16080000
160900                                   TO DP013-PARAGRAPH             16090000
161000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      16100000
161100                                   TO DP013-MESSAGE-TEXT (1)      16110000
161200             PERFORM DP013-0000-PROCESS-ABEND                     16120000
161300     END-EVALUATE.                                                16130000
161400*                                                                 16140000
161500*----------------------------------------------------------------*16150000
161600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16160000
161700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16170000
161800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16180000
161900*    MESSAGE.                                                    *16190000
162000*----------------------------------------------------------------*16200000
162100 2110-BROWSE-BACKWARD.                                            16210000
162200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    16220000
162300         GIVING PV-TOP-ITEM.                                      16230000
162400*                                                                 16240000
162500     IF  ((PV-TOP-ITEM < +1)                                      16250000
162600       OR (PV-TOP-ITEM = +1))                                     16260000
162700         MOVE +1                   TO PV-TOP-ITEM                 16270000
162800*        -- TOP OF LIST --                                        16280000
162900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16290000
163000         SET DP020-MSG-INFORMATIONAL TO TRUE                      16300000
163100     END-IF.                                                      16310000
163200                                                                  16320000
163300*----------------------------------------------------------------*16330000
163400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *16340000
163500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *16350000
163600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *16360000
163700*----------------------------------------------------------------*16370000
163800 2120-BROWSE-FORWARD.                                             16380000
163900                                                                  16390000
164000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              16400000
164100         GIVING PV-TOP-ITEM.                                      16410000
164200     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   16420000
164300         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             16430000
164400*        -- BOTTOM OF LIST --                                     16440000
164500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16450000
164600         SET DP020-MSG-INFORMATIONAL  TO TRUE                     16460000
164700     ELSE                                                         16470000
164800         COMPUTE PV-BOTTOM-ITEM =                                 16480000
164900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16490000
165000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16500000
165100*            -- BOTTOM OF LIST --                                 16510000
165200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16520000
165300             SET DP020-MSG-INFORMATIONAL TO TRUE                  16530000
165400         END-IF                                                   16540000
165500     END-IF.                                                      16550000
165600                                                                  16560000
165700*----------------------------------------------------------------*16570000
165800*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16580000
165900*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16590000
166000*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *16600000
166100*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *16610000
166200*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *16620000
166300*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *16630000
166400*----------------------------------------------------------------*16640000
166500 2130-CHECK-FOR-JUMP-BROWSE.                                      16650000
166600     SET PS-NO-ERROR               TO TRUE.                       16660000
166700     IF (ASC-START-ITEM-REQUEST = SPACE)                          16670000
166800         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             16680000
166900     ELSE                                                         16690000
167000         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     16700000
167100         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   16710000
167200         MOVE LENGTH OF ASC-START-ITEM-REQUEST TO                 16720000
167300                                             DP010I-MAXIMUM-DIGITS16730000
167400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16740000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16751007
263968              USING DP010I-NUMERIC-EDIT-AREA                      16752007
167600                                                                  16760000
167700         IF  NOT DP010I-ERROR-DETECTED                            16770000
167800             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N16780000
167900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  16790000
168000                 IF  ASC-START-ITEM-REQUEST-N >                   16800000
168100                                          ASC-NUMBER-OF-ITEMS-READ16810000
168200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         16820000
168300                     COMPUTE PV-TOP-ITEM =                        16830000
168400                             ASC-NUMBER-OF-ITEMS-READ             16840000
168500                             - PC-ITEMS-PER-PANEL + 1             16850000
168600                     IF  PV-TOP-ITEM < +1                         16860000
168700                         MOVE +1   TO PV-TOP-ITEM                 16870000
168800                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 16880000
168900                         SET DP020-MSG-INFORMATIONAL TO TRUE      16890000
169000                     ELSE                                         16900000
169100                         MOVE  PV-TOP-ITEM                        16910000
169200                           TO  ASC-START-ITEM-REQUEST-N           16920000
169300                     END-IF                                       16930000
169400                 ELSE                                             16940000
169500                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 16950000
169600                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      16960000
169700                     COMPUTE PV-BOTTOM-ITEM =                     16970000
169800                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16980000
169900                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16990000
170000                         SUBTRACT  PV-TOP-ITEM                    17000000
170100                             FROM  ASC-NUMBER-OF-ITEMS-READ       17010000
170200                           GIVING  ASC-ITEMS-DISPLAYED            17020000
170300                         MOVE  ASC-NUMBER-OF-ITEMS-READ           17030000
170400                           TO  PV-BOTTOM-ITEM                     17040000
170500*                        -- BOTTOM OF LIST --                     17050000
170600                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 17060000
170700                         SET DP020-MSG-INFORMATIONAL TO TRUE      17070000
170800                     END-IF                                       17080000
170900                 END-IF                                           17090000
171000             ELSE                                                 17100000
171100*                --- VALUE OUT OF RANGE ----                      17110000
171200                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        17120000
171300                 MOVE -1           TO ASTRTITL                    17130000
171400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17140000
171500                 MOVE DP015-REVERSE TO ASTRTITH                   17150000
171600                 MOVE DP015-RED    TO ASTRTITC                    17160000
171700                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           17170000
171800                 SET DP020-MSG-FATAL                              17180000
171900                     PS-ERROR        TO TRUE                      17190000
172000             END-IF                                               17200000
172100         ELSE                                                     17210000
172200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17220000
172300             MOVE -1               TO ASTRTITL                    17230000
172400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17240000
172500             MOVE DP015-REVERSE    TO ASTRTITH                    17250000
172600             MOVE DP015-RED        TO ASTRTITC                    17260000
172700             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               17270000
172800             SET DP020-MSG-FATAL   TO TRUE                        17280000
172900             SET PS-ERROR          TO TRUE                        17290000
173000         END-IF                                                   17300000
173100     END-IF.                                                      17310000
173200                                                                  17320000
173300*----------------------------------------------------------------*17330000
173400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *17340000
173500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *17350000
173600*----------------------------------------------------------------*17360000
173700 2140-DESELECT-ALL-ITEMS.                                         17370000
173800     MOVE +1                       TO ASC-BLK-SUB.                17380000
173900                                                                  17390000
174000     PERFORM 2141-CLEAR-SELECTED-INDS                             17400000
174100         VARYING ASC-ITEM-SUB                                     17410000
174200         FROM 1 BY 1                                              17420000
174300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17430000
174400                                                                  17440000
174500     ADD +1                        TO ASC-BLK-SUB.                17450000
174600                                                                  17460000
174700     PERFORM 2141-CLEAR-SELECTED-INDS                             17470000
174800         VARYING ASC-ITEM-SUB                                     17480000
174900         FROM 1 BY 1                                              17490000
175000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17500000
175100                                                                  17510000
175200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17520000
175300                                   TO PV-LIST-ITEM-NUMBER.        17530000
175400                                                                  17540000
175500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17550000
175600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17560000
175700                                                                  17570000
175800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17580000
175900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      17590000
176000         MOVE +1                   TO ASC-BLK-SUB                 17600000
176100                                                                  17610000
176200         PERFORM 5100-WRITE-TEMP-STORAGE                          17620000
176300         MOVE +2                   TO ASC-BLK-SUB                 17630000
176400         PERFORM 5100-WRITE-TEMP-STORAGE                          17640000
176500         MOVE +1                   TO ASC-BLK-SUB                 17650000
176600                                                                  17660000
176700                                                                  17670000
176800         MOVE +1                   TO PV-BLOCK-NUMBER             17680000
176900                                                                  17690000
177000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17700000
177100             PV-FIRST-BLOCK-IN-ARRAY - 1                          17710000
177200                                                                  17720000
177300         PERFORM                                                  17730000
177400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17740000
177500                                                                  17750000
177600             PERFORM 4410-READ-TEMP-STORAGE                       17760000
177700                                                                  17770000
177800             PERFORM 2141-CLEAR-SELECTED-INDS                     17780000
177900                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 17790000
178000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17800000
178100                                                                  17810000
178200             PERFORM 5100-WRITE-TEMP-STORAGE                      17820000
178300                                                                  17830000
178400             ADD +1                TO PV-BLOCK-NUMBER             17840000
178500                                                                  17850000
178600         END-PERFORM                                              17860000
178700                                                                  17870000
178800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17880000
178900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17890000
179000                                                                  17900000
179100         PERFORM                                                  17910000
179200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17920000
179300                   ASC-HIGHEST-BLOCK-WRITTEN                      17930000
179400                                                                  17940000
179500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17950000
179600                                   TO PV-BLOCK-NUMBER             17960000
179700                                                                  17970000
179800             PERFORM 4410-READ-TEMP-STORAGE                       17980000
179900                                                                  17990000
180000             PERFORM 2141-CLEAR-SELECTED-INDS                     18000000
180100                 VARYING ASC-ITEM-SUB                             18010000
180200                 FROM 1 BY 1                                      18020000
180300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18030000
180400                                                                  18040000
180500             PERFORM 5100-WRITE-TEMP-STORAGE                      18050000
180600                                                                  18060000
180700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18070000
180800                                                                  18080000
180900         END-PERFORM                                              18090000
181000                                                                  18100000
181100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18110000
181200                                   TO PV-BLOCK-NUMBER             18120000
181300                                                                  18130000
181400         PERFORM 4410-READ-TEMP-STORAGE                           18140000
181500     END-IF.                                                      18150000
181600                                                                  18160000
181700                                                                  18170000
181800     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 18180000
181900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.18190000
182000     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  18200000
182100                                                                  18210000
182200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18220000
182300                                                                  18230000
182400 EJECT                                                            18240000
182500*----------------------------------------------------------------*18250000
182600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *18260000
182700*----------------------------------------------------------------*18270000
182800                                                                  18280000
182900 2141-CLEAR-SELECTED-INDS.                                        18290000
183000                                                                  18300000
183100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18310000
183200             NOT EQUAL ZERO                                       18320000
183300         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18330000
183400             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18340000
183500                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    18350000
183600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18360000
183700                                   TO TRUE                        18370000
183800         END-IF                                                   18380000
183900     END-IF.                                                      18390000
184000                                                                  18400000
184100 EJECT                                                            18410000
184200*----------------------------------------------------------------*18420000
184300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *18430000
184400*  FOR ALL ITEMS.                                                *18440000
184500*----------------------------------------------------------------*18450000
184600                                                                  18460000
184700 2150-SELECT-ALL-ITEMS.                                           18470000
184800                                                                  18480000
184900     MOVE +1                       TO ASC-BLK-SUB.                18490000
185000                                                                  18500000
185100     PERFORM 2151-SET-SELECTED-INDS                               18510000
185200         VARYING ASC-ITEM-SUB                                     18520000
185300         FROM 1 BY 1                                              18530000
185400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18540000
185500                                                                  18550000
185600     ADD +1                        TO ASC-BLK-SUB.                18560000
185700                                                                  18570000
185800     PERFORM 2151-SET-SELECTED-INDS                               18580000
185900         VARYING ASC-ITEM-SUB                                     18590000
186000         FROM 1 BY 1                                              18600000
186100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18610000
186200                                                                  18620000
186300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18630000
186400                                   TO PV-LIST-ITEM-NUMBER.        18640000
186500                                                                  18650000
186600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18660000
186700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18670000
186800*                                                                 18680000
186900     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            18690000
187000         MOVE +1                   TO ASC-BLK-SUB                 18700000
187100                                                                  18710000
187200         PERFORM 5100-WRITE-TEMP-STORAGE                          18720000
187300         MOVE +2                   TO ASC-BLK-SUB                 18730000
187400         PERFORM 5100-WRITE-TEMP-STORAGE                          18740000
187500         MOVE +1                   TO ASC-BLK-SUB                 18750000
187600         MOVE +1                   TO PV-BLOCK-NUMBER             18760000
187700     END-IF.                                                      18770000
187800                                                                  18780000
187900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18790000
188000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18800000
188100         MOVE +1                   TO ASC-BLK-SUB                 18810000
188200                                                                  18820000
188300         PERFORM 5100-WRITE-TEMP-STORAGE                          18830000
188400         MOVE +2                   TO ASC-BLK-SUB                 18840000
188500         PERFORM 5100-WRITE-TEMP-STORAGE                          18850000
188600         MOVE +1                   TO ASC-BLK-SUB                 18860000
188700                                                                  18870000
188800         MOVE +1                   TO PV-BLOCK-NUMBER             18880000
188900                                                                  18890000
189000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18900000
189100             PV-FIRST-BLOCK-IN-ARRAY - 1                          18910000
189200                                                                  18920000
189300         PERFORM                                                  18930000
189400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18940000
189500                                                                  18950000
189600             PERFORM 4410-READ-TEMP-STORAGE                       18960000
189700                                                                  18970000
189800             PERFORM 2151-SET-SELECTED-INDS                       18980000
189900                 VARYING ASC-ITEM-SUB                             18990000
190000                 FROM 1 BY 1                                      19000000
190100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19010000
190200                                                                  19020000
190300             PERFORM 5100-WRITE-TEMP-STORAGE                      19030000
190400                                                                  19040000
190500             ADD +1                TO PV-BLOCK-NUMBER             19050000
190600                                                                  19060000
190700         END-PERFORM                                              19070000
190800                                                                  19080000
190900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19090000
191000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19100000
191100                                                                  19110000
191200         PERFORM                                                  19120000
191300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19130000
191400                   ASC-HIGHEST-BLOCK-WRITTEN                      19140000
191500                                                                  19150000
191600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19160000
191700                                   TO PV-BLOCK-NUMBER             19170000
191800                                                                  19180000
191900             PERFORM 4410-READ-TEMP-STORAGE                       19190000
192000                                                                  19200000
192100             PERFORM 2151-SET-SELECTED-INDS                       19210000
192200                 VARYING ASC-ITEM-SUB                             19220000
192300                 FROM 1 BY 1                                      19230000
192400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19240000
192500                                                                  19250000
192600             PERFORM 5100-WRITE-TEMP-STORAGE                      19260000
192700                                                                  19270000
192800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19280000
192900                                                                  19290000
193000         END-PERFORM                                              19300000
193100                                                                  19310000
193200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19320000
193300                                   TO PV-BLOCK-NUMBER             19330000
193400                                                                  19340000
193500         PERFORM 4410-READ-TEMP-STORAGE                           19350000
193600     END-IF.                                                      19360000
193700                                                                  19370000
193800                                                                  19380000
193900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             19390000
194000                       ASC-NUMBER-OF-SELECTED-ITEMS.              19400000
194100                                                                  19410000
194200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19420000
194300                                                                  19430000
194400 EJECT                                                            19440000
194500*----------------------------------------------------------------*19450000
194600*    MARK EACH ITEM AS BEING SELECTED.                           *19460000
194700*----------------------------------------------------------------*19470000
194800                                                                  19480000
194900 2151-SET-SELECTED-INDS.                                          19490000
195000                                                                  19500000
195100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19510000
195200             NOT EQUAL ZERO                                       19520000
195300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19530000
195400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19540000
195500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        19550000
195600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19560000
195700                               TO  TRUE                           19570000
195800         END-IF                                                   19580000
195900     END-IF.                                                      19590000
196000******************************************************************19600000
196100** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **19610000
196200** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **19620000
196300******************************************************************19630000
196400 2200-MOVE-SCREEN-TO-COMMAREA.                                    19640000
196500                                                                  19650000
196600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             19660000
196700     MOVE +1                       TO PV-SUB.                     19670000
196800*                                                                 19680000
196900     PERFORM 3100-SET-SUBSCRIPTS.                                 19690000
197000     IF  ASTRTITL > ZERO                                          19700000
197100         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          19710000
197200     ELSE                                                         19720000
197300         IF  ASTRTITF = DP015-ERASE-EOF                           19730000
197400             INITIALIZE ASC-START-ITEM-REQUEST                    19740000
197500         END-IF                                                   19750000
197600     END-IF.                                                      19760000
197700                                                                  19770000
197710     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  AND              19771005
197711         ASC-NUMBER-OF-ITEMS-READ  =  0  AND                      19771105
197712         ASC-END-OF-SELECTED-RANGE =  0                           19771205
197713         PERFORM                                                  19771305
197714             VARYING PV-SUB                                       19771405
197715                FROM 1 BY 1                                       19771505
197716               UNTIL PV-SUB > PC-ITEMS-PER-PANEL                  19771605
197717                MOVE DP015-ASK-DRK-OFF                            19771705
197718                                       TO MR-SELECTA (PV-SUB)     19771805
197719         END-PERFORM                                              19771905
197720         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               19772005
197721         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19772105
197723         SET  PS-NO-ERROR      TO  TRUE                           19772305
197730     ELSE                                                         19773005
197800         PERFORM 2210-MOVE-LINES-TO-COMMAREA                      19780005
197900             VARYING PV-SUB                                       19790005
198000             FROM 1 BY 1                                          19800005
198100             UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                   19810005
198110     END-IF.                                                      19811005
198200******************************************************************19820000
198300** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**19830000
198400******************************************************************19840000
198500 2210-MOVE-LINES-TO-COMMAREA.                                     19850000
198600     IF  MR-SELECTL (PV-SUB) > ZERO                               19860000
198700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19870000
198800         MOVE MR-SELECTI (PV-SUB)                                 19880000
198900                                   TO ASC-TEMP-SELECTED-SW        19890000
199000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19900000
199100     ELSE                                                         19910000
199200         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19920000
199300                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19930000
199400                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        19940000
199500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19950000
199600         END-IF                                                   19960000
199700     END-IF.                                                      19970000
199800                                                                  19980000
199900     ADD +1                        TO ASC-ITEM-SUB.               19990000
200000                                                                  20000000
200100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20010000
200200         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     20020000
200300             COMPUTE PV-BLOCK-NUMBER  =                           20030000
200400                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         20040000
200500                    PC-ITEMS-PER-PANEL                            20050000
200600             PERFORM 5105-REWRITE-ASC-LISTQ                       20060000
200700         END-IF                                                   20070000
200800         ADD +1                    TO ASC-BLK-SUB                 20080000
200900         MOVE +1                   TO ASC-ITEM-SUB                20090000
201000     ELSE                                                         20100000
201100     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             20110000
201200         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     20120000
201300             COMPUTE PV-BLOCK-NUMBER  =                           20130000
201400                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         20140000
201500                    PC-ITEMS-PER-PANEL                            20150000
201600             PERFORM 5105-REWRITE-ASC-LISTQ                       20160000
201700         END-IF                                                   20170000
201800     END-IF.                                                      20180000
201900******************************************************************20190000
202000** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **20200000
202100** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **20210000
202200******************************************************************20220000
202300 3000-EDIT-DATA-IN-COMMAREA.                                      20230000
202400     SET PS-NO-ERROR               TO TRUE.                       20240000
202500     PERFORM 3200-RESET-ATTRIBUTES.                               20250000
202600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     20260000
202700                                                                  20270000
202800**                                                                20280000
202900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              20290000
203000* EDITTING IS DONE FROM THE BOTTOM UP.                            20300000
203100**                                                                20310000
203200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       20320000
203300         ASC-ITEMS-DISPLAYED - 1.                                 20330000
203400     PERFORM 3100-SET-SUBSCRIPTS.                                 20340000
203500*                                                                 20350000
203600     IF  PS-NO-ERROR                                              20360000
203700         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        20370000
203800     END-IF.                                                      20380000
203900                                                                  20390000
204000     IF  PS-NO-ERROR                                              20400000
204100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20410000
204200     END-IF.                                                      20420000
204300*                                                                 20430000
204400     IF  ((PS-NO-ERROR)                                           20440000
204500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   20450000
204600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    20460000
204700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  20470000
204800     END-IF.                                                      20480000
204900                                                                  20490000
205000*----------------------------------------------------------------*20500000
205100*   3005-EDIT-COMMAREA-BLOCKS                                    *20510000
205200*----------------------------------------------------------------*20520000
205300 3005-EDIT-COMMAREA-BLOCKS.                                       20530000
205400     MOVE +1                       TO PV-BLOCK-NUMBER.            20540000
205500     MOVE +1                       TO ASC-BLK-SUB.                20550000
205600     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               20560000
205700                                                                  20570000
205800     COMPUTE PV-BLOCK-NUMBER  =                                   20580000
205900        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 20590000
206000            PC-ITEMS-PER-PANEL.                                   20600000
206100                                                                  20610000
206200     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          20620000
206300                                                                  20630000
206400     PERFORM                                                      20640000
206500       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          20650000
206600          OR PS-ERROR                                             20660000
206700          OR PS-BLOCK-ERROR                                       20670000
206800                                                                  20680000
206900             COMPUTE PV-ITEMS-HOLD  =                             20690000
207000                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        20700000
207100                     PC-ITEMS-PER-PANEL - 1                       20710000
207200                                                                  20720000
207300             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       20730000
207400                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               20740000
207500                     FROM  PV-ITEMS-HOLD                          20750000
207600                   GIVING  PV-ITEMS-DIFF                          20760000
207700                 SUBTRACT  PV-ITEMS-DIFF                          20770000
207800                     FROM  PC-ITEMS-PER-PANEL                     20780000
207900                   GIVING  PV-ITEMS-HOLD                          20790000
208000                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              20800000
208100                                              ASC-ITEM-SUB        20810000
208200                                              ASC-ITEMS-DISPLAYED 20820000
208300             ELSE                                                 20830000
208400                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              20840000
208500                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        20850000
208600             END-IF                                               20860000
208700                                                                  20870000
208800             PERFORM 3300-EDIT-SELECTIONS                         20880000
208900                     VARYING PV-SUB                               20890000
209000                        FROM PV-SUB BY -1                         20900000
209100                       UNTIL PV-SUB < +1                          20910000
209200                                                                  20920000
209300             MOVE +1               TO ASC-BLK-SUB                 20930000
209400                                                                  20940000
209500             PERFORM 5105-REWRITE-ASC-LISTQ                       20950000
209600                                                                  20960000
209700             MOVE +1                TO ASC-BLK-SUB                20970000
209800                                                                  20980000
209900             IF  PS-BLOCK-ERROR                                   20990000
210000                 SET  PS-ERROR     TO TRUE                        21000000
210100                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        21010000
210200                                   TO PV-TOP-ITEM                 21020000
210300             ELSE                                                 21030000
210400                 ADD  +1           TO PV-BLOCK-NUMBER             21040000
210500                 IF  PV-BLOCK-NUMBER >                            21050000
210600                     ASC-HIGHEST-BLOCK-WRITTEN                    21060000
210700                     MOVE +2       TO ASC-BLK-SUB                 21070000
210800                     PERFORM 4410-READ-TEMP-STORAGE               21080000
210900                     MOVE +1       TO ASC-BLK-SUB                 21090000
211000                 ELSE                                             21100000
211100                     PERFORM 4410-READ-TEMP-STORAGE               21110000
211200                     ADD  +1        TO PV-BLOCK-NUMBER            21120000
211300                     MOVE +2        TO ASC-BLK-SUB                21130000
211400                     PERFORM 4410-READ-TEMP-STORAGE               21140000
211500                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            21150000
211600                     MOVE +1        TO ASC-BLK-SUB                21160000
211700                 END-IF                                           21170000
211800             END-IF                                               21180000
211900     END-PERFORM.                                                 21190000
212000                                                                  21200000
212100     IF  PV-ORIGINAL-BLOCK  = +1    OR                            21210000
212200         PS-ERROR                   OR                            21220000
212300         PS-BLOCK-ERROR                                           21230000
212400         CONTINUE                                                 21240000
212500     ELSE                                                         21250000
212600         MOVE +1                 TO PV-BLOCK-NUMBER               21260000
212700         MOVE +1                 TO ASC-BLK-SUB                   21270000
212800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  21280000
212900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           21290000
213000         PERFORM 4410-READ-TEMP-STORAGE                           21300000
213100                                                                  21310000
213200         PERFORM                                                  21320000
213300           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              21330000
213400              OR PS-ERROR                                         21340000
213500              OR PS-BLOCK-ERROR                                   21350000
213600                                                                  21360000
213700                 COMPUTE PV-ITEMS-HOLD  =                         21370000
213800                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    21380000
213900                         PC-ITEMS-PER-PANEL - 1                   21390000
214000                                                                  21400000
214100                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     21410000
214200                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           21420000
214300                         FROM  PV-ITEMS-HOLD                      21430000
214400                       GIVING  PV-ITEMS-DIFF                      21440000
214500                     SUBTRACT  PV-ITEMS-DIFF                      21450000
214600                         FROM  PC-ITEMS-PER-PANEL                 21460000
214700                       GIVING  PV-ITEMS-HOLD                      21470000
214800                         MOVE  PV-ITEMS-HOLD TO PV-SUB            21480000
214900                                                ASC-ITEM-SUB      21490000
215000                                               ASC-ITEMS-DISPLAYED21500000
215100                 ELSE                                             21510000
215200                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          21520000
215300                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    21530000
215400                 END-IF                                           21540000
215500                                                                  21550000
215600                 PERFORM 3300-EDIT-SELECTIONS                     21560000
215700                         VARYING PV-SUB                           21570000
215800                            FROM PV-SUB BY -1                     21580000
215900                           UNTIL PV-SUB < +1                      21590000
216000                                                                  21600000
216100                 MOVE +1               TO ASC-BLK-SUB             21610000
216200                                                                  21620000
216300                 PERFORM 5105-REWRITE-ASC-LISTQ                   21630000
216400                                                                  21640000
216500                 MOVE +1                TO ASC-BLK-SUB            21650000
216600                                                                  21660000
216700                 IF  PS-BLOCK-ERROR                               21670000
216800                     SET  PS-ERROR     TO TRUE                    21680000
216900                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    21690000
217000                                       TO PV-TOP-ITEM             21700000
217100                 ELSE                                             21710000
217200                     ADD  +1            TO PV-BLOCK-NUMBER        21720000
217300                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      21730000
217400                         MOVE +2        TO ASC-BLK-SUB            21740000
217500                         PERFORM 4410-READ-TEMP-STORAGE           21750000
217600                         MOVE +1        TO ASC-BLK-SUB            21760000
217700                     ELSE                                         21770000
217800                         PERFORM 4410-READ-TEMP-STORAGE           21780000
217900                         ADD  +1        TO PV-BLOCK-NUMBER        21790000
218000                         MOVE +2        TO ASC-BLK-SUB            21800000
218100                         PERFORM 4410-READ-TEMP-STORAGE           21810000
218200                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        21820000
218300                         MOVE +1        TO ASC-BLK-SUB            21830000
218400                     END-IF                                       21840000
218500                 END-IF                                           21850000
218600     END-PERFORM.                                                 21860000
218700                                                                  21870000
218800*----------------------------------------------------------------*21880000
218900*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21890000
219000*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21900000
219100*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21910000
219200*                                                                *21920000
219300*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21930000
219400*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21940000
219500*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21950000
219600*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21960000
219700*----------------------------------------------------------------*21970000
219800 3100-SET-SUBSCRIPTS.                                             21980000
219900                                                                  21990000
220000     COMPUTE ASC-ITEM-SUB =                                       22000000
220100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        22010000
220200                                                                  22020000
220300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         22030000
220400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22040000
220500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               22050000
220600     ELSE                                                         22060000
220700         MOVE +1                     TO ASC-BLK-SUB               22070000
220800     END-IF.                                                      22080000
220900******************************************************************22090000
221000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **22100000
221100******************************************************************22110000
221200 3200-RESET-ATTRIBUTES.                                           22120000
221300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   22130000
221400     MOVE DP015-GREEN              TO ASTRTITC.                   22140000
221500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   22150000
221600                                                                  22160000
221700     PERFORM                                                      22170000
221800         VARYING PV-SUB                                           22180000
221900         FROM 1 BY 1                                              22190000
222000         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        22200000
222100         MOVE DP015-UNP-ALP-NOR-OFF                               22210000
222200                                   TO MR-SELECTA (PV-SUB)         22220000
222300         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         22230000
222400         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         22240000
222500     END-PERFORM.                                                 22250000
222600******************************************************************22260000
222700** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **22270000
222800** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **22280000
222900** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **22290000
223000** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **22300000
223100******************************************************************22310000
223200 3300-EDIT-SELECTIONS.                                            22320000
223300     EVALUATE TRUE                                                22330000
223400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22340000
223500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22350000
223600                 CONTINUE                                         22360000
223700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22370000
223800             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22380000
223900                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   22390000
224000                 MOVE ASC-TEMP-SELECTED-SW                        22400000
224100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22410000
224200                                TO ASC-SELECTED-SW                22420000
224300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22430000
224400             END-IF                                               22440000
224500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22450000
224600                 = SPACE                                          22460000
224700             EVALUATE TRUE                                        22470000
224800                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22480000
224900                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22490000
225000                     MOVE SPACE TO ASC-SELECTED-SW                22500000
225100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22510000
225200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22520000
225300                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    22530000
225400                     MOVE SPACE TO ASC-SELECTED-SW                22540000
225500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22550000
225600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22560000
225700                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22570000
225800                     MOVE SPACE TO ASC-SELECTED-SW                22580000
225900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22590000
226000             END-EVALUATE                                         22600000
226100         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22610000
226200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22620000
226300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22630000
226400             END-IF                                               22640000
226500             PERFORM 3310-EDIT-RANGE                              22650000
226600         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22660000
226700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22670000
226800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22680000
226900             END-IF                                               22690000
227000             PERFORM 3310-EDIT-RANGE                              22700000
227100         WHEN OTHER                                               22710000
227200             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           22720000
227300             SET DP020-MSG-FATAL    TO TRUE                       22730000
227400             MOVE -1                TO MR-SELECTL (PV-SUB)        22740000
227500             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 22750000
227600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        22760000
227700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        22770000
227800             SET PS-ERROR TO TRUE                                 22780000
227900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22790000
228000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22800000
228100                 MOVE SPACE         TO ASC-SELECTED-SW            22810000
228200                                        (ASC-BLK-SUB ASC-ITEM-SUB)22820000
228300             END-IF                                               22830000
228400     END-EVALUATE.                                                22840000
228500                                                                  22850000
228600     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 22860000
228700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               22870000
228800     IF  ASC-ITEM-SUB < 1                                         22880000
228900         SUBTRACT +1 FROM ASC-BLK-SUB                             22890000
229000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                22900000
229100     END-IF.                                                      22910000
229200                                                                  22920000
229300******************************************************************22930000
229400** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **22940000
229500** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **22950000
229600** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**22960000
229700** THE ENDING.                                                  **22970000
229800******************************************************************22980000
229900 3310-EDIT-RANGE.                                                 22990000
230000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                23000000
230100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   23010000
230200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)23020000
230300                                   TO ASC-SELECTED-SW             23030000
230400                                        (ASC-BLK-SUB ASC-ITEM-SUB)23040000
230500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 23050000
230600         ELSE                                                     23060000
230700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     23070000
230800                 CONTINUE                                         23080000
230900             ELSE                                                 23090000
231000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        23100000
231100                 MOVE PC-TSYMSG-00054                             23110000
231200                                       TO DP020-MSG-NUMBER        23120000
231300                 MOVE -1               TO ASTRTITL                23130000
231400                 SET DP020-MSG-FATAL                              23140000
231500                     DP030-SET-CURSOR-APPL-1                      23150000
231600                     PS-ERROR          TO TRUE                    23160000
231700             END-IF                                               23170000
231800         END-IF                                                   23180000
231900     ELSE                                                         23190000
232000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23200000
232100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23210000
232200                                   TO ASC-SELECTED-SW             23220000
232300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23230000
232400             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   23240000
232500         ELSE                                                     23250000
232600             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23260000
232700                 CONTINUE                                         23270000
232800             ELSE                                                 23280000
232900*                -- ONLY ONE END-OF-RANGE ALLOWED --              23290000
233000                 MOVE PC-TSYMSG-00055                             23300000
233100                                        TO DP020-MSG-NUMBER       23310000
233200                 MOVE -1                TO ASTRTITL               23320000
233300                 SET DP020-MSG-FATAL                              23330000
233400                     DP030-SET-CURSOR-APPL-1                      23340000
233500                     PS-ERROR           TO TRUE                   23350000
233600             END-IF                                               23360000
233700         END-IF                                                   23370000
233800     END-IF.                                                      23380000
233900*                                                                 23390000
234000******************************************************************23400000
234100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **23410000
234200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **23420000
234300******************************************************************23430000
234400 3400-CHECK-RANGE-SEQUENCE.                                       23440000
234500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23450000
234600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23460000
234700       AND  ASC-START-OF-SELECTED-RANGE >                         23470000
234800                                         ASC-END-OF-SELECTED-RANGE23480000
234900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23490000
235000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23500000
235100         SET DP020-MSG-FATAL TO TRUE                              23510000
235200         SET PS-ERROR TO TRUE                                     23520000
235300         PERFORM 3410-POSITION-AT-ERROR                           23530000
235400     END-IF.                                                      23540000
235500******************************************************************23550000
235600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **23560000
235700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **23570000
235800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **23580000
235900******************************************************************23590000
236000 3410-POSITION-AT-ERROR.                                          23600000
236100     SET DP030-SET-CURSOR-APPL-1                                  23610000
236200                                   TO TRUE.                       23620000
236300     MOVE -1                       TO ASTRTITL                    23630000
236400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23640000
236500                    - PV-TOP-ITEM + 1.                            23650000
236600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23660000
236700         CONTINUE                                                 23670000
236800     END-IF.                                                      23680000
236900*                                                                 23690000
237000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   23700000
237100                    - PV-TOP-ITEM + 1.                            23710000
237200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23720000
237300         CONTINUE                                                 23730000
237400     END-IF.                                                      23740000
237500                                                                  23750000
237600*----------------------------------------------------------------*23760000
237700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *23770000
237800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *23780000
237900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *23790000
238000*----------------------------------------------------------------*23800000
238100 3500-MARK-RANGE-AS-SELECTED.                                     23810000
238200     MOVE +1                       TO  ASC-BLK-SUB.               23820000
238300     PERFORM 3510-MARK-SELECTED-INDS                              23830000
238400         VARYING ASC-ITEM-SUB                                     23840000
238500         FROM 1 BY 1                                              23850000
238600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23860000
238700                                                                  23870000
238800     ADD +1                        TO ASC-BLK-SUB.                23880000
238900     PERFORM 3510-MARK-SELECTED-INDS                              23890000
239000         VARYING ASC-ITEM-SUB                                     23900000
239100         FROM 1 BY 1                                              23910000
239200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23920000
239300                                                                  23930000
239400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23940000
239500                                   TO  PV-LIST-ITEM-NUMBER.       23950000
239600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23960000
239700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         23970000
239800               PC-ITEMS-PER-PANEL).                               23980000
239900                                                                  23990000
240000     MOVE ASC-START-OF-SELECTED-RANGE                             24000000
240100                                   TO PV-START-OF-SELECTED-RANGE. 24010000
240200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24020000
240300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24030000
240400               PC-ITEMS-PER-PANEL).                               24040000
240500                                                                  24050000
240600     MOVE ASC-END-OF-SELECTED-RANGE                               24060000
240700                                   TO  PV-END-OF-SELECTED-RANGE.  24070000
240800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24080000
240900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24090000
241000               PC-ITEMS-PER-PANEL).                               24100000
241100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             24110000
241200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             24120000
241300                                                                  24130000
241400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24140000
241500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24150000
241600         MOVE +1                   TO ASC-BLK-SUB                 24160000
241700         PERFORM 5100-WRITE-TEMP-STORAGE                          24170000
241800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24180000
241900             PV-FIRST-BLOCK-IN-ARRAY - 1                          24190000
242000                                                                  24200000
242100         PERFORM                                                  24210000
242200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24220000
242300                   PV-PREV-BLOCK-IN-ARRAY                         24230000
242400             MOVE PV-FIRST-BLOCK-IN-RANGE                         24240000
242500                                   TO PV-BLOCK-NUMBER             24250000
242600             PERFORM 4410-READ-TEMP-STORAGE                       24260000
242700             PERFORM 3510-MARK-SELECTED-INDS                      24270000
242800                 VARYING ASC-ITEM-SUB                             24280000
242900                 FROM 1 BY 1                                      24290000
243000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24300000
243100             PERFORM 5100-WRITE-TEMP-STORAGE                      24310000
243200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     24320000
243300         END-PERFORM                                              24330000
243400                                                                  24340000
243500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24350000
243600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24360000
243700         PERFORM                                                  24370000
243800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24380000
243900                   PV-LAST-BLOCK-IN-RANGE                         24390000
244000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24400000
244100                                   TO PV-BLOCK-NUMBER             24410000
244200             PERFORM 4410-READ-TEMP-STORAGE                       24420000
244300             PERFORM 3510-MARK-SELECTED-INDS                      24430000
244400                 VARYING ASC-ITEM-SUB                             24440000
244500                 FROM 1 BY 1                                      24450000
244600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24460000
244700             PERFORM 5100-WRITE-TEMP-STORAGE                      24470000
244800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24480000
244900         END-PERFORM                                              24490000
245000                                                                  24500000
245100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24510000
245200                                   TO PV-BLOCK-NUMBER             24520000
245300         PERFORM 4410-READ-TEMP-STORAGE                           24530000
245400     END-IF.                                                      24540000
245500                                                                  24550000
245600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 24560000
245700                                      ASC-END-OF-SELECTED-RANGE.  24570000
245800                                                                  24580000
245900*----------------------------------------------------------------*24590000
246000* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *24600000
246100*----------------------------------------------------------------*24610000
246200 3510-MARK-SELECTED-INDS.                                         24620000
246300                                                                  24630000
246400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24640000
246500                                ASC-ITEM-SUB) >                   24650000
246600         ASC-START-OF-SELECTED-RANGE)                             24660000
246700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24670000
246800                                ASC-ITEM-SUB) =                   24680000
246900         ASC-START-OF-SELECTED-RANGE)                             24690000
247000                                                                  24700000
247100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24710000
247200                                    ASC-ITEM-SUB) <               24720000
247300             ASC-END-OF-SELECTED-RANGE)                           24730000
247400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24740000
247500                                    ASC-ITEM-SUB) =               24750000
247600             ASC-END-OF-SELECTED-RANGE)                           24760000
247700                                                                  24770000
247800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          24780000
247900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   24790000
248000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   24800000
248100                               TO TRUE                            24810000
248200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              24820000
248300                               TO TRUE                            24830000
248400                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    24840000
248500             END-IF                                               24850000
248600         END-IF                                                   24860000
248700     END-IF.                                                      24870000
248800                                                                  24880000
248900*----------------------------------------------------------------*24890000
249000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *24900000
249100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *24910000
249200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *24920000
249300*    DISPLAY THE PANEL TO USER.                                  *24930000
249400*----------------------------------------------------------------*24940000
249500 4000-BUILD-INITIAL-PANEL.                                        24950000
249600                                                                  24960000
249700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            24970000
249800                                 ASC-BLOCK-ENTRIES (2).           24980000
249900     MOVE +1                 TO ASC-BLK-SUB.                      24990000
250000     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           25000000
250100                                                                  25010000
250200     MOVE +0                 TO ASC-ITEM-SUB                      25020000
250300                                ASC-NUMBER-OF-ITEMS-READ          25030000
250400                                ASC-NUMBER-OF-SELECTED-ITEMS      25040000
250500                                ASC-HIGHEST-BLOCK-WRITTEN         25050000
250600                                ASC-START-OF-SELECTED-RANGE       25060000
250700                                ASC-END-OF-SELECTED-RANGE         25070000
250800                                ASC-ITEM-AT-TOP-OF-PANEL.         25080000
250900                                                                  25090000
251000                                                                  25100000
251100     PERFORM 4100-PREPARE-CURSOR.                                 25110000
251200     PERFORM 4010-OPEN-CURSOR.                                    25120000
251300     IF  PS-ERROR                                                 25130000
251400         CONTINUE                                                 25140000
251500     ELSE                                                         25150000
251600         PERFORM 4300-READ-ITEMS-FROM-DB                          25160000
251700         PERFORM 4020-CLOSE-CURSOR                                25170000
251800     END-IF.                                                      25180000
251900                                                                  25190000
252000     MOVE +1                   TO  PV-TOP-ITEM.                   25200000
252100*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        25210000
252200*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   25220000
252300*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      25230000
252400*    THE ORIGINAL SCREEN.                                         25240000
252500*    OR WHEN THE F17 OR F18 ARE PRESSED                           25250000
252600     EVALUATE TRUE                                                25260000
252700         WHEN SU039-SELECTED-ITEMS > 1                            25270000
252800             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  25280000
252900                 SET DP020-MSG-WARNING TO  TRUE                   25290000
253000                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       25300000
253100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25310000
253200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25320000
253210                 PERFORM                                          25321003
253220                      VARYING PV-SUB                              25322003
253230                         FROM 1 BY 1                              25323003
253240                         UNTIL PV-SUB > PC-ITEMS-PER-PANEL        25324003
253250                          MOVE DP015-ASK-DRK-OFF                  25325003
253251                                       TO MR-SELECTA (PV-SUB)     25325103
253301                 END-PERFORM                                      25330103
253302                                                                  25330203
253310             ELSE                                                 25331000
253400                 MOVE -1               TO MR-SELECTL(1)           25340000
253500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25350000
253600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25360000
253700             END-IF                                               25370000
253800         WHEN OTHER                                               25380000
253900             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  25390000
254000*                SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            25400000
254100                 SET DP020-MSG-FATAL   TO  TRUE                   25410000
254200                 IF  SQLCODE = -181                               25420000
254300                     CONTINUE                                     25430000
254400                 ELSE                                             25440000
254500                     MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER   25450000
254510                     PERFORM                                      25451003
254520                          VARYING PV-SUB                          25452003
254530                             FROM 1 BY 1                          25453003
254540                            UNTIL PV-SUB > PC-ITEMS-PER-PANEL     25454003
254550                              MOVE DP015-ASK-DRK-OFF              25455003
254560                                       TO MR-SELECTA (PV-SUB)     25456003
254570                     END-PERFORM                                  25457003
254580                                                                  25458003
254600                 END-IF                                           25460000
254700             ELSE                                                 25470000
254800                 MOVE -1               TO MR-SELECTL(1)           25480000
254900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25490000
255000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25500000
255100             END-IF                                               25510000
255200     END-EVALUATE.                                                25520000
255300                                                                  25530000
255400*----------------------------------------------------------------*25540000
255500* OPEN THE CURSOR                                                 25550000
255600*----------------------------------------------------------------*25560000
255700 4010-OPEN-CURSOR.                                                25570000
255800     PERFORM                                                      25580000
255900         WITH TEST AFTER                                          25590000
256000         VARYING PV-RETRY-COUNTER                                 25600000
256100         FROM 1 BY 1                                              25610000
256200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25620000
256300                   OR (SQLCODE = ZERO)                            25630000
256400                   OR (SQLCODE = -181))                           25640000
256500                                                                  25650000
256600         EVALUATE TRUE                                            25660000
256700             WHEN ASC-OP-PO-RC-LN-ST-CSR                          25670000
256800                 EXEC SQL                                         25680000
256900                      OPEN OP-PO-RC-LN-ST-CSR                     25690000
257000                 END-EXEC                                         25700000
257100             WHEN ASC-OP-PO-REC-LNE-CSR                           25710000
257200                 EXEC SQL                                         25720000
257300                      OPEN OP-PO-REC-LNE-CSR                      25730000
257400                 END-EXEC                                         25740000
257500             WHEN ASC-OPER-PO-REC-CSR                             25750000
257600                 EXEC SQL                                         25760000
257700                      OPEN OPER-PO-REC-CSR                        25770000
257800                 END-EXEC                                         25780000
257900             WHEN ASC-OPER-PO-CSR                                 25790000
258000                 EXEC SQL                                         25800000
258100                      OPEN OPER-PO-CSR                            25810000
258200                 END-EXEC                                         25820000
258300             WHEN ASC-OPER-CSR                                    25830000
258400                 EXEC SQL                                         25840000
258500                      OPEN OPER-CSR                               25850000
258600                 END-EXEC                                         25860000
258700             WHEN ASC-PO-REC-LNE-DST-CSR                          25870000
258800                 EXEC SQL                                         25880000
258900                      OPEN PO-REC-LNE-DST-CSR                     25890000
259000                 END-EXEC                                         25900000
259100             WHEN ASC-PO-REC-LNE-CSR                              25910000
259200                 EXEC SQL                                         25920000
259300                      OPEN PO-REC-LNE-CSR                         25930000
259400                 END-EXEC                                         25940000
259500             WHEN ASC-PO-REC-CSR                                  25950000
259600                 EXEC SQL                                         25960000
259700                      OPEN PO-REC-CSR                             25970000
259800                 END-EXEC                                         25980000
259900             WHEN ASC-PO-CSR                                      25990000
260000                 EXEC SQL                                         26000000
260100                      OPEN PO-CSR                                 26010000
260200                 END-EXEC                                         26020000
260300             WHEN ASC-OPER-UPC-CSR                                26030000
260400                 EXEC SQL                                         26040000
260500                      OPEN OPER-UPC-CSR                           26050000
260600                 END-EXEC                                         26060000
260700             WHEN ASC-UPC-CSR                                     26070000
260800                 EXEC SQL                                         26080000
260900                      OPEN UPC-CSR                                26090000
261000                 END-EXEC                                         26100000
261100             WHEN ASC-OPER-SKU-CSR                                26110000
261200                 EXEC SQL                                         26120000
261300                      OPEN OPER-SKU-CSR                           26130000
261400                 END-EXEC                                         26140000
261500             WHEN ASC-SKU-CSR                                     26150000
261600                 EXEC SQL                                         26160000
261700                      OPEN SKU-CSR                                26170000
261800                 END-EXEC                                         26180000
261900             WHEN ASC-AUDIT-CSR                                   26190000
262000                 EXEC SQL                                         26200000
262100                      OPEN AUDIT-CSR                              26210000
262200                 END-EXEC                                         26220000
262300             WHEN ASC-SHIPT-UNT-CSR                               26230000
262400                 EXEC SQL                                         26240000
262500                      OPEN SHIPT-UNIT-CSR                         26250000
262600                 END-EXEC                                         26260000
262700         END-EVALUATE                                             26270000
262800                                                                  26280000
262900         EVALUATE TRUE                                            26290000
263000             WHEN SQLCODE = ZERO                                  26300000
263100             WHEN SQLCODE = -904                                  26310000
263200             WHEN SQLCODE = -913                                  26320000
263300                 CONTINUE                                         26330000
263400             WHEN SQLCODE = -181                                  26340000
263500                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            26350000
263600                 SET DP020-MSG-FATAL           TO TRUE            26360000
263700                 SET PS-ERROR                  TO TRUE            26370000
263800                 MOVE PC-TSYMSG-00009          TO DP020-MSG-NUMBER26380000
263900             WHEN SQLWARN0 NOT = SPACES                           26390000
264000             WHEN SQLCODE < ZERO                                  26400000
264100             WHEN SQLCODE > ZERO                                  26410000
264200                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       26420000
264300                 MOVE 'OPEN CURSOR PROBLEM    - '                 26430000
264400                                   TO DP013-MESSAGE-TEXT (1)      26440000
264500                 MOVE SQLCA        TO DP013-SQLCA                 26450000
264600                 MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)    26460000
264700                 SET DP013-DB2-ABEND                              26470000
264800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26480000
264900                 PERFORM DP013-0000-PROCESS-ABEND                 26490000
265000         END-EVALUATE                                             26500000
265100     END-PERFORM.                                                 26510000
265200*                                                                 26520000
265300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26530000
265400         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             26540000
265500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   26550000
265600                                   TO DP013-MESSAGE-TEXT (1)      26560000
265700         MOVE SQLCA                TO DP013-SQLCA                 26570000
265800         MOVE 'FINCLADJ'           TO DP013-DB2-TABLE-NAME (1)    26580000
265900         SET DP013-DB2-ABEND                                      26590000
266000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   26600000
266100         PERFORM DP013-0000-PROCESS-ABEND                         26610000
266200     END-IF.                                                      26620000
266300                                                                  26630000
266400*----------------------------------------------------------------*26640000
266500* CLOSE THE CURSOR.                                               26650000
266600*----------------------------------------------------------------*26660000
266700 4020-CLOSE-CURSOR.                                               26670000
266800                                                                  26680000
266900     EVALUATE TRUE                                                26690000
267000         WHEN ASC-OP-PO-RC-LN-ST-CSR                              26700000
267100             EXEC SQL                                             26710000
267200                  CLOSE OP-PO-RC-LN-ST-CSR                        26720000
267300             END-EXEC                                             26730000
267400         WHEN ASC-OP-PO-REC-LNE-CSR                               26740000
267500             EXEC SQL                                             26750000
267600                  CLOSE OP-PO-REC-LNE-CSR                         26760000
267700             END-EXEC                                             26770000
267800         WHEN ASC-OPER-PO-REC-CSR                                 26780000
267900             EXEC SQL                                             26790000
268000                  CLOSE OPER-PO-REC-CSR                           26800000
268100             END-EXEC                                             26810000
268200         WHEN ASC-OPER-PO-CSR                                     26820000
268300             EXEC SQL                                             26830000
268400                  CLOSE OPER-PO-CSR                               26840000
268500             END-EXEC                                             26850000
268600         WHEN ASC-OPER-CSR                                        26860000
268700             EXEC SQL                                             26870000
268800                  CLOSE OPER-CSR                                  26880000
268900             END-EXEC                                             26890000
269000         WHEN ASC-PO-REC-LNE-DST-CSR                              26900000
269100             EXEC SQL                                             26910000
269200                  CLOSE PO-REC-LNE-DST-CSR                        26920000
269300             END-EXEC                                             26930000
269400         WHEN ASC-PO-REC-LNE-CSR                                  26940000
269500             EXEC SQL                                             26950000
269600                  CLOSE PO-REC-LNE-CSR                            26960000
269700             END-EXEC                                             26970000
269800         WHEN ASC-PO-REC-CSR                                      26980000
269900             EXEC SQL                                             26990000
270000                  CLOSE PO-REC-CSR                                27000000
270100             END-EXEC                                             27010000
270200         WHEN ASC-PO-CSR                                          27020000
270300             EXEC SQL                                             27030000
270400                  CLOSE PO-CSR                                    27040000
270500             END-EXEC                                             27050000
270600         WHEN ASC-OPER-UPC-CSR                                    27060000
270700             EXEC SQL                                             27070000
270800                  CLOSE OPER-UPC-CSR                              27080000
270900             END-EXEC                                             27090000
271000         WHEN ASC-UPC-CSR                                         27100000
271100             EXEC SQL                                             27110000
271200                  CLOSE UPC-CSR                                   27120000
271300             END-EXEC                                             27130000
271400         WHEN ASC-OPER-SKU-CSR                                    27140000
271500             EXEC SQL                                             27150000
271600                  CLOSE OPER-SKU-CSR                              27160000
271700             END-EXEC                                             27170000
271800         WHEN ASC-SKU-CSR                                         27180000
271900             EXEC SQL                                             27190000
272000                  CLOSE SKU-CSR                                   27200000
272100             END-EXEC                                             27210000
272200         WHEN ASC-AUDIT-CSR                                       27220000
272300             EXEC SQL                                             27230000
272400                  CLOSE AUDIT-CSR                                 27240000
272500             END-EXEC                                             27250000
272600         WHEN ASC-SHIPT-UNT-CSR                                   27260000
272700             EXEC SQL                                             27270000
272800                  CLOSE SHIPT-UNIT-CSR                            27280000
272900             END-EXEC                                             27290000
273000     END-EVALUATE.                                                27300000
273100                                                                  27310000
273200     EVALUATE TRUE                                                27320000
273300         WHEN SQLCODE = ZERO                                      27330000
273400         WHEN SQLCODE = +100                                      27340000
273500             CONTINUE                                             27350000
273600         WHEN SQLWARN0 NOT = SPACES                               27360000
273700         WHEN SQLCODE < ZERO                                      27370000
273800         WHEN SQLCODE > ZERO                                      27380000
273900             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          27390000
274000             MOVE 'CLOSE CURSOR PROBLEM   '                       27400000
274100                               TO DP013-MESSAGE-TEXT (1)          27410000
274200             MOVE SQLCA        TO DP013-SQLCA                     27420000
274300             MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)        27430000
274400             SET DP013-DB2-ABEND                                  27440000
274500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27450000
274600             PERFORM DP013-0000-PROCESS-ABEND                     27460000
274700     END-EVALUATE.                                                27470000
274800                                                                  27480000
274900*----------------------------------------------------------------*27490000
275000*    FILL IN HOST VARIABLE FIELDS                                 27500000
275100*----------------------------------------------------------------*27510000
275200 4100-PREPARE-CURSOR.                                             27520000
275300     IF NOT ASC-UNT-ADJ-ALL                                       27530000
275400         MOVE ASC-UNT-ADJ-TYP     TO  DK-UNT-ADJ-TYP-BEGIN        27540000
275500                                      DK-UNT-ADJ-TYP-END          27550000
275600     ELSE                                                         27560000
275700         MOVE DK-DEFAULT-ALPHA-BEGIN  TO  DK-UNT-ADJ-TYP-BEGIN    27570000
275800         MOVE DK-DEFAULT-ALPHA-END    TO  DK-UNT-ADJ-TYP-END      27580000
275900     END-IF.                                                      27590000
276000                                                                  27600000
276100* DMH 8/19/03 - BEGIN                                             27610000
276200     IF  ASC-GROUP-CRTN                                           27620000
276300         MOVE 'C'                TO  DK-GROUP-BEGIN               27630000
276400                                     DK-GROUP-END                 27640000
276500     ELSE                                                         27650000
276600     IF  ASC-GROUP-P2L                                            27660000
276700         MOVE 'P'                TO  DK-GROUP-BEGIN               27670000
276800                                     DK-GROUP-END                 27680000
276900     ELSE                                                         27690000
277000         MOVE 'A'                TO  DK-GROUP-BEGIN               27700000
277100         MOVE 'Z'                TO  DK-GROUP-END                 27710000
277200     END-IF                                                       27720000
277300     END-IF.                                                      27730000
277400* DMH 8/19/03 - END                                               27740000
277500                                                                  27750000
277600                                                                  27760000
277700     IF ASC-FAIL                                                  27770000
277800         MOVE 'N'                 TO  DK-FAIL-SUCC-BEGIN          27780000
277900                                      DK-FAIL-SUCC-END            27790000
278000         MOVE '        '          TO  DK-RSLV-BY-BEGIN            27800000
278100         MOVE 'ZZZZZZZZ'          TO  DK-RSLV-BY-END              27810000
278200     ELSE                                                         27820000
278300         IF ASC-SUCCESS                                           27830000
278400             MOVE 'Y'             TO  DK-FAIL-SUCC-BEGIN          27840000
278500                                      DK-FAIL-SUCC-END            27850000
278600             MOVE '        '      TO  DK-RSLV-BY-BEGIN            27860000
278700             MOVE 'ZZZZZZZZ'      TO  DK-RSLV-BY-END              27870000
278800         ELSE                                                     27880000
278900             IF ASC-UNACKNOWLEDGED                                27890000
279000                 MOVE 'N'             TO  DK-FAIL-SUCC-BEGIN      27900000
279100                                          DK-FAIL-SUCC-END        27910000
279200                 MOVE '        '      TO  DK-RSLV-BY-BEGIN        27920000
279300                                          DK-RSLV-BY-END          27930000
279400             ELSE                                                 27940000
279500                 MOVE DK-DEFAULT-ALPHA-BEGIN TO DK-FAIL-SUCC-BEGIN27950000
279600                 MOVE DK-DEFAULT-ALPHA-END   TO DK-FAIL-SUCC-END  27960000
279700                 MOVE '        '             TO  DK-RSLV-BY-BEGIN 27970000
279800                 MOVE 'ZZZZZZZZ'             TO  DK-RSLV-BY-END   27980000
279900             END-IF                                               27990000
280000         END-IF                                                   28000000
280100     END-IF.                                                      28010000
280200     MOVE ASC-FROM-YY          TO PV-FROM-YY.                     28020000
280300     MOVE ASC-FROM-MM          TO PV-FROM-MM.                     28030000
280400     MOVE ASC-FROM-DD          TO PV-FROM-DD.                     28040000
280500     MOVE PV-FROM-TMST-X       TO PV-FROM-TMST.                   28050000
280600     MOVE ASC-TO-YY            TO PV-TO-YY.                       28060000
280700     MOVE ASC-TO-MM            TO PV-TO-MM.                       28070000
280800     MOVE ASC-TO-DD            TO PV-TO-DD.                       28080000
280900     MOVE PV-TO-TMST-X         TO PV-TO-TMST.                     28090000
281000     MOVE ASC-OPER-UNT-ID          TO  DK-OPER-UNT-ID.            28100000
281100     MOVE ASC-PO                   TO  DK-PO-NBR.                 28110000
281200     MOVE ASC-RCVR                 TO  DK-RCVR-SEQ-NBR.           28120000
281300     MOVE ASC-LINE                 TO  DK-LINE-NBR.               28130000
281400     MOVE ASC-STR-NBR              TO  DK-STR-NBR.                28140000
281500     IF ASC-STR-NBR  >  ZEROES                                    28150000
281600         MOVE ASC-STR-NBR          TO  DK-STR-BEGIN               28160000
281700                                       DK-STR-END                 28170000
281800     ELSE                                                         28180000
281900         MOVE DK-DEFAULT-BEGIN     TO  DK-STR-BEGIN               28190000
282000         MOVE DK-DEFAULT-END-STR   TO  DK-STR-END                 28200000
282100     END-IF.                                                      28210000
282200     MOVE ASC-AUDIT-NBR            TO  DK-AUDIT-NBR.              28220000
282300     MOVE ASC-UPC                  TO  DK-UPC-NBR.                28230000
282400     MOVE ASC-SKU                  TO  DK-SKU-NBR.                28240000
282500     MOVE ASC-SHIPT-UNT-ID         TO  DK-SHIPT-UNT-ID.           28250000
282600**   IF ASC-SKU    > ZERO                                         28260000
282700**       IF ASC-UPC = ZEROES                                      28270000
282800**           PERFORM 4110-GET-UPC                                 28280000
282900**           MOVE XL001-UPC-NBR    TO  DK-UPC-NBR                 28290000
283000**       END-IF                                                   28300000
283100**   END-IF.                                                      28310000
283200                                                                  28320000
283300     EVALUATE TRUE                                                28330000
283400         WHEN DK-OPER-UNT-ID > 0 AND                              28340000
283500              DK-PO-NBR > 0 AND                                   28350000
283600              DK-RCVR-SEQ-NBR > 0 AND                             28360000
283700              DK-LINE-NBR > 0 AND                                 28370000
283800              DK-STR-NBR > 0                                      28380000
283900             SET ASC-OP-PO-RC-LN-ST-CSR            TO TRUE        28390000
284000                                                                  28400000
284100         WHEN DK-OPER-UNT-ID > 0 AND                              28410000
284200              DK-PO-NBR > 0 AND                                   28420000
284300              DK-RCVR-SEQ-NBR > 0 AND                             28430000
284400              DK-LINE-NBR > 0                                     28440000
284500             SET ASC-OP-PO-REC-LNE-CSR             TO TRUE        28450000
284600                                                                  28460000
284700         WHEN DK-OPER-UNT-ID > 0 AND                              28470000
284800              DK-PO-NBR > 0 AND                                   28480000
284900              DK-RCVR-SEQ-NBR > 0                                 28490000
285000             SET ASC-OPER-PO-REC-CSR               TO TRUE        28500000
285100                                                                  28510000
285200         WHEN DK-OPER-UNT-ID > 0 AND                              28520000
285300              DK-PO-NBR > 0                                       28530000
285400             SET ASC-OPER-PO-CSR                   TO TRUE        28540000
285500                                                                  28550000
285600         WHEN DK-OPER-UNT-ID > 0 AND                              28560000
285700              DK-UPC-NBR > 0                                      28570000
285800             SET ASC-OPER-UPC-CSR                  TO TRUE        28580000
285900                                                                  28590000
286000         WHEN DK-OPER-UNT-ID > 0 AND                              28600000
286100              DK-SKU-NBR > 0                                      28610000
286200             SET ASC-OPER-SKU-CSR                  TO TRUE        28620000
286300                                                                  28630000
286400         WHEN DK-AUDIT-NBR > 0                                    28640000
286500             SET ASC-AUDIT-CSR                     TO TRUE        28650000
286600                                                                  28660000
286700         WHEN DK-SHIPT-UNT-ID > 0                                 28670000
286800             SET ASC-SHIPT-UNT-CSR                 TO TRUE        28680000
286900                                                                  28690000
287000         WHEN DK-OPER-UNT-ID > 0                                  28700000
287100             SET ASC-OPER-CSR                      TO TRUE        28710000
287200                                                                  28720000
287300         WHEN DK-PO-NBR > 0 AND                                   28730000
287400              DK-RCVR-SEQ-NBR > 0 AND                             28740000
287500              DK-LINE-NBR > 0 AND                                 28750000
287600              DK-STR-NBR > 0                                      28760000
287700             SET ASC-PO-REC-LNE-DST-CSR            TO TRUE        28770000
287800                                                                  28780000
287900         WHEN DK-PO-NBR > 0 AND                                   28790000
288000              DK-RCVR-SEQ-NBR > 0 AND                             28800000
288100              DK-LINE-NBR > 0                                     28810000
288200             SET ASC-PO-REC-LNE-CSR                TO TRUE        28820000
288300                                                                  28830000
288400         WHEN DK-PO-NBR > 0 AND                                   28840000
288500              DK-RCVR-SEQ-NBR > 0                                 28850000
288600             SET ASC-PO-REC-CSR                    TO TRUE        28860000
288700                                                                  28870000
288800         WHEN DK-PO-NBR > 0                                       28880000
288900             SET ASC-PO-CSR                        TO TRUE        28890000
289000                                                                  28900000
289100         WHEN DK-UPC-NBR > 0                                      28910000
289200             SET ASC-UPC-CSR                       TO TRUE        28920000
289300                                                                  28930000
289400         WHEN DK-SKU-NBR > 0                                      28940000
289500             SET ASC-SKU-CSR                       TO TRUE        28950000
289600                                                                  28960000
289700     END-EVALUATE.                                                28970000
289800                                                                  28980000
289900*----------------------------------------------------------------*28990000
290000*    RETRIEVE UPC USING SKU NUMBER                                29000000
290100*----------------------------------------------------------------*29010000
290200 4110-GET-UPC.                                                    29020000
290300     INITIALIZE XL001-ITEM-COMMAREA.                              29030000
290400     MOVE ASC-SKU  TO XL001-KEY-SKU.                              29040000
290500     MOVE  'V'     TO XL001-KEY-UPC-TYP-CDE.                      29050000
290600     SET  XL001-BY-NUMERIC-SKU                                    29060000
290700          XL001-SELECT-UPC     TO TRUE.                           29070000
290800                                                                  29080000
290900     CALL XL001-VSM-PGM USING DFHEIBLK                            29090000
291000                           XL001-COMMAREA                         29100000
291100                           XL001-ITEM-COMMAREA.                   29110000
291200     EVALUATE TRUE                                                29120000
291300         WHEN XL001-SUCCESSFUL                                    29130000
291400         WHEN XL001-UPC-SQLCODE = -811                            29140000
291500              CONTINUE                                            29150000
291600         WHEN XL001-UPC-NOT-FOUND                                 29160000
291700             PERFORM 4120-GET-INTR-UPC-NBR                        29170000
291800         WHEN XL001-SQL-ERROR                                     29180000
291900             MOVE '4110-GET-UPC-NBR  '  TO DP013-PARAGRAPH        29190000
292000             MOVE 'FIND UPC NUMBER' TO  DP013-MESSAGE-TEXT (1)    29200000
292100             MOVE SQLCA   TO DP013-SQLCA                          29210000
292200             MOVE 'XLKUT001' TO DP013-DB2-TABLE-NAME (1)          29220000
292300             SET DP013-DB2-ABEND                                  29230000
292400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29240000
292500             PERFORM DP013-0000-PROCESS-ABEND                     29250000
292600     END-EVALUATE.                                                29260000
292700                                                                  29270000
292800*----------------------------------------------------------------*29280000
292900*    RETRIEVE INTR UPC NUMBER                                     29290000
293000*----------------------------------------------------------------*29300000
293100 4120-GET-INTR-UPC-NBR.                                           29310000
293200     INITIALIZE XL001-ITEM-COMMAREA.                              29320000
293300     MOVE ASC-SKU  TO XL001-KEY-SKU.                              29330000
293400     MOVE  'I'     TO XL001-KEY-UPC-TYP-CDE.                      29340000
293500     SET  XL001-BY-NUMERIC-SKU                                    29350000
293600          XL001-SELECT-UPC     TO TRUE.                           29360000
293700                                                                  29370000
293800     CALL XL001-VSM-PGM USING DFHEIBLK                            29380000
293900                           XL001-COMMAREA                         29390000
294000                           XL001-ITEM-COMMAREA.                   29400000
294100     EVALUATE TRUE                                                29410000
294200         WHEN XL001-SUCCESSFUL                                    29420000
294300         WHEN XL001-UPC-SQLCODE = -811                            29430000
294400              CONTINUE                                            29440000
294500         WHEN XL001-UPC-NOT-FOUND                                 29450000
294600             MOVE ZEROES TO XL001-UPC-NBR                         29460000
294700         WHEN XL001-SQL-ERROR                                     29470000
294800             MOVE '4120-GET-INTR-UPC-NBR  '  TO DP013-PARAGRAPH   29480000
294900             MOVE 'FIND INTR UPC NUMBER' TO DP013-MESSAGE-TEXT (1)29490000
295000             MOVE SQLCA   TO DP013-SQLCA                          29500000
295100             MOVE 'XLKUT001' TO DP013-DB2-TABLE-NAME (1)          29510000
295200             SET DP013-DB2-ABEND                                  29520000
295300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29530000
295400             PERFORM DP013-0000-PROCESS-ABEND                     29540000
295500     END-EVALUATE.                                                29550000
295600                                                                  29560000
295700*----------------------------------------------------------------*29570000
295800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29580000
295900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29590000
296000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29600000
296100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29610000
296200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29620000
296300*                                                                *29630000
296400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29640000
296500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29650000
296600*    UPON INITIALIZATION.                                        *29660000
296700*----------------------------------------------------------------*29670000
296800 4300-READ-ITEMS-FROM-DB.                                         29680000
296900                                                                  29690000
297000     PERFORM                                                      29700000
297100         VARYING PV-READ-COUNT                                    29710000
297200         FROM 1 BY 1                                              29720000
297300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29730000
297400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29740000
297500                                                                  29750000
297600         PERFORM 4310-FETCH                                       29760000
297700                                                                  29770000
297800         IF  ASC-ITEMS-LEFT-ON-DB                                 29780000
297900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                29790000
298000                 ADD +1            TO ASC-ITEM-SUB                29800000
298100             ELSE                                                 29810000
298200                 ADD +1            TO ASC-BLK-SUB                 29820000
298300                 MOVE +1           TO ASC-ITEM-SUB                29830000
298400                                                                  29840000
298500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         29850000
298600                     MOVE +1       TO ASC-BLK-SUB                 29860000
298700                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           29870000
298800                     PERFORM 5100-WRITE-TEMP-STORAGE              29880000
298900                     MOVE ASC-BLOCK-ENTRIES                       29890000
299000                                   (PC-MAX-BLOCKS-IN-ARRAY)       29900000
299100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 29910000
299200                     ADD +1        TO ASC-BLK-SUB                 29920000
299300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   29930000
299400                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      29940000
299500                                                          TO TRUE 29950000
299600                 END-IF                                           29960000
299700             END-IF                                               29970000
299800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    29980000
299900             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          29990000
300000             MOVE ASC-NUMBER-OF-ITEMS-READ                        30000000
300100                                   TO ASC-LIST-ITEM-NUMBER        30010000
300200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30020000
300300             MOVE SPACES TO ASC-ACTION                            30030000
300400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30040000
300500             MOVE SUT00030-ORGN-LOC-NBR TO                        30050000
300600                           ASC-OPER-UNT (ASC-BLK-SUB ASC-ITEM-SUB)30060000
300700                           PV-OPER-UNT-ID                         30070000
300800             MOVE SUT00030-PO-NBR       TO  DK-TRN-NBR            30080000
300900                                            PV-PO                 30090000
301000             MOVE SUT00030-RCVR-SEQ-NBR TO  DK-PO-RCVR-NBR-N      30100000
301100                                            PV-RCVR               30110000
301200             MOVE DK-PO-RCVR-NBR-N      TO  DK-RCVR-NBR-9         30120000
301300             MOVE DK-RCVR-NBR-3         TO  DK-RCVR-NBR           30130000
301400             MOVE DK-PO-RCVR            TO                        30140000
301500                            ASC-PO-RCVR (ASC-BLK-SUB ASC-ITEM-SUB)30150000
301600                                                                  30160000
301700             MOVE SUT00030-RCVR-LNE-NBR TO                        30170000
301800                           ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)30180000
301900                           PV-LINE                                30190000
302000             MOVE SUT00030-UPC-NBR TO                             30200000
302100                           ASC-UPC-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 30210000
302200                           PV-UPC                                 30220000
302300             PERFORM 4320-GET-SKU                                 30230000
302400             MOVE XL001-SKU-NBR TO                                30240000
302500                           ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 30250000
302600             MOVE  PV-NET-ADJ TO                                  30260000
302700                       ASC-TOT-NET-ADJ (ASC-BLK-SUB ASC-ITEM-SUB) 30270000
302800             ADD PV-NET-ADJ  TO  ASC-TOTAL-NET-ADJUST             30280000
302900             MOVE SPACES TO ASC-ADJ-SRC-NAME-HOLD                 30290000
303000             PERFORM 4330-GET-ADJ-SOURCE                          30300000
303100             MOVE ASC-ADJ-SRC-NAME-HOLD TO                        30310000
303200                          ASC-ADJ-SRCE (ASC-BLK-SUB ASC-ITEM-SUB) 30320000
303300             MOVE 'N' TO  PS-FAIL-UNACKNOW-SW                     30330000
303400             MOVE 'N' TO  PS-FAIL-ACKNOW-SW                       30340000
303500             PERFORM 4340-GET-REST-OF-INFO                        30350000
303600             IF PS-FAIL-UNACKNOW                                  30360000
303700                 MOVE 'F' TO                                      30370000
303800                        ASC-FAIL-SUCCSS (ASC-BLK-SUB ASC-ITEM-SUB)30380000
303900                 MOVE 'U' TO ASC-ACKNOWLEDGE                      30390000
304000                                        (ASC-BLK-SUB ASC-ITEM-SUB)30400000
304100             ELSE                                                 30410000
304200                 IF PS-FAIL-ACKNOW                                30420000
304300                     MOVE 'F' TO                                  30430000
304400                        ASC-FAIL-SUCCSS (ASC-BLK-SUB ASC-ITEM-SUB)30440000
304500                     MOVE ' ' TO ASC-ACKNOWLEDGE                  30450000
304600                                        (ASC-BLK-SUB ASC-ITEM-SUB)30460000
304700                 ELSE                                             30470000
304800                     MOVE 'S' TO                                  30480000
304900                        ASC-FAIL-SUCCSS (ASC-BLK-SUB ASC-ITEM-SUB)30490000
305000                     MOVE ' ' TO ASC-ACKNOWLEDGE                  30500000
305100                                        (ASC-BLK-SUB ASC-ITEM-SUB)30510000
305200                 END-IF                                           30520000
305300             END-IF                                               30530000
305400         END-IF                                                   30540000
305500     END-PERFORM.                                                 30550000
305600                                                                  30560000
305700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          30570000
305800         MOVE +1               TO ASC-BLK-SUB                     30580000
305900         PERFORM 5100-WRITE-TEMP-STORAGE                          30590000
306000         ADD +1                TO ASC-BLK-SUB                     30600000
306100         PERFORM 5100-WRITE-TEMP-STORAGE                          30610000
306200                                                                  30620000
306300         MOVE 1                TO ASC-BLK-SUB                     30630000
306400                                  PV-BLOCK-NUMBER                 30640000
306500         PERFORM 4410-READ-TEMP-STORAGE                           30650000
306600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             30660000
306700             MOVE 2            TO ASC-BLK-SUB                     30670000
306800                                  PV-BLOCK-NUMBER                 30680000
306900             PERFORM 4410-READ-TEMP-STORAGE                       30690000
307000         END-IF                                                   30700000
307100     END-IF.                                                      30710000
307200                                                                  30720000
307300                                                                  30730000
307400*----------------------------------------------------------------*30740000
307500*    FETCH THE CURSOR                                             30750000
307600*----------------------------------------------------------------*30760000
307700 4310-FETCH.                                                      30770000
307800                                                                  30780000
307900     EVALUATE TRUE                                                30790000
308000         WHEN ASC-OP-PO-RC-LN-ST-CSR                              30800000
308100             EXEC SQL                                             30810000
308200                  FETCH OP-PO-RC-LN-ST-CSR                        30820000
308300                  INTO  :SUT00030-ORGN-LOC-NBR                    30830000
308400                       ,:SUT00030-PO-NBR                          30840000
308500                       ,:SUT00030-RCVR-SEQ-NBR                    30850000
308600                       ,:SUT00030-RCVR-LNE-NBR                    30860000
308700                       ,:SUT00030-UPC-NBR                         30870000
308800                       ,:PV-NET-ADJ                               30880000
308900             END-EXEC                                             30890000
309000         WHEN ASC-OP-PO-REC-LNE-CSR                               30900000
309100             EXEC SQL                                             30910000
309200                  FETCH OP-PO-REC-LNE-CSR                         30920000
309300                  INTO  :SUT00030-ORGN-LOC-NBR                    30930000
309400                       ,:SUT00030-PO-NBR                          30940000
309500                       ,:SUT00030-RCVR-SEQ-NBR                    30950000
309600                       ,:SUT00030-RCVR-LNE-NBR                    30960000
309700                       ,:SUT00030-UPC-NBR                         30970000
309800                       ,:PV-NET-ADJ                               30980000
309900             END-EXEC                                             30990000
310000         WHEN ASC-OPER-PO-REC-CSR                                 31000000
310100             EXEC SQL                                             31010000
310200                  FETCH OPER-PO-REC-CSR                           31020000
310300                  INTO  :SUT00030-ORGN-LOC-NBR                    31030000
310400                       ,:SUT00030-PO-NBR                          31040000
310500                       ,:SUT00030-RCVR-SEQ-NBR                    31050000
310600                       ,:SUT00030-RCVR-LNE-NBR                    31060000
310700                       ,:SUT00030-UPC-NBR                         31070000
310800                       ,:PV-NET-ADJ                               31080000
310900             END-EXEC                                             31090000
311000         WHEN ASC-OPER-PO-CSR                                     31100000
311100             EXEC SQL                                             31110000
311200                  FETCH OPER-PO-CSR                               31120000
311300                  INTO  :SUT00030-ORGN-LOC-NBR                    31130000
311400                       ,:SUT00030-PO-NBR                          31140000
311500                       ,:SUT00030-RCVR-SEQ-NBR                    31150000
311600                       ,:SUT00030-RCVR-LNE-NBR                    31160000
311700                       ,:SUT00030-UPC-NBR                         31170000
311800                       ,:PV-NET-ADJ                               31180000
311900             END-EXEC                                             31190000
312000         WHEN ASC-OPER-CSR                                        31200000
312100             EXEC SQL                                             31210000
312200                  FETCH OPER-CSR                                  31220000
312300                  INTO  :SUT00030-ORGN-LOC-NBR                    31230000
312400                       ,:SUT00030-PO-NBR                          31240000
312500                       ,:SUT00030-RCVR-SEQ-NBR                    31250000
312600                       ,:SUT00030-RCVR-LNE-NBR                    31260000
312700                       ,:SUT00030-UPC-NBR                         31270000
312800                       ,:PV-NET-ADJ                               31280000
312900             END-EXEC                                             31290000
313000         WHEN ASC-PO-REC-LNE-DST-CSR                              31300000
313100             EXEC SQL                                             31310000
313200                  FETCH PO-REC-LNE-DST-CSR                        31320000
313300                  INTO  :SUT00030-ORGN-LOC-NBR                    31330000
313400                       ,:SUT00030-PO-NBR                          31340000
313500                       ,:SUT00030-RCVR-SEQ-NBR                    31350000
313600                       ,:SUT00030-RCVR-LNE-NBR                    31360000
313700                       ,:SUT00030-UPC-NBR                         31370000
313800                       ,:PV-NET-ADJ                               31380000
313900             END-EXEC                                             31390000
314000         WHEN ASC-PO-REC-LNE-CSR                                  31400000
314100             EXEC SQL                                             31410000
314200                  FETCH PO-REC-LNE-CSR                            31420000
314300                  INTO  :SUT00030-ORGN-LOC-NBR                    31430000
314400                       ,:SUT00030-PO-NBR                          31440000
314500                       ,:SUT00030-RCVR-SEQ-NBR                    31450000
314600                       ,:SUT00030-RCVR-LNE-NBR                    31460000
314700                       ,:SUT00030-UPC-NBR                         31470000
314800                       ,:PV-NET-ADJ                               31480000
314900             END-EXEC                                             31490000
315000         WHEN ASC-PO-REC-CSR                                      31500000
315100             EXEC SQL                                             31510000
315200                  FETCH PO-REC-CSR                                31520000
315300                  INTO  :SUT00030-ORGN-LOC-NBR                    31530000
315400                       ,:SUT00030-PO-NBR                          31540000
315500                       ,:SUT00030-RCVR-SEQ-NBR                    31550000
315600                       ,:SUT00030-RCVR-LNE-NBR                    31560000
315700                       ,:SUT00030-UPC-NBR                         31570000
315800                       ,:PV-NET-ADJ                               31580000
315900             END-EXEC                                             31590000
316000         WHEN ASC-PO-CSR                                          31600000
316100             EXEC SQL                                             31610000
316200                  FETCH PO-CSR                                    31620000
316300                  INTO  :SUT00030-ORGN-LOC-NBR                    31630000
316400                       ,:SUT00030-PO-NBR                          31640000
316500                       ,:SUT00030-RCVR-SEQ-NBR                    31650000
316600                       ,:SUT00030-RCVR-LNE-NBR                    31660000
316700                       ,:SUT00030-UPC-NBR                         31670000
316800                       ,:PV-NET-ADJ                               31680000
316900             END-EXEC                                             31690000
317000         WHEN ASC-OPER-UPC-CSR                                    31700000
317100             EXEC SQL                                             31710000
317200                  FETCH OPER-UPC-CSR                              31720000
317300                  INTO  :SUT00030-ORGN-LOC-NBR                    31730000
317400                       ,:SUT00030-PO-NBR                          31740000
317500                       ,:SUT00030-RCVR-SEQ-NBR                    31750000
317600                       ,:SUT00030-RCVR-LNE-NBR                    31760000
317700                       ,:SUT00030-UPC-NBR                         31770000
317800                       ,:PV-NET-ADJ                               31780000
317900             END-EXEC                                             31790000
318000         WHEN ASC-UPC-CSR                                         31800000
318100             EXEC SQL                                             31810000
318200                  FETCH UPC-CSR                                   31820000
318300                  INTO  :SUT00030-ORGN-LOC-NBR                    31830000
318400                       ,:SUT00030-PO-NBR                          31840000
318500                       ,:SUT00030-RCVR-SEQ-NBR                    31850000
318600                       ,:SUT00030-RCVR-LNE-NBR                    31860000
318700                       ,:SUT00030-UPC-NBR                         31870000
318800                       ,:PV-NET-ADJ                               31880000
318900             END-EXEC                                             31890000
319000         WHEN ASC-OPER-SKU-CSR                                    31900000
319100             EXEC SQL                                             31910000
319200                  FETCH OPER-SKU-CSR                              31920000
319300                  INTO  :SUT00030-ORGN-LOC-NBR                    31930000
319400                       ,:SUT00030-PO-NBR                          31940000
319500                       ,:SUT00030-RCVR-SEQ-NBR                    31950000
319600                       ,:SUT00030-RCVR-LNE-NBR                    31960000
319700                       ,:SUT00030-UPC-NBR                         31970000
319800                       ,:PV-NET-ADJ                               31980000
319900             END-EXEC                                             31990000
320000         WHEN ASC-SKU-CSR                                         32000000
320100             EXEC SQL                                             32010000
320200                  FETCH SKU-CSR                                   32020000
320300                  INTO  :SUT00030-ORGN-LOC-NBR                    32030000
320400                       ,:SUT00030-PO-NBR                          32040000
320500                       ,:SUT00030-RCVR-SEQ-NBR                    32050000
320600                       ,:SUT00030-RCVR-LNE-NBR                    32060000
320700                       ,:SUT00030-UPC-NBR                         32070000
320800                       ,:PV-NET-ADJ                               32080000
320900             END-EXEC                                             32090000
321000         WHEN ASC-AUDIT-CSR                                       32100000
321100             EXEC SQL                                             32110000
321200                  FETCH AUDIT-CSR                                 32120000
321300                  INTO  :SUT00030-ORGN-LOC-NBR                    32130000
321400                       ,:SUT00030-PO-NBR                          32140000
321500                       ,:SUT00030-RCVR-SEQ-NBR                    32150000
321600                       ,:SUT00030-RCVR-LNE-NBR                    32160000
321700                       ,:SUT00030-UPC-NBR                         32170000
321800                       ,:PV-NET-ADJ                               32180000
321900             END-EXEC                                             32190000
322000         WHEN ASC-SHIPT-UNT-CSR                                   32200000
322100             EXEC SQL                                             32210000
322200                  FETCH SHIPT-UNIT-CSR                            32220000
322300                  INTO  :SUT00030-ORGN-LOC-NBR                    32230000
322400                       ,:SUT00030-PO-NBR                          32240000
322500                       ,:SUT00030-RCVR-SEQ-NBR                    32250000
322600                       ,:SUT00030-RCVR-LNE-NBR                    32260000
322700                       ,:SUT00030-UPC-NBR                         32270000
322800                       ,:PV-NET-ADJ                               32280000
322900             END-EXEC                                             32290000
323000     END-EVALUATE.                                                32300000
323100                                                                  32310000
323200     EVALUATE TRUE                                                32320000
323300         WHEN SQLCODE = ZERO                                      32330000
323400         WHEN SQLCODE = +100                                      32340000
323500              CONTINUE                                            32350000
323600         WHEN SQLWARN0 NOT = SPACE                                32360000
323700         WHEN SQLCODE NOT = ZERO                                  32370000
323800              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         32380000
323900              MOVE 'FETCH CURSOR PROBLEM '                        32390000
324000                               TO DP013-MESSAGE-TEXT (1)          32400000
324100              MOVE SQLCA       TO DP013-SQLCA                     32410000
324200              MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)       32420000
324300              SET DP013-DB2-ABEND TO TRUE                         32430000
324400              PERFORM DP013-0000-PROCESS-ABEND                    32440000
324500     END-EVALUATE.                                                32450000
324600                                                                  32460000
324700     IF  SQLCODE EQUAL +100                                       32470000
324800         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      32480000
324900     END-IF.                                                      32490000
325000                                                                  32500000
325100                                                                  32510000
325200*----------------------------------------------------------------*32520000
325300*    GET THE SKU NUMBER USING XLKUT001                            32530000
325400*----------------------------------------------------------------*32540000
325500 4320-GET-SKU.                                                    32550000
325600     INITIALIZE XL001-ITEM-COMMAREA.                              32560000
325700     MOVE SUT00030-UPC-NBR TO XL001-KEY-UPC-NBR.                  32570000
325800     SET  XL001-BY-UPC-NBR                                        32580000
325900          XL001-SELECT-SKU     TO TRUE.                           32590000
326000     CALL XL001-VSM-PGM USING DFHEIBLK                            32600000
326100                           XL001-COMMAREA                         32610000
326200                           XL001-ITEM-COMMAREA.                   32620000
326300     EVALUATE TRUE                                                32630000
326400         WHEN XL001-SUCCESSFUL                                    32640000
326500              CONTINUE                                            32650000
326600         WHEN OTHER                                               32660000
326700             MOVE ZEROES TO XL001-SKU-NBR                         32670000
326800     END-EVALUATE.                                                32680000
326900                                                                  32690000
327000*----------------------------------------------------------------*32700000
327100*    GET THE PROCESS REASON DESCRIPTION FROM TSURSNC              32710000
327200*----------------------------------------------------------------*32720000
327300 4330-GET-ADJ-SOURCE.                                             32730000
327400                                                                  32740000
327500      PERFORM 4331-OPEN-CURSOR.                                   32750000
327600      PERFORM 4332-FETCH-CURSOR UNTIL SQLCODE = +100 OR PS-DONE   32760000
327700      PERFORM 4333-CLOSE-CURSOR.                                  32770000
327800      MOVE 'N' TO PS-DONE-SW.                                     32780000
327900                                                                  32790000
328000*----------------------------------------------------------------*32800000
328100* OPEN THE CURSOR                                                 32810000
328200*----------------------------------------------------------------*32820000
328300 4331-OPEN-CURSOR.                                                32830000
328400                                                                  32840000
328500     EXEC SQL                                                     32850000
328600          OPEN SOURCE-CSR                                         32860000
328700     END-EXEC.                                                    32870000
328800                                                                  32880000
328900     EVALUATE TRUE                                                32890000
329000         WHEN SQLCODE = ZERO                                      32900000
329100         WHEN SQLCODE = -904                                      32910000
329200         WHEN SQLCODE = -913                                      32920000
329300             CONTINUE                                             32930000
329400         WHEN SQLWARN0 NOT = SPACES                               32940000
329500         WHEN SQLCODE < ZERO                                      32950000
329600         WHEN SQLCODE > ZERO                                      32960000
329700             MOVE '4331-OPEN-CURSOR' TO DP013-PARAGRAPH           32970000
329800             MOVE 'OPEN CURSOR PROBLEM    - '                     32980000
329900                                   TO DP013-MESSAGE-TEXT (1)      32990000
330000             MOVE SQLCA        TO DP013-SQLCA                     33000000
330100             MOVE 'TSURSNC '   TO DP013-DB2-TABLE-NAME (1)        33010000
330200             SET DP013-DB2-ABEND                                  33020000
330300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33030000
330400             PERFORM DP013-0000-PROCESS-ABEND                     33040000
330500     END-EVALUATE.                                                33050000
330600                                                                  33060000
330700*----------------------------------------------------------------*33070000
330800*    FETCH THE CURSOR                                             33080000
330900*----------------------------------------------------------------*33090000
331000 4332-FETCH-CURSOR.                                               33100000
331100     EXEC SQL                                                     33110000
331200          FETCH SOURCE-CSR                                        33120000
331300          INTO  :ASC-ADJ-SRC-NAME                                 33130000
331400     END-EXEC.                                                    33140000
331500                                                                  33150000
331600     EVALUATE TRUE                                                33160000
331700         WHEN SQLCODE = ZERO                                      33170000
331800             IF ASC-ADJ-SRC-NAME-HOLD  = SPACES                   33180000
331900                 MOVE ASC-ADJ-SRC-NAME TO ASC-ADJ-SRC-NAME-HOLD   33190000
332000             ELSE                                                 33200000
332100                 IF ASC-ADJ-SRC-NAME-HOLD NOT = ASC-ADJ-SRC-NAME  33210000
332200                    MOVE 'MULTIPLE'   TO ASC-ADJ-SRC-NAME-HOLD    33220000
332300                    SET PS-DONE TO TRUE                           33230000
332400                 ELSE                                             33240000
332500                    MOVE ASC-ADJ-SRC-NAME TO ASC-ADJ-SRC-NAME-HOLD33250000
332600                 END-IF                                           33260000
332700             END-IF                                               33270000
332800         WHEN SQLCODE = +100                                      33280000
332900             SET PS-DONE TO TRUE                                  33290000
333000         WHEN SQLWARN0 NOT = SPACE                                33300000
333100         WHEN SQLCODE NOT = ZERO                                  33310000
333200              MOVE '4332-FETCH-CURSOR' TO DP013-PARAGRAPH         33320000
333300              MOVE 'FETCH CURSOR PROBLEM '                        33330000
333400                               TO DP013-MESSAGE-TEXT (1)          33340000
333500              MOVE SQLCA       TO DP013-SQLCA                     33350000
333600              MOVE 'TSURSNC '   TO DP013-DB2-TABLE-NAME (1)       33360000
333700              SET DP013-DB2-ABEND TO TRUE                         33370000
333800              PERFORM DP013-0000-PROCESS-ABEND                    33380000
333900     END-EVALUATE.                                                33390000
334000                                                                  33400000
334100*----------------------------------------------------------------*33410000
334200* CLOSE THE CURSOR.                                               33420000
334300*-----------------------------------------------------------------33430000
334400 4333-CLOSE-CURSOR.                                               33440000
334500                                                                  33450000
334600     EXEC SQL                                                     33460000
334700          CLOSE SOURCE-CSR                                        33470000
334800     END-EXEC.                                                    33480000
334900                                                                  33490000
335000     EVALUATE TRUE                                                33500000
335100         WHEN SQLCODE = ZERO                                      33510000
335200         WHEN SQLCODE = +100                                      33520000
335300             CONTINUE                                             33530000
335400         WHEN SQLWARN0 NOT = SPACES                               33540000
335500         WHEN SQLCODE < ZERO                                      33550000
335600         WHEN SQLCODE > ZERO                                      33560000
335700             MOVE '4333-CLOSE-CURSOR' TO DP013-PARAGRAPH          33570000
335800             MOVE 'CLOSE CURSOR PROBLEM '                         33580000
335900                               TO DP013-MESSAGE-TEXT (1)          33590000
336000             MOVE SQLCA        TO DP013-SQLCA                     33600000
336100             MOVE 'TSURSNC '   TO DP013-DB2-TABLE-NAME (1)        33610000
336200             SET DP013-DB2-ABEND                                  33620000
336300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33630000
336400             PERFORM DP013-0000-PROCESS-ABEND                     33640000
336500     END-EVALUATE.                                                33650000
336600                                                                  33660000
336700*----------------------------------------------------------------*33670000
336800* GET REST OF THE INFORMATION                                     33680000
336900* CHECK TO SEE IF THERE ARE ANY ADJUSTMENTS THAT FAILED BUT HAVE  33690000
337000* NOT BEEN ACKNOWLEDGED.                                          33700000
337100*----------------------------------------------------------------*33710000
337200 4340-GET-REST-OF-INFO.                                           33720000
337300                                                                  33730000
337400     EXEC SQL                                                     33740000
337500         SELECT 1                                                 33750000
337600           INTO :PV-ONE                                           33760000
337700           FROM SYSIBM.SYSDUMMY1 X                                33770000
337800          WHERE  EXISTS (SELECT 1                                 33780000
337900               FROM SUT_FINCL_ADJ                                 33790000
338000        WHERE  AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN         33800000
338100          AND  AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END           33810000
338200          AND  AUTO_APL_IND       = 'N'                           33820000
338300          AND  RSLV_BY_USR_ID     = '        '                    33830000
338400          AND  CRE_TMST          >= :PV-FROM-TMST                 33840000
338500          AND  CRE_TMST          <= :PV-TO-TMST                   33850000
338600          AND  ORGN_LOC_NBR       = :PV-OPER-UNT-ID               33860000
338700          AND  PO_NBR             = :PV-PO                        33870000
338800          AND  RCVR_SEQ_NBR       = :PV-RCVR                      33880000
338900          AND  RCVR_LNE_NBR       = :PV-LINE                      33890000
339000          AND  DEST_LOC_NBR      >= :DK-STR-BEGIN                 33900000
339100          AND  DEST_LOC_NBR      <= :DK-STR-END                   33910000
339200          AND  UPC_NBR            = :PV-UPC                       33920000
339300          AND  X.IBMREQD > '')                                    33930000
339400     END-EXEC.                                                    33940000
339500                                                                  33950000
339600     EVALUATE TRUE                                                33960000
339700         WHEN SQLCODE = +0                                        33970000
339800             SET PS-FAIL-UNACKNOW TO TRUE                         33980000
339900         WHEN OTHER                                               33990000
340000             SET PS-NO-FAIL-UNACKNOW TO TRUE                      34000000
340100     END-EVALUATE.                                                34010000
340200                                                                  34020000
340300     PERFORM 4350-CHECK-OTHER-INFO.                               34030000
340400                                                                  34040000
340500*----------------------------------------------------------------*34050000
340600* CHECK TO SEE IF THERE ARE ANY ADJUSTMENTS THAT FAILED BUT HAVE  34060000
340700* BEEN ACKNOWLEDGED.                                              34070000
340800*----------------------------------------------------------------*34080000
340900 4350-CHECK-OTHER-INFO.                                           34090000
341000                                                                  34100000
341100     EXEC SQL                                                     34110000
341200         SELECT 1                                                 34120000
341300           INTO :PV-ONE                                           34130000
341400           FROM SYSIBM.SYSDUMMY1 X                                34140000
341500          WHERE  EXISTS (SELECT 1                                 34150000
341600               FROM SUT_FINCL_ADJ                                 34160000
341700        WHERE  AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN         34170000
341800          AND  AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END           34180000
341900          AND  AUTO_APL_IND       = 'N'                           34190000
342000          AND  RSLV_BY_USR_ID NOT LIKE '        '                 34200000
342100          AND  CRE_TMST          >= :PV-FROM-TMST                 34210000
342200          AND  CRE_TMST          <= :PV-TO-TMST                   34220000
342300          AND  ORGN_LOC_NBR       = :PV-OPER-UNT-ID               34230000
342400          AND  PO_NBR             = :PV-PO                        34240000
342500          AND  RCVR_SEQ_NBR       = :PV-RCVR                      34250000
342600          AND  RCVR_LNE_NBR       = :PV-LINE                      34260000
342700          AND  DEST_LOC_NBR      >= :DK-STR-BEGIN                 34270000
342800          AND  DEST_LOC_NBR      <= :DK-STR-END                   34280000
342900          AND  UPC_NBR            = :PV-UPC                       34290000
343000          AND  X.IBMREQD > '')                                    34300000
343100     END-EXEC.                                                    34310000
343200                                                                  34320000
343300     EVALUATE TRUE                                                34330000
343400         WHEN SQLCODE = +0                                        34340000
343500             SET PS-FAIL-ACKNOW TO TRUE                           34350000
343600         WHEN OTHER                                               34360000
343700             SET PS-NO-FAIL-ACKNOW TO TRUE                        34370000
343800     END-EVALUATE.                                                34380000
343900                                                                  34390000
344000*----------------------------------------------------------------*34400000
344100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *34410000
344200*----------------------------------------------------------------*34420000
344300 4400-MOVE-COMMAREA-TO-SCREEN.                                    34430000
344400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             34440000
344500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          34450000
344600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          34460000
344700             MOVE +1    TO ASC-BLK-SUB                            34470000
344800             PERFORM 5100-WRITE-TEMP-STORAGE                      34480000
344900             ADD +1     TO ASC-BLK-SUB                            34490000
345000             PERFORM 5100-WRITE-TEMP-STORAGE                      34500000
345100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             34510000
345200                 GIVING PV-BLOCK-NUMBER                           34520000
345300                 REMAINDER PV-REMAINDER                           34530000
345400             IF  PV-REMAINDER > ZERO                              34540000
345500                 ADD +1 TO PV-BLOCK-NUMBER                        34550000
345600             END-IF                                               34560000
345700             MOVE +1    TO ASC-BLK-SUB                            34570000
345800             PERFORM 4410-READ-TEMP-STORAGE                       34580000
345900             ADD +1     TO ASC-BLK-SUB                            34590000
346000                           PV-BLOCK-NUMBER                        34600000
346100             PERFORM 4410-READ-TEMP-STORAGE                       34610000
346200     END-IF.                                                      34620000
346300     MOVE +1            TO ASC-BLK-SUB.                           34630000
346400     COMPUTE ASC-ITEM-SUB =                                       34640000
346500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              34650000
346600         + PC-ITEMS-PER-PANEL).                                   34660000
346700*                                                                 34670000
346800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        34680000
346900         ADD +1         TO ASC-BLK-SUB                            34690000
347000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            34700000
347100     END-IF.                                                      34710000
347200*                                                                 34720000
347300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           34730000
347400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                34740000
347500     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        34750000
347600     PERFORM 4420-FORMAT-LIST-LINES                               34760000
347700         VARYING PV-SUB                                           34770000
347800         FROM PC-ITEMS-PER-PANEL BY -1                            34780000
347900         UNTIL PV-SUB < +1.                                       34790000
348000*                                                                 34800000
348100     COMPUTE ASC-ITEMS-DISPLAYED =                                34810000
348200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          34820000
348300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    34830000
348400                                      ASTRTITO.                   34840000
348500     MOVE ASC-ITEM-AT-BOT-OF-PANEL     TO AENDITO.                34850000
348600     MOVE ASC-NUMBER-OF-ITEMS-READ     TO ATOTITO.                34860000
348700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ASELITO.                34870000
348800                                                                  34880000
348900     IF ASC-UNT-ADJ-TYP = 'P'                                     34890000
349000         MOVE 'POST VERIFY'     TO AADJTYPO                       34900000
349100     ELSE                                                         34910000
349200         IF ASC-UNT-ADJ-TYP = 'C'                                 34920000
349300             MOVE 'CONFIRM    '     TO AADJTYPO                   34930000
349400         ELSE                                                     34940000
349500             IF ASC-UNT-ADJ-TYP = 'V'                             34950000
349600                 MOVE 'VERIFY    '  TO AADJTYPO                   34960000
349700             ELSE                                                 34970000
349800                 IF ASC-UNT-ADJ-TYP = 'Q'                         34980000
349900                     MOVE 'P2L ADJUST'  TO AADJTYPO               34990000
350000                 ELSE                                             35000000
350100                     MOVE 'ALL       '  TO AADJTYPO               35010000
350200                 END-IF                                           35020000
350300             END-IF                                               35030000
350400         END-IF                                                   35040000
350500     END-IF.                                                      35050000
350600     IF ASC-FAIL-SUCCESS-IND = 'F'                                35060000
350700         MOVE 'FAIL       '     TO ASTATUSO                       35070000
350800     ELSE                                                         35080000
350900         IF ASC-FAIL-SUCCESS-IND = 'S'                            35090000
351000             MOVE 'SUCCESSFUL '     TO ASTATUSO                   35100000
351100         ELSE                                                     35110000
351200             IF ASC-FAIL-SUCCESS-IND = 'U'                        35120000
351300                 MOVE 'UNACKNOWLEDGED'  TO ASTATUSO               35130000
351400             ELSE                                                 35140000
351500                 MOVE 'ALL           '  TO ASTATUSO               35150000
351600             END-IF                                               35160000
351700         END-IF                                                   35170000
351800     END-IF.                                                      35180000
351900                                                                  35190000
352000     MOVE  ASC-PROCESS-GRP-DESC  TO  AGROUPO.                     35200000
352100                                                                  35210000
352200     IF ASC-STR-NBR  =  ZEROES                                    35220000
352300         MOVE 'ALL '                TO ASTOREO                    35230000
352400     ELSE                                                         35240000
352500         MOVE ASC-STR-NAME          TO ASTOREO                    35250000
352600     END-IF.                                                      35260000
352700     MOVE ASC-FROM-YY          TO DK-DIS-YY                       35270000
352800     MOVE ASC-FROM-MM          TO DK-DIS-MM                       35280000
352900     MOVE ASC-FROM-DD          TO DK-DIS-DD                       35290000
353000     MOVE DK-DISPLAY-DATE      TO AFRDATEO                        35300000
353100     MOVE ASC-TO-YY            TO DK-DIS-YY                       35310000
353200     MOVE ASC-TO-MM            TO DK-DIS-MM                       35320000
353300     MOVE ASC-TO-DD            TO DK-DIS-DD                       35330000
353400     MOVE DK-DISPLAY-DATE      TO ATODATEO                        35340000
353500     MOVE ASC-TOTAL-NET-ADJUST TO ANETADJO                        35350000
353600                                                                  35360000
353700     IF  DP020-MSG-NUMBER-X = SPACE                               35370000
353800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  35380000
353900*            --- MORE ITEMS TO DISPLAY ----                       35390000
354000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            35400000
354100             SET DP020-MSG-INFORMATIONAL TO TRUE                  35410000
354200         END-IF                                                   35420000
354300     END-IF.                                                      35430000
354400                                                                  35440000
354500*----------------------------------------------------------------*35450000
354600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *35460000
354700*----------------------------------------------------------------*35470000
354800 4410-READ-TEMP-STORAGE.                                          35480000
354900                                                                  35490000
355000     EXEC CICS                                                    35500000
355100         READQ TS                                                 35510000
355200             QUEUE (ASC-LIST-QUEUE-NAME)                          35520000
355300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35530000
355400             ITEM  (PV-BLOCK-NUMBER)                              35540000
355500             RESP  (PV-CICS-RESP)                                 35550000
355600     END-EXEC.                                                    35560000
355700                                                                  35570000
355800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       35580000
355900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     35590000
356000         CONTINUE                                                 35600000
356100     ELSE                                                         35610000
356200         SET DP013-CICS-ABEND     TO TRUE                         35620000
356300         SET DP013-NO-ROLLBACK    TO TRUE                         35630000
356400         MOVE '4410-READ-TEMP-STORAGE'                            35640000
356500                                  TO DP013-PARAGRAPH              35650000
356600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      35660000
356700                                  TO DP013-MESSAGE-TEXT(1)        35670000
356800         PERFORM DP013-0000-PROCESS-ABEND                         35680000
356900     END-IF.                                                      35690000
357000                                                                  35700000
357100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35710000
357200*                                                                 35720000
357300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         35730000
357400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               35740000
357500     END-IF.                                                      35750000
357600                                                                  35760000
357700*----------------------------------------------------------------*35770000
357800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *35780000
357900*----------------------------------------------------------------*35790000
358000 4420-FORMAT-LIST-LINES.                                          35800000
358100     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      35810000
358200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                35820000
358300         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           35830000
358400         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           35840000
358500         MOVE SPACE              TO MR-SELECTI    (PV-SUB)        35850000
358600                                    MR-ACTION     (PV-SUB)        35860000
358700                                    MR-PO-RCVR    (PV-SUB)        35870000
358800                                    MR-NET-ADJ    (PV-SUB)        35880000
358900                                    MR-ADJ-SOURCE (PV-SUB)        35890000
359000                                    MR-FAIL-SUCCSS(PV-SUB)        35900000
359100                                    MR-ACKNOWLEDGE(PV-SUB)        35910000
359200          MOVE ZEROES            TO MR-OPER-UNT-ID(PV-SUB)        35920000
359300                                    MR-LINE       (PV-SUB)        35930000
359400                                    MR-UPC        (PV-SUB)        35940000
359500                                    MR-SKU        (PV-SUB)        35950000
359600     ELSE                                                         35960000
359700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      35970000
359800                                                   > SPACE        35980000
359900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 35990000
360000                                 TO MR-SELECTI (PV-SUB)           36000000
360100         ELSE                                                     36010000
360200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      36020000
360300                                 TO MR-SELECTI (PV-SUB)           36030000
360400         END-IF                                                   36040000
360500         IF  DP030-SET-CURSOR-TRAILER                             36050000
360600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)36060000
360700                 > SPACE)                                         36070000
360800               OR (PV-SUB = 1))                                   36080000
360900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               36090000
361000                MOVE -1               TO MR-SELECTL (PV-SUB)      36100000
361100             END-IF                                               36110000
361200         END-IF                                                   36120000
361300*                                                                 36130000
361400         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               36140000
361500                                            TO MR-ACTION (PV-SUB) 36150000
361600         MOVE ASC-OPER-UNT (ASC-BLK-SUB ASC-ITEM-SUB)             36160000
361700                                       TO MR-OPER-UNT-ID (PV-SUB) 36170000
361800         MOVE ASC-PO-RCVR (ASC-BLK-SUB ASC-ITEM-SUB)              36180000
361900                                           TO MR-PO-RCVR (PV-SUB) 36190000
362000         MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             36200000
362100                                              TO MR-LINE  (PV-SUB)36210000
362200         MOVE ASC-UPC-NBR (ASC-BLK-SUB ASC-ITEM-SUB)              36220000
362300                                                TO MR-UPC (PV-SUB)36230000
362400         MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)              36240000
362500                                                TO MR-SKU (PV-SUB)36250000
362600         MOVE ASC-TOT-NET-ADJ (ASC-BLK-SUB ASC-ITEM-SUB)          36260000
362700                                            TO MR-NET-ADJ (PV-SUB)36270000
362800         MOVE ASC-ADJ-SRCE (ASC-BLK-SUB ASC-ITEM-SUB)             36280000
362900                                         TO MR-ADJ-SOURCE (PV-SUB)36290000
363000         MOVE ASC-FAIL-SUCCSS (ASC-BLK-SUB ASC-ITEM-SUB)          36300000
363100                                        TO MR-FAIL-SUCCSS (PV-SUB)36310000
363200         MOVE ASC-ACKNOWLEDGE (ASC-BLK-SUB ASC-ITEM-SUB)          36320000
363300                                        TO MR-ACKNOWLEDGE (PV-SUB)36330000
363400         IF MR-FAIL-SUCCSS (PV-SUB) = 'F'  AND                    36340000
363500            MR-ACKNOWLEDGE (PV-SUB) = 'U'                         36350000
363600             MOVE DP015-YELLOW         TO MR-OPER-UNT-IDC (PV-SUB)36360000
363700             MOVE -1                   TO MR-OPER-UNT-IDL (PV-SUB)36370000
363800             MOVE DP015-YELLOW         TO MR-PO-RCVRC     (PV-SUB)36380000
363900             MOVE -1                   TO MR-PO-RCVRL     (PV-SUB)36390000
364000             MOVE DP015-YELLOW         TO MR-LINEC        (PV-SUB)36400000
364100             MOVE -1                   TO MR-LINEL        (PV-SUB)36410000
364200             MOVE DP015-YELLOW         TO MR-UPCC         (PV-SUB)36420000
364300             MOVE -1                   TO MR-UPCL         (PV-SUB)36430000
364400             MOVE DP015-YELLOW         TO MR-SKUC         (PV-SUB)36440000
364500             MOVE -1                   TO MR-SKUL         (PV-SUB)36450000
364600             MOVE DP015-YELLOW         TO MR-NET-ADJC     (PV-SUB)36460000
364700             MOVE -1                   TO MR-NET-ADJL     (PV-SUB)36470000
364800             MOVE DP015-YELLOW         TO MR-ADJ-SOURCEC  (PV-SUB)36480000
364900             MOVE -1                   TO MR-ADJ-SOURCEL  (PV-SUB)36490000
365000             MOVE DP015-YELLOW         TO MR-FAIL-SUCCSSC (PV-SUB)36500000
365100             MOVE -1                   TO MR-FAIL-SUCCSSL (PV-SUB)36510000
365200             MOVE DP015-YELLOW         TO MR-ACKNOWLEDGEC (PV-SUB)36520000
365300             MOVE -1                   TO MR-ACKNOWLEDGEL (PV-SUB)36530000
365400         ELSE                                                     36540000
365500             MOVE DP015-BLUE           TO MR-OPER-UNT-IDC (PV-SUB)36550000
365600             MOVE 0                    TO MR-OPER-UNT-IDL (PV-SUB)36560000
365700             MOVE DP015-BLUE           TO MR-PO-RCVRC     (PV-SUB)36570000
365800             MOVE 0                    TO MR-PO-RCVRL     (PV-SUB)36580000
365900             MOVE DP015-BLUE           TO MR-LINEC        (PV-SUB)36590000
366000             MOVE 0                    TO MR-LINEL        (PV-SUB)36600000
366100             MOVE DP015-BLUE           TO MR-UPCC         (PV-SUB)36610000
366200             MOVE 0                    TO MR-UPCL         (PV-SUB)36620000
366300             MOVE DP015-BLUE           TO MR-SKUC         (PV-SUB)36630000
366400             MOVE 0                    TO MR-SKUL         (PV-SUB)36640000
366500             MOVE DP015-BLUE           TO MR-NET-ADJC     (PV-SUB)36650000
366600             MOVE 0                    TO MR-NET-ADJL     (PV-SUB)36660000
366700             MOVE DP015-BLUE           TO MR-ADJ-SOURCEC  (PV-SUB)36670000
366800             MOVE 0                    TO MR-ADJ-SOURCEL  (PV-SUB)36680000
366900             MOVE DP015-BLUE           TO MR-FAIL-SUCCSSC (PV-SUB)36690000
367000             MOVE 0                    TO MR-FAIL-SUCCSSL (PV-SUB)36700000
367100             MOVE DP015-BLUE           TO MR-ACKNOWLEDGEC (PV-SUB)36710000
367200             MOVE 0                    TO MR-ACKNOWLEDGEL (PV-SUB)36720000
367300         END-IF                                                   36730000
367400     END-IF.                                                      36740000
367500     SUBTRACT +1 FROM ASC-ITEM-SUB                                36750000
367600     IF  ASC-ITEM-SUB < + 1                                       36760000
367700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  36770000
367800         MOVE +1                 TO ASC-BLK-SUB                   36780000
367900     END-IF.                                                      36790000
368000                                                                  36800000
368100******************************************************************36810000
368200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **36820000
368300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **36830000
368400** ISSUE A WARNING.                                             **36840000
368500******************************************************************36850000
368600 4430-CHECK-FOR-BEGIN-AND-END.                                    36860000
368700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       36870000
368800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     36880000
368900*            -- NO END-OF-RANGE SPECFIED ---                      36890000
369000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            36900000
369100             SET DP020-MSG-WARNING TO TRUE                        36910000
369200             PERFORM 4431-POSITION-AT-WARNING                     36920000
369300         END-IF                                                   36930000
369400     ELSE                                                         36940000
369500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     36950000
369600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                36960000
369700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            36970000
369800             SET DP020-MSG-WARNING TO TRUE                        36980000
369900             PERFORM 4431-POSITION-AT-WARNING                     36990000
370000         END-IF                                                   37000000
370100     END-IF.                                                      37010000
370200******************************************************************37020000
370300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **37030000
370400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **37040000
370500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **37050000
370600** POSITION THE CURSOR THERE.                                   **37060000
370700******************************************************************37070000
370800 4431-POSITION-AT-WARNING.                                        37080000
370900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 37090000
371000                    - PV-TOP-ITEM + 1.                            37100000
371100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      37110000
371200         CONTINUE                                                 37120000
371300     ELSE                                                         37130000
371400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      37140000
371500         MOVE -1                    TO ASTRTITL                   37150000
371600     END-IF.                                                      37160000
371700*                                                                 37170000
371800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   37180000
371900                    - PV-TOP-ITEM + 1.                            37190000
372000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      37200000
372100         CONTINUE                                                 37210000
372200     ELSE                                                         37220000
372300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      37230000
372400         MOVE -1                   TO ASTRTITL                    37240000
372500     END-IF.                                                      37250000
372600                                                                  37260000
372700*----------------------------------------------------------------*37270000
372800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *37280000
372900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *37290000
373000* FOR THE SELECTED ITEMS QUEUE.                                  *37300000
373100*                                                                *37310000
373200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *37320000
373300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *37330000
373400* THE ARRAY IS FULL.                                             *37340000
373500*----------------------------------------------------------------*37350000
373600 5000-PREPARE-SEL-QUEUE.                                          37360000
373700                                                                  37370000
373800     MOVE +1                   TO  ASC-BLK-SUB.                   37380000
373900     PERFORM 5100-WRITE-TEMP-STORAGE.                             37390000
374000     ADD +1                    TO  ASC-BLK-SUB.                   37400000
374100     PERFORM 5100-WRITE-TEMP-STORAGE.                             37410000
374200                                                                  37420000
374300     MOVE ASC-SEL-QUEUE-NAME   TO  SU038-SEL-QUEUE-NAME.          37430000
374400     PERFORM 6010-DELETE-SEL-QUEUE.                               37440000
374500                                                                  37450000
374600     SET ASC-UPDATE-TSQ        TO  TRUE.                          37460000
374700                                                                  37470000
374800     SET SU039-IDX             TO  1.                             37480000
374900     MOVE ZERO                 TO SU038-NUMBER-OF-TS-ITEMS.       37490000
375000     INITIALIZE SU039-SELECTED-ITEM-ARRAY.                        37500000
375100                                                                  37510000
375200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           37520000
375300             VARYING PV-ITEM                                      37530000
375400             FROM 1 BY 1                                          37540000
375500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     37550000
375600                                                                  37560000
375700     IF  SU039-IDX > 1                                            37570000
375800         PERFORM 5205-WRITE-SEL-QUEUE                             37580000
375900         ADD +1                TO SU038-NUMBER-OF-TS-ITEMS        37590000
376000     END-IF.                                                      37600000
376100*----------------------------------------------------------------*37610000
376200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *37620000
376300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *37630000
376400*----------------------------------------------------------------*37640000
376500 5100-WRITE-TEMP-STORAGE.                                         37650000
376600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     37660000
376700                                   TO PV-LIST-ITEM-NUMBER.        37670000
376800     COMPUTE PV-BLOCK-NUMBER =                                    37680000
376900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37690000
377000                                                                  37700000
377100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             37710000
377200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             37720000
377300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      37730000
377400             PERFORM 5105-REWRITE-ASC-LISTQ                       37740000
377500         END-IF                                                   37750000
377600     ELSE                                                         37760000
377700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       37770000
377800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            37780000
377900         PERFORM 5110-WRITE-ASC-LISTQ                             37790000
378000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   37800000
378100     END-IF.                                                      37810000
378200                                                                  37820000
378300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             37830000
378400                                                                  37840000
378500******************************************************************37850000
378600** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **37860000
378700** SPECIFIC COMMAREA.                                           **37870000
378800******************************************************************37880000
378900 5105-REWRITE-ASC-LISTQ.                                          37890000
379000     EXEC CICS                                                    37900000
379100         WRITEQ TS                                                37910000
379200             QUEUE (ASC-LIST-QUEUE-NAME)                          37920000
379300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37930000
379400             ITEM  (PV-BLOCK-NUMBER)                              37940000
379500             REWRITE                                              37950000
379600             RESP  (PV-CICS-RESP)                                 37960000
379700     END-EXEC.                                                    37970000
379800                                                                  37980000
379900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           37990000
380000         CONTINUE                                                 38000000
380100     ELSE                                                         38010000
380200         SET DP013-CICS-ABEND            TO TRUE                  38020000
380300         SET DP013-NO-ROLLBACK           TO TRUE                  38030000
380400         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       38040000
380500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     38050000
380600                                         TO DP013-MESSAGE-TEXT(1) 38060000
380700         PERFORM DP013-0000-PROCESS-ABEND                         38070000
380800     END-IF.                                                      38080000
380900                                                                  38090000
381000******************************************************************38100000
381100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **38110000
381200** SPECIFIC COMMAREA.                                           **38120000
381300******************************************************************38130000
381400 5110-WRITE-ASC-LISTQ.                                            38140000
381500     EXEC CICS                                                    38150000
381600         WRITEQ TS                                                38160000
381700             QUEUE (ASC-LIST-QUEUE-NAME)                          38170000
381800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               38180000
381900             ITEM  (PV-BLOCK-NUMBER)                              38190000
382000             RESP  (PV-CICS-RESP)                                 38200000
382100     END-EXEC.                                                    38210000
382200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      38220000
382300         SET DP013-CICS-ABEND      TO TRUE                        38230000
382400         SET DP013-NO-ROLLBACK     TO TRUE                        38240000
382500         MOVE '5110-WRITE-ASC-LISTQ'                              38250000
382600                                   TO DP013-PARAGRAPH             38260000
382700         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           38270000
382800                                   TO DP013-MESSAGE-TEXT(1)       38280000
382900         PERFORM DP013-0000-PROCESS-ABEND                         38290000
383000     END-IF.                                                      38300000
383100                                                                  38310000
383200*----------------------------------------------------------------*38320000
383300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *38330000
383400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *38340000
383500*----------------------------------------------------------------*38350000
383600 5200-FILL-SEL-QUEUE-RECORD.                                      38360000
383700                                                                  38370000
383800     PERFORM 6112-READ-LIST-QUEUE.                                38380000
383900                                                                  38390000
384000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38400000
384100         PERFORM                                                  38410000
384200         VARYING LQW-IDX                                          38420000
384300         FROM 1 BY 1                                              38430000
384400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38440000
384500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          38450000
384600                                                                  38460000
384700             IF  LQW-SELECT (LQW-IDX)                             38470000
384800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              38480000
384900                                   TO SU039-ITEM (SU039-IDX)      38490000
385000                 MOVE SPACE        TO SU039-ACTION-SW (SU039-IDX) 38500000
385100                                                                  38510000
385200                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   38520000
385300                                 TO SU039-OPER-UNT-ID (SU039-IDX) 38530000
385400                 MOVE LQW-PO-RCVR (LQW-IDX)                       38540000
385500                                     TO SU039-PO-RCVR (SU039-IDX) 38550000
385600                 MOVE LQW-LINE-NBR(LQW-IDX)                       38560000
385700                                        TO SU039-LINE (SU039-IDX) 38570000
385800                 MOVE LQW-UPC-NBR (LQW-IDX)                       38580000
385900                                         TO SU039-UPC (SU039-IDX) 38590000
386000                 MOVE LQW-SKU-NBR (LQW-IDX)                       38600000
386100                                         TO SU039-SKU (SU039-IDX) 38610000
386200                 MOVE LQW-NET-ADJ (LQW-IDX)                       38620000
386300                                     TO SU039-NET-ADJ (SU039-IDX) 38630000
386400                 MOVE LQW-ADJ-SOURCE (LQW-IDX)                    38640000
386500                                  TO SU039-ADJ-SOURCE (SU039-IDX) 38650000
386600                 MOVE ASC-SHIPT-UNT-ID                            38660000
386700                                  TO SU039-SHIPT-UNT-ID(SU039-IDX)38670000
386800                 MOVE LQW-FAIL-SUCCSS (LQW-IDX)                   38680000
386900                                 TO SU039-FAIL-SUCCSS (SU039-IDX) 38690000
387000                 MOVE LQW-ACKNOWLEDGE (LQW-IDX)                   38700000
387100                                 TO SU039-ACKNOWLEDGE (SU039-IDX) 38710000
387200                                                                  38720000
387300                 SET SU039-IDX UP BY 1                            38730000
387400                 IF  SU039-IDX > SU039-MAX-ITEMS                  38740000
387500                     PERFORM 5205-WRITE-SEL-QUEUE                 38750000
387600                     ADD +1        TO SU038-NUMBER-OF-TS-ITEMS    38760000
387700                     INITIALIZE SU039-SELECTED-ITEM-ARRAY         38770000
387800                     SET SU039-IDX TO  1                          38780000
387900                 END-IF                                           38790000
388000             END-IF                                               38800000
388100         END-PERFORM                                              38810000
388200     END-IF.                                                      38820000
388300                                                                  38830000
388400*----------------------------------------------------------------*38840000
388500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *38850000
388600*----------------------------------------------------------------*38860000
388700 5205-WRITE-SEL-QUEUE.                                            38870000
388800                                                                  38880000
388900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38890000
389000                                   TO SU039-SELECTED-ITEMS.       38900000
389100                                                                  38910000
389200     EXEC CICS                                                    38920000
389300          WRITEQ TS                                               38930000
389400              QUEUE (ASC-SEL-QUEUE-NAME)                          38940000
389500              FROM  (SU039-SELECT-RECORD)                         38950000
389600              ITEM  (PV-SEL-QUEUE-ITEM)                           38960000
389700              RESP  (PV-CICS-RESP)                                38970000
389800     END-EXEC.                                                    38980000
389900                                                                  38990000
390000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39000000
390100         CONTINUE                                                 39010000
390200     ELSE                                                         39020000
390300         SET DP013-CICS-ABEND      TO TRUE                        39030000
390400         SET DP013-NO-ROLLBACK     TO TRUE                        39040000
390500         MOVE '5205-WRITE-SEL-QUEUE'                              39050000
390600                                   TO DP013-PARAGRAPH             39060000
390700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          39070000
390800                                   TO DP013-MESSAGE-TEXT(1)       39080000
390900         PERFORM DP013-0000-PROCESS-ABEND                         39090000
391000     END-IF.                                                      39100000
391100******************************************************************39110000
391200** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **39120000
391300** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **39130000
391400** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **39140000
391500** THE USER.                                                    **39150000
391600******************************************************************39160000
391700 6000-REFRESH-PANEL-FROM-TEMP.                                    39170000
391800     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      39180000
391900         SET ASC-NO-TSQ-UPDATE TO TRUE                            39190000
392000         MOVE ZERO                 TO PV-SAVE-ITEM                39200000
392100                                      PV-SEL-QUEUE-ITEM           39210000
392200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        39220000
392300                                   TO PV-HOLD-SELECTED-ITEMS      39230000
392400         MOVE +1                   TO PV-ITEMS-PROCESSED          39240000
392500         PERFORM 6100-UPDATE-TSQ                                  39250000
392600             UNTIL PV-ITEMS-PROCESSED >                           39260000
392700                                     PV-HOLD-SELECTED-ITEMS       39270000
392800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         39280000
392900                    ASC-BLOCK-ENTRIES (2)                         39290000
393000     END-IF.                                                      39300000
393100                                                                  39310000
393200*----------------------------------------------------------------*39320000
393300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *39330000
393400*----------------------------------------------------------------*39340000
393500 6010-DELETE-SEL-QUEUE.                                           39350000
393600                                                                  39360000
393700     EXEC CICS                                                    39370000
393800         DELETEQ TS                                               39380000
393900             QUEUE (ASC-SEL-QUEUE-NAME)                           39390000
394000             RESP  (PV-CICS-RESP)                                 39400000
394100     END-EXEC.                                                    39410000
394200*                                                                 39420000
394300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      39430000
394400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         39440000
394500         CONTINUE                                                 39450000
394600     ELSE                                                         39460000
394700         SET DP013-CICS-ABEND TO TRUE                             39470000
394800         SET DP013-NO-ROLLBACK TO TRUE                            39480000
394900         MOVE '6010-DELETE-SEL-QUEUE'                             39490000
395000                        TO DP013-PARAGRAPH                        39500000
395100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         39510000
395200                        TO DP013-MESSAGE-TEXT (1)                 39520000
395300         PERFORM DP013-0000-PROCESS-ABEND                         39530000
395400     END-IF.                                                      39540000
395500                                                                  39550000
395600*----------------------------------------------------------------*39560000
395700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *39570000
395800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *39580000
395900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *39590000
396000*    THE TEMP QUEUE.                                             *39600000
396100*----------------------------------------------------------------*39610000
396200 6100-UPDATE-TSQ.                                                 39620000
396300                                                                  39630000
396400     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             39640000
396500     PERFORM 6150-READ-SEL-QUEUE.                                 39650000
396600     PERFORM                                                      39660000
396700         VARYING SU039-IDX                                        39670000
396800         FROM 1 BY 1                                              39680000
396900         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     39690000
397000         OR (SU039-IDX GREATER THAN SU039-MAX-ITEMS))             39700000
397100         IF  SU039-ACTION-SW (SU039-IDX) > SPACE                  39710000
397200             PERFORM 6110-PROCESS-ITEMS                           39720000
397300         END-IF                                                   39730000
397400         ADD +1                TO PV-ITEMS-PROCESSED              39740000
397500     END-PERFORM.                                                 39750000
397600     PERFORM 6111-WRITE-LIST-QUEUE.                               39760000
397700                                                                  39770000
397800*----------------------------------------------------------------*39780000
397900*    READ THE LIST QUEUE RECORD.                                 *39790000
398000*----------------------------------------------------------------*39800000
398100 6150-READ-SEL-QUEUE.                                             39810000
398200                                                                  39820000
398300     EXEC CICS                                                    39830000
398400          READQ TS                                                39840000
398500              QUEUE (ASC-SEL-QUEUE-NAME)                          39850000
398600              INTO  (SU039-SELECT-RECORD)                         39860000
398700              ITEM  (PV-SEL-QUEUE-ITEM)                           39870000
398800              RESP  (PV-CICS-RESP)                                39880000
398900     END-EXEC.                                                    39890000
399000*                                                                 39900000
399100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39910000
399200         CONTINUE                                                 39920000
399300     ELSE                                                         39930000
399400         SET DP013-CICS-ABEND      TO  TRUE                       39940000
399500         SET DP013-NO-ROLLBACK     TO  TRUE                       39950000
399600         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           39960000
399700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           39970000
399800                                   TO  DP013-MESSAGE-TEXT(1)      39980000
399900         PERFORM DP013-0000-PROCESS-ABEND                         39990000
400000     END-IF.                                                      40000000
400100                                                                  40010000
400200*----------------------------------------------------------------*40020000
400300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*40030000
400400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*40040000
400500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *40050000
400600*----------------------------------------------------------------*40060000
400700 6110-PROCESS-ITEMS.                                              40070000
400800                                                                  40080000
400900     COMPUTE PV-ITEM = 1 + ((SU039-ITEM (SU039-IDX) - 1)          40090000
401000                     / PC-ITEMS-PER-PANEL).                       40100000
401100                                                                  40110000
401200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           40120000
401300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          40130000
401400             PERFORM 6111-WRITE-LIST-QUEUE                        40140000
401500         END-IF                                                   40150000
401600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    40160000
401700                                                                  40170000
401800         PERFORM 6112-READ-LIST-QUEUE                             40180000
401900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               40190000
402000             CONTINUE                                             40200000
402100         END-IF                                                   40210000
402200     END-IF.                                                      40220000
402300                                                                  40230000
402400     COMPUTE PV-SUB = (SU039-ITEM (SU039-IDX)                     40240000
402500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              40250000
402600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         40260000
402700     MOVE LQW-SELECTED-SW (PV-SUB)                                40270000
402800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  40280000
402900                                                                  40290000
403000     EVALUATE TRUE                                                40300000
403100         WHEN SU039-INQ (SU039-IDX)                               40310000
403200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             40320000
403300                                                                  40330000
403400         WHEN SU039-UPD (SU039-IDX)                               40340000
403500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             40350000
403600                                                                  40360000
403700         WHEN SU039-DEL (SU039-IDX)                               40370000
403800              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             40380000
403900                                                                  40390000
404000         WHEN SU039-ERR (SU039-IDX)                               40400000
404100              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             40410000
404200     END-EVALUATE.                                                40420000
404300                                                                  40430000
404400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                40440000
404500                                                                  40450000
404600*----------------------------------------------------------------*40460000
404700*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *40470000
404800*----------------------------------------------------------------*40480000
404900 6111-WRITE-LIST-QUEUE.                                           40490000
405000                                                                  40500000
405100     EXEC CICS                                                    40510000
405200         WRITEQ TS                                                40520000
405300             QUEUE (ASC-LIST-QUEUE-NAME)                          40530000
405400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     40540000
405500             ITEM  (PV-SAVE-ITEM)                                 40550000
405600             REWRITE                                              40560000
405700             RESP  (PV-CICS-RESP)                                 40570000
405800     END-EXEC.                                                    40580000
405900*                                                                 40590000
406000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40600000
406100         CONTINUE                                                 40610000
406200     ELSE                                                         40620000
406300         SET DP013-CICS-ABEND  TO  TRUE                           40630000
406400         SET DP013-NO-ROLLBACK TO  TRUE                           40640000
406500         MOVE '6111-WRITE-LIST-QUEUE'                             40650000
406600                               TO  DP013-PARAGRAPH                40660000
406700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  40670000
406800                               TO  DP013-MESSAGE-TEXT(1)          40680000
406900         PERFORM DP013-0000-PROCESS-ABEND                         40690000
407000     END-IF.                                                      40700000
407100                                                                  40710000
407200*----------------------------------------------------------------*40720000
407300*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*40730000
407400*----------------------------------------------------------------*40740000
407500 6112-READ-LIST-QUEUE.                                            40750000
407600                                                                  40760000
407700     EXEC CICS                                                    40770000
407800         READQ TS                                                 40780000
407900             QUEUE (ASC-LIST-QUEUE-NAME)                          40790000
408000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     40800000
408100             ITEM  (PV-ITEM)                                      40810000
408200             RESP  (PV-CICS-RESP)                                 40820000
408300     END-EXEC.                                                    40830000
408400*                                                                 40840000
408500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40850000
408600         CONTINUE                                                 40860000
408700     ELSE                                                         40870000
408800         SET DP013-CICS-ABEND        TO TRUE                      40880000
408900         SET DP013-NO-ROLLBACK       TO TRUE                      40890000
409000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           40900000
409100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    40910000
409200                                     TO DP013-MESSAGE-TEXT(1)     40920000
409300         PERFORM DP013-0000-PROCESS-ABEND                         40930000
409400     END-IF.                                                      40940000
409500                                                                  40950000
409600*-----------------------------------------------------------------40960000
409700*  READ THE LIST QUEUE RECORD                                     40970000
409800*-----------------------------------------------------------------40980000
409900 9100-READ-SEL-QUEUE.                                             40990000
410000                                                                  41000000
410100     EXEC CICS                                                    41010000
410200         READQ TS                                                 41020000
410300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        41030002
410400             INTO  (SU039-SELECT-RECORD)                          41040000
410500             ITEM  (ASC-SEL-ITEM)                                 41050000
410600             RESP  (PV-CICS-RESP)                                 41060000
410700     END-EXEC.                                                    41070000
410800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        41080000
410900         CONTINUE                                                 41090000
411000     ELSE                                                         41100000
411100         SET DP013-LOGIC-ABEND                                    41110000
411200             DP013-NO-ROLLBACK   TO   TRUE                        41120000
411300         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          41130000
411400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   41140000
411500                                 TO   DP013-MESSAGE-TEXT (1)      41150000
411600         PERFORM DP013-0000-PROCESS-ABEND                         41160000
411700     END-IF.                                                      41170000
411800                                                                  41180000
411900*-----------------------------------------------------------------41190000
412000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *41200000
412100*-----------------------------------------------------------------41210000
412200 9200-REWRITE-SEL-QUEUE.                                          41220000
412300                                                                  41230000
412400     EXEC CICS                                                    41240000
412500          WRITEQ TS                                               41250000
412600              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      41260002
412700              FROM   (SU039-SELECT-RECORD)                        41270000
412800              ITEM   (ASC-SEL-ITEM)                               41280000
412900              RESP   (PV-CICS-RESP)                               41290000
413000              REWRITE                                             41300000
413100     END-EXEC.                                                    41310000
413200                                                                  41320000
413300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   41330000
413400         SET DP013-CICS-ABEND                                     41340000
413500             DP013-NO-ROLLBACK     TO TRUE                        41350000
413600         MOVE '9200-REWRITE-SEL-QUEUE'                            41360000
413700                                   TO DP013-PARAGRAPH             41370000
413800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   41380000
413900                                   TO DP013-MESSAGE-TEXT (1)      41390000
414000         PERFORM DP013-0000-PROCESS-ABEND                         41400000
414100     END-IF.                                                      41410000
414200                                                                  41420000
414300*----------------------------------------------------------------*41430000
414400*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *41440000
414500*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *41450000
414600*----------------------------------------------------------------*41460000
414700 9900-SOFT-ABORT.                                                 41470000
414800                                                                  41480000
414900     EXEC CICS SYNCPOINT                                          41490000
415000          ROLLBACK                                                41500000
415100     END-EXEC.                                                    41510000
415200                                                                  41520000
415300     SET  PS-ERROR                                                41530000
415400          PS-SOFT-ABORT-ERROR                                     41540000
415500          DP020-MSG-FATAL       TO  TRUE.                         41550000
415600                                                                  41560000
415700*----------------------------------------------------------------*41570000
415800*    ABEND PROCESSOR MODULE                                      *41580000
415900*----------------------------------------------------------------*41590000
416000                                                                  41600000
416100     COPY DPPD013.                                                41610000
