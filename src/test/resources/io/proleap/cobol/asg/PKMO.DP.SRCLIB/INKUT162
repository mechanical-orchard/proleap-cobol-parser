       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    INKUT162                                                  
       AUTHOR.        DORSEY JACKSON                                            
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  07-03-2002.                                               
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      * INKUT162 - GENERATE A VALID RECORD HEADER COUNT RECORD.                 
      *                                                                         
      *CHANGE HISTORY:                                                          
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                             
      * -------  ----------  ----------------------------------------           
W21732* W21732   12-26-2002  NON-INTELLIGENT SKU. - IGSI                        
25248 * 25248    10-06-2003  UPC CAPABILITIES & STORE NUMBER EXPANSION          
25248 *                      -ROD JANSSEN                                       
W26600*                                                                         
W26600* W26600   06-  -2004  PHYSICAL INVENTORY - STORE EXPANSION               
W26600*                      INCREASED RECORD LENGTH OF INPUT AND OUTPUT        
W26600*                      FILE FROM 70 BYTES TO 71 BYTES.                    
W26600*                      M JOHNSON                                          
W26600*                                                                         
SR3403* SR3403   04-02-2012  EXPAND LRECL OF INPUT AND OUTPUT FILES             
SR3403*                      TO 100 FOR LARGE RETAIL PROJECT.                   
SR3403*                      CHANDAN RACHH                                      
SR3403*                                                                         
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.    IBM-3090.                                            
       OBJECT-COMPUTER.    IBM-3090.                                            
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT INPUT-FILE                                                    
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT OUTPUT-FILE                                                   
               ASSIGN TO OUT01.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  INPUT-FILE                                                           
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS 0 RECORDS                                            
W21732*    RECORD CONTAINS 70 CHARACTERS                                        
           DATA RECORD IS INPUT-RECORD.                                         
SR3403 01  INPUT-RECORD                   PIC X(100).                           
                                                                                
       FD  OUTPUT-FILE                                                          
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS 0 RECORDS                                            
W21732*    RECORD CONTAINS 70 CHARACTERS                                        
           DATA RECORD IS OUTPUT-RECORD.                                        
SR3403 01  OUTPUT-RECORD                  PIC X(100).                           
                                                                                
       EJECT                                                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** WORKING STORAGE AREA BEGIN ***'.                                
                                                                                
      *****************************************************************         
      ***************************************************************** 00120000
      *   INPUT RECORD                                                  00130000
      ***************************************************************** 00140000
                                                                                
25248      COPY INWS009.                                                        
25248 *01  IR-INPUT-RECORD.                                                     
25248 *    05  INPUT-STORE                   PIC X(03)   VALUE SPACES.          
25248 *    05  FILLER                        PIC X(67)   VALUE SPACES.          
25248 *                                                                         
       01  OR-OUTPUT-RECORD.                                                    
W26600     05  OUTPUT-STORE                  PIC 9(04)   VALUE ZEROES.          
W26600     05  OUTPUT-REC-COUNT              PIC 9(09)   VALUE ZEROES           
                                                               COMP.            
W26600     05  FILLER                        PIC X(63)   VALUE SPACES.          
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PROGRAM-NAME               PIC X(08) VALUE 'INKUT162'.        
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-INPUT-EOF-SW               PIC X(1)     VALUE 'N'.            
               88  PS-INPUT-EOF                           VALUE 'Y'.            
           05  PS-FIRST-RECORD-SW            PIC X(1)     VALUE 'Y'.            
               88  PS-FIRST-RECORD                        VALUE 'Y'.            
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-IN-COUNTER              PIC S9(9)   VALUE ZEROES              
                                                         COMP SYNC.             
       EJECT                                                                    
      *                                                                         
       PROCEDURE DIVISION.                                                      
                                                                                
       0000-INKUT162.                                                           
                                                                                
      ****************************************************************          
      *    OPEN ALL FILES.                                                      
      *    PROCESS CONTROL RECORDS                                              
      *    CLOSE ALL FILES.                                                     
      ****************************************************************          
           OPEN INPUT  INPUT-FILE                                               
                OUTPUT OUTPUT-FILE.                                             
                                                                                
           PERFORM 1000-INITIALIZE.                                             
                                                                                
           PERFORM 2000-PROCESS                                                 
               UNTIL PS-INPUT-EOF.                                              
                                                                                
           PERFORM 4000-WRITE-OUTPUT-RECORD.                                    
                                                                                
           CLOSE INPUT-FILE                                                     
                 OUTPUT-FILE.                                                   
                                                                                
           STOP RUN.                                                            
                                                                                
       1000-INITIALIZE.                                                         
      ****************************************************************          
      *    READ FIRST RECORD                                                    
      *    PERFORMED BY 0000-INKUT162.                                          
      ****************************************************************          
                                                                                
           PERFORM 3000-READ-CNTL-FILE.                                         
                                                                                
       EJECT                                                                    
                                                                                
       2000-PROCESS.                                                            
                                                                                
      ****************************************************************          
      *    CREATE OUTPUT RECORDS                                                
      *    READ THE NEXT CONTROL RECORD                                         
      *                                                                         
      *    PERFORMED BY 0000-INKUT162.                                          
      ****************************************************************          
                                                                                
           ADD +1                     TO PV-IN-COUNTER.                         
                                                                                
           PERFORM 3000-READ-CNTL-FILE.                                         
                                                                                
       3000-READ-CNTL-FILE.                                                     
      ****************************************************************          
      *    READ CONTROL FILE ONE                                                
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE                                         
      *                 2000-PROCESS                                            
      ****************************************************************          
25248 **** READ INPUT-FILE INTO IR-INPUT-RECORD                                 
25248      READ INPUT-FILE INTO IN009-EDITED-INVENTORY-RECORD                   
               AT END                                                           
                   SET PS-INPUT-EOF TO TRUE.                                    
                                                                                
       4000-WRITE-OUTPUT-RECORD.                                                
      ****************************************************************          
      *    WRITE OUTPUT RECORD                                                  
      *                                                                         
      *    PERFORMED BY 0000-INKUT162                                           
      ****************************************************************          
           MOVE PV-IN-COUNTER         TO OUTPUT-REC-COUNT.                      
           WRITE OUTPUT-RECORD FROM OR-OUTPUT-RECORD.                           
           DISPLAY 'INPUT RECORD COUNT = ' PV-IN-COUNTER.                       
           DISPLAY 'OUT-REC-COUNT      = ' OUTPUT-REC-COUNT.                    
           EJECT                                                                
