000100*-----------------------*                                         00010066
000200 IDENTIFICATION DIVISION.                                         00020066
000300*-----------------------*                                         00030066
000400 PROGRAM-ID.    RDKCS034.                                         00040066
000500 AUTHOR.        GREGORY SHEFF.                                    00050066
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060066
000700 DATE-WRITTEN.  06-03-03.                                         00070066
000800 DATE-COMPILED.                                                   00080066
000900*----------------------------------------------------------------*00090066
001000*                                                                *00100066
001100*    THIS PROGRAM IS USED TO ENTER CRITERIA TO BE USED TO SEARCH *00110066
001200*    FOR INFORMATION IN THE CASH REFUND DATABASE.                *00120066
001300*                                                                *00130066
001400*    THE USER ENTERS INFORMATION INTO A SCREEN IN ONE OF THREE   *00140066
001500*    GROUPS:                                                     *00150066
001600*        A) DRIVER LICENSE AND/OR SOCIAL SECURITY NUMBER, OR     *00160066
001700*        B) RECEIPT DATE, STORE, TERMINAL, AND TRANSACTION, OR   *00170066
001800*        C) APPROVAL CODE                                        *00180066
001801*                                                                *00180199
001802* WR33375  B. CHERRY 10/15/2007                                  *00180299
001803*        MODIFIED THE PROGRAM TO ALLOW FOR NON-NUMERIC DRIVER    *00180399
001804*        LICENSE                                                 *00180499
001805*          C. PARMLEY ALSO ADDED NEW MESSAGE WHEN PF19 IS PRESSED*00180599
001806*             WITH THE INCORRECT CRITERIA                        *00180699
001807* 10/11/2021 GERMAN BANDA                    WR/IR #: CHG0262418* 00180799
001808*            - CHANGE CALL OF DPKUT100 TO                       * 00180899
001809*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00180999
001810*              MAKING THE CALL DYNAMIC VS STATIC                * 00181099
001820*                                                               * 00182099
001830*---------------------------------------------------------------* 00183099
CICS  * CHANGED 10/27/2022    BY JIM HUNTER      WR: CHG0277293         00184099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00185099
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00186099
CICS  ******************************************************************00187099
002000 ENVIRONMENT DIVISION.                                            00200066
002100                                                                  00210066
002200 DATA DIVISION.                                                   00220066
002300                                                                  00230066
002400 WORKING-STORAGE SECTION.                                         00240066
002500*                                                                 00250066
002600 01  PC-PROGRAM-CONSTANTS.                                        00260066
002700     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'RD034A  '. 00270066
002800     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'RDKM034 '. 00280066
002900     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'RDKCS034'. 00290066
003000     05  PC-TSYMSG-NUMBERS.                                       00300066
003100         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00310066
003200         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00320066
003300         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00330066
003400         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00340066
003500         10  PC-TSYMSG-00010       PIC  9(05)  VALUE  00010.      00350066
003510         10  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.      00351085
003600         10  PC-TSYMSG-03095       PIC  9(05)  VALUE  03095.      00360066
003610         10  PC-TSYMSG-03100       PIC  9(05)  VALUE  03100.      00361078
003620         10  PC-TSYMSG-03108       PIC  9(05)  VALUE  03108.      00362098
003630         10  PC-TSYMSG-03596       PIC  9(05)  VALUE  03596.      00363099
003700*                                                                 00370066
003800 01  PV-PROGRAM-VARIABLES.                                        00380066
003900     05  PV-STORE-NUMBER-N         PIC  9(05)  VALUE  0.          00390066
004000     05  PV-STATUS-CODES           PIC  X(01)  VALUE  SPACES.     00400066
004100         88  PV-APPROVED                       VALUE  'A'.        00410066
004200         88  PV-DENIED                         VALUE  'D'.        00420066
004300         88  PV-KMRC                           VALUE  'K'.        00430066
004400         88  PV-PENDING                        VALUE  'P'.        00440066
004500         88  PV-VOID                           VALUE  'V'.        00450066
004600         88  PV-VALID-STATUS-CODE                                 00460068
004700                                  VALUE  'A', 'D', 'K', 'P', 'V', 00470066
004800                                    'C', 'S', 'M', 'B', 'E', 'O'. 00480068
004900*                                                                 00490066
005000 01  PS-PROGRAM-SWITCHES.                                         00500066
005100     05  PS-NO-EDIT-ERROR-SW       PIC  X(01)  VALUE  'N'.        00510066
005200         88  PS-EDIT-ERROR                     VALUE  'Y'.        00520066
005300         88  PS-NO-EDIT-ERROR                  VALUE  'N'.        00530066
005400                                                                  00540066
005500 01  PM-PROGRAM-MESSAGES.                                         00550066
005600     05  PM-ABEND-INFO-A.                                         00560066
005700         10  FILLER                PIC X(15)   VALUE              00570066
005800                                   'DP020-SRC-AID: '.             00580066
005900         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00590066
006000         10  FILLER                PIC X(19)   VALUE              00600066
006100                                   '. DP020-FK-ACTION: '.         00610066
006200         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00620066
006300         10  FILLER                PIC X(22)   VALUE              00630066
006400                                   '. DP020-FK-DISPN-IND: '.      00640066
006500         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00650066
006600         10  FILLER                PIC X(01)   VALUE '.'.         00660066
006700         10  FILLER                PIC X(19)   VALUE SPACE.       00670066
006800                                                                  00680066
006900                                                                  00690066
007000*----------------------------------------------------------------*00700066
007100*    MAP LAYOUT                                                  *00710066
007200*----------------------------------------------------------------*00720066
007300     COPY RDKM034.                                                00730066
007400                                                                  00740067
007500*----------------------------------------------------------------*00750066
007600*    ATTRIBUTE SETTINGS COPYBOOK.                                *00760066
007700*----------------------------------------------------------------*00770066
007800     COPY DPWS015.                                                00780093
007900                                                                  00790066
008000*----------------------------------------------------------------*00800066
008100*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             00810001
008200*----------------------------------------------------------------*00820066
008210                                                                  00821099
008300     COPY DPWS500.                                                00830099
008400                                                                  00840001
008500*----------------------------------------------------------------*00850066
008600*    FUNCTION KEYS COPYBOOK                                      *00860066
008700*----------------------------------------------------------------*00870066
008800     COPY DPWS016.                                                00880093
008900                                                                  00890067
009000******************************************************************00900066
009100** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00910066
009200** SUB-ROUTINE (DPKUT100).                                      **00920066
009300******************************************************************00930066
009400     COPY DPWS010I.                                               00940093
009500                                                                  00950067
009600******************************************************************00960066
009700** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **00970066
009800** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **00980066
009900******************************************************************00990066
010000     COPY DPWS030.                                                01000093
CICS       COPY DPWS930.                                                01001099
010100                                                                  01010067
010200***************************************************************** 01020066
010300*    STANDARD COMMAREA.                                           01030066
010400***************************************************************** 01040066
010500     COPY DPWS020.                                                01050093
010600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01060066
010700                                                                  01070066
010800***************************************************************** 01080066
010900*    INTER-APPLICATION COMMAREA.                                  01090066
011000***************************************************************** 01100066
011100                                                                  01110066
011200         10  INTER-APPL-COMM-AREA PIC X(200).                     01120066
011300     COPY RDWS033.                                                01130093
011400***************************************************************** 01140066
011500*    SPECIFIC COMMMAREA FOR RDKCS034.                             01150066
011600***************************************************************** 01160066
011700         10  ASC-SPECIFIC-COMMAREA.                               01170066
011800             15  ASC-DRIVERS-LIC             PIC  X(25).          01180066
011900             15  ASC-DRIVERS-ORIG            PIC  X(25).          01190066
012000             15  ASC-SSN                     PIC  X(09).          01200066
012010             15  ASC-LAST-NAME               PIC  X(30).          01201099
012020             15  ASC-FIRST-NAME              PIC  X(30).          01202099
012100             15  ASC-RECEIPT-DTE             PIC  X(08).          01210066
012200             15  ASC-STORE-NBR               PIC  X(05).          01220039
012300             15  ASC-STORE-NBR-N  REDEFINES  ASC-STORE-NBR        01230039
012400                                             PIC  9(05).          01240039
012500             15  ASC-TERMINAL                PIC  X(04).          01250066
012600             15  ASC-TERMINAL-N  REDEFINES  ASC-TERMINAL          01260039
012700                                             PIC  ZZZ9.           01270039
012800             15  ASC-TRANSACTION             PIC  X(04).          01280066
012900             15  ASC-TRANSACTION-N  REDEFINES  ASC-TRANSACTION    01290039
013000                                             PIC  ZZZ9.           01300039
013010             15  ASC-ADDRESS                 PIC  X(40).          01301099
013100             15  ASC-STATUS-CDE              PIC  X(01).          01310066
013110             15  ASC-PF17-SW                 PIC  X(01).          01311083
013130                88  ASC-PF17-YES              VALUE  'Y'.         01313083
013140                88  ASC-PF17-NO               VALUE  'N'.         01314083
013150             15  ASC-PF19-SW                 PIC  X(01).          01315099
013160                88  ASC-PF19-YES              VALUE  'Y'.         01316099
013170                88  ASC-PF19-NO               VALUE  'N'.         01317099
013200         10  FILLER                          PIC  X(2682).        01320099
013300                                                                  01330066
013400*----------------------------------------------------------------*01340066
013500*    ABEND PROCESSING COPYBOOK.                                  *01350066
013600*----------------------------------------------------------------*01360066
013700     COPY DPWS013.                                                01370093
013800                                                                  01380066
013900******************************************************            01390066
014000*  DRIVER LICENSE CONVERSION COPYBOOK                             01400066
014100******************************************************            01410066
014110                                                                  01411099
014120*BC WR33375                                                       01412099
014130                                                                  01413099
014200**   COPY CRWS500.                                                01420099
014300                                                                  01430066
014400 LINKAGE SECTION.                                                 01440066
014500                                                                  01450066
014600 01  DFHCOMMAREA.                                                 01460066
014700     05  FILLER                         OCCURS  1 TO 4072 TIMES   01470066
014800                                        DEPENDING ON EIBCALEN.    01480066
014900         10  FILLER                     PIC X.                    01490066
015000                                                                  01500066
015100 PROCEDURE DIVISION.                                              01510066
015200***************************************************************** 01520066
015300** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01530066
015400** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01540066
015500** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01550066
015600**                                                             ** 01560066
015700** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01570066
015800** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01580066
015900***************************************************************** 01590066
016000 0000-MAIN-MODULE.                                                01600066
016100     INITIALIZE DP030-CICS-API-FIELDS.                            01610066
016200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01620066
016300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01630066
016400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01640066
016500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01650066
016600     MOVE LENGTH OF RD034AI        TO DP030-MAP-LENGTH (1).       01660066
016700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01670066
016800     PERFORM 0001-CALL-CICS-ARCH-API.                             01680066
016900                                                                  01690067
017000     PERFORM 1000-CONTROL-PROCESSING                              01700066
017100                                                                  01710067
017200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01720066
017300     PERFORM 0001-CALL-CICS-ARCH-API.                             01730066
017400                                                                  01740066
017500 0001-CALL-CICS-ARCH-API.                                         01750066
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      01760099
017700                                    DFHCOMMAREA                   01770099
017800                                    DP030-CICS-API-FIELDS         01780099
017900                                    DP020-STANDARD-COMMAREA       01790099
018000                                    RD034AI.                      01800099
018100                                                                  01810067
018200     IF  DP030-RC-CALL-SUCCESSFUL                                 01820066
018300         CONTINUE                                                 01830066
018400     ELSE                                                         01840066
018500         SET DP013-NO-ROLLBACK                                    01850066
018600             DP013-XCTL-DISPLAY-RESTART                           01860066
018700             DP013-CICS-ABEND      TO TRUE                        01870066
018800         MOVE 'BEFORE 0000-MAIN-MODULE'                           01880066
018900                                   TO DP013-PARAGRAPH             01890066
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O01891099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      01892099
019200         MOVE DP030-RETURN-CODE                                   01920066
019300                                   TO DP013-MESSAGE-TEXT (3)      01930066
019400         PERFORM DP013-0000-PROCESS-ABEND                         01940066
019500     END-IF.                                                      01950066
019600                                                                  01960067
019700*----------------------------------------------------------------*01970066
019800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *01980066
019900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *01990066
020000*----------------------------------------------------------------*02000066
020100                                                                  02010066
020200 1000-CONTROL-PROCESSING.                                         02020066
020300                                                                  02030066
020400     EVALUATE TRUE                                                02040066
020500         WHEN DP020-NEXT-ACT-INITIAL                              02050066
020600             INITIALIZE ASC-SPECIFIC-COMMAREA                     02060066
020700             PERFORM 4000-BUILD-INITIAL-PANEL                     02070066
020800                                                                  02080066
020900         WHEN DP020-NEXT-ACT-READ-MAP                             02090066
021000             PERFORM 2000-FKEY-PROCESSING                         02100066
021100                                                                  02110066
021200         WHEN DP020-NEXT-ACT-RETURN                               02120066
021300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02130066
021400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02140066
021500                                                                  02150066
021600         WHEN OTHER                                               02160066
021700             SET DP013-LOGIC-ABEND                                02170066
021800                 DP013-NO-ROLLBACK TO TRUE                        02180066
021900             MOVE '1000-CONTROL-PROCESSING'                       02190066
022000                                   TO  DP013-PARAGRAPH            02200066
022100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02210066
022200                                   TO  DP013-MESSAGE-TEXT(1)      02220066
022300             MOVE DP020-NEXT-APPL-ACTIVITY                        02230066
022400                                   TO DP013-MESSAGE-TEXT(2)       02240066
022500             PERFORM DP013-0000-PROCESS-ABEND                     02250066
022600     END-EVALUATE.                                                02260066
022700                                                                  02270066
022800*----------------------------------------------------------------*02280066
022900* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02290066
023000* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02300066
023100* EDITS.                                                         *02310066
023200*----------------------------------------------------------------*02320066
023300                                                                  02330066
023400 2000-FKEY-PROCESSING.                                            02340066
023500                                                                  02350066
023600     EVALUATE TRUE                                                02360066
023700                                                                  02370066
023800         WHEN DP020-SRC-AID = DP016-CLEAR                         02380066
023900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02390066
024000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02400066
024100                                                                  02410066
024200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02420066
024300             INITIALIZE ASC-SPECIFIC-COMMAREA                     02430066
024400             PERFORM 4000-BUILD-INITIAL-PANEL                     02440066
024500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02450066
024600             PERFORM 3200-RESET-ATTRIBUTES                        02460066
024700                                                                  02470066
024800         WHEN OTHER                                               02480066
024900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02490066
025000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02500066
025100             IF  PS-NO-EDIT-ERROR                                 02510066
025200                 SET DP030-CONTINUE-GO TO TRUE                    02520066
025300                 PERFORM 2100-CHECK-FUNCTION-KEY                  02530066
025400             ELSE                                                 02540066
025500                 SET DP030-OVERRIDE-GO TO TRUE                    02550066
025600             END-IF                                               02560066
025700     END-EVALUATE.                                                02570066
025800******************************************************************02580066
025900** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **02590066
026000** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **02600066
026100** FROM THE CICS ARCHITECTURE API.                              **02610066
026200******************************************************************02620066
026300 2100-CHECK-FUNCTION-KEY.                                         02630066
026400                                                                  02640066
026500* THE PF22 KEY REQUIRES ONE OF THE FOLLOWING GROUPS TO BE ENTERED:02650066
026600*    A) DRIVER LICENSE AND/OR SOCIAL SECURITY NUMBER, OR          02660066
026700*    B) RECEIPT DATE, STORE, TERMINAL, AND TRANSACTION, OR        02670066
026800*    C) APPROVAL CODE                                             02680066
026900                                                                  02690066
027000     EVALUATE TRUE                                                02700066
027101*------------    PF22 KEY  -----------------*                     02710198
027102         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              02710290
027110             IF ASC-PF17-YES                                      02711091
027130*-----------  03108-E-ONLY USE PF17 FOR LASTNAME SEARCH           02713099
027131                SET DP030-OVERRIDE-GO TO TRUE                     02713193
027140                MOVE PC-TSYMSG-03108  TO DP020-MSG-NUMBER         02714098
027141                SET DP020-MSG-FATAL   TO TRUE                     02714196
027300             ELSE                                                 02730085
027301                PERFORM 2110-PREPARE-INTER-APPL-COMM              02730191
027312             END-IF                                               02731285
027313             IF ASC-PF19-YES                                      02731399
027314*-----------  03596-E-ONLY USE PF19 FOR ADDRESS SEARCH            02731499
027315                SET DP030-OVERRIDE-GO TO TRUE                     02731599
027316                MOVE PC-TSYMSG-03596  TO DP020-MSG-NUMBER         02731699
027318                SET DP020-MSG-FATAL   TO TRUE                     02731899
027319             ELSE                                                 02731999
027320                PERFORM 2110-PREPARE-INTER-APPL-COMM              02732099
027321             END-IF                                               02732199
027322                                                                  02732299
027323*---------          PF 17 KEY      ------------*                  02732399
027324         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              02732499
027325             IF ASC-PF17-NO                                       02732599
027326*-----------  03108-E-ONLY USE PF17 FOR LASTNAME SEARCH           02732699
027327                SET DP030-OVERRIDE-GO TO TRUE                     02732799
027328                MOVE PC-TSYMSG-03108  TO DP020-MSG-NUMBER         02732899
027329                SET DP020-MSG-FATAL   TO TRUE                     02732999
027330             ELSE                                                 02733099
027331                PERFORM 2110-PREPARE-INTER-APPL-COMM              02733199
027332             END-IF                                               02733299
027340                                                                  02734074
027350*---------          PF 19 KEY      ------------*                  02735099
027360         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              02736099
027370             IF ASC-PF19-NO                                       02737099
027380*-----------  03596-E-ONLY USE PF19 FOR ADDRESS SEARCH            02738099
027390                SET DP030-OVERRIDE-GO TO TRUE                     02739099
027391                MOVE PC-TSYMSG-03596  TO DP020-MSG-NUMBER         02739199
027393                SET DP020-MSG-FATAL   TO TRUE                     02739399
027394             ELSE                                                 02739499
027395                PERFORM 2110-PREPARE-INTER-APPL-COMM              02739599
027396             END-IF                                               02739699
027397                                                                  02739799
027400         WHEN DP020-SRC-AID = DP016-ENTER                         02740066
027500             MOVE -1 TO ADRVLICL                                  02750066
027600             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 02760066
027700                                                                  02770066
027800         WHEN OTHER                                               02780066
027900             SET DP013-NO-ROLLBACK                                02790066
028000                 DP013-XCTL-DISPLAY-RESTART                       02800066
028100                 DP013-CICS-ABEND  TO TRUE                        02810066
028200             MOVE '2100-CHECK-FUNCTION-KEY'                       02820066
028300                                   TO DP013-PARAGRAPH             02830066
028400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      02840066
028500                                   TO DP013-MESSAGE-TEXT (1)      02850066
028600             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 02860066
028700                                   TO DP013-MESSAGE-TEXT (2)      02870066
028800             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                02880066
028900             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 02890066
029000                                   TO PM-A-FK-ACTION              02900066
029100             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              02910066
029200                                   TO PM-A-FK-DISPN               02920066
029300             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      02930066
029400             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        02940066
029500                                   TO DP013-MESSAGE-TEXT (4)      02950066
029600             PERFORM DP013-0000-PROCESS-ABEND                     02960066
029700     END-EVALUATE.                                                02970066
029800******************************************************************02980066
029900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **02990066
030000** INTER-APPLICATION COMMAREA.                                  **03000066
030100******************************************************************03010066
030200 2110-PREPARE-INTER-APPL-COMM.                                    03020066
030300     INITIALIZE RD033-INTER-APPL-COMMAREA.                        03030066
030400     MOVE ASC-DRIVERS-LIC          TO RD033-DRIVERS-LIC.          03040066
030500     MOVE ASC-SSN                  TO RD033-SSN.                  03050066
030510     MOVE ASC-LAST-NAME            TO RD033-LAST-NAME.            03051081
030520     MOVE ASC-FIRST-NAME           TO RD033-FIRST-NAME.           03052081
030600     MOVE ASC-RECEIPT-DTE          TO RD033-RECEIPT-DTE.          03060066
030700     MOVE ASC-TERMINAL             TO RD033-TERMINAL.             03070066
030800     MOVE ASC-TRANSACTION          TO RD033-TRANSACTION.          03080066
030810     MOVE ASC-ADDRESS              TO RD033-ADDRESS.              03081099
030900     MOVE ASC-STATUS-CDE           TO RD033-APPRVL-CDE.           03090066
031000     MOVE ASC-STORE-NBR-N          TO RD033-STORE-NBR.            03100039
031100                                                                  03110039
031200*----------------------------------------------------------------*03120066
031300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03130066
031400* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03140066
031500* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03150066
031600*----------------------------------------------------------------*03160066
031700                                                                  03170066
031800 2200-MOVE-SCREEN-TO-COMMAREA.                                    03180066
031900     IF  ADRVLICL > ZERO                                          03190066
032000         MOVE ADRVLICI             TO ASC-DRIVERS-LIC             03200066
032100                                      ASC-DRIVERS-ORIG            03210066
032200     ELSE                                                         03220066
032300         IF  ADRVLICF = DP015-ERASE-EOF                           03230066
032400             MOVE SPACE            TO ASC-DRIVERS-LIC             03240066
032500                                      ASC-DRIVERS-ORIG            03250066
032600         END-IF                                                   03260066
032700     END-IF.                                                      03270066
032800                                                                  03280066
032900     IF  ASSNNBRL > ZERO                                          03290066
033000         MOVE ASSNNBRI             TO ASC-SSN                     03300066
033100     ELSE                                                         03310066
033200         IF  ASSNNBRF = DP015-ERASE-EOF                           03320066
033300             MOVE SPACES           TO ASC-SSN                     03330066
033400         END-IF                                                   03340066
033500     END-IF.                                                      03350066
033600                                                                  03360066
033610     IF  ALSTNML > ZERO                                           03361076
033620         MOVE ALSTNMI              TO ASC-LAST-NAME               03362076
033630     ELSE                                                         03363076
033640         IF  ALSTNMF = DP015-ERASE-EOF                            03364076
033650             MOVE SPACES           TO ASC-LAST-NAME               03365076
033660         END-IF                                                   03366076
033670     END-IF.                                                      03367076
033680                                                                  03368076
033690     IF  AFRSTNML > ZERO                                          03369076
033691         MOVE AFRSTNMI             TO ASC-FIRST-NAME              03369176
033692     ELSE                                                         03369276
033693         IF  AFRSTNMF = DP015-ERASE-EOF                           03369379
033694             MOVE SPACES           TO ASC-FIRST-NAME              03369476
033695         END-IF                                                   03369576
033696     END-IF.                                                      03369676
033697                                                                  03369776
033700     IF  AREQDTEL > ZERO                                          03370066
033800         MOVE AREQDTEI             TO ASC-RECEIPT-DTE             03380066
033900     ELSE                                                         03390066
034000         IF  AREQDTEF = DP015-ERASE-EOF                           03400066
034100             MOVE SPACE            TO ASC-RECEIPT-DTE             03410066
034200         END-IF                                                   03420066
034300     END-IF.                                                      03430066
034400                                                                  03440066
034500     IF  ASTRNBRL > ZERO                                          03450066
034600         MOVE ASTRNBRI             TO ASC-STORE-NBR               03460066
034700     ELSE                                                         03470066
034800         IF  ASTRNBRF = DP015-ERASE-EOF                           03480066
034900             MOVE SPACE            TO ASC-STORE-NBR               03490066
035000         END-IF                                                   03500066
035100     END-IF.                                                      03510066
035200                                                                  03520066
035300     IF  ASTRRGTL > ZERO                                          03530066
035400         MOVE ASTRRGTI             TO ASC-TERMINAL                03540066
035500     ELSE                                                         03550066
035600         IF  ASTRRGTF = DP015-ERASE-EOF                           03560066
035700             MOVE SPACE            TO ASC-TERMINAL                03570066
035800         END-IF                                                   03580066
035900     END-IF.                                                      03590066
036000                                                                  03600066
036100     IF  ARGTTRNL > ZERO                                          03610066
036200         MOVE ARGTTRNI             TO ASC-TRANSACTION             03620066
036300     ELSE                                                         03630066
036400         IF  ARGTTRNF = DP015-ERASE-EOF                           03640066
036500             MOVE SPACE            TO ASC-TRANSACTION             03650066
036600         END-IF                                                   03660066
036700     END-IF.                                                      03670066
036800                                                                  03680066
036810     IF  AADDRSSL > ZERO                                          03681099
036820         MOVE AADDRSSI             TO ASC-ADDRESS                 03682099
036830     ELSE                                                         03683099
036840         IF  AADDRSSF = DP015-ERASE-EOF                           03684099
036850             MOVE SPACES           TO ASC-ADDRESS                 03685099
036860         END-IF                                                   03686099
036870     END-IF.                                                      03687099
036880                                                                  03688099
036900     IF  ASTATCDL > ZERO                                          03690066
037000         MOVE ASTATCDI             TO ASC-STATUS-CDE              03700066
037100     ELSE                                                         03710066
037200         IF  ASTATCDF = DP015-ERASE-EOF                           03720066
037300             MOVE SPACE            TO ASC-STATUS-CDE              03730066
037400         END-IF                                                   03740066
037500     END-IF.                                                      03750066
037600*----------------------------------------------------------------*03760066
037700* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *03770066
037800* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *03780066
037900* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*03790066
038000* IN THE DESTINATION PROGRAM, NOT HERE.                          *03800066
038100*----------------------------------------------------------------*03810066
038200                                                                  03820066
038300 3000-EDIT-DATA-IN-COMMAREA.                                      03830066
038400                                                                  03840066
038500     PERFORM 3200-RESET-ATTRIBUTES.                               03850066
038600                                                                  03860066
038610     SET ASC-PF17-NO  TO TRUE.                                    03861087
038611     SET ASC-PF19-NO  TO TRUE.                                    03861199
038620                                                                  03862087
038700     IF ASC-DRIVERS-LIC > SPACES                                  03870066
038800        AND  (ASC-SSN         > SPACES                            03880039
038810        OR    ASC-LAST-NAME   > SPACES                            03881076
038900        OR    ASC-RECEIPT-DTE > SPACES                            03890066
039000        OR    ASC-STORE-NBR   > SPACES                            03900039
039100        OR    ASC-TERMINAL    > SPACES                            03910066
039200        OR    ASC-TRANSACTION > SPACES                            03920066
039210        OR    ASC-ADDRESS     > SPACES                            03921099
039300        OR    ASC-STATUS-CDE  > SPACES)                           03930066
039400              SET PS-EDIT-ERROR     TO TRUE                       03940066
039500              SET DP020-MSG-FATAL   TO TRUE                       03950066
039600* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         03960066
039700              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           03970066
039800              MOVE DP015-UNP-ALP-BRT-OFF                          03980066
039900                                    TO ADRVLICA                   03990066
040000              MOVE DP015-RED        TO ADRVLICC                   04000066
040100              MOVE DP015-REVERSE    TO ADRVLICH                   04010066
040200              MOVE -1               TO ADRVLICL                   04020066
040300     ELSE                                                         04030066
040400     IF ASC-SSN > SPACES                                          04040066
040500        AND  (ASC-DRIVERS-LIC > SPACES                            04050039
040600        OR    ASC-LAST-NAME   > SPACES                            04060076
040610        OR    ASC-RECEIPT-DTE > SPACES                            04061076
040700        OR    ASC-STORE-NBR   > SPACES                            04070039
040800        OR    ASC-TERMINAL    > SPACES                            04080066
040900        OR    ASC-TRANSACTION > SPACES                            04090066
040910        OR    ASC-ADDRESS     > SPACES                            04091099
041000        OR    ASC-STATUS-CDE  > SPACES)                           04100066
041100              SET PS-EDIT-ERROR     TO TRUE                       04110066
041200              SET DP020-MSG-FATAL   TO TRUE                       04120066
041300* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04130066
041400              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04140066
041500              MOVE DP015-UNP-ALP-BRT-OFF                          04150066
041600                                    TO ASSNNBRA                   04160066
041700              MOVE DP015-RED        TO ASSNNBRC                   04170066
041800              MOVE DP015-REVERSE    TO ASSNNBRH                   04180066
041900              MOVE -1               TO ASSNNBRL                   04190066
042000     ELSE                                                         04200066
042010     IF ASC-LAST-NAME > SPACES                                    04201076
042020        AND  (ASC-DRIVERS-LIC > SPACES                            04202076
042030        OR    ASC-SSN         > SPACES                            04203076
042040        OR    ASC-RECEIPT-DTE > SPACES                            04204076
042050        OR    ASC-STORE-NBR   > SPACES                            04205076
042060        OR    ASC-TERMINAL    > SPACES                            04206076
042070        OR    ASC-TRANSACTION > SPACES                            04207076
042071        OR    ASC-ADDRESS     > SPACES                            04207199
042080        OR    ASC-STATUS-CDE  > SPACES)                           04208076
042090              SET PS-EDIT-ERROR     TO TRUE                       04209076
042091              SET DP020-MSG-FATAL   TO TRUE                       04209176
042092* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04209276
042093              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04209376
042094              MOVE DP015-UNP-ALP-BRT-OFF                          04209476
042095                                    TO ALSTNMA                    04209576
042096              MOVE DP015-RED        TO ALSTNMC                    04209676
042097              MOVE DP015-REVERSE    TO ALSTNMH                    04209776
042098              MOVE -1               TO ALSTNML                    04209876
042099     ELSE                                                         04209976
042100     IF ASC-FIRST-NAME > SPACES                                   04210077
042101        AND  (ASC-DRIVERS-LIC > SPACES                            04210177
042102        OR    ASC-SSN         > SPACES                            04210277
042103        OR    ASC-RECEIPT-DTE > SPACES                            04210377
042104        OR    ASC-STORE-NBR   > SPACES                            04210477
042105        OR    ASC-TERMINAL    > SPACES                            04210577
042106        OR    ASC-TRANSACTION > SPACES                            04210677
042107        OR    ASC-ADDRESS     > SPACES                            04210799
042108        OR    ASC-STATUS-CDE  > SPACES)                           04210899
042109              SET PS-EDIT-ERROR     TO TRUE                       04210999
042110              SET DP020-MSG-FATAL   TO TRUE                       04211099
042111* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04211199
042112              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04211299
042113              MOVE DP015-UNP-ALP-BRT-OFF                          04211399
042114                                    TO ALSTNMA                    04211499
042115              MOVE DP015-RED        TO ALSTNMC                    04211599
042116              MOVE DP015-REVERSE    TO ALSTNMH                    04211699
042117              MOVE -1               TO ALSTNML                    04211799
042118     ELSE                                                         04211899
042119     IF ASC-FIRST-NAME > SPACES                                   04211999
042120        AND  (ASC-LAST-NAME   = SPACES                            04212099
042121        AND   ASC-DRIVERS-LIC = SPACES                            04212199
042122        AND   ASC-SSN         = SPACES                            04212299
042123        AND   ASC-RECEIPT-DTE = SPACES                            04212399
042124        AND   ASC-STORE-NBR   = SPACES                            04212499
042125        AND   ASC-TERMINAL    = SPACES                            04212599
042126        AND   ASC-TRANSACTION = SPACES                            04212699
042127        AND   ASC-ADDRESS     = SPACES                            04212799
042128        AND   ASC-STATUS-CDE  = SPACES)                           04212899
042129              SET PS-EDIT-ERROR     TO TRUE                       04212999
042130              SET DP020-MSG-FATAL   TO TRUE                       04213099
042131* ----------  03100-E-LAST NAME MUST BE ENTERED WITH FIRST NAME   04213199
042132              MOVE PC-TSYMSG-03100  TO DP020-MSG-NUMBER           04213299
042133              MOVE DP015-UNP-ALP-BRT-OFF                          04213399
042134                                    TO ALSTNMA                    04213499
042135                                       AFRSTNMA                   04213599
042136              MOVE DP015-RED        TO ALSTNMC                    04213699
042137                                       AFRSTNMC                   04213799
042138              MOVE DP015-REVERSE    TO ALSTNMH                    04213899
042139                                       AFRSTNMH                   04213999
042140              MOVE -1               TO ALSTNML                    04214099
042141     ELSE                                                         04214199
042142     IF ASC-ADDRESS     > SPACES                                  04214299
042143        AND  (ASC-DRIVERS-LIC > SPACES                            04214399
042144        OR    ASC-SSN         > SPACES                            04214499
042145        OR    ASC-LAST-NAME   > SPACES                            04214599
042147        OR    ASC-RECEIPT-DTE > SPACES                            04214799
042148        OR    ASC-STORE-NBR   > SPACES                            04214899
042149        OR    ASC-TERMINAL    > SPACES                            04214999
042150        OR    ASC-TRANSACTION > SPACES                            04215099
042152        OR    ASC-STATUS-CDE  > SPACES)                           04215299
042160              SET PS-EDIT-ERROR     TO TRUE                       04216099
042161              SET DP020-MSG-FATAL   TO TRUE                       04216199
042162* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04216299
042163              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04216399
042164              MOVE DP015-UNP-ALP-BRT-OFF                          04216499
042165                                    TO ADRVLICA                   04216599
042166              MOVE DP015-RED        TO ADRVLICC                   04216699
042167              MOVE DP015-REVERSE    TO ADRVLICH                   04216799
042168              MOVE -1               TO ADRVLICL                   04216899
042169     ELSE                                                         04216999
042170     IF ASC-STATUS-CDE > SPACES                                   04217077
042200        AND  (ASC-DRIVERS-LIC > SPACES                            04220076
042300        OR    ASC-SSN         > SPACES                            04230076
042500        OR    ASC-STORE-NBR   > SPACES                            04250076
042600        OR    ASC-TERMINAL    > SPACES                            04260076
042610        OR    ASC-ADDRESS     > SPACES                            04261099
042700        OR    ASC-TRANSACTION > SPACES)                           04270076
042800              SET PS-EDIT-ERROR     TO TRUE                       04280076
042900              SET DP020-MSG-FATAL   TO TRUE                       04290076
043000* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04300076
043100              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04310076
043200              MOVE DP015-UNP-ALP-BRT-OFF                          04320076
043300                                    TO ASTATCDA                   04330076
043400              MOVE DP015-RED        TO ASTATCDC                   04340076
043500              MOVE DP015-REVERSE    TO ASTATCDH                   04350076
043600              MOVE -1               TO ASTATCDL                   04360076
043700     ELSE                                                         04370076
043800     IF ASC-RECEIPT-DTE > SPACES                                  04380076
043900        AND  (ASC-DRIVERS-LIC > SPACES                            04390076
044000        OR    ASC-SSN         > SPACES)                           04400076
044200              SET PS-EDIT-ERROR     TO TRUE                       04420076
044300              SET DP020-MSG-FATAL   TO TRUE                       04430076
044400* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04440076
044500              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04450076
044600              MOVE DP015-UNP-ALP-BRT-OFF                          04460076
044700                                    TO AREQDTEA                   04470076
044800              MOVE DP015-RED        TO AREQDTEC                   04480076
044900              MOVE DP015-REVERSE    TO AREQDTEH                   04490076
045000              MOVE -1               TO AREQDTEL                   04500076
045100     ELSE                                                         04510076
045200     IF ASC-STORE-NBR > SPACES                                    04520076
045300        AND  (ASC-DRIVERS-LIC > SPACES                            04530076
045400        OR    ASC-SSN         > SPACES                            04540076
045500        OR    ASC-STATUS-CDE  > SPACES)                           04550076
045600              SET PS-EDIT-ERROR     TO TRUE                       04560076
045700              SET DP020-MSG-FATAL   TO TRUE                       04570076
045800* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04580076
045900              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04590076
046000              MOVE DP015-UNP-ALP-BRT-OFF                          04600076
046100                                    TO ASTRNBRA                   04610076
046200              MOVE DP015-RED        TO ASTRNBRC                   04620076
046300              MOVE DP015-REVERSE    TO ASTRNBRH                   04630076
046400              MOVE -1               TO ASTRNBRL                   04640076
046500     ELSE                                                         04650076
046600     IF ASC-TERMINAL > SPACES                                     04660076
046700        AND  (ASC-DRIVERS-LIC > SPACES                            04670076
046800        OR    ASC-SSN         > SPACES                            04680076
046900        OR    ASC-STATUS-CDE  > SPACES)                           04690076
047000              SET PS-EDIT-ERROR     TO TRUE                       04700076
047100              SET DP020-MSG-FATAL   TO TRUE                       04710076
047200* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04720076
047300              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04730076
047400              MOVE DP015-UNP-ALP-BRT-OFF                          04740076
047500                                    TO ASTRRGTA                   04750076
047600              MOVE DP015-RED        TO ASTRRGTC                   04760076
047700              MOVE DP015-REVERSE    TO ASTRRGTH                   04770076
047800              MOVE -1               TO ASTRRGTL                   04780076
047900     ELSE                                                         04790076
048000     IF ASC-TRANSACTION > SPACES                                  04800076
048100        AND  (ASC-DRIVERS-LIC > SPACES                            04810076
048200        OR    ASC-SSN         > SPACES                            04820076
048300        OR    ASC-STATUS-CDE  > SPACES)                           04830076
048400              SET PS-EDIT-ERROR     TO TRUE                       04840076
048500              SET DP020-MSG-FATAL   TO TRUE                       04850076
048600* ----------  03095-E-ONLY ONE SELECTION CRITERIA ALLOWED         04860076
048700              MOVE PC-TSYMSG-03095  TO DP020-MSG-NUMBER           04870076
048800              MOVE DP015-UNP-ALP-BRT-OFF                          04880076
048900                                    TO ARGTTRNA                   04890076
049000              MOVE DP015-RED        TO ARGTTRNC                   04900076
049100              MOVE DP015-REVERSE    TO ARGTTRNH                   04910076
049200              MOVE -1               TO ARGTTRNL                   04920076
049300     END-IF                                                       04930076
049400     END-IF                                                       04940076
049410     END-IF                                                       04941076
049420     END-IF                                                       04942099
049500     END-IF                                                       04950076
049600     END-IF                                                       04960076
049610     END-IF                                                       04961077
049700     END-IF                                                       04970076
049800     END-IF                                                       04980076
049900     END-IF.                                                      04990076
050000                                                                  05000076
050100     IF  ASC-STATUS-CDE > SPACE                                   05010076
050200         MOVE ASC-STATUS-CDE       TO PV-STATUS-CODES             05020076
050300         IF NOT PV-VALID-STATUS-CODE                              05030076
050400             SET PS-EDIT-ERROR                                    05040076
050500                 DP020-MSG-FATAL   TO TRUE                        05050076
050600* ---------- 00005-E-INVALID VALUE                                05060076
050700             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            05070076
050800             MOVE DP015-UNP-ALP-BRT-OFF                           05080076
050900                                   TO ASTATCDA                    05090076
051000             MOVE DP015-RED        TO ASTATCDC                    05100076
051100             MOVE DP015-REVERSE    TO ASTATCDH                    05110076
051200             MOVE -1               TO ASTATCDL                    05120076
051300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05130076
051400         END-IF                                                   05140076
051500     END-IF.                                                      05150076
051600                                                                  05160076
051700     IF  ASC-TRANSACTION > SPACE                                  05170076
051800         MOVE ASC-TRANSACTION      TO DP010I-UNEDITED-FIELD       05180076
051900         MOVE LENGTH OF ASC-TRANSACTION                           05190076
052000                                   TO DP010I-MAXIMUM-DIGITS       05200076
052100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     05210076
052200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  05220076
052310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05231099
052320                         USING DP010I-NUMERIC-EDIT-AREA           05232099
052400         IF  DP010I-ERROR-DETECTED                                05240076
052500             SET PS-EDIT-ERROR                                    05250076
052600                 DP020-MSG-FATAL   TO TRUE                        05260076
052700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            05270076
052800             MOVE DP015-UNP-ALP-BRT-OFF                           05280076
052900                                   TO ARGTTRNA                    05290076
053000             MOVE DP015-RED        TO ARGTTRNC                    05300076
053100             MOVE DP015-REVERSE    TO ARGTTRNH                    05310076
053200             MOVE -1               TO ARGTTRNL                    05320076
053300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05330076
053400         ELSE                                                     05340076
053500             MOVE DP010I-NUMERIC-FIELD                            05350076
053600                                   TO ASC-TRANSACTION-N           05360076
053700                                      ARGTTRNO                    05370076
053800             IF DP010I-NUMERIC-FIELD = ZEROS                      05380076
053900                 SET PS-EDIT-ERROR                                05390076
054000                     DP020-MSG-FATAL                              05400076
054100                                   TO TRUE                        05410076
054200*               -- CANNOT BE ZERO --                              05420076
054300                 MOVE PC-TSYMSG-00010                             05430076
054400                                   TO DP020-MSG-NUMBER            05440076
054500                 MOVE DP015-UNP-ALP-BRT-OFF                       05450076
054600                                   TO ARGTTRNA                    05460076
054700                 MOVE DP015-RED    TO ARGTTRNC                    05470076
054800                 MOVE DP015-REVERSE                               05480076
054900                                   TO ARGTTRNH                    05490076
055000                 MOVE -1           TO ARGTTRNL                    05500076
055100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05510076
055200             END-IF                                               05520076
055300         END-IF                                                   05530076
055400     END-IF.                                                      05540076
055500                                                                  05550076
055600     IF  ASC-TERMINAL > SPACE                                     05560076
055700         MOVE ASC-TERMINAL         TO DP010I-UNEDITED-FIELD       05570076
055800         MOVE LENGTH OF ASC-TERMINAL                              05580076
055900                                   TO DP010I-MAXIMUM-DIGITS       05590076
056000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     05600076
056100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  05610076
056210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05621099
056220                         USING DP010I-NUMERIC-EDIT-AREA           05622099
056300         IF  DP010I-ERROR-DETECTED                                05630076
056400             SET PS-EDIT-ERROR                                    05640076
056500                 DP020-MSG-FATAL   TO TRUE                        05650076
056600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            05660076
056700             MOVE DP015-UNP-ALP-BRT-OFF                           05670076
056800                                   TO ASTRRGTA                    05680076
056900             MOVE DP015-RED        TO ASTRRGTC                    05690076
057000             MOVE DP015-REVERSE    TO ASTRRGTH                    05700076
057100             MOVE -1               TO ASTRRGTL                    05710076
057200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05720076
057300         ELSE                                                     05730076
057400             MOVE DP010I-NUMERIC-FIELD                            05740076
057500                                   TO ASC-TERMINAL-N              05750076
057600                                      ASTRRGTO                    05760076
057700             IF DP010I-NUMERIC-FIELD = ZEROS                      05770076
057800                 SET PS-EDIT-ERROR                                05780076
057900                     DP020-MSG-FATAL                              05790076
058000                                   TO TRUE                        05800076
058100                 MOVE PC-TSYMSG-00010                             05810076
058200                                   TO DP020-MSG-NUMBER            05820076
058300                 MOVE DP015-UNP-ALP-BRT-OFF                       05830076
058400                                   TO ASTRRGTA                    05840076
058500                 MOVE DP015-RED    TO ASTRRGTC                    05850076
058600                 MOVE DP015-REVERSE                               05860076
058700                                   TO ASTRRGTH                    05870076
058800                 MOVE -1           TO ASTRRGTL                    05880076
058900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05890076
059000             END-IF                                               05900076
059100         END-IF                                                   05910076
059200     END-IF.                                                      05920076
059300                                                                  05930076
059400     IF  ASC-STORE-NBR > SPACE                                    05940076
059500         MOVE ASC-STORE-NBR        TO DP010I-UNEDITED-FIELD       05950076
059600         MOVE LENGTH OF ASC-STORE-NBR                             05960076
059700                                   TO DP010I-MAXIMUM-DIGITS       05970076
059800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     05980076
059900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  05990076
060010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06001099
060020                         USING DP010I-NUMERIC-EDIT-AREA           06002099
060100         IF  DP010I-ERROR-DETECTED                                06010076
060200             SET PS-EDIT-ERROR                                    06020076
060300                 DP020-MSG-FATAL   TO TRUE                        06030076
060400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06040076
060500             MOVE DP015-UNP-ALP-BRT-OFF                           06050076
060600                                   TO ASTRNBRA                    06060076
060700             MOVE DP015-RED        TO ASTRNBRC                    06070076
060800             MOVE DP015-REVERSE    TO ASTRNBRH                    06080076
060900             MOVE -1               TO ASTRNBRL                    06090076
061000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06100076
061100         ELSE                                                     06110076
061111             MOVE DP010I-NUMERIC-FIELD                            06111176
061112                                    TO PV-STORE-NUMBER-N          06111276
061113             MOVE PV-STORE-NUMBER-N TO ASC-STORE-NBR              06111376
061114                                       ASTRNBRO                   06111476
061118             IF DP010I-NUMERIC-FIELD = ZEROS                      06111876
061119                 SET PS-EDIT-ERROR                                06111976
061120                     DP020-MSG-FATAL                              06112076
061121                                   TO TRUE                        06112176
061122                 MOVE PC-TSYMSG-00010                             06112276
061123                                   TO DP020-MSG-NUMBER            06112376
061124                 MOVE DP015-UNP-ALP-BRT-OFF                       06112476
061125                                   TO ASTRNBRA                    06112576
061126                 MOVE DP015-RED    TO ASTRNBRC                    06112676
061127                 MOVE DP015-REVERSE                               06112776
061128                                   TO ASTRNBRH                    06112876
061129                 MOVE -1           TO ASTRNBRL                    06112976
061130                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06113076
061131             END-IF                                               06113176
061600         END-IF                                                   06160039
061700     END-IF.                                                      06170039
061800                                                                  06180039
061900     IF ASC-RECEIPT-DTE  > SPACE                                  06190066
062000         INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56      06200039
062100                                                                  06210039
062200         SET DPG52-LK-DTE-GREG-CC                                 06220039
062300             DPG51-ACTUAL-CALENDAR-ONLY                           06230039
062400         TO TRUE                                                  06240066
062500                                                                  06250039
062600         MOVE ASC-RECEIPT-DTE      TO DPG52-LK-DATE-INPUT         06260039
062700                                                                  06270039
062800         CALL DP500-KOHLS-CALENDAR-ROUTINE                        06280039
062900           USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56              06290039
063000                                                                  06300039
063100         EVALUATE TRUE                                            06310039
063200           WHEN DPG54-SEVERE-ERROR                                06320039
063300           WHEN DPG54-DATE-INVALID                                06330039
063400             SET PS-EDIT-ERROR                                    06340039
063500                 DP020-MSG-FATAL TO TRUE                          06350039
063600* ---------- 00009-E-INVALID DATE                                 06360066
063700             MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER             06370039
063800             MOVE DP015-UNP-ALP-BRT-OFF TO AREQDTEA               06380039
063900             MOVE DP015-RED             TO AREQDTEC               06390039
064000             MOVE DP015-REVERSE         TO AREQDTEH               06400039
064100             MOVE -1                    TO AREQDTEL               06410039
064200             SET DP030-SET-CURSOR-APPL-1                          06420039
064300                                        TO TRUE                   06430039
064400         END-EVALUATE                                             06440039
064500     END-IF.                                                      06450066
064600                                                                  06460066
064700     IF  ASC-SSN > SPACES                                         06470039
064800         IF  ASC-SSN NOT NUMERIC                                  06480039
064900             SET PS-EDIT-ERROR                                    06490066
065000                 DP020-MSG-FATAL   TO TRUE                        06500066
065100* ---------- 00008-E-MUST BE NUMERIC                              06510066
065200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06520066
065300             MOVE DP015-UNP-ALP-BRT-OFF                           06530066
065400                                   TO ASSNNBRA                    06540066
065500             MOVE DP015-RED        TO ASSNNBRC                    06550066
065600             MOVE DP015-REVERSE    TO ASSNNBRH                    06560066
065700             MOVE -1               TO ASSNNBRL                    06570066
065800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06580066
065900         ELSE                                                     06590039
066000             IF  ASC-SSN <= ZEROS                                 06600039
066100                 SET PS-EDIT-ERROR                                06610066
066200                     DP020-MSG-FATAL   TO TRUE                    06620066
066300* ----------    00010-E-CANNOT BE ZERO                            06630066
066400                 MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER        06640066
066500                 MOVE DP015-UNP-ALP-BRT-OFF                       06650066
066600                                       TO ASSNNBRA                06660066
066700                 MOVE DP015-RED        TO ASSNNBRC                06670066
066800                 MOVE DP015-REVERSE    TO ASSNNBRH                06680066
066900                 MOVE -1               TO ASSNNBRL                06690066
067000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06700066
067100             END-IF                                               06710039
067200         END-IF                                                   06720039
067300     END-IF.                                                      06730039
067400                                                                  06740066
067410*BC                                                               06741099
067500*    IF  ASC-DRIVERS-LIC > SPACE                                  06750099
067600*       MOVE SPACES TO CRWS500-INPUT-DL                           06760099
067700*                      CRWS500-OUTPUT-DL                          06770099
067800*       MOVE FUNCTION UPPER-CASE(ASC-DRIVERS-LIC)                 06780099
067900*                   TO CRWS500-INPUT-DL                           06790099
068000*       PERFORM PD500-SHIFT-CONV-ALPHA-DL                         06800099
068100*          THRU PD500-EXIT                                        06810099
068200*       MOVE CRWS500-OUTPUT-DL TO ASC-DRIVERS-LIC                 06820099
068300*    END-IF.                                                      06830099
068400                                                                  06840066
068410     IF  ASC-LAST-NAME  > SPACE                                   06841086
068420        SET ASC-PF17-YES TO TRUE                                  06842086
068430     ELSE                                                         06843086
068440        SET ASC-PF17-NO TO TRUE                                   06844086
068490     END-IF.                                                      06849086
068491                                                                  06849186
068492     IF  ASC-ADDRESS  > SPACE                                     06849299
068493        SET ASC-PF19-YES TO TRUE                                  06849399
068494     ELSE                                                         06849499
068495        SET ASC-PF19-NO TO TRUE                                   06849599
068496     END-IF.                                                      06849699
068497                                                                  06849799
068500     IF    ASC-STATUS-CDE  = SPACES                               06850066
068600     AND   ASC-TRANSACTION = SPACES                               06860066
068700     AND   ASC-TERMINAL    = SPACES                               06870066
068800     AND   ASC-STORE-NBR   = SPACES                               06880066
068900     AND   ASC-STORE-NBR   = SPACES                               06890066
069000     AND   ASC-RECEIPT-DTE = SPACES                               06900066
069100     AND   ASC-SSN         = SPACES                               06910039
069200     AND   ASC-DRIVERS-LIC = SPACES                               06920066
069210     AND   ASC-LAST-NAME   = SPACES                               06921075
069220     AND   ASC-FIRST-NAME  = SPACES                               06922082
069230     AND   ASC-ADDRESS     = SPACES                               06923099
069300             SET PS-EDIT-ERROR                                    06930066
069400                 DP020-MSG-FATAL   TO TRUE                        06940066
069500*    ------- 00007-E-REQUIRED-ENTRY                               06950066
069600             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            06960066
069700             MOVE -1               TO ADRVLICL                    06970066
069800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06980066
069900     END-IF.                                                      06990066
070000                                                                  07000066
070100     IF  PS-NO-EDIT-ERROR                                         07010066
070200         MOVE -1                   TO ADRVLICL                    07020066
070300         SET DP030-SET-CURSOR-APPL-1                              07030066
070400                                   TO TRUE                        07040066
070500     END-IF.                                                      07050066
070600                                                                  07060066
070700******************************************************************07070066
070800** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **07080066
070900** MAP.                                                         **07090066
071000******************************************************************07100066
071100 3200-RESET-ATTRIBUTES.                                           07110066
071200     MOVE DP015-UNP-ALP-NOR-OFF    TO ADRVLICA                    07120066
071300                                      ASSNNBRA                    07130066
071310                                      ALSTNMA                     07131076
071320                                      AFRSTNMA                    07132076
071400                                      AREQDTEA                    07140066
071500                                      ASTRNBRA                    07150066
071600                                      ASTRRGTA                    07160066
071700                                      ARGTTRNA                    07170066
071710                                      AADDRSSA                    07171099
071800                                      ASTATCDA.                   07180066
071900     MOVE DP015-GREEN              TO ADRVLICC                    07190066
072000                                      ASSNNBRC                    07200066
072010                                      ALSTNMC                     07201076
072020                                      AFRSTNMC                    07202076
072100                                      AREQDTEC                    07210066
072200                                      ASTRNBRC                    07220066
072300                                      ASTRRGTC                    07230066
072400                                      ARGTTRNC                    07240066
072410                                      AADDRSSC                    07241099
072500                                      ASTATCDC.                   07250066
072600     MOVE DP015-UNDERLINE          TO ADRVLICH                    07260066
072700                                      ASSNNBRH                    07270066
072710                                      ALSTNMH                     07271076
072720                                      AFRSTNMH                    07272076
072800                                      AREQDTEH                    07280066
072900                                      ASTRNBRH                    07290066
073000                                      ASTRRGTH                    07300066
073100                                      ARGTTRNH                    07310066
073110                                      AADDRSSH                    07311099
073200                                      ASTATCDH.                   07320066
073300*                                                                 07330066
073400*----------------------------------------------------------------*07340066
073500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *07350066
073600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *07360066
073700*  IT HERE.                                                      *07370066
073800*----------------------------------------------------------------*07380066
073900 4000-BUILD-INITIAL-PANEL.                                        07390066
074000     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        07400066
074100     MOVE -1                       TO ADRVLICL.                   07410066
074200                                                                  07420067
074300*----------------------------------------------------------------*07430066
074400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *07440066
074500*----------------------------------------------------------------*07450066
074600 4400-MOVE-COMMAREA-TO-SCREEN.                                    07460066
074700                                                                  07470067
074800     MOVE ASC-DRIVERS-ORIG         TO ADRVLICO.                   07480066
074900     MOVE ASC-SSN                  TO ASSNNBRO.                   07490066
074910     MOVE ASC-LAST-NAME            TO ALSTNMO.                    07491076
074920     MOVE ASC-FIRST-NAME           TO AFRSTNMO.                   07492076
075000     MOVE ASC-RECEIPT-DTE          TO AREQDTEO.                   07500066
075100     MOVE ASC-STORE-NBR            TO ASTRNBRO.                   07510066
075200     MOVE ASC-TERMINAL             TO ASTRRGTO.                   07520066
075300     MOVE ASC-TRANSACTION          TO ARGTTRNO.                   07530066
075400     MOVE ASC-STATUS-CDE           TO ASTATCDO.                   07540066
075410     MOVE ASC-ADDRESS              TO AADDRSSO.                   07541099
075500*                                                                 07550099
075510*BC  WR33375                                                      07551099
075600**********************************************************        07560066
075700*  DRIVERS LICENSE ROUTINE CRPD500                                07570066
075800**********************************************************        07580066
075810*BC  WR33375                                                      07581099
075820                                                                  07582099
075900*BC  COPY CRPD500.                                                07590099
076000*----------------------------------------------------------------*07600066
076100*    ABEND PROCESSOR MODULE                                      *07610066
076200*----------------------------------------------------------------*07620066
076300                                                                  07630066
076400     COPY DPPD013.                                                07640093
076500*                                                                 07650039
