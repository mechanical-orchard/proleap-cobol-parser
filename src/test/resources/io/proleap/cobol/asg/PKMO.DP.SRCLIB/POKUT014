000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKUT014.                                         00020000
000300 AUTHOR.        CHRIS KORTENDICK.                                 00030000
000400 DATE-WRITTEN   07/93.                                            00040000
000500***                                                               00050000
000600***   REFORMAT EDI INPUT FILE TO CONSOLIDATE DUPLICATE SKUS WITHIN00060000
000700***   A PURCHASE ORDER                                            00070000
000800***                                                               00080000
      ******************************************************************00090000
      * DATE  03/22/00                                                 *00100000
      *   WR20853 INCREASE 300 STORE LIMIT TO 500.                     *00110000
      ******************************************************************00120000
      * DATE  07/17/02                                                 *00130000
      *   P477920 INCREASE 800 STORE LIMIT TO 999.                     *00140000
      ******************************************************************00150000
      ******************************************************************00160000
      * DATE  06/10/08                                                 *00170000
      *   WR34211 INCREASE 999 STORE LIMIT TO 1500. ALSO INCREASED     *00180000
      *   SKU LIMIT TO 1500.  STILL HAVE LIMIT OF 999 SKU'S PER ORDER  *00190000
      *   BUT WE WILL NOW WRITE THOSE PO'S TO A REPORT AND             *00200000
      *   AUTOMATICALLY SEND AN E-MAIL TO MIO NOTIFYING THEM THAT      *00210000
      *   THERE WAS A PO WITH MORE THAN 999 SKU'S.  REPORT WILL        *00220000
      *   DISPLAY VENDOR NAME, PO NUMBER AND NUMBER OF SKU'S (IF       *00230000
      *   MORE THAN 1500, WILL DISPLAY '>1500')                         00240000
      ******************************************************************00250000
WR0933******************************************************************00260000
WR0933*04/09/12 - COGNIZANT         WR40933                            *00270000
WR0933*         - ADDED CHANGES RELATED TO "T-SHIRT INTERNATIONAL INC".*00280000
W41905******************************************************************00290000
W41905*04/26/13 - COGNIZANT         WR41905                            *00300000
W41905*         - ADDED CHANGES RELATED TO "JACMEL JEWELRY INC".       *00310000
W41952*04/26/13 - COGNIZANT         WR41952                            *00320000
W41952*         - ADDED CHANGES RELATED TO "G-III LEATHER FASHIONS".   *00330000
W42092*08/16/13 - COGNIZANT         WR42092                             00340000
W42092*         - ADDED CHANGES RELATED TO "PVH SUPERBA".              *00350000
CHGID *03/05/14 - COGNIZANT         INC0588831                          00360000
CHGID *         - CHANGED THE EDI TRADING PARTNER ID AS 08/4229981500  *00370000
CHGID *         - INSTEAD OF 12/2035798435 & 12/8187827568 FOR          00380000
CHGID *         - THE VENDORS OLGA AND WARNER'S.                        00390000
534202*04/04/14 - COGNIZANT         INC0534202                          00400000
534202*         - ADDED CHANGES RELATED TO "J AMERICA".                *00410000
453643*04/16/15 - COGNIZANT         INC1453643                          00420000
453643*         - ADDED CHANGES RELATED TO                             *00430000
453643*           "ETERNAL FORTUNE FASHIONS LLC"                       *00440000
494672*04/29/15 - COGNIZANT         INC1494672                          00450000
494672*         - ADDED CHANGES RELATED TO                             *00460000
494672*           "HAGGAR CLOTHING COMPANY'                            *00470000
686121*07/07/15 - COGNIZANT         INC1686121                          00480000
686121*         - ADDED CHANGES RELATED TO                             *00490000
686121*           "WILLIAMSON-DICKIE MFG CO''                          *00500000
102069*10/28/15 - COGNIZANT         INC2102069                          00510000
102069*         - ADDED CHANGES RELATED TO                             *00520000
102069*           "G-III LEATHER FASHIONS"                             *00530000
371617*02/04/16 - COGNIZANT         INC2371617                          00540000
371617*         - ADDED CHANGES RELATED TO                             *00550000
371617*           "NEW ERA CAP CO INC"                                 *00560000
505256*02/29/16 - COGNIZANT         INC2505256                          00570000
505256*         - ADDED CHANGES RELATED TO                             *00580000
505256*           "MAIDENFORM INC"                                     *00590000
683003*04/22/16 - COGNIZANT         INC2683003                          00600000
683003*         - ADDED CHANGES RELATED TO                             *00610000
683003*           "RANDA ACCESSORIES"                                  *00620000
683026*04/22/16 - COGNIZANT         INC2683026                          00630000
683026*         - ADDED CHANGES RELATED TO                             *00640000
683026*           "RANDA CORP"                                         *00650000
944205*07/05/16 - COGNIZANT         INC2944205                          00660000
944205*         - ADDED CHANGES RELATED TO                             *00670000
944205*           "BOELTER COMPANIES"                                  *00680000
002139*08/12/16 - COGNIZANT         INC3002139                          00690000
002139*         - ADDED CHANGES RELATED TO                             *00700000
002139*           "GONZALES ENT INC DBA FIFTH SUN"                     *00710000
714055*01/17/17 - COGNIZANT         INC3714055                          00720000
714055*         - ADDED CHANGES RELATED TO                             *00730000
714055*           CHANGED INTERFACE ID TO "COLOSSEUM ATHLETICS INC"    *00740000
647062*01/23/17 - COGNIZANT         INC3647062                          00750000
647062*         - ADDED CHANGES RELATED TO                             *00760000
647062*           "LUXOTTICA USA LLC "                                 *00770000
042023*04/06/17 - COGNIZANT         INC4042023                          00780000
042023*         - ADDED CHANGES RELATED TO                             *00790000
042023*           "CC PRODUCTS"                                        *00800000
018127*06/30/17 - COGNIZANT         INC4018127                          00810000
018127*         - ADDED CHANGES RELATED TO                             *00820000
018127*           "TERVIS TUMBLER"                                     *00830000
356324*06/30/17 - COGNIZANT         INC4356324                          00840000
356324*         - ADDED CHANGES RELATED TO                             *00850000
356324*           "PERRY ELLIS MENSWEAR"                               *00860000
575459*08/24/17 - COGNIZANT         INC4575459                          00870000
575459*         - ADDED TRADING PARTNER ID 12/9139423258 TO            *00880000
575459*           "GEAR FOR SPORTS" VENDOR                             *00890000
637834*06/19/18 - COGNIZANT         INC5637834                          00900000
637834*         - ADDED CHANGES RELATED TO                             *00910000
637834*           "OURAY SPORTSWEAR"                                   *00920000
756744*10/18/18 - COGNIZANT         INC6756744                          00930000
756744*         - REPLACE INTERCHANGE ID 125175212525 WITH 125176557948*00940000
756744*           FOR VENDOR "J AMERICA".                               00950000
185577*12/12/18 - COGNIZANT         INC7185577                          00960000
185577*         - ADDED CHANGES RELATED TO                             *00970000
185577*           "BESPOKE FASHION LLC"                                *00980000
790723*02/28/19 - COGNIZANT         SCTASK0790723                       00990000
790723*         - ADDED CHANGES RELATED TO                             *01000000
790723*           "FGX INTERNATIONAL INC"                              *01010000
956632*05/22/19 - COGNIZANT         INC7956632                          01020000
956632*         - ADDED CHANGES RELATED TO                             *01030000
956632*           "RANDA LUGGAGE"                           *           01040000
956632*05/22/19 - COGNIZANT         INC7956632                          01050000
956632*         - ADDED CHANGES RELATED TO                             *01060000
956632*           "LOGO BRANDS INC"                                    *01070000
956632*05/22/19 - COGNIZANT         INC7956632                          01080000
956632*         - ADDED CHANGES RELATED TO                             *01090000
956632*           "GREAT AMERICAN PRODUCTS"                            *01100000
346771*08/06/19 - COGNIZANT         INC8346771                          01110000
346771*         - ADDED CHANGES RELATED TO                             *01120000
346771*           "MAD ENGINE LLC"                                     *01130000
265129*08/06/19 - COGNIZANT         INC8265129                          01140000
265129*         - ADDED CHANGES RELATED TO                             *01150000
265129*           "HYBRID PROMOTIONS LLC"                              *01160000
887802*10/22/19 - COGNIZANT         INC8887802                          01170000
887802*         - ADDED CHANGES RELATED TO                             *01180000
887802*           "BIOWORLD MERCHANDISING"                             *01190000
927044*10/30/19 - COGNIZANT         INC8927044                          01200000
927044*         - ADDED CHANGES RELATED TO                             *01210000
927044*           "NORTHWEST CO/ASHLAND MILL"                          *01220000
925845*10/30/19 - COGNIZANT         INC8925845                          01230000
925845*         - ADDED CHANGES RELATED TO                             *01240000
925845*           "FOR BARE FEET"                                      *01250000
762449*09/30/20 - ADDED CHANGES RELATED TO                             *01260000
762449*           "MASTERPIECES PUZZLE COMPANY"                        *01270000
352053*08/11/22 - SRINIVASAN SIVARAJ INC13352053                       *01280000
352053*           CHANGED NAME OF "TWINS NEW YORK" TO "47BRAND LLC"    *01290000
889751*01/04/23 - ADDED CHANGES RELATED TO INC13889751                 *01300000
889751*           "RIPPLE JUNCTION DESIGN CO INC"                      *01310000
064017*03/03/23 - SRINIVASAN SIVARAJ INC14064017                        01320000
064017*         - ADDED CHANGES RELATED TO                             *01330000
064017*           "S LICHTENBERG & CO INC"                             *01340000
176716*04/13/23 - SRINIVASAN SIVARAJ INC14176716                        01350000
176716*         - ADDED CHANGES RELATED TO                             *01360000
176716*           "SPIRIT LEATHERWORKS LLC"                            *01370000
176682*04/13/23 - SRINIVASAN SIVARAJ INC14176682                        01380000
176682*         - ADDED CHANGES RELATED TO                             *01390000
176682*           "TEE SHIRT CENTRAL INC"                              *01400000
680553*10/05/23 - SRINIVASAN SIVARAJ INC14680553                        01410000
680553*         - ADDED CHANGES RELATED TO                             *01420000
680553*           "LF MEN'S GROUP LLC"                                 *01430000
WR0933******************************************************************01440000
000900 ENVIRONMENT DIVISION.                                            01450000
001000 INPUT-OUTPUT SECTION.                                            01460000
001100 FILE-CONTROL.                                                    01470000
001200                                                                  01480000
001300     SELECT INPUT-FILE                                            01490000
001400            ASSIGN TO INP01.                                      01500000
001500                                                                  01510000
001600     SELECT OUTPUT-FILE                                           01520000
001700            ASSIGN TO OUT01.                                      01530000
001800                                                                  01540000
           SELECT EMAIL-MSG-FILE                                        01550000
                  ASSIGN TO OUT02.                                      01560000
001800                                                                  01570000
           SELECT REPORT-FILE                                           01580000
                  ASSIGN TO RPT01.                                      01590000
001800                                                                  01600000
001900 DATA DIVISION.                                                   01610000
002000 FILE SECTION.                                                    01620000
002100                                                                  01630000
002200 FD  INPUT-FILE                                                   01640000
002300     LABEL RECORDS ARE STANDARD                                   01650000
002400     RECORDING MODE IS F                                          01660000
002500     RECORD CONTAINS 350 CHARACTERS                               01670000
002600     BLOCK CONTAINS 0 RECORDS                                     01680000
002700     DATA RECORD IS INPUT-RECORD.                                 01690000
002800                                                                  01700000
002900 01  INPUT-RECORD                     PIC X(350).                 01710000
003000                                                                  01720000
003100 FD  OUTPUT-FILE                                                  01730000
003200     LABEL RECORDS ARE STANDARD                                   01740000
003300     RECORDING MODE IS F                                          01750000
003400     RECORD CONTAINS 350 CHARACTERS                               01760000
003500     BLOCK CONTAINS 0 RECORDS                                     01770000
003600     DATA RECORD IS OUTPUT-RECORD.                                01780000
003700                                                                  01790000
003800 01  OUTPUT-RECORD                    PIC X(350).                 01800000
003900                                                                  01810000
       FD  EMAIL-MSG-FILE                                               01820000
           RECORDING MODE F                                             01830000
           BLOCK CONTAINS 0 RECORDS                                     01840000
           LABEL RECORDS ARE STANDARD                                   01850000
           DATA RECORD IS EMAIL-MSG-FILE-RECORD.                        01860000
       01  EMAIL-MSG-FILE-RECORD           PIC X(80).                   01870000
003900                                                                  01880000
024200 FD  REPORT-FILE                                                  01890000
024300     RECORDING MODE IS F                                          01900000
024400*    LABEL RECORDS ARE STANDARD                                   01910000
006300     LABEL RECORDS ARE OMITTED                                    01920000
024500     BLOCK CONTAINS 0 RECORDS                                     01930000
006200     RECORD CONTAINS 150 CHARACTERS                               01940000
024600     DATA RECORD IS REPORT-REC.                                   01950000
024700 01  REPORT-REC                  PIC  X(150).                     01960000
003900                                                                  01970000
004000 WORKING-STORAGE SECTION.                                         01980000
004100                                                                  01990000
025200 01  PC-PROGRAM-CONSTANTS.                                        02000000
025500     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'POKUT014'. 02010000
025600     05  PC-LINES-MAX            PIC S999       VALUE +64.        02020000
004100                                                                  02030000
039400 01  PV-REPORT-CONTROLS.                                          02040000
039500     05  PV-LINE-SKIP            PIC S999       VALUE ZEROES.     02050000
039600     05  PV-LINES-PER-PAGE       PIC S999       VALUE +999.       02060000
039700     05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     02070000
039800     05  PV-COUNT                PIC S9(05)     VALUE ZEROES.     02080000
004100                                                                  02090000
035500     05  PV-CURRENT-DATE.                                         02100000
035600         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      02110000
035700         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      02120000
035800         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      02130000
035900     05  PV-CURRENT-TIME.                                         02140000
036000         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     02150000
036100         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     02160000
036200         10  FILLER              PIC  9(02)     VALUE ZEROES.     02170000
                                                                        02180000
004200 01  WS-MISCELLANEOUS.                                            02190000
004300     05  WS-ALLOC-MAX                 PIC S9(4) COMP SYNC         02200000
004400                                                VALUE +10.        02210000
004500     05  SUB1                         PIC S9(4) COMP SYNC         02220000
004600                                                VALUE ZERO.       02230000
004700     05  WS-INPUT-SKU                 PIC X(08) VALUE SPACES.     02240000
           05  WS-CURR-INTERCHANGE          PIC X(17) VALUE SPACES.     02250000
           05  WS-CURR-ISA-CNTL-NBR         PIC 9(09) VALUE ZERO.       02260000
004800                                                                  02270000
004900 01  WS-INDS-SWITCHES.                                            02280000
005000     05  WS-PO-IND                    PIC X     VALUE 'C'.        02290000
005100         88  CURRENT-PO                         VALUE 'C'.        02300000
005200         88  NEW-PO                             VALUE 'N'.        02310000
005300     05  WS-MORE-INPUT-SW             PIC X     VALUE 'Y'.        02320000
005400         88  MORE-INPUT                         VALUE 'Y'.        02330000
005500         88  NO-MORE-INPUT                      VALUE 'N'.        02340000
005600     05  WS-MORE-OUTPUT-SW            PIC X     VALUE 'Y'.        02350000
005700         88  MORE-OUTPUT                        VALUE 'Y'.        02360000
005800         88  NO-MORE-OUTPUT                     VALUE 'N'.        02370000
005900     05  WS-MORE-ALLOCS-SW            PIC X     VALUE 'Y'.        02380000
006000         88  MORE-ALLOCS                        VALUE 'Y'.        02390000
006100         88  NO-MORE-ALLOCS                     VALUE 'N'.        02400000
006200     05  WS-STORE-FOUND-SW            PIC X     VALUE 'N'.        02410000
006300         88  WS-STORE-FOUND                     VALUE 'Y'.        02420000
006400         88  WS-STORE-NOT-FOUND                 VALUE 'N'.        02430000
006500     05  WS-INDEX-FOUND-SW            PIC X     VALUE 'N'.        02440000
006600         88  WS-INDEX-FOUND                     VALUE 'Y'.        02450000
006700         88  WS-INDEX-NOT-FOUND                 VALUE 'N'.        02460000
006500     05  WS-ERROR-RECORD-SW           PIC X     VALUE 'N'.        02470000
006600         88  WS-ERROR-REC-YES                   VALUE 'Y'.        02480000
006700         88  WS-ERROR-REC-NO                    VALUE 'N'.        02490000
005000     05  WS-WRITE-HEADER-REC-SW       PIC X     VALUE 'N'.        02500000
005100         88  WRITE-HEADER-YES                   VALUE 'Y'.        02510000
005200         88  WRITE-HEADER-NO                    VALUE 'N'.        02520000
005300     05  WS-MORE-INPUT-REC-SW         PIC X     VALUE 'Y'.        02530000
005400         88  MORE-INPUT-REC                     VALUE 'Y'.        02540000
005500         88  NO-MORE-INPUT-REC                  VALUE 'N'.        02550000
006800                                                                  02560000
006900 01  WS-SKU-TABLE.                                                02570000
007000     05  WS-SKU-TBL-ENTRY  OCCURS 1500  TIMES                     02580000
007100                           INDEXED BY INDEX1.                     02590000
007200         10  WS-SKU-TBL-PO-NBR        PIC  9(09).                 02600000
007300         10  WS-SKU-TBL-UPC           PIC  X(15).                 02610000
007400         10  WS-SKU-TBL-SKU           PIC  X(08).                 02620000
007500         10  WS-SKU-TBL-SKU-CNT       PIC  9(03).                 02630000
007600         10  WS-SKU-TBL-TOT-QTY       PIC S9(07).                 02640000
007700         10  WS-SKU-TBL-UNT-CST       PIC S9(12)V9(6).            02650000
007800         10  WS-SKU-TBL-STR-ENTRY  OCCURS 1500 TIMES              02660000
007900                                   INDEXED BY INDEX2.             02670000
008000             15  WS-SKU-TBL-STR-NBR   PIC  X(05).                 02680000
008100             15  WS-SKU-TBL-ORD-QTY   PIC S9(07).                 02690000
008200                                                                  02700000
008300 01  WS-RECORD-COUNTS.                                            02710000
008400     05  WS-TOT-SKUS-IN               PIC 9(04) VALUE ZERO.       02720000
008500     05  WS-TOT-SKUS-OUT              PIC 9(04) VALUE ZERO.       02730000
008500     05  WS-TOT-SKUS-OUT-COUNT        PIC 9(04) VALUE ZERO.       02740000
008600     05  WS-SKU-CNT                   PIC 9(03) VALUE ZERO.       02750000
008700                                                                  02760000
008800 01  WS-DISPLAY-FIELDS.                                           02770000
008900     05  WS-PO-NBR-D                  PIC ZZZZZZZZ9.              02780000
009000     05  WS-TOT-SKUS-IN-D             PIC ZZZ9.                   02790000
009100     05  WS-TOT-SKUS-OUT-D            PIC ZZZ9.                   02800000
009200     05  WS-DISPLAY-PO-NBR-LIT        PIC X(17) VALUE             02810000
009300         'PURCHASE ORDER : '.                                     02820000
009400     05  WS-DISPLAY-SKUS-IN-LIT       PIC X(17) VALUE             02830000
009500         'S K U"S   INPUT: '.                                     02840000
009600     05  WS-DISPLAY-SKUS-OUT-LIT      PIC X(17) VALUE             02850000
009700         'S K U"S  OUTPUT: '.                                     02860000
009800     05  WS-DISPLAY-LINE              PIC X(80) VALUE SPACES.     02870000
009900                                                                  02880000
      *----------------------------------------------------------       02890000
      * EM - EMAIL MESSAGE DATA LINES                                   02900000
      *----------------------------------------------------------       02910000
       01  EM-EMAIL-MESSAGE-DATA-LINES.                                 02920000
           05  EM-DATA-LINE-1           PIC X(80)  VALUE                02930000
                 'HELO KOHLS@KOHLS.COM'.                                02940000
           05  EM-DATA-LINE-2           PIC X(80)  VALUE                02950000
                 'MAIL FROM: <KOHLSBATCHMAIL@KOHLS.COM>'.               02960000
           05  EM-DATA-LINE-3           PIC X(80)  VALUE                02970000
                 'RCPT TO: <EDIMIO@KOHLS.COM>'.                         02980000
           05  EM-DATA-LINE-4           PIC X(80)  VALUE                02990000
                 'DATA'.                                                03000000
           05  EM-DATA-LINE-5           PIC X(80)  VALUE                03010000
                 'TO: EDIMIO'.                                          03020000
           05  EM-DATA-LINE-6.                                          03030000
               10  EM-DATA-LINE-6-TXT   PIC X(56)  VALUE                03040000
             'SUBJECT: EDI855 PURCHASE ORDER WITH MORE THAN 999 SKUS  '.03050000
               10  EM-DATA-LINE-6-QM    PIC X(04)  VALUE SPACES.        03060000
               10  FILLER               PIC X(20)  VALUE SPACES.        03070000
           05  EM-DATA-LINE-7           PIC X(80)  VALUE                03080000
                 'REVIEW RDS REPORT POK04505 FOR PO/VENDOR DETAIL '.    03090000
                                                                        03100000
010000******************************************************************03110000
010100*   INPUT FILE LAYOUT                                             03120000
010200******************************************************************03130000
010300 01  INPUT-REC                        PIC X(350).                 03140000
010400                                                                  03150000
010500 01  INPUT-HEADER-REC     REDEFINES INPUT-REC.                    03160000
010600     05  INPUT-H-PO-NBR               PIC 9(09).                  03170000
010700     05  FILLER                       PIC X(29).                  03180000
010800     05  FILLER                       PIC X(01).                  03190000
010900         88  INPUT-HEADER-RECORD                VALUE '1'.        03200000
011000     05  FILLER                       PIC X(14).                  03210000
           05  INPUT-H-INTERCHANGE          PIC X(17).                  03220000
           05  FILLER                       PIC X(01).                  03230000
           05  INPUT-H-ISA-CNTL-NBR         PIC X(09).                  03240000
 11100     05  FILLER                       PIC X(270).                 03250000
011200                                                                  03260000
011300 01  INPUT-ITEM-REC     REDEFINES INPUT-REC.                      03270000
011400     05  INPUT-I-PO-NBR               PIC 9(09).                  03280000
011500     05  FILLER                       PIC X(06).                  03290000
011600     05  INPUT-I-UPC                  PIC X(15).                  03300000
011700     05  INPUT-I-SKU                  PIC X(08).                  03310000
011800     05  FILLER                       PIC X(01).                  03320000
011900         88  INPUT-ITEM-RECORD                  VALUE '2'.        03330000
012000     05  INPUT-I-TOTAL-QTY            PIC S9(07).                 03340000
012100     05  INPUT-I-UNIT-COST            PIC S9(12)V9(6).            03350000
012200     05  FILLER                       PIC X(286).                 03360000
012300                                                                  03370000
012400 01  INPUT-ALLOC-REC     REDEFINES INPUT-REC.                     03380000
012500     05  INPUT-A-PO-NBR               PIC 9(09).                  03390000
012600     05  FILLER                       PIC X(29).                  03400000
012700     05  FILLER                       PIC X(01).                  03410000
012800         88  INPUT-ALLOC-RECORD                  VALUE '3'.       03420000
012900     05  INPUT-A-STORE-ALLOCS    OCCURS 10 TIMES.                 03430000
013000         10  INPUT-A-STORE-NBR        PIC X(05).                  03440000
013100         10  INPUT-A-ORDER-QTY        PIC S9(07).                 03450000
013200     05  FILLER                       PIC X(211).                 03460000
013300                                                                  03470000
041600*----------------------------------------------------------------*03480000
041700*  STANDARD HEADER LAYOUT                                         03490000
041800*----------------------------------------------------------------*03500000
041900     COPY DPWS150O.                                               03510000
042000                                                                  03520000
042100*----------------------------------------------------------------*03530000
042200*  REPORT LAYOUT                                                  03540000
042300*----------------------------------------------------------------*03550000
042400                                                                  03560000
042500 01  HL-HEADER2.                                                  03570000
042600     05  FILLER                  PIC  X(54)     VALUE SPACES.     03580000
042700     05  HL-TITLE                PIC  X(46)     VALUE             03590000
042800         'EDI855 PURCHASE ORDERS WITH MORE THAN 999 SKUS'.        03600000
042900     05  FILLER                  PIC  X(50)     VALUE SPACES.     03610000
043000                                                                  03620000
043100 01  HL-HEADER3.                                                  03630000
043200     05  FILLER                  PIC   X(18)    VALUE             03640000
043300         '   VENDOR  NAME   '.                                    03650000
043400     05  FILLER                  PIC   X(30)    VALUE SPACES.     03660000
043500     05  FILLER                  PIC   X(18)    VALUE             03670000
043300         '      PO NUMBER   '.                                    03680000
           05  FILLER                  PIC   X(10)    VALUE SPACES.     03690000
           05  FILLER                  PIC   X(14)    VALUE             03700000
               '   SKU COUNT  '.                                        03710000
044400     05  FILLER                  PIC   X(15)    VALUE             03720000
               ' ISA CONTROL # '.                                       03730000
044400     05  FILLER                  PIC   X(45)    VALUE SPACES.     03740000
046400                                                                  03750000
046500 01  DL-DETAIL.                                                   03760000
046600     05  FILLER                  PIC   X(02)    VALUE SPACES.     03770000
046700     05  DL-VENDOR-NAME          PIC   X(30)    VALUE SPACES.     03780000
046800     05  FILLER                  PIC   X(20)    VALUE SPACES.     03790000
046900     05  DL-PO-NBR               PIC   X(09)    VALUE SPACES.     03800000
           05  FILLER                  PIC   X(18)    VALUE SPACES.     03810000
           05  DL-SKU-COUNT            PIC   X(05)    VALUE SPACES.     03820000
047000     05  FILLER                  PIC   X(07)    VALUE SPACES.     03830000
           05  DL-ISA-CNTL-NBR         PIC   9(09)    VALUE ZERO.       03840000
047000     05  FILLER                  PIC   X(50)    VALUE SPACES.     03850000
048200                                                                  03860000
048300 01  END-OF-REPORT.                                               03870000
048400     05  FILLER                  PIC  X(56)     VALUE SPACES.     03880000
048500     05  FILLER                  PIC  X(37)     VALUE             03890000
048600         '**********  END OF REPORT  **********'.                 03900000
048700     05  FILLER                  PIC  X(57)     VALUE SPACES.     03910000
048800                                                                  03920000
      *----------------------------------------------------------       03930000
      *  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              03940000
      *----------------------------------------------------------       03950000
           COPY DPWS023.                                                03960000
                                                                        03970000
013400******************************************************************03980000
013500*   OUTPUT FILE LAYOUT                                            03990000
013600******************************************************************04000000
013700     COPY PORD002.                                                04010000
013800                                                                  04020000
013900 PROCEDURE DIVISION.                                              04030000
064900     ACCEPT PV-CURRENT-DATE FROM DATE.                            04040000
065000     MOVE PV-CURRENT-MONTH       TO DP150O-RUN-MONTH.             04050000
065100     MOVE PV-CURRENT-DAY         TO DP150O-RUN-DAY.               04060000
065200     MOVE PV-CURRENT-YEAR        TO DP150O-RUN-YEAR.              04070000
065300                                                                  04080000
065400     ACCEPT PV-CURRENT-TIME FROM TIME.                            04090000
065500     MOVE PV-CURRENT-HOUR        TO DP150O-RUN-HOUR.              04100000
065600     MOVE PV-CURRENT-MINUTE      TO DP150O-RUN-MINUTE.            04110000
065700     MOVE PC-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          04120000
065800     MOVE 1                      TO DP150O-REPORT-NUMBER.         04130000
014000                                                                  04140000
014100     PERFORM 1000-OPEN-FILES.                                     04150000
014200                                                                  04160000
014300     PERFORM 2000-PROCESS-INPUT-FILE                              04170000
014400             UNTIL NO-MORE-INPUT.                                 04180000
014500                                                                  04190000
014600     PERFORM 3000-CLOSE-FILES.                                    04200000
                                                                        04210000
           PERFORM 4000-SEND-EMAIL-MSG.                                 04220000
014700                                                                  04230000
014800     STOP RUN.                                                    04240000
014900                                                                  04250000
015000 1000-OPEN-FILES.                                                 04260000
015100                                                                  04270000
015200     OPEN INPUT  INPUT-FILE                                       04280000
015300          OUTPUT OUTPUT-FILE                                      04290000
015400                 REPORT-FILE.                                     04300000
015500     SET MORE-INPUT TO TRUE.                                      04310000
           SET MORE-INPUT-REC TO TRUE.                                  04320000
015600                                                                  04330000
015700     PERFORM 8000-READ-INPUT-FILE.                                04340000
015800                                                                  04350000
015900     IF NO-MORE-INPUT                                             04360000
016000         DISPLAY ' '                                              04370000
016100         DISPLAY '##########   INPUT FILE WAS EMPTY   ##########' 04380000
016200     ELSE                                                         04390000
016300         MOVE INPUT-H-PO-NBR TO WS-PO-NBR-D                       04400000
               MOVE INPUT-H-INTERCHANGE  TO WS-CURR-INTERCHANGE         04410000
               MOVE INPUT-H-ISA-CNTL-NBR TO WS-CURR-ISA-CNTL-NBR        04420000
016400     END-IF.                                                      04430000
016500                                                                  04440000
016600 2000-PROCESS-INPUT-FILE.                                         04450000
016700                                                                  04460000
016800     INITIALIZE WS-SKU-TABLE.                                     04470000
016900     MOVE ZERO TO WS-TOT-SKUS-IN                                  04480000
017000                  WS-TOT-SKUS-OUT                                 04490000
017000                  WS-TOT-SKUS-OUT-COUNT.                          04500000
017100                                                                  04510000
017200     MOVE INPUT-HEADER-REC TO PO002-EDI855-HEADER-RECORD.         04520000
017500                                                                  04530000
017600     SET CURRENT-PO TO TRUE.                                      04540000
017700                                                                  04550000
017800     PERFORM 2100-PROCESS-CURRENT-PO-I THRU 2100-EXIT             04560000
017900             UNTIL NO-MORE-INPUT OR                               04570000
018000                   NEW-PO.                                        04580000
           IF WS-TOT-SKUS-OUT-COUNT > 999                               04590000
              SET WRITE-HEADER-NO TO TRUE                               04600000
              SET WS-ERROR-REC-YES TO TRUE                              04610000
              MOVE WS-PO-NBR-D TO DL-PO-NBR                             04620000
              MOVE WS-CURR-ISA-CNTL-NBR TO DL-ISA-CNTL-NBR              04630000
              IF WS-TOT-SKUS-OUT-COUNT >= 1500                          04640000
                 MOVE '>1500' TO DL-SKU-COUNT                           04650000
              ELSE                                                      04660000
                 MOVE WS-TOT-SKUS-OUT-COUNT TO DL-SKU-COUNT             04670000
              END-IF                                                    04680000
              EVALUATE WS-CURR-INTERCHANGE                              04690000
                 WHEN '086119230000'                                    04700000
                      MOVE 'HALLMARK MARKETING CORP' TO                 04710000
                                               DL-VENDOR-NAME           04720000
                 WHEN '124154571577'                                    04730000
                      MOVE 'MULBERRY NECKWEAR' TO                       04740000
                                               DL-VENDOR-NAME           04750000
                 WHEN 'ZZHDLEKOHL'                                      04760000
                      MOVE 'HANDLEMAN COMPANY' TO                       04770000
                                               DL-VENDOR-NAME           04780000
                 WHEN '01067429365'                                     04790000
                      MOVE 'HANES HOSIERY'    TO DL-VENDOR-NAME         04800000
                                                                        04810000
                 WHEN '086111970038'                                    04820000
                      MOVE 'INTERCRAFT COMPANY      ' TO                04830000
                                               DL-VENDOR-NAME           04840000
                 WHEN '010419368400'                                    04850000
                      MOVE 'JOCKEY INTERNATIONAL INC' TO                04860000
                                               DL-VENDOR-NAME           04870000
                 WHEN '086111151100'                                    04880000
                      MOVE 'SARA LEE INTIMATES      ' TO                04890000
                                               DL-VENDOR-NAME           04900000
                 WHEN '01076735463'                                     04910000
                      MOVE 'CARLTON CARDS           '      TO           04920000
                                               DL-VENDOR-NAME           04930000
                 WHEN '01002344208'                                     04940000
                      MOVE 'VANITY FAIR             ' TO                04950000
                                               DL-VENDOR-NAME           04960000
                 WHEN '01031360197'                                     04970000
                      MOVE 'LILY OF FRANCE          ' TO                04980000
                                               DL-VENDOR-NAME           04990000
                 WHEN '01143367634'                                     05000000
                      MOVE 'ESTEE LAUDER            ' TO                05010000
                                               DL-VENDOR-NAME           05020000
                 WHEN '086116630000'                                    05030000
                 WHEN '086116630050'                                    05040000
                      MOVE 'LIZ CLAIBORNE           ' TO                05050000
                                               DL-VENDOR-NAME           05060000
                 WHEN '01007131501'                                     05070000
                      MOVE 'LEE WRANGLER            ' TO                05080000
                                               DL-VENDOR-NAME           05090000
                 WHEN '012270726'                                       05100000
                      MOVE 'FISHMAN & TOBIN INC     ' TO                05110000
                                               DL-VENDOR-NAME           05120000
CHGID *          WHEN '122035798435'                                    05130000
CHGID *          WHEN '128187827568'                                    05140000
CHGID            WHEN '084229981500'                                    05150000
                      MOVE 'OLGA/WARNER             ' TO                05160000
                                               DL-VENDOR-NAME           05170000
                 WHEN '1213026746000'                                   05180000
                      MOVE 'PLAYTEX                 ' TO                05190000
                                               DL-VENDOR-NAME           05200000
                 WHEN '086111151100'                                    05210000
                      MOVE 'BALI                    ' TO                05220000
                                               DL-VENDOR-NAME           05230000
                 WHEN '129105196395'                                    05240000
                      MOVE 'WONDERBRA               ' TO                05250000
                                               DL-VENDOR-NAME           05260000
                 WHEN '124053609856'                                    05270000
                      MOVE 'TOP OF THE WORLD        ' TO                05280000
                                               DL-VENDOR-NAME           05290000
                 WHEN '086126930000'                                    05300000
                      MOVE 'VF IMAGEWEAR            ' TO                05310000
                                               DL-VENDOR-NAME           05320000
                 WHEN '128649689682'                                    05330000
                      MOVE 'KNIGHTS APPAREL         ' TO                05340000
                                               DL-VENDOR-NAME           05350000
                 WHEN '122605632187'                                    05360000
                      MOVE 'NEXT INC                ' TO                05370000
                                               DL-VENDOR-NAME           05380000
                 WHEN '086174371385'                                    05390000
352053                MOVE '47BRAND LLC             ' TO                05400000
                                               DL-VENDOR-NAME           05410000
                 WHEN 'ZZPERRYGEGP'                                     05420000
                      MOVE 'SUPREME INTL            ' TO                05430000
                                               DL-VENDOR-NAME           05440000
                 WHEN '010004637980'                                    05450000
                      MOVE 'COLLEGE CONCEPTS        ' TO                05460000
                                               DL-VENDOR-NAME           05470000
                 WHEN '061117700002'                                    05480000
                      MOVE 'RUSSELL ATHLETIC        ' TO                05490000
                                               DL-VENDOR-NAME           05500000
                 WHEN '01001334036'                                     05510000
                      MOVE 'OUTERSTUFF              ' TO                05520000
                                               DL-VENDOR-NAME           05530000
                 WHEN '14037794872C'                                    05540000
                      MOVE 'HADDAD                  ' TO                05550000
                                               DL-VENDOR-NAME           05560000
                 WHEN '123365192222'                                    05570000
                      MOVE 'HANES UNDERWEAR         ' TO                05580000
                                               DL-VENDOR-NAME           05590000
                 WHEN '126129445069'                                    05600000
                      MOVE 'COKEM                   ' TO                05610000
                                               DL-VENDOR-NAME           05620000
                 WHEN '129136933200'                                    05630000
575459           WHEN '129139423258'                                    05640000
                      MOVE 'GEAR FOR SPORTS         ' TO                05650000
                                               DL-VENDOR-NAME           05660000
                 WHEN '129136933996'                                    05670000
                      MOVE 'CHAMPION CUSTOM         ' TO                05680000
                                               DL-VENDOR-NAME           05690000
714055           WHEN '01833753478'                                     05700000
714055           WHEN '01833753478N'                                    05710000
                      MOVE 'COLOSSEUM ATHLETICS     ' TO                05720000
                                               DL-VENDOR-NAME           05730000
                 WHEN '01053736070'                                     05740000
                      MOVE 'SPORTS LICENSED         ' TO                05750000
                                               DL-VENDOR-NAME           05760000
                 WHEN '127048211005'                                    05770000
                      MOVE 'RENAISSANCE IMPORTS     ' TO                05780000
                                               DL-VENDOR-NAME           05790000
                 WHEN '086111190003'                                    05800000
                      MOVE 'LEVI                    ' TO                05810000
                                               DL-VENDOR-NAME           05820000
WR0933           WHEN '123045622401'                                    05830000
WR0933                MOVE 'T-SHIRT INTERNATIONAL   ' TO                05840000
WR0933                                         DL-VENDOR-NAME           05850000
W41905           WHEN '127183494307'                                    05860000
W41905                MOVE 'JACMEL JEWELRY          ' TO                05870000
W41905                                         DL-VENDOR-NAME           05880000
W41952           WHEN '122124030661'                                    05890000
W41952                MOVE 'G-III LEATHER FASHIONS  ' TO                05900000
W41952                                         DL-VENDOR-NAME           05910000
W42092           WHEN 'ZZSUPERBAINC'                                    05920000
W42092                MOVE 'PVH SUPERBA             ' TO                05930000
W42092                                         DL-VENDOR-NAME           05940000
534202*          WHEN '125175212525'                                    05950000
756744           WHEN '125176557948'                                    05960000
534202                MOVE 'J AMERICA               ' TO                05970000
534202                                         DL-VENDOR-NAME           05980000
453643           WHEN '086594140000'                                    05990000
453643                MOVE 'ETERNAL FORTUNE FASHIONS LLC' TO            06000000
453643                                         DL-VENDOR-NAME           06010000
494672           WHEN '086111270000'                                    06020000
494672                MOVE 'HAGGAR CLOTHING COMPANY ' TO                06030000
494672                                         DL-VENDOR-NAME           06040000
686121           WHEN '01008029498'                                     06050000
686121                MOVE 'WILLIAMSON-DICKIE MFG CO' TO                06060000
686121                                         DL-VENDOR-NAME           06070000
371617           WHEN '01056612773'                                     06080000
371617                MOVE 'NEW ERA CAP'              TO                06090000
371617                                         DL-VENDOR-NAME           06100000
505256           WHEN '122014369009'                                    06110000
505256                MOVE 'MAIDENFORM INC'           TO                06120000
505256                                         DL-VENDOR-NAME           06130000
683003           WHEN '01089087787'                                     06140000
683003                MOVE 'RANDA ACCESSORIES'        TO                06150000
683003                                         DL-VENDOR-NAME           06160000
683026           WHEN '086117470000'                                    06170000
683026                MOVE 'RANDA CORP'               TO                06180000
683026                                         DL-VENDOR-NAME           06190000
944205           WHEN '14006436299AS'                                   06200000
944205                MOVE 'BOELTER COMPANIES'        TO                06210000
944205                                         DL-VENDOR-NAME           06220000
002139           WHEN '125303438725'                                    06230000
002139                MOVE 'GONZALES ENT INC DBA FIFTH SUN'   TO        06240000
002139                                         DL-VENDOR-NAME           06250000
647062           WHEN '01012697983'                                     06260000
647062                MOVE 'LUXOTTICA USA LLC'                TO        06270000
647062                                         DL-VENDOR-NAME           06280000
042023           WHEN '129139423259'                                    06290000
042023                MOVE 'CC PRODUCTS'                      TO        06300000
042023                                         DL-VENDOR-NAME           06310000
018127           WHEN '129419662114'                                    06320000
018127                MOVE 'TERVIS TUMBLER'                   TO        06330000
018127                                         DL-VENDOR-NAME           06340000
356324           WHEN '122122217500'                                    06350000
356324                MOVE 'PERRY ELLIS MENSWEAR'             TO        06360000
356324                                         DL-VENDOR-NAME           06370000
637834           WHEN 'ZZ30378999YK'                                    06380000
637834                MOVE 'OURAY SPORTSWEAR'                 TO        06390000
637834                                         DL-VENDOR-NAME           06400000
185577           WHEN '01034698614'                                     06410000
185577                MOVE 'BESPOKE FASHION LLC'              TO        06420000
185577                                         DL-VENDOR-NAME           06430000
790723           WHEN 'ZZ062312087S2'                                   06440000
790723                MOVE 'FGX INTERNATIONAL INC'            TO        06450000
790723                                         DL-VENDOR-NAME           06460000
956632           WHEN '129738121700'                                    06470000
956632                MOVE 'RANDA LUGGAGE'                    TO        06480000
956632                                         DL-VENDOR-NAME           06490000
956632           WHEN '126152619218'                                    06500000
956632                MOVE 'LOGO BRANDS INC'                  TO        06510000
956632                                         DL-VENDOR-NAME           06520000
956632           WHEN '128306204400'                                    06530000
956632                MOVE 'GREAT AMERICAN PRODUCTS'          TO        06540000
956632                                         DL-VENDOR-NAME           06550000
346771           WHEN '128585585273'                                    06560000
346771                MOVE ' MAD ENGINE LLC'                  TO        06570000
346771                                         DL-VENDOR-NAME           06580000
265129           WHEN '123109949975N'                                   06590000
265129                MOVE 'HYBRID PROMOTIONS LLC'            TO        06600000
265129                                         DL-VENDOR-NAME           06610000
887802           WHEN '14087607334'                                     06620000
887802                MOVE 'BIOWORLD MERCHANDISING'           TO        06630000
887802                                         DL-VENDOR-NAME           06640000
927044           WHEN '125164846996'                                    06650000
927044                MOVE 'NORTHWEST CO/ASHLAND MILL'       TO         06660000
927044                                         DL-VENDOR-NAME           06670000
925845           WHEN '127653497474'                                    06680000
925845                MOVE 'FOR BARE FEET'                    TO        06690000
925845                                         DL-VENDOR-NAME           06700000
762449           WHEN 'ZZ52074119YK'                                    06710000
762449                MOVE 'MASTERPIECES PUZZLE COMPANY'      TO        06720000
762449                                         DL-VENDOR-NAME           06730000
889751           WHEN '01805838083'                                     06740000
889751                MOVE 'RIPPLE JUNCTION DESIGN CO INC'    TO        06750000
889751                                         DL-VENDOR-NAME           06760000
064017           WHEN '086118910100'                                    06770000
064017                MOVE 'S LICHTENBERG & CO INC'           TO        06780000
064017                                         DL-VENDOR-NAME           06790000
176716           WHEN '122137472376'                                    06800000
176716                MOVE 'SPIRIT LEATHERWORKS LLC'          TO        06810000
176716                                         DL-VENDOR-NAME           06820000
176682           WHEN '123056226763'                                    06830000
176682                MOVE 'TEE SHIRT CENTRAL INC'            TO        06840000
176682                                         DL-VENDOR-NAME           06850000
680553           WHEN '086116110015'                                    06860000
680553                MOVE 'LF MENS GROUP LLC'                TO        06870000
680553                                         DL-VENDOR-NAME           06880000
                 WHEN OTHER                                             06890000
                      MOVE '??????????????????' TO                      06900000
                                               DL-VENDOR-NAME           06910000
              END-EVALUATE                                              06920000
                                                                        06930000
021200        MOVE INPUT-H-PO-NBR       TO WS-PO-NBR-D                  06940000
              MOVE INPUT-H-INTERCHANGE  TO WS-CURR-INTERCHANGE          06950000
              MOVE INPUT-H-ISA-CNTL-NBR TO WS-CURR-ISA-CNTL-NBR         06960000
                                                                        06970000
              PERFORM 7000-PROCESS-REPORT-FILES                         06980000
           ELSE                                                         06990000
                                                                        07000000
018200        SET MORE-OUTPUT TO TRUE                                   07010000
018400        PERFORM 2200-PROCESS-CURRENT-PO-O THRU 2200-EXIT          07020000
018500                VARYING INDEX1 FROM 1 BY 1                        07030000
018600                  UNTIL NO-MORE-OUTPUT                            07040000
018700                                                                  07050000
018800        DISPLAY ' '                                               07060000
018900        MOVE SPACES TO WS-DISPLAY-LINE                            07070000
019000        STRING WS-DISPLAY-PO-NBR-LIT                              07080000
019100               WS-PO-NBR-D                                        07090000
019200               DELIMITED BY SIZE                                  07100000
019300               INTO WS-DISPLAY-LINE                               07110000
019400        DISPLAY WS-DISPLAY-LINE                                   07120000
019500                                                                  07130000
019600        MOVE WS-TOT-SKUS-IN TO WS-TOT-SKUS-IN-D                   07140000
019700        MOVE SPACES TO WS-DISPLAY-LINE                            07150000
019800        STRING WS-DISPLAY-SKUS-IN-LIT                             07160000
019900               WS-TOT-SKUS-IN-D                                   07170000
020000               DELIMITED BY SIZE                                  07180000
020100               INTO WS-DISPLAY-LINE                               07190000
020200        DISPLAY WS-DISPLAY-LINE                                   07200000
020300                                                                  07210000
020400        MOVE WS-TOT-SKUS-OUT TO WS-TOT-SKUS-OUT-D                 07220000
020500        MOVE SPACES TO WS-DISPLAY-LINE                            07230000
020600        STRING WS-DISPLAY-SKUS-OUT-LIT                            07240000
020700               WS-TOT-SKUS-OUT-D                                  07250000
020800               DELIMITED BY SIZE                                  07260000
020900               INTO WS-DISPLAY-LINE                               07270000
021000        DISPLAY WS-DISPLAY-LINE                                   07280000
021100                                                                  07290000
021200        MOVE INPUT-H-PO-NBR TO WS-PO-NBR-D                        07300000
              MOVE INPUT-H-INTERCHANGE  TO WS-CURR-INTERCHANGE          07310000
              MOVE INPUT-H-ISA-CNTL-NBR TO WS-CURR-ISA-CNTL-NBR         07320000
021300     END-IF.                                                      07330000
021400 2100-PROCESS-CURRENT-PO-I.                                       07340000
021500                                                                  07350000
021600     PERFORM 8000-READ-INPUT-FILE.                                07360000
021700                                                                  07370000
021800     IF NO-MORE-INPUT                                             07380000
021900         GO TO 2100-EXIT.                                         07390000
022000                                                                  07400000
022100     IF INPUT-HEADER-RECORD                                       07410000
022200         SET NEW-PO TO TRUE                                       07420000
               SET WRITE-HEADER-YES TO TRUE                             07430000
022300         GO TO 2100-EXIT                                          07440000
022400     END-IF.                                                      07450000
022500                                                                  07460000
022600     IF INPUT-ALLOC-RECORD                                        07470000
022700         PERFORM 2110-PROCESS-ALLOC-RECORD                        07480000
022800     ELSE                                                         07490000
022900         IF INPUT-ITEM-RECORD                                     07500000
023000             PERFORM 2120-PROCESS-ITEM-RECORD                     07510000
023100         END-IF                                                   07520000
023200     END-IF.                                                      07530000
023300                                                                  07540000
023400 2100-EXIT.                                                       07550000
023500     EXIT.                                                        07560000
023600                                                                  07570000
023700 2110-PROCESS-ALLOC-RECORD.                                       07580000
023800                                                                  07590000
023900     SET INDEX1 TO +1.                                            07600000
024000                                                                  07610000
026600     SEARCH WS-SKU-TBL-ENTRY                                      07620000
026700            VARYING INDEX1                                        07630000
026800            WHEN WS-INPUT-SKU = WS-SKU-TBL-SKU (INDEX1)           07640000
026900                 SET INDEX2 TO +1                                 07650000
027000                 SET WS-STORE-NOT-FOUND  TO TRUE                  07660000
027100                 PERFORM 2112-PROCESS-ALLOCS                      07670000
027200                     VARYING SUB1 FROM 1 BY 1                     07680000
027300                       UNTIL INPUT-A-STORE-NBR (SUB1) = SPACES OR 07690000
027500                             SUB1 > WS-ALLOC-MAX                  07700000
027600     END-SEARCH.                                                  07710000
027800                                                                  07720000
027900 2112-PROCESS-ALLOCS.                                             07730000
028000                                                                  07740000
028100     SET WS-STORE-NOT-FOUND  TO TRUE.                             07750000
028200                                                                  07760000
028300     PERFORM UNTIL WS-STORE-FOUND                                 07770000
028400     IF INPUT-A-STORE-NBR (SUB1) =                                07780000
028500                                WS-SKU-TBL-STR-NBR (INDEX1 INDEX2)07790000
028600         ADD INPUT-A-ORDER-QTY (SUB1) TO                          07800000
028700                                WS-SKU-TBL-ORD-QTY (INDEX1 INDEX2)07810000
028800         SET INDEX2 TO +1                                         07820000
028900         SET WS-STORE-FOUND TO TRUE                               07830000
029000     ELSE                                                         07840000
029100     IF WS-SKU-TBL-STR-NBR (INDEX1 INDEX2) = SPACES               07850000
029200         MOVE INPUT-A-STORE-NBR (SUB1) TO                         07860000
029300                                WS-SKU-TBL-STR-NBR (INDEX1 INDEX2)07870000
029400         MOVE INPUT-A-ORDER-QTY (SUB1) TO                         07880000
029500                                WS-SKU-TBL-ORD-QTY (INDEX1 INDEX2)07890000
029600         SET INDEX2 TO +1                                         07900000
029700         SET WS-STORE-FOUND TO TRUE                               07910000
029800     ELSE                                                         07920000
029900         SET INDEX2 UP BY +1                                      07930000
030000     END-IF                                                       07940000
030100     END-IF                                                       07950000
030200     END-PERFORM.                                                 07960000
030300 2120-PROCESS-ITEM-RECORD.                                        07970000
030400                                                                  07980000
030500     MOVE INPUT-I-SKU TO WS-INPUT-SKU.                            07990000
030600                                                                  08000000
030700     SET INDEX1 TO +1.                                            08010000
030800                                                                  08020000
030900     SEARCH WS-SKU-TBL-ENTRY                                      08030000
031000            VARYING INDEX1                                        08040000
032700            WHEN WS-SKU-TBL-SKU (INDEX1) = SPACES                 08050000
036100                  ADD 1 TO WS-TOT-SKUS-OUT-COUNT                  08060000
032800                  MOVE INPUT-I-PO-NBR TO                          08070000
032900                                       WS-SKU-TBL-PO-NBR (INDEX1) 08080000
033000                  MOVE INPUT-I-UPC  TO WS-SKU-TBL-UPC (INDEX1)    08090000
033100                  MOVE INPUT-I-SKU  TO WS-SKU-TBL-SKU (INDEX1)    08100000
033200                  MOVE ZEROES     TO WS-SKU-TBL-SKU-CNT (INDEX1)  08110000
033300                  MOVE INPUT-I-TOTAL-QTY TO                       08120000
033400                                       WS-SKU-TBL-TOT-QTY (INDEX1)08130000
033500                  MOVE INPUT-I-UNIT-COST TO                       08140000
033600                                       WS-SKU-TBL-UNT-CST (INDEX1)08150000
033700            WHEN INPUT-I-SKU = WS-SKU-TBL-SKU (INDEX1)            08160000
033800                  ADD INPUT-I-TOTAL-QTY TO                        08170000
033900                                       WS-SKU-TBL-TOT-QTY (INDEX1)08180000
034000                  ADD INPUT-I-UNIT-COST TO                        08190000
034100                                       WS-SKU-TBL-UNT-CST (INDEX1)08200000
034200     END-SEARCH.                                                  08210000
034300                                                                  08220000
034400 2200-PROCESS-CURRENT-PO-O.                                       08230000
034500                                                                  08240000
034600     IF WS-SKU-TBL-SKU (INDEX1) = SPACES                          08250000
034700         SET NO-MORE-OUTPUT TO TRUE                               08260000
034800         GO TO 2200-EXIT                                          08270000
034900     END-IF.                                                      08280000
035800     IF WRITE-HEADER-YES OR NO-MORE-INPUT-REC                     08290000
017400        WRITE OUTPUT-RECORD FROM PO002-EDI855-HEADER-RECORD       08300000
              SET WRITE-HEADER-NO TO TRUE                               08310000
              SET MORE-INPUT-REC TO TRUE                                08320000
           END-IF.                                                      08330000
035100     MOVE SPACES TO PO002-EDI855-ITEM-RECORD.                     08340000
035200     MOVE WS-SKU-TBL-PO-NBR  (INDEX1) TO PO002-I-PO-NBR.          08350000
035300     MOVE WS-SKU-TBL-UPC     (INDEX1) TO PO002-I-UPC.             08360000
035400     MOVE WS-SKU-TBL-SKU     (INDEX1) TO PO002-I-SKU.             08370000
035500     MOVE WS-SKU-TBL-TOT-QTY (INDEX1) TO PO002-I-TOTAL-QTY.       08380000
035600     MOVE WS-SKU-TBL-UNT-CST (INDEX1) TO PO002-I-UNIT-PRICE.      08390000
035700     SET PO002-ITEM-RECORD TO TRUE.                               08400000
035900     WRITE OUTPUT-RECORD FROM PO002-EDI855-ITEM-RECORD.           08410000
036000                                                                  08420000
036100     ADD 1 TO WS-TOT-SKUS-OUT.                                    08430000
036200                                                                  08440000
036300     MOVE +1 TO SUB1.                                             08450000
036400     SET MORE-ALLOCS TO TRUE.                                     08460000
036500     INITIALIZE PO002-EDI855-ALLOC-RECORD.                        08470000
036600                                                                  08480000
036700     PERFORM 2210-PROCESS-ALLOCS THRU 2210-EXIT                   08490000
036800             VARYING INDEX2 FROM 1 BY 1                           08500000
036900               UNTIL NO-MORE-ALLOCS.                              08510000
037000                                                                  08520000
037100 2200-EXIT.                                                       08530000
037200     EXIT.                                                        08540000
037300                                                                  08550000
037400 2210-PROCESS-ALLOCS.                                             08560000
037500                                                                  08570000
037600     IF WS-SKU-TBL-STR-NBR (INDEX1 INDEX2) = SPACES               08580000
037700         WRITE OUTPUT-RECORD FROM PO002-EDI855-ALLOC-RECORD       08590000
037800         SET NO-MORE-ALLOCS TO TRUE                               08600000
037900         GO TO 2210-EXIT                                          08610000
038000     END-IF.                                                      08620000
038100                                                                  08630000
038200     IF SUB1 > WS-ALLOC-MAX                                       08640000
038300         WRITE OUTPUT-RECORD FROM PO002-EDI855-ALLOC-RECORD       08650000
038400         INITIALIZE PO002-EDI855-ALLOC-RECORD                     08660000
038500         MOVE +1 TO SUB1                                          08670000
038600     END-IF.                                                      08680000
038700                                                                  08690000
038800     SET PO002-ALLOC-RECORD TO TRUE.                              08700000
038900     MOVE WS-SKU-TBL-PO-NBR (INDEX1) TO PO002-A-PO-NBR.           08710000
039000     MOVE WS-SKU-TBL-UPC    (INDEX1) TO PO002-A-UPC.              08720000
      *    MOVE PO002-EDI855-ALLOC-RECORD  TO PO002-EDI855-ALLOC-RECORD.08730000
039100     MOVE WS-SKU-TBL-STR-NBR (INDEX1 INDEX2) TO                   08740000
039200                                        PO002-A-STORE-NBR (SUB1). 08750000
039300     MOVE WS-SKU-TBL-ORD-QTY (INDEX1 INDEX2) TO                   08760000
039400                                        PO002-A-ALLOC-QTY (SUB1). 08770000
039500     ADD +1 TO SUB1.                                              08780000
039600                                                                  08790000
039700 2210-EXIT.                                                       08800000
039800     EXIT.                                                        08810000
039900                                                                  08820000
040000 3000-CLOSE-FILES.                                                08830000
040100                                                                  08840000
040200     CLOSE INPUT-FILE                                             08850000
040300           OUTPUT-FILE.                                           08860000
040400                                                                  08870000
       4000-SEND-EMAIL-MSG.                                             08880000
           IF WS-ERROR-REC-YES                                          08890000
              INITIALIZE DP023-DYNALC-PARMS                             08900000
              MOVE 'OUT02' TO DP023-DDNAME                              08910000
              SET DP023-DSNAME-SYSOUT TO TRUE                           08920000
              SET DP023-FREE-CLOSE-YES TO TRUE                          08930000
              SET DP023-RECFM-FIXED-BLOCK TO TRUE                       08940000
              MOVE 80     TO DP023-RECSZ                                08950000
              MOVE 7      TO DP023-RECOUNT                              08960000
              MOVE 'B'    TO DP023-PRINT-CLASS                          08970000
              MOVE 'SMTP' TO DP023-PRINT-WRITER                         08980000
              PERFORM DP023-0000-DYNALC                                 08990000
                                                                        09000000
              OPEN OUTPUT EMAIL-MSG-FILE                                09010000
              WRITE EMAIL-MSG-FILE-RECORD FROM EM-DATA-LINE-1           09020000
              WRITE EMAIL-MSG-FILE-RECORD FROM EM-DATA-LINE-2           09030000
              WRITE EMAIL-MSG-FILE-RECORD FROM EM-DATA-LINE-3           09040000
              WRITE EMAIL-MSG-FILE-RECORD FROM EM-DATA-LINE-4           09050000
              WRITE EMAIL-MSG-FILE-RECORD FROM EM-DATA-LINE-5           09060000
              WRITE EMAIL-MSG-FILE-RECORD FROM EM-DATA-LINE-6           09070000
              WRITE EMAIL-MSG-FILE-RECORD FROM EM-DATA-LINE-7           09080000
              CLOSE EMAIL-MSG-FILE                                      09090000
           END-IF.                                                      09100000
                                                                        09110000
                                                                        09120000
                                                                        09130000
040000 7000-PROCESS-REPORT-FILES.                                       09140000
040400                                                                  09150000
199800      IF PV-LINES-PER-PAGE + 5 > PC-LINES-MAX                     09160000
199900             PERFORM 7300-WRITE-HEADINGS                          09170000
201000     MOVE +2                 TO PV-LINE-SKIP                      09180000
201200                                                                  09190000
201300     IF PV-LINES-PER-PAGE > PC-LINES-MAX                          09200000
201400         PERFORM 7300-WRITE-HEADINGS                              09210000
201500     END-IF.                                                      09220000
201600                                                                  09230000
201700     MOVE DL-DETAIL              TO REPORT-REC.                   09240000
201800                                                                  09250000
201900     PERFORM 7400-WRITE-ERROR-REPORT.                             09260000
202000     INITIALIZE DL-DETAIL.                                        09270000
202100     MOVE +1                     TO PV-LINE-SKIP.                 09280000
202200                                                                  09290000
253100 7300-WRITE-HEADINGS.                                             09300000
253500                                                                  09310000
253600     ADD +1                      TO PV-PAGE-COUNT.                09320000
253700     MOVE PV-PAGE-COUNT          TO DP150O-PAGE-NUMBER            09330000
253800                                                                  09340000
253900* HEADING LINE 1 (STANDARD)                                       09350000
254000     WRITE REPORT-REC FROM DP150O-STANDRD-HEADER-150-COLS         09360000
254100       AFTER ADVANCING PAGE.                                      09370000
254200     WRITE REPORT-REC FROM HL-HEADER2                             09380000
254300       AFTER ADVANCING +1 LINES.                                  09390000
254400                                                                  09400000
254500     WRITE REPORT-REC FROM HL-HEADER3                             09410000
254600       AFTER ADVANCING +3 LINES.                                  09420000
254900                                                                  09430000
255000     MOVE +6                     TO PV-LINES-PER-PAGE.            09440000
255100     MOVE +2                     TO PV-LINE-SKIP.                 09450000
255200                                                                  09460000
252000 7400-WRITE-ERROR-REPORT.                                         09470000
252400                                                                  09480000
252500     WRITE REPORT-REC                                             09490000
252600       AFTER ADVANCING PV-LINE-SKIP LINES.                        09500000
252700                                                                  09510000
252800     ADD PV-LINE-SKIP            TO PV-LINES-PER-PAGE.            09520000
252900                                                                  09530000
253000                                                                  09540000
040500 8000-READ-INPUT-FILE.                                            09550000
040600                                                                  09560000
040700     READ INPUT-FILE INTO INPUT-REC                               09570000
040800          AT END  SET NO-MORE-INPUT TO TRUE.                      09580000
                        SET NO-MORE-INPUT-REC TO TRUE.                  09590000
040900                                                                  09600000
041000     IF MORE-INPUT AND                                            09610000
041100        INPUT-ITEM-RECORD                                         09620000
041200         ADD 1 TO WS-TOT-SKUS-IN                                  09630000
041300     END-IF.                                                      09640000
041400                                                                  09650000
041500 9000-WRITE-OUTPUT-FILE.                                          09660000
041600                                                                  09670000
041700     WRITE OUTPUT-RECORD FROM PO002-EDI855-RECORD.                09680000
      *----------------------------------------------------------       09690000
      *  DYNAMIC ALLOCATION ROUTINE                                     09700000
      *----------------------------------------------------------       09710000
           COPY DPPD023.                                                09720000
