000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'OUTBOUND CARTON MANIFEST REPORT'.                         00020000
000300 PROGRAM-ID.             SUKCS751.                                00030000
000400 AUTHOR.                 DENNIS STEFFEN.                          00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN.           WINTER, 2003.                            00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900*    ANY CHANGES THAT MAY EFFECT THE LAYOUT OF THIS REPORT SHOULD 00090000
001000*    BE TESTED ON EVERY MODEL OF PRINTER.  THERE MIGHT BE         00100000
001100*    DIFFERENCES IN CARRIAGE CONTROL AND GRAPHICS PRINTING FOR    00110000
001200*    EACH MODEL.  ALSO BE AWARE THAT WHEN USING PROGRAM DRS1INTC  00120000
001300*    TO PRINT THE REPORT, A NON-BLANK CHARACTER IN PRINT POSITION 00130000
001400*    132 WILL CAUSE A DOUBLE-SPACE TO OCCUR REGARDLESS OF THE     00140000
001500*    VALUE OF THE CARRIAGE CONTROL.                               00150000
001600******************************************************************00160009
001700*  CHANGED 06/05/13 BY C. PARMLEY          PR#5148B              *00170010
001800*   DETERMINATION OF RFID NOW BEING DONE DIFFERENTLY USING THE   *00180010
001900*   RIT_RFID_VRFN TABLE. VARIOUS CALLS TO TABLE TAKE PLACE TO    *00190010
001901*   DETERMINE IF UPC IS RFID. CODE CHANGES CAN BE FOUND WITH     *00190110
001902*   CLP 06/05/13 PR#5148B START/END AROUND THEM.                 *00190210
001903*                                         CRQ#: #0055296         *00190310
001904******************************************************************00190410
002100                                                                  00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300 CONFIGURATION SECTION.                                           00230000
002400 DATA DIVISION.                                                   00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600                                                                  00260000
002700 01  DK-DB2-KEYS.                                                 00270000
002800     05  DK-DEPT-NBR                  PIC S9(4)V COMP-3.          00280000
002900     05  DK-SUBCLASS-NBR              PIC S9(4)V COMP-3.          00290000
003000     05  DK-LOC-NBR                   PIC S9(04) COMP.            00300000
003100     05  DK-STYLE                     PIC X(20).                  00310000
003200     05  DK-SHIPT-UNT-ID              PIC S9(18) COMP-3           00320000
003300                                                    VALUE ZERO.   00330000
003400                                                                  00340000
003500                                                                  00350000
003600     COPY DPWS020.                                                00360000
003700         10  INTER-APPL-COMM-AREA PIC X(200).                     00370000
003800*    FLAT COMMAREA FROM SUKCS750                                  00380000
003900*    THIS CONTAINS A TABLE OF SML NBRS TO BE PROCESSED            00390000
004000     COPY SUWS033.                                                00400000
004100                                                                  00410000
004200 01  PC-PROGRAM-CONSTANTS.                                        00420000
004300     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00430000
004400                                              'SUKCS751'.         00440000
004500     05  PC-LOCATION-MODULE              PIC  X(08)  VALUE        00450000
004600                                              'XLKUT071'.         00460000
004700     05  PC-ABEND-MESSAGE                PIC  X(132) VALUE        00470000
004800          '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    00480000
004900                                                                  00490000
005000     05  PC-END-REPORT.                                           00500000
005100         10  FILLER                   PIC X(53) VALUE SPACES.     00510000
005200         10  FILLER                   PIC X(25) VALUE             00520000
005300          '***** END OF REPORT *****'.                            00530000
005400         10  FILLER                   PIC X(54) VALUE SPACES.     00540000
005500                                                                  00550000
005600 01  PS-PROGRAM-SWITCHES.                                         00560000
005700     05  PS-CURSOR-CLOSED-SW             PIC  X(01)  VALUE 'N'.   00570000
005800         88  PS-CURSOR-CLOSED                        VALUE 'Y'.   00580000
005900         88  PS-CURSOR-OPEN                          VALUE 'N'.   00590000
006000     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   00600000
006100         88  PS-ERROR-YES                            VALUE 'Y'.   00610000
006200         88  PS-ERROR-NO                             VALUE 'N'.   00620000
006300     05  PS-EOF-QUEUE-SW                 PIC  X(01)  VALUE 'N'.   00630000
006400         88  PS-EOF-QUEUE                            VALUE 'Y'.   00640000
006500     05  PS-END-OF-CSR-SW                PIC  X(01)  VALUE 'N'.   00650000
006600         88  PS-END-OF-CSR                           VALUE 'Y'.   00660000
006700         88  PS-NOT-END-OF-CSR                       VALUE 'N'.   00670000
006800     05  PS-TOP-OF-PAGE-SET-SW           PIC  X(01)  VALUE 'N'.   00680000
006900         88  PS-TOP-OF-PAGE-SET                      VALUE 'Y'.   00690000
007000         88  PS-TOP-OF-PAGE-NOT-SET                  VALUE 'N'.   00700000
007100     05  PS-SHORTEN-LAST-PAGE-SW         PIC X(01)   VALUE 'N'.   00710000
007200         88  PS-SHORTEN-LAST-PAGE                    VALUE 'Y'.   00720000
007300         88  PS-DONT-SHORTEN-LAST-PAGE               VALUE 'N'.   00730000
007400     05  PS-XL-MOD-ERROR-SW              PIC X(01)   VALUE 'N'.   00740000
007500         88  PS-XL-MOD-ERROR                         VALUE 'Y'.   00750000
007600         88  PS-XL-MOD-ERROR-NO                      VALUE 'N'.   00760000
007700     05  PS-DEPT-SUBCL-RFID-SW           PIC X(01)   VALUE 'N'.   00770000
007800         88  PS-DEPT-SUBCL-RFID-YES                  VALUE 'Y'.   00780000
007900         88  PS-DEPT-SUBCL-RFID-NO                   VALUE 'N'.   00790000
008000     05  PS-DC-RFID-SW                   PIC X(01)   VALUE 'N'.   00800000
008100         88  PS-DC-RFID-YES                          VALUE 'Y'.   00810000
008200         88  PS-DC-RFID-NO                           VALUE 'N'.   00820000
008300     05  PS-STORE-RFID-SW                PIC X(01)   VALUE 'N'.   00830000
008400         88  PS-STORE-RFID-YES                       VALUE 'Y'.   00840000
008500         88  PS-STORE-RFID-NO                        VALUE 'N'.   00850000
008600                                                                  00860000
008700 01  PV-COUNTERS COMP-3.                                          00870000
008800     05  PV-LINE-COUNT                PIC S9(3)     VALUE ZERO.   00880000
008900     05  PV-PAGE-COUNT                PIC S9(5)     VALUE ZERO.   00890000
009000     05  PV-EXTEND-RETAIL             PIC S9(07)V99 VALUE ZERO.   00900000
009100     05  PV-TOT-ITEMS                 PIC S9(07)    VALUE ZERO.   00910000
009200     05  PV-TOT-UNITS                 PIC S9(11)    VALUE ZERO.   00920000
009300     05  PV-TOT-UNIT-RETAIL           PIC S9(07)V99 VALUE ZERO.   00930000
009400     05  PV-TOT-EXTEND-RETAIL         PIC S9(07)V99 VALUE ZERO.   00940000
009500     05  PV-TOT-RF-ITEMS              PIC S9(07)    VALUE ZERO.   00950000
009600     05  PV-TOT-RF-UNITS              PIC S9(11)    VALUE ZERO.   00960000
009700     05  PV-TOT-RF-UNIT-RETAIL        PIC S9(07)V99 VALUE ZERO.   00970000
009800     05  PV-TOT-RF-EXTEND-RETAIL      PIC S9(07)V99 VALUE ZERO.   00980000
009900                                                                  00990000
010000 01  PV-DISPLAY-FIELDS.                                           01000000
010100     05  PV-SQLCODE-1                 PIC -999      VALUE ZERO.   01010000
010200     05  PV-SQLCODE-2                 PIC -999      VALUE ZERO.   01020000
010300     05  PV-SQLCODE-3                 PIC -999      VALUE ZERO.   01030000
010400     05  PV-SQLCODE-4                 PIC -999      VALUE ZERO.   01040000
010500     05  PV-SQLCODE-5                 PIC -999      VALUE ZERO.   01050000
010600                                                                  01060000
010700 01  PV-CURRENT-KEY.                                              01070000
010800     05  PV-CURR-SML                  PIC 9(20) VALUE ZERO.       01080000
010900     05  PV-CURR-PO                   PIC 9(09) VALUE ZERO.       01090000
011000     05  PV-CURR-RCVR                 PIC 9(09) VALUE ZERO.       01100000
011100 01  PV-PREVIOUS-KEY.                                             01110000
011200     05  PV-PREV-SML                  PIC 9(20) VALUE ZERO.       01120000
011300     05  PV-PREV-PO                   PIC 9(09) VALUE ZERO.       01130000
011400     05  PV-PREV-RCVR                 PIC 9(09) VALUE ZERO.       01140000
011500                                                                  01150000
011600 01  PV-PROGRAM-VARIABLES.                                        01160000
011700     05  PV-STORE-IND                 PIC X     VALUE SPACES.     01170000
011800     05  PV-DEPT-SUBCL-IND            PIC X(01) VALUE SPACES.     01180000
011900     05  PV-EXCEPTIONS-IND            PIC X(01) VALUE SPACES.     01190000
012000     05  PV-SKIP-STYLE-IND            PIC X(01) VALUE SPACES.     01200000
012100     05  PV-DISP-PO                   PIC 9(08) VALUE ZERO.       01210000
012200     05  PV-DISP-RECV                 PIC 9(04) VALUE ZERO.       01220000
012300     05  PV-RCVR-SEQ                  PIC 9(09) VALUE ZERO        01230000
012301                                                 COMP.            01230119
012310     05  PV-DISP-UPC                  PIC 9(15) VALUE ZERO.       01231019
012320     05  PV-DISP-STR                  PIC 9(05) VALUE ZERO.       01232020
012500     05  PV-COMMAREA-LENGTH           PIC S9(04) VALUE ZERO       01250000
012600                                                 COMP SYNC.       01260000
012700     05  PV-RUN-DATE                     PIC X(10) VALUE SPACES.  01270000
012800     05  PV-RUN-TIME                     PIC X(08) VALUE SPACES.  01280000
012900     05  PV-CREATE-DATE                  PIC X(10) VALUE SPACES.  01290000
013000     05  PV-CREATE-TIME                  PIC X(08) VALUE SPACES.  01300000
013010     05  PV-STR-SCAN-DATE                PIC X(10) VALUE SPACES.  01301012
013020     05  PV-STR-SCAN-TIME                PIC X(08) VALUE SPACES.  01302012
013100     05  PV-CREATE-SOURCE                PIC X(20) VALUE SPACES.  01310000
013200     05  PV-LETTER                       PIC X(01) VALUE SPACES.  01320000
013300                                                                  01330000
013400     05  PV-NUM-ITEMS                    PIC S9(4)   VALUE ZERO   01340000
013500                                                     COMP SYNC.   01350000
013600     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01360000
013700                                                     COMP SYNC.   01370000
013800     05  PV-ITEM-NBR                     PIC S9(04) COMP.         01380000
013900     05  PV-STR-REC-QTY                  PIC S9(9) COMP.          01390000
014000     05  PV-STRS-ON-LAST-PAGE            PIC S9(9) COMP.          01400000
014100     05  PV-SUB-1                        PIC S9(4)   VALUE ZERO   01410000
014200                                                     COMP SYNC.   01420000
014300     05  PV-SUM-VERIFIED-QTY             PIC S9(09)  VALUE ZERO   01430000
014400                                                     COMP SYNC.   01440000
014500     05  PV-CICS-RESP                    PIC S9(8) VALUE ZERO     01450000
014600                                                COMP SYNC.        01460000
014700     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        01470000
014800                                                COMP SYNC.        01480000
014810     05  PV-STORE-SCAN-COUNT          PIC S9(09)  VALUE ZERO      01481017
014820                                                  COMP.           01482017
014900     05  PV-CURRENT-DATE-X.                                       01490000
015000         10  PV-CURRENT-CENTURY-YEAR     PIC  9(04)  VALUE ZEROS. 01500000
015100         10  FILLER                      PIC  X(01)  VALUE '-'.   01510000
015200         10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 01520000
015300         10  FILLER                      PIC  X(01)  VALUE '-'.   01530000
015400         10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 01540000
015500     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            01550000
015600                                         PIC  X(10).              01560000
015700     05  PV-SQLCODE-NUMBER.                                       01570000
015800         10  FILLER                      PIC X(10)  VALUE         01580000
015900             'SQLCODE = '.                                        01590000
016000         10  PV-SQLCODE                  PIC +999.                01600000
016100     05  PV-DRS-ABEND-DISPLAY-LINE1.                              01610000
016200         10  FILLER                      PIC  X(14)  VALUE        01620000
016300             'DRRB ID = DRRB'.                                    01630000
016400         10  FILLER                      PIC  X(02)  VALUE SPACE. 01640000
016500         10  FILLER                      PIC  X(12)  VALUE        01650000
016600             'DRRB FUNC = '.                                      01660000
016700         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 01670000
016800         10  FILLER                      PIC  X(02)  VALUE SPACE. 01680000
016900         10  FILLER                      PIC  X(11)  VALUE        01690000
017000             'DRRB RID = '.                                       01700000
017100         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 01710000
017200         10  FILLER                      PIC  X(02)  VALUE SPACE. 01720000
017300         10  FILLER                      PIC  X(15)  VALUE        01730000
017400             'DRRB OPTIONS = '.                                   01740000
017500         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 01750000
017600     05  PV-DRS-ABEND-DISPLAY-LINE2.                              01760000
017700         10  FILLER                      PIC  X(10)  VALUE        01770000
017800             'DRRB RC = '.                                        01780000
017900         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 01790000
018000         10  FILLER                      PIC  X(02)  VALUE SPACE. 01800000
018100         10  FILLER                      PIC  X(18)  VALUE        01810000
018200             'DRRB ATTR-ERROR = '.                                01820000
018300         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 01830000
018400         10  FILLER                      PIC  X(02)  VALUE SPACE. 01840000
018500         10  FILLER                      PIC  X(12)  VALUE        01850000
018600             'DRRB DRDC = '.                                      01860000
018700         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 01870000
018800         10  FILLER                      PIC  X(02)  VALUE SPACE. 01880000
018900         10  FILLER                      PIC  X(13)  VALUE        01890000
019000             'DRRB LINES = '.                                     01900000
019100         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 01910000
019200     05  PV-DEPT-NBR-N                   PIC  9(04)  VALUE ZERO.  01920000
019300     05  PV-SUB-CL-NBR-N                 PIC  9(04)  VALUE ZERO.  01930000
019400 01  PV-CICS-MSG-AREA.                                            01940000
019500     05  FILLER                          PIC X(20) VALUE          01950000
019600                 '** SUKCS751 ** TASK='.                          01960000
019700     05  PV-TASK-NUMBER                  PIC Z(08).               01970000
019800     05  FILLER                          PIC X(07) VALUE          01980000
019900                 ' TIME= '.                                       01990000
020000     05  PV-TIME                         PIC X(08).               02000000
020100     05  FILLER                          PIC X(09) VALUE          02010000
020200         ' QUEUE = '.                                             02020000
020300     05  PV-QUEUE-NAME.                                           02030000
020400         10  PV-ADDRESS                  PIC X(4)  VALUE SPACES.  02040000
020500         10  PV-TASK                     PIC 9(5)  VALUE ZERO.    02050000
020600         10  PV-LAST-NUMBER              PIC X(1)  VALUE SPACES.  02060000
020700     05  FILLER                          PIC X(1)  VALUE SPACES.  02070000
020800     05  PV-CICS-MESSAGE                 PIC X(55) VALUE SPACES.  02080000
020900                                                                  02090000
021000     COPY DFHAID.                                                 02100000
021100     COPY DPWS013.                                                02110000
021200     COPY DSWS004.                                                02120000
021300                                                                  02130000
021400*    ITEM COMMAREA FOR PCKUT713                                   02140000
021500     COPY PCWS046.                                                02150000
021600                                                                  02160000
021700*    ITEM COMMAREA FOR XLKUT071                                   02170000
021800     COPY XLWS071.                                                02180000
021900                                                                  02190000
022000*    ITEM COMMAREA FOR XLKUT001                                   02200000
022100     COPY XLWS001.                                                02210000
022200                                                                  02220000
022300     COPY DPWS132.                                                02230000
022400     COPY SUWS093.                                                02240000
022500*                                                                 02250000
022600 01  HL1-HEADING-LINE.                                            02260000
022700     05  FILLER                       PIC X(50) VALUE SPACE.      02270000
022800     05  FILLER                       PIC X(31) VALUE             02280000
022900         'OUTBOUND CARTON MANIFEST REPORT'.                       02290000
023000     05  FILLER                       PIC X(51) VALUE SPACE.      02300000
023100*                                                                 02310000
023200 01  HL2-HEADING-LINE.                                            02320000
023300     05  FILLER                       PIC X(01) VALUE SPACE.      02330000
023400     05  FILLER                       PIC X(15) VALUE             02340000
023500         'SML..........: '.                                       02350000
023600     05  HL2-SML                      PIC 9(20) VALUE ZERO.       02360000
023700     05  FILLER                       PIC X(13) VALUE SPACE.      02370000
023800     05  FILLER                       PIC X(15) VALUE             02380000
023900         'CREATE DATE..: '.                                       02390000
024000     05  HL2-CREATE-DATE              PIC X(10) VALUE SPACE.      02400000
024100     05  FILLER                       PIC X(01) VALUE SPACE.      02410000
024200     05  HL2-CREATE-TIME              PIC X(08) VALUE SPACE.      02420000
024300     05  FILLER                       PIC X(06) VALUE SPACE.      02430000
024400     05  FILLER                       PIC X(23) VALUE             02440000
024500         'OUTBOUND SCAC/TRAILER: '.                               02450000
024600     05  HL2-SCAC                     PIC X(04) VALUE SPACE.      02460000
024700     05  FILLER                       PIC X(01) VALUE '/'.        02470000
024800     05  HL2-TRAILER-ID               PIC X(09) VALUE SPACE.      02480000
024900     05  FILLER                       PIC X(08) VALUE SPACE.      02490000
025000*                                                                 02500000
025100 01  HL3-HEADING-LINE.                                            02510000
025200     05  FILLER                       PIC X(01) VALUE SPACE.      02520000
025300     05  FILLER                       PIC X(15) VALUE             02530000
025400         'DESTINATION..: '.                                       02540000
025500     05  HL3-DEST                     PIC ZZZ9.                   02550000
025600     05  FILLER                       PIC X(01) VALUE '-'.        02560000
025700     05  HL3-DEST-NAME                PIC X(25) VALUE SPACE.      02570000
025800     05  FILLER                       PIC X(03) VALUE SPACES.     02580000
025900     05  FILLER                       PIC X(15) VALUE             02590000
026000         'CREATE SOURCE: '.                                       02600000
026100     05  HL3-SOURCE                   PIC X(25) VALUE SPACE.      02610000
026200     05  FILLER                       PIC X(23) VALUE             02620000
026300         'OUTBOUND TRIP ID.....: '.                               02630000
026400     05  HL3-OUTBOUND-TRIP            PIC 9(09) VALUE ZERO.       02640000
026500     05  FILLER                       PIC X(13) VALUE SPACE.      02650000
026600*                                                                 02660000
026700 01  HL4-HEADING-LINE.                                            02670000
026800     05  FILLER                       PIC X(01) VALUE SPACE.      02680000
026900     05  FILLER                       PIC X(15) VALUE             02690000
027000         'CARTON STATUS: '.                                       02700000
027100     05  HL3-CTN-STATUS               PIC X(20) VALUE SPACES.     02710000
027200     05  FILLER                       PIC X(13) VALUE SPACE.      02720000
027300     05  FILLER                       PIC X(15) VALUE             02730000
027400         'CREATE USERID: '.                                       02740000
027500     05  HL3-USERID                   PIC X(08) VALUE SPACE.      02750000
027600     05  FILLER                       PIC X(17) VALUE SPACE.      02760000
027700     05  FILLER                       PIC X(23) VALUE             02770000
027800         'OUTBOUND TRIP STATUS.: '.                               02780000
027900     05  HL3-OUTBOUND-STATUS          PIC X(20) VALUE SPACE.      02790000
027910*                                                                 02791010
027920 01  HL5-HEADING-LINE.                                            02792010
027921     05  FILLER                       PIC X(01) VALUE SPACE.      02792110
027922     05  FILLER                       PIC X(15) VALUE             02792210
027923         'STORE SCAN...: '.                                       02792310
027924     05  HL5-STR-SCAN                 PIC X(20) VALUE SPACE.      02792413
027925     05  FILLER                       PIC X(01) VALUE SPACE.      02792516
027926     05  HL5-MULTI-SCANS              PIC X(07) VALUE SPACES.     02792616
027927     05  FILLER                       PIC X(05) VALUE SPACE.      02792716
027928     05  FILLER                       PIC X(15) VALUE             02792816
027929         'STR SCAN DATE: '.                                       02792916
027930     05  HL5-STR-SCAN-DATE            PIC X(10) VALUE SPACE.      02793016
027931     05  FILLER                       PIC X(01) VALUE SPACE.      02793116
027932     05  HL5-STR-SCAN-TIME            PIC X(08) VALUE SPACE.      02793216
027933     05  FILLER                       PIC X(06) VALUE SPACE.      02793316
027934     05  FILLER                       PIC X(49) VALUE SPACE.      02793416
028000*                                                                 02800000
028100 01  DH1-DETAIL-HEADING-1.                                        02810000
028200     05  FILLER                       PIC X(01) VALUE SPACE.      02820000
028300     05  FILLER                       PIC X(16) VALUE             02830000
028400         'PO-RECEIVER-LINE'.                                      02840000
028500     05  FILLER                       PIC X(03) VALUE SPACE.      02850000
028600     05  FILLER                       PIC X(02) VALUE             02860000
028700         'ST'.                                                    02870000
028800     05  FILLER                       PIC X(01) VALUE SPACE.      02880000
028900     05  FILLER                       PIC X(04) VALUE             02890000
029000         'DEPT'.                                                  02900000
029100     05  FILLER                       PIC X(01) VALUE SPACE.      02910000
029200     05  FILLER                       PIC X(03) VALUE             02920000
029300         'CLS'.                                                   02930000
029400     05  FILLER                       PIC X(03) VALUE SPACE.      02940000
029500     05  FILLER                       PIC X(03) VALUE             02950000
029600         'SKU'.                                                   02960000
029700     05  FILLER                       PIC X(05) VALUE SPACE.      02970000
029800     05  FILLER                       PIC X(04) VALUE             02980000
029900         'RFID'.                                                  02990000
030000     05  FILLER                       PIC X(05) VALUE SPACE.      03000000
030100     05  FILLER                       PIC X(03) VALUE             03010000
030200         'UPC'.                                                   03020000
030300     05  FILLER                       PIC X(10) VALUE SPACE.      03030000
030400     05  FILLER                       PIC X(05) VALUE             03040000
030500         'STYLE'.                                                 03050000
030600     05  FILLER                       PIC X(12) VALUE SPACE.      03060000
030700     05  FILLER                       PIC X(11) VALUE             03070000
030800         'DESCRIPTION'.                                           03080000
030900     05  FILLER                       PIC X(09) VALUE SPACE.      03090000
031000     05  FILLER                       PIC X(05) VALUE             03100000
031100         'UNITS'.                                                 03110000
031200     05  FILLER                       PIC X(02) VALUE SPACE.      03120000
031300     05  FILLER                       PIC X(11) VALUE             03130000
031400         'UNIT RETAIL'.                                           03140000
031500     05  FILLER                       PIC X(01) VALUE SPACE.      03150000
031600     05  FILLER                       PIC X(12) VALUE             03160000
031700         'EXTND RETAIL'.                                          03170000
031800                                                                  03180000
031900 01  DL-DETAIL-LINE.                                              03190000
032000     05  FILLER                       PIC X(01) VALUE SPACE.      03200000
032100     05  DL-PO-REC.                                               03210000
032200         10  DL-PO                    PIC 9(08) VALUE ZERO.       03220000
032300         10  DL-PO-FILLER             PIC X(01) VALUE SPACES.     03230000
032400         10  DL-RECEIVER              PIC 9(04) VALUE ZERO.       03240000
032500         10  DL-REC-FILLER            PIC X(01) VALUE SPACES.     03250000
032600     05  DL-LINE                      PIC 9(04) VALUE ZERO.       03260000
032700     05  FILLER                       PIC X(01) VALUE SPACE.      03270000
032800     05  DL-STATUS                    PIC X(02) VALUE SPACES.     03280000
032900     05  FILLER                       PIC X(01) VALUE SPACE.      03290000
033000     05  DL-DEPT                      PIC ZZZ9  VALUE ZERO.       03300000
033100     05  FILLER                       PIC X(01) VALUE SPACE.      03310000
033200     05  DL-CLS                       PIC ZZZ9  VALUE ZERO.       03320000
033300     05  FILLER                       PIC X(01) VALUE SPACE.      03330000
033400     05  DL-SKU                       PIC 9(08) VALUE ZERO.       03340000
033500     05  FILLER                       PIC X(02) VALUE SPACE.      03350000
033600     05  DL-RFD                       PIC X(01) VALUE SPACE.      03360000
033700     05  FILLER                       PIC X(02) VALUE SPACE.      03370000
033800     05  DL-UPC                       PIC 9(15) VALUE ZERO.       03380000
033900     05  FILLER                       PIC X(01) VALUE SPACE.      03390000
034000     05  DL-VS-NBR                    PIC X(18) VALUE SPACE.      03400000
034100     05  FILLER                       PIC X(01) VALUE SPACE.      03410000
034200     05  DL-DESC                      PIC X(13) VALUE SPACE.      03420000
034300     05  FILLER                       PIC X(01) VALUE SPACE.      03430000
034400     05  DL-UNITS                     PIC ZZZ,ZZZ,ZZ9.            03440000
034500     05  FILLER                       PIC X(01) VALUE SPACE.      03450000
034600     05  DL-UNIT-RETAIL               PIC Z,ZZZ,ZZ9.99.           03460000
034700     05  FILLER                       PIC X(01) VALUE SPACE.      03470000
034800     05  DL-EXTND-RETAIL              PIC Z,ZZZ,ZZ9.99.           03480000
034900*                                                                 03490000
035000 01  TL-TOTAL-LINE1.                                              03500000
035100     05  FILLER                       PIC X(05) VALUE SPACE.      03510000
035200     05  FILLER                       PIC X(18) VALUE             03520000
035300         'TOTAL RFID ITEMS: '.                                    03530000
035400     05  TL-RF-ITEMS                  PIC ZZ,ZZ9.                 03540000
035500     05  FILLER                       PIC X(39) VALUE SPACE.      03550000
035600     05  FILLER                       PIC X(25) VALUE             03560000
035700         'TOTAL RFID UNITS/RETAIL: '.                             03570000
035800     05  TL-RF-UNITS                  PIC Z,ZZZ,ZZZ,ZZ9.          03580000
035900     05  FILLER                       PIC X(01) VALUE SPACE.      03590000
036000     05  TL-RF-UNIT-RETAIL            PIC Z,ZZZ,ZZ9.99.           03600000
036100     05  FILLER                       PIC X(01) VALUE SPACE.      03610000
036200     05  TL-RF-EXTND-RETAIL           PIC Z,ZZZ,ZZ9.99.           03620000
036300                                                                  03630000
036400 01  TL-TOTAL-LINE2.                                              03640000
036500     05  FILLER                       PIC X(05) VALUE SPACE.      03650000
036600     05  FILLER                       PIC X(18) VALUE             03660000
036700         'TOTAL ITEMS.....: '.                                    03670000
036800     05  TL-ITEMS                     PIC ZZ,ZZ9.                 03680000
036900     05  FILLER                       PIC X(39) VALUE SPACE.      03690000
037000     05  FILLER                       PIC X(25) VALUE             03700000
037100         'TOTAL UNITS/RETAIL.....: '.                             03710000
037200     05  TL-UNITS                     PIC Z,ZZZ,ZZZ,ZZ9.          03720000
037300     05  FILLER                       PIC X(01) VALUE SPACE.      03730000
037400     05  TL-UNIT-RETAIL               PIC Z,ZZZ,ZZ9.99.           03740000
037500     05  FILLER                       PIC X(01) VALUE SPACE.      03750000
037600     05  TL-EXTND-RETAIL              PIC Z,ZZZ,ZZ9.99.           03760000
037700*                                                                 03770000
037800 01  PC-CARRIAGE-CONTROL.                                         03780000
037900     05  PC-TOP-OF-PAGE               PIC  X(01) VALUE '1'.       03790000
038000     05  PC-SINGLE-SPACE              PIC  X(01) VALUE SPACE.     03800000
038100     05  PC-DOUBLE-SPACE              PIC  X(01) VALUE ZERO.      03810000
038200     05  PC-TRIPLE-SPACE              PIC  X(01) VALUE '-'.       03820000
038300     05  PC-PUT                       PIC  X(03) VALUE 'PUT'.     03830000
038400     05  PC-INIT                      PIC  X(04) VALUE 'INIT'.    03840000
038500     05  PC-TERM                     PIC  X(04)  VALUE 'TERM'.    03850000
038600*                                                                 03860000
038700 01  EL1-ERROR-LINE.                                              03870000
038800     05  FILLER                       PIC X(01) VALUE SPACE.      03880000
038900     05  FILLER                       PIC X(53) VALUE             03890000
039000         'ERROR - DATABASE IS BUSY - TRY AGAIN IN A FEW MINUTES'. 03900000
039100     05  FILLER                       PIC X(78) VALUE SPACE.      03910000
039200/                                                                 03920000
039300*                                                                 03930000
039400*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            03940000
039500*                                                                 03950000
039600     COPY DRRD001O.                                               03960000
039700                                                                  03970000
039800*                                                                 03980000
039900*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        03990000
040000*                                                                 04000000
040100     COPY DRRD002O.                                               04010000
040200/                                                                 04020000
040300*    OUTBOUND CARTONS                                             04030000
040400     EXEC SQL                                                     04040000
040500          INCLUDE SUT00024                                        04050000
040600     END-EXEC.                                                    04060000
040700                                                                  04070000
040800*    OUTBOUND CARTON UPC                                          04080000
040900     EXEC SQL                                                     04090000
041000          INCLUDE SUT00028                                        04100000
041100     END-EXEC.                                                    04110000
041200                                                                  04120000
041300*    OUTBOUND CARTON VENDOR (INPKSU)                              04130000
041400     EXEC SQL                                                     04140000
041500          INCLUDE SUT00026                                        04150000
041600     END-EXEC.                                                    04160000
041700                                                                  04170000
041800*    TRIP STATUS CODES                                            04180000
041900     EXEC SQL                                                     04190000
042000          INCLUDE TSUOBSC                                         04200000
042100     END-EXEC.                                                    04210000
042200                                                                  04220000
042300*    PACKSLIP TABLE                                               04230000
042400     EXEC SQL                                                     04240000
042500          INCLUDE TPKSLIP                                         04250000
042600     END-EXEC.                                                    04260000
042700                                                                  04270000
042800*    RECEIVER TABLE                                               04280000
042900     EXEC SQL                                                     04290000
043000          INCLUDE TRECEIV                                         04300000
043100     END-EXEC.                                                    04310000
043200                                                                  04320000
043210*CLP 06/05/13 PR#5148B START                                      04321009
043300*    RFID TABLE                                                   04330009
043400     EXEC SQL                                                     04340000
043500          INCLUDE RIT00000                                        04350000
043600     END-EXEC.                                                    04360000
043610*CLP 06/05/13 PR#5148B END                                        04361009
043620                                                                  04362009
043700*--------------------------------------------------               04370000
043800*    DCLGEN FOR INTEGRATION TABLE WST_ATTR_ELEM                   04380000
043900*--------------------------------------------------               04390000
044000     EXEC SQL                                                     04400000
044100         INCLUDE WST00010                                         04410000
044200     END-EXEC.                                                    04420000
044300*--------------------------------------------------               04430000
044400*    DCLGEN FOR PARAMETER TABLE                                   04440000
044500*--------------------------------------------------               04450000
044600     EXEC SQL                                                     04460000
044700         INCLUDE TKRPRPM                                          04470000
044800     END-EXEC.                                                    04480000
044900*--------------------------------------------------               04490000
045000*    DCLGEN FOR XLV_UPC                                           04500000
045100*--------------------------------------------------               04510000
045200     EXEC SQL                                                     04520000
045300         INCLUDE XLV00003                                         04530000
045400     END-EXEC.                                                    04540000
045500*--------------------------------------------------               04550000
045600*--------------------------------------------------               04560000
045700*    DCLGEN FOR XLT_SKU                                           04570000
045800*--------------------------------------------------               04580000
045900     EXEC SQL                                                     04590000
046000         INCLUDE XLT00003                                         04600000
046100     END-EXEC.                                                    04610000
046200*--------------------------------------------------               04620000
046300*    DCLGEN FOR XLV_VND_STYL                                      04630000
046400*--------------------------------------------------               04640000
046500     EXEC SQL                                                     04650000
046600         INCLUDE XLV00001                                         04660000
046700     END-EXEC.                                                    04670000
046800                                                                  04680000
046810*--------------------------------------------------               04681010
046820*    DCLGEN FOR SUT_OTBND_SCN_TYP                                 04682010
046830*--------------------------------------------------               04683010
046840     EXEC SQL                                                     04684010
046850         INCLUDE SUT00120                                         04685010
046860     END-EXEC.                                                    04686010
046870                                                                  04687010
046880*--------------------------------------------------               04688010
046890*    DCLGEN FOR SUT_OTBND_STR_SCN                                 04689010
046891*--------------------------------------------------               04689110
046892     EXEC SQL                                                     04689210
046893         INCLUDE SUT00121                                         04689310
046894     END-EXEC.                                                    04689410
046895                                                                  04689510
046896*--------------------------------------------------               04689610
046897*                                                                 04689710
046898*--------------------------------------------------               04689810
046900     EXEC SQL                                                     04690000
047000         DECLARE DETAIL-CSR CURSOR FOR                            04700000
047100                                                                  04710000
047200        SELECT                                                    04720000
047300            'A'                                                   04730000
047400        , UPC.TRN_NBR                                             04740000
047500        , UPC.RCVR_SEQ_NBR                                        04750000
047600        , UPC.TRN_LNE_NBR                                         04760000
047700        , UPC.UPC_NBR                                             04770000
047800        , UPC.SHPD_UNT_QTY                                        04780000
047900        , CART.DEST_LOC_NBR                                       04790000
048000        FROM                                                      04800000
048100         SUT_OTBND_CART CART                                      04810000
048200     ,   SUT_OTBND_UPC UPC                                        04820000
048300        WHERE                                                     04830000
048400            CART.SHIPT_UNT_ID = UPC.SHIPT_UNT_ID                  04840000
048500            AND                                                   04850000
048600            CART.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                  04860000
048700                                                                  04870000
048800         UNION                                                    04880000
048900                                                                  04890000
049000        SELECT                                                    04900000
049100            'B'                                                   04910000
049200        , UPC.TRN_NBR                                             04920000
049300        , UPC.RCVR_SEQ_NBR                                        04930000
049400        , UPC.TRN_LNE_NBR                                         04940000
049500        , UPC.UPC_NBR                                             04950000
049600        , UPC.SHPD_UNT_QTY                                        04960000
049700        , CART.DEST_LOC_NBR                                       04970000
049800        FROM                                                      04980000
049900          SUT_OTBND_CART CART                                     04990000
050000     ,    SUT_OTBND_UPC UPC                                       05000000
050100        WHERE                                                     05010000
050200            CART.SHIPT_UNT_ID = UPC.SHIPT_UNT_ID                  05020000
050300            AND                                                   05030000
050400            CART.ORIG_CART_ID = :DK-SHIPT-UNT-ID                  05040000
050500            AND                                                   05050000
050600            CART.CART_SRC_CDE IN ('ASN', 'RCV')                   05060000
050700                                                                  05070000
050800     END-EXEC.                                                    05080000
050900                                                                  05090000
051000     EXEC SQL                                                     05100000
051100         INCLUDE SQLCA                                            05110000
051200     END-EXEC.                                                    05120000
051300/                                                                 05130000
051400                                                                  05140000
051500 LINKAGE SECTION.                                                 05150000
051600 01  DFHCOMMAREA.                                                 05160000
051700     05  FILLER                       OCCURS 1 TO 1000 TIMES      05170000
051800                                      DEPENDING ON EIBCALEN.      05180000
051900         10  FILLER                   PIC X.                      05190000
052000/                                                                 05200000
052100 PROCEDURE DIVISION.                                              05210000
052200                                                                  05220000
052300     PERFORM 1000-INITIALIZE.                                     05230000
052400                                                                  05240000
052500     PERFORM 2000-PROCESS-QUEUE-REC                               05250000
052600                  UNTIL PS-EOF-QUEUE                              05260000
052700                     OR PS-XL-MOD-ERROR                           05270000
052800                     OR SU033-SHIPT-UNT-ID (SU033-IDX) = ZERO     05280000
052900                                                                  05290000
053000*    CLOSE PRINTER                                                05300000
053100     MOVE PC-TERM                     TO DRS01-DRRB-FUNC          05310000
053200     PERFORM 8000-LINK-TO-DRS.                                    05320000
053300                                                                  05330000
053400 0000-GOBACK.                                                     05340000
053500                                                                  05350000
053600*    PERFORM 9105-DELETE-SEL-QUEUE.                               05360000
053700                                                                  05370000
053800     GOBACK.                                                      05380000
053900/                                                                 05390000
054000 1000-INITIALIZE.                                                 05400000
054100                                                                  05410000
054200     MOVE EIBTASKN                    TO PV-TASK-NUMBER           05420000
054300     MOVE LENGTH OF SU033-COMM-AREA   TO PV-COMMAREA-LENGTH       05430000
054400     INITIALIZE SU033-COMM-AREA                                   05440000
054500                                                                  05450000
054600     EXEC CICS                                                    05460000
054700         RETRIEVE                                                 05470000
054800             INTO (SU033-COMM-AREA)                               05480000
054900             LENGTH (PV-COMMAREA-LENGTH)                          05490000
055000     END-EXEC                                                     05500000
055100                                                                  05510000
055200     EVALUATE TRUE                                                05520000
055300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05530000
055400             CONTINUE                                             05540000
055500         WHEN OTHER                                               05550000
055600             MOVE '1000-INITIALIZE'   TO DP013-PARAGRAPH          05560000
055700             MOVE 'UNABLE TO RETRIEVE DATA'                       05570000
055800                                      TO DP013-MESSAGE-TEXT (1)   05580000
055900             SET DP013-CICS-ABEND                                 05590000
056000                 DP013-NO-ROLLBACK    TO TRUE                     05600000
056100             PERFORM 9999-WRITE-CICS-LOG-MSG                      05610000
056200     END-EVALUATE.                                                05620000
056300                                                                  05630000
056400* GET THE FIRST TABLIZED SML KEY FOR PROCESSING                   05640000
056500     SET SU033-IDX                    TO 1                        05650000
056600                                                                  05660000
056700     EXEC SQL                                                     05670000
056800         SELECT                                                   05680000
056900         CHAR ( DATE (CURRENT TIMESTAMP),USA)                     05690000
057000     ,   CHAR ( TIME (CURRENT TIMESTAMP),JIS)                     05700000
057100     INTO                                                         05710000
057200         :PV-RUN-DATE                                             05720000
057300     ,   :PV-RUN-TIME                                             05730000
057400         FROM SYSIBM.SYSDUMMY1                                    05740000
057500     END-EXEC                                                     05750000
057600                                                                  05760000
057700     MOVE PV-RUN-DATE                 TO DP132-RUN-DATE.          05770000
057800     MOVE PV-RUN-TIME                 TO DP132-RUN-TIME.          05780000
057900                                                                  05790000
058000     MOVE 'SUKCS751'                  TO DP132-PROGRAM-NAME.      05800000
058100     MOVE 1                           TO DP132-REPORT-NUMBER.     05810000
058200                                                                  05820000
058300*    OPEN PRINTER                                                 05830000
058400     MOVE 'A'                         TO DRS02-DRIB-CLASS.        05840000
058500     MOVE 'N'                         TO DRS02-DRIB-HOLD.         05850000
058600     MOVE SU033-PRINTER-ID            TO DRS02-DRIB-DEST.         05860000
058700     MOVE PC-INIT                     TO DRS01-DRRB-FUNC.         05870000
058800     MOVE DRS02-DRIB-HEADER           TO DRS01-COMM-DRIB-HDR.     05880000
058900     MOVE DRS02-DRIB-ATTRIB           TO DRS01-COMM-DRIB-AT1.     05890000
059000     PERFORM 8000-LINK-TO-DRS.                                    05900000
059100                                                                  05910000
059200                                                                  05920000
059300 1001-GET-NEXT-SML.                                               05930000
059400     IF SU033-SHIPT-UNT-ID (SU033-IDX) > ZERO                     05940000
059500         MOVE SU033-SHIPT-UNT-ID (SU033-IDX)                      05950000
059600                                      TO DK-SHIPT-UNT-ID          05960000
059700     ELSE                                                         05970000
059800         SET PS-EOF-QUEUE             TO TRUE                     05980000
059900     END-IF.                                                      05990000
060000/                                                                 06000000
060100 2000-PROCESS-QUEUE-REC.                                          06010000
060200                                                                  06020000
060300     IF SU033-IDX > 30  OR                                        06030000
060400        SU033-SHIPT-UNT-ID (SU033-IDX) = ZERO                     06040000
060500         OR  PS-XL-MOD-ERROR                                      06050000
060600         SET PS-EOF-QUEUE             TO TRUE                     06060000
060700     ELSE                                                         06070000
060800         PERFORM 1001-GET-NEXT-SML                                06080000
060900         MOVE ZERO                    TO PV-TOT-ITEMS             06090000
061000                                         PV-TOT-UNITS             06100000
061100                                         PV-TOT-UNIT-RETAIL       06110000
061200                                         PV-TOT-EXTEND-RETAIL     06120000
061300                                         PV-TOT-RF-ITEMS          06130000
061400                                         PV-TOT-RF-UNITS          06140000
061500                                         PV-TOT-RF-UNIT-RETAIL    06150000
061600                                         PV-TOT-RF-EXTEND-RETAIL  06160000
061700         MOVE 1                       TO PV-LINE-COUNT            06170000
061800         MOVE 1                       TO PV-PAGE-COUNT            06180000
061900         PERFORM 3000-BUILD-HEADINGS                              06190000
062000         PERFORM 8100-PRINT-HEADINGS                              06200000
062100     END-IF                                                       06210000
062200     PERFORM 7400-CHECK-IF-RFID-DC                                06220000
062300     PERFORM 7100-OPEN-DETAIL-CSR                                 06230000
062400     PERFORM UNTIL PS-END-OF-CSR                                  06240000
062500                OR PS-XL-MOD-ERROR                                06250000
062600         PERFORM 7110-FETCH-DETAIL-CSR                            06260000
062700         IF PS-END-OF-CSR                                         06270000
062800            CONTINUE                                              06280000
062900         ELSE                                                     06290000
063000            PERFORM 2100-BUILD-DETAIL-LINE                        06300000
063100            IF PS-XL-MOD-ERROR-NO                                 06310000
063200               IF PV-LINE-COUNT > 60                              06320000
063300                  ADD 1              TO PV-PAGE-COUNT             06330000
063400                  PERFORM 8100-PRINT-HEADINGS                     06340000
063500               END-IF                                             06350000
063600               PERFORM 4000-PRINT-DETAIL-LINE                     06360000
063700            ELSE                                                  06370000
063800             PERFORM 4200-PRINT-ERROR-LINE                        06380000
063900            END-IF                                                06390000
064000         END-IF                                                   06400000
064100     END-PERFORM                                                  06410000
064200     PERFORM 7120-CLOSE-DETAIL-CSR                                06420000
064300     IF  PS-XL-MOD-ERROR-NO                                       06430000
064400         PERFORM 4100-WRITE-TOTAL-LINE                            06440000
064500         SET SU033-IDX UP BY 1                                    06450000
064600     END-IF.                                                      06460000
064700                                                                  06470000
064800 2100-BUILD-DETAIL-LINE.                                          06480000
064900                                                                  06490000
065000     IF PV-CURRENT-KEY NOT EQUAL PV-PREVIOUS-KEY                  06500000
065100         MOVE PV-CURRENT-KEY          TO PV-PREVIOUS-KEY          06510000
065200         MOVE SUT00028-TRN-NBR        TO DL-PO                    06520000
065300         MOVE '-'                     TO DL-PO-FILLER             06530000
065400         MOVE SUT00028-RCVR-SEQ-NBR   TO DL-RECEIVER              06540000
065500         MOVE '-'                     TO DL-REC-FILLER            06550000
065600         PERFORM 7140-SELECT-RECEIVER-STATUS                      06560000
065700         MOVE RECEIV-STATUS-CDE       TO DL-STATUS                06570000
065800     ELSE                                                         06580000
065900         MOVE SPACES                  TO DL-PO-REC                06590000
066000                                         DL-STATUS                06600000
066100     END-IF.                                                      06610000
066200                                                                  06620000
066300     MOVE SUT00028-TRN-LNE-NBR        TO DL-LINE.                 06630000
066400                                                                  06640000
066500     MOVE SUT00028-UPC-NBR            TO DL-UPC.                  06650000
066600     MOVE SUT00028-SHPD-UNT-QTY       TO DL-UNITS.                06660000
066700                                                                  06670000
066800     PERFORM 8300-CALL-XLKUT001.                                  06680000
066900                                                                  06690000
067000     MOVE XL001-DEPT-NBR              TO DL-DEPT.                 06700000
067100     MOVE XL001-SUB-CL-NBR            TO DL-CLS.                  06710000
067200     MOVE XL001-SKU-NBR               TO DL-SKU.                  06720000
067300     MOVE XL001-VS-NBR                TO DL-VS-NBR.               06730000
067400     MOVE XL001-SKU-DESC              TO DL-DESC.                 06740000
067500     MOVE XL001-UNT-RTL-AMT           TO DL-UNIT-RETAIL.          06750000
067600     MULTIPLY SUT00028-SHPD-UNT-QTY BY XL001-UNT-RTL-AMT          06760000
067700                                  GIVING PV-EXTEND-RETAIL.        06770000
067800     MOVE PV-EXTEND-RETAIL            TO DL-EXTND-RETAIL.         06780000
067900                                                                  06790000
068000     ADD SUT00028-SHPD-UNT-QTY        TO PV-TOT-UNITS.            06800000
068100     ADD XL001-UNT-RTL-AMT            TO PV-TOT-UNIT-RETAIL.      06810000
068200     ADD PV-EXTEND-RETAIL             TO PV-TOT-EXTEND-RETAIL.    06820000
068300*RFI PROCESSING                                                   06830000
068400     IF PS-DEPT-SUBCL-RFID-YES AND PS-STORE-RFID-YES              06840000
068500        ADD 1                         TO PV-TOT-RF-ITEMS          06850000
068600        MOVE 'Y'                      TO DL-RFD                   06860000
068700        ADD SUT00028-SHPD-UNT-QTY     TO PV-TOT-RF-UNITS          06870000
068800        ADD XL001-UNT-RTL-AMT         TO PV-TOT-RF-UNIT-RETAIL    06880000
068900        ADD PV-EXTEND-RETAIL          TO PV-TOT-RF-EXTEND-RETAIL  06890000
069000        SET PS-DEPT-SUBCL-RFID-NO     TO TRUE                     06900000
069100     ELSE                                                         06910000
069200        MOVE SPACE                    TO DL-RFD                   06920000
069300     END-IF.                                                      06930000
069400/                                                                 06940000
069500 3000-BUILD-HEADINGS.                                             06950000
069600     INITIALIZE PC046-COMMAREA-REC.                               06960000
069700     MOVE DK-SHIPT-UNT-ID             TO HL2-SML                  06970000
069800                                         PV-CURR-SML              06980000
069900                                         PC046-CARTON-ID.         06990000
070000     PERFORM 8200-CALL-PCKUT713.                                  07000000
070100     IF PS-ERROR-YES                                              07010000
070200         CONTINUE                                                 07020000
070300     ELSE                                                         07030000
070400         MOVE PC046-SCAC              TO HL2-SCAC                 07040000
070500         MOVE PC046-TRLR-ID           TO HL2-TRAILER-ID           07050000
070600         MOVE PC046-CRTN-STAT-DESC    TO HL3-CTN-STATUS           07060000
070700         MOVE PC046-OTBD-TRIP-ID      TO HL3-OUTBOUND-TRIP        07070000
070800     END-IF.                                                      07080000
070900                                                                  07090000
071000     PERFORM 7000-GET-TRIP-STAT-DESC.                             07100000
071100     MOVE SUOBSC-TRIP-STAT-DESC       TO HL3-OUTBOUND-STATUS.     07110000
071200                                                                  07120000
071300     PERFORM 7010-GET-CTN-INFO.                                   07130000
071400     MOVE PV-CREATE-DATE              TO HL2-CREATE-DATE.         07140000
071500     MOVE PV-CREATE-TIME              TO HL2-CREATE-TIME.         07150000
071600     MOVE SUT00024-CRE-USR-ID         TO HL3-USERID.              07160000
071700     MOVE PV-CREATE-SOURCE            TO HL3-SOURCE.              07170000
071800                                                                  07180000
071900     PERFORM 7020-GET-DEST-NAME.                                  07190000
072000                                                                  07200000
072100     MOVE PC046-DEST-OPER-UNT-ID      TO HL3-DEST.                07210000
072200     MOVE XL071-LOC-NM                TO HL3-DEST-NAME.           07220000
072300                                                                  07230000
072310* DMH - 11/14/17 BEGIN                                            07231011
072320     PERFORM 7030-CHECK-STORE-SCAN.                               07232011
072321     MOVE SUT00120-SCN-TYP-SHRT-DES   TO  HL5-STR-SCAN.           07232113
072325     MOVE PV-STR-SCAN-DATE            TO  HL5-STR-SCAN-DATE.      07232513
072327     MOVE PV-STR-SCAN-TIME            TO  HL5-STR-SCAN-TIME.      07232713
072334* DMH - 11/14/17 END                                              07233411
072340                                                                  07234011
072350                                                                  07235011
072400******************************************************************07240000
072500*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        07250000
072600******************************************************************07260000
072700 4000-PRINT-DETAIL-LINE.                                          07270000
072800                                                                  07280000
072900     IF PV-LINE-COUNT > 60                                        07290000
073000         ADD 1                        TO PV-PAGE-COUNT            07300000
073100         PERFORM 8100-PRINT-HEADINGS                              07310000
073200     END-IF                                                       07320000
073300                                                                  07330000
073400     MOVE PC-DOUBLE-SPACE             TO  DRS01-COMM-CTL          07340000
073500     MOVE DL-DETAIL-LINE              TO  DRS01-COMM-DATA.        07350000
073600     PERFORM 8000-LINK-TO-DRS.                                    07360000
073700     ADD 2                            TO PV-LINE-COUNT.           07370000
073800                                                                  07380000
073900 4100-WRITE-TOTAL-LINE.                                           07390000
074000     MOVE PV-TOT-ITEMS                TO TL-ITEMS                 07400000
074100     MOVE PV-TOT-UNITS                TO TL-UNITS                 07410000
074200     MOVE PV-TOT-UNIT-RETAIL          TO TL-UNIT-RETAIL           07420000
074300     MOVE PV-TOT-EXTEND-RETAIL        TO TL-EXTND-RETAIL          07430000
074400     MOVE PV-TOT-RF-ITEMS             TO TL-RF-ITEMS              07440000
074500     MOVE PV-TOT-RF-UNITS             TO TL-RF-UNITS              07450000
074600     MOVE PV-TOT-RF-UNIT-RETAIL       TO TL-RF-UNIT-RETAIL        07460000
074700     MOVE PV-TOT-RF-EXTEND-RETAIL     TO TL-RF-EXTND-RETAIL       07470000
074800                                                                  07480000
074900     MOVE PC-TRIPLE-SPACE             TO DRS01-COMM-CTL           07490000
075000     MOVE TL-TOTAL-LINE1              TO DRS01-COMM-DATA.         07500000
075100     PERFORM 8000-LINK-TO-DRS.                                    07510000
075200     ADD 3                            TO PV-LINE-COUNT.           07520000
075300                                                                  07530000
075400     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL           07540000
075500     MOVE TL-TOTAL-LINE2              TO DRS01-COMM-DATA.         07550000
075600     PERFORM 8000-LINK-TO-DRS.                                    07560000
075700     ADD 1                            TO PV-LINE-COUNT.           07570000
075800                                                                  07580000
075900     MOVE PC-TRIPLE-SPACE             TO DRS01-COMM-CTL           07590000
076000     MOVE PC-END-REPORT               TO DRS01-COMM-DATA.         07600000
076100     PERFORM 8000-LINK-TO-DRS.                                    07610000
076200     ADD 3                            TO PV-LINE-COUNT.           07620000
076300                                                                  07630000
076400 4200-PRINT-ERROR-LINE.                                           07640000
076500                                                                  07650000
076600     MOVE PC-TRIPLE-SPACE             TO DRS01-COMM-CTL           07660000
076700     MOVE EL1-ERROR-LINE              TO DRS01-COMM-DATA.         07670000
076800     PERFORM 8000-LINK-TO-DRS.                                    07680000
076900     ADD 3                            TO PV-LINE-COUNT.           07690000
077000                                                                  07700000
077100                                                                  07710000
077200 7000-GET-TRIP-STAT-DESC.                                         07720000
077300     EXEC SQL                                                     07730000
077400     SELECT                                                       07740000
077500         TRIP_STAT_DESC                                           07750000
077600     INTO                                                         07760000
077700         :SUOBSC-TRIP-STAT-DESC                                   07770000
077800     FROM                                                         07780000
077900         TSUOBSC                                                  07790000
078000     WHERE                                                        07800000
078100         TRIP_STAT_CDE                = :PC046-TRIP-STATUS        07810000
078200     END-EXEC.                                                    07820000
078300                                                                  07830000
078400     EVALUATE TRUE                                                07840000
078500         WHEN SQLCODE = ZERO                                      07850000
078600         WHEN SQLCODE = +100                                      07860000
078700             CONTINUE                                             07870000
078800                                                                  07880000
078900         WHEN SQLWARN0 NOT = SPACE                                07890000
079000         WHEN SQLCODE < ZERO                                      07900000
079100         WHEN SQLCODE > ZERO                                      07910000
079200             MOVE '7000-GET-TRIP-STAT-DESC'                       07920000
079300                                      TO DP013-PARAGRAPH          07930000
079400             MOVE 'SELECT STATUS CODE DESC'                       07940000
079500                                      TO DP013-MESSAGE-TEXT (1)   07950000
079600             MOVE SQLCA               TO DP013-SQLCA              07960000
079700             MOVE 'TSUOBSC'           TO DP013-DB2-TABLE-NAME (1) 07970000
079800             SET DP013-NO-ROLLBACK                                07980000
079900                 DP013-DB2-ABEND      TO TRUE                     07990000
080000             PERFORM 9999-WRITE-CICS-LOG-MSG                      08000000
080100     END-EVALUATE.                                                08010000
080200                                                                  08020000
080300                                                                  08030000
080400 7010-GET-CTN-INFO.                                               08040000
080500                                                                  08050000
080600     EXEC SQL                                                     08060000
080700     SELECT                                                       08070000
080800         CHAR (( CRE_DTE),USA)                                    08080000
080900     ,   CHAR (( CRE_TM),JIS)                                     08090000
081000     ,   CRE_USR_ID                                               08100000
081100                                                                  08110000
081200     ,   CASE                                                     08120000
081300              CART_SRC_CDE                                        08130000
081400         WHEN 'ASN' THEN 'CHECK-IN          '                     08140000
081500         WHEN 'CKN' THEN 'CHECK-IN          '                     08150000
081600         WHEN 'CPS' THEN 'CASEPACK SPLIT    '                     08160000
081700         WHEN 'JWL' THEN 'FINE JEWELRY      '                     08170000
081800         WHEN 'P2L' THEN 'PACK-TO-LITE      '                     08180000
081900         WHEN 'MAN' THEN 'CARTON BUILD      '                     08190000
082000         WHEN 'RCV' THEN 'RECEIVING         '                     08200000
082100         WHEN 'RDM' THEN 'RDM               '                     08210000
082200         WHEN 'SMO' THEN 'SMOOTHING         '                     08220000
082300         WHEN 'FXR' THEN 'FAST TRANSFER     '                     08230000
082400         WHEN 'MST' THEN 'MASTER CONTAINER  '                     08240000
082500         WHEN 'MSC' THEN 'CARTON BUILD      '                     08250000
082600         WHEN 'DMG' THEN 'DMG BY CRTN ADJUST'                     08260000
082610         WHEN '3WD' THEN '3PRTY WHSE DISTRBN'                     08261018
082700         END                                                      08270000
082800     INTO                                                         08280000
082900         :PV-CREATE-DATE                                          08290000
083000     ,   :PV-CREATE-TIME                                          08300000
083100     ,   :SUT00024-CRE-USR-ID                                     08310000
083200     ,   :PV-CREATE-SOURCE                                        08320000
083300     FROM                                                         08330000
083400         SUT_OTBND_CART                                           08340000
083500     WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                        08350000
083600     END-EXEC.                                                    08360000
083700                                                                  08370000
083800     EVALUATE TRUE                                                08380000
083900         WHEN SQLCODE = ZERO                                      08390000
084000         WHEN SQLCODE = +100                                      08400000
084100             CONTINUE                                             08410000
084200                                                                  08420000
084300         WHEN SQLWARN0 NOT = SPACE                                08430000
084400         WHEN SQLCODE < ZERO                                      08440000
084500         WHEN SQLCODE > ZERO                                      08450000
084600             MOVE '7010-GET-CTN-INFO' TO DP013-PARAGRAPH          08460000
084700             MOVE 'SELECT CARTON INFO'                            08470000
084800                                      TO DP013-MESSAGE-TEXT (1)   08480000
084900             MOVE SQLCA               TO DP013-SQLCA              08490000
085000             MOVE 'SUT_OTBND_CART'    TO DP013-DB2-TABLE-NAME (1) 08500000
085100             SET DP013-NO-ROLLBACK                                08510000
085200                 DP013-DB2-ABEND      TO TRUE                     08520000
085300             PERFORM 9999-WRITE-CICS-LOG-MSG                      08530000
085400     END-EVALUATE.                                                08540000
085500                                                                  08550000
085600 7020-GET-DEST-NAME.                                              08560000
085700                                                                  08570000
085800     INITIALIZE XL071-COMMAREA-REC.                               08580000
085900     MOVE PC046-DEST-OPER-UNT-ID   TO XL071-LOCATION-NUMBER.      08590000
086000                                                                  08600000
086100     CALL PC-LOCATION-MODULE  USING                               08610000
086200                                    DFHEIBLK                      08620000
086300                                    XL071-COMMAREA                08630000
086400                                    XL071-COMMAREA-REC.           08640000
086500                                                                  08650000
086600     IF XL071-NO-ERRORS                                           08660000
086700         CONTINUE                                                 08670000
086800     ELSE                                                         08680000
086900         IF XL071-LOC-NOT-FOUND                                   08690000
087000             MOVE SPACES TO XL071-LOC-NM                          08700000
087100         ELSE                                                     08710000
087200             IF XL071-BAD-DB2-RETURN                              08720000
087300                 MOVE '7020-GET-DEST-NAME' TO DP013-PARAGRAPH     08730000
087400                 MOVE 'SELECT DEST NAME' TO DP013-MESSAGE-TEXT (1)08740000
087500                 MOVE XL071-SQLCA    TO SQLCA                     08750000
087600                 MOVE SQLCA          TO DP013-SQLCA               08760000
087700                 MOVE 'XLT00010'     TO DP013-DB2-TABLE-NAME (1)  08770000
087800                 SET DP013-DB2-ABEND TO TRUE                      08780000
087900                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           08790000
088000                 SET DP013-NO-ROLLBACK TO TRUE                    08800000
088100                 PERFORM DP013-0000-PROCESS-ABEND                 08810000
088200             END-IF                                               08820000
088300         END-IF                                                   08830000
088400     END-IF.                                                      08840000
088500                                                                  08850000
088501                                                                  08850111
088502*---------------------------------------------------------------- 08850211
088503* CHECK IF CARTON WAS SCANNED AT THE STORE                      - 08850311
088504*---------------------------------------------------------------- 08850411
088510 7030-CHECK-STORE-SCAN.                                           08851011
088511                                                                  08851111
088514     EXEC SQL                                                     08851411
088515          SELECT  C.SCN_TYP_SHRT_DES                              08851511
088516               ,  CHAR (DATE(A.CRE_TMST),USA)                     08851615
088517               ,  CHAR (TIME(A.CRE_TMST),JIS)                     08851715
088518            INTO :SUT00120-SCN-TYP-SHRT-DES                       08851811
088519               , :PV-STR-SCAN-DATE                                08851911
088520               , :PV-STR-SCAN-TIME                                08852011
088521            FROM  SUT_OTBND_STR_SCN A                             08852111
088522               ,  SUT_OTBND_SCN_TYP C                             08852211
088523           WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                08852311
088524             AND A.CRE_TMST IN                                    08852411
088525                 (SELECT MAX(B.CRE_TMST)                          08852511
088526                    FROM SUT_OTBND_STR_SCN B                      08852611
088527                   WHERE A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID     08852711
088530                     AND NOT B.SCN_TYP_CDE  =  'SSMS'             08853011
088531                )                                                 08853111
088532             AND A.SCN_TYP_CDE  =  C.SCN_TYP_CDE                  08853211
088533     END-EXEC.                                                    08853311
088543                                                                  08854311
088544     EVALUATE TRUE                                                08854411
088545         WHEN SQLCODE = ZERO                                      08854511
088546              PERFORM 7035-CHECK-MULT-STR-SCN                     08854616
088547         WHEN SQLCODE = +100                                      08854711
088548              MOVE SPACES  TO  SUT00120-SCN-TYP-SHRT-DES          08854811
088550                               PV-STR-SCAN-DATE                   08855016
088551                               PV-STR-SCAN-TIME                   08855116
088552                                                                  08855211
088553         WHEN SQLWARN0 NOT = SPACE                                08855311
088554         WHEN SQLCODE < ZERO                                      08855411
088555         WHEN SQLCODE > ZERO                                      08855511
088556             MOVE '7030-CHECK-STORE-SCAN'                         08855611
088557                                      TO DP013-PARAGRAPH          08855711
088558             MOVE 'CHECK IF STORE SCANNED CARTON'                 08855811
088559                                      TO DP013-MESSAGE-TEXT (1)   08855911
088560             MOVE SQLCA               TO DP013-SQLCA              08856011
088561             MOVE 'SUT_OTBND_SCN_TYP' TO DP013-DB2-TABLE-NAME (1) 08856111
088562             MOVE 'SUT_OTBND_STR_SCN' TO DP013-DB2-TABLE-NAME (1) 08856211
088563             SET DP013-NO-ROLLBACK                                08856311
088564                 DP013-DB2-ABEND      TO TRUE                     08856411
088565             PERFORM 9999-WRITE-CICS-LOG-MSG                      08856511
088566     END-EVALUATE.                                                08856611
088568                                                                  08856811
088569                                                                  08856916
088570*---------------------------------------------------------------- 08857016
088571* CHECK IF CARTON WAS SCANNED AT THE STORE MULTIPLE TIMES       - 08857116
088572*---------------------------------------------------------------- 08857216
088573 7035-CHECK-MULT-STR-SCN.                                         08857316
088574                                                                  08857416
088575     EXEC SQL                                                     08857516
088576          SELECT  COUNT(*)                                        08857616
088577            INTO :PV-STORE-SCAN-COUNT                             08857716
088578            FROM  SUT_OTBND_STR_SCN                               08857816
088584           WHERE  SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                 08858416
088592     END-EXEC.                                                    08859216
088593                                                                  08859316
088594     EVALUATE TRUE                                                08859416
088595         WHEN SQLCODE = ZERO                                      08859516
088596               IF  PV-STORE-SCAN-COUNT   > 1                      08859616
088597                   MOVE  '(MULTI)' TO  HL5-MULTI-SCANS            08859716
088598               ELSE                                               08859816
088599                   MOVE  SPACES    TO  HL5-MULTI-SCANS            08859916
088600               END-IF                                             08860016
088605                                                                  08860516
088606         WHEN SQLWARN0 NOT = SPACE                                08860616
088607         WHEN SQLCODE < ZERO                                      08860716
088608         WHEN SQLCODE > ZERO                                      08860816
088609             MOVE '7035-CHECK-MULT-STR-SCN'                       08860916
088610                                      TO DP013-PARAGRAPH          08861016
088611             MOVE 'CHECK IF STORE SCANNED CARTON'                 08861116
088612                                      TO DP013-MESSAGE-TEXT (1)   08861216
088613             MOVE SQLCA               TO DP013-SQLCA              08861316
088614             MOVE 'SUT_OTBND_SCN_TYP' TO DP013-DB2-TABLE-NAME (1) 08861416
088615             MOVE 'SUT_OTBND_STR_SCN' TO DP013-DB2-TABLE-NAME (1) 08861516
088616             SET DP013-NO-ROLLBACK                                08861616
088617                 DP013-DB2-ABEND      TO TRUE                     08861716
088618             PERFORM 9999-WRITE-CICS-LOG-MSG                      08861816
088619     END-EVALUATE.                                                08861916
088620                                                                  08862016
088621                                                                  08862116
088630*---------------------------------------------------------------- 08863000
088700 7100-OPEN-DETAIL-CSR.                                            08870000
088800     EXEC SQL                                                     08880000
088900         OPEN DETAIL-CSR                                          08890000
089000     END-EXEC.                                                    08900000
089100                                                                  08910000
089200     EVALUATE TRUE                                                08920000
089300         WHEN SQLCODE = ZERO                                      08930000
089400             SET PS-NOT-END-OF-CSR    TO TRUE                     08940000
089500             SET PS-CURSOR-OPEN       TO TRUE                     08950000
089600                                                                  08960000
089700         WHEN SQLWARN0 NOT = SPACE                                08970000
089800         WHEN SQLCODE < ZERO                                      08980000
089900         WHEN SQLCODE > ZERO                                      08990000
090000             MOVE '7100-OPEN-DETAIL-CSR'                          09000000
090100                                      TO DP013-PARAGRAPH          09010000
090200             MOVE 'OPEN DETAIL CURSOR'                            09020000
090300                                      TO DP013-MESSAGE-TEXT (1)   09030000
090400             MOVE SQLCA               TO DP013-SQLCA              09040000
090500             MOVE 'SUT_OTBND_CART'    TO DP013-DB2-TABLE-NAME (1) 09050000
090600             MOVE 'SUT_OTBND_UPC'     TO DP013-DB2-TABLE-NAME (2) 09060000
090700             SET DP013-NO-ROLLBACK                                09070000
090800                 DP013-DB2-ABEND      TO TRUE                     09080000
090900             PERFORM 9999-WRITE-CICS-LOG-MSG                      09090000
091000     END-EVALUATE.                                                09100000
091100                                                                  09110000
091200 7110-FETCH-DETAIL-CSR.                                           09120000
091300     EXEC SQL                                                     09130000
091400         FETCH DETAIL-CSR                                         09140000
091500         INTO                                                     09150000
091600          :PV-LETTER                                              09160000
091700        , :SUT00028-TRN-NBR                                       09170000
091800        , :SUT00028-RCVR-SEQ-NBR                                  09180000
091900        , :SUT00028-TRN-LNE-NBR                                   09190000
092000        , :SUT00028-UPC-NBR                                       09200000
092100        , :SUT00028-SHPD-UNT-QTY                                  09210000
092200        , :SUT00024-DEST-LOC-NBR                                  09220000
092300     END-EXEC.                                                    09230000
092400                                                                  09240000
092500     EVALUATE TRUE                                                09250000
092600         WHEN SQLCODE = ZERO                                      09260000
092700             IF PS-DC-RFID-YES                                    09270000
092701*CLP 06/05/13 PR#5148B START                                      09270109
092710                PERFORM 7200-SEL-DPT-SCL-VS-NBR                   09271000
093000                PERFORM 7300-CHECK-DEPT-CLASS                     09300000
093002                PERFORM 7500-CHECK-IF-RFID-STORE                  09300200
093003*CLP 06/05/13 PR#5148B END                                        09300309
093100             END-IF                                               09310000
093200             ADD 1                    TO PV-TOT-ITEMS             09320000
093300             MOVE SUT00028-TRN-NBR    TO PV-CURR-PO               09330000
093400             MOVE SUT00028-RCVR-SEQ-NBR                           09340000
093500                                      TO PV-CURR-RCVR             09350000
093600                                                                  09360000
093700             MOVE  SUT00028-RCVR-SEQ-NBR                          09370000
093800               TO  PV-RCVR-SEQ                                    09380000
093900                                                                  09390000
094000             IF  PV-RCVR-SEQ  =  0                                09400000
094100                 PERFORM 7130-GET-RCVR-SEQ                        09410000
094200             END-IF                                               09420000
094300                                                                  09430000
094400         WHEN SQLCODE = +100                                      09440000
094500             SET PS-END-OF-CSR        TO TRUE                     09450000
094600                                                                  09460000
094700         WHEN SQLWARN0 NOT = SPACE                                09470000
094800         WHEN SQLCODE < ZERO                                      09480000
094900         WHEN SQLCODE > ZERO                                      09490000
095000             MOVE '7110-FETCH-DETAIL-CSR'                         09500000
095100                                      TO DP013-PARAGRAPH          09510000
095200             MOVE 'FETCH DETAIL CURSOR'                           09520000
095300                                      TO DP013-MESSAGE-TEXT (1)   09530000
095400             MOVE SQLCA               TO DP013-SQLCA              09540000
095500             MOVE 'SUT_OTBND_CART'    TO DP013-DB2-TABLE-NAME (1) 09550000
095600             MOVE 'SUT_OTBND_UPC'     TO DP013-DB2-TABLE-NAME (2) 09560000
095700             SET DP013-NO-ROLLBACK                                09570000
095800                 DP013-DB2-ABEND      TO TRUE                     09580000
095900             PERFORM 9999-WRITE-CICS-LOG-MSG                      09590000
096000     END-EVALUATE.                                                09600000
096100                                                                  09610000
096200 7120-CLOSE-DETAIL-CSR.                                           09620000
096300     EXEC SQL                                                     09630000
096400         CLOSE DETAIL-CSR                                         09640000
096500     END-EXEC.                                                    09650000
096600                                                                  09660000
096700     EVALUATE TRUE                                                09670000
096800         WHEN SQLCODE = ZERO                                      09680000
096900             SET PS-CURSOR-CLOSED   TO TRUE                       09690000
097000                                                                  09700000
097100         WHEN SQLWARN0 NOT = SPACE                                09710000
097200         WHEN SQLCODE < ZERO                                      09720000
097300         WHEN SQLCODE > ZERO                                      09730000
097400             MOVE '7120-CLOSE-DETAIL-CSR'                         09740000
097500                                      TO DP013-PARAGRAPH          09750000
097600             MOVE 'CLOSE DETAIL CURSOR'                           09760000
097700                                      TO DP013-MESSAGE-TEXT (1)   09770000
097800             MOVE SQLCA               TO DP013-SQLCA              09780000
097900             MOVE 'SUT_OTBND_CART'    TO DP013-DB2-TABLE-NAME (1) 09790000
098000             MOVE 'SUT_OTBND_UPC'     TO DP013-DB2-TABLE-NAME (2) 09800000
098100             SET DP013-NO-ROLLBACK                                09810000
098200                 DP013-DB2-ABEND      TO TRUE                     09820000
098300             PERFORM 9999-WRITE-CICS-LOG-MSG                      09830000
098400     END-EVALUATE.                                                09840000
098500                                                                  09850000
098600                                                                  09860000
098700 7130-GET-RCVR-SEQ.                                               09870000
098800                                                                  09880000
098900     EXEC SQL                                                     09890000
099000         SELECT  A.REC_SEQ_NBR                                    09900000
099100         INTO    :PKSLIP-REC-SEQ-NBR                              09910000
099200         FROM    TPKSLIP A                                        09920000
099300                ,SUT_OTBND_VND B                                  09930000
099400         WHERE   :DK-SHIPT-UNT-ID  =  B.SHIPT_UNT_ID              09940000
099500           AND   B.PO_NBR          =  A.PO_NBR                    09950000
099600           AND   B.PKSL_SEQ_NBR    =  A.SEQ_NBR                   09960000
099700           AND   A.VER_STAT_CDE    = 'A'                          09970000
099800     END-EXEC.                                                    09980000
099900                                                                  09990000
100000     EVALUATE TRUE                                                10000000
100100         WHEN SQLCODE = ZERO                                      10010000
100200             MOVE  PKSLIP-REC-SEQ-NBR                             10020000
100300               TO  PV-RCVR-SEQ                                    10030000
100400                                                                  10040000
100500         WHEN SQLCODE = +100                                      10050000
100600              CONTINUE                                            10060000
100700                                                                  10070000
100800         WHEN SQLWARN0 NOT = SPACE                                10080000
100900         WHEN SQLCODE < ZERO                                      10090000
101000         WHEN SQLCODE > ZERO                                      10100000
101100             MOVE '7130-GET-RCVR-SEQ    '                         10110000
101200                                      TO DP013-PARAGRAPH          10120000
101300             MOVE 'GET RCVR SEQ NUMBER'                           10130000
101400                                      TO DP013-MESSAGE-TEXT (1)   10140000
101500             MOVE SQLCA               TO DP013-SQLCA              10150000
101600             MOVE 'SUT_OTBND_VND '    TO DP013-DB2-TABLE-NAME (1) 10160000
101700             MOVE 'TPKSLIP      '     TO DP013-DB2-TABLE-NAME (2) 10170000
101800             MOVE  DK-SHIPT-UNT-ID    TO DP013-MESSAGE-TEXT (2)   10180000
101900             SET DP013-NO-ROLLBACK                                10190000
102000                 DP013-DB2-ABEND      TO TRUE                     10200000
102100             PERFORM 9999-WRITE-CICS-LOG-MSG                      10210000
102200     END-EVALUATE.                                                10220000
102300                                                                  10230000
102400                                                                  10240000
102500 7140-SELECT-RECEIVER-STATUS.                                     10250000
102600                                                                  10260000
102700     EXEC SQL                                                     10270000
102800         SELECT  STATUS_CDE                                       10280000
102900         INTO    :RECEIV-STATUS-CDE                               10290000
103000         FROM    TRECEIV                                          10300000
103100         WHERE   ORD_NBR           =  :SUT00028-TRN-NBR           10310000
103200           AND   REC_SEQ_NBR       =  :SUT00028-RCVR-SEQ-NBR      10320000
103300     END-EXEC.                                                    10330000
103400                                                                  10340000
103500     EVALUATE TRUE                                                10350000
103600         WHEN SQLCODE = ZERO                                      10360000
103700             CONTINUE                                             10370000
103800                                                                  10380000
103900         WHEN SQLCODE = +100                                      10390000
104000              MOVE '??'      TO RECEIV-STATUS-CDE                 10400000
104100                                                                  10410000
104200         WHEN SQLWARN0 NOT = SPACE                                10420000
104300         WHEN SQLCODE < ZERO                                      10430000
104400         WHEN SQLCODE > ZERO                                      10440000
104500             MOVE SUT00028-TRN-NBR                                10450000
104600                                      TO PV-DISP-PO               10460000
104700             MOVE SUT00028-RCVR-SEQ-NBR                           10470000
104800                                      TO PV-DISP-RECV             10480000
104900             MOVE '7140-SELECT-RECEIVER-STATUS'                   10490000
105000                                      TO DP013-PARAGRAPH          10500000
105100             MOVE 'GET RCVR STATUS    '                           10510000
105200                                      TO DP013-MESSAGE-TEXT (1)   10520000
105300             MOVE SQLCA               TO DP013-SQLCA              10530000
105400             MOVE 'TRECEIV'           TO DP013-DB2-TABLE-NAME (1) 10540000
105500             STRING 'PO = '  PV-DISP-PO                           10550000
105600                    ' REC = ' PV-DISP-RECV                        10560000
105700                    DELIMITED BY SIZE                             10570000
105800                                    INTO DP013-MESSAGE-TEXT (2)   10580000
105900             SET DP013-NO-ROLLBACK                                10590000
106000                 DP013-DB2-ABEND      TO TRUE                     10600000
106100             PERFORM 9999-WRITE-CICS-LOG-MSG                      10610000
106200     END-EVALUATE.                                                10620000
106300                                                                  10630000
120200 7200-SEL-DPT-SCL-VS-NBR.                                         12020000
120300     MOVE SUT00028-UPC-NBR            TO XLV00003-UPC-NBR.        12030000
120400     PERFORM 7210-SELECT-STYL-BY-UPC.                             12040000
120500     PERFORM 7220-SELECT-VEND-STYL.                               12050000
120600                                                                  12060000
120700 7210-SELECT-STYL-BY-UPC.                                         12070000
120800     EXEC SQL                                                     12080000
120900         SELECT B.STYL_ID                                         12090000
121000         INTO :XLT00003-STYL-ID                                   12100000
121100         FROM                                                     12110000
121200            XLV_UPC A                                             12120000
121300          , XLT_SKU B                                             12130000
121400         WHERE UPC_NBR = :XLV00003-UPC-NBR                        12140000
121500          AND A.INTR_UPC_ID = B.INTR_UPC_ID                       12150000
121600         WITH UR                                                  12160000
121700     END-EXEC.                                                    12170000
121800                                                                  12180000
121900     EVALUATE TRUE                                                12190000
122000         WHEN SQLCODE = ZERO                                      12200000
122100             CONTINUE                                             12210000
122200         WHEN SQLWARN0 NOT = SPACE                                12220000
122300         WHEN SQLCODE < ZERO                                      12230000
122400         WHEN SQLCODE > ZERO                                      12240000
122500             MOVE '7210-SELECT-STYL-BY-UPC'                       12250000
122600                                      TO DP013-PARAGRAPH          12260000
122700             MOVE 'SELECT STYLE BY UPD'                           12270000
122800                                      TO DP013-MESSAGE-TEXT (1)   12280000
122900             MOVE SQLCA               TO DP013-SQLCA              12290000
123000             MOVE 'XLV_UPC'           TO DP013-DB2-TABLE-NAME (1) 12300000
123100             MOVE 'XLT_SKU'           TO DP013-DB2-TABLE-NAME (2) 12310000
123200             SET DP013-NO-ROLLBACK                                12320000
123300                 DP013-DB2-ABEND      TO TRUE                     12330000
123400             PERFORM 9999-WRITE-CICS-LOG-MSG                      12340000
123500     END-EVALUATE.                                                12350000
123600                                                                  12360000
123700 7220-SELECT-VEND-STYL.                                           12370000
123800     EXEC SQL                                                     12380000
123900         SELECT A.DEPT_NBR                                        12390000
124000              , A.SUB_CL_NBR                                      12400000
124100              , A.VS_NBR                                          12410000
124200         INTO :XLV00001-DEPT-NBR                                  12420000
124300            , :XLV00001-SUB-CL-NBR                                12430000
124400            , :XLV00001-VS-NBR                                    12440000
124500         FROM                                                     12450000
124600            XLV_VND_STYL A                                        12460000
124700         WHERE STYL_ID = :XLT00003-STYL-ID                        12470000
124800         WITH UR                                                  12480000
124900     END-EXEC.                                                    12490000
125000                                                                  12500000
125100     EVALUATE TRUE                                                12510000
125200         WHEN SQLCODE = ZERO                                      12520000
125300             CONTINUE                                             12530000
125400         WHEN SQLCODE = +100                                      12540000
125500            CONTINUE                                              12550000
125600         WHEN SQLWARN0 NOT = SPACE                                12560000
125700         WHEN SQLCODE < ZERO                                      12570000
125800         WHEN SQLCODE > ZERO                                      12580000
125900             MOVE '7220-SELECT-VEND-STYL'                         12590000
126000                                      TO DP013-PARAGRAPH          12600000
126100             MOVE 'SELECT VENDOR STYLE'                           12610000
126200                                      TO DP013-MESSAGE-TEXT (1)   12620000
126300             MOVE SQLCA               TO DP013-SQLCA              12630000
126400             MOVE 'XLV_VND_STYL  '    TO DP013-DB2-TABLE-NAME (1) 12640000
126500             MOVE  DK-SHIPT-UNT-ID    TO DP013-MESSAGE-TEXT (2)   12650000
126600             SET DP013-NO-ROLLBACK                                12660000
126700                 DP013-DB2-ABEND      TO TRUE                     12670000
126800             PERFORM 9999-WRITE-CICS-LOG-MSG                      12680000
126900     END-EVALUATE.                                                12690000
127000                                                                  12700000
127100*CLP 06/05/13 PR#5148B START                                      12710009
127259 7300-CHECK-DEPT-CLASS.                                           12725900
127260     MOVE XLV00001-DEPT-NBR           TO PV-DEPT-NBR-N.           12726000
127300     MOVE PV-DEPT-NBR-N               TO DK-DEPT-NBR.             12730000
127400     MOVE XLV00001-SUB-CL-NBR         TO PV-SUB-CL-NBR-N.         12740000
127500     MOVE PV-SUB-CL-NBR-N             TO DK-SUBCLASS-NBR.         12750000
127600                                                                  12760000
127700     EXEC SQL                                                     12770000
127800         SELECT A.INCLN_CDE                                       12780000
127900           INTO :RIT00000-INCLN-CDE                               12790000
128000           FROM RIT_RFID_VRFN A                                   12800000
128100          WHERE A.RFID_LVL_CDE = 'DPTSCL'                         12810000
128200            AND A.DEPT_NBR     = :DK-DEPT-NBR                     12820000
128300            AND A.STR_NBR     =0                                  12830000
128400            AND A.DC_LOC_NBR  =0                                  12840000
128500            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              12850000
128600            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              12860000
128700         WITH UR                                                  12870000
128800     END-EXEC.                                                    12880000
128900     EVALUATE TRUE                                                12890000
129000         WHEN SQLCODE = ZERO                                      12900000
129100         WHEN SQLCODE = -811                                      12910000
129200            EVALUATE TRUE                                         12920009
129300              WHEN RIT00000-INCLN-CDE  = 'N'                      12930000
129400                  SET PS-DEPT-SUBCL-RFID-YES TO TRUE              12940000
129500              WHEN RIT00000-INCLN-CDE  = 'E'                      12950000
129600                  PERFORM 7310-CHECK-DPT-SUBCL-EXCEPT             12960000
129700              WHEN RIT00000-INCLN-CDE  = 'I'                      12970000
129800                  PERFORM 7350-CHECK-DPT-SUBCL-INCLUTON           12980000
129900              WHEN OTHER                                          12990000
130000                  MOVE '7300-CHECK-DEPT-CLASS'                    13000000
130100                                      TO DP013-PARAGRAPH          13010000
130200                 MOVE 'CHECK DEPARTMENT CLASS FOR RFID'           13020000
130300                                       TO DP013-MESSAGE-TEXT (1)  13030000
130400                 MOVE XL001-SQLCA         TO DP013-SQLCA          13040000
130500                 MOVE 'RIT_RFID_VRFN' TO DP013-DB2-TABLE-NAME (1) 13050009
130600                 SET DP013-NO-ROLLBACK                            13060000
130700                 DP013-DB2-ABEND      TO TRUE                     13070000
130800                 SET PS-XL-MOD-ERROR      TO TRUE                 13080000
130900                 PERFORM 9999-WRITE-CICS-LOG-MSG                  13090000
131000                                                                  13100000
131100            END-EVALUATE                                          13110000
131200                                                                  13120000
131300     END-EVALUATE.                                                13130000
131400                                                                  13140000
131500 7310-CHECK-DPT-SUBCL-EXCEPT.                                     13150000
131600     EXEC SQL                                                     13160000
131700         SELECT A.INCLN_CDE                                       13170000
131800           INTO :RIT00000-INCLN-CDE                               13180000
131900           FROM RIT_RFID_VRFN A                                   13190000
132000          WHERE A.RFID_LVL_CDE = 'DPTSCL'                         13200000
132100            AND A.STR_NBR      =0                                 13210000
132200            AND A.DC_LOC_NBR   =0                                 13220000
132300            AND A.DEPT_NBR     = :DK-DEPT-NBR                     13230000
132400            AND A.SUB_CL_NBR   = :DK-SUBCLASS-NBR                 13240000
132500            AND A.INCLN_CDE    = 'E'                              13250000
132600            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              13260000
132700            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              13270000
132800         WITH UR                                                  13280000
132900     END-EXEC.                                                    13290000
133000                                                                  13300000
133100     EVALUATE TRUE                                                13310000
133200        WHEN SQLCODE = ZERO                                       13320000
133300        WHEN SQLCODE = -811                                       13330000
133400             SET PS-DEPT-SUBCL-RFID-NO TO TRUE                    13340000
133500                                                                  13350000
133600        WHEN SQLCODE = +100                                       13360000
133700             SET PS-DEPT-SUBCL-RFID-YES TO TRUE                   13370000
133800         WHEN OTHER                                               13380000
133900              MOVE '7310-CHECK-DPT-SUBCL-EXCEPT'                  13390000
134000                                       TO DP013-PARAGRAPH         13400000
134100              MOVE 'CHECK-DPT-SUBCL-EXCEPT'                       13410000
134200                                       TO DP013-MESSAGE-TEXT (1)  13420000
134300              MOVE SQLCA               TO DP013-SQLCA             13430000
134400              MOVE 'RIT_RFID_VRFN'     TO DP013-DB2-TABLE-NAME (1)13440000
134500              SET DP013-NO-ROLLBACK                               13450000
134600                  DP013-DB2-ABEND      TO TRUE                    13460000
134700              PERFORM 9999-WRITE-CICS-LOG-MSG                     13470000
134800     END-EVALUATE.                                                13480000
134900                                                                  13490000
135000 7350-CHECK-DPT-SUBCL-INCLUTON.                                   13500009
135100                                                                  13510000
135200      EXEC SQL                                                    13520000
135300         SELECT A.INCLN_CDE                                       13530000
135400           INTO :RIT00000-INCLN-CDE                               13540000
135500           FROM RIT_RFID_VRFN A                                   13550000
135600          WHERE A.RFID_LVL_CDE = 'DPTSCL'                         13560000
135700            AND A.STR_NBR      =0                                 13570000
135800            AND A.DC_LOC_NBR   =0                                 13580000
135900            AND A.DEPT_NBR     = :DK-DEPT-NBR                     13590000
136000            AND A.SUB_CL_NBR   = :DK-SUBCLASS-NBR                 13600000
136100            AND A.INCLN_CDE    = 'I'                              13610000
136200            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              13620000
136300            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              13630000
136400         WITH UR                                                  13640000
136500     END-EXEC.                                                    13650000
136600                                                                  13660000
136700     EVALUATE TRUE                                                13670000
136800         WHEN SQLCODE = ZERO                                      13680000
136900         WHEN SQLCODE = -811                                      13690000
137000              SET PS-DEPT-SUBCL-RFID-YES TO TRUE                  13700000
137100                                                                  13710000
137200         WHEN SQLCODE = +100                                      13720000
137300              SET PS-DEPT-SUBCL-RFID-NO   TO TRUE                 13730000
137400         WHEN OTHER                                               13740000
137500              MOVE '7350-CHECK-DPT-SUBCL-INCLUTON'                13750000
137600                                       TO DP013-PARAGRAPH         13760000
137700              MOVE 'CHECK-DPT-SUBCL-INCLUTON'                     13770000
137800                                       TO DP013-MESSAGE-TEXT (1)  13780000
137900              MOVE SQLCA               TO DP013-SQLCA             13790000
138000              MOVE 'RIT_RFID_VRFN'     TO DP013-DB2-TABLE-NAME (1)13800000
138100              SET DP013-NO-ROLLBACK                               13810000
138200                  DP013-DB2-ABEND      TO TRUE                    13820000
138300              PERFORM 9999-WRITE-CICS-LOG-MSG                     13830000
138400     END-EVALUATE.                                                13840000
138500                                                                  13850000
138600 7400-CHECK-IF-RFID-DC.                                           13860000
138700                                                                  13870000
138800     MOVE SU033-OPER-UNT-ID TO DK-LOC-NBR.                        13880000
138900                                                                  13890000
139000     EXEC SQL                                                     13900009
139100     SELECT A.DC_LOC_NBR                                          13910000
139200       INTO :RIT00000-DC-LOC-NBR                                  13920000
139300       FROM RIT_RFID_VRFN  A                                      13930000
139400      WHERE A.DC_LOC_NBR    = :DK-LOC-NBR                         13940000
139500        AND A.STR_NBR       = 0                                   13950000
139600        AND A.DEPT_NBR      = 0                                   13960000
139700        AND A.SUB_CL_NBR    = 0                                   13970000
139800        AND A.RFID_LVL_CDE  = 'RFIDDC'                            13980000
139900        AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP                  13990000
140000        AND A.EFF_END_TMST   > CURRENT_TIMESTAMP                  14000000
140100     WITH UR                                                      14010000
140200     END-EXEC.                                                    14020000
140300                                                                  14030000
140400     EVALUATE TRUE                                                14040000
140500         WHEN SQLCODE = ZERO                                      14050000
140600             SET PS-DC-RFID-YES TO TRUE                           14060000
140700         WHEN SQLCODE = +100                                      14070000
140800             SET PS-DC-RFID-NO  TO TRUE                           14080000
140900         WHEN OTHER                                               14090000
141000             MOVE '7400-CHECK-IF-RFID-DC'                         14100000
141100                                      TO DP013-PARAGRAPH          14110000
141200             MOVE 'CHECK DC FOR RIFD'                             14120000
141300                                      TO DP013-MESSAGE-TEXT (1)   14130000
141400             MOVE SQLCA               TO DP013-SQLCA              14140000
141510              MOVE 'RIT_RFID_VRFN' TO DP013-DB2-TABLE-NAME (1)    14151009
141600             SET DP013-NO-ROLLBACK                                14160000
141700                 DP013-DB2-ABEND      TO TRUE                     14170000
141800             PERFORM 9999-WRITE-CICS-LOG-MSG                      14180000
141900     END-EVALUATE.                                                14190000
142000                                                                  14200000
142020*************************************************************     14202000
142030***  CHECK DEPT FOR RFID VERIFICATION-DON'T DO WHEN THE CARTON    14203000
142040***  IS A PACK TO LIGHT CARTON                                    14204000
142050*************************************************************     14205000
142060 7500-CHECK-IF-RFID-STORE.                                        14206000
142070                                                                  14207000
142080     MOVE SUT00024-DEST-LOC-NBR TO DK-LOC-NBR.                    14208000
142090                                                                  14209000
142091     SET  PS-STORE-RFID-NO      TO TRUE.                          14209100
142092                                                                  14209200
142095     EXEC SQL                                                     14209500
142096         SELECT DISTINCT(A.INCLN_CDE)                             14209600
142097           INTO :RIT00000-INCLN-CDE                               14209700
142098           FROM RIT_RFID_VRFN  A                                  14209800
142099          WHERE A.STR_NBR        = :DK-LOC-NBR                    14209900
142100            AND A.DC_LOC_NBR     =0                               14210000
142101            AND A.SUB_CL_NBR     =0                               14210100
142102            AND A.RFID_LVL_CDE   = 'STRDPT'                       14210200
142103            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              14210300
142104            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              14210400
142105         WITH UR                                                  14210500
142106     END-EXEC.                                                    14210600
142107                                                                  14210700
142108     EVALUATE TRUE                                                14210800
142109         WHEN SQLCODE = ZERO                                      14210900
142110           EVALUATE TRUE                                          14211000
142111              WHEN RIT00000-INCLN-CDE = 'N'                       14211100
142112                  SET PS-STORE-RFID-YES  TO TRUE                  14211200
142113              WHEN RIT00000-INCLN-CDE = 'E'                       14211300
142114                  PERFORM 7510-CHK-EXCLDED-DPT-WTHIN-STR          14211400
142115              WHEN RIT00000-INCLN-CDE = 'I'                       14211500
142116                  PERFORM 7520-CHK-INCLDED-DPT-WTHIN-STR          14211600
142117              WHEN OTHER                                          14211700
142118                 MOVE '7500-CHECK-IF-RFID-STORE'                  14211800
142119                                      TO DP013-PARAGRAPH          14211900
142120                 MOVE 'INVALID INCLUSION CODE '                   14212000
142121                                      TO DP013-MESSAGE-TEXT (1)   14212100
142123                 MOVE 'RIT_RFID_VRFN' TO DP013-DB2-TABLE-NAME (1) 14212300
142124                 SET DP013-NO-ROLLBACK                            14212400
142125                     DP013-DB2-ABEND  TO TRUE                     14212500
142126                 SET PS-XL-MOD-ERROR  TO TRUE                     14212600
142127                 PERFORM 9999-WRITE-CICS-LOG-MSG                  14212700
142131           END-EVALUATE                                           14213100
142132         WHEN SQLCODE = +100                                      14213200
142133              SET PS-STORE-RFID-NO    TO TRUE                     14213300
142135         WHEN OTHER                                               14213500
142136              MOVE '7500-CHECK-IF-RFID-STORE'                     14213600
142137                                   TO DP013-PARAGRAPH             14213700
142138              MOVE 'UNABLE TO FETCH INCL CODE BY STORE'           14213800
142139                                   TO DP013-MESSAGE-TEXT (1)      14213900
142140              MOVE XL001-SQLCA     TO DP013-SQLCA                 14214000
142141              MOVE 'RIT_RFID_VRFN' TO DP013-DB2-TABLE-NAME (1)    14214100
142142              SET DP013-NO-ROLLBACK                               14214200
142143                  DP013-DB2-ABEND  TO TRUE                        14214300
142144              SET PS-XL-MOD-ERROR  TO TRUE                        14214400
142145              PERFORM 9999-WRITE-CICS-LOG-MSG                     14214500
142146     END-EVALUATE.                                                14214600
142147                                                                  14214700
142148*************************************************************     14214800
142149***  CHECK DEPT WITHIN STORE FOR RFID VERIFICATION WHEN THER ARE  14214900
142150***  NO INCLUSIONS OR EXCLUSIONS ON RIT_RFID_VRFN                 14215000
142151*************************************************************     14215100
142152*************************************************************     14215200
142153***  CHECK DEPT WITHIN STORE FOR RFID VERIFICATION WHEN INCLN_CDE 14215300
142154***  = 'E' FOR EXCLUDED.                                          14215400
142155*************************************************************     14215500
142156 7510-CHK-EXCLDED-DPT-WTHIN-STR.                                  14215600
142157                                                                  14215700
142158     MOVE SUT00024-DEST-LOC-NBR TO DK-LOC-NBR.                    14215800
142159                                                                  14215900
142160     SET  PS-STORE-RFID-YES     TO TRUE.                          14216000
142161                                                                  14216100
142164     EXEC SQL                                                     14216400
142165         SELECT A.INCLN_CDE                                       14216500
142166           INTO :RIT00000-INCLN-CDE                               14216600
142167           FROM RIT_RFID_VRFN  A                                  14216700
142168          WHERE A.STR_NBR        = :DK-LOC-NBR                    14216800
142169            AND A.DEPT_NBR       = :XLV00001-DEPT-NBR             14216900
142170            AND A.SUB_CL_NBR     =0                               14217000
142171            AND A.DC_LOC_NBR     =0                               14217100
142172            AND A.RFID_LVL_CDE   = 'STRDPT'                       14217200
142173            AND A.INCLN_CDE      = 'E'                            14217300
142174            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              14217400
142175            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              14217500
142176         WITH UR                                                  14217600
142177     END-EXEC.                                                    14217700
142178                                                                  14217800
142179     EVALUATE TRUE                                                14217900
142180         WHEN SQLCODE = ZERO                                      14218000
142181              SET PS-STORE-RFID-NO  TO TRUE                       14218100
142183         WHEN SQLCODE = +100                                      14218300
142184              SET PS-STORE-RFID-YES TO TRUE                       14218400
142186         WHEN OTHER                                               14218600
142187              MOVE '7510-CHK-EXCLDED-DPT-WTHIN-STR'               14218700
142188                                   TO DP013-PARAGRAPH             14218800
142189              MOVE 'UNABLE TO FETCH INCL CODE BY STORE DEPT'      14218900
142190                                   TO DP013-MESSAGE-TEXT (1)      14219000
142191              MOVE XL001-SQLCA     TO DP013-SQLCA                 14219100
142192              MOVE 'RIT_RFID_VRFN' TO DP013-DB2-TABLE-NAME (1)    14219200
142193              SET DP013-NO-ROLLBACK                               14219300
142194                  DP013-DB2-ABEND  TO TRUE                        14219400
142195              SET PS-XL-MOD-ERROR  TO TRUE                        14219500
142196              PERFORM 9999-WRITE-CICS-LOG-MSG                     14219600
142200     END-EVALUATE.                                                14220000
142201                                                                  14220100
142202*************************************************************     14220200
142203***  CHECK DEPT WITHIN STORE FOR RFID VERIFICATION WHEN INCLN_CDE 14220300
142204***  = 'I' FOR INCLUDED.                                          14220400
142205*************************************************************     14220500
142206 7520-CHK-INCLDED-DPT-WTHIN-STR.                                  14220600
142207                                                                  14220700
142208     MOVE SUT00024-DEST-LOC-NBR TO DK-LOC-NBR.                    14220800
142209                                                                  14220900
142210     SET  PS-STORE-RFID-NO      TO TRUE.                          14221000
142211                                                                  14221100
142214     EXEC SQL                                                     14221400
142215         SELECT A.INCLN_CDE                                       14221500
142216           INTO :RIT00000-INCLN-CDE                               14221600
142217           FROM RIT_RFID_VRFN  A                                  14221700
142218          WHERE A.STR_NBR        = :DK-LOC-NBR                    14221800
142219            AND A.DEPT_NBR       = :XLV00001-DEPT-NBR             14221900
142220            AND A.SUB_CL_NBR     =0                               14222000
142221            AND A.DC_LOC_NBR     =0                               14222100
142222            AND A.RFID_LVL_CDE   = 'STRDPT'                       14222200
142223            AND A.INCLN_CDE      = 'I'                            14222300
142224            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              14222400
142225            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              14222500
142226         WITH UR                                                  14222600
142227     END-EXEC.                                                    14222700
142228                                                                  14222800
142229     EVALUATE TRUE                                                14222900
142230         WHEN SQLCODE = ZERO                                      14223000
142231              SET PS-STORE-RFID-YES  TO TRUE                      14223100
142233         WHEN SQLCODE = +100                                      14223300
142234              SET PS-STORE-RFID-NO   TO TRUE                      14223400
142236         WHEN OTHER                                               14223600
142237              MOVE '7520-CHK-INCLDED-DPT-WTHIN-STR'               14223700
142238                                   TO DP013-PARAGRAPH             14223800
142239              MOVE 'UNABLE TO FETCH INCL CODE BY STORE DEPT'      14223900
142240                                   TO DP013-MESSAGE-TEXT (1)      14224000
142241              MOVE XL001-SQLCA     TO DP013-SQLCA                 14224100
142242              MOVE 'RIT_RFID_VRFN' TO DP013-DB2-TABLE-NAME (1)    14224200
142243              SET DP013-NO-ROLLBACK                               14224300
142244                  DP013-DB2-ABEND  TO TRUE                        14224400
142245              SET PS-XL-MOD-ERROR  TO TRUE                        14224500
142246              PERFORM 9999-WRITE-CICS-LOG-MSG                     14224600
142250     END-EVALUATE.                                                14225000
142251*CLP 06/05/13 PR#5148B END                                        14225109
142253                                                                  14225300
142260 8000-LINK-TO-DRS.                                                14226000
142300* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     14230000
142400                                                                  14240000
142500*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        14250000
142600*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          14260000
142700*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              14270000
142800     EXEC CICS                                                    14280000
142900         LINK                                                     14290000
143000             PROGRAM   ('DRS1INTC')                               14300000
143100             COMMAREA  (DRS01-COMMAREA)                           14310000
143200     END-EXEC.                                                    14320000
143300                                                                  14330000
143400     EVALUATE TRUE                                                14340000
143500         WHEN DRS01-DRRB-RC = ZERO                                14350000
143600             CONTINUE                                             14360000
143700         WHEN OTHER                                               14370000
143800             MOVE '8000-LINK-TO-DRS'    TO DP013-PARAGRAPH        14380000
143900             SET DP013-OTHER-ABEND      TO TRUE                   14390000
144000             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       14400000
144100             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        14410000
144200             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    14420000
144300             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         14430000
144400             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      14440000
144500             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       14450000
144600             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      14460000
144700             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      14470000
144800                 TO DP013-MESSAGE-TEXT (1)                        14480000
144900             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      14490000
145000                 TO DP013-MESSAGE-TEXT (2)                        14500000
145100             SET DP013-LINK-RETURN      TO TRUE                   14510000
145200             PERFORM DP013-0000-PROCESS-ABEND                     14520000
145300             GO TO 0000-GOBACK                                    14530000
145400     END-EVALUATE.                                                14540000
145500/                                                                 14550000
145600 8100-PRINT-HEADINGS.                                             14560000
145700     MOVE PC-PUT                      TO DRS01-DRRB-FUNC          14570000
145800     MOVE PV-PAGE-COUNT               TO DP132-PAGE-NUMBER        14580000
145900                                                                  14590000
146000     MOVE DP132-STANDRD-HEADER-132-COLS                           14600000
146100                                      TO DRS01-COMM-DATA.         14610000
146200     MOVE PC-TOP-OF-PAGE              TO DRS01-COMM-CTL.          14620000
146300     PERFORM 8000-LINK-TO-DRS.                                    14630000
146400                                                                  14640000
146500     MOVE HL1-HEADING-LINE            TO DRS01-COMM-DATA.         14650000
146600     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          14660000
146700     PERFORM 8000-LINK-TO-DRS.                                    14670000
146800                                                                  14680000
146900     MOVE HL2-HEADING-LINE            TO DRS01-COMM-DATA          14690000
147000     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          14700000
147100     PERFORM 8000-LINK-TO-DRS.                                    14710000
147200                                                                  14720000
147300     MOVE HL3-HEADING-LINE            TO DRS01-COMM-DATA          14730000
147400     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          14740000
147500     PERFORM 8000-LINK-TO-DRS.                                    14750000
147600                                                                  14760000
147700     MOVE HL4-HEADING-LINE            TO DRS01-COMM-DATA          14770000
147800     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          14780000
147900     PERFORM 8000-LINK-TO-DRS.                                    14790000
148000                                                                  14800000
148010     MOVE HL5-HEADING-LINE            TO DRS01-COMM-DATA          14801011
148020     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          14802011
148030     PERFORM 8000-LINK-TO-DRS.                                    14803011
148040                                                                  14804011
148100     MOVE DH1-DETAIL-HEADING-1        TO DRS01-COMM-DATA          14810000
148200     MOVE PC-DOUBLE-SPACE             TO DRS01-COMM-CTL.          14820000
148300     PERFORM 8000-LINK-TO-DRS.                                    14830000
148400     MOVE 10                          TO PV-LINE-COUNT.           14840011
148500/                                                                 14850000
148600 8200-CALL-PCKUT713.                                              14860000
148700                                                                  14870000
148800     CALL PC046-CARTON-STATUS-MODULE                              14880000
148900             USING DFHEIBLK                                       14890000
149000             PC046-COMMAREA                                       14900000
149100             PC046-COMMAREA-REC                                   14910000
149200     END-CALL.                                                    14920000
149300                                                                  14930000
149400     EVALUATE TRUE                                                14940000
149500     WHEN PC046-SUCCESSFUL                                        14950000
149600         CONTINUE                                                 14960000
149700     WHEN OTHER                                                   14970000
149800         SET PS-ERROR-YES             TO TRUE                     14980000
149900     END-EVALUATE.                                                14990000
150000                                                                  15000000
150100 8300-CALL-XLKUT001.                                              15010000
150200     INITIALIZE  XL001-ITEM-COMMAREA.                             15020000
150300                                                                  15030000
150400     MOVE SUT00028-UPC-NBR            TO XL001-KEY-UPC-NBR.       15040000
150410*    MOVE PC046-DEST-OPER-UNT-ID      TO XL001-KEY-STR-NBR.       15041023
150500                                                                  15050000
150600     SET XL001-BY-UPC-NBR                                         15060000
150700         XL001-SELECT-SKU                                         15070000
150800         XL001-SELECT-VND-STYL                                    15080000
150900         XL001-SELECT-SKU-STR TO TRUE.                            15090000
151000                                                                  15100000
151100     CALL XL001-VSM-PGM USING  DFHEIBLK                           15110000
151200                               XL001-COMMAREA                     15120000
151300                               XL001-ITEM-COMMAREA.               15130000
151400                                                                  15140000
151500     EVALUATE TRUE                                                15150000
151600         WHEN XL001-SUCCESSFUL                                    15160000
151700         WHEN XL001-SKU-NOT-FOUND                                 15170000
151800         WHEN XL001-UPC-NOT-FOUND                                 15180000
151810         WHEN XL001-SKU-STR-NOT-FOUND                             15181022
151900             CONTINUE                                             15190000
152000         WHEN XL001-SQL-ERROR                                     15200000
152010             MOVE SUT00028-UPC-NBR    TO  PV-DISP-UPC             15201019
152100             MOVE PC046-DEST-OPER-UNT-ID TO  PV-DISP-STR          15210021
152110             MOVE '8300-CALL-XLKUT001'                            15211020
152200                                      TO DP013-PARAGRAPH          15220000
152300             INITIALIZE DP013-MESSAGE-TEXT (1)                    15230000
152400             STRING 'CALL XLKUT001 ITEM MODULE - '                15240000
152500                    'PARAGRAPH=' XL001-ERROR-PARAGRAPH-NBR        15250000
152600                                         DELIMITED BY SIZE        15260000
152700                                    INTO DP013-MESSAGE-TEXT (1)   15270000
152800             INITIALIZE DP013-MESSAGE-TEXT (2)                    15280000
152900             MOVE XL001-SKU-SQLCODE       TO  PV-SQLCODE-1        15290000
153000             MOVE XL001-VND-STYL-SQLCODE  TO  PV-SQLCODE-2        15300000
153100             MOVE XL001-SKU-STR-SQLCODE   TO  PV-SQLCODE-3        15310000
153200             MOVE XL001-UPC-SQLCODE       TO  PV-SQLCODE-4        15320000
153300             MOVE XL001-WEB-SKU-SQLCODE   TO  PV-SQLCODE-5        15330000
153400             STRING 'SQL: '                                       15340020
153500                    ' SKU='       PV-SQLCODE-1 '  '               15350000
153600                    ' VND-STYL='  PV-SQLCODE-2 '  '               15360000
153610                    ' UPC:'       PV-DISP-UPC                     15361019
153620                    ' STR:'       PV-DISP-STR                     15362020
153700                                         DELIMITED BY SIZE        15370000
153800                                    INTO DP013-MESSAGE-TEXT (2)   15380000
153900             INITIALIZE DP013-MESSAGE-TEXT (3)                    15390000
154000             STRING 'SQL: '                                       15400020
154100                    ' SKU-STR='   PV-SQLCODE-3 '  '               15410000
154200                    ' UPC='       PV-SQLCODE-4 '  '               15420000
154300                    ' WEB-SKU='   PV-SQLCODE-5                    15430000
154400                                         DELIMITED BY SIZE        15440000
154500                                    INTO DP013-MESSAGE-TEXT (3)   15450000
154600             MOVE XL001-SQLCA         TO DP013-SQLCA              15460000
154700             MOVE 'XLKUT001'          TO DP013-DB2-TABLE-NAME (1) 15470000
154800             SET DP013-NO-ROLLBACK                                15480000
154900                 DP013-DB2-ABEND      TO TRUE                     15490000
155000             SET PS-XL-MOD-ERROR      TO TRUE                     15500000
155100             PERFORM 9999-WRITE-CICS-LOG-MSG                      15510000
155200         WHEN OTHER                                               15520000
155300             MOVE '8300-CALL-XLKUT001'                            15530000
155400                                      TO DP013-PARAGRAPH          15540000
155500             MOVE 'CALL XLKUT001 ITEM MODULE'                     15550000
155600                                      TO DP013-MESSAGE-TEXT (1)   15560000
155700             MOVE 'INVALID ACCESS'                                15570000
155800                                      TO DP013-MESSAGE-TEXT (2)   15580000
155900             MOVE XL001-SQLCA         TO DP013-SQLCA              15590000
156000             MOVE 'XLKUT001'          TO DP013-DB2-TABLE-NAME (1) 15600000
156100             SET DP013-NO-ROLLBACK                                15610000
156200                 DP013-DB2-ABEND      TO TRUE                     15620000
156300             SET PS-XL-MOD-ERROR      TO TRUE                     15630000
156400             PERFORM 9999-WRITE-CICS-LOG-MSG                      15640000
156500     END-EVALUATE.                                                15650000
156600/                                                                 15660000
156700 9999-WRITE-CICS-LOG-MSG.                                         15670000
156800                                                                  15680000
156900     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              15690000
157000     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             15700000
157100                                                                  15710000
157200     MOVE PC-PUT                   TO  DRS01-DRRB-FUNC.           15720000
157300                                                                  15730000
157400                                                                  15740000
157500                                                                  15750000
157600     MOVE PC-ABEND-MESSAGE         TO  DRS01-COMM-DATA.           15760000
157700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15770000
157800     PERFORM 8000-LINK-TO-DRS.                                    15780000
157900                                                                  15790000
158000     MOVE DP013-PARAGRAPH          TO  DRS01-COMM-DATA.           15800000
158100     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15810000
158200     PERFORM 8000-LINK-TO-DRS.                                    15820000
158300     MOVE DP013-MESSAGE-TEXT (1)   TO  DRS01-COMM-DATA.           15830000
158400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15840000
158500     PERFORM 8000-LINK-TO-DRS.                                    15850000
158600     MOVE DP013-MESSAGE-TEXT (2)   TO  DRS01-COMM-DATA.           15860000
158700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15870000
158800     PERFORM 8000-LINK-TO-DRS.                                    15880000
158900     MOVE DP013-MESSAGE-TEXT (3)   TO  DRS01-COMM-DATA.           15890000
159000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15900000
159100     PERFORM 8000-LINK-TO-DRS.                                    15910000
159200     MOVE DP013-DB2-TABLE-NAME (1) TO  DRS01-COMM-DATA.           15920000
159300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15930000
159400     PERFORM 8000-LINK-TO-DRS.                                    15940000
159500     MOVE DP013-DB2-TABLE-NAME (2) TO  DRS01-COMM-DATA.           15950000
159600     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15960000
159700     PERFORM 8000-LINK-TO-DRS.                                    15970000
159800     MOVE DP013-DB2-TABLE-NAME (3) TO  DRS01-COMM-DATA.           15980000
159900     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            15990000
160000     PERFORM 8000-LINK-TO-DRS.                                    16000000
160100     MOVE SQLCODE TO PV-SQLCODE.                                  16010000
160200     MOVE PV-SQLCODE-NUMBER        TO  DRS01-COMM-DATA.           16020000
160300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            16030000
160400     PERFORM 8000-LINK-TO-DRS.                                    16040000
160500                                                                  16050000
160600     SET DP013-LINK-RETURN         TO TRUE.                       16060000
160700     PERFORM DP013-0000-PROCESS-ABEND.                            16070000
160800                                                                  16080000
160900     COPY DPPD013.                                                16090000
161000/                                                                 16100000
