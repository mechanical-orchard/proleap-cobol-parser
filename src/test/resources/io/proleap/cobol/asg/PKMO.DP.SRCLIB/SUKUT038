000100***************************************************************** 00010007
000200 IDENTIFICATION DIVISION.                                         00020007
000300***************************************************************** 00030007
000400                                                                  00040007
000500 PROGRAM-ID.             SUKUT038.                                00050007
000600 AUTHOR.                 RON KRIER.                               00060007
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070007
000800 DATE-WRITTEN            AUGUST, 2000.                            00080007
000900 DATE-COMPILED.                                                   00090007
001000***************************************************************** 00100007
001100***************************************************************** 00110007
001200*                                                               * 00120007
001300*  THIS PROGRAM WILL TAKE IN THE EXTRACT FILE FROM THE SUKUT001 * 00130007
001400*  PROGRAM (THE EXTRACT OF CARTON INFORMATION FOR A SELECTED    * 00140007
001500*  TRIP) AND COMBINE THE MULTIPLE RECORDS FOR A CARTON INTO     * 00150007
001600*  1 RECORD THAT CAN BE USED FOR FURTHER PROCESSING.            * 00160007
001700*                                                               * 00170007
001800***************************************************************** 00180007
001900*  CHANGED ON 10/24/02 BY ALBERT A VINOD                        * 00190007
002000*  WR# 21361 REMOVED GROUP VARIABLE PV-SKU                      * 00200007
      *                                                               * 00200111
001900*  CHANGED ON 10/14/14 BY CHERI PARMLEY                         * 00201011
002000*  CHG#0094517 COMMENTED OUT PO VARIABLES NOT USED IN PGM       * 00202011
002100***************************************************************** 00210007
002200***************************************************************** 00220007
002300 ENVIRONMENT DIVISION.                                            00230007
002400***************************************************************** 00240007
002500                                                                  00250007
002600 CONFIGURATION SECTION.                                           00260007
002700                                                                  00270007
002800 SOURCE-COMPUTER.        IBM-3090.                                00280007
002900 OBJECT-COMPUTER.        IBM-3090.                                00290007
003000                                                                  00300007
003100 INPUT-OUTPUT SECTION.                                            00310007
003200                                                                  00320007
003300 FILE-CONTROL.                                                    00330007
003400*                                                                 00340007
003500     SELECT EXTRACT-FILE                                          00350007
003600         ASSIGN TO INP01.                                         00360007
003700                                                                  00370007
003800     SELECT EXTRACT-FILE-OUT                                      00380007
003900         ASSIGN TO OUT01.                                         00390007
004000*                                                                 00400007
004100***************************************************************** 00410007
004200 DATA DIVISION.                                                   00420007
004300***************************************************************** 00430007
004400*                                                                 00440007
004500 FILE SECTION.                                                    00450007
004600*                                                                 00460007
004700 FD  EXTRACT-FILE                                                 00470007
004800     LABEL RECORDS ARE STANDARD                                   00480007
004900     RECORDING MODE IS F                                          00490007
005000     BLOCK CONTAINS 0 RECORDS                                     00500007
005100     RECORD CONTAINS 200 CHARACTERS.                              00510007
005200 01  EXTRACT-RECORD                  PIC X(200).                  00520007
005300                                                                  00530007
005400 FD  EXTRACT-FILE-OUT                                             00540007
005500     LABEL RECORDS ARE STANDARD                                   00550007
005600     RECORDING MODE IS F                                          00560007
005700     BLOCK CONTAINS 0 RECORDS                                     00570007
005800     RECORD CONTAINS 200 CHARACTERS.                              00580007
005900 01  EXTRACT-RECORD-OUT              PIC X(200).                  00590007
006000                                                                  00600007
006100*                                                                 00610007
006200                                                                  00620007
006300 WORKING-STORAGE SECTION.                                         00630007
006400**************************************************************    00640007
006500* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00650007
006600**************************************************************    00660007
006700                                                                  00670007
006800 01  PROGRAM-SWITCHES.                                            00680007
006900     05  PS-EOF-INPUT-SW             PIC  X(03)    VALUE 'BOF'.   00690007
007000         88  PS-EOF-INPUT                          VALUE 'EOF'.   00700007
007100     05  PS-EMPTY-FILE-SW            PIC  X(01)    VALUE 'N'.     00710007
007200         88  PS-EMPTY-FILE                         VALUE 'Y'.     00720007
007300     05  PS-END-OF-CURSOR-SW         PIC  X(01)    VALUE 'N'.     00730007
007400         88  PS-END-OF-CURSOR                      VALUE 'Y'.     00740007
007500         88  PS-NOT-END-OF-CURSOR                  VALUE 'N'.     00750007
007600     05  PS-HDR-PROCESSED-SW         PIC  X(01)    VALUE 'N'.     00760007
007700         88  PS-HDR-PROCESSED                      VALUE 'Y'.     00770007
007800     05  PS-INPUT-STATUS-SW          PIC  X(01)    VALUE 'N'.     00780007
007900         88  PS-INPUT-STATUS-NO-ASN-INPUT          VALUE 'Y'.     00790007
008000         88  PS-INPUT-STATUS-NO-ASN-ERRORS         VALUE 'N'.     00800007
008100         88  PS-INPUT-STATUS-ASN-WRITTEN           VALUE 'X'.     00810007
008200     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00820007
008300         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00830007
008400     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     00840007
008500         88  PS-STATUS-FOUND                       VALUE 'Y'.     00850007
008600         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     00860007
008700     05  PS-FIRST-LINE-SW            PIC  X(01)    VALUE 'Y'.     00870007
008800         88  PS-FIRST-LINE                         VALUE 'Y'.     00880007
008900         88  PS-NOT-FIRST-LINE                     VALUE 'N'.     00890007
009000     05  PS-PRT-HEADING-SW           PIC  X(01)    VALUE 'Y'.     00900007
009100         88  PS-PRT-HEADING                        VALUE 'Y'.     00910007
009200         88  PS-NOT-PRT-HEADING                    VALUE 'N'.     00920007
009300     05  PS-SCANNED-IND              PIC  X(01)    VALUE 'N'.     00930007
009400         88  PS-SCANNED                            VALUE 'Y'.     00940007
009500         88  PS-NOT-SCANNED                        VALUE 'N'.     00950007
009600     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     00960007
009700         88  PS-ERROR-RECORD                       VALUE 'A'.     00970007
009800         88  PS-DETAIL-RECORD                      VALUE 'B'.     00980007
009900*                                                                 00990007
010000 01  PC-CONSTANTS.                                                01000007
010100     05  PC-1                        PIC S9(03)    VALUE +1       01010007
010200                                                   COMP-3.        01020007
010300     05  PC-2                        PIC S9(03)    VALUE +2       01030007
010400                                                   COMP-3.        01040007
010500     05  PC-3                        PIC S9(03)    VALUE +3       01050007
010600                                                   COMP-3.        01060007
010700     05  PC-7                        PIC S9(01)    VALUE +7.      01070007
010800     05  PC-11                       PIC S9(03)    VALUE +11      01080007
010900                                                   COMP-3.        01090007
011000     05  PC-60                       PIC S9(03)    VALUE +60      01100007
011100                                                   COMP-3.        01110007
011200     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01120007
011300     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01130007
011400     05  PC-00                       PIC  X(02)    VALUE '00'.    01140007
011500     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01150007
011600     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01160007
011700     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01170007
011800     05  PC-A                        PIC  X(01)    VALUE 'A'.     01180007
011900     05  PC-SUKUT038                 PIC  X(08)    VALUE          01190007
012000         'SUKUT038'.                                              01200007
012100     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01210007
012200     05  PC-NO-SKU                   PIC  X(11)    VALUE          01220007
012300         '  NO SKU'.                                              01230007
012400                                                                  01240007
012500 01  DN-DB2-NULL-INDICATORS.                                      01250007
012600     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01260007
012700*                                                                 01270007
012800 01  PV-SU001-RECORD-LAYOUT.                                      01280007
012900     05  PV-SU001-MANIFEST-NBR        PIC S9(09) COMP.            01290007
013000     05  PV-SU001-SHIPT-UNT-ID        PIC S9(18) COMP-3.          01300007
013100     05  PV-SU001-PO-NUMBER           PIC S9(09) COMP.            01310007
013200     05  PV-SU001-REC-SEQ-NBR         PIC S9(09) COMP.            01320007
013300     05  PV-SU001-SCANNED-IND         PIC  X(01).                 01330007
013400     05  PV-SU001-MISDIRECT-IND       PIC  X(01).                 01340007
013500     05  PV-SU001-NOT-FOUND-IND       PIC  X(01).                 01350007
013600     05  PV-SU001-FREE-ASTRAY-IND     PIC  X(01).                 01360007
013700     05  PV-SU001-ANOTHER-TRAILER-IND PIC X(01).                  01370007
013800     05  PV-SU001-RECORD-TYPE-IND     PIC  X(01).                 01380007
013900         88  PV-SU001-ERROR-RECORD               VALUE 'A'.       01390007
014000         88  PV-SU001-DETAIL-RECORD              VALUE 'B'.       01400007
014100     05  PV-SU001-STR-NBR             PIC  S9(4) COMP.            01410007
014200     05  PV-SU001-TSULBXF-USED        PIC  X(01).                 01420007
014300         88  PV-SU001-TABLE-USED                 VALUE 'Y'.       01430007
014400         88  PV-SU001-TABLE-NOT-USED             VALUE 'N'.       01440007
014500     05  PV-SU001-BRCDE-NBR           PIC  X(22).                 01450007
014600     05  PV-SU001-AUTO-VE-IND         PIC  X(01).                 01460010
014700         88  PV-SU001-AUTO-VE-YES                VALUE 'Y'.       01470010
014800         88  PV-SU001-AUTO-VE-NO                 VALUE 'N'.       01480010
014900                                                                  01490007
015000 01  PV-MISC-FIELDS.                                              01500007
015100     05  PV-HOLD-INPUT-RECORD         PIC X(200)    VALUE SPACES. 01510007
015200     05  PV-LINE-SUB                  PIC S9(03)    VALUE +0      01520007
015300                                                   COMP-3.        01530007
015400     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01540007
015500                                                   COMP-3.        01550007
015600     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01560007
015700                                                   COMP-3.        01570007
015800     05  PV-CART-MISSING             PIC S9(04)    VALUE ZERO     01580007
015900                                                   COMP-3.        01590007
016000     05  PV-EXPTED-QTY               PIC S9(05)    VALUE ZERO     01600007
016100                                                   COMP-3.        01610007
016200     05  PV-LINE-TOT-QTY             PIC S9(05)    VALUE ZERO     01620007
016300                                                   COMP-3.        01630007
016400     05  PV-STATUS                   PIC  X(02).                  01640007
016500     05  PV-STR-NBR-NUMERIC          PIC  9(4).                   01650007
016600     05  PV-STR-NBR REDEFINES PV-STR-NBR-NUMERIC.                 01660007
016700         10  PV-STR-NBR-1            PIC  X(01).                  01670007
016800         10  PV-STR-NBR-2-4          PIC  X(03).                  01680007
      *CLP 10/14/14                                                     01681011
016900*    05  PV-SAVE-PO-RECEIVER         PIC  X(11).                  01690011
017000     05  PV-SAVE-SCANNED-IND         PIC  X(01).                  01700007
017100     05  PV-SAVE-SHIP-CODE           PIC  9(18).                  01710007
017200     05  PV-SAVE-LINE-NBR            PIC  X(04).                  01720007
017300     05  PV-TRIP-ID                  PIC  9(09).                  01730007
017400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01740007
017500                                                   COMP SYNC.     01750007
017600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01760007
017700     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    01770007
017800******************************************************************01780007
017900*   REMOVED GROUP VARIABLE PV-SKU                     WR # 21361 *01790007
018000******************************************************************01800007
018100******************************************************************01810007
018200*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *01820009
018300******************************************************************01830007
      *CLP 10/14/14                                                     01831011
018400*    05  PV-PO-RECEIVER.                                          01840011
018500*        10  PV-PO                   PIC  9(07)    VALUE ZERO.    01850011
018600*        10  FILLER                  PIC  X(01)    VALUE '-'.     01860011
018700*        10  PV-RECEIVER             PIC  9(03)    VALUE ZERO.    01870011
018800     05  PV-STORE-NBR-CHAR           PIC  X(03)    VALUE SPACES.  01880007
018900     05  PV-TODAYS-DATE.                                          01890007
019000         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01900007
019100         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01910007
019200         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01920007
019300     05  PV-TODAYS-TIME.                                          01930007
019400         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01940007
019500         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01950007
019600         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01960007
019700         10  FILLER                  PIC  9(02)    VALUE ZERO.    01970007
019800     05  PV-DB2-DATE.                                             01980007
019900         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    01990007
020000         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    02000007
020100         10  FILLER                  PIC  X(01)    VALUE ZERO.    02010007
020200         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02020007
020300         10  FILLER                  PIC  X(01)    VALUE ZERO.    02030007
020400         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02040007
020500     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 02050007
020600     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    02060007
020700         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 02070007
020800         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 02080007
020900         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 02090007
021000         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 02100007
021100     05  PV-OUT-SERIAL-SHIP-CODE.                                 02110007
021200         10  FILLER                   PIC  X(05)    VALUE '(00) '.02120007
021300         10  PV-OUT-S-S-C-1           PIC  X(01).                 02130007
021400         10  FILLER                   PIC  X(01) VALUE SPACES.    02140007
021500         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 02150007
021600         10  FILLER                   PIC  X(01) VALUE SPACES.    02160007
021700         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02170007
021800         10  FILLER                   PIC  X(01) VALUE SPACES.    02180007
021900         10  PV-OUT-S-S-C-18          PIC  X(01).                 02190007
022000     05  PV-SAVE-TRN-LNE-NBR          PIC S9(09) COMP.            02200007
022100     05  PV-SAVE-MERCH-DEPT-NMBR      PIC  X(03).                 02210007
022200     05  PV-SAVE-MERCH-CLASS-NMBR     PIC  X(02).                 02220007
022300     05  PV-SAVE-SEQ-NMBR             PIC  X(03).                 02230007
022400*                                                                 02240007
022500     COPY SURD001.                                                02250010
022600 EJECT                                                            02260007
022700                                                                  02270007
022800*                                                                 02280007
022900 PROCEDURE DIVISION.                                              02290007
023000*                                                                 02300007
023100 0000-MAINLINE-PROCESSING.                                        02310007
023200******************************************************************02320007
023300* THIS IS THE MAIN DRIVER FOR THE PROGRAM.                        02330007
023400*                                                                 02340007
023500* THE PROGRAM WILL ALWAYS READ THE INPUT RECORD INTO A PV AREA    02350007
023600* AND THEN MOVE TO THE SURD001 INCLUDE AS NEEDED AND ALWAYS       02360007
023700* WRITE FROM THE SURD001 AREA.                                    02370007
023800******************************************************************02380007
023900                                                                  02390007
024000     PERFORM 0100-INITIALIZATION.                                 02400007
024100                                                                  02410007
024200     PERFORM 1200-PROCESS-EXTRACT                                 02420007
024300         UNTIL PS-EOF-INPUT                                       02430007
024400            OR PS-ERROR-RECORD.                                   02440007
024500                                                                  02450007
024600     IF  PS-EOF-INPUT                                             02460007
024700         IF  PS-EMPTY-FILE                                        02470007
024800             CONTINUE                                             02480007
024900         ELSE                                                     02490007
025000             PERFORM 8400-WRITE-EXTRACT-OUTPUT                    02500007
025100         END-IF                                                   02510007
025200     END-IF.                                                      02520007
025300                                                                  02530007
025400     CLOSE EXTRACT-FILE                                           02540007
025500           EXTRACT-FILE-OUT.                                      02550007
025600                                                                  02560007
025700     GOBACK.                                                      02570007
025800                                                                  02580007
025900                                                                  02590007
026000 0100-INITIALIZATION.                                             02600007
026100******************************************************************02610007
026200**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               02620007
026300******************************************************************02630007
026400                                                                  02640007
026500     OPEN INPUT  EXTRACT-FILE                                     02650007
026600          OUTPUT EXTRACT-FILE-OUT.                                02660007
026700                                                                  02670007
026800     PERFORM 2200-READ-EXTRACT.                                   02680007
026900                                                                  02690007
027000     IF  PS-EOF-INPUT                                             02700007
027100         SET PS-EMPTY-FILE TO TRUE                                02710007
027200     ELSE                                                         02720007
027300         IF  PV-SU001-ERROR-RECORD                                02730007
027400             SET PS-ERROR-RECORD TO TRUE                          02740007
027500             MOVE PV-SU001-RECORD-LAYOUT TO                       02750007
027600                  SU001-EXTRACT-RECORD                            02760007
027700             PERFORM 8400-WRITE-EXTRACT-OUTPUT                    02770007
027800         ELSE                                                     02780007
027900             MOVE PV-SU001-RECORD-LAYOUT TO                       02790007
028000                  SU001-EXTRACT-RECORD                            02800007
028100             PERFORM 2200-READ-EXTRACT                            02810007
028200         END-IF                                                   02820007
028300     END-IF.                                                      02830007
028400                                                                  02840007
028500                                                                  02850007
028600 1200-PROCESS-EXTRACT.                                            02860007
028700******************************************************************02870007
028800**  PROCESS THE INPUT FILE.  IF THE SHIP UNITS ARE THE SAME,      02880007
028900**  THEN THE TWO RECORDS WILL BE COMBINED INTO THE SURD001 AREA.  02890007
029000**  IF THE SHIP UNITS ARE NOT EQUAL, THEN AN OUTPUT RECORD WILL   02900007
029100**  BE WRITTEN AND THE PV HOLD INPUT FIELD WILL BE MOVED TO       02910007
029200**  THE SURD001 AREA FOR THE NEXT COMPARE.                        02920007
029300******************************************************************02930007
029400                                                                  02940007
029500     IF  PV-SU001-SHIPT-UNT-ID = SU001-SHIPT-UNT-ID               02950007
029600         PERFORM 1400-COMPARE-RECORDS                             02960007
029700     ELSE                                                         02970007
029800         PERFORM 8400-WRITE-EXTRACT-OUTPUT                        02980007
029900         MOVE PV-SU001-RECORD-LAYOUT TO                           02990007
030000              SU001-EXTRACT-RECORD                                03000007
030100     END-IF.                                                      03010007
030200                                                                  03020007
030300     PERFORM 2200-READ-EXTRACT.                                   03030007
030400                                                                  03040007
030500                                                                  03050007
030600 1400-COMPARE-RECORDS.                                            03060007
030700******************************************************************03070007
030800**  THIS WILL COMPARE THE CURRENT AND PREVIOUS INDICATOR FIELDS   03080007
030900**  TO SET THEM ACCORDINGLY.                                      03090007
031000******************************************************************03100007
031100                                                                  03110007
031200     IF  PV-SU001-SCANNED-IND = PC-Y                              03120007
031300         MOVE PC-Y TO SU001-SCANNED-IND                           03130007
031400     END-IF.                                                      03140007
031500                                                                  03150007
031600     IF  PV-SU001-MISDIRECT-IND = PC-Y                            03160007
031700         MOVE PC-Y TO SU001-MISDIRECT-IND                         03170007
031800     END-IF.                                                      03180007
031900                                                                  03190007
032000     IF  PV-SU001-NOT-FOUND-IND = PC-Y                            03200007
032100         MOVE PC-Y TO SU001-NOT-FOUND-IND                         03210007
032200     END-IF.                                                      03220007
032300                                                                  03230007
032400     IF  PV-SU001-FREE-ASTRAY-IND = PC-Y                          03240007
032500         MOVE PC-Y TO SU001-FREE-ASTRAY-IND                       03250007
032600     END-IF.                                                      03260007
032700                                                                  03270007
032800     IF  PV-SU001-ANOTHER-TRAILER-IND = PC-Y                      03280007
032900         MOVE PC-Y TO SU001-ANOTHER-TRAILER-IND                   03290007
033000     END-IF.                                                      03300007
033100                                                                  03310007
033200     IF  PV-SU001-TSULBXF-USED = PC-Y                             03320007
033300         MOVE PC-Y TO SU001-TSULBXF-USED                          03330007
033400     END-IF.                                                      03340007
033500                                                                  03350007
033600     IF  PV-SU001-AUTO-VE-IND  = PC-Y                             03360010
033700         MOVE PC-Y TO SU001-AUTO-VE-IND                           03370010
033800     END-IF.                                                      03380010
033900                                                                  03390010
034000 2200-READ-EXTRACT.                                               03400007
034100******************************************************************03410007
034200**  READS THE INPUT RECORD IN THE PV AREA.                        03420007
034300******************************************************************03430007
034400                                                                  03440007
034500     READ EXTRACT-FILE INTO PV-SU001-RECORD-LAYOUT                03450007
034600        AT END                                                    03460007
034700           SET PS-EOF-INPUT TO TRUE.                              03470007
034800                                                                  03480007
034900                                                                  03490007
035000 8400-WRITE-EXTRACT-OUTPUT.                                       03500007
035100******************************************************************03510007
035200*     WRITE THE COMBINED EXTRACT RECORD FROM THE SURD001 AREA.   *03520007
035300******************************************************************03530007
035400                                                                  03540007
035500     WRITE EXTRACT-RECORD-OUT                                     03550007
035600      FROM SU001-EXTRACT-RECORD.                                  03560007
035700                                                                  03570007
