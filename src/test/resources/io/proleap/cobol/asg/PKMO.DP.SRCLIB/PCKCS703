000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    PCKCS703.                                         00040002
000500 AUTHOR.        ANN RAISLER.                                      00050002
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
000700 DATE-WRITTEN.  09-15-98.                                         00070002
000800 DATE-COMPILED.                                                   00080002
000900                                                                  00090002
001000*---------------------------------------------------------------* 00100002
001100*    E703 - P2L/CASEPACK LABEL STORE LIST/PRINT.                * 00110002
001200*                                                               * 00120002
001300*    THIS SCREEN CAN BE USED TO REVIEW THE STORE LEVEL          * 00130002
001400*    DISTRIBUTION OF MERCHANDISE FOR A SELECTED LINE AND CAN BE * 00140002
001500*    USED TO REPRINT AN ENTIRE STORE(S) SHIPPING LABELS.        * 00150002
001600*                                                               * 00160002
001700*---------------------------------------------------------------* 00170002
001710* DATE  11/04/2021                                                00171075
001720*            - CHANGE CALL OF 'DPKUT100' TO                     * 00172075
001730*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00173075
001740*              MAKING THE CALL DYNAMIC VS STATIC                * 00174075
001750*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00175076
001751*-----------------------------------------------------------------00175177
001752* DATE  11/07/2022                                              * 00175278
001753*            - ADD COPYBOOK DPWS930                             * 00175378
001754*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00175478
001755*              DYNAMIC.                                         * 00175578
001756*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00175678
001760*-----------------------------------------------------------------00176075
001800                                                                  00180002
001900 ENVIRONMENT DIVISION.                                            00190002
002000                                                                  00200002
002100 DATA DIVISION.                                                   00210002
002200                                                                  00220002
002300 WORKING-STORAGE SECTION.                                         00230002
002400                                                                  00240002
002500 01  DK-DB2-KEYS.                                                 00250005
002600     05  DK-OPER-UNT-ID               PIC S9(04) COMP VALUE ZERO. 00260007
002700     05  DK2-PO-NBR                    PIC S9(09) COMP VALUE +0.  00270013
002800     05  DK2-REC-SEQ-NBR               PIC S9(09) COMP VALUE +0.  00280013
002900     05  DK2-PREPK-ID                  PIC S9(04) COMP VALUE +0.  00290013
003000                                                                  00300005
003100                                                                  00310002
003200 01  PC-PROGRAM-CONSTANTS.                                        00320002
003300     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00330002
003400                                                    'PC703A  '.   00340002
003500     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00350002
003600                                                    'PCKM703 '.   00360002
003700     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00370002
003800                                                    'PCKCS703'.   00380002
003900     05  PC-LABEL-PROGRAM                PIC  X(08)  VALUE        00390002
004000                                                    'PCKCS191'.   00400002
004100                                                                  00410002
004200                                                                  00420002
004300     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'PCKCS126'.  00430002
004400     05  PC-REPORT-PGM-2           PIC  X(08)  VALUE 'PCKCS123'.  00440002
004500                                                                  00450002
004600     05  PC-DEFAULT-TIMESTAMP      PIC  X(26)  VALUE              00460002
004700                                  '9999-09-09-09.09.09.999999'.   00470002
004800                                                                  00480002
004900     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00490002
005000     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00500002
005100     05  PC-PRINT-QUEUE-SEQ             PIC  9(01)  VALUE 3.      00510002
005200     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00520002
005300     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00530002
005400     05  PC-PRT                         PIC  X(03)  VALUE 'PRT'.  00540002
005500                                                                  00550002
005600     05  PC-P2L-CASE-DESC               PIC  X(10)  VALUE         00560002
005700                                                    'P2L/CASE  '. 00570002
005800     05  PC-P2L-LBL-DESC                PIC  X(10)  VALUE         00580002
005900                                                    'P2L LBL   '. 00590002
006000     05  PC-CASE-LBL-DESC               PIC  X(10)  VALUE         00600002
006100                                                    'CASE LBL  '. 00610002
006200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00620002
006300                                                    COMP SYNC.    00630002
006400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00640002
006500                                                    COMP SYNC.    00650002
006600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00660002
006700                                                    +1000000      00670002
006800                                                    COMP-3.       00680002
006900     05  PC-MAX-RETRIES                 PIC S9(04)  VALUE  +2.    00690002
007000     05  PC-SEMI-COLON                  PIC  X(01)  VALUE ';'.    00700002
007100     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00710002
007200     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00720002
007300     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00730002
007400     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00740002
007500                                                                  00750002
007600     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 00760002
007700                                                                  00770002
007800     05  PC-A                           PIC  X(01)  VALUE 'A'.    00780002
007900     05  PC-F                           PIC  X(01)  VALUE 'F'.    00790002
008000     05  PC-N                           PIC X(01)   VALUE 'N'.    00800002
008100     05  PC-O                           PIC X(01)   VALUE 'O'.    00810002
008200     05  PC-P                           PIC X(01)   VALUE 'P'.    00820002
008300     05  PC-R                           PIC X(01)   VALUE 'R'.    00830002
008400     05  PC-S                           PIC X(01)   VALUE 'S'.    00840002
008500     05  PC-X                           PIC X(01)   VALUE 'X'.    00850002
008600     05  PC-CS                          PIC X(02)   VALUE 'CS'.   00860002
008700     05  PC-DC                          PIC X(02)   VALUE 'PC'.   00870002
008800     05  PC-RV                          PIC X(02)   VALUE 'RV'.   00880002
008900                                                                  00890002
009000     05  PC-01                          PIC  X(02)  VALUE '01'.   00900002
009100     05  PC-03                          PIC  X(02)  VALUE '03'.   00910002
009200     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00920002
009300                                                                  00930002
009400     05  PC-NO-LABEL                    PIC X(02)   VALUE 'NL'.   00940002
009500                                                                  00950002
009600     05  PC-ODD-CRTN-FCSE               PIC X(04) VALUE 'FCSE'.   00960002
009700     05  PC-ODD-CRTN-INPK               PIC X(04) VALUE 'INPK'.   00970002
009800     05  PC-ODD-CRTN-P2L                PIC X(04) VALUE 'P2L '.   00980002
009900                                                                  00990009
010000     05  PC-INNER-PREPACK            PIC  X(06) VALUE 'INPRPK'.   01000009
010100     05  PC-MULTI-SKU                PIC  X(06) VALUE 'MLTSKU'.   01010009
010200     05  PC-SINGLE-SKU               PIC  X(06) VALUE 'SGLSKU'.   01020009
010300     05  PC-CASEPACK                 PIC  X(06) VALUE 'CASEPK'.   01030009
010400     05  PC-BULK                     PIC  X(06) VALUE 'BULK  '.   01040009
010500                                                                  01050002
010600     05  PC-QTY                      PIC  X(03) VALUE 'QTY'.      01060015
010700     05  PC-PAK                      PIC  X(03) VALUE 'PAK'.      01070015
010800     05  PC-INPK                     PIC  X(06) VALUE 'INPK.:'.   01080015
010900     05  PC-RATIO                    PIC  X(06) VALUE 'RATIO:'.   01090015
011000     05  PC-SKU                      PIC  X(07) VALUE 'SKU...:'.  01100015
011100     05  PC-PACKID                   PIC  X(07) VALUE 'PACKID:'.  01110015
011200                                                                  01120015
011300     05  PC-USE-UCC128               PIC X(18)  VALUE             01130025
011400                                     'USING UCC128 DATA '.        01140025
011500     05  PC-IGNORE-UCC128            PIC X(18)  VALUE             01150025
011600                                     'IGNORE UCC128 DATA'.        01160025
011700     05  PC-NO-UCC128-AVAIL          PIC X(18)  VALUE             01170025
011800                                     'NO UCC128 DATA    '.        01180025
011900                                                                  01190025
012000                                                                  01200002
012100*----------------------------------------------------------------*01210002
012200*  SYSTEM MESSAGES                                               *01220002
012300*----------------------------------------------------------------*01230002
012400*   00005 - INVALID VALUE                                        *01240002
012500*   00008 - MUST BE NUMERIC                                      *01250002
012600*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01260002
012700*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01270002
012800*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01280002
012900*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01290002
013000*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01300002
013100*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01310002
013200*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01320002
013300*   00069 - TOP OF LIST                                          *01330002
013400*   00070 - BOTTOM OF LIST                                       *01340002
013500*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01350002
013600*   00279 - MORE ITEMS TO DISPLAY                                *01360002
013700*   00746 - INVALID PRINTER DESTINATION                          *01370002
013800*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01380002
013900*   01770 - SELECTED LINE(S) HAVE BEEN SUCCESSFULLY PROCESSED    *01390002
014000*   01786 - NUMBER OF SHIPPING CARTONS MUST BE > 0               *01400002
014100*   01787 - STORE(S) SELECTED IS DC OR RTV LOCATION, UNABLE TO   *01410002
014200*           REPRINT                                              *01420002
014300*   02424 - PGYBK PRTRS CANNOT BE USED FOR PRE-PACK TYPE I OR M  *01430011
014400*   02508 - CANNOT REPRT LBL FOR LINES PROCESSED USING UCC128     01440029
014500*   99901 - INVALID COMMAND WAS ENTERED                          *01450002
014600*----------------------------------------------------------------*01460002
014700 01  PC-TSYMSG-NUMBERS.                                           01470002
014800     10  PC-TSYMSG-00005                PIC  9(05)  VALUE 00005.  01480002
014900     10  PC-TSYMSG-00008                PIC  9(05)  VALUE 00008.  01490002
015000     10  PC-TSYMSG-00050                PIC  9(05)  VALUE 00050.  01500002
015100     10  PC-TSYMSG-00051                PIC  9(05)  VALUE 00051.  01510002
015200     10  PC-TSYMSG-00052                PIC  9(05)  VALUE 00052.  01520002
015300     10  PC-TSYMSG-00053                PIC  9(05)  VALUE 00053.  01530002
015400     10  PC-TSYMSG-00054                PIC  9(05)  VALUE 00054.  01540002
015500     10  PC-TSYMSG-00055                PIC  9(05)  VALUE 00055.  01550002
015600     10  PC-TSYMSG-00057                PIC  9(05)  VALUE 00057.  01560002
015700     10  PC-TSYMSG-00069                PIC  9(05)  VALUE 00069.  01570002
015800     10  PC-TSYMSG-00070                PIC  9(05)  VALUE 00070.  01580002
015900     10  PC-TSYMSG-00101                PIC  9(05)  VALUE 00101.  01590002
016000     10  PC-TSYMSG-00279                PIC  9(05)  VALUE 00279.  01600002
016100     10  PC-TSYMSG-00746                PIC  9(05)  VALUE 00746.  01610002
016200     10  PC-TSYMSG-01563                PIC  9(05)  VALUE 01563.  01620002
016300     10  PC-TSYMSG-01786                PIC  9(05)  VALUE 01786.  01630002
016400     10  PC-TSYMSG-01787                PIC  9(05)  VALUE 01787.  01640002
016500     10  PC-TSYMSG-02424                PIC  9(05)  VALUE 02424.  01650011
016600     10  PC-TSYMSG-02508                PIC  9(05)  VALUE 02508.  01660029
016610     10  PC-TSYMSG-03415                PIC  9(05)  VALUE 03415.  01661070
016700     10  PC-TSYMSG-99901                PIC  9(05)  VALUE 99901.  01670002
016800                                                                  01680002
016900                                                                  01690002
017000*----------------------------------------------------------------*01700002
017100 01  PS-PROGRAM-SWITCHES.                                         01710002
017200     05  PS-ERROR-SW                    PIC  X(01)  VALUE  'N'.   01720002
017300         88  PS-NO-ERROR                            VALUE  'N'.   01730002
017400         88  PS-ERROR                               VALUE  'Y'.   01740002
017500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE  'N'.   01750002
017600         88  PS-COMMAREA-VALID                      VALUE  'Y'.   01760002
017700         88  PS-COMMAREA-NOT-VALID                  VALUE  'N'.   01770002
017800     05  PS-FCSE-CTN-SW                 PIC  X(01)  VALUE  'N'.   01780050
017900         88  PS-END-FCSE-CTN-CSR-YES                VALUE  'Y'.   01790050
018000         88  PS-END-FCSE-CTN-CSR-NO                 VALUE  'N'.   01800050
018100     05  PS-FCSE-CTN-PRPK-SW            PIC  X(01)  VALUE  'N'.   01810050
018200         88  PS-END-FCSE-CTN-PRPK-CSR-YES           VALUE  'Y'.   01820050
018300         88  PS-END-FCSE-CTN-PRPK-CSR-NO            VALUE  'N'.   01830050
018400     05  PS-INPK-CTN-SW                 PIC  X(01)  VALUE  'N'.   01840050
018500         88  PS-END-INPK-CTN-CSR-YES                VALUE  'Y'.   01850050
018600         88  PS-END-INPK-CTN-CSR-NO                 VALUE  'N'.   01860050
018700     05  PS-INPK-CTN-PRPK-SW            PIC  X(01)  VALUE  'N'.   01870050
018800         88  PS-END-INPK-CTN-PRPK-CSR-YES           VALUE  'Y'.   01880050
018900         88  PS-END-INPK-CTN-PRPK-CSR-NO            VALUE  'N'.   01890050
019000                                                                  01900050
019100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01910002
019200         88  PS-LIST-END                            VALUE  'Y'.   01920002
019300         88  PS-NO-LIST-END                         VALUE  'N'.   01930002
019400     05  PS-PRINTER-ERROR-SW            PIC  X(01)  VALUE  'N'.   01940002
019500         88  PS-PRINTER-ERROR                       VALUE  'Y'.   01950002
019600                                                                  01960002
019700 01  PM-PROGRAM-MESSAGES.                                         01970002
019800     05  PM-PROGRAM-MESSAGE-1.                                    01980002
019900         10  PM-RET-CDE                 PIC  X(02)  VALUE SPACES. 01990002
020000         10  FILLER                     PIC  X(01)  VALUE '-'.    02000002
020100         10  PM-RET-MSG                 PIC  X(25)  VALUE SPACES. 02010002
020200         10  FILLER                     PIC  X(48)  VALUE SPACES. 02020002
020300                                                                  02030002
020400*                                                                 02040002
020500                                                                  02050002
020600                                                                  02060002
020700*----------------------------------------------------------------*02070002
020800 01  PV-PROGRAM-VARIABLES.                                        02080002
020900     05  PV-WORK-SKU.                                             02090002
021000         10  PV-WK-DEPT-NBR             PIC  9(03).               02100002
021100         10  PV-WK-CLASS-NBR            PIC  9(02).               02110002
021200         10  PV-WK-SKU-SEQ-NBR          PIC  9(03).               02120002
021300                                                                  02130002
021400     05  PV-SKU                         PIC  9(08).               02140037
021500     05  PV-WRITE-LENGTH                PIC S9(04)  COMP.         02150002
021600                                                                  02160002
021700     05  PV-MOD-NBR-N                   PIC  9(04).               02170002
021800     05  FILLER  REDEFINES  PV-MOD-NBR-N.                         02180002
021900         10  FILLER                   PIC  X(01).                 02190002
022000         10  PV-MOD-NBR-3             PIC  X(03).                 02200002
022100                                                                  02210002
022200     05  PV-MFST-NBR                    PIC S9(09)  COMP.         02220002
022300     05  PV-FCSE-REM                    PIC S9(09)  COMP.         02230002
022400     05  PV-INPK-REM                    PIC S9(09)  COMP.         02240002
022500     05  PV-STORE                       PIC X(03).                02250002
022600     05  PV-NBR-OF-STORES-SELECTED      PIC S9(09)  COMP.         02260002
022700     05  PV-NO-OF-LBLS-COMP             PIC S9(09)  COMP.         02270002
022800                                                                  02280002
022900     05  PV-SUB                         PIC S9(04)  VALUE +0      02290002
023000                                                    COMP SYNC.    02300002
023100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02310002
023200                                                    COMP SYNC.    02320002
023300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02330002
023400                                                    COMP-3.       02340002
023500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02350002
023600                                                    COMP-3.       02360002
023700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02370002
023800                                                    COMP-3.       02380002
023900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02390002
024000                                                    COMP-3.       02400002
024100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02410002
024200                                                    COMP-3.       02420002
024300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02430002
024400                                                    COMP-3.       02440002
024500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02450002
024600                                                    COMP SYNC.    02460002
024700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02470002
024800                                                    COMP SYNC.    02480002
024900     05  PV-ITEM                        PIC S9(04)  VALUE +0      02490002
025000                                                    COMP SYNC.    02500002
025100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02510002
025200                                                    COMP SYNC.    02520002
025300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02530002
025400                                                    COMP SYNC.    02540002
025500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02550002
025600                                                    COMP SYNC.    02560002
025700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02570002
025800                                                    COMP SYNC.    02580002
025900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02590002
026000                                                    COMP SYNC.    02600002
026100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02610002
026200                                                    COMP SYNC.    02620002
026300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02630002
026400                                                    COMP SYNC.    02640002
026500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02650002
026600                                                    COMP SYNC.    02660002
026700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02670002
026800                                                    COMP SYNC.    02680002
026900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02690002
027000                                                    COMP SYNC.    02700002
027100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02710002
027200                                                    COMP SYNC.    02720002
027300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02730002
027400                                                    COMP SYNC.    02740002
027500                                                                  02750002
027600     05  PV-OPER-UNT-ID                 PIC S9(04) COMP.          02760002
027700                                                                  02770002
027800     05  PV-TOT-CS-LABELS               PIC  S9(09)  VALUE +0.    02780002
027900                                                                  02790002
028000     05  PV-TOT-SEL-FCSE-CART-QTY       PIC  S9(09)  VALUE +0.    02800002
028100                                                                  02810002
028200     05  PV-TOT-SEL-INPK-CART-QTY       PIC  S9(09)  VALUE +0.    02820002
028300                                                                  02830002
028400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02840002
028500                                                     COMP SYNC.   02850002
028600     05  PV-FCSE-SPLT-AFTER-ODD          PIC S9(04)  VALUE +0     02860002
028700                                                     COMP.        02870002
028800     05  PV-TOT-CRTN-AFTER-ODD           PIC S9(09)  VALUE +0     02880002
028900                                                     COMP.        02890002
029000     05  PV-TOT-PREPK-UNTS               PIC  S9(9)      COMP.    02900013
029100     05  PV-TOT-PREPK-INPK-UNTS          PIC  S9(9) COMP.         02910035
029200     05  PV-DISPLAY-PACKID.                                       02920017
029300         10  FILLER                      PIC   X(03) VALUE 'PK-'. 02930017
029400         10  PV-PACKID                   PIC   9(04).             02940031
029500         10  FILLER                      PIC   X(01) VALUE SPACE. 02950017
029600                                                                  02960002
029700     05  PV-DISPLAY-ITEM-NBR             PIC  9(15).              02970039
029800     05  PV-UCC128-FCSE-CNT              PIC S9(09)  COMP.        02980027
029900     05  PV-UCC128-INPK-CNT              PIC S9(09)  COMP.        02990027
030000     05  PV-FCSE-CNT                     PIC S9(09)  COMP.        03000050
030100     05  PV-INPK-CNT                     PIC S9(09)  COMP.        03010050
030200     05  PV-PLACEHOLDER                  PIC  X(01) VALUE SPACE.  03020050
030300                                                                  03030050
030400     05  PV-DSPLY-PO-NBR                 PIC  9(09).              03040030
030500     05  PV-DSPLY-REC-SEQ-NBR            PIC  9(09).              03050030
030600     05  PV-DSPLY-PREPK-ID               PIC  9(04).              03060030
030700                                                                  03070002
030800                                                                  03080027
030900*----------------------------------------------------------------*03090002
031000*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *03100002
031100*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *03110002
031200*   APPLICATION-SPECIFIC COMMAREA.                               *03120002
031300*----------------------------------------------------------------*03130002
031400 01  LQW-LIST-QUEUE-WORK-AREA.                                    03140002
031500     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03150002
031600     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03160002
031700                                        INDEXED BY LQW-IDX.       03170002
031800         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03180002
031900         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03190002
032000         10  LQW-SELECTED-SW            PIC  X(01).               03200002
032100             88  LQW-SELECT                         VALUE 'S'.    03210002
032200             88  LQW-DESELECT                       VALUE ' '.    03220002
032300         10  LQW-ACTION                 PIC  X(03).               03230002
032400             88  LQW-DEL                            VALUE 'DEL'.  03240002
032500             88  LQW-INQ                            VALUE 'INQ'.  03250002
032600             88  LQW-UPD                            VALUE 'UPD'.  03260002
032700             88  LQW-PRT                            VALUE 'PRT'.  03270002
032800         10  LQW-STORE                  PIC  X(04).               03280002
032900         10  LQW-PKSLQTY                PIC  9(05).               03290002
033000         10  LQW-P2QTY                  PIC  9(05).               03300002
033100         10  LQW-SHIPQTY                PIC  9(05).               03310002
033200         10  LQW-CARTQTY                PIC  9(05).               03320002
033300         10  LQW-ODD-CRTN-SW            PIC  X(01).               03330002
033400         10  LQW-FCSE-CART-QTY          PIC  9(05).               03340002
033500         10  LQW-INPK-CART-QTY          PIC  9(05).               03350002
033600         10  LQW-STORE-TYPE             PIC  X(02).               03360002
033700         10  LQW-PKSLPAK                PIC  9(05).               03370017
033800         10  LQW-P2PAK                  PIC  9(05).               03380017
033900         10  LQW-SHIPPAK                PIC  9(05).               03390017
034000                                                                  03400002
034100*---------------------------------------------------------------* 03410002
034200*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 03420002
034300*---------------------------------------------------------------* 03430002
034400     COPY DPWS057.                                                03440002
034500                                                                  03450002
034600                                                                  03460002
034700*---------------------------------------------------------------* 03470002
034800*  RECORD LAYOUT FOR THE LIST INPUT                             * 03480002
034900*---------------------------------------------------------------* 03490002
035000     COPY PCWS121.                                                03500002
035100                                                                  03510002
035200                                                                  03520002
035300*---------------------------------------------------------------* 03530002
035400*    MAP LAYOUT                                                 * 03540002
035500*---------------------------------------------------------------* 03550002
035600                                                                  03560002
035700     COPY PCKM703.                                                03570002
035800                                                                  03580002
035900 01  MR-OCCURS-LAYOUT                   REDEFINES  PC703AO.       03590002
036000     05  FILLER                         PIC X(360).               03600026
036100     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03610002
036200         10  MR-SELECTL                 PIC S9(04) COMP.          03620002
036300         10  MR-SELECTA                 PIC  X(01).               03630002
036400         10  MR-SELECTC                 PIC  X(01).               03640002
036500         10  MR-SELECTH                 PIC  X(01).               03650002
036600         10  MR-SELECT                  PIC  X(01).               03660002
036700                                                                  03670002
036800         10  MR-ACTIONL                 PIC S9(04) COMP.          03680002
036900         10  MR-ACTIONA                 PIC  X(01).               03690002
037000         10  MR-ACTIONC                 PIC  X(01).               03700002
037100         10  MR-ACTIONH                 PIC  X(01).               03710002
037200         10  MR-ACTION                  PIC  X(03).               03720002
037300                                                                  03730002
037400         10  MR-STOREL                  PIC S9(04) COMP.          03740002
037500         10  MR-STOREA                  PIC  X(01).               03750002
037600         10  MR-STOREC                  PIC  X(01).               03760002
037700         10  MR-STOREH                  PIC  X(01).               03770002
037800         10  MR-STORE                   PIC  Z(04).               03780002
037900                                                                  03790002
038000         10  MR-PKSLQTYL                PIC S9(04) COMP.          03800002
038100         10  MR-PKSLQTYA                PIC  X(01).               03810002
038200         10  MR-PKSLQTYC                PIC  X(01).               03820002
038300         10  MR-PKSLQTYH                PIC  X(01).               03830002
038400         10  MR-PKSLQTY                 PIC  ZZZZ9.               03840002
038500         10  MR-PKSLQTY-X REDEFINES MR-PKSLQTY PIC X(05).         03850002
038600                                                                  03860002
038700         10  MR-P2QTYL                  PIC S9(04) COMP.          03870002
038800         10  MR-P2QTYA                  PIC  X(01).               03880002
038900         10  MR-P2QTYC                  PIC  X(01).               03890002
039000         10  MR-P2QTYH                  PIC  X(01).               03900002
039100         10  MR-P2QTY                   PIC  ZZZZZ.               03910002
039200                                                                  03920002
039300         10  MR-SHIPQTYL                PIC S9(04) COMP.          03930002
039400         10  MR-SHIPQTYA                PIC  X(01).               03940002
039500         10  MR-SHIPQTYC                PIC  X(01).               03950002
039600         10  MR-SHIPQTYH                PIC  X(01).               03960002
039700         10  MR-SHIPQTY                 PIC  ZZZZZ.               03970002
039800                                                                  03980002
039900         10  MR-ODD-CART-SWL            PIC S9(04) COMP.          03990002
040000         10  MR-ODD-CART-SWA            PIC  X(01).               04000002
040100         10  MR-ODD-CART-SWC            PIC  X(01).               04010002
040200         10  MR-ODD-CART-SWH            PIC  X(01).               04020002
040300         10  MR-ODD-CART-SW             PIC  X.                   04030002
040400                                                                  04040002
040500         10  MR-CARTQTYL                PIC S9(04) COMP.          04050002
040600         10  MR-CARTQTYA                PIC  X(01).               04060002
040700         10  MR-CARTQTYC                PIC  X(01).               04070002
040800         10  MR-CARTQTYH                PIC  X(01).               04080002
040900         10  MR-CARTQTY                 PIC  ZZZZZ.               04090002
041000                                                                  04100002
041100         10  MR-FCSE-CARTQTYL           PIC S9(04) COMP.          04110002
041200         10  MR-FCSE-CARTQTYA           PIC  X(01).               04120002
041300         10  MR-FCSE-CARTQTYC           PIC  X(01).               04130002
041400         10  MR-FCSE-CARTQTYH           PIC  X(01).               04140002
041500         10  MR-FCSE-CARTQTY            PIC  ZZZZZ.               04150002
041600                                                                  04160002
041700         10  MR-INPK-CARTQTYL           PIC S9(04) COMP.          04170002
041800         10  MR-INPK-CARTQTYA           PIC  X(01).               04180002
041900         10  MR-INPK-CARTQTYC           PIC  X(01).               04190002
042000         10  MR-INPK-CARTQTYH           PIC  X(01).               04200002
042100         10  MR-INPK-CARTQTY            PIC  ZZZZZ.               04210002
042200     05  FILLER                         PIC  X(12).               04220015
042300                                                                  04230002
042400*---------------------------------------------------------------* 04240002
042500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04250002
042600*---------------------------------------------------------------* 04260002
042700                                                                  04270002
042800     COPY DPWS015.                                                04280002
042900                                                                  04290002
043000*---------------------------------------------------------------* 04300002
043100*    FUNCTION KEYS COPYBOOK.                                    * 04310002
043200*---------------------------------------------------------------* 04320002
043300                                                                  04330002
043400     COPY DPWS016.                                                04340002
043500                                                                  04350002
043600*---------------------------------------------------------------* 04360002
043700*    NUMERIC EDIT LAYOUT.                                       * 04370002
043800*---------------------------------------------------------------* 04380002
043900                                                                  04390002
044000     COPY DPWS010I.                                               04400002
044100                                                                  04410002
044200*----------------------------------------------------------------*04420040
044300*  COPYBOOK USED TO FOR ITEM ACCESS MODULE                        04430040
044400*  (XLKUT001)                                                     04440040
044500*----------------------------------------------------------------*04450040
044600     COPY XLWS001.                                                04460040
044700/                                                                 04470040
044800*----------------------------------------------------------------*04480002
044900*  SENDING/RECEIVING AREA FOR THE                                *04490002
045000*  PRINTER VALIDATION ROUTING (DPKCS060)                         *04500002
045100*----------------------------------------------------------------*04510002
045200     COPY DPWS072.                                                04520002
045300                                                                  04530002
045400                                                                  04540002
045500*---------------------------------------------------------------* 04550002
045600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 04560002
045700*---------------------------------------------------------------* 04570002
045800     COPY DPWS030.                                                04580002
045810     COPY DPWS930.                                                04581078
045900                                                                  04590002
046000                                                                  04600002
046100*---------------------------------------------------------------* 04610002
046200*  RECORD LAYOUT FOR THE LABEL PRINT MODULE - STORE DETAIL        04620002
046300*---------------------------------------------------------------* 04630002
046400     COPY PCWS128.                                                04640002
046500                                                                  04650002
046600                                                                  04660002
046700*---------------------------------------------------------------* 04670002
046800*  RECORD LAYOUT FOR THE LABEL PRINT MODULE - HEADER DETAIL       04680002
046900*---------------------------------------------------------------* 04690002
047000     COPY PCWS126.                                                04700002
047100                                                                  04710002
047200                                                                  04720002
047300*---------------------------------------------------------------* 04730002
047400*    STANDARD COMMAREA.                                         * 04740002
047500*---------------------------------------------------------------* 04750002
047600     COPY DPWS020.                                                04760002
047700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04770002
047800                                                                  04780002
047900*---------------------------------------------------------------* 04790002
048000* INTER-APPLICATION COMMAREA.                                   * 04800002
048100*   PCWS120 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04810002
048200*             SPEC SCREEN.                                      * 04820002
048300*   PCWS122 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM      * 04830002
048400*             THE LIST SCREEN                                   * 04840002
048500*---------------------------------------------------------------* 04850002
048600                                                                  04860002
048700         10  INTER-APPL-COMM-AREA       PIC X(200).               04870002
048800     COPY PCWS120.                                                04880002
048900     COPY PCWS122.                                                04890002
049000*---------------------------------------------------------------* 04900002
049100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04910002
049200*---------------------------------------------------------------* 04920002
049300         10  ASC-SPECIFIC-COMMAREA.                               04930002
049400             15  ASC-PO-NBR                   PIC S9(09) COMP.    04940002
049500             15  ASC-REC-SEQ-NBR              PIC S9(09) COMP.    04950002
049600             15  ASC-OPER-UNT-ID              PIC S9(04).         04960002
049700             15  ASC-FCLTY-ID                 PIC S9(04).         04970002
049800             15  ASC-CURR-OPER-UNT-ID         PIC S9(04).         04980002
049900             15  ASC-CURR-FCLTY-ID            PIC S9(04).         04990002
050000             15  ASC-CL-NBR                   PIC  X(02).         05000046
050100             15  ASC-SML-P2L-PRTR-ID          PIC  X(08).         05010002
050200             15  ASC-SML-P2L-PRTR-ID-N REDEFINES                  05020002
050300                 ASC-SML-P2L-PRTR-ID          PIC  9(08).         05030002
050400             15  FILLER  REDEFINES  ASC-SML-P2L-PRTR-ID.          05040002
050500                 20  FILLER                   PIC  X(05).         05050002
050600                 20  ASC-SML-P2L-PRTR-ID-3    PIC  X(03).         05060002
050700             15  ASC-PGYBCK-PRTR-ID           PIC  X(08).         05070002
050800             15  ASC-PGYBCK-PRTR-ID-N  REDEFINES                  05080002
050900                 ASC-PGYBCK-PRTR-ID           PIC  9(08).         05090002
051000             15  FILLER  REDEFINES  ASC-PGYBCK-PRTR-ID.           05100002
051100                 20  FILLER                   PIC  X(05).         05110002
051200                 20  ASC-PGYBCK-PRTR-ID-3     PIC  X(03).         05120002
051300             15  ASC-MODU-NBR                 PIC  X(03).         05130002
051400             15  ASC-DFLT-STR-ZN-ID           PIC  X(05).         05140002
051500             15  ASC-P2L-CART-CNT             PIC S9(09) COMP-3.  05150002
051600             15  ASC-P2L-QTY                  PIC S9(09) COMP-3.  05160002
051700             15  ASC-SHIP-CART-CNT            PIC S9(09) COMP-3.  05170002
051800             15  ASC-SHIP-QTY                 PIC S9(09) COMP-3.  05180002
051900             15  ASC-PROC-CART-CNT            PIC S9(09) COMP-3.  05190002
052000             15  ASC-PROC-QTY                 PIC S9(09) COMP-3.  05200002
052100             15  ASC-PKSL-QTY                 PIC S9(09) COMP-3.  05210002
052200             15  ASC-INPK-UNT-QTY             PIC S9(04) COMP-3.  05220002
052300             15  ASC-OTPK-UNT-QTY             PIC S9(04) COMP-3.  05230002
052400             15  ASC-INPK-CNVYB-IND           PIC  X(01).         05240002
052500             15  ASC-CRE-LBL-IND              PIC  X(01).         05250002
052600                 88  ASC-CRE-BOTH-LBL             VALUE 'B'.      05260002
052700                 88  ASC-CRE-P2L-LBL              VALUE 'P'.      05270002
052800                 88  ASC-CRE-SML-LBL              VALUE 'C'.      05280002
052900             15  ASC-LBL-PRT-ORDER            PIC  X(01).         05290002
053000                 88  ASC-SML-P2L-LABELS           VALUE 'S'.      05300004
053100                 88  ASC-PIGGYBACK-LABELS         VALUE 'P'.      05310004
053200             15  ASC-SPEC-INST-DESC           PIC  X(05).         05320002
053300             15  ASC-PO-LNE-NBR               PIC S9(04) COMP.    05330002
053400             15  ASC-SKU                      PIC  X(08).         05340037
053500             15  ASC-ITEM-NBR                 PIC  9(15).         05350037
053600             15  ASC-STATUS                   PIC  X(08).         05360002
053700             15  ASC-CRE-LBL-DESC             PIC  X(10).         05370002
053800             15  ASC-DPT-NBR                  PIC  X(03).         05380002
053900             15  ASC-PRT-QUEUE-NAME.                              05390002
054000                 20  ASC-PRT-TERM-ID          PIC  X(04).         05400002
054100                 20  ASC-PRT-TASK-NUMBER      PIC S9(05) COMP-3.  05410002
054200                 20  ASC-PRT-SEQ              PIC  9(01).         05420002
054300             15  ASC-BLK-SUB                  PIC S9(04)  COMP    05430002
054400                                                          SYNC.   05440002
054500             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    05450002
054600                                                          SYNC.   05460002
054700             15  ASC-SEL-SUB                  PIC S9(4)   COMP.   05470002
054800             15  ASC-SEL-ITEM                 PIC S9(4)   COMP.   05480002
054900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09)  COMP-3. 05490002
055000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09)  COMP-3. 05500002
055100             15  ASC-ITEMS-DISPLAYED          PIC S9(03)  COMP-3. 05510002
055200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09)  COMP-3. 05520002
055300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09)  COMP-3. 05530002
055400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04)  COMP    05540002
055500                                                          SYNC.   05550002
055600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09)  COMP-3. 05560002
055700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09)  COMP-3. 05570002
055800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05580002
055900                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05590002
056000                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05600002
056100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05610002
056200                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05620002
056300                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05630002
056400             15  ASC-LIST-QUEUE-NAME.                             05640002
056500                 20  ASC-LIST-TERM-ID         PIC  X(04).         05650002
056600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05)  COMP-3. 05660002
056700                 20  ASC-LIST-SEQ             PIC  9(01).         05670002
056800             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05680002
056900             15  ASC-SEL-QUEUE-NAME.                              05690002
057000                 20  ASC-SEL-TERM-ID          PIC  X(04).         05700002
057100                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05710002
057200                 20  ASC-SEL-SEQ              PIC  9(01).         05720002
057300                                                                  05730002
057400             15  ASC-START-ITEM-REQUEST.                          05740002
057500                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05750002
057600             15  ASC-USE-SELECTION-QUEUE-IND  PIC X(1).           05760002
057700                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   05770002
057800             15  ASC-DISTHD-ORIG-LBL-TYP      PIC  X(01).         05780002
057900             15  ASC-ODD-CARTON               PIC S9(04) COMP-3.  05790002
058000             15  ASC-ODD-CARTON-USE-SW        PIC  X(01).         05800002
058100                 88  ASC-ODD-CRTN-FCSE             VALUE 'F'.     05810002
058200                 88  ASC-ODD-CRTN-INPK             VALUE 'I'.     05820002
058300                 88  ASC-ODD-CRTN-P2L              VALUE 'P'.     05830002
058400                 88  ASC-ODD-CRTN-NONE             VALUE 'N'.     05840002
058500             15  ASC-DC-PRTD-AT               PIC  X(02).         05850002
058600             15  ASC-PKGNG-CD                 PIC  X(01).         05860009
058700                 88  ASC-PRE-PACK-ORDER           VALUE 'I', 'M'. 05870009
058800                 88  ASC-INNER-PREPK              VALUE 'I'.      05880009
058900                 88  ASC-MULTI-SKU-PREPK          VALUE 'M'.      05890009
059000                 88  ASC-SINGLE-SKU-PREPK         VALUE 'S'.      05900009
059100                 88  ASC-CASEPACK                 VALUE 'C'.      05910009
059200                 88  ASC-BULK-PACK                VALUE 'B'.      05920009
059300             15  ASC-DSPLY-PKGNG-CD           PIC  X(01).         05930020
059400                 88  ASC-DSP-PRE-PACK-ORDER       VALUE 'I', 'M'. 05940020
059500                 88  ASC-DSP-INNER-PREPK          VALUE 'I'.      05950020
059600                 88  ASC-DSP-MULTI-SKU-PREPK      VALUE 'M'.      05960020
059700                 88  ASC-DSP-SINGLE-SKU-PREPK     VALUE 'S'.      05970020
059800                 88  ASC-DSP-CASEPACK             VALUE 'C'.      05980020
059900                 88  ASC-DSP-BULK-PACK            VALUE 'B'.      05990020
060000             15  ASC-PREPK-ID                 PIC S9(04) COMP.    06000012
060100             15  ASC-PREPK-RATIO              PIC S9(04) COMP.    06010012
060200             15  ASC-PACKS-IN-CRTN            PIC S9(04) COMP.    06020012
060300             15  ASC-SIGNON-USERID            PIC X(08).          06030014
060400             15  ASC-P2L-PAK                  PIC S9(09) COMP-3.  06040017
060500             15  ASC-SHIP-PAK                 PIC S9(09) COMP-3.  06050017
060600             15  ASC-PROC-PAK                 PIC S9(09) COMP-3.  06060017
060700             15  ASC-PKSL-PAK                 PIC S9(09) COMP-3.  06070017
060800             15  ASC-USE-UCC128-IND           PIC X(01).          06080025
060900                 88  ASC-USE-UCC128-YES           VALUE 'Y'.      06090025
061000                 88  ASC-USE-UCC128-NO            VALUE 'N'.      06100025
061100                 88  ASC-USE-UCC128-IGNORE        VALUE 'I'.      06110025
061110             15  ASC-ERR-ON-LABEL-DWNLD-SW    PIC  X(01).         06111068
061120                 88  ASC-ERR-ON-LABEL-DWNLD          VALUE 'Y'.   06112068
061130                 88  ASC-ERR-ON-LABEL-DWNLD-NO       VALUE 'N'.   06113068
061140* 10/05/10 - DMH - begin                                          06114073
061150             15  ASC-TRIP-ARRIVE-DATE        PIC  X(10).          06115073
061160             15  ASC-TRIP-ARRIVE-DATE-R                           06116073
061170                 REDEFINES ASC-TRIP-ARRIVE-DATE.                  06117073
061180                 20  ASC-TRIP-ARRIVE-CCYY    PIC  X(04).          06118073
061190                 20  ASC-TRIP-ARRIVE-DASH1   PIC  X(01).          06119073
061191                 20  ASC-TRIP-ARRIVE-MM      PIC  X(02).          06119173
061192                 20  ASC-TRIP-ARRIVE-DASH2   PIC  X(01).          06119273
061193                 20  ASC-TRIP-ARRIVE-DD      PIC  X(02).          06119373
061194* 10/05/10 - DMH - end                                            06119473
061200                                                                  06120002
061300         10  ASC-SPECIFIC-COMMAREA-2.                             06130002
061400                                                                  06140002
061500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06150002
061600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06160002
061700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06170002
061800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06180002
061900                                                                  06190002
062000                 20  ASC-ITEM-ARRAY.                              06200002
062100                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        06210002
062200                         30  ASC-LIST-ITEM-NUMBER                 06220002
062300                                                     PIC S9(09)   06230002
062400                                                     COMP-3.      06240002
062500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06250002
062600                             88  ASC-VALID-SELECT    VALUE ' '    06260002
062700                                                           'S'    06270002
062800                                                           'B'    06280002
062900                                                           'E'.   06290002
063000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06300002
063100                             88  ASC-TEMP-SELECT     VALUE 'S'.   06310002
063200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06320002
063300                             88  ASC-TEMP-END        VALUE 'E'.   06330002
063400                         30  ASC-SELECTED-SW         PIC  X(01).  06340002
063500                             88  ASC-NO-SELECT       VALUE ' '.   06350002
063600                             88  ASC-SELECT          VALUE 'S'.   06360002
063700                             88  ASC-BEGIN           VALUE 'B'.   06370002
063800                             88  ASC-END             VALUE 'E'.   06380002
063900                         30  ASC-ACTION              PIC  X(03).  06390002
064000                         30  ASC-STORE               PIC  X(04).  06400002
064100                         30  ASC-PKSLQTY             PIC  9(05).  06410002
064200                         30  ASC-P2QTY               PIC  9(05).  06420002
064300                         30  ASC-SHIPQTY             PIC  9(05).  06430002
064400                         30  ASC-CARTQTY             PIC  9(05).  06440002
064500                         30  ASC-ODD-CART-SW         PIC  X(01).  06450002
064600                         30  ASC-FCSE-CART-QTY       PIC  9(05).  06460002
064700                         30  ASC-INPK-CART-QTY       PIC  9(05).  06470002
064800                         30  ASC-STORE-TYPE          PIC  X(02).  06480002
064900                         30  ASC-PKSLPAK             PIC  9(05).  06490017
065000                         30  ASC-P2PAK               PIC  9(05).  06500017
065100                         30  ASC-SHIPPAK             PIC  9(05).  06510017
065200         10  FILLER                                  PIC X(940).  06520073
065300                                                                  06530002
065400*---------------------------------------------------------------* 06540002
065500*    ABEND PROCESSING COPYBOOK.                                 * 06550002
065600*---------------------------------------------------------------* 06560002
065700                                                                  06570002
065800     COPY DPWS013.                                                06580002
065900                                                                  06590002
066000                                                                  06600002
066100*---------------------------------------------------------------* 06610002
066200*    RC - RECEIPT ITEM TABLE                                    * 06620002
066300*---------------------------------------------------------------* 06630002
066400     EXEC SQL                                                     06640002
066500          INCLUDE TRECITM                                         06650002
066600     END-EXEC.                                                    06660002
066700                                                                  06670002
066800*---------------------------------------------------------------* 06680002
066900*    PO - PURCHASE ITEM TABLE                                   * 06690002
067000*---------------------------------------------------------------* 06700002
067100     EXEC SQL                                                     06710002
067200          INCLUDE TPURITM                                         06720002
067300     END-EXEC.                                                    06730002
067400                                                                  06740002
067500*---------------------------------------------------------------* 06750002
067600*    PO - PURCHASE ORDER TABLE                                  * 06760002
067700*---------------------------------------------------------------* 06770002
067800     EXEC SQL                                                     06780002
067900          INCLUDE TPURCHS                                         06790002
068000     END-EXEC.                                                    06800002
068100                                                                  06810002
068200*---------------------------------------------------------------* 06820002
068300*    RC-RECEIPT DISTRIBUTION                                    * 06830002
068400*---------------------------------------------------------------* 06840002
068500     EXEC SQL                                                     06850002
068600          INCLUDE TRECDIS                                         06860002
068700     END-EXEC.                                                    06870002
068800                                                                  06880002
068900*---------------------------------------------------------------* 06890002
069000*    DC-DISTRIBUTION TRANSACTION HEADER                         * 06900002
069100*---------------------------------------------------------------* 06910002
069200     EXEC SQL                                                     06920002
069300          INCLUDE TDISTHD                                         06930002
069400     END-EXEC.                                                    06940002
069500                                                                  06950002
069600*---------------------------------------------------------------* 06960002
069700*    DC-DISTRIBUTION TRANSACTION DETAIL                         * 06970002
069800*---------------------------------------------------------------* 06980002
069900     EXEC SQL                                                     06990002
070000          INCLUDE TDISTDT                                         07000002
070100     END-EXEC.                                                    07010002
070200                                                                  07020002
070300*---------------------------------------------------------------* 07030002
070400*    CR-STORE TABLE (XLT_LOC)                                   * 07040064
070500*---------------------------------------------------------------* 07050002
070600     EXEC SQL                                                     07060002
070700          INCLUDE XLT00010                                        07070064
070800     END-EXEC.                                                    07080002
070900                                                                  07090002
071000*---------------------------------------------------------------* 07100005
071100*      -SKU TABLE                                               * 07110005
071200*---------------------------------------------------------------* 07120005
071300     EXEC SQL                                                     07130005
071400          INCLUDE TSK                                             07140005
071500     END-EXEC.                                                    07150005
071600                                                                  07160005
071700*---------------------------------------------------------------* 07170007
071800*      -COMPANY CONTROL TABLE                                   * 07180007
071900*---------------------------------------------------------------* 07190007
072000     EXEC SQL                                                     07200007
072100          INCLUDE TCOCNTL                                         07210007
072200     END-EXEC.                                                    07220007
072300                                                                  07230007
072400*---------------------------------------------------------------* 07240027
072500*   SU - VIRTUAL LABEL DATA TABLE                               * 07250027
072600*---------------------------------------------------------------* 07260027
072700     EXEC SQL                                                     07270027
072800          INCLUDE TLBVRDA                                         07280027
072900     END-EXEC.                                                    07290027
073000                                                                  07300027
073100*---------------------------------------------------------------* 07310051
073200*                                                               * 07320051
073300*---------------------------------------------------------------* 07330051
073400     EXEC SQL                                                     07340051
073500          INCLUDE TSULBXF                                         07350051
073600     END-EXEC.                                                    07360051
073700                                                                  07370051
073710*---------------------------------------------------------------* 07371069
073720*      -OUTBOUND CARTON TABLE  (SUT_OTBND_CART)                 * 07372069
073730*---------------------------------------------------------------* 07373069
073740     EXEC SQL                                                     07374069
073750          INCLUDE SUT00024                                        07375069
073760     END-EXEC.                                                    07376069
073770                                                                  07377069
073780*---------------------------------------------------------------* 07378069
073790*      -OUTBOUND UPC TABLE  (SUT_OTBND_UPC )                 *    07379069
073791*---------------------------------------------------------------* 07379169
073792     EXEC SQL                                                     07379269
073793          INCLUDE SUT00028                                        07379369
073794     END-EXEC.                                                    07379469
073795                                                                  07379569
073800*---------------------------------------------------------------* 07380002
073820*      -PARAMETER TABLE                                      *    07382071
073830*---------------------------------------------------------------* 07383071
073840     EXEC SQL                                                     07384071
073850          INCLUDE TKRPRPM                                         07385071
073860     END-EXEC.                                                    07386071
073870                                                                  07387071
073880*---------------------------------------------------------------* 07388071
073900*    DB2 AREA FOR COMMUNICATIONS                                * 07390002
074000*---------------------------------------------------------------* 07400002
074100     EXEC SQL                                                     07410002
074200          INCLUDE SQLCA                                           07420002
074300     END-EXEC.                                                    07430002
074400                                                                  07440002
074500                                                                  07450002
074600*---------------------------------------------------------------* 07460002
074700*   PO/RECEIVER/LINE CURSOR PULLS ALL STORES FOR THE LINE       * 07470002
074800*---------------------------------------------------------------* 07480002
074900     EXEC SQL                                                     07490002
075000          DECLARE PO-ALL-STR-CSR CURSOR FOR                       07500002
075100              SELECT A.STR_NBR                                    07510002
075200                    ,C.LOC_TYP_CDE                                07520064
075300                    ,B.EXPTED_ITM_QTY                             07530002
075400                    ,A.P2L_SPLT_UNT_QTY                           07540002
075500                    ,A.FCSE_SPLT_UNT_QTY                          07550002
075600                    ,A.INPK_SPLT_UNT_QTY                          07560002
075700                    ,A.ODD_CART_IND                               07570002
075800                FROM TDISTDT A                                    07580002
075900                    ,TRECDIS B                                    07590002
076000                    ,XLT_LOC C                                    07600064
076100               WHERE A.ORD_NBR           = :ASC-PO-NBR            07610002
076200                 AND A.ORD_NBR           = B.ORD_NBR              07620002
076300                 AND A.RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR       07630002
076400                 AND A.RCVR_SEQ_NBR      = B.REC_SEQ_NBR          07640002
076500                 AND A.ORD_LNE_NBR       = :ASC-PO-LNE-NBR        07650002
076600                 AND A.ORD_LNE_NBR       = B.ORD_LNE_NBR          07660002
076700                 AND A.STR_NBR           = B.STR_NBR              07670002
076800                 AND B.STR_NBR           = C.LOC_NBR              07680065
077000          ORDER BY                                                07700002
077100                A.STR_NBR                                         07710002
077200     END-EXEC.                                                    07720002
077300                                                                  07730002
077400                                                                  07740002
077500*---------------------------------------------------------------* 07750049
077600*   FULL CASE CARTON CURSOR                                     * 07760049
077700*---------------------------------------------------------------* 07770049
077800     EXEC SQL                                                     07780050
077900          DECLARE FCSE-CTN-CSR CURSOR FOR                         07790050
078000           SELECT 'A'                                             07800050
078100                 , COUNT(*)                                       07810050
078200             FROM TLBVRDA                                         07820050
078300            WHERE PO_NBR           = :ASC-PO-NBR                  07830050
078400              AND RCVR_SEQ_NBR     = :ASC-REC-SEQ-NBR             07840050
078500              AND PO_LNE_NBR       = :ASC-PO-LNE-NBR              07850050
078600              AND DEST_OPER_UNT_ID = :DISTDT-STR-NBR              07860050
078700              AND INPK_CNVYB_IND   = 'N'                          07870050
078800              AND LBL_ASG_IND      = 'N'                          07880050
078900           UNION                                                  07890050
079000           SELECT 'B'                                             07900050
079100                , COUNT(*)                                        07910050
079200             FROM TLBVRDA A                                       07920050
079300                 ,TSULBXF B                                       07930050
079400            WHERE A.PO_NBR           = :ASC-PO-NBR                07940050
079500              AND A.RCVR_SEQ_NBR     = :ASC-REC-SEQ-NBR           07950050
079600              AND A.PO_LNE_NBR       = :ASC-PO-LNE-NBR            07960050
079700              AND A.DEST_OPER_UNT_ID = :DISTDT-STR-NBR            07970050
079800              AND A.INPK_CNVYB_IND   = 'N'                        07980050
079900              AND A.LBL_ASG_IND      = 'Y'                        07990050
080000              AND A.BRCDE_NBR        = B.BRCDE_NBR                08000050
080100              AND B.DEST_OPER_UNT_ID = A.DEST_OPER_UNT_ID         08010050
080200     END-EXEC.                                                    08020049
080300                                                                  08030049
080400*---------------------------------------------------------------* 08040055
080500*   FULL CASE PREPACK CARTON CURSOR                             * 08050055
080600*---------------------------------------------------------------* 08060055
080700     EXEC SQL                                                     08070055
080800          DECLARE FCSE-CTN-PRPK-CSR CURSOR FOR                    08080056
080900           SELECT 'A'                                             08090055
081000                 , COUNT(*)                                       08100055
081100             FROM TLBVRDA                                         08110055
081200            WHERE PO_NBR           = :ASC-PO-NBR                  08120055
081300              AND RCVR_SEQ_NBR     = :ASC-REC-SEQ-NBR             08130055
081400              AND PREPK_ID         = :ASC-PREPK-ID                08140055
081500              AND DEST_OPER_UNT_ID = :DISTDT-STR-NBR              08150055
081600              AND INPK_CNVYB_IND   = 'N'                          08160055
081700              AND LBL_ASG_IND      = 'N'                          08170055
081800           UNION                                                  08180055
081900           SELECT 'B'                                             08190055
082000                , COUNT(*)                                        08200055
082100             FROM TLBVRDA A                                       08210055
082200                 ,TSULBXF B                                       08220055
082300            WHERE A.PO_NBR           = :ASC-PO-NBR                08230055
082400              AND A.RCVR_SEQ_NBR     = :ASC-REC-SEQ-NBR           08240055
082500              AND PREPK_ID           = :ASC-PREPK-ID              08250055
082600              AND A.DEST_OPER_UNT_ID = :DISTDT-STR-NBR            08260055
082700              AND A.INPK_CNVYB_IND   = 'N'                        08270055
082800              AND A.LBL_ASG_IND      = 'Y'                        08280055
082900              AND A.BRCDE_NBR        = B.BRCDE_NBR                08290055
083000              AND B.DEST_OPER_UNT_ID = A.DEST_OPER_UNT_ID         08300055
083300     END-EXEC.                                                    08330055
083400                                                                  08340055
083500                                                                  08350055
083600*---------------------------------------------------------------* 08360057
083700*   INNER PACK CARTON COUNT CURSOR                              * 08370057
083800*---------------------------------------------------------------* 08380057
083900                                                                  08390057
084000     EXEC SQL                                                     08400057
084100          DECLARE INPK-CTN-CSR CURSOR FOR                         08410057
084200           SELECT 'A'                                             08420057
084300                 , COUNT(*)                                       08430057
084400             FROM TLBVRDA                                         08440057
084500            WHERE PO_NBR            = :ASC-PO-NBR                 08450057
084600              AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR            08460057
084700              AND PO_LNE_NBR        = :ASC-PO-LNE-NBR             08470059
084800              AND DEST_OPER_UNT_ID  = :DISTDT-STR-NBR             08480057
084900              AND INPK_CNVYB_IND    = 'Y'                         08490057
085000              AND LBL_ASG_IND       = 'N'                         08500057
085100          UNION                                                   08510057
085200          SELECT 'B'                                              08520057
085300               , COUNT(*)                                         08530057
085400            FROM TLBVRDA A                                        08540057
085500                ,TSULBXF B                                        08550057
085600           WHERE A.PO_NBR           = :ASC-PO-NBR                 08560057
085700             AND A.RCVR_SEQ_NBR     = :ASC-REC-SEQ-NBR            08570057
085800             AND A.PO_LNE_NBR       = :ASC-PO-LNE-NBR             08580057
085900             AND A.DEST_OPER_UNT_ID = :DISTDT-STR-NBR             08590057
086000             AND A.INPK_CNVYB_IND   = 'Y'                         08600057
086100             AND A.LBL_ASG_IND      = 'Y'                         08610057
086200             AND A.BRCDE_NBR        = B.BRCDE_NBR                 08620057
086300             AND B.DEST_OPER_UNT_ID = A.DEST_OPER_UNT_ID          08630057
086400     END-EXEC.                                                    08640057
086500                                                                  08650057
086600*---------------------------------------------------------------* 08660057
086700*   INNER PACK CARTON COUNT CURSOR - PREPACK                    * 08670057
086800*---------------------------------------------------------------* 08680057
086900                                                                  08690057
087000     EXEC SQL                                                     08700057
087100          DECLARE INPK-CTN-PRPK-CSR CURSOR FOR                    08710057
087200           SELECT 'A'                                             08720057
087300                 , COUNT(*)                                       08730057
087400             FROM TLBVRDA                                         08740057
087500            WHERE PO_NBR             = :ASC-PO-NBR                08750060
087600              AND RCVR_SEQ_NBR       = :ASC-REC-SEQ-NBR           08760060
087700              AND PREPK_ID           = :ASC-PREPK-ID              08770060
087800              AND DEST_OPER_UNT_ID   = :DISTDT-STR-NBR            08780060
087900              AND INPK_CNVYB_IND     = 'Y'                        08790060
088000              AND LBL_ASG_IND        = 'N'                        08800060
088100          UNION                                                   08810057
088200          SELECT 'B'                                              08820057
088300               , COUNT(*)                                         08830057
088400            FROM TLBVRDA A                                        08840057
088500                ,TSULBXF B                                        08850057
088600           WHERE A.PO_NBR             = :ASC-PO-NBR               08860060
088700             AND A.RCVR_SEQ_NBR       = :ASC-REC-SEQ-NBR          08870060
088800             AND PREPK_ID             = :ASC-PREPK-ID             08880060
088900             AND A.DEST_OPER_UNT_ID   = :DISTDT-STR-NBR           08890060
089000             AND A.INPK_CNVYB_IND     = 'Y'                       08900060
089100             AND A.LBL_ASG_IND        = 'Y'                       08910060
089200             AND A.BRCDE_NBR          = B.BRCDE_NBR               08920060
089300             AND B.DEST_OPER_UNT_ID   = A.DEST_OPER_UNT_ID        08930060
089400     END-EXEC.                                                    08940057
089500                                                                  08950057
089600                                                                  08960057
089700 LINKAGE SECTION.                                                 08970057
089800                                                                  08980002
089900 01  DFHCOMMAREA.                                                 08990002
090000     05  FILLER                         OCCURS  1 TO 4072 TIMES   09000002
090100                                        DEPENDING ON EIBCALEN.    09010002
090200         10  FILLER                     PIC X.                    09020002
090300                                                                  09030002
090400                                                                  09040002
090500 PROCEDURE DIVISION.                                              09050002
090600******************************************************************09060002
090700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09070002
090800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09080002
090900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09090002
091000******************************************************************09100002
091100 0000-MAIN-MODULE.                                                09110002
091200     INITIALIZE DP030-CICS-API-FIELDS.                            09120002
091300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09130002
091400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09140002
091500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09150002
091600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09160002
091700     MOVE LENGTH OF PC703AI        TO DP030-MAP-LENGTH (1).       09170002
091800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09180002
091900     PERFORM 0001-CALL-CICS-ARCH-API.                             09190002
092000                                                                  09200002
092100     PERFORM 1000-CONTROL-PROCESSING                              09210002
092200                                                                  09220002
092300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09230002
092400     PERFORM 0001-CALL-CICS-ARCH-API.                             09240002
092500                                                                  09250002
092600******************************************************************09260002
092700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09270002
092800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **09280002
092900******************************************************************09290002
093000 0001-CALL-CICS-ARCH-API.                                         09300002
093100*    CALL 'DPKCS030' USING DFHEIBLK                               09310078
093110     CALL DP930-CICS-ARCH-API                                     09311078
093120                     USING DFHEIBLK                               09312078
093200                           DFHCOMMAREA                            09320002
093300                           DP030-CICS-API-FIELDS                  09330002
093400                           DP020-STANDARD-COMMAREA                09340002
093500                           PC703AI.                               09350002
093600                                                                  09360002
093700     IF  DP030-RC-CALL-SUCCESSFUL                                 09370002
093800         CONTINUE                                                 09380002
093900     ELSE                                                         09390002
094000         SET DP013-NO-ROLLBACK                                    09400002
094100             DP013-XCTL-DISPLAY-RESTART                           09410002
094200             DP013-CICS-ABEND      TO TRUE                        09420002
094300         MOVE '0001-CALL-CICS-ARCH-API'                           09430002
094400                                   TO DP013-PARAGRAPH             09440002
094500*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX09450078
094600*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      09460078
094610         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O09461078
094620-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09462078
094700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09470002
094800         PERFORM DP013-0000-PROCESS-ABEND                         09480002
094900     END-IF.                                                      09490002
095000                                                                  09500002
095100                                                                  09510002
095200*----------------------------------------------------------------*09520002
095300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09530002
095400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09540002
095500*                                                                *09550002
095600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09560002
095700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09570002
095800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09580002
095900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09590002
096000*----------------------------------------------------------------*09600002
096100 1000-CONTROL-PROCESSING.                                         09610002
096200                                                                  09620002
096300     EVALUATE TRUE                                                09630002
096400         WHEN DP020-NEXT-ACT-INITIAL                              09640002
096500             INITIALIZE ASC-SPECIFIC-COMMAREA                     09650002
096600             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09660002
096700                                      ASC-SEL-TERM-ID             09670002
096800                                      ASC-PRT-TERM-ID             09680002
096900             MOVE DP020-SRC-TASK-NUMBER                           09690002
097000                                   TO ASC-LIST-TASK-NUMBER        09700002
097100                                      ASC-SEL-TASK-NUMBER         09710002
097200                                      ASC-PRT-TASK-NUMBER         09720002
097300             MOVE PC-LIST-QUEUE-SEQ                               09730002
097400                                   TO ASC-LIST-SEQ                09740002
097500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09750002
097600             MOVE PC-PRINT-QUEUE-SEQ TO ASC-PRT-SEQ               09760002
097700             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09770002
097800             IF  PS-COMMAREA-NOT-VALID                            09780002
097900                 SET DP020-NEXT-ACT-APPL-ERROR                    09790002
098000                                   TO TRUE                        09800002
098100             ELSE                                                 09810002
098200                 PERFORM 4000-BUILD-INITIAL-PANEL                 09820002
098300             END-IF                                               09830002
098400                                                                  09840002
098500         WHEN DP020-NEXT-ACT-READ-MAP                             09850002
098600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09860002
098700                                   TO PV-TOP-ITEM                 09870002
098800             PERFORM 2000-PROCESS-PANEL                           09880002
098900                                                                  09890002
099000         WHEN DP020-NEXT-ACT-RETURN                               09900002
099100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09910002
099200                                   TO PV-TOP-ITEM                 09920002
099300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09930002
099400             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 09940002
099500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09950002
099600             MOVE -1                   TO APONBRL                 09960002
099700                                                                  09970002
099800         WHEN OTHER                                               09980002
099900             SET DP013-LOGIC-ABEND TO TRUE                        09990002
100000             SET DP013-NO-ROLLBACK TO TRUE                        10000002
100100             MOVE '1000-CONTROL-PROCESSING'                       10010002
100200                                   TO DP013-PARAGRAPH             10020002
100300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10030002
100400                                   TO DP013-MESSAGE-TEXT(1)       10040002
100500             PERFORM DP013-0000-PROCESS-ABEND                     10050002
100600                                                                  10060002
100700     END-EVALUATE.                                                10070002
100800                                                                  10080002
100900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10090002
101000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10100002
101100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10110002
101200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10120002
101300 1100-PROCESS-INTER-APPL-COMM.                                    10130002
101400                                                                  10140002
101500     SET PS-COMMAREA-VALID         TO TRUE.                       10150002
101600     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10160002
101700     IF  DP020-INT-APPL-FORMAT-IND =  PC-CRIT-SPEC-FORMAT         10170002
101800         MOVE PC120-PO-NBR         TO ASC-PO-NBR                  10180002
101900         MOVE PC120-REC-SEQ-NBR    TO ASC-REC-SEQ-NBR             10190002
102000         MOVE PC120-OPER-UNT-ID    TO ASC-OPER-UNT-ID             10200002
102100         MOVE PC120-FCLTY-ID       TO ASC-FCLTY-ID                10210002
102200         MOVE PC120-CURR-OPER-UNT-ID                              10220002
102300                                   TO ASC-CURR-OPER-UNT-ID        10230002
102400         MOVE PC120-CURR-FCLTY-ID  TO ASC-CURR-FCLTY-ID           10240002
102500         MOVE PC120-SML-P2L-PRTR-ID                               10250002
102600                                   TO ASC-SML-P2L-PRTR-ID         10260002
102700         MOVE PC120-PGYBCK-PRTR-ID TO ASC-PGYBCK-PRTR-ID          10270002
102800         MOVE PC120-DFLT-STR-ZN-ID TO ASC-DFLT-STR-ZN-ID          10280002
102900         MOVE PC120-CRE-LBL-IND    TO ASC-CRE-LBL-IND             10290002
103000         MOVE PC120-ODD-CARTON     TO ASC-ODD-CARTON              10300002
103100         MOVE PC120-ODD-CRTN-USE-SW TO ASC-ODD-CARTON-USE-SW      10310002
103200         MOVE PC120-DC-PRTD-AT     TO ASC-DC-PRTD-AT              10320009
103300         MOVE PC120-PKGNG-CD       TO ASC-PKGNG-CD                10330009
103400         MOVE PC120-DSPLY-PKGNG-CD TO ASC-DSPLY-PKGNG-CD          10340020
103500         MOVE PC120-PREPK-RATIO    TO ASC-PREPK-RATIO             10350018
103600         MOVE PC120-PREPK-ID       TO ASC-PREPK-ID                10360032
103700         MOVE PC120-PACKS-IN-CRTN  TO ASC-PACKS-IN-CRTN           10370036
103800         MOVE PC120-USE-UCC128-DATA-SW                            10380028
103900                                   TO ASC-USE-UCC128-IND          10390028
104000         MOVE PC120-DPT-NBR        TO ASC-DPT-NBR                 10400047
104010         MOVE PC120-TRIP-ARRIVE-DATE TO ASC-TRIP-ARRIVE-DATE      10401073
104100         EVALUATE TRUE                                            10410002
104200             WHEN ASC-CRE-BOTH-LBL                                10420002
104300                  MOVE  PC-P2L-CASE-DESC  TO  ASC-CRE-LBL-DESC    10430002
104400             WHEN ASC-CRE-P2L-LBL                                 10440002
104500                  MOVE  PC-P2L-LBL-DESC   TO  ASC-CRE-LBL-DESC    10450002
104600             WHEN ASC-CRE-SML-LBL                                 10460002
104700                  MOVE  PC-CASE-LBL-DESC  TO  ASC-CRE-LBL-DESC    10470002
104800         END-EVALUATE                                             10480002
104900         MOVE PC120-SPEC-INST-DESC TO ASC-SPEC-INST-DESC          10490002
105000         MOVE PC120-PO-LINE-NBR    TO ASC-PO-LNE-NBR              10500002
105100     END-IF.                                                      10510002
105200                                                                  10520002
105300     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              10530002
105400        IF PC122-NUMBER-OF-SELECTED-ITEMS > 0                     10540002
105500           MOVE PC122-PO-NBR         TO ASC-PO-NBR                10550002
105600           MOVE PC122-REC-SEQ-NBR    TO ASC-REC-SEQ-NBR           10560002
105700           MOVE PC122-OPER-UNT-ID    TO ASC-OPER-UNT-ID           10570002
105800           MOVE PC122-FCLTY-ID       TO ASC-FCLTY-ID              10580002
105900           MOVE PC122-CURR-OPER-UNT-ID                            10590002
106000                                     TO ASC-CURR-OPER-UNT-ID      10600002
106100           MOVE PC122-CURR-FCLTY-ID  TO ASC-CURR-FCLTY-ID         10610002
106200           MOVE PC122-SML-P2L-PRTR-ID                             10620002
106300                                     TO ASC-SML-P2L-PRTR-ID       10630002
106400           MOVE PC122-PGYBCK-PRTR-ID TO ASC-PGYBCK-PRTR-ID        10640002
106500           MOVE PC122-DFLT-STR-ZN-ID TO ASC-DFLT-STR-ZN-ID        10650002
106600           MOVE PC122-CRE-LBL-IND    TO ASC-CRE-LBL-IND           10660002
106700                                                                  10670037
106800           MOVE PC122-DC-PRTD-AT     TO ASC-DC-PRTD-AT            10680002
106900           MOVE PC122-PKGNG-CD       TO ASC-PKGNG-CD              10690009
107000           MOVE PC122-DSPLY-PKGNG-CD TO ASC-DSPLY-PKGNG-CD        10700020
107100           MOVE PC122-DPT-NBR        TO ASC-DPT-NBR               10710042
107110           MOVE PC122-TRIP-ARRIVE-DATE TO ASC-TRIP-ARRIVE-DATE    10711073
107200           EVALUATE TRUE                                          10720002
107300               WHEN ASC-CRE-BOTH-LBL                              10730002
107400                  MOVE  PC-P2L-CASE-DESC  TO  ASC-CRE-LBL-DESC    10740002
107500               WHEN ASC-CRE-P2L-LBL                               10750002
107600                  MOVE  PC-P2L-LBL-DESC   TO  ASC-CRE-LBL-DESC    10760002
107700               WHEN ASC-CRE-SML-LBL                               10770002
107800                  MOVE  PC-CASE-LBL-DESC  TO  ASC-CRE-LBL-DESC    10780002
107900           END-EVALUATE                                           10790002
108000           SET ASC-USE-SELECTION-QUEUE    TO TRUE                 10800002
108100           MOVE PC122-NUMBER-OF-TS-ITEMS                          10810002
108200             TO ASC-NUMBER-OF-TS-ITEMS                            10820002
108300           MOVE PC122-SEL-QUEUE-NAME      TO ASC-SEL-QUEUE-NAME   10830002
108400           PERFORM 1120-PREPARE-LIST-ENTRY                        10840002
108500        ELSE                                                      10850002
108600           MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER         10860002
108700           SET  PS-COMMAREA-NOT-VALID TO TRUE                     10870002
108800       END-IF.                                                    10880002
108900                                                                  10890002
109000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10900002
109100 1120-PREPARE-LIST-ENTRY.                                         10910002
109200                                                                  10920002
109300     MOVE PC121-MAX-ITEMS          TO ASC-SEL-SUB.                10930002
109400     MOVE ZERO                     TO ASC-SEL-ITEM.               10940002
109500     PERFORM 1130-GET-NEXT-RECORD.                                10950002
109600                                                                  10960002
109700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10970002
109800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*10980002
109900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10990002
110000 1130-GET-NEXT-RECORD.                                            11000002
110100                                                                  11010002
110200     ADD +1                       TO ASC-SEL-SUB.                 11020002
110300                                                                  11030002
110400     IF  ASC-SEL-SUB > PC121-MAX-ITEMS                            11040002
110500         ADD +1                   TO ASC-SEL-ITEM                 11050002
110600         MOVE +1                  TO ASC-SEL-SUB                  11060002
110700     END-IF.                                                      11070002
110800                                                                  11080002
110900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                11090002
111000         PERFORM 9100-READ-SEL-QUEUE                              11100002
111100         IF  PC121-ITEM (ASC-SEL-SUB) > ZERO                      11110002
111200             MOVE PC121-PO-LNE-NBR (ASC-SEL-SUB)                  11120002
111300                                  TO ASC-PO-LNE-NBR               11130002
111400             MOVE PC121-CL-NBR  (ASC-SEL-SUB)                     11140046
111500                                  TO ASC-CL-NBR                   11150046
111600                                                                  11160037
111700             MOVE PC121-SKU-NBR (ASC-SEL-SUB)  TO ASC-SKU         11170040
111800             MOVE PC121-MODU-NBR (ASC-SEL-SUB)                    11180002
111900                                  TO PV-MOD-NBR-N                 11190002
112000             MOVE PV-MOD-NBR-3    TO ASC-MODU-NBR                 11200002
112100             MOVE PC121-INPK-UNT-QTY (ASC-SEL-SUB)                11210002
112200                                  TO ASC-INPK-UNT-QTY             11220002
112300             MOVE PC121-OTPK-UNT-QTY (ASC-SEL-SUB)                11230002
112400                                  TO ASC-OTPK-UNT-QTY             11240002
112500             MOVE PC121-INPK-CNVYB-IND (ASC-SEL-SUB)              11250002
112600                                       TO ASC-INPK-CNVYB-IND      11260002
112700             MOVE PC121-ODD-CARTON     (ASC-SEL-SUB)              11270002
112800                                       TO ASC-ODD-CARTON          11280002
112900             MOVE PC121-ODD-CRTN-USE-SW(ASC-SEL-SUB)              11290002
113000                                       TO ASC-ODD-CARTON-USE-SW   11300002
113100             MOVE PC121-PREPK-ID(ASC-SEL-SUB)                     11310012
113200                                       TO ASC-PREPK-ID            11320012
113300             MOVE PC121-PREPK-RATIO(ASC-SEL-SUB)                  11330012
113400                                       TO ASC-PREPK-RATIO         11340012
113500             MOVE PC121-PACKS-IN-CRTN(ASC-SEL-SUB)                11350012
113600                                       TO ASC-PACKS-IN-CRTN       11360012
113700             MOVE PC121-UCC128-USAGE (ASC-SEL-SUB)                11370025
113800                                       TO ASC-USE-UCC128-IND      11380025
113900             MOVE PC121-ITEM-NBR     (ASC-SEL-SUB)                11390045
114000                                       TO ASC-ITEM-NBR            11400045
114100             SET PC121-INQ (ASC-SEL-SUB)                          11410002
114200                                  TO TRUE                         11420002
114300             PERFORM 9200-REWRITE-SEL-QUEUE                       11430002
114400         ELSE                                                     11440002
114500             SUBTRACT +1 FROM ASC-SEL-SUB                         11450002
114600             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             11460002
114700             SET DP020-MSG-INFORMATIONAL                          11470002
114800                 PS-LIST-END             TO TRUE                  11480002
114900         END-IF                                                   11490002
115000     ELSE                                                         11500002
115100         SUBTRACT +1 FROM ASC-SEL-ITEM                            11510002
115200         MOVE PC121-MAX-ITEMS     TO ASC-SEL-SUB                  11520002
115300         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             11530002
115400         SET DP020-MSG-INFORMATIONAL                              11540002
115500             PS-LIST-END             TO TRUE                      11550002
115600     END-IF.                                                      11560002
115700                                                                  11570002
115800/                                                                 11580002
115900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11590002
116000*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *11600002
116100*    PROCESSED.                                                  *11610002
116200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11620002
116300                                                                  11630002
116400 1140-GET-PREV-RECORD.                                            11640002
116500                                                                  11650002
116600     SUBTRACT +1 FROM ASC-SEL-SUB.                                11660002
116700                                                                  11670002
116800     IF  ASC-SEL-SUB < +1                                         11680002
116900         SUBTRACT +1 FROM ASC-SEL-ITEM                            11690002
117000         MOVE PC121-MAX-ITEMS     TO ASC-SEL-SUB                  11700002
117100     END-IF.                                                      11710002
117200                                                                  11720002
117300     IF  ASC-SEL-ITEM > ZERO                                      11730002
117400         PERFORM 9100-READ-SEL-QUEUE                              11740002
117500         MOVE PC121-PO-LNE-NBR (ASC-SEL-SUB)                      11750002
117600                              TO ASC-PO-LNE-NBR                   11760002
117700         MOVE PC121-CL-NBR     (ASC-SEL-SUB)                      11770046
117800                              TO ASC-CL-NBR                       11780046
117900         MOVE PC121-SKU-NBR (ASC-SEL-SUB)  TO ASC-SKU             11790040
118000         MOVE PC121-MODU-NBR (ASC-SEL-SUB)                        11800002
118100                              TO PV-MOD-NBR-N                     11810002
118200         MOVE PV-MOD-NBR-3    TO ASC-MODU-NBR                     11820002
118300         MOVE PC121-INPK-UNT-QTY (ASC-SEL-SUB)                    11830002
118400                              TO ASC-INPK-UNT-QTY                 11840002
118500         MOVE PC121-OTPK-UNT-QTY (ASC-SEL-SUB)                    11850002
118600                              TO ASC-OTPK-UNT-QTY                 11860002
118700         MOVE PC121-INPK-CNVYB-IND  (ASC-SEL-SUB)                 11870002
118800                                 TO ASC-INPK-CNVYB-IND            11880002
118900         SET PC121-INQ (ASC-SEL-SUB)                              11890002
119000                                  TO TRUE                         11900002
119100         PERFORM 9200-REWRITE-SEL-QUEUE                           11910002
119200     ELSE                                                         11920002
119300         MOVE +1                  TO ASC-SEL-ITEM                 11930002
119400                                     ASC-SEL-SUB                  11940002
119500         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11950002
119600         SET DP020-MSG-INFORMATIONAL                              11960002
119700             PS-LIST-END             TO TRUE                      11970002
119800     END-IF.                                                      11980002
119900                                                                  11990002
120000                                                                  12000002
120100                                                                  12010002
120200                                                                  12020002
120300 EJECT                                                            12030002
120400                                                                  12040002
120500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12050002
120600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITING OF THE DATA    *12060002
120700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *12070002
120800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *12080002
120900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12090002
121000* FUNCTION KEYS CAN GET THIS FAR.                                *12100002
121100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12110002
121200 2000-PROCESS-PANEL.                                              12120002
121300                                                                  12130002
121400     EVALUATE TRUE                                                12140002
121500         WHEN DP020-SRC-AID = DP016-CLEAR                         12150002
121600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12160002
121700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12170002
121800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12180002
121900                                                                  12190002
122000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12200002
122100             PERFORM 2050-DELETE-LIST-QUEUE                       12210002
122200             PERFORM 4000-BUILD-INITIAL-PANEL                     12220002
122300                                                                  12230002
122400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12240002
122500             PERFORM 2140-DESELECT-ALL-ITEMS                      12250002
122600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12260002
122700                                                                  12270002
122800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  12280002
122900             PERFORM 2150-SELECT-ALL-ITEMS                        12290002
123000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12300002
123100                                                                  12310002
123200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12320002
123300             IF  ASC-USE-SELECTION-QUEUE                          12330002
123400                 PERFORM 1130-GET-NEXT-RECORD                     12340002
123500                 IF PS-LIST-END                                   12350002
123600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12360002
123700                     SET PS-NO-LIST-END TO TRUE                   12370002
123800                 ELSE                                             12380002
123900                     PERFORM 2050-DELETE-LIST-QUEUE               12390002
124000                     PERFORM 4000-BUILD-INITIAL-PANEL             12400002
124100                 END-IF                                           12410002
124200              ELSE                                                12420002
124300*                --- BOTTOM OF LIST ---                           12430002
124400                 MOVE PC-TSYMSG-00070                             12440002
124500                                   TO DP020-MSG-NUMBER            12450002
124600                 SET DP020-MSG-INFORMATIONAL                      12460002
124700                                   TO TRUE                        12470002
124800             END-IF                                               12480002
124900                                                                  12490002
125000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12500002
125100             IF  ASC-USE-SELECTION-QUEUE                          12510002
125200                 PERFORM 1140-GET-PREV-RECORD                     12520002
125300                 IF PS-LIST-END                                   12530002
125400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12540002
125500                     SET PS-NO-LIST-END                           12550002
125600                                   TO TRUE                        12560002
125700                 ELSE                                             12570002
125800                     PERFORM 2050-DELETE-LIST-QUEUE               12580002
125900                     PERFORM 4000-BUILD-INITIAL-PANEL             12590002
126000                 END-IF                                           12600002
126100             ELSE                                                 12610002
126200                 MOVE PC-TSYMSG-00069                             12620002
126300                                   TO DP020-MSG-NUMBER            12630002
126400                 SET DP020-MSG-INFORMATIONAL                      12640002
126500                                   TO TRUE                        12650002
126600             END-IF                                               12660002
126700                                                                  12670002
126800         WHEN OTHER                                               12680002
126900             PERFORM 2010-CHECK-CICS-NETWORK                      12690014
127000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12700002
127100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12710002
127200             IF  PS-NO-ERROR                                      12720002
127300                 SET DP030-CONTINUE-GO                            12730002
127400                                 TO TRUE                          12740002
127500                 PERFORM 2100-CHECK-FUNCTION-KEY                  12750002
127600             ELSE                                                 12760002
127700                 SET DP030-OVERRIDE-GO                            12770002
127800                                 TO TRUE                          12780002
127900             END-IF                                               12790002
128000                                                                  12800002
128100     END-EVALUATE.                                                12810002
128200                                                                  12820002
128300                                                                  12830002
128400*----------------------------------------------------------------*12840014
128500*  DETERMINE WHAT CICS NETWORK YOU ARE WORKING IN                *12850014
128600*----------------------------------------------------------------*12860014
128700 2010-CHECK-CICS-NETWORK.                                         12870014
128800                                                                  12880014
128900      EXEC CICS                                                   12890014
129000          ASSIGN                                                  12900014
129100              USERID (ASC-SIGNON-USERID)                          12910014
129200      END-EXEC.                                                   12920014
129300                                                                  12930014
129400                                                                  12940014
129500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12950002
129600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12960002
129700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12970002
129800 2050-DELETE-LIST-QUEUE.                                          12980002
129900     EXEC CICS                                                    12990002
130000         DELETEQ TS                                               13000002
130100             QUEUE (ASC-LIST-QUEUE-NAME)                          13010002
130200             RESP  (PV-CICS-RESP)                                 13020002
130300     END-EXEC.                                                    13030002
130400                                                                  13040002
130500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       13050002
130600        (PV-CICS-RESP = DFHRESP(QIDERR))                          13060002
130700         CONTINUE                                                 13070002
130800     ELSE                                                         13080002
130900         SET DP013-CICS-ABEND      TO TRUE                        13090002
131000         SET DP013-NO-ROLLBACK     TO TRUE                        13100002
131100                                                                  13110002
131200         MOVE '2050-DELETE-LIST-QUEUE'                            13120002
131300                                   TO DP013-PARAGRAPH             13130002
131400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13140002
131500                                   TO DP013-MESSAGE-TEXT (1)      13150002
131600         PERFORM DP013-0000-PROCESS-ABEND                         13160002
131700     END-IF.                                                      13170002
131800                                                                  13180002
131900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13190002
132000                                                                  13200002
132100                                                                  13210002
132200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*13220002
132300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13230002
132400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13240002
132500* CICS ARCHITECTURE API.                                         *13250002
132600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*13260002
132700 2100-CHECK-FUNCTION-KEY.                                         13270002
132800                                                                  13280002
132900     EVALUATE TRUE                                                13290002
133000                                                                  13300002
133100* F18 - LABEL REPRINT (LOCAL-FUNC-01)                             13310002
133200                                                                  13320002
133300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13330002
133400             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13340002
133500                 INITIALIZE PC122-INTER-APPL-COMMAREA             13350002
133600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13360002
133700                                TO PC122-NUMBER-OF-SELECTED-ITEMS 13370002
133800                 MOVE ASC-SEL-QUEUE-NAME                          13380002
133900                                TO PC122-SEL-QUEUE-NAME           13390002
134000                 MOVE ASC-OPER-UNT-ID                             13400002
134100                                TO PC122-OPER-UNT-ID              13410002
134200                 MOVE ASC-FCLTY-ID                                13420002
134300                                TO PC122-FCLTY-ID                 13430002
134400                 MOVE ASC-CURR-OPER-UNT-ID                        13440002
134500                                TO PC122-CURR-OPER-UNT-ID         13450002
134600                 MOVE ASC-CURR-FCLTY-ID                           13460002
134700                                TO PC122-CURR-FCLTY-ID            13470002
134800                 MOVE ASC-PO-NBR                                  13480002
134900                                TO PC122-PO-NBR                   13490002
135000                 MOVE ASC-REC-SEQ-NBR                             13500002
135100                                TO PC122-REC-SEQ-NBR              13510002
135200                 MOVE ASC-DPT-NBR                                 13520002
135300                                TO PC122-DPT-NBR                  13530002
135400                 MOVE ASC-SML-P2L-PRTR-ID                         13540002
135500                                TO PC122-SML-P2L-PRTR-ID          13550002
135600                 MOVE ASC-PGYBCK-PRTR-ID                          13560002
135700                                TO PC122-PGYBCK-PRTR-ID           13570002
135800                 MOVE ASC-DC-PRTD-AT                              13580002
135900                                TO PC122-DC-PRTD-AT               13590002
136000                 PERFORM 5000-PREPARE-SEL-QUEUE                   13600002
136100             ELSE                                                 13610002
136200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13620002
136300                 SET DP030-OVERRIDE-GO                            13630002
136400                                   TO TRUE                        13640002
136500                 MOVE PC-TSYMSG-00057                             13650002
136600                                   TO DP020-MSG-NUMBER            13660002
136700                 SET DP020-MSG-WARNING                            13670002
136800                                   TO TRUE                        13680002
136900             END-IF                                               13690002
137000                                                                  13700002
137100                                                                  13710002
137200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13720002
137300             MOVE +1               TO PV-TOP-ITEM                 13730002
137400             PERFORM 3200-RESET-ATTRIBUTES                        13740002
137500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13750002
137600                                                                  13760002
137700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13770002
137800             PERFORM 3200-RESET-ATTRIBUTES                        13780002
137900             PERFORM 2110-BROWSE-BACKWARD                         13790002
138000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13800002
138100                                                                  13810002
138200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13820002
138300             PERFORM 3200-RESET-ATTRIBUTES                        13830002
138400             PERFORM 2120-BROWSE-FORWARD                          13840002
138500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13850002
138600                                                                  13860002
138700         WHEN DP020-SRC-AID = DP016-ENTER                         13870002
138800             PERFORM 3200-RESET-ATTRIBUTES                        13880002
138900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13890002
139000             IF  PS-ERROR                                         13900002
139100                 CONTINUE                                         13910002
139200             ELSE                                                 13920002
139300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13930002
139400             END-IF                                               13940002
139500                                                                  13950002
139600                                                                  13960002
139700         WHEN OTHER                                               13970002
139800             SET DP013-NO-ROLLBACK                                13980002
139900                 DP013-XCTL-DISPLAY-RESTART                       13990002
140000                 DP013-CICS-ABEND  TO TRUE                        14000002
140100             MOVE '2100-CHECK-FUNCTION-KEY'                       14010002
140200                                   TO DP013-PARAGRAPH             14020002
140300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14030002
140400                                   TO DP013-MESSAGE-TEXT (1)      14040002
140500             PERFORM DP013-0000-PROCESS-ABEND                     14050002
140600     END-EVALUATE.                                                14060002
140700                                                                  14070002
140800                                                                  14080002
140900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*14090002
141000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14100002
141100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14110002
141200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14120002
141300*    MESSAGE.                                                    *14130002
141400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*14140002
141500 2110-BROWSE-BACKWARD.                                            14150002
141600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14160002
141700         GIVING PV-TOP-ITEM.                                      14170002
141800                                                                  14180002
141900     IF  ((PV-TOP-ITEM < +1)                                      14190002
142000       OR (PV-TOP-ITEM = +1))                                     14200002
142100         MOVE +1                   TO PV-TOP-ITEM                 14210002
142200*        -- TOP OF LIST --                                        14220002
142300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14230002
142400         SET DP020-MSG-INFORMATIONAL TO TRUE                      14240002
142500     END-IF.                                                      14250002
142600                                                                  14260002
142700                                                                  14270002
142800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*14280002
142900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14290002
143000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14300002
143100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14310002
143200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*14320002
143300 2120-BROWSE-FORWARD.                                             14330002
143400                                                                  14340002
143500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14350002
143600         GIVING PV-TOP-ITEM.                                      14360002
143700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   14370002
143800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14380002
143900                                   TO PV-TOP-ITEM                 14390002
144000*        -- BOTTOM OF LIST --                                     14400002
144100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14410002
144200         SET DP020-MSG-INFORMATIONAL                              14420002
144300                                   TO TRUE                        14430002
144400     ELSE                                                         14440002
144500         COMPUTE PV-BOTTOM-ITEM =                                 14450002
144600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14460002
144700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14470002
144800*            -- BOTTOM OF LIST --                                 14480002
144900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14490002
145000             SET DP020-MSG-INFORMATIONAL                          14500002
145100                                   TO TRUE                        14510002
145200         END-IF                                                   14520002
145300     END-IF.                                                      14530002
145400                                                                  14540002
145500                                                                  14550002
145600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*14560002
145700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14570002
145800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14580002
145900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14590002
146000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14600002
146100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14610002
146200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14620002
146300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*14630002
146400 2130-CHECK-FOR-JUMP-BROWSE.                                      14640002
146500     SET PS-NO-ERROR               TO TRUE.                       14650002
146600     IF (ASC-START-ITEM-REQUEST = SPACE)                          14660002
146700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14670002
146800                                   TO PV-TOP-ITEM                 14680002
146900     ELSE                                                         14690002
147000         MOVE ASC-START-ITEM-REQUEST-N                            14700002
147100                                   TO DP010I-UNEDITED-FIELD       14710002
147200         MOVE LENGTH OF ASC-START-ITEM-REQUEST-N                  14720002
147300                                   TO DP010I-MAXIMUM-DIGITS       14730002
147400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     14740002
147500         SET DP010I-NEGATIVE-NOT-ALLOWED                          14750002
147600                                   TO TRUE                        14760002
147710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14771074
147720                         USING DP010I-NUMERIC-EDIT-AREA           14772074
147800                                                                  14780002
147900         IF  NOT DP010I-ERROR-DETECTED                            14790002
148000             MOVE DP010I-NUMERIC-FIELD                            14800002
148100                                   TO  ASC-START-ITEM-REQUEST-N   14810002
148200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14820002
148300                 IF  ASC-START-ITEM-REQUEST-N >                   14830002
148400                                          ASC-NUMBER-OF-ITEMS-READ14840002
148500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14850002
148600                     COMPUTE PV-TOP-ITEM =                        14860002
148700                             ASC-NUMBER-OF-ITEMS-READ             14870002
148800                             - PC-ITEMS-PER-PANEL + 1             14880002
148900                     IF  PV-TOP-ITEM < +1                         14890002
149000                         MOVE +1   TO PV-TOP-ITEM                 14900002
149100                         MOVE PC-TSYMSG-00070                     14910002
149200                                   TO DP020-MSG-NUMBER            14920002
149300                         SET DP020-MSG-INFORMATIONAL              14930002
149400                                   TO TRUE                        14940002
149500                     END-IF                                       14950002
149600                 ELSE                                             14960002
149700                     MOVE ASC-START-ITEM-REQUEST-N                14970002
149800                                   TO PV-TOP-ITEM                 14980002
149900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14990002
150000                     COMPUTE PV-BOTTOM-ITEM =                     15000002
150100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     15010002
150200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ15020002
150300*                        -- BOTTOM OF LIST --                     15030002
150400                         MOVE PC-TSYMSG-00070                     15040002
150500                                   TO DP020-MSG-NUMBER            15050002
150600                         SET DP020-MSG-INFORMATIONAL              15060002
150700                                   TO TRUE                        15070002
150800                     END-IF                                       15080002
150900                 END-IF                                           15090002
151000             ELSE                                                 15100002
151100*                --- VALUE OUT OF RANGE ----                      15110002
151200                 MOVE PC-TSYMSG-00101                             15120002
151300                                   TO DP020-MSG-NUMBER            15130002
151400                 MOVE -1           TO ASTRTITL                    15140002
151500                 SET DP030-SET-CURSOR-APPL-1                      15150002
151600                                   TO TRUE                        15160002
151700                 MOVE DP015-REVERSE                               15170002
151800                                   TO ASTRTITH                    15180002
151900                 MOVE DP015-RED    TO ASTRTITC                    15190002
152000                 MOVE DP015-UNP-NUM-BRT-MDT                       15200002
152100                                   TO ASTRTITA                    15210002
152200                 SET DP020-MSG-FATAL                              15220002
152300                                   TO TRUE                        15230002
152400                 SET PS-ERROR      TO TRUE                        15240002
152500             END-IF                                               15250002
152600                                                                  15260002
152700         ELSE                                                     15270002
152800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15280002
152900             MOVE -1               TO ASTRTITL                    15290002
153000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15300002
153100             MOVE DP015-REVERSE    TO ASTRTITH                    15310002
153200             MOVE DP015-RED        TO ASTRTITC                    15320002
153300             MOVE DP015-UNP-NUM-BRT-MDT                           15330002
153400                                   TO ASTRTITA                    15340002
153500             SET DP020-MSG-FATAL   TO TRUE                        15350002
153600             SET PS-ERROR          TO TRUE                        15360002
153700         END-IF                                                   15370002
153800     END-IF.                                                      15380002
153900                                                                  15390002
154000                                                                  15400002
154100*----------------------------------------------------------------*15410002
154200*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *15420002
154300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *15430002
154400*----------------------------------------------------------------*15440002
154500 2140-DESELECT-ALL-ITEMS.                                         15450002
154600     MOVE +1                       TO ASC-BLK-SUB.                15460002
154700                                                                  15470002
154800     PERFORM 2141-CLEAR-SELECTED-INDS                             15480002
154900         VARYING ASC-ITEM-SUB                                     15490002
155000         FROM 1 BY 1                                              15500002
155100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15510002
155200                                                                  15520002
155300     ADD +1                        TO ASC-BLK-SUB.                15530002
155400                                                                  15540002
155500     PERFORM 2141-CLEAR-SELECTED-INDS                             15550002
155600         VARYING ASC-ITEM-SUB                                     15560002
155700         FROM 1 BY 1                                              15570002
155800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15580002
155900                                                                  15590002
156000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15600002
156100                                   TO PV-LIST-ITEM-NUMBER.        15610002
156200                                                                  15620002
156300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15630002
156400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15640002
156500                                                                  15650002
156600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15660002
156700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      15670002
156800         MOVE +1                   TO ASC-BLK-SUB                 15680002
156900                                                                  15690002
157000         PERFORM 5100-WRITE-TEMP-STORAGE                          15700002
157100                                                                  15710002
157200         MOVE +1                   TO PV-BLOCK-NUMBER             15720002
157300                                                                  15730002
157400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15740002
157500             PV-FIRST-BLOCK-IN-ARRAY - 1                          15750002
157600                                                                  15760002
157700         PERFORM                                                  15770002
157800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15780002
157900                                                                  15790002
158000             PERFORM 4410-READ-TEMP-STORAGE                       15800002
158100                                                                  15810002
158200             PERFORM 2141-CLEAR-SELECTED-INDS                     15820002
158300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 15830002
158400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15840002
158500                                                                  15850002
158600             PERFORM 5100-WRITE-TEMP-STORAGE                      15860002
158700                                                                  15870002
158800             ADD +1                TO PV-BLOCK-NUMBER             15880002
158900                                                                  15890002
159000         END-PERFORM                                              15900002
159100                                                                  15910002
159200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15920002
159300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15930002
159400                                                                  15940002
159500         PERFORM                                                  15950002
159600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15960002
159700                   ASC-HIGHEST-BLOCK-WRITTEN                      15970002
159800                                                                  15980002
159900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15990002
160000                                   TO PV-BLOCK-NUMBER             16000002
160100                                                                  16010002
160200             PERFORM 4410-READ-TEMP-STORAGE                       16020002
160300                                                                  16030002
160400             PERFORM 2141-CLEAR-SELECTED-INDS                     16040002
160500                 VARYING ASC-ITEM-SUB                             16050002
160600                 FROM 1 BY 1                                      16060002
160700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16070002
160800                                                                  16080002
160900             PERFORM 5100-WRITE-TEMP-STORAGE                      16090002
161000                                                                  16100002
161100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16110002
161200                                                                  16120002
161300         END-PERFORM                                              16130002
161400                                                                  16140002
161500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16150002
161600                                   TO PV-BLOCK-NUMBER             16160002
161700                                                                  16170002
161800         PERFORM 4410-READ-TEMP-STORAGE                           16180002
161900     END-IF.                                                      16190002
162000                                                                  16200002
162100                                                                  16210002
162200     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 16220002
162300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.16230002
162400     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  16240002
162500                                                                  16250002
162600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16260002
162700                                                                  16270002
162800                                                                  16280002
162900*----------------------------------------------------------------*16290002
163000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *16300002
163100*----------------------------------------------------------------*16310002
163200 2141-CLEAR-SELECTED-INDS.                                        16320002
163300                                                                  16330002
163400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16340002
163500             NOT EQUAL ZERO                                       16350002
163600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16360002
163700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16370002
163800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    16380002
163900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16390002
164000                                   TO TRUE                        16400002
164100         END-IF                                                   16410002
164200     END-IF.                                                      16420002
164300                                                                  16430002
164400                                                                  16440002
164500*----------------------------------------------------------------*16450002
164600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *16460002
164700*  FOR ALL ITEMS.                                                *16470002
164800*----------------------------------------------------------------*16480002
164900 2150-SELECT-ALL-ITEMS.                                           16490002
165000                                                                  16500002
165100     MOVE +1                       TO ASC-BLK-SUB.                16510002
165200                                                                  16520002
165300     PERFORM 2151-SET-SELECTED-INDS                               16530002
165400         VARYING ASC-ITEM-SUB                                     16540002
165500         FROM 1 BY 1                                              16550002
165600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16560002
165700                                                                  16570002
165800     ADD +1                        TO ASC-BLK-SUB.                16580002
165900                                                                  16590002
166000     PERFORM 2151-SET-SELECTED-INDS                               16600002
166100         VARYING ASC-ITEM-SUB                                     16610002
166200         FROM 1 BY 1                                              16620002
166300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16630002
166400                                                                  16640002
166500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16650002
166600                                   TO PV-LIST-ITEM-NUMBER.        16660002
166700                                                                  16670002
166800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16680002
166900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16690002
167000                                                                  16700002
167100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16710002
167200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    16720002
167300         MOVE +1                   TO ASC-BLK-SUB                 16730002
167400                                                                  16740002
167500         PERFORM 5100-WRITE-TEMP-STORAGE                          16750002
167600                                                                  16760002
167700         MOVE +1                   TO PV-BLOCK-NUMBER             16770002
167800                                                                  16780002
167900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16790002
168000             PV-FIRST-BLOCK-IN-ARRAY - 1                          16800002
168100                                                                  16810002
168200         PERFORM                                                  16820002
168300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16830002
168400                                                                  16840002
168500             PERFORM 4410-READ-TEMP-STORAGE                       16850002
168600                                                                  16860002
168700             PERFORM 2151-SET-SELECTED-INDS                       16870002
168800                 VARYING ASC-ITEM-SUB                             16880002
168900                 FROM 1 BY 1                                      16890002
169000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16900002
169100                                                                  16910002
169200             PERFORM 5100-WRITE-TEMP-STORAGE                      16920002
169300                                                                  16930002
169400             ADD +1                TO PV-BLOCK-NUMBER             16940002
169500                                                                  16950002
169600         END-PERFORM                                              16960002
169700                                                                  16970002
169800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16980002
169900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16990002
170000                                                                  17000002
170100         PERFORM                                                  17010002
170200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17020002
170300                   ASC-HIGHEST-BLOCK-WRITTEN                      17030002
170400                                                                  17040002
170500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17050002
170600                                   TO PV-BLOCK-NUMBER             17060002
170700                                                                  17070002
170800             PERFORM 4410-READ-TEMP-STORAGE                       17080002
170900                                                                  17090002
171000             PERFORM 2151-SET-SELECTED-INDS                       17100002
171100                 VARYING ASC-ITEM-SUB                             17110002
171200                 FROM 1 BY 1                                      17120002
171300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17130002
171400                                                                  17140002
171500             PERFORM 5100-WRITE-TEMP-STORAGE                      17150002
171600                                                                  17160002
171700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17170002
171800                                                                  17180002
171900         END-PERFORM                                              17190002
172000                                                                  17200002
172100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17210002
172200                                   TO PV-BLOCK-NUMBER             17220002
172300                                                                  17230002
172400         PERFORM 4410-READ-TEMP-STORAGE                           17240002
172500     END-IF.                                                      17250002
172600                                                                  17260002
172700                                                                  17270002
172800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             17280002
172900                       ASC-NUMBER-OF-SELECTED-ITEMS.              17290002
173000                                                                  17300002
173100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17310002
173200                                                                  17320002
173300                                                                  17330002
173400*----------------------------------------------------------------*17340002
173500*    MARK EACH ITEM AS BEING SELECTED.                           *17350002
173600*----------------------------------------------------------------*17360002
173700 2151-SET-SELECTED-INDS.                                          17370002
173800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17380002
173900             NOT EQUAL ZERO                                       17390002
174000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17400002
174100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17410002
174200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        17420002
174300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17430002
174400                               TO  TRUE                           17440002
174500         END-IF                                                   17450002
174600     END-IF.                                                      17460002
174700                                                                  17470002
174800                                                                  17480002
174900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*17490002
175000*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *17500002
175100*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *17510002
175200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*17520002
175300 2200-MOVE-SCREEN-TO-COMMAREA.                                    17530002
175400                                                                  17540002
175500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             17550002
175600     MOVE +1                       TO PV-SUB.                     17560002
175700                                                                  17570002
175800     PERFORM 3100-SET-SUBSCRIPTS.                                 17580002
175900                                                                  17590002
176000     IF  ASTRTITL > ZERO                                          17600002
176100         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          17610002
176200     ELSE                                                         17620002
176300         IF  ASTRTITF = DP015-ERASE-EOF                           17630002
176400             INITIALIZE ASC-START-ITEM-REQUEST                    17640002
176500         END-IF                                                   17650002
176600     END-IF.                                                      17660002
176700                                                                  17670002
176800     IF  ALBTYPL > ZERO                                           17680002
176900         MOVE ALBTYPI          TO ASC-LBL-PRT-ORDER               17690002
177000     ELSE                                                         17700002
177100         IF  ALBTYPF = DP015-ERASE-EOF                            17710002
177200             MOVE  SPACES      TO ASC-LBL-PRT-ORDER               17720002
177300         END-IF                                                   17730002
177400     END-IF.                                                      17740002
177500                                                                  17750002
177600     IF  ALBPRTL > ZERO                                           17760002
177700         IF ASC-LBL-PRT-ORDER = PC-S                              17770002
177800             MOVE ALBPRTI          TO ASC-SML-P2L-PRTR-ID         17780002
177900         ELSE                                                     17790002
178000             MOVE ALBPRTI          TO ASC-PGYBCK-PRTR-ID          17800002
178100         END-IF                                                   17810002
178200     END-IF.                                                      17820002
178300                                                                  17830002
178400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17840002
178500         VARYING PV-SUB                                           17850002
178600         FROM 1 BY 1                                              17860002
178700         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      17870002
178800                                                                  17880002
178900                                                                  17890002
179000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*17900002
179100*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *17910002
179200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*17920002
179300 2210-MOVE-LINES-TO-COMMAREA.                                     17930002
179400*                                                                 17940002
179500*** SELECT FIELD                                                  17950002
179600*                                                                 17960002
179700     IF  MR-SELECTL (PV-SUB) > ZERO                               17970002
179800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17980002
179900         MOVE MR-SELECT  (PV-SUB)  TO ASC-TEMP-SELECTED-SW        17990002
180000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18000002
180100     ELSE                                                         18010002
180200         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                18020002
180300             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         18030002
180400             MOVE SPACE        TO ASC-TEMP-SELECTED-SW            18040002
180500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18050002
180600         END-IF                                                   18060002
180700     END-IF.                                                      18070002
180800***                                                               18080002
180900*                                                                 18090002
181000     ADD +1                        TO ASC-ITEM-SUB.               18100002
181100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        18110002
181200         ADD +1                    TO ASC-BLK-SUB                 18120002
181300         MOVE +1                   TO ASC-ITEM-SUB                18130002
181400     END-IF.                                                      18140002
181500                                                                  18150002
181600                                                                  18160002
181700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*18170002
181800*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *18180002
181900*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *18190002
182000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*18200002
182100 3000-EDIT-DATA-IN-COMMAREA.                                      18210002
182200     SET PS-NO-ERROR               TO TRUE.                       18220002
182300                                                                  18230002
182400     PERFORM 3200-RESET-ATTRIBUTES.                               18240002
182500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18250002
182600                                                                  18260029
182700*-----------------------------------------------------------------18270029
182800* CHECK REPRINT - NOT VALID IF PROCESSED USING UCC128 DATA        18280029
182900*-----------------------------------------------------------------18290029
183000     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  AND              18300029
183100         PS-NO-ERROR                                              18310029
183200         IF  ASC-USE-UCC128-YES                                   18320029
183300             SET PS-ERROR                                         18330029
183400             DP020-MSG-FATAL             TO TRUE                  18340029
183500             MOVE PC-TSYMSG-02508        TO DP020-MSG-NUMBER      18350029
183600             MOVE -1                     TO ASEL01L               18360029
183700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18370029
183800         END-IF                                                   18380029
183900     END-IF.                                                      18390029
184000                                                                  18400029
184100*                                                                 18410002
184110*-----------------------------------------------------------------18411068
184120* CHECK NO ERRORS CREATING OUTBOUND CARTONS ON INITIAL DOWNLOAD   18412068
184130*-----------------------------------------------------------------18413068
184140     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  AND              18414068
184150         PS-NO-ERROR                                              18415068
184160         IF  ASC-ERR-ON-LABEL-DWNLD                               18416068
184170             SET PS-ERROR                                         18417068
184180             DP020-MSG-FATAL             TO TRUE                  18418068
184190             MOVE PC-TSYMSG-03415        TO DP020-MSG-NUMBER      18419068
184191             MOVE -1                     TO ASEL01L               18419168
184192             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18419268
184193         END-IF                                                   18419368
184194     END-IF.                                                      18419468
184195                                                                  18419568
184196*                                                                 18419668
184200*  VALIDATE LABEL TYPE                                            18420002
184300*                                                                 18430002
184400                                                                  18440002
184500     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    18450002
184600        IF ASC-LBL-PRT-ORDER = PC-S OR PC-P                       18460002
184700            CONTINUE                                              18470002
184800        ELSE                                                      18480002
184900            SET PS-ERROR                                          18490002
185000            DP020-MSG-FATAL       TO TRUE                         18500002
185100            MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER         18510002
185200            MOVE DP015-UNP-ALP-BRT-OFF                            18520002
185300                                      TO ALBTYPA                  18530002
185400            MOVE DP015-RED            TO ALBTYPC                  18540002
185500            MOVE DP015-REVERSE        TO ALBTYPH                  18550002
185600            MOVE -1                   TO ALBTYPL                  18560002
185700            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   18570002
185800        END-IF                                                    18580002
185900      END-IF.                                                     18590002
186000                                                                  18600002
186100*                                                                 18610002
186200*  VALIDATE PRINTER ID'S                                          18620002
186300*                                                                 18630002
186400                                                                  18640002
186500     IF PS-NO-ERROR                                               18650002
186600      IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                   18660002
186700                                                                  18670002
186800        IF (((ASC-SML-P2L-PRTR-ID = SPACES  OR                    18680002
186900              ASC-SML-P2L-PRTR-ID = PC-NO-LABEL)    AND           18690002
187000             (ASC-PGYBCK-PRTR-ID = SPACES  OR                     18700002
187100              ASC-PGYBCK-PRTR-ID = PC-NO-LABEL))                  18710002
187200                                                                  18720002
187300        OR  ((ASC-SML-P2L-PRTR-ID = SPACES  OR                    18730002
187400              ASC-SML-P2L-PRTR-ID = PC-NO-LABEL)    AND           18740002
187500              ASC-LBL-PRT-ORDER = PC-S)                           18750002
187600                                                                  18760002
187700        OR  ((ASC-PGYBCK-PRTR-ID = SPACES OR                      18770002
187800              ASC-PGYBCK-PRTR-ID = PC-NO-LABEL)     AND           18780002
187900              ASC-LBL-PRT-ORDER = PC-P))                          18790002
188000                                                                  18800002
188100            SET PS-ERROR                                          18810002
188200            DP020-MSG-FATAL       TO TRUE                         18820002
188300            MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER         18830002
188400            MOVE DP015-UNP-ALP-BRT-OFF                            18840002
188500                                      TO ALBPRTA                  18850002
188600            MOVE DP015-RED            TO ALBPRTC                  18860002
188700            MOVE DP015-REVERSE        TO ALBPRTH                  18870002
188800            MOVE -1                   TO ALBPRTL                  18880002
188900            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   18890002
189000        ELSE                                                      18900002
189100            IF ASC-SML-P2L-PRTR-ID NOT = SPACES  AND              18910002
189200               ASC-SML-P2L-PRTR-ID NOT = PC-NO-LABEL              18920002
189300               MOVE ASC-SML-P2L-PRTR-ID TO DP072-PRINTER-ID       18930002
189400               MOVE PC-REPORT-PGM-1     TO DP072-RPT-PGM-NME      18940002
189500               PERFORM 3010-VALIDATE-PRINTER                      18950002
189600               IF PS-NO-ERROR                                     18960002
189700                 IF  ASC-SML-P2L-LABELS                           18970004
189800                     PERFORM 3020-VALIDATE-PRINTER-ID-SML         18980004
189900                 END-IF                                           18990004
190000                 IF PS-NO-ERROR                                   19000004
190100                    MOVE DP072-PRTR-CLUSTER-NBR                   19010004
190200                                   TO PC126-SHP-PRTR-CLUSTER-NBR  19020002
190300                    MOVE DP072-PRTR-IP-ADDRESS                    19030004
190400                                   TO PC126-SHP-PRTR-IP-ADDR      19040002
190500                    MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE           19050004
190600                                   TO PC126-SHP-PRTR-OS-RLSE-CDE  19060002
190700                    MOVE DP072-PRTR-DATA-XFER-MODE-ID             19070004
190800                                   TO PC126-SHP-DATA-XFER-MODE-ID 19080002
190900                    MOVE DP072-XMIT-INTFC-CDE                     19090004
191000                                   TO PC126-SHP-XMIT-INTFC-CDE    19100002
191100                    MOVE DP072-PRTR-TYP-CDE                       19110004
191200                                   TO PC126-SHP-PRTR-TYP-CDE      19120004
191300                 END-IF                                           19130004
191400               END-IF                                             19140004
191500            END-IF                                                19150002
191600         END-IF                                                   19160002
191700        END-IF.                                                   19170002
191800                                                                  19180002
191900                                                                  19190002
192000*-----------------------------------------------------------------19200002
192100* IF PIGGYBACK LABEL PRINTER ID IS ENTERED - VALIDATE             19210002
192200*-----------------------------------------------------------------19220002
192300     IF  PS-NO-ERROR                                              19230002
192400      IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                   19240002
192500         IF  ASC-PGYBCK-PRTR-ID > SPACES  AND                     19250002
192600             ASC-PGYBCK-PRTR-ID NOT = PC-NO-LABEL                 19260002
192700             IF  ASC-PRE-PACK-ORDER                               19270011
192800                 SET  PS-ERROR                                    19280011
192900                      DP020-MSG-FATAL  TO TRUE                    19290011
193000                 MOVE PC-TSYMSG-02424  TO DP020-MSG-NUMBER        19300011
193100                 MOVE DP015-UNP-ALP-BRT-OFF                       19310011
193200                                       TO ALBPRTA                 19320011
193300                 MOVE DP015-RED        TO ALBPRTC                 19330011
193400                 MOVE DP015-REVERSE    TO ALBPRTH                 19340011
193500                 MOVE -1               TO ALBPRTL                 19350011
193600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19360011
193700             ELSE                                                 19370011
193800                 MOVE ASC-PGYBCK-PRTR-ID TO DP072-PRINTER-ID      19380011
193900                 MOVE PC-REPORT-PGM-2    TO DP072-RPT-PGM-NME     19390011
194000                 PERFORM 3010-VALIDATE-PRINTER                    19400011
194100                 IF  PS-NO-ERROR                                  19410011
194200                     PERFORM 3030-VALIDATE-PRINTER-ID-PGBK        19420011
194300                     IF PS-NO-ERROR                               19430011
194400                        MOVE DP072-PRTR-CLUSTER-NBR               19440011
194500                           TO PC126-PGYBK-PRTR-CLUSTER-NBR        19450002
194600                        MOVE DP072-PRTR-IP-ADDRESS                19460011
194700                           TO PC126-PGYBK-PRTR-IP-ADDR            19470002
194800                        MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE       19480011
194900                           TO PC126-PGYBK-PRTR-OS-RLSE-CDE        19490002
195000                        MOVE DP072-PRTR-DATA-XFER-MODE-ID         19500011
195100                           TO PC126-PGYBK-DATA-XFER-MODE-ID       19510002
195200                        MOVE DP072-XMIT-INTFC-CDE                 19520011
195300                           TO PC126-PGYBK-XMIT-INTFC-CDE          19530002
195400                        MOVE DP072-PRTR-TYP-CDE                   19540011
195500                           TO PC126-PGYBK-PRTR-TYP-CDE            19550003
195600                     END-IF                                       19560011
195700                 END-IF                                           19570011
195800             END-IF                                               19580011
195900         END-IF                                                   19590002
196000       END-IF                                                     19600002
196100     END-IF.                                                      19610002
196200                                                                  19620002
196300                                                                  19630002
196400*-----------------------------------------------------------------19640002
196500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              19650002
196600* EDITTING IS DONE FROM THE BOTTOM UP.                            19660002
196700*-----------------------------------------------------------------19670002
196800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19680002
196900         ASC-ITEMS-DISPLAYED - 1.                                 19690002
197000     PERFORM 3100-SET-SUBSCRIPTS.                                 19700002
197100                                                                  19710002
197200     IF  PS-NO-ERROR                                              19720002
197300         PERFORM 3300-EDIT-SELECTIONS                             19730002
197400             VARYING PV-SUB                                       19740002
197500             FROM PV-SUB BY -1                                    19750002
197600             UNTIL PV-SUB < +1                                    19760002
197700     END-IF.                                                      19770002
197800                                                                  19780002
197900     IF  PS-NO-ERROR                                              19790002
198000         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19800002
198100     END-IF.                                                      19810002
198200                                                                  19820002
198300     IF  ((PS-NO-ERROR)                                           19830002
198400       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   19840002
198500       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    19850002
198600             PERFORM 3500-MARK-RANGE-AS-SELECTED                  19860002
198700     END-IF.                                                      19870002
198800                                                                  19880002
198900                                                                  19890002
199000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19900002
199100*   3010-VALIDATE-PRINTER                                        *19910002
199200* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *19920002
199300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19930002
199400 3010-VALIDATE-PRINTER.                                           19940002
199500                                                                  19950002
199600     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     19960002
199700     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 19970064
199800     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        19980064
199900     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     19990002
200000                                        DP072-FCLTY-ID.           20000002
200100     SET DP072-VALIDATE              TO TRUE.                     20010002
200200                                                                  20020002
200300     EXEC CICS                                                    20030002
200400          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  20040002
200500               COMMAREA (DP072-COMM-AREA)                         20050002
200600               RESP     (PV-CICS-RESP)                            20060002
200700     END-EXEC                                                     20070002
200800                                                                  20080002
200900     EVALUATE TRUE                                                20090002
201000         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     20100002
201100              CONTINUE                                            20110002
201200         WHEN OTHER                                               20120002
201300             SET PS-ERROR                                         20130002
201400                 DP020-MSG-FATAL       TO TRUE                    20140002
201500             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        20150002
201600             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              20160002
201700                 MOVE DP015-UNP-ALP-BRT-OFF                       20170002
201800                                       TO ALBPRTA                 20180002
201900                 MOVE DP015-RED        TO ALBPRTC                 20190002
202000                 MOVE DP015-REVERSE    TO ALBPRTH                 20200002
202100                 MOVE -1               TO ALBPRTL                 20210002
202200             ELSE                                                 20220002
202300                 MOVE DP015-UNP-ALP-BRT-OFF                       20230002
202400                                       TO ALBPRTA                 20240002
202500                 MOVE DP015-RED        TO ALBPRTC                 20250002
202600                 MOVE DP015-REVERSE    TO ALBPRTH                 20260002
202700                 MOVE -1               TO ALBPRTL                 20270002
202800             END-IF                                               20280002
202900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20290002
203000     END-EVALUATE.                                                20300002
203100                                                                  20310002
203200                                                                  20320002
203300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*20330002
203400*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *20340002
203500*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *20350002
203600*  CAN BE PRINTED ON THIS PRINTER.                               *20360002
203700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*20370002
203800 3020-VALIDATE-PRINTER-ID-SML.                                    20380002
203900                                                                  20390002
204000     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  = PC-MGMX                20400002
204100         SET  PS-PRINTER-ERROR                                    20410002
204200              PS-ERROR                                            20420002
204300              DP020-MSG-FATAL         TO TRUE                     20430002
204400         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         20440002
204500         MOVE DP015-UNP-ALP-BRT-MDT   TO ALBPRTA                  20450002
204600         MOVE DP015-RED               TO ALBPRTC                  20460002
204700         MOVE DP015-REVERSE           TO ALBPRTH                  20470002
204800         MOVE DP015-UNP-ALP-BRT-MDT   TO ALBTYPA                  20480004
204900         MOVE DP015-RED               TO ALBTYPC                  20490004
205000         MOVE DP015-REVERSE           TO ALBTYPH                  20500004
205100         MOVE -1                      TO ALBPRTL                  20510002
205200         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     20520002
205300     END-IF.                                                      20530002
205400                                                                  20540002
205500     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   20550002
205600         CONTINUE                                                 20560002
205700     ELSE                                                         20570002
205800         SET  PS-PRINTER-ERROR                                    20580002
205900              PS-ERROR                                            20590002
206000              DP020-MSG-FATAL         TO TRUE                     20600002
206100         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         20610002
206200         MOVE DP015-UNP-ALP-BRT-MDT   TO ALBPRTA                  20620002
206300         MOVE DP015-RED               TO ALBPRTC                  20630002
206400         MOVE DP015-REVERSE           TO ALBPRTH                  20640002
206500         MOVE -1                      TO ALBPRTL                  20650002
206600         MOVE DP015-UNP-ALP-BRT-MDT   TO ALBTYPA                  20660004
206700         MOVE DP015-RED               TO ALBTYPC                  20670004
206800         MOVE DP015-REVERSE           TO ALBTYPH                  20680004
206900         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     20690002
207000     END-IF.                                                      20700002
207100                                                                  20710002
207200                                                                  20720002
207300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*20730002
207400*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *20740002
207500*  THIS IS A VALID PRINTER AND THAT PIGGYBACK LABELS CAN BE      *20750002
207600*  PRINTED ON THIS PRINTER.                                      *20760002
207700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*20770002
207800 3030-VALIDATE-PRINTER-ID-PGBK.                                   20780002
207900                                                                  20790002
208000     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   20800002
208100         CONTINUE                                                 20810002
208200     ELSE                                                         20820002
208300         SET  PS-PRINTER-ERROR                                    20830002
208400              PS-ERROR                                            20840002
208500              DP020-MSG-FATAL         TO TRUE                     20850002
208600         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         20860002
208700         MOVE DP015-UNP-ALP-BRT-MDT   TO ALBPRTA                  20870002
208800         MOVE DP015-RED               TO ALBPRTC                  20880002
208900         MOVE DP015-REVERSE           TO ALBPRTH                  20890002
209000         MOVE -1                      TO ALBPRTL                  20900002
209100         MOVE DP015-UNP-ALP-BRT-MDT   TO ALBTYPA                  20910004
209200         MOVE DP015-RED               TO ALBTYPC                  20920004
209300         MOVE DP015-REVERSE           TO ALBTYPH                  20930004
209400         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     20940002
209500     END-IF.                                                      20950002
209600                                                                  20960002
209700                                                                  20970002
209800                                                                  20980002
209900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*20990002
210000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21000002
210100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21010002
210200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21020002
210300*                                                                *21030002
210400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21040002
210500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21050002
210600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21060002
210700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21070002
210800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*21080002
210900 3100-SET-SUBSCRIPTS.                                             21090002
211000     COMPUTE ASC-ITEM-SUB =                                       21100002
211100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21110002
211200                                                                  21120002
211300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21130002
211400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21140002
211500                                                                  21150002
211600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               21160002
211700     ELSE                                                         21170002
211800         MOVE +1                     TO ASC-BLK-SUB               21180002
211900     END-IF.                                                      21190002
212000                                                                  21200002
212100                                                                  21210002
212200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*21220002
212300*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *21230002
212400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*21240002
212500 3200-RESET-ATTRIBUTES.                                           21250002
212600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    21260002
212700                                      ALBTYPA                     21270002
212800                                      ALBPRTA.                    21280002
212900     MOVE DP015-GREEN              TO ASTRTITC                    21290002
213000                                      ALBTYPC                     21300002
213100                                      ALBPRTC.                    21310002
213200     MOVE DP015-UNDERLINE          TO ASTRTITH                    21320002
213300                                      ALBTYPH                     21330002
213400                                      ALBPRTH.                    21340002
213500                                                                  21350002
213600     PERFORM                                                      21360002
213700         VARYING PV-SUB                                           21370002
213800         FROM 1 BY 1                                              21380002
213900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        21390002
214000         MOVE DP015-UNP-ALP-NOR-OFF                               21400002
214100                                   TO MR-SELECTA (PV-SUB)         21410002
214200         MOVE DP015-ASK-NOR-OFF                                   21420002
214300                                   TO MR-ACTIONA (PV-SUB)         21430002
214400                                      MR-STOREA (PV-SUB)          21440002
214500                                      MR-PKSLQTYA (PV-SUB)        21450002
214600                                      MR-P2QTYA (PV-SUB)          21460002
214700                                      MR-SHIPQTYA (PV-SUB)        21470002
214800                                      MR-CARTQTYA (PV-SUB)        21480002
214900                                      MR-FCSE-CARTQTYA (PV-SUB)   21490002
215000                                      MR-INPK-CARTQTYA (PV-SUB)   21500002
215100                                      MR-ODD-CART-SWA (PV-SUB)    21510002
215200         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         21520002
215300         MOVE DP015-BLUE           TO MR-ACTIONC (PV-SUB)         21530002
215400                                      MR-STOREC (PV-SUB)          21540002
215500                                      MR-PKSLQTYC (PV-SUB)        21550002
215600                                      MR-P2QTYC (PV-SUB)          21560002
215700                                      MR-SHIPQTYC (PV-SUB)        21570002
215800                                      MR-CARTQTYC (PV-SUB)        21580002
215900                                      MR-FCSE-CARTQTYC (PV-SUB)   21590002
216000                                      MR-INPK-CARTQTYC (PV-SUB)   21600002
216100                                      MR-ODD-CART-SWC (PV-SUB)    21610002
216200         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         21620002
216300*12/01 - BEGIN                                                    21630002
216400         MOVE DP015-HL-OFF         TO MR-STOREH (PV-SUB)          21640002
216500                                      MR-PKSLQTYH (PV-SUB)        21650002
216600                                      MR-P2QTYH (PV-SUB)          21660002
216700                                      MR-SHIPQTYH (PV-SUB)        21670002
216800                                      MR-CARTQTYH (PV-SUB)        21680002
216900                                      MR-INPK-CARTQTYH (PV-SUB)   21690002
217000                                      MR-FCSE-CARTQTYH (PV-SUB)   21700002
217100                                      MR-ODD-CART-SWH (PV-SUB)    21710002
217200*12/01 - END                                                      21720002
217300     END-PERFORM.                                                 21730002
217400                                                                  21740002
217500                                                                  21750002
217600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*21760002
217700*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *21770002
217800*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *21780002
217900*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *21790002
218000*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *21800002
218100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*21810002
218200 3300-EDIT-SELECTIONS.                                            21820002
218300     EVALUATE TRUE                                                21830002
218400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21840002
218500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         21850002
218600                 CONTINUE                                         21860002
218700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         21870002
218800             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        21880002
218900                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   21890002
219000                 MOVE ASC-TEMP-SELECTED-SW                        21900002
219100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21910002
219200                                TO ASC-SELECTED-SW                21920002
219300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21930002
219400             END-IF                                               21940002
219500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21950002
219600                 = SPACE                                          21960002
219700             EVALUATE TRUE                                        21970002
219800                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       21980002
219900                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS21990002
220000                     MOVE SPACE TO ASC-SELECTED-SW                22000002
220100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22010002
220200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22020002
220300                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    22030002
220400                     MOVE SPACE TO ASC-SELECTED-SW                22040002
220500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22050002
220600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22060002
220700                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22070002
220800                     MOVE SPACE TO ASC-SELECTED-SW                22080002
220900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22090002
221000             END-EVALUATE                                         22100002
221100         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22110002
221200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22120002
221300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22130002
221400             END-IF                                               22140002
221500             PERFORM 3310-EDIT-RANGE                              22150002
221600         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22160002
221700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22170002
221800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22180002
221900             END-IF                                               22190002
222000             PERFORM 3310-EDIT-RANGE                              22200002
222100         WHEN OTHER                                               22210002
222200             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           22220002
222300             SET DP020-MSG-FATAL    TO TRUE                       22230002
222400             MOVE -1                TO MR-SELECTL (PV-SUB)        22240002
222500             SET DP030-SET-CURSOR-APPL-1                          22250002
222600                                    TO TRUE                       22260002
222700             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        22270002
222800             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        22280002
222900             SET PS-ERROR TO TRUE                                 22290002
223000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22300002
223100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22310002
223200                 MOVE SPACE         TO ASC-SELECTED-SW            22320002
223300                                        (ASC-BLK-SUB ASC-ITEM-SUB)22330002
223400             END-IF                                               22340002
223500     END-EVALUATE.                                                22350002
223600                                                                  22360002
223700     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                    22370002
223800           PERFORM 3305-EDIT-LINES.                               22380002
223900                                                                  22390002
224000                                                                  22400002
224100     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 22410002
224200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               22420002
224300     IF  ASC-ITEM-SUB < 1                                         22430002
224400         SUBTRACT +1 FROM ASC-BLK-SUB                             22440002
224500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                22450002
224600     END-IF.                                                      22460002
224700                                                                  22470002
224800                                                                  22480002
224900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22490002
225000*  EDIT SELECTED LINES                                           *22500002
225100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22510002
225200 3305-EDIT-LINES.                                                 22520002
225300                                                                  22530002
225400* RE-CHECK LINE-STATUS                                            22540002
225500                                                                  22550002
225600     EVALUATE TRUE                                                22560002
225700         WHEN  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)             22570002
225800               PERFORM 3330-CHECK-LBL-CREATE-FLDS                 22580002
225900     END-EVALUATE.                                                22590002
226000                                                                  22600002
226100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22610002
226200*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *22620002
226300*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *22630002
226400*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *22640002
226500*  THE ENDING.                                                   *22650002
226600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22660002
226700 3310-EDIT-RANGE.                                                 22670002
226800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                22680002
226900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   22690002
227000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)22700002
227100                                   TO ASC-SELECTED-SW             22710002
227200                                        (ASC-BLK-SUB ASC-ITEM-SUB)22720002
227300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 22730002
227400         ELSE                                                     22740002
227500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     22750002
227600                 CONTINUE                                         22760002
227700             ELSE                                                 22770002
227800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        22780002
227900                 MOVE PC-TSYMSG-00054                             22790002
228000                                   TO DP020-MSG-NUMBER            22800002
228100                 SET DP020-MSG-FATAL                              22810002
228200                                   TO TRUE                        22820002
228300                 MOVE -1           TO MR-SELECTL (PV-SUB)         22830002
228400                 SET DP030-SET-CURSOR-APPL-1                      22840002
228500                                   TO TRUE                        22850002
228600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         22860002
228700                 MOVE DP015-UNDERLINE                             22870002
228800                                   TO MR-SELECTH (PV-SUB)         22880002
228900                 SET PS-ERROR      TO TRUE                        22890002
229000             END-IF                                               22900002
229100         END-IF                                                   22910002
229200     ELSE                                                         22920002
229300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22930002
229400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22940002
229500                                   TO ASC-SELECTED-SW             22950002
229600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22960002
229700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   22970002
229800         ELSE                                                     22980002
229900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       22990002
230000                 CONTINUE                                         23000002
230100             ELSE                                                 23010002
230200*                -- ONLY ONE END-OF-RANGE ALLOWED --              23020002
230300                 MOVE PC-TSYMSG-00055                             23030002
230400                                   TO DP020-MSG-NUMBER            23040002
230500                 SET DP020-MSG-FATAL                              23050002
230600                                   TO TRUE                        23060002
230700                 MOVE -1           TO MR-SELECTL (PV-SUB)         23070002
230800                 SET DP030-SET-CURSOR-APPL-1                      23080002
230900                                   TO TRUE                        23090002
231000                 SET PS-ERROR      TO TRUE                        23100002
231100             END-IF                                               23110002
231200         END-IF                                                   23120002
231300     END-IF.                                                      23130002
231400                                                                  23140002
231500                                                                  23150002
231600                                                                  23160002
231700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23170002
231800* LABEL OPTION REQUIRED FIELDS:                                  *23180002
231900*      SHIP CARTONS MAY NOT BE 0 FOR SELECTED LINE               *23190002
232000*      LABELS CANNOT BE PRINTED IF STORE TYPE DC OR RV           *23200002
232100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23210002
232200 3330-CHECK-LBL-CREATE-FLDS.                                      23220002
232300      IF  ASC-CARTQTY  (ASC-BLK-SUB ASC-ITEM-SUB) = 0             23230002
232400      AND ASC-NUMBER-OF-SELECTED-ITEMS = 1                        23240002
232500         MOVE PC-TSYMSG-01786   TO DP020-MSG-NUMBER               23250002
232600         SET DP020-MSG-FATAL    TO TRUE                           23260002
232700         MOVE -1                TO MR-SELECTL (PV-SUB)            23270002
232800         SET DP030-SET-CURSOR-APPL-1                              23280002
232900                                TO TRUE                           23290002
233000         MOVE DP015-RED     TO MR-STOREC (PV-SUB)                 23300002
233100         MOVE DP015-REVERSE TO MR-STOREH (PV-SUB)                 23310002
233200         SET PS-ERROR TO TRUE                                     23320002
233300     END-IF.                                                      23330002
233400                                                                  23340002
233500      IF  ASC-STORE-TYPE  (ASC-BLK-SUB ASC-ITEM-SUB) =            23350002
233600          PC-DC OR PC-RV                                          23360002
233700      AND ASC-NUMBER-OF-SELECTED-ITEMS = 1                        23370002
233800         MOVE PC-TSYMSG-01787   TO DP020-MSG-NUMBER               23380002
233900         SET DP020-MSG-FATAL    TO TRUE                           23390002
234000         MOVE -1                TO MR-SELECTL (PV-SUB)            23400002
234100         SET DP030-SET-CURSOR-APPL-1                              23410002
234200                                TO TRUE                           23420002
234300         MOVE DP015-RED     TO MR-STOREC (PV-SUB)                 23430002
234400         MOVE DP015-REVERSE TO MR-STOREH (PV-SUB)                 23440002
234500         SET PS-ERROR TO TRUE                                     23450002
234600     END-IF.                                                      23460002
234700                                                                  23470002
234800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23480002
234900*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *23490002
235000*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *23500002
235100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23510002
235200 3400-CHECK-RANGE-SEQUENCE.                                       23520002
235300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23530002
235400       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23540002
235500       AND  ASC-START-OF-SELECTED-RANGE >                         23550002
235600                                         ASC-END-OF-SELECTED-RANGE23560002
235700*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23570002
235800         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23580002
235900         SET DP020-MSG-FATAL TO TRUE                              23590002
236000         SET PS-ERROR TO TRUE                                     23600002
236100         PERFORM 3410-POSITION-AT-ERROR                           23610002
236200     END-IF.                                                      23620002
236300                                                                  23630002
236400                                                                  23640002
236500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23650002
236600*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *23660002
236700*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *23670002
236800*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *23680002
236900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23690002
237000 3410-POSITION-AT-ERROR.                                          23700002
237100     SET DP030-SET-CURSOR-APPL-1                                  23710002
237200                                   TO TRUE.                       23720002
237300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23730002
237400                    - PV-TOP-ITEM + 1.                            23740002
237500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23750002
237600         CONTINUE                                                 23760002
237700     ELSE                                                         23770002
237800         MOVE -1                   TO MR-SELECTL (PV-SUB)         23780002
237900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23790002
238000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23800002
238100     END-IF.                                                      23810002
238200                                                                  23820002
238300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   23830002
238400                    - PV-TOP-ITEM + 1.                            23840002
238500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23850002
238600         CONTINUE                                                 23860002
238700     ELSE                                                         23870002
238800         MOVE -1                   TO MR-SELECTL (PV-SUB)         23880002
238900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23890002
239000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23900002
239100     END-IF.                                                      23910002
239200                                                                  23920002
239300                                                                  23930002
239400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23940002
239500*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *23950002
239600*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *23960002
239700*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *23970002
239800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23980002
239900 3500-MARK-RANGE-AS-SELECTED.                                     23990002
240000     MOVE +1                       TO  ASC-BLK-SUB.               24000002
240100     PERFORM 3510-MARK-SELECTED-INDS                              24010002
240200         VARYING ASC-ITEM-SUB                                     24020002
240300         FROM 1 BY 1                                              24030002
240400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24040002
240500                                                                  24050002
240600     ADD +1                        TO ASC-BLK-SUB.                24060002
240700     PERFORM 3510-MARK-SELECTED-INDS                              24070002
240800         VARYING ASC-ITEM-SUB                                     24080002
240900         FROM 1 BY 1                                              24090002
241000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24100002
241100                                                                  24110002
241200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24120002
241300                                   TO  PV-LIST-ITEM-NUMBER.       24130002
241400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24140002
241500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         24150002
241600               PC-ITEMS-PER-PANEL).                               24160002
241700                                                                  24170002
241800     MOVE ASC-START-OF-SELECTED-RANGE                             24180002
241900                                   TO PV-START-OF-SELECTED-RANGE. 24190002
242000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24200002
242100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24210002
242200               PC-ITEMS-PER-PANEL).                               24220002
242300                                                                  24230002
242400     MOVE ASC-END-OF-SELECTED-RANGE                               24240002
242500                                   TO  PV-END-OF-SELECTED-RANGE.  24250002
242600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24260002
242700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24270002
242800               PC-ITEMS-PER-PANEL).                               24280002
242900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             24290002
243000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             24300002
243100                                                                  24310002
243200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24320002
243300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24330002
243400         MOVE +1                   TO ASC-BLK-SUB                 24340002
243500         PERFORM 5100-WRITE-TEMP-STORAGE                          24350002
243600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24360002
243700             PV-FIRST-BLOCK-IN-ARRAY - 1                          24370002
243800                                                                  24380002
243900         PERFORM                                                  24390002
244000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24400002
244100                   PV-PREV-BLOCK-IN-ARRAY                         24410002
244200             MOVE PV-FIRST-BLOCK-IN-RANGE                         24420002
244300                                   TO PV-BLOCK-NUMBER             24430002
244400             PERFORM 4410-READ-TEMP-STORAGE                       24440002
244500             PERFORM 3510-MARK-SELECTED-INDS                      24450002
244600                 VARYING ASC-ITEM-SUB                             24460002
244700                 FROM 1 BY 1                                      24470002
244800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24480002
244900             PERFORM 5100-WRITE-TEMP-STORAGE                      24490002
245000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     24500002
245100         END-PERFORM                                              24510002
245200                                                                  24520002
245300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24530002
245400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24540002
245500         PERFORM                                                  24550002
245600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24560002
245700                   PV-LAST-BLOCK-IN-RANGE                         24570002
245800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24580002
245900                                   TO PV-BLOCK-NUMBER             24590002
246000             PERFORM 4410-READ-TEMP-STORAGE                       24600002
246100             PERFORM 3510-MARK-SELECTED-INDS                      24610002
246200                 VARYING ASC-ITEM-SUB                             24620002
246300                 FROM 1 BY 1                                      24630002
246400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24640002
246500             PERFORM 5100-WRITE-TEMP-STORAGE                      24650002
246600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24660002
246700         END-PERFORM                                              24670002
246800                                                                  24680002
246900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24690002
247000                                   TO PV-BLOCK-NUMBER             24700002
247100         PERFORM 4410-READ-TEMP-STORAGE                           24710002
247200     END-IF.                                                      24720002
247300                                                                  24730002
247400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 24740002
247500                                      ASC-END-OF-SELECTED-RANGE.  24750002
247600                                                                  24760002
247700                                                                  24770002
247800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*24780002
247900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *24790002
248000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*24800002
248100 3510-MARK-SELECTED-INDS.                                         24810002
248200                                                                  24820002
248300     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24830002
248400                                ASC-ITEM-SUB) >                   24840002
248500         ASC-START-OF-SELECTED-RANGE)                             24850002
248600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24860002
248700                                ASC-ITEM-SUB) =                   24870002
248800         ASC-START-OF-SELECTED-RANGE)                             24880002
248900                                                                  24890002
249000         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24900002
249100                                    ASC-ITEM-SUB) <               24910002
249200             ASC-END-OF-SELECTED-RANGE)                           24920002
249300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24930002
249400                                    ASC-ITEM-SUB) =               24940002
249500             ASC-END-OF-SELECTED-RANGE)                           24950002
249600                                                                  24960002
249700             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          24970002
249800                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   24980002
249900                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   24990002
250000                               TO TRUE                            25000002
250100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25010002
250200                               TO TRUE                            25020002
250300                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    25030002
250400             END-IF                                               25040002
250500         END-IF                                                   25050002
250600     END-IF.                                                      25060002
250700                                                                  25070002
250800                                                                  25080002
250900                                                                  25090002
251000                                                                  25100002
251100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*25110002
251200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25120002
251300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25130002
251400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25140002
251500*    DISPLAY THE PANEL TO USER.                                  *25150002
251600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*25160002
251700 4000-BUILD-INITIAL-PANEL.                                        25170002
251800                                                                  25180002
251900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            25190002
252000                                 ASC-BLOCK-ENTRIES (2).           25200002
252100     MOVE +1                  TO ASC-BLK-SUB.                     25210002
252200     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            25220002
252300                                                                  25230002
252400     MOVE +0                  TO ASC-ITEM-SUB                     25240002
252500                                 ASC-NUMBER-OF-ITEMS-READ         25250002
252600                                 ASC-NUMBER-OF-SELECTED-ITEMS     25260002
252700                                 ASC-HIGHEST-BLOCK-WRITTEN        25270002
252800                                 ASC-START-OF-SELECTED-RANGE      25280002
252900                                 ASC-END-OF-SELECTED-RANGE        25290002
253000                                 ASC-ITEM-AT-TOP-OF-PANEL.        25300002
253100                                                                  25310002
253200     PERFORM 4050-GET-TDISTHD.                                    25320002
253210     PERFORM 4095-CHECK-ERROR-ON-DOWNLOAD.                        25321068
253300                                                                  25330002
253400     MOVE  DISTHD-SPC-INSTR-DESC    TO  ASC-SPEC-INST-DESC.       25340002
253500     MOVE  DISTHD-FCSE-LBL-TYP-CDE  TO  ASC-DISTHD-ORIG-LBL-TYP.  25350002
253600                                                                  25360002
253700     EVALUATE DISTHD-FCSE-LBL-TYP-CDE                             25370002
253800         WHEN PC-O                                                25380002
253900         WHEN PC-P                                                25390002
254000             MOVE PC-P TO ASC-LBL-PRT-ORDER                       25400002
254100         WHEN PC-R                                                25410002
254200         WHEN PC-S                                                25420002
254300             MOVE PC-S TO ASC-LBL-PRT-ORDER                       25430002
254400         WHEN PC-X                                                25440002
254500             MOVE PC-X TO ASC-LBL-PRT-ORDER                       25450002
254600     END-EVALUATE.                                                25460002
254700     IF ASC-INPK-UNT-QTY = 0                                      25470002
254800         MOVE DISTHD-INPK-UNT-QTY TO ASC-INPK-UNT-QTY             25480002
254900     END-IF.                                                      25490002
255000     IF ASC-OTPK-UNT-QTY = 0                                      25500002
255100         MOVE DISTHD-OTPK-UNT-QTY TO ASC-OTPK-UNT-QTY             25510002
255200     END-IF.                                                      25520002
255300     IF ASC-INPK-CNVYB-IND = SPACES OR LOW-VALUES                 25530002
255400         MOVE DISTHD-INPK-CNVYB-IND TO ASC-INPK-CNVYB-IND         25540002
255500     END-IF.                                                      25550002
255600     IF ASC-MODU-NBR = SPACES OR LOW-VALUES OR '000'              25560002
255700         MOVE   DISTHD-PRC-AREA-MODU-ID TO ASC-MODU-NBR           25570002
255800     END-IF.                                                      25580002
255900     MOVE DISTHD-P2L-CART-CNT TO ASC-P2L-CART-CNT.                25590002
256000     ADD DISTHD-FCSE-CART-CNT, DISTHD-INPK-CART-CNT               25600002
256100          GIVING ASC-SHIP-CART-CNT.                               25610002
256200     MOVE DISTHD-TOT-CART-CNT  TO ASC-PROC-CART-CNT.              25620002
256300     MULTIPLY DISTHD-TOT-CART-CNT BY DISTHD-OTPK-UNT-QTY          25630002
256400          GIVING ASC-PROC-QTY.                                    25640002
256500                                                                  25650017
256600* 7/09 BEGIN                                                      25660002
256700     IF  DISTHD-ODD-CART-UNT-QTY  >  0                            25670002
256800         SUBTRACT 1                                               25680002
256900             FROM DISTHD-TOT-CART-CNT                             25690002
257000           GIVING PV-TOT-CRTN-AFTER-ODD                           25700002
257100                                                                  25710002
257200           MULTIPLY PV-TOT-CRTN-AFTER-ODD                         25720002
257300               BY   DISTHD-OTPK-UNT-QTY                           25730002
257400           GIVING   ASC-PROC-QTY                                  25740002
257500              ADD   DISTHD-ODD-CART-UNT-QTY                       25750002
257600               TO   ASC-PROC-QTY                                  25760002
257700* 7/09 END                                                        25770002
257800     ELSE                                                         25780002
257900     MULTIPLY DISTHD-TOT-CART-CNT BY DISTHD-OTPK-UNT-QTY          25790002
258000          GIVING ASC-PROC-QTY.                                    25800002
258100                                                                  25810017
258200     IF  ASC-PRE-PACK-ORDER                                       25820017
258300         DIVIDE  ASC-PROC-QTY                                     25830017
258400             BY  ASC-PREPK-RATIO                                  25840017
258500         GIVING  ASC-PROC-PAK                                     25850017
258600     END-IF.                                                      25860017
258700                                                                  25870002
258800     PERFORM 4040-GET-TRECITM.                                    25880002
258900     EVALUATE TRUE                                                25890002
259000       WHEN   RECITM-STATUS-CDE = 'VE'                            25900002
259100            MOVE 'VERFYD  '              TO ASC-STATUS            25910002
259200       WHEN   DISTHD-PRCG-STAT-CDE = 'P' OR 'V'                   25920002
259300            MOVE 'PRVRFYD  '             TO ASC-STATUS            25930002
259400       WHEN   DISTHD-PRCG-STAT-CDE = 'D'                          25940002
259500           IF DISTHD-P2L-CART-CNT = 0                             25950002
259600               MOVE 'FCS RDY '          TO ASC-STATUS             25960002
259700           ELSE                                                   25970002
259800               MOVE 'DOWNLD   '         TO ASC-STATUS             25980002
259900           END-IF                                                 25990002
260000       WHEN DISTHD-PRCG-STAT-CDE = 'B'                            26000002
260100           IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TIMESTAMP      26010002
260200               MOVE 'CNFM ND  '         TO ASC-STATUS             26020002
260300           ELSE                                                   26030002
260400               IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TIMESTAMP   26040002
260500                  MOVE 'P2L ND   '     TO ASC-STATUS              26050002
260600               END-IF                                             26060002
260700           END-IF                                                 26070002
260800* BAD RATIO                                                       26080022
260900         WHEN DISTHD-PRCG-STAT-CDE  =  'A'                        26090022
261000              MOVE 'BAD RAT '          TO ASC-STATUS              26100023
261100* NOT ARRIVED                                                     26110022
261200         WHEN DISTHD-PRCG-STAT-CDE  =  'G'                        26120022
261300              MOVE 'NOT ARR '          TO ASC-STATUS              26130023
261400                                                                  26140002
261500       WHEN ASC-STATUS = SPACES                                   26150002
261600           MOVE 'READY    '             TO ASC-STATUS             26160002
261700     END-EVALUATE.                                                26170002
261800                                                                  26180002
261900     PERFORM 4060-GET-TDISTDT.                                    26190002
262000                                                                  26200002
262100     IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TIMESTAMP             26210002
262200         MOVE DISTDT-P2L-SPLT-UNT-QTY TO ASC-P2L-QTY              26220002
262300     ELSE                                                         26230002
262400         MOVE DISTDT-ACTL-ALLOC-QTY TO ASC-P2L-QTY                26240002
262500     END-IF.                                                      26250002
262600                                                                  26260017
262700     IF  ASC-PRE-PACK-ORDER                                       26270017
262800         DIVIDE  ASC-P2L-QTY                                      26280017
262900             BY  ASC-PREPK-RATIO                                  26290017
263000         GIVING  ASC-P2L-PAK                                      26300017
263100     END-IF.                                                      26310017
263200                                                                  26320017
263300     IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TIMESTAMP            26330002
263400         ADD DISTDT-FCSE-SPLT-UNT-QTY,                            26340002
263500             DISTDT-INPK-SPLT-UNT-QTY GIVING                      26350002
263600             ASC-SHIP-QTY                                         26360002
263700     ELSE                                                         26370002
263800         MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-SHIP-QTY            26380002
263900     END-IF.                                                      26390002
264000                                                                  26400017
264100     IF  ASC-PRE-PACK-ORDER                                       26410017
264200         DIVIDE  ASC-SHIP-QTY                                     26420017
264300             BY  ASC-PREPK-RATIO                                  26430017
264400         GIVING  ASC-SHIP-PAK                                     26440017
264500     END-IF.                                                      26450017
264600                                                                  26460002
264700     PERFORM 4070-GET-TRECDIS.                                    26470002
264800     IF  RECITM-STATUS-CDE = 'VE'                                 26480002
264900         MOVE RECDIS-AP-VERIFY-ITM-QTY TO ASC-PKSL-QTY            26490002
265000     ELSE                                                         26500002
265100         MOVE RECDIS-EXPTED-ITM-QTY TO ASC-PKSL-QTY               26510002
265200     END-IF.                                                      26520002
265300                                                                  26530002
265400     IF  ASC-PRE-PACK-ORDER                                       26540017
265500         DIVIDE  ASC-PKSL-QTY                                     26550017
265600             BY  ASC-PREPK-RATIO                                  26560017
265700         GIVING  ASC-PKSL-PAK                                     26570017
265800     END-IF.                                                      26580017
265900                                                                  26590017
266000     IF ASC-SKU = SPACES                                          26600002
266100         PERFORM 4080-GET-ITEM-NBR                                26610037
266200         IF RECITM-ITM-NBR = ZEROES                               26620038
266300            MOVE ZEROES TO ASC-SKU                                26630038
266400                           PC126-ITEM-NBR                         26640038
266500         ELSE                                                     26650038
266600            PERFORM 4090-CALL-XLKUT001                            26660038
266700         END-IF                                                   26670038
266800     END-IF.                                                      26680002
266900                                                                  26690002
267000     IF  PS-NO-ERROR                                              26700002
267100         PERFORM 4110-OPEN-CURSOR.                                26710002
267200                                                                  26720002
267300     IF  PS-NO-ERROR                                              26730002
267400         PERFORM 4300-READ-ITEMS-FROM-DB.                         26740002
267500                                                                  26750002
267600     IF  PS-NO-ERROR                                              26760002
267700         PERFORM 4120-CLOSE-CURSOR.                               26770002
267800                                                                  26780002
267900     IF  PS-NO-ERROR                                              26790002
268000         MOVE +1                   TO  PV-TOP-ITEM                26800002
268100         IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      26810002
268200             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                26820002
268300             SET DP020-MSG-FATAL   TO  TRUE                       26830002
268400             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           26840002
268500         ELSE                                                     26850002
268600             MOVE -1               TO MR-SELECTL (1)              26860002
268700             SET DP030-SET-CURSOR-APPL-1                          26870002
268800                                   TO TRUE                        26880002
268900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 26890002
269000         END-IF                                                   26900002
269100     END-IF.                                                      26910002
269200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*26920002
269300* GET STATUS CD FROM TRECITM                                     *26930002
269400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*26940002
269500                                                                  26950002
269600 4040-GET-TRECITM.                                                26960002
269700                                                                  26970002
269800     EXEC SQL                                                     26980002
269900     SELECT                                                       26990002
270000               STATUS_CDE                                         27000002
270100         INTO                                                     27010002
270200              :RECITM-STATUS-CDE                                  27020002
270300         FROM  TRECITM                                            27030002
270400         WHERE ORD_NBR          = :ASC-PO-NBR                     27040002
270500         AND REC_SEQ_NBR        = :ASC-REC-SEQ-NBR                27050002
270600         AND ORD_LNE_NBR        = :ASC-PO-LNE-NBR                 27060002
270700         AND VER_STATUS_CDE     = 'A'                             27070002
270800     END-EXEC.                                                    27080002
270900                                                                  27090002
271000     EVALUATE TRUE                                                27100002
271100         WHEN SQLCODE = ZERO                                      27110002
271200             CONTINUE                                             27120002
271300         WHEN SQLCODE = +100                                      27130002
271400             MOVE SPACES              TO RECITM-STATUS-CDE        27140002
271500         WHEN SQLCODE = -904                                      27150002
271600         WHEN SQLCODE = -911                                      27160002
271700         WHEN SQLCODE = -913                                      27170002
271800             PERFORM 9900-SOFT-ABORT                              27180002
271900                                                                  27190002
272000         WHEN SQLWARN0 NOT = SPACES                               27200002
272100         WHEN SQLCODE < ZERO                                      27210002
272200         WHEN SQLCODE > ZERO                                      27220002
272300             MOVE '4040-GET-RECITM'                               27230002
272400                                  TO DP013-PARAGRAPH              27240002
272500             MOVE 'UNSUCCESSFUL SELECT FOR STATUS CD'             27250002
272600                                  TO DP013-MESSAGE-TEXT (1)       27260002
272700             MOVE SQLCA      TO DP013-SQLCA                       27270002
272800             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          27280002
272900             SET DP013-DB2-ABEND                                  27290002
273000                 DP013-NO-ROLLBACK                                27300002
273100                                  TO TRUE                         27310002
273200             PERFORM DP013-0000-PROCESS-ABEND                     27320002
273300     END-EVALUATE.                                                27330002
273400                                                                  27340002
273500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*27350002
273600* GET REMAINING INFO FROM TDISTHD                                *27360002
273700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*27370002
273800 4050-GET-TDISTHD.                                                27380002
273900                                                                  27390002
274000         EXEC SQL                                                 27400002
274100             SELECT PRC_AREA_MODU_ID,                             27410002
274200                    FCSE_LBL_TYP_CDE,                             27420002
274300                    INPK_UNT_QTY,                                 27430002
274400                    OTPK_UNT_QTY,                                 27440002
274500                    INPK_CNVYB_IND,                               27450002
274600                    TOT_CART_CNT,                                 27460002
274700                    P2L_CART_CNT,                                 27470002
274800                    FCSE_CART_CNT,                                27480002
274900                    INPK_CART_CNT,                                27490002
275000                    RSLTS_RCVD_TMST,                              27500002
275100                    FCSE_CNFRMN_TMST,                             27510002
275200                    PRCG_STAT_CDE,                                27520002
275300                    SPC_INSTR_DESC,                               27530002
275400                    ODD_CART_UNT_QTY                              27540002
275500             INTO   :DISTHD-PRC-AREA-MODU-ID,                     27550002
275600                    :DISTHD-FCSE-LBL-TYP-CDE,                     27560002
275700                    :DISTHD-INPK-UNT-QTY,                         27570002
275800                    :DISTHD-OTPK-UNT-QTY,                         27580002
275900                    :DISTHD-INPK-CNVYB-IND,                       27590002
276000                    :DISTHD-TOT-CART-CNT,                         27600002
276100                    :DISTHD-P2L-CART-CNT,                         27610002
276200                    :DISTHD-FCSE-CART-CNT,                        27620002
276300                    :DISTHD-INPK-CART-CNT,                        27630002
276400                    :DISTHD-RSLTS-RCVD-TMST,                      27640002
276500                    :DISTHD-FCSE-CNFRMN-TMST,                     27650002
276600                    :DISTHD-PRCG-STAT-CDE,                        27660002
276700                    :DISTHD-SPC-INSTR-DESC,                       27670002
276800                    :DISTHD-ODD-CART-UNT-QTY                      27680002
276900             FROM  TDISTHD                                        27690002
277000          WHERE ORD_NBR          =  :ASC-PO-NBR                   27700002
277100          AND   ORD_LNE_NBR      =  :ASC-PO-LNE-NBR               27710002
277200          AND   RCVR_SEQ_NBR     =  :ASC-REC-SEQ-NBR              27720002
277300         END-EXEC.                                                27730002
277400                                                                  27740002
277500         EVALUATE TRUE                                            27750002
277600                                                                  27760002
277700             WHEN SQLCODE = +0                                    27770002
277800             WHEN SQLCODE = +100                                  27780002
277900             WHEN SQLCODE = -811                                  27790002
278000             WHEN SQLCODE = -904                                  27800002
278100             WHEN SQLCODE = -913                                  27810002
278200                 CONTINUE                                         27820002
278300                                                                  27830002
278400             WHEN SQLWARN0 NOT = SPACES                           27840002
278500             WHEN SQLCODE < +0                                    27850002
278600             WHEN SQLCODE > +0                                    27860002
278700                 MOVE '4050-GET-TDISTHD'                          27870002
278800                                 TO DP013-PARAGRAPH               27880002
278900                 MOVE 'GET DATA FROM TDISTHD TABLE'               27890002
279000                                 TO DP013-MESSAGE-TEXT (1)        27900002
279100                 MOVE SQLCA      TO DP013-SQLCA                   27910002
279200                 MOVE 'TDISTHD'  TO DP013-DB2-TABLE-NAME (1)      27920002
279300                 SET DP013-DB2-ABEND                              27930002
279400                     DP013-XCTL-DISPLAY-RESTART                   27940002
279500                                 TO TRUE                          27950002
279600                 PERFORM DP013-0000-PROCESS-ABEND                 27960002
279700         END-EVALUATE.                                            27970002
279800                                                                  27980002
279900                                                                  27990002
280000                                                                  28000002
280100                                                                  28010002
280200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*28020002
280300* GET QUANTITY INFO FROM TDISTDT                                 *28030002
280400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*28040002
280500 4060-GET-TDISTDT.                                                28050002
280600                                                                  28060002
280700                                                                  28070002
280800         EXEC SQL                                                 28080002
280900             SELECT SUM(P2L_SPLT_UNT_QTY),                        28090002
281000                    SUM(ACTL_ALLOC_QTY),                          28100002
281100                    SUM(FCSE_SPLT_UNT_QTY),                       28110002
281200                    SUM(INPK_SPLT_UNT_QTY),                       28120002
281300                    SUM(FCSE_ACTL_UNT_QTY)                        28130002
281400             INTO   :DISTDT-P2L-SPLT-UNT-QTY,                     28140002
281500                    :DISTDT-ACTL-ALLOC-QTY,                       28150002
281600                    :DISTDT-FCSE-SPLT-UNT-QTY,                    28160002
281700                    :DISTDT-INPK-SPLT-UNT-QTY,                    28170002
281800                    :DISTDT-FCSE-ACTL-UNT-QTY                     28180002
281900             FROM  TDISTDT                                        28190002
282000         WHERE  ORD_NBR          =  :ASC-PO-NBR                   28200002
282100          AND   ORD_LNE_NBR      =  :ASC-PO-LNE-NBR               28210002
282200          AND   RCVR_SEQ_NBR     =  :ASC-REC-SEQ-NBR              28220002
282300         END-EXEC.                                                28230002
282400                                                                  28240002
282500         EVALUATE TRUE                                            28250002
282600                                                                  28260002
282700             WHEN SQLCODE = +0                                    28270002
282800                 CONTINUE                                         28280002
282900             WHEN SQLCODE = +100                                  28290002
283000             WHEN SQLCODE = -305                                  28300002
283100             WHEN SQLCODE = -811                                  28310002
283200             WHEN SQLCODE = -904                                  28320002
283300             WHEN SQLCODE = -913                                  28330002
283400                MOVE 0 TO DISTDT-P2L-SPLT-UNT-QTY                 28340002
283500                          DISTDT-ACTL-ALLOC-QTY                   28350002
283600                          DISTDT-FCSE-SPLT-UNT-QTY                28360002
283700                          DISTDT-INPK-SPLT-UNT-QTY                28370002
283800                          DISTDT-FCSE-ACTL-UNT-QTY                28380002
283900                                                                  28390002
284000             WHEN SQLWARN0 NOT = SPACES                           28400002
284100             WHEN SQLCODE < +0                                    28410002
284200             WHEN SQLCODE > +0                                    28420002
284300                 MOVE '4060-GET-TDISTDT'                          28430002
284400                                 TO DP013-PARAGRAPH               28440002
284500                 MOVE 'GET DATA FROM TDISTDT TABLE'               28450002
284600                                 TO DP013-MESSAGE-TEXT (1)        28460002
284700                 MOVE SQLCA      TO DP013-SQLCA                   28470002
284800                 MOVE 'TDISTDT'  TO DP013-DB2-TABLE-NAME (1)      28480002
284900                 SET DP013-DB2-ABEND                              28490002
285000                     DP013-XCTL-DISPLAY-RESTART                   28500002
285100                                 TO TRUE                          28510002
285200                 PERFORM DP013-0000-PROCESS-ABEND                 28520002
285300         END-EVALUATE.                                            28530002
285400                                                                  28540002
285500                                                                  28550002
285600                                                                  28560002
285700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*28570002
285800* GET PACKSLIP INFO FROM TRECDIS                                 *28580002
285900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*28590002
286000 4070-GET-TRECDIS.                                                28600002
286100                                                                  28610002
286200                                                                  28620002
286300         EXEC SQL                                                 28630002
286400             SELECT SUM(EXPTED_ITM_QTY),                          28640002
286500                    SUM(AP_VERIFY_ITM_QTY)                        28650002
286600             INTO   :RECDIS-EXPTED-ITM-QTY,                       28660002
286700                    :RECDIS-AP-VERIFY-ITM-QTY                     28670002
286800             FROM  TRECDIS                                        28680002
286900         WHERE  ORD_NBR          =  :ASC-PO-NBR                   28690002
287000          AND   ORD_LNE_NBR      =  :ASC-PO-LNE-NBR               28700002
287100          AND   REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR              28710002
287200         END-EXEC.                                                28720002
287300                                                                  28730002
287400         EVALUATE TRUE                                            28740002
287500                                                                  28750002
287600             WHEN SQLCODE = +0                                    28760002
287700                 CONTINUE                                         28770002
287800             WHEN SQLCODE = +100                                  28780002
287900             WHEN SQLCODE = -305                                  28790002
288000             WHEN SQLCODE = -811                                  28800002
288100             WHEN SQLCODE = -904                                  28810002
288200             WHEN SQLCODE = -913                                  28820002
288300                 MOVE 0 TO  RECDIS-EXPTED-ITM-QTY,                28830002
288400                            RECDIS-AP-VERIFY-ITM-QTY              28840002
288500                                                                  28850002
288600             WHEN SQLWARN0 NOT = SPACES                           28860002
288700             WHEN SQLCODE < +0                                    28870002
288800             WHEN SQLCODE > +0                                    28880002
288900                 MOVE '4070-GET-TRECDIS'                          28890002
289000                                 TO DP013-PARAGRAPH               28900002
289100                 MOVE 'GET DATA FROM TRECDIS TABLE'               28910002
289200                                 TO DP013-MESSAGE-TEXT (1)        28920002
289300                 MOVE SQLCA      TO DP013-SQLCA                   28930002
289400                 MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME (1)      28940002
289500                 SET DP013-DB2-ABEND                              28950002
289600                     DP013-XCTL-DISPLAY-RESTART                   28960002
289700                                 TO TRUE                          28970002
289800                 PERFORM DP013-0000-PROCESS-ABEND                 28980002
289900         END-EVALUATE.                                            28990002
290000                                                                  29000002
290100                                                                  29010002
290200                                                                  29020002
290300                                                                  29030002
290400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*29040002
290500* GET THE VENDOR STYLE NAME FROM TRECITM/TPURITM FOR PC126       *29050002
290600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*29060002
290700 4075-GET-VENDOR-STYLE.                                           29070002
290800     EXEC SQL                                                     29080002
290900          SELECT B.VEND_STYL_NAME                                 29090002
291000           INTO :PURITM-VEND-STYL-NAME                            29100002
291100           FROM TRECITM A                                         29110002
291200               ,TPURITM B                                         29120002
291300          WHERE A.ORD_NBR           = :ASC-PO-NBR                 29130002
291400            AND A.REC_SEQ_NBR       = :ASC-REC-SEQ-NBR            29140002
291500            AND A.ORD_LNE_NBR       = :ASC-PO-LNE-NBR             29150002
291600            AND A.VER_STATUS_CDE    = 'A'                         29160002
291700            AND A.ORD_NBR           = B.PO_NBR                    29170002
291800            AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR            29180002
291900            AND B.VER_STATUS_CDE    = 'A'                         29190002
292000     END-EXEC.                                                    29200002
292100                                                                  29210002
292200     EVALUATE TRUE                                                29220002
292300         WHEN SQLCODE = ZERO                                      29230002
292400              MOVE  PURITM-VEND-STYL-NAME  TO  PC126-VENDOR-STYLE 29240002
292500         WHEN SQLCODE = +100                                      29250002
292600         WHEN SQLCODE = -904                                      29260002
292700         WHEN SQLCODE = -913                                      29270002
292800              MOVE  SPACES                 TO  PC126-VENDOR-STYLE 29280002
292900         WHEN SQLWARN0 NOT = SPACES                               29290002
293000         WHEN SQLCODE < ZERO                                      29300002
293100         WHEN SQLCODE > ZERO                                      29310002
293200              MOVE '4075-GET-VENDOR-STYLE'                        29320002
293300                                     TO DP013-PARAGRAPH           29330002
293400              MOVE 'GET VENDOR STYLE NAME  '                      29340002
293500                                     TO DP013-MESSAGE-TEXT (1)    29350002
293600              MOVE SQLCA             TO DP013-SQLCA               29360002
293700              MOVE 'TPURITM'         TO DP013-DB2-TABLE-NAME (1)  29370002
293800              MOVE 'TRECITM'         TO DP013-DB2-TABLE-NAME (2)  29380002
293900              SET DP013-DB2-ABEND TO TRUE                         29390002
294000              SET DP013-XCTL-DISPLAY-RESTART                      29400002
294100                                     TO TRUE                      29410002
294200              PERFORM DP013-0000-PROCESS-ABEND                    29420002
294300     END-EVALUATE.                                                29430002
294400                                                                  29440002
294500                                                                  29450007
294600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*29460007
294700* GET SSCC-18-IND FROM TCOCNTL TO DETERMINE IF DC IS SET UP      *29470007
294800* TO PROCESS 20 & 22 DIGIT BARCODES                              *29480007
294900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*29490007
295000 4076-GET-TCOCNTL-INFO.                                           29500007
295100                                                                  29510007
295200     MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID.                    29520008
295300                                                                  29530007
295400     EXEC SQL                                                     29540007
295500          SELECT  SSCC_18_IND                                     29550007
295600            INTO :COCNTL-SSCC-18-IND                              29560007
295700            FROM  TCOCNTL                                         29570007
295800           WHERE  OPER_UNT_ID  = :DK-OPER-UNT-ID                  29580008
295900     END-EXEC.                                                    29590007
296000                                                                  29600007
296100     EVALUATE TRUE                                                29610007
296200         WHEN SQLCODE = ZERO                                      29620007
296300              CONTINUE                                            29630007
296400         WHEN SQLWARN0 NOT = SPACES                               29640007
296500         WHEN SQLCODE < ZERO                                      29650007
296600         WHEN SQLCODE > ZERO                                      29660007
296700              MOVE '4076-GET-TCOCNTL-INFO'                        29670007
296800                                     TO DP013-PARAGRAPH           29680007
296900              MOVE 'GET SSCC-18-IND        '                      29690007
297000                                     TO DP013-MESSAGE-TEXT (1)    29700007
297100              MOVE SQLCA             TO DP013-SQLCA               29710007
297200              MOVE 'TCOCNTL'         TO DP013-DB2-TABLE-NAME (1)  29720007
297300              SET DP013-DB2-ABEND TO TRUE                         29730007
297400              SET DP013-XCTL-DISPLAY-RESTART                      29740007
297500                                     TO TRUE                      29750007
297600              PERFORM DP013-0000-PROCESS-ABEND                    29760007
297700     END-EVALUATE.                                                29770007
297800                                                                  29780007
297900                                                                  29790007
298000*----------------------------------------------------------------*29800013
298100* GET THE TOTAL NUMBER OF UNITS FOR A PREPACK ORDER (M OR I)     *29810013
298200*----------------------------------------------------------------*29820013
298300 4078-GET-TOT-PREPK-UNTS.                                         29830013
298400     MOVE ASC-PO-NBR       TO  DK2-PO-NBR                         29840030
298500                               PV-DSPLY-PO-NBR.                   29850030
298600     MOVE ASC-REC-SEQ-NBR  TO  DK2-REC-SEQ-NBR                    29860030
298700                               PV-DSPLY-REC-SEQ-NBR.              29870030
298800     MOVE ASC-PREPK-ID     TO  DK2-PREPK-ID                       29880030
298900                               PV-DSPLY-PREPK-ID.                 29890030
299000                                                                  29900013
299100     EXEC SQL                                                     29910013
299200         SELECT SUM(PREPK_RATO_QTY)                               29920013
299300               ,SUM(INNR_PACK_QTY)                                29930035
299400           INTO :PV-TOT-PREPK-UNTS                                29940035
299500               ,:PV-TOT-PREPK-INPK-UNTS                           29950035
299600           FROM TRECITM                                           29960035
299700          WHERE ORD_NBR      =  :DK2-PO-NBR                       29970035
299800            AND REC_SEQ_NBR  =  :DK2-REC-SEQ-NBR                  29980035
299900            AND PREPK_ID     =  :DK2-PREPK-ID                     29990035
300000     END-EXEC.                                                    30000035
300100                                                                  30010035
300200     EVALUATE TRUE                                                30020035
300300         WHEN SQLCODE = +0                                        30030035
300400             CONTINUE                                             30040035
300500         WHEN SQLCODE = -904                                      30050035
300600         WHEN SQLCODE = -913                                      30060035
300700              CONTINUE                                            30070035
300800         WHEN SQLWARN0 NOT = SPACES                               30080035
300900         WHEN SQLCODE < ZERO                                      30090035
301000         WHEN SQLCODE > ZERO                                      30100035
301100              MOVE '4078-GET-TOT-PREPK-UNTS'                      30110035
301200                                     TO DP013-PARAGRAPH           30120035
301300              MOVE 'GET TOTAL NUMBER OF UNIT IN PACK'             30130035
301400                                     TO DP013-MESSAGE-TEXT (1)    30140035
301500              STRING 'PO/RCVR - '       DELIMITED BY SIZE         30150035
301600                     PV-DSPLY-PO-NBR      DELIMITED BY SIZE       30160030
301700                     '-'                  DELIMITED BY SIZE       30170030
301800                     PV-DSPLY-REC-SEQ-NBR DELIMITED BY SIZE       30180030
301900                     '   PREPK ID-'       DELIMITED BY SIZE       30190030
302000                     PV-DSPLY-REC-SEQ-NBR DELIMITED BY SIZE       30200030
302100                                   INTO DP013-MESSAGE-TEXT (2)    30210030
302200              MOVE SQLCA             TO DP013-SQLCA               30220013
302300              MOVE 'TRECITM'         TO DP013-DB2-TABLE-NAME (1)  30230013
302400              SET DP013-DB2-ABEND TO TRUE                         30240013
302500              SET DP013-XCTL-DISPLAY-RESTART                      30250013
302600                                     TO TRUE                      30260013
302700              PERFORM DP013-0000-PROCESS-ABEND                    30270013
302800     END-EVALUATE.                                                30280013
302900                                                                  30290013
303000                                                                  30300013
303100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*30310002
303200* GET ITEM NUMBER FROM TRECITM                                   *30320037
303300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*30330002
303400 4080-GET-ITEM-NBR.                                               30340037
303500                                                                  30350002
303600                                                                  30360002
303700         EXEC SQL                                                 30370002
303800             SELECT A.ITM_NBR                                     30380037
303900             INTO  :RECITM-ITM-NBR                                30390037
304000             FROM  TRECITM A                                      30400037
304100        WHERE   A.ORD_NBR        =  :ASC-PO-NBR                   30410002
304200          AND   A.ORD_LNE_NBR    =  :ASC-PO-LNE-NBR               30420002
304300          AND   A.REC_SEQ_NBR    =  :ASC-REC-SEQ-NBR              30430002
304400          AND   A.VER_STATUS_CDE = 'A'                            30440002
304500                                                                  30450002
304600         END-EXEC.                                                30460002
304700                                                                  30470002
304800         EVALUATE TRUE                                            30480002
304900                                                                  30490002
305000             WHEN SQLCODE = +0                                    30500002
305100                 MOVE RECITM-ITM-NBR  TO ASC-ITEM-NBR             30510045
305200             WHEN SQLCODE = +100                                  30520002
305300             WHEN SQLCODE = -811                                  30530002
305400             WHEN SQLCODE = -904                                  30540002
305500             WHEN SQLCODE = -913                                  30550002
305600                 MOVE ZEROES TO  RECITM-ITM-NBR                   30560037
305700             WHEN SQLWARN0 NOT = SPACES                           30570002
305800             WHEN SQLCODE < +0                                    30580002
305900             WHEN SQLCODE > +0                                    30590002
306000                 MOVE '4080-GET-ITEM-NBR'                         30600037
306100                                 TO DP013-PARAGRAPH               30610002
306200                 MOVE 'GET DATA FROM TPURITM/TPURCHS'             30620002
306300                                 TO DP013-MESSAGE-TEXT (1)        30630002
306400                 MOVE SQLCA      TO DP013-SQLCA                   30640002
306500                 MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME (1)      30650002
306600                 SET DP013-DB2-ABEND                              30660002
306700                     DP013-XCTL-DISPLAY-RESTART                   30670002
306800                                 TO TRUE                          30680002
306900                 PERFORM DP013-0000-PROCESS-ABEND                 30690002
307000         END-EVALUATE.                                            30700002
307100                                                                  30710002
307200                                                                  30720002
307300                                                                  30730002
307400                                                                  30740002
307500*----------------------------------------------------------------*30750038
307600 4090-CALL-XLKUT001.                                              30760038
307700                                                                  30770038
307800     INITIALIZE XL001-ITEM-COMMAREA.                              30780038
307900                                                                  30790038
308000                                                                  30800038
308100     MOVE RECITM-ITM-NBR TO XL001-KEY-ITM-NBR                     30810038
308200                            PC126-ITEM-NBR                        30820038
308300                                                                  30830038
308400     SET  XL001-BY-ITEM                                           30840038
308500          XL001-SELECT-SKU       TO TRUE                          30850038
308600                                                                  30860038
308700     CALL XL001-VSM-PGM USING  DFHEIBLK                           30870038
308800                               XL001-COMMAREA                     30880038
308900                               XL001-ITEM-COMMAREA.               30890038
309000     EVALUATE TRUE                                                30900038
309100         WHEN XL001-SUCCESSFUL                                    30910038
309200             MOVE XL001-SKU-NBR TO ASC-SKU                        30920038
309300         WHEN XL001-SQL-ERROR                                     30930038
309400             MOVE RECITM-ITM-NBR TO PV-DISPLAY-ITEM-NBR           30940039
309500             IF XL001-SKU-NOT-FOUND                               30950039
309600                MOVE '4090-CALL-XLKUT001'                         30960039
309700                                  TO DP013-PARAGRAPH              30970039
309800                MOVE 'SKU NOT FOUND  - '                          30980039
309900                                  TO DP013-MESSAGE-TEXT (1)       30990039
310000                STRING ' PCKCS703 -'            DELIMITED BY SIZE 31000039
310100                       ' ITEM NUMBER - '        DELIMITED BY SIZE 31010039
310200                        PV-DISPLAY-ITEM-NBR     DELIMITED BY SIZE 31020039
310300                                INTO DP013-MESSAGE-TEXT (2)       31030039
310400                MOVE XL001-SQLCA  TO DP013-SQLCA                  31040039
310500                MOVE 'XLKUT001'   TO DP013-DB2-TABLE-NAME (1)     31050039
310600                SET DP013-DB2-ABEND                               31060039
310700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            31070039
310800                PERFORM DP013-0000-PROCESS-ABEND                  31080039
310900             ELSE                                                 31090039
311000                IF XL001-SKU-CONTENTION                           31100039
311100                  MOVE '4090-CALL-XLKUT001'                       31110039
311200                                  TO DP013-PARAGRAPH              31120039
311300                  MOVE 'TABLE CONTENTION-'                        31130039
311400                                  TO DP013-MESSAGE-TEXT (1)       31140039
311500                  STRING ' PCKCS703 -'         DELIMITED BY SIZE  31150039
311600                         ' ITEM NUMBER - '     DELIMITED BY SIZE  31160039
311700                          PV-DISPLAY-ITEM-NBR  DELIMITED BY SIZE  31170039
311800                                  INTO DP013-MESSAGE-TEXT (2)     31180039
311900                  MOVE XL001-SQLCA  TO DP013-SQLCA                31190039
312000                  MOVE 'XLKUT001'   TO DP013-DB2-TABLE-NAME (1)   31200039
312100                  SET DP013-DB2-ABEND                             31210039
312200                      DP013-XCTL-DISPLAY-RESTART TO TRUE          31220039
312300                  PERFORM DP013-0000-PROCESS-ABEND                31230039
312400                ELSE                                              31240039
312500                  MOVE '4090-CALL-XLKUT001'                       31250039
312600                                  TO DP013-PARAGRAPH              31260039
312700                  MOVE 'SQL ERROR   -----'                        31270039
312800                                  TO DP013-MESSAGE-TEXT (1)       31280039
312900                  STRING ' PCKCS703 -'         DELIMITED BY SIZE  31290039
313000                         ' ITEM NUMBER - '     DELIMITED BY SIZE  31300039
313100                          PV-DISPLAY-ITEM-NBR  DELIMITED BY SIZE  31310039
313200                                  INTO DP013-MESSAGE-TEXT (2)     31320039
313300                  MOVE XL001-SQLCA  TO DP013-SQLCA                31330039
313400                  MOVE 'XLKUT001'   TO DP013-DB2-TABLE-NAME (1)   31340039
313500                  SET DP013-DB2-ABEND                             31350039
313600                      DP013-XCTL-DISPLAY-RESTART TO TRUE          31360039
313700                  PERFORM DP013-0000-PROCESS-ABEND                31370039
313800                END-IF                                            31380039
313900             END-IF                                               31390041
314000         WHEN OTHER                                               31400038
314100                MOVE '4090-CALL-XLKUT001'                         31410039
314200                                  TO DP013-PARAGRAPH              31420039
314300                MOVE 'INVALID ACCESS - '                          31430039
314400                                  TO DP013-MESSAGE-TEXT (1)       31440039
314500                STRING ' PCKCS703 -'            DELIMITED BY SIZE 31450039
314600                       ' ITEM NUMBER - '        DELIMITED BY SIZE 31460039
314700                        PV-DISPLAY-ITEM-NBR     DELIMITED BY SIZE 31470039
314800                                INTO DP013-MESSAGE-TEXT (2)       31480039
314900                MOVE XL001-SQLCA  TO DP013-SQLCA                  31490039
315000                MOVE 'XLKUT001'   TO DP013-DB2-TABLE-NAME (1)     31500039
315100                SET DP013-DB2-ABEND                               31510039
315200                    DP013-XCTL-DISPLAY-RESTART TO TRUE            31520039
315300                PERFORM DP013-0000-PROCESS-ABEND                  31530039
315400     END-EVALUATE.                                                31540038
315410*----------------------------------------------------------------*31541068
315420* CHECK IF LABEL PRINT ABENDED ON INTIAL DOWNLOAD AND OTBND TABLE*31542068
315430* WAS NOT UPDATED CORRECTLY                                      *31543068
315440*----------------------------------------------------------------*31544068
315450 4095-CHECK-ERROR-ON-DOWNLOAD.                                    31545068
315460                                                                  31546068
315470                                                                  31547068
315480       EXEC SQL                                                   31548068
315490         SELECT A.SHIPT_UNT_ID                                    31549068
315491          INTO  :SUT00024-SHIPT-UNT-ID                            31549168
315492          FROM  SUT_OTBND_CART A                                  31549268
315493             ,  SUT_OTBND_UPC B                                   31549368
315494             ,  TKRPRPM       C                                   31549471
315495          WHERE   A.SHIPT_UNT_ID   =  B.SHIPT_UNT_ID              31549571
315496            AND   B.TRN_NBR        =  :ASC-PO-NBR                 31549671
315497            AND   B.TRN_LNE_NBR    =  :ASC-PO-LNE-NBR             31549771
315498            AND   B.RCVR_SEQ_NBR   =  :ASC-REC-SEQ-NBR            31549871
315499            AND   A.CART_TYP_CDE   =  ' '                         31549971
315500            AND   A.CART_SRC_CDE   =  'CPS'                       31550071
315501            AND   A.LBL_PRT_SEQ_NBR = 0                           31550171
315502            AND   A.ACTV_IND       = 'Y'                          31550271
315503            AND   A.ORGN_LOC_NBR   = C.LOC_ID                     31550371
315504            AND   C.SYS_PRC_FUNC_CDE  = 'CSMFST'                  31550471
315505            AND   C.FUNC_TXT          = 'Y'                       31550572
315506            AND   C.FUNC_PRC_STAT_CDE = 'AC'                      31550671
315507       END-EXEC.                                                  31550771
315508                                                                  31550871
315509         EVALUATE TRUE                                            31550971
315510                                                                  31551071
315511             WHEN SQLCODE = +0                                    31551171
315512             WHEN SQLCODE = -811                                  31551271
315513                 SET ASC-ERR-ON-LABEL-DWNLD TO TRUE               31551371
315514             WHEN SQLCODE = +100                                  31551471
315515                  SET ASC-ERR-ON-LABEL-DWNLD-NO TO TRUE           31551571
315516             WHEN SQLWARN0 NOT = SPACES                           31551671
315517             WHEN SQLCODE < +0                                    31551771
315518             WHEN SQLCODE > +0                                    31551871
315519                 MOVE '4095-CHECK-ERROR-ON-DOWNLOAD'              31551971
315520                                 TO DP013-PARAGRAPH               31552071
315521                 MOVE 'CHECK OTBND CARTON DATA  '                 31552171
315522                                 TO DP013-MESSAGE-TEXT (1)        31552271
315523                 MOVE SQLCA      TO DP013-SQLCA                   31552371
315524                 MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)31552471
315525                 SET DP013-DB2-ABEND                              31552571
315526                     DP013-XCTL-DISPLAY-RESTART                   31552671
315527                                 TO TRUE                          31552771
315528                 PERFORM DP013-0000-PROCESS-ABEND                 31552871
315529         END-EVALUATE.                                            31552971
315530                                                                  31553071
315531                                                                  31553171
315532                                                                  31553271
315533                                                                  31553371
315540*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*31554002
315600*   OPEN THE STORE CURSOR                                        *31560002
315700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*31570002
315800 4110-OPEN-CURSOR.                                                31580002
315900     EXEC SQL                                                     31590002
316000          OPEN PO-ALL-STR-CSR                                     31600002
316100     END-EXEC                                                     31610002
316200                                                                  31620002
316300     EVALUATE TRUE                                                31630002
316400         WHEN SQLCODE = ZERO                                      31640002
316500             CONTINUE                                             31650002
316600         WHEN SQLWARN0 NOT = SPACES                               31660002
316700         WHEN SQLCODE < ZERO                                      31670002
316800         WHEN SQLCODE > ZERO                                      31680002
316900             MOVE '4110-OPEN-CURSOR'                              31690002
317000                               TO DP013-PARAGRAPH                 31700002
317100             MOVE 'OPEN THE STORE CURSOR      - '                 31710002
317200                               TO DP013-MESSAGE-TEXT (1)          31720002
317300             MOVE SQLCA        TO DP013-SQLCA                     31730002
317400             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        31740002
317500             MOVE 'XLT00010'   TO DP013-DB2-TABLE-NAME (2)        31750064
317600             SET DP013-DB2-ABEND                                  31760002
317700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31770002
317800             PERFORM DP013-0000-PROCESS-ABEND                     31780002
317900     END-EVALUATE.                                                31790002
318000                                                                  31800002
318100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*31810002
318200*    FETCH CURSOR                                                *31820002
318300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*31830002
318400 4115-FETCH.                                                      31840002
318500                                                                  31850002
318600     EXEC SQL                                                     31860002
318700          FETCH PO-ALL-STR-CSR                                    31870002
318800           INTO  :DISTDT-STR-NBR                                  31880002
318900                ,:XLT00010-LOC-TYP-CDE                            31890064
319000                ,:RECDIS-EXPTED-ITM-QTY                           31900002
319100                ,:DISTDT-P2L-SPLT-UNT-QTY                         31910002
319200                ,:DISTDT-FCSE-SPLT-UNT-QTY                        31920002
319300                ,:DISTDT-INPK-SPLT-UNT-QTY                        31930002
319400                ,:DISTDT-ODD-CART-IND                             31940002
319500                                                                  31950002
319600     END-EXEC.                                                    31960002
319700                                                                  31970002
319800     EVALUATE TRUE                                                31980002
319900         WHEN SQLCODE = ZERO                                      31990002
320000              CONTINUE                                            32000002
320100         WHEN SQLCODE = +100                                      32010002
320200              SET ASC-NO-ITEMS-LEFT-ON-DB  TO TRUE                32020002
320300         WHEN SQLWARN0 NOT = SPACE                                32030002
320400         WHEN SQLCODE NOT = ZERO                                  32040002
320500              MOVE '4115-FETCH'                                   32050002
320600                               TO DP013-PARAGRAPH                 32060002
320700              MOVE 'FETCH RECDIS/STR000 CURSOR'                   32070002
320800                               TO DP013-MESSAGE-TEXT (1)          32080002
320900              MOVE SQLCA       TO DP013-SQLCA                     32090002
321000              SET DP013-DB2-ABEND                                 32100002
321100                               TO TRUE                            32110002
321200              PERFORM DP013-0000-PROCESS-ABEND                    32120002
321300     END-EVALUATE.                                                32130002
321400                                                                  32140002
321500                                                                  32150002
321600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*32160002
321700* CLOSE THE CURSOR.                                              *32170002
321800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*32180002
321900 4120-CLOSE-CURSOR.                                               32190002
322000     EXEC SQL                                                     32200002
322100          CLOSE PO-ALL-STR-CSR                                    32210002
322200     END-EXEC.                                                    32220002
322300                                                                  32230002
322400     EVALUATE TRUE                                                32240002
322500         WHEN SQLCODE = ZERO                                      32250002
322600             CONTINUE                                             32260002
322700         WHEN SQLWARN0 NOT = SPACES                               32270002
322800         WHEN SQLCODE < ZERO                                      32280002
322900         WHEN SQLCODE > ZERO                                      32290002
323000             MOVE '4120-CLOSE-CURSOR'                             32300002
323100                               TO DP013-PARAGRAPH                 32310002
323200             MOVE 'CLOSE CURSOR                '                  32320002
323300                               TO DP013-MESSAGE-TEXT (1)          32330002
323400             MOVE SQLCA        TO DP013-SQLCA                     32340002
323500             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        32350002
323600             MOVE 'XLT00010'   TO DP013-DB2-TABLE-NAME (2)        32360064
323700             SET DP013-DB2-ABEND                                  32370002
323800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32380002
323900             PERFORM DP013-0000-PROCESS-ABEND                     32390002
324000     END-EVALUATE.                                                32400002
324100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*32410002
324200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *32420002
324300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *32430002
324400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *32440002
324500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *32450002
324600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *32460002
324700*                                                                *32470002
324800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *32480002
324900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *32490002
325000*    UPON INITIALIZATION.                                        *32500002
325100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*32510002
325200 4300-READ-ITEMS-FROM-DB.                                         32520002
325300                                                                  32530002
325400     PERFORM                                                      32540002
325500         VARYING PV-READ-COUNT                                    32550002
325600         FROM 1 BY 1                                              32560002
325700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    32570002
325800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         32580002
325900                                                                  32590002
326000         PERFORM 4115-FETCH                                       32600002
326100                                                                  32610002
326200         IF  ASC-ITEMS-LEFT-ON-DB                                 32620002
326300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                32630002
326400                 ADD +1            TO ASC-ITEM-SUB                32640002
326500             ELSE                                                 32650002
326600                 ADD +1            TO ASC-BLK-SUB                 32660002
326700                 MOVE +1           TO ASC-ITEM-SUB                32670002
326800                                                                  32680002
326900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         32690002
327000                     MOVE +1       TO ASC-BLK-SUB                 32700002
327100                     SET ASC-BLOCK-MODIFIED (1)                   32710002
327200                                   TO TRUE                        32720002
327300                     PERFORM 5100-WRITE-TEMP-STORAGE              32730002
327400                     MOVE ASC-BLOCK-ENTRIES                       32740002
327500                               (PC-MAX-BLOCKS-IN-ARRAY)           32750002
327600                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 32760002
327700                     ADD +1        TO ASC-BLK-SUB                 32770002
327800                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   32780002
327900                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      32790002
328000                                   TO TRUE                        32800002
328100                 END-IF                                           32810002
328200             END-IF                                               32820002
328300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    32830002
328400             MOVE ASC-NUMBER-OF-ITEMS-READ                        32840002
328500                                   TO ASC-LIST-ITEM-NUMBER        32850002
328600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32860002
328700                                                                  32870002
328800             MOVE SPACES                 TO  ASC-ACTION           32880002
328900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32890002
329000                                                                  32900002
329100             MOVE DISTDT-STR-NBR        TO  ASC-STORE             32910002
329200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32920002
329300                                                                  32930002
329400             MOVE XLT00010-LOC-TYP-CDE   TO  ASC-STORE-TYPE       32940064
329500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32950002
329600                                                                  32960002
329700             IF  DISTDT-ODD-CART-IND  =  PC-N                     32970002
329800                 MOVE  SPACE             TO ASC-ODD-CART-SW       32980002
329900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32990002
330000             ELSE                                                 33000002
330100                 MOVE DISTDT-ODD-CART-IND TO ASC-ODD-CART-SW      33010002
330200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33020002
330300             END-IF                                               33030002
330400                                                                  33040002
330500             MOVE DISTDT-P2L-SPLT-UNT-QTY TO ASC-P2QTY            33050002
330600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33060002
330700                                                                  33070002
330800             MOVE RECDIS-EXPTED-ITM-QTY TO  ASC-PKSLQTY           33080002
330900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33090002
331000             ADD DISTDT-FCSE-SPLT-UNT-QTY,                        33100002
331100                 DISTDT-INPK-SPLT-UNT-QTY GIVING                  33110002
331200                 ASC-SHIPQTY  (ASC-BLK-SUB ASC-ITEM-SUB)          33120002
331300                                                                  33130002
331400             IF  ASC-PRE-PACK-ORDER                               33140017
331500                 DIVIDE  ASC-P2QTY   (ASC-BLK-SUB ASC-ITEM-SUB)   33150017
331600                     BY  ASC-PREPK-RATIO                          33160017
331700                 GIVING  ASC-P2PAK   (ASC-BLK-SUB ASC-ITEM-SUB)   33170017
331800                 DIVIDE  ASC-PKSLQTY (ASC-BLK-SUB ASC-ITEM-SUB)   33180017
331900                     BY  ASC-PREPK-RATIO                          33190017
332000                 GIVING  ASC-PKSLPAK (ASC-BLK-SUB ASC-ITEM-SUB)   33200017
332100                 DIVIDE  ASC-SHIPQTY (ASC-BLK-SUB ASC-ITEM-SUB)   33210017
332200                     BY  ASC-PREPK-RATIO                          33220017
332300                 GIVING  ASC-SHIPPAK (ASC-BLK-SUB ASC-ITEM-SUB)   33230017
332400             END-IF                                               33240017
332500                                                                  33250017
332600             MOVE 0 TO PV-FCSE-REM                                33260002
332700                       PV-INPK-REM                                33270002
332800                                                                  33280027
332900             IF  ASC-USE-UCC128-YES                               33290027
333000                 IF  ASC-PRE-PACK-ORDER                           33300048
333100                     PERFORM 4355-GET-FCSE-COUNT-PREPK            33310048
333200                 ELSE                                             33320048
333300                     PERFORM 4350-GET-FCSE-COUNT                  33330048
333400                 END-IF                                           33340048
333500                 MOVE PV-UCC128-FCSE-CNT                          33350048
333600                   TO ASC-FCSE-CART-QTY                           33360048
333700                      (ASC-BLK-SUB ASC-ITEM-SUB)                  33370048
333800             ELSE                                                 33380027
333900             IF DISTHD-OTPK-UNT-QTY > 0                           33390002
334000                                                                  33400002
334100                IF  DISTHD-ODD-CART-UNT-QTY  >  0  AND            33410002
334200                    DISTDT-ODD-CART-IND  =  PC-F                  33420002
334300                    SUBTRACT  DISTHD-ODD-CART-UNT-QTY             33430002
334400                        FROM  DISTDT-FCSE-SPLT-UNT-QTY            33440002
334500                      GIVING  PV-FCSE-SPLT-AFTER-ODD              33450002
334600                                                                  33460002
334700                      DIVIDE  PV-FCSE-SPLT-AFTER-ODD              33470002
334800                          BY  DISTHD-OTPK-UNT-QTY                 33480002
334900                      GIVING  ASC-FCSE-CART-QTY                   33490002
335000                              (ASC-BLK-SUB ASC-ITEM-SUB)          33500002
335100                      REMAINDER PV-FCSE-REM                       33510002
335200                      ADD  1  TO                                  33520002
335300                              ASC-FCSE-CART-QTY                   33530002
335400                              (ASC-BLK-SUB ASC-ITEM-SUB)          33540002
335500                ELSE                                              33550002
335600                    DIVIDE DISTDT-FCSE-SPLT-UNT-QTY               33560002
335700                        BY DISTHD-OTPK-UNT-QTY                    33570002
335800                    GIVING ASC-FCSE-CART-QTY                      33580002
335900                           (ASC-BLK-SUB ASC-ITEM-SUB)             33590002
336000                    REMAINDER PV-FCSE-REM                         33600002
336100                END-IF                                            33610002
336200             ELSE                                                 33620002
336300               MOVE 0                                             33630002
336400               TO     ASC-FCSE-CART-QTY (ASC-BLK-SUB ASC-ITEM-SUB)33640002
336500             END-IF                                               33650002
336600             END-IF                                               33660027
336700                                                                  33670027
336800             IF  ASC-USE-UCC128-YES                               33680027
336900                 IF  ASC-PRE-PACK-ORDER                           33690048
337000                     PERFORM 4365-GET-INPK-COUNT-PREPK            33700048
337100                 ELSE                                             33710048
337200                     PERFORM 4360-GET-INPK-COUNT                  33720048
337300                 END-IF                                           33730048
337400                 MOVE PV-UCC128-INPK-CNT                          33740027
337500                   TO ASC-INPK-CART-QTY                           33750027
337600                      (ASC-BLK-SUB ASC-ITEM-SUB)                  33760027
337700             ELSE                                                 33770027
337800             IF  DISTHD-INPK-UNT-QTY > 0                          33780027
337900                 DIVIDE DISTDT-INPK-SPLT-UNT-QTY                  33790027
338000                     BY DISTHD-INPK-UNT-QTY                       33800027
338100                 GIVING ASC-INPK-CART-QTY                         33810027
338200                        (ASC-BLK-SUB ASC-ITEM-SUB)                33820027
338300                 REMAINDER PV-INPK-REM                            33830027
338400             ELSE                                                 33840002
338500                 MOVE 0                                           33850027
338600                   TO ASC-INPK-CART-QTY                           33860027
338700                      (ASC-BLK-SUB ASC-ITEM-SUB)                  33870027
338800             END-IF                                               33880002
338900             END-IF                                               33890027
339000                                                                  33900027
339100             ADD                                                  33910002
339200               ASC-FCSE-CART-QTY (ASC-BLK-SUB ASC-ITEM-SUB),      33920002
339300               ASC-INPK-CART-QTY (ASC-BLK-SUB ASC-ITEM-SUB)       33930002
339400             GIVING                                               33940002
339500               ASC-CARTQTY (ASC-BLK-SUB ASC-ITEM-SUB)             33950002
339600             IF PV-FCSE-REM > 0                                   33960002
339700               ADD 1 TO ASC-CARTQTY (ASC-BLK-SUB ASC-ITEM-SUB)    33970002
339800             END-IF                                               33980002
339900             IF PV-INPK-REM > 0                                   33990002
340000               ADD 1 TO ASC-CARTQTY (ASC-BLK-SUB ASC-ITEM-SUB)    34000002
340100             END-IF                                               34010002
340200          END-IF                                                  34020002
340300     END-PERFORM.                                                 34030002
340400                                                                  34040002
340500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          34050002
340600         MOVE +1               TO ASC-BLK-SUB                     34060002
340700         PERFORM 5100-WRITE-TEMP-STORAGE                          34070002
340800         ADD +1                TO ASC-BLK-SUB                     34080002
340900         PERFORM 5100-WRITE-TEMP-STORAGE                          34090002
341000                                                                  34100002
341100         MOVE 1                TO ASC-BLK-SUB                     34110002
341200                                  PV-BLOCK-NUMBER                 34120002
341300         PERFORM 4410-READ-TEMP-STORAGE                           34130002
341400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             34140002
341500             MOVE 2            TO ASC-BLK-SUB                     34150002
341600                                  PV-BLOCK-NUMBER                 34160002
341700             PERFORM 4410-READ-TEMP-STORAGE                       34170002
341800         END-IF                                                   34180002
341900     END-IF.                                                      34190002
342000                                                                  34200002
342100                                                                  34210027
342200*----------------------------------------------------------------*34220027
342300* IF LINES WAS PROCESSED USING UCC128 DATA - GET THE FULLCASE    *34230027
342400* CARTON COUNT FROM THE VIRTUAL LABEL TABLE (TLBVRDA)            *34240027
342500*----------------------------------------------------------------*34250027
342600 4350-GET-FCSE-COUNT.                                             34260027
342610                                                                  34261061
342700     SET PS-END-FCSE-CTN-CSR-NO TO TRUE                           34270061
342800     MOVE ZEROES TO PV-UCC128-FCSE-CNT                            34280055
342900                    PV-FCSE-CNT.                                  34290055
343000     PERFORM 4352-OPEN-FCSE-CTN-CSR.                              34300055
343100     PERFORM 4353-FETCH-FCSE-CTN-CSR                              34310055
343200       UNTIL PS-END-FCSE-CTN-CSR-YES.                             34320054
343300     PERFORM 4354-CLOSE-FCSE-CTN-CSR.                             34330055
343400                                                                  34340027
343500*----------------------------------------------------------------*34350050
343600*   OPEN THE FULL CASE CARTON COUNT CURSOR                       *34360050
343700*----------------------------------------------------------------*34370050
343800 4352-OPEN-FCSE-CTN-CSR.                                          34380055
343900                                                                  34390050
344000     EXEC SQL                                                     34400050
344100          OPEN FCSE-CTN-CSR                                       34410050
344200     END-EXEC                                                     34420050
344300                                                                  34430050
344400     EVALUATE TRUE                                                34440050
344500         WHEN SQLCODE = ZERO                                      34450050
344600             CONTINUE                                             34460050
344700         WHEN SQLWARN0 NOT = SPACES                               34470050
344800         WHEN SQLCODE < ZERO                                      34480050
344900         WHEN SQLCODE > ZERO                                      34490050
345000             MOVE '4352-OPEN-FCSE-CTN-CSR    '                    34500055
345100                               TO DP013-PARAGRAPH                 34510050
345200             MOVE 'OPEN THE FCSE CTN CNT CSR  - '                 34520050
345300                               TO DP013-MESSAGE-TEXT (1)          34530050
345400             MOVE SQLCA        TO DP013-SQLCA                     34540050
345500             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        34550050
345600             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        34560050
345700             SET DP013-DB2-ABEND                                  34570050
345800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               34580050
345900             PERFORM DP013-0000-PROCESS-ABEND                     34590050
346000     END-EVALUATE.                                                34600050
346100                                                                  34610050
346200*----------------------------------------------------------------*34620050
346300*    FETCH FULL CASE CARTON COUNT CURSOR                         *34630050
346400*----------------------------------------------------------------*34640050
346500 4353-FETCH-FCSE-CTN-CSR.                                         34650055
346600                                                                  34660050
346700     EXEC SQL                                                     34670050
346800          FETCH  FCSE-CTN-CSR                                     34680050
346900           INTO :PV-PLACEHOLDER                                   34690050
347000               ,:PV-FCSE-CNT                                      34700050
347100     END-EXEC.                                                    34710050
347200                                                                  34720050
347300     EVALUATE TRUE                                                34730050
347400         WHEN SQLCODE = ZERO                                      34740050
347500              ADD PV-FCSE-CNT  TO PV-UCC128-FCSE-CNT              34750052
347600         WHEN SQLCODE = +100                                      34760050
347700              SET PS-END-FCSE-CTN-CSR-YES  TO TRUE                34770050
347800         WHEN SQLWARN0 NOT = SPACE                                34780050
347900         WHEN SQLCODE NOT = ZERO                                  34790050
348000              MOVE '4353-FETCH-FCSE-CTN-CSR    '                  34800055
348100                               TO DP013-PARAGRAPH                 34810050
348200              MOVE 'FETCH TLBVRDA/TSULBXF CURSOR'                 34820050
348300                               TO DP013-MESSAGE-TEXT (1)          34830050
348400              MOVE SQLCA       TO DP013-SQLCA                     34840050
348500              SET DP013-DB2-ABEND                                 34850050
348600                               TO TRUE                            34860050
348700              PERFORM DP013-0000-PROCESS-ABEND                    34870050
348800     END-EVALUATE.                                                34880050
348900                                                                  34890050
349000                                                                  34900050
349100*----------------------------------------------------------------*34910050
349200* CLOSE THE FULL CASE CARTON COUNT CURSOR                        *34920050
349300*----------------------------------------------------------------*34930050
349400 4354-CLOSE-FCSE-CTN-CSR.                                         34940055
349500                                                                  34950050
349600     EXEC SQL                                                     34960050
349700          CLOSE FCSE-CTN-CSR                                      34970050
349800     END-EXEC.                                                    34980050
349900                                                                  34990050
350000     EVALUATE TRUE                                                35000050
350100         WHEN SQLCODE = ZERO                                      35010050
350200             CONTINUE                                             35020050
350300         WHEN SQLWARN0 NOT = SPACES                               35030050
350400         WHEN SQLCODE < ZERO                                      35040050
350500         WHEN SQLCODE > ZERO                                      35050050
350600             MOVE '4354-CLOSE-FCSE-CTN-CSR'                       35060055
350700                               TO DP013-PARAGRAPH                 35070050
350800             MOVE 'CLOSE FCSE CARTON COUNT CSR'                   35080050
350900                               TO DP013-MESSAGE-TEXT (1)          35090050
351000             MOVE SQLCA        TO DP013-SQLCA                     35100050
351100             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        35110050
351200             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        35120050
351300             SET DP013-DB2-ABEND                                  35130050
351400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35140050
351500             PERFORM DP013-0000-PROCESS-ABEND                     35150050
351600     END-EVALUATE.                                                35160050
351700                                                                  35170055
351800*----------------------------------------------------------------*35180048
351900* IF LINES WAS PROCESSED USING UCC128 DATA - GET THE FULLCASE    *35190048
352000* CARTON COUNT FROM THE VIRTUAL LABEL TABLE (TLBVRDA) - PREPK    *35200048
352100*----------------------------------------------------------------*35210048
352200 4355-GET-FCSE-COUNT-PREPK.                                       35220048
352300     SET PS-END-FCSE-CTN-PRPK-CSR-NO TO TRUE.                     35230062
352400     MOVE ZEROES TO PV-UCC128-FCSE-CNT                            35240055
352500                    PV-FCSE-CNT.                                  35250055
352600     PERFORM 4357-OPEN-FCSE-CTN-PRPK-CSR.                         35260055
352700     PERFORM 4358-FETCH-FCSE-CTN-PRPK-CSR                         35270055
352800       UNTIL PS-END-FCSE-CTN-PRPK-CSR-YES.                        35280055
352900     PERFORM 4359-CLOSE-FCSE-CTN-PRPK-CSR.                        35290055
353000                                                                  35300055
353100                                                                  35310048
353200*----------------------------------------------------------------*35320055
353300*   OPEN THE FULL CASE CARTON COUNT CURSOR - PREPACK             *35330055
353400*----------------------------------------------------------------*35340055
353500 4357-OPEN-FCSE-CTN-PRPK-CSR.                                     35350055
353600                                                                  35360055
353700     EXEC SQL                                                     35370055
353800          OPEN FCSE-CTN-PRPK-CSR                                  35380055
353900     END-EXEC                                                     35390055
354000                                                                  35400055
354100     EVALUATE TRUE                                                35410055
354200         WHEN SQLCODE = ZERO                                      35420055
354300             CONTINUE                                             35430055
354400         WHEN SQLWARN0 NOT = SPACES                               35440055
354500         WHEN SQLCODE < ZERO                                      35450055
354600         WHEN SQLCODE > ZERO                                      35460055
354700             MOVE '4357-OPEN-FCSE-CTN-PRPK-CSR'                   35470055
354800                               TO DP013-PARAGRAPH                 35480055
354900             MOVE 'OPEN THE FCSE CTN PRPK CSR - '                 35490055
355000                               TO DP013-MESSAGE-TEXT (1)          35500055
355100             MOVE SQLCA        TO DP013-SQLCA                     35510055
355200             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        35520055
355300             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        35530055
355400             SET DP013-DB2-ABEND                                  35540055
355500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35550055
355600             PERFORM DP013-0000-PROCESS-ABEND                     35560055
355700     END-EVALUATE.                                                35570055
355800                                                                  35580055
355900*----------------------------------------------------------------*35590055
356000*    FETCH FULL CASE CARTON COUNT CURSOR - PREPACK               *35600055
356100*----------------------------------------------------------------*35610055
356200 4358-FETCH-FCSE-CTN-PRPK-CSR.                                    35620055
356300                                                                  35630055
356400     EXEC SQL                                                     35640055
356500          FETCH  FCSE-CTN-PRPK-CSR                                35650055
356600           INTO :PV-PLACEHOLDER                                   35660055
356700               ,:PV-FCSE-CNT                                      35670055
356800     END-EXEC.                                                    35680055
356900                                                                  35690055
357000     EVALUATE TRUE                                                35700055
357100         WHEN SQLCODE = ZERO                                      35710055
357200              ADD PV-FCSE-CNT  TO PV-UCC128-FCSE-CNT              35720055
357300         WHEN SQLCODE = +100                                      35730055
357400              SET PS-END-FCSE-CTN-PRPK-CSR-YES  TO TRUE           35740055
357500         WHEN SQLWARN0 NOT = SPACE                                35750055
357600         WHEN SQLCODE NOT = ZERO                                  35760055
357700              MOVE '4358-FETCH-FCSE-CTN-PRPK-CSR'                 35770055
357800                               TO DP013-PARAGRAPH                 35780055
357900              MOVE 'FETCH TLBVRDA/TSULBXF CURSOR'                 35790055
358000                               TO DP013-MESSAGE-TEXT (1)          35800055
358100              MOVE SQLCA       TO DP013-SQLCA                     35810055
358200              SET DP013-DB2-ABEND                                 35820055
358300                               TO TRUE                            35830055
358400              PERFORM DP013-0000-PROCESS-ABEND                    35840055
358500     END-EVALUATE.                                                35850055
358600                                                                  35860055
358700                                                                  35870055
358800*----------------------------------------------------------------*35880055
358900* CLOSE THE FULL CASE CARTON COUNT CURSOR - PREPACK              *35890055
359000*----------------------------------------------------------------*35900055
359100 4359-CLOSE-FCSE-CTN-PRPK-CSR.                                    35910055
359200                                                                  35920055
359300     EXEC SQL                                                     35930055
359400          CLOSE FCSE-CTN-PRPK-CSR                                 35940055
359500     END-EXEC.                                                    35950055
359600                                                                  35960055
359700     EVALUATE TRUE                                                35970055
359800         WHEN SQLCODE = ZERO                                      35980055
359900             CONTINUE                                             35990055
360000         WHEN SQLWARN0 NOT = SPACES                               36000055
360100         WHEN SQLCODE < ZERO                                      36010055
360200         WHEN SQLCODE > ZERO                                      36020055
360300             MOVE '4359-CLOSE-FCSE-CTN-PRPK-CSR'                  36030055
360400                               TO DP013-PARAGRAPH                 36040055
360500             MOVE 'CLOSE FCSE CARTON PRPK CSR'                    36050055
360600                               TO DP013-MESSAGE-TEXT (1)          36060055
360700             MOVE SQLCA        TO DP013-SQLCA                     36070055
360800             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        36080055
360900             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        36090055
361000             SET DP013-DB2-ABEND                                  36100055
361100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36110055
361200             PERFORM DP013-0000-PROCESS-ABEND                     36120055
361300     END-EVALUATE.                                                36130055
361400                                                                  36140055
361500*----------------------------------------------------------------*36150027
361600* IF LINES WAS PROCESSED USING UCC128 DATA - GET THE INNERPACK   *36160027
361700* CARTON COUNT FROM THE VIRTUAL LABEL TABLE (TLBVRDA)            *36170027
361800*----------------------------------------------------------------*36180027
361900 4360-GET-INPK-COUNT.                                             36190027
362000                                                                  36200027
362010     SET PS-END-INPK-CTN-CSR-NO TO TRUE.                          36201063
362100     MOVE ZEROES TO PV-UCC128-INPK-CNT                            36210057
362200                    PV-INPK-CNT.                                  36220057
362300     PERFORM 4362-OPEN-INPK-CTN-CSR.                              36230057
362400     PERFORM 4363-FETCH-INPK-CTN-CSR                              36240057
362500       UNTIL PS-END-INPK-CTN-CSR-YES.                             36250057
362600     PERFORM 4364-CLOSE-INPK-CTN-CSR.                             36260057
362700                                                                  36270027
362800*----------------------------------------------------------------*36280057
362900*   OPEN THE INNER PACK CARTON COUNT CURSOR                      *36290057
363000*----------------------------------------------------------------*36300057
363100 4362-OPEN-INPK-CTN-CSR.                                          36310057
363200                                                                  36320057
363300     EXEC SQL                                                     36330057
363400          OPEN INPK-CTN-CSR                                       36340057
363500     END-EXEC                                                     36350057
363600                                                                  36360057
363700     EVALUATE TRUE                                                36370057
363800         WHEN SQLCODE = ZERO                                      36380057
363900             CONTINUE                                             36390057
364000         WHEN SQLWARN0 NOT = SPACES                               36400057
364100         WHEN SQLCODE < ZERO                                      36410057
364200         WHEN SQLCODE > ZERO                                      36420057
364300             MOVE '4362-OPEN-INPK-CTN-CSR    '                    36430057
364400                               TO DP013-PARAGRAPH                 36440057
364500             MOVE 'OPEN THE INPK CTN CNT CSR  - '                 36450057
364600                               TO DP013-MESSAGE-TEXT (1)          36460057
364700             MOVE SQLCA        TO DP013-SQLCA                     36470057
364800             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        36480057
364900             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        36490057
365000             SET DP013-DB2-ABEND                                  36500057
365100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36510057
365200             PERFORM DP013-0000-PROCESS-ABEND                     36520057
365300     END-EVALUATE.                                                36530057
365400                                                                  36540057
365500*----------------------------------------------------------------*36550057
365600*    FETCH INNER PACK CARTON COUNT CURSOR                        *36560057
365700*----------------------------------------------------------------*36570057
365800 4363-FETCH-INPK-CTN-CSR.                                         36580057
365900                                                                  36590057
366000     EXEC SQL                                                     36600057
366100          FETCH  INPK-CTN-CSR                                     36610057
366200           INTO :PV-PLACEHOLDER                                   36620057
366300               ,:PV-INPK-CNT                                      36630057
366400     END-EXEC.                                                    36640057
366500                                                                  36650057
366600     EVALUATE TRUE                                                36660057
366700         WHEN SQLCODE = ZERO                                      36670057
366800              ADD PV-INPK-CNT  TO PV-UCC128-INPK-CNT              36680057
366900         WHEN SQLCODE = +100                                      36690057
367000              SET PS-END-INPK-CTN-CSR-YES  TO TRUE                36700057
367100         WHEN SQLWARN0 NOT = SPACE                                36710057
367200         WHEN SQLCODE NOT = ZERO                                  36720057
367300              MOVE '4363-FETCH-INPK-CTN-CSR    '                  36730057
367400                               TO DP013-PARAGRAPH                 36740057
367500              MOVE 'FETCH TLBVRDA/TSULBXF CURSOR'                 36750057
367600                               TO DP013-MESSAGE-TEXT (1)          36760057
367700              MOVE SQLCA       TO DP013-SQLCA                     36770057
367800              SET DP013-DB2-ABEND                                 36780057
367900                               TO TRUE                            36790057
368000              PERFORM DP013-0000-PROCESS-ABEND                    36800057
368100     END-EVALUATE.                                                36810057
368200                                                                  36820057
368300                                                                  36830057
368400*----------------------------------------------------------------*36840057
368500* CLOSE THE INNER PACK CARTON COUNT CURSOR                       *36850057
368600*----------------------------------------------------------------*36860057
368700 4364-CLOSE-INPK-CTN-CSR.                                         36870057
368800                                                                  36880057
368900     EXEC SQL                                                     36890057
369000          CLOSE INPK-CTN-CSR                                      36900057
369100     END-EXEC.                                                    36910057
369200                                                                  36920057
369300     EVALUATE TRUE                                                36930057
369400         WHEN SQLCODE = ZERO                                      36940057
369500             CONTINUE                                             36950057
369600         WHEN SQLWARN0 NOT = SPACES                               36960057
369700         WHEN SQLCODE < ZERO                                      36970057
369800         WHEN SQLCODE > ZERO                                      36980057
369900             MOVE '4364-CLOSE-INPK-CTN-CSR'                       36990057
370000                               TO DP013-PARAGRAPH                 37000057
370100             MOVE 'CLOSE INPK CARTON COUNT CSR'                   37010057
370200                               TO DP013-MESSAGE-TEXT (1)          37020057
370300             MOVE SQLCA        TO DP013-SQLCA                     37030057
370400             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        37040057
370500             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        37050057
370600             SET DP013-DB2-ABEND                                  37060057
370700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37070057
370800             PERFORM DP013-0000-PROCESS-ABEND                     37080057
370900     END-EVALUATE.                                                37090057
371000                                                                  37100057
371100*----------------------------------------------------------------*37110048
371200* IF LINES WAS PROCESSED USING UCC128 DATA - GET THE INNERPACK   *37120048
371300* CARTON COUNT FROM THE VIRTUAL LABEL TABLE (TLBVRDA) - PREPK    *37130048
371400*----------------------------------------------------------------*37140048
371500 4365-GET-INPK-COUNT-PREPK.                                       37150048
371600     SET PS-END-INPK-CTN-PRPK-CSR-NO TO TRUE.                     37160063
371700     MOVE ZEROES TO PV-UCC128-INPK-CNT                            37170057
371800                    PV-INPK-CNT.                                  37180057
371900     PERFORM 4367-OPEN-INPK-CTN-PRPK-CSR.                         37190057
372000     PERFORM 4368-FETCH-INPK-CTN-PRPK-CSR                         37200057
372100       UNTIL PS-END-INPK-CTN-PRPK-CSR-YES.                        37210057
372200     PERFORM 4369-CLOSE-INPK-CTN-PRPK-CSR.                        37220057
372300                                                                  37230057
372400                                                                  37240027
372500*----------------------------------------------------------------*37250057
372600*   OPEN THE INNER PACK CARTON COUNT CURSOR - PREPACK            *37260057
372700*----------------------------------------------------------------*37270057
372800 4367-OPEN-INPK-CTN-PRPK-CSR.                                     37280057
372900                                                                  37290057
373000     EXEC SQL                                                     37300057
373100          OPEN INPK-CTN-PRPK-CSR                                  37310057
373200     END-EXEC                                                     37320057
373300                                                                  37330057
373400     EVALUATE TRUE                                                37340057
373500         WHEN SQLCODE = ZERO                                      37350057
373600             CONTINUE                                             37360057
373700         WHEN SQLWARN0 NOT = SPACES                               37370057
373800         WHEN SQLCODE < ZERO                                      37380057
373900         WHEN SQLCODE > ZERO                                      37390057
374000             MOVE '4367-OPEN-INPK-CTN-PRPK-CSR'                   37400057
374100                               TO DP013-PARAGRAPH                 37410057
374200             MOVE 'OPEN THE INPK CTN PRPK CSR - '                 37420057
374300                               TO DP013-MESSAGE-TEXT (1)          37430057
374400             MOVE SQLCA        TO DP013-SQLCA                     37440057
374500             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        37450057
374600             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        37460057
374700             SET DP013-DB2-ABEND                                  37470057
374800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37480057
374900             PERFORM DP013-0000-PROCESS-ABEND                     37490057
375000     END-EVALUATE.                                                37500057
375100                                                                  37510057
375200*----------------------------------------------------------------*37520057
375300*    FETCH INNER PACK CARTON COUNT CURSOR - PREPACK              *37530057
375400*----------------------------------------------------------------*37540057
375500 4368-FETCH-INPK-CTN-PRPK-CSR.                                    37550057
375600                                                                  37560057
375700     EXEC SQL                                                     37570057
375800          FETCH  INPK-CTN-PRPK-CSR                                37580057
375900           INTO :PV-PLACEHOLDER                                   37590057
376000               ,:PV-INPK-CNT                                      37600057
376100     END-EXEC.                                                    37610057
376200                                                                  37620057
376300     EVALUATE TRUE                                                37630057
376400         WHEN SQLCODE = ZERO                                      37640057
376500              ADD PV-INPK-CNT  TO PV-UCC128-INPK-CNT              37650057
376600         WHEN SQLCODE = +100                                      37660057
376700              SET PS-END-INPK-CTN-PRPK-CSR-YES  TO TRUE           37670057
376800         WHEN SQLWARN0 NOT = SPACE                                37680057
376900         WHEN SQLCODE NOT = ZERO                                  37690057
377000              MOVE '4368-FETCH-INPK-CTN-PRPK-CSR'                 37700057
377100                               TO DP013-PARAGRAPH                 37710057
377200              MOVE 'FETCH TLBVRDA/TSULBXF CURSOR'                 37720057
377300                               TO DP013-MESSAGE-TEXT (1)          37730057
377400              MOVE SQLCA       TO DP013-SQLCA                     37740057
377500              SET DP013-DB2-ABEND                                 37750057
377600                               TO TRUE                            37760057
377700              PERFORM DP013-0000-PROCESS-ABEND                    37770057
377800     END-EVALUATE.                                                37780057
378000                                                                  37800057
378100*----------------------------------------------------------------*37810057
378200* CLOSE THE INNER PACK CARTON COUNT CURSOR - PREPACK             *37820057
378300*----------------------------------------------------------------*37830057
378400 4369-CLOSE-INPK-CTN-PRPK-CSR.                                    37840057
378500                                                                  37850057
378600     EXEC SQL                                                     37860057
378700          CLOSE INPK-CTN-PRPK-CSR                                 37870057
378800     END-EXEC.                                                    37880057
378900                                                                  37890057
379000     EVALUATE TRUE                                                37900057
379100         WHEN SQLCODE = ZERO                                      37910057
379200             CONTINUE                                             37920057
379300         WHEN SQLWARN0 NOT = SPACES                               37930057
379400         WHEN SQLCODE < ZERO                                      37940057
379500         WHEN SQLCODE > ZERO                                      37950057
379600             MOVE '4369-CLOSE-INPK-CTN-PRPK-CSR'                  37960057
379700                               TO DP013-PARAGRAPH                 37970057
379800             MOVE 'CLOSE INPK CARTON PRPK CSR'                    37980057
379900                               TO DP013-MESSAGE-TEXT (1)          37990057
380000             MOVE SQLCA        TO DP013-SQLCA                     38000057
380100             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        38010057
380200             MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (2)        38020057
380300             SET DP013-DB2-ABEND                                  38030057
380400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38040057
380500             PERFORM DP013-0000-PROCESS-ABEND                     38050057
380600     END-EVALUATE.                                                38060057
380700                                                                  38070057
380800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*38080002
380900* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *38090002
381000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*38100002
381100 4400-MOVE-COMMAREA-TO-SCREEN.                                    38110002
381200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             38120002
381300         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          38130002
381400         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          38140002
381500             MOVE +1    TO ASC-BLK-SUB                            38150002
381600             PERFORM 5100-WRITE-TEMP-STORAGE                      38160002
381700             ADD +1     TO ASC-BLK-SUB                            38170002
381800             PERFORM 5100-WRITE-TEMP-STORAGE                      38180002
381900             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             38190002
382000                 GIVING PV-BLOCK-NUMBER                           38200002
382100                 REMAINDER PV-REMAINDER                           38210002
382200             IF  PV-REMAINDER > ZERO                              38220002
382300                 ADD +1 TO PV-BLOCK-NUMBER                        38230002
382400             END-IF                                               38240002
382500             MOVE +1    TO ASC-BLK-SUB                            38250002
382600             PERFORM 4410-READ-TEMP-STORAGE                       38260002
382700             ADD +1     TO ASC-BLK-SUB                            38270002
382800                           PV-BLOCK-NUMBER                        38280002
382900             PERFORM 4410-READ-TEMP-STORAGE                       38290002
383000     END-IF.                                                      38300002
383100     MOVE +1            TO ASC-BLK-SUB.                           38310002
383200     COMPUTE ASC-ITEM-SUB =                                       38320002
383300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              38330002
383400         + PC-ITEMS-PER-PANEL).                                   38340002
383500                                                                  38350002
383600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38360002
383700         ADD +1         TO ASC-BLK-SUB                            38370002
383800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            38380002
383900     END-IF.                                                      38390002
384000                                                                  38400002
384100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           38410002
384200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                38420002
384300     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        38430002
384400     PERFORM 4420-FORMAT-LIST-LINES                               38440002
384500         VARYING PV-SUB                                           38450002
384600         FROM PC-ITEMS-PER-PANEL BY -1                            38460002
384700         UNTIL PV-SUB < +1.                                       38470002
384800                                                                  38480002
384900     COMPUTE ASC-ITEMS-DISPLAYED =                                38490002
385000         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          38500002
385100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    38510002
385200                                      ASTRTITO.                   38520002
385300     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    38530002
385400     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    38540002
385500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38550002
385600                                   TO ASELITO.                    38560002
385700                                                                  38570002
385800     MOVE ASC-OPER-UNT-ID          TO AOPUNTO.                    38580002
385900     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    38590002
386000                                                                  38600002
386100     IF ASC-LBL-PRT-ORDER = PC-S                                  38610002
386200         MOVE ASC-SML-P2L-PRTR-ID  TO ALBPRTO                     38620002
386300     ELSE                                                         38630002
386400     IF ASC-LBL-PRT-ORDER = PC-P                                  38640002
386500         MOVE ASC-PGYBCK-PRTR-ID   TO ALBPRTO                     38650002
386600     ELSE                                                         38660002
386700     IF ASC-LBL-PRT-ORDER = PC-X                                  38670002
386800         IF  ASC-SML-P2L-PRTR-ID =  PC-NO-LABEL  AND              38680002
386900             ASC-PGYBCK-PRTR-ID  =  PC-NO-LABEL                   38690002
387000             MOVE PC-NO-LABEL      TO ALBPRTO                     38700002
387100         ELSE                                                     38710002
387200         IF  ASC-SML-P2L-PRTR-ID =  PC-NO-LABEL                   38720002
387300             MOVE ASC-PGYBCK-PRTR-ID   TO ALBPRTO                 38730002
387400         ELSE                                                     38740002
387500         IF  ASC-PGYBCK-PRTR-ID  =  PC-NO-LABEL                   38750002
387600             MOVE ASC-SML-P2L-PRTR-ID  TO ALBPRTO                 38760002
387700         END-IF                                                   38770002
387800         END-IF                                                   38780002
387900         END-IF                                                   38790002
388000     END-IF                                                       38800002
388100     END-IF                                                       38810002
388200     END-IF.                                                      38820002
388300                                                                  38830002
388400     MOVE ASC-PO-NBR               TO APONBRO.                    38840002
388500     MOVE ASC-REC-SEQ-NBR          TO ARECVRO.                    38850002
388600     MOVE ASC-PO-LNE-NBR           TO ALINEO.                     38860002
388700     IF  ASC-PRE-PACK-ORDER                                       38870017
388800         MOVE ASC-PREPK-RATIO      TO MINPAKO                     38880017
388900         MOVE ASC-PREPK-ID         TO PV-PACKID                   38890017
389000         MOVE PV-DISPLAY-PACKID    TO ASKUO                       38900017
389100         MOVE ASC-PKSL-PAK         TO MTOTPSO                     38910017
389200         MOVE ASC-PROC-PAK         TO MTOTPRO                     38920017
389300         MOVE ASC-P2L-PAK          TO MTOTP2O                     38930017
389400         MOVE ASC-SHIP-PAK         TO MTOTSHO                     38940017
389500     ELSE                                                         38950017
389600         MOVE ASC-INPK-UNT-QTY     TO MINPAKO                     38960017
389700         MOVE ASC-SKU              TO ASKUO                       38970017
389800         MOVE ASC-PKSL-QTY         TO MTOTPSO                     38980017
389900         MOVE ASC-PROC-QTY         TO MTOTPRO                     38990017
390000         MOVE ASC-P2L-QTY          TO MTOTP2O                     39000017
390100         MOVE ASC-SHIP-QTY         TO MTOTSHO                     39010017
390200     END-IF.                                                      39020017
390300     MOVE ASC-OTPK-UNT-QTY         TO MOTPAKO.                    39030002
390400     MOVE ASC-STATUS               TO ASTATO.                     39040002
390500     MOVE ASC-INPK-CNVYB-IND       TO MIPCNVO.                    39050002
390600     MOVE ASC-LBL-PRT-ORDER        TO ALBTYPO.                    39060002
390700     MOVE ASC-P2L-CART-CNT         TO MP2CRTO.                    39070002
390800     MOVE ASC-PROC-CART-CNT        TO MPRCRTO.                    39080002
390900     MOVE ASC-SHIP-CART-CNT        TO MSHCRTO.                    39090002
391000                                                                  39100002
391100     MOVE ASC-ODD-CARTON           TO AODUNTO.                    39110002
391200     IF  ASC-ODD-CRTN-FCSE                                        39120002
391300         MOVE  PC-ODD-CRTN-FCSE    TO AODUSEO                     39130002
391400     ELSE                                                         39140002
391500     IF  ASC-ODD-CRTN-INPK                                        39150002
391600         MOVE  PC-ODD-CRTN-INPK    TO AODUSEO                     39160002
391700     ELSE                                                         39170002
391800     IF  ASC-ODD-CRTN-P2L                                         39180002
391900         MOVE  PC-ODD-CRTN-P2L     TO AODUSEO                     39190002
392000     ELSE                                                         39200002
392100         MOVE  SPACES              TO AODUSEO                     39210002
392200     END-IF                                                       39220002
392300     END-IF                                                       39230002
392400     END-IF.                                                      39240002
392500                                                                  39250009
392600     IF  ASC-DSP-INNER-PREPK                                      39260020
392700         MOVE  PC-INNER-PREPACK    TO APKGCDO                     39270009
392800     ELSE                                                         39280009
392900     IF  ASC-DSP-MULTI-SKU-PREPK                                  39290020
393000         MOVE  PC-MULTI-SKU        TO APKGCDO                     39300009
393100     ELSE                                                         39310009
393200     IF  ASC-DSP-SINGLE-SKU-PREPK                                 39320020
393300         MOVE  PC-SINGLE-SKU       TO APKGCDO                     39330009
393400     ELSE                                                         39340009
393500     IF  ASC-DSP-CASEPACK                                         39350020
393600         MOVE  PC-CASEPACK         TO APKGCDO                     39360009
393700     ELSE                                                         39370009
393800     IF  ASC-DSP-BULK-PACK                                        39380020
393900         MOVE  PC-BULK             TO APKGCDO                     39390009
394000     END-IF                                                       39400009
394100     END-IF                                                       39410009
394200     END-IF                                                       39420009
394300     END-IF                                                       39430009
394400     END-IF.                                                      39440009
394500                                                                  39450020
394600     IF  ASC-DSP-PRE-PACK-ORDER                                   39460021
394700         MOVE DP015-YELLOW         TO APKGCDC                     39470009
394800     END-IF.                                                      39480020
394900                                                                  39490020
395000     IF  ASC-PRE-PACK-ORDER                                       39500020
395100         MOVE DP015-YELLOW         TO MINPAKC                     39510020
395200                                      ASKUC                       39520017
395300                                      MTOTPSC                     39530016
395400                                      MTOTPRC                     39540016
395500                                      MTOTP2C                     39550016
395600                                      MTOTSHC                     39560016
395700         MOVE PC-PAK               TO MTHPKSO                     39570015
395800                                      MTHPRCO                     39580015
395900                                      MTHP2LO                     39590015
396000                                      MTHSHPO                     39600015
396100                                      MLHPKSO                     39610015
396200                                      MLHP2LO                     39620015
396300                                      MLHSHPO                     39630015
396400         MOVE PC-RATIO             TO MHINRTO                     39640015
396500         MOVE PC-PACKID            TO MHSKPKO                     39650015
396600     ELSE                                                         39660015
396700         MOVE PC-QTY               TO MTHPKSO                     39670015
396800                                      MTHPRCO                     39680015
396900                                      MTHP2LO                     39690015
397000                                      MTHSHPO                     39700015
397100                                      MLHPKSO                     39710015
397200                                      MLHP2LO                     39720015
397300                                      MLHSHPO                     39730015
397400         MOVE PC-INPK              TO MHINRTO                     39740015
397500         MOVE PC-SKU               TO MHSKPKO                     39750015
397600     END-IF.                                                      39760015
397700                                                                  39770015
397800     IF  ASC-USE-UCC128-YES                                       39780025
397900         MOVE  PC-USE-UCC128       TO AUSE128O                    39790025
398000         MOVE  DP015-YELLOW        TO AUSE128C                    39800025
398100     ELSE                                                         39810025
398200     IF  ASC-USE-UCC128-IGNORE                                    39820025
398300         MOVE  PC-IGNORE-UCC128    TO AUSE128O                    39830025
398400         MOVE  DP015-YELLOW        TO AUSE128C                    39840025
398500     ELSE                                                         39850025
398600         MOVE  PC-NO-UCC128-AVAIL  TO AUSE128O                    39860025
398700         MOVE  DP015-BLUE          TO AUSE128C                    39870025
398800     END-IF.                                                      39880025
398900                                                                  39890025
399000                                                                  39900015
399100     IF  DP020-MSG-NUMBER-X = SPACE                               39910015
399200     AND DP020-MSG-TEXT = SPACES                                  39920015
399300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  39930015
399400*            --- MORE ITEMS TO DISPLAY ----                       39940015
399500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            39950015
399600             SET DP020-MSG-INFORMATIONAL TO TRUE                  39960015
399700         END-IF                                                   39970015
399800     END-IF.                                                      39980015
399900                                                                  39990015
400000                                                                  40000002
400100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*40010002
400200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *40020002
400300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*40030002
400400 4410-READ-TEMP-STORAGE.                                          40040002
400500                                                                  40050002
400600     EXEC CICS                                                    40060002
400700         READQ TS                                                 40070002
400800             QUEUE (ASC-LIST-QUEUE-NAME)                          40080002
400900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               40090002
401000             ITEM  (PV-BLOCK-NUMBER)                              40100002
401100             RESP  (PV-CICS-RESP)                                 40110002
401200     END-EXEC.                                                    40120002
401300                                                                  40130002
401400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       40140002
401500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     40150002
401600         CONTINUE                                                 40160002
401700     ELSE                                                         40170002
401800         SET DP013-CICS-ABEND     TO TRUE                         40180002
401900         SET DP013-NO-ROLLBACK    TO TRUE                         40190002
402000         MOVE '4410-READ-TEMP-STORAGE'                            40200002
402100                                  TO DP013-PARAGRAPH              40210002
402200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      40220002
402300                                  TO DP013-MESSAGE-TEXT(1)        40230002
402400         PERFORM DP013-0000-PROCESS-ABEND                         40240002
402500     END-IF.                                                      40250002
402600                                                                  40260002
402700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             40270002
402800                                                                  40280002
402900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         40290002
403000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               40300002
403100     END-IF.                                                      40310002
403200                                                                  40320002
403300                                                                  40330002
403400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*40340002
403500*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *40350002
403600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*40360002
403700 4420-FORMAT-LIST-LINES.                                          40370002
403800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      40380002
403900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                40390002
404000         MOVE DP015-ASK-NOR-OFF  TO MR-SELECTA (PV-SUB)           40400002
404100                                    MR-STOREA (PV-SUB)            40410002
404200                                    MR-PKSLQTYA (PV-SUB)          40420002
404300                                    MR-P2QTYA (PV-SUB)            40430002
404400                                    MR-SHIPQTYA (PV-SUB)          40440002
404500                                    MR-CARTQTYA (PV-SUB)          40450002
404600                                    MR-INPK-CARTQTYA (PV-SUB)     40460002
404700                                    MR-FCSE-CARTQTYA (PV-SUB)     40470002
404800                                    MR-ODD-CART-SWA (PV-SUB)      40480002
404900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           40490002
405000                                    MR-STOREH (PV-SUB)            40500002
405100                                    MR-PKSLQTYH (PV-SUB)          40510002
405200                                    MR-P2QTYH (PV-SUB)            40520002
405300                                    MR-SHIPQTYH (PV-SUB)          40530002
405400                                    MR-CARTQTYH (PV-SUB)          40540002
405500                                    MR-INPK-CARTQTYH (PV-SUB)     40550002
405600                                    MR-FCSE-CARTQTYH (PV-SUB)     40560002
405700                                    MR-ODD-CART-SWH (PV-SUB)      40570002
405800         MOVE SPACE              TO MR-SELECT  (PV-SUB)           40580002
405900                                    MR-ACTION  (PV-SUB)           40590002
406000         MOVE SPACES             TO MR-PKSLQTY-X (PV-SUB)         40600002
406100         MOVE SPACES             TO MR-ODD-CART-SW (PV-SUB)       40610002
406200         MOVE ZEROES             TO MR-P2QTY  (PV-SUB)            40620002
406300                                    MR-SHIPQTY  (PV-SUB)          40630002
406400                                    MR-CARTQTY  (PV-SUB)          40640002
406500                                    MR-INPK-CARTQTY  (PV-SUB)     40650002
406600                                    MR-FCSE-CARTQTY  (PV-SUB)     40660002
406700                                    MR-STORE  (PV-SUB)            40670002
406800     ELSE                                                         40680002
406900         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      40690002
407000                                                   > SPACE        40700002
407100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 40710002
407200                                 TO MR-SELECT  (PV-SUB)           40720002
407300         ELSE                                                     40730002
407400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      40740002
407500                                 TO MR-SELECT  (PV-SUB)           40750002
407600         END-IF                                                   40760002
407700                                                                  40770002
407800         IF  DP030-SET-CURSOR-TRAILER                             40780002
407900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)40790002
408000                 > SPACE)                                         40800002
408100               OR (PV-SUB = 1))                                   40810002
408200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               40820002
408300                MOVE -1          TO MR-SELECTL (PV-SUB)           40830002
408400             END-IF                                               40840002
408500         END-IF                                                   40850002
408600                                                                  40860002
408700         MOVE ASC-ACTION        (ASC-BLK-SUB ASC-ITEM-SUB)        40870002
408800                                 TO MR-ACTION (PV-SUB)            40880002
408900         MOVE ASC-STORE         (ASC-BLK-SUB ASC-ITEM-SUB)        40890002
409000                                 TO MR-STORE   (PV-SUB)           40900002
409100         IF  ASC-PRE-PACK-ORDER                                   40910017
409200             MOVE ASC-PKSLPAK   (ASC-BLK-SUB ASC-ITEM-SUB)        40920017
409300                                 TO MR-PKSLQTY (PV-SUB)           40930002
409400             MOVE ASC-P2PAK     (ASC-BLK-SUB ASC-ITEM-SUB)        40940017
409500                                 TO MR-P2QTY (PV-SUB)             40950002
409600             MOVE ASC-SHIPPAK   (ASC-BLK-SUB ASC-ITEM-SUB)        40960017
409700                                 TO MR-SHIPQTY (PV-SUB)           40970002
409800         ELSE                                                     40980017
409900             MOVE ASC-PKSLQTY   (ASC-BLK-SUB ASC-ITEM-SUB)        40990017
410000                                 TO MR-PKSLQTY (PV-SUB)           41000017
410100             MOVE ASC-P2QTY     (ASC-BLK-SUB ASC-ITEM-SUB)        41010017
410200                                 TO MR-P2QTY (PV-SUB)             41020017
410300             MOVE ASC-SHIPQTY   (ASC-BLK-SUB ASC-ITEM-SUB)        41030017
410400                                 TO MR-SHIPQTY (PV-SUB)           41040017
410500         END-IF                                                   41050017
410600         MOVE ASC-CARTQTY       (ASC-BLK-SUB ASC-ITEM-SUB)        41060002
410700                                 TO MR-CARTQTY (PV-SUB)           41070002
410800         MOVE ASC-FCSE-CART-QTY (ASC-BLK-SUB ASC-ITEM-SUB)        41080002
410900                                 TO MR-FCSE-CARTQTY (PV-SUB)      41090002
411000         MOVE ASC-INPK-CART-QTY (ASC-BLK-SUB ASC-ITEM-SUB)        41100002
411100                                 TO MR-INPK-CARTQTY (PV-SUB)      41110002
411200         MOVE ASC-ODD-CART-SW   (ASC-BLK-SUB ASC-ITEM-SUB)        41120002
411300                                 TO MR-ODD-CART-SW (PV-SUB)       41130002
411400     END-IF.                                                      41140002
411500                                                                  41150002
411600     IF  ASC-PRE-PACK-ORDER                                       41160016
411700         MOVE DP015-YELLOW         TO MR-PKSLQTYC (PV-SUB)        41170016
411800                                      MR-P2QTYC (PV-SUB)          41180016
411900                                      MR-SHIPQTYC (PV-SUB)        41190016
412000     END-IF.                                                      41200016
412100                                                                  41210002
412200     SUBTRACT +1 FROM ASC-ITEM-SUB                                41220002
412300     IF  ASC-ITEM-SUB < + 1                                       41230002
412400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  41240002
412500         MOVE +1                 TO ASC-BLK-SUB                   41250002
412600     END-IF.                                                      41260002
412700                                                                  41270002
412800                                                                  41280002
412900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*41290002
413000*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *41300002
413100*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *41310002
413200*  ISSUE A WARNING.                                              *41320002
413300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*41330002
413400 4430-CHECK-FOR-BEGIN-AND-END.                                    41340002
413500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       41350002
413600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     41360002
413700*            -- NO END-OF-RANGE SPECFIED ---                      41370002
413800             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            41380002
413900             SET DP020-MSG-WARNING TO TRUE                        41390002
414000             PERFORM 4431-POSITION-AT-WARNING                     41400002
414100         END-IF                                                   41410002
414200     ELSE                                                         41420002
414300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     41430002
414400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                41440002
414500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            41450002
414600             SET DP020-MSG-WARNING TO TRUE                        41460002
414700             PERFORM 4431-POSITION-AT-WARNING                     41470002
414800         END-IF                                                   41480002
414900     END-IF.                                                      41490002
415000                                                                  41500002
415100                                                                  41510002
415200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*41520002
415300*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *41530002
415400*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *41540002
415500*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *41550002
415600*  POSITION THE CURSOR THERE.                                    *41560002
415700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*41570002
415800 4431-POSITION-AT-WARNING.                                        41580002
415900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 41590002
416000                    - PV-TOP-ITEM + 1.                            41600002
416100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41610002
416200         CONTINUE                                                 41620002
416300     ELSE                                                         41630002
416400         SET DP030-SET-CURSOR-APPL-1                              41640002
416500                                   TO TRUE                        41650002
416600         MOVE -1                   TO MR-SELECTL (PV-SUB)         41660002
416700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41670002
416800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41680002
416900     END-IF.                                                      41690002
417000                                                                  41700002
417100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   41710002
417200                    - PV-TOP-ITEM + 1.                            41720002
417300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41730002
417400         CONTINUE                                                 41740002
417500     ELSE                                                         41750002
417600         SET DP030-SET-CURSOR-APPL-1                              41760002
417700                                   TO TRUE                        41770002
417800         MOVE -1                   TO MR-SELECTL (PV-SUB)         41780002
417900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41790002
418000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41800002
418100     END-IF.                                                      41810002
418200                                                                  41820002
418300                                                                  41830002
418400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*41840002
418500 5000-PREPARE-SEL-QUEUE.                                          41850002
418600                                                                  41860002
418700                                                                  41870002
418800     MOVE +1                   TO  ASC-BLK-SUB.                   41880002
418900     PERFORM 5100-WRITE-TEMP-STORAGE.                             41890002
419000     ADD +1                    TO  ASC-BLK-SUB.                   41900002
419100     PERFORM 5100-WRITE-TEMP-STORAGE.                             41910002
419200                                                                  41920002
419300     INITIALIZE PV-NBR-OF-STORES-SELECTED                         41930002
419400                PV-TOT-SEL-FCSE-CART-QTY                          41940002
419500                PV-TOT-SEL-INPK-CART-QTY                          41950002
419600                PV-TOT-CS-LABELS.                                 41960002
419700                                                                  41970002
419800     PERFORM 5400-BUILD-SEL-STRS-TS-QUEUE                         41980002
419900             VARYING PV-ITEM                                      41990002
420000             FROM 1 BY 1                                          42000002
420100             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     42010002
420200                                                                  42020002
420300     MOVE ASC-PO-NBR             TO  PC126-PO-NBR.                42030002
420400     MOVE ASC-REC-SEQ-NBR        TO  PC126-RCVR-SEQ-NBR.          42040002
420500     MOVE ASC-PO-LNE-NBR         TO  PC126-PO-LNE-NBR.            42050002
420600     MOVE ASC-OPER-UNT-ID        TO  PC126-OPER-UNT-ID.           42060002
420700     MOVE ASC-LBL-PRT-ORDER      TO  PC126-SHIP-LABEL-TYPE.       42070002
420800     MOVE ASC-ODD-CARTON         TO  PC126-ODD-CRTN-UNT-QTY.      42080002
420900     MOVE ASC-ODD-CARTON-USE-SW  TO  PC126-ODD-CRTN-USE.          42090002
421000     MOVE ASC-DC-PRTD-AT         TO  PC126-DC-PRTD-AT.            42100002
421100     MOVE ASC-DPT-NBR            TO  PC126-DEPT-NBR.              42110043
421200     MOVE ASC-CL-NBR             TO  PC126-CL-NBR.                42120046
421300                                                                  42130002
421400     IF  ASC-DISTHD-ORIG-LBL-TYP  =  PC-X                         42140002
421500         SET  PC126-INITIAL-PRINT  TO  TRUE                       42150002
421600     ELSE                                                         42160002
421700         SET  PC126-REPRINT        TO  TRUE                       42170002
421800     END-IF.                                                      42180002
421900                                                                  42190002
422000     SET  PC126-PRT-STR-SEQ      TO  TRUE.                        42200002
422100                                                                  42210002
422200     IF  ASC-SPEC-INST-DESC  >  SPACES                            42220002
422300         MOVE ASC-SPEC-INST-DESC TO  PC126-STR-ZNE                42230002
422400     ELSE                                                         42240002
422500         MOVE ASC-DFLT-STR-ZN-ID     TO  PC126-STR-ZNE            42250002
422600     END-IF.                                                      42260002
422700                                                                  42270002
422800     MOVE ASC-SKU                TO  PC126-SKU.                   42280038
422900     MOVE ASC-ITEM-NBR           TO  PC126-ITEM-NBR.              42290044
422910     MOVE ASC-TRIP-ARRIVE-DATE   TO  PC126-TRIP-ARRIVE-DATE.      42291073
423000                                                                  42300002
423100     MOVE PV-TOT-SEL-FCSE-CART-QTY                                42310002
423200                                 TO PC126-FCSE-LBL-CNT.           42320002
423300     MOVE PV-TOT-SEL-INPK-CART-QTY                                42330002
423400                                 TO PC126-INPK-LBL-CNT.           42340002
423500     MOVE PV-TOT-CS-LABELS                                        42350002
423600                                 TO PC126-CS-BOUND-CTNS.          42360002
423700     SET  PC126-SHP-RPRT-ALL     TO TRUE.                         42370002
423800     SET  PC126-P2L-RPRT-ALL     TO TRUE.                         42380002
423900     MOVE ASC-OTPK-UNT-QTY       TO  PC126-OTPK-UNT-QTY.          42390002
424000     MOVE ASC-INPK-UNT-QTY       TO  PC126-INPK-UNT-QTY.          42400002
424100     MOVE ASC-MODU-NBR           TO  PC126-MOD-NBR.               42410002
424200     MOVE ASC-SML-P2L-PRTR-ID    TO  PC126-SHP-PRTR-ID.           42420002
424300     MOVE ASC-PGYBCK-PRTR-ID     TO  PC126-PGYBK-PRTR-ID.         42430002
424400     MOVE ASC-PRT-QUEUE-NAME     TO  PC126-PRT-QUEUE-NAME.        42440002
424500     MOVE PC-CURRENT-PROGRAM-NAME                                 42450002
424600                                 TO  PC126-CALLING-PGM-NME.       42460002
424700     PERFORM 4075-GET-VENDOR-STYLE.                               42470002
424800     PERFORM 4076-GET-TCOCNTL-INFO.                               42480007
424900     MOVE  COCNTL-SSCC-18-IND    TO PC126-SSCC-18-IND.            42490007
425000     MOVE  ASC-SKU               TO PC126-SKU.                    42500038
425100     MOVE 0                      TO  PC126-DC-BOUND-UNTS          42510002
425200                                     PC126-RTV-BOUND-UNTS         42520002
425300                                     PC126-SHP-REPRT-FROM-CNT     42530002
425400                                     PC126-SHP-REPRT-TO-CNT       42540002
425500                                     PC126-P2L-REPRT-FROM-CNT     42550002
425600                                     PC126-P2L-REPRT-TO-CNT       42560002
425700                                     PC126-P2L-LBL-CNT.           42570002
425800** DMH                                                            42580012
425900     MOVE ASC-PKGNG-CD           TO PC126-PKGNG-CD.               42590012
426000     MOVE ASC-DSPLY-PKGNG-CD     TO PC126-DSPLY-PKGNG-CD.         42600020
426100     MOVE ASC-PREPK-ID           TO PC126-PREPK-ID.               42610020
426200     MOVE ASC-PREPK-RATIO        TO PC126-PREPK-RATIO.            42620020
426300     MOVE ASC-PACKS-IN-CRTN      TO PC126-PACKS-IN-CRTN.          42630024
426400     MOVE ASC-SIGNON-USERID      TO PC126-USER-ID.                42640020
426500                                                                  42650020
426600     IF  ASC-PRE-PACK-ORDER                                       42660020
426700         PERFORM 4078-GET-TOT-PREPK-UNTS                          42670020
426800         MOVE  PV-TOT-PREPK-UNTS TO  PC126-TOT-PREPK-UNTS         42680020
426900         MOVE  PV-TOT-PREPK-INPK-UNTS                             42690035
427000                                 TO  PC126-PREPK-INPK-UNT-QTY     42700035
427100     ELSE                                                         42710035
427200         MOVE  ZEROES            TO  PC126-TOT-PREPK-UNTS         42720035
427300                                     PC126-PREPK-INPK-UNT-QTY     42730035
427400     END-IF.                                                      42740035
427500** DMH                                                            42750012
427600     MOVE LENGTH OF PC126-COMMAREA-REC                            42760002
427700                                 TO  PV-COMMAREA-LENGTH.          42770002
427800                                                                  42780002
427900     MOVE +1 TO ASC-BLK-SUB.                                      42790002
428000     PERFORM 5001-CLEAR-SELECTED-INDS                             42800002
428100         VARYING ASC-ITEM-SUB                                     42810002
428200         FROM 1 BY 1                                              42820002
428300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 42830002
428400     ADD +1  TO ASC-BLK-SUB.                                      42840002
428500     PERFORM 5001-CLEAR-SELECTED-INDS                             42850002
428600         VARYING ASC-ITEM-SUB                                     42860002
428700         FROM 1 BY 1                                              42870002
428800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 42880002
428900                                                                  42890002
429000     PERFORM 5900-LINK-PRINT-ROUTINE-SYSTEC.                      42900002
429100                                                                  42910002
429200     IF  ASC-DISTHD-ORIG-LBL-TYP  =  PC-X                         42920002
429300         PERFORM 6200-UPDATE-DISTHD                               42930002
429400     END-IF.                                                      42940002
429500                                                                  42950002
429600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        42960002
429700                                                                  42970002
429800                                                                  42980002
429900     MOVE +1                   TO  ASC-BLK-SUB.                   42990002
430000     PERFORM 5100-WRITE-TEMP-STORAGE.                             43000002
430100     ADD +1                    TO  ASC-BLK-SUB.                   43010002
430200     PERFORM 5100-WRITE-TEMP-STORAGE.                             43020002
430300                                                                  43030002
430400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        43040002
430500                                                                  43050002
430600                                                                  43060002
430700*----------------------------------------------------------------*43070002
430800*    MARK EACH ITEM AS BEING NOT SELECTED. CHANGE ACT TO PRT     *43080002
430900*----------------------------------------------------------------*43090002
431000 5001-CLEAR-SELECTED-INDS.                                        43100002
431100                                                                  43110002
431200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           43120002
431300             NOT EQUAL ZERO                                       43130002
431400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          43140002
431500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          43150002
431600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    43160002
431700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  43170002
431800                                   TO TRUE                        43180002
431900             MOVE PC-PRT TO ASC-ACTION(ASC-BLK-SUB ASC-ITEM-SUB)  43190002
432000         END-IF                                                   43200002
432100     END-IF.                                                      43210002
432200                                                                  43220002
432300                                                                  43230002
432400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43240002
432500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *43250002
432600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *43260002
432700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43270002
432800 5100-WRITE-TEMP-STORAGE.                                         43280002
432900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     43290002
433000                                   TO PV-LIST-ITEM-NUMBER.        43300002
433100     COMPUTE PV-BLOCK-NUMBER =                                    43310002
433200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    43320002
433300                                                                  43330002
433400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             43340002
433500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             43350002
433600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      43360002
433700             PERFORM 5105-REWRITE-ASC-LISTQ                       43370002
433800         END-IF                                                   43380002
433900     ELSE                                                         43390002
434000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       43400002
434100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            43410002
434200         PERFORM 5110-WRITE-ASC-LISTQ                             43420002
434300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   43430002
434400     END-IF.                                                      43440002
434500                                                                  43450002
434600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             43460002
434700                                                                  43470002
434800                                                                  43480002
434900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43490002
435000*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *43500002
435100*  SPECIFIC COMMAREA.                                            *43510002
435200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43520002
435300 5105-REWRITE-ASC-LISTQ.                                          43530002
435400     EXEC CICS                                                    43540002
435500         WRITEQ TS                                                43550002
435600             QUEUE (ASC-LIST-QUEUE-NAME)                          43560002
435700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               43570002
435800             ITEM  (PV-BLOCK-NUMBER)                              43580002
435900             REWRITE                                              43590002
436000             RESP  (PV-CICS-RESP)                                 43600002
436100     END-EXEC.                                                    43610002
436200                                                                  43620002
436300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           43630002
436400         CONTINUE                                                 43640002
436500     ELSE                                                         43650002
436600         SET DP013-CICS-ABEND            TO TRUE                  43660002
436700         SET DP013-NO-ROLLBACK           TO TRUE                  43670002
436800         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       43680002
436900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     43690002
437000                                         TO DP013-MESSAGE-TEXT(1) 43700002
437100         PERFORM DP013-0000-PROCESS-ABEND                         43710002
437200     END-IF.                                                      43720002
437300                                                                  43730002
437400                                                                  43740002
437500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43750002
437600*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *43760002
437700*  SPECIFIC COMMAREA.                                            *43770002
437800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43780002
437900 5110-WRITE-ASC-LISTQ.                                            43790002
438000     EXEC CICS                                                    43800002
438100         WRITEQ TS                                                43810002
438200             QUEUE (ASC-LIST-QUEUE-NAME)                          43820002
438300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               43830002
438400             ITEM  (PV-BLOCK-NUMBER)                              43840002
438500             RESP  (PV-CICS-RESP)                                 43850002
438600     END-EXEC.                                                    43860002
438700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      43870002
438800         SET DP013-CICS-ABEND      TO TRUE                        43880002
438900         SET DP013-NO-ROLLBACK     TO TRUE                        43890002
439000         MOVE '5110-WRITE-ASC-LISTQ'                              43900002
439100                                   TO DP013-PARAGRAPH             43910002
439200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           43920002
439300                                   TO DP013-MESSAGE-TEXT(1)       43930002
439400         PERFORM DP013-0000-PROCESS-ABEND                         43940002
439500     END-IF.                                                      43950002
439600                                                                  43960002
439700 5400-BUILD-SEL-STRS-TS-QUEUE.                                    43970002
439800                                                                  43980002
439900     PERFORM 6112-READ-LIST-QUEUE.                                43990002
440000                                                                  44000002
440100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       44010002
440200         PERFORM                                                  44020002
440300         VARYING LQW-IDX                                          44030002
440400         FROM 1 BY 1                                              44040002
440500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            44050002
440600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          44060002
440700                                                                  44070002
440800             IF  LQW-SELECT (LQW-IDX)                             44080002
440900                 MOVE LQW-STORE (LQW-IDX) (2:3)                   44090002
441000                                   TO PV-STORE                    44100002
441100                 ADD LQW-FCSE-CART-QTY (LQW-IDX)                  44110002
441200                                   TO PV-TOT-SEL-FCSE-CART-QTY    44120002
441300                 ADD LQW-INPK-CART-QTY (LQW-IDX)                  44130002
441400                                   TO PV-TOT-SEL-INPK-CART-QTY    44140002
441500                                                                  44150002
441600                 IF LQW-STORE-TYPE (LQW-IDX) = PC-CS              44160002
441700                    ADD LQW-CARTQTY (LQW-IDX) TO PV-TOT-CS-LABELS 44170002
441800                    MOVE LQW-CARTQTY (LQW-IDX)                    44180002
441900                                            TO PV-NO-OF-LBLS-COMP 44190002
442000                 END-IF                                           44200002
442100                                                                  44210002
442200                                                                  44220002
442300                 PERFORM 5700-WRITE-PRINT-QUEUE                   44230002
442400                                                                  44240002
442500                 SET LQW-DESELECT (LQW-IDX)                       44250002
442600                                   TO TRUE                        44260002
442700                 MOVE SPACE      TO LQW-TEMP-SELECTED-SW (LQW-IDX)44270002
442800                 SUBTRACT 1    FROM ASC-NUMBER-OF-SELECTED-ITEMS  44280002
442900             END-IF                                               44290002
443000         END-PERFORM                                              44300002
443100     END-IF.                                                      44310002
443200                                                                  44320002
443300     MOVE PV-ITEM                  TO PV-SAVE-ITEM.               44330002
443400     PERFORM 6111-WRITE-LIST-QUEUE.                               44340002
443500                                                                  44350002
456000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*45600002
456100*    MOVE THE REQUIRED DATA TO THE FIELDS ON THE PRINT REQUEST   *45610002
456200*    LAYOUT AND WRITE THE RECORD TO THE PRINT REQUEST TEMP       *45620002
456300*    STORAGE QUEUE.                                              *45630002
456400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*45640002
456500 5700-WRITE-PRINT-QUEUE.                                          45650002
456600                                                                  45660002
456700     MOVE LENGTH OF PC128-COMMAREA-REC                            45670002
456800                                 TO PV-WRITE-LENGTH.              45680002
456900                                                                  45690002
457000     MOVE ASC-PO-NBR             TO  PC128-PO-NBR.                45700002
457100     MOVE ASC-REC-SEQ-NBR        TO  PC128-RCVR-SEQ-NBR.          45710002
457200     MOVE ASC-PO-LNE-NBR         TO  PC128-PO-LNE-NBR.            45720002
457300     MOVE LQW-STORE (LQW-IDX)                                     45730002
457400                                 TO  PC128-STR-NBR.               45740002
457500                                                                  45750002
457600*    MOVE PV-MFST-NBR            TO  PC128-MNFT-NBR.              45760033
457700     MOVE ZEROS                  TO  PC128-MNFT-NBR.              45770033
457800     MOVE LQW-FCSE-CART-QTY (LQW-IDX)                             45780002
457900                                 TO  PC128-FCSE-LBL-CNT.          45790002
458000     MOVE LQW-INPK-CART-QTY (LQW-IDX)                             45800002
458100                                 TO  PC128-INPK-LBL-CNT.          45810002
458200     MOVE LQW-ODD-CRTN-SW (LQW-IDX)                               45820002
458300                                 TO  PC128-ODD-CART-SW.           45830002
458400                                                                  45840002
458500                                                                  45850002
458600     EXEC CICS                                                    45860002
458700         WRITEQ TS                                                45870002
458800             QUEUE   (ASC-PRT-QUEUE-NAME)                         45880002
458900             FROM    (PC128-COMMAREA-REC)                         45890002
459000             LENGTH  (PV-WRITE-LENGTH)                            45900002
459100             RESP    (PV-CICS-RESP)                               45910002
459200     END-EXEC.                                                    45920002
459300                                                                  45930002
459400     EVALUATE TRUE                                                45940002
459500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     45950002
459600             CONTINUE                                             45960002
459700         WHEN OTHER                                               45970002
459800             MOVE '5700-WRITE-PRINT-QUEUE'                        45980002
459900                                 TO DP013-PARAGRAPH               45990002
460000             MOVE 'UNABLE TO WRITE TO PIGGYBACK LABEL REQUEST'    46000002
460100                                 TO DP013-MESSAGE-TEXT (1)        46010002
460200             MOVE 'TS QUEUE'     TO DP013-MESSAGE-TEXT (2)        46020002
460300             SET DP013-CICS-ABEND                                 46030002
460400                 DP013-NO-ROLLBACK                                46040002
460500                                 TO TRUE                          46050002
460600             PERFORM DP013-0000-PROCESS-ABEND                     46060002
460700     END-EVALUATE.                                                46070002
460800                                                                  46080002
460900                                                                  46090002
461000 EJECT                                                            46100002
461100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*46110002
461200*    LINK TO THE PROGRAM WHICH BUILDS THE JOBS USED TO PRODUCE   *46120002
461300*    THE BATCH SHIPPING MANIFEST LABELS.  THIS ROUTINE WILL      *46130002
461400*    BE USED FOR PRINTERS THAT ARE SET UP FOR THE NEW SYS-TEC    *46140002
461500*    LABEL SYSTEM.                                               *46150002
461600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*46160002
461700 5900-LINK-PRINT-ROUTINE-SYSTEC.                                  46170002
461800                                                                  46180002
461900     EXEC CICS                                                    46190002
462000          LINK PROGRAM  ('PCKCS191')                              46200002
462100               COMMAREA (PC126-COMMAREA-REC)                      46210002
462200               LENGTH   (PV-COMMAREA-LENGTH)                      46220002
462300               RESP     (PV-CICS-RESP)                            46230002
462400     END-EXEC.                                                    46240002
462500                                                                  46250002
462600     EVALUATE TRUE                                                46260002
462700         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     46270002
462800              CONTINUE                                            46280002
462900         WHEN OTHER                                               46290002
463000              PERFORM DP013-0000-PROCESS-ABEND                    46300002
463100     END-EVALUATE.                                                46310002
463200                                                                  46320002
463300     MOVE PC126-CRA-RET-CDE      TO PM-RET-CDE.                   46330002
463400     MOVE PC126-CRA-RET-MSG      TO PM-RET-MSG.                   46340002
463500     MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT.               46350002
463600                                                                  46360002
463700 EJECT                                                            46370002
463800                                                                  46380002
463900                                                                  46390002
464000*----------------------------------------------------------------*46400002
464100*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *46410002
464200*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *46420002
464300*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *46430002
464400*  THE USER.                                                     *46440002
464500*----------------------------------------------------------------*46450002
464600 6000-REFRESH-PANEL-FROM-TEMP.                                    46460002
464700     IF  ASC-UPDATE-TSQ                                           46470002
464800         SET ASC-NO-TSQ-UPDATE TO TRUE                            46480002
464900         MOVE ZERO                 TO PV-SAVE-ITEM                46490002
465000                                      PV-SEL-QUEUE-ITEM           46500002
465100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        46510002
465200                                   TO PV-HOLD-SELECTED-ITEMS      46520002
465300         MOVE +1                   TO PV-ITEMS-PROCESSED          46530002
465400         PERFORM 6100-UPDATE-TSQ                                  46540002
465500             UNTIL PV-ITEMS-PROCESSED >                           46550002
465600                                     PV-HOLD-SELECTED-ITEMS       46560002
465700         PERFORM 6010-DELETE-SEL-QUEUE                            46570002
465800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         46580002
465900                    ASC-BLOCK-ENTRIES (2)                         46590002
466000     END-IF.                                                      46600002
466100                                                                  46610002
466200                                                                  46620002
466300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*46630002
466400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *46640002
466500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*46650002
466600 6010-DELETE-SEL-QUEUE.                                           46660002
466700     EXEC CICS                                                    46670002
466800         DELETEQ TS                                               46680002
466900             QUEUE (ASC-SEL-QUEUE-NAME)                           46690002
467000             RESP  (PV-CICS-RESP)                                 46700002
467100     END-EXEC.                                                    46710002
467200                                                                  46720002
467300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      46730002
467400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         46740002
467500         CONTINUE                                                 46750002
467600     ELSE                                                         46760002
467700         SET DP013-CICS-ABEND TO TRUE                             46770002
467800         SET DP013-NO-ROLLBACK TO TRUE                            46780002
467900         MOVE '6010-DELETE-SEL-QUEUE'                             46790002
468000                        TO DP013-PARAGRAPH                        46800002
468100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         46810002
468200                        TO DP013-MESSAGE-TEXT (1)                 46820002
468300         PERFORM DP013-0000-PROCESS-ABEND                         46830002
468400     END-IF.                                                      46840002
468500                                                                  46850002
468600                                                                  46860002
468700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*46870002
468800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *46880002
468900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *46890002
469000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *46900002
469100*    THE TEMP QUEUE.                                             *46910002
469200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*46920002
469300                                                                  46930002
469400 6100-UPDATE-TSQ.                                                 46940002
469500                                                                  46950002
469600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             46960002
469700     PERFORM 6105-READ-SEL-QUEUE.                                 46970002
469800     PERFORM                                                      46980002
469900         VARYING DP057-IDX                                        46990002
470000         FROM 1 BY 1                                              47000002
470100         UNTIL ((PV-ITEMS-PROCESSED >                             47010002
470200                              PV-HOLD-SELECTED-ITEMS)             47020002
470300         OR (DP057-IDX GREATER THAN DP057-MAX-ITEMS))             47030002
470400         IF  DP057-ACTION-SW (DP057-IDX) > SPACE                  47040002
470500             PERFORM 6110-PROCESS-ITEMS                           47050002
470600         END-IF                                                   47060002
470700         ADD +1                TO PV-ITEMS-PROCESSED              47070002
470800     END-PERFORM.                                                 47080002
470900     PERFORM 6111-WRITE-LIST-QUEUE.                               47090002
471000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*47100002
471100*    READ THE LIST QUEUE RECORD.                                 *47110002
471200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*47120002
471300                                                                  47130002
471400 6105-READ-SEL-QUEUE.                                             47140002
471500                                                                  47150002
471600     EXEC CICS                                                    47160002
471700          READQ TS                                                47170002
471800              QUEUE (ASC-SEL-QUEUE-NAME)                          47180002
471900              INTO  (DP057-MESSAGE-SEL-REC)                       47190002
472000              ITEM  (PV-SEL-QUEUE-ITEM)                           47200002
472100              RESP  (PV-CICS-RESP)                                47210002
472200     END-EXEC.                                                    47220002
472300*                                                                 47230002
472400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          47240002
472500         CONTINUE                                                 47250002
472600     ELSE                                                         47260002
472700         SET DP013-CICS-ABEND      TO  TRUE                       47270002
472800         SET DP013-NO-ROLLBACK     TO  TRUE                       47280002
472900         MOVE '6105-READ-SEL-QUEUE'                               47290002
473000                                   TO  DP013-PARAGRAPH            47300002
473100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           47310002
473200                                   TO  DP013-MESSAGE-TEXT(1)      47320002
473300         PERFORM DP013-0000-PROCESS-ABEND                         47330002
473400     END-IF.                                                      47340002
473500 EJECT                                                            47350002
473600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*47360002
473700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*47370002
473800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*47380002
473900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *47390002
474000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*47400002
474100                                                                  47410002
474200 6110-PROCESS-ITEMS.                                              47420002
474300                                                                  47430002
474400     COMPUTE PV-ITEM = 1 + ((DP057-ITEM (DP057-IDX) - 1)          47440002
474500                     / PC-ITEMS-PER-PANEL).                       47450002
474600                                                                  47460002
474700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           47470002
474800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          47480002
474900             PERFORM 6111-WRITE-LIST-QUEUE                        47490002
475000         END-IF                                                   47500002
475100         MOVE PV-ITEM          TO PV-SAVE-ITEM                    47510002
475200                                                                  47520002
475300         PERFORM 6112-READ-LIST-QUEUE                             47530002
475400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               47540002
475500             CONTINUE                                             47550002
475600         END-IF                                                   47560002
475700     END-IF.                                                      47570002
475800                                                                  47580002
475900     COMPUTE PV-SUB = (DP057-ITEM (DP057-IDX)                     47590002
476000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              47600002
476100     SET LQW-DESELECT (PV-SUB) TO    TRUE                         47610002
476200     MOVE LQW-SELECTED-SW (PV-SUB)                                47620002
476300                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  47630002
476400     EVALUATE TRUE                                                47640002
476500         WHEN DP057-INQ (DP057-IDX)                               47650002
476600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             47660002
476700                                                                  47670002
476800         WHEN DP057-UPD (DP057-IDX)                               47680002
476900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             47690002
477000                                                                  47700002
477100         WHEN DP057-DEL (DP057-IDX)                               47710002
477200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             47720002
477300                                                                  47730002
477400         WHEN DP057-ERR (DP057-IDX)                               47740002
477500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             47750002
477600     END-EVALUATE.                                                47760002
477700                                                                  47770002
477800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                47780002
477900                                                                  47790002
478000                                                                  47800002
478100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*47810002
478200*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *47820002
478300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*47830002
478400 6111-WRITE-LIST-QUEUE.                                           47840002
478500     EXEC CICS                                                    47850002
478600         WRITEQ TS                                                47860002
478700             QUEUE (ASC-LIST-QUEUE-NAME)                          47870002
478800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     47880002
478900             ITEM  (PV-SAVE-ITEM)                                 47890002
479000             REWRITE                                              47900002
479100             RESP  (PV-CICS-RESP)                                 47910002
479200     END-EXEC.                                                    47920002
479300                                                                  47930002
479400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          47940002
479500         CONTINUE                                                 47950002
479600     ELSE                                                         47960002
479700         SET DP013-CICS-ABEND  TO  TRUE                           47970002
479800         SET DP013-NO-ROLLBACK TO  TRUE                           47980002
479900         MOVE '6111-WRITE-LIST-QUEUE'                             47990002
480000                               TO  DP013-PARAGRAPH                48000002
480100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  48010002
480200                               TO  DP013-MESSAGE-TEXT(1)          48020002
480300         PERFORM DP013-0000-PROCESS-ABEND                         48030002
480400     END-IF.                                                      48040002
480500                                                                  48050002
480600                                                                  48060002
480700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*48070002
480800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*48080002
480900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*48090002
481000 6112-READ-LIST-QUEUE.                                            48100002
481100     EXEC CICS                                                    48110002
481200         READQ TS                                                 48120002
481300             QUEUE (ASC-LIST-QUEUE-NAME)                          48130002
481400             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     48140002
481500             ITEM  (PV-ITEM)                                      48150002
481600             RESP  (PV-CICS-RESP)                                 48160002
481700     END-EXEC.                                                    48170002
481800                                                                  48180002
481900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48190002
482000         CONTINUE                                                 48200002
482100     ELSE                                                         48210002
482200         SET DP013-CICS-ABEND        TO TRUE                      48220002
482300         SET DP013-NO-ROLLBACK       TO TRUE                      48230002
482400         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           48240002
482500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    48250002
482600                                     TO DP013-MESSAGE-TEXT(1)     48260002
482700         PERFORM DP013-0000-PROCESS-ABEND                         48270002
482800     END-IF.                                                      48280002
482900                                                                  48290002
483000                                                                  48300002
483100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 48310002
483200* UPDATE DISTHD LBL TYPE IF ORIGINALLY = 'X'                     *48320002
483300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 48330002
483400 6200-UPDATE-DISTHD.                                              48340002
483500                                                                  48350002
483600     MOVE  ASC-LBL-PRT-ORDER      TO  DISTHD-FCSE-LBL-TYP-CDE.    48360002
483700                                                                  48370002
483800     EXEC SQL                                                     48380002
483900          UPDATE TDISTHD                                          48390002
484000             SET                                                  48400002
484100                 FCSE_LBL_TYP_CDE  = :DISTHD-FCSE-LBL-TYP-CDE     48410002
484200           WHERE ORD_NBR           = :ASC-PO-NBR                  48420002
484300             AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR             48430002
484400             AND ORD_LNE_NBR       = :ASC-PO-LNE-NBR              48440002
484500     END-EXEC.                                                    48450002
484600                                                                  48460002
484700     EVALUATE TRUE                                                48470002
484800                                                                  48480002
484900         WHEN SQLCODE = +0                                        48490002
485000             CONTINUE                                             48500002
485100                                                                  48510002
485200         WHEN SQLCODE = -904                                      48520002
485300         WHEN SQLCODE = -911                                      48530002
485400         WHEN SQLCODE = -913                                      48540002
485500             PERFORM 9900-SOFT-ABORT                              48550002
485600                                                                  48560002
485700         WHEN SQLWARN0 NOT = SPACES                               48570002
485800         WHEN SQLCODE < +0                                        48580002
485900         WHEN SQLCODE > +0                                        48590002
486000             MOVE '6200-UPDATE-DISTHD'                            48600002
486100                             TO DP013-PARAGRAPH                   48610002
486200             MOVE 'UPDATE LABEL TYPE ON DISTHD TABLE'             48620002
486300                             TO DP013-MESSAGE-TEXT (1)            48630002
486400             MOVE SQLCA          TO DP013-SQLCA                   48640002
486500             MOVE 'TDISTHD'      TO DP013-DB2-TABLE-NAME (1)      48650002
486600             SET DP013-DB2-ABEND                                  48660002
486700                 DP013-XCTL-DISPLAY-RESTART                       48670002
486800                             TO TRUE                              48680002
486900             PERFORM DP013-0000-PROCESS-ABEND                     48690002
487000     END-EVALUATE.                                                48700002
487100                                                                  48710002
487200                                                                  48720002
487300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 48730002
487400* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *48740002
487500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 48750002
487600 9100-READ-SEL-QUEUE.                                             48760002
487700     EXEC CICS                                                    48770002
487800         READQ TS                                                 48780002
487900             QUEUE (ASC-SEL-QUEUE-NAME)                           48790002
488000             INTO  (PC121-DC-SELECT-RECORD)                       48800002
488100             ITEM  (ASC-SEL-ITEM)                                 48810002
488200             RESP  (PV-CICS-RESP)                                 48820002
488300     END-EXEC.                                                    48830002
488400                                                                  48840002
488500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       48850002
488600         CONTINUE                                                 48860002
488700     ELSE                                                         48870002
488800         SET DP013-LOGIC-ABEND                                    48880002
488900             DP013-NO-ROLLBACK     TO TRUE                        48890002
489000         MOVE '9100-READ-SEL-QUEUE'                               48900002
489100                                   TO DP013-PARAGRAPH             48910002
489200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   48920002
489300                                   TO DP013-MESSAGE-TEXT (1)      48930002
489400         PERFORM DP013-0000-PROCESS-ABEND                         48940002
489500     END-IF.                                                      48950002
489600                                                                  48960002
489700                                                                  48970002
489800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*48980002
489900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *48990002
490000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 49000002
490100 9200-REWRITE-SEL-QUEUE.                                          49010002
490200     EXEC CICS                                                    49020002
490300          WRITEQ TS                                               49030002
490400              QUEUE  (ASC-SEL-QUEUE-NAME)                         49040002
490500              FROM   (PC121-DC-SELECT-RECORD)                     49050002
490600              ITEM   (ASC-SEL-ITEM)                               49060002
490700              RESP   (PV-CICS-RESP)                               49070002
490800              REWRITE                                             49080002
490900     END-EXEC.                                                    49090002
491000                                                                  49100002
491100     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   49110002
491200         SET DP013-CICS-ABEND                                     49120002
491300             DP013-NO-ROLLBACK     TO TRUE                        49130002
491400         MOVE '9200-REWRITE-SEL-QUEUE'                            49140002
491500                                   TO DP013-PARAGRAPH             49150002
491600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   49160002
491700                                   TO DP013-MESSAGE-TEXT (1)      49170002
491800         PERFORM DP013-0000-PROCESS-ABEND                         49180002
491900     END-IF.                                                      49190002
492000                                                                  49200002
492100                                                                  49210002
492200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*49220002
492300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *49230002
492400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *49240002
492500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*49250002
492600 9900-SOFT-ABORT.                                                 49260002
492700                                                                  49270002
492800     EXEC CICS SYNCPOINT                                          49280002
492900          ROLLBACK                                                49290002
493000     END-EXEC.                                                    49300002
493100                                                                  49310002
493200     SET  PS-ERROR              TO TRUE.                          49320002
493300                                                                  49330002
493400                                                                  49340002
493500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*49350002
493600*    ABEND PROCESSOR MODULE                                      *49360002
493700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*49370002
493800                                                                  49380002
493900     COPY DPPD013.                                                49390002
