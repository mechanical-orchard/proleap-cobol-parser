      *************************                                                 
       IDENTIFICATION DIVISION.                                                 
      *************************                                                 
       PROGRAM-ID.             TXKRP056.                                        
       AUTHOR.                 LENIN JOSEPH - COGNIZANT                         
       INSTALLATION.           KOHLS DEPARTMENT STORES.                         
       DATE-WRITTEN            JAN 2014.                                        
       DATE-COMPILED.                                                           
                                                                                
      *****************************************************************         
      *                                                                         
      *  THIS PROGRAM WILL CREATE THE MONTHLY SFS REPORT FOR STORE              
      *  AND ZIP CODE LEVEL. THIS PROGRAM USES THE SORTED INPUT FILE            
      *  FOR BOTH STORE LEVEL AND ZIP CODE LEVEL.                               
      *                                                                         
      *   INPUT : INP01 -  SFS STORE INPUT FILE                                 
      *   INPUT : INP02 -  SFS ZIP CODE INPUT FILE                              
      *   INPUT : INP03 -  FISCAL MONTH END DATE                                
      *                                                                         
      *   OUTPUT: OUT01 -  ROLLED UP SFS STORE OUTPUT FILE                      
      *   OUTPUT: OUT02 -  ROLLED UP SFS ZIP CODE OUTPUT FILE                   
      *                                                                         
      *CHANGE HISTORY:                                                          
      * WR/PBI     DATE        DESCRIPTION OF CHANGES                           
      * -------    ----------  ----------------------------------------         
      *  *****     01-29-2014  INITIAL CREATION - COGNIZANT                     
TRUNC * CHG0281149  1-24-2023  EXPAND WORKING STORAGE AND REPORT FIELDS         
TRUNC *                        TO STOP TRUNCATION OF THE TOTALS                 
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT SFS-STR-INPUT                                                 
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT SFS-ZIP-INPUT                                                 
               ASSIGN TO INP02.                                                 
                                                                                
           SELECT POS-DATE-CARD-FILE                                            
               ASSIGN TO INP03.                                                 
                                                                                
           SELECT SFS-STR-REPORT                                                
               ASSIGN TO RPT01.                                                 
                                                                                
           SELECT SFS-ZIP-REPORT                                                
               ASSIGN TO RPT02.                                                 
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  SFS-STR-INPUT                                                        
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       01  SFS-STR-INPUT-REC                     PIC X(80).                     
                                                                                
       FD  SFS-ZIP-INPUT                                                        
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       01  SFS-ZIP-INPUT-REC                     PIC  X(80).                    
                                                                                
       FD  POS-DATE-CARD-FILE                                                   
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       01  CONTROL-RECORD                        PIC  X(80).                    
                                                                                
       FD  SFS-STR-REPORT                                                       
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       01  SFS-STR-REPORT-REC                    PIC  X(132).                   
                                                                                
       FD  SFS-ZIP-REPORT                                                       
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       01  SFS-ZIP-REPORT-REC                    PIC  X(132).                   
                                                                                
      ******************************************************************        
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
                                                                                
      ******************************************************************        
      *          P R O G R A M     A B E N D     C O D E               *        
      ******************************************************************        
                                                                                
       01  ABEND-CODE                            PIC S9(04) VALUE ZERO          
                                                            COMP SYNC.          
           88  AC-CONTROL-CARD-ERROR                        VALUE +4003.        
           88  AC-CALENDAR-ROUTINE-ERROR                    VALUE +4019.        
                                                                                
      ******************************************************************        
      *              P R O G R A M     C O N S T A N T S               *        
      ******************************************************************        
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PROGRAM-ABEND-MESSAGE          PIC  X(11) VALUE               
                                                     '** ABEND **'.             
           05  PC-LINE-LIMIT                     PIC S9(04) VALUE +60           
                                                           COMP-3.              
           05  PC-REPORT-NBR-1                   PIC  9(01) VALUE 1.            
           05  PC-PROGRAM-NAME                   PIC  X(08) VALUE               
                                                           'TXKUT056'.          
           05  PC-ONE                            PIC  9(01) VALUE 1.            
           05  PC-MINUS-ONE                      PIC S9(01) VALUE -1.           
                                                                                
      ******************************************************************        
      *               P R O G R A M     C O U N T E R S                *        
      ******************************************************************        
       01  PC-PROGRAM-COUNTERS.                                                 
           05  PV-PAGE-CNT                       PIC S9(05) VALUE 0.            
           05  PC-STR-INPUT-REC-CNT              PIC  9(05) VALUE 0.            
           05  PC-ZIP-INPUT-REC-CNT              PIC  9(05) VALUE 0.            
           05  PC-STR-OUT-REC-CNT                PIC  9(05) VALUE 0.            
           05  PC-ZIP-OUT-REC-CNT                PIC  9(05) VALUE 0.            
           05  PC-STR-STATE-REC-CNT              PIC  9(05) VALUE 0.            
           05  PC-ZIP-STATE-REC-CNT              PIC  9(05) VALUE 0.            
                                                                                
      ******************************************************************        
      *               P R O G R A M     D I S P L A Y S                *        
      ******************************************************************        
       01  PC-PROGRAM-DISPLAYS.                                                 
           05  PC-STR-IN-DIS                     PIC  Z(04)9(01).               
           05  PC-ZIP-IN-DIS                     PIC  Z(04)9(01).               
           05  PC-STR-OUT-DIS                    PIC  Z(04)9(01).               
           05  PC-ZIP-OUT-DIS                    PIC  Z(04)9(01).               
           05  PC-STR-STT-DIS                    PIC  Z(04)9(01).               
           05  PC-ZIP-STT-DIS                    PIC  Z(04)9(01).               
                                                                                
      ******************************************************************        
      *          P R O G R A M     E R R O R     M E S S A G E         *        
      ******************************************************************        
                                                                                
      ******************************************************************        
      *              P R O G R A M     L A Y O U T S                   *        
      ******************************************************************        
       01  PL-PROGRAM-LAYOUTS.                                                  
           05  PL-OUTSTR-SFS-REC.                                               
               10  PL-STR-NBR                    PIC  9(04).                    
               10  PL-STR-NAME                   PIC  X(10).                    
               10  PL-STR-STATE-CODE             PIC  X(02).                    
               10  PL-STR-TAXABLE-AMT            PIC S9(7)V99 COMP-3.           
               10  PL-STR-TAX-AMT                PIC S9(7)V99 COMP-3.           
               10  FILLER                        PIC  X(53).                    
           05  PL-OUTZIP-SFS-REC.                                               
               10  PL-ZIP-CD                     PIC  X(05).                    
               10  PL-ZIP-STATE-CODE             PIC  X(02).                    
               10  PL-ZIP-TAXABLE-AMT            PIC S9(7)V99 COMP-3.           
               10  PL-ZIP-TAX-AMT                PIC S9(7)V99 COMP-3.           
               10  FILLER                        PIC  X(63).                    
            05 CC-DATE-CARD.                                                    
               10  CC-DATE-CD-CCYY               PIC  X(04) VALUE               
                                                           SPACES.              
               10  FILLER                        PIC  X(01) VALUE '-'.          
               10  CC-DATE-CD-MM                 PIC  X(02) VALUE               
                                                           SPACES.              
               10  FILLER                        PIC  X(01) VALUE '-'.          
               10  CC-DATE-CD-DD                 PIC  X(02) VALUE               
                                                           SPACES.              
               10  FILLER                        PIC  X(70) VALUE               
                                                           SPACES.              
      *----------------------------------------------------------               
      * HEADING LINE 2                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-STR-LINE-2.                                               
           05  FILLER                            PIC  X(46) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(35) VALUE               
                      'MONTHLY SFS REPORT ON STORE LEVEL  '.                    
           05  FILLER                            PIC  X(51) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 2                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-ZIP-LINE-2.                                               
           05  FILLER                            PIC  X(46) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(36) VALUE               
                      'MONTHLY SFS REPORT ON ZIP CODE LEVEL'.                   
           05  FILLER                            PIC  X(50) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 3                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-LINE-3.                                                   
           05  FILLER                            PIC  X(53) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(05) VALUE               
                                                            'FROM'.             
           05  HL3-FROM-DATE                     PIC  X(10) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(04) VALUE               
                                                            ' TO '.             
           05  HL3-TO-DATE                       PIC  X(10) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(50) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 5                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-STR-LN-5.                                                 
           05  FILLER                            PIC  X(05) VALUE               
                                                            '_____'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(10) VALUE               
                                                     '__________'.              
           05  FILLER                            PIC  X(06) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(05) VALUE               
                                                            '_____'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(14) VALUE               
                                                      '______________'.         
           05  FILLER                            PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(10) VALUE               
                                                     '__________'.              
           05  FILLER                            PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(88) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 6                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-STR-LN-6.                                                 
           05  FILLER                            PIC  X(05) VALUE               
                                                       'STORE'.                 
           05  FILLER                            PIC  X(05) VALUE               
                                                       SPACES.                  
           05  FILLER                            PIC  X(10) VALUE               
                                                       ' LOCATION '.            
           05  FILLER                            PIC  X(06) VALUE               
                                                       SPACES.                  
           05  FILLER                            PIC  X(05) VALUE               
                                                            'STATE'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(14) VALUE               
                                                       'TAXABLE AMOUNT'.        
           05  FILLER                            PIC  X(02) VALUE               
                                                       SPACES.                  
           05  FILLER                            PIC  X(10) VALUE               
                                                       'TAX AMOUNT'.            
           05  FILLER                            PIC  X(02) VALUE               
                                                       SPACES.                  
           05  FILLER                            PIC  X(88) VALUE               
                                                       SPACES.                  
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 7                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-STR-LN-7.                                                 
           05  FILLER                            PIC  X(05) VALUE               
                                                            '_____'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(10) VALUE               
                                                     '__________'.              
           05  FILLER                            PIC  X(06) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(05) VALUE               
                                                            '_____'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(14) VALUE               
                                                      '______________'.         
           05  FILLER                            PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(10) VALUE               
                                                     '__________'.              
           05  FILLER                            PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(88) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * DETAIL LINE                                                             
      *----------------------------------------------------------               
       01  DL-DETAIL-STR-LINE.                                                  
           05  DL-STR-NBR                        PIC  ZZZZ.                     
           05  FILLER                            PIC  X(06).                    
           05  DL-STR-NAM                        PIC  X(10).                    
           05  FILLER                            PIC  X(08) VALUE               
                                                            SPACES.             
           05  DL-STR-STATE                      PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(06).                    
           05  DL-STR-TAXABLE-AMT                PIC  ZZZZZZZ.99-.              
           05  FILLER                            PIC  X(03) VALUE               
                                                            SPACES.             
           05  DL-STR-TAX-AMT                    PIC  ZZZZZZZ.99-.              
           05  FILLER                            PIC  X(89) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 5                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-ZIP-LN-5.                                                 
           05  FILLER                            PIC  X(09) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(08) VALUE               
                                                       '________'.              
           05  FILLER                            PIC  X(09) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(05) VALUE               
                                                            '_____'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(14) VALUE               
                                                       '______________'.        
           05  FILLER                            PIC  X(04) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(10) VALUE               
                                                       '__________'.            
           05  FILLER                            PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(88) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 6                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-ZIP-LN-6.                                                 
           05  FILLER                            PIC  X(09) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(08) VALUE               
                                                      'ZIP CODE'.               
           05  FILLER                            PIC  X(09) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(05) VALUE               
                                                            'STATE'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(14) VALUE               
                                                       'TAXABLE AMOUNT'.        
           05  FILLER                            PIC  X(04) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(10) VALUE               
                                                        'TAX AMOUNT'.           
           05  FILLER                            PIC  X(90) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * HEADING LINE 7                                                          
      *----------------------------------------------------------               
       01  HL-HEADING-ZIP-LN-7.                                                 
           05  FILLER                            PIC  X(09) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(08) VALUE               
                                                       '________'.              
           05  FILLER                            PIC  X(09) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(05) VALUE               
                                                            '_____'.            
           05  FILLER                            PIC  X(05) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(14) VALUE               
                                                       '______________'.        
           05  FILLER                            PIC  X(04) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(10) VALUE               
                                                       '__________'.            
           05  FILLER                            PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(88) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * DETAIL LINE                                                             
      *----------------------------------------------------------               
       01  DL-DETAIL-ZIP-LINE.                                                  
           05  FILLER                            PIC  X(11).                    
           05  DL-ZIP-CDE                        PIC  X(05).                    
           05  FILLER                            PIC  X(12) VALUE               
                                                            SPACES.             
           05  DL-ZIP-STATE                      PIC  X(02).                    
           05  FILLER                            PIC  X(06) VALUE               
                                                            SPACES.             
           05  DL-ZIP-TAXABLE-AMT                PIC  ZZZZZZZ.99-.              
           05  FILLER                            PIC  X(03) VALUE               
                                                            SPACES.             
           05  DL-ZIP-TAX-AMT                    PIC  ZZZZZZZ.99-.              
           05  FILLER                            PIC  X(89) VALUE               
                                                            SPACES.             
                                                                                
      *----------------------------------------------------------               
      * TOTAL LINE                                                              
      *----------------------------------------------------------               
       01  TL-TOTAL-LINE.                                                       
           05  TL-TOTAL-TYPE                     PIC  X(17) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(01) VALUE '"'.          
           05  TL-STATE-CDE                      PIC  X(02) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(01) VALUE '"'.          
           05  FILLER                            PIC  X(13) VALUE               
                                                            SPACES.             
           05  TL-TAXABLE-AMOUNT                 PIC  ZZZZZZZZZ.99-.            
TRUNC      05  FILLER                            PIC  X(01) VALUE               
                                                            SPACES.             
TRUNC      05  TL-TAX-AMOUNT                     PIC  ZZZZZZZZZ.99-.            
           05  FILLER                            PIC  X(03) VALUE               
                                                            SPACES.             
           05  FILLER                            PIC  X(89) VALUE               
                                                            SPACES.             
                                                                                
      ******************************************************************        
      *              P R O G R A M     S W I T C H E S                 *        
      ******************************************************************        
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-STR-OF-FILE-SW             PIC  X(01) VALUE 'N'.          
               88  PS-NOT-END-STR-OF-FILE                  VALUE 'N'.           
               88  PS-END-STR-OF-FILE                      VALUE 'Y'.           
           05  PS-END-ZIP-OF-FILE-SW             PIC  X(01) VALUE 'N'.          
               88  PS-NOT-END-ZIP-OF-FILE                  VALUE 'N'.           
               88  PS-END-ZIP-OF-FILE                      VALUE 'Y'.           
           05  PS-END-OF-DATE-FILE               PIC  X(01) VALUE 'Y'.          
               88  PS-END-OF-DATE-FILE-YES                 VALUE 'Y'.           
               88  PS-END-OF-DATE-FILE-NO                  VALUE 'N'.           
                                                                                
                                                                                
      ******************************************************************        
      *              P R O G R A M     V A R I A B L E S               *        
      ******************************************************************        
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PARAGRAPH-NAME                 PIC  X(30) VALUE               
                                                           SPACES.              
           05  PV-DB2-OPERATION-ATTEMPTED        PIC  X(30) VALUE               
                                                           SPACES.              
           05  PV-OPERATION-MSG-1                PIC  X(30) VALUE               
                                                           SPACES.              
           05  PV-OPERATION-MSG-2                PIC  X(30) VALUE               
                                                           SPACES.              
           05  PV-LINE-CNT                       PIC S9(03) VALUE +65           
                                                      COMP-3.                   
           05  PV-BREAK-ACCUM-FIELDS.                                           
               10  PV-STR-ST-CDE                 PIC  X(02).                    
               10  PV-STR-ST-TAXABLE-AMT         PIC S9(07)V99 COMP-3           
                                                       VALUE 0.                 
               10  PV-STR-ST-TAX-AMT             PIC S9(07)V99 COMP-3           
                                                       VALUE 0.                 
               10  PV-STR-NBR                    PIC S9(04) COMP-3              
                                                       VALUE 0.                 
               10  PV-STR-CNT                    PIC S9(05) COMP-3              
                                                       VALUE 0.                 
               10  PV-ZIP-ST-CDE                 PIC  X(02).                    
               10  PV-ZIP-TAXABLE-AMT            PIC S9(07)V99 COMP-3           
                                                       VALUE 0.                 
               10  PV-ZIP-TAX-AMT                PIC S9(07)V99 COMP-3    0.     
                                                       VALUE 0.                 
               10  PV-CO-CNT                     PIC S9(05) COMP-3              
                                                       VALUE 0.                 
TRUNC          10  PV-CO-TAX-AMOUNT              PIC S9(09)V99 COMP-3           
                                                       VALUE 0.                 
TRUNC          10  PV-CO-TAX-AMOUNT-DISC         PIC S9(09)V99 COMP-3           
                                                       VALUE 0.                 
                                                                                
       01  PV-DATE-AND-TIME-FIELDS.                                             
           05  PV-08BYT-CONTROL-DT.                                             
               10 PV-08BYT-CONT-CCYY             PIC  X(04).                    
               10 PV-08BYT-CONT-MM               PIC  X(02).                    
               10 PV-08BYT-CONT-DD               PIC  X(02).                    
           05  PV-CURR-DATE-CCYYMMDD.                                           
               10  PV-CURR-DATE-CCYY             PIC  9(04).                    
               10  PV-CURR-DATE-MM               PIC  9(02).                    
               10  PV-CURR-DATE-DD               PIC  9(02).                    
           05  PV-CURR-TIME.                                                    
               10  PV-CURR-TIME-HH               PIC  9(02) VALUE ZERO.         
               10  PV-CURR-TIME-MM               PIC  9(02) VALUE ZERO.         
               10  PV-CURR-TIME-SSHH             PIC  9(04) VALUE ZERO.         
           05  PV-COMP-START-DTE.                                               
               10  PV-COMP-START-CCYY            PIC  X(04).                    
               10  FILLER                        PIC  X(01) VALUE '-'.          
               10  PV-COMP-START-MM              PIC  X(02).                    
               10  FILLER                        PIC  X(01) VALUE '-'.          
               10  PV-COMP-START-DD              PIC  X(02).                    
           05  PV-COMP-END-DTE.                                                 
               10  PV-COMP-END-CCYY              PIC  X(04).                    
               10  FILLER                        PIC  X(01) VALUE '-'.          
               10  PV-COMP-END-MM                PIC  X(02).                    
               10  FILLER                        PIC  X(01) VALUE '-'.          
               10  PV-COMP-END-DD                PIC  X(02).                    
      *----------------------------------------------------------               
      * WORKING STORAGE SECTION FOR CALENDAR ROUTINE                            
      *----------------------------------------------------------               
           COPY DPWS500.                                                        
                                                                                
      *----------------------------------------------------------               
      * STANDARD HEADING FOR 132 CHARACTER REPORT                               
      *----------------------------------------------------------               
           COPY DPWS132.                                                        
                                                                                
      *---------------------------------------------------------------*         
       PROCEDURE DIVISION.                                                      
      *---------------------------------------------------------------*         
                                                                                
       0000-MAINLINE-PARAGRAPH.                                                 
                                                                                
           PERFORM 1000-INITIALIZE.                                             
                                                                                
           PERFORM 2000-PROCESS-STR-INFO                                        
                   UNTIL PS-END-STR-OF-FILE.                                    
                                                                                
           PERFORM 3000-PROCESS-ZIP-INFO                                        
                   UNTIL PS-END-ZIP-OF-FILE.                                    
                                                                                
           PERFORM 9000-END-OF-JOB.                                             
                                                                                
           GOBACK.                                                              
      *****************************************************************         
      * 1000-INITIALIZE.                                                        
      *                                                                         
      * INITALIZE COUNTER, SWITCHES AND LAYOUTS. OPEN THE FILES                 
      * AND MAKE IT READY FOR FURTHER PROCESSING. CALLS THE DATE ROUTINE        
      * TO GET THE FISCAL MONTH START DATE AND FISCAL MONTH END DATE.           
      *                                                                         
      *                                                                         
      * PARAGRAPH CALLED FROM :- 0000-MAINLINE-PARAGRAPH                        
      * PARAGRAPH CALLED TO   :- 1100-PROCESS-CONTROL-CARD                      
      *                          8000-READ-SFS-STR-INPUT                        
      *                          9999-ABEND-PROCESS                             
      *****************************************************************         
       1000-INITIALIZE.                                                         
                                                                                
           OPEN INPUT SFS-STR-INPUT                                             
                      SFS-ZIP-INPUT                                             
                      POS-DATE-CARD-FILE                                        
               OUTPUT SFS-STR-REPORT                                            
                      SFS-ZIP-REPORT.                                           
                                                                                
           PERFORM 1100-PROCESS-CONTROL-CARD.                                   
                                                                                
           PERFORM 8000-READ-SFS-STR-INPUT.                                     
                                                                                
           IF PS-END-STR-OF-FILE                                                
               MOVE '1000-INITIALIZE'       TO PV-PARAGRAPH-NAME                
               MOVE ' SFS STORE INPUT FILE IS EMPTY '                           
                                            TO PV-OPERATION-MSG-1               
              PERFORM 9999-ABEND-PROCESS                                        
           ELSE                                                                 
               MOVE PL-STR-STATE-CODE       TO PV-STR-ST-CDE                    
                                               DL-STR-STATE                     
           END-IF.                                                              
                                                                                
                                                                                
           MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.           
           ACCEPT PV-CURR-TIME FROM TIME.                                       
                                                                                
           MOVE PV-CURR-DATE-MM             TO DP132-RUN-MONTH.                 
           MOVE PV-CURR-DATE-DD             TO DP132-RUN-DAY.                   
           MOVE PV-CURR-DATE-CCYY           TO DP132-RUN-YEAR.                  
                                                                                
           MOVE PV-CURR-TIME-HH             TO DP132-RUN-HOUR.                  
           MOVE PV-CURR-TIME-MM             TO DP132-RUN-MINUTE.                
           MOVE PC-PROGRAM-NAME             TO DP132-PROGRAM-NAME.              
           MOVE PC-REPORT-NBR-1             TO DP132-REPORT-NUMBER.             
                                                                                
      *****************************************************************         
      * 1100-PROCESS-DATE-CARD.                                                 
      *                                                                         
      * CALLS THE DATE ROUTINE WITH FISCAL END DATE AND RETRIVES THE            
      * FISCAL MONTH START DATE AND FISCAL MONTH END DATE.                      
      *                                                                         
      * PARAGRAPH CALLED FROM :- 1000-INITIALIZE                                
      * PARAGRAPH CALLED TO   :- 1100-PROCESS-DATE-CARD                         
      *                          9999-ABEND-PROCESS                             
      *****************************************************************         
                                                                                
       1100-PROCESS-CONTROL-CARD.                                               
                                                                                
           INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.                 
           SET PS-END-OF-DATE-FILE-NO       TO TRUE                             
                                                                                
           READ POS-DATE-CARD-FILE          INTO CC-DATE-CARD                   
               AT END                                                           
                   SET PS-END-OF-DATE-FILE-YES  TO TRUE                         
           END-READ.                                                            
                                                                                
           IF PS-END-OF-DATE-FILE-YES                                           
               MOVE '1100-PROCESS-CONTROL-CARD' TO PV-PARAGRAPH-NAME            
               MOVE 'DATE CARD MISSING'     TO PV-OPERATION-MSG-1               
               PERFORM 9999-ABEND-PROCESS                                       
           END-IF.                                                              
                                                                                
           MOVE CC-DATE-CD-CCYY             TO PV-08BYT-CONT-CCYY.              
           MOVE CC-DATE-CD-MM               TO PV-08BYT-CONT-MM  .              
           MOVE CC-DATE-CD-DD               TO PV-08BYT-CONT-DD  .              
                                                                                
           SET DPG51-FISCAL-454-CALENDAR    TO TRUE.                            
           SET DPG52-LK-DTE-ISO             TO TRUE.                            
                                                                                
           MOVE PV-08BYT-CONTROL-DT         TO DPG52-DB2-ISO-DATE.              
                                                                                
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53            
                                                   DPG54 DPG55 DPG56.           
           IF  DPG54-SEVERE-ERROR                                               
               DISPLAY '*********************************'                      
               DISPLAY '** ABEND FROM CALL SUB         **'                      
               DISPLAY '** PROGRAM = TXKRP052          **'                      
               DISPLAY '** DATE = ' CC-DATE-CARD '     **'                      
               DISPLAY '*********************************'                      
               DISPLAY DPG54-ERROR-MESSAGE                                      
               SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                            
               PERFORM 9999-ABEND-PROCESS                                       
           ELSE                                                                 
               IF  DPG54-DATE-INVALID                                           
                    DISPLAY '****************************'                      
                    DISPLAY '** ABEND INVALID END DATE **'                      
                    DISPLAY '** PROGRAM = TXKUT056     **'                      
                    DISPLAY '** DATE = ' CC-DATE-CARD '  **'                    
                    DISPLAY '****************************'                      
                    DISPLAY DPG54-ERROR-MESSAGE                                 
                    SET AC-CONTROL-CARD-ERROR TO TRUE                           
                    PERFORM 9999-ABEND-PROCESS                                  
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE DPG56-FIRST-FP-GREG-CC-YR   TO PV-COMP-START-CCYY.              
           MOVE DPG56-FIRST-FP-GREG-CC-MO   TO PV-COMP-START-MM.                
           MOVE DPG56-FIRST-FP-GREG-CC-DY   TO PV-COMP-START-DD.                
           MOVE DPG56-LAST-FP-GREG-CC-YR    TO PV-COMP-END-CCYY.                
           MOVE DPG56-LAST-FP-GREG-CC-MO    TO PV-COMP-END-MM.                  
           MOVE DPG56-LAST-FP-GREG-CC-DY    TO PV-COMP-END-DD.                  
                                                                                
           MOVE PV-COMP-START-DTE           TO HL3-FROM-DATE.                   
           MOVE PV-COMP-END-DTE             TO HL3-TO-DATE.                     
                                                                                
           DISPLAY 'THE STARTING DATE OF FISCAL MONTH :- '                      
                    PV-COMP-START-DTE.                                          
           DISPLAY 'THE ENDING DATE OF FISCAL MONTH   :- '                      
                    PV-COMP-END-DTE.                                            
                                                                                
      *****************************************************************         
      * 2000-PROCESS-STR-INFO.                                                  
      *                                                                         
      * MAINPROCESS FOR STORE RECORDS.                                          
      *                                                                         
      * PARAGRAPH CALLED FROM :- 0000-MAINLINE-PARAGRAPH                        
      * PARAGRAPH CALLED TO   :- 2100-PRCS-STR-STAT-CHG                         
      *                          2200-PRINT-STR-HEADINGS                        
      *                          2300-GRAND-TOT-STR-PRCS                        
      *                          3200-PRINT-ZIP-HEADINGS                        
      *                          8000-READ-SFS-STR-INPUT                        
      *                          8100-READ-SFS-ZIP-INPUT                        
      *****************************************************************         
                                                                                
       2000-PROCESS-STR-INFO.                                                   
                                                                                
      *    MOVE INPUT FIELDS TO DETAIL RECORD LAYOUT                            
           MOVE PL-STR-NBR                  TO DL-STR-NBR.                      
           MOVE PL-STR-NAME                 TO DL-STR-NAM.                      
           MOVE PL-STR-TAXABLE-AMT          TO DL-STR-TAXABLE-AMT.              
           MOVE PL-STR-TAX-AMT              TO DL-STR-TAX-AMT.                  
                                                                                
           IF PL-STR-STATE-CODE = PV-STR-ST-CDE                                 
               ADD PL-STR-TAXABLE-AMT       TO PV-STR-ST-TAXABLE-AMT            
               ADD PL-STR-TAX-AMT           TO PV-STR-ST-TAX-AMT                
           ELSE                                                                 
               PERFORM 2100-PRCS-STR-STAT-CHG                                   
           END-IF.                                                              
                                                                                
           ADD +1                           TO PV-CO-CNT.                       
           ADD PL-STR-TAXABLE-AMT           TO PV-CO-TAX-AMOUNT.                
           ADD PL-STR-TAX-AMT               TO PV-CO-TAX-AMOUNT-DISC.           
           IF PV-LINE-CNT > PC-LINE-LIMIT                                       
               PERFORM 2200-PRINT-STR-HEADINGS                                  
           END-IF.                                                              
                                                                                
           WRITE SFS-STR-REPORT-REC         FROM DL-DETAIL-STR-LINE.            
                                                                                
           ADD +1                           TO PV-LINE-CNT.                     
           ADD +1                           TO PC-STR-OUT-REC-CNT.              
                                                                                
      *    READ THE NEW STORE INFORMATION FROM THE INPUT FILE                   
           PERFORM 8000-READ-SFS-STR-INPUT.                                     
                                                                                
           IF  PS-END-STR-OF-FILE                                               
      *    PROCESSING FOR GRAND TOTAL RECORD.                                   
               PERFORM 2300-GRAND-TOT-STR-PRCS                                  
                                                                                
      *    ZIP CODE FILE PROCESSING IS STARTED.                                 
               PERFORM 8100-READ-SFS-ZIP-INPUT                                  
               IF  PS-END-ZIP-OF-FILE                                           
                   MOVE '2000-PROCESS-STR-INFO'                                 
                                            TO PV-PARAGRAPH-NAME                
                   MOVE ' SFS ZIP CODE INPUT FILE IS EMPTY '                    
                                            TO PV-OPERATION-MSG-1               
                   PERFORM 9999-ABEND-PROCESS                                   
               ELSE                                                             
                   MOVE PL-ZIP-STATE-CODE   TO PV-ZIP-ST-CDE                    
                                               DL-ZIP-STATE                     
               END-IF                                                           
      *    INITITALIZING WORKING STORAGE COUNTERS AND AMOUNT FIELDS.            
               MOVE ZERO                    TO PV-LINE-CNT                      
                                               PV-PAGE-CNT                      
               MOVE ZERO                    TO PV-CO-TAX-AMOUNT                 
                                               PV-CO-TAX-AMOUNT-DISC            
      *    KOHLS HEADER RECORD IS PRINTED                                       
               PERFORM 3200-PRINT-ZIP-HEADINGS                                  
           END-IF.                                                              
                                                                                
      *****************************************************************         
      * 2100-PRCS-STR-STAT-CHG.                                                 
      *                                                                         
      * WRITE THE STATE RECORD INTO REPORT ALONG WITH THE INITIALIZING          
      * AND POPULATING THE NEW STATE REC VALUES TO WORKING STORAGE.             
      *                                                                         
      * PARAGRAPH CALLED FROM :- 2000-PROCESS-STR-INFO                          
      * PARAGRAPH CALLED TO   :- 2200-PRINT-STR-HEADINGS                        
      *****************************************************************         
       2100-PRCS-STR-STAT-CHG.                                                  
                                                                                
             INITIALIZE TL-TOTAL-LINE.                                          
             MOVE PV-STR-ST-TAXABLE-AMT     TO TL-TAXABLE-AMOUNT.               
             MOVE PV-STR-ST-TAX-AMT         TO TL-TAX-AMOUNT.                   
             MOVE 'STATE TOTALS FOR '       TO TL-TOTAL-TYPE.                   
             MOVE DL-STR-STATE              TO TL-STATE-CDE.                    
             MOVE PL-STR-STATE-CODE         TO PV-STR-ST-CDE.                   
             MOVE PL-STR-TAXABLE-AMT        TO PV-STR-ST-TAXABLE-AMT.           
             MOVE PL-STR-TAX-AMT            TO PV-STR-ST-TAX-AMT.               
                                                                                
             IF PV-LINE-CNT > PC-LINE-LIMIT                                     
                 PERFORM 2200-PRINT-STR-HEADINGS                                
             END-IF.                                                            
                                                                                
             WRITE SFS-STR-REPORT-REC       FROM TL-TOTAL-LINE.                 
             ADD +1                         TO PC-STR-STATE-REC-CNT.            
             MOVE SPACES                    TO SFS-STR-REPORT-REC.              
             WRITE SFS-STR-REPORT-REC.                                          
             ADD +4                         TO PV-LINE-CNT.                     
                                                                                
             MOVE PL-STR-STATE-CODE         TO DL-STR-STATE.                    
                                                                                
             IF PV-LINE-CNT > PC-LINE-LIMIT                                     
                 PERFORM 2200-PRINT-STR-HEADINGS                                
             END-IF.                                                            
                                                                                
      *****************************************************************         
      * 2200-PRINT-STR-HEADINGS.                                                
      *                                                                         
      * WRITE THE STATE RECORD INTO REPORT ALONG WITH THE INITIALIZING          
      * AND POPULATING THE NEW STATE REC VALUES TO WORKING STORAGE.             
      *                                                                         
      * PARAGRAPH CALLED FROM :- 2000-PROCESS-STR-INFO                          
      *                          2100-PRCS-STR-STAT-CHG                         
      * PARAGRAPH CALLED TO   :- NIL                                            
      *****************************************************************         
       2200-PRINT-STR-HEADINGS.                                                 
                                                                                
           ADD +1                   TO PV-PAGE-CNT.                             
           MOVE PV-PAGE-CNT         TO DP132-PAGE-NUMBER.                       
           WRITE SFS-STR-REPORT-REC FROM DP132-STANDRD-HEADER-132-COLS          
               AFTER ADVANCING PAGE.                                            
                                                                                
           WRITE SFS-STR-REPORT-REC FROM HL-HEADING-STR-LINE-2                  
               AFTER ADVANCING 1.                                               
           WRITE SFS-STR-REPORT-REC FROM HL-HEADING-LINE-3.                     
                                                                                
           WRITE SFS-STR-REPORT-REC FROM HL-HEADING-STR-LN-5                    
               AFTER ADVANCING 2.                                               
           WRITE SFS-STR-REPORT-REC FROM HL-HEADING-STR-LN-6.                   
           WRITE SFS-STR-REPORT-REC FROM HL-HEADING-STR-LN-7.                   
                                                                                
           MOVE +9                  TO PV-LINE-CNT.                             
                                                                                
      *****************************************************************         
      * 2300-GRAND-TOT-STR-PRCS.                                                
      *                                                                         
      * WRITE THE COMPANY REC INTO REPORT ALONG WITH THE INITIALIZING           
      * AND POPULATING THE NEW STATE REC VALUES TO WORKING STORAGE.             
      *                                                                         
      * PARAGRAPH CALLED FROM :- 2000-PROCESS-STR-INFO                          
      * PARAGRAPH CALLED TO   :- 2200-PRINT-STR-HEADINGS                        
      *****************************************************************         
       2300-GRAND-TOT-STR-PRCS.                                                 
                                                                                
           INITIALIZE TL-TOTAL-LINE                                             
           MOVE PV-STR-ST-TAXABLE-AMT       TO TL-TAXABLE-AMOUNT.               
           MOVE PV-STR-ST-TAX-AMT           TO TL-TAX-AMOUNT.                   
           MOVE 'STATE TOTALS FOR '         TO TL-TOTAL-TYPE.                   
           MOVE DL-STR-STATE                TO TL-STATE-CDE                     
           MOVE PL-STR-STATE-CODE           TO PV-STR-ST-CDE.                   
                                                                                
           IF PV-LINE-CNT > PC-LINE-LIMIT                                       
               PERFORM 2200-PRINT-STR-HEADINGS                                  
           END-IF.                                                              
                                                                                
           WRITE SFS-STR-REPORT-REC         FROM TL-TOTAL-LINE                  
           AFTER ADVANCING 2.                                                   
           ADD +1                           TO PC-STR-STATE-REC-CNT.            
           ADD +2                           TO PV-LINE-CNT.                     
                                                                                
           INITIALIZE TL-TOTAL-LINE                                             
           MOVE SPACE                       TO TL-STATE-CDE                     
           MOVE PV-CO-TAX-AMOUNT            TO TL-TAXABLE-AMOUNT.               
           MOVE PV-CO-TAX-AMOUNT-DISC       TO TL-TAX-AMOUNT.                   
           MOVE 'COMPANY TOTALS'            TO TL-TOTAL-TYPE.                   
                                                                                
           IF PV-LINE-CNT > PC-LINE-LIMIT                                       
               PERFORM 2200-PRINT-STR-HEADINGS                                  
           END-IF.                                                              
                                                                                
           WRITE SFS-STR-REPORT-REC         FROM TL-TOTAL-LINE                  
           AFTER ADVANCING 2.                                                   
           ADD +2                           TO PV-LINE-CNT.                     
                                                                                
      *****************************************************************         
      * 3000-PROCESS-ZIP-INFO.                                                  
      *                                                                         
      * MAINPROCESS FOR STORE RECORDS.                                          
      *                                                                         
      * PARAGRAPH CALLED FROM :- 0000-MAINLINE-PARAGRAPH                        
      * PARAGRAPH CALLED TO   :- 3100-PRCS-ZIP-STAT-CHG                         
      *                          3200-PRINT-ZIP-HEADINGS                        
      *                          3300-GRAND-TOT-ZIP-PRCS                        
      *                          8100-READ-SFS-ZIP-INPUT                        
      *****************************************************************         
       3000-PROCESS-ZIP-INFO.                                                   
                                                                                
                                                                                
      *    MOVE INPUT FIELDS TO REPORT RECORD                                   
           MOVE PL-ZIP-CD                   TO DL-ZIP-CDE.                      
           MOVE PL-ZIP-TAXABLE-AMT          TO DL-ZIP-TAXABLE-AMT.              
           MOVE PL-ZIP-TAX-AMT              TO DL-ZIP-TAX-AMT.                  
                                                                                
           IF PL-ZIP-STATE-CODE = PV-ZIP-ST-CDE                                 
               ADD PL-ZIP-TAXABLE-AMT       TO  PV-ZIP-TAXABLE-AMT              
               ADD PL-ZIP-TAX-AMT           TO  PV-ZIP-TAX-AMT                  
           ELSE                                                                 
               PERFORM 3100-PRCS-ZIP-STAT-CHG                                   
           END-IF.                                                              
                                                                                
           ADD +1                           TO PV-CO-CNT.                       
           ADD PL-ZIP-TAXABLE-AMT           TO PV-CO-TAX-AMOUNT.                
           ADD PL-ZIP-TAX-AMT               TO PV-CO-TAX-AMOUNT-DISC.           
                                                                                
           IF PV-LINE-CNT > PC-LINE-LIMIT                                       
               PERFORM 3200-PRINT-ZIP-HEADINGS                                  
           END-IF.                                                              
                                                                                
           WRITE SFS-ZIP-REPORT-REC          FROM DL-DETAIL-ZIP-LINE.           
                                                                                
           ADD +1                           TO PC-ZIP-OUT-REC-CNT.              
           ADD +1                           TO PV-LINE-CNT.                     
                                                                                
           PERFORM 8100-READ-SFS-ZIP-INPUT.                                     
                                                                                
           IF PS-END-ZIP-OF-FILE                                                
               PERFORM 3300-GRAND-TOT-ZIP-PRCS                                  
           END-IF.                                                              
                                                                                
      *****************************************************************         
      * 3100-PRCS-ZIP-STAT-CHG.                                                 
      *                                                                         
      * WRITE THE STATE RECORD INTO REPORT ALONG WITH THE INITIALIZING          
      * AND POPULATING THE NEW STATE REC VALUES TO WORKING STORAGE.             
      *                                                                         
      * PARAGRAPH CALLED FROM :- 3000-PROCESS-ZIP-INFO                          
      * PARAGRAPH CALLED TO   :- 3200-PRINT-ZIP-HEADINGS                        
      *****************************************************************         
       3100-PRCS-ZIP-STAT-CHG.                                                  
                                                                                
             INITIALIZE TL-TOTAL-LINE                                           
             MOVE PV-ZIP-TAXABLE-AMT        TO TL-TAXABLE-AMOUNT                
             MOVE PV-ZIP-TAX-AMT            TO TL-TAX-AMOUNT                    
             MOVE 'STATE TOTALS FOR '       TO TL-TOTAL-TYPE                    
             MOVE DL-ZIP-STATE              TO TL-STATE-CDE                     
             MOVE PL-ZIP-STATE-CODE         TO PV-ZIP-ST-CDE                    
             MOVE PL-ZIP-TAXABLE-AMT        TO PV-ZIP-TAXABLE-AMT               
             MOVE PL-ZIP-TAX-AMT            TO PV-ZIP-TAX-AMT                   
                                                                                
             IF PV-LINE-CNT > PC-LINE-LIMIT                                     
                 PERFORM 3200-PRINT-ZIP-HEADINGS                                
             END-IF                                                             
                                                                                
             WRITE SFS-ZIP-REPORT-REC       FROM TL-TOTAL-LINE.                 
             ADD +1                         TO PC-ZIP-STATE-REC-CNT.            
             MOVE SPACES                    TO SFS-ZIP-REPORT-REC               
             WRITE SFS-ZIP-REPORT-REC.                                          
             ADD +4                         TO PV-LINE-CNT                      
                                                                                
             MOVE PL-ZIP-STATE-CODE         TO DL-ZIP-STATE                     
                                                                                
             IF PV-LINE-CNT > PC-LINE-LIMIT                                     
                 PERFORM 3200-PRINT-ZIP-HEADINGS                                
             END-IF.                                                            
                                                                                
      *****************************************************************         
      * 3200-PRINT-ZIP-HEADINGS.                                                
      *                                                                         
      * WRITE THE STATE RECORD INTO REPORT ALONG WITH THE INITIALIZING          
      * AND POPULATING THE NEW STATE REC VALUES TO WORKING STORAGE.             
      *                                                                         
      * PARAGRAPH CALLED FROM :- 3000-PROCESS-ZIP-INFO                          
      *                          3100-PRCS-ZIP-STAT-CHG                         
      * PARAGRAPH CALLED TO   :- NIL                                            
      *****************************************************************         
       3200-PRINT-ZIP-HEADINGS.                                                 
                                                                                
           ADD +1                   TO PV-PAGE-CNT.                             
           MOVE PV-PAGE-CNT         TO DP132-PAGE-NUMBER.                       
           WRITE SFS-ZIP-REPORT-REC FROM DP132-STANDRD-HEADER-132-COLS          
               AFTER ADVANCING PAGE.                                            
                                                                                
           WRITE SFS-ZIP-REPORT-REC FROM HL-HEADING-ZIP-LINE-2                  
               AFTER ADVANCING  1.                                              
           WRITE SFS-ZIP-REPORT-REC FROM HL-HEADING-LINE-3.                     
                                                                                
           WRITE SFS-ZIP-REPORT-REC FROM HL-HEADING-ZIP-LN-5                    
               AFTER ADVANCING 2.                                               
           WRITE SFS-ZIP-REPORT-REC FROM HL-HEADING-ZIP-LN-6.                   
           WRITE SFS-ZIP-REPORT-REC FROM HL-HEADING-ZIP-LN-7.                   
                                                                                
           MOVE +9                  TO PV-LINE-CNT.                             
                                                                                
      *****************************************************************         
      * 3300-GRAND-TOT-ZIP-PRCS.                                                
      *                                                                         
      * WRITE THE COMPANY REC INTO REPORT ALONG WITH THE INITIALIZING           
      * AND POPULATING THE NEW STATE REC VALUES TO WORKING STORAGE.             
      *                                                                         
      * PARAGRAPH CALLED FROM :- 3000-PROCESS-ZIP-INFO                          
      * PARAGRAPH CALLED TO   :- 3200-PRINT-ZIP-HEADINGS                        
      *****************************************************************         
       3300-GRAND-TOT-ZIP-PRCS.                                                 
                                                                                
           INITIALIZE TL-TOTAL-LINE                                             
           MOVE PV-ZIP-TAXABLE-AMT         TO TL-TAXABLE-AMOUNT.                
           MOVE PV-ZIP-TAX-AMT             TO TL-TAX-AMOUNT.                    
           MOVE 'STATE TOTALS FOR '        TO TL-TOTAL-TYPE.                    
           MOVE DL-ZIP-STATE               TO TL-STATE-CDE.                     
           MOVE PL-ZIP-STATE-CODE          TO PV-ZIP-ST-CDE.                    
                                                                                
           IF PV-LINE-CNT > PC-LINE-LIMIT                                       
               PERFORM 3200-PRINT-ZIP-HEADINGS                                  
           END-IF.                                                              
                                                                                
           WRITE SFS-ZIP-REPORT-REC        FROM TL-TOTAL-LINE                   
               AFTER ADVANCING 2.                                               
           ADD +1                          TO PC-ZIP-STATE-REC-CNT.             
           ADD +2                          TO PV-LINE-CNT.                      
                                                                                
           INITIALIZE TL-TOTAL-LINE                                             
           MOVE PV-CO-TAX-AMOUNT           TO TL-TAXABLE-AMOUNT.                
           MOVE PV-CO-TAX-AMOUNT-DISC      TO TL-TAX-AMOUNT.                    
           MOVE SPACE                      TO TL-STATE-CDE.                     
           MOVE 'COMPANY TOTALS'           TO TL-TOTAL-TYPE.                    
                                                                                
           IF PV-LINE-CNT > PC-LINE-LIMIT                                       
               PERFORM 3200-PRINT-ZIP-HEADINGS                                  
           END-IF.                                                              
                                                                                
           WRITE SFS-ZIP-REPORT-REC        FROM TL-TOTAL-LINE                   
               AFTER ADVANCING 2.                                               
           ADD +2                          TO PV-LINE-CNT.                      
                                                                                
                                                                                
      *---------------------------------------------------------------*         
      *            -- END-OF-JOB PROCESSING                           *         
      *---------------------------------------------------------------*         
       9000-END-OF-JOB.                                                         
                                                                                
           MOVE PC-STR-INPUT-REC-CNT        TO PC-STR-IN-DIS                    
           MOVE PC-ZIP-INPUT-REC-CNT        TO PC-ZIP-IN-DIS                    
           MOVE PC-STR-OUT-REC-CNT          TO PC-STR-OUT-DIS                   
           MOVE PC-ZIP-OUT-REC-CNT          TO PC-ZIP-OUT-DIS                   
           MOVE PC-STR-STATE-REC-CNT        TO PC-STR-STT-DIS                   
           MOVE PC-ZIP-STATE-REC-CNT        TO PC-ZIP-STT-DIS                   
           DISPLAY '**************************************************'         
           DISPLAY '**                 RUN SUMMARY                  **'         
           DISPLAY '**              PROGRAM = TXKRP056              **'         
           DISPLAY '** DATE = ' CC-DATE-CARD '                      **'         
           DISPLAY '**************************************************'         
           DISPLAY '                                 '                          
           DISPLAY 'NO. OF STORE INPUT REC PROCESSED = ' PC-STR-IN-DIS          
           DISPLAY 'NO. OF STORE DETAIL REC WRITTEN  = ' PC-STR-OUT-DIS         
           DISPLAY 'NO. OF STATE IN STORE REPORT     = ' PC-STR-STT-DIS         
           DISPLAY '                                 '                          
           DISPLAY 'NO. OF ZIP CD INPUT REC PROCESSED= ' PC-ZIP-IN-DIS          
           DISPLAY 'NO. OF ZIP CD DETAIL REC WRITTEN = ' PC-ZIP-OUT-DIS         
           DISPLAY 'NO. OF STATE IN STORE REPORT     = ' PC-ZIP-STT-DIS         
           CLOSE SFS-STR-INPUT                                                  
                 SFS-ZIP-INPUT                                                  
                 POS-DATE-CARD-FILE                                             
                 SFS-STR-REPORT                                                 
                 SFS-ZIP-REPORT.                                                
                                                                                
      ******************************************************************        
      *     READ INPUT STORE FILE                                               
      * PARAGRAPH CALLED FROM :- 1000-INITIALIZE                                
      *                       :- 2000-PRCSS-STR-INFO                            
      * PARAGRAPH CALLED TO   :- NIL                                            
      ******************************************************************        
       8000-READ-SFS-STR-INPUT.                                                 
                                                                                
           READ SFS-STR-INPUT               INTO PL-OUTSTR-SFS-REC              
               AT END                                                           
                  SET PS-END-STR-OF-FILE      TO TRUE                           
               NOT AT END                                                       
                  SET PS-NOT-END-STR-OF-FILE  TO TRUE                           
                  ADD 1                       TO PC-STR-INPUT-REC-CNT           
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *     READ INPUT ZIP CODE FILE                                            
      * PARAGRAPH CALLED FROM :- 1000-INITIALIZE                                
      *                       :- 2000-PRCSS-STR-INFO                            
      * PARAGRAPH CALLED TO   :- NIL                                            
      ******************************************************************        
      *---------------------------------------------------------------*         
      *            -- READ EXTRACT FILE                               *         
      *---------------------------------------------------------------*         
       8100-READ-SFS-ZIP-INPUT.                                                 
                                                                                
           READ SFS-ZIP-INPUT               INTO PL-OUTZIP-SFS-REC              
               AT END                                                           
                  SET PS-END-ZIP-OF-FILE    TO TRUE                             
               NOT AT END                                                       
                  SET PS-NOT-END-ZIP-OF-FILE  TO TRUE                           
                  ADD 1                       TO PC-ZIP-INPUT-REC-CNT           
           END-READ.                                                            
                                                                                
      ******************************************************************        
      * 9999-ABEND-PROCESS - PERFORMS A NON-SQL-ABEND                           
      ******************************************************************        
       9999-ABEND-PROCESS.                                                      
           DISPLAY '** ABEND           **'.                                     
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.                  
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.                
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.               
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.               
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
                                                                                
