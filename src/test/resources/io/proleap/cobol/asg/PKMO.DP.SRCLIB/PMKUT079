      ******************************************************************00010000
       IDENTIFICATION DIVISION.                                         00020000
       PROGRAM-ID.             PMKUT079.                                00030000
       AUTHOR.                 AMANDA NEWHART                           00040000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
       DATE-WRITTEN.           FEBRUARY 2003.                           00060000
       DATE-COMPILED.                                                   00070000
      ******************************************************************00080000
      *                                                                *00090000
      *    PMKUT079 - PRICING STORE GROUP BUSINESS EVENT               *00100000
      *               INTEGRITY CHECK.                                 *00110000
      *                                                                *00120000
      *    - CURRENTLY CHECK TEN DIFFERENT AREAS FOR STORE GROUP       *00130000
      *      PRICING (ADMINTIERED, ADMINTIERED-OVRRID, CLRNC, CMPTV,   *00140000
      *      GRP, GRP-OVRRID, PROMOTIERED, PROMOTIERED-OVRRID,         *00150000
      *      SIMPLENOTNULL, SIMPLENOTNULL-OVRRID).  A FUTURE CHANGE    *00160000
      *      WOULD BE TO ADD FOUR MORE (ADDLAMTOFF, ADDLAMTOFF-OVRRID, *00170000
      *      BWP, BWP-OVRRID).                                         *00180000
      *                                                                *00190000
      *      THIS PROGRAM CREATES THE PRICING STORE GROUP BUSINESS     *00200000
      *      FILE USED IN THE DATA INTEGRITY PROCESS.  FIRST OPEN      *00210000
      *      TWO INPUT FILES AND ONE OUTPUT FILE.  IF WHEN THE TWO     *00220000
      *      INPUT FILES ARE READ AND NOTHING IS IN EITHER OF THESE    *00230000
      *      FILES ABEND THE PROGRAM OTHERWISE, LOG ON TO ORACLE. IF   *00240000
      *      SUCCESSFUL THEN FIND THE CURRENT SYSDATE USING A SELECT   *00250000
      *      STATEMENT.  NEXT SELECT THE CLEARANCE RECORDS FROM THE    *00260000
      *      PMV_STR_GP_CLRNC TABLE THAT FALL WITHIN THE DATE RANGE    *00270000
      *      FROM THE DATE RANGE FILE.  IF THE LAST UPDATED TIMESTAMP  *00280000
      *      IS LESS THEN THE TIMSTAMP FILE THEN MOVE THE RECORD TO    *00290000
      *      THE COPYBOOK AND THEN WRITE THE COPYBOOK TO THE OUTPUT    *00300000
      *      FILE.  WHEN THE LAST CLEARANCE RECORD IS FOUND RUN THE AD *00310000
      *      EVENT CURSOR.  THIS WILL FIND ALL THE AD EVENT DATES      *00320000
      *      THAT ARE WITHIN THE DATE RANGE FROM THE DATE RANGE FILE.  *00330000
      *      AS LONG AS THE AD EVENT DATE RANGE IS WITHIN THE FILE     *00340000
      *      DATE RANGE USE THESE NEW DATES AS THE DATE RANGE.         *00350000
      *      ALTHOUGH WHICHEVER DATES ARE USED CONCATINATE A TIMESTAMP *00360000
      *      TO THE END.  THEN SELECT THE ADMIN RECORD FROM THE        *00370000
      *      PMV_STR_GP_ADM_TIER VIEW THAT FALLS WITHIN THE DATE       *00380000
      *      RANGE.  IF THE LAST UPDATE TIMESTAMP IS LESS THEN THE     *00390000
      *      TIMESTAMP FILE THEN MOVE THE SELECTED VARIABLES TO THE    *00400000
      *      COPYBOOK.  AFTER THEY HAVE BEEN MOVED WRITE THE COPYBOOK  *00410000
      *      TO THE OUTPUT FILE.  THEN DO THE SAME THING FOR           *00420000
      *      PMV_STR_GP_ADM_TIER_OVRD, PMV_STR_GP_CMPTV_PRICG,         *00430000
      *      PMV_STR_GP_GP_PRICG, PMV_STR_GP_GP_PRICG_OVRD,            *00440000
      *      PMV_STR_GP_PROMO_ITM_LVL_TIER,                            *00450000
      *      PMV_STR_GP_PROMO_ITM_TIER_OVRD,                           *00460000
      *      PMV_STR_GP_SIMP_PRICG_NOT_NULL,                           *00470000
      *      PMV_STR_GP_SIMP_NOT_NULL_OVRD.  ALTHOUGH WITH             *00480000
      *      PMV_STR_GP_GP_PRICG, PMV_STR_GP_PROMO_ITM_LVL_TIER, AND   *00490000
      *      PMV_STR_GP_SIMP_PRICG_NOT_NULL IF THE ADV_IND IS Y FIND   *00500000
      *      THE PRICE VERSION FOR THE SPECIFIC PROMO AND STORE.  WHEN *00510000
      *      THE LAST SELECT STATEMENT HAS BEEN PROCESSED FETCH THE    *00520000
      *      NEXT DATE RANGE FROM THE AD EVENT CURSOR AND REPEAT THE   *00530000
      *      PROCESS UNTIL THE LAST DATE HAS BEEN RUN.  AFTER THE LAST *00540000
      *      RECORD HAS BEEN WRITTEN TO THE OUTPUT FILE WRITE A TOTAL  *00550000
      *      LINE TO THE FILE.  FINALLY CLOSE THE TWO INPUT FILES AND  *00560000
      *      AND ONE OUTPUT FILE.  AFTER THE LAST RECORD WAS WRITTEN   *00570000
      *      TO THE FILE WRITE A TOTAL LINE TO THE FILE.  FINALLY      *00580000
      *      CLOSE THE TWO INPUT FILES AND THE ONE OUTPUT FILE.        *00590000
      *                                                                *00600000
      ******************************************************************00610000
      **   CHANGE LOG:                                                 *00620000
      ******************************************************************00630000
      *    08/07/2003 - AMANDA NEWHART      WR21770                    *00640000
      *     - ADDED TIME DISPLAYS BEFORE AND AFTER THE OPEN AND FETCH  *00650000
      *       OF A CURSOR.                                             *00660000
      *                                                                *00670000
      *    08/11/2003 - COLLEEN CUMMINGS    WR21770                    *00680000
      *     - CHANGED PROMO-CSR, GRP-CSR, AND SIMP-CSR TO NOT CALL     *00690000
      *       C110- (DELETED ENTIRE PARAGRAPH) - AND TO INSTEAD        *00700000
      *       DO A VIRTUAL TABLE JOIN TO GET THE PRIC-VER-ID - WAS     *00710000
      *       TAKING TOO LONG TO DO AN EXTRA SQL CALL FOR EACH ROW.    *00720000
      *                                                                *00730000
      *    08/12/2003 - COLLEEN CUMMINGS    WR21770                    *00740000
      *     - FORGOT TO FETCH THE PRIC-VER-ID IN THE GRP-CSR - OOPS.   *00750000
      *                                                                *00760000
      *    01/07/2004 - AMANDA NEWHART      P000616675                 *00770000
      *     - REMOVED THE GROUP AND SIMPLE CURSOR FROM PROGRAM AND     *00780000
      *       MOVED THEM TO THE PROC.  ADDED AN ALTER SESSION, C110.   *00781000
      *       DEFAULT THE BUSINESS EVENT CREATE TMST TO 0.             *00782000
      *                                                                *00800000
      *    01/08/2004 - AMANDA NEWHART      P000616675                 *00801000
      *     - MOVE UP SAME PROGRAM WITH LAST MOVE.  THIS MOVE HAS THE  *00802000
      *       ABOVE CHANGE.                                            *00803000
      *                                                                *00805000
      *    07/30/2018 - COGNIZANT           CHG0204126                 *00806002
      *     - ORACLE LOGON STANDARDS PROGRAM CHANGE                    *00806102
      ******************************************************************00810000
      ******************************************************************00820000
       ENVIRONMENT DIVISION.                                            00830000
       CONFIGURATION SECTION.                                           00840000
       SOURCE-COMPUTER. IBM-3090.                                       00850000
       OBJECT-COMPUTER. IBM-3090.                                       00860000
                                                                        00870000
       INPUT-OUTPUT SECTION.                                            00880000
       FILE-CONTROL.                                                    00890000
                                                                        00900000
           SELECT DATE-RANGE-FILE                                       00910000
               ASSIGN                       TO INP01.                   00920000
                                                                        00930000
           SELECT TMST-FILE                                             00940000
               ASSIGN                       TO INP02.                   00950000
                                                                        00960000
           SELECT PRCG-STORE-GP-FILE                                    00970000
               ASSIGN                       TO OUT01.                   00980000
                                                                        00990000
           SELECT ORACLE-LOGON-FILE                                     00990100
               ASSIGN                       TO ORALOGON.                00990200
                                                                        00991000
       DATA DIVISION.                                                   01000000
                                                                        01010000
       FILE SECTION.                                                    01020000
                                                                        01030000
       FD  DATE-RANGE-FILE                                              01040000
           RECORDING MODE F                                             01050000
           BLOCK CONTAINS 0 RECORDS                                     01060000
           LABEL RECORDS ARE OMITTED.                                   01070000
       01  DATE-RANGE-LINE                  PIC  X(80).                 01080000
                                                                        01090000
       FD  TMST-FILE                                                    01100000
           RECORDING MODE F                                             01110000
           BLOCK CONTAINS 0 RECORDS                                     01120000
           LABEL RECORDS ARE OMITTED.                                   01130000
       01  TMST-LINE                        PIC  X(80).                 01140000
                                                                        01150000
       FD  PRCG-STORE-GP-FILE                                           01160000
           RECORDING MODE F                                             01170000
           BLOCK CONTAINS 0 RECORDS                                     01180000
           LABEL RECORDS ARE OMITTED.                                   01190000
       01  PRCG-STORE-GP-LINE               PIC X(275).                 01200000
                                                                        01210000
       FD  ORACLE-LOGON-FILE                                            01210100
           RECORDING MODE IS F                                          01210200
           LABEL RECORDS ARE STANDARD                                   01210300
           BLOCK CONTAINS 0 RECORDS                                     01210400
           RECORD CONTAINS 80 CHARACTERS                                01210500
           DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      01210600
       01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       01210700
                                                                        01211000
       WORKING-STORAGE SECTION.                                         01220000
                                                                        01230000
       01  ABEND-CODE                       PIC S9(04)   COMP VALUE +0. 01240000
           88  ABEND-4001-WRITE-ERROR                    VALUE +4001.   01250000
           88  ABEND-4002-READ-ERROR                     VALUE +4002.   01260000
           88  ABEND-4003-CTRL-CARD-ERROR                VALUE +4003.   01270000
           88  ABEND-4004-TABLE-ERROR                    VALUE +4004.   01280000
           88  ABEND-4005-OPEN-ERROR                     VALUE +4005.   01290000
           88  ABEND-4006-CLOSE-ERROR                    VALUE +4006.   01300000
           88  ABEND-4007-SEQUENCE-ERROR                 VALUE +4007.   01310000
           88  ABEND-4008-DATA-ERROR                     VALUE +4008.   01320000
           88  ABEND-4009-KEY-DATA-ERROR                 VALUE +4009.   01330000
           88  ABEND-4013-DB2-ERROR                      VALUE +4013.   01340000
           88  ABEND-4014-ORACLE-LOGON-ERROR             VALUE +4014.   01350000
           88  ABEND-4019-DATE-ROUTINE-ERROR             VALUE +4019.   01360000
           88  ABEND-4444-FORCED-ABEND                   VALUE +4444.   01370000
                                                                        01380000
       01  CC-DATE-RANGE-FILE.                                          01390000
           05  CC-START-DATE                PIC X(10).                  01400000
           05  FILLER                       PIC X(01).                  01410000
           05  CC-END-DATE                  PIC X(10).                  01420000
                                                                        01430000
       01  CC-TMST-FILE.                                                01440000
           05  CC-LAST-UPD-TMST             PIC X(19).                  01450000
                                                                        01460000
       01  PS-PROGRAM-SWITCHES.                                         01470000
006510     05  PS-END-OF-LOGON-FILE-SW      PIC  X(01)  VALUE 'N'.      01471000
006530         88  PS-END-OF-LOGON-FILE                 VALUE 'Y'.      01472000
           05  PS-ORA-SRC-CTL-DONE-SW       PIC  X(01)  VALUE 'N'.      01473000
               88  PS-ORA-SRC-EMPTY                     VALUE 'Y'.      01474000
           05  PS-DATE-RANGE-FILE-SW        PIC  X(01)  VALUE 'N'.      01480000
               88  PS-DATE-RANGE-FILE-END               VALUE 'Y'.      01490000
               88  PS-DATE-RANGE-FILE-START             VALUE 'N'.      01500000
           05  PS-TMST-FILE-SW              PIC  X(01)  VALUE 'N'.      01510000
               88  PS-TMST-FILE-END                     VALUE 'Y'.      01520000
               88  PS-TMST-FILE-START                   VALUE 'N'.      01530000
           05  PS-END-OF-SPLIT-DTE-SWITCH    PIC X(1)   VALUE 'N'.      01540000
               88  PS-END-OF-SPLIT-DTE                  VALUE 'Y'.      01550000
               88  PS-NOT-END-OF-SPLIT-DTE              VALUE 'N'.      01560000
           05  PS-TYPE                       PIC X(01).                 01570000
               88  PS-ADMIN-TYP                         VALUE 'A'.      01580000
               88  PS-ADMINOVR-TYP                      VALUE 'D'.      01590000
               88  PS-CLRNC-TYP                         VALUE 'C'.      01600000
               88  PS-CMPTV-TYP                         VALUE 'M'.      01610000
               88  PS-GRP-TYP                           VALUE 'G'.      01620000
               88  PS-GRPOVR-TYP                        VALUE 'R'.      01630000
               88  PS-PROMO-TYP                         VALUE 'P'.      01640000
               88  PS-PROMOOVR-TYP                      VALUE 'O'.      01650000
               88  PS-SIMP-TYP                          VALUE 'S'.      01660000
               88  PS-SIMPOVR-TYP                       VALUE 'I'.      01670000
                                                                        01671000
       01  CC-ORACLE-CONNECTION.                                        01672000
           05  CC-ORACLE-USERID           PIC X(40).                    01673000
               88 CC-AUTO-LOGON                       VALUE '/'.        01674000
           05  CC-ORACLE-PASSWORD         PIC X(40).                    01675000
                                                                        01680000
       01  PS-CSR-PROGRAM-SWITCHES.                                     01690000
           05  PS-END-OF-ADMIN-CSR-SWITCH    PIC X(1)   VALUE 'N'.      01700000
               88  PS-END-OF-ADMIN-CSR                  VALUE 'Y'.      01710000
               88  PS-NOT-END-OF-ADMIN-CSR              VALUE 'N'.      01720000
           05  PS-END-OF-ADMINOVR-CSR-SWITCH PIC X(1)   VALUE 'N'.      01730000
               88  PS-END-OF-ADMINOVR-CSR               VALUE 'Y'.      01740000
               88  PS-NOT-END-OF-ADMINOVR-CSR           VALUE 'N'.      01750000
           05  PS-END-OF-CLRNC-CSR-SWITCH    PIC X(1)   VALUE 'N'.      01760000
               88  PS-END-OF-CLRNC-CSR                  VALUE 'Y'.      01770000
               88  PS-NOT-END-OF-CLRNC-CSR              VALUE 'N'.      01780000
           05  PS-END-OF-CMPTV-CSR-SWITCH    PIC X(1)   VALUE 'N'.      01790000
               88  PS-END-OF-CMPTV-CSR                  VALUE 'Y'.      01800000
               88  PS-NOT-END-OF-CMPTV-CSR              VALUE 'N'.      01810000
           05  PS-END-OF-GRPOVR-CSR-SWITCH   PIC X(1)   VALUE 'N'.      01850000
               88  PS-END-OF-GRPOVR-CSR                 VALUE 'Y'.      01860000
               88  PS-NOT-END-OF-GRPOVR-CSR             VALUE 'N'.      01870000
           05  PS-END-OF-PROMO-CSR-SWITCH    PIC X(1)   VALUE 'N'.      01880000
               88  PS-END-OF-PROMO-CSR                  VALUE 'Y'.      01890000
               88  PS-NOT-END-OF-PROMO-CSR              VALUE 'N'.      01900000
           05  PS-END-OF-PROMOOVR-CSR-SWITCH PIC X(1)   VALUE 'N'.      01910000
               88  PS-END-OF-PROMOOVR-CSR               VALUE 'Y'.      01920000
               88  PS-NOT-END-OF-PROMOOVR-CSR           VALUE 'N'.      01930000
           05  PS-END-OF-SIMPOVR-CSR-SWITCH  PIC X(1)   VALUE 'N'.      01970000
               88  PS-END-OF-SIMPOVR-CSR                VALUE 'Y'.      01980000
               88  PS-NOT-END-OF-SIMPOVR-CSR            VALUE 'N'.      01990000
           05  PS-END-OF-ADEVNT-DTE-CSR-SW   PIC X(1)   VALUE 'N'.      02000000
               88  PS-END-OF-ADEVNT-DTE-CSR             VALUE 'Y'.      02010000
               88  PS-NOT-END-OF-ADEVNT-DTE-CSR         VALUE 'N'.      02020000
                                                                        02030000
       01  PC-PROGRAM-CONSTANTS.                                        02040000
           05  PC-AUTO-LOGON                PIC  X(01)  VALUE '/'.      02041000
           05  PC-PROGRAM-NAME              PIC  X(08)  VALUE           02050000
                                                           'PMKUT079'.  02060000
           05  PC-BUSINESS-EVNT-ID          PIC  9(03)  VALUE 120.      02070000
           05  PC-ACTION-CDE                PIC  X(01)  VALUE 'U'.      02080000
           05  PC-THREE                     PIC  9(02)  VALUE 03.       02090000
           05  PC-DASH                      PIC  X(01)  VALUE '-'.      02100000
           05  PC-SPACE                     PIC  X(01)  VALUE ' '.      02110000
           05  PC-BEG-TMST                  PIC  X(08)  VALUE           02120000
                                                          '00:00:00'.   02130000
           05  PC-END-TMST                  PIC  X(08)  VALUE           02140000
                                                          '23:59:59'.   02150000
                                                                        02160000
       01  PV-PROGRAM-VARIABLES.                                        02170000
           05  PV-ORACLE-USERID-LEN       PIC S9(4) VALUE ZEROS         02171000
                                                    COMP SYNC.          02172000
           05  PV-ORACLE-PASSWORD-LEN     PIC S9(4) VALUE ZEROS         02173000
                                                    COMP SYNC.          02174000
           05  PV-SQL                       PIC S9(04)  VALUE ZEROS.    02180000
           05  PV-TABLE-NAME                PIC  X(12)  VALUE SPACES.   02190000
           05  PV-OPERATION-MSG             PIC  X(60)  VALUE SPACES.   02200000
           05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACES.   02210000
           05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACES.   02220000
           05  PV-SYS-DATE                  PIC  X(26)  VALUE SPACES.   02230000
           05  PV-SYS-DATE-XS REDEFINES PV-SYS-DATE.                    02240000
               10  PV-SYS-DATE-DATE         PIC  X(10).                 02250000
               10  PV-PERIOD                PIC  X(01).                 02260000
               10  PV-SYS-DATE-TIME         PIC  X(15).                 02270000
           05  PV-NEXT-DATE                 PIC  X(10)  VALUE SPACES.   02280000
           05  PV-MINUS-DATE                PIC  X(10)  VALUE SPACES.   02290000
           05  PV-NEW-STRT-DATE             PIC  X(26)  VALUE SPACES.   02300000
           05  PV-NEW-END-DATE              PIC  X(26)  VALUE SPACES.   02310000
           05  PV-PREV-NEW-STRT-DTE         PIC  X(26)  VALUE SPACES.   02320000
           05  PV-PREV-NEW-END-DTE          PIC  X(26)  VALUE SPACES.   02330000
                                                                        02340000
       01  PV-ADEVNT-VARIABLES.                                         02350000
           05 PV-ADEVNT-ID                  PIC  9(10)     VALUE ZEROS. 02360000
           05 PV-ADEVNT-STRT-DTE            PIC  X(10)     VALUE SPACES.02370000
           05 PV-ADEVNT-END-DTE             PIC  X(10)     VALUE SPACES.02380000
                                                                        02390000
       01 PV-SELECT-VARIABLES.                                          02400000
           05  PV-ADV-IND                   PIC  X(01)  VALUE SPACES.   02410000
           05  PV-PROMO-ID                  PIC  9(10)  VALUE ZEROS.    02420000
           05  PV-STR-SELN-ID               PIC  9(10)  VALUE ZEROS.    02430000
           05  PV-PROMO-INTFC-ID            PIC  9(10)  VALUE ZERO.     02440000
           05  PV-MDSE-LNE-ID               PIC  9(10)  VALUE ZERO.     02450000
           05  PV-PROMO-PRIC-VER-ID         PIC  9(10)  VALUE ZERO.     02460000
           05  PV-STR-SELN-TYP-CDE          PIC  X(01)  VALUE SPACES.   02470000
           05  PV-STR-SELN-HIER-LVL-CDE     PIC  9(02)  VALUE ZERO.     02480000
           05  PV-ADHC-STR-GP-ID            PIC  9(10)  VALUE ZERO.     02490000
           05  PV-STR-GP-TYP-CDE            PIC  9(04)  VALUE ZERO.     02500000
           05  PV-STR-GP-ID                 PIC  9(04)  VALUE ZERO.     02510000
           05  PV-PRNT-OV-STR-GP-ID         PIC  9(04)  VALUE ZERO.     02520000
           05  PV-PRNT-OV-STR-GP-CDE        PIC  9(04)  VALUE ZERO.     02530000
           05  PV-PRNT-OV-ADHC-STR-GP-ID    PIC  9(10)  VALUE ZERO.     02540000
           05  PV-PRNT-OV-STR-SELN-CDE      PIC  X(01)  VALUE SPACES.   02550000
           05  PV-STRT-TMST                 PIC  X(26)  VALUE SPACES.   02560000
           05  PV-END-TMST                  PIC  X(26)  VALUE SPACES.   02570000
           05  PV-ACT-STRT-TM               PIC  X(10)  VALUE SPACES.   02580000
           05  PV-ACT-END-TM                PIC  X(10)  VALUE SPACES.   02590000
           05  PV-ACT-STRT-TMST             PIC  X(26)  VALUE SPACES.   02600000
           05  PV-ACT-END-TMST              PIC  X(26)  VALUE SPACES.   02610000
           05  PV-ESL-TOPR-TYP-CDE          PIC  X(03)  VALUE SPACES.   02620000
           05  PV-STAT-CDE                  PIC  X(01)  VALUE SPACES.   02630000
           05  PV-LAST-UPD-TMST             PIC  X(26)  VALUE SPACES.   02640000
           05  PV-SORT-LAST-UPD-TMST        PIC  X(26)  VALUE SPACES.   02650000
                                                                        02660000
           05  PV-ADHC-STR-GP-ID-NULL       PIC S9(04)  COMP            02670000
                                                        VALUE ZEROS.    02680000
           05  PV-OV-STR-GP-ID-NULL         PIC S9(04)  COMP            02690000
                                                        VALUE ZEROS.    02700000
           05  PV-OV-STR-GP-CDE-NULL        PIC S9(04)  COMP            02710000
                                                        VALUE ZEROS.    02720000
           05  PV-OV-ADHC-STR-GP-NULL       PIC S9(04)  COMP            02730000
                                                        VALUE ZEROS.    02740000
           05  PV-OV-STR-SELN-CDE-NULL      PIC S9(04)  COMP            02750000
                                                        VALUE ZEROS.    02760000
           05  PV-STR-GP-TYP-CDE-NULL       PIC S9(04)  COMP            02770000
                                                        VALUE ZEROS.    02780000
           05  PV-STR-GP-ID-NULL            PIC S9(04)  COMP            02790000
                                                        VALUE ZEROS.    02800000
           05  PV-PROMO-PRIC-VER-ID-NULL    PIC S9(04)  COMP            02810000
                                                        VALUE ZEROS.    02820000
           05  PV-ESL-TOPR-TYP-CDE-NULL     PIC S9(04)  COMP            02830000
                                                        VALUE ZEROS.    02840000
                                                                        02850000
       01  CT-CPU-TIME.                                                 02860000
           05  CT-CPU-HR                        PIC  9(02) VALUE ZERO.  02870000
           05  CT-CPU-MIN                       PIC  9(02) VALUE ZERO.  02880000
           05  CT-CPU-SEC                       PIC  9(02) VALUE ZERO.  02890000
           05  CT-CPU-HSEC                      PIC  9(02) VALUE ZERO.  02900000
                                                                        02910000
       01  PV-CPU-TIME.                                                 02920000
           05  PV-CPU-HR                        PIC  9(02) VALUE ZERO.  02930000
           05  FILLER                           PIC  X(01) VALUE ":".   02940000
           05  PV-CPU-MIN                       PIC  9(02) VALUE ZERO.  02950000
           05  FILLER                           PIC  X(01) VALUE ":".   02960000
           05  PV-CPU-SEC                       PIC  9(02) VALUE ZERO.  02970000
           05  FILLER                           PIC  X(01) VALUE ":".   02980000
           05  PV-CPU-HSEC                      PIC  9(02) VALUE ZERO.  02990000
                                                                        03000000
       01  PA-FETCH-PROGRAM-ACCUMULATORS.                               03010000
           05  PA-RECS-WRITTEN              PIC S9(11)  COMP-3          03020000
                                                        VALUE ZEROS.    03030000
           05  PA-FETCH-ADMIN-CNT           PIC S9(11)  COMP-3          03040000
                                                        VALUE ZEROS.    03050000
           05  PA-FETCH-ADMINOVR-CNT        PIC S9(11)  COMP-3          03060000
                                                        VALUE ZEROS.    03070000
           05  PA-FETCH-CLRNC-CNT           PIC S9(11)  COMP-3          03080000
                                                        VALUE ZEROS.    03090000
           05  PA-FETCH-CMPTV-CNT           PIC S9(11)  COMP-3          03100000
                                                        VALUE ZEROS.    03110000
           05  PA-FETCH-GRP-CNT             PIC S9(11)  COMP-3          03120000
                                                        VALUE ZEROS.    03130000
           05  PA-FETCH-GRPOVR-CNT          PIC S9(11)  COMP-3          03140000
                                                        VALUE ZEROS.    03150000
           05  PA-FETCH-PROMO-CNT           PIC S9(11)  COMP-3          03160000
                                                        VALUE ZEROS.    03170000
           05  PA-FETCH-PROMOOVR-CNT        PIC S9(11)  COMP-3          03180000
                                                        VALUE ZEROS.    03190000
           05  PA-FETCH-SIMP-CNT            PIC S9(11)  COMP-3          03200000
                                                        VALUE ZEROS.    03210000
           05  PA-FETCH-SIMPOVR-CNT         PIC S9(11)  COMP-3          03220000
                                                        VALUE ZEROS.    03230000
           05  PA-WRITE-ADMIN-CNT           PIC S9(11)  COMP-3          03240000
                                                        VALUE ZEROS.    03250000
           05  PA-WRITE-ADMINOVR-CNT        PIC S9(11)  COMP-3          03260000
                                                        VALUE ZEROS.    03270000
           05  PA-WRITE-CLRNC-CNT           PIC S9(11)  COMP-3          03280000
                                                        VALUE ZEROS.    03290000
           05  PA-WRITE-CMPTV-CNT           PIC S9(11)  COMP-3          03300000
                                                        VALUE ZEROS.    03310000
           05  PA-WRITE-GRP-CNT             PIC S9(11)  COMP-3          03320000
                                                        VALUE ZEROS.    03330000
           05  PA-WRITE-GRPOVR-CNT          PIC S9(11)  COMP-3          03340000
                                                        VALUE ZEROS.    03350000
           05  PA-WRITE-PROMO-CNT           PIC S9(11)  COMP-3          03360000
                                                        VALUE ZEROS.    03370000
           05  PA-WRITE-PROMOOVR-CNT        PIC S9(11)  COMP-3          03380000
                                                        VALUE ZEROS.    03390000
           05  PA-WRITE-SIMP-CNT            PIC S9(11)  COMP-3          03400000
                                                        VALUE ZEROS.    03410000
           05  PA-WRITE-SIMPOVR-CNT         PIC S9(11)  COMP-3          03420000
                                                        VALUE ZEROS.    03430000
           05  PA-ADEVNT-DATE               PIC S9(11)  COMP-3          03440000
                                                        VALUE ZEROS.    03450000
                                                                        03460000
       01  PA-IND-PROGRAM-ACCUMULATORS.                                 03470000
           05  PA-IND-FETCH-ADMIN-CNT       PIC S9(11)  COMP-3          03480000
                                                        VALUE ZEROS.    03490000
           05  PA-IND-FETCH-ADMINOVR-CNT    PIC S9(11)  COMP-3          03500000
                                                        VALUE ZEROS.    03510000
           05  PA-IND-FETCH-CLRNC-CNT       PIC S9(11)  COMP-3          03520000
                                                        VALUE ZEROS.    03530000
           05  PA-IND-FETCH-CMPTV-CNT       PIC S9(11)  COMP-3          03540000
                                                        VALUE ZEROS.    03550000
           05  PA-IND-FETCH-GRP-CNT         PIC S9(11)  COMP-3          03560000
                                                        VALUE ZEROS.    03570000
           05  PA-IND-FETCH-GRPOVR-CNT      PIC S9(11)  COMP-3          03580000
                                                        VALUE ZEROS.    03590000
           05  PA-IND-FETCH-PROMO-CNT       PIC S9(11)  COMP-3          03600000
                                                        VALUE ZEROS.    03610000
           05  PA-IND-FETCH-PROMOOVR-CNT    PIC S9(11)  COMP-3          03620000
                                                        VALUE ZEROS.    03630000
           05  PA-IND-FETCH-SIMP-CNT        PIC S9(11)  COMP-3          03640000
                                                        VALUE ZEROS.    03650000
           05  PA-IND-FETCH-SIMPOVR-CNT     PIC S9(11)  COMP-3          03660000
                                                        VALUE ZEROS.    03670000
           05  PA-IND-WRITE-ADMIN-CNT       PIC S9(11)  COMP-3          03680000
                                                        VALUE ZEROS.    03690000
           05  PA-IND-WRITE-ADMINOVR-CNT    PIC S9(11)  COMP-3          03700000
                                                        VALUE ZEROS.    03710000
           05  PA-IND-WRITE-CLRNC-CNT       PIC S9(11)  COMP-3          03720000
                                                        VALUE ZEROS.    03730000
           05  PA-IND-WRITE-CMPTV-CNT       PIC S9(11)  COMP-3          03740000
                                                        VALUE ZEROS.    03750000
           05  PA-IND-WRITE-GRP-CNT         PIC S9(11)  COMP-3          03760000
                                                        VALUE ZEROS.    03770000
           05  PA-IND-WRITE-GRPOVR-CNT      PIC S9(11)  COMP-3          03780000
                                                        VALUE ZEROS.    03790000
           05  PA-IND-WRITE-PROMO-CNT       PIC S9(11)  COMP-3          03800000
                                                        VALUE ZEROS.    03810000
           05  PA-IND-WRITE-PROMOOVR-CNT    PIC S9(11)  COMP-3          03820000
                                                        VALUE ZEROS.    03830000
           05  PA-IND-WRITE-SIMP-CNT        PIC S9(11)  COMP-3          03840000
                                                        VALUE ZEROS.    03850000
           05  PA-IND-WRITE-SIMPOVR-CNT     PIC S9(11)  COMP-3          03860000
                                                        VALUE ZEROS.    03870000
                                                                        03880000
      ******************************************************************03890000
      *    COPYBOOK FOR THE PRICING STORE GROUP BUSINESS EVENT.         03900000
      ******************************************************************03910000
           COPY PMRD710.                                                03920000
                                                                        03930000
      ******************************************************************03940000
      *    COPYBOOK FOR THE TOTAL RECORD                                03950000
      ******************************************************************03960000
           COPY PMRD700.                                                03970001
                                                                        03980000
      ***************************************************************** 03990000
      *                      O  R  A  C  L  E                           04000000
      *================================================================ 04010000
      * ORACLE DECLARE SECTION                                          04020000
      * ORACLE USED AND RETURNED VARIABLES                              04030000
      ***************************************************************** 04040000
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     04050000
                                                                        04060000
      *---------------------------------------------------------------* 04070000
      * ORACLE LOGON WORKING STORAGE COPYBOOK                           04080000
      *---------------------------------------------------------------* 04090000
       01      PC-ENT01-TYPE-CDE          PIC X(02)      VALUE '01'.    04100000
       01      PV-ORACLE-ID               PIC X(1)       VALUE '/'.     04110000
                                                                        04120000
       01      USERNAME                   PIC X(10)      VARYING.       04130000
       01      PASSWD                     PIC X(10)      VARYING.       04140000
                                                                        04150000
       01      ORACLE-RETURN              PIC X(200)     VALUE SPACES.  04160000
                                                                        04170000
           EXEC SQL END DECLARE SECTION END-EXEC.                       04180000
           EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       04190000
                                                                        04200000
      ********************                                              04210000
       EJECT                                                            04220000
      ********************                                              04230000
       PROCEDURE DIVISION.                                              04240000
      ********************                                              04250000
      ***************************************************************** 04260000
      * A100-MAINLINE.                                                * 04270000
      * ==> PROCESSES:                                                * 04280000
      *  - RESET SWITCHES                                             * 04290000
      *  - OPEN INPUT AND OUTPUT FILES                                * 04300000
      *  - READ THE DATE RANGE FILE                                   * 04310000
      *  - READ THE TIMESTAMP FILE                                    * 04320000
      *  - SET UP ORACLE                                              * 04330000
      *  - FIND THE CURRENT SYS DATE                                  * 04340000
      *  - RUN THE CLEARANCE CURSOR                                   * 04350000
      *  - RUN THE ADEVENT CURSOR                                     * 04360000
      *  - WRITE THE TOTAL LINES                                      * 04370000
      *  - CLOSE THE INPUT AND OUTPUT FILES                           * 04380000
      * ==> PERFORMED FROM: START                                     * 04390000
      ***************************************************************** 04400000
       A100-MAINLINE.                                                   04410000
                                                                        04420000
           SET PS-DATE-RANGE-FILE-START TO TRUE.                        04430000
           SET PS-TMST-FILE-START TO TRUE.                              04440000
           PERFORM B100-OPEN-FILES.                                     04450000
           PERFORM B200-READ-DATE-RANGE-FILE.                           04460000
           PERFORM B300-READ-TMST-FILE.                                 04470000
                                                                        04480000
      *    PERFORM PM700-A000-ORACLE-SETUP.                             04490000
           PERFORM B110-ORACLE-SETUP.                                   04491000
                                                                        04500000
      *    PERFORM C100-FIND-SYSDATE.                                   04510000
           PERFORM C110-ALTER-SESSION.                                  04520000
                                                                        04530000
           PERFORM C220-DECLARE-CLRNC-CSR.                              04540000
           PERFORM C320-OPEN-CLRNC-CSR.                                 04550000
            ACCEPT CT-CPU-TIME FROM TIME.                               04560000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           04570000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          04580000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          04590000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         04600000
            DISPLAY 'START FETCH/PROCESS CLRNC-CSR: ' PV-CPU-TIME.      04610000
           PERFORM C420-FETCH-CLRNC-CSR.                                04620000
           PERFORM C520-PROCESS-CLRNC-CSR                               04630000
               UNTIL PS-END-OF-CLRNC-CSR.                               04640000
            ACCEPT CT-CPU-TIME FROM TIME.                               04650000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           04660000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          04670000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          04680000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         04690000
            DISPLAY 'FINISH FETCH/PROCESS CLRNC-CSR: ' PV-CPU-TIME.     04700000
            DISPLAY ' '                                                 04710000
           PERFORM C620-CLOSE-CLRNC-CSR.                                04720000
                                                                        04730000
           PERFORM C295-DECLARE-ADEVNT-DTE-CSR                          04740000
           PERFORM C395-OPEN-ADEVNT-DTE-CSR.                            04750000
           PERFORM C495-FETCH-ADEVNT-DTE-CSR.                           04760000
           PERFORM C595-PROCESS-ADEVNT-DTE-CSR                          04770000
               UNTIL PS-END-OF-ADEVNT-DTE-CSR.                          04780000
           PERFORM C695-CLOSE-ADEVNT-DTE-CSR.                           04790000
                                                                        04800000
           PERFORM W200-WRITE-TOTAL-LINE.                               04810000
                                                                        04820000
           PERFORM B900-CLOSE-FILES.                                    04830000
                                                                        04840000
           DISPLAY 'ADMIN CSR WRITTEN FROM ORACLE    = '                04850000
                                                PA-WRITE-ADMIN-CNT.     04860000
           DISPLAY 'ADMINOVR CSR WRITTEN FROM ORACLE = '                04870000
                                                PA-WRITE-ADMINOVR-CNT.  04880000
           DISPLAY 'CLRNC CSR WRITTEN FROM ORACLE    = '                04890000
                                                PA-WRITE-CLRNC-CNT.     04900000
           DISPLAY 'CMPTV CSR WRITTEN FROM ORACLE    = '                04910000
                                                PA-WRITE-CMPTV-CNT.     04920000
           DISPLAY 'GRP CSR WRITTEH FROM ORACLE      = '                04930000
                                                PA-WRITE-GRP-CNT.       04940000
           DISPLAY 'GRPOVR CSR WRITTEN FROM ORACLE   ='                 04950000
                                                PA-WRITE-GRPOVR-CNT.    04960000
           DISPLAY 'PROMO CSR WRITTEN FROM ORACLE    = '                04970000
                                                PA-WRITE-PROMO-CNT.     04980000
           DISPLAY 'PROMOOVR CSR WRITTEN FROM ORACLE = '                04990000
                                                PA-WRITE-PROMOOVR-CNT.  05000000
           DISPLAY 'SIMP CSR WRITTEN FROM ORACLE     = '                05010000
                                                PA-WRITE-SIMP-CNT.      05020000
           DISPLAY 'SIMPOVR CSR WRITTEN FROM ORACLE  = '                05030000
                                                PA-WRITE-SIMPOVR-CNT.   05040000
           DISPLAY 'RECORDS WRITTEN TO FILE        = ' PA-RECS-WRITTEN. 05050000
                                                                        05060000
           STOP RUN.                                                    05070000
                                                                        05080000
      ***************************************************************** 05090000
      * A200-PROCESS-CSRS.                                            * 05100000
      * ==> PROCESSES:                                                * 05110000
      *  - REINITIALIZE THE PROGRAM ACCUMULATORS                      * 05120000
      *  - PROCESS ALL THE CURSORS                                    * 05130000
      *    - SIMPLE, GROUP, ADMIN TIERED, PROMO TIERED, CPMTV         * 05140000
      * ==> PERFORMED FROM: C595-PROCESS-ADEVNT-DTE-CSR               * 05150000
      ***************************************************************** 05160000
       A200-PROCESS-CSRS.                                               05170000
                                                                        05180000
           INITIALIZE PA-IND-PROGRAM-ACCUMULATORS.                      05190000
           INITIALIZE PS-CSR-PROGRAM-SWITCHES.                          05200000
                                                                        05210000
           PERFORM C200-DECLARE-ADMIN-CSR.                              05220000
           PERFORM C300-OPEN-ADMIN-CSR.                                 05230000
            ACCEPT CT-CPU-TIME FROM TIME.                               05240000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           05250000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          05260000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          05270000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         05280000
            DISPLAY 'START FETCH/PROCESS ADMIN-CSR: ' PV-CPU-TIME.      05290000
           PERFORM C400-FETCH-ADMIN-CSR.                                05300000
           PERFORM C500-PROCESS-ADMIN-CSR                               05310000
               UNTIL PS-END-OF-ADMIN-CSR.                               05320000
            ACCEPT CT-CPU-TIME FROM TIME.                               05330000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           05340000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          05350000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          05360000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         05370000
            DISPLAY 'FINISH FETCH/PROCESS ADMIN-CSR: ' PV-CPU-TIME.     05380000
            DISPLAY ' '                                                 05390000
           PERFORM C600-CLOSE-ADMIN-CSR.                                05400000
                                                                        05410000
           PERFORM C210-DECLARE-ADMINOVR-CSR.                           05420000
           PERFORM C310-OPEN-ADMINOVR-CSR.                              05430000
            ACCEPT CT-CPU-TIME FROM TIME.                               05440000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           05450000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          05460000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          05470000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         05480000
            DISPLAY 'START FETCH/PROCESS ADMINOVR-CSR: ' PV-CPU-TIME.   05490000
           PERFORM C410-FETCH-ADMINOVR-CSR.                             05500000
           PERFORM C510-PROCESS-ADMINOVR-CSR                            05510000
               UNTIL PS-END-OF-ADMINOVR-CSR.                            05520000
            ACCEPT CT-CPU-TIME FROM TIME.                               05530000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           05540000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          05550000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          05560000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         05570000
            DISPLAY 'FINISH FETCH/PROCESS ADMINOVR-CSR: ' PV-CPU-TIME.  05580000
            DISPLAY ' '                                                 05590000
           PERFORM C610-CLOSE-ADMINOVR-CSR.                             05600000
                                                                        05610000
           PERFORM C230-DECLARE-CMPTV-CSR.                              05620000
           PERFORM C330-OPEN-CMPTV-CSR.                                 05630000
            ACCEPT CT-CPU-TIME FROM TIME.                               05640000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           05650000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          05660000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          05670000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         05680000
            DISPLAY 'START FETCH/PROCESS CMPTV-CSR: ' PV-CPU-TIME.      05690000
           PERFORM C430-FETCH-CMPTV-CSR.                                05700000
           PERFORM C530-PROCESS-CMPTV-CSR                               05710000
               UNTIL PS-END-OF-CMPTV-CSR.                               05720000
            ACCEPT CT-CPU-TIME FROM TIME.                               05730000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           05740000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          05750000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          05760000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         05770000
            DISPLAY 'FINISH FETCH/PROCESS CMPTV-CSR: ' PV-CPU-TIME.     05780000
            DISPLAY ' '                                                 05790000
           PERFORM C630-CLOSE-CMPTV-CSR.                                05800000
                                                                        06010000
           PERFORM C250-DECLARE-GRPOVR-CSR.                             06020000
           PERFORM C350-OPEN-GRPOVR-CSR.                                06030000
            ACCEPT CT-CPU-TIME FROM TIME.                               06040000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06050000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06060000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06070000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06080000
            DISPLAY 'START FETCH/PROCESS GRPOVR-CSR: ' PV-CPU-TIME.     06090000
           PERFORM C450-FETCH-GRPOVR-CSR.                               06100000
           PERFORM C550-PROCESS-GRPOVR-CSR                              06110000
               UNTIL PS-END-OF-GRPOVR-CSR.                              06120000
            ACCEPT CT-CPU-TIME FROM TIME.                               06130000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06140000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06150000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06160000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06170000
            DISPLAY 'FINISH FETCH/PROCESS GRPOVR-CSR: ' PV-CPU-TIME.    06180000
            DISPLAY ' '                                                 06190000
           PERFORM C650-CLOSE-GRPOVR-CSR.                               06200000
                                                                        06210000
           PERFORM C260-DECLARE-PROMO-CSR.                              06220000
           PERFORM C360-OPEN-PROMO-CSR.                                 06230000
            ACCEPT CT-CPU-TIME FROM TIME.                               06240000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06250000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06260000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06270000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06280000
            DISPLAY 'START FETCH/PROCESS PROMO-CSR: ' PV-CPU-TIME.      06290000
           PERFORM C460-FETCH-PROMO-CSR.                                06300000
           PERFORM C560-PROCESS-PROMO-CSR                               06310000
               UNTIL PS-END-OF-PROMO-CSR.                               06320000
            ACCEPT CT-CPU-TIME FROM TIME.                               06330000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06340000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06350000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06360000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06370000
            DISPLAY 'FINISH FETCH/PROCESS PROMO-CSR: ' PV-CPU-TIME.     06380000
            DISPLAY ' '                                                 06390000
           PERFORM C660-CLOSE-PROMO-CSR.                                06400000
                                                                        06410000
           PERFORM C270-DECLARE-PROMOOVR-CSR.                           06420000
           PERFORM C370-OPEN-PROMOOVR-CSR.                              06430000
            ACCEPT CT-CPU-TIME FROM TIME.                               06440000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06450000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06460000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06470000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06480000
            DISPLAY 'START FETCH/PROCESS PROMOOVR-CSR: ' PV-CPU-TIME.   06490000
           PERFORM C470-FETCH-PROMOOVR-CSR.                             06500000
           PERFORM C570-PROCESS-PROMOOVR-CSR                            06510000
               UNTIL PS-END-OF-PROMOOVR-CSR.                            06520000
            ACCEPT CT-CPU-TIME FROM TIME.                               06530000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06540000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06550000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06560000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06570000
            DISPLAY 'FINISH FETCH/PROCESS PROMOOVR-CSR: ' PV-CPU-TIME.  06580000
            DISPLAY ' '                                                 06590000
           PERFORM C670-CLOSE-PROMOOVR-CSR.                             06600000
                                                                        06610000
           PERFORM C290-DECLARE-SIMPOVR-CSR.                            06820000
           PERFORM C390-OPEN-SIMPOVR-CSR.                               06830000
            ACCEPT CT-CPU-TIME FROM TIME.                               06840000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06850000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06860000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06870000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06880000
            DISPLAY 'START FETCH/PROCESS SIMPOVR-CSR: ' PV-CPU-TIME.    06890000
           PERFORM C490-FETCH-SIMPOVR-CSR.                              06900000
           PERFORM C590-PROCESS-SIMPOVR-CSR                             06910000
               UNTIL PS-END-OF-SIMPOVR-CSR.                             06920000
            ACCEPT CT-CPU-TIME FROM TIME.                               06930000
            MOVE CT-CPU-HR     TO  PV-CPU-HR.                           06940000
            MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                          06950000
            MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                          06960000
            MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                         06970000
            DISPLAY 'FINISH FETCH/PROCESS SIMPOVR-CSR: ' PV-CPU-TIME.   06980000
            DISPLAY ' '                                                 06990000
           PERFORM C690-CLOSE-SIMPOVR-CSR.                              07000000
                                                                        07010000
      ***************************************************************** 07020000
      * B100-OPEN-FILES.                                              * 07030000
      * ==> PROCESSES:                                                * 07040000
      *  - OPEN TWO INPUT FILES AND ONE OUTPUT FILE                   * 07050000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 07060000
      ***************************************************************** 07070000
       B100-OPEN-FILES.                                                 07080000
                                                                        07090000
           OPEN INPUT  DATE-RANGE-FILE                                  07100000
                INPUT  TMST-FILE                                        07110000
                OUTPUT PRCG-STORE-GP-FILE.                              07120000
                                                                        07130000
      ***************************************************************** 07132000
      * B110-ORACLE-SETUP.                                            * 07133000
      ***************************************************************** 07134000
       B110-ORACLE-SETUP.                                               07135000
                                                                        07136000
           OPEN INPUT ORACLE-LOGON-FILE.                                07137000
                                                                        07138000
           PERFORM B120-READ-ORACLE-LOGON.                              07139000
                                                                        07139100
           CLOSE ORACLE-LOGON-FILE.                                     07139200
                                                                        07139300
           IF ((PS-END-OF-LOGON-FILE)                                   07139400
                   OR (CC-ORACLE-CONNECTION = SPACES))                  07139500
               DISPLAY '** ABEND **'                                    07139600
               DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '  07139700
                         'NOT PROVIDED'                                 07139800
               SET PS-ORA-SRC-EMPTY TO TRUE                             07139900
               CALL 'ILBOABN0' USING ABEND-CODE                         07140000
           END-IF.                                                      07140100
                                                                        07140200
           IF CC-AUTO-LOGON                                             07140300
               DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'        07140400
               EXEC SQL                                                 07140500
                    CONNECT :USERNAME                                   07140600
               END-EXEC                                                 07140700
           ELSE                                                         07140800
               INITIALIZE PV-ORACLE-USERID-LEN                          07140900
                          PV-ORACLE-PASSWORD-LEN                        07141000
               INSPECT CC-ORACLE-USERID                                 07141100
                   TALLYING PV-ORACLE-USERID-LEN                        07141200
                FOR CHARACTERS BEFORE INITIAL SPACE                     07141300
            INSPECT CC-ORACLE-PASSWORD                                  07141400
                TALLYING PV-ORACLE-PASSWORD-LEN                         07141500
                FOR CHARACTERS BEFORE INITIAL SPACE                     07141600
            MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           07141700
                      USERNAME-ARR                                      07141800
            MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   07141900
            MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       07142000
                      PASSWD-ARR                                        07142100
            MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   07142200
            DISPLAY PC-PROGRAM-NAME ' - LOGON TO ORACLE AS USER '       07142300
                      USERNAME-ARR                                      07142400
            EXEC SQL                                                    07142500
              CONNECT :USERNAME IDENTIFIED BY :PASSWD                   07142600
            END-EXEC                                                    07142700
            INITIALIZE CC-ORACLE-PASSWORD                               07142800
                       PASSWD                                           07142900
            END-IF.                                                     07143000
                                                                        07143100
020500     IF (SQLCODE NOT = 0)                                         07143200
020900         DISPLAY PV-PARAGRAPH-NAME                                07143300
020910         DISPLAY PC-PROGRAM-NAME ' - ERROR LOGGING ON TO ORACLE'  07143400
021000*        PERFORM 9900-ORACLE-ABEND                                07143500
               PERFORM Z100-ABEND                                       07143600
021200     END-IF.                                                      07143700
                                                                        07143800
                                                                        07143900
      ***************************************************************** 07144000
      *  B120-READ-ORACLE-LOGON.                                      * 07144100
      * ==> PROCESSES:                                                * 07144200
      *   - READ ORCALE CONTROL CARD                                  * 07144300
      * ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 07144400
      ***************************************************************** 07144500
       B120-READ-ORACLE-LOGON.                                          07144600
                                                                        07144700
034510     READ ORACLE-LOGON-FILE                                       07144800
034520         INTO CC-ORACLE-CONNECTION                                07144900
034530         AT END                                                   07145000
034540             SET PS-END-OF-LOGON-FILE TO TRUE                     07145100
034550     END-READ.                                                    07145200
                                                                        07145300
      ***************************************************************** 07146000
      * B200-READ-DATE-RANGE-FILE.                                    * 07150000
      * ==> PROCESSES:                                                * 07160000
      *  - READ IN THE DATE RANGE FILE                                * 07170000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 07180000
      ***************************************************************** 07190000
       B200-READ-DATE-RANGE-FILE.                                       07200000
                                                                        07210000
           READ DATE-RANGE-FILE INTO CC-DATE-RANGE-FILE                 07220000
              AT END                                                    07230000
                 SET PS-DATE-RANGE-FILE-END TO TRUE                     07240000
           END-READ.                                                    07250000
                                                                        07260000
           IF PS-DATE-RANGE-FILE-END                                    07270000
               MOVE 'NO DATE RANGE FILE TO PROCESS'                     07280000
                                                 TO PV-OPERATION-MSG-1  07290000
               SET ABEND-4003-CTRL-CARD-ERROR    TO TRUE                07300000
               PERFORM Z910-ABEND                                       07310000
           ELSE                                                         07320000
               DISPLAY 'CC-START-DATE = ' CC-START-DATE                 07330000
               DISPLAY 'CC-END-DATE   = ' CC-END-DATE                   07340000
                                                                        07350000
               STRING CC-START-DATE DELIMITED BY SPACE                  07360000
                      PC-SPACE DELIMITED BY SIZE                        07370000
                      PC-BEG-TMST   DELIMITED BY SIZE                   07380000
                      INTO PV-NEW-STRT-DATE                             07390000
                                                                        07400000
               STRING CC-END-DATE DELIMITED BY SPACE                    07410000
                      PC-SPACE DELIMITED BY SIZE                        07420000
                      PC-END-TMST   DELIMITED BY SIZE                   07430000
                      INTO PV-NEW-END-DATE                              07440000
           END-IF.                                                      07450000
                                                                        07460000
      ***************************************************************** 07470000
      * B300-READ-TMST-FILE.                                          * 07480000
      * ==> PROCESSES:                                                * 07490000
      *  - READ IN THE TMST FILE                                      * 07500000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 07510000
      ***************************************************************** 07520000
       B300-READ-TMST-FILE.                                             07530000
                                                                        07540000
           READ TMST-FILE INTO CC-TMST-FILE                             07550000
              AT END                                                    07560000
                 SET PS-TMST-FILE-END TO TRUE                           07570000
           END-READ.                                                    07580000
                                                                        07590000
           IF PS-TMST-FILE-END                                          07600000
               MOVE 'NO TMST FILE TO PROCESS'                           07610000
                                                 TO PV-OPERATION-MSG-1  07620000
               SET ABEND-4003-CTRL-CARD-ERROR    TO TRUE                07630000
               PERFORM Z910-ABEND                                       07640000
           ELSE                                                         07650000
               DISPLAY 'CC-LAST-UPD-TMST = ' CC-LAST-UPD-TMST           07660000
           END-IF.                                                      07670000
                                                                        07680000
      ***************************************************************** 07690000
      * B900-CLOSE-FILES                                              * 07700000
      * ==> PROCESSES:                                                * 07710000
      *  - CLOSE THE TWO INPUT FILES AND ONE OUTPUT FILE              * 07720000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 07730000
      ***************************************************************** 07740000
       B900-CLOSE-FILES.                                                07750000
                                                                        07760000
           CLOSE  DATE-RANGE-FILE                                       07770000
                  TMST-FILE                                             07780000
                  PRCG-STORE-GP-FILE.                                   07790000
                                                                        07800000
      ***************************************************************** 07810000
      * C100-FIND-SYSDATE:                                            * 07820000
      * ==> PROCESSES:                                                * 07830000
      *  - SINCE NO TABLE IS ACTUALLY USED WE USE THE DUAL TABLE      * 07840000
      *  - FIND THE CURRENT DATE AND TIME                               07850000
      * ==> SQLCODE:                                                  * 07860000
      *  - 0 = A ROW WAS FOUND.                                       * 07870000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 07880000
      ***************************************************************** 07890000
       C100-FIND-SYSDATE.                                               07900000
           EXEC SQL                                                     07910000
               SELECT                                                   07920000
                   SYSDATE                                              07930000
               INTO :PV-SYS-DATE                                        07940000
               FROM                                                     07950000
                   DUAL                                                 07960000
           END-EXEC.                                                    07970000
                                                                        07980000
           EVALUATE TRUE                                                07990000
             WHEN SQLCODE = ZERO                                        08000000
                 MOVE PC-DASH TO PV-PERIOD                              08010000
      *          STRING PV-SYS-DATE-XS DELIMITED BY SPACE               08020000
      *                 '.000000'      DELIMITED BY SIZE                08030000
      *                 INTO PV-SYS-DATE-XS                             08040000
                 STRING CC-LAST-UPD-TMST DELIMITED BY SPACE             08041000
                        '.000000'      DELIMITED BY SIZE                08042000
                        INTO PV-SYS-DATE-XS                             08043000
                 DISPLAY 'SYS DATE = ' PV-SYS-DATE-XS                   08050000
                 CONTINUE                                               08060000
             WHEN OTHER                                                 08070000
               MOVE SQLCODE               TO PV-SQL                     08080000
               MOVE 'DUAL'                TO PV-TABLE-NAME              08090000
               MOVE 'C100-FIND-SYSDATE'   TO PV-PARAGRAPH-NAME          08100000
               PERFORM Z100-ABEND                                       08110000
           END-EVALUATE.                                                08120000
                                                                        08130000
      ***************************************************************** 08140000
      * C105-ADD-ONE-DAY                                              * 08150000
      * ==> PROCESSES:                                                * 08160000
      * ==> SQLCODE:                                                  * 08170000
      *  - 0 = A ROW WAS FOUND.                                       * 08180000
      * ==> PERFORMED FROM:                                           * 08190000
      ***************************************************************** 08200000
       C105-ADD-ONE-DAY.                                                08210000
                                                                        08220000
           EXEC SQL                                                     08230000
               SELECT                                                   08240000
                   TO_CHAR(TO_DATE(:PV-PREV-NEW-END-DTE) + 1,           08250000
                                                'YYYY-MM-DD')           08260000
                  ,TO_CHAR(TO_DATE(:PV-ADEVNT-STRT-DTE) - 1,            08270000
                                                'YYYY-MM-DD')           08280000
               INTO :PV-NEXT-DATE                                       08290000
                   ,:PV-MINUS-DATE                                      08300000
               FROM                                                     08310000
                   DUAL                                                 08320000
           END-EXEC.                                                    08330000
                                                                        08340000
           EVALUATE TRUE                                                08350000
             WHEN SQLCODE = ZERO                                        08360000
                 DISPLAY 'PV-PREV-NEW-END-DTE = ' PV-PREV-NEW-END-DTE   08370000
                 DISPLAY 'PV-ADEVNT-STRT-DTE = ' PV-ADEVNT-STRT-DTE     08380000
                 DISPLAY 'PV-NEXT-DATE = '        PV-NEXT-DATE          08390000
                 DISPLAY 'PV-MINUS-DATE = '       PV-MINUS-DATE         08400000
                 CONTINUE                                               08410000
                                                                        08420000
             WHEN OTHER                                                 08430000
               MOVE SQLCODE               TO PV-SQL                     08440000
               MOVE 'DUAL'                TO PV-TABLE-NAME              08450000
               MOVE 'C105-ADD-ONE-DAY '   TO PV-PARAGRAPH-NAME          08460000
               PERFORM Z100-ABEND                                       08470000
           END-EVALUATE.                                                08480000
                                                                        08490000
      ***************************************************************** 08500000
      * C110-ALTER-SESSION:                                           * 08510000
      * ==> PROCESSES:                                                * 08520000
      *  - ALLOW SESSION TO USE UP TO 100MB OF MAIN MEMORY TO DO SORTS* 08530000
      *    IN MEMORY BEFORE GOING TO DISK.                            * 08540000
      * ==> SQLCODE:                                                  * 08550000
      *  - 0 = ALTER SESSION WAS SUCCESSFULL                          * 08560000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 08570000
      ***************************************************************** 08580000
       C110-ALTER-SESSION.                                              08590000
                                                                        08600000
           EXEC SQL                                                     08610000
               ALTER SESSION SET SORT_AREA_SIZE=104857600               08620000
           END-EXEC.                                                    08630000
                                                                        08640000
           EVALUATE TRUE                                                08650000
             WHEN SQLCODE = ZERO                                        08660000
                 CONTINUE                                               08670000
             WHEN OTHER                                                 08680000
               MOVE SQLCODE               TO PV-SQL                     08690000
               MOVE 'ALTER SESSION'       TO PV-TABLE-NAME              08700000
               MOVE 'C110-ALTER-SESSION'  TO PV-PARAGRAPH-NAME          08710000
               PERFORM Z100-ABEND                                       08720000
           END-EVALUATE.                                                08730000
                                                                        08740000
      ***************************************************************** 08750000
      * C200-DECLARE-ADMIN-CSR.                                       * 08760000
      * ==> PROCESSES:                                                * 08770000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 08780000
      *  - DECLARE CSR THAT RETRIEVES ADMIN INFO                      * 08790000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 08800000
      ***************************************************************** 08810000
       C200-DECLARE-ADMIN-CSR.                                          08820000
                                                                        08830000
           EXEC SQL                                                     08840000
                DECLARE ADMINCSR                                        08850000
                CURSOR FOR                                              08860000
                    SELECT /*+ FIRST_ROWS */                            08870000
                         A.TIER_PROMO_INTFC_ID                          08880000
                        ,A.PROMO_TIER_MDSE_ID                           08890000
                        ,A.PROMO_PRIC_VER_ID                            08900000
                        ,A.STR_SELN_TYP_CDE                             08910000
                        ,A.STR_SELN_HIER_LVL_CDE                        08920000
                        ,A.ADHC_STR_GP_ID                               08930000
                        ,A.ZONE_GROUP_ID                                08940000
                        ,A.ZONE_ID                                      08950000
                        ,TO_CHAR(A.VER_STRT_TMST,                       08960000
                                           'YYYY-MM-DD-HH24.MI.SS')     08970000
                        ,TO_CHAR(A.VER_END_TMST,                        08980000
                                           'YYYY-MM-DD-HH24.MI.SS')     08990000
                        ,TO_CHAR(A.VER_STRT_TMST, 'HH24.MI')            09000000
                        ,TO_CHAR(A.VER_END_TMST, 'HH24.MI')             09010000
                        ,A.STAT_CDE                                     09020000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       09030000
                                             'YYYY-MM-DD-HH24.MI.SS')   09040000
                        ,TO_CHAR(A.SORT_LAST_UPD_TMST,                  09050000
                                             'YYYY-MM-DD-HH24.MI.SS')   09060000
                    FROM PMV_STR_GP_ADM_TIER A                          09070000
                    WHERE A.VER_END_TMST >= TO_DATE(                    09080000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   09090000
                      AND A.VER_STRT_TMST <= TO_DATE(                   09100000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    09110000
           END-EXEC.                                                    09120000
                                                                        09130000
      ***************************************************************** 09140000
      * C210-DECLARE-ADMINOVR-CSR.                                    * 09150000
      * ==> PROCESSES:                                                * 09160000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 09170000
      *  - DECLARE CSR THAT RETRIEVES ADMIN OVERRIDE INFO             * 09180000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 09190000
      ***************************************************************** 09200000
       C210-DECLARE-ADMINOVR-CSR.                                       09210000
                                                                        09220000
           EXEC SQL                                                     09230000
                DECLARE ADMINOVRCSR                                     09240000
                CURSOR FOR                                              09250000
                    SELECT /*+ FIRST_ROWS */                            09260000
                         A.TIER_PROMO_INTFC_ID                          09270000
                        ,A.PROMO_TIER_MDSE_ID                           09280000
                        ,A.STR_SELN_TYP_CDE                             09290000
                        ,A.STR_SELN_HIER_LVL_CDE                        09300000
                        ,A.ADHC_STR_GP_ID                               09310000
                        ,A.ZONE_GROUP_ID                                09320000
                        ,A.ZONE_ID                                      09330000
                        ,A.PARENT_OVRRID_STR_GP_ID                      09340000
                        ,A.PARENT_OVRRID_STR_GP_TYP_CDE                 09350000
                        ,A.PARENT_OVRRID_ADHC_STR_GP_ID                 09360000
                        ,A.PARENT_OVRRID_STR_SELN_TYP_CDE               09370000
                        ,TO_CHAR(A.VER_STRT_TMST,                       09380000
                                           'YYYY-MM-DD-HH24.MI.SS')     09390000
                        ,TO_CHAR(A.VER_END_TMST,                        09400000
                                           'YYYY-MM-DD-HH24.MI.SS')     09410000
                        ,TO_CHAR(A.VER_STRT_TMST, 'HH24.MI')            09420000
                        ,TO_CHAR(A.VER_END_TMST, 'HH24.MI')             09430000
                        ,A.STAT_CDE                                     09440000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       09450000
                                             'YYYY-MM-DD-HH24.MI.SS')   09460000
                        ,TO_CHAR(A.SORT_LAST_UPD_TMST,                  09470000
                                             'YYYY-MM-DD-HH24.MI.SS')   09480000
                    FROM PMV_STR_GP_ADM_TIER_OVRD A                     09490000
                    WHERE A.VER_END_TMST >= TO_DATE(                    09500000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   09510000
                      AND A.VER_STRT_TMST <= TO_DATE(                   09520000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    09530000
           END-EXEC.                                                    09540000
                                                                        09550000
      ***************************************************************** 09560000
      * C220-DECLARE-CLRNC-CSR.                                       * 09570000
      * ==> PROCESSES:                                                * 09580000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 09590000
      *  - DECLARE CSR THAT RETRIEVES CLRNC INFO                      * 09600000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 09610000
      ***************************************************************** 09620000
       C220-DECLARE-CLRNC-CSR.                                          09630000
                                                                        09640000
           EXEC SQL                                                     09650000
                DECLARE CLRNCCSR                                        09660000
                CURSOR FOR                                              09670000
                    SELECT /*+ FIRST_ROWS */                            09680000
                         A.CLRNC_PROMO_INTFC_ID                         09690000
                        ,A.MDSE_SELN_LNE_ID                             09700000
                        ,A.STR_SELN_TYP_CDE                             09710000
                        ,A.STR_SELN_HIER_LVL_CDE                        09720000
                        ,A.ADHC_STR_GP_ID                               09730000
                        ,A.ZONE_GROUP_ID                                09740000
                        ,A.ZONE_ID                                      09750000
                        ,TO_CHAR(A.STRT_TMST,                           09760000
                                           'YYYY-MM-DD-HH24.MI.SS')     09770000
                        ,TO_CHAR(A.END_TMST,                            09780000
                                           'YYYY-MM-DD-HH24.MI.SS')     09790000
                        ,TO_CHAR(A.STRT_TMST, 'HH24.MI')                09800000
                        ,TO_CHAR(A.END_TMST, 'HH24.MI')                 09810000
                        ,A.STAT_CDE                                     09820000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       09830000
                                             'YYYY-MM-DD-HH24.MI.SS')   09840000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       09850000
                                             'YYYY-MM-DD-HH24.MI.SS')   09860000
                    FROM PMV_STR_GP_CLRNC A                             09870000
                    WHERE A.END_TMST >= TO_DATE(                        09880000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   09890000
                      AND A.STRT_TMST <= TO_DATE(                       09900000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    09910000
           END-EXEC.                                                    09920000
                                                                        09930000
      ***************************************************************** 09940000
      * C230-DECLARE-CMPTV-CSR.                                       * 09950000
      * ==> PROCESSES:                                                * 09960000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 09970000
      *  - DECLARE CSR THAT RETRIEVES CMPTV INFO                      * 09980000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 09990000
      ***************************************************************** 10000000
       C230-DECLARE-CMPTV-CSR.                                          10010000
                                                                        10020000
           EXEC SQL                                                     10030000
                DECLARE CMPTVCSR                                        10040000
                CURSOR FOR                                              10050000
                    SELECT /*+ FIRST_ROWS */                            10060000
                         A.CMPTV_PROMO_INTFC_ID                         10070000
                        ,A.MDSE_SELN_LNE_ID                             10080000
                        ,A.STR_SELN_TYP_CDE                             10090000
                        ,A.STR_SELN_HIER_LVL_CDE                        10100000
                        ,A.ADHC_STR_GP_ID                               10110000
                        ,A.ZONE_GROUP_ID                                10120000
                        ,A.ZONE_ID                                      10130000
                        ,TO_CHAR(A.CMPTV_PRICG_STRT_TMST ,              10140000
                                           'YYYY-MM-DD-HH24.MI.SS')     10150000
                        ,TO_CHAR(A.CMPTV_PRICG_END_TMST ,               10160000
                                           'YYYY-MM-DD-HH24.MI.SS')     10170000
                        ,TO_CHAR(A.CMPTV_PRICG_STRT_TMST, 'HH24.MI')    10180000
                        ,TO_CHAR(A.CMPTV_PRICG_END_TMST, 'HH24.MI')     10190000
                        ,A.STAT_CDE                                     10200000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       10210000
                                             'YYYY-MM-DD-HH24.MI.SS')   10220000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       10230000
                                             'YYYY-MM-DD-HH24.MI.SS')   10240000
                    FROM PMV_STR_GP_CMPTV_PRICG A                       10250000
                    WHERE A.CMPTV_PRICG_END_TMST >= TO_DATE(            10260000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   10270000
                      AND A.CMPTV_PRICG_STRT_TMST <= TO_DATE(           10280000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    10290000
           END-EXEC.                                                    10300000
                                                                        10310000
      ***************************************************************** 11160000
      * C250-DECLARE-GRPOVR-CSR.                                      * 11170000
      * ==> PROCESSES:                                                * 11180000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 11190000
      *  - DECLARE CSR THAT RETRIEVES GROUP OVERRIDE INFO             * 11200000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 11210000
      ***************************************************************** 11220000
       C250-DECLARE-GRPOVR-CSR.                                         11230000
                                                                        11240000
           EXEC SQL                                                     11250000
                DECLARE GRPOVRCSR                                       11260000
                CURSOR FOR                                              11270000
                    SELECT /*+ FIRST_ROWS */                            11280000
                         A.GP_PROMO_INTFC_ID                            11290000
                        ,A.MDSE_SELN_LNE_ID                             11300000
                        ,A.STR_SELN_TYP_CDE                             11310000
                        ,A.STR_SELN_HIER_LVL_CDE                        11320000
                        ,A.ADHC_STR_GP_ID                               11330000
                        ,A.ZONE_GROUP_ID                                11340000
                        ,A.ZONE_ID                                      11350000
                        ,A.PARENT_OVRRID_STR_GP_ID                      11360000
                        ,A.PARENT_OVRRID_STR_GP_TYP_CDE                 11370000
                        ,A.PARENT_OVRRID_ADHC_STR_GP_ID                 11380000
                        ,A.PARENT_OVRRID_STR_SELN_TYP_CDE               11390000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST ,                11400000
                                           'YYYY-MM-DD-HH24.MI.SS')     11410000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST ,                 11420000
                                           'YYYY-MM-DD-HH24.MI.SS')     11430000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST, 'HH24.MI')      11440000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST, 'HH24.MI')       11450000
                        ,A.ESL_TOPR_TYP_CDE                             11460000
                        ,A.STAT_CDE                                     11470000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       11480000
                                             'YYYY-MM-DD-HH24.MI.SS')   11490000
                        ,TO_CHAR(A.SORT_LAST_UPD_TMST,                  11500000
                                             'YYYY-MM-DD-HH24.MI.SS')   11510000
                    FROM PMV_STR_GP_GP_PRICG_OVRD A                     11520000
                    WHERE A.PROMO_ITM_END_TMST >= TO_DATE(              11530000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   11540000
                      AND A.PROMO_ITM_STRT_TMST <= TO_DATE(             11550000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    11560000
           END-EXEC.                                                    11570000
                                                                        11580000
      ***************************************************************** 11590000
      * C260-DECLARE-PROMO-CSR.                                       * 11600000
      * ==> PROCESSES:                                                * 11610000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 11620000
      *  - DECLARE CSR THAT RETRIEVES PROMO INFO                      * 11630000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 11640000
      ***************************************************************** 11650000
       C260-DECLARE-PROMO-CSR.                                          11660000
                                                                        11670000
           EXEC SQL                                                     11680000
                DECLARE PROMOCSR                                        11690000
                CURSOR FOR                                              11700000
                    SELECT /*+ FIRST_ROWS */                            11710000
                         A.ADV_IND                                      11720000
                        ,A.PROMO_ID                                     11730000
                        ,A.STR_SELN_ID                                  11740000
                        ,A.TIER_PROMO_INTFC_ID                          11750000
                        ,A.MDSE_SELN_LNE_ID                             11760000
                        ,A.STR_SELN_TYP_CDE                             11770000
                        ,A.STR_SELN_HIER_LVL_CDE                        11780000
                        ,A.ADHC_STR_GP_ID                               11790000
                        ,A.ZONE_GROUP_ID                                11800000
                        ,A.ZONE_ID                                      11810000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST ,                11820000
                                           'YYYY-MM-DD-HH24.MI.SS')     11830000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST ,                 11840000
                                           'YYYY-MM-DD-HH24.MI.SS')     11850000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST, 'HH24.MI')      11860000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST, 'HH24.MI')       11870000
                        ,A.ESL_TOPR_TYP_CDE                             11880000
                        ,A.STAT_CDE                                     11890000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       11900000
                                             'YYYY-MM-DD-HH24.MI.SS')   11910000
                        ,TO_CHAR(A.SORT_LAST_UPD_TMST,                  11920000
                                             'YYYY-MM-DD-HH24.MI.SS')   11930000
                        ,DECODE (A.ADV_IND,'Y',                         11940000
                         VT1.PROMO_PRIC_VER_ID,NULL) PROMO_PRIC_VER_ID  11950000
                    FROM PMV_STR_GP_PROMO_ITM_LVL_TIER A                11960000
                        ,(SELECT *                                      11970000
                          FROM PMT_PROMO_PRT_VER B                      11980000
                              ,PMT_PROMO_PRT_VER_RLT C                  11990000
                      WHERE B.PROMO_PRT_VER_ID = C.PROMO_PRT_VER_ID)VT1 12000000
                    WHERE A.PROMO_ITM_END_TMST >= TO_DATE(              12010000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   12020000
                      AND A.PROMO_ITM_STRT_TMST <= TO_DATE(             12030000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    12040000
                      AND A.PROMO_ID = VT1.PROMO_ID (+)                 12050000
                      AND A.STR_SELN_ID = VT1.STR_SELN_ID(+)            12060000
           END-EXEC.                                                    12070000
                                                                        12080000
      ***************************************************************** 12090000
      * C270-DECLARE-PROMOOVR-CSR.                                    * 12100000
      * ==> PROCESSES:                                                * 12110000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 12120000
      *  - DECLARE CSR THAT RETRIEVES PROMO OVERRIDE INFO             * 12130000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 12140000
      ***************************************************************** 12150000
       C270-DECLARE-PROMOOVR-CSR.                                       12160000
                                                                        12170000
           EXEC SQL                                                     12180000
                DECLARE PROMOOVRCSR                                     12190000
                CURSOR FOR                                              12200000
                    SELECT /*+ FIRST_ROWS */                            12210000
                         A.TIER_PROMO_INTFC_ID                          12220000
                        ,A.MDSE_SELN_LNE_ID                             12230000
                        ,A.STR_SELN_TYP_CDE                             12240000
                        ,A.STR_SELN_HIER_LVL_CDE                        12250000
                        ,A.ADHC_STR_GP_ID                               12260000
                        ,A.ZONE_GROUP_ID                                12270000
                        ,A.ZONE_ID                                      12280000
                        ,A.PARENT_OVRRID_STR_GP_ID                      12290000
                        ,A.PARENT_OVRRID_STR_GP_TYP_CDE                 12300000
                        ,A.PARENT_OVRRID_ADHC_STR_GP_ID                 12310000
                        ,A.PARENT_OVRRID_STR_SELN_TYP_CDE               12320000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST ,                12330000
                                           'YYYY-MM-DD-HH24.MI.SS')     12340000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST ,                 12350000
                                           'YYYY-MM-DD-HH24.MI.SS')     12360000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST, 'HH24.MI')      12370000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST, 'HH24.MI')       12380000
                        ,A.ESL_TOPR_TYP_CDE                             12390000
                        ,A.STAT_CDE                                     12400000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       12410000
                                             'YYYY-MM-DD-HH24.MI.SS')   12420000
                        ,TO_CHAR(A.SORT_LAST_UPD_TMST,                  12430000
                                             'YYYY-MM-DD-HH24.MI.SS')   12440000
                    FROM PMV_STR_GP_PROMO_ITM_TIER_OVRD A               12450000
                    WHERE A.PROMO_ITM_END_TMST >= TO_DATE(              12460000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   12470000
                      AND A.PROMO_ITM_STRT_TMST <= TO_DATE(             12480000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    12490000
           END-EXEC.                                                    12500000
                                                                        12510000
      ***************************************************************** 13360000
      * C290-DECLARE-SIMPOVR-CSR.                                     * 13370000
      * ==> PROCESSES:                                                * 13380000
      *  - USED A VIEW IN THE FROM CLAUSE INSTEAD OF IND TABLES       * 13390000
      *  - DECLARE CSR THAT RETRIEVES SIMPLE OVERRIDE INFO            * 13400000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 13410000
      ***************************************************************** 13420000
       C290-DECLARE-SIMPOVR-CSR.                                        13430000
                                                                        13440000
           EXEC SQL                                                     13450000
                DECLARE SIMPOVRCSR                                      13460000
                CURSOR FOR                                              13470000
                    SELECT /*+ FIRST_ROWS */                            13480000
                         A.SIMP_PROMO_INTFC_ID                          13490000
                        ,A.MDSE_SELN_LNE_ID                             13500000
                        ,A.STR_SELN_TYP_CDE                             13510000
                        ,A.STR_SELN_HIER_LVL_CDE                        13520000
                        ,A.ADHC_STR_GP_ID                               13530000
                        ,A.ZONE_GROUP_ID                                13540000
                        ,A.ZONE_ID                                      13550000
                        ,A.PARENT_OVRRID_STR_GP_ID                      13560000
                        ,A.PARENT_OVRRID_STR_GP_TYP_CDE                 13570000
                        ,A.PARENT_OVRRID_ADHC_STR_GP_ID                 13580000
                        ,A.PARENT_OVRRID_STR_SELN_TYP_CDE               13590000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST ,                13600000
                                           'YYYY-MM-DD-HH24.MI.SS')     13610000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST ,                 13620000
                                           'YYYY-MM-DD-HH24.MI.SS')     13630000
                        ,TO_CHAR(A.PROMO_ITM_STRT_TMST, 'HH24.MI')      13640000
                        ,TO_CHAR(A.PROMO_ITM_END_TMST, 'HH24.MI')       13650000
                        ,A.ESL_TOPR_TYP_CDE                             13660000
                        ,A.STAT_CDE                                     13670000
                        ,TO_CHAR(A.LAST_UPD_TMST,                       13680000
                                             'YYYY-MM-DD-HH24.MI.SS')   13690000
                        ,TO_CHAR(A.SORT_LAST_UPD_TMST,                  13700000
                                             'YYYY-MM-DD-HH24.MI.SS')   13710000
                    FROM PMV_STR_GP_SIMP_NOT_NULL_OVRD A                13720000
                    WHERE A.PROMO_ITM_END_TMST >= TO_DATE(              13730000
                          :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')   13740000
                      AND A.PROMO_ITM_STRT_TMST <= TO_DATE(             13750000
                          :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')    13760000
           END-EXEC.                                                    13770000
                                                                        13780000
      ***************************************************************** 13790000
      * C295-DECLARE-ADEVNT-DTE-CSR.                                  * 13800000
      * ==> PROCESSES:                                                * 13810000
      *     - FIND THE DATE RANGES FOR THE AD EVENTS WITHIN THE DATE  * 13820000
      *       RANGE PASSED IN FROM THE CONTROL CARD.                  * 13830000
      * ==> PERFORMED FROM: A100-MAINLINE.                            * 13840000
      ***************************************************************** 13850000
       C295-DECLARE-ADEVNT-DTE-CSR.                                     13860000
                                                                        13870000
           EXEC SQL                                                     13880000
                DECLARE ADEVNTDTECSR                                    13890000
                CURSOR FOR                                              13900000
                    SELECT                                              13910000
                         A.AD_EVNT_ID                                   13920000
                        ,TO_CHAR(A.STRT_DTE, 'YYYY-MM-DD')              13930000
                        ,TO_CHAR(A.END_DTE, 'YYYY-MM-DD')               13940000
                    FROM                                                13950000
                        PMT_AD_EVNT A                                   13960000
                    WHERE                                               13970000
                          A.END_DTE >= TO_DATE(                         13980000
                           :PV-NEW-STRT-DATE, 'YYYY-MM-DD HH24:MI:SS')  13990000
                      AND A.STRT_DTE <= TO_DATE(                        14000000
                           :PV-NEW-END-DATE, 'YYYY-MM-DD HH24:MI:SS')   14010000
                    ORDER BY                                            14020000
                        A.STRT_DTE                                      14030000
                       ,A.END_DTE                                       14040000
           END-EXEC.                                                    14050000
                                                                        14060000
      ***************************************************************** 14070000
      * C300-OPEN-ADMIN-CSR.                                          * 14080000
      * ==> PROCESSES:                                                * 14090000
      *  - OPEN ADMINCSR                                              * 14100000
      * ==> SQLCODE:                                                  * 14110000
      *  - 0 = SUCCESSFULL OPEN                                       * 14120000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 14130000
      ***************************************************************** 14140000
       C300-OPEN-ADMIN-CSR.                                             14150000
                                                                        14160000
           ACCEPT CT-CPU-TIME FROM TIME.                                14170000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            14180000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           14190000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           14200000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          14210000
           DISPLAY 'START OPEN ADMIN-CSR: ' PV-CPU-TIME.                14220000
                                                                        14230000
           EXEC SQL                                                     14240000
                 OPEN ADMINCSR                                          14250000
           END-EXEC.                                                    14260000
                                                                        14270000
           ACCEPT CT-CPU-TIME FROM TIME.                                14280000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            14290000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           14300000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           14310000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          14320000
           DISPLAY 'FINISH OPEN ADMIN-CSR: ' PV-CPU-TIME.               14330000
                                                                        14340000
           EVALUATE TRUE                                                14350000
               WHEN SQLCODE = ZERO                                      14360000
                   CONTINUE                                             14370000
               WHEN OTHER                                               14380000
                   MOVE 'C300-OPEN-ADMIN-CSR         '                  14390000
                                     TO PV-PARAGRAPH-NAME               14400000
                   MOVE 'OPEN ERROR ON ADMIN-CSR'                       14410000
                                     TO PV-OPERATION-MSG-1              14420000
                   PERFORM Z100-ABEND                                   14430000
           END-EVALUATE.                                                14440000
                                                                        14450000
      ***************************************************************** 14460000
      * C310-OPEN-ADMINOVR-CSR.                                       * 14470000
      * ==> PROCESSES:                                                * 14480000
      *  - OPEN ADMINOVRCSR                                           * 14490000
      * ==> SQLCODE:                                                  * 14500000
      *  - 0 = SUCCESSFULL OPEN                                       * 14510000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 14520000
      ***************************************************************** 14530000
       C310-OPEN-ADMINOVR-CSR.                                          14540000
                                                                        14550000
           ACCEPT CT-CPU-TIME FROM TIME.                                14560000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            14570000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           14580000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           14590000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          14600000
           DISPLAY 'START OPEN ADMINOVR-CSR: ' PV-CPU-TIME.             14610000
                                                                        14620000
           EXEC SQL                                                     14630000
                 OPEN ADMINOVRCSR                                       14640000
           END-EXEC.                                                    14650000
                                                                        14660000
           ACCEPT CT-CPU-TIME FROM TIME.                                14670000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            14680000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           14690000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           14700000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          14710000
           DISPLAY 'FINISH OPEN ADMINOVR-CSR: ' PV-CPU-TIME.            14720000
                                                                        14730000
           EVALUATE TRUE                                                14740000
               WHEN SQLCODE = ZERO                                      14750000
                   CONTINUE                                             14760000
               WHEN OTHER                                               14770000
                   MOVE 'C310-OPEN-ADMINOVR-CSR      '                  14780000
                                     TO PV-PARAGRAPH-NAME               14790000
                   MOVE 'OPEN ERROR ON ADMINOVR-CURSOR '                14800000
                                     TO PV-OPERATION-MSG-1              14810000
                   PERFORM Z100-ABEND                                   14820000
           END-EVALUATE.                                                14830000
                                                                        14840000
      ***************************************************************** 14850000
      * C320-OPEN-CLRNC-CSR.                                          * 14860000
      * ==> PROCESSES:                                                * 14870000
      *  - OPEN CLRNCCSR                                              * 14880000
      * ==> SQLCODE:                                                  * 14890000
      *  - 0 = SUCCESSFULL OPEN                                       * 14900000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 14910000
      ***************************************************************** 14920000
       C320-OPEN-CLRNC-CSR.                                             14930000
                                                                        14940000
           ACCEPT CT-CPU-TIME FROM TIME.                                14950000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            14960000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           14970000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           14980000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          14990000
           DISPLAY 'START OPEN CLRNC-CSR: ' PV-CPU-TIME.                15000000
                                                                        15010000
           EXEC SQL                                                     15020000
                 OPEN CLRNCCSR                                          15030000
           END-EXEC.                                                    15040000
                                                                        15050000
           ACCEPT CT-CPU-TIME FROM TIME.                                15060000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            15070000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           15080000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           15090000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          15100000
           DISPLAY 'FINISH OPEN CLRNC-CSR: ' PV-CPU-TIME.               15110000
                                                                        15120000
           EVALUATE TRUE                                                15130000
               WHEN SQLCODE = ZERO                                      15140000
                   CONTINUE                                             15150000
               WHEN OTHER                                               15160000
                   MOVE 'C320-OPEN-CLRNC-CSR '                          15170000
                                     TO PV-PARAGRAPH-NAME               15180000
                   MOVE 'OPEN ERROR ON CLRNC-CSR '                      15190000
                                     TO PV-OPERATION-MSG-1              15200000
                   PERFORM Z100-ABEND                                   15210000
           END-EVALUATE.                                                15220000
                                                                        15230000
      ***************************************************************** 15240000
      * C330-OPEN-CMPTV-CSR.                                          * 15250000
      * ==> PROCESSES:                                                * 15260000
      *  - OPEN CMPTVCSR                                              * 15270000
      * ==> SQLCODE:                                                  * 15280000
      *  - 0 = SUCCESSFULL OPEN                                       * 15290000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 15300000
      ***************************************************************** 15310000
       C330-OPEN-CMPTV-CSR.                                             15320000
                                                                        15330000
           ACCEPT CT-CPU-TIME FROM TIME.                                15340000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            15350000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           15360000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           15370000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          15380000
           DISPLAY 'START OPEN CMPTV-CSR: ' PV-CPU-TIME.                15390000
                                                                        15400000
           EXEC SQL                                                     15410000
                 OPEN CMPTVCSR                                          15420000
           END-EXEC.                                                    15430000
                                                                        15440000
           ACCEPT CT-CPU-TIME FROM TIME.                                15450000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            15460000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           15470000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           15480000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          15490000
           DISPLAY 'FINISH OPEN CMPTV-CSR: ' PV-CPU-TIME.               15500000
                                                                        15510000
           EVALUATE TRUE                                                15520000
               WHEN SQLCODE = ZERO                                      15530000
                   CONTINUE                                             15540000
               WHEN OTHER                                               15550000
                   MOVE 'C330-OPEN-CMPTV-CSR.'                          15560000
                                     TO PV-PARAGRAPH-NAME               15570000
                   MOVE 'OPEN ERROR ON CMPTV-CSR '                      15580000
                                     TO PV-OPERATION-MSG-1              15590000
                   PERFORM Z100-ABEND                                   15600000
           END-EVALUATE.                                                15610000
                                                                        15620000
      ***************************************************************** 16020000
      * C350-OPEN-GRPOVR-CSR.                                         * 16030000
      * ==> PROCESSES:                                                * 16040000
      *  - OPEN GRPOVRCSR                                             * 16050000
      * ==> SQLCODE:                                                  * 16060000
      *  - 0 = SUCCESSFULL OPEN                                       * 16070000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 16080000
      ***************************************************************** 16090000
       C350-OPEN-GRPOVR-CSR.                                            16100000
                                                                        16110000
           ACCEPT CT-CPU-TIME FROM TIME.                                16120000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            16130000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           16140000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           16150000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          16160000
           DISPLAY 'START OPEN GRPOVR-CSR: ' PV-CPU-TIME.               16170000
                                                                        16180000
           EXEC SQL                                                     16190000
                 OPEN GRPOVRCSR                                         16200000
           END-EXEC.                                                    16210000
                                                                        16220000
           ACCEPT CT-CPU-TIME FROM TIME.                                16230000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            16240000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           16250000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           16260000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          16270000
           DISPLAY 'FINISH OPEN GRPOVR-CSR: ' PV-CPU-TIME.              16280000
                                                                        16290000
           EVALUATE TRUE                                                16300000
               WHEN SQLCODE = ZERO                                      16310000
                   CONTINUE                                             16320000
               WHEN OTHER                                               16330000
                   MOVE 'C350-OPEN-GRPOVR-CSR '                         16340000
                                     TO PV-PARAGRAPH-NAME               16350000
                   MOVE 'OPEN ERROR ON GRPOVR-CSR '                     16360000
                                     TO PV-OPERATION-MSG-1              16370000
                   PERFORM Z100-ABEND                                   16380000
           END-EVALUATE.                                                16390000
                                                                        16400000
      ***************************************************************** 16410000
      * C360-OPEN-PROMO-CSR.                                          * 16420000
      * ==> PROCESSES:                                                * 16430000
      *  - OPEN PROMOCSR                                              * 16440000
      * ==> SQLCODE:                                                  * 16450000
      *  - 0 = SUCCESSFULL OPEN                                       * 16460000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 16470000
      ***************************************************************** 16480000
       C360-OPEN-PROMO-CSR.                                             16490000
                                                                        16500000
           ACCEPT CT-CPU-TIME FROM TIME.                                16510000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            16520000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           16530000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           16540000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          16550000
           DISPLAY 'START OPEN PROMO-CSR: ' PV-CPU-TIME.                16560000
                                                                        16570000
           EXEC SQL                                                     16580000
                 OPEN PROMOCSR                                          16590000
           END-EXEC.                                                    16600000
                                                                        16610000
           ACCEPT CT-CPU-TIME FROM TIME.                                16620000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            16630000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           16640000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           16650000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          16660000
           DISPLAY 'FINISH OPEN PROMO-CSR: ' PV-CPU-TIME.               16670000
                                                                        16680000
           EVALUATE TRUE                                                16690000
               WHEN SQLCODE = ZERO                                      16700000
                   CONTINUE                                             16710000
               WHEN OTHER                                               16720000
                   MOVE 'C360-OPEN-PROMO-CSR  '                         16730000
                                     TO PV-PARAGRAPH-NAME               16740000
                   MOVE 'OPEN ERROR ON PROMO-CSR '                      16750000
                                     TO PV-OPERATION-MSG-1              16760000
                   PERFORM Z100-ABEND                                   16770000
           END-EVALUATE.                                                16780000
                                                                        16790000
      ***************************************************************** 16800000
      * C370-OPEN-PROMOOVR-CSR.                                       * 16810000
      * ==> PROCESSES:                                                * 16820000
      *  - OPEN PROMOOVRCSR                                           * 16830000
      * ==> SQLCODE:                                                  * 16840000
      *  - 0 = SUCCESSFULL OPEN                                       * 16850000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 16860000
      ***************************************************************** 16870000
       C370-OPEN-PROMOOVR-CSR.                                          16880000
                                                                        16890000
           ACCEPT CT-CPU-TIME FROM TIME.                                16900000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            16910000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           16920000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           16930000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          16940000
           DISPLAY 'START OPEN PROMOOVR-CSR: ' PV-CPU-TIME.             16950000
                                                                        16960000
           EXEC SQL                                                     16970000
                 OPEN PROMOOVRCSR                                       16980000
           END-EXEC.                                                    16990000
                                                                        17000000
           ACCEPT CT-CPU-TIME FROM TIME.                                17010000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            17020000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           17030000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           17040000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          17050000
           DISPLAY 'FINISH OPEN PROMOOVR-CSR: ' PV-CPU-TIME.            17060000
                                                                        17070000
           EVALUATE TRUE                                                17080000
               WHEN SQLCODE = ZERO                                      17090000
                   CONTINUE                                             17100000
               WHEN OTHER                                               17110000
                   MOVE 'C370-OPEN-PROMOOVR-CSR'                        17120000
                                     TO PV-PARAGRAPH-NAME               17130000
                   MOVE 'OPEN ERROR ON PROMOOVR-CSR '                   17140000
                                     TO PV-OPERATION-MSG-1              17150000
                   PERFORM Z100-ABEND                                   17160000
           END-EVALUATE.                                                17170000
                                                                        17570000
      ***************************************************************** 17580000
      * C390-OPEN-SIMPOVR-CSR.                                        * 17590000
      * ==> PROCESSES:                                                * 17600000
      *  - OPEN SIMPOVRCSR                                            * 17610000
      * ==> SQLCODE:                                                  * 17620000
      *  - 0 = SUCCESSFULL OPEN                                       * 17630000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 17640000
      ***************************************************************** 17650000
       C390-OPEN-SIMPOVR-CSR.                                           17660000
                                                                        17670000
           ACCEPT CT-CPU-TIME FROM TIME.                                17680000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            17690000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           17700000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           17710000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          17720000
           DISPLAY 'START OPEN SIMPOVR-CSR: ' PV-CPU-TIME.              17730000
                                                                        17740000
           EXEC SQL                                                     17750000
                 OPEN SIMPOVRCSR                                        17760000
           END-EXEC.                                                    17770000
                                                                        17780000
           ACCEPT CT-CPU-TIME FROM TIME.                                17790000
           MOVE CT-CPU-HR     TO  PV-CPU-HR.                            17800000
           MOVE CT-CPU-MIN    TO  PV-CPU-MIN.                           17810000
           MOVE CT-CPU-SEC    TO  PV-CPU-SEC.                           17820000
           MOVE CT-CPU-HSEC   TO  PV-CPU-HSEC.                          17830000
           DISPLAY 'FINISH OPEN SIMPOVR-CSR: ' PV-CPU-TIME.             17840000
                                                                        17850000
           EVALUATE TRUE                                                17860000
               WHEN SQLCODE = ZERO                                      17870000
                   CONTINUE                                             17880000
               WHEN OTHER                                               17890000
                   MOVE 'C390-OPEN-SIMPOVR-CSR '                        17900000
                                     TO PV-PARAGRAPH-NAME               17910000
                   MOVE 'OPEN ERROR ON SIMPOVR-CSR '                    17920000
                                     TO PV-OPERATION-MSG-1              17930000
                   PERFORM Z100-ABEND                                   17940000
           END-EVALUATE.                                                17950000
                                                                        17960000
      ***************************************************************** 17970000
      * C395-OPEN-ADEVNT-DTE-CSR                                      * 17980000
      * ==> PROCESSES:                                                * 17990000
      *  - OPEN ADEVNTDTECSR                                          * 18000000
      * ==> SQLCODE:                                                  * 18010000
      *  - 0 = SUCCESSFULL OPEN                                       * 18020000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 18030000
      ***************************************************************** 18040000
       C395-OPEN-ADEVNT-DTE-CSR.                                        18050000
                                                                        18060000
           EXEC SQL                                                     18070000
                 OPEN ADEVNTDTECSR                                      18080000
           END-EXEC.                                                    18090000
                                                                        18100000
           EVALUATE TRUE                                                18110000
               WHEN SQLCODE = ZERO                                      18120000
                   CONTINUE                                             18130000
               WHEN OTHER                                               18140000
                   MOVE 'C395-OPEN-ADEVNT-DTE-CSR '                     18150000
                                     TO PV-PARAGRAPH-NAME               18160000
                   MOVE 'OPEN ERROR ON ADEVNTDTECSR '                   18170000
                                     TO PV-OPERATION-MSG-1              18180000
                   PERFORM Z100-ABEND                                   18190000
           END-EVALUATE.                                                18200000
                                                                        18210000
      ****************************************************************  18220000
      * C400-FETCH-ADMIN-CSR.                                        *  18230000
      * ==> PROCESSES:                                                * 18240000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 18250000
      *    VARIABLES LISTED.                                          * 18260000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 18270000
      *    DATE THEN                                                  * 18280000
      *    - THEN MOVE TO THE COPYBOOK                                * 18290000
      * ==> SQLCODE:                                                  * 18300000
      *  - 0    = A ROW WAS FOUND                                     * 18310000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 18320000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 18330000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS, C500-PROCESS-ADMIN-CSR * 18340000
      ****************************************************************  18350000
       C400-FETCH-ADMIN-CSR.                                            18360000
                                                                        18370000
           EXEC SQL                                                     18380000
               FETCH ADMINCSR                                           18390000
                INTO  :PV-PROMO-INTFC-ID                                18400000
                    , :PV-MDSE-LNE-ID                                   18410000
                    , :PV-PROMO-PRIC-VER-ID                             18420000
                    , :PV-STR-SELN-TYP-CDE                              18430000
                    , :PV-STR-SELN-HIER-LVL-CDE                         18440000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 18450000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 18460000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      18470000
                    , :PV-STRT-TMST                                     18480000
                    , :PV-END-TMST                                      18490000
                    , :PV-ACT-STRT-TM                                   18500000
                    , :PV-ACT-END-TM                                    18510000
                    , :PV-STAT-CDE                                      18520000
                    , :PV-LAST-UPD-TMST                                 18530000
                    , :PV-SORT-LAST-UPD-TMST                            18540000
           END-EXEC.                                                    18550000
                                                                        18560000
           EVALUATE TRUE                                                18570000
               WHEN SQLCODE = ZERO                                      18580000
                   ADD 1 TO PA-FETCH-ADMIN-CNT                          18590000
                   ADD 1 TO PA-IND-FETCH-ADMIN-CNT                      18600000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             18610000
                       ADD 1 TO PA-WRITE-ADMIN-CNT                      18620000
                       ADD 1 TO PA-IND-WRITE-ADMIN-CNT                  18630000
                       SET PS-ADMIN-TYP TO TRUE                         18640000
                       PERFORM D100-MOVE-TO-CPYBK                       18650000
                   END-IF                                               18660000
               WHEN SQLCODE = 1403                                      18670000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         18680000
                                                PA-RECS-WRITTEN         18690000
                   DISPLAY ' ADMIN CNT FROM FETCH = ' PA-FETCH-ADMIN-CNT18700000
                   DISPLAY ' ADMIN CNT FROM WRITE = ' PA-WRITE-ADMIN-CNT18710000
                   DISPLAY ' IND ADMIN CNT FROM FETCH = '               18720000
                                                PA-IND-FETCH-ADMIN-CNT  18730000
                   DISPLAY ' IND ADMIN CNT FROM WRITE = '               18740000
                                                PA-IND-WRITE-ADMIN-CNT  18750000
                   DISPLAY 'END OF ADMIN CSR'                           18760000
                   SET PS-END-OF-ADMIN-CSR TO TRUE                      18770000
               WHEN OTHER                                               18780000
                   DISPLAY 'PROMO INTFC ID = ' PV-PROMO-INTFC-ID        18790000
                   MOVE 'C400-FETCH-ADMIN-CSR '                         18800000
                                     TO PV-PARAGRAPH-NAME               18810000
                   MOVE 'FETCH ERROR ON ADMIN-CSR'                      18820000
                                     TO PV-OPERATION-MSG-1              18830000
                   PERFORM Z100-ABEND                                   18840000
           END-EVALUATE.                                                18850000
                                                                        18860000
      ****************************************************************  18870000
      * C410-FETCH-ADMINOVR-CSR.                                     *  18880000
      * ==> PROCESSES:                                                * 18890000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 18900000
      *    VARIABLES LISTED.                                          * 18910000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 18920000
      *    DATE THEN                                                  * 18930000
      *    - THEN MOVE TO THE COPYBOOK                                * 18940000
      * ==> SQLCODE:                                                  * 18950000
      *  - 0    = A ROW WAS FOUND                                     * 18960000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 18970000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 18980000
      * ==>PERFORMED FROM:A200-PROCESS-CSRS, C510-PROCESS-ADMINOVR-CSR* 18990000
      ****************************************************************  19000000
       C410-FETCH-ADMINOVR-CSR.                                         19010000
                                                                        19020000
           EXEC SQL                                                     19030000
               FETCH ADMINOVRCSR                                        19040000
                INTO  :PV-PROMO-INTFC-ID                                19050000
                    , :PV-MDSE-LNE-ID                                   19060000
                    , :PV-STR-SELN-TYP-CDE                              19070000
                    , :PV-STR-SELN-HIER-LVL-CDE                         19080000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 19090000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 19100000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      19110000
                    , :PV-PRNT-OV-STR-GP-ID     :PV-OV-STR-GP-ID-NULL   19120000
                    , :PV-PRNT-OV-STR-GP-CDE    :PV-OV-STR-GP-CDE-NULL  19130000
                    , :PV-PRNT-OV-ADHC-STR-GP-ID :PV-OV-ADHC-STR-GP-NULL19140000
                    , :PV-PRNT-OV-STR-SELN-CDE  :PV-OV-STR-SELN-CDE-NULL19150000
                    , :PV-STRT-TMST                                     19160000
                    , :PV-END-TMST                                      19170000
                    , :PV-ACT-STRT-TM                                   19180000
                    , :PV-ACT-END-TM                                    19190000
                    , :PV-STAT-CDE                                      19200000
                    , :PV-LAST-UPD-TMST                                 19210000
                    , :PV-SORT-LAST-UPD-TMST                            19220000
           END-EXEC.                                                    19230000
                                                                        19240000
           EVALUATE TRUE                                                19250000
               WHEN SQLCODE = ZERO                                      19260000
                   ADD 1 TO PA-FETCH-ADMINOVR-CNT                       19270000
                   ADD 1 TO PA-IND-FETCH-ADMINOVR-CNT                   19280000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             19290000
                       ADD 1 TO PA-WRITE-ADMINOVR-CNT                   19300000
                       ADD 1 TO PA-IND-WRITE-ADMINOVR-CNT               19310000
                       SET PS-ADMINOVR-TYP TO TRUE                      19320000
                       PERFORM D100-MOVE-TO-CPYBK                       19330000
                   END-IF                                               19340000
               WHEN SQLCODE = 1403                                      19350000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         19360000
                                                PA-RECS-WRITTEN         19370000
                   DISPLAY ' ADMINOVR CNT FROM FETCH = '                19380000
                                                PA-FETCH-ADMINOVR-CNT   19390000
                   DISPLAY ' ADMINOVR CNT FROM WRITE = '                19400000
                                                PA-WRITE-ADMINOVR-CNT   19410000
                   DISPLAY ' IND ADMINOVR CNT FROM FETCH = '            19420000
                                              PA-IND-FETCH-ADMINOVR-CNT 19430000
                   DISPLAY ' IND ADMINOVR CNT FROM WRITE = '            19440000
                                              PA-IND-WRITE-ADMINOVR-CNT 19450000
                   DISPLAY 'END OF ADMINOVR CSR'                        19460000
                   SET PS-END-OF-ADMINOVR-CSR TO TRUE                   19470000
               WHEN OTHER                                               19480000
                   DISPLAY 'PROMO INTFC ID = ' PV-PROMO-INTFC-ID        19490000
                   MOVE 'C410-FETCH-ADMINOVR-CSR'                       19500000
                                     TO PV-PARAGRAPH-NAME               19510000
                   MOVE 'FETCH ERROR ON ADMINOVR-CSR'                   19520000
                                     TO PV-OPERATION-MSG-1              19530000
                   PERFORM Z100-ABEND                                   19540000
           END-EVALUATE.                                                19550000
                                                                        19560000
      ****************************************************************  19570000
      * C420-FETCH-CLRNC-CSR.                                        *  19580000
      * ==> PROCESSES:                                                * 19590000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 19600000
      *    VARIABLES LISTED.                                          * 19610000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 19620000
      *    DATE THEN                                                  * 19630000
      *    - THEN MOVE TO THE COPYBOOK                                * 19640000
      * ==> SQLCODE:                                                  * 19650000
      *  - 0    = A ROW WAS FOUND                                     * 19660000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 19670000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 19680000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS, C520-PROCESS-CLRNC-CSR * 19690000
      ****************************************************************  19700000
       C420-FETCH-CLRNC-CSR.                                            19710000
                                                                        19720000
           EXEC SQL                                                     19730000
               FETCH CLRNCCSR                                           19740000
                INTO  :PV-PROMO-INTFC-ID                                19750000
                    , :PV-MDSE-LNE-ID                                   19760000
                    , :PV-STR-SELN-TYP-CDE                              19770000
                    , :PV-STR-SELN-HIER-LVL-CDE                         19780000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 19790000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 19800000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      19810000
                    , :PV-STRT-TMST                                     19820000
                    , :PV-END-TMST                                      19830000
                    , :PV-ACT-STRT-TM                                   19840000
                    , :PV-ACT-END-TM                                    19850000
                    , :PV-STAT-CDE                                      19860000
                    , :PV-LAST-UPD-TMST                                 19870000
                    , :PV-SORT-LAST-UPD-TMST                            19880000
           END-EXEC.                                                    19890000
                                                                        19900000
           EVALUATE TRUE                                                19910000
               WHEN SQLCODE = ZERO                                      19920000
                   ADD 1 TO PA-FETCH-CLRNC-CNT                          19930000
                   ADD 1 TO PA-IND-FETCH-CLRNC-CNT                      19940000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             19950000
                       ADD 1 TO PA-WRITE-CLRNC-CNT                      19960000
                       ADD 1 TO PA-IND-WRITE-CLRNC-CNT                  19970000
                       SET PS-CLRNC-TYP TO TRUE                         19980000
                       PERFORM D100-MOVE-TO-CPYBK                       19990000
                   END-IF                                               20000000
               WHEN SQLCODE = 1403                                      20010000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         20020000
                                                PA-RECS-WRITTEN         20030000
                   DISPLAY ' CLRNC CNT FROM FETCH = ' PA-FETCH-CLRNC-CNT20040000
                   DISPLAY ' CLRNC CNT FROM WRITE = ' PA-WRITE-CLRNC-CNT20050000
                   DISPLAY ' IND CLRNC CNT FROM FETCH = '               20060000
                                                 PA-IND-FETCH-CLRNC-CNT 20070000
                   DISPLAY ' IND CLRNC CNT FROM WRITE = '               20080000
                                                 PA-IND-WRITE-CLRNC-CNT 20090000
                   DISPLAY 'END OF CLRNC CSR'                           20100000
                   SET PS-END-OF-CLRNC-CSR TO TRUE                      20110000
               WHEN OTHER                                               20120000
                   DISPLAY 'PROMO INFTC ID = ' PV-PROMO-INTFC-ID        20130000
                   MOVE 'C420-FETCH-CLRNC-CSR '                         20140000
                                     TO PV-PARAGRAPH-NAME               20150000
                   MOVE 'FETCH ERROR ON CLRNC-CSR '                     20160000
                                     TO PV-OPERATION-MSG-1              20170000
                   PERFORM Z100-ABEND                                   20180000
           END-EVALUATE.                                                20190000
                                                                        20200000
      ****************************************************************  20210000
      * C430-FETCH-CMPTV-CSR.                                        *  20220000
      * ==> PROCESSES:                                                * 20230000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 20240000
      *    VARIABLES LISTED.                                          * 20250000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 20260000
      *    DATE THEN                                                  * 20270000
      *    - THEN MOVE TO THE COPYBOOK                                * 20280000
      * ==> SQLCODE:                                                  * 20290000
      *  - 0    = A ROW WAS FOUND                                     * 20300000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 20310000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 20320000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS, C530-PROCESS-CMPTV-CSR * 20330000
      ****************************************************************  20340000
       C430-FETCH-CMPTV-CSR.                                            20350000
                                                                        20360000
           EXEC SQL                                                     20370000
               FETCH CMPTVCSR                                           20380000
                INTO  :PV-PROMO-INTFC-ID                                20390000
                    , :PV-MDSE-LNE-ID                                   20400000
                    , :PV-STR-SELN-TYP-CDE                              20410000
                    , :PV-STR-SELN-HIER-LVL-CDE                         20420000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 20430000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 20440000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      20450000
                    , :PV-STRT-TMST                                     20460000
                    , :PV-END-TMST                                      20470000
                    , :PV-ACT-STRT-TM                                   20480000
                    , :PV-ACT-END-TM                                    20490000
                    , :PV-STAT-CDE                                      20500000
                    , :PV-LAST-UPD-TMST                                 20510000
                    , :PV-SORT-LAST-UPD-TMST                            20520000
           END-EXEC.                                                    20530000
                                                                        20540000
           EVALUATE TRUE                                                20550000
               WHEN SQLCODE = ZERO                                      20560000
                   ADD 1 TO PA-FETCH-CMPTV-CNT                          20570000
                   ADD 1 TO PA-IND-FETCH-CMPTV-CNT                      20580000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             20590000
                       ADD 1 TO PA-WRITE-CMPTV-CNT                      20600000
                       ADD 1 TO PA-IND-WRITE-CMPTV-CNT                  20610000
                       SET PS-CMPTV-TYP TO TRUE                         20620000
                       PERFORM D100-MOVE-TO-CPYBK                       20630000
                   END-IF                                               20640000
               WHEN SQLCODE = 1403                                      20650000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         20660000
                                                PA-RECS-WRITTEN         20670000
                   DISPLAY ' CMPTV CNT FROM FETCH = ' PA-FETCH-CMPTV-CNT20680000
                   DISPLAY ' CMPTV CNT FROM WRITE = ' PA-WRITE-CMPTV-CNT20690000
                   DISPLAY ' IND CMPTV CNT FROM FETCH = '               20700000
                                                PA-IND-FETCH-CMPTV-CNT  20710000
                   DISPLAY ' IND CMPTV CNT FROM WRITE = '               20720000
                                                PA-IND-WRITE-CMPTV-CNT  20730000
                   DISPLAY 'END OF CMPTV CSR'                           20740000
                   SET PS-END-OF-CMPTV-CSR TO TRUE                      20750000
               WHEN OTHER                                               20760000
                   DISPLAY 'PROMO INFTC ID = ' PV-PROMO-INTFC-ID        20770000
                   MOVE 'C430-FETCH-CMPTV-CSR '                         20780000
                                     TO PV-PARAGRAPH-NAME               20790000
                   MOVE 'FETCH ERROR ON CMPTV-CSR '                     20800000
                                     TO PV-OPERATION-MSG-1              20810000
                   PERFORM Z100-ABEND                                   20820000
           END-EVALUATE.                                                20830000
                                                                        20840000
      ****************************************************************  21550000
      * C450-FETCH-GRPOVR-CSR.                                       *  21560000
      * ==> PROCESSES:                                                * 21570000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 21580000
      *    VARIABLES LISTED.                                          * 21590000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 21600000
      *    DATE THEN                                                  * 21610000
      *    - THEN MOVE TO THE COPYBOOK                                * 21620000
      * ==> SQLCODE:                                                  * 21630000
      *  - 0    = A ROW WAS FOUND                                     * 21640000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 21650000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 21660000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS, C550-PROCESS-GRPOVR-CSR* 21670000
      ****************************************************************  21680000
       C450-FETCH-GRPOVR-CSR.                                           21690000
                                                                        21700000
           EXEC SQL                                                     21710000
               FETCH GRPOVRCSR                                          21720000
                INTO  :PV-PROMO-INTFC-ID                                21730000
                    , :PV-MDSE-LNE-ID                                   21740000
                    , :PV-STR-SELN-TYP-CDE                              21750000
                    , :PV-STR-SELN-HIER-LVL-CDE                         21760000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 21770000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 21780000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      21790000
                    , :PV-PRNT-OV-STR-GP-ID     :PV-OV-STR-GP-ID-NULL   21800000
                    , :PV-PRNT-OV-STR-GP-CDE    :PV-OV-STR-GP-CDE-NULL  21810000
                    , :PV-PRNT-OV-ADHC-STR-GP-ID :PV-OV-ADHC-STR-GP-NULL21820000
                    , :PV-PRNT-OV-STR-SELN-CDE  :PV-OV-STR-SELN-CDE-NULL21830000
                    , :PV-STRT-TMST                                     21840000
                    , :PV-END-TMST                                      21850000
                    , :PV-ACT-STRT-TM                                   21860000
                    , :PV-ACT-END-TM                                    21870000
                    , :PV-ESL-TOPR-TYP-CDE     :PV-ESL-TOPR-TYP-CDE-NULL21880000
                    , :PV-STAT-CDE                                      21890000
                    , :PV-LAST-UPD-TMST                                 21900000
                    , :PV-SORT-LAST-UPD-TMST                            21910000
           END-EXEC.                                                    21920000
                                                                        21930000
           EVALUATE TRUE                                                21940000
               WHEN SQLCODE = ZERO                                      21950000
                   ADD 1 TO PA-FETCH-GRPOVR-CNT                         21960000
                   ADD 1 TO PA-IND-FETCH-GRPOVR-CNT                     21970000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             21980000
                       ADD 1 TO PA-WRITE-GRPOVR-CNT                     21990000
                       ADD 1 TO PA-IND-WRITE-GRPOVR-CNT                 22000000
                       SET PS-GRPOVR-TYP TO TRUE                        22010000
                       PERFORM D100-MOVE-TO-CPYBK                       22020000
                   END-IF                                               22030000
               WHEN SQLCODE = 1403                                      22040000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         22050000
                                                PA-RECS-WRITTEN         22060000
                   DISPLAY ' GRPOVR CNT FROM FETCH = '                  22070000
                                                   PA-FETCH-GRPOVR-CNT  22080000
                   DISPLAY ' GRPOVR CNT FROM WRITE = '                  22090000
                                                   PA-WRITE-GRPOVR-CNT  22100000
                   DISPLAY ' IND GRPOVR CNT FROM FETCH = '              22110000
                                                PA-IND-FETCH-GRPOVR-CNT 22120000
                   DISPLAY ' IND GRPOVR CNT FROM WRITE = '              22130000
                                                PA-IND-WRITE-GRPOVR-CNT 22140000
                   DISPLAY 'END OF GRPOVR CSR'                          22150000
                   SET PS-END-OF-GRPOVR-CSR TO TRUE                     22160000
               WHEN OTHER                                               22170000
                   DISPLAY 'PROMO INTFC ID = ' PV-PROMO-INTFC-ID        22180000
                   MOVE 'C450-FETCH-GRPOVR-CSR '                        22190000
                                     TO PV-PARAGRAPH-NAME               22200000
                   MOVE 'FETCH ERROR ON GRPOVR-CSR'                     22210000
                                     TO PV-OPERATION-MSG-1              22220000
                   PERFORM Z100-ABEND                                   22230000
           END-EVALUATE.                                                22240000
                                                                        22250000
      ***************************************************************** 22260000
      * C460-FETCH-PROMO-CSR.                                         * 22270000
      * ==> PROCESSES:                                                * 22280000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 22290000
      *    VARIABLES LISTED.                                          * 22300000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 22310000
      *    DATE THEN                                                  * 22320000
      *    - FIND PRICE VERSION                                       * 22330000
      *    - THEN MOVE TO THE COPYBOOK                                * 22340000
      * ==> SQLCODE:                                                  * 22350000
      *  - 0    = A ROW WAS FOUND                                     * 22360000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 22370000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 22380000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS, C560-PROCESS-PROMO-CSR * 22390000
      ****************************************************************  22400000
       C460-FETCH-PROMO-CSR.                                            22410000
                                                                        22420000
           EXEC SQL                                                     22430000
               FETCH PROMOCSR                                           22440000
                INTO  :PV-ADV-IND                                       22450000
                    , :PV-PROMO-ID                                      22460000
                    , :PV-STR-SELN-ID                                   22470000
                    , :PV-PROMO-INTFC-ID                                22480000
                    , :PV-MDSE-LNE-ID                                   22490000
                    , :PV-STR-SELN-TYP-CDE                              22500000
                    , :PV-STR-SELN-HIER-LVL-CDE                         22510000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 22520000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 22530000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      22540000
                    , :PV-STRT-TMST                                     22550000
                    , :PV-END-TMST                                      22560000
                    , :PV-ACT-STRT-TM                                   22570000
                    , :PV-ACT-END-TM                                    22580000
                    , :PV-ESL-TOPR-TYP-CDE     :PV-ESL-TOPR-TYP-CDE-NULL22590000
                    , :PV-STAT-CDE                                      22600000
                    , :PV-LAST-UPD-TMST                                 22610000
                    , :PV-SORT-LAST-UPD-TMST                            22620000
                    , :PV-PROMO-PRIC-VER-ID   :PV-PROMO-PRIC-VER-ID-NULL22630000
           END-EXEC.                                                    22640000
                                                                        22650000
           EVALUATE TRUE                                                22660000
               WHEN SQLCODE = ZERO                                      22670000
                   ADD 1 TO PA-FETCH-PROMO-CNT                          22680000
                   ADD 1 TO PA-IND-FETCH-PROMO-CNT                      22690000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             22700000
                       ADD 1 TO PA-WRITE-PROMO-CNT                      22710000
                       ADD 1 TO PA-IND-WRITE-PROMO-CNT                  22720000
                       SET PS-PROMO-TYP TO TRUE                         22730000
                       PERFORM D100-MOVE-TO-CPYBK                       22740000
                   END-IF                                               22750000
               WHEN SQLCODE = 1403                                      22760000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         22770000
                                                PA-RECS-WRITTEN         22780000
                   DISPLAY ' PROMO CNT FROM FETCH = ' PA-FETCH-PROMO-CNT22790000
                   DISPLAY ' PROMO CNT FROM WRITE = ' PA-WRITE-PROMO-CNT22800000
                   DISPLAY ' IND PROMO CNT FROM FETCH = '               22810000
                                                 PA-IND-FETCH-PROMO-CNT 22820000
                   DISPLAY ' IND PROMO CNT FROM WRITE = '               22830000
                                                 PA-IND-WRITE-PROMO-CNT 22840000
                   DISPLAY 'END OF PROMO CSR'                           22850000
                   SET PS-END-OF-PROMO-CSR TO TRUE                      22860000
               WHEN OTHER                                               22870000
                   DISPLAY 'PROMO INFTC ID = ' PV-PROMO-INTFC-ID        22880000
                   MOVE 'C460-FETCH-PROMO-CSR '                         22890000
                                     TO PV-PARAGRAPH-NAME               22900000
                   MOVE 'FETCH ERROR ON PROMO-CSR '                     22910000
                                     TO PV-OPERATION-MSG-1              22920000
                   PERFORM Z100-ABEND                                   22930000
           END-EVALUATE.                                                22940000
                                                                        22950000
      ****************************************************************  22960000
      * C470-FETCH-PROMOOVR-CSR.                                     *  22970000
      * ==> PROCESSES:                                                * 22980000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 22990000
      *    VARIABLES LISTED.                                          * 23000000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 23010000
      *    DATE THEN                                                  * 23020000
      *    - THEN MOVE TO THE COPYBOOK                                * 23030000
      * ==> SQLCODE:                                                  * 23040000
      *  - 0    = A ROW WAS FOUND                                     * 23050000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 23060000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 23070000
      * ==>PERFORMED FROM:A200-PROCESS-CSRS, C570-PROCESS-PROMOOVR-CSR* 23080000
      ***************************************************************** 23090000
       C470-FETCH-PROMOOVR-CSR.                                         23100000
                                                                        23110000
           EXEC SQL                                                     23120000
               FETCH PROMOOVRCSR                                        23130000
                INTO  :PV-PROMO-INTFC-ID                                23140000
                    , :PV-MDSE-LNE-ID                                   23150000
                    , :PV-STR-SELN-TYP-CDE                              23160000
                    , :PV-STR-SELN-HIER-LVL-CDE                         23170000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 23180000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 23190000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      23200000
                    , :PV-PRNT-OV-STR-GP-ID     :PV-OV-STR-GP-ID-NULL   23210000
                    , :PV-PRNT-OV-STR-GP-CDE    :PV-OV-STR-GP-CDE-NULL  23220000
                    , :PV-PRNT-OV-ADHC-STR-GP-ID :PV-OV-ADHC-STR-GP-NULL23230000
                    , :PV-PRNT-OV-STR-SELN-CDE  :PV-OV-STR-SELN-CDE-NULL23240000
                    , :PV-STRT-TMST                                     23250000
                    , :PV-END-TMST                                      23260000
                    , :PV-ACT-STRT-TM                                   23270000
                    , :PV-ACT-END-TM                                    23280000
                    , :PV-ESL-TOPR-TYP-CDE     :PV-ESL-TOPR-TYP-CDE-NULL23290000
                    , :PV-STAT-CDE                                      23300000
                    , :PV-LAST-UPD-TMST                                 23310000
                    , :PV-SORT-LAST-UPD-TMST                            23320000
           END-EXEC.                                                    23330000
                                                                        23340000
           EVALUATE TRUE                                                23350000
               WHEN SQLCODE = ZERO                                      23360000
                   ADD 1 TO PA-FETCH-PROMOOVR-CNT                       23370000
                   ADD 1 TO PA-IND-FETCH-PROMOOVR-CNT                   23380000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             23390000
                       ADD 1 TO PA-WRITE-PROMOOVR-CNT                   23400000
                       ADD 1 TO PA-IND-WRITE-PROMOOVR-CNT               23410000
                       SET PS-PROMOOVR-TYP TO TRUE                      23420000
                       PERFORM D100-MOVE-TO-CPYBK                       23430000
                   END-IF                                               23440000
               WHEN SQLCODE = 1403                                      23450000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         23460000
                                                PA-RECS-WRITTEN         23470000
                   DISPLAY ' PROMOOVR CNT FROM FETCH = '                23480000
                                               PA-FETCH-PROMOOVR-CNT    23490000
                   DISPLAY ' PROMOOVR CNT FROM WRITE = '                23500000
                                               PA-WRITE-PROMOOVR-CNT    23510000
                   DISPLAY ' IND PROMOOVR CNT FROM FETCH = '            23520000
                                               PA-IND-FETCH-PROMOOVR-CNT23530000
                   DISPLAY ' IND PROMOOVR CNT FROM WRITE = '            23540000
                                               PA-IND-WRITE-PROMOOVR-CNT23550000
                   DISPLAY 'END OF PROMOOVR CSR'                        23560000
                   SET PS-END-OF-PROMOOVR-CSR TO TRUE                   23570000
               WHEN OTHER                                               23580000
                   DISPLAY 'PROMO INTFC ID = ' PV-PROMO-INTFC-ID        23590000
                   MOVE 'C470-FETCH-PROMOOVR-CSR '                      23600000
                                     TO PV-PARAGRAPH-NAME               23610000
                   MOVE 'FETCH ERROR ON PROMOOVR-CSR'                   23620000
                                     TO PV-OPERATION-MSG-1              23630000
                   PERFORM Z100-ABEND                                   23640000
           END-EVALUATE.                                                23650000
                                                                        23660000
      ****************************************************************  24370000
      * C490-FETCH-SIMPOVR-CSR.                                      *  24380000
      * ==> PROCESSES:                                                * 24390000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 24400000
      *    VARIABLES LISTED.                                          * 24410000
      *  - IF THE LST UPDATE DATE IS LESS THEN THE CURRENT LAST UPDATE* 24420000
      *    DATE THEN                                                  * 24430000
      *    - FIND PRICE VERSION                                       * 24440000
      *    - THEN MOVE TO THE COPYBOOK                                * 24450000
      * ==> SQLCODE:                                                  * 24460000
      *  - 0    = A ROW WAS FOUND                                     * 24470000
      *  - 1405 = FETCHED COLUMN VALUE IS NULL REASON FOR NULL VALUES * 24480000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 24490000
      * ==> PERFORMED FROM:A200-PROCESS-CSRS, C590-PROCESS-SIMPOVR-CSR* 24500000
      ****************************************************************  24510000
       C490-FETCH-SIMPOVR-CSR.                                          24520000
                                                                        24530000
           EXEC SQL                                                     24540000
               FETCH SIMPOVRCSR                                         24550000
                INTO  :PV-PROMO-INTFC-ID                                24560000
                    , :PV-MDSE-LNE-ID                                   24570000
                    , :PV-STR-SELN-TYP-CDE                              24580000
                    , :PV-STR-SELN-HIER-LVL-CDE                         24590000
                    , :PV-ADHC-STR-GP-ID        :PV-ADHC-STR-GP-ID-NULL 24600000
                    , :PV-STR-GP-TYP-CDE        :PV-STR-GP-TYP-CDE-NULL 24610000
                    , :PV-STR-GP-ID             :PV-STR-GP-ID-NULL      24620000
                    , :PV-PRNT-OV-STR-GP-ID     :PV-OV-STR-GP-ID-NULL   24630000
                    , :PV-PRNT-OV-STR-GP-CDE    :PV-OV-STR-GP-CDE-NULL  24640000
                    , :PV-PRNT-OV-ADHC-STR-GP-ID :PV-OV-ADHC-STR-GP-NULL24650000
                    , :PV-PRNT-OV-STR-SELN-CDE  :PV-OV-STR-SELN-CDE-NULL24660000
                    , :PV-STRT-TMST                                     24670000
                    , :PV-END-TMST                                      24680000
                    , :PV-ACT-STRT-TM                                   24690000
                    , :PV-ACT-END-TM                                    24700000
                    , :PV-ESL-TOPR-TYP-CDE     :PV-ESL-TOPR-TYP-CDE-NULL24710000
                    , :PV-STAT-CDE                                      24720000
                    , :PV-LAST-UPD-TMST                                 24730000
                    , :PV-SORT-LAST-UPD-TMST                            24740000
           END-EXEC.                                                    24750000
                                                                        24760000
           EVALUATE TRUE                                                24770000
               WHEN SQLCODE = ZERO                                      24780000
                   ADD 1 TO PA-FETCH-SIMPOVR-CNT                        24790000
                   ADD 1 TO PA-IND-FETCH-SIMPOVR-CNT                    24800000
                   IF PV-LAST-UPD-TMST <=  CC-LAST-UPD-TMST             24810000
                       ADD 1 TO PA-WRITE-SIMPOVR-CNT                    24820000
                       ADD 1 TO PA-IND-WRITE-SIMPOVR-CNT                24830000
                       SET PS-SIMPOVR-TYP TO TRUE                       24840000
                       PERFORM D100-MOVE-TO-CPYBK                       24850000
                   END-IF                                               24860000
               WHEN SQLCODE = 1403                                      24870000
                   DISPLAY ' RECORDS WRITTEN TO FILE SO FAR = '         24880000
                                                PA-RECS-WRITTEN         24890000
                   DISPLAY ' SIMPOVR CNT FROM FETCH = '                 24900000
                                                  PA-FETCH-SIMPOVR-CNT  24910000
                   DISPLAY ' SIMPOVR CNT FROM WRITE = '                 24920000
                                                  PA-WRITE-SIMPOVR-CNT  24930000
                   DISPLAY ' IND SIMPOVR CNT FROM FETCH = '             24940000
                                               PA-IND-FETCH-SIMPOVR-CNT 24950000
                   DISPLAY ' IND SIMPOVR CNT FROM WRITE = '             24960000
                                               PA-IND-WRITE-SIMPOVR-CNT 24970000
                   DISPLAY 'END OF SIMPOVR CSR'                         24980000
                   SET PS-END-OF-SIMPOVR-CSR TO TRUE                    24990000
               WHEN OTHER                                               25000000
                   DISPLAY 'PROMO INTFC ID = ' PV-PROMO-INTFC-ID        25010000
                   MOVE 'C490-FETCH-SIMPOVR-CSR  '                      25020000
                                     TO PV-PARAGRAPH-NAME               25030000
                   MOVE 'FETCH ERROR ON SIMPOVR-CSR'                    25040000
                                     TO PV-OPERATION-MSG-1              25050000
                   PERFORM Z100-ABEND                                   25060000
           END-EVALUATE.                                                25070000
                                                                        25080000
      ***************************************************************** 25090000
      * C495-FETCH-ADEVNT-DTE-CSR                                     * 25100000
      * ==> PROCESSES:                                                * 25110000
      *  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 25120000
      *    VARIABLES LISTED.                                          * 25130000
      * ==> SQLCODE:                                                  * 25140000
      *  - 0    = A ROW WAS FOUND                                     * 25150000
      *  - 1403 = WHEN NO DATA WAS FOUND                              * 25160000
      * ==> PERFORMED FROM: A100-MAINLINE, C595-PROCESS-ADEVNT-DTE-CSR* 25170000
      ***************************************************************** 25180000
       C495-FETCH-ADEVNT-DTE-CSR.                                       25190000
                                                                        25200000
           EXEC SQL                                                     25210000
               FETCH ADEVNTDTECSR                                       25220000
                INTO  :PV-ADEVNT-ID                                     25230000
                    , :PV-ADEVNT-STRT-DTE                               25240000
                    , :PV-ADEVNT-END-DTE                                25250000
           END-EXEC.                                                    25260000
                                                                        25270000
           EVALUATE TRUE                                                25280000
               WHEN SQLCODE = ZERO                                      25290000
                   ADD 1 TO PA-ADEVNT-DATE                              25300000
                                                                        25310000
               WHEN SQLCODE = 1403                                      25320000
                   DISPLAY 'END OF ADEVNTDTECSR'                        25330000
                   SET PS-END-OF-ADEVNT-DTE-CSR TO TRUE                 25340000
                                                                        25350000
               WHEN OTHER                                               25360000
                   MOVE 'C495-FETCH-ADEVNT-DTE-CSR   '                  25370000
                                     TO PV-PARAGRAPH-NAME               25380000
                   MOVE 'FETCH ERROR ON ADEVNTDTECSR '                  25390000
                                     TO PV-OPERATION-MSG-1              25400000
                   PERFORM Z100-ABEND                                   25410000
           END-EVALUATE.                                                25420000
                                                                        25430000
      ***************************************************************** 25440000
      * C500-PROCESS-ADMIN-CSR.                                       * 25450000
      * ==> PROCESSES:                                                * 25460000
      *  - WRITE THE DATA TO THE FILE                                 * 25470000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 25480000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 25490000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 25500000
      ***************************************************************** 25510000
       C500-PROCESS-ADMIN-CSR.                                          25520000
                                                                        25530000
           INITIALIZE PV-SELECT-VARIABLES.                              25540000
           PERFORM C400-FETCH-ADMIN-CSR.                                25550000
                                                                        25560000
      ***************************************************************** 25570000
      * C510-PROCESS-ADMINOVR-CSR.                                    * 25580000
      * ==> PROCESSES:                                                * 25590000
      *  - WRITE THE DATA TO THE FILE                                 * 25600000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 25610000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 25620000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 25630000
      ***************************************************************** 25640000
       C510-PROCESS-ADMINOVR-CSR.                                       25650000
                                                                        25660000
           INITIALIZE PV-SELECT-VARIABLES.                              25670000
           PERFORM C410-FETCH-ADMINOVR-CSR.                             25680000
                                                                        25690000
      ****************************************************************  25700000
      * C520-PROCESS-CLRNC-CSR.                                      *  25710000
      * ==> PROCESSES:                                                * 25720000
      *  - WRITE THE DATA TO THE FILE                                 * 25730000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 25740000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 25750000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 25760000
      ****************************************************************  25770000
       C520-PROCESS-CLRNC-CSR.                                          25780000
                                                                        25790000
           INITIALIZE PV-SELECT-VARIABLES.                              25800000
           PERFORM C420-FETCH-CLRNC-CSR.                                25810000
                                                                        25820000
      ****************************************************************  25830000
      * C530-PROCESS-CMPTV-CSR.                                      *  25840000
      * ==> PROCESSES:                                                * 25850000
      *  - WRITE THE DATA TO THE FILE                                 * 25860000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 25870000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 25880000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 25890000
      ****************************************************************  25900000
       C530-PROCESS-CMPTV-CSR.                                          25910000
                                                                        25920000
           INITIALIZE PV-SELECT-VARIABLES.                              25930000
           PERFORM C430-FETCH-CMPTV-CSR.                                25940000
                                                                        25950000
      ****************************************************************  26090000
      * C550-PROCESS-GRPOVR-CSR.                                        26100000
      * ==> PROCESSES:                                                * 26110000
      *  - WRITE THE DATA TO THE FILE                                 * 26120000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 26130000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 26140000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 26150000
      ****************************************************************  26160000
       C550-PROCESS-GRPOVR-CSR.                                         26170000
                                                                        26180000
           INITIALIZE PV-SELECT-VARIABLES.                              26190000
           PERFORM C450-FETCH-GRPOVR-CSR.                               26200000
                                                                        26210000
      ****************************************************************  26220000
      * C560-PROCESS-PROMO-CSR.                                      *  26230000
      * ==> PROCESSES:                                                * 26240000
      *  - WRITE THE DATA TO THE FILE                                 * 26250000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 26260000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 26270000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 26280000
      ****************************************************************  26290000
       C560-PROCESS-PROMO-CSR.                                          26300000
                                                                        26310000
           INITIALIZE PV-SELECT-VARIABLES.                              26320000
           PERFORM C460-FETCH-PROMO-CSR.                                26330000
                                                                        26340000
      ****************************************************************  26350000
      * C570-PROCESS-PROMOOVR-CSR.                                   *  26360000
      * ==> PROCESSES:                                                * 26370000
      *  - WRITE THE DATA TO THE FILE                                 * 26380000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 26390000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 26400000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 26410000
      ****************************************************************  26420000
       C570-PROCESS-PROMOOVR-CSR.                                       26430000
                                                                        26440000
           INITIALIZE PV-SELECT-VARIABLES.                              26450000
           PERFORM C470-FETCH-PROMOOVR-CSR.                             26460000
                                                                        26600000
      ****************************************************************  26610000
      * C590-PROCESS-SIMPOVR-CSR.                                    *  26620000
      * ==> PROCESSES:                                                * 26630000
      *  - WRITE THE DATA TO THE FILE                                 * 26640000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 26650000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 26660000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 26670000
      ****************************************************************  26680000
       C590-PROCESS-SIMPOVR-CSR.                                        26690000
                                                                        26700000
           INITIALIZE PV-SELECT-VARIABLES.                              26710000
           PERFORM C490-FETCH-SIMPOVR-CSR.                              26720000
                                                                        26730000
      ****************************************************************  26740000
      * C595-PROCESS-ADEVNT-DTE-CSR                                  *  26750000
      * ==> PROCESSES:                                                * 26760000
      *  - DETERMINE THE DATES TO BE USED IN THE CURSORS              * 26770000
      *  - REINITALIZE THE VARIABLES TO START FROM SCRATCH            * 26780000
      *  - FETCH THE NEXT ROW IN THE SELECT STATMENT                  * 26790000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 26800000
      ****************************************************************  26810000
       C595-PROCESS-ADEVNT-DTE-CSR.                                     26820000
                                                                        26830000
           IF PA-ADEVNT-DATE > 1                                        26840000
               PERFORM C105-ADD-ONE-DAY                                 26850000
               IF PV-ADEVNT-STRT-DTE > PV-NEXT-DATE                     26860000
                   STRING PV-NEXT-DATE DELIMITED BY SPACE               26870000
                          PC-SPACE DELIMITED BY SIZE                    26880000
                          PC-BEG-TMST   DELIMITED BY SIZE               26890000
                          INTO PV-NEW-STRT-DATE                         26900000
                                                                        26910000
                   IF  PV-MINUS-DATE > CC-END-DATE                      26920000
                       STRING CC-END-DATE DELIMITED BY SPACE            26930000
                              PC-SPACE DELIMITED BY SIZE                26940000
                              PC-END-TMST   DELIMITED BY SIZE           26950000
                              INTO PV-NEW-END-DATE                      26960000
                   ELSE                                                 26970000
                       STRING PV-MINUS-DATE DELIMITED BY SPACE          26980000
                              PC-SPACE DELIMITED BY SIZE                26990000
                              PC-END-TMST   DELIMITED BY SIZE           27000000
                              INTO PV-NEW-END-DATE                      27010000
                   END-IF                                               27020000
                                                                        27030000
                   DISPLAY 'START DATE = ' PV-NEW-STRT-DATE             27040000
                   DISPLAY 'END DATE   = ' PV-NEW-END-DATE              27050000
                   PERFORM A200-PROCESS-CSRS                            27060000
               END-IF                                                   27070000
           END-IF.                                                      27080000
                                                                        27090000
           IF PA-ADEVNT-DATE = 1                                        27100000
               STRING CC-START-DATE DELIMITED BY SPACE                  27110000
                      PC-SPACE DELIMITED BY SIZE                        27120000
                      PC-BEG-TMST   DELIMITED BY SIZE                   27130000
                      INTO PV-NEW-STRT-DATE                             27140000
           ELSE                                                         27150000
               STRING PV-ADEVNT-STRT-DTE DELIMITED BY SPACE             27160000
                      PC-SPACE DELIMITED BY SIZE                        27170000
                      PC-BEG-TMST   DELIMITED BY SIZE                   27180000
                      INTO PV-NEW-STRT-DATE                             27190000
           END-IF.                                                      27200000
                                                                        27210000
           IF  PV-ADEVNT-END-DTE > CC-END-DATE                          27220000
               STRING CC-END-DATE DELIMITED BY SPACE                    27230000
                      PC-SPACE DELIMITED BY SIZE                        27240000
                      PC-END-TMST   DELIMITED BY SIZE                   27250000
                      INTO PV-NEW-END-DATE                              27260000
           ELSE                                                         27270000
               STRING PV-ADEVNT-END-DTE DELIMITED BY SPACE              27280000
                      PC-SPACE DELIMITED BY SIZE                        27290000
                      PC-END-TMST   DELIMITED BY SIZE                   27300000
                      INTO PV-NEW-END-DATE                              27310000
           END-IF.                                                      27320000
                                                                        27330000
           DISPLAY 'START DATE = ' PV-NEW-STRT-DATE.                    27340000
           DISPLAY 'END DATE   = ' PV-NEW-END-DATE.                     27350000
           PERFORM A200-PROCESS-CSRS.                                   27360000
                                                                        27370000
           MOVE PV-NEW-STRT-DATE TO PV-PREV-NEW-STRT-DTE.               27380000
           MOVE PV-NEW-END-DATE  TO PV-PREV-NEW-END-DTE.                27390000
                                                                        27400000
           INITIALIZE PV-ADEVNT-VARIABLES.                              27410000
           PERFORM C495-FETCH-ADEVNT-DTE-CSR.                           27420000
                                                                        27430000
      ****************************************************************  27440000
      * C600-CLOSE-ADMIN-CSR.                                        *  27450000
      * ==> PROCESSES:                                                * 27460000
      *  - CLOSE THE ADMINCSR                                         * 27470000
      * ==> SQLCODE:                                                  * 27480000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 27490000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 27500000
      ****************************************************************  27510000
       C600-CLOSE-ADMIN-CSR.                                            27520000
                                                                        27530000
           EXEC SQL                                                     27540000
                CLOSE ADMINCSR                                          27550000
           END-EXEC.                                                    27560000
                                                                        27570000
           EVALUATE TRUE                                                27580000
               WHEN SQLCODE = ZERO                                      27590000
                   SET PS-NOT-END-OF-ADMIN-CSR TO TRUE                  27600000
                   CONTINUE                                             27610000
               WHEN OTHER                                               27620000
                  MOVE 'C600-CLOSE-ADMIN-CSR     '                      27630000
                                    TO PV-PARAGRAPH-NAME                27640000
                  MOVE 'CLOSE ERROR ON ADMIN-CSR '                      27650000
                                    TO PV-OPERATION-MSG-1               27660000
                   DISPLAY PV-PARAGRAPH-NAME                            27670000
                   PERFORM Z100-ABEND                                   27680000
           END-EVALUATE.                                                27690000
                                                                        27700000
      ****************************************************************  27710000
      * C610-CLOSE-ADMINOVR-CSR.                                     *  27720000
      * ==> PROCESSES:                                                * 27730000
      *  - CLOSE THE ADMINOVRCSR                                      * 27740000
      * ==> SQLCODE:                                                  * 27750000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 27760000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 27770000
      ****************************************************************  27780000
       C610-CLOSE-ADMINOVR-CSR.                                         27790000
                                                                        27800000
           EXEC SQL                                                     27810000
                CLOSE ADMINOVRCSR                                       27820000
           END-EXEC.                                                    27830000
                                                                        27840000
           EVALUATE TRUE                                                27850000
               WHEN SQLCODE = ZERO                                      27860000
                   SET PS-NOT-END-OF-ADMINOVR-CSR TO TRUE               27870000
                   CONTINUE                                             27880000
               WHEN OTHER                                               27890000
                  MOVE 'C610-CLOSE-ADMINOVR-CSR      '                  27900000
                                    TO PV-PARAGRAPH-NAME                27910000
                  MOVE 'CLOSE ERROR ON ADMINOVR-CSR  '                  27920000
                                    TO PV-OPERATION-MSG-1               27930000
                   DISPLAY PV-PARAGRAPH-NAME                            27940000
                   PERFORM Z100-ABEND                                   27950000
           END-EVALUATE.                                                27960000
                                                                        27970000
      ****************************************************************  27980000
      * C620-CLOSE-CLRNC-CSR.                                        *  27990000
      * ==> PROCESSES:                                                * 28000000
      *  - CLOSE THE CLRCCSR                                          * 28010000
      * ==> SQLCODE:                                                  * 28020000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 28030000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 28040000
      ****************************************************************  28050000
       C620-CLOSE-CLRNC-CSR.                                            28060000
                                                                        28070000
           EXEC SQL                                                     28080000
                CLOSE CLRNCCSR                                          28090000
           END-EXEC.                                                    28100000
                                                                        28110000
           EVALUATE TRUE                                                28120000
               WHEN SQLCODE = ZERO                                      28130000
                   SET PS-NOT-END-OF-CLRNC-CSR TO TRUE                  28140000
                   CONTINUE                                             28150000
               WHEN OTHER                                               28160000
                  MOVE 'C620-CLOSE-CLRNC-CSR     '                      28170000
                                    TO PV-PARAGRAPH-NAME                28180000
                  MOVE 'CLOSE ERROR ON CLRNC-CSR '                      28190000
                                    TO PV-OPERATION-MSG-1               28200000
                   DISPLAY PV-PARAGRAPH-NAME                            28210000
                   PERFORM Z100-ABEND                                   28220000
           END-EVALUATE.                                                28230000
                                                                        28240000
      ****************************************************************  28250000
      * C630-CLOSE-CMPTV-CSR.                                        *  28260000
      * ==> PROCESSES:                                                * 28270000
      *  - CLOSE THE CMPTVCSR                                         * 28280000
      * ==> SQLCODE:                                                  * 28290000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 28300000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 28310000
      ****************************************************************  28320000
       C630-CLOSE-CMPTV-CSR.                                            28330000
                                                                        28340000
           EXEC SQL                                                     28350000
                CLOSE CMPTVCSR                                          28360000
           END-EXEC.                                                    28370000
                                                                        28380000
           EVALUATE TRUE                                                28390000
               WHEN SQLCODE = ZERO                                      28400000
                   SET PS-NOT-END-OF-CMPTV-CSR TO TRUE                  28410000
                   CONTINUE                                             28420000
               WHEN OTHER                                               28430000
                  MOVE 'C630-CLOSE-CMPTV-CSR         '                  28440000
                                    TO PV-PARAGRAPH-NAME                28450000
                  MOVE 'CLOSE ERROR ON CMPTV-CSR  '                     28460000
                                    TO PV-OPERATION-MSG-1               28470000
                   DISPLAY PV-PARAGRAPH-NAME                            28480000
                   PERFORM Z100-ABEND                                   28490000
           END-EVALUATE.                                                28500000
                                                                        28510000
      ****************************************************************  28790000
      * C650-CLOSE-GRPOVR-CSR.                                       *  28800000
      * ==> PROCESSES:                                                * 28810000
      *  - CLOSE THE GRPOVRCSR                                        * 28820000
      * ==> SQLCODE:                                                  * 28830000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 28840000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 28850000
      ****************************************************************  28860000
       C650-CLOSE-GRPOVR-CSR.                                           28870000
                                                                        28880000
           EXEC SQL                                                     28890000
                CLOSE GRPOVRCSR                                         28900000
           END-EXEC.                                                    28910000
                                                                        28920000
           EVALUATE TRUE                                                28930000
               WHEN SQLCODE = ZERO                                      28940000
                   SET PS-NOT-END-OF-GRPOVR-CSR TO TRUE                 28950000
                   CONTINUE                                             28960000
               WHEN OTHER                                               28970000
                  MOVE 'C650-CLOSE-GRPOVR-CSR        '                  28980000
                                    TO PV-PARAGRAPH-NAME                28990000
                  MOVE 'CLOSE ERROR ON GRPOVR-CSR  '                    29000000
                                    TO PV-OPERATION-MSG-1               29010000
                   DISPLAY PV-PARAGRAPH-NAME                            29020000
                   PERFORM Z100-ABEND                                   29030000
           END-EVALUATE.                                                29040000
                                                                        29050000
      ****************************************************************  29060000
      * C660-CLOSE-PROMO-CSR.                                        *  29070000
      * ==> PROCESSES:                                                * 29080000
      *  - CLOSE THE PROMOCSR                                         * 29090000
      * ==> SQLCODE:                                                  * 29100000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 29110000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 29120000
      ****************************************************************  29130000
       C660-CLOSE-PROMO-CSR.                                            29140000
                                                                        29150000
           EXEC SQL                                                     29160000
                CLOSE PROMOCSR                                          29170000
           END-EXEC.                                                    29180000
                                                                        29190000
           EVALUATE TRUE                                                29200000
               WHEN SQLCODE = ZERO                                      29210000
                   SET PS-END-OF-PROMO-CSR TO TRUE                      29220000
                   CONTINUE                                             29230000
               WHEN OTHER                                               29240000
                  MOVE 'C660-CLOSE-PROMO-CSR     '                      29250000
                                    TO PV-PARAGRAPH-NAME                29260000
                  MOVE 'CLOSE ERROR ON PROMO-CSR '                      29270000
                                    TO PV-OPERATION-MSG-1               29280000
                   DISPLAY PV-PARAGRAPH-NAME                            29290000
                   PERFORM Z100-ABEND                                   29300000
           END-EVALUATE.                                                29310000
                                                                        29320000
      ****************************************************************  29330000
      * C670-CLOSE-PROMOOVR-CSR.                                     *  29340000
      * ==> PROCESSES:                                                * 29350000
      *  - CLOSE THE PROMOOVRCSR                                      * 29360000
      * ==> SQLCODE:                                                  * 29370000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 29380000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 29390000
      ****************************************************************  29400000
       C670-CLOSE-PROMOOVR-CSR.                                         29410000
                                                                        29420000
           EXEC SQL                                                     29430000
                CLOSE PROMOOVRCSR                                       29440000
           END-EXEC.                                                    29450000
                                                                        29460000
           EVALUATE TRUE                                                29470000
               WHEN SQLCODE = ZERO                                      29480000
                   SET PS-END-OF-PROMOOVR-CSR TO TRUE                   29490000
                   CONTINUE                                             29500000
               WHEN OTHER                                               29510000
                  MOVE 'C670-CLOSE-PROMOOVR-CSR     '                   29520000
                                    TO PV-PARAGRAPH-NAME                29530000
                  MOVE 'CLOSE ERROR ON PROMOOVR-CSR  '                  29540000
                                    TO PV-OPERATION-MSG-1               29550000
                   DISPLAY PV-PARAGRAPH-NAME                            29560000
                   PERFORM Z100-ABEND                                   29570000
           END-EVALUATE.                                                29580000
                                                                        29590000
      ****************************************************************  29870000
      * C690-CLOSE-SIMPOVR-CSR.                                      *  29880000
      * ==> PROCESSES:                                                * 29890000
      *  - CLOSE THE SIMPOVRCSR                                       * 29900000
      * ==> SQLCODE:                                                  * 29910000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 29920000
      * ==> PERFORMED FROM: A200-PROCESS-CSRS                         * 29930000
      ****************************************************************  29940000
       C690-CLOSE-SIMPOVR-CSR.                                          29950000
                                                                        29960000
           EXEC SQL                                                     29970000
                CLOSE SIMPOVRCSR                                        29980000
           END-EXEC.                                                    29990000
                                                                        30000000
           EVALUATE TRUE                                                30010000
               WHEN SQLCODE = ZERO                                      30020000
                   SET PS-NOT-END-OF-SIMPOVR-CSR TO TRUE                30030000
                   CONTINUE                                             30040000
               WHEN OTHER                                               30050000
                  MOVE 'C690-CLOSE-SIMPOVR-CSR       '                  30060000
                                    TO PV-PARAGRAPH-NAME                30070000
                  MOVE 'CLOSE ERROR ON SIMPOVR-CSR  '                   30080000
                                    TO PV-OPERATION-MSG-1               30090000
                   DISPLAY PV-PARAGRAPH-NAME                            30100000
                   PERFORM Z100-ABEND                                   30110000
           END-EVALUATE.                                                30120000
                                                                        30130000
      ****************************************************************  30140000
      * C695-CLOSE-ADEVNT-DTE-CSR.                                   *  30150000
      * ==> PROCESSES:                                                * 30160000
      *  - CLOSE THE ADEVNTDTECSR                                     * 30170000
      * ==> SQLCODE:                                                  * 30180000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 30190000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 30200000
      ****************************************************************  30210000
       C695-CLOSE-ADEVNT-DTE-CSR.                                       30220000
                                                                        30230000
           EXEC SQL                                                     30240000
                CLOSE ADEVNTDTECSR                                      30250000
           END-EXEC.                                                    30260000
                                                                        30270000
           EVALUATE TRUE                                                30280000
               WHEN SQLCODE = ZERO                                      30290000
                   SET PS-NOT-END-OF-ADEVNT-DTE-CSR TO TRUE             30300000
                   CONTINUE                                             30310000
               WHEN OTHER                                               30320000
                  MOVE 'C695-CLOSE-ADEVNT-DTE-CSR   '                   30330000
                                    TO PV-PARAGRAPH-NAME                30340000
                  MOVE 'CLOSE ERROR ON ADEVNTDTECSR '                   30350000
                                    TO PV-OPERATION-MSG-1               30360000
                   DISPLAY PV-PARAGRAPH-NAME                            30370000
                   PERFORM Z100-ABEND                                   30380000
           END-EVALUATE.                                                30390000
                                                                        30400000
      ***************************************************************** 30410000
      * D100-MOVE-TO-CPYBK.                                           * 30420000
      * ==> PROCESSES:                                                * 30430000
      *  - MOVE THE VARIABLES TO THE COPYBOOK                         * 30440000
      * ==> PERFORMED FROM: C400-FETCH-ADMIN-CSR, C490-FETCH-SIMPOVR  * 30450000
      *       C410-FETCH-ADMINOVR-CSR, C420-FETCH-CLRNC-CSR,          * 30460000
      *       C430-FETCH-CMPTV-CSR, C450-FETCH-GRPOVR-CSR,            * 30470000
      *       C460-FETCH-PROMO-CSR, C470-FETCH-PROMOOVR-CSR           * 30480000
      ***************************************************************** 30500000
       D100-MOVE-TO-CPYBK.                                              30510000
                                                                        30520000
           INITIALIZE PM710-PRICING-STR-GP-RECORD.                      30530000
           MOVE PC-BUSINESS-EVNT-ID    TO PM710-BUSINESS-EVNT-ID.       30540000
           MOVE PC-ACTION-CDE          TO PM710-ACTION-CDE.             30550000
      *    MOVE PV-SYS-DATE-XS         TO PM710-BUSINESS-EVNT-CRE-TMST. 30560000
           MOVE '0000-00-00-00.00.00.000000'                            30561000
                                       TO PM710-BUSINESS-EVNT-CRE-TMST. 30562000
           MOVE PV-PROMO-INTFC-ID      TO PM710-PROMO-INTFC-ID.         30570000
           MOVE PV-MDSE-LNE-ID         TO PM710-MDSE-LNE-ID.            30580000
           MOVE PV-STR-SELN-TYP-CDE    TO PM710-STR-SELN-TYP-CDE.       30590000
           MOVE PV-STR-SELN-HIER-LVL-CDE TO                             30600000
                PM710-STR-SELN-HIER-LVL-CDE.                            30610000
           MOVE PV-ADHC-STR-GP-ID      TO PM710-ADHC-STR-GP-ID.         30620000
           MOVE PV-STR-GP-TYP-CDE      TO PM710-STR-GP-TYP-CDE.         30630000
           MOVE PV-STR-GP-ID           TO PM710-STR-GP-ID.              30640000
           MOVE PV-STAT-CDE            TO PM710-STAT-CDE.               30650000
                                                                        30660000
           STRING PV-STRT-TMST DELIMITED BY SPACE                       30670000
                  '.000000'     DELIMITED BY SIZE                       30680000
                  INTO PM710-STRT-TMST.                                 30690000
                                                                        30700000
           STRING PV-END-TMST DELIMITED BY SPACE                        30710000
                   '.000000'     DELIMITED BY SIZE                      30720000
                   INTO PM710-END-TMST.                                 30730000
                                                                        30740000
           IF PV-ACT-STRT-TM = '00.00'                                  30750000
               PERFORM E100-FIND-ACTUAL-START-TIME                      30760000
           ELSE                                                         30770000
               MOVE PM710-STRT-TMST TO PM710-ACT-STRT-TMST              30780000
           END-IF.                                                      30790000
                                                                        30800000
           IF PV-ACT-END-TM = '23.59'                                   30810000
               PERFORM E200-FIND-ACTUAL-END-TIME                        30820000
           ELSE                                                         30830000
               MOVE PM710-END-TMST TO PM710-ACT-END-TMST                30840000
           END-IF.                                                      30850000
                                                                        30860000
           STRING PV-LAST-UPD-TMST DELIMITED BY SPACE                   30870000
                  '.000000'     DELIMITED BY SIZE                       30880000
                  INTO PM710-LAST-UPD-TMST.                             30890000
                                                                        30900000
           STRING PV-SORT-LAST-UPD-TMST DELIMITED BY SPACE              30910000
                  '.000000'     DELIMITED BY SIZE                       30920000
                  INTO PM710-SORT-LAST-UPD-TMST.                        30930000
                                                                        30940000
           EVALUATE TRUE                                                30950000
               WHEN PS-ADMIN-TYP                                        30960000
                  MOVE PV-PROMO-PRIC-VER-ID TO PM710-PROMO-PRIC-VER-ID  30970000
                                                                        30980000
               WHEN PS-SIMP-TYP                                         30990000
               WHEN PS-PROMO-TYP                                        31000000
               WHEN PS-GRP-TYP                                          31010000
                  MOVE PV-PROMO-PRIC-VER-ID TO PM710-PROMO-PRIC-VER-ID  31020000
                  MOVE PV-ESL-TOPR-TYP-CDE  TO PM710-ESL-TOPR-TYP-CDE   31030000
                                                                        31040000
               WHEN PS-ADMINOVR-TYP                                     31050000
                   MOVE PV-PRNT-OV-STR-GP-ID                            31060000
                                      TO PM710-PRNT-OV-STR-GP-ID        31070000
                   MOVE PV-PRNT-OV-STR-GP-CDE                           31080000
                                      TO PM710-PRNT-OV-STR-GP-CDE       31090000
                   MOVE PV-PRNT-OV-ADHC-STR-GP-ID                       31100000
                                      TO PM710-PRNT-ADHC-STR-GP-ID      31110000
                   MOVE PV-PRNT-OV-STR-SELN-CDE                         31120000
                                      TO PM710-PRNT-OV-STR-SELN-CDE     31130000
                                                                        31140000
               WHEN PS-SIMPOVR-TYP                                      31150000
               WHEN PS-PROMOOVR-TYP                                     31160000
               WHEN PS-GRPOVR-TYP                                       31170000
                   MOVE PV-PRNT-OV-STR-GP-ID                            31180000
                                      TO PM710-PRNT-OV-STR-GP-ID        31190000
                   MOVE PV-PRNT-OV-STR-GP-CDE                           31200000
                                      TO PM710-PRNT-OV-STR-GP-CDE       31210000
                   MOVE PV-PRNT-OV-ADHC-STR-GP-ID                       31220000
                                      TO PM710-PRNT-ADHC-STR-GP-ID      31230000
                   MOVE PV-PRNT-OV-STR-SELN-CDE                         31240000
                                      TO PM710-PRNT-OV-STR-SELN-CDE     31250000
                   MOVE PV-ESL-TOPR-TYP-CDE                             31260000
                                      TO PM710-ESL-TOPR-TYP-CDE         31270000
                                                                        31280000
           END-EVALUATE.                                                31290000
           PERFORM W100-WRITE-DETAIL.                                   31300000
                                                                        31310000
      ***************************************************************** 31320000
      * E100-FIND-ACTUAL-START-TIME.                                  * 31330000
      * ==> PROCESSES:                                                * 31340000
      *  - ADD THREE HOURS TO THE START TIME                          * 31350000
      * ==> SQLCODE:                                                  * 31360000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 31370000
      * ==> PERFORMED FROM: D100-MOVE-TO-CPYBK                        * 31380000
      ***************************************************************** 31390000
       E100-FIND-ACTUAL-START-TIME.                                     31400000
           EXEC SQL                                                     31410000
               SELECT                                                   31420000
                   TO_CHAR(TO_DATE(:PV-STRT-TMST) +                     31430000
                             (:PC-THREE / 24), 'YYYY-MM-DD-HH24.MI.SS') 31440000
               INTO                                                     31450000
                   :PM710-ACT-STRT-TMST                                 31460000
               FROM                                                     31470000
                   DUAL                                                 31480000
            END-EXEC.                                                   31490000
                                                                        31500000
            EVALUATE TRUE                                               31510000
                WHEN SQLCODE = ZERO                                     31520000
                    STRING PM710-ACT-STRT-TMST DELIMITED BY SPACE       31530000
                         '.000000'     DELIMITED BY SIZE                31540000
                         INTO PM710-ACT-STRT-TMST                       31550000
                WHEN OTHER                                              31560000
                    DISPLAY 'START TMST: ' PV-STRT-TMST                 31570000
                    DISPLAY 'ACTUAL TMST: ' PM710-ACT-STRT-TMST         31580000
                    MOVE SQLCODE               TO PV-SQL                31590000
                    MOVE 'DUAL'                TO PV-TABLE-NAME         31600000
                    MOVE 'E100-FIND-ACTUAL-START-TIME'                  31610000
                                             TO PV-PARAGRAPH-NAME       31620000
                    PERFORM Z100-ABEND                                  31630000
            END-EVALUATE.                                               31640000
                                                                        31650000
      ***************************************************************** 31660000
      * E200-FIND-ACTUAL-END-TIME.                                    * 31670000
      * ==> PROCESSES:                                                * 31680000
      *  - ADD THREE HOURS TO THE END TIME                            * 31690000
      * ==> SQLCODE:                                                  * 31700000
      *  - 0    = CLOSE WAS SUCCESSFULL                               * 31710000
      * ==> PERFORMED FROM: D100-MOVE-TO-CPYBK                        * 31720000
      ***************************************************************** 31730000
       E200-FIND-ACTUAL-END-TIME.                                       31740000
           EXEC SQL                                                     31750000
               SELECT                                                   31760000
                   TO_CHAR(TO_DATE(:PV-END-TMST) +                      31770000
                             (:PC-THREE / 24), 'YYYY-MM-DD-HH24.MI.SS') 31780000
               INTO                                                     31790000
                   :PM710-ACT-END-TMST                                  31800000
               FROM                                                     31810000
                   DUAL                                                 31820000
            END-EXEC.                                                   31830000
                                                                        31840000
            EVALUATE TRUE                                               31850000
                WHEN SQLCODE = ZERO                                     31860000
                    STRING PM710-ACT-END-TMST DELIMITED BY SPACE        31870000
                         '.000000'     DELIMITED BY SIZE                31880000
                         INTO PM710-ACT-END-TMST                        31890000
                WHEN OTHER                                              31900000
                    MOVE SQLCODE               TO PV-SQL                31910000
                    MOVE 'DUAL'                TO PV-TABLE-NAME         31920000
                    MOVE 'E200-FIND-ACTUAL-END-TIME'                    31930000
                                             TO PV-PARAGRAPH-NAME       31940000
                    PERFORM Z100-ABEND                                  31950000
            END-EVALUATE.                                               31960000
                                                                        31970000
      ***************************************************************** 31980000
      * W100-WRITE-DETAIL.                                            * 31990000
      * ==> PROCESSES:                                                * 32000000
      *  - WRITE THE DETAIL LINE TO THE PRCG STORE GP OUTPUT FILE.    * 32010000
      * ==> PERFORMED FROM: C500-PROCESS-ADMIN-CSR                    * 32020000
      *      C510-PROCESS-ADMINOVR-CSR, C520-PROCESS-CLRNC-CSR        * 32030000
      *      C530-PROCESS-CMPTV-CSR,                                  * 32040000
      *      C550-PROCESS-GRPOVR-CSR, C560-PROCESS-PROMO-CSR          * 32050000
      *      C570-PROCESS-PROMOOVR-CSR, C590-PROCESS-SIMPOVR-CSR      * 32060000
      ***************************************************************** 32080000
       W100-WRITE-DETAIL.                                               32090000
                                                                        32100000
           WRITE PRCG-STORE-GP-LINE FROM PM710-PRICING-STR-GP-RECORD.   32110000
                                                                        32120000
           ADD +1                    TO PA-RECS-WRITTEN.                32130000
                                                                        32140000
      ***************************************************************** 32150000
      * W200-WRITE-TOTAL-LINE                                         * 32160000
      * ==> PROCESSES:                                                * 32170000
      *  - WRITE THE TOTAL LINE TO THE PRCG STORE GP OUTPUT FILE.     * 32180000
      * ==> PERFORMED FROM: A100-MAINLINE                             * 32190000
      ***************************************************************** 32200000
       W200-WRITE-TOTAL-LINE.                                           32210000
                                                                        32220000
           MOVE PC-BUSINESS-EVNT-ID TO PM700-BUSINESS-EVNT-ID.          32230000
           MOVE PA-RECS-WRITTEN TO PM700-TOTAL-NBR-OF-RECS.             32240000
           WRITE PRCG-STORE-GP-LINE FROM PM700-TOTAL-RECORD.            32250000
                                                                        32260000
      ******************************************************************32270000
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT     *32280000
      * LOGONS TO ORACLE.                                              *32290000
      ******************************************************************32300000
      *    COPY PMPD700.                                                32310000
                                                                        32320000
      ***************************************************************** 32330000
      * Z100-ABEND.                                                   * 32340000
      *  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            * 32350000
      ***************************************************************** 32360000
       Z100-ABEND.                                                      32370000
                                                                        32380000
           DISPLAY '                       '.                           32390000
           DISPLAY '** ABEND **       ** = SQLERROR'.                   32400000
           DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.           32410000
           DISPLAY '** SQLCODE        ** = ' SQLCODE.                   32420000
           DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                32430000
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   32440000
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  32450000
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                32460000
           DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         32470000
           DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             32480000
           DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG.          32490000
           DISPLAY '                       '.                           32500000
                                                                        32510000
           CALL 'ILBOABN0' USING ABEND-CODE.                            32520000
                                                                        32530000
      ******************************************************************32540000
      * Z910-ABEND - PERFORMS A NON-SQL-ABEND                          *32550000
      ******************************************************************32560000
       Z910-ABEND.                                                      32570000
                                                                        32580000
           DISPLAY '** ABEND           **'.                             32590000
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          32600000
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        32610000
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         32620000
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.       32630000
                                                                        32640000
           CALL 'ILBOABN0' USING ABEND-CODE.                            32650000
