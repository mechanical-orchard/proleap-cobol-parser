000010******************************************************************00001067
000011* this version has logic for thin Slice                          *00001175
000012*  mainframe modernization                                       *00001271
000014******************************************************************00001471
000015******************************************************************00001599
000016*  this is a copy of SUKCS771 for pna testing for thin slice     *00001699
000017                                                                  00001799
000018* THIS IS PART OF THE MAINFRAME MODERNIZATION SELECTION CRITERIA *00001899
000019*                                                                *00001999
000020 IDENTIFICATION DIVISION.                                         00002068
000030******************************************************************00003068
000040                                                                  00004068
000050 PROGRAM-ID.             SUKCS782.                                00005099
000060 AUTHOR.                 GERMAN BANDA.                            00006068
000070 INSTALLATION.           KOHLS.                                   00007068
000080 DATE-WRITTEN.           OCTOBER, 2004.                           00008068
000090 DATE-COMPILED.                                                   00009068
000100                                                                  00010068
000110******************************************************************00011068
000120* THIS PROGRAM WILL TAKE A SOCKET FROM A PRINT AND APPLY BOX,     00012068
000130* RECEIVE BARCODE DATA, AND SEND LABEL DATA BACK IN ORDER TO      00013068
000140* PRODUCE A LABEL.                                                00014068
000150******************************************************************00015068
000160* 12/22/14 modified parm PACRTN                                  *00016068
000170*          text:  Y/N in first postition of text                 *00017068
000180*                 if Y in first position                         *00018068
000190*                       in pos 3-5  - ALL means all PNA stations *00019068
000200*                       in pos 3-5  - 001 3 digit PNA station #  *00020068
000210*                                     (001 means pna station #1) *00021068
000220******************************************************************00022068
000230* 11/04/2008  Christine Twiehaus                                 *00023068
000240*             DUEL FEED PRINT AND APPLY PROCESSING               *00024068
000250*             DETERMINE IF DUAL FEED IS ENABLED, FORMAT CALL TO  *00025068
000260*             DIRECTIVE GENERATOR, DETERMINE DIVERTS TO          *00026068
000270*             PRINT AND APPLY STATION LINE AND DC                *00027068
000280******************************************************************00028068
000290* 2014-12-03   Denise Hahn                                       *00029068
000300*            - many incidents being opened due to no host resp   *00030068
000310*            - seeing alot of contention and database locks      *00031068
000320*            - adding WITH UR to some of the SQL statements to   *00032068
000330*              help relieve some of the issues                   *00033068
000340******************************************************************00034068
000350******************************************************************00035068
000360                                                                  00036068
000370***************************************************************** 00037068
000380* CHANGE DESCRIPTION                                              00038068
000390***************************************************************** 00039068
000400* DATE  06/24/2010                                                00040068
000410*  CHANGE MADE: CHANGED TO BE ABLE TO CHECK IN IR CARTONS         00041068
000420*  ('0042') (ALONG WITH VENDOR CARTONS) AND DO THE NECESSARY      00042068
000430*  PROCESSING.                                                    00043068
000440*  MADE BY: TOYAM SAIKH     TKID:TKMAX89                          00044068
000450*  CHANGES ARE TAGGED AS TS 06/24/2010                            00045068
000460*                                                                 00046068
000470* 07/08/2010  EKTA AGRAWAL             TKID: TKMAV49             *00047068
000480*             MODIFIED TO CALL THE NEW PROGRAM PCKUT790 TO UPDATE*00048068
000490*             THE SUMMARY WORKED DATABASE FOR THE IR CARTONS THAT*00049068
000500*             HAS BEEN SCANNED AND INSERTED TO THE OUTBOUND      *00050068
000510*             LOCATION TABLE.                                    *00051068
000520*             CHANGES TAGGED AS EA 07/08/2010                    *00052068
000530* 06/20/2013  CHERI PARMLEY            TKID: TKMAF76             *00053068
000540*                                      PR#5148B                  *00054068
000550*             MODIFIED TO CALL THE RFID MODULE IN A DIFFRENT     *00055068
000560*             LOCATION. NEW MODULE WORKS WHERE UPON RETURN       *00056068
000570*             SWITCHES NEED TO BE CHECKED FOR RFID ON LABEL AND  *00057068
000580*             IF DIRECTIVE CREATED.                              *00058068
000590*             WE WILL BE DISPLAYING 'RFID' ON THE P2L NOW WITHIN *00059068
000600*             THIS PROGRAM WHEN APROPRIATE.                      *00060068
000610*             ALSO ADDED 'T' CASI CODE FOR P2L LABEL             *00061068
000620*             CHANGES TAGGED AS CLP 06/20/13 PR5148B START/END   *00062068
000630*                                      CHG0055296                *00063068
000640* 07/19/13 RLK BEG                                                00064068
000650* 07/17/2013  RICH KELLEN  CHG0058309  TKID: TKMAA71             *00065068
000660*             CHANGE TO ADD CREATION OF NEW DESTINATION AND       00066068
000670*             MESSAGE LABELS FOR SOME NON-AUTO CONVEYOR DC'S.     00067068
000680*             THE DC'S USING THE NEW LABEL TYPES WILL BE          00068068
000690*             BY A NEW ROW TYPE ON THE TKRPRPM TABLE.             00069068
000700* 08/01/13 RLK BEG                                                00070068
000710* 08/01/2013  RICH KELLEN  CHG0058309  TKID: TKMAA71             *00071068
000720*             CHANGE TO ADD logic to add new data to carton       00072068
000730*             label and create message label, which is the        00073068
000740*             same except for no barcode on label.                00074068
000750* 08/01/13 RLK END                                                00075068
000760* 09/23/13 SB BEG                                                 00076068
000770* 09/23/2013  SHOBHIT BAIJAL CHG0063318     TKID: TKMALR7        *00077068
000780*             CHANGE TO ADD LOGIC TO CHECK CARTONS FOR IMPORT     00078068
000790*             REPLEN AND ONLY IF THAT IS TRUE, THEN CHECK FOR     00079068
000800*             RFID TAGGING.                                       00080068
000810* 09/23/13 SB END                                                 00081068
000820* 10/29/2013  CHERI PARMLEY  CHG0068598     TKID: TKMAF76        *00082068
000830*             ADD LOGIC FOR RFID AUDIT-PNA RECEIVING CAN NOW HAVE 00083068
000840*             A COMBINATION OF AUDITS. EITHER QC OR RFID OR COMBO.00084068
000850*             ALSO INCLUDED LOGIC TO PASS FIELDS TO THE RFID      00085068
000860*             MODULE FOR IR PROCESSING. THE MODULE WILL NOW TELL  00086068
000870*             IF THE IR FACILITY IS NOW TAGGING BY DEPT.          00087068
000880*             CHANGES TAGGED AS 'CLP 10/29/13'                    00088068
000890*             --------------------------------------------------- 00089068
000900*             WITHIN 6020-SET-DIRECT-AND-LABEL NEW PARA 6030- IS  00090068
000910*             EXECUTED TO CHECK IF RFID AUDIT IS NEEDED. NEW      00091068
000920*             PROGRAM IS BEING CALLED SUKCS720 TO DETERMINE THIS. 00092068
000930*             COMING BACK FROM THIS PROGRAM NEW SWITCHES ARE SET  00093068
000940*             IN THE SURD021 COPY WHICH REFLECTS THE RESULTS OF   00094068
000950*             THE AUDIT. THESE SWITCHES ARE USED THRU OUT THE     00095068
000960*             PROGRAM TO SEE WHAT STATUS THE RFID AUDIT IS IN.    00096068
000970*             SU021-RFID-AUDIT-VALIDATION-SW AND ITS 88 LEVELS    00097068
000980*             HAVE BEEN ADDED.                                    00098068
000990*             ----------------------------------------------------00099068
001000*             WITHIN 6010-CALL-RFID-DETERMINATION THERE IS NEW    00100068
001010*             LOGIC SU093-IR-CHK-IN-YES IS SET AND THEN SUKUT149  00101068
001020*             IS CALLED TO SEE IF THE IR FACILITY IS TAGGING.     00102068
001030*             IF IR TAGGING THEN THE DIRECTIVE IS SET TO NO AND   00103068
001040*             THE PRINT OF RFID ON LABELS IS SET TO NO. THIS IS   00104068
001050*             SET WITHIN 6020- AFTER CHECKING THE SWITCHES COMING 00105068
001060*             BACK FROM THE SUKUT149 MODULE.                      00106068
001070*             ----------------------------------------------------00107068
001080* 03/18/2014  CHERI PARMLEY  CHG0077335     TKID: TKMAF76        *00108068
001090*             ADDED -811 CHECK IN PARA 8550- TO SET CARTON FOUND  00109068
001100*             TO TRUE FOUND WITH MULTIPLE AUDITS WITH RFID NOW    00110068
001110*             PARA WAS ABENDING.                                  00111068
001120* 03/20/2014  CHERI PARMLEY  CHG0077565     TKID: TKMAF76        *00112068
001130              ADDED 8535-CHECK-AUDIT-CRT-PNDG-RF TO CHECK FOR     00113068
001140              RF AUDIT CARTON STATUS IN 6005-. THIS IS NEEDED TO  00114068
001150              SET AUDIT REQUIRED SWITCH CORRECTLY WHICH IS USED IN00115068
001160              7205-. CARTONS BEING RE-SCANNED THRU PNA THAT WERE  00116068
001170              COMBO OR RFID ORIGINALLY WERE COMING BACK AS QCAUDIT00117068
001180              ON THE LABEL.                                       00118068
001190* 04/04/2014  CHERI PARMLEY  CHG0079586     TKID: TKMAF76        *00119068
001200*             REMOVED 2300- PARA NOT EXECUTED.                    00120068
001210*                                                                 00121068
001220*             CHECK FOR NULL IN 7235- TO ELIMINATE ABENDS WITH    00122068
001230*             -310. DISPLAY THE DK-CTN # PROPERLY IF ABEND.       00123068
001240*                                                                 00124068
001250*             IN 8000- ADDED DATE CHECK TO PROPERLY FILL IN DATE  00125068
001260*             ON IR CARTON MESSAGE LABEL (PC248-)                 00126068
001270*                                                                 00127068
001280*             IN 7205- PERFORM 7150- TO BE SURE TO GET THE 2 DIGIT00128068
001290*             DC LOCATION ABBREVIATION FOR THE IR CARTON LABEL.   00129068
001300*                                                                 00130068
001310*             IN 6020- ADDED CODE TO CHECK IF IR NEEDS DC TO TAG  00131068
001320*             OR NOT.                                             00132068
001330*             CHANGES TAGGED CLP 04/08/14                         00133068
001340*---------------------------------------------------------------- 00134068
001350* 04/25/2014  CHERI PARMLEY  CHG0080734     TKID: TKMAF76         00135068
001360*             ADD LOGIC in 6020- FOR IR CARTONS THAT NEED TAGGING 00136068
001370*             BY DC - IF AUTOMATED DC - DO NOT PRINT 'REPL RFID'  00137068
001380*             LABEL IN NON AUTOMATED DC PUT RFID ON LABEL.        00138068
001390*             CHANGES TAGGED AS 'CLP 04/25/14'                    00139068
001400*---------------------------------------------------------------- 00140068
001410* 06/24/2015  CHERI PARMLEY  CHG0120422     TKID: TKMAF76         00141068
001420*             REPLACING PGM-MDSE-DESC WITH THE BUSINESS AREA DESC 00142068
001430*             AND BRAND DESC.                                     00143068
001440*             CHANGES TAGGED AS 'CLP 06/24/2015'                  00144068
001450*---------------------------------------------------------------- 00145068
001460* 04/27/2017   Cheri Parmley CHG0166773     TKID: TKMAF76        *00146013
001470*              In 5000-PRINT-LABEL check if its a forced divert  *00147013
001480*              if so check table to see if DC is 'Y' if so use   *00148013
001490*              the divert code from the parm table PADCLS  else  *00149013
001500*              use whats on the SUT_PNA_STA_DIVERT table for the *00150013
001510*              divert code. Check also in 8000-LOAD-LABEL-DATA-SML00151013
001520*             CHANGES TAGGED AS 'CLP 03-13-2017'                  00152013
001530***************************************************************** 00153013
001540* 06/20/2017   Cheri Parmley CHG0171081     TKID: TKMAF76        *00154017
001550*              Program SUKCS782 ran for Blue Springs inititally  *00155016
001560*              as to not effect other DC's. Then regression      *00156016
001570*              testing occurred in Macon and Ottawa. After       *00157016
001580*              successful regression SUKCS782 was rolled out to  *00158099
001590*              all DC's.                                         *00159017
001600******************************************************************00160061
001610* 07/12/2017   Barb Schultz  CHG0176459     TKID: TKMA555        *00161061
001620*              CHANGES TO HANDLE EAS AND RFID TAGGING            *00162061
001630*              SIMULTANEOUSLY.                                   *00163061
001640******************************************************************00164066
001650* 09/26/2017   GERMAN BANDA   CHG0178877                         *00165066
001660*              CHANGED 6020- PARAGRAPH TO ALSO CHECK IF          *00166066
001670*              SU093-LABEL-PRINT-IND = SPACES BEFORE SETTING     *00167066
001680*              PS-DIRECTIVE-NO TO TRUE.                          *00168066
001690******************************************************************00169019
001700 ENVIRONMENT DIVISION.                                            00170019
001710******************************************************************00171019
001720                                                                  00172019
001730******************************************************************00173019
001740 DATA DIVISION.                                                   00174019
001750******************************************************************00175019
001760                                                                  00176019
001770******************************************************************00177013
001780 WORKING-STORAGE SECTION.                                         00178013
001790******************************************************************00179013
001800*                                                                 00180013
001810*----------------------------------------------------------------*00181013
001820*  DB2 KEYS                                                      *00182013
001830*----------------------------------------------------------------*00183013
001840 01  DK-DB2-KEYS.                                                 00184013
001850     05  DK-CTN                          PIC  S9(18)V COMP-3.     00185013
001860     05  DK-128-BARCODE                  PIC  S9(18)V COMP-3.     00186013
001870     05  DK-SML-BARCODE                  PIC   X(22).             00187013
001880     05  DK-CURR-OPER-UNT-ID             PIC  S9(04)  COMP.       00188013
001890     05  DK-DEST-OPER-UNT-ID             PIC  S9(04)  COMP.       00189013
001900     05  DK-OPER-UNT-ID                  PIC  S9(04)  COMP.       00190013
001910     05  DK-FCLTY-ID                     PIC  S9(04)  COMP.       00191013
001920     05  DK-MANIFEST                     PIC  S9(09)  COMP.       00192013
001930     05  DK-BATCH-NUMBER                 PIC  S9(04)  COMP.       00193013
001940     05  DK-PO                           PIC  S9(09)  COMP.       00194013
001950     05  DK-STORE                        PIC  S9(04)  COMP.       00195013
001960     05  DK-REC-SEQ-NBR                  PIC  S9(09)  COMP.       00196013
001970     05  DK-PO-LNE-NBR                   PIC  S9(09)  COMP.       00197013
001980     05  DK-PREPK-ID                     PIC  S9(04)  COMP.       00198013
001990     05  DK-OUTER-QTY                    PIC  S9(04)  COMP.       00199013
002000     05  DK-BARCODE-NBR                  PIC  X(22).              00200013
002010     05  DK-CART-LBL-TYP-CDE             PIC  X(01).              00201013
002020     05  DK-ERR-MSG-CDE                  PIC  X(01).              00202013
002030     05  DK-KRPRPM-LOC-ID                PIC  S9(4) COMP.         00203013
002040* EKTA                                                            00204013
002050     05  DK-TRIP-ID                      PIC  S9(09)  COMP.       00205013
002060* EKTA                                                            00206013
002061*                                                                 00206174
002062*** THIN SLICE DB2 KEYS                                           00206274
002063*                                                                 00206374
002064     05  DK-THIN-DC-NBR              PIC  S9(04)  COMP.           00206474
002065     05  DK-THIN-OPER-UNT-ID         PIC S9(10)V9(5) COMP-3.      00206574
002066     05  DK-THIN-PNA-STA             PIC S9(10)V9(5) COMP-3.      00206674
002067     05  DK-THIN-RCVG-DOOR           PIC   X(04).                 00206778
002070                                                                  00207013
002080*----------------------------------------------------------------*00208013
002090*  PCWS160 - LAYOUT FOR 22 & 20 DIGIT BARCODES                  * 00209013
002100*----------------------------------------------------------------*00210013
002110     COPY PCWS160.                                                00211013
002120*---------------------------------------------------------------* 00212013
002130* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 00213013
002140*---------------------------------------------------------------* 00214013
002150     COPY XLWS001.                                                00215013
002160                                                                  00216013
002170/                                                                 00217013
002180*---------------------------------------------------------------* 00218013
002190*  RECORD LAYOUTS FOR THE TROUBLE CREATION ROUTINE                00219013
002200*---------------------------------------------------------------* 00220013
002210     COPY TMWS500.                                                00221013
002220                                                                  00222013
002230*---------------------------------------------------------------* 00223013
002240*  RECORD LAYOUTS FOR THE FREE ASTRAY HANDLER MODULE              00224013
002250*---------------------------------------------------------------* 00225013
002260     COPY SUWS044.                                                00226013
002270                                                                  00227013
002280*---------------------------------------------------------------* 00228013
002290*  RECORD LAYOUTS FOR THE AUTO VERF PARM CHECK MODULE             00229013
002300*---------------------------------------------------------------* 00230013
002310     COPY RCWS040.                                                00231013
002320                                                                  00232013
002330*---------------------------------------------------------------* 00233013
002340*  RECORD LAYOUTS FOR THE AUTO CONFIRMATION MODULE                00234013
002350*---------------------------------------------------------------* 00235013
002360     COPY RCWS041.                                                00236013
002370                                                                  00237013
002380* JAK WR41309 - ADD COPYBOOK FOR CALL TO SUKUT149                 00238013
002390*---------------------------------------------------------------* 00239013
002400*  RECORD LAYOUTS FOR RFID DETERMINATION MODULE                   00240013
002410*---------------------------------------------------------------* 00241013
002420     COPY SUWS093.                                                00242013
002430* JAK WR41309 - END                                               00243013
002431                                                                  00243178
002432*---------------------------------------------------------------* 00243278
002433*  commarea for thin slice module (sukcs700)                      00243378
002434*---------------------------------------------------------------* 00243478
002435     COPY SUWS109.                                                00243578
002440                                                                  00244013
002450*---------------------------------------------------------------* 00245013
002460*  COMMUNICATION AREA FOR THE ASSIGNMENT DATA                     00246013
002470*  USED IN THE DLX LABOR SYSTEM (DLKUP001)                        00247013
002480*---------------------------------------------------------------* 00248013
002490     COPY DLWS001.                                                00249013
002500                                                                  00250013
002510*---------------------------------------------------------------* 00251013
002520*  COMMUNICATION AREA FOR THE ASSIGNMENT DATA                     00252013
002530*  USED IN THE DLX LABOR SYSTEM (DLKUT001)                        00253013
002540*---------------------------------------------------------------* 00254013
002550     COPY DLWS003.                                                00255013
002560                                                                  00256013
002570*---------------------------------------------------------------* 00257013
002580*    DLKCS410 COMMAREA                                            00258013
002590*---------------------------------------------------------------* 00259013
002600     COPY DLWS016.                                                00260013
002610                                                                  00261013
002620*---------------------------------------------------------------* 00262013
002630*    TEMPLATE                                                     00263013
002640     COPY DLWS011.                                                00264013
002650                                                                  00265013
002660*---------------------------------------------------------------* 00266013
002670*  COMMUNICATION AREA PASSED TO WRITE INFORMATION                 00267013
002680*  TO THE EAI EXPORT TABLES (XLKUP033)                            00268013
002690*---------------------------------------------------------------* 00269013
002700     COPY XLWS072.                                                00270013
002710                                                                  00271013
002720*---------------------------------------------------------------* 00272013
002730*  LAYOUT WHICH DEFINES THE DATA ELEMENTS                         00273013
002740*  FOUND WITHIN THE DTL_TXT                                       00274013
002750*---------------------------------------------------------------* 00275013
002760     COPY SUWS050.                                                00276013
002770                                                                  00277013
002780*---------------------------------------------------------------* 00278013
002790*  LABEL FORM/DATA RECORD - CHECK-IN SML USING 128 DATA           00279013
002800*  FROM PRINT AND APPLY SYSTEM                                    00280013
002810*---------------------------------------------------------------* 00281013
002820     COPY PCWS257.                                                00282013
002830                                                                  00283013
002840* 07/19/13 RLK BEG                                                00284013
002850*----------------------------------------------------------------*00285013
002860*  BATCH LABEL - RFID CARTON LABEL (FORM AND DATA)               *00286013
002870*----------------------------------------------------------------*00287013
002880     COPY PCWS267.                                                00288013
002890* 07/19/13 RLK END                                                00289013
002900*---------------------------------------------------------------* 00290013
002910*  LABEL FORM/DATA RECORD - CHECK-IN MESSAGE LABEL                00291013
002920*  FROM PRINT AND APPLY SYSTEM                                    00292013
002930*---------------------------------------------------------------* 00293013
002940     COPY PCWS248.                                                00294013
002950                                                                  00295013
002960*---------------------------------------------------------------* 00296013
002970*  LABEL FORM/DATA RECORD - CHECK-IN P2L LABEL                    00297013
002980*  FROM PRINT AND APPLY SYSTEM                                    00298013
002990*---------------------------------------------------------------* 00299013
003000     COPY PCWS249.                                                00300013
003010                                                                  00301013
003020*---------------------------------------------------------------* 00302013
003030*  LABEL FORM/DATA RECORD - CENTRAL STORE BLIND RECEIPT LABEL     00303013
003040*  FROM PRINT AND APPLY SYSTEM                                    00304013
003050*---------------------------------------------------------------* 00305013
003060     COPY PCWS250.                                                00306013
003070                                                                  00307013
003080*----------------------------------------------------------------*00308013
003090*  PROGRAM CONSTANTS                                             *00309013
003100*----------------------------------------------------------------*00310013
003110 01  PC-PROGRAM-CONSTANTS.                                        00311013
003120     05  PC-TRANID                       PIC  X(04)  VALUE 'S771'.00312013
003130     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00313013
003140                                                     COMP SYNC.   00314013
003150     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00315013
003160                                                     COMP SYNC.   00316013
003170     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00317013
003180                                                     COMP SYNC.   00318013
003190     05  PC-RECV                         PIC  X(04)  VALUE 'RECV'.00319013
003200     05  PC-RFDC                         PIC  X(04)  VALUE 'RFDC'.00320013
003210     05  PC-RFDF                         PIC  X(04)  VALUE 'RFDF'.00321013
003220     05  PC-PBSA                         PIC  X(04)  VALUE 'PBSA'.00322013
003230     05  PC-PBSB                         PIC  X(04)  VALUE 'PBSB'.00323013
003240     05  PC-PBSC                         PIC  X(04)  VALUE 'PBSC'.00324013
003250     05  PC-PBSD                         PIC  X(04)  VALUE 'PBSD'.00325013
003260     05  PC-PBSE                         PIC  X(04)  VALUE 'PBSE'.00326013
003270     05  PC-FLAT                         PIC  X(04)  VALUE 'FLAT'.00327013
003280     05  PC-N                            PIC  X(01)  VALUE 'N'.   00328013
003290     05  PC-PO                           PIC  X(02)  VALUE 'PO'.  00329013
003300     05  PC-RCV                          PIC  X(03)  VALUE 'RCV'. 00330013
003310     05  PC-0                            PIC  X(01)  VALUE '0'.   00331013
003320     05  PC-4                            PIC  X(01)  VALUE '4'.   00332013
003330     05  PC-5                            PIC  X(01)  VALUE '5'.   00333013
003340     05  PC-00                           PIC  9(02)  VALUE 00.    00334013
003350     05  PC-COLON                        PIC  X(01)  VALUE ':'.   00335013
003360     05  PC-A                            PIC  X(01)  VALUE 'A'.   00336013
003370     05  PC-B                            PIC  X(01)  VALUE 'B'.   00337013
003380     05  PC-C                            PIC  X(01)  VALUE 'C'.   00338013
003390     05  PC-D                            PIC  X(01)  VALUE 'D'.   00339013
003400     05  PC-E                            PIC  X(01)  VALUE 'E'.   00340013
003410     05  PC-G                            PIC  X(01)  VALUE 'G'.   00341013
003420     05  PC-K                            PIC  X(01)  VALUE 'K'.   00342013
003430     05  PC-L                            PIC  X(01)  VALUE 'L'.   00343013
003440     05  PC-P                            PIC  X(01)  VALUE 'P'.   00344013
003450     05  PC-Q                            PIC  X(01)  VALUE 'Q'.   00345013
003460     05  PC-R                            PIC  X(01)  VALUE 'R'.   00346013
003470     05  PC-T                            PIC  X(01)  VALUE 'T'.   00347013
003480     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   00348013
003490     05  PC-DS                           PIC  X(02)  VALUE 'DS'.  00349013
003500     05  PC-PS                           PIC  X(02)  VALUE 'PS'.  00350013
003510     05  PC-PP                           PIC  X(02)  VALUE 'PP'.  00351013
003520     05  PC-BC                           PIC  X(02)  VALUE 'BC'.  00352013
003530*CLP 10/29/13 - BEGIN                                             00353013
003540     05  PC-S                            PIC  X(01)  VALUE 'S'.   00354013
003550     05  PC-RF                           PIC  X(02)  VALUE 'RF'.  00355013
003560     05  PC-RA                           PIC  X(02)  VALUE 'RA'.  00356013
003570     05  PC-QR                           PIC  X(02)  VALUE 'QR'.  00357013
003580*CLP 10/29/13 -   END                                             00358013
003590     05  PC-FA                           PIC  X(02)  VALUE 'FA'.  00359013
003600     05  PC-ASN                          PIC  X(03)  VALUE 'ASN'. 00360013
003610     05  PC-0-9                          PIC  9(01)  VALUE 0.     00361013
003620     05  PC-ACTIVE                       PIC  X(01)  VALUE 'A'.   00362013
003630     05  PC-M                            PIC  X(01)  VALUE 'M'.   00363013
003640     05  PC-I                            PIC  X(01)  VALUE 'I'.   00364013
003650     05  PC-SPACE                        PIC  X(01)  VALUE ' '.   00365013
003660     05  PC-OF                           PIC  X(04)  VALUE ' OF '.00366013
003670     05  PC-1                            PIC  9(01)  VALUE  1.    00367013
003680     05  PC-2                            PIC  9(01)  VALUE  2.    00368013
003690     05  PC-3                            PIC  9(01)  VALUE  3.    00369013
003700     05  PC-01                           PIC  X(02)  VALUE '01'.  00370013
003710     05  PC-18                           PIC S9(04)  VALUE 18     00371013
003720                                                     COMP SYNC.   00372013
003730     05  PC-19                           PIC S9(04)  VALUE 19     00373013
003740                                                     COMP SYNC.   00374013
003750     05  PC-20                           PIC S9(04)  VALUE 20     00375013
003760                                                     COMP SYNC.   00376013
003770     05  PC-NEG-9                        PIC S9(09)  VALUE        00377013
003780                                                      -999999999. 00378013
003790     05  PC-DEFAULT-TIME                 PIC  X(26)  VALUE        00379013
003800                                 '9999-09-09-09.09.09.999999'.    00380013
003810**PACK BY STORE TROUBLE CODES                                     00381013
003820     05  PC-QTY-ERR-TRBL-CODE-350       PIC S9(04) COMP VALUE 350.00382013
003830     05  PC-UPC-NOT-ON-PO-TRBL-351      PIC S9(04) COMP VALUE 351.00383013
003840     05  PC-LNE-ZERO-TRBL-CODE-352      PIC S9(04) COMP VALUE 352.00384013
003850     05  PC-UPC-CRTN-TRBL-CODE-353      PIC S9(04) COMP VALUE 353.00385013
003860     05  PC-UPC-PKSL-TRBL-CODE-354      PIC S9(04) COMP VALUE 354.00386013
003870*----------------------------------------------------------------*00387013
003880* PROGRAM NAMES                                                  *00388013
003890*----------------------------------------------------------------*00389013
003900     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)  VALUE 'SUKCS782'. 00390099
003910     05  PC-SU-TRAILER-PGM          PIC  X(08)  VALUE 'SUKRF501'. 00391013
003920     05  PC-SU-CARTON-AUDIT-PGM     PIC  X(08)  VALUE 'SUKRF509'. 00392013
003930     05  PC-SU-AUDIT-STATUS-PGM     PIC  X(08)  VALUE 'SUKRF536'. 00393013
003940     05  PC-SU-AUDIT-DEF-PRMPT-PGM  PIC  X(08)  VALUE 'SUKRF534'. 00394013
003950     05  PC-SU-CARTON-AUDIT-STATUS  PIC  X(08)  VALUE 'SUKRF538'. 00395013
003960     05  PC-TROUBLE-WTR             PIC  X(08)  VALUE 'TMKCS521'. 00396013
003970     05  PC-FA-HANDLER-PGM          PIC  X(08)  VALUE 'SUKUT705'. 00397013
003980     05  PC-AUTOVE-DETERMIN-PGM     PIC  X(08)  VALUE 'RCKUT127'. 00398013
003981     05  PC-THIN-SLICE-MOD          PIC  X(08)  VALUE 'SUKCS700'. 00398175
003990     05  PC-TROUBLE-LENGTH          PIC S9(04)  COMP VALUE +600.  00399013
004000     05  PC-SU-LBL-PRT-TRANS        PIC  X(08)  VALUE 'S527'.     00400013
004010     05  PC-SU-CRTN-VERIF-TRIGGER   PIC  X(08)  VALUE 'S764'.     00401013
004020     05  PC-CONTAINER-UPD-TRAN      PIC  X(04)  VALUE 'I210'.     00402013
004030*ap 7/12/07 begin                                                 00403013
004040     05  PC-POG-NAME-SPACES             PIC  X(35)                00404013
004050                 VALUE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'.     00405013
004060*ap 7/12/07 end                                                   00406013
004070*----------------------------------------------------------------*00407013
004080 01  PC-LABEL-MESSAGES.                                           00408013
004090*----------------------------------------------------------------*00409013
004100     05  PC-DEFAULT-LABEL-MSG       PIC X(35) VALUE               00410013
004110                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 00411013
004120     05  PC-NOT-ATTACHED-RCVR-MSG   PIC X(35) VALUE               00412013
004130                           'CARTON NOT ATTACHED TO A RECEIVER  '. 00413013
004140     05  PC-NOT-FOUND-MSG           PIC X(35) VALUE               00414013
004150                           '*** NO ITEM INFO - DETAIL CHECK ***'. 00415013
004160     05  PC-FREE-ASTRY-NO-RCVR-MSG  PIC X(35) VALUE               00416013
004170                           '***FREE ASTY - CRTN NO RECEIVER ***'. 00417013
004180     05  PC-FREE-ASTRY-NO-TRIP-MSG  PIC X(35) VALUE               00418013
004190                           '***FREE ASTY - RCVR NO SCAC/TRLR***'. 00419013
004200     05  PC-DUPLICATE-SCAN-MSG      PIC X(35) VALUE               00420013
004210                           '** DUPLICATE SCAN - DETAIL CHECK **'. 00421013
004220     05  PC-DETAIL-CK-NEED-MSG      PIC X(35) VALUE               00422013
004230                           '* * * * DETAIL CHECK NEEDED * * * *'. 00423013
004240     05  PC-MISDIRECT-MSG          PIC X(35) VALUE                00424013
004250                           '* * *  M I S  -  D I R E C T * * * '. 00425013
004260     05  PC-INACT-PKSK-CRE-NEW-RCVR PIC X(35) VALUE               00426013
004270                           '** INACT PKSLP/CREATE NEW RCVR  ***'. 00427013
004280     05  PC-PKSLIP-CARTON-UNEQUAL   PIC X(35) VALUE               00428013
004290                           '** PACKSLIP/CARTON DATA UNEQUAL ***'. 00429013
004300     05  PC-CASEPK-NOT-DNLD-RECVR   PIC X(35) VALUE               00430013
004310                           '** CASEPACK NOT DNLD FOR RECVR *** '. 00431013
004320     05  PC-CASEPK-DNLD-PHYSCL      PIC X(35) VALUE               00432013
004330                           '** CASEPACK DNLD PHYSICAL LABELS***'. 00433013
004340     05  PC-FREE-ASTY-NEED-TRANS    PIC X(35) VALUE               00434013
004350                           '** FREE ASTY NEEDS TRANSCRIPTION***'. 00435013
004360     05  PC-HOLD-CRTN-TRIP-END      PIC X(35) VALUE               00436013
004370                           '** HOLD CARTON UNTIL TRLR EMPTY ***'. 00437013
004380     05  PC-UNUSABLE-128-NO-PKSLIP  PIC X(35) VALUE               00438013
004390                           '**** UNUSABLE UCC128 DATA     *****'. 00439013
004400     05  PC-TRANSC-CHECK-IN-RCVR    PIC X(35) VALUE               00440013
004410                           '** TRANSCRIBE CHECK IN RECEIVER ***'. 00441013
004420     05  PC-MULT-BRCDES-FND-MSG     PIC X(35) VALUE               00442013
004430                           '*** MULT KOHLS BARCODES ON CARTON**'. 00443013
004440     05  PC-MULT-SML-ERR-MSG        PIC X(35) VALUE               00444013
004450                           '*** MULTIPLE SML BARCODES FOUND ***'. 00445013
004460     05  PC-MULT-SML-P2L-MSG        PIC X(35) VALUE               00446013
004470                           '*** SML AND P2L BARCODES FOUND  ***'. 00447013
004480     05  PC-INPK-CNVYB-MSG          PIC X(35) VALUE               00448013
004490                           '** CSPACK DNLD AS INPK CONVEYABLE**'. 00449013
004500     05  PC-MULT-LABELS-MSG         PIC X(35) VALUE               00450013
004510                           '***UNABLE TO PROCESS MULT LABELS **'. 00451013
004520     05  PC-VRFD-LINE-EXIST-MSG     PIC X(35) VALUE               00452013
004530                           '*** CRTN CONTAINS VERIFIED LINES **'. 00453013
004540     05  PC-VALID-BRCDE-MESSAGE     PIC X(35) VALUE               00454013
004550                           '*** NO VALID BARCODE WAS SCANNED **'. 00455013
004560     05  PC-DUP-VNDR-BRCDE-MSG      PIC X(35) VALUE               00456013
004570                           '**DUPLICATE VENDOR BRCDE SCANNED** '. 00457013
004580     05  PC-DUPLICATE-TRIP-DISPLAY  PIC X(35) VALUE SPACES.       00458013
004590* DMH - 9/22/11                                                   00459013
004600     05  PC-BARCODE-1-ERROR-MSG.                                  00460013
004610         10 FILLER                  PIC X(06) VALUE '***   '.     00461013
004620         10 PC-BARCODE-1-ERROR      PIC X(22) VALUE SPACES.       00462013
004630         10 FILLER                  PIC X(07) VALUE '    ***'.    00463013
004640*                                                                 00464013
004650     05  PC-BARCODE-2-ERROR-MSG.                                  00465013
004660         10 FILLER                  PIC X(06) VALUE '***   '.     00466013
004670         10 PC-BARCODE-2-ERROR      PIC X(22) VALUE SPACES.       00467013
004680         10 FILLER                  PIC X(07) VALUE '    ***'.    00468013
004690                                                                  00469013
004700                                                                  00470013
004710*----------------------------------------------------------------*00471013
004720*  PROGRAM SWITCHES                                              *00472013
004730*----------------------------------------------------------------*00473013
004740 01  PS-PROGRAM-SWITCHES.                                         00474013
004750     05  PS-LOG-MESSAGE-SW              PIC  X       VALUE 'N'.   00475013
004760         88  PS-LOG-MESSAGE                          VALUE 'Y'.   00476013
004770         88  PS-NO-LOG-MESSAGE                       VALUE 'N'.   00477013
004780     05  PS-MSG-1-SW                     PIC  X(01)  VALUE 'N'.   00478013
004790         88  PS-NO-MSG-1                             VALUE 'N'.   00479013
004800         88  PS-YES-MSG-1                            VALUE 'Y'.   00480013
004810     05  PS-MSG-2-SW                     PIC  X(01)  VALUE 'N'.   00481013
004820         88  PS-NO-MSG-2                             VALUE 'N'.   00482013
004830         88  PS-YES-MSG-2                            VALUE 'Y'.   00483013
004840     05  PS-DUPLICATE-CARTON-SW          PIC  X(01)  VALUE 'N'.   00484013
004850         88  PS-DUPLICATE-CARTON                     VALUE 'Y'.   00485013
004860         88  PS-NO-DUPLICATE-CARTON                  VALUE 'N'.   00486013
004870     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   00487013
004880         88  PS-VALID-INPUT                          VALUE 'Y'.   00488013
004890         88  PS-INVALID-INPUT                        VALUE 'N'.   00489013
004900     05  PS-DUPLICATE-SW                 PIC  X(01)  VALUE 'N'.   00490013
004910         88  PS-DUPLICATE-FOUND                      VALUE 'Y'.   00491013
004920         88  PS-NO-DUPLICATE-FOUND                   VALUE 'N'.   00492013
004930     05  PS-NOT-FOUND-SW                 PIC  X(01)  VALUE 'Y'.   00493013
004940         88  PS-FOUND                                VALUE 'Y'.   00494013
004950         88  PS-NOT-FOUND                            VALUE 'N'.   00495013
004960     05  PS-SULBXF-RECORD-FOUND-SW       PIC  X(01)  VALUE 'Y'.   00496013
004970         88  PS-SULBXF-RECORD-FOUND                  VALUE 'Y'.   00497013
004980         88  PS-SULBXF-RECORD-NOT-FOUND              VALUE 'N'.   00498013
004990     05  PS-ACTIVE-XREF-ROW-FOUND-SW     PIC  X(01)  VALUE 'Y'.   00499013
005000         88  PS-ACTIVE-XREF-ROW-FOUND                VALUE 'Y'.   00500013
005010         88  PS-ACTIVE-XREF-ROW-NOT-FOUND            VALUE 'N'.   00501013
005020     05  PS-XREF-PBS-FOUND-SW            PIC  X(01)  VALUE 'N'.   00502013
005030         88  PS-XREF-PBS-FOUND                       VALUE 'Y'.   00503013
005040         88  PS-XREF-PBS-NOT-FOUND                   VALUE 'N'.   00504013
005050     05  PS-CHECK-DIGIT-IND              PIC  X(01)  VALUE 'N'.   00505013
005060         88  PS-VALID-CHECK-DIGIT                    VALUE 'Y'.   00506013
005070         88  PS-INVALID-CHECK-DIGIT                  VALUE 'N'.   00507013
005080     05  PS-SCANNED-DATA-IND             PIC  X(01)  VALUE 'Y'.   00508013
005090         88  PS-NOT-SCANNED-DATA                     VALUE 'N'.   00509013
005100         88  PS-SCANNED-DATA                         VALUE 'Y'.   00510013
005110     05  PS-OPER-IS-DC-STORE-SW          PIC  X(01)  VALUE ' '.   00511013
005120         88  PS-OPER-IS-DC                           VALUE 'D'.   00512013
005130         88  PS-OPER-IS-STORE                        VALUE 'S'.   00513013
005140         88  PS-OPER-IS-ECOMM-STORE                  VALUE 'E'.   00514013
005150     05  PS-OPER-IS-ECOMM-DC-SW          PIC  X(01)  VALUE 'N'.   00515013
005160         88  PS-OPER-NOT-ECOMM-DC                    VALUE 'N'.   00516013
005170         88  PS-OPER-IS-ECOMM-DC                     VALUE 'Y'.   00517013
005180     05  PS-OPER-IS-ECOMM-DS-SW          PIC  X(01)  VALUE 'N'.   00518013
005190         88  PS-OPER-NOT-ECOMM-DS                    VALUE 'N'.   00519013
005200         88  PS-OPER-IS-ECOMM-DS                     VALUE 'Y'.   00520013
005210     05  PS-NEW-STORE-FIXTURE-IND        PIC X(1)    VALUE 'N'.   00521013
005220         88  PS-NO-NEW-STORE-FIXTURE                 VALUE 'N'.   00522013
005230         88  PS-NEW-STORE-FIXTURE                    VALUE 'Y'.   00523013
005240     05  PS-REPRINT-FORM-SW              PIC  X(01)  VALUE 'N'.   00524013
005250         88  PS-REPRINT-FORM                         VALUE 'Y'.   00525013
005260         88  PS-NOT-REPRINT-FORM                     VALUE 'N'.   00526013
005270     05  PS-CARTON-EXISTS-SW             PIC  X(01)  VALUE 'Y'.   00527013
005280         88  PS-CARTON-EXISTS                        VALUE 'Y'.   00528013
005290         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   00529013
005300     05  PS-EO-UNITS-CSR-SW              PIC  X(01)  VALUE 'N'.   00530013
005310         88  PS-EO-UNITS-CSR                         VALUE 'Y'.   00531013
005320         88  PS-NOT-EO-UNITS-CSR                     VALUE 'N'.   00532013
005330     05  PS-EO-PREPK-CSR-SW              PIC  X(01)  VALUE 'N'.   00533013
005340         88  PS-EO-PREPK-CSR                         VALUE 'Y'.   00534013
005350         88  PS-NOT-EO-PREPK-CSR                     VALUE 'N'.   00535013
005360     05  PS-END-OF-VRTL-LBL-CSR-SW       PIC  X(01)  VALUE 'N'.   00536013
005370         88  PS-END-OF-VRTL-LBL-CSR                  VALUE 'Y'.   00537013
005380         88  PS-NOT-END-OF-VRTL-LBL-CSR              VALUE 'N'.   00538013
005390     05  PS-END-OF-REPRINT-CSR-SW        PIC  X(01)  VALUE 'N'.   00539013
005400         88  PS-END-OF-REPRINT-CSR                   VALUE 'Y'.   00540013
005410         88  PS-NOT-END-OF-REPRINT-CSR               VALUE 'N'.   00541013
005420     05  PS-END-OF-UPC-UNLOAD-CSR-SW     PIC  X(01)  VALUE 'N'.   00542013
005430         88  PS-END-OF-UPC-UNLOAD-CSR                VALUE 'Y'.   00543013
005440         88  PS-NOT-END-OF-UPC-UNLOAD-CSR            VALUE 'N'.   00544013
005450     05  PS-LABEL-DATA-FOUND-SW          PIC  X(01)  VALUE 'N'.   00545013
005460         88  PS-LABEL-DATA-FOUND                     VALUE 'Y'.   00546013
005470         88  PS-LABEL-DATA-NOT-FOUND                 VALUE 'N'.   00547013
005480     05  PS-DISPLAY-SUKRF530-SW          PIC  X(01)  VALUE 'N'.   00548013
005490         88  PS-DISPLAY-SUKRF530                     VALUE 'Y'.   00549013
005500         88  PS-DONT-DISPLAY-SUKRF530                VALUE 'N'.   00550013
005510     05  PS-SUCCESSFUL-UPDATE-SW         PIC  X(01)  VALUE 'N'.   00551013
005520         88  PS-SUCCESSFUL-UPDATE                    VALUE 'Y'.   00552013
005530         88  PS-NOT-SUCCESSFUL-UPDATE                VALUE 'N'.   00553013
005540     05  PS-DONE-SW                      PIC  X(01)  VALUE 'N'.   00554013
005550         88  PS-DONE                                 VALUE 'Y'.   00555013
005560         88  PS-NOT-DONE                             VALUE 'N'.   00556013
005570     05  PS-FOUND-ON-CURSOR-SW           PIC  X(01)  VALUE 'Y'.   00557013
005580         88  PS-FOUND-ON-CURSOR                      VALUE 'Y'.   00558013
005590         88  PS-NOT-FOUND-ON-CURSOR                  VALUE 'N'.   00559013
005600     05  PS-REPRINT-DUP-SW               PIC  X(01)  VALUE 'N'.   00560013
005610         88  PS-REPRINT-DUP                          VALUE 'Y'.   00561013
005620         88  PS-NOT-REPRINT-DUP                      VALUE 'N'.   00562013
005630     05  PS-TRNGLE-TRANS-SW              PIC  X(01)  VALUE 'N'.   00563013
005640         88  PS-TRNGLE-TRANS                         VALUE 'Y'.   00564013
005650         88  PS-NOT-TRNGLE-TRANS                     VALUE 'N'.   00565013
005660     05  PS-FIRST-PO-LINE-SW             PIC  X(01)  VALUE 'Y'.   00566013
005670         88  PS-FIRST-PO-LINE-FOR-CTN                VALUE 'Y'.   00567013
005680         88  PS-NOT-FIRST-PO-LINE-FOR-CTN            VALUE 'N'.   00568013
005690     05  PS-PRINT-AUDIT-LABEL-SW         PIC  X(01)  VALUE 'N'.   00569013
005700         88  PS-PRINT-AUDIT-LABEL                    VALUE 'Y'.   00570013
005710         88  PS-DONT-PRINT-AUDIT-LABEL               VALUE 'N'.   00571013
005720     05  PS-FIRST-ODD-UNTS-FETCH-SW      PIC  X(01)  VALUE 'Y'.   00572013
005730         88  PS-FIRST-ODD-UNTS-FETCH                 VALUE 'Y'.   00573013
005740         88  PS-NOT-FIRST-ODD-UNTS-FETCH             VALUE 'N'.   00574013
005750     05  PS-FOUND-ON-ODD-UNTS-CSR-SW     PIC  X(01)  VALUE 'Y'.   00575013
005760         88  PS-FOUND-ON-ODD-UNTS-CSR                VALUE 'Y'.   00576013
005770         88  PS-EO-ODD-UNTS-CSR                      VALUE 'N'.   00577013
005780     05  PS-ODD-UNT-CRTN-FOUND-SW        PIC  X(01)  VALUE 'N'.   00578013
005790         88  PS-ODD-UNT-CRTN-FOUND                   VALUE 'Y'.   00579013
005800         88  PS-NOT-ODD-UNT-CRTN-FOUND               VALUE 'N'.   00580013
005810     05  PS-FIRST-PREPK-SW               PIC  X(01)  VALUE 'Y'.   00581013
005820         88  PS-FIRST-PREPK                          VALUE 'Y'.   00582013
005830         88  PS-NOT-FIRST-PREPK                      VALUE 'N'.   00583013
005840     05  PS-HANG-FOLD-CSR-SW             PIC  X(01)  VALUE 'N'.   00584013
005850         88  PS-EO-HANG-FOLD-CSR                     VALUE 'Y'.   00585013
005860         88  PS-NOT-EO-HANG-FOLD-CSR                 VALUE 'N'.   00586013
005870     05  PS-EO-WEIGHTS-MSRS-CSR-SW       PIC  X(01)  VALUE 'N'.   00587013
005880         88  PS-EO-WEIGHTS-MSRS-CSR                  VALUE 'Y'.   00588013
005890         88  PS-NOT-EO-WEIGHTS-MSRS-CSR              VALUE 'N'.   00589013
005900     05  PS-HANG-FOLD-MIXED-SW           PIC  X(01)  VALUE 'N'.   00590013
005910         88  PS-HANG-FOLD-MIXED                      VALUE 'Y'.   00591013
005920         88  PS-NOT-HANG-FOLD-MIXED                  VALUE 'N'.   00592013
005930     05  PS-FIRST-UPC-CALL-SW            PIC  X(01)  VALUE 'N'.   00593013
005940         88  PS-FIRST-UPC-CALL                       VALUE 'Y'.   00594013
005950         88  PS-NOT-FIRST-UPC-CALL                   VALUE 'N'.   00595013
005960     05  PS-CARTON-STATUS-SW             PIC  X(01)  VALUE 'N'.   00596013
005970         88  PS-INACTV-CRTN-FND                      VALUE 'Y'.   00597013
005980         88  PS-ACTV-CRTN-FND                        VALUE 'N'.   00598013
005990     05  PS-INVALID-CREATE-SOURCE-SW     PIC  X(01)  VALUE 'N'.   00599013
006000         88  PS-INVALID-CRE-SOURCE                   VALUE 'Y'.   00600013
006010         88  PS-NOT-INVALID-CRE-SOURCE               VALUE 'N'.   00601013
006020     05  PS-BLND-RECV-SIMPL-LOC-SW       PIC  X(01)  VALUE 'N'.   00602013
006030         88  PS-BLND-RECV-SIMPL-LOC-FND              VALUE 'Y'.   00603013
006040         88  PS-BLND-RECV-SIMPL-LOC-NOT-FND          VALUE 'N'.   00604013
006050     05  PS-MISDIRECT-PACK-BY-STORE-SW   PIC  X(01)  VALUE 'N'.   00605013
006060         88  PS-MISDIRECT-PACK-BY-STORE              VALUE 'Y'.   00606013
006070         88  PS-MISDIRECT-PACK-BY-STORE-NO           VALUE 'N'.   00607013
006080     05  PS-INACTV-PBS-CARTON-FOUND-SW   PIC  X(01)  VALUE 'N'.   00608013
006090         88  PS-INACTV-PBS-CARTON-YES                VALUE 'Y'.   00609013
006100         88  PS-INACTV-PBS-CARTON-NO                 VALUE 'N'.   00610013
006110     05  PS-CASEPACK-LBL-PRINT-SW        PIC  X(01)  VALUE 'Y'.   00611013
006120         88  PS-CASEPK-FOUND                         VALUE 'Y'.   00612013
006130         88  PS-NO-CASEPK-FND                        VALUE 'N'.   00613013
006140     05  PS-PBS-TROUBLE-FOUND-SW         PIC  X(01)  VALUE 'N'.   00614013
006150         88  PS-TROUBLE-FOUND                        VALUE 'Y'.   00615013
006160         88  PS-NO-TROUBLE-FOUND                     VALUE 'N'.   00616013
006170     05  PS-PBS-RTV-ALLOC-SW             PIC  X(02)  VALUE '  '.  00617013
006180         88  PS-PBS-RTV-ALLOC                        VALUE 'RA'.  00618013
006190         88  PS-PBS-RTV-NO-ALLOC                     VALUE 'RN'.  00619013
006200     05  PS-AUDIT-PROMPT-CHECK-SW        PIC  X(01)  VALUE 'N'.   00620013
006210         88  PS-AUDIT-PROMPT-CHECK-YES               VALUE 'Y'.   00621013
006220         88  PS-AUDIT-PROMPT-CHECK-NO                VALUE 'N'.   00622013
006230     05  PS-INPK-AUD-INLINE-REQUIRED-SW  PIC  X(01)  VALUE 'Y'.   00623013
006240         88  PS-INPK-AUD-INLINE-YES                  VALUE 'Y'.   00624013
006250         88  PS-INPK-AUD-INLINE-NO                   VALUE 'N'.   00625013
006260     05  PS-PBS-CRTN-RCVR-MISMTCH-SW     PIC  X(01)  VALUE 'N'.   00626013
006270         88  PS-PBS-CRTN-RCVR-MISMTCH-YES            VALUE 'Y'.   00627013
006280         88  PS-PBS-CRTN-RCVR-MISMTCH-NO             VALUE 'N'.   00628013
006290     05  PS-FREE-ASTRAY-PROCESS-SW       PIC  X(01)  VALUE 'N'.   00629013
006300         88  PS-FREE-ASTRAY-PROCESS                  VALUE 'Y'.   00630013
006310         88  PS-FREE-ASTRAY-PROCESS-NO               VALUE 'N'.   00631013
006320     05  PS-SML-CREATION-SW              PIC  X(01)  VALUE 'N'.   00632013
006330         88  PS-CARTON-SML-CREATED                   VALUE 'S'.   00633013
006340         88  PS-CARTON-P2L-CREATED                   VALUE 'P'.   00634013
006350         88  PS-NO-CARTON-SML-CREATED                VALUE 'N'.   00635013
006360     05  PS-SULBXF-ROW-FOUND-SW          PIC  X(01)  VALUE 'N'.   00636013
006370         88  PS-SULBXF-ROW-FOUND                     VALUE 'Y'.   00637013
006380         88  PS-NO-SULBXF-ROW-FOUND                  VALUE 'N'.   00638013
006390     05  PS-RCVR-DATA-FOUND-SW           PIC  X(01)  VALUE 'Y'.   00639013
006400         88  PS-RCVR-DATA-FOUND-YES                  VALUE 'Y'.   00640013
006410         88  PS-RCVR-DATA-FOUND-NO                   VALUE 'N'.   00641013
006420     05  PS-UCC128-PKSLIP-ERROR-SW       PIC  X(01)  VALUE 'N'.   00642013
006430         88  PS-UCC128-PKSLIP-ERROR-YES              VALUE 'Y'.   00643013
006440         88  PS-UCC128-PKSLIP-ERROR-NO               VALUE 'N'.   00644013
006450     05  PS-FREE-ASTRAY-MSG-LBL-SW       PIC  X(01)  VALUE 'N'.   00645013
006460         88  PS-FREE-ASTRAY-MSG-LBL-YES              VALUE 'Y'.   00646013
006470         88  PS-FREE-ASTRAY-MSG-LBL-NO               VALUE 'N'.   00647013
006480     05  PS-WEIGHTS-MEAUSURES-CHECK-SW   PIC  X(01)  VALUE 'N'.   00648013
006490         88  PS-WEIGHTS-MEAUSURES-CHECK              VALUE 'Y'.   00649013
006500         88  PS-WEIGHTS-MEAUSURES-CHECK-NO           VALUE 'N'.   00650013
006510     05  PS-RECITM-VERIFIED-LINES-SW     PIC  X(01)  VALUE 'N'.   00651013
006520         88  PS-RECITM-VERIFIED-LINES-YES            VALUE 'Y'.   00652013
006530         88  PS-RECITM-VERIFIED-LINES-NO             VALUE 'N'.   00653013
006540     05  PS-UCC128-VND-BRCDE1-SW         PIC  X(01)  VALUE 'N'.   00654013
006550         88  PS-UCC128-VND-BRCD1-FOUND               VALUE 'Y'.   00655013
006560         88  PS-UCC128-VND-BRCD1-NOT-FND             VALUE 'N'.   00656013
006570     05  PS-UCC128-VND-BRCDE2-SW         PIC  X(01)  VALUE 'N'.   00657013
006580         88  PS-UCC128-VND-BRCD2-FOUND               VALUE 'Y'.   00658013
006590         88  PS-UCC128-VND-BRCD2-NOT-FND             VALUE 'N'.   00659013
006600     05  PS-KOHLS-SML-BRCD1-SW           PIC  X(01)  VALUE 'N'.   00660013
006610         88  PS-KOHLS-SML-BRCD1-FOUND                VALUE 'Y'.   00661013
006620         88  PS-KOHLS-SML-BRCD1-NOT-FND              VALUE 'N'.   00662013
006630     05  PS-KOHLS-SML-BRCD2-SW           PIC  X(01)  VALUE 'N'.   00663013
006640         88  PS-KOHLS-SML-BRCD2-FOUND                VALUE 'Y'.   00664013
006650         88  PS-KOHLS-SML-BRCD2-NOT-FND              VALUE 'N'.   00665013
006660     05  PS-KOHLS-SML-BRCD3-SW           PIC  X(01)  VALUE 'N'.   00666013
006670         88  PS-KOHLS-SML-BRCD3-FOUND                VALUE 'Y'.   00667013
006680         88  PS-KOHLS-SML-BRCD3-NOT-FND              VALUE 'N'.   00668013
006690     05  PS-PROCESSING-ERROR-sw          PIC  X(01)  VALUE 'N'.   00669013
006700         88  PS-PROCESSING-ERROR-YES                 VALUE 'Y'.   00670013
006710         88  PS-PROCESSING-ERROR-NO                  VALUE 'N'.   00671013
006720     05  PS-VALID-SML-BRCDE-SW           PIC  X(01)  VALUE 'N'.   00672013
006730         88  PS-VALID-SML-BRCDE-YES                  VALUE 'Y'.   00673013
006740         88  PS-VALID-SML-BRCDE-NO                   VALUE 'N'.   00674013
006750     05  PS-PACK-BY-STORE-IND            PIC  X(01)  VALUE 'N'.   00675013
006760         88  PS-PACK-BY-STORE                        VALUE 'Y'.   00676013
006770         88  PS-NOT-PACK-BY-STORE                    VALUE 'N'.   00677013
006780     05  PS-MULTI-LINE-IND               PIC  X(01)  VALUE SPACE. 00678013
006790         88  PS-MULTI-LINE                           VALUE 'Y'.   00679013
006800         88  PS-NOT-MULTI-LINE                       VALUE 'N'.   00680013
006810     05  PS-NO-LINE-IND                  PIC  X(01)  VALUE SPACE. 00681013
006820         88  PS-NO-LINE                              VALUE 'Y'.   00682013
006830         88  PS-LINE-FND                             VALUE 'N'.   00683013
006840     05  PS-AUTO-VE-SW                   PIC  X(01)  VALUE 'N'.   00684013
006850         88  PS-AUTO-VE-YES                          VALUE 'Y'.   00685013
006860         88  PS-AUTO-VE-NO                           VALUE 'N'.   00686013
006870     05  PS-CRTN-ATT-TO-RCVR-SW      PIC  X(01)  VALUE SPACE.     00687013
006880         88  PS-CRTN-ATT-TO-RCVR                 VALUE 'Y'.       00688013
006890         88  PS-NOT-CRTN-ATT-TO-RCVR             VALUE 'N'.       00689013
006900     05  PS-CRTN-ATT-TO-TRIP-SW      PIC  X(01)  VALUE SPACE.     00690013
006910         88  PS-CRTN-ATT-TO-TRIP                 VALUE 'Y'.       00691013
006920         88  PS-NOT-CRTN-ATT-TO-TRIP             VALUE 'N'.       00692013
006930     05  PS-REPRINT-IND              PIC  X(01)  VALUE SPACE.     00693013
006940         88  PS-REPRINT                          VALUE 'Y'.       00694013
006950         88  PS-NOT-REPRINT                      VALUE SPACE.     00695013
006960     05  PS-LBL-REPRINT-IND          PIC  X(01)  VALUE SPACE.     00696013
006970         88  PS-LBL-REPRINT                      VALUE 'Y'.       00697013
006980         88  PS-NOT-LBL-REPRINT                  VALUE SPACE.     00698013
006990     05  PS-ECOMM-DC-REPUR-SW        PIC  X(01)  VALUE 'N'.       00699013
007000         88  PS-ECOMM-DC-REPURPOSE               VALUE 'Y'.       00700013
007010         88  PS-ECOMM-DC-REPURPOSE-NO            VALUE 'N'.       00701013
007020     05  PS-WRONG-FCLTY-IND          PIC  X(01)  VALUE SPACE.     00702013
007030         88  PS-WRONG-FCLTY                      VALUE 'W'.       00703013
007040     05  PS-BARCODE-ERROR-SW         PIC  X(01)  VALUE 'N'.       00704013
007050         88  PS-BRCDE-ERROR-FND                  VALUE 'Y'.       00705013
007060         88  PS-NO-BRCDE-ERROR-FND               VALUE 'N'.       00706013
007070     05  PS-SML-UCC128-MISMATCH-SW   PIC  X(01)  VALUE 'N'.       00707013
007080         88  PS-SML-UCC128-MISMATCH              VALUE 'Y'.       00708013
007090         88  PS-SML-UCC128-MATCH                 VALUE 'N'.       00709013
007100     05  PS-MULT-SSCC-SW             PIC  X(01)  VALUE 'N'.       00710013
007110         88  PS-MULT-SSCC-YES                    VALUE 'Y'.       00711013
007120         88  PS-MULT-SSCC-NO                     VALUE 'N'.       00712013
007130     05  PS-INPK-CNVYB-FOUND-SW      PIC  X(01)  VALUE 'N'.       00713013
007140         88  PS-INPK-CNVYB-FOUND-YES             VALUE 'Y'.       00714013
007150         88  PS-INPK-CNVYB-FOUND-NO              VALUE 'N'.       00715013
007160     05  PS-VALID-BARCODE-SW         PIC  X(01)  VALUE 'Y'.       00716013
007170         88  PS-VALID-BRCDE-FOUND                VALUE 'Y'.       00717013
007180         88  PS-NO-VALID-BRCDES-FND              VALUE 'N'.       00718013
007190     05  PS-MESSG-LBL-IND            PIC  X(01)  VALUE SPACE.     00719013
007200         88  PS-UCC128-PBS-RCVR                  VALUE 'A'.       00720013
007210         88  PS-UCC128-NO-RCVR                   VALUE 'B'.       00721013
007220         88  PS-UCC128-CENTRAL-STOCK             VALUE 'C'.       00722013
007230         88  PS-UCC128-DUP-CTN                   VALUE 'D'.       00723013
007240         88  PS-UCC128-COMTEC-INPK               VALUE 'E'.       00724013
007250         88  PS-UCC128-AUDIT-CHECK               VALUE 'F'.       00725013
007260         88  PS-UCC128-GENERAL-MESS              VALUE 'G'.       00726013
007270         88  PS-ASGMT-CLOSED-RETURN              VALUE 'H'.       00727013
007280         88  PS-UCC128-IGNORED                   VALUE 'I'.       00728013
007281         88  PS-THIN-SLICE-SELECTED              VALUE 'J'.       00728190
007290         88  PS-UCC128-NO-LABEL-DATA             VALUE 'L'.       00729013
007300         88  PS-UCC128-NOT-AVAILABLE             VALUE 'N'.       00730013
007310         88  PS-UCC128-PREPK-ORD                 VALUE 'P'.       00731013
007320         88  PS-CREATE-SOURCE-RECV               VALUE 'R'.       00732013
007330         88  PS-STAT-WARNG-MESSGE-DEP            VALUE 'S'.       00733013
007340         88  PS-FREE-ASTRY-TRIP-MESS             VALUE 'T'.       00734013
007350         88  PS-INACTV-CRTN-MESSAGE              VALUE 'V'.       00735013
007360         88  PS-STAT-WARNG-MESSGE-DEL            VALUE 'W'.       00736013
007370         88  PS-UCC128-UNABLE-TO-ASSIGN          VALUE 'X'.       00737013
007380     05  PS-P2L-FORCED-DIVERT-SW     PIC  X(01)  VALUE 'Y'.       00738013
007390         88  PS-P2L-FORCED-DIVERT-YES            VALUE 'Y'.       00739013
007400         88  PS-P2L-FORCED-DIVERT-NO             VALUE 'N'.       00740013
007410* CT 2008-11-12 BEGIN                                             00741013
007420     05  PS-SET-NEW-FRCED-DIVERT-SW  PIC  X(01)  VALUE 'N'.       00742013
007430         88  PS-SET-NEW-FRCED-DIVERT-YES         VALUE 'Y'.       00743013
007440         88  PS-SET-NEW-FRCED-DIVERT-NO          VALUE 'N'.       00744013
007450     05  PS-AUDIT-CARTON-FOUND-SW    PIC  X(01)  VALUE 'N'.       00745013
007460         88  PS-AUDIT-CARTON-FOUND-YES           VALUE 'Y'.       00746013
007470         88  PS-AUDIT-CARTON-FOUND-NO            VALUE 'N'.       00747013
007480     05  PS-AUDIT-CARTON-PENDING-SW  PIC  X(01)  VALUE 'N'.       00748013
007490         88  PS-AUDIT-CARTON-PNDG-YES            VALUE 'Y'.       00749013
007500         88  PS-AUDIT-CARTON-PNDG-NO             VALUE 'N'.       00750013
007510     05  PS-AUDIT-CARTON-PEND-RF-SW  PIC  X(01)  VALUE 'N'.       00751013
007520         88  PS-AUDIT-CRTN-PNDG-RF-YES            VALUE 'Y'.      00752013
007530         88  PS-AUDIT-CRTN-PNDG-RF-NO            VALUE 'N'.       00753013
007540* CT 2008-11-12 END                                               00754013
007550     05  PS-ECOMM-STORE-WRONG-FCLTY-SW   PIC  X(01)  VALUE ' '.   00755013
007560         88  PS-ECOMM-STORE-NO-RCVR                  VALUE 'N'.   00756013
007570     05  PS-HANG-FOLD-IND-FOUND-SW       PIC  X(01)  VALUE 'N'.   00757013
007580         88  PS-HANG-FOLD-IND-FOUND-YES              VALUE 'Y'.   00758013
007590         88  PS-HANG-FOLD-IND-FOUND-NO               VALUE 'N'.   00759013
007600     05  PS-EAS-TAG-IND-FOUND-SW         PIC  X(01)  VALUE 'N'.   00760013
007610         88  PS-EAS-TAG-IND-FOUND-YES                VALUE 'Y'.   00761013
007620         88  PS-EAS-TAG-IND-FOUND-NO                 VALUE 'N'.   00762013
007630*CLP 06/24/2015 START                                             00763013
007640     05  PS-BRAND-FOUND-SW            PIC  X(01)  VALUE 'N'.      00764013
007650         88  PS-BRAND-FOUND-YES                   VALUE 'Y'.      00765013
007660         88  PS-BRAND-FOUND-NO                    VALUE 'N'.      00766013
007670*CLP 06/24/2015 END                                               00767013
007680     05  PS-INSERT-ERROR-SW              PIC  X(01)  VALUE 'N'.   00768013
007690         88  PS-INSERT-ERROR-YES                     VALUE 'Y'.   00769013
007700         88  PS-INSERT-ERROR-NO                      VALUE 'N'.   00770013
007710* CT 11/04/08 BEGIN                                              *00771013
007720     05  PS-AUTO-CONVEY-LVL-SW           PIC  X(03)  VALUE SPACE. 00772013
007730         88  PS-AUTO-CONVEY-NO-CRTNS                 VALUE 'NNE'. 00773013
007740         88  PS-AUTO-CONVEY-EXCPT-CRTNS              VALUE 'EXC'. 00774013
007750         88  PS-AUTO-CONVEY-ALL-CRTNS                VALUE 'ALL'. 00775013
007760* CT 11/04/08 END                                                 00776013
007770                                                                  00777013
007780*TS 06/24/2010 BEG                                                00778013
007790     05  PS-WHSE-OTBND-CART-SW           PIC  X(01)  VALUE 'N'.   00779013
007800         88  PS-WHSE-OTBND-CART-YES                  VALUE 'Y'.   00780013
007810         88  PS-WHSE-OTBND-CART-NO                   VALUE 'N'.   00781013
007820                                                                  00782013
007830     05  PS-OTBND-LOC-ENTRY-SW           PIC  X(01)  VALUE 'N'.   00783013
007840         88  PS-OTBND-LOC-ENTRY-EXIST                VALUE 'Y'.   00784013
007850         88  PS-OTBND-LOC-ENTRY-NOT-EXIST            VALUE 'N'.   00785013
007860*TS 06/24/2010 END                                                00786013
007870* JAK WR41309 - ADD SWITCH                                        00787013
007880     05  PS-RF-ID-FOUND-SW               PIC  X(01)  VALUE 'Y'.   00788013
007890         88  PS-RF-ID-FOUND-YES                      VALUE 'Y'.   00789013
007900         88  PS-RF-ID-FOUND-NO                       VALUE 'N'.   00790013
007910* JAK WR41309 - END                                               00791013
007920* CLP 06/20/13 PR5148B START                                      00792013
007930     05  PS-DIRECTIVE-SW                 PIC  X(01)  VALUE 'N'.   00793013
007940         88  PS-DIRECTIVE-YES                        VALUE 'Y'.   00794013
007950         88  PS-DIRECTIVE-NO                         VALUE 'N'.   00795013
007960     05  PS-RFID-ON-LABEL-SW             PIC  X(01)  VALUE 'N'.   00796013
007970         88  PS-RFID-ON-LABEL-YES                    VALUE 'Y'.   00797013
007980         88  PS-RFID-ON-LABEL-NO                     VALUE 'N'.   00798013
007990*                                                                 00799013
008000     05  PS-RFID-QC-AUD-CMB-IND   PIC X(01)   VALUE SPACES.       00800013
008010         88  PS-RFID-AUD-ONLY                  VALUE 'R'.         00801013
008020         88  PS-QC-AUD-ONLY                    VALUE 'S'.         00802013
008030         88  PS-QC-AND-RFID-AUD                VALUE 'B'.         00803013
008040     05  PS-RFID-DEPT-LEVEL-CHK-SW       PIC  X(01)  VALUE 'N'.   00804063
008050         88  PS-RFID-DEPT-LEVEL-YES                  VALUE 'Y'.   00805063
008060         88  PS-RFID-DEPT-LEVEL-NO                   VALUE 'N'.   00806063
008070     05  PS-RFID-CALL-AUDIT-SW           PIC  X(01)  VALUE 'N'.   00807063
008080         88  PS-RFID-AUDIT-YES                       VALUE 'Y'.   00808063
008090         88  PS-RFID-AUDIT-NO                        VALUE 'N'.   00809063
008100*                                                                 00810013
008110* CLP 06/20/13 PR5148B END                                        00811013
008120* 07/19/13 RLK BEG                                                00812013
008130     05  PS-DC-USE-RFID-CART-LBL-SW      PIC  X(01)  VALUE 'N'.   00813013
008140         88  PS-DC-USE-RFID-CART-LBL-YES             VALUE 'Y'.   00814013
008150         88  PS-DC-USE-RFID-CART-LBL-NO              VALUE 'N'.   00815013
008160* 07/19/13 RLK END                                                00816013
008170                                                                  00817013
008180     05  PS-BLD-INTERNAL-TABLE-SW        PIC  X(01)  VALUE 'N'.   00818013
008190         88  PS-BLD-INTERNAL-TABLE-YES               VALUE 'Y'.   00819013
008200         88  PS-BLD-INTERNAL-TABLE-NO                VALUE 'N'.   00820013
008210                                                                  00821013
008220     05  PS-LABEL-PARM-FOUND-SW          PIC  X(01)  VALUE 'N'.   00822061
008230         88  PS-LABEL-PARM-FOUND                     VALUE 'Y'.   00823061
008240         88  PS-LABEL-PARM-NOT-FOUND                 VALUE 'N'.   00824061
008241                                                                  00824169
008242     05  PS-USE-LAST-4-FROM-TMST-SW      PIC  X(01)  VALUE 'N'.   00824269
008243         88  PS-USE-LAST-4-FROM-TMST                 VALUE 'Y'.   00824369
008244         88  PS-USE-LAST-4-ZEROS                     VALUE 'N'.   00824469
008245                                                                  00824573
008246     05  PS-DC-THIN-SLICE-SW             PIC  X(01)  VALUE 'N'.   00824673
008247         88  PS-DC-THIN-SLICE                        VALUE 'Y'.   00824773
008248         88  PS-DC-THIN-SLICE-NO                     VALUE 'N'.   00824873
008249     05  PS-DC-PNA-RF-DOOR-SW            PIC  X(01)  VALUE 'N'.   00824973
008250         88  PS-DC-PNA-RF-DOOR                       VALUE 'Y'.   00825073
008251         88  PS-DC-PNA-RF-DOOR-NO                    VALUE 'N'.   00825173
008252     05  PS-SELECT-FOR-THIN-SLICE-SW     PIC  X(01)  VALUE 'N'.   00825273
008253         88  PS-SELECT-FOR-THIN-SLICE                VALUE 'Y'.   00825373
008256         88  PS-SELECT-FOR-THIN-SLICE-NO             VALUE 'N'.   00825673
008258                                                                  00825873
008259*----------------------------------------------------------------*00825972
008260*  PROGRAM VARIABLES                                             *00826013
008270*----------------------------------------------------------------*00827013
008280 01  PV-PROGRAM-VARIABLES.                                        00828013
008290                                                                  00829013
008300     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   00830013
008310                                                     COMP SYNC.   00831013
008320     05  PV-NULL-CRE-TMST                PIC S9(4)   VALUE ZERO   00832013
008330                                                     COMP SYNC.   00833013
008340     05  PV-NULL-E-BUS-IND               PIC S9(4)   VALUE ZERO   00834013
008350                                                     COMP SYNC.   00835013
008360     05  PV-CICS-MSG-AREA-A.                                      00836013
008370         10  FILLER                      PIC  X(01)  VALUE SPACE. 00837013
008380         10  PV-CICS-MSG-AREA-B          PIC  X(119) VALUE SPACE. 00838013
008390     05  PV-CICS-MSG-AREA.                                        00839013
008400         10  PV-CICS-MSG-AREA1           PIC  X(119) VALUE SPACE. 00840013
008410         10  PV-CICS-MSG-AREA2           PIC  X(119) VALUE SPACE. 00841013
008420         10  PV-CICS-MSG-AREA3           PIC  X(119) VALUE SPACE. 00842013
008430         10  PV-CICS-MSG-AREA4           PIC  X(119) VALUE SPACE. 00843013
008440         10  PV-CICS-MSG-AREA5           PIC  X(119) VALUE SPACE. 00844013
008450         10  PV-CICS-MSG-AREA6           PIC  X(119) VALUE SPACE. 00845013
008460         10  PV-CICS-MSG-AREA7           PIC  X(119) VALUE SPACE. 00846013
008470         10  PV-CICS-MSG-AREA8           PIC  X(119) VALUE SPACE. 00847013
008480     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  00848013
008490                                                     COMP SYNC.   00849013
008500     05  PV-ABEND-PROCESS-MSG-1 PIC X(99) VALUE SPACES.           00850013
008510     05  PV-ABEND-PROCESS-MSG-2 PIC X(99) VALUE SPACES.           00851013
008520                                                                  00852013
008530     05  PV-FMT-DUPLICATE-CRTN-MSG.                               00853013
008540         10  PV-FMT-DISPLAY-TXT    PIC X(25) VALUE                00854013
008550                       'CRTN PREV SCNNED ON TRIP:'.               00855013
008560         10  PV-DISP-DUP-TRIP      PIC X(10).                     00856013
008570                                                                  00857013
008580     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 00858013
008590     05  PV-REPRINT-CSR-CNT              PIC S9(04)  VALUE ZEROS  00859013
008600                                                     COMP SYNC.   00860013
008610     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  00861013
008620                                                     COMP SYNC.   00862013
008630     05  PV-DLKCS410-COUNT               PIC S9(09)  VALUE ZEROS  00863013
008640                                                     COMP SYNC.   00864013
008650     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  00865013
008660                                                     COMP SYNC.   00866013
008670     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  00867013
008680                                                     COMP SYNC.   00868013
008690     05  PV-VERIF-RECITM-COUNT           PIC S9(04)  VALUE ZEROS  00869013
008700                                                     COMP SYNC.   00870013
008710     05  PV-ROWS-INSERTED                PIC  9(04)  VALUE ZERO   00871013
008720                                                 COMP.            00872013
008730     05  PV-HOLD-LBL-TYP-CDE             PIC  X      VALUE SPACE. 00873013
008740*CLP 06/24/2015 START                                             00874013
008750     05  PV-BUS-AREA-BRAND        PIC  X(35)    VALUE SPACES.     00875013
008760     05  PV-DESC-LEN              PIC S9(04) VALUE +0             00876013
008770                                                COMP.             00877013
008780     05  PV-BUS-AREA-DESC-9       PIC  X(09)    VALUE SPACES.     00878013
008790*CLP 06/24/2015 END                                               00879013
008800* JAK WR41309 - ADD PROGRAM VARIABLES                             00880013
008810     05  PV-RFID-STORE.                                           00881013
008820         10  PV-RFID-STORE-TXT-4         PIC  X(12) VALUE         00882013
008830                                                 '***@RFID@***'.  00883013
008840         10  PV-EAS-STORE-TXT-4          PIC  X(12) VALUE         00884063
008850                                                 '***@EAS@****'.  00885063
008860         10  PV-EAS-RF-STORE-TXT-4       PIC  X(12) VALUE         00886063
008870                                                 '*@EAS/RFID@*'.  00887063
008880     05  PV-ERROR-TEXT                   PIC  X(100) VALUE SPACE. 00888019
008890     05  PV-RD-COUNT                     PIC S9(09)  COMP-3       00889019
008900                                                     VALUE +0.    00890019
008910* JAK WR41309 - END                                               00891019
008920     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 00892019
008930     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 00893019
008940     05  PV-TOTAL                        PIC  9(04).              00894019
008950     05  FILLER REDEFINES PV-TOTAL.                               00895019
008960         10  FILLER                      PIC  9(03).              00896019
008970         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              00897019
008980     05  PV-CTN-X                        PIC  X(18).              00898013
008990     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              00899013
009000     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          00900013
009010         10  PV-CTN-9-1                  PIC  9(01).              00901013
009020         10  PV-CTN-9-2                  PIC  9(01).              00902013
009030         10  PV-CTN-9-3                  PIC  9(01).              00903013
009040         10  PV-CTN-9-4                  PIC  9(01).              00904013
009050         10  PV-CTN-9-5                  PIC  9(01).              00905013
009060         10  PV-CTN-9-6                  PIC  9(01).              00906013
009070         10  PV-CTN-9-7                  PIC  9(01).              00907013
009080         10  PV-CTN-9-8                  PIC  9(01).              00908013
009090         10  PV-CTN-9-9                  PIC  9(01).              00909013
009100         10  PV-CTN-9-10                 PIC  9(01).              00910013
009110         10  PV-CTN-9-11                 PIC  9(01).              00911013
009120         10  PV-CTN-9-12                 PIC  9(01).              00912013
009130         10  PV-CTN-9-13                 PIC  9(01).              00913013
009140         10  PV-CTN-9-14                 PIC  9(01).              00914013
009150         10  PV-CTN-9-15                 PIC  9(01).              00915013
009160         10  PV-CTN-9-16                 PIC  9(01).              00916013
009170         10  PV-CTN-9-17                 PIC  9(01).              00917013
009180         10  PV-CTN-9-18                 PIC  9(01).              00918013
009190                                                                  00919013
009200* dmh - 9-16-11 - begin                                           00920013
009210     05  PV-VNDR-CTN                     PIC  9(18)   VALUE ZEROS.00921013
009220     05  PV-disp-msg-cnt                 PIC  9(09)   VALUE ZEROS.00922013
009230     05  PV-disp-sulbxf                  PIC  9(18)   VALUE ZEROS.00923013
009240     05  PV-disp-duration                PIC  9(09)   VALUE ZEROS.00924013
009250     05  PV-DISP-PARM-SECONDS            PIC  9(09)   VALUE ZEROS.00925013
009260* dmh - 9-16-11 - end                                             00926013
009270                                                                  00927013
009280     05  PV-DB2-CURRENT-DATE             PIC X(10)    VALUE SPACE.00928013
009290     05  PV-DB2-COUNT                    PIC S9(09)   VALUE +0    00929013
009300                                                      COMP-3.     00930013
009310     05  PV-DB2-PKSLIP-COUNT             PIC S9(09)   VALUE +0    00931013
009320                                                      COMP-3.     00932013
009330     05  PV-DB2-COUNT-PBS                PIC S9(09)   VALUE +0    00933013
009340                                                      COMP-3.     00934013
009350     05  PV-DB2-ALLOC-COUNT              PIC S9(09)   VALUE +0    00935013
009360                                                      COMP-3.     00936013
009370     05  PV-DB2-RTV-COUNT                PIC S9(09)   VALUE +0    00937013
009380                                                      COMP-3.     00938013
009390     05  PV-DB2-LINE-COUNT               PIC S9(09)   VALUE +0    00939013
009400                                                      COMP-3.     00940013
009410     05  PV-128-BARCODE-COUNT            PIC S9(09)   VALUE +0    00941013
009420                                                      COMP-3.     00942013
009430     05  PV-SML-BARCODE-COUNT            PIC S9(09)   VALUE +0    00943013
009440                                                      COMP-3.     00944013
009450     05  PV-SML-BRCDE-COUNTER            PIC S9(09)   VALUE +0    00945013
009460                                                      COMP-3.     00946013
009470     05  PV-PBS-SCN-LOC-ID               PIC   X(4).              00947013
009480     05  PV-UCC128-DAT-USG-CDE           PIC   X(1) VALUE SPACES. 00948013
009490                                                                  00949013
009500     05  PV-DEST-STORE                   PIC S9(04)  VALUE  0     00950013
009510                                                     COMP.        00951013
009520     05  PV-STORE-9-4                    PIC 9(04)    VALUE ZEROS.00952013
009530     05  PV-STORE-X   REDEFINES PV-STORE-9-4.                     00953013
009540         10  PV-STORE-X-4                PIC X(04).               00954013
009550*                                                                 00955013
009560     05  PV-STORE-NBR.                                            00956013
009570         10  PV-STORE-NBR-PFX            PIC 9(01) VALUE ZEROS.   00957013
009580         10  PV-STORE-NBR-4              PIC 9(04) VALUE ZEROS.   00958013
009590                                                                  00959013
009600     05  PV-STORE-NBR-PFX-HOLD           PIC 9(01) VALUE ZEROS.   00960013
009610* label data                                                      00961013
009620     05  PV-PO-RCVR.                                              00962013
009630         10  PV-PO-NUMBER                PIC  9(08)  VALUE ZEROES.00963013
009640         10  FILLER                      PIC  X(01)  VALUE '-'.   00964013
009650         10  PV-PO-RECEIVER              PIC  9(03)  VALUE ZEROES.00965013
009660     05  PV-SHIPT-UNT-ID-NUM             PIC  9(18)  VALUE ZEROES.00966013
009670     05  PV-SHIPT-UNT-ID-NUM-R REDEFINES PV-SHIPT-UNT-ID-NUM.     00967013
009680         10  FILLER                      PIC  9(13).              00968013
009690         10  PV-SHIPT-UNT-14-18          PIC  9(05).              00969013
009700*                                                                 00970013
009710     05  PV-STORE-NUMBER                 PIC  9(04)  VALUE ZEROES.00971013
009720*EXAMPLE:  (055-31)12345678   (USED ON SML LABELS).               00972013
009730     05  PV-SML-SKU-NUMBER.                                       00973013
009740         10  FILLER                      PIC  X(01)  VALUE '('.   00974013
009750         10  PV-SML-DEPT1                PIC  X(03).              00975013
009760         10  FILLER                      PIC  X(01)  VALUE '-'.   00976013
009770         10  PV-SML-CLASS-NBR1           PIC  X(02).              00977013
009780         10  FILLER                      PIC  X(01)  VALUE ')'.   00978013
009790         10  PV-SML-SKU                  PIC  9(08).              00979013
009800                                                                  00980013
009810*                                                                 00981013
009820     05  PV-PO-NBR-K                     PIC  X(09)  VALUE SPACES.00982013
009830     05  PV-PO-NBR-R REDEFINES PV-PO-NBR-K.                       00983013
009840         10  FILLER                      PIC  9(01).              00984013
009850         10  PV-PO-NBR-7POS              PIC  9(08).              00985013
009860*                                                                 00986013
009870     05  PV-LABELS-PRINTED               PIC  9(04)  VALUE ZERO.  00987013
009880     05  PV-LABELS-PRINTED-X REDEFINES PV-LABELS-PRINTED          00988013
009890                                         PIC  X(04).              00989013
009900*                                                                 00990013
009910     05  PV-RCVR-NBR                     PIC  X(09)  VALUE SPACES.00991013
009920     05  PV-RCVR-NBR-R REDEFINES PV-RCVR-NBR.                     00992013
009930         10  FILLER                      PIC  9(06).              00993013
009940         10  PV-RCVR-NBR-3POS            PIC  9(03).              00994013
009950*                                                                 00995013
009960     05  PV-PACKS-IN-CARTON              PIC  9(04)  VALUE ZERO.  00996013
009970     05  PV-PACKS-IN-CARTON-X REDEFINES PV-PACKS-IN-CARTON        00997013
009980                                         PIC  X(04).              00998013
009990*EXAMPLE:  12345678           (USED ON P2L LABELS).               00999013
010000     05  PV-P2L-SKU-NUMBER.                                       01000013
010010         10  FILLER                      PIC  X(02)  VALUE SPACES.01001013
010020         10  PV-P2L-SKU                  PIC  9(08).              01002013
010030                                                                  01003013
010040*EXAMPLE:  313-59             (USED ON P2L LABELS).               01004013
010050     05  PV-P2L-DEPT-CLASS.                                       01005013
010060         10  PV-P2L-DEPT1                PIC  X(03).              01006013
010070         10  FILLER                      PIC  X(01)  VALUE '-'.   01007013
010080         10  PV-P2L-CLASS-NBR1           PIC  X(02).              01008013
010090                                                                  01009013
010100*EXAMPLE:  (055-31)183        (USED ON CS LABELS).                01010013
010110     05  PV-CS-SKU-NUMBER.                                        01011013
010120         10  FILLER                      PIC  X(01)  VALUE '('.   01012013
010130         10  PV-CS-DEPT                  PIC  X(03).              01013013
010140         10  FILLER                      PIC  X(01)  VALUE '-'.   01014013
010150         10  PV-CS-CLASS-NBR             PIC  X(02).              01015013
010160         10  FILLER                      PIC  X(01)  VALUE ')'.   01016013
010170         10  PV-CS-SKU                   PIC  9(08).              01017013
010180                                                                  01018013
010190*EXAMPLE:  05531183           (USED ON CS LABELS).                01019013
010200     05  PV-CS-SKU-NBR.                                           01020013
010210         10  PV-CS-SKU-ONLY              PIC  9(08).              01021013
010220*                                                                 01022013
010230*                                                                 01023013
010240     05  PV-INPK-QTY                     PIC  X(09)  VALUE SPACES.01024013
010250     05  PV-INPK-QTY-R REDEFINES PV-INPK-QTY.                     01025013
010260         10  FILLER                      PIC  9(05).              01026013
010270         10  PV-INPK-UNIT-QTY            PIC  9(04).              01027013
010280*                                                                 01028013
010290     05  PV-OTPK-QTY                     PIC  X(09)  VALUE SPACES.01029013
010300     05  PV-OTPK-QTY-R REDEFINES PV-OTPK-QTY.                     01030013
010310         10  FILLER                      PIC  9(05).              01031013
010320         10  PV-OTPK-UNIT-QTY            PIC  9(04).              01032013
010330*                                                                 01033013
010340     05  PV-PREPK-QTY                    PIC  X(04)  VALUE SPACES.01034013
010350     05  PV-PREPK-QTY-R REDEFINES PV-PREPK-QTY.                   01035013
010360         10  PV-PREPK-UNIT-QTY           PIC  9(04).              01036013
010370*gb 07/31/17                                                      01037062
010380     05  PV-FUNC-TXT                     PIC  X(01) VALUE SPACES. 01038061
010390                                                                  01039063
010400     05  PV-2O-DIGIT-BARCODE.                                     01040013
010410         10  PV-20-SML-CONTAINER-CDE         PIC 9(02).           01041013
010420         10  PV-20-SML-PACKAGING-TYP         PIC 9(01).           01042013
010430         10  PV-20-SML-SOFTWARE-SRC          PIC 9(01).           01043013
010440         10  PV-20-SML-BC-DIVERT             PIC 9(05).           01044013
010450         10  PV-20-SML-BC-DC-ORIGIN          PIC 9(03).           01045013
010460         10  PV-20-SML-BC-MNFST-NBR          PIC 9(08).           01046013
010470                                                                  01047013
010480* 07/19/13 RLK BEG                                                01048013
010490     05  PV-RFID-DIVERT-CDE              PIC X(4).                01049013
010500     05  PV-RFID-DIVERT-CDE-N REDEFINES PV-RFID-DIVERT-CDE        01050013
010510                                         PIC 9(4).                01051013
010520     05  PV-22-DIGIT-BARCODE.                                     01052013
010530         10  PV-22-CRTN-TYPE-IND              PIC 9(01).          01053013
010540         10  PV-22-CRTN-DIVERT-CDE            PIC X(04).          01054013
010550         10  PV-22-CRTN-PO-NBR                PIC 9(08).          01055013
010560         10  PV-22-CTRN-RCVR-SEQ-NBR          PIC 9(02).          01056013
010570         10  PV-22-CRTN-PO-LNE-NBR            PIC 9(03).          01057013
010580         10  PV-22-CRTN-CART-NBR              PIC 9(04).          01058013
010590* 07/19/13 RLK END                                                01059013
010600     05 PV-WORK-DB2-DATE                 PIC X(10)   VALUE SPACES.01060013
010610     05 PV-WORK-DB2-DATE-R    REDEFINES PV-WORK-DB2-DATE.         01061013
010620         10 PV-WORK-CC                   PIC  9(02).              01062013
010630         10 PV-WORK-YY                   PIC  9(02).              01063013
010640         10 FILLER                       PIC  X(01).              01064013
010650         10 PV-WORK-MM                   PIC  9(02).              01065013
010660         10 FILLER                       PIC  X(01).              01066013
010670         10 PV-WORK-DD                   PIC  9(02).              01067013
010680     05 PV-LBL-DATE                      PIC  X(08)  VALUE SPACES.01068013
010690     05 PV-LBL-DATE-R REDEFINES PV-LBL-DATE.                      01069013
010700        10  PV-LBL-DATE-MM               PIC  X(02).              01070013
010710        10  PV-LBL-DASH1                 PIC  X(01).              01071013
010720        10  PV-LBL-DATE-DD               PIC  X(02).              01072013
010730        10  PV-LBL-DASH2                 PIC  X(01).              01073013
010740        10  PV-LBL-DATE-YY               PIC  X(02).              01074013
010750                                                                  01075013
010760     05 PV-CURRENT-TIME-LBL.                                      01076013
010770         10 PV-CURRENT-HOUR-LBL          PIC  9(02)  VALUE ZEROES.01077013
010780         10 FILLER                       PIC  X(01)  VALUE ':'.   01078013
010790         10 PV-CURRENT-MIN-LBL           PIC  9(02)  VALUE ZEROES.01079013
010800                                                                  01080013
010810     05  PV-DSPLY-PRTR                   PIC  X(06)  VALUE SPACES.01081013
010820     05  PV-DSPLY-PRTR-R REDEFINES PV-DSPLY-PRTR.                 01082013
010830         10  PV-DSPLY-DC                 PIC  X(02).              01083013
010840         10  PV-DSPLY-DASH               PIC  X(01).              01084013
010850         10  PV-DSPLY-PRTR-ID            PIC  X(03).              01085013
010860*                                                                 01086013
010870     05  PV-PACK.                                                 01087013
010880         10  PV-PACK-TEXT                PIC  X(05)               01088013
010890                                         VALUE 'PACK-'.           01089013
010900         10  PV-PREPK-ID-LBL             PIC  9(4).               01090013
010910     05  PV-LINE-RATO                    PIC  9(04).              01091013
010920     05  PV-LINE-RATO-R REDEFINES PV-LINE-RATO.                   01092013
010930         10  FILLER                      PIC  X(01).              01093013
010940         10  PV-LINE-RATO-NBR            PIC  X(03).              01094013
010950*                                                                 01095013
010960     05  PV-LINE-NBR                     PIC  X(09)  VALUE SPACES.01096013
010970     05  PV-LINE-NBR-R REDEFINES PV-LINE-NBR.                     01097013
010980         10  FILLER                      PIC  9(06).              01098013
010990         10  PV-PO-LINE-NBR              PIC  9(03).              01099013
011000*                                                                 01100013
011010     05  PV-PRINTER-FORMAT.                                       01101013
011020         10  FILLER                      PIC  X(01)  VALUE '#'.   01102013
011030         10  PV-DC-PRTD-AT               PIC  X(02)  VALUE SPACES.01103013
011040         10  FILLER                      PIC  X(01)  VALUE '-'.   01104013
011050         10  PV-PRTR-ID                  PIC  X(03)  VALUE SPACES.01105013
011060                                                                  01106013
011070*                                                                 01107013
011080     05  PV-PO-ITM-UNITS-BC           PIC X(21) VALUE SPACES.     01108013
011090     05  PV-PO-ITM-UNITS-BC-R REDEFINES PV-PO-ITM-UNITS-BC.       01109013
011100         10  PV-BC-PO-NBR-BC          PIC 9(09).                  01110013
011110         10  PV-BC-ITEM-NBR-BC        PIC 9(08).                  01111013
011120         10  PV-BC-UNITS-BC           PIC 9(04).                  01112013
011130     05  PV-PO-ITM-UNITS-NBR          PIC X(23) VALUE SPACES.     01113013
011140     05  PV-PO-ITM-UNITS-NBR-R REDEFINES PV-PO-ITM-UNITS-NBR.     01114013
011150         10  PV-BC-PO-NBR             PIC 9(09).                  01115013
011160         10  FILLER                   PIC X(01).                  01116013
011170         10  PV-BC-ITEM-NBR           PIC 9(08).                  01117013
011180         10  FILLER                   PIC X(01).                  01118013
011190         10  PV-BC-UNITS              PIC 9(04).                  01119013
011200                                                                  01120013
011210*label data end                                                   01121013
011220     05  PV-RCVR-SEQ-NBR                 PIC S9(09)   VALUE ZEROS 01122013
011230                                                      COMP.       01123013
011240     05  PV-CRTN-TRIP-ID                 PIC  S9(9)   VALUE ZEROS 01124013
011250                                                      COMP.       01125013
011260     05  PV-MAX-USER-BATCH               PIC S9(04)   VALUE ZEROS 01126013
011270                                                      COMP.       01127013
011280     05  PV-VEND-STYL-NAME               PIC  X(20) VALUE SPACES. 01128013
011290     05  PV-DEPT-NUMBER                  PIC  X(03) VALUE SPACES. 01129013
011300     05  PV-CL-NBR                       PIC  X(02) VALUE SPACES. 01130013
011310     05 PV-DC-5-CHAR-ABBR               PIC X(05) VALUE SPACES.   01131013
011320     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          01132013
011330         15 FILLER                      PIC  X(03).               01133013
011340         15 PV-2-DIGIT-DC-ABBR          PIC  X(02).               01134013
011350     05  PV-SKU.                                                  01135013
011360         10  PV-DEPT-NBR                 PIC  X(03) VALUE SPACES. 01136013
011370         10  PV-SKU-DASH-1               PIC  X(01) VALUE SPACE.  01137013
011380         10  PV-CLASS-NBR                PIC  X(02) VALUE SPACES. 01138013
011390         10  PV-SKU-DASH-2               PIC  X(01) VALUE SPACE.  01139013
011400         10  PV-SKU-NBR                  PIC  X(03) VALUE SPACES. 01140013
011410     05  PV-SKU-OUT                      PIC  X(08).              01141013
011420     05  PV-SKU-OUT-9 REDEFINES PV-SKU-OUT                        01142013
011430                                         PIC  9(08).              01143013
011440     05  PV-SKU-LBL.                                              01144013
011450         10  FILLER                      PIC  X(01) VALUE '('.    01145013
011460         10  PV-DEPT-NUMBER-LBL          PIC  X(03) VALUE SPACES. 01146013
011470         10  FILLER                      PIC  X(01) VALUE '-'.    01147013
011480         10  PV-CL-NBR-LBL               PIC  X(02) VALUE SPACES. 01148013
011490         10  FILLER                      PIC  X(01) VALUE ')'.    01149013
011500         10  PV-SKU-NBR-LBL              PIC  9(08) VALUE ZERO.   01150013
011510     05  PV-CARTON-CNT                   PIC 9(04)    VALUE ZEROS.01151013
011520     05  PV-CARTON-CNT-X REDEFINES PV-CARTON-CNT.                 01152013
011530         10  PV-CARTON-CNT-LBL           PIC X(04).               01153013
011540*                                                                 01154013
011550     05  PV-MULTIPLE                     PIC  9(04)  VALUE ZEROS. 01155013
011560     05  PV-HOLD-MULTIPLE                PIC  9(04)  VALUE ZEROS. 01156013
011570     05  PV-REMAINDER                    PIC  9(04)  VALUE ZEROS. 01157013
011580*                                                                 01158013
011590     05  PV-INNR-PACK-QTY                PIC  S9(5) VALUE ZEROES  01159013
011600                                                    COMP.         01160013
011610     05  PV-OUTR-PACK-QTY                PIC  S9(5) VALUE ZEROES  01161013
011620                                                    COMP.         01162013
011630     05  PV-SHIPPED-QTY                  PIC  S9(9) VALUE ZEROES  01163013
011640                                                    COMP.         01164013
011650     05  PV-SHPD-QTY-TOTAL               PIC  S9(9) VALUE ZEROES  01165013
011660                                                    COMP.         01166013
011670     05  PV-WRKR-USR-ID                  PIC  X(08) VALUE ZEROES. 01167013
011680     05  PV-SESSION-ID                   PIC  X(08) VALUE ZEROES. 01168013
011690     05  PV-PREPK-ID                     PIC  S9(4) COMP.         01169013
011700     05  PV-PREPK-RATO-QTY               PIC  S9(4) COMP.         01170013
011710     05  PV-PREPK-UNT-QTY                PIC  S9(4) COMP.         01171013
011720     05  PV-CSE-PK-QTY                   PIC  S9(4) COMP.         01172013
011730     05  PV-ODD-CART-IND                 PIC   X(1).              01173013
011740     05  PV-SEASET-NM                    PIC   X(25).             01174013
011750     05  PV-PRNT-CART-SEQ-ID             PIC   S9(4) COMP.        01175013
011760*                                                                 01176013
011770     05  PV-WHSE-CART-EXIST              PIC  X(01).              01177013
011780     05  PV-UNION-TYPE                   PIC  X(01).              01178013
011790     05  PV-PREV-FETCH                   PIC  X(01).              01179013
011800     05  PV-PREV-LINE                    PIC  S9(9) COMP.         01180013
011810                                                                  01181013
011820     05  PV-FUNC-QTY                     PIC  9(09)  VALUE ZEROES.01182013
011830     05  PV-FUNC-QTY-R REDEFINES PV-FUNC-QTY.                     01183013
011840         10  FILLER                      PIC  9(08).              01184013
011850         10  PV-FUNC-QTYx                PIC  X(01).              01185013
011860                                                                  01186013
011870     05  PV-BAR-CODE                     PIC  X(22) VALUE ZEROES. 01187013
011880     05  PV-BAR-CODE-N  REDEFINES  PV-BAR-CODE.                   01188013
011890         10 FILLER                       PIC  9(02).              01189013
011900         10 PV-BAR-CODE-OTBND            PIC  9(18).              01190013
011910         10 FILLER                       PIC  9(02).              01191013
011920     05  PV-BAR-CODE-R  REDEFINES  PV-BAR-CODE.                   01192013
011930         10 PV-BAR-CODE-DIVERT-PFX       PIC  9(01).              01193013
011940         10 PV-BAR-CODE-STORE-NBR        PIC  9(04).              01194013
011950         10 PV-BAR-CODE-OPER-UNIT        PIC  9(04).              01195013
011960         10 PV-BAR-CODE-POS-10-15        PIC  9(06).              01196013
011970         10 PV-BAR-CODE-LBL-MANIFEST     PIC  9(07).              01197013
011980     05  PV-DISPLAY-PO                   PIC  9(09) VALUE ZEROES. 01198013
011990     05  PV-DISPLAY-STORE                PIC  9(04) VALUE ZEROES. 01199013
012000     05  PV-DISPLAY-DEPT                 PIC  9(04) VALUE ZEROES. 01200013
012010     05  PV-DISPLAY-ITM-NBR              PIC  9(15) VALUE ZEROES. 01201013
012020     05  PV-DISPLAY-ERROR-NBR            PIC  9(02) VALUE ZEROES. 01202013
012030     05  PV-DISPLAY-PACK-SKU             PIC  9(02) VALUE ZEROES. 01203013
012040     05  PV-DISPLAY-RET-CODE             PIC  9(02) VALUE ZEROES. 01204013
012050     05  PV-DISPLAY-SQLCODE              PIC S9(04) VALUE ZEROES. 01205013
012060     05  PV-DISPL-ASGMT-SEQ-NBR          PIC S9(09).              01206013
012070                                                                  01207013
012080     05  PV-DISP-SQLCODE                 PIC  -999  VALUE ZEROES. 01208013
012090     05  PV-DISP-SQL1                    PIC  -999  VALUE ZEROES. 01209013
012100     05  PV-DISP-SQL2                    PIC  -999  VALUE ZEROES. 01210013
012110     05  PV-DISP-SQL3                    PIC  -999  VALUE ZEROES. 01211013
012120     05  PV-DISP-SQL4                    PIC  -999  VALUE ZEROES. 01212013
012130     05  PV-DISP-SQL5                    PIC  -999  VALUE ZEROES. 01213013
012140     05  PV-DISP-SML                     PIC  9(18) VALUE ZEROES. 01214013
012150     05  PV-DISP-PARENT                  PIC  9(18) VALUE ZEROES. 01215013
012160     05  PV-DISP-SSCC                    PIC  9(18) VALUE ZEROES. 01216013
012170     05  PV-DISP-orig-sscc               PIC  9(18) VALUE ZEROES. 01217013
012180     05  PV-DISP-next-sscc               PIC  9(18) VALUE ZEROES. 01218013
012190     05  PV-DISP-ORIG                    PIC  9(18) VALUE ZEROES. 01219013
012200     05  PV-DISP-PO                      PIC  9(09) VALUE ZEROES. 01220013
012210     05  PV-DISP-RCVR                    PIC  9(04) VALUE ZEROES. 01221013
012220     05  PV-DISP-LINE                    PIC  9(04) VALUE ZEROES. 01222013
012230     05  PV-DISP-PREPK                   PIC  9(04) VALUE ZEROES. 01223013
012240     05  PV-DISP-RATIO                   PIC  9(04) VALUE ZEROES. 01224013
012250     05  PV-DISP-DRVR                    PIC  9(04) VALUE ZEROES. 01225013
012260     05  PV-DISP-dc                      PIC  9(04) VALUE ZEROES. 01226013
012270     05  PV-DISP-OPER                    PIC  9(04) VALUE ZEROES. 01227013
012280     05  PV-DISP-DEST-OPER               PIC  9(04) VALUE ZEROES. 01228013
012290     05  PV-DISP-orig-OPER               PIC  9(04) VALUE ZEROES. 01229013
012300     05  PV-DISP-curr-OPER               PIC  9(04) VALUE ZEROES. 01230013
012310     05  PV-DISP-fclty                   PIC  9(04) VALUE ZEROES. 01231013
012320     05  PV-DISP-orig-fclty              PIC  9(04) VALUE ZEROES. 01232013
012330     05  PV-DISP-dest-fclty              PIC  9(04) VALUE ZEROES. 01233013
012340     05  PV-DISP-dept                    PIC  9(04) VALUE ZEROES. 01234013
012350     05  PV-DISP-str                     PIC  9(04) VALUE ZEROES. 01235013
012360     05  PV-DISP-bus-area                PIC  9(02) VALUE ZEROES. 01236013
012370     05  PV-DISP-SKU                     PIC  9(09) VALUE ZEROES. 01237013
012380     05  PV-DISP-SKU2                    PIC  9(09) VALUE ZEROES. 01238013
012390     05  PV-DISP-PK-SKU                  PIC  9(09) VALUE ZEROES. 01239013
012400     05  PV-DISP-PKSL                    PIC  9(04) VALUE ZEROES. 01240013
012410     05  PV-DISP-RVSN                    PIC  9(04) VALUE ZEROES. 01241013
012420     05  PV-DISP-STKR-NBR                PIC  9(04) VALUE ZEROES. 01242013
012430     05  PV-DISP-ENT-ID                  PIC  9(09) VALUE ZEROES. 01243013
012440     05  PV-DISP-QTY                     PIC  9(09) VALUE ZEROES. 01244013
012450     05  PV-DISP-OH-QTY                  PIC  9(09) VALUE ZEROES. 01245013
012460     05  PV-DISP-PK-QTY                  PIC  9(09) VALUE ZEROES. 01246013
012470     05  PV-DISP-SIZE                    PIC  9(09) VALUE ZEROES. 01247013
012480     05  PV-DISP-StyL                    PIC  9(09) VALUE ZEROES. 01248013
012490     05  PV-DISP-UPCID                   PIC  9(09) VALUE ZEROES. 01249013
012500     05  PV-DISP-ITM                     PIC  9(15) VALUE ZEROES. 01250013
012510     05  PV-DISP-UPC                     PIC  9(15) VALUE ZEROES. 01251013
012520     05  PV-DISP-LBL-TOT                 PIC  9(04) VALUE ZEROES. 01252013
012530     05  PV-DISP-LBL-SEQ                 PIC  9(04) VALUE ZEROES. 01253013
012540     05  PV-DISP-PREPK-UNT               PIC  9(09) VALUE ZEROES. 01254013
012550     05  PV-DISP-CASE-UNT                PIC  9(09) VALUE ZEROES. 01255013
012560     05  PV-DISP-inPK                    PIC  9(09) VALUE ZEROES. 01256013
012570     05  PV-DISP-OTPK                    PIC  9(09) VALUE ZEROES. 01257013
012580     05  PV-DISP-AUDIT                   PIC  9(09) VALUE ZEROES. 01258013
012590     05  PV-DISP-PNA-STA                 PIC  9(03) VALUE ZEROES. 01259013
012600     05  PV-DISP-trip                    PIC  9(09) VALUE ZEROES. 01260013
012610     05  PV-DISP-batch                   PIC  9(09) VALUE ZEROES. 01261013
012620     05  PV-DISP-trbl                    PIC  9(04) VALUE ZEROES. 01262013
012630     05  PV-DISP-maj-cl                  PIC  9(04) VALUE ZEROES. 01263013
012640     05  PV-DISP-sub-cl                  PIC  9(04) VALUE ZEROES. 01264013
012650     05  pv-disp-prpt-amt                PIC  9(04) VALUE ZEROES. 01265013
012660     05  PV-DISP-HNG-FLD                 PIC  9(04) VALUE ZEROES. 01266013
012670     05  PV-DISP-ir                      PIC  9(04) VALUE ZEROES. 01267013
012680     05  PV-DISP-MQ-COND                 PIC -9(09) VALUE ZEROES. 01268013
012690     05  PV-DISP-MQ-reas                 PIC -9(09) VALUE ZEROES. 01269013
012700                                                                  01270013
012710     05  PV-INIT-TIMESTAMP               PIC  X(26) VALUE SPACES. 01271013
012720     05  PV-INIT-TIMESTAMP-R REDEFINES PV-INIT-TIMESTAMP.         01272013
012730         10  FILLER                      PIC  X(11).              01273013
012740         10  PV-INIT-HH                  PIC  9(02).              01274013
012750         10  FILLER                      PIC  X(01).              01275013
012760         10  PV-INIT-MM                  PIC  9(02).              01276013
012770         10  FILLER                      PIC  X(01).              01277013
012780         10  PV-INIT-SS                  PIC  9(02).              01278013
012790         10  FILLER                      PIC  X(07).              01279013
012800     05  PV-INIT-TIME-KEY.                                        01280013
012810         10  PV-INIT-KEY-HH              PIC  9(02).              01281013
012820         10  PV-INIT-KEY-MM              PIC  9(02).              01282013
012830         10  PV-INIT-KEY-SS              PIC  9(02).              01283013
012840     05  PV-CURR-TIMESTAMP               PIC  X(26) VALUE SPACES. 01284013
012850     05  PV-CURR-PARA                    PIC  9(04) VALUE ZEROES. 01285013
012860     05  PV-DURATION-SEC                 PIC S9(09) COMP VALUE 0. 01286013
012870     05  PV-DURATION-nano-sec            PIC S9(10) COMP VALUE 0. 01287013
012880     05  PV-work-nano-sec                PIC  9(10) value zeroes. 01288013
012890     05  PV-work-nano-sec-redef redefines pv-work-nano-sec.       01289013
012900         10  PV-work-nano-min-1-2        pic 9(02).               01290013
012910         10  PV-work-nano-sec-3-4        pic 9(02).               01291013
012920         10  PV-work-nano-micro-5-10     pic 9(06).               01292013
012930     05  PV-disp-nano-sec                PIC  x(12).              01293013
012940     05  PV-disp-nano-sec-redef redefines pv-disp-nano-sec.       01294013
012950         10  PV-disp-nano-min-1-2        pic 9(02).               01295013
012960         10  pv-disp-nano-dash-1         pic x(01).               01296013
012970         10  PV-disp-nano-sec-3-4        pic 9(02).               01297013
012980         10  pv-disp-nano-dash-2         pic x(01).               01298013
012990         10  PV-disp-nano-micro-5-10     pic 9(06).               01299013
013000     05  PV-PARM-SECONDS                 PIC S9(09) COMP VALUE 0. 01300013
013010     05  PV-TKRPRPM-TEXT                 PIC  X(25) VALUE SPACES. 01301013
013020     05  PV-TKRPRPM-TEXT-Redef1 redefines PV-TKRPRPM-TEXT.        01302013
013030         10  PV-TKRPRPM-TEXT-Y-N         PIC  X(01).              01303013
013040         10  FILLER                      PIC  X(01).              01304013
013050         10  PV-TKRPRPM-TEXT-ALL         PIC  X(03).              01305013
013060         10  FILLER                      PIC  X(20).              01306013
013070     05  PV-TKRPRPM-TEXT-REDEF2 redefines PV-TKRPRPM-TEXT.        01307013
013080         10  FILLER                      PIC  X(02).              01308013
013090         10  PV-TKRPRPM-TEXT-PNA-STA     PIC  9(03).              01309013
013100         10  FILLER                      PIC  X(20).              01310013
013110                                                                  01311013
013120     05  PV-SQLCODE                      PIC S9(09) VALUE ZEROES. 01312013
013130     05  PV-PRINTER-ID.                                           01313013
013140         10  PV-PRINTER-ID-1-3           PIC  X(03) VALUE ZEROES. 01314013
013150         10  PV-PRINTER-ID-4-8           PIC  X(03) VALUE ZEROES. 01315013
013160     05  PV-LBL-MANIFEST-NBR             PIC  9(09) VALUE ZEROES. 01316013
013170     05  PV-LBL-MANIFEST-INCREMENT       PIC S9(09) VALUE +1      01317013
013180                                                     COMP.        01318013
013190     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01319013
013200                                                    COMP SYNC.    01320013
013210     05  PV-DEPT-DESC                   PIC   X(25) VALUE SPACES. 01321013
013220     05  PV-MAJ-CL-DESC                 PIC   X(25) VALUE SPACES. 01322013
013230     05  PV-TRN-LNE-NBR                 PIC  S9(9) COMP.          01323013
013240     05  PV-HOLD-TRN-LNE-NBR            PIC  S9(9) COMP.          01324013
013250     05  PV-OPER-UNT-ID                 PIC  S9(04)  COMP.        01325013
013260     05  PV-CURR-OPER-UNT-ID            PIC  S9(04)  COMP.        01326013
013270     05  PV-REPURP-COUNT                PIC S9(09)  VALUE +0      01327013
013280                                                     COMP-3.      01328013
013290     05  PV-FIXTURE-ID                  PIC  X(10) VALUE SPACES.  01329013
013300                                                                  01330013
013310     05  PV-PCKCS721                  PIC X(08)  VALUE 'PCKCS721'.01331013
013320     05  PV-SUKCS583                  PIC X(08)  VALUE 'SUKCS583'.01332013
013330* CLP 10/29/13 BEGIN PR#5148D                                     01333013
013340     05  PV-SUKCS720                  PIC X(08)  VALUE 'SUKCS720'.01334013
013350* CLP 10/29/13   END PR#5148D                                     01335013
013360     05  PV-DONE-PROCESSING-SW        PIC X(01)  VALUE 'N'.       01336013
013370         88  PV-DONE-PROCESSING                  VALUE 'Y'.       01337013
013380     05  PV-DUPLICATE-IND            PIC  X(01)  VALUE SPACE.     01338013
013390     05  PV-LABEL-IND                PIC  X(01)  VALUE SPACE.     01339013
013400     05  PV-oper                     PIC  9(04)  VALUE zero.      01340013
013410     05  PV-line-no                  PIC  9(09)  VALUE zero.      01341013
013420     05  PV-PRC-MSG-CDE              PIC  X(02)  VALUE SPACES.    01342061
013430                                                                  01343013
013440     05  PV-FIRST-STORE-RCPT.                                     01344013
013450         10 PV-FIRST-STORE-RCPT-TXT-1 PIC X(12) VALUE             01345013
013460                                       '@@@@NEW@@@@@'.            01346013
013470         10 PV-FIRST-STORE-RCPT-TXT-2 PIC X(12) VALUE             01347013
013480                                       '@@@@@TO@@@@@'.            01348013
013490         10 PV-FIRST-STORE-RCPT-TXT-3 PIC X(12) VALUE             01349013
013500                                       '@@@STORE@@@@'.            01350013
013501                                                                  01350168
013502     05  PV-CURRENT-TMST              PIC  X(26) VALUE SPACES.    01350268
013503     05  PV-CURRENT-TMST-R.                                       01350368
013504         10 FILLER                    PIC  X(22) VALUE SPACES.    01350468
013505         10 PV-CURRENT-TMST-R-LAST-4  PIC  9(04) VALUE ZEROS.     01350568
013510                                                                  01351013
013520 01  PV-COUNTERS.                                                 01352013
013530     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.01353013
013540     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      01354013
013550                                                 COMP.            01355013
013560     05  PV-DPKUT038-CICS-RESP        PIC S9(04) VALUE +0         01356013
013570                                                 COMP SYNC.       01357013
013580     05  PV-DPKUT038-DATE             PIC X(06)  VALUE SPACES.    01358013
013590     05  PV-DPKUT038-DATE-R REDEFINES PV-DPKUT038-DATE.           01359013
013600         10 PV-DPKUT038-YY               PIC  X(02).              01360013
013610         10 PV-DPKUT038-MM               PIC  X(02).              01361013
013620         10 PV-DPKUT038-DD               PIC  X(02).              01362013
013630     05  PV-DPKUT038-MJR-CL.                                      01363013
013640         10 FILLER                       PIC  X(01) VALUE SPACE.  01364013
013650         10 PV-DPKUT038-MJR-CL-2         PIC  X(01) VALUE SPACE.  01365013
013660*                                                                 01366013
013670     05  PV-CURRENT-DATE                 PIC X(10)  VALUE SPACES. 01367013
013680     05  PV-CURRENT-DATE-R REDEFINES     PV-CURRENT-DATE.         01368013
013690         10 PV-CURRENT-CC                PIC  9(02).              01369013
013700         10 PV-CURRENT-YY                PIC  9(02).              01370013
013710         10 FILLER                       PIC  X(01).              01371013
013720         10 PV-CURRENT-MM                PIC  9(02).              01372013
013730         10 FILLER                       PIC  X(01).              01373013
013740         10 PV-CURRENT-DD                PIC  9(02).              01374013
013750     05  PV-CURRENT-TIME                 PIC X(08)  VALUE SPACES. 01375013
013760     05  PV-CURRENT-TIME-R REDEFINES     PV-CURRENT-TIME.         01376013
013770         10 PV-CURRENT-HR                PIC  9(02).              01377013
013780         10 FILLER                       PIC  X(01).              01378013
013790         10 PV-CURRENT-MN                PIC  9(02).              01379013
013800         10 FILLER                       PIC  X(03).              01380013
013810*                                                                 01381013
013820     05  PV-BEGIN-TIME                   PIC X(26)  VALUE SPACES. 01382013
013830     05  PV-END-TIME                     PIC X(26)  VALUE SPACES. 01383013
013840*                                                                 01384013
013850     05  PV-TSHUNLO-CRE-TMST             PIC X(26)  VALUE SPACES. 01385013
013860     05  PV-TSHUNLO-TMST-EAI             PIC X(26)  VALUE SPACES. 01386013
013870     05  PV-TSHUNLO-PBS-CRE-TMST         PIC X(26)  VALUE SPACES. 01387013
013880     05  PV-TSHUNLO-PBS-TMST-R.                                   01388013
013890         10 PV-PBS-YYYY-MM-DD            PIC  X(10).              01389013
013900         10 PV-PBS-TMST-SPACE            PIC  X(01)  VALUE SPACES.01390013
013910         10 PV-PBS-HH                    PIC  X(02).              01391013
013920         10 PV-PBS-TMST-COLON            PIC  X(01)  VALUE ':'.   01392013
013930         10 PV-PBS-MM                    PIC  X(02).              01393013
013940         10 PV-PBS-TMST-SPACE-2          PIC  X(10)  VALUE SPACES.01394013
013950     05  PV-DATE-CCYY-MM-DD              PIC  X(10)  VALUE SPACES.01395013
013960     05  PV-DATE-CCYY-MM-DD-R REDEFINES PV-DATE-CCYY-MM-DD.       01396013
013970         10  PV-DATE-CCYY.                                        01397013
013980             15  PV-DATE-CC              PIC  X(02).              01398013
013990             15  PV-DATE-YY              PIC  X(02).              01399013
014000         10  FILLER                      PIC  X(01).              01400013
014010         10  PV-DATE-MM                  PIC  X(02).              01401013
014020         10  FILLER                      PIC  X(01).              01402013
014030         10  PV-DATE-DD                  PIC  X(02).              01403013
014040     05  PV-ARVD-DATE                    PIC  X(08)  VALUE SPACES.01404013
014050     05  PV-ARVD-DATE-R REDEFINES PV-ARVD-DATE.                   01405013
014060         10  PV-ARVD-DATE-MM             PIC  X(02).              01406013
014070         10  PV-ARVD-DASH1               PIC  X(01).              01407013
014080         10  PV-ARVD-DATE-DD             PIC  X(02).              01408013
014090         10  PV-ARVD-DASH2               PIC  X(01).              01409013
014100         10  PV-ARVD-DATE-YY             PIC  X(02).              01410013
014110*                                                                 01411013
014120*----------------------------------------------------------------*01412013
014130*                                                                *01413013
014140*----------------------------------------------------------------*01414013
014150     05  PV-PROGRAM-DATA.                                         01415013
014160         10  PV-PO-NBR                   PIC S9(09)  VALUE  0     01416013
014170                                                     COMP.        01417013
014180         10  PV-ORGN-OPER-UNT-ID         PIC  S9(4) COMP.         01418013
014190         10  PV-BATCH-NUMBER             PIC  S9(4) COMP VALUE 0. 01419013
014200         10  PV-BATCH-NO-USE             PIC  S9(4) COMP VALUE 0. 01420013
014210*                                                                 01421013
014220                                                                  01422013
014230         10  PV-PO-LINE-N                  PIC 9(09).             01423013
014240         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 01424013
014250             15 FILLER                     PIC X(05).             01425013
014260             15 PV-PO-LINE-OUT             PIC X(04).             01426013
014270                                                                  01427013
014280         10  PV-DRIVER-LINE-NO             PIC 9(09).             01428013
014290                                                                  01429013
014300         10  PV-PO-LINE-LBL.                                      01430013
014310             15  PV-LINE-LBL-1           PIC 9(01).               01431013
014320             15  PV-LINE-LBL-3           PIC 9(03).               01432013
014330                                                                  01433013
014340         10  PV-STORE                    PIC  X(04)  VALUE SPACE. 01434013
014350         10  PV-STORE-N REDEFINES PV-STORE PIC ZZZ9.              01435013
014360                                                                  01436013
014370         10  PV-CTN.                                              01437013
014380             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              01438013
014390             15  PV-CTN-LAST-17          PIC  X(17).              01439013
014400             15  PV-CTN-FILLER           PIC  X(02).              01440013
014410         10  FILLER REDEFINES PV-CTN.                             01441013
014420             15  PV-CTN-SCAN-00          PIC  X(02).              01442013
014430             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              01443013
014440             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              01444013
014450         10  FILLER REDEFINES PV-CTN.                             01445013
014460             15  PV-CTN-SCAN-00          PIC  X(02).              01446013
014470             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              01447013
014480                                                                  01448013
014490         10  PV-BUS-AREA-ID              PIC  S9(2)V VALUE ZEROES 01449013
014500                                                     COMP-3.      01450013
014510*                                                                 01451013
014520         10  PV-HNG-FOLD-SEQ-NBR         PIC  S9(4) COMP.         01452013
014530         10  PV-PREV-HANG-FOLD-IND       PIC  X(01) VALUE SPACE.  01453013
014540         10  PV-HANG-FOLD-IND            PIC  X(01) VALUE SPACE.  01454013
014550*                                                                 01455013
014560         10  PV-TROUBLE-COUNT            PIC S9(09)  COMP.        01456013
014570         10  PV-TROUBLE-COUNT-REPUR      PIC S9(09)  COMP.        01457013
014580         10  PV-TROUBLE-CNT-REPUR-INNR   PIC S9(09)  COMP.        01458013
014590         10  PV-SHPD-PK-QTY              PIC S9(09)  COMP.        01459013
014600*                                                                 01460013
014610         10  PV-OTBND-CRTN               PIC  X(22) VALUE SPACES. 01461013
014620         10  PV-OTBND-CRTN-R   REDEFINES PV-OTBND-CRTN.           01462013
014630             15  PV-OTBND-SML                PIC  9(20).          01463013
014640             15  FILLER                      PIC  9(02).          01464013
014650*                                                                 01465013
014660*** dmh added 11/14/11                                            01466013
014670         10  PV-TRIP-ID-10-NUM           PIC  9(10) VALUE ZEROES. 01467013
014680* 09/23/13 SB BEG                                                 01468013
014690     05  PV-20-DIGIT-BARCODE             PIC X(18) VALUE ZEROES.  01469013
014700     05  PV-20-DIGIT-BARCODE-R REDEFINES PV-20-DIGIT-BARCODE.     01470013
014710*        10  PV-20-SML-CONTAINER-CDE-R     PIC 9(02).             01471013
014720         10  PV-20-SML-PACKAGING-TYP-R     PIC 9(01).             01472013
014730             88  PV-20-SML-INTERNAL-LBL            VALUE 4.       01473013
014740         10  PV-20-SML-SOFTWARE-SRC-R      PIC 9(01).             01474013
014750             88  PV-20-SML-FROM-KOHLS              VALUE 1.       01475013
014760             88  PV-20-SML-FROM-REPLEN             VALUE 2.       01476013
014770         10  PV-20-SML-BC-DIVERT-R.                               01477013
014780             15  PV-20-SML-BC-DIVERT-PFX-R PIC 9(01).             01478013
014790             15  PV-20-SML-BC-DIVERT-CDE-R PIC 9(04).             01479013
014800         10  PV-20-SML-BC-DC-ORIGIN-R      PIC 9(03).             01480013
014810         10  PV-20-SML-BC-MNFST-NBR-R      PIC 9(08).             01481013
014820     05  PV-RFID-REPLEN-CHK-SW             PIC X(01) VALUE SPACE. 01482013
014830         88  PV-RFID-REPLEN-YES                    VALUE 'Y'.     01483013
014840         88  PV-RFID-REPLEN-NO                     VALUE 'N'.     01484013
014850* 09/23/13 SB END                                                 01485013
014851*                                                                 01485174
014860                                                                  01486013
014870*----------------------------------------------------------------*01487013
014880* PARAGRAPH TRACKING TABLE - USED FOR DEBUGGING                  *01488013
014890* WILL TRACK PARAGRAPHS IN THIS TABLE - IF WE SEE TRANSACTION    *01489013
014900* IF TAKING LONGER THEN X SECONDS TO RESPOND, WILL DUMP THE      *01490013
014910* TABLE TO CSSL                                                  *01491013
014920* PARM PATIME                                                    *01492013
014930*----------------------------------------------------------------*01493013
014940 01  PT-PARA-TRACKING-TABLE.                                      01494013
014950     05  PT-ENTRIES               OCCURS 1500 TIMES               01495013
014960                                  INDEXED BY PT-TRACK-IDX.        01496013
014970         10 FILLER                PIC  X(01) VALUE SPACE.         01497013
014980         10 PT-PROGRAM            PIC  X(08) VALUE 'SUKCS782'.    01498099
014990         10 FILLER                PIC  X(01) VALUE SPACE.         01499013
015000         10 pt-dc                 PIC  9(04) VALUE zeroes.        01500013
015010         10 filler                PIC  X(01) VALUE '-'.           01501013
015020         10 pt-pna-sta            PIC  9(03) VALUE zeroes.        01502013
015030         10 filler                PIC  X(01) VALUE '-'.           01503013
015040         10 pt-start-hhmmss       PIC  9(06) VALUE zeroes.        01504013
015050         10 FILLER                PIC  X(01) VALUE SPACE.         01505013
015060         10 PT-INDEX-NBR          PIC  9(05) VALUE ZEROES.        01506013
015070         10 FILLER                PIC  X(01) VALUE SPACE.         01507013
015080         10 PT-paragraph          PIC  X(04) VALUE SPACE.         01508013
015090         10 FILLER                PIC  X(01) VALUE SPACE.         01509013
015100         10 PT-TIMESTAMP          PIC  X(26) VALUE SPACE.         01510013
015110         10 FILLER                PIC  X(01) VALUE SPACE.         01511013
015120         10 PT-DURATION           PIC  9(09) VALUE ZEROES.        01512013
015130         10 FILLER                PIC  X(01) VALUE SPACE.         01513013
015140         10 PT-nano-sec           PIC  x(12) VALUE ZEROES.        01514013
015150     05  PT-MAX-PARA-ENTRIES      PIC  9(04) VALUE 1500.          01515013
015160     05  PT-CURR-ENTRIES          PIC  9(04) VALUE ZEROES.        01516013
015170     05  PT-CURR-PARA             PIC  X(04) VALUE SPACES.        01517013
015180                                                                  01518013
015190                                                                  01519013
015200*----------------------------------------------------------------*01520013
015210*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01521013
015220*----------------------------------------------------------------*01522013
015230     COPY DPWS015.                                                01523013
015240                                                                  01524013
015250/                                                                 01525013
015260*----------------------------------------------------------------*01526013
015270*  COPYBOOK FOR CALLED MODULE TO RETURN BUSINESS AREA ID          01527013
015280*  VSM INTERFACE                                                  01528013
015290*----------------------------------------------------------------*01529013
015300     COPY XLWS073.                                                01530013
015310/                                                                 01531013
015320*----------------------------------------------------------------*01532013
015330*  COPYBOOK FOR CALLED MODULE TO RETURN SEASONAL SET AND FIXTURE  01533013
015340*  DATA                                                           01534013
015350*----------------------------------------------------------------*01535013
015360     COPY PCWS240.                                                01536013
015370/                                                                 01537013
015380*---------------------------------------------------------------* 01538013
015390* COPYBOOK TO DETERMINE CURRENT STORE ON HAND (XLKUT088)        * 01539013
015400*---------------------------------------------------------------* 01540013
015410     COPY XLWS088.                                                01541013
015420                                                                  01542013
015430*----------------------------------------------------------------*01543013
015440*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01544013
015450*----------------------------------------------------------------*01545013
015460     COPY DFHAID.                                                 01546013
015470                                                                  01547013
015480*----------------------------------------------------------------*01548013
015490*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *01549013
015500*----------------------------------------------------------------*01550013
015510     COPY DPWS003.                                                01551013
015520                                                                  01552013
015530     COPY SUWS054.                                                01553013
015540                                                                  01554013
015550*----------------------------------------------------------------*01555013
015560*CT 11/04/08 BEGIN                                               *01556013
015570*    COPYBOOK USED BY TO SEND DIRECTIVE TO SUKUT129              *01557013
015580*----------------------------------------------------------------*01558013
015590                                                                  01559013
015600     COPY SUWS090.                                                01560013
015610                                                                  01561013
015620*CT 11/04/08 end                                                 *01562013
015630                                                                  01563013
015640*----------------------------------------------------------------*01564013
015650*  COMMAREA LAYOUT FOR THE AUDIT CHECK MODULE (SUKCS583)         *01565013
015660*----------------------------------------------------------------*01566013
015670     COPY SURD021.                                                01567013
015680                                                                  01568013
015690*----------------------------------------------------------------*01569013
015700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01570013
015710*----------------------------------------------------------------*01571013
015720     COPY DPWS013.                                                01572013
015730                                                                  01573013
015740*----------------------------------------------------------------*01574013
015750*    STORE MANIFEST LAYOUT.                                       01575013
015760*----------------------------------------------------------------*01576013
015770     COPY PCWS187.                                                01577013
015780                                                                  01578013
015790* EA 07/08/2010                                                  *01579013
015800*----------------------------------------------------------------*01580013
015810*    COPYBOOK FOR UNIT WORK MODULE - PCKUT790                    *01581013
015820*----------------------------------------------------------------*01582013
015830                                                                  01583013
015840     COPY PCWS260.                                                01584013
015850                                                                  01585013
015860* EA 07/08/2010                                                  *01586013
015870*----------------------------------------------------------------*01587013
015880*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      01588013
015890*  TABLE                                                          01589013
015900*----------------------------------------------------------------*01590013
015910     EXEC SQL                                                     01591013
015920         INCLUDE TSHPUNT                                          01592013
015930     END-EXEC.                                                    01593013
015940                                                                  01594013
015950*----------------------------------------------------------------*01595013
015960*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  01596013
015970*  TABLE                                                          01597013
015980*----------------------------------------------------------------*01598013
015990     EXEC SQL                                                     01599013
016000         INCLUDE TSHUUPC                                          01600013
016010     END-EXEC.                                                    01601013
016020                                                                  01602013
016030*----------------------------------------------------------------*01603013
016040*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT UNIT      01604013
016050*  LOCATION TABLE                                                 01605013
016060*----------------------------------------------------------------*01606013
016070     EXEC SQL                                                     01607013
016080         INCLUDE TSHUNLO                                          01608013
016090     END-EXEC.                                                    01609013
016100                                                                  01610013
016110*----------------------------------------------------------------*01611013
016120*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI PACKSLI01612013
016130*  VENDOR SHIPMENT UNIT ASSOCIATION TABLE                         01613013
016140*----------------------------------------------------------------*01614013
016150     EXEC SQL                                                     01615013
016160         INCLUDE TINPKSU                                          01616013
016170     END-EXEC.                                                    01617013
016180                                                                  01618013
016190*----------------------------------------------------------------*01619013
016200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       01620013
016210*  LOCATION MASTER TABLE (XLT_LOC)                                01621013
016220*----------------------------------------------------------------*01622013
016230     EXEC SQL                                                     01623013
016240         INCLUDE XLT00010                                         01624013
016250     END-EXEC.                                                    01625013
016260                                                                  01626013
016270*----------------------------------------------------------------*01627013
016280*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PO TABLE           01628013
016290*----------------------------------------------------------------*01629013
016300     EXEC SQL                                                     01630013
016310         INCLUDE TPURCHS                                          01631013
016320     END-EXEC.                                                    01632013
016330                                                                  01633013
016340*----------------------------------------------------------------*01634013
016350*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEAR TABLE       01635013
016360*----------------------------------------------------------------*01636013
016370     EXEC SQL                                                     01637013
016380         INCLUDE TMDSEAR                                          01638013
016390     END-EXEC.                                                    01639013
016400                                                                  01640013
016410*----------------------------------------------------------------*01641013
016420*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEDP TABLE       01642013
016430*----------------------------------------------------------------*01643013
016440     EXEC SQL                                                     01644013
016450         INCLUDE TMDSEDP                                          01645013
016460     END-EXEC.                                                    01646013
016470                                                                  01647013
016480*----------------------------------------------------------------*01648013
016490*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STORE ZONE TABLE   01649013
016500*----------------------------------------------------------------*01650013
016510     EXEC SQL                                                     01651013
016520         INCLUDE TSTRZN                                           01652013
016530     END-EXEC.                                                    01653013
016540                                                                  01654013
016550*----------------------------------------------------------------*01655013
016560*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL PRINT DATA  *01656013
016570*  TABLE                                                         *01657013
016580*----------------------------------------------------------------*01658013
016590     EXEC SQL                                                     01659013
016600         INCLUDE TLBPTDA                                          01660013
016610     END-EXEC.                                                    01661013
016620                                                                  01662013
016630*----------------------------------------------------------------*01663013
016640*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VIRTUAL LABEL     *01664013
016650*  TABLE                                                         *01665013
016660*----------------------------------------------------------------*01666013
016670     EXEC SQL                                                     01667013
016680         INCLUDE TLBVRDA                                          01668013
016690     END-EXEC.                                                    01669013
016700                                                                  01670013
016710*----------------------------------------------------------------*01671013
016720*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01672013
016730*----------------------------------------------------------------*01673013
016740     EXEC SQL                                                     01674013
016750         INCLUDE TVHTRIP                                          01675013
016760     END-EXEC.                                                    01676013
016770                                                                  01677013
016780*----------------------------------------------------------------*01678013
016790*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01679013
016800*----------------------------------------------------------------*01680013
016810     EXEC SQL                                                     01681013
016820         INCLUDE TSHIPMT                                          01682013
016830     END-EXEC.                                                    01683013
016840                                                                  01684013
016850*----------------------------------------------------------------*01685013
016860*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01686013
016870*----------------------------------------------------------------*01687013
016880     EXEC SQL                                                     01688013
016890         INCLUDE TSHPTPO                                          01689013
016900     END-EXEC.                                                    01690013
016910                                                                  01691013
016920*----------------------------------------------------------------*01692013
016930*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01693013
016940*----------------------------------------------------------------*01694013
016950     EXEC SQL                                                     01695013
016960         INCLUDE TRECEIV                                          01696013
016970     END-EXEC.                                                    01697013
016980                                                                  01698013
016990*----------------------------------------------------------------*01699013
017000*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01700013
017010*----------------------------------------------------------------*01701013
017020     EXEC SQL                                                     01702013
017030         INCLUDE TPKSLIP                                          01703013
017040     END-EXEC.                                                    01704013
017050                                                                  01705013
017060*----------------------------------------------------------------*01706013
017070*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01707013
017080*----------------------------------------------------------------*01708013
017090     EXEC SQL                                                     01709013
017100         INCLUDE TRECITM                                          01710013
017110     END-EXEC.                                                    01711013
017120                                                                  01712013
017130*----------------------------------------------------------------*01713013
017140*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01714013
017150*----------------------------------------------------------------*01715013
017160     EXEC SQL                                                     01716013
017170         INCLUDE TRECDIS                                          01717013
017180     END-EXEC.                                                    01718013
017190                                                                  01719013
017200*----------------------------------------------------------------*01720013
017210*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01721013
017220*----------------------------------------------------------------*01722013
017230     EXEC SQL                                                     01723013
017240         INCLUDE TPURITM                                          01724013
017250     END-EXEC.                                                    01725013
017260                                                                  01726013
017270*----------------------------------------------------------------*01727013
017280*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01728013
017290*----------------------------------------------------------------*01729013
017300     EXEC SQL                                                     01730013
017310         INCLUDE TVNDDPT                                          01731013
017320     END-EXEC.                                                    01732013
017330                                                                  01733013
017340*----------------------------------------------------------------*01734013
017350*  DCLGEN LAYOUT AND COBOL DECLARATION FOR SEASONAL SET TABLE    *01735013
017360*----------------------------------------------------------------*01736013
017370     EXEC SQL                                                     01737013
017380         INCLUDE TSEASET                                          01738013
017390     END-EXEC.                                                    01739013
017400                                                                  01740013
017410*----------------------------------------------------------------*01741013
017420*  DCLGEN LAYOUT AND COBOL DECLARATION FOR MESSAGE TABLE         *01742013
017430*----------------------------------------------------------------*01743013
017440     EXEC SQL                                                     01744013
017450         INCLUDE TLBVRMG                                          01745013
017460     END-EXEC.                                                    01746013
017470                                                                  01747013
017480*----------------------------------------------------------------*01748013
017490*  DCLGEN LAYOUT AND COBOL DECLARATION FOR CARTON/LABEL CROSS REF*01749013
017500*----------------------------------------------------------------*01750013
017510     EXEC SQL                                                     01751013
017520         INCLUDE TSULBXF                                          01752013
017530     END-EXEC.                                                    01753013
017540                                                                  01754013
017550*----------------------------------------------------------------*01755013
017560*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01756013
017570*----------------------------------------------------------------*01757013
017580     EXEC SQL                                                     01758013
017590         INCLUDE TDISTHD                                          01759013
017600     END-EXEC.                                                    01760013
017610                                                                  01761013
017620*----------------------------------------------------------------*01762013
017630*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01763013
017640*----------------------------------------------------------------*01764013
017650     EXEC SQL                                                     01765013
017660         INCLUDE TP2LMOD                                          01766013
017670     END-EXEC.                                                    01767013
017680                                                                  01768013
017690*----------------------------------------------------------------*01769013
017700*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01770013
017710*----------------------------------------------------------------*01771013
017720     EXEC SQL                                                     01772013
017730         INCLUDE TCOCNTL                                          01773013
017740     END-EXEC.                                                    01774013
017750                                                                  01775013
017760*----------------------------------------------------------------*01776013
017770*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01777013
017780*----------------------------------------------------------------*01778013
017790     EXEC SQL                                                     01779013
017800         INCLUDE TKRPRPM                                          01780013
017810     END-EXEC.                                                    01781013
017820                                                                  01782013
017830*----------------------------------------------------------------*01783013
017840*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND SHIPT CARTON         01784013
017850*   (sut_otbnd_cart)                                             *01785013
017860*----------------------------------------------------------------*01786013
017870     EXEC SQL                                                     01787013
017880         INCLUDE SUT00024                                         01788013
017890     END-EXEC.                                                    01789013
017900                                                                  01790013
017910*----------------------------------------------------------------*01791013
017920*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND SHIPT CARTON UPC     01792013
017930*   (SUT_OTBND_UPC)                                             * 01793013
017940*----------------------------------------------------------------*01794013
017950     EXEC SQL                                                     01795013
017960         INCLUDE SUT00028                                         01796013
017970     END-EXEC.                                                    01797013
017980                                                                  01798013
017990*----------------------------------------------------------------*01799013
018000*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND LOCATION TABLE       01800013
018010*   (SUT_OTBND_LOC)                                             * 01801013
018020*----------------------------------------------------------------*01802013
018030     EXEC SQL                                                     01803013
018040         INCLUDE SUT00027                                         01804013
018050     END-EXEC.                                                    01805013
018060                                                                  01806013
018070*----------------------------------------------------------------*01807013
018080*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND VENDOR  TABLE        01808013
018090*   (SUT_OTBND_VND)                                             * 01809013
018100*----------------------------------------------------------------*01810013
018110     EXEC SQL                                                     01811013
018120         INCLUDE SUT00026                                         01812013
018130     END-EXEC.                                                    01813013
018140                                                                  01814013
018150*---------------------------------------------------------------* 01815013
018160*      -TROUBLE NOTIFICATION TABLE                              * 01816013
018170*---------------------------------------------------------------* 01817013
018180     EXEC SQL                                                     01818013
018190          INCLUDE TTRBNTF                                         01819013
018200     END-EXEC.                                                    01820013
018210                                                                  01821013
018220                                                                  01822013
018230*---------------------------------------------------------------* 01823013
018240*      -TROUBLE REASON CODES TABLE                              * 01824013
018250*---------------------------------------------------------------* 01825013
018260     EXEC SQL                                                     01826013
018270          INCLUDE TTRBRSN                                         01827013
018280     END-EXEC.                                                    01828013
018290                                                                  01829013
018300*---------------------------------------------------------------* 01830013
018310*      -TROUBLE REASON CODES TABLE  - PROGRAM ID level          * 01831013
018320*---------------------------------------------------------------* 01832013
018330     EXEC SQL                                                     01833013
018340          INCLUDE TTRBRCN                                         01834013
018350     END-EXEC.                                                    01835013
018360                                                                  01836013
018370*---------------------------------------------------------------* 01837013
018380*   QC -PO AUDIT REQUEST TABLE                                  * 01838013
018390*---------------------------------------------------------------* 01839013
018400     EXEC SQL                                                     01840013
018410          INCLUDE SUT00015                                        01841013
018420     END-EXEC.                                                    01842013
018430                                                                  01843013
018440*CT 11/04/08 BEGIN                                              * 01844013
018450*---------------------------------------------------------------* 01845013
018460*   SUT_PNA_STA                                                 * 01846013
018470*---------------------------------------------------------------* 01847013
018480     EXEC SQL                                                     01848013
018490          INCLUDE SUT00107                                        01849013
018500     END-EXEC.                                                    01850013
018510                                                                  01851013
018520*---------------------------------------------------------------* 01852013
018530*   SUT_PNA_STA_DOOR                                            * 01853013
018540*---------------------------------------------------------------* 01854013
018550     EXEC SQL                                                     01855013
018560          INCLUDE SUT00109                                        01856013
018570     END-EXEC.                                                    01857013
018580                                                                  01858013
018590                                                                  01859013
018600*---------------------------------------------------------------* 01860013
018610*   SUT_PNA_STA_DIVERT                                          * 01861013
018620*---------------------------------------------------------------* 01862013
018630     EXEC SQL                                                     01863013
018640          INCLUDE SUT00108                                        01864013
018650     END-EXEC.                                                    01865013
018660                                                                  01866013
018670*CT 11/04/08 END                                                * 01867013
018680                                                                  01868013
018690*---------------------------------------------------------------* 01869013
018700*   TRIP STATUS TABLE                                           * 01870013
018710*---------------------------------------------------------------* 01871013
018720     EXEC SQL                                                     01872013
018730          INCLUDE TTRIPST                                         01873013
018740     END-EXEC.                                                    01874013
018750                                                                  01875013
018760*---------------------------------------------------------------* 01876013
018770*   OUTBOUND PACK TABLE (SUT_OTBND_PK)                          * 01877013
018780*---------------------------------------------------------------* 01878013
018790     EXEC SQL                                                     01879013
018800          INCLUDE SUT00041                                        01880013
018810     END-EXEC.                                                    01881013
018820                                                                  01882013
018830*---------------------------------------------------------------* 01883013
018840*   PO PREPACK TABLE (TPOPRPK)                                  * 01884013
018850*---------------------------------------------------------------* 01885013
018860     EXEC SQL                                                     01886013
018870          INCLUDE TPOPRPK                                         01887013
018880     END-EXEC.                                                    01888013
018890                                                                  01889013
018900*----------------------------------------------------------------*01890013
018910* DCLGEN FOR EAS MDSE TAG LOOKUP  (SFT_EAS_TG_MDSE)              *01891013
018920*----------------------------------------------------------------*01892013
018930     EXEC SQL                                                     01893013
018940          INCLUDE SFT00000                                        01894013
018950     END-EXEC.                                                    01895013
018960                                                                  01896013
018970*----------------------------------------------------------------*01897013
018980* DC DOOR TABLE                                                  *01898013
018990*----------------------------------------------------------------*01899013
019000     EXEC SQL                                                     01900013
019010          INCLUDE TCNDCDR                                         01901013
019020     END-EXEC.                                                    01902013
019030                                                                  01903013
019040*----------------------------------------------------------------*01904013
019050* DC DOOR TO STORE TABLE                                         *01905013
019060*----------------------------------------------------------------*01906013
019070     EXEC SQL                                                     01907013
019080          INCLUDE TCNDRST                                         01908013
019090     END-EXEC.                                                    01909013
019100                                                                  01910013
019110******************************************************************01911013
019120*  DB2 AREA FOR THE SHIPPING UNIT AUDIT TRANSACTION TABLE         01912013
019130******************************************************************01913013
019140     EXEC SQL                                                     01914013
019150          INCLUDE TSUATRN                                         01915013
019160     END-EXEC.                                                    01916013
019170                                                                  01917013
019180*CLP 06/24/2015 - START                                           01918013
019190*----------------------------------------------------------------*01919013
019200* SKU TABLE (XLT_SKU)                                             01920013
019210*----------------------------------------------------------------*01921013
019220     EXEC SQL                                                     01922013
019230          INCLUDE XLT00003                                        01923013
019240     END-EXEC.                                                    01924013
019250                                                                  01925013
019260*----------------------------------------------------------------*01926013
019270* VENDOR STYLE TABLE (XLT_VND_STYL)                               01927013
019280*----------------------------------------------------------------*01928013
019290     EXEC SQL                                                     01929013
019300          INCLUDE XLT00004                                        01930013
019310     END-EXEC.                                                    01931013
019320                                                                  01932013
019330*----------------------------------------------------------------*01933013
019340* BRAND TABLE (XLT_BRND)                                          01934013
019350*----------------------------------------------------------------*01935013
019360     EXEC SQL                                                     01936013
019370          INCLUDE XLT00043                                        01937013
019380     END-EXEC.                                                    01938013
019390                                                                  01939013
019400*CLP 06/24/2015 - END                                             01940013
019410*----------------------------------------------------------------*01941013
019420*    DB2 DCLGEN FOR THE WST_INTGRTN_TYP TABLE                     01942013
019430*----------------------------------------------------------------*01943013
019440     EXEC SQL                                                     01944013
019450          INCLUDE WST00008                                        01945013
019460     END-EXEC.                                                    01946013
019470/                                                                 01947013
019480*----------------------------------------------------------------*01948013
019490*    DB2 DCLGEN FOR THE WST_ATTR_DEFN TABLE                       01949013
019500*----------------------------------------------------------------*01950013
019510     EXEC SQL                                                     01951013
019520          INCLUDE WST00009                                        01952013
019530     END-EXEC.                                                    01953013
019540/                                                                 01954013
019550* JAK WR41309 - ADD DCLGEN                                        01955013
019560*----------------------------------------------------------------*01956013
019570*    DB2 DCLGEN FOR THE SUT_PRC_MSG_CNTL TABLE                    01957013
019580*----------------------------------------------------------------*01958013
019590     EXEC SQL                                                     01959013
019600          INCLUDE SUT00094                                        01960013
019610     END-EXEC.                                                    01961013
019620/                                                                 01962013
019630* JAK WR41309 - END                                               01963013
019640*----------------------------------------------------------------*01964013
019650*    DB2 DCLGEN FOR THE WST_ATTR_ELEM TABLE                       01965013
019660*----------------------------------------------------------------*01966013
019670     EXEC SQL                                                     01967013
019680          INCLUDE WST00010                                        01968013
019690     END-EXEC.                                                    01969013
019700/                                                                 01970013
019710*----------------------------------------------------------------*01971013
019720*  COMMUNICATIONS AREA FOR DB2                                    01972013
019730*----------------------------------------------------------------*01973013
019740     EXEC SQL                                                     01974013
019750         INCLUDE SQLCA                                            01975013
019760     END-EXEC.                                                    01976013
019770*----------------------------------------------------------------*01977013
019780*  CURSOR TO SELECT THE LINE(S), LINE NUMBER, PREPACK ID        * 01978013
019790*  AND SHIPPED QUANTITY                                         * 01979013
019800*  2014-12-03 - DMH - Added "WITH UR" to cursor                 * 01980013
019810*---------------------------------------------------------------* 01981013
019820                                                                  01982013
019830                                                                  01983013
019840     EXEC SQL                                                     01984013
019850          DECLARE PREPK-CSR CURSOR FOR                            01985013
019860          SELECT A.TRN_NBR                                        01986013
019870                ,D.ORD_LNE_NBR                                    01987013
019880                ,D.PREPK_ID                                       01988013
019890                ,D.PREPK_RATO_QTY                                 01989013
019900                ,A.SHPD_QTY                                       01990013
019910                ,E.PREPK_LNE_PRC_CDE                              01991013
019920                ,E.UCC128_DAT_USG_CDE                             01992013
019930                ,E.PRC_AREA_MODU_ID                               01993013
019940          FROM   TSHUUPC A                                        01994013
019950               , TINPKSU B                                        01995013
019960               , TPKSLIP C                                        01996013
019970               , TRECITM D                                        01997013
019980               , TDISTHD E                                        01998013
019990          WHERE A.SHIPT_UNT_ID = :DK-CTN                          01999013
020000          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    02000013
020010          AND  B.PO_NBR       = C.PO_NBR                          02001013
020020          AND  B.SEQ_NBR      = C.SEQ_NBR                         02002013
020030          AND  C.VER_STAT_CDE = 'A'                               02003013
020040          AND  C.PO_NBR       = D.ORD_NBR                         02004013
020050          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     02005013
020060          AND  C.REC_SEQ_NBR  = :PV-RCVR-SEQ-NBR                  02006013
020070          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     02007013
020080          AND  E.ORD_NBR      = C.PO_NBR                          02008013
020090          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     02009013
020100          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     02010013
020110          AND  E.TOT_CART_CNT > 0                                 02011013
020120         WITH UR                                                  02012013
020130     END-EXEC                                                     02013013
020140                                                                  02014013
020150*---------------------------------------------------------------* 02015013
020160*  CURSOR TO SELECT THE BARCODES FOR A CARTON, USED FOR A REPRINT 02016013
020170*  2014-12-03 - DMH - Added "WITH UR" to cursor                 * 02017013
020180*---------------------------------------------------------------* 02018013
020190     EXEC SQL                                                     02019013
020200        DECLARE REPRINT-CSR CURSOR FOR                            02020013
020210        SELECT   BRCDE_NBR                                        02021013
020220        FROM TSULBXF A                                            02022013
020230        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                02023013
020240          AND  A.STAT_CDE              =   'A'                    02024013
020250         WITH UR                                                  02025013
020260     END-EXEC                                                     02026013
020270                                                                  02027013
020280*---------------------------------------------------------------* 02028013
020290*  CURSOR TO SELECT THE LINE(S) AND NUMBER OF UNITS WITHIN A    * 02029013
020300*  CARTON                                                       * 02030013
020310*  2014-12-03 - DMH - Added "WITH UR" to cursor                 * 02031013
020320*---------------------------------------------------------------* 02032013
020330     EXEC SQL                                                     02033013
020340          DECLARE UNITS-CSR CURSOR FOR                            02034013
020350          SELECT SHPD_QTY                                         02035013
020360                ,TRN_LNE_NBR                                      02036013
020370                ,UCC128_DAT_USG_CDE                               02037013
020380                ,PRC_AREA_MODU_ID                                 02038013
020390          FROM   TSHUUPC A                                        02039013
020400                ,TDISTHD B                                        02040013
020410          WHERE SHIPT_UNT_ID  = :DK-CTN                           02041013
020420            AND A.TRN_NBR     =  B.ORD_NBR                        02042013
020430            AND A.TRN_LNE_NBR =  B.ORD_LNE_NBR                    02043013
020440            AND B.RCVR_SEQ_NBR = :PV-RCVR-SEQ-NBR                 02044013
020450            AND B.TOT_CART_CNT > 0                                02045013
020460          ORDER BY 2                                              02046013
020470           WITH UR                                                02047013
020480     END-EXEC                                                     02048013
020490                                                                  02049013
020500                                                                  02050013
020510*---------------------------------------------------------------* 02051013
020520*                                                               * 02052013
020530*                                                               * 02053013
020540*---------------------------------------------------------------* 02054013
020550     EXEC SQL                                                     02055013
020560        DECLARE VRTL-LBL-PRT-CSR CURSOR FOR                       02056013
020570        SELECT   CART_LBL_TYP_CDE                                 02057013
020580                ,PREPK_PRCG_LNE_NBR                               02058013
020590                ,INPK_UNT_QTY                                     02059013
020600                ,PREPK_RATO_QTY                                   02060013
020610                ,DEST_OPER_UNT_ID                                 02061013
020620                ,CSE_PK_QTY                                       02062013
020630                ,ODD_CART_IND                                     02063013
020640                ,INPK_CNVYB_IND                                   02064013
020650                ,LBL_TYP_LBL_SEQ_ID                               02065013
020660                ,LBL_TYP_TOT_QTY                                  02066013
020670                ,BRCDE_NBR                                        02067013
020680                ,STR_ZN_ID                                        02068013
020690                ,MODU_DESC                                        02069013
020700                ,ITM_NBR                                          02070013
020710                ,DEPT_DESC                                        02071013
020720                ,MAJ_CL_DESC                                      02072013
020730                ,SEASET_NM                                        02073013
020740                ,FIXT_ID                                          02074013
020750                ,LBL_TYP_CDE                                      02075013
020760                ,PRNT_CART_SEQ_ID                                 02076013
020770                ,STRG_AREA_CDE                                    02077013
020780                ,OTPK_UNT_QTY                                     02078013
020790                ,EAS_TAG_IND                                      02079013
020800                ,DOOR_ID                                          02080013
020810                ,HNG_FOLD_SEQ_NBR                                 02081013
020820*CLP 06/24/2015 START                                             02082013
020830                ,LBL_MSG_TXT                                      02083013
020840*CLP 06/24/2015 END                                               02084013
020850        FROM TLBVRDA A                                            02085013
020860        WHERE  A.PO_NBR                =   :DK-PO                 02086013
020870          AND  A.RCVR_SEQ_NBR          =   :DK-REC-SEQ-NBR        02087013
020880          AND  A.PO_LNE_NBR            =   :DK-PO-LNE-NBR         02088013
020890          AND  A.PREPK_ID              =   :DK-PREPK-ID           02089013
020900          AND  A.OTPK_UNT_QTY          =   :DK-OUTER-QTY          02090013
020910          AND  A.LBL_ASG_IND           =   'N'                    02091013
020920          AND  A.PRNT_CART_SEQ_ID      =   :LBVRDA-LBL-ASG-SEQ-NBR02092013
020930        ORDER BY LBL_TYP_LBL_SEQ_ID                               02093013
020940     END-EXEC                                                     02094013
020950                                                                  02095013
020960                                                                  02096013
020970*---------------------------------------------------------------* 02097013
020980*  CURSOR TO DETERMINE ODD UNITS IN A PREPACK                   * 02098013
020990*  CARTON                                                       * 02099013
021000*  2014-12-03 - DMH - Added "WITH UR" to cursor                 * 02100013
021010*---------------------------------------------------------------* 02101013
021020     EXEC SQL                                                     02102013
021030          DECLARE ODD-UNITS-CSR CURSOR FOR                        02103013
021040           SELECT 'A',                                            02104013
021050                  TRN_LNE_NBR,                                    02105013
021060                  0                                               02106013
021070           FROM TSHUUPC                                           02107013
021080           WHERE SHIPT_UNT_ID = :DK-CTN                           02108013
021090           UNION                                                  02109013
021100           SELECT 'B', B.ORD_LNE_NBR, A.PREPK_ID                  02110013
021110           FROM  TRECITM A                                        02111013
021120               , TSHUUPC                                          02112013
021130               , TRECITM B                                        02113013
021140           WHERE A.ORD_NBR        = TRN_NBR                       02114013
021150               AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR               02115013
021160               AND A.ORD_LNE_NBR  = TRN_LNE_NBR                   02116013
021170               AND SHIPT_UNT_ID   = :DK-CTN                       02117013
021180               AND B.ORD_NBR      = A.ORD_NBR                     02118013
021190               AND B.REC_SEQ_NBR  = A.REC_SEQ_NBR                 02119013
021200               AND B.PREPK_ID     = A.PREPK_ID                    02120013
021210           ORDER BY 2, 1                                          02121013
021220**         ORDER BY 2, 3, 1                                       02122013
021230**GB 3/5/02  REMOVE  AND A.ORD_NBR      = :DK-PO                  02123013
021240            WITH UR                                               02124013
021250     END-EXEC                                                     02125013
021260                                                                  02126013
021270                                                                  02127013
021280*---------------------------------------------------------------* 02128013
021290*  CURSOR TO DETERMINE MERCHANDISE PRESENTATION                 * 02129013
021300*  HANG, FOLD OR MIXED                                          * 02130013
021310*  2014-12-03 - DMH - Added "WITH UR" to cursor                 * 02131013
021320*---------------------------------------------------------------* 02132013
021330     EXEC SQL                                                     02133013
021340          DECLARE HANG_FOLD_CSR CURSOR FOR                        02134013
021350           SELECT DISTINCT(UPC_NBR)                               02135013
021360                , TRN_LNE_NBR                                     02136013
021370           FROM TSHUUPC                                           02137013
021380           WHERE SHIPT_UNT_ID = :DK-CTN                           02138013
021390            WITH UR                                               02139013
021400     END-EXEC                                                     02140013
021410                                                                  02141013
021420                                                                  02142013
021430*---------------------------------------------------------------* 02143013
021440*  CURSOR TO DETERMINE IF ECOMM UPC NEEDS WEIGHTS MEASURES      * 02144013
021450*  CHECK                                                        * 02145013
021460*  2014-12-03 - DMH - Added "WITH UR" to cursor                 * 02146013
021470*---------------------------------------------------------------* 02147013
021480     EXEC SQL                                                     02148013
021490          DECLARE WGHTS_MSRS_CSR CURSOR FOR                       02149013
021500           SELECT DISTINCT(UPC_NBR)                               02150013
021510           FROM TSHUUPC                                           02151013
021520           WHERE SHIPT_UNT_ID = :DK-CTN                           02152013
021530            WITH UR                                               02153013
021540     END-EXEC                                                     02154013
021550                                                                  02155013
021560                                                                  02156013
021570*---------------------------------------------------------------* 02157013
021580*  CURSOR TO SELECT UPC FOR EACH CARTON TO POPULATE             * 02158013
021590*  THE OUTBOUND CARTON UPC TABLE                                * 02159013
021600*  2014-12-03 - DMH - Added "WITH UR" to cursor                 * 02160013
021610*---------------------------------------------------------------* 02161013
021620     EXEC SQL                                                     02162013
021630          DECLARE UPC_UNLOAD_CSR CURSOR FOR                       02163013
021640           SELECT DISTINCT(UPC_NBR)                               02164013
021650                , TRN_NBR                                         02165013
021660                , TRN_LNE_NBR                                     02166013
021670                , TRN_TYP_CDE                                     02167013
021680                , SHPD_QTY                                        02168013
021690           FROM TSHUUPC                                           02169013
021700           WHERE SHIPT_UNT_ID = :DK-CTN                           02170013
021710            WITH UR                                               02171013
021720     END-EXEC.                                                    02172013
021730                                                                  02173013
021740                                                                  02174013
021750***************************************************************** 02175013
021760 LINKAGE SECTION.                                                 02176013
021770******************************************************************02177013
021780 01  DFHCOMMAREA.                                                 02178013
021790     05  FILLER                       OCCURS 1 TO 4072 TIMES      02179013
021800                                      DEPENDING ON EIBCALEN.      02180013
021810         10  FILLER                   PIC X.                      02181013
021820                                                                  02182013
021830******************************************************************02183013
021840 PROCEDURE DIVISION.                                              02184013
021850******************************************************************02185013
021860 0000-PROGRAM-MAINLINE.                                           02186013
021870                                                                  02187013
021880     MOVE DFHCOMMAREA TO SU054-CRTN-CHECKIN-RECORD.               02188013
021890                                                                  02189013
021900     set  PS-NO-LOG-MESSAGE                                       02190013
021910          PS-BLD-INTERNAL-TABLE-NO   to  true.                    02191013
021920                                                                  02192013
021930     perform 0100-get-start-tmst.                                 02193013
021940                                                                  02194013
021941* RPK 2018-05-09 - BEGIN                                          02194168
021942* ADDED THE FOLLOWING LOGIC WITH THE PV-CURRENT-TMST TO           02194268
021943* GET THE LAST 4 DIGITS OF THE TIMESTAMP TO MOVE TO THE           02194368
021944* LAST 4 DIGITS OF THE 22 DIGIT RFID TAGGING BARCODE.             02194468
021945* SEE MORE INFO IN THE PROGRAM DOC ON THIS.                       02194568
021946     MOVE PV-INIT-TIMESTAMP TO PV-CURRENT-TMST-r.                 02194668
021947                                                                  02194768
021948     IF PV-CURRENT-TMST-R-LAST-4 < 1000                           02194868
021949        COMPUTE PV-CURRENT-TMST-R-LAST-4 =                        02194968
021950                PV-CURRENT-TMST-R-LAST-4 + 1000                   02195068
021951     END-IF.                                                      02195168
021952* RPK 2018-05-09 - END                                            02195268
021953                                                                  02195368
021954     PERFORM 0400-CHECK-FOR-LOGGING.                              02195413
021960     PERFORM 0410-CHECK-PARA-TRACK-sec.                           02196013
021970     MOVE zeroes       TO PT-CURR-ENTRIES                         02197013
021980     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         02198013
021990                                                                  02199013
022000*                                                                 02200013
022010** added internal table to track paragraph execution time         02201013
022020** dmh 2014-12-22 - begin                                         02202013
022030*                                                                 02203013
022040     MOVE  '0000'  TO  PT-CURR-PARA.                              02204013
022050     IF  PS-BLD-INTERNAL-TABLE-YES                                02205013
022060         PERFORM 0200-INTERNAL-TABLE                              02206013
022070     else                                                         02207013
022080         MOVE 1            TO PT-CURR-ENTRIES                     02208013
022090         SET  PT-TRACK-IDX to PT-CURR-ENTRIES                     02209013
022100         perform 0202-BUILD-MESSAGE-DISPLAY                       02210013
022110     END-IF.                                                      02211013
022120                                                                  02212013
022130     IF  PS-LOG-MESSAGE                                           02213013
022140         move spaces to  pv-ciCS-MSG-AREA-A                       02214013
022150         PERFORM 9999-WRITE-TO-CSSL                               02215013
022160         PERFORM 0205-WRITE-SUWS054-TO-CSSL                       02216013
022170                                                                  02217013
022180         INITIALIZE PV-CICS-MSG-AREA-A                            02218013
022190         STRING ' SUKCS782-STARTED'                               02219099
022200               ' 0000-'                                           02220013
022210               ' DC:'   SU054-DC-NUMBER                           02221013
022220               ' STA:'  SU054-ACCM-LINE-NMBR                      02222013
022230               ' KEY:'  PV-INIT-TIME-KEY                          02223013
022240               ' TMST:' PV-INIT-TIMESTAMP     DELIMITED BY SIZE   02224013
022250                                        INTO PV-CICS-MSG-AREA-A   02225013
022260         PERFORM 9999-WRITE-TO-CSSL                               02226013
022270                                                                  02227013
022280     END-IF.                                                      02228013
022290*                                                                 02229013
022300** DMH 2014-12-22 - END                                           02230013
022310*                                                                 02231013
022320                                                                  02232013
022330     MOVE  SPACES             TO PV-DUPLICATE-IND                 02233013
022340                                 PS-REPRINT-IND                   02234013
022350                                 PS-LBL-REPRINT-IND               02235013
022360     SET PS-VALID-INPUT                                           02236013
022370         PS-INSERT-ERROR-NO                                       02237013
022380         PS-VALID-BRCDE-FOUND                                     02238013
022390         PS-NO-BRCDE-ERROR-FND TO TRUE                            02239013
022400     SET PS-DC-USE-RFID-CART-LBL-NO TO TRUE                       02240044
022410                                                                  02241013
022420     MOVE SU054-TRIP-ID TO PV-DISP-trip                           02242013
022430     PERFORM 1000-PROCESS-LABEL-REQUEST                           02243013
022440*                                                                 02244013
022450*** DMH 9/22/11 - BEGIN                                           02245013
022460     IF  SU054-MULT-SSCC-YES                                      02246013
022470         SET PS-MULT-SSCC-YES  TO  TRUE                           02247013
022480         PERFORM 5005-PRINT-MESSAGE-LABELS                        02248013
022490     END-IF                                                       02249013
022500                                                                  02250013
022510***                                                               02251013
022520*                                                                 02252013
022530     PERFORM 1300-VALDTE-LBL-COMBINATIONS.                        02253013
022540                                                                  02254013
022550*                                                                 02255013
022560*** 000b is just used to show how the program is stepping         02256013
022570*** thru .... this is the 2nd display in paragraph 000            02257013
022580*                                                                 02258013
022590     MOVE  '000B'  TO  PT-CURR-PARA.                              02259013
022600     IF  PS-BLD-INTERNAL-TABLE-YES                                02260013
022610         PERFORM 0200-INTERNAL-TABLE                              02261013
022620     ELSE                                                         02262013
022630         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       02263013
022640     END-IF.                                                      02264013
022650                                                                  02265013
022660     IF  PS-LOG-MESSAGE                                           02266013
022670         STRING ' SUKCS782-000B '                                 02267099
022680                'PS-PROCESSING-ERROR-SW:'                         02268013
022690                 PS-PROCESSING-ERROR-SW      DELIMITED BY SIZE    02269013
022700                                        INTO PV-CICS-MSG-AREA-A   02270013
022710     END-IF                                                       02271013
022720                                                                  02272013
022730*TS 06/24/2010 BEG                                                02273013
022740*    PERFORM 2240-CHECK-TABLES                                    02274013
022750     IF PS-WHSE-OTBND-CART-YES                                    02275013
022760                                                                  02276013
022770*        MOVE PV-BAR-CODE-OTBND      TO SUT00024-SHIPT-UNT-ID     02277013
022780         MOVE PV-CTN-N               TO SUT00024-SHIPT-UNT-ID     02278013
022790                                        DK-CTN                    02279013
022800         MOVE SU054-DC-NUMBER        TO RECEIV-CURR-OPER-UNT-ID   02280013
022810         PERFORM 7644-SELECT-OTBND-LOC                            02281013
022820* EA 07/08/2010                                                  *02282013
022830         IF PS-OTBND-LOC-ENTRY-NOT-EXIST                          02283013
022840            PERFORM 7645-INSERT-OTBND-LOC                         02284013
022850            PERFORM 7646-CALL-UNT-WKD-MODULE                      02285013
022860         END-IF                                                   02286013
022870*        PERFORM 2255-SELECT-SHUUPC                               02287013
022880         PERFORM 2256-SELECT-OTBND-UPC                            02288013
022890*                                                                 02289013
022900         MOVE SU054-ACCM-LINE-NMBR TO SUT00107-ACM-LBL-STA-NBR    02290013
022910         PERFORM 5003-SELECT-CONVEY-LVL                           02291013
022920* 09/23/13 SB BEG                                                 02292013
022930*        PERFORM 5004-SELECT-FUNC-TXT                             02293013
022940* 09/23/13 SB END                                                 02294013
022950* DONE NOW WITHIN 6020-                                           02295013
022960*        IF PV-RFID-REPLEN-NO                                     02296013
022970            PERFORM 6000A-FORMAT-DIR-CALL-IR                      02297013
022980*        END-IF                                                   02298013
022990*                                                                 02299013
023000* EA 07/08/2010                                                  *02300013
023010         PERFORM 2257-SELECT-TVHTRIP                              02301013
023020*****************************************************             02302013
023030** GB 10/2/12 IMPORT REPLEN CHANGES FOR RFID BEG                  02303013
023040*****************************************************             02304013
023050*        IF PS-OTBND-LOC-ENTRY-NOT-EXIST                          02305013
023060*           MOVE SU054-ACCM-LINE-NMBR TO SUT00107-ACM-LBL-STA-NBR 02306013
023070*           PERFORM 5003-SELECT-CONVEY-LVL                        02307013
023080*           EVALUATE TRUE                                         02308013
023090*               WHEN PS-AUTO-CONVEY-NO-CRTNS                      02309013
023100*                  CONTINUE                                       02310013
023110*               WHEN PS-AUTO-CONVEY-ALL-CRTNS                     02311013
023120*               WHEN PS-AUTO-CONVEY-EXCPT-CRTNS                   02312013
023130*                  PERFORM 6000A-FORMAT-DIR-CALL-IR               02313013
023140*                  CONTINUE                                       02314013
023150*           END-EVALUATE                                          02315013
023160*        END-IF                                                   02316013
023170*****************************************************             02317013
023180** GB 10/2/12 IMPORT REPLEN CHANGES FOR RFID END                  02318013
023190*****************************************************             02319013
023200***********************************************************       02320013
023210* CLP 06/20/13 PR5148B START                                      02321013
023220         IF PS-RFID-ON-LABEL-YES                                  02322013
023230             PERFORM 5005-PRINT-MESSAGE-LABELS                    02323013
023240         ELSE                                                     02324013
023250             PERFORM 7200-GATHER-LABEL-INFO                       02325013
023260             PERFORM 7205-INSERT-LABEL-TABLE                      02326013
023270             SET SU054-NO-REJECT                                  02327013
023280             SU054-NO-LABEL-REQ TO TRUE                           02328013
023290             MOVE +0    TO SU054-FRCD-DIVERT-IND                  02329013
023300             MOVE +1    TO SU054-DWNLD-PRINT-IND                  02330013
023310             MOVE LBPTDA-BRCDE-NBR   TO SU054-KOHLS-SML           02331013
023320             MOVE SU054-CRTN-CHECKIN-RECORD TO  DFHCOMMAREA       02332013
023330* CLP 06/20/13 PR5148B END                                        02333013
023340         END-IF                                                   02334013
023350     ELSE                                                         02335013
023360          PERFORM 2240-CHECK-TABLES                               02336013
023370     END-IF.                                                      02337013
023380*TS 06/24/2010 END                                                02338013
023390                                                                  02339013
023400     IF  PS-BLD-INTERNAL-TABLE-YES  and                           02340013
023410         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  02341013
023420                                                                  02342013
023430         move spaces to  pv-ciCS-MSG-AREA-A                       02343013
023440         PERFORM 9999-WRITE-TO-CSSL                               02344013
023450                                                                  02345013
023460         INITIALIZE PV-CICS-MSG-AREA-A                            02346013
023470         move pv-duration-sec to  PV-disp-duration                02347013
023480         STRING ' SUKCS782-DID NOT MEET SLA'                      02348099
023490               ' 0000-'                                           02349013
023500               ' DC:'        SU054-DC-NUMBER                      02350013
023510               ' STA:'       SU054-ACCM-LINE-NMBR                 02351013
023520               ' KEY:'       PV-INIT-TIME-KEY                     02352013
023530               ' tmst:'      PV-curr-TIMESTAMP                    02353013
023540               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   02354013
023550                                        INTO PV-CICS-MSG-AREA-A   02355013
023560         PERFORM 9999-WRITE-TO-CSSL                               02356013
023570                                                                  02357013
023580         INITIALIZE PV-CICS-MSG-AREA-A                            02358013
023590         STRING ' SUKCS782-'                                      02359099
023600               ' 0000-'                                           02360013
023610               ' KEY:'       PV-INIT-TIME-KEY                     02361013
023620               ' init:'      PV-init-TIMESTAMP                    02362013
023630               ' curr:'      PV-curr-timestamp DELIMITED BY SIZE  02363013
023640                                        INTO PV-CICS-MSG-AREA-A   02364013
023650         PERFORM 9999-WRITE-TO-CSSL                               02365013
023660                                                                  02366013
023670         PERFORM 0205-WRITE-SUWS054-TO-CSSL                       02367013
023680                                                                  02368013
023690         move spaces to  pv-ciCS-MSG-AREA-A                       02369013
023700         PERFORM 9999-WRITE-TO-CSSL                               02370013
023710                                                                  02371013
023720         PERFORM 0210-DUMP-TABLE-TO-CSSL                          02372013
023730         VARYING PT-TRACK-IDX                                     02373013
023740            FROM 1 BY 1                                           02374013
023750           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 02375013
023760              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             02376013
023770                                                                  02377013
023780         PERFORM 0220-CLEAR-TABLE                                 02378013
023790         VARYING PT-TRACK-IDX                                     02379013
023800            FROM 1 BY 1                                           02380013
023810           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 02381013
023820              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             02382013
023830                                                                  02383013
023840         MOVE ZEROES TO PT-CURR-ENTRIES                           02384013
023850         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   02385013
023860                                                                  02386013
023870         INITIALIZE PV-CICS-MSG-AREA-A                            02387013
023880         move pv-duration-sec to  PV-disp-duration                02388013
023890         STRING ' SUKCS782-DID NOT MEET SLA'                      02389099
023900               ' 0000-'                                           02390013
023910               ' DC:'        SU054-DC-NUMBER                      02391013
023920               ' STA:'       SU054-ACCM-LINE-NMBR                 02392013
023930               ' KEY:'       PV-INIT-TIME-KEY                     02393013
023940               ' done'                       delimited by size    02394013
023950                                        INTO PV-CICS-MSG-AREA-A   02395013
023960         PERFORM 9999-WRITE-TO-CSSL                               02396013
023970                                                                  02397013
023980         move spaces to  pv-ciCS-MSG-AREA-A                       02398013
023990         PERFORM 9999-WRITE-TO-CSSL                               02399013
024000                                                                  02400013
024010     END-IF.                                                      02401013
024020                                                                  02402013
024030     IF  PS-LOG-MESSAGE                                           02403013
024040         INITIALIZE PV-CICS-MSG-AREA-A                            02404013
024050         move pv-duration-sec  to   PV-disp-duration              02405013
024060         STRING ' SUKCS782-ENDED  '                               02406099
024070               ' 0000-'                                           02407013
024080               ' DC:'        SU054-DC-NUMBER                      02408013
024090               ' STA:'       SU054-ACCM-LINE-NMBR                 02409013
024100               ' KEY:'       PV-INIT-TIME-KEY                     02410013
024110               ' tmst:'      PV-curr-TIMESTAMP                    02411013
024120               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   02412013
024130                                        INTO PV-CICS-MSG-AREA-A   02413013
024140         PERFORM 9999-WRITE-TO-CSSL                               02414013
024150                                                                  02415013
024160     END-IF.                                                      02416013
024170                                                                  02417013
024180     GOBACK.                                                      02418013
024190                                                                  02419013
024200                                                                  02420013
024210*---------------------------------------------------------------* 02421013
024220* SELECT THE TIMESTAMP WHEN THE PROGRAM IS STARTED.  THIS WILL  * 02422013
024230* USED TO DETERMINE IF PROGRAM IS TAKING TO LONG TO RESPOND.    * 02423013
024240* DMH - 12/22/14                                                * 02424013
024250*---------------------------------------------------------------* 02425013
024260 0100-GET-START-TMST.                                             02426013
024270                                                                  02427013
024280         EXEC SQL                                                 02428013
024290             SET :PV-INIT-TIMESTAMP  =  CURRENT TIMESTAMP         02429013
024300         END-EXEC.                                                02430013
024310                                                                  02431013
024320     MOVE  PV-INIT-HH    TO  PV-INIT-KEY-HH.                      02432013
024330     MOVE  PV-INIT-MM    TO  PV-INIT-KEY-MM.                      02433013
024340     MOVE  PV-INIT-SS    TO  PV-INIT-KEY-SS.                      02434013
024350                                                                  02435013
024360                                                                  02436013
024370*---------------------------------------------------------------* 02437013
024380* SELECT THE CURRENT TIMESTAMP WHEN A PARAGRAPH IS BEING        * 02438013
024390* EXECUTED - THIS WILL BE USED TO DETERMINE IF THE PROGRAM IS   * 02439013
024400* TAKING TOO LONG TO RESPOND.                                   * 02440013
024410* DMH - 12/22/14                                                * 02441013
024420*---------------------------------------------------------------* 02442013
024430 0100-GET-CURRENT-TMST.                                           02443013
024440                                                                  02444013
024450     EXEC SQL                                                     02445013
024460         SET :PV-CURR-TIMESTAMP  =  CURRENT TIMESTAMP             02446013
024470     END-EXEC.                                                    02447013
024480                                                                  02448013
024490     EXEC SQL                                                     02449013
024500          SELECT                                                  02450013
024510                 TIMESTAMPDIFF( 2 ,CHAR(:PV-CURR-TIMESTAMP        02451013
024520                   - TIMESTAMP(:PV-INIT-TIMESTAMP)))              02452013
024530               , TIMESTAMPDIFF( 1 ,CHAR(:PV-CURR-TIMESTAMP        02453013
024540                   - TIMESTAMP(:PV-INIT-TIMESTAMP)))              02454013
024550            INTO :PV-DURATION-SEC                                 02455013
024560               , :PV-DURATION-nano-sec                            02456013
024570            FROM  SYSIBM.SYSDUMMY1                                02457013
024580     END-EXEC.                                                    02458013
024590                                                                  02459013
024600                                                                  02460013
024610*---------------------------------------------------------------* 02461013
024620* BUILD INTERNAL TABLE WITN PARAGRAPH TRACKING                  * 02462013
024630* DMH - 12/22/14                                                * 02463013
024640*---------------------------------------------------------------* 02464013
024650 0200-INTERNAL-TABLE.                                             02465013
024660                                                                  02466013
024670     PERFORM 0100-GET-CURRENT-TMST.                               02467013
024680     ADD  +1  TO  PT-CURR-ENTRIES.                                02468013
024690     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         02469013
024700                                                                  02470013
024710     MOVE 'SUKCS782'           TO PT-PROGRAM(PT-TRACK-IDX).       02471099
024720     move pt-curr-entries      TO PT-INDEX-NBR(PT-TRACK-IDX).     02472013
024730     MOVE PT-CURR-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     02473013
024740     MOVE PV-CURR-TIMESTAMP    TO PT-TIMESTAMP(PT-TRACK-IDX).     02474013
024750     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      02475013
024760                                                                  02476013
024770     move PV-DURATION-nano-sec    to PV-work-nano-sec.            02477013
024780     move PV-work-nano-min-1-2    to PV-disp-nano-min-1-2.        02478013
024790     move '-'                     to pv-disp-nano-dash-1.         02479013
024800     move PV-work-nano-sec-3-4    to PV-disp-nano-sec-3-4.        02480013
024810     move '-'                     to pv-disp-nano-dash-2.         02481013
024820     move PV-work-nano-micro-5-10 to PV-disp-nano-micro-5-10.     02482013
024830     MOVE PV-disp-nano-sec     TO PT-NANO-SEC(PT-TRACK-IDX).      02483013
024840                                                                  02484013
024850     MOVE SU054-DC-NUMBER      TO PT-DC(PT-TRACK-IDX).            02485013
024860     MOVE SU054-ACCM-LINE-NMBR TO PT-PNA-STA(PT-TRACK-IDX).       02486013
024870     MOVE PV-INIT-TIME-KEY     TO PT-START-HHMMSS(PT-TRACK-IDX).  02487013
024880                                                                  02488013
024890     IF  PS-LOG-MESSAGE                                           02489013
024900         INITIALIZE PV-CICS-MSG-AREA1                             02490013
024910         MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA1      02491013
024920         MOVE SPACES                    TO PV-CICS-MSG-AREA-A     02492013
024930         MOVE PV-CICS-MSG-AREA1         TO PV-CICS-MSG-AREA-A     02493013
024940         PERFORM 9999-WRITE-TO-CSSL                               02494013
024950     END-IF                                                       02495013
024960                                                                  02496013
024970     IF  PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES                     02497013
024980         MOVE ZEROES TO PT-CURR-ENTRIES                           02498013
024990         SET  PT-TRACK-IDX  to PT-CURR-ENTRIES                    02499013
025000     END-IF.                                                      02500013
025010                                                                  02501013
025020 0202-BUILD-MESSAGE-DISPLAY.                                      02502013
025030                                                                  02503013
025040     IF  PS-LOG-MESSAGE                                           02504013
025050         PERFORM 0100-GET-CURRENT-TMST                            02505013
025060     end-if.                                                      02506013
025070                                                                  02507013
025080     MOVE  1  TO  PT-CURR-ENTRIES                                 02508013
025090                                                                  02509013
025100     SET  PT-TRACK-IDX TO PT-CURR-ENTRIES.                        02510013
025110                                                                  02511013
025120     MOVE 'SUKCS782'           TO PT-PROGRAM(PT-TRACK-IDX).       02512099
025130     MOVE +1                   TO PT-INDEX-NBR(PT-TRACK-IDX).     02513013
025140     MOVE PT-CURR-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     02514013
025150     MOVE PV-CURR-TIMESTAMP    TO PT-TIMESTAMP(PT-TRACK-IDX).     02515013
025160     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      02516013
025170     MOVE SU054-DC-NUMBER      TO PT-DC(PT-TRACK-IDX).            02517013
025180     MOVE SU054-ACCM-LINE-NMBR TO PT-PNA-STA(PT-TRACK-IDX).       02518013
025190     MOVE PV-INIT-TIME-KEY     TO PT-START-HHMMSS(PT-TRACK-IDX).  02519013
025200                                                                  02520013
025210     IF  PS-LOG-MESSAGE                                           02521013
025220         INITIALIZE PV-CICS-MSG-AREA1                             02522013
025230         MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA1      02523013
025240         MOVE SPACES                    TO PV-CICS-MSG-AREA-A     02524013
025250         MOVE PV-CICS-MSG-AREA1         TO PV-CICS-MSG-AREA-A     02525013
025260         PERFORM 9999-WRITE-TO-CSSL                               02526013
025270     END-IF.                                                      02527013
025280                                                                  02528013
025290                                                                  02529013
025300 0205-WRITE-SUWS054-TO-CSSL.                                      02530013
025310                                                                  02531013
025320     INITIALIZE PV-CICS-MSG-AREA1                                 02532013
025330     INITIALIZE PV-CICS-MSG-AREA2                                 02533013
025340                                                                  02534013
025350     MOVE SQLCODE                  TO PV-DISP-SQLCODE             02535013
025360     MOVE SU054-DC-NUMBER          TO PV-DISP-DC                  02536013
025370     MOVE SU054-TRIP-ID            TO PV-DISP-TRIP                02537013
025380     MOVE SU054-ACCM-LINE-NMBR     TO PV-DISP-PNA-STA             02538013
025390     MOVE LBVRDA-DEST-OPER-UNT-ID  TO PV-DISP-DEST-OPER           02539013
025400                                                                  02540013
025410     STRING  ' SUKCS782 0205-'                                    02541099
025420             ' DC:'     PV-DISP-DC                                02542013
025430             ' B1:'     SU054-BAR-CODE-1                          02543013
025440             ' B2:'     SU054-BAR-CODE-2                          02544013
025450             ' B3:'     SU054-BAR-CODE-3                          02545013
025460                        DELIMITED BY SIZE                         02546013
025470                   INTO PV-CICS-MSG-AREA1                         02547013
025480                                                                  02548013
025490     MOVE SPACES             TO PV-CICS-MSG-AREA-A                02549013
025500     MOVE PV-CICS-MSG-AREA1  TO PV-CICS-MSG-AREA-A                02550013
025510                                                                  02551013
025520     PERFORM 9999-WRITE-TO-CSSL                                   02552013
025530                                                                  02553013
025540     STRING  ' SUKCS782 '                                         02554099
025550                        SU054-KOHLS-SML                           02555013
025560             ' DEST:'   PV-DISP-DEST-OPER                         02556013
025570             ' TRIP:'   PV-DISP-TRIP                              02557013
025580             ' DR:'     SU054-DOOR-NUMBER                         02558013
025590             ' USR:'    SU054-USER-ID                             02559013
025600             ' STA:'    PV-DISP-PNA-STA                           02560013
025610             ' SQL:'    PV-DISP-SQLCODE                           02561013
025620                        DELIMITED BY SIZE                         02562013
025630                   INTO PV-CICS-MSG-AREA2                         02563013
025640                                                                  02564013
025650     MOVE SPACES             TO PV-CICS-MSG-AREA-A                02565013
025660     MOVE PV-CICS-MSG-AREA2  TO PV-CICS-MSG-AREA-A                02566013
025670                                                                  02567013
025680     PERFORM 9999-WRITE-TO-CSSL.                                  02568013
025690                                                                  02569013
025691     MOVE SPACES TO  PV-CICS-MSG-AREA2                            02569197
025692                                                                  02569295
025693     STRING  ' SUKCS782 '                                         02569399
025694             ' BARCODE:' SU054-KOHLS-SML                          02569495
025695             ' THIN:'    SU054-THIN-SLICE-IND ' * '               02569597
025700                         DELIMITED BY SIZE                        02570095
025701                   INTO PV-CICS-MSG-AREA2                         02570195
025702                                                                  02570295
025703     MOVE SPACES             TO PV-CICS-MSG-AREA-A                02570395
025704     MOVE PV-CICS-MSG-AREA2  TO PV-CICS-MSG-AREA-A                02570495
025705                                                                  02570595
025706     PERFORM 9999-WRITE-TO-CSSL.                                  02570695
025707                                                                  02570795
025708                                                                  02570813
025710 0210-DUMP-TABLE-TO-CSSL.                                         02571013
025720                                                                  02572013
025730     INITIALIZE PV-CICS-MSG-AREA1                                 02573013
025740                                                                  02574013
025750     MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA1          02575013
025760                                                                  02576013
025770     MOVE SPACES             TO PV-CICS-MSG-AREA-A                02577013
025780     MOVE PV-CICS-MSG-AREA1  TO PV-CICS-MSG-AREA-A                02578013
025790                                                                  02579013
025800     PERFORM 9999-WRITE-TO-CSSL.                                  02580013
025810                                                                  02581013
025820                                                                  02582013
025830 0220-CLEAR-TABLE.                                                02583013
025840                                                                  02584013
025850     MOVE  SPACES  TO  PT-PROGRAM(PT-TRACK-IDX).                  02585013
025860     MOVE  ZEROES  TO  PT-INDEX-NBR(PT-TRACK-IDX).                02586013
025870     MOVE  SPACES  TO  PT-PARAGRAPH(PT-TRACK-IDX).                02587013
025880     MOVE  SPACES  TO  PT-TIMESTAMP(PT-TRACK-IDX).                02588013
025890     MOVE  ZEROES  TO  PT-DURATION(PT-TRACK-IDX).                 02589013
025900                                                                  02590013
025910                                                                  02591013
025920*---------------------------------------------------------------* 02592013
025930* check parm table (TKRPRPM) to check for logging to CSSL       * 02593013
025940*                                                               * 02594013
025950*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 02595013
025960*---------------------------------------------------------------* 02596013
025970 0400-CHECK-FOR-LOGGING.                                          02597013
025980*                                                                 02598013
025990** added internal table to track paragraph execution time         02599013
026000** dmh 2014-12-22 - begin                                         02600013
026010*                                                                 02601013
026020     MOVE  '0400'  TO  PT-CURR-PARA.                              02602013
026030     PERFORM 0202-BUILD-MESSAGE-DISPLAY.                          02603013
026040                                                                  02604013
026050*                                                                 02605013
026060** DMH 2014-12-22 - END                                           02606013
026070*                                                                 02607013
026080                                                                  02608013
026090     MOVE SU054-DC-NUMBER        TO DK-KRPRPM-LOC-ID              02609013
026100                                                                  02610013
026110     EXEC SQL                                                     02611013
026120          SELECT FUNC_TXT                                         02612013
026130          INTO  :KRPRPM-FUNC-TXT                                  02613013
026140          FROM   TKRPRPM                                          02614013
026150          WHERE  SYS_PRC_FUNC_CDE  = 'PACRTN'                     02615013
026160            AND  INTFC_SYS_CDE     = 'ACM'                        02616013
026170            AND  LOC_ID            = :DK-KRPRPM-LOC-ID            02617013
026180            AND  FUNC_TXT       LIKE 'Y%'                         02618013
026190           WITH UR                                                02619013
026200     END-EXEC.                                                    02620013
026210                                                                  02621013
026220     EVALUATE TRUE                                                02622013
026230         WHEN SQLCODE = ZERO                                      02623013
026240             MOVE KRPRPM-FUNC-TXT TO  PV-TKRPRPM-TEXT             02624013
026250             IF  PV-TKRPRPM-TEXT-Y-N  = 'Y'    and                02625013
026260                 PV-TKRPRPM-TEXT-ALL  = 'ALL'                     02626013
026270                 SET PS-LOG-MESSAGE  TO  TRUE                     02627013
026280             ELSE                                                 02628013
026290             IF  PV-TKRPRPM-TEXT-Y-N     = 'Y'    and             02629013
026300                 PV-TKRPRPM-TEXT-PNA-STA = SU054-ACCM-LINE-NMBR   02630013
026310                 SET PS-LOG-MESSAGE  TO  TRUE                     02631013
026320             ELSE                                                 02632013
026330                SET PS-NO-LOG-MESSAGE TO TRUE                     02633013
026340             END-IF                                               02634013
026350             END-IF                                               02635013
026360         WHEN SQLCODE = +100                                      02636013
026370             SET PS-NO-LOG-MESSAGE TO TRUE                        02637013
026380         WHEN SQLWARN0 NOT = SPACES                               02638013
026390         WHEN SQLCODE < ZERO                                      02639013
026400         WHEN SQLCODE > ZERO                                      02640013
026410                                                                  02641013
026420              INITIALIZE PV-CICS-MSG-AREA1                        02642013
026430              INITIALIZE PV-CICS-MSG-AREA2                        02643013
026440                                                                  02644013
026450              MOVE SQLCODE              TO PV-DISP-SQLCODE        02645013
026460              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             02646013
026470              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           02647013
026480              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        02648013
026490              MOVE LBVRDA-DEST-OPER-UNT-ID                        02649013
026500                                        TO PV-DISP-DEST-OPER      02650013
026510                                                                  02651013
026520              STRING  'SUKCS782 0400-'                            02652099
026530                      ' DC:'     PV-DISP-DC                       02653013
026540                      ' B1:'     SU054-BAR-CODE-1                 02654013
026550                      ' B2:'     SU054-BAR-CODE-2                 02655013
026560                      ' B3:'     SU054-BAR-CODE-3                 02656013
026570                                 DELIMITED BY SIZE                02657013
026580                            INTO PV-CICS-MSG-AREA1                02658013
026590                                                                  02659013
026600              MOVE SPACES     TO PV-CICS-MSG-AREA-A               02660013
026610              MOVE PV-CICS-MSG-AREA1                              02661013
026620                              TO PV-CICS-MSG-AREA-A               02662013
026630                                                                  02663013
026640              PERFORM 9999-WRITE-TO-CSSL                          02664013
026650                                                                  02665013
026660              STRING  'SUKCS782 '                                 02666099
026670                                 SU054-KOHLS-SML                  02667013
026680                      ' DEST:'   PV-DISP-DEST-OPER                02668013
026690                      ' TRIP:'   PV-DISP-TRIP                     02669013
026700                      ' DR:'     SU054-DOOR-NUMBER                02670013
026710                      ' USR:'    SU054-USER-ID                    02671013
026720                      ' STA:'    PV-DISP-PNA-STA                  02672013
026730                      ' SQL:'    PV-DISP-SQLCODE                  02673013
026740                      ' TKRPRPM-PACRTN'                           02674013
026750                                 DELIMITED BY SIZE                02675013
026760                            INTO PV-CICS-MSG-AREA2                02676013
026770                                                                  02677013
026780              MOVE SPACES     TO PV-CICS-MSG-AREA-A               02678013
026790              MOVE PV-CICS-MSG-AREA2                              02679013
026800                              TO PV-CICS-MSG-AREA-A               02680013
026810                                                                  02681013
026820              PERFORM 9999-WRITE-TO-CSSL                          02682013
026830                                                                  02683013
026840              SET PS-PROCESSING-ERROR-YES TO TRUE                 02684013
026850              PERFORM 9998-WRITE-TO-CSSL                          02685013
026860                                                                  02686013
026870     END-EVALUATE.                                                02687013
026880                                                                  02688013
026890                                                                  02689013
026900*---------------------------------------------------------------* 02690013
026910* check parm table (TKRPRPM) to check for logging to CSSL       * 02691013
026920* IF PROGRAM IS TAKING TOO LONG TO RESPOND.  THE VALUE WILL     * 02692013
026930* BE seconds AND WILL BE USED TO DETERMINE IF WE SHOULD WRITE   * 02693013
026940* pt-pARA-tRACKING TABLE TO CSSL                                * 02694013
026950* check parm table (TKRPRPM) to check if will be building the   * 02695013
026960* internal table during processing.  this will be used when     * 02696013
026970* dc's report long resonse times                                * 02697013
026980*  2014-12-22 - DMH - Added "WITH UR" to SQL                    * 02698013
026990*---------------------------------------------------------------* 02699013
027000 0410-CHECK-PARA-TRACK-sec.                                       02700013
027010*                                                                 02701013
027020** added internal table to track paragraph execution time         02702013
027030** dmh 2014-12-22 - begin                                         02703013
027040*                                                                 02704013
027050     MOVE  '0410'  TO  PT-CURR-PARA.                              02705013
027060     PERFORM 0202-BUILD-MESSAGE-DISPLAY.                          02706013
027070                                                                  02707013
027080*                                                                 02708013
027090** DMH 2014-12-22 - END                                           02709013
027100*                                                                 02710013
027110                                                                  02711013
027120     MOVE SU054-DC-NUMBER        TO DK-KRPRPM-LOC-ID              02712013
027130                                                                  02713013
027140     EXEC SQL                                                     02714013
027150          SELECT  FUNC_QTY                                        02715013
027160               ,  FUNC_txt                                        02716013
027170            INTO :PV-PARM-seconds                                 02717013
027180               ,  :PS-BLD-INTERNAL-TABLE-SW                       02718013
027190            FROM  TKRPRPM                                         02719013
027200           WHERE  SYS_PRC_FUNC_CDE  = 'PATIME'                    02720013
027210             AND  INTFC_SYS_CDE     = 'ACM'                       02721013
027220             AND  LOC_ID            = :DK-KRPRPM-LOC-ID           02722013
027230             AND  fUNC_BEG_TMST    <=  current timestamp          02723013
027240             AND  fUNC_END_TMST    >=  current timestamp          02724013
027250            WITH UR                                               02725013
027260     END-EXEC.                                                    02726013
027270                                                                  02727013
027280     EVALUATE TRUE                                                02728013
027290         WHEN SQLCODE = ZERO                                      02729013
027300              CONTINUE                                            02730013
027310         WHEN SQLCODE = +100                                      02731013
027320              MOVE 999999999  TO  PV-PARM-seconds                 02732013
027330         WHEN SQLWARN0 NOT = SPACES                               02733013
027340         WHEN SQLCODE < ZERO                                      02734013
027350         WHEN SQLCODE > ZERO                                      02735013
027360                                                                  02736013
027370              INITIALIZE PV-CICS-MSG-AREA1                        02737013
027380              INITIALIZE PV-CICS-MSG-AREA2                        02738013
027390                                                                  02739013
027400              MOVE SQLCODE              TO PV-DISP-SQLCODE        02740013
027410              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             02741013
027420              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           02742013
027430              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        02743013
027440              MOVE LBVRDA-DEST-OPER-UNT-ID                        02744013
027450                                        TO PV-DISP-DEST-OPER      02745013
027460                                                                  02746013
027470              STRING  'SUKCS782 0410-'                            02747099
027480                      ' DC:'     PV-DISP-DC                       02748013
027490                      ' B1:'     SU054-BAR-CODE-1                 02749013
027500                      ' B2:'     SU054-BAR-CODE-2                 02750013
027510                      ' B3:'     SU054-BAR-CODE-3                 02751013
027520                                 DELIMITED BY SIZE                02752013
027530                            INTO PV-CICS-MSG-AREA1                02753013
027540                                                                  02754013
027550              MOVE SPACES     TO PV-CICS-MSG-AREA-A               02755013
027560              MOVE PV-CICS-MSG-AREA1                              02756013
027570                              TO PV-CICS-MSG-AREA-A               02757013
027580                                                                  02758013
027590              PERFORM 9999-WRITE-TO-CSSL                          02759013
027600                                                                  02760013
027610              STRING  'SUKCS782 '                                 02761099
027620                                 SU054-KOHLS-SML                  02762013
027630                      ' DEST:'   PV-DISP-DEST-OPER                02763013
027640                      ' TRIP:'   PV-DISP-TRIP                     02764013
027650                      ' DR:'     SU054-DOOR-NUMBER                02765013
027660                      ' USR:'    SU054-USER-ID                    02766013
027670                      ' STA:'    PV-DISP-PNA-STA                  02767013
027680                      ' SQL:'    PV-DISP-SQLCODE                  02768013
027690                      ' TKRPRPM-PATIME'                           02769013
027700                                 DELIMITED BY SIZE                02770013
027710                            INTO PV-CICS-MSG-AREA2                02771013
027720                                                                  02772013
027730              MOVE SPACES     TO PV-CICS-MSG-AREA-A               02773013
027740              MOVE PV-CICS-MSG-AREA2                              02774013
027750                              TO PV-CICS-MSG-AREA-A               02775013
027760                                                                  02776013
027770              PERFORM 9999-WRITE-TO-CSSL                          02777013
027780                                                                  02778013
027790              SET PS-PROCESSING-ERROR-YES TO TRUE                 02779013
027800              PERFORM 9998-WRITE-TO-CSSL                          02780013
027810                                                                  02781013
027820     END-EVALUATE.                                                02782013
027830                                                                  02783013
027840     IF  PS-LOG-MESSAGE                                           02784013
027850         INITIALIZE PV-CICS-MSG-AREA1                             02785013
027860         MOVE PV-PARM-SECONDS  TO  PV-DISP-PARM-SECONDS           02786013
027870         STRING ' SUKCS782 0410 '                                 02787099
027880                ' PV-PARM-SECONDS:' PV-DISP-PARM-SECONDS          02788013
027890                ' PS-BLD-INTERNAL-TABLE-SW:'                      02789013
027900                                    PS-BLD-INTERNAL-TABLE-SW      02790013
027910                                           DELIMITED BY SIZE      02791013
027920                                      INTO PV-CICS-MSG-AREA1      02792013
027930         MOVE SPACES                    TO PV-CICS-MSG-AREA-A     02793013
027940         MOVE PV-CICS-MSG-AREA1         TO PV-CICS-MSG-AREA-A     02794013
027950         PERFORM 9999-WRITE-TO-CSSL                               02795013
027960     END-IF.                                                      02796013
027970                                                                  02797013
027980                                                                  02798013
027990*---------------------------------------------------------------* 02799013
028000* check if location is a DC (xLT_LOC)                           * 02800013
028010*                                                               * 02801013
028020*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 02802013
028030*---------------------------------------------------------------* 02803013
028040 0500-CHECK-IF-DC.                                                02804013
028050*                                                                 02805013
028060** added internal table to track paragraph execution time         02806013
028070** dmh 2014-12-22 - begin                                         02807013
028080*                                                                 02808013
028090     MOVE  '0500'  TO  PT-CURR-PARA.                              02809013
028100     IF  PS-BLD-INTERNAL-TABLE-YES                                02810013
028110         PERFORM 0200-INTERNAL-TABLE                              02811013
028120     ELSE                                                         02812013
028130         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       02813013
028140     END-IF.                                                      02814013
028150                                                                  02815013
028160*                                                                 02816013
028170** DMH 2014-12-22 - END                                           02817013
028180*                                                                 02818013
028190                                                                  02819013
028200     EXEC SQL                                                     02820013
028210          SELECT LOC_TYP_CDE                                      02821013
028220               , LOC_10_ABBR_NM                                   02822013
028230               , E_BUS_IND                                        02823013
028240          INTO  :XLT00010-LOC-TYP-CDE                             02824013
028250               ,:XLT00010-LOC-10-ABBR-NM                          02825013
028260               ,:XLT00010-E-BUS-IND                               02826013
028270          FROM   XLT_LOC                                          02827013
028280          WHERE  LOC_NBR   = :SHPUNT-DEST-OPER-UNT-ID             02828013
028290           WITH UR                                                02829013
028300     END-EXEC.                                                    02830013
028310                                                                  02831013
028320     EVALUATE TRUE                                                02832013
028330         WHEN SQLCODE = ZERO                                      02833013
028340            IF XLT00010-LOC-TYP-CDE = 'DC'                        02834013
028350              SET PS-OPER-IS-DC TO TRUE                           02835013
028360            ELSE                                                  02836013
028370               IF XLT00010-LOC-TYP-CDE = 'DS'                     02837013
028380                  IF XLT00010-E-BUS-IND = 'Y'                     02838013
028390                     SET PS-OPER-IS-ECOMM-STORE TO TRUE           02839013
028400                  ELSE                                            02840013
028410                     SET PS-OPER-IS-STORE TO TRUE                 02841013
028420                  END-IF                                          02842013
028430               END-IF                                             02843013
028440            END-IF                                                02844013
028450         WHEN SQLCODE = +100                                      02845013
028460             CONTINUE                                             02846013
028470         WHEN SQLWARN0 NOT = SPACES                               02847013
028480         WHEN SQLCODE NOT EQUAL ZERO                              02848013
028490                                                                  02849013
028500              INITIALIZE PV-CICS-MSG-AREA1                        02850013
028510              INITIALIZE PV-CICS-MSG-AREA2                        02851013
028520                                                                  02852013
028530              MOVE SQLCODE              TO PV-DISP-SQLCODE        02853013
028540              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             02854013
028550              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           02855013
028560              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        02856013
028570              MOVE LBVRDA-DEST-OPER-UNT-ID                        02857013
028580                                        TO PV-DISP-DEST-OPER      02858013
028590                                                                  02859013
028600              STRING  'SUKCS782 0500-'                            02860099
028610                      ' DC:'               PV-DISP-DC             02861013
028620                      ' B1:'               SU054-BAR-CODE-1       02862013
028630                      ' B2:'               SU054-BAR-CODE-2       02863013
028640                      ' B3:'               SU054-BAR-CODE-3       02864013
028650                                           DELIMITED BY SIZE      02865013
028660                                      INTO PV-CICS-MSG-AREA1      02866013
028670                                                                  02867013
028680              MOVE SPACES               TO PV-CICS-MSG-AREA-A     02868013
028690              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     02869013
028700                                                                  02870013
028710              PERFORM 9999-WRITE-TO-CSSL                          02871013
028720                                                                  02872013
028730              STRING  'SUKCS782 '         SU054-KOHLS-SML         02873099
028740                      ' DEST:'             PV-DISP-DEST-OPER      02874013
028750                      ' TRIP:'             PV-DISP-TRIP           02875013
028760                      ' DR:'               SU054-DOOR-NUMBER      02876013
028770                      ' USR:'              SU054-USER-ID          02877013
028780                      ' STA:'              PV-DISP-PNA-STA        02878013
028790                      ' SQL:'              PV-DISP-SQLCODE        02879013
028800                      ' XLT_LOC'           DELIMITED BY SIZE      02880013
028810                                      INTO PV-CICS-MSG-AREA2      02881013
028820                                                                  02882013
028830              MOVE SPACES               TO PV-CICS-MSG-AREA-A     02883013
028840              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     02884013
028850                                                                  02885013
028860              PERFORM 9999-WRITE-TO-CSSL                          02886013
028870                                                                  02887013
028880              INITIALIZE PV-CICS-MSG-AREA3                        02888013
028890              MOVE SHPUNT-SHIPT-UNT-ID  TO  PV-DISP-SSCC          02889013
028900              MOVE SHPUNT-ORGN-OPER-UNT-ID                        02890013
028910                                        TO  PV-DISP-ORIG-OPER     02891013
028920              MOVE SHPUNT-DEST-OPER-UNT-ID                        02892013
028930                                        TO  PV-DISP-DEST-OPER     02893013
028940                                                                  02894013
028950              STRING  'SUKCS782 '                                 02895099
028960                      ' SSCC:'             PV-DISP-SSCC           02896013
028970                      ' ORIG:'             PV-DISP-ORIG-OPER      02897013
028980                      ' DEST:'             PV-DISP-DEST-OPER      02898013
028990                                           DELIMITED BY SIZE      02899013
029000                                      INTO PV-CICS-MSG-AREA3      02900013
029010                                                                  02901013
029020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     02902013
029030              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     02903013
029040                                                                  02904013
029050              PERFORM 9999-WRITE-TO-CSSL                          02905013
029060                                                                  02906013
029070             SET PS-PROCESSING-ERROR-YES TO TRUE                  02907013
029080             PERFORM 9998-WRITE-TO-CSSL                           02908013
029090                                                                  02909013
029100     END-EVALUATE.                                                02910013
029110                                                                  02911013
029120                                                                  02912013
029130 1000-PROCESS-LABEL-REQUEST.                                      02913013
029140*                                                                 02914013
029150** added internal table to track paragraph execution time         02915013
029160** dmh 2014-12-22 - begin                                         02916013
029170*                                                                 02917013
029180     MOVE  '1000'  TO  PT-CURR-PARA.                              02918013
029190     IF  PS-BLD-INTERNAL-TABLE-YES                                02919013
029200         PERFORM 0200-INTERNAL-TABLE                              02920013
029210     ELSE                                                         02921013
029220         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       02922013
029230     END-IF.                                                      02923013
029240                                                                  02924013
029250*                                                                 02925013
029260** DMH 2014-12-22 - END                                           02926013
029270*                                                                 02927013
029280                                                                  02928013
029290     MOVE ZEROES      TO PV-SML-BRCDE-COUNTER.                    02929013
029300     IF SU054-BAR-CODE-1 > SPACES                                 02930013
029310        MOVE  SU054-BAR-CODE-1  TO PV-CTN-N                       02931013
029320        MOVE  PV-CTN-N          TO DK-128-BARCODE                 02932013
029330                                                                  02933013
029340        PERFORM 1100-CHECK-UCC128-VND-BRCDE                       02934013
029350        IF PV-128-BARCODE-COUNT > 0                               02935013
029360           SET PS-UCC128-VND-BRCD1-FOUND TO TRUE                  02936013
029370*                                                                 02937013
029380*** DMH 9/16/11 BEGIN                                             02938013
029390           MOVE  PV-CTN-N          TO  PV-VNDR-CTN                02939013
029400*** DMH 9/16/11 END                                               02940013
029410*                                                                 02941013
029420        ELSE                                                      02942013
029430           MOVE  SU054-BAR-CODE-1  TO DK-SML-BARCODE              02943013
029440           ADD +1    TO PV-SML-BRCDE-COUNTER                      02944013
029450           SET PS-UCC128-VND-BRCD1-NOT-FND TO TRUE                02945013
029460           PERFORM 1200-CHECK-KOHLS-SML-BRCDE                     02946013
029470           IF PV-SML-BARCODE-COUNT > 0                            02947013
029480              SET PS-KOHLS-SML-BRCD1-FOUND TO TRUE                02948013
029490           ELSE                                                   02949013
029500              SET PS-KOHLS-SML-BRCD1-NOT-FND TO TRUE              02950013
029510           END-IF                                                 02951013
029520        END-IF                                                    02952013
029530     END-IF                                                       02953013
029540                                                                  02954013
029550     IF SU054-BAR-CODE-2 > SPACES                                 02955013
029560        MOVE  SU054-BAR-CODE-2  TO PV-CTN-N                       02956013
029570        MOVE  PV-CTN-N          TO DK-128-BARCODE                 02957013
029580        PERFORM 1100-CHECK-UCC128-VND-BRCDE                       02958013
029590        IF PV-128-BARCODE-COUNT > 0                               02959013
029600           SET PS-UCC128-VND-BRCD2-FOUND TO TRUE                  02960013
029610*                                                                 02961013
029620*** DMH 9/16/11 BEGIN                                             02962013
029630           MOVE  PV-CTN-N          TO  PV-VNDR-CTN                02963013
029640*** DMH 9/16/11 END                                               02964013
029650*                                                                 02965013
029660        ELSE                                                      02966013
029670           MOVE  SU054-BAR-CODE-2  TO DK-SML-BARCODE              02967013
029680           ADD +1    TO PV-SML-BRCDE-COUNTER                      02968013
029690           SET PS-UCC128-VND-BRCD2-NOT-FND TO TRUE                02969013
029700           PERFORM 1200-CHECK-KOHLS-SML-BRCDE                     02970013
029710           IF PV-SML-BARCODE-COUNT > 0                            02971013
029720              SET PS-KOHLS-SML-BRCD2-FOUND TO TRUE                02972013
029730           ELSE                                                   02973013
029740              SET PS-KOHLS-SML-BRCD2-NOT-FND TO TRUE              02974013
029750           END-IF                                                 02975013
029760        END-IF                                                    02976013
029770     END-IF                                                       02977013
029780                                                                  02978013
029790     IF SU054-BAR-CODE-3 > SPACES                                 02979013
029800        MOVE  SU054-BAR-CODE-3  TO DK-SML-BARCODE                 02980013
029810        ADD +1    TO PV-SML-BRCDE-COUNTER                         02981013
029820        PERFORM 1200-CHECK-KOHLS-SML-BRCDE                        02982013
029830        IF PV-SML-BARCODE-COUNT > 0                               02983013
029840           SET PS-KOHLS-SML-BRCD3-FOUND TO TRUE                   02984013
029850        ELSE                                                      02985013
029860           SET PS-KOHLS-SML-BRCD3-NOT-FND TO TRUE                 02986013
029870        END-IF                                                    02987013
029880     END-IF.                                                      02988013
029890                                                                  02989013
029900                                                                  02990013
029910*---------------------------------------------------------------* 02991013
029920* check if UCC128 vendor barcode (TSHPUNT)                      * 02992013
029930*                                                               * 02993013
029940*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 02994013
029950*  2014-12-03 - DMH - Added "FETCH FIRST 1 ROW ONLY             * 02995013
029960*                     only checking for existence of            * 02996013
029970*---------------------------------------------------------------* 02997013
029980 1100-CHECK-UCC128-VND-BRCDE.                                     02998013
029990*                                                                 02999013
030000** added internal table to track paragraph execution time         03000013
030010** dmh 2014-12-22 - begin                                         03001013
030020*                                                                 03002013
030030     MOVE  '1100'  TO  PT-CURR-PARA.                              03003013
030040     IF  PS-BLD-INTERNAL-TABLE-YES                                03004013
030050         PERFORM 0200-INTERNAL-TABLE                              03005013
030060     ELSE                                                         03006013
030070         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03007013
030080     END-IF.                                                      03008013
030090                                                                  03009013
030100*                                                                 03010013
030110** DMH 2014-12-22 - END                                           03011013
030120*                                                                 03012013
030130                                                                  03013013
030140                                                                  03014013
030150     MOVE ZEROES TO PV-128-BARCODE-COUNT                          03015013
030160     EXEC SQL                                                     03016013
030170         SELECT COUNT(*)                                          03017013
030180         INTO   :PV-128-BARCODE-COUNT                             03018013
030190         FROM   TSHPUNT                                           03019013
030200         WHERE  SHIPT_UNT_ID      = :DK-128-BARCODE               03020013
030210          AND   SHIPT_UNT_SRC_ID  =  'ASN'                        03021013
030220         FETCH FIRST 1 ROW ONLY                                   03022013
030230          WITH UR                                                 03023013
030240     END-EXEC.                                                    03024013
030250                                                                  03025013
030260     EVALUATE TRUE                                                03026013
030270         WHEN SQLCODE = ZERO                                      03027013
030280             CONTINUE                                             03028013
030290         WHEN SQLWARN0 NOT = SPACES                               03029013
030300         WHEN SQLCODE NOT EQUAL ZERO                              03030013
030310                                                                  03031013
030320              INITIALIZE PV-CICS-MSG-AREA1                        03032013
030330              INITIALIZE PV-CICS-MSG-AREA2                        03033013
030340                                                                  03034013
030350              MOVE SQLCODE              TO PV-DISP-SQLCODE        03035013
030360              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03036013
030370              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03037013
030380              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03038013
030390              MOVE LBVRDA-DEST-OPER-UNT-ID                        03039013
030400                                        TO PV-DISP-DEST-OPER      03040013
030410                                                                  03041013
030420              STRING  'SUKCS782 1100-'                            03042099
030430                      ' DC:'               PV-DISP-DC             03043013
030440                      ' B1:'               SU054-BAR-CODE-1       03044013
030450                      ' B2:'               SU054-BAR-CODE-2       03045013
030460                      ' B3:'               SU054-BAR-CODE-3       03046013
030470                                           DELIMITED BY SIZE      03047013
030480                                      INTO PV-CICS-MSG-AREA1      03048013
030490                                                                  03049013
030500              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03050013
030510              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03051013
030520                                                                  03052013
030530              PERFORM 9999-WRITE-TO-CSSL                          03053013
030540                                                                  03054013
030550              STRING  'SUKCS782 '         SU054-KOHLS-SML         03055099
030560                      ' DEST:'             PV-DISP-DEST-OPER      03056013
030570                      ' TRIP:'             PV-DISP-TRIP           03057013
030580                      ' DR:'               SU054-DOOR-NUMBER      03058013
030590                      ' USR:'              SU054-USER-ID          03059013
030600                      ' STA:'              PV-DISP-PNA-STA        03060013
030610                      ' SQL:'              PV-DISP-SQLCODE        03061013
030620                      ' TSHPUNT'           DELIMITED BY SIZE      03062013
030630                                      INTO PV-CICS-MSG-AREA2      03063013
030640                                                                  03064013
030650              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03065013
030660              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03066013
030670                                                                  03067013
030680              PERFORM 9999-WRITE-TO-CSSL                          03068013
030690                                                                  03069013
030700              INITIALIZE PV-CICS-MSG-AREA3                        03070013
030710              MOVE DK-128-BARCODE      TO  PV-DISP-SSCC           03071013
030720                                                                  03072013
030730              STRING  'SUKCS782 '                                 03073099
030740                      ' SSCC:'             PV-DISP-SSCC           03074013
030750                                           DELIMITED BY SIZE      03075013
030760                                      INTO PV-CICS-MSG-AREA3      03076013
030770                                                                  03077013
030780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03078013
030790              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03079013
030800                                                                  03080013
030810              PERFORM 9999-WRITE-TO-CSSL                          03081013
030820                                                                  03082013
030830             SET PS-PROCESSING-ERROR-YES TO TRUE                  03083013
030840             PERFORM 9998-WRITE-TO-CSSL                           03084013
030850     END-EVALUATE.                                                03085013
030860                                                                  03086013
030870*---------------------------------------------------------------* 03087013
030880* check if KOHLS SML Barcode     (TSULBXF)                      * 03088013
030890*                                                               * 03089013
030900*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 03090013
030910*  2014-12-03 - DMH - Added "FETCH FIRST 1 ROW"                 * 03091013
030920*                     only checking for existence of            * 03092013
030930*---------------------------------------------------------------* 03093013
030940******************************************************************03094013
030950 1200-CHECK-KOHLS-SML-BRCDE.                                      03095013
030960******************************************************************03096013
030970                                                                  03097013
030980*                                                                 03098013
030990** added internal table to track paragraph execution time         03099013
031000** dmh 2014-12-22 - begin                                         03100013
031010*                                                                 03101013
031020     MOVE  '1200'  TO  PT-CURR-PARA.                              03102013
031030     IF  PS-BLD-INTERNAL-TABLE-YES                                03103013
031040         PERFORM 0200-INTERNAL-TABLE                              03104013
031050     ELSE                                                         03105013
031060         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03106013
031070     END-IF.                                                      03107013
031080                                                                  03108013
031090*                                                                 03109013
031100** DMH 2014-12-22 - END                                           03110013
031110*                                                                 03111013
031120                                                                  03112013
031130     MOVE ZEROES     TO PV-SML-BARCODE-COUNT.                     03113013
031140                                                                  03114013
031150     EXEC SQL                                                     03115013
031160         SELECT  COUNT(*)                                         03116013
031170         INTO   :PV-SML-BARCODE-COUNT                             03117013
031180         FROM   TSULBXF                                           03118013
031190         WHERE  BRCDE_NBR      = :DK-SML-BARCODE                  03119013
031200         FETCH FIRST 1 ROW ONLY                                   03120013
031210     END-EXEC.                                                    03121013
031220                                                                  03122013
031230     EVALUATE TRUE                                                03123013
031240         WHEN SQLCODE = ZERO                                      03124013
031250*TS 06/24/2010 BEG                                                03125013
031260              IF PV-SML-BARCODE-COUNT > 0                         03126013
031270                   CONTINUE                                       03127013
031280              ELSE                                                03128013
031290                   PERFORM 1205-SELECT-OTBND-CART                 03129013
031300              END-IF                                              03130013
031310*TS 06/24/2010 END                                                03131013
031320         WHEN SQLWARN0 NOT = SPACES                               03132013
031330         WHEN SQLCODE NOT EQUAL ZERO                              03133013
031340                                                                  03134013
031350              INITIALIZE PV-CICS-MSG-AREA1                        03135013
031360              INITIALIZE PV-CICS-MSG-AREA2                        03136013
031370                                                                  03137013
031380              MOVE SQLCODE              TO PV-DISP-SQLCODE        03138013
031390              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03139013
031400              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03140013
031410              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03141013
031420                                                                  03142013
031430              STRING  'SUKCS782 1200-'                            03143099
031440                      ' DC:'               PV-DISP-DC             03144013
031450                      ' B1:'               SU054-BAR-CODE-1       03145013
031460                      ' B2:'               SU054-BAR-CODE-2       03146013
031470                      ' B3:'               SU054-BAR-CODE-3       03147013
031480                                           DELIMITED BY SIZE      03148013
031490                                      INTO PV-CICS-MSG-AREA1      03149013
031500                                                                  03150013
031510              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03151013
031520              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03152013
031530                                                                  03153013
031540              PERFORM 9999-WRITE-TO-CSSL                          03154013
031550                                                                  03155013
031560              STRING  'SUKCS782 '         SU054-KOHLS-SML         03156099
031570                      ' TRIP:'             PV-DISP-TRIP           03157013
031580                      ' DR:'               SU054-DOOR-NUMBER      03158013
031590                      ' USR:'              SU054-USER-ID          03159013
031600                      ' STA:'              PV-DISP-PNA-STA        03160013
031610                      ' SQL:'              PV-DISP-SQLCODE        03161013
031620                      ' TSULBXF'           DELIMITED BY SIZE      03162013
031630                                      INTO PV-CICS-MSG-AREA2      03163013
031640                                                                  03164013
031650              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03165013
031660              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03166013
031670                                                                  03167013
031680              PERFORM 9999-WRITE-TO-CSSL                          03168013
031690                                                                  03169013
031700              INITIALIZE PV-CICS-MSG-AREA3                        03170013
031710              MOVE DK-SML-BARCODE      TO  PV-DISP-SSCC           03171013
031720                                                                  03172013
031730              STRING  'SUKCS782 '                                 03173099
031740                      ' SSCC:'             PV-DISP-SSCC           03174013
031750                                           DELIMITED BY SIZE      03175013
031760                                      INTO PV-CICS-MSG-AREA3      03176013
031770                                                                  03177013
031780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03178013
031790              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03179013
031800                                                                  03180013
031810              PERFORM 9999-WRITE-TO-CSSL                          03181013
031820                                                                  03182013
031830             SET PS-PROCESSING-ERROR-YES  TO TRUE                 03183013
031840             PERFORM 9998-WRITE-TO-CSSL                           03184013
031850     END-EVALUATE.                                                03185013
031860                                                                  03186013
031870*TS 06/24/2010 BEG                                                03187013
031880******************************************************************03188013
031890 1205-SELECT-OTBND-CART.                                          03189013
031900******************************************************************03190013
031910*                                                                 03191013
031920** added internal table to track paragraph execution time         03192013
031930** dmh 2014-12-22 - begin                                         03193013
031940*                                                                 03194013
031950     MOVE  '1205'  TO  PT-CURR-PARA.                              03195013
031960     IF  PS-BLD-INTERNAL-TABLE-YES                                03196013
031970         PERFORM 0200-INTERNAL-TABLE                              03197013
031980     ELSE                                                         03198013
031990         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03199013
032000     END-IF.                                                      03200013
032010                                                                  03201013
032020*                                                                 03202013
032030** DMH 2014-12-22 - END                                           03203013
032040*                                                                 03204013
032050                                                                  03205013
032060     EXEC SQL                                                     03206013
032070         SELECT CART_SRC_CDE                                      03207013
032080          INTO :SUT00024-CART-SRC-CDE                             03208013
032090          FROM SUT_OTBND_CART                                     03209013
032100          WHERE SHIPT_UNT_ID = :DK-128-BARCODE                    03210013
032110                AND ACTV_IND = 'Y'                                03211013
032120          WITH UR                                                 03212013
032130     END-EXEC.                                                    03213013
032140                                                                  03214013
032150     EVALUATE TRUE                                                03215013
032160         WHEN SQLCODE = +0                                        03216013
032170             IF SUT00024-CART-SRC-CDE = 'RDM'                     03217013
032180                SET PS-WHSE-OTBND-CART-YES TO TRUE                03218013
032190             ELSE                                                 03219013
032200                SET PS-WHSE-OTBND-CART-NO  TO TRUE                03220013
032210             END-IF                                               03221013
032220         WHEN SQLCODE = +100                                      03222013
032230             SET PS-WHSE-OTBND-CART-NO  TO TRUE                   03223013
032240         WHEN SQLWARN0 NOT = SPACES                               03224013
032250         WHEN SQLCODE NOT EQUAL ZERO                              03225013
032260                                                                  03226013
032270              INITIALIZE PV-CICS-MSG-AREA1                        03227013
032280              INITIALIZE PV-CICS-MSG-AREA2                        03228013
032290                                                                  03229013
032300              MOVE SQLCODE              TO PV-DISP-SQLCODE        03230013
032310              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03231013
032320              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03232013
032330              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03233013
032340                                                                  03234013
032350              STRING  'SUKCS782 1205-'                            03235099
032360                      ' DC:'               PV-DISP-DC             03236013
032370                      ' B1:'               SU054-BAR-CODE-1       03237013
032380                      ' B2:'               SU054-BAR-CODE-2       03238013
032390                      ' B3:'               SU054-BAR-CODE-3       03239013
032400                                           DELIMITED BY SIZE      03240013
032410                                      INTO PV-CICS-MSG-AREA1      03241013
032420                                                                  03242013
032430              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03243013
032440              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03244013
032450                                                                  03245013
032460              PERFORM 9999-WRITE-TO-CSSL                          03246013
032470                                                                  03247013
032480              STRING  'SUKCS782 '         SU054-KOHLS-SML         03248099
032490                      ' TRIP:'             PV-DISP-TRIP           03249013
032500                      ' DR:'               SU054-DOOR-NUMBER      03250013
032510                      ' USR:'              SU054-USER-ID          03251013
032520                      ' STA:'              PV-DISP-PNA-STA        03252013
032530                      ' SQL:'              PV-DISP-SQLCODE        03253013
032540                      ' SUT_OTBND_CART'    DELIMITED BY SIZE      03254013
032550                                      INTO PV-CICS-MSG-AREA2      03255013
032560                                                                  03256013
032570              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03257013
032580              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03258013
032590                                                                  03259013
032600              PERFORM 9999-WRITE-TO-CSSL                          03260013
032610                                                                  03261013
032620              INITIALIZE PV-CICS-MSG-AREA3                        03262013
032630              MOVE DK-128-BARCODE      TO  PV-DISP-SSCC           03263013
032640                                                                  03264013
032650              STRING  'SUKCS782 '                                 03265099
032660                      ' SSCC:'             PV-DISP-SSCC           03266013
032670                                           DELIMITED BY SIZE      03267013
032680                                      INTO PV-CICS-MSG-AREA3      03268013
032690                                                                  03269013
032700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03270013
032710              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03271013
032720                                                                  03272013
032730              PERFORM 9999-WRITE-TO-CSSL                          03273013
032740                                                                  03274013
032750             SET PS-PROCESSING-ERROR-YES TO TRUE                  03275013
032760             PERFORM 9998-WRITE-TO-CSSL                           03276013
032770     END-EVALUATE.                                                03277013
032780                                                                  03278013
032790******************************************************************03279013
032800 7644-SELECT-OTBND-LOC.                                           03280013
032810******************************************************************03281013
032820*                                                                 03282013
032830** added internal table to track paragraph execution time         03283013
032840** dmh 2014-12-22 - begin                                         03284013
032850*                                                                 03285013
032860     MOVE  '7644'  TO  PT-CURR-PARA.                              03286013
032870     IF  PS-BLD-INTERNAL-TABLE-YES                                03287013
032880         PERFORM 0200-INTERNAL-TABLE                              03288013
032890     ELSE                                                         03289013
032900         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03290013
032910     END-IF.                                                      03291013
032920                                                                  03292013
032930*                                                                 03293013
032940** DMH 2014-12-22 - END                                           03294013
032950*                                                                 03295013
032960                                                                  03296013
032970     INITIALIZE PV-WHSE-CART-EXIST.                               03297013
032980                                                                  03298013
032990     EXEC SQL                                                     03299013
033000         SELECT 'Y'                                               03300013
033010          INTO :PV-WHSE-CART-EXIST                                03301013
033020          FROM SUT_OTBND_LOC A                                    03302013
033030          WHERE A.SHIPT_UNT_ID = :DK-CTN                          03303013
033040            AND A.SCN_CDE      = 'RECV'                           03304013
033050          WITH UR                                                 03305013
033060     END-EXEC.                                                    03306013
033070                                                                  03307013
033080     EVALUATE TRUE                                                03308013
033090         WHEN SQLCODE = +0                                        03309013
033100              SET PS-OTBND-LOC-ENTRY-EXIST TO TRUE                03310013
033110         WHEN SQLCODE = +100                                      03311013
033120              SET PS-OTBND-LOC-ENTRY-NOT-EXIST TO TRUE            03312013
033130         WHEN SQLWARN0 NOT = SPACES                               03313013
033140         WHEN SQLCODE NOT EQUAL ZERO                              03314013
033150                                                                  03315013
033160              INITIALIZE PV-CICS-MSG-AREA1                        03316013
033170              INITIALIZE PV-CICS-MSG-AREA2                        03317013
033180                                                                  03318013
033190              MOVE SQLCODE              TO PV-DISP-SQLCODE        03319013
033200              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03320013
033210              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03321013
033220              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03322013
033230                                                                  03323013
033240              STRING  'SUKCS782 7644-'                            03324099
033250                      ' DC:'               PV-DISP-DC             03325013
033260                      ' B1:'               SU054-BAR-CODE-1       03326013
033270                      ' B2:'               SU054-BAR-CODE-2       03327013
033280                      ' B3:'               SU054-BAR-CODE-3       03328013
033290                                           DELIMITED BY SIZE      03329013
033300                                      INTO PV-CICS-MSG-AREA1      03330013
033310                                                                  03331013
033320              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03332013
033330              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03333013
033340                                                                  03334013
033350              PERFORM 9999-WRITE-TO-CSSL                          03335013
033360                                                                  03336013
033370              STRING  'SUKCS782 '         SU054-KOHLS-SML         03337099
033380                      ' TRIP:'             PV-DISP-TRIP           03338013
033390                      ' DR:'               SU054-DOOR-NUMBER      03339013
033400                      ' USR:'              SU054-USER-ID          03340013
033410                      ' STA:'              PV-DISP-PNA-STA        03341013
033420                      ' SQL:'              PV-DISP-SQLCODE        03342013
033430                      ' SUT_OTBND_LOC'     DELIMITED BY SIZE      03343013
033440                                      INTO PV-CICS-MSG-AREA2      03344013
033450                                                                  03345013
033460              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03346013
033470              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03347013
033480                                                                  03348013
033490              PERFORM 9999-WRITE-TO-CSSL                          03349013
033500                                                                  03350013
033510              INITIALIZE PV-CICS-MSG-AREA3                        03351013
033520              MOVE DK-CTN              TO  PV-DISP-SSCC           03352013
033530                                                                  03353013
033540              STRING  'SUKCS782 '                                 03354099
033550                      ' SSCC:'             PV-DISP-SSCC           03355013
033560                                           DELIMITED BY SIZE      03356013
033570                                      INTO PV-CICS-MSG-AREA3      03357013
033580                                                                  03358013
033590              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03359013
033600              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03360013
033610                                                                  03361013
033620              PERFORM 9999-WRITE-TO-CSSL                          03362013
033630                                                                  03363013
033640             SET PS-PROCESSING-ERROR-YES TO TRUE                  03364013
033650             PERFORM 9998-WRITE-TO-CSSL                           03365013
033660     END-EVALUATE.                                                03366013
033670                                                                  03367013
033680                                                                  03368013
033690*---------------------------------------------------------------* 03369013
033700* select outbound carton contents    (SUT_OTBND_upc)            * 03370013
033710*                                                               * 03371013
033720*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 03372013
033730*---------------------------------------------------------------* 03373013
033740 2256-SELECT-OTBND-UPC.                                           03374013
033750*                                                                 03375013
033760** added internal table to track paragraph execution time         03376013
033770** dmh 2014-12-22 - begin                                         03377013
033780*                                                                 03378013
033790     MOVE  '2256'  TO  PT-CURR-PARA.                              03379013
033800     IF  PS-BLD-INTERNAL-TABLE-YES                                03380013
033810         PERFORM 0200-INTERNAL-TABLE                              03381013
033820     ELSE                                                         03382013
033830         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03383013
033840     END-IF.                                                      03384013
033850                                                                  03385013
033860*                                                                 03386013
033870** DMH 2014-12-22 - END                                           03387013
033880*                                                                 03388013
033890                                                                  03389013
033900     EXEC SQL                                                     03390013
033910         SELECT DISTINCT                                          03391013
033920                B.TRN_NBR                                         03392013
033930              , B.TRN_LNE_NBR                                     03393013
033940              , A.DEST_LOC_NBR                                    03394013
033950         INTO   :SUT00028-TRN-NBR                                 03395013
033960              , :SUT00028-TRN-LNE-NBR                             03396013
033970              , :SUT00024-DEST-LOC-NBR                            03397013
033980         FROM   SUT_OTBND_UPC B                                   03398013
033990             ,  SUT_OTBND_CART A                                  03399013
034000         WHERE  A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                 03400013
034010           AND  A.SHIPT_UNT_ID   = :DK-CTN                        03401013
034020     END-EXEC.                                                    03402013
034030                                                                  03403013
034040     EVALUATE TRUE                                                03404013
034050         WHEN SQLCODE = ZERO                                      03405013
034060             MOVE SUT00028-TRN-NBR   TO PV-PO-NBR                 03406013
034070                                        PV-DISPLAY-PO             03407013
034080             MOVE SUT00028-TRN-LNE-NBR TO                         03408013
034090                                        PV-PO-LINE-N              03409013
034100                                        DK-PO-LNE-NBR             03410013
034110                                        PV-DISP-line              03411013
034120             MOVE SUT00024-DEST-LOC-NBR  TO PV-STORE-N            03412013
034130                                            PV-DEST-STORE         03413013
034140         WHEN SQLCODE = -811                                      03414013
034150             MOVE SUT00028-TRN-NBR   TO PV-PO-NBR                 03415013
034160             SET  PS-MULTI-LINE      TO TRUE                      03416013
034170             MOVE SUT00024-DEST-LOC-NBR  TO PV-STORE-N            03417013
034180                                            PV-DEST-STORE         03418013
034190         WHEN SQLCODE = +100                                      03419013
034200             SET  PS-NO-LINE              TO  TRUE                03420013
034210         WHEN SQLWARN0 NOT = SPACES                               03421013
034220         WHEN SQLCODE NOT EQUAL ZERO                              03422013
034230                                                                  03423013
034240              INITIALIZE PV-CICS-MSG-AREA1                        03424013
034250              INITIALIZE PV-CICS-MSG-AREA2                        03425013
034260                                                                  03426013
034270              MOVE SQLCODE              TO PV-DISP-SQLCODE        03427013
034280              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03428013
034290              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03429013
034300              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03430013
034310                                                                  03431013
034320              STRING  'SUKCS782 2256-'                            03432099
034330                      ' DC:'               PV-DISP-DC             03433013
034340                      ' B1:'               SU054-BAR-CODE-1       03434013
034350                      ' B2:'               SU054-BAR-CODE-2       03435013
034360                      ' B3:'               SU054-BAR-CODE-3       03436013
034370                                           DELIMITED BY SIZE      03437013
034380                                      INTO PV-CICS-MSG-AREA1      03438013
034390                                                                  03439013
034400              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03440013
034410              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03441013
034420                                                                  03442013
034430              PERFORM 9999-WRITE-TO-CSSL                          03443013
034440                                                                  03444013
034450              STRING  'SUKCS782 '          SU054-KOHLS-SML        03445099
034460                      ' TRIP:'             PV-DISP-TRIP           03446013
034470                      ' DR:'               SU054-DOOR-NUMBER      03447013
034480                      ' USR:'              SU054-USER-ID          03448013
034490                      ' STA:'              PV-DISP-PNA-STA        03449013
034500                      ' SQL:'              PV-DISP-SQLCODE        03450013
034510                      ' SUT_OTBND_UPC/CART'                       03451013
034520                                           DELIMITED BY SIZE      03452013
034530                                      INTO PV-CICS-MSG-AREA2      03453013
034540                                                                  03454013
034550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03455013
034560              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03456013
034570                                                                  03457013
034580              PERFORM 9999-WRITE-TO-CSSL                          03458013
034590                                                                  03459013
034600              INITIALIZE PV-CICS-MSG-AREA3                        03460013
034610              MOVE DK-CTN              TO  PV-DISP-SSCC           03461013
034620                                                                  03462013
034630              STRING  'SUKCS782 '                                 03463099
034640                      ' SSCC:'             PV-DISP-SSCC           03464013
034650                                           DELIMITED BY SIZE      03465013
034660                                      INTO PV-CICS-MSG-AREA3      03466013
034670                                                                  03467013
034680              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03468013
034690              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03469013
034700                                                                  03470013
034710              PERFORM 9999-WRITE-TO-CSSL                          03471013
034720                                                                  03472013
034730             SET PS-PROCESSING-ERROR-YES TO TRUE                  03473013
034740             PERFORM 9998-WRITE-TO-CSSL                           03474013
034750     END-EVALUATE.                                                03475013
034760                                                                  03476013
034770                                                                  03477013
034780*---------------------------------------------------------------* 03478013
034790* select SCAC/TRAILER for inbound trip (TVHTRIP)                * 03479013
034800*                                                               * 03480013
034810*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 03481013
034820*---------------------------------------------------------------* 03482013
034830 2257-SELECT-TVHTRIP.                                             03483013
034840*                                                                 03484013
034850** added internal table to track paragraph execution time         03485013
034860** dmh 2014-12-22 - begin                                         03486013
034870*                                                                 03487013
034880     MOVE  '2257'  TO  PT-CURR-PARA.                              03488013
034890     IF  PS-BLD-INTERNAL-TABLE-YES                                03489013
034900         PERFORM 0200-INTERNAL-TABLE                              03490013
034910     ELSE                                                         03491013
034920         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03492013
034930     END-IF.                                                      03493013
034940                                                                  03494013
034950*                                                                 03495013
034960** DMH 2014-12-22 - END                                           03496013
034970*                                                                 03497013
034980                                                                  03498013
034990     INITIALIZE VHTRIP-OWNER-SCAC-ID                              03499013
035000                VHTRIP-VEH-NBR                                    03500013
035010                DK-TRIP-ID.                                       03501013
035020                                                                  03502013
035030                                                                  03503013
035040     MOVE SU054-TRIP-ID TO DK-TRIP-ID.                            03504013
035050                                                                  03505013
035060     EXEC SQL                                                     03506013
035070      SELECT OWNER_SCAC_ID                                        03507013
035080           , VEH_NBR                                              03508013
035090        INTO :VHTRIP-OWNER-SCAC-ID                                03509013
035100           , :VHTRIP-VEH-NBR                                      03510013
035110      FROM   TVHTRIP                                              03511013
035120      WHERE  TRIP_ID        = :DK-TRIP-ID                         03512013
035130       WITH UR                                                    03513013
035140     END-EXEC.                                                    03514013
035150                                                                  03515013
035160     EVALUATE TRUE                                                03516013
035170         WHEN SQLCODE = ZERO                                      03517013
035180              CONTINUE                                            03518013
035190         WHEN SQLWARN0 NOT = SPACES                               03519013
035200         WHEN SQLCODE NOT EQUAL ZERO                              03520013
035210                                                                  03521013
035220              INITIALIZE PV-CICS-MSG-AREA1                        03522013
035230              INITIALIZE PV-CICS-MSG-AREA2                        03523013
035240                                                                  03524013
035250              MOVE SQLCODE              TO PV-DISP-SQLCODE        03525013
035260              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03526013
035270              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03527013
035280              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03528013
035290                                                                  03529013
035300              STRING  'SUKCS782 2257-'                            03530099
035310                      ' DC:'               PV-DISP-DC             03531013
035320                      ' B1:'               SU054-BAR-CODE-1       03532013
035330                      ' B2:'               SU054-BAR-CODE-2       03533013
035340                      ' B3:'               SU054-BAR-CODE-3       03534013
035350                                           DELIMITED BY SIZE      03535013
035360                                      INTO PV-CICS-MSG-AREA1      03536013
035370                                                                  03537013
035380              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03538013
035390              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03539013
035400                                                                  03540013
035410              PERFORM 9999-WRITE-TO-CSSL                          03541013
035420                                                                  03542013
035430              STRING  'SUKCS782 '          SU054-KOHLS-SML        03543099
035440                      ' TRIP:'             PV-DISP-TRIP           03544013
035450                      ' DR:'               SU054-DOOR-NUMBER      03545013
035460                      ' USR:'              SU054-USER-ID          03546013
035470                      ' STA:'              PV-DISP-PNA-STA        03547013
035480                      ' SQL:'              PV-DISP-SQLCODE        03548013
035490                      ' TVHTRIP'                                  03549013
035500                                           DELIMITED BY SIZE      03550013
035510                                      INTO PV-CICS-MSG-AREA2      03551013
035520                                                                  03552013
035530              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03553013
035540              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03554013
035550                                                                  03555013
035560              PERFORM 9999-WRITE-TO-CSSL                          03556013
035570                                                                  03557013
035580              INITIALIZE PV-CICS-MSG-AREA3                        03558013
035590              MOVE DK-TRIP-ID           TO PV-DISP-TRIP           03559013
035600                                                                  03560013
035610              STRING  'SUKCS782 '                                 03561099
035620                      ' TRIP:'             PV-DISP-TRIP           03562013
035630                                           DELIMITED BY SIZE      03563013
035640                                      INTO PV-CICS-MSG-AREA3      03564013
035650                                                                  03565013
035660              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03566013
035670              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03567013
035680                                                                  03568013
035690              PERFORM 9999-WRITE-TO-CSSL                          03569013
035700                                                                  03570013
035710             SET PS-PROCESSING-ERROR-YES TO TRUE                  03571013
035720             PERFORM 9998-WRITE-TO-CSSL                           03572013
035730     END-EVALUATE.                                                03573013
035740                                                                  03574013
035750*TS 06/24/2010 END                                                03575013
035760*                                                                 03576013
035770* EA 07/08/2010                                                  *03577013
035780 7646-CALL-UNT-WKD-MODULE.                                        03578013
035790*                                                                 03579013
035800** added internal table to track paragraph execution time         03580013
035810** dmh 2014-12-22 - begin                                         03581013
035820*                                                                 03582013
035830     MOVE  '7646'  TO  PT-CURR-PARA.                              03583013
035840     IF  PS-BLD-INTERNAL-TABLE-YES                                03584013
035850         PERFORM 0200-INTERNAL-TABLE                              03585013
035860     ELSE                                                         03586013
035870         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03587013
035880     END-IF.                                                      03588013
035890                                                                  03589013
035900*                                                                 03590013
035910** DMH 2014-12-22 - END                                           03591013
035920*                                                                 03592013
035930                                                                  03593013
035940     INITIALIZE PC260-COMM-AREA.                                  03594013
035950     MOVE PV-CTN-N                    TO PC260-SHIPT-UNT-ID.      03595013
035960     MOVE SU054-DC-NUMBER             TO PC260-OPER-UNT-ID.       03596013
035970     MOVE 'REPLEN'                    TO PC260-PRCG-AREA-CDE.     03597013
035980     SET PC260-TRANS-LINE-VERIFY      TO TRUE.                    03598013
035990     SET PC260-MOD-SUCCESSFUL         TO TRUE.                    03599013
036000                                                                  03600013
036010*    CALL PC260-VSM-PGM USING PC260-COMM-AREA.                    03601013
036020*    CALL 'PCKUT790' USING PC260-COMM-AREA.                       03602013
036030                                                                  03603013
036040     CALL PC260-VSM-PGM USING  DFHEIBLK                           03604013
036050                               PC260-COMMAREA                     03605013
036060                               PC260-COMM-AREA.                   03606013
036070     EVALUATE TRUE                                                03607013
036080         WHEN PC260-MOD-SUCCESSFUL                                03608013
036090              CONTINUE                                            03609013
036100         WHEN OTHER                                               03610013
036110                                                                  03611013
036120              INITIALIZE PV-CICS-MSG-AREA1                        03612013
036130              INITIALIZE PV-CICS-MSG-AREA2                        03613013
036140                                                                  03614013
036150              MOVE PC260-BAD-SQL-CDE    TO PV-DISP-SQLCODE        03615013
036160              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03616013
036170              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03617013
036180              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03618013
036190                                                                  03619013
036200              STRING  'SUKCS782 7646-'                            03620099
036210                      ' DC:'               PV-DISP-DC             03621013
036220                      ' B1:'               SU054-BAR-CODE-1       03622013
036230                      ' B2:'               SU054-BAR-CODE-2       03623013
036240                      ' B3:'               SU054-BAR-CODE-3       03624013
036250                                           DELIMITED BY SIZE      03625013
036260                                      INTO PV-CICS-MSG-AREA1      03626013
036270                                                                  03627013
036280              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03628013
036290              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03629013
036300                                                                  03630013
036310              PERFORM 9999-WRITE-TO-CSSL                          03631013
036320                                                                  03632013
036330              STRING  'SUKCS782 '          SU054-KOHLS-SML        03633099
036340                      ' TRIP:'             PV-DISP-TRIP           03634013
036350                      ' DR:'               SU054-DOOR-NUMBER      03635013
036360                      ' USR:'              SU054-USER-ID          03636013
036370                      ' STA:'              PV-DISP-PNA-STA        03637013
036380                      ' SQL:'              PV-DISP-SQLCODE        03638013
036390                      ' PCKUT970'                                 03639013
036400                                           DELIMITED BY SIZE      03640013
036410                                      INTO PV-CICS-MSG-AREA2      03641013
036420                                                                  03642013
036430              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03643013
036440              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03644013
036450                                                                  03645013
036460              PERFORM 9999-WRITE-TO-CSSL                          03646013
036470                                                                  03647013
036480              INITIALIZE PV-CICS-MSG-AREA3                        03648013
036490              MOVE PV-CTN-N             TO PV-DISP-sscc           03649013
036500                                                                  03650013
036510              STRING  'SUKCS782 '                                 03651099
036520                      ' CRTN:'             PV-DISP-sscc           03652013
036530                      ' PARA:'             PC260-PARAGRAPH        03653013
036540                      ' DB:'               PC260-BAD-TABLE-NAME   03654013
036550                      ' FUNC:'         PC260-BAD-TABLE-FUNCTION   03655013
036560                                           DELIMITED BY SIZE      03656013
036570                                      INTO PV-CICS-MSG-AREA3      03657013
036580                                                                  03658013
036590              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03659013
036600              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03660013
036610                                                                  03661013
036620              PERFORM 9999-WRITE-TO-CSSL                          03662013
036630                                                                  03663013
036640              INITIALIZE PV-CICS-MSG-AREA4                        03664013
036650                                                                  03665013
036660              STRING  'SUKCS782 '                                 03666099
036670                      ' TEXT:'             PC260-MESSAGE-TEXT     03667013
036680                                           DELIMITED BY SIZE      03668013
036690                                      INTO PV-CICS-MSG-AREA4      03669013
036700                                                                  03670013
036710              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03671013
036720              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     03672013
036730                                                                  03673013
036740              PERFORM 9999-WRITE-TO-CSSL                          03674013
036750                                                                  03675013
036760              SET PS-PROCESSING-ERROR-YES TO TRUE                 03676013
036770              PERFORM 9998-WRITE-TO-CSSL                          03677013
036780     END-EVALUATE.                                                03678013
036790*                                                                 03679013
036800* EA 07/08/2010                                                  *03680013
036810                                                                  03681013
036820 1300-VALDTE-LBL-COMBINATIONS.                                    03682013
036830*                                                                 03683013
036840** added internal table to track paragraph execution time         03684013
036850** dmh 2014-12-22 - begin                                         03685013
036860*                                                                 03686013
036870     MOVE  '1300'  TO  PT-CURR-PARA.                              03687013
036880     IF  PS-BLD-INTERNAL-TABLE-YES                                03688013
036890         PERFORM 0200-INTERNAL-TABLE                              03689013
036900     ELSE                                                         03690013
036910         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       03691013
036920     END-IF.                                                      03692013
036930                                                                  03693013
036940*                                                                 03694013
036950** DMH 2014-12-22 - END                                           03695013
036960*                                                                 03696013
036970                                                                  03697013
036980     SET  PS-SML-UCC128-MATCH  TO  TRUE                           03698013
036990                                                                  03699013
037000** WHEN MULTIPLE KOHLS BARCODES EXIST ON THE CARTON (SML/P2L)     03700013
037010** SET ERROR TO PRINT MESSAGE LABEL                               03701013
037020      IF PV-SML-BRCDE-COUNTER > +1                                03702013
037030         SET PS-BRCDE-ERROR-FND   TO TRUE                         03703013
037040         IF PS-KOHLS-SML-BRCD1-FOUND                              03704013
037050            MOVE SU054-BAR-CODE-1 TO DK-SML-BARCODE               03705013
037060         ELSE                                                     03706013
037070            MOVE SU054-BAR-CODE-2 TO DK-SML-BARCODE               03707013
037080         END-IF                                                   03708013
037090         PERFORM 1351-SELECT-UCC128-BRCDE-MLT                     03709013
037100         MOVE SULBXF-SHIPT-UNT-ID    TO PV-CTN-N                  03710013
037110      ELSE                                                        03711013
037120*TS 06/24/2010 BEG                                                03712013
037130         IF PS-WHSE-OTBND-CART-NO                                 03713013
037140*TS 06/24/2010 END                                                03714013
037150          IF PS-UCC128-VND-BRCD1-FOUND                            03715013
037160             MOVE SU054-BAR-CODE-1 TO PV-CTN-N                    03716013
037170* VND BRCDE SCANNED, CHECKED FOR VALID SML OR P2L LABEL           03717013
037180* WHEN FOUND, SET PS-VALID-SML-BRCDE-YES IN WHICH CASE THE LABEL  03718013
037190* WILL NOT BE REPRINTED                                           03719013
037200             EVALUATE TRUE                                        03720013
037210               WHEN  PS-KOHLS-SML-BRCD1-FOUND                     03721013
037220                 MOVE SU054-BAR-CODE-1 TO DK-SML-BARCODE          03722013
037230                 PERFORM 1350-SELECT-UCC128-BRCDE                 03723013
037240*                                                                 03724013
037250*** DMH 9/16/11 - BEGIN                                           03725013
037260                 IF PS-LOG-MESSAGE                                03726013
037270                                                                  03727013
037280              INITIALIZE PV-CICS-MSG-AREA1                        03728013
037290              INITIALIZE PV-CICS-MSG-AREA2                        03729013
037300                                                                  03730013
037310              MOVE SQLCODE              TO PV-DISP-SQLCODE        03731013
037320              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03732013
037330              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03733013
037340              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03734013
037350                                                                  03735013
037360              STRING  'SUKCS782 1300-'                            03736099
037370                      ' DC:'               PV-DISP-DC             03737013
037380                      ' B1:'               SU054-BAR-CODE-1       03738013
037390                      ' B2:'               SU054-BAR-CODE-2       03739013
037400                      ' B3:'               SU054-BAR-CODE-3       03740013
037410                                           DELIMITED BY SIZE      03741013
037420                                      INTO PV-CICS-MSG-AREA1      03742013
037430                                                                  03743013
037440              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03744013
037450              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03745013
037460                                                                  03746013
037470              PERFORM 9999-WRITE-TO-CSSL                          03747013
037480                                                                  03748013
037490              STRING  'SUKCS782 '          SU054-KOHLS-SML        03749099
037500                      ' TRIP:'             PV-DISP-TRIP           03750013
037510                      ' DR:'               SU054-DOOR-NUMBER      03751013
037520                      ' USR:'              SU054-USER-ID          03752013
037530                      ' STA:'              PV-DISP-PNA-STA        03753013
037540                      ' SQL:'              PV-DISP-SQLCODE        03754013
037550                      ' PCKUT970'                                 03755013
037560                                           DELIMITED BY SIZE      03756013
037570                                      INTO PV-CICS-MSG-AREA2      03757013
037580                                                                  03758013
037590              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03759013
037600              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03760013
037610                                                                  03761013
037620              PERFORM 9999-WRITE-TO-CSSL                          03762013
037630                                                                  03763013
037640              INITIALIZE PV-CICS-MSG-AREA3                        03764013
037650              move  sulbxf-shipt-unt-id to PV-disp-sulbxf         03765059
037660                                                                  03766013
037670              STRING  'SUKCS782 '                                 03767099
037680                      ' SULBXF:'           PV-DISP-SULBXF         03768013
037690                      ' VNDR Crtn:'        PV-VNDR-CTN            03769013
037700                                           DELIMITED BY SIZE      03770013
037710                                      INTO PV-CICS-MSG-AREA3      03771013
037720                                                                  03772013
037730              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03773013
037740              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03774013
037750                                                                  03775013
037760              PERFORM 9999-WRITE-TO-CSSL                          03776013
037770                                                                  03777013
037780                 END-IF                                           03778013
037790                                                                  03779013
037800                 IF  SULBXF-SHIPT-UNT-ID  =  PV-VNDR-CTN          03780013
037810                     CONTINUE                                     03781013
037820                 ELSE                                             03782013
037830                     SET  PS-SML-UCC128-MISMATCH  TO  TRUE        03783013
037840                 END-IF                                           03784013
037850*** DMH 9/16/11 - END                                             03785013
037860*                                                                 03786013
037870               WHEN PS-KOHLS-SML-BRCD2-FOUND                      03787013
037880                   MOVE SU054-BAR-CODE-2 TO DK-SML-BARCODE        03788013
037890                   PERFORM 1350-SELECT-UCC128-BRCDE               03789013
037900*                                                                 03790013
037910*** DMH 9/16/11 - BEGIN                                           03791013
037920                  IF PS-LOG-MESSAGE                               03792013
037930                                                                  03793013
037940              INITIALIZE PV-CICS-MSG-AREA1                        03794013
037950              INITIALIZE PV-CICS-MSG-AREA2                        03795013
037960                                                                  03796013
037970              MOVE SQLCODE              TO PV-DISP-SQLCODE        03797013
037980              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03798013
037990              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03799013
038000              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03800013
038010                                                                  03801013
038020              STRING  'SUKCS782 1300-'                            03802099
038030                      ' DC:'               PV-DISP-DC             03803013
038040                      ' B1:'               SU054-BAR-CODE-1       03804013
038050                      ' B2:'               SU054-BAR-CODE-2       03805013
038060                      ' B3:'               SU054-BAR-CODE-3       03806013
038070                                           DELIMITED BY SIZE      03807013
038080                                      INTO PV-CICS-MSG-AREA1      03808013
038090                                                                  03809013
038100              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03810013
038110              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03811013
038120                                                                  03812013
038130              PERFORM 9999-WRITE-TO-CSSL                          03813013
038140                                                                  03814013
038150              STRING  'SUKCS782 '          SU054-KOHLS-SML        03815099
038160                      ' TRIP:'             PV-DISP-TRIP           03816013
038170                      ' DR:'               SU054-DOOR-NUMBER      03817013
038180                      ' USR:'              SU054-USER-ID          03818013
038190                      ' STA:'              PV-DISP-PNA-STA        03819013
038200                      ' SQL:'              PV-DISP-SQLCODE        03820013
038210                      ' PCKUT970'                                 03821013
038220                                           DELIMITED BY SIZE      03822013
038230                                      INTO PV-CICS-MSG-AREA2      03823013
038240                                                                  03824013
038250              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03825013
038260              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03826013
038270                                                                  03827013
038280              PERFORM 9999-WRITE-TO-CSSL                          03828013
038290                                                                  03829013
038300              INITIALIZE PV-CICS-MSG-AREA3                        03830013
038310              move  sulbxf-shipt-unt-id to PV-disp-sulbxf         03831013
038320                                                                  03832013
038330              STRING  'SUKCS782 '                                 03833099
038340                      ' SULBXF:'           PV-DISP-SULBXF         03834013
038350                      ' VNDR Crtn:'        PV-VNDR-CTN            03835013
038360                                           DELIMITED BY SIZE      03836013
038370                                      INTO PV-CICS-MSG-AREA3      03837013
038380                                                                  03838013
038390              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03839013
038400              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03840013
038410                                                                  03841013
038420              PERFORM 9999-WRITE-TO-CSSL                          03842013
038430                                                                  03843013
038440                  END-IF                                          03844013
038450                                                                  03845013
038460                  IF  SULBXF-SHIPT-UNT-ID  =  PV-VNDR-CTN         03846013
038470                      CONTINUE                                    03847013
038480                  ELSE                                            03848013
038490                      SET  PS-SML-UCC128-MISMATCH  TO  TRUE       03849013
038500                  END-IF                                          03850013
038510*** DMH 9/16/11 - END                                             03851013
038520*                                                                 03852013
038530               WHEN PS-KOHLS-SML-BRCD3-FOUND                      03853013
038540                   MOVE SU054-BAR-CODE-3 TO DK-SML-BARCODE        03854013
038550                   PERFORM 1350-SELECT-UCC128-BRCDE               03855013
038560*                                                                 03856013
038570*** DMH 9/16/11 - BEGIN                                           03857013
038580                 IF PS-LOG-MESSAGE                                03858013
038590                                                                  03859013
038600              INITIALIZE PV-CICS-MSG-AREA1                        03860013
038610              INITIALIZE PV-CICS-MSG-AREA2                        03861013
038620                                                                  03862013
038630              MOVE SQLCODE              TO PV-DISP-SQLCODE        03863013
038640              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             03864013
038650              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           03865013
038660              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        03866013
038670                                                                  03867013
038680              STRING  'SUKCS782 1300-'                            03868099
038690                      ' DC:'               PV-DISP-DC             03869013
038700                      ' B1:'               SU054-BAR-CODE-1       03870013
038710                      ' B2:'               SU054-BAR-CODE-2       03871013
038720                      ' B3:'               SU054-BAR-CODE-3       03872013
038730                                           DELIMITED BY SIZE      03873013
038740                                      INTO PV-CICS-MSG-AREA1      03874013
038750                                                                  03875013
038760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03876013
038770              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     03877013
038780                                                                  03878013
038790              PERFORM 9999-WRITE-TO-CSSL                          03879013
038800                                                                  03880013
038810              STRING  'SUKCS782 '          SU054-KOHLS-SML        03881099
038820                      ' TRIP:'             PV-DISP-TRIP           03882013
038830                      ' DR:'               SU054-DOOR-NUMBER      03883013
038840                      ' USR:'              SU054-USER-ID          03884013
038850                      ' STA:'              PV-DISP-PNA-STA        03885013
038860                      ' SQL:'              PV-DISP-SQLCODE        03886013
038870                      ' PCKUT970'                                 03887013
038880                                           DELIMITED BY SIZE      03888013
038890                                      INTO PV-CICS-MSG-AREA2      03889013
038900                                                                  03890013
038910              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03891013
038920              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     03892013
038930                                                                  03893013
038940              PERFORM 9999-WRITE-TO-CSSL                          03894013
038950                                                                  03895013
038960              INITIALIZE PV-CICS-MSG-AREA3                        03896013
038970              move  sulbxf-shipt-unt-id to PV-disp-sulbxf         03897013
038980                                                                  03898013
038990              STRING  'SUKCS782 '                                 03899099
039000                      ' SULBXF:'           PV-DISP-SULBXF         03900013
039010                      ' VNDR Crtn:'        PV-VNDR-CTN            03901013
039020                                           DELIMITED BY SIZE      03902013
039030                                      INTO PV-CICS-MSG-AREA3      03903013
039040                                                                  03904013
039050              MOVE SPACES               TO PV-CICS-MSG-AREA-A     03905013
039060              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     03906013
039070                                                                  03907013
039080              PERFORM 9999-WRITE-TO-CSSL                          03908013
039090                                                                  03909013
039100                 END-IF                                           03910013
039110                                                                  03911013
039120                 IF  SULBXF-SHIPT-UNT-ID  =  PV-VNDR-CTN          03912013
039130                     CONTINUE                                     03913013
039140                 ELSE                                             03914013
039150                     SET  PS-SML-UCC128-MISMATCH  TO  TRUE        03915013
039160                 END-IF                                           03916013
039170*** DMH 9/16/11 - END                                             03917013
039180*                                                                 03918013
039190             END-EVALUATE                                         03919013
039200                                                                  03920013
039210             IF  PS-SML-UCC128-MISMATCH                           03921013
039220*** 9/22/11      SET PS-NO-VALID-BRCDES-FND TO TRUE               03922013
039230                 PERFORM 5005-PRINT-MESSAGE-LABELS                03923013
039240             END-IF                                               03924013
039250                                                                  03925013
039260*                                                                 03926013
039270*** dmh 9/16/11 - end                                             03927013
039280*                                                                 03928013
039290          ELSE                                                    03929013
039300             IF PS-UCC128-VND-BRCD2-FOUND                         03930013
039310                MOVE SU054-BAR-CODE-2 TO PV-CTN-N                 03931013
039320*CHECK FOR PS-VALID-SML-BRCDE                                     03932013
039330                EVALUATE TRUE                                     03933013
039340                  WHEN  PS-KOHLS-SML-BRCD1-FOUND                  03934013
039350                    MOVE SU054-BAR-CODE-1 TO DK-SML-BARCODE       03935013
039360                    PERFORM 1350-SELECT-UCC128-BRCDE              03936013
039370*                                                                 03937013
039380*** DMH 9/16/11 - BEGIN                                           03938013
039390                    IF  SULBXF-SHIPT-UNT-ID  =  PV-VNDR-CTN       03939013
039400                        CONTINUE                                  03940013
039410                    ELSE                                          03941013
039420                        SET  PS-SML-UCC128-MISMATCH  TO  TRUE     03942013
039430                    END-IF                                        03943013
039440*** DMH 9/16/11 - END                                             03944013
039450*                                                                 03945013
039460                  WHEN PS-KOHLS-SML-BRCD2-FOUND                   03946013
039470                      MOVE SU054-BAR-CODE-2 TO DK-SML-BARCODE     03947013
039480                      PERFORM 1350-SELECT-UCC128-BRCDE            03948013
039490*                                                                 03949013
039500*** DMH 9/16/11 - BEGIN                                           03950013
039510                     IF  SULBXF-SHIPT-UNT-ID  =  PV-VNDR-CTN      03951013
039520                         CONTINUE                                 03952013
039530                     ELSE                                         03953013
039540                         SET  PS-SML-UCC128-MISMATCH  TO  TRUE    03954013
039550                 END-IF                                           03955013
039560*** DMH 9/16/11 - END                                             03956013
039570*                                                                 03957013
039580                  WHEN PS-KOHLS-SML-BRCD3-FOUND                   03958013
039590                      MOVE SU054-BAR-CODE-3 TO DK-SML-BARCODE     03959013
039600                      PERFORM 1350-SELECT-UCC128-BRCDE            03960013
039610*                                                                 03961013
039620*** DMH 9/16/11 - BEGIN                                           03962013
039630                     IF  SULBXF-SHIPT-UNT-ID  =  PV-VNDR-CTN      03963013
039640                         CONTINUE                                 03964013
039650                     ELSE                                         03965013
039660                         SET  PS-SML-UCC128-MISMATCH  TO  TRUE    03966013
039670                     END-IF                                       03967013
039680*** DMH 9/16/11 - END                                             03968013
039690*                                                                 03969013
039700                END-EVALUATE                                      03970013
039710                                                                  03971013
039720                IF  PS-SML-UCC128-MISMATCH                        03972013
039730*** 9/22/11         SET PS-NO-VALID-BRCDES-FND TO TRUE            03973013
039740                    PERFORM 5005-PRINT-MESSAGE-LABELS             03974013
039750                END-IF                                            03975013
039760                                                                  03976013
039770             ELSE                                                 03977013
039780               MOVE SPACES TO DK-SML-BARCODE                      03978013
039790               EVALUATE TRUE                                      03979013
039800                 WHEN PS-KOHLS-SML-BRCD1-FOUND                    03980013
039810                   MOVE SU054-BAR-CODE-1 TO DK-SML-BARCODE        03981013
039820                   PERFORM 1350-SELECT-UCC128-BRCDE               03982013
039830                   IF PS-PROCESSING-ERROR-NO                      03983013
039840                      MOVE SULBXF-SHIPT-UNT-ID TO PV-CTN-N        03984013
039850                   END-IF                                         03985013
039860                 WHEN PS-KOHLS-SML-BRCD2-FOUND                    03986013
039870                   MOVE SU054-BAR-CODE-2 TO DK-SML-BARCODE        03987013
039880                   PERFORM 1350-SELECT-UCC128-BRCDE               03988013
039890                   IF PS-PROCESSING-ERROR-NO                      03989013
039900                      MOVE SULBXF-SHIPT-UNT-ID TO PV-CTN          03990013
039910                   END-IF                                         03991013
039920                 WHEN PS-KOHLS-SML-BRCD3-FOUND                    03992013
039930                   MOVE SU054-BAR-CODE-3 TO DK-SML-BARCODE        03993013
039940                   PERFORM 1350-SELECT-UCC128-BRCDE               03994013
039950                   IF PS-PROCESSING-ERROR-NO                      03995013
039960                      MOVE SULBXF-SHIPT-UNT-ID TO PV-CTN-N        03996013
039970                   END-IF                                         03997013
039980                 WHEN OTHER                                       03998013
039990                    SET PS-NO-VALID-BRCDES-FND TO TRUE            03999013
040000                    PERFORM 5005-PRINT-MESSAGE-LABELS             04000013
040010               END-EVALUATE                                       04001013
040020             END-IF                                               04002013
040030*TS 06/24/2010 BEG                                                04003013
040040           END-IF                                                 04004013
040050*TS 06/24/2010 END                                                04005013
040060          END-IF.                                                 04006013
040070                                                                  04007013
040080                                                                  04008013
040090*---------------------------------------------------------------* 04009013
040100* select SML using SSCC - (TSULBXF)                             * 04010013
040110*                                                               * 04011013
040120*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 04012013
040130*---------------------------------------------------------------* 04013013
040140******************************************************************04014013
040150 1350-SELECT-UCC128-BRCDE.                                        04015013
040160******************************************************************04016013
040170*                                                                 04017013
040180** added internal table to track paragraph execution time         04018013
040190** dmh 2014-12-22 - begin                                         04019013
040200*                                                                 04020013
040210     MOVE  '1350'  TO  PT-CURR-PARA.                              04021013
040220     IF  PS-BLD-INTERNAL-TABLE-YES                                04022013
040230         PERFORM 0200-INTERNAL-TABLE                              04023013
040240     ELSE                                                         04024013
040250         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04025013
040260     END-IF.                                                      04026013
040270                                                                  04027013
040280*                                                                 04028013
040290** DMH 2014-12-22 - END                                           04029013
040300*                                                                 04030013
040310                                                                  04031013
040320     EXEC SQL                                                     04032013
040330         SELECT  SHIPT_UNT_ID                                     04033013
040340         INTO   :SULBXF-SHIPT-UNT-ID                              04034013
040350         FROM   TSULBXF                                           04035013
040360         WHERE  BRCDE_NBR      = :DK-SML-BARCODE                  04036013
040370           AND  STAT_CDE       = 'A'                              04037013
040380     END-EXEC.                                                    04038013
040390                                                                  04039013
040400     EVALUATE TRUE                                                04040013
040410         WHEN SQLCODE = ZERO                                      04041013
040420             SET PS-VALID-SML-BRCDE-YES TO TRUE                   04042013
040430         WHEN SQLCODE = +100                                      04043013
040440             SET PS-VALID-SML-BRCDE-NO TO TRUE                    04044013
040450         WHEN SQLWARN0 NOT = SPACES                               04045013
040460         WHEN SQLCODE NOT EQUAL ZERO                              04046013
040470                                                                  04047013
040480              INITIALIZE PV-CICS-MSG-AREA1                        04048013
040490              INITIALIZE PV-CICS-MSG-AREA2                        04049013
040500                                                                  04050013
040510              MOVE SQLCODE              TO PV-DISP-SQLCODE        04051013
040520              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             04052013
040530              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           04053013
040540              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        04054013
040550                                                                  04055013
040560              STRING  'SUKCS782 1350-'                            04056099
040570                      ' DC:'               PV-DISP-DC             04057013
040580                      ' B1:'               SU054-BAR-CODE-1       04058013
040590                      ' B2:'               SU054-BAR-CODE-2       04059013
040600                      ' B3:'               SU054-BAR-CODE-3       04060013
040610                                           DELIMITED BY SIZE      04061013
040620                                      INTO PV-CICS-MSG-AREA1      04062013
040630                                                                  04063013
040640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04064013
040650              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     04065013
040660                                                                  04066013
040670              PERFORM 9999-WRITE-TO-CSSL                          04067013
040680                                                                  04068013
040690              STRING  'SUKCS782 '          SU054-KOHLS-SML        04069099
040700                      ' TRIP:'             PV-DISP-TRIP           04070013
040710                      ' DR:'               SU054-DOOR-NUMBER      04071013
040720                      ' USR:'              SU054-USER-ID          04072013
040730                      ' STA:'              PV-DISP-PNA-STA        04073013
040740                      ' SQL:'              PV-DISP-SQLCODE        04074013
040750                      ' TSULBXF'                                  04075013
040760                                           DELIMITED BY SIZE      04076013
040770                                      INTO PV-CICS-MSG-AREA2      04077013
040780                                                                  04078013
040790              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04079013
040800              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     04080013
040810                                                                  04081013
040820              pERFORM 9999-WRITE-TO-CSSL                          04082013
040830                                                                  04083013
040840              INITIALIZE PV-CICS-MSG-AREA3                        04084013
040850                                                                  04085013
040860              STRING  'SUKCS782 '                                 04086099
040870                      ' DK-SML-BARCODE:'   DK-SML-BARCODE         04087013
040880                                           DELIMITED BY SIZE      04088013
040890                                      INTO PV-CICS-MSG-AREA3      04089013
040900                                                                  04090013
040910              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04091013
040920              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     04092013
040930                                                                  04093013
040940              PERFORM 9999-WRITE-TO-CSSL                          04094013
040950                                                                  04095013
040960             SET PS-PROCESSING-ERROR-YES  TO TRUE                 04096013
040970             PERFORM 9998-WRITE-TO-CSSL                           04097013
040980     END-EVALUATE.                                                04098013
040990                                                                  04099013
041000                                                                  04100013
041010*---------------------------------------------------------------* 04101013
041020* select SML using SSCC - (TSULBXF) (multiple sml's for SSCC)   * 04102013
041030*                                                               * 04103013
041040*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 04104013
041050*---------------------------------------------------------------* 04105013
041060******************************************************************04106013
041070 1351-SELECT-UCC128-BRCDE-MLT.                                    04107013
041080******************************************************************04108013
041090*                                                                 04109013
041100** added internal table to track paragraph execution time         04110013
041110** dmh 2014-12-22 - begin                                         04111013
041120*                                                                 04112013
041130     MOVE  '1351'  TO  PT-CURR-PARA.                              04113013
041140     IF  PS-BLD-INTERNAL-TABLE-YES                                04114013
041150         PERFORM 0200-INTERNAL-TABLE                              04115013
041160     ELSE                                                         04116013
041170         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04117013
041180     END-IF.                                                      04118013
041190                                                                  04119013
041200*                                                                 04120013
041210** DMH 2014-12-22 - END                                           04121013
041220*                                                                 04122013
041230                                                                  04123013
041240     EXEC SQL                                                     04124013
041250         SELECT  SHIPT_UNT_ID                                     04125013
041260         INTO   :SULBXF-SHIPT-UNT-ID                              04126013
041270         FROM   TSULBXF                                           04127013
041280         WHERE  BRCDE_NBR      = :DK-SML-BARCODE                  04128013
041290     END-EXEC.                                                    04129013
041300                                                                  04130013
041310     EVALUATE TRUE                                                04131013
041320         WHEN SQLCODE = ZERO                                      04132013
041330         WHEN SQLCODE = -811                                      04133013
041340         WHEN SQLCODE = +100                                      04134013
041350             CONTINUE                                             04135013
041360         WHEN SQLWARN0 NOT = SPACES                               04136013
041370         WHEN SQLCODE NOT EQUAL ZERO                              04137013
041380                                                                  04138013
041390              INITIALIZE PV-CICS-MSG-AREA1                        04139013
041400              INITIALIZE PV-CICS-MSG-AREA2                        04140013
041410                                                                  04141013
041420              MOVE SQLCODE              TO PV-DISP-SQLCODE        04142013
041430              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             04143013
041440              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           04144013
041450              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        04145013
041460                                                                  04146013
041470              STRING  'SUKCS782 1351-'                            04147099
041480                      ' DC:'               PV-DISP-DC             04148013
041490                      ' B1:'               SU054-BAR-CODE-1       04149013
041500                      ' B2:'               SU054-BAR-CODE-2       04150013
041510                      ' B3:'               SU054-BAR-CODE-3       04151013
041520                                           DELIMITED BY SIZE      04152013
041530                                      INTO PV-CICS-MSG-AREA1      04153013
041540                                                                  04154013
041550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04155013
041560              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     04156013
041570                                                                  04157013
041580              PERFORM 9999-WRITE-TO-CSSL                          04158013
041590                                                                  04159013
041600              STRING  'SUKCS782 '          SU054-KOHLS-SML        04160099
041610                      ' TRIP:'             PV-DISP-TRIP           04161013
041620                      ' DR:'               SU054-DOOR-NUMBER      04162013
041630                      ' USR:'              SU054-USER-ID          04163013
041640                      ' STA:'              PV-DISP-PNA-STA        04164013
041650                      ' SQL:'              PV-DISP-SQLCODE        04165013
041660                      ' TSULBXF'                                  04166013
041670                                           DELIMITED BY SIZE      04167013
041680                                      INTO PV-CICS-MSG-AREA2      04168013
041690                                                                  04169013
041700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04170013
041710              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     04171013
041720                                                                  04172013
041730              pERFORM 9999-WRITE-TO-CSSL                          04173013
041740                                                                  04174013
041750              INITIALIZE PV-CICS-MSG-AREA3                        04175013
041760                                                                  04176013
041770              STRING  'SUKCS782 '                                 04177099
041780                      ' DK-SML-BARCODE:'   DK-SML-BARCODE         04178013
041790                                           DELIMITED BY SIZE      04179013
041800                                      INTO PV-CICS-MSG-AREA3      04180013
041810                                                                  04181013
041820              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04182013
041830              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     04183013
041840                                                                  04184013
041850              PERFORM 9999-WRITE-TO-CSSL                          04185013
041860                                                                  04186013
041870             SET PS-PROCESSING-ERROR-YES TO TRUE                  04187013
041880             PERFORM 9998-WRITE-TO-CSSL                           04188013
041890     END-EVALUATE.                                                04189013
041900                                                                  04190013
041910                                                                  04191013
041920*---------------------------------------------------------------* 04192013
041930* select Store Zone to be displayed on the SML label            * 04193013
041940*                                                               * 04194013
041950*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 04195013
041960*---------------------------------------------------------------* 04196013
041970 2100-GET-ZONE-DESC.                                              04197013
041980*                                                                 04198013
041990** added internal table to track paragraph execution time         04199013
042000** dmh 2014-12-22 - begin                                         04200013
042010*                                                                 04201013
042020     MOVE  '2100'  TO  PT-CURR-PARA.                              04202013
042030     IF  PS-BLD-INTERNAL-TABLE-YES                                04203013
042040         PERFORM 0200-INTERNAL-TABLE                              04204013
042050     ELSE                                                         04205013
042060         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04206013
042070     END-IF.                                                      04207013
042080                                                                  04208013
042090*                                                                 04209013
042100** DMH 2014-12-22 - END                                           04210013
042110*                                                                 04211013
042120                                                                  04212013
042130         MOVE PV-PO-NBR  TO PURCHS-PO-NBR.                        04213013
042140                                                                  04214013
042150         EXEC SQL                                                 04215013
042160              SELECT C.STR_ZN_ID                                  04216013
042170              INTO   :MDSEDP-STR-ZN-ID                            04217013
042180              FROM   TPURCHS A,                                   04218013
042190                     TMDSEAR B,                                   04219013
042200                     TMDSEDP C                                    04220013
042210              WHERE  A.PO_NBR   = :PURCHS-PO-NBR                  04221013
042220                AND  A.VER_STATUS_CDE = 'A'                       04222013
042230                AND  A.DEPT_NBR = B.DEPT_NBR                      04223013
042240                AND  B.MDSELV_CDE = 'DPT'                         04224013
042250                AND  B.OPERCO_NBR = '03'                          04225013
042260                AND (B.STRT_DTE <= CURRENT DATE AND               04226013
042270                     B.END_DTE > CURRENT DATE)                    04227013
042280                AND  B.MDSEAR_DKEY = C.MDSEAR_DKEY                04228013
042290               WITH UR                                            04229013
042300         END-EXEC                                                 04230013
042310                                                                  04231013
042320     EVALUATE TRUE                                                04232013
042330         WHEN SQLCODE = ZERO                                      04233013
042340             MOVE MDSEDP-STR-ZN-ID TO LBPTDA-STR-ZN-ID            04234013
042350         WHEN SQLCODE = +100                                      04235013
042360             MOVE SPACES TO LBPTDA-STR-ZN-ID                      04236013
042370         WHEN SQLWARN0 NOT = SPACES                               04237013
042380         WHEN SQLCODE NOT EQUAL ZERO                              04238013
042390                                                                  04239013
042400              INITIALIZE PV-CICS-MSG-AREA1                        04240013
042410              INITIALIZE PV-CICS-MSG-AREA2                        04241013
042420                                                                  04242013
042430              MOVE SQLCODE              TO PV-DISP-SQLCODE        04243013
042440              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             04244013
042450              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           04245013
042460              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        04246013
042470                                                                  04247013
042480              STRING  'SUKCS782 2100-'                            04248099
042490                      ' DC:'               PV-DISP-DC             04249013
042500                      ' B1:'               SU054-BAR-CODE-1       04250013
042510                      ' B2:'               SU054-BAR-CODE-2       04251013
042520                      ' B3:'               SU054-BAR-CODE-3       04252013
042530                                           DELIMITED BY SIZE      04253013
042540                                      INTO PV-CICS-MSG-AREA1      04254013
042550                                                                  04255013
042560              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04256013
042570              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     04257013
042580                                                                  04258013
042590              PERFORM 9999-WRITE-TO-CSSL                          04259013
042600                                                                  04260013
042610              STRING  'SUKCS782 '          SU054-KOHLS-SML        04261099
042620                      ' TRIP:'             PV-DISP-TRIP           04262013
042630                      ' DR:'               SU054-DOOR-NUMBER      04263013
042640                      ' USR:'              SU054-USER-ID          04264013
042650                      ' STA:'              PV-DISP-PNA-STA        04265013
042660                      ' SQL:'              PV-DISP-SQLCODE        04266013
042670                      ' TPURCHS/TMDSEAR/TMDSEDP'                  04267013
042680                                           DELIMITED BY SIZE      04268013
042690                                      INTO PV-CICS-MSG-AREA2      04269013
042700                                                                  04270013
042710              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04271013
042720              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     04272013
042730                                                                  04273013
042740              PERFORM 9999-WRITE-TO-CSSL                          04274013
042750                                                                  04275013
042760              INITIALIZE PV-CICS-MSG-AREA3                        04276013
042770              MOVE PURCHS-PO-NBR        TO PV-DISP-PO             04277013
042780                                                                  04278013
042790              STRING  'SUKCS782 '                                 04279099
042800                      ' PO:'               PV-DISP-po             04280013
042810                                           DELIMITED BY SIZE      04281013
042820                                      INTO PV-CICS-MSG-AREA3      04282013
042830                                                                  04283013
042840              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04284013
042850              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     04285013
042860                                                                  04286013
042870              PERFORM 9999-WRITE-TO-CSSL                          04287013
042880                                                                  04288013
042890             SET PS-PROCESSING-ERROR-YES TO TRUE                  04289013
042900             PERFORM 9998-WRITE-TO-CSSL                           04290013
042910     END-EVALUATE.                                                04291013
042920                                                                  04292013
042930*---------------------------------------------------------------* 04293013
042940* select Store Zone description to be displayed on the SML      * 04294013
042950*                                                               * 04295013
042960*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 04296013
042970*---------------------------------------------------------------* 04297013
042980 2150-GET-ZONE-DESC-FOR-CL.                                       04298013
042990*                                                                 04299013
043000** added internal table to track paragraph execution time         04300013
043010** dmh 2014-12-22 - begin                                         04301013
043020*                                                                 04302013
043030     MOVE  '2150'  TO  PT-CURR-PARA.                              04303013
043040     IF  PS-BLD-INTERNAL-TABLE-YES                                04304013
043050         PERFORM 0200-INTERNAL-TABLE                              04305013
043060     ELSE                                                         04306013
043070         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04307013
043080     END-IF.                                                      04308013
043090                                                                  04309013
043100*                                                                 04310013
043110** DMH 2014-12-22 - END                                           04311013
043120*                                                                 04312013
043130                                                                  04313013
043140         EXEC SQL                                                 04314013
043150              SELECT C.STR_ZN_ID                                  04315013
043160              INTO   :MDSEDP-STR-ZN-ID                            04316013
043170              FROM   TPURCHS A,                                   04317013
043180                     TMDSEAR B,                                   04318013
043190                     TMDSEDP C                                    04319013
043200              WHERE  A.PO_NBR   = :PURCHS-PO-NBR                  04320013
043210                AND  A.VER_STATUS_CDE = 'A'                       04321013
043220                AND  A.DEPT_NBR = B.DEPT_NBR                      04322013
043230                AND  B.MDSELV_CDE = 'DPT'                         04323013
043240                AND  B.OPERCO_NBR = '03'                          04324013
043250                AND (B.STRT_DTE <= CURRENT DATE AND               04325013
043260                     B.END_DTE > CURRENT DATE)                    04326013
043270                AND  B.MDSEAR_DKEY = C.MDSEAR_DKEY                04327013
043280               WITH UR                                            04328013
043290         END-EXEC                                                 04329013
043300                                                                  04330013
043310     EVALUATE TRUE                                                04331013
043320         WHEN SQLCODE = ZERO                                      04332013
043330             CONTINUE                                             04333013
043340         WHEN SQLCODE = +100                                      04334013
043350             MOVE SPACES TO MDSEDP-STR-ZN-ID                      04335013
043360         WHEN SQLWARN0 NOT = SPACES                               04336013
043370         WHEN SQLCODE NOT EQUAL ZERO                              04337013
043380                                                                  04338013
043390              INITIALIZE PV-CICS-MSG-AREA1                        04339013
043400              INITIALIZE PV-CICS-MSG-AREA2                        04340013
043410                                                                  04341013
043420              MOVE SQLCODE              TO PV-DISP-SQLCODE        04342013
043430              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             04343013
043440              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           04344013
043450              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        04345013
043460                                                                  04346013
043470              STRING  'SUKCS782 2150-'                            04347099
043480                      ' DC:'               PV-DISP-DC             04348013
043490                      ' B1:'               SU054-BAR-CODE-1       04349013
043500                      ' B2:'               SU054-BAR-CODE-2       04350013
043510                      ' B3:'               SU054-BAR-CODE-3       04351013
043520                                           DELIMITED BY SIZE      04352013
043530                                      INTO PV-CICS-MSG-AREA1      04353013
043540                                                                  04354013
043550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04355013
043560              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     04356013
043570                                                                  04357013
043580              PERFORM 9999-WRITE-TO-CSSL                          04358013
043590                                                                  04359013
043600              STRING  'SUKCS782 '          SU054-KOHLS-SML        04360099
043610                      ' TRIP:'             PV-DISP-TRIP           04361013
043620                      ' DR:'               SU054-DOOR-NUMBER      04362013
043630                      ' USR:'              SU054-USER-ID          04363013
043640                      ' STA:'              PV-DISP-PNA-STA        04364013
043650                      ' SQL:'              PV-DISP-SQLCODE        04365013
043660                      ' TPURCHS/TMDSEAR/TMDSEDP'                  04366013
043670                                           DELIMITED BY SIZE      04367013
043680                                      INTO PV-CICS-MSG-AREA2      04368013
043690                                                                  04369013
043700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04370013
043710              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     04371013
043720                                                                  04372013
043730              PERFORM 9999-WRITE-TO-CSSL                          04373013
043740                                                                  04374013
043750              INITIALIZE PV-CICS-MSG-AREA3                        04375013
043760              MOVE PURCHS-PO-NBR        TO PV-DISP-PO             04376013
043770                                                                  04377013
043780              STRING  'SUKCS782 '                                 04378099
043790                      ' PO:'               PV-DISP-PO             04379013
043800                                           DELIMITED BY SIZE      04380013
043810                                      INTO PV-CICS-MSG-AREA3      04381013
043820                                                                  04382013
043830              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04383013
043840              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     04384013
043850                                                                  04385013
043860              PERFORM 9999-WRITE-TO-CSSL                          04386013
043870                                                                  04387013
043880             SET PS-PROCESSING-ERROR-YES TO TRUE                  04388013
043890             PERFORM 9998-WRITE-TO-CSSL                           04389013
043900     END-EVALUATE.                                                04390013
043910                                                                  04391013
043920 2240-CHECK-TABLES.                                               04392013
043930*                                                                 04393013
043940** added internal table to track paragraph execution time         04394013
043950** dmh 2014-12-22 - begin                                         04395013
043960*                                                                 04396013
043970     MOVE  '2240'  TO  PT-CURR-PARA.                              04397013
043980     IF  PS-BLD-INTERNAL-TABLE-YES                                04398013
043990         PERFORM 0200-INTERNAL-TABLE                              04399013
044000     ELSE                                                         04400013
044010         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04401013
044020     END-IF.                                                      04402013
044030                                                                  04403013
044040*                                                                 04404013
044050** DMH 2014-12-22 - END                                           04405013
044060*                                                                 04406013
044070                                                                  04407013
044080     INITIALIZE PV-PREPK-ID.                                      04408013
044090                                                                  04409013
044100     MOVE PV-CTN-N  TO SHPUNT-SHIPT-UNT-ID                        04410013
044110                       SHUUPC-SHIPT-UNT-ID                        04411013
044120                       DK-CTN                                     04412013
044130                       PV-DISP-sscc.                              04413013
044140     PERFORM 2250-SELECT-SHPUNT.                                  04414013
044150     SET PS-NOT-PACK-BY-STORE                                     04415013
044160         PS-NOT-MULTI-LINE                                        04416013
044170         PS-LINE-FND                                              04417013
044180         PS-MISDIRECT-PACK-BY-STORE-NO                            04418013
044190         PS-INACTV-PBS-CARTON-NO                                  04419013
044200         PS-NOT-INVALID-CRE-SOURCE                                04420013
044210         PS-ECOMM-DC-REPURPOSE-NO                                 04421013
044220         PS-AUTO-VE-NO             TO TRUE                        04422013
044230                                                                  04423013
044240                                                                  04424013
044250     IF PS-BRCDE-ERROR-FND                                        04425013
044260        PERFORM 5005-PRINT-MESSAGE-LABELS                         04426013
044270     END-IF                                                       04427013
044280                                                                  04428013
044290     IF XLT00010-LOC-TYP-CDE = 'DS'                               04429013
044300** gb 05/08                                                       04430013
044310        IF PS-OPER-IS-ECOMM-STORE                                 04431013
044320           SET PS-OPER-IS-ECOMM-DC TO TRUE                        04432013
044330        END-IF                                                    04433013
044340                                                                  04434013
044350        MOVE  '224B'  TO  PT-CURR-PARA                            04435013
044360         IF  PS-BLD-INTERNAL-TABLE-YES                            04436013
044370             PERFORM 0200-INTERNAL-TABLE                          04437013
044380         ELSE                                                     04438013
044390             PERFORM 0202-BUILD-MESSAGE-DISPLAY                   04439013
044400         END-IF                                                   04440013
044410                                                                  04441013
044420         IF  PS-LOG-MESSAGE                                       04442013
044430             INITIALIZE PV-CICS-MSG-AREA-B                        04443013
044440               MOVE 'SUKCS782 - 2240-CHECK-TABLES part 2'         04444099
044450                 to PV-CICS-MSG-AREA-B                            04445013
044460             PERFORM 9999-WRITE-TO-CSSL                           04446013
044470         END-IF                                                   04447013
044480** gb 05/08                                                       04448013
044490        SET PS-PACK-BY-STORE TO TRUE                              04449013
044500        PERFORM 2265-CHECK-INACTV-PBS                             04450013
044510     END-IF                                                       04451013
044520                                                                  04452013
044530     IF PS-CARTON-EXISTS                                          04453013
044540        IF SHPUNT-SHIPT-UNT-SRC-ID EQUAL 'ASN' OR 'RCV'           04454013
044550             CONTINUE                                             04455013
044560        ELSE                                                      04456013
044570            SET PS-CARTON-DOESNT-EXIST                            04457013
044580                PS-INVALID-CRE-SOURCE   TO TRUE                   04458013
044590        END-IF                                                    04459013
044600     END-IF                                                       04460013
044610                                                                  04461013
044620     IF PS-CARTON-EXISTS                                          04462013
044630        PERFORM 2255-SELECT-SHUUPC                                04463013
044640        PERFORM 2410-DETERMINE-RECEIVER                           04464013
044650                                                                  04465013
044660        IF PKSLIP-ORIG-PKSL-SEQ-NBR > 0                           04466013
044670           SET SU044-FA-PKSLIP-CREATE TO TRUE                     04467013
044680        ELSE                                                      04468013
044690           SET SU044-ASN-PKSLIP-CREATE TO TRUE                    04469013
044700        END-IF                                                    04470013
044710                                                                  04471013
044720        PERFORM 3805-CHECK-TKRPRPM-AUTOVE                         04472013
044730                                                                  04473013
044740        IF SHPUNT-ORGN-OPER-UNT-ID = SU054-DC-NUMBER              04474013
044750           CONTINUE                                               04475013
044760        ELSE                                                      04476013
044770           IF RECEIV-CURR-OPER-UNT-ID = SU054-DC-NUMBER           04477013
044780              CONTINUE                                            04478013
044790           ELSE                                                   04479013
044800              SET PS-NOT-CRTN-ATT-TO-TRIP TO TRUE                 04480013
044810              IF RC040-PROCESS-MSDIRCT-NO                         04481013
044820                 SET PS-WRONG-FCLTY           TO TRUE             04482013
044830              END-IF                                              04483013
044840           END-IF                                                 04484013
044850        END-IF                                                    04485013
044860                                                                  04486013
044870        IF PS-CRTN-ATT-TO-TRIP AND PS-CRTN-ATT-TO-RCVR            04487013
044880           MOVE RECEIV-OPER-UNT-ID TO DK-OPER-UNT-ID              04488013
044890           PERFORM 7215-GET-ECOMM-DC-INFO                         04489013
044900        END-IF                                                    04490013
044910                                                                  04491013
044911* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04491171
044912* fOR mAINFRAME MODERNIZATION - CHECK IF SELECTED FOR tHIN SLICE* 04491271
044913* DMH - 5/16/23 BEGIN                                           * 04491371
044914*                                                               * 04491471
044915* cHECK IF dc IS PART OF THE tHIN SLICE TEST - TKRPRPM: THNSLC  * 04491571
044916* CHECK IF PNA/RF DOOR IS FOR THIN SLICE:  wst PARM:  THNSLCCKIN* 04491671
044917* if Yes to both checks - call thin slice module :  SUKCS700    * 04491771
044918* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04491871
044923        PERFORM 2500-THIN-SLICE-CHECK                             04492373
044924                                                                  04492473
044925        IF  PS-SELECT-FOR-THIN-SLICE                              04492580
044929            MOVE 'NEW CK-IN'  TO  SU054-KOHLS-SML                 04492980
044930            SET  SU054-THIN-SLICE-ELIGIBLE   TO  TRUE             04493097
044931            PERFORM 5005B-THIN-SLICE-LABELS                       04493184
044932        ELSE                                                      04493280
044933                                                                  04493372
044934* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04493472
044935* DMH - 5/16/23 END - END THIN SLICE CHECK                      * 04493572
044936* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04493672
044937                                                                  04493772
044938          IF PS-PACK-BY-STORE AND PS-RCVR-DATA-FOUND-YES          04493880
044939             IF RECEIV-PACK-BY-ST-IND = 'Y'                       04493980
044940                SET PS-PBS-CRTN-RCVR-MISMTCH-NO TO TRUE           04494080
044950                PERFORM 2241-PROCESS-VALID-CARTONS                04495080
044960             ELSE                                                 04496080
044970                IF PS-OPER-IS-ECOMM-DC                            04497080
044980                   PERFORM 2241-PROCESS-VALID-CARTONS             04498080
044990                ELSE                                              04499080
045000                   SET PS-PBS-CRTN-RCVR-MISMTCH-YES TO TRUE       04500080
045010                   PERFORM 5005-PRINT-MESSAGE-LABELS              04501080
045020                END-IF                                            04502080
045030             END-IF                                               04503080
045040          ELSE                                                    04504080
045050             IF PS-UCC128-PKSLIP-ERROR-YES                        04505080
045060                PERFORM 5005-PRINT-MESSAGE-LABELS                 04506080
045070             ELSE                                                 04507080
045080                PERFORM 2241-PROCESS-VALID-CARTONS                04508080
045090             END-IF                                               04509080
045100          END-IF                                                  04510080
045101*                                                                 04510181
045102*** "END-IF"  for ps-select-for-thin-slice                        04510281
045103*                                                                 04510381
045104        END-IF                                                    04510481
045105*                                                                 04510581
045106*** else for  "IF PS-CARTON-EXISTS"                               04510681
045108*                                                                 04510881
045110     ELSE                                                         04511081
045120           SET PS-INVALID-INPUT                                   04512080
045130               PS-NO-VALID-BRCDES-FND                             04513080
045140               PS-NOT-FOUND               TO TRUE                 04514080
045150               PERFORM 5005-PRINT-MESSAGE-LABELS                  04515080
045161     END-IF.                                                      04516180
045170******************************************************************04517013
045180 2241-PROCESS-VALID-CARTONS.                                      04518013
045190*                                                                 04519013
045200** added internal table to track paragraph execution time         04520013
045210** dmh 2014-12-22 - begin                                         04521013
045220*                                                                 04522013
045230     MOVE  '2241'  TO  PT-CURR-PARA.                              04523013
045240     IF  PS-BLD-INTERNAL-TABLE-YES                                04524013
045250         PERFORM 0200-INTERNAL-TABLE                              04525013
045260     ELSE                                                         04526013
045270         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04527013
045280     END-IF.                                                      04528013
045290                                                                  04529013
045300*                                                                 04530013
045310** DMH 2014-12-22 - END                                           04531013
045320*                                                                 04532013
045330                                                                  04533013
045340         IF PS-CRTN-ATT-TO-TRIP AND PS-CRTN-ATT-TO-RCVR           04534013
045350            AND PS-OPER-IS-ECOMM-DC                               04535013
045360            IF RECEIV-CURR-OPER-UNT-ID = RECEIV-OPER-UNT-ID       04536013
045370               CONTINUE                                           04537013
045380            ELSE                                                  04538013
045390**SLH 5/08                                                        04539013
045400               INITIALIZE PV-REPURP-COUNT                         04540013
045410               PERFORM 3806-CHECK-FOR-REPURP                      04541013
045420*              IF PV-REPURP-COUNT > 0                             04542013
045430                  PERFORM 6750-CHECK-ECOMM-REPURPOSE              04543013
045440*              END-IF                                             04544013
045450**SLH 5/08                                                        04545013
045460            END-IF                                                04546013
045470         END-IF                                                   04547013
045480                                                                  04548013
045490         PERFORM 2260-SELECT-TSHUNLO                              04549013
045500                                                                  04550013
045510         IF SU054-ASGMT-STRT-DTE  > SPACES                        04551013
045520            MOVE +0   TO PV-DLKCS410-COUNT                        04552013
045530            PERFORM 2285-CALL-DLKUP001-ASGMT-MOD                  04553013
045540         END-IF                                                   04554013
045550                                                                  04555013
045560         PERFORM 2425-CHECK-VERIFIED-LINES                        04556013
045570                                                                  04557013
045580         IF PS-RECITM-VERIFIED-LINES-YES                          04558013
045590               PERFORM 5005-PRINT-MESSAGE-LABELS                  04559013
045600         END-IF                                                   04560013
045610                                                                  04561013
045620                                                                  04562013
045630         IF PV-DB2-COUNT = 0                                      04563013
045640            PERFORM 2270-INSERT-TSHUNLO                           04564013
045650                                                                  04565013
045660            IF PS-ECOMM-DC-REPURPOSE                              04566013
045670               PERFORM 5005-PRINT-MESSAGE-LABELS                  04567013
045680            END-IF                                                04568013
045690                                                                  04569013
045700            IF PS-ECOMM-DC-REPURPOSE-NO                           04570013
045710              IF ((SHPUNT-ORGN-OPER-UNT-ID = SU054-DC-NUMBER)   OR04571013
045720                 (RECEIV-CURR-OPER-UNT-ID = SU054-DC-NUMBER))     04572013
045730                 AND PS-RECITM-VERIFIED-LINES-NO                  04573013
045740*change to process pack by store misdirects                       04574013
045750                 OR  RC040-PROCESS-MSDIRCT-YES                    04575013
045760                 IF PS-PACK-BY-STORE                              04576013
045770                    PERFORM 2242-PACK-BY-STORE-PROCESS            04577013
045780                 ELSE                                             04578013
045790                    PERFORM 2245-BULK-LABEL-ROUTINE               04579013
045800                 END-IF                                           04580013
045810              ELSE                                                04581013
045820                  SET PS-INVALID-INPUT  TO TRUE                   04582013
045830                  IF RC040-PROCESS-MSDIRCT-NO                     04583013
045840                     SET PS-WRONG-FCLTY    TO TRUE                04584013
045850                  END-IF                                          04585013
045860                  PERFORM 5005-PRINT-MESSAGE-LABELS               04586013
045870              END-IF                                              04587013
045880            END-IF                                                04588013
045890         ELSE                                                     04589013
045900*gb 5/08/08                                                       04590013
045910           IF PS-ECOMM-DC-REPURPOSE                               04591013
045920              PERFORM 5005-PRINT-MESSAGE-LABELS                   04592013
045930           END-IF                                                 04593013
045940         IF PS-ECOMM-DC-REPURPOSE-NO                              04594013
045950*gb 5/08/08                                                       04595013
045960          IF SHUNLO-TRIP-ID    = SU054-TRIP-ID                    04596013
045970            IF PS-CRTN-ATT-TO-TRIP AND PS-CRTN-ATT-TO-RCVR        04597013
045980               AND PS-RECITM-VERIFIED-LINES-NO                    04598013
045990               PERFORM 2280-SELECT-STORE-FROM-XREF                04599013
046000               IF PS-PACK-BY-STORE                                04600013
046010                  PERFORM 2242-PACK-BY-STORE-PROCESS              04601013
046020               ELSE                                               04602013
046030                  PERFORM 2245-BULK-LABEL-ROUTINE                 04603013
046040               END-IF                                             04604013
046050            ELSE                                                  04605013
046060              IF ((SHPUNT-ORGN-OPER-UNT-ID = SU054-DC-NUMBER)   OR04606013
046070                  (RECEIV-CURR-OPER-UNT-ID = SU054-DC-NUMBER))    04607013
046080                  AND  PS-RECITM-VERIFIED-LINES-NO                04608013
046090                  PERFORM 2280-SELECT-STORE-FROM-XREF             04609013
046100                  IF PS-PACK-BY-STORE                             04610013
046110                     PERFORM 2242-PACK-BY-STORE-PROCESS           04611013
046120                  ELSE                                            04612013
046130                     PERFORM 2245-BULK-LABEL-ROUTINE              04613013
046140                  END-IF                                          04614013
046150              ELSE                                                04615013
046160                 SET PS-DUPLICATE-FOUND TO TRUE                   04616013
046170                 IF RC040-PROCESS-MSDIRCT-NO                      04617013
046180                    SET PS-WRONG-FCLTY TO TRUE                    04618013
046190                 END-IF                                           04619013
046200                 PERFORM 5005-PRINT-MESSAGE-LABELS                04620013
046210              END-IF                                              04621013
046220            END-IF                                                04622013
046230          ELSE                                                    04623013
046240             MOVE SHUNLO-TRIP-ID  TO PV-DISP-DUP-TRIP             04624013
046250             SET PS-DUPLICATE-CARTON TO TRUE                      04625013
046260             PERFORM 5005-PRINT-MESSAGE-LABELS                    04626013
046270          END-IF                                                  04627013
046280          END-IF                                                  04628013
046290         END-IF.                                                  04629013
046300                                                                  04630013
046310 2242-PACK-BY-STORE-PROCESS.                                      04631013
046320******************************************************************04632013
046330*                                                                 04633013
046340** added internal table to track paragraph execution time         04634013
046350** dmh 2014-12-22 - begin                                         04635013
046360*                                                                 04636013
046370     MOVE  '2242'  TO  PT-CURR-PARA.                              04637013
046380     IF  PS-BLD-INTERNAL-TABLE-YES                                04638013
046390         PERFORM 0200-INTERNAL-TABLE                              04639013
046400     ELSE                                                         04640013
046410         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04641013
046420     END-IF.                                                      04642013
046430                                                                  04643013
046440*                                                                 04644013
046450** DMH 2014-12-22 - END                                           04645013
046460*                                                                 04646013
046470       PERFORM  7230-GET-DEPT-CL-SKU                              04647013
046480       IF PS-INACTV-PBS-CARTON-YES                                04648013
046490          PERFORM 4500-CREATE-TROUBLE                             04649013
046500       END-IF                                                     04650013
046510          MOVE SHPUNT-DEST-OPER-UNT-ID                            04651013
046520                           TO PV-DEST-STORE                       04652013
046530          IF PS-INACTV-PBS-CARTON-YES                             04653013
046540             PERFORM 7235-GET-OUTER-PACK                          04654013
046550             PERFORM 5005-PRINT-MESSAGE-LABELS                    04655013
046560          ELSE                                                    04656013
046570             SET PS-NO-TROUBLE-FOUND TO TRUE                      04657013
046580             IF PV-RCVR-SEQ-NBR > 0                               04658013
046590                PERFORM 4450-CHECK-TROUBLE                        04659013
046600             END-IF                                               04660013
046610             IF PS-TROUBLE-FOUND                                  04661013
046620                PERFORM 4460-CHECK-PO-AUD-REQ                     04662013
046630                IF PS-AUDIT-PROMPT-CHECK-YES                      04663013
046640                   IF PS-CRTN-ATT-TO-TRIP AND                     04664013
046650                                      PS-CRTN-ATT-TO-RCVR         04665013
046660                      PERFORM 5000-PRINT-LABEL                    04666013
046670                   ELSE                                           04667013
046680                      PERFORM 4510-PROCESS-CHECK-RTV              04668013
046690                      IF PS-PBS-RTV-ALLOC OR PS-PBS-RTV-NO-ALLOC  04669013
046700                         IF PS-AUTO-VE-YES AND    PS-PBS-RTV-ALLOC04670013
046710                            PERFORM 7590-CREATE-RTV-OTBND         04671013
046720                         END-IF                                   04672013
046730                      ELSE                                        04673013
046740                         IF PS-AUTO-VE-YES                        04674013
046750                            PERFORM 4250-LINK-TO-FRASTY-HANDLER   04675013
046760                         END-IF                                   04676013
046770                      END-IF                                      04677013
046780                      PERFORM 5005-PRINT-MESSAGE-LABELS           04678013
046790                   END-IF                                         04679013
046800                ELSE                                              04680013
046810                  IF PV-RCVR-SEQ-NBR = 0 AND PS-AUTO-VE-YES       04681013
046820                     IF PS-OPER-IS-ECOMM-STORE                    04682013
046830                        SET PS-ECOMM-STORE-NO-RCVR TO TRUE        04683013
046840                     ELSE                                         04684013
046850                        PERFORM 4250-LINK-TO-FRASTY-HANDLER       04685013
046860                     END-IF                                       04686013
046870                  END-IF                                          04687013
046880                  PERFORM 5005-PRINT-MESSAGE-LABELS               04688013
046890                END-IF                                            04689013
046900             ELSE                                                 04690013
046910                IF PV-RCVR-SEQ-NBR = 0 AND PS-AUTO-VE-YES         04691013
046920                   IF PS-OPER-IS-ECOMM-STORE                      04692013
046930                      SET PS-ECOMM-STORE-NO-RCVR TO TRUE          04693013
046940                   ELSE                                           04694013
046950                      PERFORM 4250-LINK-TO-FRASTY-HANDLER         04695013
046960                   END-IF                                         04696013
046970                   PERFORM 5005-PRINT-MESSAGE-LABELS              04697013
046980                ELSE                                              04698013
046990                   PERFORM 4510-PROCESS-CHECK-RTV                 04699013
047000                   IF PS-PBS-RTV-ALLOC OR PS-PBS-RTV-NO-ALLOC     04700013
047010                      IF PS-AUTO-VE-YES AND PS-PBS-RTV-ALLOC      04701013
047020                         PERFORM 7590-CREATE-RTV-OTBND            04702013
047030                      END-IF                                      04703013
047040                      PERFORM 5005-PRINT-MESSAGE-LABELS           04704013
047050                   ELSE                                           04705013
047060                      IF PS-CRTN-ATT-TO-TRIP AND                  04706013
047070                                         PS-CRTN-ATT-TO-RCVR      04707013
047080                         PERFORM 5000-PRINT-LABEL                 04708013
047090                      ELSE                                        04709013
047100                         IF PS-AUTO-VE-YES                        04710013
047110                            PERFORM 4250-LINK-TO-FRASTY-HANDLER   04711013
047120                         END-IF                                   04712013
047130                         PERFORM 5005-PRINT-MESSAGE-LABELS        04713013
047140                      END-IF                                      04714013
047150                   END-IF                                         04715013
047160                END-IF                                            04716013
047170             END-IF                                               04717013
047180          END-IF.                                                 04718013
047190******************************************************************04719013
047200 2245-BULK-LABEL-ROUTINE.                                         04720013
047210******************************************************************04721013
047220*                                                                 04722013
047230** added internal table to track paragraph execution time         04723013
047240** dmh 2014-12-22 - begin                                         04724013
047250*                                                                 04725013
047260     MOVE  '2245'  TO  PT-CURR-PARA.                              04726013
047270     IF  PS-BLD-INTERNAL-TABLE-YES                                04727013
047280         PERFORM 0200-INTERNAL-TABLE                              04728013
047290     ELSE                                                         04729013
047300         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04730013
047310     END-IF.                                                      04731013
047320                                                                  04732013
047330*                                                                 04733013
047340** DMH 2014-12-22 - END                                           04734013
047350*                                                                 04735013
047360     INITIALIZE PV-MULTI-LINE-COUNT                               04736013
047370                DK-OUTER-QTY                                      04737013
047380                PV-TRN-LNE-NBR                                    04738013
047390                PV-HOLD-TRN-LNE-NBR.                              04739013
047400                                                                  04740013
047410     SET PS-NOT-FOUND-ON-CURSOR                                   04741013
047420         PS-FIRST-PO-LINE-FOR-CTN TO TRUE.                        04742013
047430                                                                  04743013
047440       IF PS-AUTO-VE-YES AND PV-RCVR-SEQ-NBR = 0                  04744013
047450          PERFORM 4250-LINK-TO-FRASTY-HANDLER                     04745013
047460          SET PS-NOT-FOUND-ON-CURSOR TO TRUE                      04746013
047470       ELSE                                                       04747013
047480          IF RECEIV-PKGNG-CDE = PC-M OR PC-I                      04748013
047490            PERFORM 3685-CHECK-UCC128-USE                         04749013
047500            IF (DISTHD-TOT-CART-CNT > 0)   AND                    04750013
047510                  (DISTHD-UCC128-DAT-USG-CDE = 'U')               04751013
047520                PERFORM 2335-OPEN-ODD-UNITS-CSR                   04752013
047530                PERFORM 2340-FETCH-ODD-UNITS-CSR                  04753013
047540                  UNTIL PS-EO-ODD-UNTS-CSR OR                     04754013
047550                                PS-ODD-UNT-CRTN-FOUND             04755013
047560                PERFORM 2345-CLOSE-ODD-UNITS-CSR                  04756013
047570                IF PS-ODD-UNT-CRTN-FOUND                          04757013
047580                  CONTINUE                                        04758013
047590                ELSE                                              04759013
047600                  PERFORM 2350-OPEN-PREPK-CSR                     04760013
047610                  PERFORM 2360-FETCH-PREPK-CSR                    04761013
047620                    UNTIL PS-EO-PREPK-CSR OR                      04762013
047630                              PS-ODD-UNT-CRTN-FOUND               04763013
047640                  PERFORM 2370-CLOSE-PREPK-CSR                    04764013
047650                END-IF                                            04765013
047660            END-IF                                                04766013
047670          ELSE                                                    04767013
047680             PERFORM 2450-OPEN-UNITS-CSR                          04768013
047690             PERFORM 2460-FETCH-LINE-AND-UNITS                    04769013
047700               UNTIL PS-EO-UNITS-CSR                              04770013
047710             PERFORM 2470-CLOSE-UNITS-CSR                         04771013
047720          END-IF                                                  04772013
047730       END-IF                                                     04773013
047740                                                                  04774013
047750                                                                  04775013
047760       IF PS-ODD-UNT-CRTN-FOUND                                   04776013
047770        CONTINUE                                                  04777013
047780       ELSE                                                       04778013
047790       IF PS-FOUND-ON-CURSOR                                      04779013
047800             EVALUATE TRUE                                        04780013
047810             WHEN DISTHD-UCC128-DAT-USG-CDE = 'I'                 04781013
047820                 SET PS-UCC128-IGNORED TO TRUE                    04782013
047830                 SET PS-NO-CASEPK-FND TO TRUE                     04783013
047840                 PERFORM 5005-PRINT-MESSAGE-LABELS                04784013
047850             WHEN DISTHD-UCC128-DAT-USG-CDE = 'N'                 04785013
047860             WHEN DISTHD-UCC128-DAT-USG-CDE = ' '                 04786013
047870                 SET PS-NO-CASEPK-FND TO TRUE                     04787013
047880                 SET PS-UCC128-NOT-AVAILABLE                      04788013
047890                                           TO TRUE                04789013
047900                 PERFORM 5005-PRINT-MESSAGE-LABELS                04790013
047910                                                                  04791013
047920             WHEN DISTHD-UCC128-DAT-USG-CDE = 'U'                 04792013
047930                 IF PS-LBL-REPRINT                                04793013
047940                    PERFORM 3655-REPRINT-LABELS                   04794013
047950                 ELSE                                             04795013
047960                    PERFORM 3500-GET-VIRTUAL-LABEL-DATA           04796013
047970                    IF PS-LABEL-DATA-FOUND                        04797013
047980                       IF PS-FREE-ASTRAY-MSG-LBL-NO               04798013
047990                         IF LBVRDA-CART-LBL-TYP-CDE = 'C' OR 'E'  04799013
048000                            PERFORM 3800-CHECK-RDM-BLIND-RCVNG    04800013
048010                         END-IF                                   04801013
048020                         PERFORM 3700-PRINT-VIRTUAL-LABELS        04802013
048030                       END-IF                                     04803013
048040                    ELSE                                          04804013
048050                      IF LBVRDA-INPK-CNVYB-IND = 'Y'              04805013
048060                         SET PS-INPK-CNVYB-FOUND-YES TO TRUE      04806013
048070                         PERFORM 5005-PRINT-MESSAGE-LABELS        04807013
048080                      ELSE                                        04808013
048090                         SET PS-INPK-CNVYB-FOUND-NO  TO TRUE      04809013
048100                         IF PS-UCC128-NO-LABEL-DATA               04810013
048110                            SET PS-NO-CASEPK-FND TO TRUE          04811013
048120                         ELSE                                     04812013
048130                           SET PS-UCC128-UNABLE-TO-ASSIGN         04813013
048140                               PS-NO-CASEPK-FND TO TRUE           04814013
048150                         END-IF                                   04815013
048160                         PERFORM 5005-PRINT-MESSAGE-LABELS        04816013
048170                      END-IF                                      04817013
048180                    END-IF                                        04818013
048190                 END-IF                                           04819013
048200             END-EVALUATE                                         04820013
048210       ELSE                                                       04821013
048220******* NOT FOUND ON CURSOR, NO CSEPK PERFORMED                   04822013
048230          SET PS-NO-CASEPK-FND TO TRUE                            04823013
048240          PERFORM 7235-GET-OUTER-PACK                             04824013
048250          SET PS-UCC128-GENERAL-MESS TO TRUE                      04825013
048260          PERFORM 5005-PRINT-MESSAGE-LABELS                       04826013
048270       END-IF.                                                    04827013
048280                                                                  04828013
048290*---------------------------------------------------------------* 04829013
048300* select SSCC in inbound carton database (TSHPUNT)              * 04830013
048310*                                                               * 04831013
048320*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 04832013
048330*---------------------------------------------------------------* 04833013
048340 2250-SELECT-SHPUNT.                                              04834013
048350*                                                                 04835013
048360** added internal table to track paragraph execution time         04836013
048370** dmh 2014-12-22 - begin                                         04837013
048380*                                                                 04838013
048390     MOVE  '2250'  TO  PT-CURR-PARA.                              04839013
048400     IF  PS-BLD-INTERNAL-TABLE-YES                                04840013
048410         PERFORM 0200-INTERNAL-TABLE                              04841013
048420     ELSE                                                         04842013
048430         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04843013
048440     END-IF.                                                      04844013
048450                                                                  04845013
048460*                                                                 04846013
048470** DMH 2014-12-22 - END                                           04847013
048480*                                                                 04848013
048490                                                                  04849013
048500     EXEC SQL                                                     04850013
048510         SELECT ORGN_OPER_UNT_ID,                                 04851013
048520                DEST_OPER_UNT_ID,                                 04852013
048530                SHIPT_UNT_SRC_ID,                                 04853013
048540                ACTV_IND                                          04854013
048550         INTO   :SHPUNT-ORGN-OPER-UNT-ID,                         04855013
048560                :SHPUNT-DEST-OPER-UNT-ID,                         04856013
048570                :SHPUNT-SHIPT-UNT-SRC-ID,                         04857013
048580                :SHPUNT-ACTV-IND                                  04858013
048590         FROM   TSHPUNT                                           04859013
048600         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             04860013
048610          WITH UR                                                 04861013
048620     END-EXEC.                                                    04862013
048630                                                                  04863013
048640     EVALUATE TRUE                                                04864013
048650         WHEN SQLCODE = ZERO                                      04865013
048660            IF SHPUNT-ACTV-IND = 'I'                              04866013
048670               SET PS-INACTV-CRTN-FND                             04867013
048680                   PS-CARTON-DOESNT-EXIST TO TRUE                 04868013
048690            ELSE                                                  04869013
048700              SET PS-CARTON-EXISTS TO TRUE                        04870013
048710            END-IF                                                04871013
048720                                                                  04872013
048730            IF SHPUNT-DEST-OPER-UNT-ID = 0                        04873013
048740                  MOVE SHPUNT-ORGN-OPER-UNT-ID TO                 04874013
048750                                        SHPUNT-DEST-OPER-UNT-ID   04875013
048760                                        PV-STORE                  04876013
048770                                        PV-DEST-STORE             04877013
048780            ELSE                                                  04878013
048790                  MOVE SHPUNT-DEST-OPER-UNT-ID TO PV-STORE        04879013
048800                                                  PV-DEST-STORE   04880013
048810            END-IF                                                04881013
048820            PERFORM 0500-CHECK-IF-DC                              04882013
048830         WHEN SQLCODE = +100                                      04883013
048840              SET PS-CARTON-DOESNT-EXIST TO TRUE                  04884013
048850         WHEN SQLWARN0 NOT = SPACES                               04885013
048860         WHEN SQLCODE NOT EQUAL ZERO                              04886013
048870                                                                  04887013
048880              INITIALIZE PV-CICS-MSG-AREA1                        04888013
048890              INITIALIZE PV-CICS-MSG-AREA2                        04889013
048900                                                                  04890013
048910              MOVE SQLCODE              TO PV-DISP-SQLCODE        04891013
048920              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             04892013
048930              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           04893013
048940              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        04894013
048950                                                                  04895013
048960              STRING  'SUKCS782 2250-'                            04896099
048970                      ' DC:'               PV-DISP-DC             04897013
048980                      ' B1:'               SU054-BAR-CODE-1       04898013
048990                      ' B2:'               SU054-BAR-CODE-2       04899013
049000                      ' B3:'               SU054-BAR-CODE-3       04900013
049010                                           DELIMITED BY SIZE      04901013
049020                                      INTO PV-CICS-MSG-AREA1      04902013
049030                                                                  04903013
049040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04904013
049050              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     04905013
049060                                                                  04906013
049070              PERFORM 9999-WRITE-TO-CSSL                          04907013
049080                                                                  04908013
049090              STRING  'SUKCS782 '          SU054-KOHLS-SML        04909099
049100                      ' TRIP:'             PV-DISP-TRIP           04910013
049110                      ' DR:'               SU054-DOOR-NUMBER      04911013
049120                      ' USR:'              SU054-USER-ID          04912013
049130                      ' STA:'              PV-DISP-PNA-STA        04913013
049140                      ' SQL:'              PV-DISP-SQLCODE        04914013
049150                      ' TSHPUNT'                                  04915013
049160                                           DELIMITED BY SIZE      04916013
049170                                      INTO PV-CICS-MSG-AREA2      04917013
049180                                                                  04918013
049190              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04919013
049200              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     04920013
049210                                                                  04921013
049220              PERFORM 9999-WRITE-TO-CSSL                          04922013
049230                                                                  04923013
049240              INITIALIZE PV-CICS-MSG-AREA3                        04924013
049250              MOVE SHPUNT-SHIPT-UNT-ID  TO PV-DISP-SSCC           04925013
049260                                                                  04926013
049270              STRING  'SUKCS782 '                                 04927099
049280                      ' SSCC:'             PV-DISP-SSCC           04928013
049290                                           DELIMITED BY SIZE      04929013
049300                                      INTO PV-CICS-MSG-AREA3      04930013
049310                                                                  04931013
049320              MOVE SPACES               TO PV-CICS-MSG-AREA-A     04932013
049330              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     04933013
049340                                                                  04934013
049350              PERFORM 9999-WRITE-TO-CSSL                          04935013
049360                                                                  04936013
049370             SET PS-PROCESSING-ERROR-YES TO TRUE                  04937013
049380             PERFORM 9998-WRITE-TO-CSSL                           04938013
049390     END-EVALUATE.                                                04939013
049400                                                                  04940013
049410                                                                  04941013
049420*---------------------------------------------------------------* 04942013
049430* select SSCC po-line for inbound carton (TSHUUPC)              * 04943013
049440*                                                               * 04944013
049450*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 04945013
049460*---------------------------------------------------------------* 04946013
049470 2255-SELECT-SHUUPC.                                              04947013
049480*                                                                 04948013
049490** added internal table to track paragraph execution time         04949013
049500** dmh 2014-12-22 - begin                                         04950013
049510*                                                                 04951013
049520     MOVE  '2255'  TO  PT-CURR-PARA.                              04952013
049530     IF  PS-BLD-INTERNAL-TABLE-YES                                04953013
049540         PERFORM 0200-INTERNAL-TABLE                              04954013
049550     ELSE                                                         04955013
049560         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       04956013
049570     END-IF.                                                      04957013
049580                                                                  04958013
049590*                                                                 04959013
049600** DMH 2014-12-22 - END                                           04960013
049610*                                                                 04961013
049620                                                                  04962013
049630     EXEC SQL                                                     04963013
049640         SELECT DISTINCT                                          04964013
049650                TRN_NBR                                           04965013
049660              , TRN_LNE_NBR                                       04966013
049670         INTO   :SHUUPC-TRN-NBR                                   04967013
049680              , :SHUUPC-TRN-LNE-NBR                               04968013
049690         FROM   TSHUUPC                                           04969013
049700         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             04970013
049710          WITH UR                                                 04971013
049720     END-EXEC.                                                    04972013
049730                                                                  04973013
049740     EVALUATE TRUE                                                04974013
049750         WHEN SQLCODE = ZERO                                      04975013
049760             MOVE SHUUPC-TRN-NBR     TO PV-PO-NBR                 04976013
049770                                        PV-DISPLAY-PO             04977013
049780             MOVE SHUUPC-TRN-LNE-NBR TO                           04978013
049790                                        PV-PO-LINE-N              04979013
049800                                        DK-PO-LNE-NBR             04980013
049810                                        PV-DISP-line              04981013
049820         WHEN SQLCODE = -811                                      04982013
049830             MOVE SHUUPC-TRN-NBR     TO PV-PO-NBR                 04983013
049840             SET  PS-MULTI-LINE      TO TRUE                      04984013
049850         WHEN SQLCODE = +100                                      04985013
049860             SET  PS-NO-LINE              TO  TRUE                04986013
049870         WHEN SQLWARN0 NOT = SPACES                               04987013
049880         WHEN SQLCODE NOT EQUAL ZERO                              04988013
049890                                                                  04989013
049900              INITIALIZE PV-CICS-MSG-AREA1                        04990013
049910              INITIALIZE PV-CICS-MSG-AREA2                        04991013
049920                                                                  04992013
049930              MOVE SQLCODE              TO PV-DISP-SQLCODE        04993013
049940              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             04994013
049950              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           04995013
049960              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        04996013
049970                                                                  04997013
049980              STRING  'SUKCS782 2255-'                            04998099
049990                      ' DC:'               PV-DISP-DC             04999013
050000                      ' B1:'               SU054-BAR-CODE-1       05000013
050010                      ' B2:'               SU054-BAR-CODE-2       05001013
050020                      ' B3:'               SU054-BAR-CODE-3       05002013
050030                                           DELIMITED BY SIZE      05003013
050040                                      INTO PV-CICS-MSG-AREA1      05004013
050050                                                                  05005013
050060              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05006013
050070              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05007013
050080                                                                  05008013
050090              PERFORM 9999-WRITE-TO-CSSL                          05009013
050100                                                                  05010013
050110              STRING  'SUKCS782 '          SU054-KOHLS-SML        05011099
050120                      ' TRIP:'             PV-DISP-TRIP           05012013
050130                      ' DR:'               SU054-DOOR-NUMBER      05013013
050140                      ' USR:'              SU054-USER-ID          05014013
050150                      ' STA:'              PV-DISP-PNA-STA        05015013
050160                      ' SQL:'              PV-DISP-SQLCODE        05016013
050170                      ' TSHUUPC'                                  05017013
050180                                           DELIMITED BY SIZE      05018013
050190                                      INTO PV-CICS-MSG-AREA2      05019013
050200                                                                  05020013
050210              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05021013
050220              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05022013
050230                                                                  05023013
050240              PERFORM 9999-WRITE-TO-CSSL                          05024013
050250                                                                  05025013
050260              INITIALIZE PV-CICS-MSG-AREA3                        05026013
050270              MOVE SHPUNT-SHIPT-UNT-ID  TO PV-DISP-SSCC           05027060
050280                                                                  05028013
050290              STRING  'SUKCS782 '                                 05029099
050300                      ' SSCC:'             PV-DISP-SSCC           05030013
050310                                           DELIMITED BY SIZE      05031013
050320                                      INTO PV-CICS-MSG-AREA3      05032013
050330                                                                  05033013
050340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05034013
050350              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05035013
050360                                                                  05036013
050370              PERFORM 9999-WRITE-TO-CSSL                          05037013
050380                                                                  05038013
050390             SET PS-PROCESSING-ERROR-YES TO TRUE                  05039013
050400             PERFORM 9998-WRITE-TO-CSSL                           05040013
050410     END-EVALUATE.                                                05041013
050420                                                                  05042013
050430                                                                  05043013
050440*---------------------------------------------------------------* 05044013
050450* check to see carton previously checked in (TSHUNLO)           * 05045013
050460*                                                               * 05046013
050470*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 05047013
050480*---------------------------------------------------------------* 05048013
050490 2260-SELECT-TSHUNLO.                                             05049013
050500*                                                                 05050013
050510** added internal table to track paragraph execution time         05051013
050520** dmh 2014-12-22 - begin                                         05052013
050530*                                                                 05053013
050540     MOVE  '2260'  TO  PT-CURR-PARA.                              05054013
050550     IF  PS-BLD-INTERNAL-TABLE-YES                                05055013
050560         PERFORM 0200-INTERNAL-TABLE                              05056013
050570     ELSE                                                         05057013
050580         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05058013
050590     END-IF.                                                      05059013
050600                                                                  05060013
050610*                                                                 05061013
050620** DMH 2014-12-22 - END                                           05062013
050630*                                                                 05063013
050640                                                                  05064013
050650     INITIALIZE PV-DB2-COUNT.                                     05065013
050660                                                                  05066013
050670     EXEC SQL                                                     05067013
050680         SELECT  TRIP_ID                                          05068013
050690         INTO   :SHUNLO-TRIP-ID                                   05069013
050700         FROM   TSHUNLO                                           05070013
050710         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             05071013
050720           AND  SCN_LOC_ID     = :PC-RECV                         05072013
050730     END-EXEC.                                                    05073013
050740                                                                  05074013
050750     EVALUATE TRUE                                                05075013
050760         WHEN SQLCODE = ZERO                                      05076013
050770         WHEN SQLCODE = -811                                      05077013
050780              MOVE +1 TO PV-DB2-COUNT                             05078013
050790         WHEN SQLCODE = +100                                      05079013
050800              CONTINUE                                            05080013
050810         WHEN SQLWARN0 NOT = SPACES                               05081013
050820         WHEN SQLCODE NOT EQUAL ZERO                              05082013
050830                                                                  05083013
050840              INITIALIZE PV-CICS-MSG-AREA1                        05084013
050850              INITIALIZE PV-CICS-MSG-AREA2                        05085013
050860                                                                  05086013
050870              MOVE SQLCODE              TO PV-DISP-SQLCODE        05087013
050880              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             05088013
050890              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           05089013
050900              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        05090013
050910                                                                  05091013
050920              STRING  'SUKCS782 2260-'                            05092099
050930                      ' DC:'               PV-DISP-DC             05093013
050940                      ' B1:'               SU054-BAR-CODE-1       05094013
050950                      ' B2:'               SU054-BAR-CODE-2       05095013
050960                      ' B3:'               SU054-BAR-CODE-3       05096013
050970                                           DELIMITED BY SIZE      05097013
050980                                      INTO PV-CICS-MSG-AREA1      05098013
050990                                                                  05099013
051000              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05100013
051010              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05101013
051020                                                                  05102013
051030              PERFORM 9999-WRITE-TO-CSSL                          05103013
051040                                                                  05104013
051050              STRING  'SUKCS782 '          SU054-KOHLS-SML        05105099
051060                      ' TRIP:'             PV-DISP-TRIP           05106013
051070                      ' DR:'               SU054-DOOR-NUMBER      05107013
051080                      ' USR:'              SU054-USER-ID          05108013
051090                      ' STA:'              PV-DISP-PNA-STA        05109013
051100                      ' SQL:'              PV-DISP-SQLCODE        05110013
051110                      ' TSHUNLO'                                  05111013
051120                                           DELIMITED BY SIZE      05112013
051130                                      INTO PV-CICS-MSG-AREA2      05113013
051140                                                                  05114013
051150              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05115013
051160              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05116013
051170                                                                  05117013
051180              PERFORM 9999-WRITE-TO-CSSL                          05118013
051190                                                                  05119013
051200              INITIALIZE PV-CICS-MSG-AREA3                        05120013
051210              MOVE SHPUNT-SHIPT-UNT-ID  TO PV-DISP-SSCC           05121013
051220                                                                  05122013
051230              STRING  'SUKCS782 '                                 05123099
051240                      ' SSCC:'             PV-DISP-SSCC           05124013
051250                      ' PC-RECV:'          PC-RECV                05125013
051260                                           DELIMITED BY SIZE      05126013
051270                                      INTO PV-CICS-MSG-AREA3      05127013
051280                                                                  05128013
051290              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05129013
051300              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05130013
051310                                                                  05131013
051320              PERFORM 9999-WRITE-TO-CSSL                          05132013
051330                                                                  05133013
051340             SET PS-PROCESSING-ERROR-YES TO TRUE                  05134013
051350             PERFORM 9998-WRITE-TO-CSSL                           05135013
051360     END-EVALUATE.                                                05136013
051370                                                                  05137013
051380                                                                  05138013
051390*---------------------------------------------------------------* 05139013
051400*                                                               * 05140013
051410*                                                               * 05141013
051420*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 05142013
051430*---------------------------------------------------------------* 05143013
051440* 07/19/13 RLK BEG                                                05144013
051450 2262-SELECT-CRTN-LBL-TSHUNLO.                                    05145013
051460*                                                                 05146013
051470** added internal table to track paragraph execution time         05147013
051480** dmh 2014-12-22 - begin                                         05148013
051490*                                                                 05149013
051500     MOVE  '2262'  TO  PT-CURR-PARA.                              05150013
051510     IF  PS-BLD-INTERNAL-TABLE-YES                                05151013
051520         PERFORM 0200-INTERNAL-TABLE                              05152013
051530     ELSE                                                         05153013
051540         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05154013
051550     END-IF.                                                      05155013
051560                                                                  05156013
051570*                                                                 05157013
051580** DMH 2014-12-22 - END                                           05158013
051590*                                                                 05159013
051600                                                                  05160013
051610     INITIALIZE PV-DB2-COUNT.                                     05161013
051620                                                                  05162013
051630     EXEC SQL                                                     05163013
051640         SELECT  TRIP_ID                                          05164013
051650                ,SCN_LOC_ID                                       05165013
051660         INTO   :SHUNLO-TRIP-ID                                   05166013
051670               ,:SHUNLO-SCN-LOC-ID                                05167013
051680         FROM   TSHUNLO A                                         05168013
051690         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             05169013
051700           AND A.SCN_LOC_ID  LIKE ('RFD%')                        05170013
051710           AND A.ACTV_CDE  = :PC-I                                05171013
051720           AND A.CRE_TMST =                                       05172013
051730              (SELECT MAX(B.CRE_TMST)                             05173013
051740               FROM TSHUNLO B                                     05174013
051750               WHERE  B.SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID     05175013
051760                 AND  B.ACTV_CDE  =:PC-I                          05176013
051770                 AND B.SCN_LOC_ID  LIKE ('RFD%'))                 05177013
051780     END-EXEC.                                                    05178013
051790                                                                  05179013
051800     EVALUATE TRUE                                                05180013
051810         WHEN SQLCODE = ZERO                                      05181013
051820         WHEN SQLCODE = -811                                      05182013
051830              MOVE +1 TO PV-DB2-COUNT                             05183013
051840         WHEN SQLCODE = +100                                      05184013
051850             MOVE SPACE TO SHUNLO-SCN-LOC-ID                      05185013
051860         WHEN SQLWARN0 NOT = SPACES                               05186013
051870         WHEN SQLCODE NOT EQUAL ZERO                              05187013
051880                                                                  05188013
051890              INITIALIZE PV-CICS-MSG-AREA1                        05189013
051900              INITIALIZE PV-CICS-MSG-AREA2                        05190013
051910                                                                  05191013
051920              MOVE SQLCODE              TO PV-DISP-SQLCODE        05192013
051930              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             05193013
051940              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           05194013
051950              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        05195013
051960                                                                  05196013
051970              STRING  'SUKCS782 2262-'                            05197099
051980                      ' DC:'               PV-DISP-DC             05198013
051990                      ' B1:'               SU054-BAR-CODE-1       05199013
052000                      ' B2:'               SU054-BAR-CODE-2       05200013
052010                      ' B3:'               SU054-BAR-CODE-3       05201013
052020                                           DELIMITED BY SIZE      05202013
052030                                      INTO PV-CICS-MSG-AREA1      05203013
052040                                                                  05204013
052050              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05205013
052060              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05206013
052070                                                                  05207013
052080              PERFORM 9999-WRITE-TO-CSSL                          05208013
052090                                                                  05209013
052100              STRING  'SUKCS782 '          SU054-KOHLS-SML        05210099
052110                      ' TRIP:'             PV-DISP-TRIP           05211013
052120                      ' DR:'               SU054-DOOR-NUMBER      05212013
052130                      ' USR:'              SU054-USER-ID          05213013
052140                      ' STA:'              PV-DISP-PNA-STA        05214013
052150                      ' SQL:'              PV-DISP-SQLCODE        05215013
052160                      ' TSHUNLO'                                  05216013
052170                                           DELIMITED BY SIZE      05217013
052180                                      INTO PV-CICS-MSG-AREA2      05218013
052190                                                                  05219013
052200              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05220013
052210              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05221013
052220                                                                  05222013
052230              PERFORM 9999-WRITE-TO-CSSL                          05223013
052240                                                                  05224013
052250              INITIALIZE PV-CICS-MSG-AREA3                        05225013
052260              MOVE SHPUNT-SHIPT-UNT-ID  TO PV-DISP-SSCC           05226013
052270                                                                  05227013
052280              STRING  'SUKCS782 '                                 05228099
052290                      ' SSCC:'             PV-DISP-SSCC           05229013
052300                      ' PC-I:'             PC-I                   05230013
052310                                           DELIMITED BY SIZE      05231013
052320                                      INTO PV-CICS-MSG-AREA3      05232013
052330                                                                  05233013
052340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05234013
052350              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05235013
052360                                                                  05236013
052370              PERFORM 9999-WRITE-TO-CSSL                          05237013
052380                                                                  05238013
052390             SET PS-PROCESSING-ERROR-YES TO TRUE                  05239013
052400             PERFORM 9998-WRITE-TO-CSSL                           05240013
052410     END-EVALUATE.                                                05241013
052420                                                                  05242013
052430                                                                  05243013
052440*---------------------------------------------------------------* 05244013
052450*                                                               * 05245013
052460*                                                               * 05246013
052470*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 05247013
052480*---------------------------------------------------------------* 05248013
052490 2265-CHECK-INACTV-PBS.                                           05249013
052500*                                                                 05250013
052510** added internal table to track paragraph execution time         05251013
052520** dmh 2014-12-22 - begin                                         05252013
052530*                                                                 05253013
052540     MOVE  '2265'  TO  PT-CURR-PARA.                              05254013
052550     IF  PS-BLD-INTERNAL-TABLE-YES                                05255013
052560         PERFORM 0200-INTERNAL-TABLE                              05256013
052570     ELSE                                                         05257013
052580         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05258013
052590     END-IF.                                                      05259013
052600                                                                  05260013
052610*                                                                 05261013
052620** DMH 2014-12-22 - END                                           05262013
052630*                                                                 05263013
052640                                                                  05264013
052650     EXEC SQL                                                     05265013
052660         SELECT  CRE_TMST                                         05266013
052670               , SCN_LOC_ID                                       05267013
052680         INTO   :PV-TSHUNLO-PBS-CRE-TMST :PV-NULL-CRE-TMST        05268013
052690               ,:PV-PBS-SCN-LOC-ID                                05269013
052700         FROM   TSHUNLO                                           05270013
052710         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             05271013
052720           AND  SCN_LOC_ID                                        05272013
052730                       IN ('PBSA','PBSB','PBSC','PBSD','PBSE')    05273013
052740          WITH UR                                                 05274013
052750     END-EXEC.                                                    05275013
052760                                                                  05276013
052770     EVALUATE TRUE                                                05277013
052780         WHEN SQLCODE = ZERO                                      05278013
052790         WHEN SQLCODE = -811                                      05279013
052800             IF PV-NULL-CRE-TMST = -1                             05280013
052810                SET PS-INACTV-PBS-CARTON-NO TO TRUE               05281013
052820             ELSE                                                 05282013
052830                SET PS-INACTV-PBS-CARTON-YES TO TRUE              05283013
052840                MOVE PV-TSHUNLO-PBS-CRE-TMST TO                   05284013
052850                                            PV-TSHUNLO-PBS-TMST-R 05285013
052860                MOVE SPACES          TO PV-PBS-TMST-SPACE         05286013
052870                                        PV-PBS-TMST-SPACE-2       05287013
052880                MOVE PC-COLON        TO PV-PBS-TMST-COLON         05288013
052890             END-IF                                               05289013
052900         WHEN SQLCODE = +100                                      05290013
052910                SET PS-INACTV-PBS-CARTON-NO TO TRUE               05291013
052920         WHEN SQLWARN0 NOT = SPACES                               05292013
052930         WHEN SQLCODE NOT EQUAL ZERO                              05293013
052940                                                                  05294013
052950              INITIALIZE PV-CICS-MSG-AREA1                        05295013
052960              INITIALIZE PV-CICS-MSG-AREA2                        05296013
052970                                                                  05297013
052980              MOVE SQLCODE              TO PV-DISP-SQLCODE        05298013
052990              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             05299013
053000              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           05300013
053010              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        05301013
053020                                                                  05302013
053030              STRING  'SUKCS782 2265-'                            05303099
053040                      ' DC:'               PV-DISP-DC             05304013
053050                      ' B1:'               SU054-BAR-CODE-1       05305013
053060                      ' B2:'               SU054-BAR-CODE-2       05306013
053070                      ' B3:'               SU054-BAR-CODE-3       05307013
053080                                           DELIMITED BY SIZE      05308013
053090                                      INTO PV-CICS-MSG-AREA1      05309013
053100                                                                  05310013
053110              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05311013
053120              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05312013
053130                                                                  05313013
053140              PERFORM 9999-WRITE-TO-CSSL                          05314013
053150                                                                  05315013
053160              STRING  'SUKCS782 '          SU054-KOHLS-SML        05316099
053170                      ' TRIP:'             PV-DISP-TRIP           05317013
053180                      ' DR:'               SU054-DOOR-NUMBER      05318013
053190                      ' USR:'              SU054-USER-ID          05319013
053200                      ' STA:'              PV-DISP-PNA-STA        05320013
053210                      ' SQL:'              PV-DISP-SQLCODE        05321013
053220                      ' TSHUNLO'                                  05322013
053230                                           DELIMITED BY SIZE      05323013
053240                                      INTO PV-CICS-MSG-AREA2      05324013
053250                                                                  05325013
053260              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05326013
053270              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05327013
053280                                                                  05328013
053290              PERFORM 9999-WRITE-TO-CSSL                          05329013
053300                                                                  05330013
053310              INITIALIZE PV-CICS-MSG-AREA3                        05331013
053320              MOVE SHPUNT-SHIPT-UNT-ID  TO PV-DISP-SSCC           05332013
053330                                                                  05333013
053340              STRING  'SUKCS782 '                                 05334099
053350                      ' SSCC:'             PV-DISP-SSCC           05335013
053360                                           DELIMITED BY SIZE      05336013
053370                                      INTO PV-CICS-MSG-AREA3      05337013
053380                                                                  05338013
053390              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05339013
053400              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05340013
053410                                                                  05341013
053420              PERFORM 9999-WRITE-TO-CSSL                          05342013
053430                                                                  05343013
053440             SET PS-PROCESSING-ERROR-YES TO TRUE                  05344013
053450             PERFORM 9998-WRITE-TO-CSSL                           05345013
053460     END-EVALUATE.                                                05346013
053470                                                                  05347013
053480 2270-INSERT-TSHUNLO.                                             05348013
053490*                                                                 05349013
053500** added internal table to track paragraph execution time         05350013
053510** dmh 2014-12-22 - begin                                         05351013
053520*                                                                 05352013
053530     MOVE  '2270'  TO  PT-CURR-PARA.                              05353013
053540     IF  PS-BLD-INTERNAL-TABLE-YES                                05354013
053550         PERFORM 0200-INTERNAL-TABLE                              05355013
053560     ELSE                                                         05356013
053570         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05357013
053580     END-IF.                                                      05358013
053590                                                                  05359013
053600*                                                                 05360013
053610** DMH 2014-12-22 - END                                           05361013
053620*                                                                 05362013
053630                                                                  05363013
053640     MOVE  +1                   TO  DK-FCLTY-ID.                  05364013
053650     MOVE  SU054-TRIP-ID        TO  DK-MANIFEST.                  05365013
053660     MOVE  PV-BATCH-NUMBER      TO  DK-BATCH-NUMBER.              05366013
053670     MOVE  PC-R                 TO  SHUNLO-PRTR-TYP-CDE.          05367013
053680     MOVE PC-A                  TO  SHUNLO-ACTV-CDE               05368013
053690     MOVE PC-RECV               TO  SHUNLO-SCN-LOC-ID             05369013
053700     MOVE SU054-DC-NUMBER       TO  SHUNLO-OPER-UNT-ID            05370013
053710                                                                  05371013
053720     EXEC SQL                                                     05372013
053730         INSERT INTO TSHUNLO                                      05373013
053740               (SHIPT_UNT_ID                                      05374013
053750              , OPER_UNT_ID                                       05375013
053760              , FCLTY_ID                                          05376013
053770              , SCN_LOC_ID                                        05377013
053780              , CRE_USR_ID                                        05378013
053790              , CRE_TMST                                          05379013
053800              , TRIP_ID                                           05380013
053810              , PRTR_TYP_CDE                                      05381013
053820              , LBL_PRT_BTCH_ID                                   05382013
053830              , ACTV_CDE)                                         05383013
053840         VALUES (:SHPUNT-SHIPT-UNT-ID                             05384013
053850               , :SHUNLO-OPER-UNT-ID                              05385013
053860               , :DK-FCLTY-ID                                     05386013
053870               , :PC-RECV                                         05387013
053880               , :SU054-USER-ID                                   05388013
053890               , CURRENT TIMESTAMP                                05389013
053900               , :DK-MANIFEST                                     05390013
053910               , :SHUNLO-PRTR-TYP-CDE                             05391013
053920               , :DK-BATCH-NUMBER                                 05392013
053930               , :SHUNLO-ACTV-CDE)                                05393013
053940     END-EXEC.                                                    05394013
053950                                                                  05395013
053960     EVALUATE TRUE                                                05396013
053970         WHEN SQLCODE = ZERO                                      05397013
053980             PERFORM 3569-SEL-MAX-CHECK-IN-TMST                   05398013
053990         WHEN SQLWARN0 NOT = SPACES                               05399013
054000         WHEN SQLCODE NOT EQUAL ZERO                              05400013
054010                                                                  05401013
054020              INITIALIZE PV-CICS-MSG-AREA1                        05402013
054030              INITIALIZE PV-CICS-MSG-AREA2                        05403013
054040                                                                  05404013
054050              MOVE SQLCODE              TO PV-DISP-SQLCODE        05405013
054060              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             05406013
054070              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           05407013
054080              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        05408013
054090                                                                  05409013
054100              STRING  'SUKCS782 2270-'                            05410099
054110                      ' DC:'               PV-DISP-DC             05411013
054120                      ' B1:'               SU054-BAR-CODE-1       05412013
054130                      ' B2:'               SU054-BAR-CODE-2       05413013
054140                      ' B3:'               SU054-BAR-CODE-3       05414013
054150                                           DELIMITED BY SIZE      05415013
054160                                      INTO PV-CICS-MSG-AREA1      05416013
054170                                                                  05417013
054180              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05418013
054190              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05419013
054200                                                                  05420013
054210              PERFORM 9999-WRITE-TO-CSSL                          05421013
054220                                                                  05422013
054230              STRING  'SUKCS782 '          SU054-KOHLS-SML        05423099
054240                      ' TRIP:'             PV-DISP-TRIP           05424013
054250                      ' DR:'               SU054-DOOR-NUMBER      05425013
054260                      ' USR:'              SU054-USER-ID          05426013
054270                      ' STA:'              PV-DISP-PNA-STA        05427013
054280                      ' SQL:'              PV-DISP-SQLCODE        05428013
054290                      ' TSHUNLO'                                  05429013
054300                                           DELIMITED BY SIZE      05430013
054310                                      INTO PV-CICS-MSG-AREA2      05431013
054320                                                                  05432013
054330              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05433013
054340              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05434013
054350                                                                  05435013
054360              PERFORM 9999-WRITE-TO-CSSL                          05436013
054370                                                                  05437013
054380              INITIALIZE PV-CICS-MSG-AREA3                        05438013
054390              MOVE  SHPUNT-SHIPT-UNT-ID TO PV-DISP-SSCC           05439013
054400              MOVE  SHUNLO-OPER-UNT-ID  TO PV-DISP-OPER           05440013
054410              MOVE  DK-FCLTY-ID         TO PV-DISP-FCLTY          05441013
054420              MOVE  DK-MANIFEST         TO PV-DISP-TRIP           05442013
054430              MOVE  DK-BATCH-NUMBER     TO PV-DISP-BATCH          05443013
054440                                                                  05444013
054450              STRING  'SUKCS782 '                                 05445099
054460                      ' '                  PV-DISP-SSCC           05446013
054470                      '-'                  PV-DISP-OPER           05447013
054480                      '-'                  PV-DISP-FCLTY          05448013
054490                      '-'                  PC-RECV                05449013
054500                      '-'                  SU054-USER-ID          05450013
054510                      '-'                  PV-DISP-TRIP           05451013
054520                      '-'                  SHUNLO-PRTR-TYP-CDE    05452013
054530                      '-'                  PV-DISP-BATCH          05453013
054540                      '-'                  SHUNLO-ACTV-CDE        05454013
054550                      '-'                  DELIMITED BY SIZE      05455013
054560                                      INTO PV-CICS-MSG-AREA3      05456013
054570                                                                  05457013
054580              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05458013
054590              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05459013
054600                                                                  05460013
054610              PERFORM 9999-WRITE-TO-CSSL                          05461013
054620                                                                  05462013
054630             SET PS-PROCESSING-ERROR-YES TO TRUE                  05463013
054640             PERFORM 9998-WRITE-TO-CSSL                           05464013
054650     END-EVALUATE.                                                05465013
054660                                                                  05466013
054670* 07/19/13 RLK BEG                                                05467013
054680 2275-INSERT-CRTN-LBL-TSHUNLO.                                    05468013
054690*                                                                 05469013
054700** added internal table to track paragraph execution time         05470013
054710** dmh 2014-12-22 - begin                                         05471013
054720*                                                                 05472013
054730     MOVE  '2275'  TO  PT-CURR-PARA.                              05473013
054740     IF  PS-BLD-INTERNAL-TABLE-YES                                05474013
054750         PERFORM 0200-INTERNAL-TABLE                              05475013
054760     ELSE                                                         05476013
054770         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05477013
054780     END-IF.                                                      05478013
054790                                                                  05479013
054800*                                                                 05480013
054810** DMH 2014-12-22 - END                                           05481013
054820*                                                                 05482013
054830                                                                  05483013
054840     MOVE  1                    TO  DK-FCLTY-ID.                  05484013
054850     MOVE  SU054-TRIP-ID        TO  DK-MANIFEST.                  05485013
054860     MOVE  PV-BATCH-NUMBER      TO  DK-BATCH-NUMBER.              05486013
054870     MOVE PC-N                  TO  SHUNLO-PRTR-TYP-CDE.          05487013
054880     MOVE 999999999             TO  DK-MANIFEST.                  05488013
054890     MOVE PC-I                  TO  SHUNLO-ACTV-CDE               05489013
054900     MOVE PC-RFDC               TO  SHUNLO-SCN-LOC-ID             05490013
054910     MOVE 0                     TO  DK-BATCH-NUMBER.              05491013
054920                                                                  05492013
054930                                                                  05493013
054940     EXEC SQL                                                     05494013
054950         INSERT INTO TSHUNLO                                      05495013
054960               (SHIPT_UNT_ID                                      05496013
054970              , OPER_UNT_ID                                       05497013
054980              , FCLTY_ID                                          05498013
054990              , SCN_LOC_ID                                        05499013
055000              , CRE_USR_ID                                        05500013
055010              , CRE_TMST                                          05501013
055020              , TRIP_ID                                           05502013
055030              , PRTR_TYP_CDE                                      05503013
055040              , LBL_PRT_BTCH_ID                                   05504013
055050              , ACTV_CDE)                                         05505013
055060         VALUES (:SHPUNT-SHIPT-UNT-ID                             05506013
055070               , :SHUNLO-OPER-UNT-ID                              05507013
055080               , :DK-FCLTY-ID                                     05508013
055090               , :SHUNLO-SCN-LOC-ID                               05509013
055100               , :SU054-USER-ID                                   05510013
055110               , CURRENT TIMESTAMP                                05511013
055120               , :DK-MANIFEST                                     05512013
055130               , :SHUNLO-PRTR-TYP-CDE                             05513013
055140               , :DK-BATCH-NUMBER                                 05514013
055150               , :SHUNLO-ACTV-CDE)                                05515013
055160     END-EXEC.                                                    05516013
055170                                                                  05517013
055180     EVALUATE TRUE                                                05518013
055190         WHEN SQLCODE = ZERO                                      05519013
055200             PERFORM 3569-SEL-MAX-CHECK-IN-TMST                   05520013
055210         WHEN SQLWARN0 NOT = SPACES                               05521013
055220         WHEN SQLCODE NOT EQUAL ZERO                              05522013
055230                                                                  05523013
055240              INITIALIZE PV-CICS-MSG-AREA1                        05524013
055250              INITIALIZE PV-CICS-MSG-AREA2                        05525013
055260                                                                  05526013
055270              MOVE SQLCODE              TO PV-DISP-SQLCODE        05527013
055280              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             05528013
055290              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           05529013
055300              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        05530013
055310                                                                  05531013
055320              STRING  'SUKCS782 2275-'                            05532099
055330                      ' DC:'               PV-DISP-DC             05533013
055340                      ' B1:'               SU054-BAR-CODE-1       05534013
055350                      ' B2:'               SU054-BAR-CODE-2       05535013
055360                      ' B3:'               SU054-BAR-CODE-3       05536013
055370                                           DELIMITED BY SIZE      05537013
055380                                      INTO PV-CICS-MSG-AREA1      05538013
055390                                                                  05539013
055400              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05540013
055410              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05541013
055420                                                                  05542013
055430              PERFORM 9999-WRITE-TO-CSSL                          05543013
055440                                                                  05544013
055450              STRING  'SUKCS782 '          SU054-KOHLS-SML        05545099
055460                      ' TRIP:'             PV-DISP-TRIP           05546013
055470                      ' DR:'               SU054-DOOR-NUMBER      05547013
055480                      ' USR:'              SU054-USER-ID          05548013
055490                      ' STA:'              PV-DISP-PNA-STA        05549013
055500                      ' SQL:'              PV-DISP-SQLCODE        05550013
055510                      ' TSHUNLO'                                  05551013
055520                                           DELIMITED BY SIZE      05552013
055530                                      INTO PV-CICS-MSG-AREA2      05553013
055540                                                                  05554013
055550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05555013
055560              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05556013
055570                                                                  05557013
055580              PERFORM 9999-WRITE-TO-CSSL                          05558013
055590                                                                  05559013
055600              INITIALIZE PV-CICS-MSG-AREA3                        05560013
055610              MOVE  SHPUNT-SHIPT-UNT-ID TO PV-DISP-SSCC           05561013
055620              MOVE  SHUNLO-OPER-UNT-ID  TO PV-DISP-OPER           05562013
055630              MOVE  DK-FCLTY-ID         TO PV-DISP-FCLTY          05563013
055640              MOVE  DK-MANIFEST         TO PV-DISP-TRIP           05564013
055650              MOVE  DK-BATCH-NUMBER     TO PV-DISP-BATCH          05565013
055660                                                                  05566013
055670              STRING  'SUKCS782 '                                 05567099
055680                      ' '                  PV-DISP-SSCC           05568013
055690                      '-'                  PV-DISP-OPER           05569013
055700                      '-'                  PV-DISP-FCLTY          05570013
055710                      '-'                  SHUNLO-SCN-LOC-ID      05571013
055720                      '-'                  SU054-USER-ID          05572013
055730                      '-'                  PV-DISP-TRIP           05573013
055740                      '-'                  SHUNLO-PRTR-TYP-CDE    05574013
055750                      '-'                  PV-DISP-BATCH          05575013
055760                      '-'                  SHUNLO-ACTV-CDE        05576013
055770                      '-'                  DELIMITED BY SIZE      05577013
055780                                      INTO PV-CICS-MSG-AREA3      05578013
055790                                                                  05579013
055800              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05580013
055810              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05581013
055820                                                                  05582013
055830              PERFORM 9999-WRITE-TO-CSSL                          05583013
055840                                                                  05584013
055850             SET PS-PROCESSING-ERROR-YES TO TRUE                  05585013
055860             PERFORM 9998-WRITE-TO-CSSL                           05586013
055870     END-EVALUATE.                                                05587013
055880                                                                  05588013
055890                                                                  05589013
055900*---------------------------------------------------------------* 05590013
055910*                                                               * 05591013
055920*                                                               * 05592013
055930*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 05593013
055940*---------------------------------------------------------------* 05594013
055950******************************************************************05595013
055960 2280-SELECT-STORE-FROM-XREF.                                     05596013
055970******************************************************************05597013
055980*                                                                 05598013
055990** added internal table to track paragraph execution time         05599013
056000** dmh 2014-12-22 - begin                                         05600013
056010*                                                                 05601013
056020     MOVE  '2280'  TO  PT-CURR-PARA.                              05602013
056030     IF  PS-BLD-INTERNAL-TABLE-YES                                05603013
056040         PERFORM 0200-INTERNAL-TABLE                              05604013
056050     ELSE                                                         05605013
056060         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05606013
056070     END-IF.                                                      05607013
056080                                                                  05608013
056090*                                                                 05609013
056100** DMH 2014-12-22 - END                                           05610013
056110*                                                                 05611013
056120                                                                  05612013
056130     EXEC SQL                                                     05613013
056140         SELECT  DEST_OPER_UNT_ID                                 05614013
056150         INTO   :SULBXF-DEST-OPER-UNT-ID                          05615013
056160         FROM   TSULBXF                                           05616013
056170         WHERE  SHIPT_UNT_ID   = :DK-CTN                          05617013
056180           AND  STAT_CDE       = 'A'                              05618013
056190     END-EXEC.                                                    05619013
056200                                                                  05620013
056210     EVALUATE TRUE                                                05621013
056220         WHEN SQLCODE = ZERO                                      05622013
056230         WHEN SQLCODE = -811                                      05623013
056240             MOVE SULBXF-DEST-OPER-UNT-ID TO PV-DEST-STORE        05624013
056250             SET PS-SULBXF-ROW-FOUND                              05625013
056260                 PS-LBL-REPRINT                                   05626013
056270                 PS-REPRINT       TO TRUE                         05627013
056280         WHEN SQLCODE = +100                                      05628013
056290             SET PS-NO-SULBXF-ROW-FOUND TO TRUE                   05629013
056300         WhEN SQLWARN0 NOT = SPACES                               05630013
056310         WHEN SQLCODE NOT EQUAL ZERO                              05631013
056320                                                                  05632013
056330              INITIALIZE PV-CICS-MSG-AREA1                        05633013
056340              INITIALIZE PV-CICS-MSG-AREA2                        05634013
056350                                                                  05635013
056360              MOVE SQLCODE              TO PV-DISP-SQLCODE        05636013
056370              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             05637013
056380              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           05638013
056390              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        05639013
056400                                                                  05640013
056410              STRING  'SUKCS782 2280-'                            05641099
056420                      ' DC:'               PV-DISP-DC             05642013
056430                      ' B1:'               SU054-BAR-CODE-1       05643013
056440                      ' B2:'               SU054-BAR-CODE-2       05644013
056450                      ' B3:'               SU054-BAR-CODE-3       05645013
056460                                           DELIMITED BY SIZE      05646013
056470                                      INTO PV-CICS-MSG-AREA1      05647013
056480                                                                  05648013
056490              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05649013
056500              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05650013
056510                                                                  05651013
056520              PERFORM 9999-WRITE-TO-CSSL                          05652013
056530                                                                  05653013
056540              STRING  'SUKCS782 '          SU054-KOHLS-SML        05654099
056550                      ' TRIP:'             PV-DISP-TRIP           05655013
056560                      ' DR:'               SU054-DOOR-NUMBER      05656013
056570                      ' USR:'              SU054-USER-ID          05657013
056580                      ' STA:'              PV-DISP-PNA-STA        05658013
056590                      ' SQL:'              PV-DISP-SQLCODE        05659013
056600                      ' TSULBXF'                                  05660013
056610                                           DELIMITED BY SIZE      05661013
056620                                      INTO PV-CICS-MSG-AREA2      05662013
056630                                                                  05663013
056640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05664013
056650              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05665013
056660                                                                  05666013
056670              PERFORM 9999-WRITE-TO-CSSL                          05667013
056680                                                                  05668013
056690              INITIALIZE PV-CICS-MSG-AREA3                        05669013
056700              MOVE  DK-CTN              TO PV-DISP-SSCC           05670013
056710                                                                  05671013
056720              STRING  'SUKCS782 '                                 05672099
056730                      ' SSCC:'             PV-DISP-SSCC           05673013
056740                                           DELIMITED BY SIZE      05674013
056750                                      INTO PV-CICS-MSG-AREA3      05675013
056760                                                                  05676013
056770              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05677013
056780              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05678013
056790                                                                  05679013
056800              PERFORM 9999-WRITE-TO-CSSL                          05680013
056810                                                                  05681013
056820             SET PS-PROCESSING-ERROR-YES TO TRUE                  05682013
056830             PERFORM 9998-WRITE-TO-CSSL                           05683013
056840     END-EVALUATE.                                                05684013
056850                                                                  05685013
056860                                                                  05686013
056870                                                                  05687013
056880 2285-CALL-DLKUP001-ASGMT-MOD.                                    05688013
056890*                                                                 05689013
056900** added internal table to track paragraph execution time         05690013
056910** dmh 2014-12-22 - begin                                         05691013
056920*                                                                 05692013
056930     MOVE  '2285'  TO  PT-CURR-PARA.                              05693013
056940     IF  PS-BLD-INTERNAL-TABLE-YES                                05694013
056950         PERFORM 0200-INTERNAL-TABLE                              05695013
056960     ELSE                                                         05696013
056970         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05697013
056980     END-IF.                                                      05698013
056990                                                                  05699013
057000*                                                                 05700013
057010** DMH 2014-12-22 - END                                           05701013
057020*                                                                 05702013
057030                                                                  05703013
057040     INITIALIZE DL001-ASGMT-COMMAREA.                             05704013
057050     SET DL001-BY-ASGMT-KEY                                       05705013
057060         DL001-COMMIT-UPDATE                                      05706013
057070         DL001-FIND-NEXT-ASGMT    TO TRUE.                        05707013
057080     MOVE SU054-ASGMT-STRT-DTE    TO DL001-KEY-START-DTE.         05708013
057090     MOVE SU054-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT.           05709013
057100     MOVE SU054-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR.       05710013
057110     MOVE +1                      TO DL001-NBR-OF-NBRS-NEED-QTY.  05711013
057120     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   05712013
057130                                                                  05713013
057140     CALL DL001-USER-PGM USING DFHEIBLK                           05714013
057150                              DL001-COMMAREA                      05715013
057160                              DL001-ASGMT-COMMAREA.               05716013
057170                                                                  05717013
057180     EVALUATE TRUE                                                05718013
057190         WHEN DL001-SUCCESSFUL                                    05719013
057200              MOVE DL001-SEQ-START-NBR                            05720013
057210                                   TO SU054-SEQ-START-NBR         05721013
057220              IF DL001-ASGMT-NEXT-USED                            05722013
057230                 MOVE DL001-NXT-START-DTE                         05723013
057240                               TO SU054-ASGMT-STRT-DTE            05724013
057250                 MOVE DL001-NXT-NBR-TXT                           05725013
057260                               TO SU054-ASGMT-NBR-TXT             05726013
057270                 MOVE DL001-NXT-NBR-SEQ-NBR                       05727013
057280                               TO SU054-ASGMT-NBR-SEQ-NBR         05728013
057290                 PERFORM 2286-CALL-DLKUT001                       05729013
057300                 IF DL003-ASGMT-FOUND                             05730013
057310                     CONTINUE                                     05731013
057320                 ELSE                                             05732013
057330                     IF PV-DLKCS410-COUNT = +0                    05733013
057340                        PERFORM 2287-LINK-DLKCS410                05734013
057350                     END-IF                                       05735013
057360                 END-IF                                           05736013
057370              END-IF                                              05737013
057380         WHEN DL001-ASGMT-CLOSED-RETURN                           05738013
057390              IF PV-DLKCS410-COUNT = 0                            05739013
057400                 PERFORM 2287-LINK-DLKCS410                       05740013
057410              END-IF                                              05741013
057420         WHEN OTHER                                               05742013
057430                                                                  05743013
057440              INITIALIZE PV-CICS-MSG-AREA1                        05744013
057450              INITIALIZE PV-CICS-MSG-AREA2                        05745013
057460                                                                  05746013
057470              MOVE DL001-RETURN-SQLCODES TO PV-DISP-SQLCODE       05747013
057480              MOVE SU054-DC-NUMBER       TO PV-DISP-DC            05748013
057490              MOVE SU054-TRIP-ID         TO PV-DISP-TRIP          05749013
057500              MOVE SU054-ACCM-LINE-NMBR  TO PV-DISP-PNA-STA       05750013
057510                                                                  05751013
057520              STRING  'SUKCS782 2285-'                            05752099
057530                      ' DC:'               PV-DISP-DC             05753013
057540                      ' B1:'               SU054-BAR-CODE-1       05754013
057550                      ' B2:'               SU054-BAR-CODE-2       05755013
057560                      ' B3:'               SU054-BAR-CODE-3       05756013
057570                                           DELIMITED BY SIZE      05757013
057580                                      INTO PV-CICS-MSG-AREA1      05758013
057590                                                                  05759013
057600              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05760013
057610              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05761013
057620                                                                  05762013
057630              PERFORM 9999-WRITE-TO-CSSL                          05763013
057640                                                                  05764013
057650              STRING  'SUKCS782 '          SU054-KOHLS-SML        05765099
057660                      ' TRIP:'             PV-DISP-TRIP           05766013
057670                      ' DR:'               SU054-DOOR-NUMBER      05767013
057680                      ' USR:'              SU054-USER-ID          05768013
057690                      ' STA:'              PV-DISP-PNA-STA        05769013
057700                      ' SQL:'              PV-DISP-SQLCODE        05770013
057710                      ' LABOR (OTHER) '                           05771013
057720                                           DELIMITED BY SIZE      05772013
057730                                      INTO PV-CICS-MSG-AREA2      05773013
057740                                                                  05774013
057750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05775013
057760              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05776013
057770                                                                  05777013
057780              PERFORM 9999-WRITE-TO-CSSL                          05778013
057790                                                                  05779013
057800              INITIALIZE PV-CICS-MSG-AREA3                        05780013
057810                                                                  05781013
057820              MOVE DL001-RETURN-SQLCODES TO PV-DISP-SQLCODE       05782013
057830                                                                  05783013
057840              STRING  'SUKCS782 '                                 05784099
057850                      ' DL001-RC:'         DL001-RETURN-CODE      05785013
057860                      ' sql:'              PV-DISP-SQLCODE        05786013
057870                                           DELIMITED BY SIZE      05787013
057880                                      INTO PV-CICS-MSG-AREA3      05788013
057890                                                                  05789013
057900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05790013
057910              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05791013
057920                                                                  05792013
057930              PERFORM 9999-WRITE-TO-CSSL                          05793013
057940                                                                  05794013
057950                                                                  05795013
057960              INITIALIZE PV-CICS-MSG-AREA4                        05796013
057970                                                                  05797013
057980              STRING  'SUKCS782 '                                 05798099
057990                      ' CALL TO DLKUP001 '                        05799013
058000                      ' CHECK CSSL FOR MORE DETAIL'               05800013
058010                                           DELIMITED BY SIZE      05801013
058020                                      INTO PV-CICS-MSG-AREA4      05802013
058030                                                                  05803013
058040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05804013
058050              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     05805013
058060                                                                  05806013
058070              PERFORM 9999-WRITE-TO-CSSL                          05807013
058080                                                                  05808013
058090              INITIALIZE PV-CICS-MSG-AREA5                        05809013
058100                                                                  05810013
058110              MOVE SU054-TRIP-ID TO   PV-DISP-trip                05811013
058120              MOVE PV-CTN         TO  PV-DISP-sscc                05812013
058130              MOVE PV-DEST-STORE  TO  PV-DISP-STR                 05813013
058140                                                                  05814013
058150              STRING  'SUKCS782 '                                 05815099
058160                      ' TRIP:'             PV-DISP-TRIP           05816013
058170                      ' SSCC:'             PV-DISP-SSCC           05817013
058180                      ' STR:'              PV-DISP-STR            05818013
058190                                           DELIMITED BY SIZE      05819013
058200                                      INTO PV-CICS-MSG-AREA5      05820013
058210                                                                  05821013
058220              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05822013
058230              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     05823013
058240                                                                  05824013
058250              PERFORM 9999-WRITE-TO-CSSL                          05825013
058260                                                                  05826013
058270              SET PV-DONE-PROCESSING      TO TRUE                 05827013
058280              SET PS-PROCESSING-ERROR-YES TO TRUE                 05828013
058290              PERFORM 9998-WRITE-TO-CSSL                          05829013
058300     END-EVALUATE.                                                05830013
058310                                                                  05831013
058320*-----------------------------------------------------------------05832013
058330*  CALL DLKUT001 TO DETERMINE IF THE REQUESTED ASSOCIATE IS      *05833013
058340*  CURRENTLY ACTIVE ON AN ACTIVE ASSIGNMENT.                     *05834013
058350*-----------------------------------------------------------------05835013
058360 2286-CALL-DLKUT001.                                              05836013
058370*                                                                 05837013
058380** added internal table to track paragraph execution time         05838013
058390** dmh 2014-12-22 - begin                                         05839013
058400*                                                                 05840013
058410     MOVE  '2286'  TO  PT-CURR-PARA.                              05841013
058420     IF  PS-BLD-INTERNAL-TABLE-YES                                05842013
058430         PERFORM 0200-INTERNAL-TABLE                              05843013
058440     ELSE                                                         05844013
058450         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05845013
058460     END-IF.                                                      05846013
058470                                                                  05847013
058480*                                                                 05848013
058490** DMH 2014-12-22 - END                                           05849013
058500*                                                                 05850013
058510                                                                  05851013
058520     INITIALIZE  DL003-ASGMT-COMMAREA.                            05852013
058530                                                                  05853013
058540     MOVE SU054-USER-ID             TO DL003-KEY-USER-ID.         05854013
058550     MOVE 'SUKCS782'                TO DL003-ORIG-CALLING-PGM-NM. 05855099
058560     SET DL003-BY-USER-KEY TO TRUE.                               05856013
058570                                                                  05857013
058580     CALL DL003-USER-PGM USING DFHEIBLK                           05858013
058590                               DL003-COMMAREA                     05859013
058600                               DL003-ASGMT-COMMAREA.              05860013
058610                                                                  05861013
058620     EVALUATE TRUE                                                05862013
058630         WHEN DL003-SUCCESSFUL                                    05863013
058640             CONTINUE                                             05864013
058650         WHEN OTHER                                               05865013
058660                                                                  05866013
058670              INITIALIZE PV-CICS-MSG-AREA1                        05867013
058680              INITIALIZE PV-CICS-MSG-AREA2                        05868013
058690                                                                  05869013
058700              MOVE DL001-RETURN-SQLCODES TO PV-DISP-SQLCODE       05870013
058710              MOVE SU054-DC-NUMBER       TO PV-DISP-DC            05871013
058720              MOVE SU054-TRIP-ID         TO PV-DISP-TRIP          05872013
058730              MOVE SU054-ACCM-LINE-NMBR  TO PV-DISP-PNA-STA       05873013
058740                                                                  05874013
058750              STRING  'SUKCS782 2286-'                            05875099
058760                      ' DC:'               PV-DISP-DC             05876013
058770                      ' B1:'               SU054-BAR-CODE-1       05877013
058780                      ' B2:'               SU054-BAR-CODE-2       05878013
058790                      ' B3:'               SU054-BAR-CODE-3       05879013
058800                                           DELIMITED BY SIZE      05880013
058810                                      INTO PV-CICS-MSG-AREA1      05881013
058820                                                                  05882013
058830              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05883013
058840              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     05884013
058850                                                                  05885013
058860              PERFORM 9999-WRITE-TO-CSSL                          05886013
058870                                                                  05887013
058880              STRING  'SUKCS782 '          SU054-KOHLS-SML        05888099
058890                      ' TRIP:'             PV-DISP-TRIP           05889013
058900                      ' DR:'               SU054-DOOR-NUMBER      05890013
058910                      ' USR:'              SU054-USER-ID          05891013
058920                      ' STA:'              PV-DISP-PNA-STA        05892013
058930                      ' SQL:'              PV-DISP-SQLCODE        05893013
058940                      ' LABOR (OTHER) '                           05894013
058950                                           DELIMITED BY SIZE      05895013
058960                                      INTO PV-CICS-MSG-AREA2      05896013
058970                                                                  05897013
058980              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05898013
058990              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     05899013
059000                                                                  05900013
059010              PERFORM 9999-WRITE-TO-CSSL                          05901013
059020                                                                  05902013
059030              INITIALIZE PV-CICS-MSG-AREA3                        05903013
059040                                                                  05904013
059050              MOVE DL001-RETURN-SQLCODES TO PV-DISP-SQLCODE       05905013
059060                                                                  05906013
059070              STRING  'SUKCS782 '                                 05907099
059080                      ' DL003-RC:'         DL003-RETURN-CODE      05908013
059090                      ' sql:'              PV-DISP-SQLCODE        05909013
059100                                           DELIMITED BY SIZE      05910013
059110                                      INTO PV-CICS-MSG-AREA3      05911013
059120                                                                  05912013
059130              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05913013
059140              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     05914013
059150                                                                  05915013
059160              PERFORM 9999-WRITE-TO-CSSL                          05916013
059170                                                                  05917013
059180                                                                  05918013
059190              INITIALIZE PV-CICS-MSG-AREA4                        05919013
059200                                                                  05920013
059210              STRING  'SUKCS782 '                                 05921099
059220                      ' CALL TO DLKUP001 '                        05922013
059230                      ' CHECK CSSL FOR MORE DETAIL'               05923013
059240                                           DELIMITED BY SIZE      05924013
059250                                      INTO PV-CICS-MSG-AREA4      05925013
059260                                                                  05926013
059270              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05927013
059280              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     05928013
059290                                                                  05929013
059300              PERFORM 9999-WRITE-TO-CSSL                          05930013
059310                                                                  05931013
059320              INITIALIZE PV-CICS-MSG-AREA5                        05932013
059330                                                                  05933013
059340              MOVE SU054-TRIP-ID TO   PV-DISP-trip                05934013
059350              MOVE PV-CTN         TO  PV-DISP-sscc                05935013
059360              MOVE PV-DEST-STORE  TO  PV-DISP-STR                 05936013
059370                                                                  05937013
059380              STRING  'SUKCS782 '                                 05938099
059390                      ' TRIP:'             PV-DISP-TRIP           05939013
059400                      ' SSCC:'             PV-DISP-SSCC           05940013
059410                      ' STR:'              PV-DISP-STR            05941013
059420                                           DELIMITED BY SIZE      05942013
059430                                      INTO PV-CICS-MSG-AREA5      05943013
059440                                                                  05944013
059450              MOVE SPACES               TO PV-CICS-MSG-AREA-A     05945013
059460              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     05946013
059470                                                                  05947013
059480              PERFORM 9999-WRITE-TO-CSSL                          05948013
059490                                                                  05949013
059500              SET PV-DONE-PROCESSING      TO TRUE                 05950013
059510              SET PS-PROCESSING-ERROR-YES TO TRUE                 05951013
059520              PERFORM 9998-WRITE-TO-CSSL                          05952013
059530     END-EVALUATE.                                                05953013
059540                                                                  05954013
059550 2287-LINK-DLKCS410.                                              05955013
059560*                                                                 05956013
059570** added internal table to track paragraph execution time         05957013
059580** dmh 2014-12-22 - begin                                         05958013
059590*                                                                 05959013
059600     MOVE  '2287'  TO  PT-CURR-PARA.                              05960013
059610     IF  PS-BLD-INTERNAL-TABLE-YES                                05961013
059620         PERFORM 0200-INTERNAL-TABLE                              05962013
059630     ELSE                                                         05963013
059640         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       05964013
059650     END-IF.                                                      05965013
059660                                                                  05966013
059670*                                                                 05967013
059680** DMH 2014-12-22 - END                                           05968013
059690*                                                                 05969013
059700                                                                  05970013
059710     INITIALIZE DL016-PGM-COMMAREA                                05971013
059720     SET DL016-ESTABLISH-ASGMT        TO TRUE                     05972013
059730     SET DL016-DO-NOT-COMMIT-UPDATE   TO TRUE                     05973013
059740     MOVE 'SUKCS782'                  TO DL016-CALLING-PGM-NM     05974099
059750     MOVE SU054-USER-ID               TO DL016-SIGN-ON-USR-ID     05975013
059760                                                                  05976013
059770     SET DL011-RECV-WRK-TYP           TO TRUE                     05977013
059780     MOVE DL011-KEY-WK-TYP            TO DL016-ASGMT-NBR-WRK-TYP  05978013
059790                                                                  05979013
059800     MOVE SU054-DOOR-NUMBER          TO DL011-RD-WRK-AREA-DOOR-NBR05980013
059810     MOVE DL011-RECV-DOOR-WRK-AREA    TO DL016-EAI-WK-AREA-DESC   05981013
059820                                                                  05982013
059830     SET DL011-RECV-WRK-TYP           TO TRUE                     05983013
059840     MOVE DL011-KEY-WK-TYP            TO DL016-EAI-WK-TYP-DESC    05984013
059850                                                                  05985013
059860     MOVE SU054-DC-NUMBER             TO DL016-EAI-DC-NBR         05986013
059870     MOVE SU054-USER-ID               TO DL016-EAI-CRE-BY-USR-ID  05987013
059880     SET DL016-EAI-USR-IS-UNKNOWN     TO TRUE                     05988013
059890                                                                  05989013
059900     MOVE LENGTH OF DL016-PGM-COMMAREA                            05990013
059910                                      TO PV-COMMAREA-LENGTH       05991013
059920                                                                  05992013
059930     EXEC CICS LINK                                               05993013
059940         PROGRAM  (DL016-USER-PGM)                                05994013
059950         COMMAREA (DL016-PGM-COMMAREA)                            05995013
059960         LENGTH   (PV-COMMAREA-LENGTH)                            05996013
059970     END-EXEC.                                                    05997013
059980                                                                  05998013
059990     EVALUATE TRUE                                                05999013
060000         WHEN DL016-SUCCESSFUL                                    06000013
060010             MOVE DL016-ESO-ASGMT-NBR-TXT                         06001013
060020                                      TO SU054-ASGMT-NBR-TXT      06002013
060030             MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR                     06003013
060040                                       TO SU054-ASGMT-NBR-SEQ-NBR 06004013
060050             MOVE DL016-ESO-ASGMT-START-DTE                       06005013
060060                                       TO SU054-ASGMT-STRT-DTE    06006013
060070             MOVE +1                   TO PV-DLKCS410-COUNT       06007013
060080             PERFORM 2285-CALL-DLKUP001-ASGMT-MOD                 06008013
060090         WHEN OTHER                                               06009013
060100                                                                  06010013
060110              INITIALIZE PV-CICS-MSG-AREA1                        06011013
060120              INITIALIZE PV-CICS-MSG-AREA2                        06012013
060130                                                                  06013013
060140              MOVE DL016-CALL-MOD-FAIL-SQL-CDE                    06014013
060150                                         TO PV-DISP-SQLCODE       06015013
060160              MOVE SU054-DC-NUMBER       TO PV-DISP-DC            06016013
060170              MOVE SU054-TRIP-ID         TO PV-DISP-TRIP          06017013
060180              MOVE SU054-ACCM-LINE-NMBR  TO PV-DISP-PNA-STA       06018013
060190                                                                  06019013
060200              STRING  'SUKCS782 2287-'                            06020099
060210                      ' DC:'               PV-DISP-DC             06021013
060220                      ' B1:'               SU054-BAR-CODE-1       06022013
060230                      ' B2:'               SU054-BAR-CODE-2       06023013
060240                      ' B3:'               SU054-BAR-CODE-3       06024013
060250                                           DELIMITED BY SIZE      06025013
060260                                      INTO PV-CICS-MSG-AREA1      06026013
060270                                                                  06027013
060280              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06028013
060290              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06029013
060300                                                                  06030013
060310              PERFORM 9999-WRITE-TO-CSSL                          06031013
060320                                                                  06032013
060330              STRING  'SUKCS782 '          SU054-KOHLS-SML        06033099
060340                      ' TRIP:'             PV-DISP-TRIP           06034013
060350                      ' DR:'               SU054-DOOR-NUMBER      06035013
060360                      ' USR:'              SU054-USER-ID          06036013
060370                      ' STA:'              PV-DISP-PNA-STA        06037013
060380                      ' SQL:'              PV-DISP-SQLCODE        06038013
060390                      ' LABOR (OTHER) '                           06039013
060400                                           DELIMITED BY SIZE      06040013
060410                                      INTO PV-CICS-MSG-AREA2      06041013
060420                                                                  06042013
060430              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06043013
060440              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06044013
060450                                                                  06045013
060460              PERFORM 9999-WRITE-TO-CSSL                          06046013
060470                                                                  06047013
060480              INITIALIZE PV-CICS-MSG-AREA3                        06048013
060490                                                                  06049013
060500              MOVE DL016-ASGMT-SQLCODE   TO PV-DISP-SQLCODE       06050013
060510                                                                  06051013
060520              STRING  'SUKCS782 '                                 06052099
060530                      ' DL016-RC:'  DL016-RETURN-CODE             06053013
060540                      ' sql:'       PV-DISP-SQLCODE               06054013
060550                      ' MOD:'       DL016-CALL-MOD-FAIL-NM        06055013
060560                      ' PARA:'      DL016-CALL-MOD-FAIL-SQL-PARA  06056013
060570                                           DELIMITED BY SIZE      06057013
060580                                      INTO PV-CICS-MSG-AREA3      06058013
060590                                                                  06059013
060600              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06060013
060610              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06061013
060620                                                                  06062013
060630              PERFORM 9999-WRITE-TO-CSSL                          06063013
060640                                                                  06064013
060650                                                                  06065013
060660              INITIALIZE PV-CICS-MSG-AREA4                        06066013
060670                                                                  06067013
060680              STRING  'SUKCS782 '                                 06068099
060690                      ' LINK-DLKCS410 '                           06069013
060700                      ' MOD:'  DL016-CALL-MOD-FAIL-ERR-CDE        06070013
060710                      ' SQL:'  DL016-CALL-MOD-FAIL-SQL-CDE        06071013
060720                      ' CHECK CSSL FOR MORE DETAIL'               06072013
060730                                           DELIMITED BY SIZE      06073013
060740                                      INTO PV-CICS-MSG-AREA4      06074013
060750                                                                  06075013
060760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06076013
060770              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     06077013
060780                                                                  06078013
060790              PERFORM 9999-WRITE-TO-CSSL                          06079013
060800                                                                  06080013
060810              INITIALIZE PV-CICS-MSG-AREA5                        06081013
060820                                                                  06082013
060830              MOVE SU054-TRIP-ID TO   PV-DISP-trip                06083013
060840              MOVE PV-CTN         TO  PV-DISP-sscc                06084013
060850              MOVE PV-DEST-STORE  TO  PV-DISP-STR                 06085013
060860                                                                  06086013
060870              STRING  'SUKCS782 '                                 06087099
060880                      ' TRIP:'             PV-DISP-TRIP           06088013
060890                      ' SSCC:'             PV-DISP-SSCC           06089013
060900                      ' STR:'              PV-DISP-STR            06090013
060910                                           DELIMITED BY SIZE      06091013
060920                                      INTO PV-CICS-MSG-AREA5      06092013
060930                                                                  06093013
060940              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06094013
060950              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     06095013
060960                                                                  06096013
060970              PERFORM 9999-WRITE-TO-CSSL                          06097013
060980                                                                  06098013
060990              SET PV-DONE-PROCESSING          TO TRUE             06099013
061000                                                                  06100013
061010             SET PS-PROCESSING-ERROR-YES TO TRUE                  06101013
061020             PERFORM 9998-WRITE-TO-CSSL                           06102013
061030     END-EVALUATE.                                                06103013
061040                                                                  06104013
061050 2290-INSERT-TSHPUNT.                                             06105013
061060*                                                                 06106013
061070** added internal table to track paragraph execution time         06107013
061080** dmh 2014-12-22 - begin                                         06108013
061090*                                                                 06109013
061100     MOVE  '2290'  TO  PT-CURR-PARA.                              06110013
061110     IF  PS-BLD-INTERNAL-TABLE-YES                                06111013
061120         PERFORM 0200-INTERNAL-TABLE                              06112013
061130     ELSE                                                         06113013
061140         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06114013
061150     END-IF.                                                      06115013
061160                                                                  06116013
061170*                                                                 06117013
061180** DMH 2014-12-22 - END                                           06118013
061190*                                                                 06119013
061200     EXEC SQL                                                     06120013
061210         INSERT INTO TSHPUNT                                      06121013
061220               (SHIPT_UNT_ID,                                     06122013
061230                ORGN_OPER_UNT_ID,                                 06123013
061240                ORGN_FCLTY_ID,                                    06124013
061250                DEST_OPER_UNT_ID,                                 06125013
061260                DEST_FCLTY_ID,                                    06126013
061270                SHIPT_UNT_SRC_ID,                                 06127013
061280                HIER_LVL_CDE,                                     06128013
061290                NEXT_SHIPT_UNT_ID,                                06129013
061300                ORIG_SHIPT_UNT_ID,                                06130013
061310                ACTV_IND,                                         06131013
061320                CRE_DTE,                                          06132013
061330                CRE_TM,                                           06133013
061340                CRE_USR_ID,                                       06134013
061350                CRE_PGM_NM)                                       06135013
061360         VALUES                                                   06136013
061370               (:SHPUNT-SHIPT-UNT-ID,                             06137013
061380                :SHPUNT-ORGN-OPER-UNT-ID,                         06138013
061390                :SHPUNT-ORGN-FCLTY-ID,                            06139013
061400                :SHPUNT-DEST-OPER-UNT-ID,                         06140013
061410                :SHPUNT-DEST-FCLTY-ID,                            06141013
061420                :SHPUNT-SHIPT-UNT-SRC-ID,                         06142013
061430                :SHPUNT-HIER-LVL-CDE,                             06143013
061440                :SHPUNT-NEXT-SHIPT-UNT-ID,                        06144013
061450                :SHPUNT-ORIG-SHIPT-UNT-ID,                        06145013
061460                :SHPUNT-ACTV-IND,                                 06146013
061470                CURRENT DATE,                                     06147013
061480                CURRENT TIME,                                     06148013
061490                :SHPUNT-CRE-USR-ID,                               06149013
061500                :SHPUNT-CRE-PGM-NM)                               06150013
061510     END-EXEC.                                                    06151013
061520                                                                  06152013
061530     EVALUATE TRUE                                                06153013
061540         WHEN SQLCODE = ZERO                                      06154013
061550             CONTINUE                                             06155013
061560         WHEN SQLWARN0 NOT = SPACES                               06156013
061570         WHEN SQLCODE NOT EQUAL ZERO                              06157013
061580                                                                  06158013
061590              INITIALIZE PV-CICS-MSG-AREA1                        06159013
061600              INITIALIZE PV-CICS-MSG-AREA2                        06160013
061610                                                                  06161013
061620              MOVE SQLCODE              TO PV-DISP-SQLCODE        06162013
061630              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06163013
061640              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06164013
061650              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06165013
061660                                                                  06166013
061670              STRING  'SUKCS782 2290-'                            06167099
061680                      ' DC:'               PV-DISP-DC             06168013
061690                      ' B1:'               SU054-BAR-CODE-1       06169013
061700                      ' B2:'               SU054-BAR-CODE-2       06170013
061710                      ' B3:'               SU054-BAR-CODE-3       06171013
061720                                           DELIMITED BY SIZE      06172013
061730                                      INTO PV-CICS-MSG-AREA1      06173013
061740                                                                  06174013
061750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06175013
061760              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06176013
061770                                                                  06177013
061780              PERFORM 9999-WRITE-TO-CSSL                          06178013
061790                                                                  06179013
061800              STRING  'SUKCS782 '          SU054-KOHLS-SML        06180099
061810                      ' TRIP:'             PV-DISP-TRIP           06181013
061820                      ' DR:'               SU054-DOOR-NUMBER      06182013
061830                      ' USR:'              SU054-USER-ID          06183013
061840                      ' STA:'              PV-DISP-PNA-STA        06184013
061850                      ' SQL:'              PV-DISP-SQLCODE        06185013
061860                      ' TSHPUNT'                                  06186013
061870                                           DELIMITED BY SIZE      06187013
061880                                      INTO PV-CICS-MSG-AREA2      06188013
061890                                                                  06189013
061900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06190013
061910              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06191013
061920                                                                  06192013
061930              PERFORM 9999-WRITE-TO-CSSL                          06193013
061940                                                                  06194013
061950              INITIALIZE PV-CICS-MSG-AREA3                        06195013
061960              MOVE SHPUNT-SHIPT-UNT-ID      TO PV-DISP-SSCC       06196013
061970              MOVE SHPUNT-ORGN-OPER-UNT-ID  TO PV-DISP-ORIG-OPER  06197013
061980              MOVE SHPUNT-ORGN-FCLTY-ID     TO PV-DISP-ORIG-FClty 06198013
061990              MOVE SHPUNT-DEST-OPER-UNT-ID  TO PV-DISP-DEST-OPER  06199013
062000              MOVE SHPUNT-DEST-FCLTY-ID     TO PV-DISP-DEST-FClty 06200013
062010              MOVE SHPUNT-NEXT-SHIPT-UNT-ID TO PV-DISP-NEXT-SSCC  06201013
062020              MOVE SHPUNT-ORIG-SHIPT-UNT-ID TO PV-DISP-ORIG-SSCC  06202013
062030                                                                  06203013
062040              STRING  'SUKCS782 '                                 06204099
062050                      ' '                  PV-DISP-SSCC           06205013
062060                      '-'                  PV-DISP-ORIG-OPER      06206013
062070                      '-'                  PV-DISP-ORIG-fclty     06207013
062080                      '-'                  PV-DISP-DEST-OPER      06208013
062090                      '-'                  PV-DISP-DEST-fclty     06209013
062100                      '-'                 SHPUNT-SHIPT-UNT-SRC-ID 06210013
062110                      '-'                  DELIMITED BY SIZE      06211013
062120                                      INTO PV-CICS-MSG-AREA3      06212013
062130                                                                  06213013
062140              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06214013
062150              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06215013
062160                                                                  06216013
062170              PERFORM 9999-WRITE-TO-CSSL                          06217013
062180                                                                  06218013
062190              INITIALIZE PV-CICS-MSG-AREA4                        06219013
062200                                                                  06220013
062210              STRING  'SUKCS782 '                                 06221099
062220                      ' '                  SHPUNT-HIER-LVL-CDE    06222013
062230                      '-'                  PV-DISP-NEXT-SSCC      06223013
062240                      '-'                  PV-DISP-ORIG-SSCC      06224013
062250                      '-'                  SHPUNT-ACTV-IND        06225013
062260                      '-'                  SHPUNT-CRE-USR-ID      06226013
062270                      '-'                  SHPUNT-CRE-PGM-NM      06227013
062280                      '-'                  DELIMITED BY SIZE      06228013
062290                                      INTO PV-CICS-MSG-AREA4      06229013
062300                                                                  06230013
062310              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06231013
062320              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     06232013
062330                                                                  06233013
062340              PERFORM 9999-WRITE-TO-CSSL                          06234013
062350                                                                  06235013
062360             SET PS-PROCESSING-ERROR-YES TO TRUE                  06236013
062370             PERFORM 9998-WRITE-TO-CSSL                           06237013
062380     END-EVALUATE.                                                06238013
062390                                                                  06239013
062400                                                                  06240013
062410******************************************************************06241013
062420 2335-OPEN-ODD-UNITS-CSR.                                         06242013
062430*                                                                 06243013
062440** added internal table to track paragraph execution time         06244013
062450** dmh 2014-12-22 - begin                                         06245013
062460*                                                                 06246013
062470     MOVE  '2335'  TO  PT-CURR-PARA.                              06247013
062480     IF  PS-BLD-INTERNAL-TABLE-YES                                06248013
062490         PERFORM 0200-INTERNAL-TABLE                              06249013
062500     ELSE                                                         06250013
062510         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06251013
062520     END-IF.                                                      06252013
062530                                                                  06253013
062540*                                                                 06254013
062550** DMH 2014-12-22 - END                                           06255013
062560*                                                                 06256013
062570     SET PS-NOT-ODD-UNT-CRTN-FOUND TO TRUE.                       06257013
062580     MOVE PV-RCVR-SEQ-NBR     TO DK-REC-SEQ-NBR.                  06258013
062590                                                                  06259013
062600         EXEC SQL                                                 06260013
062610              OPEN ODD-UNITS-CSR                                  06261013
062620         END-EXEC                                                 06262013
062630                                                                  06263013
062640                                                                  06264013
062650         EVALUATE TRUE                                            06265013
062660             WHEN SQLCODE = ZERO                                  06266013
062670                 CONTINUE                                         06267013
062680             WHEN SQLWARN0 NOT = SPACES                           06268013
062690             WHEN SQLCODE < ZERO                                  06269013
062700             WHEN SQLCODE > ZERO                                  06270013
062710                                                                  06271013
062720              INITIALIZE PV-CICS-MSG-AREA1                        06272013
062730              INITIALIZE PV-CICS-MSG-AREA2                        06273013
062740                                                                  06274013
062750              MOVE SQLCODE              TO PV-DISP-SQLCODE        06275013
062760              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06276013
062770              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06277013
062780              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06278013
062790                                                                  06279013
062800              STRING  'SUKCS782 2335-'                            06280099
062810                      ' DC:'               PV-DISP-DC             06281013
062820                      ' B1:'               SU054-BAR-CODE-1       06282013
062830                      ' B2:'               SU054-BAR-CODE-2       06283013
062840                      ' B3:'               SU054-BAR-CODE-3       06284013
062850                                           DELIMITED BY SIZE      06285013
062860                                      INTO PV-CICS-MSG-AREA1      06286013
062870                                                                  06287013
062880              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06288013
062890              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06289013
062900                                                                  06290013
062910              PERFORM 9999-WRITE-TO-CSSL                          06291013
062920                                                                  06292013
062930              STRING  'SUKCS782 '          SU054-KOHLS-SML        06293099
062940                      ' TRIP:'             PV-DISP-TRIP           06294013
062950                      ' DR:'               SU054-DOOR-NUMBER      06295013
062960                      ' USR:'              SU054-USER-ID          06296013
062970                      ' STA:'              PV-DISP-PNA-STA        06297013
062980                      ' SQL:'              PV-DISP-SQLCODE        06298013
062990                      ' TRECITM/TSHUUPC/TRECITM'                  06299013
063000                                           DELIMITED BY SIZE      06300013
063010                                      INTO PV-CICS-MSG-AREA2      06301013
063020                                                                  06302013
063030              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06303013
063040              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06304013
063050                                                                  06305013
063060              PERFORM 9999-WRITE-TO-CSSL                          06306013
063070                                                                  06307013
063080              INITIALIZE PV-CICS-MSG-AREA3                        06308013
063090              MOVE DK-PO             TO PV-DISP-PO                06309013
063100              MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR              06310013
063110              MOVE DK-CTN            TO PV-DISP-SSCC              06311013
063120                                                                  06312013
063130              STRING  'SUKCS782 '                                 06313099
063140                      'OPEN ODD-UNITS-CSR '                       06314013
063150                      '-'                  PV-DISP-PO             06315013
063160                      '-'                  PV-DISP-RCVR           06316013
063170                      '-'                  PV-DISP-SSCC           06317013
063180                      '-'                  DELIMITED BY SIZE      06318013
063190                                      INTO PV-CICS-MSG-AREA3      06319013
063200                                                                  06320013
063210              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06321013
063220              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06322013
063230                                                                  06323013
063240              PERFORM 9999-WRITE-TO-CSSL                          06324013
063250                                                                  06325013
063260                 SET PS-PROCESSING-ERROR-YES TO TRUE              06326013
063270                 PERFORM 9998-WRITE-TO-CSSL                       06327013
063280         END-EVALUATE.                                            06328013
063290                                                                  06329013
063300 EJECT                                                            06330013
063310*----------------------------------------------------------------*06331013
063320*                                                                *06332013
063330*----------------------------------------------------------------*06333013
063340 2340-FETCH-ODD-UNITS-CSR.                                        06334013
063350*                                                                 06335013
063360** added internal table to track paragraph execution time         06336013
063370** dmh 2014-12-22 - begin                                         06337013
063380*                                                                 06338013
063390     MOVE  '2340'  TO  PT-CURR-PARA.                              06339013
063400     IF  PS-BLD-INTERNAL-TABLE-YES                                06340013
063410         PERFORM 0200-INTERNAL-TABLE                              06341013
063420     ELSE                                                         06342013
063430         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06343013
063440     END-IF.                                                      06344013
063450                                                                  06345013
063460*                                                                 06346013
063470** DMH 2014-12-22 - END                                           06347013
063480*                                                                 06348013
063490                                                                  06349013
063500     EXEC SQL                                                     06350013
063510        FETCH   ODD-UNITS-CSR                                     06351013
063520        INTO   :PV-UNION-TYPE                                     06352013
063530              ,:PV-TRN-LNE-NBR                                    06353013
063540              ,:RECITM-PREPK-ID                                   06354013
063550     END-EXEC.                                                    06355013
063560* Prepack should be on both tshuupc('a' union) and trecitm('b')   06356013
063570* the fetch should always return an row from 'a' followed by a    06357013
063580* row from 'b'                                                    06358013
063590                                                                  06359013
063600     EVALUATE TRUE                                                06360013
063610       WHEN SQLCODE = ZEROS                                       06361013
063620            SET PS-FOUND-ON-ODD-UNTS-CSR TO TRUE                  06362013
063630                                                                  06363013
063640            IF PS-FIRST-ODD-UNTS-FETCH                            06364013
063650* first carton cannot be a 'b'                                    06365013
063660               IF PV-UNION-TYPE = 'B'                             06366013
063670                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               06367013
063680                  PERFORM 5005-PRINT-MESSAGE-LABELS               06368013
063690               ELSE                                               06369013
063700                  MOVE PV-UNION-TYPE TO PV-PREV-FETCH             06370013
063710                  MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE             06371013
063720                  SET PS-NOT-FIRST-ODD-UNTS-FETCH TO TRUE         06372013
063730               END-IF                                             06373013
063740            ELSE                                                  06374013
063750              IF PV-UNION-TYPE = PV-PREV-FETCH                    06375013
063760                 SET PS-ODD-UNT-CRTN-FOUND TO TRUE                06376013
063770                 PERFORM 5005-PRINT-MESSAGE-LABELS                06377013
063780              ELSE                                                06378013
063790                 IF PV-TRN-LNE-NBR = PV-PREV-LINE                 06379013
063800                     MOVE PV-UNION-TYPE  TO PV-PREV-FETCH         06380013
063810                     MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE          06381013
063820                 ELSE                                             06382013
063830** check case where 'a' followed by 'b' are the same line         06383013
063840** the line number should only change when the prev-fetch = 'b'   06384013
063850                     IF PV-PREV-FETCH = 'A'                       06385013
063860                        SET PS-ODD-UNT-CRTN-FOUND TO TRUE         06386013
063870                        PERFORM 5005-PRINT-MESSAGE-LABELS         06387013
063880                     ELSE                                         06388013
063890                        MOVE PV-UNION-TYPE  TO PV-PREV-FETCH      06389013
063900                        MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE       06390013
063910                     END-IF                                       06391013
063920                 END-IF                                           06392013
063930              END-IF                                              06393013
063940            END-IF                                                06394013
063950                                                                  06395013
063960       WHEN SQLCODE = +100                                        06396013
063970                SET  PS-EO-ODD-UNTS-CSR  TO TRUE                  06397013
063980*check to see if last prepack is an 'a' with no 'b'               06398013
063990                IF PV-UNION-TYPE  = 'A'                           06399013
064000                   SET PS-ODD-UNT-CRTN-FOUND TO TRUE              06400013
064010                   PERFORM 5005-PRINT-MESSAGE-LABELS              06401013
064020                END-IF                                            06402013
064030       WHEN OTHER                                                 06403013
064040                                                                  06404013
064050              INITIALIZE PV-CICS-MSG-AREA1                        06405013
064060              INITIALIZE PV-CICS-MSG-AREA2                        06406013
064070                                                                  06407013
064080              MOVE SQLCODE              TO PV-DISP-SQLCODE        06408013
064090              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06409013
064100              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06410013
064110              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06411013
064120                                                                  06412013
064130              STRING  'SUKCS782 2340-'                            06413099
064140                      ' DC:'               PV-DISP-DC             06414013
064150                      ' B1:'               SU054-BAR-CODE-1       06415013
064160                      ' B2:'               SU054-BAR-CODE-2       06416013
064170                      ' B3:'               SU054-BAR-CODE-3       06417013
064180                                           DELIMITED BY SIZE      06418013
064190                                      INTO PV-CICS-MSG-AREA1      06419013
064200                                                                  06420013
064210              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06421013
064220              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06422013
064230                                                                  06423013
064240              PERFORM 9999-WRITE-TO-CSSL                          06424013
064250                                                                  06425013
064260              STRING  'SUKCS782 '          SU054-KOHLS-SML        06426099
064270                      ' TRIP:'             PV-DISP-TRIP           06427013
064280                      ' DR:'               SU054-DOOR-NUMBER      06428013
064290                      ' USR:'              SU054-USER-ID          06429013
064300                      ' STA:'              PV-DISP-PNA-STA        06430013
064310                      ' SQL:'              PV-DISP-SQLCODE        06431013
064320                      ' TRECITM/TSHUUPC/TRECITM'                  06432013
064330                                           DELIMITED BY SIZE      06433013
064340                                      INTO PV-CICS-MSG-AREA2      06434013
064350                                                                  06435013
064360              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06436013
064370              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06437013
064380                                                                  06438013
064390              PERFORM 9999-WRITE-TO-CSSL                          06439013
064400                                                                  06440013
064410              INITIALIZE PV-CICS-MSG-AREA3                        06441013
064420              MOVE DK-PO             TO PV-DISP-PO                06442013
064430              MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR              06443013
064440              MOVE DK-CTN            TO PV-DISP-SSCC              06444013
064450                                                                  06445013
064460              STRING  'SUKCS782 '                                 06446099
064470                      'FETCH ODD-UNITS-CSR '                      06447013
064480                      '-'                  PV-DISP-PO             06448013
064490                      '-'                  PV-DISP-RCVR           06449013
064500                      '-'                  PV-DISP-SSCC           06450013
064510                      '-'                  DELIMITED BY SIZE      06451013
064520                                      INTO PV-CICS-MSG-AREA3      06452013
064530                                                                  06453013
064540              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06454013
064550              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06455013
064560                                                                  06456013
064570              PERFORM 9999-WRITE-TO-CSSL                          06457013
064580                                                                  06458013
064590             SET PS-PROCESSING-ERROR-YES TO TRUE                  06459013
064600             PERFORM 9998-WRITE-TO-CSSL                           06460013
064610     END-EVALUATE.                                                06461013
064620                                                                  06462013
064630                                                                  06463013
064640 2345-CLOSE-ODD-UNITS-CSR.                                        06464013
064650*                                                                 06465013
064660** added internal table to track paragraph execution time         06466013
064670** dmh 2014-12-22 - begin                                         06467013
064680*                                                                 06468013
064690     MOVE  '2345'  TO  PT-CURR-PARA.                              06469013
064700     IF  PS-BLD-INTERNAL-TABLE-YES                                06470013
064710         PERFORM 0200-INTERNAL-TABLE                              06471013
064720     ELSE                                                         06472013
064730         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06473013
064740     END-IF.                                                      06474013
064750                                                                  06475013
064760*                                                                 06476013
064770** DMH 2014-12-22 - END                                           06477013
064780*                                                                 06478013
064790                                                                  06479013
064800         EXEC SQL                                                 06480013
064810             CLOSE ODD-UNITS-CSR                                  06481013
064820         END-EXEC                                                 06482013
064830                                                                  06483013
064840                                                                  06484013
064850         EVALUATE TRUE                                            06485013
064860             WHEN SQLCODE = ZERO                                  06486013
064870                 CONTINUE                                         06487013
064880             WHEN SQLWARN0 NOT = SPACES                           06488013
064890             WHEN SQLCODE < ZERO                                  06489013
064900             WHEN SQLCODE > ZERO                                  06490013
064910                                                                  06491013
064920              INITIALIZE PV-CICS-MSG-AREA1                        06492013
064930              INITIALIZE PV-CICS-MSG-AREA2                        06493013
064940                                                                  06494013
064950              MOVE SQLCODE              TO PV-DISP-SQLCODE        06495013
064960              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06496013
064970              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06497013
064980              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06498013
064990                                                                  06499013
065000              STRING  'SUKCS782 2345-'                            06500099
065010                      ' DC:'               PV-DISP-DC             06501013
065020                      ' B1:'               SU054-BAR-CODE-1       06502013
065030                      ' B2:'               SU054-BAR-CODE-2       06503013
065040                      ' B3:'               SU054-BAR-CODE-3       06504013
065050                                           DELIMITED BY SIZE      06505013
065060                                      INTO PV-CICS-MSG-AREA1      06506013
065070                                                                  06507013
065080              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06508013
065090              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06509013
065100                                                                  06510013
065110              PERFORM 9999-WRITE-TO-CSSL                          06511013
065120                                                                  06512013
065130              STRING  'SUKCS782 '          SU054-KOHLS-SML        06513099
065140                      ' TRIP:'             PV-DISP-TRIP           06514013
065150                      ' DR:'               SU054-DOOR-NUMBER      06515013
065160                      ' USR:'              SU054-USER-ID          06516013
065170                      ' STA:'              PV-DISP-PNA-STA        06517013
065180                      ' SQL:'              PV-DISP-SQLCODE        06518013
065190                      ' TRECITM/TSHUUPC/TRECITM'                  06519013
065200                                           DELIMITED BY SIZE      06520013
065210                                      INTO PV-CICS-MSG-AREA2      06521013
065220                                                                  06522013
065230              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06523013
065240              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06524013
065250                                                                  06525013
065260              PERFORM 9999-WRITE-TO-CSSL                          06526013
065270                                                                  06527013
065280              INITIALIZE PV-CICS-MSG-AREA3                        06528013
065290              MOVE DK-PO             TO PV-DISP-PO                06529013
065300              MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR              06530013
065310              MOVE DK-CTN            TO PV-DISP-SSCC              06531013
065320                                                                  06532013
065330              STRING  'SUKCS782 '                                 06533099
065340                      'CLOSE ODD-UNITS-CSR '                      06534013
065350                      '-'                  PV-DISP-PO             06535013
065360                      '-'                  PV-DISP-RCVR           06536013
065370                      '-'                  PV-DISP-SSCC           06537013
065380                      '-'                  DELIMITED BY SIZE      06538013
065390                                      INTO PV-CICS-MSG-AREA3      06539013
065400                                                                  06540013
065410              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06541013
065420              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06542013
065430                                                                  06543013
065440              PERFORM 9999-WRITE-TO-CSSL                          06544013
065450                                                                  06545013
065460                 SET PS-PROCESSING-ERROR-YES TO TRUE              06546013
065470                 PERFORM 9998-WRITE-TO-CSSL                       06547013
065480         END-EVALUATE.                                            06548013
065490                                                                  06549013
065500                                                                  06550013
065510 EJECT                                                            06551013
065520******************************************************************06552013
065530 2350-OPEN-PREPK-CSR.                                             06553013
065540*                                                                 06554013
065550** added internal table to track paragraph execution time         06555013
065560** dmh 2014-12-22 - begin                                         06556013
065570*                                                                 06557013
065580     MOVE  '2350'  TO  PT-CURR-PARA.                              06558013
065590     IF  PS-BLD-INTERNAL-TABLE-YES                                06559013
065600         PERFORM 0200-INTERNAL-TABLE                              06560013
065610     ELSE                                                         06561013
065620         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06562013
065630     END-IF.                                                      06563013
065640                                                                  06564013
065650*                                                                 06565013
065660** DMH 2014-12-22 - END                                           06566013
065670*                                                                 06567013
065680                                                                  06568013
065690         EXEC SQL                                                 06569013
065700              OPEN PREPK-CSR                                      06570013
065710         END-EXEC                                                 06571013
065720                                                                  06572013
065730                                                                  06573013
065740         EVALUATE TRUE                                            06574013
065750             WHEN SQLCODE = ZERO                                  06575013
065760                 CONTINUE                                         06576013
065770             WHEN SQLWARN0 NOT = SPACES                           06577013
065780             WHEN SQLCODE < ZERO                                  06578013
065790             WHEN SQLCODE > ZERO                                  06579013
065800                                                                  06580013
065810              INITIALIZE PV-CICS-MSG-AREA1                        06581013
065820              INITIALIZE PV-CICS-MSG-AREA2                        06582013
065830                                                                  06583013
065840              MOVE SQLCODE              TO PV-DISP-SQLCODE        06584013
065850              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06585013
065860              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06586013
065870              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06587013
065880                                                                  06588013
065890              STRING  'SUKCS782 2350-'                            06589099
065900                      ' DC:'               PV-DISP-DC             06590013
065910                      ' B1:'               SU054-BAR-CODE-1       06591013
065920                      ' B2:'               SU054-BAR-CODE-2       06592013
065930                      ' B3:'               SU054-BAR-CODE-3       06593013
065940                                           DELIMITED BY SIZE      06594013
065950                                      INTO PV-CICS-MSG-AREA1      06595013
065960                                                                  06596013
065970              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06597013
065980              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06598013
065990                                                                  06599013
066000              PERFORM 9999-WRITE-TO-CSSL                          06600013
066010                                                                  06601013
066020              STRING  'SUKCS782 '          SU054-KOHLS-SML        06602099
066030                      ' TRIP:'             PV-DISP-TRIP           06603013
066040                      ' DR:'               SU054-DOOR-NUMBER      06604013
066050                      ' USR:'              SU054-USER-ID          06605013
066060                      ' STA:'              PV-DISP-PNA-STA        06606013
066070                      ' SQL:'              PV-DISP-SQLCODE        06607013
066080                      ' TSHUUPC/TINPKSU/TPKSLIP/TRECITM/TDISTHD'  06608013
066090                                           DELIMITED BY SIZE      06609013
066100                                      INTO PV-CICS-MSG-AREA2      06610013
066110                                                                  06611013
066120              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06612013
066130              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06613013
066140                                                                  06614013
066150              PERFORM 9999-WRITE-TO-CSSL                          06615013
066160                                                                  06616013
066170              INITIALIZE PV-CICS-MSG-AREA3                        06617013
066180              MOVE DK-PO             TO PV-DISP-PO                06618013
066190              MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR              06619013
066200              MOVE DK-CTN            TO PV-DISP-SSCC              06620013
066210                                                                  06621013
066220              STRING  'SUKCS782 '                                 06622099
066230                      'OPEN PREPK-CSR  '                          06623013
066240                      '-'                  PV-DISP-PO             06624013
066250                      '-'                  PV-DISP-RCVR           06625013
066260                      '-'                  PV-DISP-SSCC           06626013
066270                      '-'                  DELIMITED BY SIZE      06627013
066280                                      INTO PV-CICS-MSG-AREA3      06628013
066290                                                                  06629013
066300              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06630013
066310              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06631013
066320                                                                  06632013
066330              PERFORM 9999-WRITE-TO-CSSL                          06633013
066340                                                                  06634013
066350                 SET PS-PROCESSING-ERROR-YES TO TRUE              06635013
066360                 PERFORM 9998-WRITE-TO-CSSL                       06636013
066370         END-EVALUATE.                                            06637013
066380                                                                  06638013
066390 EJECT                                                            06639013
066400*----------------------------------------------------------------*06640013
066410*                                                                *06641013
066420*----------------------------------------------------------------*06642013
066430 2360-FETCH-PREPK-CSR.                                            06643013
066440*                                                                 06644013
066450** added internal table to track paragraph execution time         06645013
066460** dmh 2014-12-22 - begin                                         06646013
066470*                                                                 06647013
066480     MOVE  '2360'  TO  PT-CURR-PARA.                              06648013
066490     IF  PS-BLD-INTERNAL-TABLE-YES                                06649013
066500         PERFORM 0200-INTERNAL-TABLE                              06650013
066510     ELSE                                                         06651013
066520         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06652013
066530     END-IF.                                                      06653013
066540                                                                  06654013
066550*                                                                 06655013
066560** DMH 2014-12-22 - END                                           06656013
066570*                                                                 06657013
066580                                                                  06658013
066590     MOVE  PV-CTN-N    TO DK-CTN.                                 06659013
066600     MOVE  ZERO        TO DK-PO-LNE-NBR.                          06660013
066610                                                                  06661013
066620     EXEC SQL                                                     06662013
066630        FETCH   PREPK-CSR                                         06663013
066640        INTO   :SHUUPC-TRN-NBR                                    06664013
066650              ,:DISTHD-ORD-LNE-NBR                                06665013
066660              ,:RECITM-PREPK-ID                                   06666013
066670              ,:RECITM-PREPK-RATO-QTY                             06667013
066680              ,:SHUUPC-SHPD-QTY                                   06668013
066690              ,:DISTHD-PREPK-LNE-PRC-CDE                          06669013
066700              ,:DISTHD-UCC128-DAT-USG-CDE                         06670013
066710              ,:DISTHD-PRC-AREA-MODU-ID                           06671013
066720     END-EXEC.                                                    06672013
066730                                                                  06673013
066740     EVALUATE TRUE                                                06674013
066750       WHEN SQLCODE = ZEROS                                       06675013
066760            SET PS-FOUND-ON-CURSOR TO TRUE                        06676013
066770            IF DISTHD-UCC128-DAT-USG-CDE  = 'U'                   06677013
066780               DIVIDE SHUUPC-SHPD-QTY BY RECITM-PREPK-RATO-QTY    06678013
066790                      GIVING PV-MULTIPLE REMAINDER PV-REMAINDER   06679013
066800               IF PV-REMAINDER = 0                                06680013
066810                  IF PS-FIRST-PREPK                               06681013
066820                     MOVE PV-MULTIPLE TO PV-HOLD-MULTIPLE         06682013
066830                     SET PS-NOT-FIRST-PREPK TO TRUE               06683013
066840                  END-IF                                          06684013
066850               ELSE                                               06685013
066860                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               06686013
066870                  PERFORM 5005-PRINT-MESSAGE-LABELS               06687013
066880               END-IF                                             06688013
066890               IF PV-MULTIPLE NOT EQUAL PV-HOLD-MULTIPLE          06689013
066900                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               06690013
066910                  PERFORM 5005-PRINT-MESSAGE-LABELS               06691013
066920               END-IF                                             06692013
066930            END-IF                                                06693013
066940                                                                  06694013
066950            IF DISTHD-PREPK-LNE-PRC-CDE  = 'D'                    06695013
066960               MOVE DISTHD-ORD-LNE-NBR  TO  SHUUPC-TRN-LNE-NBR    06696013
066970                                            PV-PO-LINE-N          06697013
066980               PERFORM  7230-GET-DEPT-CL-SKU                      06698013
066990               PERFORM  7235-GET-OUTER-PACK                       06699013
067000***PV-OUTR-PACK-QTY populates tlbptda and dk-outer-qty            06700013
067010***is the driver line shp-qty used in sql                         06701013
067020               MOVE SHUUPC-SHPD-QTY     TO  DK-OUTER-QTY          06702013
067030            END-IF                                                06703013
067040                                                                  06704013
067050            SET  PS-MULTI-LINE       TO  TRUE                     06705013
067060            MOVE SHUUPC-TRN-NBR      TO  PV-PO-NBR                06706013
067070            MOVE RECITM-PREPK-ID     TO  PV-PREPK-ID              06707013
067080                                         PV-PO-LINE-N             06708013
067090                                         DK-PREPK-ID              06709013
067100       WHEN SQLCODE = +100                                        06710013
067110                SET  PS-EO-PREPK-CSR TO TRUE                      06711013
067120       WHEN OTHER                                                 06712013
067130                                                                  06713013
067140              INITIALIZE PV-CICS-MSG-AREA1                        06714013
067150              INITIALIZE PV-CICS-MSG-AREA2                        06715013
067160                                                                  06716013
067170              MOVE SQLCODE              TO PV-DISP-SQLCODE        06717013
067180              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06718013
067190              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06719013
067200              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06720013
067210                                                                  06721013
067220              STRING  'SUKCS782 2360-'                            06722099
067230                      ' DC:'               PV-DISP-DC             06723013
067240                      ' B1:'               SU054-BAR-CODE-1       06724013
067250                      ' B2:'               SU054-BAR-CODE-2       06725013
067260                      ' B3:'               SU054-BAR-CODE-3       06726013
067270                                           DELIMITED BY SIZE      06727013
067280                                      INTO PV-CICS-MSG-AREA1      06728013
067290                                                                  06729013
067300              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06730013
067310              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06731013
067320                                                                  06732013
067330              PERFORM 9999-WRITE-TO-CSSL                          06733013
067340                                                                  06734013
067350              STRING  'SUKCS782 '          SU054-KOHLS-SML        06735099
067360                      ' TRIP:'             PV-DISP-TRIP           06736013
067370                      ' DR:'               SU054-DOOR-NUMBER      06737013
067380                      ' USR:'              SU054-USER-ID          06738013
067390                      ' STA:'              PV-DISP-PNA-STA        06739013
067400                      ' SQL:'              PV-DISP-SQLCODE        06740013
067410                      ' TSHUUPC/TINPKSU/TPKSLIP/TRECITM/TDISTHD'  06741013
067420                                           DELIMITED BY SIZE      06742013
067430                                      INTO PV-CICS-MSG-AREA2      06743013
067440                                                                  06744013
067450              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06745013
067460              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06746013
067470                                                                  06747013
067480              PERFORM 9999-WRITE-TO-CSSL                          06748013
067490                                                                  06749013
067500              INITIALIZE PV-CICS-MSG-AREA3                        06750013
067510              MOVE DK-PO             TO PV-DISP-PO                06751013
067520              MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR              06752013
067530              MOVE DK-CTN            TO PV-DISP-SSCC              06753013
067540                                                                  06754013
067550              STRING  'SUKCS782 '                                 06755099
067560                      'FETCH PREPK-CSR  '                         06756013
067570                      '-'                  PV-DISP-PO             06757013
067580                      '-'                  PV-DISP-RCVR           06758013
067590                      '-'                  PV-DISP-SSCC           06759013
067600                      '-'                  DELIMITED BY SIZE      06760013
067610                                      INTO PV-CICS-MSG-AREA3      06761013
067620                                                                  06762013
067630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06763013
067640              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06764013
067650                                                                  06765013
067660              PERFORM 9999-WRITE-TO-CSSL                          06766013
067670                                                                  06767013
067680             SET PS-PROCESSING-ERROR-YES TO TRUE                  06768013
067690             PERFORM 9998-WRITE-TO-CSSL                           06769013
067700             SET  PS-EO-PREPK-CSR TO TRUE                         06770013
067710     END-EVALUATE.                                                06771013
067720                                                                  06772013
067730                                                                  06773013
067740 2370-CLOSE-PREPK-CSR.                                            06774013
067750*                                                                 06775013
067760** added internal table to track paragraph execution time         06776013
067770** dmh 2014-12-22 - begin                                         06777013
067780*                                                                 06778013
067790     MOVE  '2370'  TO  PT-CURR-PARA.                              06779013
067800     IF  PS-BLD-INTERNAL-TABLE-YES                                06780013
067810         PERFORM 0200-INTERNAL-TABLE                              06781013
067820     ELSE                                                         06782013
067830         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06783013
067840     END-IF.                                                      06784013
067850                                                                  06785013
067860*                                                                 06786013
067870** DMH 2014-12-22 - END                                           06787013
067880*                                                                 06788013
067890                                                                  06789013
067900         EXEC SQL                                                 06790013
067910             CLOSE PREPK-CSR                                      06791013
067920         END-EXEC                                                 06792013
067930                                                                  06793013
067940                                                                  06794013
067950         EVALUATE TRUE                                            06795013
067960             WHEN SQLCODE = ZERO                                  06796013
067970                 CONTINUE                                         06797013
067980             WHEN SQLWARN0 NOT = SPACES                           06798013
067990             WHEN SQLCODE < ZERO                                  06799013
068000             WHEN SQLCODE > ZERO                                  06800013
068010                                                                  06801013
068020              INITIALIZE PV-CICS-MSG-AREA1                        06802013
068030              INITIALIZE PV-CICS-MSG-AREA2                        06803013
068040                                                                  06804013
068050              MOVE SQLCODE              TO PV-DISP-SQLCODE        06805013
068060              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06806013
068070              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06807013
068080              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06808013
068090                                                                  06809013
068100              STRING  'SUKCS782 2370-'                            06810099
068110                      ' DC:'               PV-DISP-DC             06811013
068120                      ' B1:'               SU054-BAR-CODE-1       06812013
068130                      ' B2:'               SU054-BAR-CODE-2       06813013
068140                      ' B3:'               SU054-BAR-CODE-3       06814013
068150                                           DELIMITED BY SIZE      06815013
068160                                      INTO PV-CICS-MSG-AREA1      06816013
068170                                                                  06817013
068180              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06818013
068190              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06819013
068200                                                                  06820013
068210              PERFORM 9999-WRITE-TO-CSSL                          06821013
068220                                                                  06822013
068230              STRING  'SUKCS782 '          SU054-KOHLS-SML        06823099
068240                      ' TRIP:'             PV-DISP-TRIP           06824013
068250                      ' DR:'               SU054-DOOR-NUMBER      06825013
068260                      ' USR:'              SU054-USER-ID          06826013
068270                      ' STA:'              PV-DISP-PNA-STA        06827013
068280                      ' SQL:'              PV-DISP-SQLCODE        06828013
068290                      ' TSHUUPC/TINPKSU/TPKSLIP/TRECITM/TDISTHD'  06829013
068300                                           DELIMITED BY SIZE      06830013
068310                                      INTO PV-CICS-MSG-AREA2      06831013
068320                                                                  06832013
068330              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06833013
068340              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06834013
068350                                                                  06835013
068360              PERFORM 9999-WRITE-TO-CSSL                          06836013
068370                                                                  06837013
068380              INITIALIZE PV-CICS-MSG-AREA3                        06838013
068390              MOVE DK-PO             TO PV-DISP-PO                06839013
068400              MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR              06840013
068410              MOVE DK-CTN            TO PV-DISP-SSCC              06841013
068420                                                                  06842013
068430              STRING  'SUKCS782 '                                 06843099
068440                      'close PREPK-CSR  '                         06844013
068450                      '-'                  PV-DISP-PO             06845013
068460                      '-'                  PV-DISP-RCVR           06846013
068470                      '-'                  PV-DISP-SSCC           06847013
068480                      '-'                  DELIMITED BY SIZE      06848013
068490                                      INTO PV-CICS-MSG-AREA3      06849013
068500                                                                  06850013
068510              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06851013
068520              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06852013
068530                                                                  06853013
068540              PERFORM 9999-WRITE-TO-CSSL                          06854013
068550                                                                  06855013
068560                 SET PS-PROCESSING-ERROR-YES TO TRUE              06856013
068570                 PERFORM 9998-WRITE-TO-CSSL                       06857013
068580         END-EVALUATE.                                            06858013
068590                                                                  06859013
068600                                                                  06860013
068610*---------------------------------------------------------------* 06861013
068620*                                                               * 06862013
068630*                                                               * 06863013
068640*  2014-12-03 - DMH - Added "WITH UR" to SQL                    * 06864013
068650*---------------------------------------------------------------* 06865013
068660 2380-SELECT-PREPAK-INFO.                                         06866013
068670*                                                                 06867013
068680** added internal table to track paragraph execution time         06868013
068690** dmh 2014-12-22 - begin                                         06869013
068700*                                                                 06870013
068710     MOVE  '2380'  TO  PT-CURR-PARA.                              06871013
068720     IF  PS-BLD-INTERNAL-TABLE-YES                                06872013
068730         PERFORM 0200-INTERNAL-TABLE                              06873013
068740     ELSE                                                         06874013
068750         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06875013
068760     END-IF.                                                      06876013
068770                                                                  06877013
068780*                                                                 06878013
068790** DMH 2014-12-22 - END                                           06879013
068800*                                                                 06880013
068810                                                                  06881013
068820     EXEC SQL                                                     06882013
068830          SELECT                                                  06883013
068840                 E.ORD_LNE_NBR                                    06884013
068850                ,D.PREPK_ID                                       06885013
068860          INTO  :DISTHD-ORD-LNE-NBR                               06886013
068870              , :RECITM-PREPK-ID                                  06887013
068880          FROM   TSHUUPC A                                        06888013
068890               , TINPKSU B                                        06889013
068900               , TPKSLIP C                                        06890013
068910               , TRECITM D                                        06891013
068920               , TDISTHD E                                        06892013
068930          WHERE A.SHIPT_UNT_ID = :DK-CTN                          06893013
068940          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    06894013
068950          AND  B.PO_NBR       = C.PO_NBR                          06895013
068960          AND  B.SEQ_NBR      = C.SEQ_NBR                         06896013
068970          AND  C.VER_STAT_CDE = 'A'                               06897013
068980          AND  C.PO_NBR       = D.ORD_NBR                         06898013
068990          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     06899013
069000          AND  C.REC_SEQ_NBR  = :PV-RCVR-SEQ-NBR                  06900013
069010          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     06901013
069020          AND  E.ORD_NBR      = C.PO_NBR                          06902013
069030          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     06903013
069040          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     06904013
069050          AND  E.TOT_CART_CNT > 0                                 06905013
069060          AND  E.PREPK_LNE_PRC_CDE  = 'D'                         06906013
069070         WITH UR                                                  06907013
069080     END-EXEC                                                     06908013
069090                                                                  06909013
069100     EVALUATE TRUE                                                06910013
069110       WHEN SQLCODE = ZEROS                                       06911013
069120               MOVE DISTHD-ORD-LNE-NBR  TO  PV-DRIVER-LINE-NO     06912013
069130       WHEN SQLCODE = +100                                        06913013
069140               MOVE +0                  TO  PV-DRIVER-LINE-NO     06914013
069150                                            RECITM-PREPK-ID       06915013
069160       WHEN OTHER                                                 06916013
069170                                                                  06917013
069180              INITIALIZE PV-CICS-MSG-AREA1                        06918013
069190              INITIALIZE PV-CICS-MSG-AREA2                        06919013
069200                                                                  06920013
069210              MOVE SQLCODE              TO PV-DISP-SQLCODE        06921013
069220              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             06922013
069230              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           06923013
069240              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        06924013
069250                                                                  06925013
069260              STRING  'SUKCS782 2380-'                            06926099
069270                      ' DC:'               PV-DISP-DC             06927013
069280                      ' B1:'               SU054-BAR-CODE-1       06928013
069290                      ' B2:'               SU054-BAR-CODE-2       06929013
069300                      ' B3:'               SU054-BAR-CODE-3       06930013
069310                                           DELIMITED BY SIZE      06931013
069320                                      INTO PV-CICS-MSG-AREA1      06932013
069330                                                                  06933013
069340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06934013
069350              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     06935013
069360                                                                  06936013
069370              PERFORM 9999-WRITE-TO-CSSL                          06937013
069380                                                                  06938013
069390              STRING  'SUKCS782 '          SU054-KOHLS-SML        06939099
069400                      ' TRIP:'             PV-DISP-TRIP           06940013
069410                      ' DR:'               SU054-DOOR-NUMBER      06941013
069420                      ' USR:'              SU054-USER-ID          06942013
069430                      ' STA:'              PV-DISP-PNA-STA        06943013
069440                      ' SQL:'              PV-DISP-SQLCODE        06944013
069450                      ' TSHUUPC/TINPKSU/TPKSLIP/TRECITM/TDISTHD'  06945013
069460                                           DELIMITED BY SIZE      06946013
069470                                      INTO PV-CICS-MSG-AREA2      06947013
069480                                                                  06948013
069490              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06949013
069500              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     06950013
069510                                                                  06951013
069520              PERFORM 9999-WRITE-TO-CSSL                          06952013
069530                                                                  06953013
069540              INITIALIZE PV-CICS-MSG-AREA3                        06954013
069550              MOVE DK-PO             TO PV-DISP-PO                06955013
069560              MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR              06956013
069570              MOVE DK-CTN            TO PV-DISP-SSCC              06957013
069580                                                                  06958013
069590              STRING  'SUKCS782 '                                 06959099
069600                      '-'                  PV-DISP-PO             06960013
069610                      '-'                  PV-DISP-RCVR           06961013
069620                      '-'                  PV-DISP-SSCC           06962013
069630                      '-'                  DELIMITED BY SIZE      06963013
069640                                      INTO PV-CICS-MSG-AREA3      06964013
069650                                                                  06965013
069660              MOVE SPACES               TO PV-CICS-MSG-AREA-A     06966013
069670              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     06967013
069680                                                                  06968013
069690              PERFORM 9999-WRITE-TO-CSSL                          06969013
069700                                                                  06970013
069710             SET PS-PROCESSING-ERROR-YES TO TRUE                  06971013
069720             PERFORM 9998-WRITE-TO-CSSL                           06972013
069730     END-EVALUATE.                                                06973013
069740                                                                  06974013
069750 EJECT                                                            06975013
069760*----------------------------------------------------------------*06976013
069770*  GET LABEL BATCH NUMBER                                        *06977013
069780*                                                                *06978013
069790*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *06979013
069800*----------------------------------------------------------------*06980013
069810 2400-GET-BATCH-NUMBER.                                           06981013
069820*                                                                 06982013
069830** added internal table to track paragraph execution time         06983013
069840** dmh 2014-12-22 - begin                                         06984013
069850*                                                                 06985013
069860     MOVE  '2400'  TO  PT-CURR-PARA.                              06986013
069870     IF  PS-BLD-INTERNAL-TABLE-YES                                06987013
069880         PERFORM 0200-INTERNAL-TABLE                              06988013
069890     ELSE                                                         06989013
069900         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       06990013
069910     END-IF.                                                      06991013
069920                                                                  06992013
069930*                                                                 06993013
069940** DMH 2014-12-22 - END                                           06994013
069950*                                                                 06995013
069960                                                                  06996013
069970     MOVE  SU054-TRIP-ID     TO  DK-MANIFEST.                     06997013
069980                                                                  06998013
069990     EXEC SQL                                                     06999013
070000         SELECT MAX(LBL_PRT_BTCH_ID)                              07000013
070010         INTO   :PV-MAX-USER-BATCH                                07001013
070020          FROM  TLBPTDA                                           07002013
070030          WHERE TRIP_ID           = :DK-MANIFEST                  07003013
070040            AND CRE_USR_ID        = :SU054-USER-ID                07004013
070050     END-EXEC.                                                    07005013
070060                                                                  07006013
070070     EVALUATE TRUE                                                07007013
070080         WHEN SQLCODE = ZERO                                      07008013
070090             IF  PV-MAX-USER-BATCH  >  ZERO                       07009013
070100                 CONTINUE                                         07010013
070110             ELSE                                                 07011013
070120                 MOVE  ZEROES  TO  PV-MAX-USER-BATCH              07012013
070130             END-IF                                               07013013
070140         WHEN SQLCODE = -305                                      07014013
070150             MOVE  ZEROES  TO  PV-MAX-USER-BATCH                  07015013
070160         WHEN SQLWARN0 NOT = SPACES                               07016013
070170         WHEN SQLCODE NOT EQUAL ZERO                              07017013
070180                                                                  07018013
070190              INITIALIZE PV-CICS-MSG-AREA1                        07019013
070200              INITIALIZE PV-CICS-MSG-AREA2                        07020013
070210                                                                  07021013
070220              MOVE SQLCODE              TO PV-DISP-SQLCODE        07022013
070230              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07023013
070240              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07024013
070250              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07025013
070260                                                                  07026013
070270              STRING  'SUKCS782 2400-'                            07027099
070280                      ' DC:'               PV-DISP-DC             07028013
070290                      ' B1:'               SU054-BAR-CODE-1       07029013
070300                      ' B2:'               SU054-BAR-CODE-2       07030013
070310                      ' B3:'               SU054-BAR-CODE-3       07031013
070320                                           DELIMITED BY SIZE      07032013
070330                                      INTO PV-CICS-MSG-AREA1      07033013
070340                                                                  07034013
070350              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07035013
070360              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07036013
070370                                                                  07037013
070380              PERFORM 9999-WRITE-TO-CSSL                          07038013
070390                                                                  07039013
070400              STRING  'SUKCS782 '          SU054-KOHLS-SML        07040099
070410                      ' TRIP:'             PV-DISP-TRIP           07041013
070420                      ' DR:'               SU054-DOOR-NUMBER      07042013
070430                      ' USR:'              SU054-USER-ID          07043013
070440                      ' STA:'              PV-DISP-PNA-STA        07044013
070450                      ' SQL:'              PV-DISP-SQLCODE        07045013
070460                      ' TLBPTDA'                                  07046013
070470                                           DELIMITED BY SIZE      07047013
070480                                      INTO PV-CICS-MSG-AREA2      07048013
070490                                                                  07049013
070500              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07050013
070510              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07051013
070520                                                                  07052013
070530              PERFORM 9999-WRITE-TO-CSSL                          07053013
070540                                                                  07054013
070550             SET PS-PROCESSING-ERROR-YES TO TRUE                  07055013
070560             PERFORM 9998-WRITE-TO-CSSL                           07056013
070570     END-EVALUATE.                                                07057013
070580                                                                  07058013
070590                                                                  07059013
070600*----------------------------------------------------------------*07060013
070610*  DETERMINE RECEIVER                                            *07061013
070620*                                                                *07062013
070630*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *07063013
070640*----------------------------------------------------------------*07064013
070650 2410-DETERMINE-RECEIVER.                                         07065013
070660*                                                                 07066013
070670** added internal table to track paragraph execution time         07067013
070680** dmh 2014-12-22 - begin                                         07068013
070690*                                                                 07069013
070700     MOVE  '2410'  TO  PT-CURR-PARA.                              07070013
070710     IF  PS-BLD-INTERNAL-TABLE-YES                                07071013
070720         PERFORM 0200-INTERNAL-TABLE                              07072013
070730     ELSE                                                         07073013
070740         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07074013
070750     END-IF.                                                      07075013
070760                                                                  07076013
070770*                                                                 07077013
070780** DMH 2014-12-22 - END                                           07078013
070790*                                                                 07079013
070800                                                                  07080013
070810     MOVE  PV-CTN-N  TO  DK-CTN.                                  07081013
070820     MOVE  ZEROES    TO  PV-RCVR-SEQ-NBR.                         07082013
070830     MOVE  PV-PO-NBR TO  DK-PO.                                   07083013
070840                                                                  07084013
070850     INITIALIZE  PV-RCVR-SEQ-NBR                                  07085013
070860                 PV-CRTN-TRIP-ID                                  07086013
070870                 VHTRIP-OWNER-SCAC-ID                             07087013
070880                 VHTRIP-VEH-NBR                                   07088013
070890                 RECEIV-PACK-BY-ST-IND                            07089013
070900                 RECEIV-PKGNG-CDE                                 07090013
070910                 RECEIV-CURR-OPER-UNT-ID                          07091013
070920                 PV-DATE-CCYY-MM-DD.                              07092013
070930                                                                  07093013
070940     EXEC SQL                                                     07094013
070950         SELECT DISTINCT                                          07095013
070960                C.REC_SEQ_NBR                                     07096013
070970              , A.TRIP_ID                                         07097013
070980              , A.OWNER_SCAC_ID                                   07098013
070990              , A.VEH_NBR                                         07099013
071000              , D.PACK_BY_ST_IND                                  07100013
071010              , D.PKGNG_CDE                                       07101013
071020              , D.OPER_UNT_ID                                     07102013
071030              , D.CURR_OPER_UNT_ID                                07103013
071040              , D.CRE_OPER_UNT_ID                                 07104013
071050              , E.CRE_SRC_CDE                                     07105013
071060              , F.SEQ_NBR                                         07106013
071070              , E.ORIG_PKSL_SEQ_NBR                               07107013
071080              , E.PKSL_STAT_CDE                                   07108013
071090              , DATE(D.REC_TMST)                                  07109013
071100         INTO   :PV-RCVR-SEQ-NBR                                  07110013
071110              , :PV-CRTN-TRIP-ID                                  07111013
071120              , :VHTRIP-OWNER-SCAC-ID                             07112013
071130              , :VHTRIP-VEH-NBR         :PV-NULL-IND              07113013
071140              , :RECEIV-PACK-BY-ST-IND                            07114013
071150              , :RECEIV-PKGNG-CDE                                 07115013
071160              , :RECEIV-OPER-UNT-ID                               07116013
071170              , :RECEIV-CURR-OPER-UNT-ID                          07117013
071180              , :RECEIV-CRE-OPER-UNT-ID                           07118013
071190              , :PKSLIP-CRE-SRC-CDE                               07119013
071200              , :INPKSU-SEQ-NBR                                   07120013
071210              , :PKSLIP-ORIG-PKSL-SEQ-NBR                         07121013
071220              , :PKSLIP-PKSL-STAT-CDE                             07122013
071230              , :PV-DATE-CCYY-MM-DD                               07123013
071240          FROM  TVHTRIP A                                         07124013
071250              , TSHIPMT B                                         07125013
071260              , TSHPTPO C                                         07126013
071270              , TRECEIV D                                         07127013
071280              , TPKSLIP E                                         07128013
071290              , TINPKSU F                                         07129013
071300              , TSHPUNT G                                         07130013
071310          WHERE A.TRIP_ID           = B.TRIP_ID                   07131013
071320            AND C.SHIPT_ID          = B.SHIPT_ID                  07132013
071330            AND C.PO_NBR            = :DK-PO                      07133013
071340            AND C.PO_NBR            = D.ORD_NBR                   07134013
071350            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               07135013
071360            AND D.VER_STATUS_CDE    = 'A'                         07136013
071370            AND E.VER_STAT_CDE      = 'A'                         07137013
071380            AND C.PO_NBR            = E.PO_NBR                    07138013
071390            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               07139013
071400            AND E.PO_NBR            = F.PO_NBR                    07140013
071410            AND E.SEQ_NBR           = F.SEQ_NBR                   07141013
071420            AND F.SHIPT_UNT_ID      = :DK-CTN                     07142013
071430            AND F.SHIPT_UNT_ID      = G.SHIPT_UNT_ID              07143013
071440            AND G.ACTV_IND          = 'A'                         07144013
071450     END-EXEC.                                                    07145013
071460                                                                  07146013
071470     EVALUATE TRUE                                                07147013
071480         WHEN SQLCODE = ZERO                                      07148013
071490             SET   PS-CRTN-ATT-TO-RCVR                            07149013
071500                   PS-RCVR-DATA-FOUND-YES                         07150013
071510                   SU044-UPDATE-RCVR-PKSLIP TO TRUE               07151013
071520             IF  PV-RCVR-SEQ-NBR  >  ZERO                         07152013
071530                 MOVE PV-RCVR-SEQ-NBR TO PV-DISP-RCVR             07153013
071540                 IF PKSLIP-PKSL-STAT-CDE = 'IN'                   07154013
071550                    SET   PS-NOT-CRTN-ATT-TO-TRIP                 07155013
071560                          SU044-UPDATE-PKSLIP-ONLY   TO TRUE      07156013
071570                 ELSE                                             07157013
071580                    IF  PV-CRTN-TRIP-ID  =  SU054-TRIP-ID         07158013
071590                        SET   PS-CRTN-ATT-TO-TRIP TO TRUE         07159013
071600                    ELSE                                          07160013
071610                        SET   PS-NOT-CRTN-ATT-TO-TRIP TO TRUE     07161013
071620                    END-IF                                        07162013
071630                 END-IF                                           07163013
071640             ELSE                                                 07164013
071650                 MOVE  ZEROES  TO  PV-RCVR-SEQ-NBR                07165013
071660                 SET   PS-NOT-CRTN-ATT-TO-TRIP TO TRUE            07166013
071670             END-IF                                               07167013
071680         WHEN SQLCODE = +100                                      07168013
071690             MOVE  ZEROES  TO  PV-RCVR-SEQ-NBR                    07169013
071700             PERFORM 2420-CHECK-TPKSLIP-EXISTS                    07170013
071710             IF PV-DB2-PKSLIP-COUNT > 0                           07171013
071720                SET PS-UCC128-PKSLIP-ERROR-NO TO TRUE             07172013
071730             ELSE                                                 07173013
071740                SET PS-UCC128-PKSLIP-ERROR-YES TO TRUE            07174013
071750             END-IF                                               07175013
071760                                                                  07176013
071770             SET   PS-NOT-CRTN-ATT-TO-RCVR                        07177013
071780                   PS-NOT-CRTN-ATT-TO-TRIP                        07178013
071790                   PS-RCVR-DATA-FOUND-NO      TO TRUE             07179013
071800             SET   SU044-UPDATE-PKSLIP-ONLY   TO TRUE             07180013
071810         WHEN SQLCODE = -811                                      07181013
071820             PERFORM 2415-DETERMINE-RECEIVER-2                    07182013
071830                                                                  07183013
071840         WHEN SQLWARN0 NOT = SPACES                               07184013
071850         WHEN SQLCODE NOT EQUAL ZERO                              07185013
071860                                                                  07186013
071870              INITIALIZE PV-CICS-MSG-AREA1                        07187013
071880              INITIALIZE PV-CICS-MSG-AREA2                        07188013
071890                                                                  07189013
071900              MOVE SQLCODE              TO PV-DISP-SQLCODE        07190013
071910              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07191013
071920              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07192013
071930              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07193013
071940                                                                  07194013
071950              STRING  'SUKCS782 2410-'                            07195099
071960                      ' DC:'               PV-DISP-DC             07196013
071970                      ' B1:'               SU054-BAR-CODE-1       07197013
071980                      ' B2:'               SU054-BAR-CODE-2       07198013
071990                      ' B3:'               SU054-BAR-CODE-3       07199013
072000                                           DELIMITED BY SIZE      07200013
072010                                      INTO PV-CICS-MSG-AREA1      07201013
072020                                                                  07202013
072030              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07203013
072040              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07204013
072050                                                                  07205013
072060              PERFORM 9999-WRITE-TO-CSSL                          07206013
072070                                                                  07207013
072080              STRING  'SUKCS782 '          SU054-KOHLS-SML        07208099
072090                      ' TRIP:'             PV-DISP-TRIP           07209013
072100                      ' DR:'               SU054-DOOR-NUMBER      07210013
072110                      ' USR:'              SU054-USER-ID          07211013
072120                      ' STA:'              PV-DISP-PNA-STA        07212013
072130                      ' SQL:'              PV-DISP-SQLCODE        07213013
072140                      ' TVHTRIP/TSHIPMT/TSHPTPO/TRECEIV/'         07214013
072150                      'TPKSLIP/TINPKSU/TSHPUNT'                   07215013
072160                                           DELIMITED BY SIZE      07216013
072170                                      INTO PV-CICS-MSG-AREA2      07217013
072180                                                                  07218013
072190              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07219013
072200              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07220013
072210                                                                  07221013
072220              PERFORM 9999-WRITE-TO-CSSL                          07222013
072230                                                                  07223013
072240              INITIALIZE PV-CICS-MSG-AREA3                        07224013
072250              MOVE DK-PO             TO PV-DISP-PO                07225013
072260              MOVE DK-CTN            TO PV-DISP-SSCC              07226013
072270                                                                  07227013
072280              STRING  'SUKCS782 '                                 07228099
072290                      '-'                  PV-DISP-PO             07229013
072300                      '-'                  PV-DISP-SSCC           07230013
072310                      '-'                  DELIMITED BY SIZE      07231013
072320                                      INTO PV-CICS-MSG-AREA3      07232013
072330                                                                  07233013
072340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07234013
072350              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07235013
072360                                                                  07236013
072370              PERFORM 9999-WRITE-TO-CSSL                          07237013
072380                                                                  07238013
072390             SET PS-PROCESSING-ERROR-YES TO TRUE                  07239013
072400             PERFORM 9998-WRITE-TO-CSSL                           07240013
072410     END-EVALUATE.                                                07241013
072420                                                                  07242013
072430                                                                  07243013
072440*----------------------------------------------------------------*07244013
072450*  DETERMINE RECEIVER - specific trailer                         *07245013
072460*                                                                *07246013
072470*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *07247013
072480*----------------------------------------------------------------*07248013
072490 2415-DETERMINE-RECEIVER-2.                                       07249013
072500*                                                                 07250013
072510** added internal table to track paragraph execution time         07251013
072520** dmh 2014-12-22 - begin                                         07252013
072530*                                                                 07253013
072540     MOVE  '2415'  TO  PT-CURR-PARA.                              07254013
072550     IF  PS-BLD-INTERNAL-TABLE-YES                                07255013
072560         PERFORM 0200-INTERNAL-TABLE                              07256013
072570     ELSE                                                         07257013
072580         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07258013
072590     END-IF.                                                      07259013
072600                                                                  07260013
072610*                                                                 07261013
072620** DMH 2014-12-22 - END                                           07262013
072630*                                                                 07263013
072640                                                                  07264013
072650     MOVE  PV-CTN-N       TO  DK-CTN.                             07265013
072660     MOVE  ZEROES         TO  PV-RCVR-SEQ-NBR.                    07266013
072670     MOVE  PV-PO-NBR      TO  DK-PO.                              07267013
072680     MOVE  SU054-TRIP-ID TO   DK-MANIFEST.                        07268013
072690                                                                  07269013
072700     INITIALIZE  PV-RCVR-SEQ-NBR                                  07270013
072710                 PV-CRTN-TRIP-ID                                  07271013
072720                 VHTRIP-OWNER-SCAC-ID                             07272013
072730                 VHTRIP-VEH-NBR                                   07273013
072740                 RECEIV-PACK-BY-ST-IND                            07274013
072750                 RECEIV-PKGNG-CDE.                                07275013
072760                                                                  07276013
072770     EXEC SQL                                                     07277013
072780         SELECT DISTINCT                                          07278013
072790                C.REC_SEQ_NBR                                     07279013
072800              , A.TRIP_ID                                         07280013
072810              , A.OWNER_SCAC_ID                                   07281013
072820              , A.VEH_NBR                                         07282013
072830              , D.PACK_BY_ST_IND                                  07283013
072840              , D.PKGNG_CDE                                       07284013
072850              , F.SEQ_NBR                                         07285013
072860              , E.ORIG_PKSL_SEQ_NBR                               07286013
072870              , E.PKSL_STAT_CDE                                   07287013
072880              , DATE(D.REC_TMST)                                  07288013
072890         INTO   :PV-RCVR-SEQ-NBR                                  07289013
072900              , :PV-CRTN-TRIP-ID                                  07290013
072910              , :VHTRIP-OWNER-SCAC-ID                             07291013
072920              , :VHTRIP-VEH-NBR         :PV-NULL-IND              07292013
072930              , :RECEIV-PACK-BY-ST-IND                            07293013
072940              , :RECEIV-PKGNG-CDE                                 07294013
072950              , :INPKSU-SEQ-NBR                                   07295013
072960              , :PKSLIP-ORIG-PKSL-SEQ-NBR                         07296013
072970              , :PKSLIP-PKSL-STAT-CDE                             07297013
072980              , :PV-DATE-CCYY-MM-DD                               07298013
072990          FROM  TVHTRIP A                                         07299013
073000              , TSHIPMT B                                         07300013
073010              , TSHPTPO C                                         07301013
073020              , TRECEIV D                                         07302013
073030              , TPKSLIP E                                         07303013
073040              , TINPKSU F                                         07304013
073050              , TSHPUNT G                                         07305013
073060          WHERE A.TRIP_ID           = :DK-MANIFEST                07306013
073070            AND A.TRIP_ID           = B.TRIP_ID                   07307013
073080            AND C.SHIPT_ID          = B.SHIPT_ID                  07308013
073090            AND C.PO_NBR            = :DK-PO                      07309013
073100            AND C.PO_NBR            = D.ORD_NBR                   07310013
073110            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               07311013
073120            AND D.VER_STATUS_CDE    = 'A'                         07312013
073130            AND E.VER_STAT_CDE      = 'A'                         07313013
073140            AND C.PO_NBR            = E.PO_NBR                    07314013
073150            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               07315013
073160            AND E.PO_NBR            = F.PO_NBR                    07316013
073170            AND E.SEQ_NBR           = F.SEQ_NBR                   07317013
073180            AND F.SHIPT_UNT_ID      = :DK-CTN                     07318013
073190            AND F.SHIPT_UNT_ID      = G.SHIPT_UNT_ID              07319013
073200            AND G.ACTV_IND          = 'A'                         07320013
073210     END-EXEC.                                                    07321013
073220                                                                  07322013
073230     EVALUATE TRUE                                                07323013
073240         WHEN SQLCODE = ZERO                                      07324013
073250             SET   PS-CRTN-ATT-TO-RCVR                            07325013
073260                   PS-RCVR-DATA-FOUND-YES                         07326013
073270                   SU044-UPDATE-RCVR-PKSLIP TO TRUE               07327013
073280             IF  PV-RCVR-SEQ-NBR  >  ZERO                         07328013
073290                 IF PKSLIP-PKSL-STAT-CDE = 'IN'                   07329013
073300                    SET   PS-NOT-CRTN-ATT-TO-TRIP                 07330013
073310                          SU044-UPDATE-PKSLIP-ONLY   TO TRUE      07331013
073320                 ELSE                                             07332013
073330                    IF  PV-CRTN-TRIP-ID  =  SU054-TRIP-ID         07333013
073340                        SET PS-CRTN-ATT-TO-TRIP TO TRUE           07334013
073350                    ELSE                                          07335013
073360                        SET PS-NOT-CRTN-ATT-TO-TRIP TO TRUE       07336013
073370                    END-IF                                        07337013
073380                 END-IF                                           07338013
073390             ELSE                                                 07339013
073400                 MOVE  ZEROES  TO  PV-RCVR-SEQ-NBR                07340013
073410                 SET   PS-NOT-CRTN-ATT-TO-TRIP TO TRUE            07341013
073420             END-IF                                               07342013
073430                                                                  07343013
073440         WHEN SQLCODE = +100                                      07344013
073450             MOVE  ZEROES  TO  PV-RCVR-SEQ-NBR                    07345013
073460             PERFORM 2420-CHECK-TPKSLIP-EXISTS                    07346013
073470             IF PV-DB2-PKSLIP-COUNT > 0                           07347013
073480                SET PS-UCC128-PKSLIP-ERROR-NO TO TRUE             07348013
073490             ELSE                                                 07349013
073500                SET PS-UCC128-PKSLIP-ERROR-YES TO TRUE            07350013
073510             END-IF                                               07351013
073520                                                                  07352013
073530             SET   PS-NOT-CRTN-ATT-TO-RCVR                        07353013
073540                   PS-NOT-CRTN-ATT-TO-TRIP                        07354013
073550                   PS-RCVR-DATA-FOUND-NO      TO TRUE             07355013
073560             SET   SU044-UPDATE-PKSLIP-ONLY   TO TRUE             07356013
073570         WHEN SQLWARN0 NOT = SPACES                               07357013
073580         WHEN SQLCODE NOT EQUAL ZERO                              07358013
073590                                                                  07359013
073600              INITIALIZE PV-CICS-MSG-AREA1                        07360013
073610              INITIALIZE PV-CICS-MSG-AREA2                        07361013
073620                                                                  07362013
073630              MOVE SQLCODE              TO PV-DISP-SQLCODE        07363013
073640              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07364013
073650              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07365013
073660              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07366013
073670                                                                  07367013
073680              STRING  'SUKCS782 2415-'                            07368099
073690                      ' DC:'               PV-DISP-DC             07369013
073700                      ' B1:'               SU054-BAR-CODE-1       07370013
073710                      ' B2:'               SU054-BAR-CODE-2       07371013
073720                      ' B3:'               SU054-BAR-CODE-3       07372013
073730                                           DELIMITED BY SIZE      07373013
073740                                      INTO PV-CICS-MSG-AREA1      07374013
073750                                                                  07375013
073760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07376013
073770              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07377013
073780                                                                  07378013
073790              PERFORM 9999-WRITE-TO-CSSL                          07379013
073800                                                                  07380013
073810              STRING  'SUKCS782 '          SU054-KOHLS-SML        07381099
073820                      ' TRIP:'             PV-DISP-TRIP           07382013
073830                      ' DR:'               SU054-DOOR-NUMBER      07383013
073840                      ' USR:'              SU054-USER-ID          07384013
073850                      ' STA:'              PV-DISP-PNA-STA        07385013
073860                      ' SQL:'              PV-DISP-SQLCODE        07386013
073870                      ' TVHTRIP/TSHIPMT/TSHPTPO/TRECEIV/'         07387013
073880                      'TPKSLIP/TINPKSU/TSHPUNT'                   07388013
073890                                           DELIMITED BY SIZE      07389013
073900                                      INTO PV-CICS-MSG-AREA2      07390013
073910                                                                  07391013
073920              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07392013
073930              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07393013
073940                                                                  07394013
073950              PERFORM 9999-WRITE-TO-CSSL                          07395013
073960                                                                  07396013
073970              INITIALIZE PV-CICS-MSG-AREA3                        07397013
073980              MOVE DK-PO             TO PV-DISP-PO                07398013
073990              MOVE DK-CTN            TO PV-DISP-SSCC              07399013
074000                                                                  07400013
074010              STRING  'SUKCS782 '                                 07401099
074020                      '-'                  PV-DISP-PO             07402013
074030                      '-'                  PV-DISP-SSCC           07403013
074040                      '-'                  DELIMITED BY SIZE      07404013
074050                                      INTO PV-CICS-MSG-AREA3      07405013
074060                                                                  07406013
074070              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07407013
074080              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07408013
074090                                                                  07409013
074100              PERFORM 9999-WRITE-TO-CSSL                          07410013
074110                                                                  07411013
074120             SET PS-PROCESSING-ERROR-YES TO TRUE                  07412013
074130             PERFORM 9998-WRITE-TO-CSSL                           07413013
074140     END-EVALUATE.                                                07414013
074150                                                                  07415013
074160                                                                  07416013
074170*----------------------------------------------------------------*07417013
074180*                                                                *07418013
074190*                                                                *07419013
074200*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *07420013
074210*                     Added "FETCH FIRST 1 ROW" the program is   *07421013
074220*                     just checking existence of                 *07422013
074230*----------------------------------------------------------------*07423013
074240 2420-CHECK-TPKSLIP-EXISTS.                                       07424013
074250*                                                                 07425013
074260** added internal table to track paragraph execution time         07426013
074270** dmh 2014-12-22 - begin                                         07427013
074280*                                                                 07428013
074290     MOVE  '2420'  TO  PT-CURR-PARA.                              07429013
074300     IF  PS-BLD-INTERNAL-TABLE-YES                                07430013
074310         PERFORM 0200-INTERNAL-TABLE                              07431013
074320     ELSE                                                         07432013
074330         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07433013
074340     END-IF.                                                      07434013
074350                                                                  07435013
074360*                                                                 07436013
074370** DMH 2014-12-22 - END                                           07437013
074380*                                                                 07438013
074390                                                                  07439013
074400     MOVE ZEROES  TO PV-DB2-PKSLIP-COUNT.                         07440013
074410                                                                  07441013
074420     EXEC SQL                                                     07442013
074430         SELECT COUNT(*)                                          07443013
074440         INTO   :PV-DB2-PKSLIP-COUNT                              07444013
074450         FROM   TPKSLIP A                                         07445013
074460             ,  TINPKSU B                                         07446013
074470         WHERE B.SHIPT_UNT_ID  = :DK-CTN                          07447013
074480           AND A.PO_NBR        = :DK-PO                           07448013
074490           AND A.SEQ_NBR       = B.SEQ_NBR                        07449013
074500           AND A.VER_STAT_CDE  = 'A'                              07450013
074510         FETCH FIRST 1 ROW ONLY                                   07451013
074520          WITH UR                                                 07452013
074530     END-EXEC.                                                    07453013
074540                                                                  07454013
074550         EVALUATE TRUE                                            07455013
074560             WHEN SQLCODE = ZERO                                  07456013
074570             WHEN SQLCODE = +100                                  07457013
074580                  CONTINUE                                        07458013
074590             WHEN SQLWARN0 NOT = SPACES                           07459013
074600             WHEN SQLCODE < ZERO                                  07460013
074610             WHEN SQLCODE > ZERO                                  07461013
074620                                                                  07462013
074630              INITIALIZE PV-CICS-MSG-AREA1                        07463013
074640              INITIALIZE PV-CICS-MSG-AREA2                        07464013
074650                                                                  07465013
074660              MOVE SQLCODE              TO PV-DISP-SQLCODE        07466013
074670              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07467013
074680              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07468013
074690              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07469013
074700                                                                  07470013
074710              STRING  'SUKCS782 2420-'                            07471099
074720                      ' DC:'               PV-DISP-DC             07472013
074730                      ' B1:'               SU054-BAR-CODE-1       07473013
074740                      ' B2:'               SU054-BAR-CODE-2       07474013
074750                      ' B3:'               SU054-BAR-CODE-3       07475013
074760                                           DELIMITED BY SIZE      07476013
074770                                      INTO PV-CICS-MSG-AREA1      07477013
074780                                                                  07478013
074790              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07479013
074800              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07480013
074810                                                                  07481013
074820              PERFORM 9999-WRITE-TO-CSSL                          07482013
074830                                                                  07483013
074840              STRING  'SUKCS782 '          SU054-KOHLS-SML        07484099
074850                      ' TRIP:'             PV-DISP-TRIP           07485013
074860                      ' DR:'               SU054-DOOR-NUMBER      07486013
074870                      ' USR:'              SU054-USER-ID          07487013
074880                      ' STA:'              PV-DISP-PNA-STA        07488013
074890                      ' SQL:'              PV-DISP-SQLCODE        07489013
074900                      ' TPKSLIP/TINPKSU'                          07490013
074910                                           DELIMITED BY SIZE      07491013
074920                                      INTO PV-CICS-MSG-AREA2      07492013
074930                                                                  07493013
074940              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07494013
074950              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07495013
074960                                                                  07496013
074970              PERFORM 9999-WRITE-TO-CSSL                          07497013
074980                                                                  07498013
074990              INITIALIZE PV-CICS-MSG-AREA3                        07499013
075000              MOVE DK-PO             TO PV-DISP-PO                07500013
075010              MOVE DK-CTN            TO PV-DISP-SSCC              07501013
075020                                                                  07502013
075030              STRING  'SUKCS782 '                                 07503099
075040                      '-'                  PV-DISP-PO             07504013
075050                      '-'                  PV-DISP-SSCC           07505013
075060                      '-'                  DELIMITED BY SIZE      07506013
075070                                      INTO PV-CICS-MSG-AREA3      07507013
075080                                                                  07508013
075090              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07509013
075100              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07510013
075110                                                                  07511013
075120              PERFORM 9999-WRITE-TO-CSSL                          07512013
075130                                                                  07513013
075140                 SET PS-PROCESSING-ERROR-YES TO TRUE              07514013
075150                 PERFORM 9998-WRITE-TO-CSSL                       07515013
075160         END-EVALUATE.                                            07516013
075170                                                                  07517013
075180                                                                  07518013
075190*----------------------------------------------------------------*07519013
075200*  CHECK IF THE CARTON HAS ANY LINES THAT HAVE BEEN VERIFIED     *07520013
075210*                                                                *07521013
075220*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *07522013
075230*                     Added "FETCH FIRST 1 ROW" the program is   *07523013
075240*                     just checking existence of                 *07524013
075250*----------------------------------------------------------------*07525013
075260 2425-CHECK-VERIFIED-LINES.                                       07526013
075270*                                                                 07527013
075280** added internal table to track paragraph execution time         07528013
075290** dmh 2014-12-22 - begin                                         07529013
075300*                                                                 07530013
075310     MOVE  '2425'  TO  PT-CURR-PARA.                              07531013
075320     IF  PS-BLD-INTERNAL-TABLE-YES                                07532013
075330         PERFORM 0200-INTERNAL-TABLE                              07533013
075340     ELSE                                                         07534013
075350         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07535013
075360     END-IF.                                                      07536013
075370                                                                  07537013
075380*                                                                 07538013
075390** DMH 2014-12-22 - END                                           07539013
075400*                                                                 07540013
075410                                                                  07541013
075420     SET  PS-RECITM-VERIFIED-LINES-NO  TO TRUE.                   07542013
075430     MOVE ZEROES               TO PV-VERIF-RECITM-COUNT.          07543013
075440     MOVE PV-RCVR-SEQ-NBR      TO RECITM-REC-SEQ-NBR.             07544013
075450     MOVE PV-CTN-N             TO DK-CTN.                         07545013
075460                                                                  07546013
075470     EXEC SQL                                                     07547013
075480         SELECT COUNT(*)                                          07548013
075490         INTO   :PV-VERIF-RECITM-COUNT                            07549013
075500          FROM  TSHUUPC A                                         07550013
075510              , TRECITM B                                         07551013
075520          WHERE  A.SHIPT_UNT_ID    = :DK-CTN                      07552013
075530          AND    A.TRN_NBR     =  B.ORD_NBR                       07553013
075540          AND    A.TRN_LNE_NBR =  B.ORD_LNE_NBR                   07554013
075550          AND    B.REC_SEQ_NBR =  :RECITM-REC-SEQ-NBR             07555013
075560          AND    B.STATUS_CDE  =  'VE'                            07556013
075570          AND    B.VER_STATUS_CDE = 'A'                           07557013
075580        FETCH FIRST 1 ROW ONLY                                    07558013
075590         WITH UR                                                  07559013
075600     END-EXEC.                                                    07560013
075610                                                                  07561013
075620     EVALUATE TRUE                                                07562013
075630         WHEN SQLCODE = ZERO                                      07563013
075640         WHEN SQLCODE = +100                                      07564013
075650              IF PV-VERIF-RECITM-COUNT > 0                        07565013
075660                 SET PS-RECITM-VERIFIED-LINES-YES                 07566013
075670                     PS-ACTIVE-XREF-ROW-NOT-FOUND TO TRUE         07567013
075680                 PERFORM 3690-CHECK-SULBXF-FOR-ACTIVE             07568013
075690                 IF PS-ACTIVE-XREF-ROW-FOUND                      07569013
075700                    SET PS-RECITM-VERIFIED-LINES-NO TO TRUE       07570013
075710                 END-IF                                           07571013
075720              END-IF                                              07572013
075730         WHEN SQLWARN0 NOT = SPACES                               07573013
075740         WHEN SQLCODE NOT EQUAL ZERO                              07574013
075750                                                                  07575013
075760              INITIALIZE PV-CICS-MSG-AREA1                        07576013
075770              INITIALIZE PV-CICS-MSG-AREA2                        07577013
075780                                                                  07578013
075790              MOVE SQLCODE              TO PV-DISP-SQLCODE        07579013
075800              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07580013
075810              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07581013
075820              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07582013
075830                                                                  07583013
075840              STRING  'SUKCS782 2425-'                            07584099
075850                      ' DC:'               PV-DISP-DC             07585013
075860                      ' B1:'               SU054-BAR-CODE-1       07586013
075870                      ' B2:'               SU054-BAR-CODE-2       07587013
075880                      ' B3:'               SU054-BAR-CODE-3       07588013
075890                                           DELIMITED BY SIZE      07589013
075900                                      INTO PV-CICS-MSG-AREA1      07590013
075910                                                                  07591013
075920              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07592013
075930              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07593013
075940                                                                  07594013
075950              PERFORM 9999-WRITE-TO-CSSL                          07595013
075960                                                                  07596013
075970              STRING  'SUKCS782 '          SU054-KOHLS-SML        07597099
075980                      ' TRIP:'             PV-DISP-TRIP           07598013
075990                      ' DR:'               SU054-DOOR-NUMBER      07599013
076000                      ' USR:'              SU054-USER-ID          07600013
076010                      ' STA:'              PV-DISP-PNA-STA        07601013
076020                      ' SQL:'              PV-DISP-SQLCODE        07602013
076030                      ' TSHUUPC/TRECITM'                          07603013
076040                                           DELIMITED BY SIZE      07604013
076050                                      INTO PV-CICS-MSG-AREA2      07605013
076060                                                                  07606013
076070              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07607013
076080              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07608013
076090                                                                  07609013
076100              PERFORM 9999-WRITE-TO-CSSL                          07610013
076110                                                                  07611013
076120              INITIALIZE PV-CICS-MSG-AREA3                        07612013
076130              MOVE PV-PO-NBR           TO PV-DISPLAY-PO           07613013
076140              MOVE RECITM-REC-SEQ-NBR  tO PV-DISP-rcvr            07614013
076150              MOVE DK-CTN              TO PV-DISP-SSCC            07615013
076160                                                                  07616013
076170              STRING  'SUKCS782 '                                 07617099
076180                      '-'                  PV-DISP-PO             07618013
076190                      '-'                  PV-DISP-RCVR           07619013
076200                      '-'                  PV-DISP-SSCC           07620013
076210                      '-'                  DELIMITED BY SIZE      07621013
076220                                      INTO PV-CICS-MSG-AREA3      07622013
076230                                                                  07623013
076240              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07624013
076250              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07625013
076260                                                                  07626013
076270              PERFORM 9999-WRITE-TO-CSSL                          07627013
076280                                                                  07628013
076290             SET PS-PROCESSING-ERROR-YES TO TRUE                  07629013
076300             PERFORM 9998-WRITE-TO-CSSL                           07630013
076310     END-EVALUATE.                                                07631013
076320                                                                  07632013
076330                                                                  07633013
076340 2450-OPEN-UNITS-CSR.                                             07634013
076350*                                                                 07635013
076360** added internal table to track paragraph execution time         07636013
076370** dmh 2014-12-22 - begin                                         07637013
076380*                                                                 07638013
076390     MOVE  '2450'  TO  PT-CURR-PARA.                              07639013
076400     IF  PS-BLD-INTERNAL-TABLE-YES                                07640013
076410         PERFORM 0200-INTERNAL-TABLE                              07641013
076420     ELSE                                                         07642013
076430         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07643013
076440     END-IF.                                                      07644013
076450                                                                  07645013
076460*                                                                 07646013
076470** DMH 2014-12-22 - END                                           07647013
076480*                                                                 07648013
076490                                                                  07649013
076500     MOVE  PV-CTN-N TO DK-CTN.                                    07650013
076510                                                                  07651013
076520     EXEC SQL                                                     07652013
076530          OPEN UNITS-CSR                                          07653013
076540     END-EXEC                                                     07654013
076550                                                                  07655013
076560                                                                  07656013
076570     EVALUATE TRUE                                                07657013
076580         WHEN SQLCODE = ZERO                                      07658013
076590             CONTINUE                                             07659013
076600         WHEN SQLWARN0 NOT = SPACES                               07660013
076610         WHEN SQLCODE < ZERO                                      07661013
076620         WHEN SQLCODE > ZERO                                      07662013
076630                                                                  07663013
076640              INITIALIZE PV-CICS-MSG-AREA1                        07664013
076650              INITIALIZE PV-CICS-MSG-AREA2                        07665013
076660                                                                  07666013
076670              MOVE SQLCODE              TO PV-DISP-SQLCODE        07667013
076680              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07668013
076690              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07669013
076700              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07670013
076710                                                                  07671013
076720              STRING  'SUKCS782 2450-'                            07672099
076730                      ' DC:'               PV-DISP-DC             07673013
076740                      ' B1:'               SU054-BAR-CODE-1       07674013
076750                      ' B2:'               SU054-BAR-CODE-2       07675013
076760                      ' B3:'               SU054-BAR-CODE-3       07676013
076770                                           DELIMITED BY SIZE      07677013
076780                                      INTO PV-CICS-MSG-AREA1      07678013
076790                                                                  07679013
076800              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07680013
076810              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07681013
076820                                                                  07682013
076830              PERFORM 9999-WRITE-TO-CSSL                          07683013
076840                                                                  07684013
076850              STRING  'SUKCS782 '          SU054-KOHLS-SML        07685099
076860                      ' TRIP:'             PV-DISP-TRIP           07686013
076870                      ' DR:'               SU054-DOOR-NUMBER      07687013
076880                      ' USR:'              SU054-USER-ID          07688013
076890                      ' STA:'              PV-DISP-PNA-STA        07689013
076900                      ' SQL:'              PV-DISP-SQLCODE        07690013
076910                      ' TSHUUPC/TDISTHD'                          07691013
076920                                           DELIMITED BY SIZE      07692013
076930                                      INTO PV-CICS-MSG-AREA2      07693013
076940                                                                  07694013
076950              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07695013
076960              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07696013
076970                                                                  07697013
076980              PERFORM 9999-WRITE-TO-CSSL                          07698013
076990                                                                  07699013
077000              INITIALIZE PV-CICS-MSG-AREA3                        07700013
077010              MOVE PV-PO-NBR           TO PV-DISPLAY-PO           07701013
077020              MOVE PV-RCVR-SEQ-NBR     tO PV-DISP-rcvr            07702013
077030              MOVE DK-CTN              TO PV-DISP-SSCC            07703013
077040                                                                  07704013
077050              STRING  'SUKCS782 '                                 07705099
077060                      ' OPEN UNITS-CSR'                           07706013
077070                      '-'                  PV-DISP-PO             07707013
077080                      '-'                  PV-DISP-RCVR           07708013
077090                      '-'                  PV-DISP-SSCC           07709013
077100                      '-'                  DELIMITED BY SIZE      07710013
077110                                      INTO PV-CICS-MSG-AREA3      07711013
077120                                                                  07712013
077130              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07713013
077140              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07714013
077150                                                                  07715013
077160              PERFORM 9999-WRITE-TO-CSSL                          07716013
077170                                                                  07717013
077180             SET PS-PROCESSING-ERROR-YES TO TRUE                  07718013
077190             PERFORM 9998-WRITE-TO-CSSL                           07719013
077200     END-EVALUATE.                                                07720013
077210                                                                  07721013
077220 EJECT                                                            07722013
077230*----------------------------------------------------------------*07723013
077240*                                                                *07724013
077250*----------------------------------------------------------------*07725013
077260 2460-FETCH-LINE-AND-UNITS.                                       07726013
077270*                                                                 07727013
077280** added internal table to track paragraph execution time         07728013
077290** dmh 2014-12-22 - begin                                         07729013
077300*                                                                 07730013
077310     MOVE  '2460'  TO  PT-CURR-PARA.                              07731013
077320     IF  PS-BLD-INTERNAL-TABLE-YES                                07732013
077330         PERFORM 0200-INTERNAL-TABLE                              07733013
077340     ELSE                                                         07734013
077350         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07735013
077360     END-IF.                                                      07736013
077370                                                                  07737013
077380*                                                                 07738013
077390** DMH 2014-12-22 - END                                           07739013
077400*                                                                 07740013
077410                                                                  07741013
077420     EXEC SQL                                                     07742013
077430        FETCH   UNITS-CSR                                         07743013
077440        INTO   :SHUUPC-SHPD-QTY                                   07744013
077450             , :PV-TRN-LNE-NBR                                    07745013
077460             , :DISTHD-UCC128-DAT-USG-CDE                         07746013
077470             , :DISTHD-PRC-AREA-MODU-ID                           07747013
077480                                                                  07748013
077490     END-EXEC.                                                    07749013
077500                                                                  07750013
077510     EVALUATE TRUE                                                07751013
077520       WHEN SQLCODE = ZEROS                                       07752013
077530            SET PS-FOUND-ON-CURSOR TO TRUE                        07753013
077540            PERFORM  7230-GET-DEPT-CL-SKU                         07754013
077550            ADD  SHUUPC-SHPD-QTY     TO  PV-SHPD-QTY-TOTAL        07755013
077560            IF PS-FIRST-PO-LINE-FOR-CTN                           07756013
077570               ADD +1 TO PV-MULTI-LINE-COUNT                      07757013
077580               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         07758013
077590               SET  PS-NOT-FIRST-PO-LINE-FOR-CTN TO TRUE          07759013
077600            END-IF                                                07760013
077610            IF PV-TRN-LNE-NBR = PV-HOLD-TRN-LNE-NBR               07761013
077620               CONTINUE                                           07762013
077630            ELSE                                                  07763013
077640               ADD +1 TO PV-MULTI-LINE-COUNT                      07764013
077650               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         07765013
077660            END-IF                                                07766013
077670       WHEN SQLCODE = +100                                        07767013
077680            EVALUATE TRUE                                         07768013
077690               WHEN PV-MULTI-LINE-COUNT = 0                       07769013
077700                 SET PS-NO-LINE              TO  TRUE             07770013
077710               WHEN PV-MULTI-LINE-COUNT > 1                       07771013
077720                 SET  PS-MULTI-LINE          TO  TRUE             07772013
077730               WHEN OTHER                                         07773013
077740                 CONTINUE                                         07774013
077750            END-EVALUATE                                          07775013
077760            SET  PS-EO-UNITS-CSR   TO TRUE                        07776013
077770            MOVE PV-SHPD-QTY-TOTAL TO                             07777013
077780                                      PV-OUTR-PACK-QTY            07778013
077790                                      DK-OUTER-QTY                07779013
077800            MOVE ZEROES            TO PV-SHPD-QTY-TOTAL           07780013
077810       WHEN OTHER                                                 07781013
077820                                                                  07782013
077830              INITIALIZE PV-CICS-MSG-AREA1                        07783013
077840              INITIALIZE PV-CICS-MSG-AREA2                        07784013
077850                                                                  07785013
077860              MOVE SQLCODE              TO PV-DISP-SQLCODE        07786013
077870              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07787013
077880              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07788013
077890              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07789013
077900                                                                  07790013
077910              STRING  'SUKCS782 2460-'                            07791099
077920                      ' DC:'               PV-DISP-DC             07792013
077930                      ' B1:'               SU054-BAR-CODE-1       07793013
077940                      ' B2:'               SU054-BAR-CODE-2       07794013
077950                      ' B3:'               SU054-BAR-CODE-3       07795013
077960                                           DELIMITED BY SIZE      07796013
077970                                      INTO PV-CICS-MSG-AREA1      07797013
077980                                                                  07798013
077990              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07799013
078000              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07800013
078010                                                                  07801013
078020              PERFORM 9999-WRITE-TO-CSSL                          07802013
078030                                                                  07803013
078040              STRING  'SUKCS782 '          SU054-KOHLS-SML        07804099
078050                      ' TRIP:'             PV-DISP-TRIP           07805013
078060                      ' DR:'               SU054-DOOR-NUMBER      07806013
078070                      ' USR:'              SU054-USER-ID          07807013
078080                      ' STA:'              PV-DISP-PNA-STA        07808013
078090                      ' SQL:'              PV-DISP-SQLCODE        07809013
078100                      ' TSHUUPC/TDISTHD'                          07810013
078110                                           DELIMITED BY SIZE      07811013
078120                                      INTO PV-CICS-MSG-AREA2      07812013
078130                                                                  07813013
078140              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07814013
078150              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07815013
078160                                                                  07816013
078170              PERFORM 9999-WRITE-TO-CSSL                          07817013
078180                                                                  07818013
078190              INITIALIZE PV-CICS-MSG-AREA3                        07819013
078200              MOVE PV-PO-NBR           TO PV-DISPLAY-PO           07820013
078210              MOVE PV-RCVR-SEQ-NBR     tO PV-DISP-rcvr            07821013
078220              MOVE DK-CTN              TO PV-DISP-SSCC            07822013
078230                                                                  07823013
078240              STRING  'SUKCS782 '                                 07824099
078250                      ' FETCH UNITS-CSR'                          07825013
078260                      '-'                  PV-DISP-PO             07826013
078270                      '-'                  PV-DISP-RCVR           07827013
078280                      '-'                  PV-DISP-SSCC           07828013
078290                      '-'                  DELIMITED BY SIZE      07829013
078300                                      INTO PV-CICS-MSG-AREA3      07830013
078310                                                                  07831013
078320              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07832013
078330              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07833013
078340                                                                  07834013
078350              PERFORM 9999-WRITE-TO-CSSL                          07835013
078360                                                                  07836013
078370             SET PS-PROCESSING-ERROR-YES TO TRUE                  07837013
078380             PERFORM 9998-WRITE-TO-CSSL                           07838013
078390     END-EVALUATE.                                                07839013
078400                                                                  07840013
078410                                                                  07841013
078420 2470-CLOSE-UNITS-CSR.                                            07842013
078430*                                                                 07843013
078440** added internal table to track paragraph execution time         07844013
078450** dmh 2014-12-22 - begin                                         07845013
078460*                                                                 07846013
078470     MOVE  '2470'  TO  PT-CURR-PARA.                              07847013
078480     IF  PS-BLD-INTERNAL-TABLE-YES                                07848013
078490         PERFORM 0200-INTERNAL-TABLE                              07849013
078500     ELSE                                                         07850013
078510         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07851013
078520     END-IF.                                                      07852013
078530                                                                  07853013
078540*                                                                 07854013
078550** DMH 2014-12-22 - END                                           07855013
078560*                                                                 07856013
078570                                                                  07857013
078580     EXEC SQL                                                     07858013
078590         CLOSE UNITS-CSR                                          07859013
078600     END-EXEC                                                     07860013
078610                                                                  07861013
078620                                                                  07862013
078630     EVALUATE TRUE                                                07863013
078640         WHEN SQLCODE = ZERO                                      07864013
078650             CONTINUE                                             07865013
078660         WHEN SQLWARN0 NOT = SPACES                               07866013
078670         WHEN SQLCODE < ZERO                                      07867013
078680         WHEN SQLCODE > ZERO                                      07868013
078690                                                                  07869013
078700              INITIALIZE PV-CICS-MSG-AREA1                        07870013
078710              INITIALIZE PV-CICS-MSG-AREA2                        07871013
078720                                                                  07872013
078730              MOVE SQLCODE              TO PV-DISP-SQLCODE        07873013
078740              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07874013
078750              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07875013
078760              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07876013
078770                                                                  07877013
078780              STRING  'SUKCS782 2470-'                            07878099
078790                      ' DC:'               PV-DISP-DC             07879013
078800                      ' B1:'               SU054-BAR-CODE-1       07880013
078810                      ' B2:'               SU054-BAR-CODE-2       07881013
078820                      ' B3:'               SU054-BAR-CODE-3       07882013
078830                                           DELIMITED BY SIZE      07883013
078840                                      INTO PV-CICS-MSG-AREA1      07884013
078850                                                                  07885013
078860              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07886013
078870              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07887013
078880                                                                  07888013
078890              PERFORM 9999-WRITE-TO-CSSL                          07889013
078900                                                                  07890013
078910              STRING  'SUKCS782 '          SU054-KOHLS-SML        07891099
078920                      ' TRIP:'             PV-DISP-TRIP           07892013
078930                      ' DR:'               SU054-DOOR-NUMBER      07893013
078940                      ' USR:'              SU054-USER-ID          07894013
078950                      ' STA:'              PV-DISP-PNA-STA        07895013
078960                      ' SQL:'              PV-DISP-SQLCODE        07896013
078970                      ' TSHUUPC/TDISTHD'                          07897013
078980                                           DELIMITED BY SIZE      07898013
078990                                      INTO PV-CICS-MSG-AREA2      07899013
079000                                                                  07900013
079010              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07901013
079020              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07902013
079030                                                                  07903013
079040              PERFORM 9999-WRITE-TO-CSSL                          07904013
079050                                                                  07905013
079060              INITIALIZE PV-CICS-MSG-AREA3                        07906013
079070              MOVE PV-PO-NBR           TO PV-DISPLAY-PO           07907013
079080              MOVE PV-RCVR-SEQ-NBR     tO PV-DISP-rcvr            07908013
079090              MOVE DK-CTN              TO PV-DISP-SSCC            07909013
079100                                                                  07910013
079110              STRING  'SUKCS782 '                                 07911099
079120                      ' close UNITS-CSR'                          07912013
079130                      '-'                  PV-DISP-PO             07913013
079140                      '-'                  PV-DISP-RCVR           07914013
079150                      '-'                  PV-DISP-SSCC           07915013
079160                      '-'                  DELIMITED BY SIZE      07916013
079170                                      INTO PV-CICS-MSG-AREA3      07917013
079180                                                                  07918013
079190              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07919013
079200              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07920013
079210                                                                  07921013
079220              PERFORM 9999-WRITE-TO-CSSL                          07922013
079230                                                                  07923013
079240             SET PS-PROCESSING-ERROR-YES TO TRUE                  07924013
079250             PERFORM 9998-WRITE-TO-CSSL                           07925013
079260     END-EVALUATE.                                                07926013
079270                                                                  07927013
079280                                                                  07928013
079281* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07928173
079282* fOR mAINFRAME MODERNIZATION - CHECK IF SELECTED FOR tHIN SLICE* 07928273
079283* DMH - 5/16/23 BEGIN                                           * 07928373
079284*                                                               * 07928473
079285* cHECK IF dc IS PART OF THE tHIN SLICE TEST - TKRPRPM: THNSLC  * 07928573
079286* CHECK IF PNA/RF DOOR IS FOR THIN SLICE:  wst PARM:  THNSLCCKIN* 07928673
079287* if Yes to both checks - call thin slice module :  SUKCS700    * 07928773
079288* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07928873
079289 2500-THIN-SLICE-CHECK.                                           07928973
079290                                                                  07929073
079291     MOVE  '2500'  TO  PT-CURR-PARA.                              07929173
079292     IF  PS-BLD-INTERNAL-TABLE-YES                                07929273
079293         PERFORM 0200-INTERNAL-TABLE                              07929373
079294     ELSE                                                         07929473
079295         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07929573
079296     END-IF.                                                      07929673
079297                                                                  07929773
079299     SET  PS-DC-THIN-SLICE-NO                                     07929973
079300          PS-DC-PNA-RF-DOOR-NO                                    07930073
079301          PS-SELECT-FOR-THIN-SLICE-NO  TO  TRUE.                  07930173
079302                                                                  07930273
079303     PERFORM 2510-CHECK-DC-THNSLC.                                07930373
079304     IF  PS-DC-THIN-SLICE                                         07930473
079305         PERFORM 2520-CHECK-DOOR-THNSLCCKN                        07930573
079306     END-IF.                                                      07930673
079307                                                                  07930773
079308     IF  PS-DC-THIN-SLICE  AND                                    07930874
079309         PS-DC-PNA-RF-DOOR                                        07930974
079310         PERFORM 2530-CALL-SUKCS700                               07931074
079311     END-IF.                                                      07931178
079312                                                                  07931274
079320                                                                  07932073
079321 2510-CHECK-DC-THNSLC.                                            07932173
079322                                                                  07932273
079323     MOVE  '2510'  TO  PT-CURR-PARA.                              07932373
079324     IF  PS-BLD-INTERNAL-TABLE-YES                                07932473
079325         PERFORM 0200-INTERNAL-TABLE                              07932573
079326     ELSE                                                         07932673
079327         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07932773
079328     END-IF.                                                      07932873
079329                                                                  07932973
079330     MOVE SU054-DC-NUMBER  TO  DK-THIN-DC-NBR.                    07933074
079331                                                                  07933173
079332     EXEC SQL                                                     07933273
079333          SELECT FUNC_TXT                                         07933373
079334          INTO  :PS-DC-THIN-SLICE-SW                              07933473
079335          FROM   TKRPRPM                                          07933573
079336          WHERE  SYS_PRC_FUNC_CDE  = 'THNSLC'                     07933673
079337            AND  INTFC_SYS_CDE     = 'KHL'                        07933783
079338            AND  FUNC_PRC_STAT_CDE = 'AC'                         07933873
079340            AND  LOC_ID            =  :DK-THIN-DC-NBR             07934099
079341           WITH UR                                                07934199
079342     END-EXEC.                                                    07934299
079343                                                                  07934399
079344                                                                  07934499
079345     EVALUATE TRUE                                                07934599
079346         WHEN SQLCODE = ZERO                                      07934699
079347              CONTINUE                                            07934799
079348                                                                  07934899
079349         WHEN SQLCODE = +100                                      07934999
079350             SET PS-DC-THIN-SLICE-NO        TO TRUE               07935099
079351                                                                  07935199
079352         WHEN SQLWARN0 NOT = SPACES                               07935299
079353         WHEN SQLCODE < ZERO                                      07935399
079354         WHEN SQLCODE > ZERO                                      07935499
079355                                                                  07935599
079356              INITIALIZE PV-CICS-MSG-AREA1                        07935699
079357              INITIALIZE PV-CICS-MSG-AREA2                        07935799
079358                                                                  07935899
079359              MOVE SQLCODE              TO PV-DISP-SQLCODE        07935999
079360              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07936099
079361              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07936199
079362              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07936299
079363                                                                  07936399
079364              STRING  'SUKCS782 2510-'                            07936499
079365                      ' DC:'               PV-DISP-DC             07936599
079366                      ' B1:'               SU054-BAR-CODE-1       07936699
079367                      ' B2:'               SU054-BAR-CODE-2       07936799
079368                      ' B3:'               SU054-BAR-CODE-3       07936899
079369                                           DELIMITED BY SIZE      07936999
079370                                      INTO PV-CICS-MSG-AREA1      07937099
079371                                                                  07937199
079372              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07937299
079373              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07937399
079374                                                                  07937499
079375              PERFORM 9999-WRITE-TO-CSSL                          07937599
079376                                                                  07937699
079377              STRING  'SUKCS782 '          SU054-KOHLS-SML        07937799
079378                      ' TRIP:'             PV-DISP-TRIP           07937899
079379                      ' DR:'               SU054-DOOR-NUMBER      07937999
079380                      ' USR:'              SU054-USER-ID          07938099
079381                      ' STA:'              PV-DISP-PNA-STA        07938199
079382                      ' SQL:'              PV-DISP-SQLCODE        07938299
079383                      ' TKRPRPM'                                  07938399
079384                                           DELIMITED BY SIZE      07938499
079385                                      INTO PV-CICS-MSG-AREA2      07938599
079386                                                                  07938699
079387              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07938799
079388              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07938899
079389                                                                  07938999
079390              PERFORM 9999-WRITE-TO-CSSL                          07939099
079391                                                                  07939199
079392              INITIALIZE PV-CICS-MSG-AREA3                        07939299
079393              MOVE DK-THIN-OPER-UNT-ID     TO PV-DISP-OPER        07939399
079394                                                                  07939499
079395              STRING  'SUKCS782 '                                 07939599
079396                      ' OPER:'             PV-DISP-OPER           07939699
079397                      ' PARM:THNSLC'                              07939799
079398                                           DELIMITED BY SIZE      07939899
079399                                      INTO PV-CICS-MSG-AREA3      07939999
079400                                                                  07940099
079401              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07940199
079402              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07940299
079403                                                                  07940399
079404              PERFORM 9999-WRITE-TO-CSSL                          07940499
079405                                                                  07940599
079406             SET PS-PROCESSING-ERROR-YES TO TRUE                  07940699
079407             PERFORM 9998-WRITE-TO-CSSL                           07940799
079408                                                                  07940899
079409     END-EVALUATE.                                                07940999
079410                                                                  07941099
079411                                                                  07941199
079412 2520-CHECK-DOOR-THNSLCCKN.                                       07941299
079413                                                                  07941399
079414     MOVE  '2520'  TO  PT-CURR-PARA.                              07941499
079415     IF  PS-BLD-INTERNAL-TABLE-YES                                07941599
079416         PERFORM 0200-INTERNAL-TABLE                              07941699
079417     ELSE                                                         07941799
079418         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07941899
079419     END-IF.                                                      07941999
079420                                                                  07942099
079421     MOVE SU054-DC-NUMBER       TO  DK-THIN-OPER-UNT-ID.          07942199
079422     MOVE SU054-ACCM-LINE-NMBR  TO  DK-THIN-PNA-STA.              07942299
079423     MOVE SU054-DOOR-NUMBER     TO  DK-THIN-RCVG-DOOR.            07942399
079424                                                                  07942499
079425         EXEC SQL                                                 07942599
079426            SELECT  F.ATTR_ELEM_TXT                               07942699
079427              INTO :PS-DC-PNA-RF-DOOR-SW                          07942799
079428              FROM                                                07942899
079429                    WST_INTGRTN_TYP  A                            07942999
079430                 ,  WST_ATTR_DEFN    B                            07943099
079431                 ,  WST_ATTR_ELEM    C                            07943199
079432                 ,  WST_ATTR_ELEM    D                            07943299
079433                 ,  WST_ATTR_ELEM    E                            07943399
079434                 ,  WST_ATTR_ELEM    F                            07943499
079435                 ,  WST_ATTR_ELEM    G                            07943599
079436                 ,  WST_ATTR_ELEM    H                            07943699
079437                 ,  WST_ATTR_ELEM    I                            07943799
079438                 ,  WST_ATTR_ELEM    J                            07943899
079439                 ,  WST_ATTR_ELEM    K                            07943999
079440              WHERE                                               07944099
079441                    A.INTGRTN_TYP_CDE   = 'THNSLCCKIN'            07944199
079442                AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE       07944299
079443                AND B.ATTR_DEFN_SEQ_NBR = 1                       07944399
079444                AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE       07944499
079445                AND C.ATTR_DEFN_SEQ_NBR = 1                       07944599
079446                AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE       07944699
079447                AND D.ATTR_DEFN_SEQ_NBR = 2                       07944799
079448                AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE       07944899
079449                AND E.ATTR_DEFN_SEQ_NBR = 3                       07944999
079450                AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE       07945099
079451                AND F.ATTR_DEFN_SEQ_NBR = 4                       07945199
079452                AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE       07945299
079453                AND G.ATTR_DEFN_SEQ_NBR = 5                       07945399
079454                AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE       07945499
079455                AND H.ATTR_DEFN_SEQ_NBR = 6                       07945599
079456                AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE       07945699
079457                AND I.ATTR_DEFN_SEQ_NBR = 7                       07945799
079458                AND B.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE       07945899
079459                AND J.ATTR_DEFN_SEQ_NBR = 8                       07945999
079460                AND B.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE       07946099
079461                AND K.ATTR_DEFN_SEQ_NBR = 9                       07946199
079462                AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR     07946299
079463                AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR     07946399
079464                AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR     07946499
079465                AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR     07946599
079466                AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR     07946699
079467                AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR     07946799
079468                AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR     07946899
079469                AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR     07946999
079470                                                                  07947099
079471                AND C.ATTR_ELEM_NBR     = :DK-THIN-OPER-UNT-ID    07947199
079472                AND D.ATTR_ELEM_NBR     = :DK-THIN-PNA-STA        07947299
079473                AND E.ATTR_ELEM_TXT     = :DK-THIN-RCVG-DOOR      07947399
079474                AND F.ATTR_ELEM_TXT     = 'Y'                     07947499
079475                AND G.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP       07947599
079476                AND H.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP       07947699
079477            FETCH FIRST 1 ROW ONLY                                07947799
079478             WITH UR                                              07947899
079479         END-EXEC.                                                07947999
079480                                                                  07948099
079481***  C.ATTR_ELEM_NBR  = DC NUMBER                                 07948199
079482***  D.ATTR_ELEM_NBR  = PNA STATION                               07948299
079483***  E.ATTR_ELEM_TXT  = RECEIVING DOOR NUMBER                     07948399
079484                                                                  07948499
079485                                                                  07948599
079486         EVALUATE TRUE                                            07948699
079487             WHEN SQLCODE = +0                                    07948799
079488                  SET  PS-DC-PNA-RF-DOOR     TO  TRUE             07948899
079489             WHEN SQLCODE = +100                                  07948999
079490                  SET  PS-DC-PNA-RF-DOOR-NO  TO  TRUE             07949099
079491                                                                  07949199
079492                                                                  07949299
079493             WHEN SQLCODE = -904                                  07949399
079494             WHEN SQLCODE = -913                                  07949499
079495                  SET  PS-DC-PNA-RF-DOOR-NO  TO  TRUE             07949599
079496                                                                  07949699
079497              INITIALIZE PV-CICS-MSG-AREA1                        07949799
079498              INITIALIZE PV-CICS-MSG-AREA2                        07949899
079499                                                                  07949999
079500              MOVE SQLCODE              TO PV-DISP-SQLCODE        07950099
079501              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07950199
079502              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07950299
079503              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07950399
079504                                                                  07950499
079505              STRING  ' SUKCS782 2520-'                           07950599
079506                      ' DC:'               PV-DISP-DC             07950699
079507                      ' B1:'               SU054-BAR-CODE-1       07950799
079508                      ' B2:'               SU054-BAR-CODE-2       07950899
079509                      ' B3:'               SU054-BAR-CODE-3       07950999
079510                                           DELIMITED BY SIZE      07951099
079511                                      INTO PV-CICS-MSG-AREA1      07951199
079512                                                                  07951299
079513              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07951399
079514              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07951499
079515                                                                  07951599
079516              PERFORM 9999-WRITE-TO-CSSL                          07951699
079517                                                                  07951799
079518              STRING  ' SUKCS782 '          SU054-KOHLS-SML       07951899
079519                      ' TRIP:'             PV-DISP-TRIP           07951999
079520                      ' DR:'               SU054-DOOR-NUMBER      07952099
079521                      ' USR:'              SU054-USER-ID          07952199
079522                      ' STA:'              PV-DISP-PNA-STA        07952299
079523                      ' SQL:'              PV-DISP-SQLCODE        07952399
079524                      ' WST_INTGRTN_TYP/WST_ATTR_DEFN/ELEM'       07952499
079525                                           DELIMITED BY SIZE      07952599
079526                                      INTO PV-CICS-MSG-AREA2      07952699
079527                                                                  07952799
079528              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07952899
079529              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07952999
079530                                                                  07953099
079531              PERFORM 9999-WRITE-TO-CSSL                          07953199
079532                                                                  07953299
079533              INITIALIZE PV-CICS-MSG-AREA3                        07953399
079534              MOVE PV-OPER-UNT-ID       TO  PV-DISP-OPER          07953499
079535              MOVE PV-CURR-OPER-UNT-ID  TO  PV-DISP-CURR-OPER     07953599
079536                                                                  07953699
079537              STRING  ' SUKCS782 '                                07953799
079538                      ' PARM: THNSLCCKIN'                         07953899
079539                      ' OPER:'             PV-DISP-OPER           07953999
079540                      ' CURR:'             PV-DISP-CURR-OPER      07954099
079541                                           DELIMITED BY SIZE      07954199
079542                                      INTO PV-CICS-MSG-AREA3      07954299
079543                                                                  07954399
079544              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07954499
079545              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07954599
079546                                                                  07954699
079547              PERFORM 9999-WRITE-TO-CSSL                          07954799
079548                                                                  07954899
079549             WHEN SQLWARN0 NOT = SPACES                           07954999
079550             WHEN SQLCODE < +0                                    07955099
079551             WHEN SQLCODE > +0                                    07955199
079552                                                                  07955299
079553              INITIALIZE PV-CICS-MSG-AREA1                        07955399
079554              INITIALIZE PV-CICS-MSG-AREA2                        07955499
079555                                                                  07955599
079556              MOVE SQLCODE              TO PV-DISP-SQLCODE        07955699
079557              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07955799
079558              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07955899
079559              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07955999
079560                                                                  07956099
079561              STRING  'SUKCS782 2520-'                            07956199
079562                      ' DC:'               PV-DISP-DC             07956299
079563                      ' B1:'               SU054-BAR-CODE-1       07956399
079564                      ' B2:'               SU054-BAR-CODE-2       07956499
079565                      ' B3:'               SU054-BAR-CODE-3       07956599
079566                                           DELIMITED BY SIZE      07956699
079567                                      INTO PV-CICS-MSG-AREA1      07956799
079568                                                                  07956899
079569              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07956999
079570              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07957099
079571                                                                  07957199
079572              PERFORM 9999-WRITE-TO-CSSL                          07957299
079573                                                                  07957399
079574              STRING  'SUKCS782 '          SU054-KOHLS-SML        07957499
079575                      ' TRIP:'             PV-DISP-TRIP           07957599
079576                      ' DR:'               SU054-DOOR-NUMBER      07957699
079577                      ' USR:'              SU054-USER-ID          07957799
079578                      ' STA:'              PV-DISP-PNA-STA        07957899
079579                      ' SQL:'              PV-DISP-SQLCODE        07957999
079580                      ' WST_INTGRTN_TYP/WST_ATTR_DEFN/ELEM'       07958099
079581                                           DELIMITED BY SIZE      07958199
079582                                      INTO PV-CICS-MSG-AREA2      07958299
079583                                                                  07958399
079584              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07958499
079585              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07958599
079586                                                                  07958699
079587              PERFORM 9999-WRITE-TO-CSSL                          07958799
079588                                                                  07958899
079589              INITIALIZE PV-CICS-MSG-AREA3                        07958999
079590              MOVE PV-OPER-UNT-ID       TO  PV-DISP-OPER          07959099
079591              MOVE PV-CURR-OPER-UNT-ID  TO  PV-DISP-CURR-OPER     07959199
079592                                                                  07959299
079593              STRING  'SUKCS782 '                                 07959399
079594                      ' PARM: THNSLCCKIN'                         07959499
079595                      ' OPER:'             PV-DISP-OPER           07959599
079596                      ' CURR:'             PV-DISP-CURR-OPER      07959699
079597                                           DELIMITED BY SIZE      07959799
079598                                      INTO PV-CICS-MSG-AREA3      07959899
079599                                                                  07959999
079600              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07960099
079601              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07960199
079602                                                                  07960299
079603              PERFORM 9999-WRITE-TO-CSSL                          07960399
079604                                                                  07960499
079605                SET PS-PROCESSING-ERROR-YES TO TRUE               07960599
079606                PERFORM 9998-WRITE-TO-CSSL                        07960699
079607         END-EVALUATE.                                            07960799
079608                                                                  07960899
079609                                                                  07960999
079610 2530-CALL-SUKCS700.                                              07961099
079611                                                                  07961199
079612     MOVE  '2530'  TO  PT-CURR-PARA.                              07961299
079613     IF  PS-BLD-INTERNAL-TABLE-YES                                07961399
079614         PERFORM 0200-INTERNAL-TABLE                              07961499
079615     ELSE                                                         07961599
079616         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07961699
079617     END-IF.                                                      07961799
079618                                                                  07961899
079619                                                                  07961999
079620     MOVE SU054-DC-NUMBER       TO  SU109-OPER-UNT-ID.            07962099
079621     MOVE SU054-TRIP-ID         TO  SU109-TRIP-ID.                07962199
079622     MOVE SU054-DOOR-NUMBER     TO  SU109-DOOR-NUMBER.            07962299
079623     MOVE SU054-ACCM-LINE-NMBR  TO  SU109-ACM-LBL-STA-NBR.        07962399
079624     MOVE SU054-USER-ID         TO  SU109-USER-ID.                07962499
079625     MOVE SHPUNT-SHIPT-UNT-ID   TO  SU109-BAR-CODE.               07962599
079626     MOVE DK-PO                 TO  SU109-ORD-NBR.                07962699
079627     MOVE PV-RCVR-SEQ-NBR       TO  SU109-REC-SEQ-NBR.            07962799
079628     MOVE RECEIV-PACK-BY-ST-IND TO  SU109-PACK-BY-ST-IND.         07962874
079631     MOVE RECEIV-PKGNG-CDE      TO  SU109-PKGNG-CDE.              07963174
079632     IF  SU109-PBS                                                07963274
079633         MOVE ZEROES            TO  SU109-ORD-LNE-NBR             07963374
079634                                    SU109-PREPK-ID                07963474
079635     ELSE                                                         07963579
079636         IF  SU109-BULK                                           07963674
079637             MOVE SHUUPC-TRN-LNE-NBR  TO  SU109-ORD-LNE-NBR       07963774
079638             MOVE ZEROES              TO  SU109-PREPK-ID          07963874
079639         ELSE                                                     07963979
079640                 MOVE ZEROES             TO SU109-ORD-LNE-NBR     07964074
079641                 MOVE PV-PREPK-ID        TO SU109-PREPK-ID        07964174
079643         END-IF                                                   07964374
079644     END-IF.                                                      07964474
079645*                                                                 07964574
079646     SET  SU109-DC-THIN-SLICE                                     07964674
079647          SU109-DC-PNA-THIN-SLICE      TO  TRUE.                  07964774
079648*                                                                 07964874
079649     SET  SU109-DC-DOOR-THIN-SLICE-NO                             07964974
079651          SU109-THIN-SLICE-SELECTED-NO  TO  TRUE.                 07965182
079652*                                                                 07965274
079654                                                                  07965475
079655     MOVE LENGTH OF SU109-THIN-SLICE-COMM                         07965575
079656       TO PV-COMMAREA-LENGTH.                                     07965675
079657                                                                  07965775
079658     EXEC CICS                                                    07965875
079659         LINK PROGRAM  (PC-THIN-SLICE-MOD)                        07965975
079660              COMMAREA (SU109-THIN-SLICE-COMM)                    07966075
079661              LENGTH   (PV-COMMAREA-LENGTH)                       07966175
079670     END-EXEC.                                                    07967075
079680                                                                  07968075
079690     EVALUATE TRUE                                                07969075
079700         WHEN SU109-SUCCESSFUL                                    07970075
079703              MOVE SU109-THIN-SLICE-SELECTED-SW                   07970382
079704                TO  PS-SELECT-FOR-THIN-SLICE-SW                   07970475
079710                                                                  07971075
079720         WHEN OTHER                                               07972075
079721              SET PV-DONE-PROCESSING          TO TRUE             07972175
079722              MOVE SQLCODE              TO PV-SQLCODE             07972275
079723                                                                  07972375
079724              INITIALIZE PV-CICS-MSG-AREA1                        07972475
079725              INITIALIZE PV-CICS-MSG-AREA2                        07972575
079726                                                                  07972675
079727              MOVE SQLCODE              TO PV-DISP-SQLCODE        07972775
079728              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             07972875
079729              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           07972975
079730              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        07973075
079731                                                                  07973175
079732              STRING  'SUKCS782 2530-'                            07973299
079733                      ' DC:'               PV-DISP-DC             07973375
079734                      ' B1:'               SU054-BAR-CODE-1       07973475
079735                      ' B2:'               SU054-BAR-CODE-2       07973575
079736                      ' B3:'               SU054-BAR-CODE-3       07973675
079737                                           DELIMITED BY SIZE      07973775
079738                                      INTO PV-CICS-MSG-AREA1      07973875
079739                                                                  07973975
079740              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07974075
079741              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     07974175
079742                                                                  07974275
079743              PERFORM 9999-WRITE-TO-CSSL                          07974375
079744                                                                  07974475
079745              STRING  'SUKCS782 '          SU054-KOHLS-SML        07974599
079746                      ' TRIP:'             PV-DISP-TRIP           07974675
079747                      ' DR:'               SU054-DOOR-NUMBER      07974775
079748                      ' USR:'              SU054-USER-ID          07974875
079749                      ' STA:'              PV-DISP-PNA-STA        07974975
079750                      ' SQL:'              PV-DISP-SQLCODE        07975075
079751                      ' 2530-LINK-SUKCS700'                       07975175
079752                                           DELIMITED BY SIZE      07975275
079753                                      INTO PV-CICS-MSG-AREA2      07975375
079754                                                                  07975475
079755              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07975575
079756              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     07975675
079757                                                                  07975775
079758              PERFORM 9999-WRITE-TO-CSSL                          07975875
079759                                                                  07975975
079760              INITIALIZE PV-CICS-MSG-AREA3                        07976075
079761              MOVE LBPTDA-OPER-UNT-ID   TO  PV-DISP-OPER          07976175
079762                                                                  07976275
079763              STRING  'SUKCS782 '                                 07976399
079764                      ' MSG:'   SU044-CRA-RET-MSG                 07976475
079765                      ' PARA:'  SU044-CRA-REQ-ID                  07976575
079766                                           DELIMITED BY SIZE      07976675
079767                                      INTO PV-CICS-MSG-AREA3      07976775
079768                                                                  07976875
079769              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07976975
079770              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     07977075
079771                                                                  07977175
079772              PERFORM 9999-WRITE-TO-CSSL                          07977275
079773                                                                  07977375
079774              INITIALIZE PV-CICS-MSG-AREA4                        07977475
079775                                                                  07977575
079776              MOVE SU054-TRIP-ID TO   PV-DISP-TRIP                07977675
079777              MOVE PV-CTN         TO  PV-DISP-SSCC                07977775
079778              MOVE PV-DEST-STORE  TO  PV-DISP-STR                 07977875
079779                                                                  07977975
079780              STRING  'SUKCS782 '                                 07978099
079781                      ' TRIP:'             PV-DISP-TRIP           07978175
079782                      ' SSCC:'             PV-DISP-SSCC           07978275
079783                      ' STR:'              PV-DISP-STR            07978375
079784                                           DELIMITED BY SIZE      07978475
079785                                      INTO PV-CICS-MSG-AREA4      07978575
079786                                                                  07978675
079787              MOVE SPACES               TO PV-CICS-MSG-AREA-A     07978775
079788              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     07978875
079789                                                                  07978975
079790              PERFORM 9999-WRITE-TO-CSSL                          07979075
079791                                                                  07979175
079792              SET PS-PROCESSING-ERROR-YES TO TRUE                 07979275
079793              PERFORM 9998-WRITE-TO-CSSL                          07979375
079794     END-EVALUATE.                                                07979475
079795                                                                  07979574
079796     IF  PS-LOG-MESSAGE                                           07979697
079797         MOVE SPACES TO  PV-CICS-MSG-AREA-A                       07979797
079798         PERFORM 9999-WRITE-TO-CSSL                               07979897
079800                                                                  07980097
079801         INITIALIZE PV-CICS-MSG-AREA-A                            07980197
079802         STRING ' SUKCS782-2530 - RETURN '                        07980299
079803               ' RET CDE:' SU109-CRA-RET-CDE                      07980397
079804               ' DC THIN:' SU109-DC-THIN-SLICE-SW                 07980497
079805               ' DC PNA:'  SU109-DC-PNA-THIN-SLICE-SW             07980597
079806               ' THIN:'    SU109-THIN-SLICE-SELECTED-SW           07980697
079807                                             DELIMITED BY SIZE    07980797
079808                                        INTO PV-CICS-MSG-AREA-A   07980897
079809         PERFORM 9999-WRITE-TO-CSSL                               07980997
079810                                                                  07981097
079811         MOVE SPACES TO  PV-CICS-MSG-AREA-A                       07981197
079812         PERFORM 9999-WRITE-TO-CSSL                               07981297
079813                                                                  07981397
079814     END-IF.                                                      07981497
079815                                                                  07981597
079816                                                                  07981697
079817* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07981797
079818* DMH - 5/16/23 END - END THIN SLICE CHECK                      * 07981897
079819* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07981997
079820                                                                  07982097
079821                                                                  07982197
079822*----------------------------------------------------------------*07982297
079823*  CHECK IF THE CARTON HAS ANY LINES THAT HAVE BEEN VERIFIED     *07982397
079824*                                                                *07982497
079825*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *07982597
079826*----------------------------------------------------------------*07982697
079827**********************************************************        07982797
079828 3500-GET-VIRTUAL-LABEL-DATA.                                     07982897
079829**********************************************************        07982997
079830*                                                                 07983097
079831** added internal table to track paragraph execution time         07983197
079832** dmh 2014-12-22 - begin                                         07983297
079833*                                                                 07983397
079834     MOVE  '3500'  TO  PT-CURR-PARA.                              07983497
079835     IF  PS-BLD-INTERNAL-TABLE-YES                                07983597
079836         PERFORM 0200-INTERNAL-TABLE                              07983697
079837     ELSE                                                         07983797
079838         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       07983897
079839     END-IF.                                                      07983997
079840                                                                  07984097
079841*                                                                 07984197
079842** DMH 2014-12-22 - END                                           07984297
079843*                                                                 07984397
079844                                                                  07984497
079845     PERFORM                                                      07984597
079846         WITH TEST AFTER                                          07984697
079847         VARYING PV-RETRY-COUNTER                                 07984797
079848         FROM 1 BY 1                                              07984897
079849         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07984997
079850                   OR PS-SUCCESSFUL-UPDATE                        07985097
079851                   OR PS-DONE)                                    07985197
079852                                                                  07985297
079853     EXEC SQL                                                     07985397
079854        SELECT   PREPK_ID                                         07985497
079855                ,LBL_ASG_SEQ_NBR                                  07985597
079856                ,CART_LBL_TYP_CDE                                 07985697
079857                ,PREPK_PRCG_LNE_NBR                               07985797
079858                ,INPK_UNT_QTY                                     07985897
079859                ,PREPK_RATO_QTY                                   07985997
079860                ,PREPK_UNT_QTY                                    07986097
079861                ,DEST_OPER_UNT_ID                                 07986197
079862                ,CSE_PK_QTY                                       07986297
079863                ,ODD_CART_IND                                     07986397
079864                ,INPK_CNVYB_IND                                   07986497
079865                ,LBL_TYP_LBL_SEQ_ID                               07986597
079866                ,LBL_TYP_TOT_QTY                                  07986697
079867                ,BRCDE_NBR                                        07986797
079868                ,STR_ZN_ID                                        07986897
079869                ,MODU_DESC                                        07986997
079870                ,ITM_NBR                                          07987097
079871                ,DEPT_DESC                                        07987197
079872                ,MAJ_CL_DESC                                      07987297
079873                ,SEASET_NM                                        07987397
079874                ,FIXT_ID                                          07987497
079875                ,LBL_TYP_CDE                                      07987597
079876                ,PRNT_CART_SEQ_ID                                 07987697
079877                ,STRG_AREA_CDE                                    07987797
079878                ,OTPK_UNT_QTY                                     07987897
079879                ,EAS_TAG_IND                                      07987997
079880                ,DOOR_ID                                          07988097
079881                ,HNG_FOLD_SEQ_NBR                                 07988197
079882*CLP 08/24/15 START                                               07988297
079883                ,LBL_MSG_TXT                                      07988397
079884*CLP 08/24/15 END                                                 07988497
079885        INTO     :LBVRDA-PREPK-ID                                 07988597
079886                ,:LBVRDA-LBL-ASG-SEQ-NBR                          07988697
079887                ,:LBVRDA-CART-LBL-TYP-CDE                         07988797
079890                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       07989074
079960                ,:LBVRDA-INPK-UNT-QTY                             07996013
079970                ,:LBVRDA-PREPK-RATO-QTY                           07997013
079980                ,:LBVRDA-PREPK-UNT-QTY                            07998013
079990                ,:LBVRDA-DEST-OPER-UNT-ID                         07999013
080000                ,:LBVRDA-CSE-PK-QTY                               08000013
080010                ,:LBVRDA-ODD-CART-IND                             08001013
080020                ,:LBVRDA-INPK-CNVYB-IND                           08002013
080030                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       08003013
080040                ,:LBVRDA-LBL-TYP-TOT-QTY                          08004013
080050                ,:LBVRDA-BRCDE-NBR                                08005013
080060                ,:LBVRDA-STR-ZN-ID                                08006013
080070                ,:LBVRDA-MODU-DESC                                08007013
080080                ,:LBVRDA-ITM-NBR                                  08008013
080090                ,:LBVRDA-DEPT-DESC                                08009013
080100                ,:LBVRDA-MAJ-CL-DESC                              08010013
080110                ,:LBVRDA-SEASET-NM                                08011013
080120                ,:LBVRDA-FIXT-ID                                  08012013
080130                ,:LBVRDA-LBL-TYP-CDE                              08013013
080140                ,:LBVRDA-PRNT-CART-SEQ-ID                         08014013
080150                ,:LBVRDA-STRG-AREA-CDE                            08015013
080160                ,:LBVRDA-OTPK-UNT-QTY                             08016013
080170                ,:LBVRDA-EAS-TAG-IND                              08017013
080180                ,:LBVRDA-DOOR-ID                                  08018013
080190                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         08019013
080200*CLP 08/24/15 START                                               08020013
080210                ,:LBVRDA-LBL-MSG-TXT                              08021013
080220*CLP 08/24/15 END                                                 08022013
080230        FROM TLBVRDA A                                            08023013
080240        WHERE  A.PO_NBR                =  :DK-PO                  08024013
080250          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         08025013
080260          AND  A.PO_LNE_NBR            =  :DK-PO-LNE-NBR          08026013
080270          AND  A.PREPK_ID              =  :DK-PREPK-ID            08027013
080280          AND  A.OTPK_UNT_QTY          =  :DK-OUTER-QTY           08028013
080290          AND  A.LBL_ASG_IND           =  'N'                     08029013
080300          AND  A.LBL_TYP_CDE           =  'M'                     08030013
080310          AND  A.LBL_ASG_SEQ_NBR =                                08031013
080320             (SELECT  MIN(LBL_ASG_SEQ_NBR)                        08032013
080330                 FROM   TLBVRDA B                                 08033013
080340              WHERE B.PO_NBR            = A.PO_NBR                08034013
080350                    AND  B.RCVR_SEQ_NBR = A.RCVR_SEQ_NBR          08035013
080360                    AND  B.PO_LNE_NBR   = A.PO_LNE_NBR            08036013
080370                    AND  B.PREPK_ID     = A.PREPK_ID              08037013
080380                    AND  B.OTPK_UNT_QTY = A.OTPK_UNT_QTY          08038013
080390                    AND  B.LBL_ASG_IND  = A.LBL_ASG_IND           08039013
080400                    AND  A.LBL_TYP_CDE  = B.LBL_TYP_CDE)          08040013
080410     END-EXEC                                                     08041013
080420                                                                  08042013
080430       EVALUATE TRUE                                              08043013
080440           WHEN SQLCODE = ZERO                                    08044013
080450              IF LBVRDA-INPK-CNVYB-IND = 'Y'                      08045013
080460                 SET PS-LABEL-DATA-NOT-FOUND TO TRUE              08046013
080470              ELSE                                                08047013
080480                 PERFORM 3520-PROCESS-TLBVRDA                     08048013
080490              END-IF                                              08049013
080500           WHEN SQLCODE = +100                                    08050013
080510              SET PS-UCC128-NO-LABEL-DATA TO TRUE                 08051013
080520           WHEN SQLCODE = -904                                    08052013
080530           WHEN SQLCODE = -913                                    08053013
080540               CONTINUE                                           08054013
080550           WHEN SQLWARN0 NOT = SPACES                             08055013
080560           WHEN SQLCODE < ZERO                                    08056013
080570           WHEN SQLCODE > ZERO                                    08057013
080580                                                                  08058013
080590              INITIALIZE PV-CICS-MSG-AREA1                        08059013
080600              INITIALIZE PV-CICS-MSG-AREA2                        08060013
080610                                                                  08061013
080620              MOVE SQLCODE              TO PV-DISP-SQLCODE        08062013
080630              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08063013
080640              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08064013
080650              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08065013
080660                                                                  08066013
080670              STRING  'SUKCS782 3500-'                            08067099
080680                      ' DC:'               PV-DISP-DC             08068013
080690                      ' B1:'               SU054-BAR-CODE-1       08069013
080700                      ' B2:'               SU054-BAR-CODE-2       08070013
080710                      ' B3:'               SU054-BAR-CODE-3       08071013
080720                                           DELIMITED BY SIZE      08072013
080730                                      INTO PV-CICS-MSG-AREA1      08073013
080740                                                                  08074013
080750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08075013
080760              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08076013
080770                                                                  08077013
080780              PERFORM 9999-WRITE-TO-CSSL                          08078013
080790                                                                  08079013
080800              STRING  'SUKCS782 '          SU054-KOHLS-SML        08080099
080810                      ' TRIP:'             PV-DISP-TRIP           08081013
080820                      ' DR:'               SU054-DOOR-NUMBER      08082013
080830                      ' USR:'              SU054-USER-ID          08083013
080840                      ' STA:'              PV-DISP-PNA-STA        08084013
080850                      ' SQL:'              PV-DISP-SQLCODE        08085013
080860                      ' TLBVRDA'                                  08086013
080870                                           DELIMITED BY SIZE      08087013
080880                                      INTO PV-CICS-MSG-AREA2      08088013
080890                                                                  08089013
080900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08090013
080910              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08091013
080920                                                                  08092013
080930              PERFORM 9999-WRITE-TO-CSSL                          08093013
080940                                                                  08094013
080950              INITIALIZE PV-CICS-MSG-AREA3                        08095013
080960              MOVE dk-PO               TO PV-DISP-PO              08096013
080970              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR            08097013
080980              MOVE dk-PO-LNE-NBR       TO PV-DISP-LINE            08098013
080990              MOVE PV-PREPK-ID         TO PV-DISP-PREPK           08099013
081000              MOVE DK-OUTER-QTY        TO PV-DISP-Otpk            08100013
081010                                                                  08101013
081020              STRING  'SUKCS782 '                                 08102099
081030                      '-'                  PV-DISP-PO             08103013
081040                      '-'                  PV-DISP-RCVR           08104013
081050                      '-'                  PV-DISP-LINE           08105013
081060                      '-'                  PV-DISP-PREPK          08106013
081070                      ' OUTER:'            PV-DISP-otpk           08107013
081080                      '-'                  DELIMITED BY SIZE      08108013
081090                                      INTO PV-CICS-MSG-AREA3      08109013
081100                                                                  08110013
081110              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08111013
081120              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08112013
081130                                                                  08113013
081140              PERFORM 9999-WRITE-TO-CSSL                          08114013
081150                                                                  08115013
081160               SET PS-PROCESSING-ERROR-YES TO TRUE                08116013
081170               PERFORM 9998-WRITE-TO-CSSL                         08117013
081180       END-EVALUATE                                               08118013
081190     END-PERFORM.                                                 08119013
081200                                                                  08120013
081210     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08121013
081220         (SQLCODE = -904  or                                      08122013
081230          sQLCODE = -913)                                         08123013
081240                                                                  08124013
081250              INITIALIZE PV-CICS-MSG-AREA1                        08125013
081260              INITIALIZE PV-CICS-MSG-AREA2                        08126013
081270                                                                  08127013
081280              MOVE SQLCODE              TO PV-DISP-SQLCODE        08128013
081290              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08129013
081300              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08130013
081310              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08131013
081320                                                                  08132013
081330              STRING  ' SUKCS782 3500-'                           08133099
081340                      ' DC:'               PV-DISP-DC             08134013
081350                      ' B1:'               SU054-BAR-CODE-1       08135013
081360                      ' B2:'               SU054-BAR-CODE-2       08136013
081370                      ' B3:'               SU054-BAR-CODE-3       08137013
081380                                           DELIMITED BY SIZE      08138013
081390                                      INTO PV-CICS-MSG-AREA1      08139013
081400                                                                  08140013
081410              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08141013
081420              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08142013
081430                                                                  08143013
081440              PERFORM 9999-WRITE-TO-CSSL                          08144013
081450                                                                  08145013
081460              STRING  ' SUKCS782 '          SU054-KOHLS-SML       08146099
081470                      ' TRIP:'             PV-DISP-TRIP           08147013
081480                      ' DR:'               SU054-DOOR-NUMBER      08148013
081490                      ' USR:'              SU054-USER-ID          08149013
081500                      ' STA:'              PV-DISP-PNA-STA        08150013
081510                      ' SQL:'              PV-DISP-SQLCODE        08151013
081520                      ' TLBVRDA'                                  08152013
081530                                           DELIMITED BY SIZE      08153013
081540                                      INTO PV-CICS-MSG-AREA2      08154013
081550                                                                  08155013
081560              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08156013
081570              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08157013
081580                                                                  08158013
081590              PERFORM 9999-WRITE-TO-CSSL                          08159013
081600                                                                  08160013
081610              INITIALIZE PV-CICS-MSG-AREA3                        08161013
081620              MOVE dk-PO               TO PV-DISP-PO              08162013
081630              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR            08163013
081640              MOVE dk-PO-LNE-NBR       TO PV-DISP-LINE            08164013
081650              MOVE PV-PREPK-ID         TO PV-DISP-PREPK           08165013
081660              MOVE DK-OUTER-QTY        TO PV-DISP-Otpk            08166013
081670                                                                  08167013
081680              STRING  ' SUKCS782 '                                08168099
081690                      '-'                  PV-DISP-PO             08169013
081700                      '-'                  PV-DISP-RCVR           08170013
081710                      '-'                  PV-DISP-LINE           08171013
081720                      '-'                  PV-DISP-PREPK          08172013
081730                      ' OUTER:'            PV-DISP-otpk           08173013
081740                      '-'                  DELIMITED BY SIZE      08174013
081750                                      INTO PV-CICS-MSG-AREA3      08175013
081760                                                                  08176013
081770              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08177013
081780              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08178013
081790                                                                  08179013
081800              PERFORM 9999-WRITE-TO-CSSL                          08180013
081810                                                                  08181013
081820     end-if.                                                      08182013
081830                                                                  08183013
081840                                                                  08184013
081850                                                                  08185013
081860 3520-PROCESS-TLBVRDA.                                            08186013
081870*                                                                 08187013
081880** added internal table to track paragraph execution time         08188013
081890** dmh 2014-12-22 - begin                                         08189013
081900*                                                                 08190013
081910     MOVE  '3520'  TO  PT-CURR-PARA.                              08191013
081920     IF  PS-BLD-INTERNAL-TABLE-YES                                08192013
081930         PERFORM 0200-INTERNAL-TABLE                              08193013
081940     ELSE                                                         08194013
081950         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08195013
081960     END-IF.                                                      08196013
081970                                                                  08197013
081980*                                                                 08198013
081990** DMH 2014-12-22 - END                                           08199013
082000*                                                                 08200013
082010      SET PS-LABEL-DATA-FOUND                                     08201013
082020          PS-FREE-ASTRAY-MSG-LBL-NO TO TRUE.                      08202013
082030      IF PS-CRTN-ATT-TO-TRIP AND PS-CRTN-ATT-TO-RCVR              08203013
082040         PERFORM 3550-CONSUME-TABLE-ROW                           08204013
082050         IF PS-SUCCESSFUL-UPDATE                                  08205013
082060            MOVE LBVRDA-DEST-OPER-UNT-ID TO PV-DEST-STORE         08206013
082070            PERFORM 7210-GET-STORE-INFO                           08207013
082080         END-IF                                                   08208013
082090      ELSE                                                        08209013
082100         SET PS-FREE-ASTRAY-MSG-LBL-YES                           08210013
082110             PS-DONE                    TO TRUE                   08211013
082120         IF PS-AUTO-VE-YES                                        08212013
082130            SET PS-FREE-ASTRAY-PROCESS TO TRUE                    08213013
082140            PERFORM 4250-LINK-TO-FRASTY-HANDLER                   08214013
082150            PERFORM 5005-PRINT-MESSAGE-LABELS                     08215013
082160         ELSE                                                     08216013
082170            PERFORM 5005-PRINT-MESSAGE-LABELS                     08217013
082180         END-IF                                                   08218013
082190      END-IF.                                                     08219013
082200**********************************************************        08220013
082210 3550-CONSUME-TABLE-ROW.                                          08221013
082220**********************************************************        08222013
082230*                                                                 08223013
082240** added internal table to track paragraph execution time         08224013
082250** dmh 2014-12-22 - begin                                         08225013
082260*                                                                 08226013
082270     MOVE  '3550'  TO  PT-CURR-PARA.                              08227013
082280     IF  PS-BLD-INTERNAL-TABLE-YES                                08228013
082290         PERFORM 0200-INTERNAL-TABLE                              08229013
082300     ELSE                                                         08230013
082310         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08231013
082320     END-IF.                                                      08232013
082330                                                                  08233013
082340*                                                                 08234013
082350** DMH 2014-12-22 - END                                           08235013
082360*                                                                 08236013
082370     EXEC SQL                                                     08237013
082380         UPDATE TLBVRDA                                           08238013
082390           SET LBL_ASG_IND     = 'Y'                              08239013
082400         WHERE PO_NBR          = :DK-PO                           08240013
082410           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  08241013
082420           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   08242013
082430           AND PREPK_ID        = :DK-PREPK-ID                     08243013
082440           AND LBL_ASG_SEQ_NBR = :LBVRDA-LBL-ASG-SEQ-NBR          08244013
082450           AND LBL_ASG_IND     = 'N'                              08245013
082460     END-EXEC.                                                    08246013
082470                                                                  08247013
082480                                                                  08248013
082490         EVALUATE TRUE                                            08249013
082500             WHEN SQLCODE = ZERO                                  08250013
082510                SET PS-SUCCESSFUL-UPDATE TO TRUE                  08251013
082520                MOVE LBVRDA-BRCDE-NBR  TO                         08252013
082530                                          DK-BARCODE-NBR          08253013
082540                MOVE LBVRDA-CART-LBL-TYP-CDE TO                   08254013
082550                                          DK-CART-LBL-TYP-CDE     08255013
082560                MOVE LBVRDA-DEST-OPER-UNT-ID TO                   08256013
082570                                          DK-DEST-OPER-UNT-ID     08257013
082580                MOVE SU054-DC-NUMBER TO DK-OPER-UNT-ID            08258013
082590                PERFORM 7215-GET-ECOMM-DC-INFO                    08259013
082600                PERFORM 3560-CHECK-FOR-NEW-PO-LINE                08260013
082610                MOVE LBVRDA-EAS-TAG-IND TO                        08261013
082620                                        PS-EAS-TAG-IND-FOUND-SW   08262013
082630                PERFORM 3570-POPULATE-CRTN-LBL-XREF               08263013
082640             WHEN SQLCODE = +100                                  08264013
082650                SET PS-NOT-SUCCESSFUL-UPDATE TO TRUE              08265013
082660             WHEN SQLCODE = -904                                  08266013
082670             WHEN SQLCODE = -913                                  08267013
082680                 CONTINUE                                         08268013
082690             WHEN SQLWARN0 NOT = SPACES                           08269013
082700             WHEN SQLCODE < ZERO                                  08270013
082710             WHEN SQLCODE > ZERO                                  08271013
082720                                                                  08272013
082730              INITIALIZE PV-CICS-MSG-AREA1                        08273013
082740              INITIALIZE PV-CICS-MSG-AREA2                        08274013
082750                                                                  08275013
082760              MOVE SQLCODE              TO PV-DISP-SQLCODE        08276013
082770              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08277013
082780              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08278013
082790              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08279013
082800                                                                  08280013
082810              STRING  'SUKCS782 3550-'                            08281099
082820                      ' DC:'               PV-DISP-DC             08282013
082830                      ' B1:'               SU054-BAR-CODE-1       08283013
082840                      ' B2:'               SU054-BAR-CODE-2       08284013
082850                      ' B3:'               SU054-BAR-CODE-3       08285013
082860                                           DELIMITED BY SIZE      08286013
082870                                      INTO PV-CICS-MSG-AREA1      08287013
082880                                                                  08288013
082890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08289013
082900              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08290013
082910                                                                  08291013
082920              PERFORM 9999-WRITE-TO-CSSL                          08292013
082930                                                                  08293013
082940              STRING  'SUKCS782 '          SU054-KOHLS-SML        08294099
082950                      ' TRIP:'             PV-DISP-TRIP           08295013
082960                      ' DR:'               SU054-DOOR-NUMBER      08296013
082970                      ' USR:'              SU054-USER-ID          08297013
082980                      ' STA:'              PV-DISP-PNA-STA        08298013
082990                      ' SQL:'              PV-DISP-SQLCODE        08299013
083000                      ' TLBVRDA'                                  08300013
083010                                           DELIMITED BY SIZE      08301013
083020                                      INTO PV-CICS-MSG-AREA2      08302013
083030                                                                  08303013
083040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08304013
083050              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08305013
083060                                                                  08306013
083070              PERFORM 9999-WRITE-TO-CSSL                          08307013
083080                                                                  08308013
083090              INITIALIZE PV-CICS-MSG-AREA3                        08309013
083100              MOVE dk-PO               TO PV-DISP-PO              08310013
083110              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR            08311013
083120              MOVE dk-PO-LNE-NBR       TO PV-DISP-LINE            08312013
083130              MOVE PV-PREPK-ID         TO PV-DISP-PREPK           08313013
083140              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      08314013
083150                                                                  08315013
083160              STRING  'SUKCS782 '                                 08316099
083170                      '-'                  PV-DISP-PO             08317013
083180                      '-'                  PV-DISP-RCVR           08318013
083190                      '-'                  PV-DISP-LINE           08319013
083200                      '-'                  PV-DISP-PREPK          08320013
083210                      ' LBL SEQ:'          PV-DISP-LBL-SEQ        08321013
083220                      '-'                  DELIMITED BY SIZE      08322013
083230                                      INTO PV-CICS-MSG-AREA3      08323013
083240                                                                  08324013
083250              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08325013
083260              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08326013
083270                                                                  08327013
083280              PERFORM 9999-WRITE-TO-CSSL                          08328013
083290                                                                  08329013
083300                 SET PS-PROCESSING-ERROR-YES TO TRUE              08330013
083310                 PERFORM 9998-WRITE-TO-CSSL                       08331013
083320         END-EVALUATE.                                            08332013
083330                                                                  08333013
083340     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    08334013
083350         (SQLCODE = -904  or                                      08335013
083360          sQLCODE = -913)                                         08336013
083370                                                                  08337013
083380              INITIALIZE PV-CICS-MSG-AREA1                        08338013
083390              INITIALIZE PV-CICS-MSG-AREA2                        08339013
083400                                                                  08340013
083410              MOVE SQLCODE              TO PV-DISP-SQLCODE        08341013
083420              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08342013
083430              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08343013
083440              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08344013
083450                                                                  08345013
083460              STRING  ' SUKCS782 3550-'                           08346099
083470                      ' DC:'               PV-DISP-DC             08347013
083480                      ' B1:'               SU054-BAR-CODE-1       08348013
083490                      ' B2:'               SU054-BAR-CODE-2       08349013
083500                      ' B3:'               SU054-BAR-CODE-3       08350013
083510                                           DELIMITED BY SIZE      08351013
083520                                      INTO PV-CICS-MSG-AREA1      08352013
083530                                                                  08353013
083540              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08354013
083550              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08355013
083560                                                                  08356013
083570              PERFORM 9999-WRITE-TO-CSSL                          08357013
083580                                                                  08358013
083590              STRING  ' SUKCS782 '          SU054-KOHLS-SML       08359099
083600                      ' TRIP:'             PV-DISP-TRIP           08360013
083610                      ' DR:'               SU054-DOOR-NUMBER      08361013
083620                      ' USR:'              SU054-USER-ID          08362013
083630                      ' STA:'              PV-DISP-PNA-STA        08363013
083640                      ' SQL:'              PV-DISP-SQLCODE        08364013
083650                      ' TLBVRDA'                                  08365013
083660                                           DELIMITED BY SIZE      08366013
083670                                      INTO PV-CICS-MSG-AREA2      08367013
083680                                                                  08368013
083690              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08369013
083700              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08370013
083710                                                                  08371013
083720              PERFORM 9999-WRITE-TO-CSSL                          08372013
083730                                                                  08373013
083740              INITIALIZE PV-CICS-MSG-AREA3                        08374013
083750              MOVE dk-PO               TO PV-DISP-PO              08375013
083760              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR            08376013
083770              MOVE dk-PO-LNE-NBR       TO PV-DISP-LINE            08377013
083780              MOVE PV-PREPK-ID         TO PV-DISP-PREPK           08378013
083790              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      08379013
083800                                                                  08380013
083810              STRING  ' SUKCS782 '                                08381099
083820                      '-'                  PV-DISP-PO             08382013
083830                      '-'                  PV-DISP-RCVR           08383013
083840                      '-'                  PV-DISP-LINE           08384013
083850                      '-'                  PV-DISP-PREPK          08385013
083860                      ' LBL SEQ:'          PV-DISP-LBL-SEQ        08386013
083870                      '-'                  DELIMITED BY SIZE      08387013
083880                                      INTO PV-CICS-MSG-AREA3      08388013
083890                                                                  08389013
083900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08390013
083910              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08391013
083920                                                                  08392013
083930              PERFORM 9999-WRITE-TO-CSSL                          08393013
083940                                                                  08394013
083950                                                                  08395013
083960     end-if.                                                      08396013
083970                                                                  08397013
083980                                                                  08398013
083990                                                                  08399013
084000*----------------------------------------------------------------*08400013
084010*                                                                *08401013
084020*                                                                *08402013
084030*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *08403013
084040*----------------------------------------------------------------*08404013
084050**********************************************************        08405013
084060 3560-CHECK-FOR-NEW-PO-LINE.                                      08406013
084070**********************************************************        08407013
084080*                                                                 08408013
084090** added internal table to track paragraph execution time         08409013
084100** dmh 2014-12-22 - begin                                         08410013
084110*                                                                 08411013
084120     MOVE  '3560'  TO  PT-CURR-PARA.                              08412013
084130     IF  PS-BLD-INTERNAL-TABLE-YES                                08413013
084140         PERFORM 0200-INTERNAL-TABLE                              08414013
084150     ELSE                                                         08415013
084160         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08416013
084170     END-IF.                                                      08417013
084180                                                                  08418013
084190*                                                                 08419013
084200** DMH 2014-12-22 - END                                           08420013
084210*                                                                 08421013
084220     MOVE PV-PO-NBR        TO   DK-PO.                            08422013
084230     MOVE SU054-TRIP-ID    TO   DK-MANIFEST.                      08423013
084240     MOVE PV-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                      08424013
084250     MOVE 'Q'              TO   DK-ERR-MSG-CDE.                   08425013
084260                                                                  08426013
084270     EXEC SQL                                                     08427013
084280         SELECT PO_NBR                                            08428013
084290              , CRE_TMST                                          08429013
084300         INTO   :LBVRMG-PO-NBR                                    08430013
084310              , :LBVRMG-CRE-TMST                                  08431013
084320         FROM   TLBVRMG                                           08432013
084330         WHERE PO_NBR          = :DK-PO                           08433013
084340           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  08434013
084350           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   08435013
084360           AND PREPK_ID        = :DK-PREPK-ID                     08436013
084370           AND TRIP_ID         = :DK-MANIFEST                     08437013
084380           AND ERR_MSG_CDE     = :DK-ERR-MSG-CDE                  08438013
084390     END-EXEC.                                                    08439013
084400                                                                  08440013
084410         EVALUATE TRUE                                            08441013
084420             WHEN SQLCODE = ZERO                                  08442013
084430                SET PS-DONT-PRINT-AUDIT-LABEL TO TRUE             08443013
084440             WHEN SQLCODE = +100                                  08444013
084450**gb 2/26/01 after '2002-03-18' uncomment and only populate       08445013
084460** with 'q' errors for ecomm                                      08446013
084470                MOVE ZEROES TO LBVRMG-CRE-TMST                    08447013
084480                SET PS-PRINT-AUDIT-LABEL TO TRUE                  08448013
084490             WHEN SQLWARN0 NOT = SPACES                           08449013
084500             WHEN SQLCODE < ZERO                                  08450013
084510             WHEN SQLCODE > ZERO                                  08451013
084520                                                                  08452013
084530              INITIALIZE PV-CICS-MSG-AREA1                        08453013
084540              INITIALIZE PV-CICS-MSG-AREA2                        08454013
084550                                                                  08455013
084560              MOVE SQLCODE              TO PV-DISP-SQLCODE        08456013
084570              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08457013
084580              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08458013
084590              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08459013
084600                                                                  08460013
084610              STRING  'SUKCS782 3560-'                            08461099
084620                      ' DC:'               PV-DISP-DC             08462013
084630                      ' B1:'               SU054-BAR-CODE-1       08463013
084640                      ' B2:'               SU054-BAR-CODE-2       08464013
084650                      ' B3:'               SU054-BAR-CODE-3       08465013
084660                                           DELIMITED BY SIZE      08466013
084670                                      INTO PV-CICS-MSG-AREA1      08467013
084680                                                                  08468013
084690              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08469013
084700              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08470013
084710                                                                  08471013
084720              PERFORM 9999-WRITE-TO-CSSL                          08472013
084730                                                                  08473013
084740              STRING  'SUKCS782 '          SU054-KOHLS-SML        08474099
084750                      ' TRIP:'             PV-DISP-TRIP           08475013
084760                      ' DR:'               SU054-DOOR-NUMBER      08476013
084770                      ' USR:'              SU054-USER-ID          08477013
084780                      ' STA:'              PV-DISP-PNA-STA        08478013
084790                      ' SQL:'              PV-DISP-SQLCODE        08479013
084800                      ' TLBVRMG'                                  08480013
084810                                           DELIMITED BY SIZE      08481013
084820                                      INTO PV-CICS-MSG-AREA2      08482013
084830                                                                  08483013
084840              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08484013
084850              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08485013
084860                                                                  08486013
084870              PERFORM 9999-WRITE-TO-CSSL                          08487013
084880                                                                  08488013
084890              INITIALIZE PV-CICS-MSG-AREA3                        08489013
084900              MOVE dk-PO               TO PV-DISP-PO              08490013
084910              MOVE DK-REC-SEQ-NBR      to pv-disp-RCVR            08491013
084920              MOVE dk-PO-LNE-NBR       TO PV-DISP-LINE            08492013
084930              MOVE dk-PREPK-ID         TO PV-DISP-PREPK           08493013
084940                                                                  08494013
084950              STRING  'SUKCS782 '                                 08495099
084960                      '-'                  PV-DISP-PO             08496013
084970                      '-'                  PV-DISP-RCVR           08497013
084980                      '-'                  PV-DISP-LINE           08498013
084990                      '-'                  PV-DISP-PREPK          08499013
085000                      ' ERR CDE:'          DK-ERR-MSG-CDE         08500013
085010                      '-'                  DELIMITED BY SIZE      08501013
085020                                      INTO PV-CICS-MSG-AREA3      08502013
085030                                                                  08503013
085040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08504013
085050              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08505013
085060                                                                  08506013
085070              PERFORM 9999-WRITE-TO-CSSL                          08507013
085080                                                                  08508013
085090                 SET PS-PROCESSING-ERROR-YES TO TRUE              08509013
085100                 PERFORM 9998-WRITE-TO-CSSL                       08510013
085110         END-EVALUATE.                                            08511013
085120                                                                  08512013
085130*----------------------------------------------------------------*08513013
085140*                                                                *08514013
085150*                                                                *08515013
085160*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *08516013
085170*----------------------------------------------------------------*08517013
085180**********************************************************        08518013
085190 3569-SEL-MAX-CHECK-IN-TMST.                                      08519013
085200**********************************************************        08520013
085210*                                                                 08521013
085220** added internal table to track paragraph execution time         08522013
085230** dmh 2014-12-22 - begin                                         08523013
085240*                                                                 08524013
085250     MOVE  '3569'  TO  PT-CURR-PARA.                              08525013
085260     IF  PS-BLD-INTERNAL-TABLE-YES                                08526013
085270         PERFORM 0200-INTERNAL-TABLE                              08527013
085280     ELSE                                                         08528013
085290         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08529013
085300     END-IF.                                                      08530013
085310                                                                  08531013
085320*                                                                 08532013
085330** DMH 2014-12-22 - END                                           08533013
085340*                                                                 08534013
085350                                                                  08535013
085360     EXEC SQL                                                     08536013
085370         SELECT MAX(CRE_TMST)                                     08537013
085380           INTO :PV-TSHUNLO-CRE-TMST                              08538013
085390           FROM TSHUNLO                                           08539013
085400         WHERE SHIPT_UNT_ID = :DK-CTN                             08540013
085410     END-EXEC                                                     08541013
085420                                                                  08542013
085430                                                                  08543013
085440     EVALUATE TRUE                                                08544013
085450         WHEN SQLCODE = ZERO                                      08545013
085460            MOVE PV-TSHUNLO-CRE-TMST TO PV-TSHUNLO-TMST-EAI       08546013
085470         WHEN SQLWARN0 NOT = SPACES                               08547013
085480         WHEN SQLCODE < ZERO                                      08548013
085490         WHEN SQLCODE > ZERO                                      08549013
085500                                                                  08550013
085510              INITIALIZE PV-CICS-MSG-AREA1                        08551013
085520              INITIALIZE PV-CICS-MSG-AREA2                        08552013
085530                                                                  08553013
085540              MOVE SQLCODE              TO PV-DISP-SQLCODE        08554013
085550              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08555013
085560              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08556013
085570              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08557013
085580                                                                  08558013
085590              STRING  'SUKCS782 3569-'                            08559099
085600                      ' DC:'               PV-DISP-DC             08560013
085610                      ' B1:'               SU054-BAR-CODE-1       08561013
085620                      ' B2:'               SU054-BAR-CODE-2       08562013
085630                      ' B3:'               SU054-BAR-CODE-3       08563013
085640                                           DELIMITED BY SIZE      08564013
085650                                      INTO PV-CICS-MSG-AREA1      08565013
085660                                                                  08566013
085670              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08567013
085680              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08568013
085690                                                                  08569013
085700              PERFORM 9999-WRITE-TO-CSSL                          08570013
085710                                                                  08571013
085720              STRING  'SUKCS782 '          SU054-KOHLS-SML        08572099
085730                      ' TRIP:'             PV-DISP-TRIP           08573013
085740                      ' DR:'               SU054-DOOR-NUMBER      08574013
085750                      ' USR:'              SU054-USER-ID          08575013
085760                      ' STA:'              PV-DISP-PNA-STA        08576013
085770                      ' SQL:'              PV-DISP-SQLCODE        08577013
085780                      ' TSHUNLO'                                  08578013
085790                                           DELIMITED BY SIZE      08579013
085800                                      INTO PV-CICS-MSG-AREA2      08580013
085810                                                                  08581013
085820              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08582013
085830              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08583013
085840                                                                  08584013
085850              PERFORM 9999-WRITE-TO-CSSL                          08585013
085860                                                                  08586013
085870              INITIALIZE PV-CICS-MSG-AREA3                        08587013
085880              MOVE DK-CTN              TO PV-DISP-SSCC            08588013
085890                                                                  08589013
085900              STRING  'SUKCS782 '                                 08590099
085910                      ' SSCC:'             PV-DISP-SSCC           08591013
085920                                           DELIMITED BY SIZE      08592013
085930                                      INTO PV-CICS-MSG-AREA3      08593013
085940                                                                  08594013
085950              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08595013
085960              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08596013
085970                                                                  08597013
085980              PERFORM 9999-WRITE-TO-CSSL                          08598013
085990                                                                  08599013
086000             SET PS-PROCESSING-ERROR-YES TO TRUE                  08600013
086010             PERFORM 9998-WRITE-TO-CSSL                           08601013
086020     END-EVALUATE.                                                08602013
086030                                                                  08603013
086040 EJECT                                                            08604013
086050******************************************************************08605013
086060**********************************************************        08606013
086070 3570-POPULATE-CRTN-LBL-XREF.                                     08607013
086080**********************************************************        08608013
086090*                                                                 08609013
086100** added internal table to track paragraph execution time         08610013
086110** dmh 2014-12-22 - begin                                         08611013
086120*                                                                 08612013
086130     MOVE  '3570'  TO  PT-CURR-PARA.                              08613013
086140     IF  PS-BLD-INTERNAL-TABLE-YES                                08614013
086150         PERFORM 0200-INTERNAL-TABLE                              08615013
086160     ELSE                                                         08616013
086170         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08617013
086180     END-IF.                                                      08618013
086190                                                                  08619013
086200*                                                                 08620013
086210** DMH 2014-12-22 - END                                           08621013
086220*                                                                 08622013
086230                                                                  08623013
086240     PERFORM 3569-SEL-MAX-CHECK-IN-TMST.                          08624013
086250                                                                  08625013
086260     EXEC SQL                                                     08626013
086270         INSERT INTO TSULBXF                                      08627013
086280               ( SHIPT_UNT_ID                                     08628013
086290                ,BRCDE_NBR                                        08629013
086300                ,CART_LBL_TYP_CDE                                 08630013
086310                ,DEST_OPER_UNT_ID                                 08631013
086320                ,STAT_CDE                                         08632013
086330                ,LAST_STAT_CHG_TMST                               08633013
086340                ,CRE_TMST)                                        08634013
086350         VALUES (:DK-CTN                                          08635013
086360               , :DK-BARCODE-NBR                                  08636013
086370               , :DK-CART-LBL-TYP-CDE                             08637013
086380               , :DK-DEST-OPER-UNT-ID                             08638013
086390               , :PC-A                                            08639013
086400               ,  CURRENT TIMESTAMP                               08640013
086410               , :PV-TSHUNLO-CRE-TMST)                            08641013
086420     END-EXEC                                                     08642013
086430                                                                  08643013
086440         EVALUATE TRUE                                            08644013
086450             WHEN SQLCODE = ZERO                                  08645013
086460                SET PS-DONE TO TRUE                               08646013
086470                IF DK-CART-LBL-TYP-CDE = 'P'                      08647013
086480                   SET PS-CARTON-P2L-CREATED TO TRUE              08648013
086490                ELSE                                              08649013
086500                   PERFORM 7600-PROCESS-INSERTS-TO-OTBND          08650013
086510                END-IF                                            08651013
086520             WHEN SQLWARN0 NOT = SPACES                           08652013
086530             WHEN SQLCODE < ZERO                                  08653013
086540             WHEN SQLCODE > ZERO                                  08654013
086550                                                                  08655013
086560              INITIALIZE PV-CICS-MSG-AREA1                        08656013
086570              INITIALIZE PV-CICS-MSG-AREA2                        08657013
086580                                                                  08658013
086590              MOVE SQLCODE              TO PV-DISP-SQLCODE        08659013
086600              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08660013
086610              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08661013
086620              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08662013
086630                                                                  08663013
086640              STRING  'SUKCS782 3570-'                            08664099
086650                      ' DC:'               PV-DISP-DC             08665013
086660                      ' B1:'               SU054-BAR-CODE-1       08666013
086670                      ' B2:'               SU054-BAR-CODE-2       08667013
086680                      ' B3:'               SU054-BAR-CODE-3       08668013
086690                                           DELIMITED BY SIZE      08669013
086700                                      INTO PV-CICS-MSG-AREA1      08670013
086710                                                                  08671013
086720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08672013
086730              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08673013
086740                                                                  08674013
086750              PERFORM 9999-WRITE-TO-CSSL                          08675013
086760                                                                  08676013
086770              STRING  'SUKCS782 '          SU054-KOHLS-SML        08677099
086780                      ' TRIP:'             PV-DISP-TRIP           08678013
086790                      ' DR:'               SU054-DOOR-NUMBER      08679013
086800                      ' USR:'              SU054-USER-ID          08680013
086810                      ' STA:'              PV-DISP-PNA-STA        08681013
086820                      ' SQL:'              PV-DISP-SQLCODE        08682013
086830                      ' TSULBXF'                                  08683013
086840                                           DELIMITED BY SIZE      08684013
086850                                      INTO PV-CICS-MSG-AREA2      08685013
086860                                                                  08686013
086870              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08687013
086880              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08688013
086890                                                                  08689013
086900              PERFORM 9999-WRITE-TO-CSSL                          08690013
086910                                                                  08691013
086920              INITIALIZE PV-CICS-MSG-AREA3                        08692013
086930              MOVE DK-CTN              TO PV-DISP-SSCC            08693013
086940                                                                  08694013
086950              STRING  'SUKCS782 '                                 08695099
086960                      ' SSCC:'             PV-DISP-SSCC           08696013
086970                      ' CRE-TMST:'         PV-TSHUNLO-CRE-TMST    08697013
086980                                           DELIMITED BY SIZE      08698013
086990                                      INTO PV-CICS-MSG-AREA3      08699013
087000                                                                  08700013
087010              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08701013
087020              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08702013
087030                                                                  08703013
087040              PERFORM 9999-WRITE-TO-CSSL                          08704013
087050                                                                  08705013
087060                 SET PS-PROCESSING-ERROR-YES TO TRUE              08706013
087070                 PERFORM 9998-WRITE-TO-CSSL                       08707013
087080         END-EVALUATE.                                            08708013
087090                                                                  08709013
087100 EJECT                                                            08710013
087110**********************************************************        08711013
087120**if the divert status has been changed since the carton *        08712013
087130**was originally scanned, inactivate the original row    *        08713013
087140**and continue to process to insert a new row            *        08714013
087150**********************************************************        08715013
087160 3580-INACTIVATE-XREF.                                            08716013
087170*                                                                 08717013
087180** added internal table to track paragraph execution time         08718013
087190** dmh 2014-12-22 - begin                                         08719013
087200*                                                                 08720013
087210     MOVE  '3580'  TO  PT-CURR-PARA.                              08721013
087220     IF  PS-BLD-INTERNAL-TABLE-YES                                08722013
087230         PERFORM 0200-INTERNAL-TABLE                              08723013
087240     ELSE                                                         08724013
087250         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08725013
087260     END-IF.                                                      08726013
087270                                                                  08727013
087280*                                                                 08728013
087290** DMH 2014-12-22 - END                                           08729013
087300*                                                                 08730013
087310                                                                  08731013
087320     EXEC SQL                                                     08732013
087330          UPDATE TSULBXF                                          08733013
087340             SET                                                  08734013
087350                  STAT_CDE           = :PC-I                      08735013
087360                , LAST_STAT_CHG_TMST = CURRENT TIMESTAMP          08736013
087370          WHERE  SHIPT_UNT_ID        = :DK-CTN                    08737013
087380            AND  BRCDE_NBR           = :SULBXF-BRCDE-NBR          08738013
087390     END-EXEC                                                     08739013
087400                                                                  08740013
087410         EVALUATE TRUE                                            08741013
087420             WHEN SQLCODE = ZERO                                  08742013
087430                CONTINUE                                          08743013
087440             WHEN SQLWARN0 NOT = SPACES                           08744013
087450             WHEN SQLCODE < ZERO                                  08745013
087460             WHEN SQLCODE > ZERO                                  08746013
087470                                                                  08747013
087480              INITIALIZE PV-CICS-MSG-AREA1                        08748013
087490              INITIALIZE PV-CICS-MSG-AREA2                        08749013
087500                                                                  08750013
087510              MOVE SQLCODE              TO PV-DISP-SQLCODE        08751013
087520              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08752013
087530              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08753013
087540              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08754013
087550                                                                  08755013
087560              STRING  'SUKCS782 3580-'                            08756099
087570                      ' DC:'               PV-DISP-DC             08757013
087580                      ' B1:'               SU054-BAR-CODE-1       08758013
087590                      ' B2:'               SU054-BAR-CODE-2       08759013
087600                      ' B3:'               SU054-BAR-CODE-3       08760013
087610                                           DELIMITED BY SIZE      08761013
087620                                      INTO PV-CICS-MSG-AREA1      08762013
087630                                                                  08763013
087640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08764013
087650              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08765013
087660                                                                  08766013
087670              PERFORM 9999-WRITE-TO-CSSL                          08767013
087680                                                                  08768013
087690              STRING  'SUKCS782 '          SU054-KOHLS-SML        08769099
087700                      ' TRIP:'             PV-DISP-TRIP           08770013
087710                      ' DR:'               SU054-DOOR-NUMBER      08771013
087720                      ' USR:'              SU054-USER-ID          08772013
087730                      ' STA:'              PV-DISP-PNA-STA        08773013
087740                      ' SQL:'              PV-DISP-SQLCODE        08774013
087750                      ' TSULBXF'                                  08775013
087760                                           DELIMITED BY SIZE      08776013
087770                                      INTO PV-CICS-MSG-AREA2      08777013
087780                                                                  08778013
087790              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08779013
087800              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08780013
087810                                                                  08781013
087820              PERFORM 9999-WRITE-TO-CSSL                          08782013
087830                                                                  08783013
087840              INITIALIZE PV-CICS-MSG-AREA3                        08784013
087850              MOVE DK-CTN              TO PV-DISP-SSCC            08785013
087860                                                                  08786013
087870              STRING  'SUKCS782 '                                 08787099
087880                      ' SSCC:'             PV-DISP-SSCC           08788013
087890                      ' BRCD:'             SULBXF-BRCDE-NBR       08789013
087900                                           DELIMITED BY SIZE      08790013
087910                                      INTO PV-CICS-MSG-AREA3      08791013
087920                                                                  08792013
087930              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08793013
087940              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08794013
087950                                                                  08795013
087960              PERFORM 9999-WRITE-TO-CSSL                          08796013
087970                                                                  08797013
087980                 SET PS-PROCESSING-ERROR-YES TO TRUE              08798013
087990                 PERFORM 9998-WRITE-TO-CSSL                       08799013
088000         END-EVALUATE.                                            08800013
088010                                                                  08801013
088020 EJECT                                                            08802013
088030**********************************************************        08803013
088040**if the divert status has been changed since the carton *        08804013
088050**was originally scanned, inactivate the outbound row    *        08805013
088060**and continue to process to insert a new row            *        08806013
088070**********************************************************        08807013
088080 3581-INACTIVATE-OTBND-CART.                                      08808013
088090**********************************************************        08809013
088100*                                                                 08810013
088110** added internal table to track paragraph execution time         08811013
088120** dmh 2014-12-22 - begin                                         08812013
088130*                                                                 08813013
088140     MOVE  '3581'  TO  PT-CURR-PARA.                              08814013
088150     IF  PS-BLD-INTERNAL-TABLE-YES                                08815013
088160         PERFORM 0200-INTERNAL-TABLE                              08816013
088170     ELSE                                                         08817013
088180         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08818013
088190     END-IF.                                                      08819013
088200                                                                  08820013
088210*                                                                 08821013
088220** DMH 2014-12-22 - END                                           08822013
088230*                                                                 08823013
088240                                                                  08824013
088250     MOVE SULBXF-BRCDE-NBR       TO PV-BAR-CODE.                  08825013
088260     MOVE PV-BAR-CODE-OTBND      TO SUT00024-SHIPT-UNT-ID.        08826013
088270                                                                  08827013
088280     EXEC SQL                                                     08828013
088290          UPDATE SUT_OTBND_CART                                   08829013
088300             SET                                                  08830013
088310                  ACTV_IND           = 'N'                        08831013
088320          WHERE  ORIG_CART_ID        = :DK-CTN                    08832013
088330            AND  SHIPT_UNT_ID        = :SUT00024-SHIPT-UNT-ID     08833013
088340            AND  ACTV_IND            = 'Y'                        08834013
088350     END-EXEC                                                     08835013
088360                                                                  08836013
088370         EVALUATE TRUE                                            08837013
088380             WHEN SQLCODE = ZERO                                  08838013
088390             WHEN SQLCODE = +100                                  08839013
088400                CONTINUE                                          08840013
088410             WHEN SQLWARN0 NOT = SPACES                           08841013
088420             WHEN SQLCODE < ZERO                                  08842013
088430             WHEN SQLCODE > ZERO                                  08843013
088440                                                                  08844013
088450              INITIALIZE PV-CICS-MSG-AREA1                        08845013
088460              INITIALIZE PV-CICS-MSG-AREA2                        08846013
088470                                                                  08847013
088480              MOVE SQLCODE              TO PV-DISP-SQLCODE        08848013
088490              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08849013
088500              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08850013
088510              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08851013
088520                                                                  08852013
088530              STRING  'SUKCS782 3581-'                            08853099
088540                      ' DC:'               PV-DISP-DC             08854013
088550                      ' B1:'               SU054-BAR-CODE-1       08855013
088560                      ' B2:'               SU054-BAR-CODE-2       08856013
088570                      ' B3:'               SU054-BAR-CODE-3       08857013
088580                                           DELIMITED BY SIZE      08858013
088590                                      INTO PV-CICS-MSG-AREA1      08859013
088600                                                                  08860013
088610              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08861013
088620              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08862013
088630                                                                  08863013
088640              PERFORM 9999-WRITE-TO-CSSL                          08864013
088650                                                                  08865013
088660              STRING  'SUKCS782 '          SU054-KOHLS-SML        08866099
088670                      ' TRIP:'             PV-DISP-TRIP           08867013
088680                      ' DR:'               SU054-DOOR-NUMBER      08868013
088690                      ' USR:'              SU054-USER-ID          08869013
088700                      ' STA:'              PV-DISP-PNA-STA        08870013
088710                      ' SQL:'              PV-DISP-SQLCODE        08871013
088720                      ' SUT_OTBND_CART'                           08872013
088730                                           DELIMITED BY SIZE      08873013
088740                                      INTO PV-CICS-MSG-AREA2      08874013
088750                                                                  08875013
088760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08876013
088770              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08877013
088780                                                                  08878013
088790              PERFORM 9999-WRITE-TO-CSSL                          08879013
088800                                                                  08880013
088810              INITIALIZE PV-CICS-MSG-AREA3                        08881013
088820              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISP-SSCC          08882013
088830                                                                  08883013
088840              STRING  'SUKCS782 '                                 08884099
088850                      ' SSCC:'             PV-DISP-SSCC           08885013
088860                                           DELIMITED BY SIZE      08886013
088870                                      INTO PV-CICS-MSG-AREA3      08887013
088880                                                                  08888013
088890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08889013
088900              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     08890013
088910                                                                  08891013
088920              PERFORM 9999-WRITE-TO-CSSL                          08892013
088930                                                                  08893013
088940                 SET PS-PROCESSING-ERROR-YES TO TRUE              08894013
088950                 PERFORM 9998-WRITE-TO-CSSL                       08895013
088960         END-EVALUATE.                                            08896013
088970                                                                  08897013
088980 3655-REPRINT-LABELS.                                             08898013
088990*                                                                 08899013
089000** added internal table to track paragraph execution time         08900013
089010** dmh 2014-12-22 - begin                                         08901013
089020*                                                                 08902013
089030     MOVE  '3655'  TO  PT-CURR-PARA.                              08903013
089040     IF  PS-BLD-INTERNAL-TABLE-YES                                08904013
089050         PERFORM 0200-INTERNAL-TABLE                              08905013
089060     ELSE                                                         08906013
089070         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08907013
089080     END-IF.                                                      08908013
089090                                                                  08909013
089100*                                                                 08910013
089110** DMH 2014-12-22 - END                                           08911013
089120*                                                                 08912013
089130                                                                  08913013
089140     PERFORM 3660-OPEN-REPRINT-CSR.                               08914013
089150                                                                  08915013
089160     INITIALIZE PV-REPRINT-CSR-CNT.                               08916013
089170     PERFORM 3670-FETCH-REPRINT-CSR.                              08917013
089180                                                                  08918013
089190     PERFORM UNTIL PS-END-OF-REPRINT-CSR                          08919013
089200        PERFORM 3680-GET-REPRINT-LBVRDA                           08920013
089210        IF PV-REPRINT-CSR-CNT = 0                                 08921013
089220           SET PS-NO-CASEPK-FND                                   08922013
089230               PS-UCC128-NO-LABEL-DATA  TO TRUE                   08923013
089240           PERFORM 5005-PRINT-MESSAGE-LABELS                      08924013
089250        ELSE                                                      08925013
089260           PERFORM 5000-PRINT-LABEL                               08926013
089270           PERFORM 3670-FETCH-REPRINT-CSR                         08927013
089280        END-IF                                                    08928013
089290     END-PERFORM.                                                 08929013
089300                                                                  08930013
089310     PERFORM 3675-CLOSE-REPRINT-CSR.                              08931013
089320*if not found on tsulbxf or tlbvrda  count = 0                    08932013
089330     IF PV-REPRINT-CSR-CNT = 0                                    08933013
089340        SET PS-NO-CASEPK-FND                                      08934013
089350            PS-UCC128-NO-LABEL-DATA  TO TRUE                      08935013
089360        PERFORM 5005-PRINT-MESSAGE-LABELS                         08936013
089370     END-IF.                                                      08937013
089380                                                                  08938013
089390 3660-OPEN-REPRINT-CSR.                                           08939013
089400*                                                                 08940013
089410** added internal table to track paragraph execution time         08941013
089420** dmh 2014-12-22 - begin                                         08942013
089430*                                                                 08943013
089440     MOVE  '3660'  TO  PT-CURR-PARA.                              08944013
089450     IF  PS-BLD-INTERNAL-TABLE-YES                                08945013
089460         PERFORM 0200-INTERNAL-TABLE                              08946013
089470     ELSE                                                         08947013
089480         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       08948013
089490     END-IF.                                                      08949013
089500                                                                  08950013
089510*                                                                 08951013
089520** DMH 2014-12-22 - END                                           08952013
089530*                                                                 08953013
089540                                                                  08954013
089550         EXEC SQL                                                 08955013
089560              OPEN REPRINT-CSR                                    08956013
089570         END-EXEC                                                 08957013
089580                                                                  08958013
089590                                                                  08959013
089600         EVALUATE TRUE                                            08960013
089610             WHEN SQLCODE = ZERO                                  08961013
089620                 CONTINUE                                         08962013
089630             WHEN SQLWARN0 NOT = SPACES                           08963013
089640             WHEN SQLCODE < ZERO                                  08964013
089650             WHEN SQLCODE > ZERO                                  08965013
089660                                                                  08966013
089670              INITIALIZE PV-CICS-MSG-AREA1                        08967013
089680              INITIALIZE PV-CICS-MSG-AREA2                        08968013
089690                                                                  08969013
089700              MOVE SQLCODE              TO PV-DISP-SQLCODE        08970013
089710              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             08971013
089720              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           08972013
089730              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        08973013
089740                                                                  08974013
089750              STRING  'SUKCS782 3660-'                            08975099
089760                      ' DC:'               PV-DISP-DC             08976013
089770                      ' B1:'               SU054-BAR-CODE-1       08977013
089780                      ' B2:'               SU054-BAR-CODE-2       08978013
089790                      ' B3:'               SU054-BAR-CODE-3       08979013
089800                                           DELIMITED BY SIZE      08980013
089810                                      INTO PV-CICS-MSG-AREA1      08981013
089820                                                                  08982013
089830              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08983013
089840              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     08984013
089850                                                                  08985013
089860              PERFORM 9999-WRITE-TO-CSSL                          08986013
089870                                                                  08987013
089880              STRING  'SUKCS782 '          SU054-KOHLS-SML        08988099
089890                      ' TRIP:'             PV-DISP-TRIP           08989013
089900                      ' DR:'               SU054-DOOR-NUMBER      08990013
089910                      ' USR:'              SU054-USER-ID          08991013
089920                      ' STA:'              PV-DISP-PNA-STA        08992013
089930                      ' SQL:'              PV-DISP-SQLCODE        08993013
089940                      ' TLBPTDA'                                  08994013
089950                                           DELIMITED BY SIZE      08995013
089960                                      INTO PV-CICS-MSG-AREA2      08996013
089970                                                                  08997013
089980              MOVE SPACES               TO PV-CICS-MSG-AREA-A     08998013
089990              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     08999013
090000                                                                  09000013
090010              PERFORM 9999-WRITE-TO-CSSL                          09001013
090020                                                                  09002013
090030              INITIALIZE PV-CICS-MSG-AREA3                        09003013
090040              MOVE DK-PO                 TO PV-DISP-PO            09004013
090050              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09005013
090060              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09006013
090070              MOVE DK-PREPK-ID           TO PV-DISP-PREPk         09007013
090080              MOVE DK-OUTER-QTY          TO pV-DISP-Otpk          09008013
090090              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      09009013
090100                                                                  09010013
090110              STRING  'SUKCS782 '                                 09011099
090120                      ' '                  PV-DISP-PO             09012013
090130                      '-'                  PV-DISP-RCVR           09013013
090140                      '-'                  PV-DISP-LINE           09014013
090150                      '-'                  PV-DISP-PREPk          09015013
090160                      ' outer:'            PV-DISP-otpk           09016013
090170                      ' lbl seq:'          PV-DISP-LBL-SEQ        09017013
090180                                           DELIMITED BY SIZE      09018013
090190                                      INTO PV-CICS-MSG-AREA3      09019013
090200                                                                  09020013
090210              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09021013
090220              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09022013
090230                                                                  09023013
090240              PERFORM 9999-WRITE-TO-CSSL                          09024013
090250                                                                  09025013
090260                 SET PS-PROCESSING-ERROR-YES TO TRUE              09026013
090270                 PERFORM 9998-WRITE-TO-CSSL                       09027013
090280         END-EVALUATE.                                            09028013
090290                                                                  09029013
090300 3670-FETCH-REPRINT-CSR.                                          09030013
090310*                                                                 09031013
090320** added internal table to track paragraph execution time         09032013
090330** dmh 2014-12-22 - begin                                         09033013
090340*                                                                 09034013
090350     MOVE  '3670'  TO  PT-CURR-PARA.                              09035013
090360     IF  PS-BLD-INTERNAL-TABLE-YES                                09036013
090370         PERFORM 0200-INTERNAL-TABLE                              09037013
090380     ELSE                                                         09038013
090390         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09039013
090400     END-IF.                                                      09040013
090410                                                                  09041013
090420*                                                                 09042013
090430** DMH 2014-12-22 - END                                           09043013
090440*                                                                 09044013
090450                                                                  09045013
090460      EXEC SQL                                                    09046013
090470        FETCH REPRINT-CSR                                         09047013
090480        INTO     :SULBXF-BRCDE-NBR                                09048013
090490         END-EXEC                                                 09049013
090500                                                                  09050013
090510     EVALUATE TRUE                                                09051013
090520         WHEN SQLCODE = ZERO                                      09052013
090530              ADD +1 TO PV-REPRINT-CSR-CNT                        09053013
090540         WHEN SQLCODE = +100                                      09054013
090550              SET PS-END-OF-REPRINT-CSR TO TRUE                   09055013
090560         WHEN SQLWARN0 NOT = SPACE                                09056013
090570         WHEN SQLCODE NOT = ZERO                                  09057013
090580                                                                  09058013
090590              INITIALIZE PV-CICS-MSG-AREA1                        09059013
090600              INITIALIZE PV-CICS-MSG-AREA2                        09060013
090610                                                                  09061013
090620              MOVE SQLCODE              TO PV-DISP-SQLCODE        09062013
090630              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09063013
090640              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09064013
090650              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09065013
090660                                                                  09066013
090670              STRING  'SUKCS782 3670-'                            09067099
090680                      ' DC:'               PV-DISP-DC             09068013
090690                      ' B1:'               SU054-BAR-CODE-1       09069013
090700                      ' B2:'               SU054-BAR-CODE-2       09070013
090710                      ' B3:'               SU054-BAR-CODE-3       09071013
090720                                           DELIMITED BY SIZE      09072013
090730                                      INTO PV-CICS-MSG-AREA1      09073013
090740                                                                  09074013
090750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09075013
090760              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09076013
090770                                                                  09077013
090780              PERFORM 9999-WRITE-TO-CSSL                          09078013
090790                                                                  09079013
090800              STRING  'SUKCS782 '          SU054-KOHLS-SML        09080099
090810                      ' TRIP:'             PV-DISP-TRIP           09081013
090820                      ' DR:'               SU054-DOOR-NUMBER      09082013
090830                      ' USR:'              SU054-USER-ID          09083013
090840                      ' STA:'              PV-DISP-PNA-STA        09084013
090850                      ' SQL:'              PV-DISP-SQLCODE        09085013
090860                      ' TSULBXF'                                  09086013
090870                                           DELIMITED BY SIZE      09087013
090880                                      INTO PV-CICS-MSG-AREA2      09088013
090890                                                                  09089013
090900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09090013
090910              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09091013
090920                                                                  09092013
090930              PERFORM 9999-WRITE-TO-CSSL                          09093013
090940                                                                  09094013
090950              INITIALIZE PV-CICS-MSG-AREA3                        09095013
090960              MOVE DK-CTN                TO PV-DISP-SSCC          09096013
090970                                                                  09097013
090980              STRING  'SUKCS782 '                                 09098099
090990                      ' FETCH REPRINT-CSR'                        09099013
091000                      ' SSCC:'             PV-DISP-SSCC           09100013
091010                                           DELIMITED BY SIZE      09101013
091020                                      INTO PV-CICS-MSG-AREA3      09102013
091030                                                                  09103013
091040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09104013
091050              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09105013
091060                                                                  09106013
091070              PERFORM 9999-WRITE-TO-CSSL                          09107013
091080                                                                  09108013
091090              SET PS-PROCESSING-ERROR-YES TO TRUE                 09109013
091100              PERFORM 9998-WRITE-TO-CSSL                          09110013
091110     END-EVALUATE.                                                09111013
091120                                                                  09112013
091130 3675-CLOSE-REPRINT-CSR.                                          09113013
091140*                                                                 09114013
091150** added internal table to track paragraph execution time         09115013
091160** dmh 2014-12-22 - begin                                         09116013
091170*                                                                 09117013
091180     MOVE  '3675'  TO  PT-CURR-PARA.                              09118013
091190     IF  PS-BLD-INTERNAL-TABLE-YES                                09119013
091200         PERFORM 0200-INTERNAL-TABLE                              09120013
091210     ELSE                                                         09121013
091220         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09122013
091230     END-IF.                                                      09123013
091240                                                                  09124013
091250*                                                                 09125013
091260** DMH 2014-12-22 - END                                           09126013
091270*                                                                 09127013
091280                                                                  09128013
091290         EXEC SQL                                                 09129013
091300              CLOSE REPRINT-CSR                                   09130013
091310         END-EXEC                                                 09131013
091320                                                                  09132013
091330                                                                  09133013
091340         EVALUATE TRUE                                            09134013
091350             WHEN SQLCODE = ZERO                                  09135013
091360                 CONTINUE                                         09136013
091370             WHEN SQLWARN0 NOT = SPACES                           09137013
091380             WHEN SQLCODE < ZERO                                  09138013
091390             WHEN SQLCODE > ZERO                                  09139013
091400                                                                  09140013
091410              INITIALIZE PV-CICS-MSG-AREA1                        09141013
091420              INITIALIZE PV-CICS-MSG-AREA2                        09142013
091430                                                                  09143013
091440              MOVE SQLCODE              TO PV-DISP-SQLCODE        09144013
091450              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09145013
091460              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09146013
091470              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09147013
091480                                                                  09148013
091490              STRING  'SUKCS782 3675-'                            09149099
091500                      ' DC:'               PV-DISP-DC             09150013
091510                      ' B1:'               SU054-BAR-CODE-1       09151013
091520                      ' B2:'               SU054-BAR-CODE-2       09152013
091530                      ' B3:'               SU054-BAR-CODE-3       09153013
091540                                           DELIMITED BY SIZE      09154013
091550                                      INTO PV-CICS-MSG-AREA1      09155013
091560                                                                  09156013
091570              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09157013
091580              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09158013
091590                                                                  09159013
091600              PERFORM 9999-WRITE-TO-CSSL                          09160013
091610                                                                  09161013
091620              STRING  'SUKCS782 '          SU054-KOHLS-SML        09162099
091630                      ' TRIP:'             PV-DISP-TRIP           09163013
091640                      ' DR:'               SU054-DOOR-NUMBER      09164013
091650                      ' USR:'              SU054-USER-ID          09165013
091660                      ' STA:'              PV-DISP-PNA-STA        09166013
091670                      ' SQL:'              PV-DISP-SQLCODE        09167013
091680                      ' TSULBXF'                                  09168013
091690                                           DELIMITED BY SIZE      09169013
091700                                      INTO PV-CICS-MSG-AREA2      09170013
091710                                                                  09171013
091720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09172013
091730              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09173013
091740                                                                  09174013
091750              PERFORM 9999-WRITE-TO-CSSL                          09175013
091760                                                                  09176013
091770              INITIALIZE PV-CICS-MSG-AREA3                        09177013
091780              MOVE DK-CTN                TO PV-DISP-SSCC          09178013
091790                                                                  09179013
091800              STRING  'SUKCS782 '                                 09180099
091810                      ' CLOSE REPRINT-CSR'                        09181013
091820                      ' SSCC:'             PV-DISP-SSCC           09182013
091830                                           DELIMITED BY SIZE      09183013
091840                                      INTO PV-CICS-MSG-AREA3      09184013
091850                                                                  09185013
091860              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09186013
091870              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09187013
091880                                                                  09188013
091890              PERFORM 9999-WRITE-TO-CSSL                          09189013
091900                                                                  09190013
091910                 SET PS-PROCESSING-ERROR-YES TO TRUE              09191013
091920                 PERFORM 9998-WRITE-TO-CSSL                       09192013
091930         END-EVALUATE.                                            09193013
091940                                                                  09194013
091950*----------------------------------------------------------------*09195013
091960*                                                                *09196013
091970*                                                                *09197013
091980*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *09198013
091990*----------------------------------------------------------------*09199013
092000 3680-GET-REPRINT-LBVRDA.                                         09200013
092010*                                                                 09201013
092020** added internal table to track paragraph execution time         09202013
092030** dmh 2014-12-22 - begin                                         09203013
092040*                                                                 09204013
092050     MOVE  '3680'  TO  PT-CURR-PARA.                              09205013
092060     IF  PS-BLD-INTERNAL-TABLE-YES                                09206013
092070         PERFORM 0200-INTERNAL-TABLE                              09207013
092080     ELSE                                                         09208013
092090         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09209013
092100     END-IF.                                                      09210013
092110                                                                  09211013
092120*                                                                 09212013
092130** DMH 2014-12-22 - END                                           09213013
092140*                                                                 09214013
092150                                                                  09215013
092160     EXEC SQL                                                     09216013
092170        SELECT   PREPK_ID                                         09217013
092180                ,LBL_ASG_SEQ_NBR                                  09218013
092190                ,CART_LBL_TYP_CDE                                 09219013
092200                ,PREPK_PRCG_LNE_NBR                               09220013
092210                ,INPK_UNT_QTY                                     09221013
092220                ,PREPK_RATO_QTY                                   09222013
092230                ,PREPK_UNT_QTY                                    09223013
092240                ,DEST_OPER_UNT_ID                                 09224013
092250                ,CSE_PK_QTY                                       09225013
092260                ,ODD_CART_IND                                     09226013
092270                ,INPK_CNVYB_IND                                   09227013
092280                ,LBL_TYP_LBL_SEQ_ID                               09228013
092290                ,LBL_TYP_TOT_QTY                                  09229013
092300                ,BRCDE_NBR                                        09230013
092310                ,STR_ZN_ID                                        09231013
092320                ,MODU_DESC                                        09232013
092330                ,ITM_NBR                                          09233013
092340                ,DEPT_DESC                                        09234013
092350                ,MAJ_CL_DESC                                      09235013
092360                ,SEASET_NM                                        09236013
092370                ,FIXT_ID                                          09237013
092380                ,STRG_AREA_CDE                                    09238013
092390                ,OTPK_UNT_QTY                                     09239013
092400                ,EAS_TAG_IND                                      09240013
092410                ,DOOR_ID                                          09241013
092420                ,HNG_FOLD_SEQ_NBR                                 09242013
092430*CLP 08/24/15 START                                               09243013
092440                ,LBL_MSG_TXT                                      09244013
092450*CLP 08/24/15 END                                                 09245013
092460        INTO     :LBVRDA-PREPK-ID                                 09246013
092470                ,:LBVRDA-LBL-ASG-SEQ-NBR                          09247013
092480                ,:LBVRDA-CART-LBL-TYP-CDE                         09248013
092490                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       09249013
092500                ,:LBVRDA-INPK-UNT-QTY                             09250013
092510                ,:LBVRDA-PREPK-RATO-QTY                           09251013
092520                ,:LBVRDA-PREPK-UNT-QTY                            09252013
092530                ,:LBVRDA-DEST-OPER-UNT-ID                         09253013
092540                ,:LBVRDA-CSE-PK-QTY                               09254013
092550                ,:LBVRDA-ODD-CART-IND                             09255013
092560                ,:LBVRDA-INPK-CNVYB-IND                           09256013
092570                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       09257013
092580                ,:LBVRDA-LBL-TYP-TOT-QTY                          09258013
092590                ,:LBVRDA-BRCDE-NBR                                09259013
092600                ,:LBVRDA-STR-ZN-ID                                09260013
092610                ,:LBVRDA-MODU-DESC                                09261013
092620                ,:LBVRDA-ITM-NBR                                  09262013
092630                ,:LBVRDA-DEPT-DESC                                09263013
092640                ,:LBVRDA-MAJ-CL-DESC                              09264013
092650                ,:LBVRDA-SEASET-NM                                09265013
092660                ,:LBVRDA-FIXT-ID                                  09266013
092670                ,:LBVRDA-STRG-AREA-CDE                            09267013
092680                ,:LBVRDA-OTPK-UNT-QTY                             09268013
092690                ,:LBVRDA-EAS-TAG-IND                              09269013
092700                ,:LBVRDA-DOOR-ID                                  09270013
092710                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         09271013
092720*CLP 08/24/15 START                                               09272013
092730                ,:LBVRDA-LBL-MSG-TXT                              09273013
092740*CLP 08/24/15 END                                                 09274013
092750        FROM TLBVRDA A                                            09275013
092760        WHERE  A.PO_NBR                =  :DK-PO                  09276013
092770          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         09277013
092780          AND  A.PO_LNE_NBR            =  :DK-PO-LNE-NBR          09278013
092790          AND  A.PREPK_ID              =  :DK-PREPK-ID            09279013
092800          AND  A.BRCDE_NBR             =  :SULBXF-BRCDE-NBR       09280013
092810     END-EXEC                                                     09281013
092820                                                                  09282013
092830      EVALUATE TRUE                                               09283013
092840          WHEN SQLCODE = ZERO                                     09284013
092850              MOVE  LBVRDA-DEST-OPER-UNT-ID TO PV-DEST-STORE      09285013
092860              PERFORM 7210-GET-STORE-INFO                         09286013
092870          WHEN SQLCODE = +100                                     09287013
092880             SET PS-END-OF-REPRINT-CSR TO TRUE                    09288013
092890             INITIALIZE PV-REPRINT-CSR-CNT                        09289013
092900          WHEN SQLWARN0 NOT = SPACES                              09290013
092910          WHEN SQLCODE < ZERO                                     09291013
092920          WHEN SQLCODE > ZERO                                     09292013
092930                                                                  09293013
092940              INITIALIZE PV-CICS-MSG-AREA1                        09294013
092950              INITIALIZE PV-CICS-MSG-AREA2                        09295013
092960                                                                  09296013
092970              MOVE SQLCODE              TO PV-DISP-SQLCODE        09297013
092980              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09298013
092990              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09299013
093000              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09300013
093010                                                                  09301013
093020              STRING  'SUKCS782 3680-'                            09302099
093030                      ' DC:'               PV-DISP-DC             09303013
093040                      ' B1:'               SU054-BAR-CODE-1       09304013
093050                      ' B2:'               SU054-BAR-CODE-2       09305013
093060                      ' B3:'               SU054-BAR-CODE-3       09306013
093070                                           DELIMITED BY SIZE      09307013
093080                                      INTO PV-CICS-MSG-AREA1      09308013
093090                                                                  09309013
093100              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09310013
093110              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09311013
093120                                                                  09312013
093130              PERFORM 9999-WRITE-TO-CSSL                          09313013
093140                                                                  09314013
093150              STRING  'SUKCS782 '          SU054-KOHLS-SML        09315099
093160                      ' TRIP:'             PV-DISP-TRIP           09316013
093170                      ' DR:'               SU054-DOOR-NUMBER      09317013
093180                      ' USR:'              SU054-USER-ID          09318013
093190                      ' STA:'              PV-DISP-PNA-STA        09319013
093200                      ' SQL:'              PV-DISP-SQLCODE        09320013
093210                      ' TLBVRDA'                                  09321013
093220                                           DELIMITED BY SIZE      09322013
093230                                      INTO PV-CICS-MSG-AREA2      09323013
093240                                                                  09324013
093250              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09325013
093260              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09326013
093270                                                                  09327013
093280              PERFORM 9999-WRITE-TO-CSSL                          09328013
093290                                                                  09329013
093300              INITIALIZE PV-CICS-MSG-AREA3                        09330013
093310              MOVE DK-PO                 TO PV-DISP-PO            09331013
093320              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09332013
093330              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09333013
093340              MOVE DK-PREPK-ID           TO PV-DISP-PREPK         09334013
093350              MOVE SULBXF-BRCDE-NBR      TO PV-DISP-SSCC          09335013
093360                                                                  09336013
093370              STRING  'SUKCS782 '                                 09337099
093380                      ' '                  PV-DISP-PO             09338013
093390                      '-'                  PV-DISP-RCVR           09339013
093400                      '-'                  PV-DISP-LINE           09340013
093410                      '-'                  PV-DISP-PREPK          09341013
093420                      ' SSCC:'             PV-DISP-SSCC           09342013
093430                                           DELIMITED BY SIZE      09343013
093440                                      INTO PV-CICS-MSG-AREA3      09344013
093450                                                                  09345013
093460              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09346013
093470              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09347013
093480                                                                  09348013
093490              PERFORM 9999-WRITE-TO-CSSL                          09349013
093500                                                                  09350013
093510              SET PS-PROCESSING-ERROR-YES TO TRUE                 09351013
093520              PERFORM 9998-WRITE-TO-CSSL                          09352013
093530      END-EVALUATE.                                               09353013
093540                                                                  09354013
093550                                                                  09355013
093560*----------------------------------------------------------------*09356013
093570*                                                                *09357013
093580*                                                                *09358013
093590*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *09359013
093600*----------------------------------------------------------------*09360013
093610**********************************************************        09361013
093620 3685-CHECK-UCC128-USE.                                           09362013
093630**********************************************************        09363013
093640*                                                                 09364013
093650** added internal table to track paragraph execution time         09365013
093660** dmh 2014-12-22 - begin                                         09366013
093670*                                                                 09367013
093680     MOVE  '3685'  TO  PT-CURR-PARA.                              09368013
093690     IF  PS-BLD-INTERNAL-TABLE-YES                                09369013
093700         PERFORM 0200-INTERNAL-TABLE                              09370013
093710     ELSE                                                         09371013
093720         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09372013
093730     END-IF.                                                      09373013
093740                                                                  09374013
093750*                                                                 09375013
093760** DMH 2014-12-22 - END                                           09376013
093770*                                                                 09377013
093780                                                                  09378013
093790     MOVE PV-PO-NBR           TO DK-PO.                           09379013
093800     MOVE PV-RCVR-SEQ-NBR     TO DK-REC-SEQ-NBR.                  09380013
093810     MOVE SHUUPC-TRN-LNE-NBR  TO DK-PO-LNE-NBR                    09381013
093820                                 PV-PO-LINE-N.                    09382013
093830                                                                  09383013
093840     EXEC SQL                                                     09384013
093850        SELECT   UCC128_DAT_USG_CDE                               09385013
093860                ,TOT_CART_CNT                                     09386013
093870        INTO     :DISTHD-UCC128-DAT-USG-CDE                       09387013
093880                ,:DISTHD-TOT-CART-CNT                             09388013
093890        FROM TDISTHD A                                            09389013
093900        WHERE  A.ORD_NBR               =  :DK-PO                  09390013
093910          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         09391013
093920          AND  A.ORD_LNE_NBR           =  :DK-PO-LNE-NBR          09392013
093930         WITH UR                                                  09393013
093940     END-EXEC                                                     09394013
093950                                                                  09395013
093960      EVALUATE TRUE                                               09396013
093970          WHEN SQLCODE = ZERO                                     09397013
093980             MOVE DISTHD-UCC128-DAT-USG-CDE                       09398013
093990                                TO PV-UCC128-DAT-USG-CDE          09399013
094000          WHEN SQLCODE = +100                                     09400013
094010             MOVE SPACES TO PV-UCC128-DAT-USG-CDE                 09401013
094020          WHEN SQLWARN0 NOT = SPACES                              09402013
094030          WHEN SQLCODE < ZERO                                     09403013
094040          WHEN SQLCODE > ZERO                                     09404013
094050                                                                  09405013
094060              INITIALIZE PV-CICS-MSG-AREA1                        09406013
094070              INITIALIZE PV-CICS-MSG-AREA2                        09407013
094080                                                                  09408013
094090              MOVE SQLCODE              TO PV-DISP-SQLCODE        09409013
094100              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09410013
094110              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09411013
094120              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09412013
094130                                                                  09413013
094140              STRING  'SUKCS782 3685-'                            09414099
094150                      ' DC:'               PV-DISP-DC             09415013
094160                      ' B1:'               SU054-BAR-CODE-1       09416013
094170                      ' B2:'               SU054-BAR-CODE-2       09417013
094180                      ' B3:'               SU054-BAR-CODE-3       09418013
094190                                           DELIMITED BY SIZE      09419013
094200                                      INTO PV-CICS-MSG-AREA1      09420013
094210                                                                  09421013
094220              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09422013
094230              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09423013
094240                                                                  09424013
094250              PERFORM 9999-WRITE-TO-CSSL                          09425013
094260                                                                  09426013
094270              STRING  'SUKCS782 '          SU054-KOHLS-SML        09427099
094280                      ' TRIP:'             PV-DISP-TRIP           09428013
094290                      ' DR:'               SU054-DOOR-NUMBER      09429013
094300                      ' USR:'              SU054-USER-ID          09430013
094310                      ' STA:'              PV-DISP-PNA-STA        09431013
094320                      ' SQL:'              PV-DISP-SQLCODE        09432013
094330                      ' TDISTHD'                                  09433013
094340                                           DELIMITED BY SIZE      09434013
094350                                      INTO PV-CICS-MSG-AREA2      09435013
094360                                                                  09436013
094370              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09437013
094380              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09438013
094390                                                                  09439013
094400              PERFORM 9999-WRITE-TO-CSSL                          09440013
094410                                                                  09441013
094420              INITIALIZE PV-CICS-MSG-AREA3                        09442013
094430              MOVE DK-PO                 TO PV-DISP-PO            09443013
094440              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09444013
094450              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09445013
094460                                                                  09446013
094470              STRING  'SUKCS782 '                                 09447099
094480                      ' '                  PV-DISP-PO             09448013
094490                      '-'                  PV-DISP-RCVR           09449013
094500                      '-'                  PV-DISP-LINE           09450013
094510                                           DELIMITED BY SIZE      09451013
094520                                      INTO PV-CICS-MSG-AREA3      09452013
094530                                                                  09453013
094540              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09454013
094550              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09455013
094560                                                                  09456013
094570              PERFORM 9999-WRITE-TO-CSSL                          09457013
094580                                                                  09458013
094590              SET PS-PROCESSING-ERROR-YES TO TRUE                 09459013
094600              PERFORM 9998-WRITE-TO-CSSL                          09460013
094610      END-EVALUATE.                                               09461013
094620                                                                  09462013
094630                                                                  09463013
094640*----------------------------------------------------------------*09464013
094650*                                                                *09465013
094660*                                                                *09466013
094670*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *09467013
094680*----------------------------------------------------------------*09468013
094690**********************************************************        09469013
094700 3690-CHECK-SULBXF-FOR-ACTIVE.                                    09470013
094710**********************************************************        09471013
094720*                                                                 09472013
094730** added internal table to track paragraph execution time         09473013
094740** dmh 2014-12-22 - begin                                         09474013
094750*                                                                 09475013
094760     MOVE  '3690'  TO  PT-CURR-PARA.                              09476013
094770     IF  PS-BLD-INTERNAL-TABLE-YES                                09477013
094780         PERFORM 0200-INTERNAL-TABLE                              09478013
094790     ELSE                                                         09479013
094800         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09480013
094810     END-IF.                                                      09481013
094820                                                                  09482013
094830*                                                                 09483013
094840** DMH 2014-12-22 - END                                           09484013
094850*                                                                 09485013
094860                                                                  09486013
094870     MOVE PV-CTN-N            TO DK-CTN.                          09487013
094880                                                                  09488013
094890     EXEC SQL                                                     09489013
094900        SELECT   BRCDE_NBR                                        09490013
094910        INTO   :SULBXF-BRCDE-NBR                                  09491013
094920        FROM TSULBXF A                                            09492013
094930        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                09493013
094940          AND  A.STAT_CDE              =   'A'                    09494013
094950     END-EXEC                                                     09495013
094960                                                                  09496013
094970      EVALUATE TRUE                                               09497013
094980          WHEN SQLCODE = ZERO                                     09498013
094990          WHEN SQLCODE = -811                                     09499013
095000             SET PS-ACTIVE-XREF-ROW-FOUND  TO TRUE                09500013
095010          WHEN SQLCODE = +100                                     09501013
095020             PERFORM 3695-CHECK-SULBXF-2                          09502013
095030          WHEN SQLWARN0 NOT = SPACES                              09503013
095040          WHEN SQLCODE < ZERO                                     09504013
095050          WHEN SQLCODE > ZERO                                     09505013
095060                                                                  09506013
095070              INITIALIZE PV-CICS-MSG-AREA1                        09507013
095080              INITIALIZE PV-CICS-MSG-AREA2                        09508013
095090                                                                  09509013
095100              MOVE SQLCODE              TO PV-DISP-SQLCODE        09510013
095110              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09511013
095120              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09512013
095130              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09513013
095140                                                                  09514013
095150              STRING  'SUKCS782 3690-'                            09515099
095160                      ' DC:'               PV-DISP-DC             09516013
095170                      ' B1:'               SU054-BAR-CODE-1       09517013
095180                      ' B2:'               SU054-BAR-CODE-2       09518013
095190                      ' B3:'               SU054-BAR-CODE-3       09519013
095200                                           DELIMITED BY SIZE      09520013
095210                                      INTO PV-CICS-MSG-AREA1      09521013
095220                                                                  09522013
095230              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09523013
095240              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09524013
095250                                                                  09525013
095260              PERFORM 9999-WRITE-TO-CSSL                          09526013
095270                                                                  09527013
095280              STRING  'SUKCS782 '          SU054-KOHLS-SML        09528099
095290                      ' TRIP:'             PV-DISP-TRIP           09529013
095300                      ' DR:'               SU054-DOOR-NUMBER      09530013
095310                      ' USR:'              SU054-USER-ID          09531013
095320                      ' STA:'              PV-DISP-PNA-STA        09532013
095330                      ' SQL:'              PV-DISP-SQLCODE        09533013
095340                      ' TSULBXF'                                  09534013
095350                                           DELIMITED BY SIZE      09535013
095360                                      INTO PV-CICS-MSG-AREA2      09536013
095370                                                                  09537013
095380              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09538013
095390              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09539013
095400                                                                  09540013
095410              PERFORM 9999-WRITE-TO-CSSL                          09541013
095420                                                                  09542013
095430              INITIALIZE PV-CICS-MSG-AREA3                        09543013
095440              MOVE DK-CTN                TO PV-DISP-SSCC          09544013
095450              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09545013
095460              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09546013
095470                                                                  09547013
095480              STRING  'SUKCS782 '                                 09548099
095490                      ' SSCC:'             PV-DISP-SSCC           09549013
095500                                           DELIMITED BY SIZE      09550013
095510                                      INTO PV-CICS-MSG-AREA3      09551013
095520                                                                  09552013
095530              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09553013
095540              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09554013
095550                                                                  09555013
095560              PERFORM 9999-WRITE-TO-CSSL                          09556013
095570                                                                  09557013
095580              SET PS-PROCESSING-ERROR-YES TO TRUE                 09558013
095590              PERFORM 9998-WRITE-TO-CSSL                          09559013
095600      END-EVALUATE.                                               09560013
095610                                                                  09561013
095620                                                                  09562013
095630*----------------------------------------------------------------*09563013
095640*                                                                *09564013
095650*                                                                *09565013
095660*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *09566013
095670*----------------------------------------------------------------*09567013
095680**********************************************************        09568013
095690 3695-CHECK-SULBXF-2.                                             09569013
095700**********************************************************        09570013
095710*                                                                 09571013
095720** added internal table to track paragraph execution time         09572013
095730** dmh 2014-12-22 - begin                                         09573013
095740*                                                                 09574013
095750     MOVE  '3695'  TO  PT-CURR-PARA.                              09575013
095760     IF  PS-BLD-INTERNAL-TABLE-YES                                09576013
095770         PERFORM 0200-INTERNAL-TABLE                              09577013
095780     ELSE                                                         09578013
095790         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09579013
095800     END-IF.                                                      09580013
095810                                                                  09581013
095820*                                                                 09582013
095830** DMH 2014-12-22 - END                                           09583013
095840*                                                                 09584013
095850                                                                  09585013
095860     EXEC SQL                                                     09586013
095870        SELECT  BRCDE_NBR                                         09587013
095880        INTO   :SULBXF-BRCDE-NBR                                  09588013
095890        FROM   TSULBXF A                                          09589013
095900        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                09590013
095910          AND  A.STAT_CDE              =   'I'                    09591013
095920     END-EXEC                                                     09592013
095930                                                                  09593013
095940      EVALUATE TRUE                                               09594013
095950          WHEN SQLCODE = ZERO                                     09595013
095960          WHEN SQLCODE = -811                                     09596013
095970             SET PS-ACTIVE-XREF-ROW-NOT-FOUND TO TRUE             09597013
095980          WHEN SQLCODE = +100                                     09598013
095990             SET PS-SULBXF-RECORD-NOT-FOUND TO TRUE               09599013
096000          WHEN SQLWARN0 NOT = SPACES                              09600013
096010          WHEN SQLCODE < ZERO                                     09601013
096020          WHEN SQLCODE > ZERO                                     09602013
096030                                                                  09603013
096040              INITIALIZE PV-CICS-MSG-AREA1                        09604013
096050              INITIALIZE PV-CICS-MSG-AREA2                        09605013
096060                                                                  09606013
096070              MOVE SQLCODE              TO PV-DISP-SQLCODE        09607013
096080              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09608013
096090              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09609013
096100              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09610013
096110                                                                  09611013
096120              STRING  'SUKCS782 3695-'                            09612099
096130                      ' DC:'               PV-DISP-DC             09613013
096140                      ' B1:'               SU054-BAR-CODE-1       09614013
096150                      ' B2:'               SU054-BAR-CODE-2       09615013
096160                      ' B3:'               SU054-BAR-CODE-3       09616013
096170                                           DELIMITED BY SIZE      09617013
096180                                      INTO PV-CICS-MSG-AREA1      09618013
096190                                                                  09619013
096200              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09620013
096210              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09621013
096220                                                                  09622013
096230              PERFORM 9999-WRITE-TO-CSSL                          09623013
096240                                                                  09624013
096250              STRING  'SUKCS782 '          SU054-KOHLS-SML        09625099
096260                      ' TRIP:'             PV-DISP-TRIP           09626013
096270                      ' DR:'               SU054-DOOR-NUMBER      09627013
096280                      ' USR:'              SU054-USER-ID          09628013
096290                      ' STA:'              PV-DISP-PNA-STA        09629013
096300                      ' SQL:'              PV-DISP-SQLCODE        09630013
096310                      ' TSULBXF'                                  09631013
096320                                           DELIMITED BY SIZE      09632013
096330                                      INTO PV-CICS-MSG-AREA2      09633013
096340                                                                  09634013
096350              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09635013
096360              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09636013
096370                                                                  09637013
096380              PERFORM 9999-WRITE-TO-CSSL                          09638013
096390                                                                  09639013
096400              INITIALIZE PV-CICS-MSG-AREA3                        09640013
096410              MOVE DK-CTN                TO PV-DISP-SSCC          09641013
096420              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09642013
096430              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09643013
096440                                                                  09644013
096450              STRING  'SUKCS782 '                                 09645099
096460                      ' SSCC:'             PV-DISP-SSCC           09646013
096470                                           DELIMITED BY SIZE      09647013
096480                                      INTO PV-CICS-MSG-AREA3      09648013
096490                                                                  09649013
096500              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09650013
096510              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09651013
096520                                                                  09652013
096530              PERFORM 9999-WRITE-TO-CSSL                          09653013
096540                                                                  09654013
096550              SET PS-PROCESSING-ERROR-YES TO TRUE                 09655013
096560              PERFORM 9998-WRITE-TO-CSSL                          09656013
096570      END-EVALUATE.                                               09657013
096580                                                                  09658013
096590                                                                  09659013
096600*----------------------------------------------------------------*09660013
096610*                                                                *09661013
096620*                                                                *09662013
096630*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *09663013
096640*----------------------------------------------------------------*09664013
096650**********************************************************        09665013
096660 3696-CHECK-SULBXF-FOR-PBS.                                       09666013
096670**********************************************************        09667013
096680*                                                                 09668013
096690** added internal table to track paragraph execution time         09669013
096700** dmh 2014-12-22 - begin                                         09670013
096710*                                                                 09671013
096720     MOVE  '3696'  TO  PT-CURR-PARA.                              09672013
096730     IF  PS-BLD-INTERNAL-TABLE-YES                                09673013
096740         PERFORM 0200-INTERNAL-TABLE                              09674013
096750     ELSE                                                         09675013
096760         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09676013
096770     END-IF.                                                      09677013
096780                                                                  09678013
096790*                                                                 09679013
096800** DMH 2014-12-22 - END                                           09680013
096810*                                                                 09681013
096820                                                                  09682013
096830     MOVE PV-CTN-N            TO DK-CTN.                          09683013
096840                                                                  09684013
096850     EXEC SQL                                                     09685013
096860        SELECT   BRCDE_NBR                                        09686013
096870        INTO   :SULBXF-BRCDE-NBR                                  09687013
096880        FROM TSULBXF A                                            09688013
096890        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                09689013
096900          AND  A.STAT_CDE              =   'A'                    09690013
096910     END-EXEC                                                     09691013
096920                                                                  09692013
096930      EVALUATE TRUE                                               09693013
096940          WHEN SQLCODE = ZERO                                     09694013
096950          WHEN SQLCODE = -811                                     09695013
096960             SET PS-XREF-PBS-FOUND         TO TRUE                09696013
096970          WHEN SQLCODE = +100                                     09697013
096980             SET PS-XREF-PBS-NOT-FOUND    TO TRUE                 09698013
096990          WHEN SQLWARN0 NOT = SPACES                              09699013
097000          WHEN SQLCODE < ZERO                                     09700013
097010          WHEN SQLCODE > ZERO                                     09701013
097020                                                                  09702013
097030              INITIALIZE PV-CICS-MSG-AREA1                        09703013
097040              INITIALIZE PV-CICS-MSG-AREA2                        09704013
097050                                                                  09705013
097060              MOVE SQLCODE              TO PV-DISP-SQLCODE        09706013
097070              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09707013
097080              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09708013
097090              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09709013
097100                                                                  09710013
097110              STRING  'SUKCS782 3696-'                            09711099
097120                      ' DC:'               PV-DISP-DC             09712013
097130                      ' B1:'               SU054-BAR-CODE-1       09713013
097140                      ' B2:'               SU054-BAR-CODE-2       09714013
097150                      ' B3:'               SU054-BAR-CODE-3       09715013
097160                                           DELIMITED BY SIZE      09716013
097170                                      INTO PV-CICS-MSG-AREA1      09717013
097180                                                                  09718013
097190              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09719013
097200              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09720013
097210                                                                  09721013
097220              PERFORM 9999-WRITE-TO-CSSL                          09722013
097230                                                                  09723013
097240              STRING  'SUKCS782 '          SU054-KOHLS-SML        09724099
097250                      ' TRIP:'             PV-DISP-TRIP           09725013
097260                      ' DR:'               SU054-DOOR-NUMBER      09726013
097270                      ' USR:'              SU054-USER-ID          09727013
097280                      ' STA:'              PV-DISP-PNA-STA        09728013
097290                      ' SQL:'              PV-DISP-SQLCODE        09729013
097300                      ' TSULBXF'                                  09730013
097310                                           DELIMITED BY SIZE      09731013
097320                                      INTO PV-CICS-MSG-AREA2      09732013
097330                                                                  09733013
097340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09734013
097350              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09735013
097360                                                                  09736013
097370              PERFORM 9999-WRITE-TO-CSSL                          09737013
097380                                                                  09738013
097390              INITIALIZE PV-CICS-MSG-AREA3                        09739013
097400              MOVE DK-CTN                TO PV-DISP-SSCC          09740013
097410              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09741013
097420              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09742013
097430                                                                  09743013
097440              STRING  'SUKCS782 '                                 09744099
097450                      ' SSCC:'             PV-DISP-SSCC           09745013
097460                                           DELIMITED BY SIZE      09746013
097470                                      INTO PV-CICS-MSG-AREA3      09747013
097480                                                                  09748013
097490              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09749013
097500              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09750013
097510                                                                  09751013
097520              PERFORM 9999-WRITE-TO-CSSL                          09752013
097530                                                                  09753013
097540              SET PS-PROCESSING-ERROR-YES TO TRUE                 09754013
097550              PERFORM 9998-WRITE-TO-CSSL                          09755013
097560      END-EVALUATE.                                               09756013
097570                                                                  09757013
097580**********************************************************        09758013
097590 3700-PRINT-VIRTUAL-LABELS.                                       09759013
097600**********************************************************        09760013
097610*                                                                 09761013
097620** added internal table to track paragraph execution time         09762013
097630** dmh 2014-12-22 - begin                                         09763013
097640*                                                                 09764013
097650     MOVE  '3700'  TO  PT-CURR-PARA.                              09765013
097660     IF  PS-BLD-INTERNAL-TABLE-YES                                09766013
097670         PERFORM 0200-INTERNAL-TABLE                              09767013
097680     ELSE                                                         09768013
097690         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09769013
097700     END-IF.                                                      09770013
097710                                                                  09771013
097720** DMH 2014-12-22 - END                                           09772013
097730*                                                                 09773013
097740                                                                  09774013
097750                                                                  09775013
097760     EVALUATE TRUE                                                09776013
097770         WHEN LBVRDA-INPK-CNVYB-IND = 'N'                         09777013
097780            PERFORM 5000-PRINT-LABEL                              09778013
097790                                                                  09779013
097800         WHEN LBVRDA-INPK-CNVYB-IND = 'Y'                         09780013
097810***print and apply can only print and apply one label at at time  09781013
097820***if casepack downloaded as inpk cnvy do not consume vrtl labels 09782013
097830***and send message label                                         09783013
097840            SET PS-INPK-AUD-INLINE-NO TO TRUE                     09784013
097850*           PERFORM 5000-PRINT-LABEL                              09785013
097860                                                                  09786013
097870*           PERFORM 3710-OPEN-INPK-CSR                            09787013
097880*           PERFORM 3720-FETCH-INPK-CSR                           09788013
097890                                                                  09789013
097900*           PERFORM UNTIL PS-END-OF-VRTL-LBL-CSR                  09790013
097910*              IF PS-PRINT-AUDIT-LABEL                            09791013
097920*                 CONTINUE                                        09792013
097930*              ELSE                                               09793013
097940***                                                               09794013
097950* the call to interface labor data occurs in the 5000-print para  09795013
097960* set PS-NO-CARTON-SML-CREATED so the call will occur             09796013
097970* only once for each vend carton, even if inpk conveyables exist  09797013
097980***                                                               09798013
097990                  SET PS-NO-CARTON-SML-CREATED TO TRUE            09799013
098000*                 PERFORM 5000-PRINT-LABEL                        09800013
098010*              END-IF                                             09801013
098020*               PERFORM 3720-FETCH-INPK-CSR                       09802013
098030*           END-PERFORM                                           09803013
098040*           PERFORM 3735-CONSUME-INPK-ROWS                        09804013
098050*           PERFORM 3730-CLOSE-INPK-CSR                           09805013
098060     END-EVALUATE.                                                09806013
098070                                                                  09807013
098080                                                                  09808013
098090*----------------------------------------------------------------*09809013
098100* OPEN THE VIRTUAL LABEL PRINT CURSOR                            *09810013
098110*----------------------------------------------------------------*09811013
098120                                                                  09812013
098130 3710-OPEN-INPK-CSR.                                              09813013
098140*                                                                 09814013
098150** added internal table to track paragraph execution time         09815013
098160** dmh 2014-12-22 - begin                                         09816013
098170*                                                                 09817013
098180     MOVE  '3710'  TO  PT-CURR-PARA.                              09818013
098190     IF  PS-BLD-INTERNAL-TABLE-YES                                09819013
098200         PERFORM 0200-INTERNAL-TABLE                              09820013
098210     ELSE                                                         09821013
098220         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09822013
098230     END-IF.                                                      09823013
098240                                                                  09824013
098250*                                                                 09825013
098260** DMH 2014-12-22 - END                                           09826013
098270*                                                                 09827013
098280     PERFORM                                                      09828013
098290         WITH TEST AFTER                                          09829013
098300         VARYING PV-RETRY-COUNTER                                 09830013
098310         FROM 1 BY 1                                              09831013
098320         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09832013
098330                   OR (SQLCODE = ZERO))                           09833013
098340                 EXEC SQL                                         09834013
098350                      OPEN VRTL-LBL-PRT-CSR                       09835013
098360                 END-EXEC                                         09836013
098370                                                                  09837013
098380                                                                  09838013
098390         EVALUATE TRUE                                            09839013
098400             WHEN SQLCODE = ZERO                                  09840013
098410             WHEN SQLCODE = -904                                  09841013
098420             WHEN SQLCODE = -913                                  09842013
098430                 CONTINUE                                         09843013
098440             WHEN SQLWARN0 NOT = SPACES                           09844013
098450             WHEN SQLCODE < ZERO                                  09845013
098460             WHEN SQLCODE > ZERO                                  09846013
098470                                                                  09847013
098480              INITIALIZE PV-CICS-MSG-AREA1                        09848013
098490              INITIALIZE PV-CICS-MSG-AREA2                        09849013
098500                                                                  09850013
098510              MOVE SQLCODE              TO PV-DISP-SQLCODE        09851013
098520              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09852013
098530              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09853013
098540              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09854013
098550                                                                  09855013
098560              STRING  'SUKCS782 3710-'                            09856099
098570                      ' DC:'               PV-DISP-DC             09857013
098580                      ' B1:'               SU054-BAR-CODE-1       09858013
098590                      ' B2:'               SU054-BAR-CODE-2       09859013
098600                      ' B3:'               SU054-BAR-CODE-3       09860013
098610                                           DELIMITED BY SIZE      09861013
098620                                      INTO PV-CICS-MSG-AREA1      09862013
098630                                                                  09863013
098640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09864013
098650              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09865013
098660                                                                  09866013
098670              PERFORM 9999-WRITE-TO-CSSL                          09867013
098680                                                                  09868013
098690              STRING  'SUKCS782 '          SU054-KOHLS-SML        09869099
098700                      ' TRIP:'             PV-DISP-TRIP           09870013
098710                      ' DR:'               SU054-DOOR-NUMBER      09871013
098720                      ' USR:'              SU054-USER-ID          09872013
098730                      ' STA:'              PV-DISP-PNA-STA        09873013
098740                      ' SQL:'              PV-DISP-SQLCODE        09874013
098750                      ' TLBVRDA'                                  09875013
098760                                           DELIMITED BY SIZE      09876013
098770                                      INTO PV-CICS-MSG-AREA2      09877013
098780                                                                  09878013
098790              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09879013
098800              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09880013
098810                                                                  09881013
098820              PERFORM 9999-WRITE-TO-CSSL                          09882013
098830                                                                  09883013
098840              INITIALIZE PV-CICS-MSG-AREA3                        09884013
098850              MOVE DK-PO                 TO PV-DISP-PO            09885013
098860              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09886013
098870              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09887013
098880              MOVE DK-PREPK-ID           TO PV-DISP-PREPK         09888013
098890              MOVE DK-OUTER-QTY          TO PV-DISP-otpk          09889013
098900              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      09890013
098910                                                                  09891013
098920              STRING  'SUKCS782 '                                 09892099
098930                      ' OPEN VRTL-LBL-PRT-CSR '                   09893013
098940                      ' '                  PV-DISP-PO             09894013
098950                      '-'                  PV-DISP-RCVR           09895013
098960                      '-'                  PV-DISP-LINE           09896013
098970                      '-'                  PV-DISP-PREPK          09897013
098980                      ' OUTER:'            PV-DISP-otpk           09898013
098990                      ' LBL-SEQ:'          PV-DISP-LBL-SEQ        09899013
099000                                           DELIMITED BY SIZE      09900013
099010                                      INTO PV-CICS-MSG-AREA3      09901013
099020                                                                  09902013
099030              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09903013
099040              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09904013
099050                                                                  09905013
099060              PERFORM 9999-WRITE-TO-CSSL                          09906013
099070                                                                  09907013
099080                 SET PS-PROCESSING-ERROR-YES TO TRUE              09908013
099090                 PERFORM 9998-WRITE-TO-CSSL                       09909013
099100         END-EVALUATE                                             09910013
099110     END-PERFORM.                                                 09911013
099120                                                                  09912013
099130     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09913013
099140         SQLCODE NOT = ZERO                                       09914013
099150                                                                  09915013
099160              INITIALIZE PV-CICS-MSG-AREA1                        09916013
099170              INITIALIZE PV-CICS-MSG-AREA2                        09917013
099180                                                                  09918013
099190              MOVE SQLCODE              TO PV-DISP-SQLCODE        09919013
099200              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             09920013
099210              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           09921013
099220              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        09922013
099230                                                                  09923013
099240              STRING  'SUKCS782 3710-'                            09924099
099250                      ' DC:'               PV-DISP-DC             09925013
099260                      ' B1:'               SU054-BAR-CODE-1       09926013
099270                      ' B2:'               SU054-BAR-CODE-2       09927013
099280                      ' B3:'               SU054-BAR-CODE-3       09928013
099290                                           DELIMITED BY SIZE      09929013
099300                                      INTO PV-CICS-MSG-AREA1      09930013
099310                                                                  09931013
099320              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09932013
099330              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     09933013
099340                                                                  09934013
099350              PERFORM 9999-WRITE-TO-CSSL                          09935013
099360                                                                  09936013
099370              STRING  'SUKCS782 '          SU054-KOHLS-SML        09937099
099380                      ' TRIP:'             PV-DISP-TRIP           09938013
099390                      ' DR:'               SU054-DOOR-NUMBER      09939013
099400                      ' USR:'              SU054-USER-ID          09940013
099410                      ' STA:'              PV-DISP-PNA-STA        09941013
099420                      ' SQL:'              PV-DISP-SQLCODE        09942013
099430                      ' TLBVRDA-MAX RETRIES'                      09943013
099440                                           DELIMITED BY SIZE      09944013
099450                                      INTO PV-CICS-MSG-AREA2      09945013
099460                                                                  09946013
099470              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09947013
099480              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     09948013
099490                                                                  09949013
099500              PERFORM 9999-WRITE-TO-CSSL                          09950013
099510                                                                  09951013
099520              INITIALIZE PV-CICS-MSG-AREA3                        09952013
099530              MOVE DK-PO                 TO PV-DISP-PO            09953013
099540              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          09954013
099550              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          09955013
099560              MOVE DK-PREPK-ID           TO PV-DISP-PREPK         09956013
099570              MOVE DK-OUTER-QTY          TO PV-DISP-otpk          09957013
099580              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      09958013
099590                                                                  09959013
099600              STRING  'SUKCS782 '                                 09960099
099610                      ' OPEN VRTL-LBL-PRT-CSR '                   09961013
099620                      ' '                  PV-DISP-PO             09962013
099630                      '-'                  PV-DISP-RCVR           09963013
099640                      '-'                  PV-DISP-LINE           09964013
099650                      '-'                  PV-DISP-PREPK          09965013
099660                      ' OUTER:'            PV-DISP-otpk           09966013
099670                      ' LBL-SEQ:'          PV-DISP-LBL-SEQ        09967013
099680                                           DELIMITED BY SIZE      09968013
099690                                      INTO PV-CICS-MSG-AREA3      09969013
099700                                                                  09970013
099710              MOVE SPACES               TO PV-CICS-MSG-AREA-A     09971013
099720              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     09972013
099730                                                                  09973013
099740              PERFORM 9999-WRITE-TO-CSSL                          09974013
099750                                                                  09975013
099760         SET PS-PROCESSING-ERROR-YES TO TRUE                      09976013
099770         PERFORM 9998-WRITE-TO-CSSL                               09977013
099780     END-IF.                                                      09978013
099790                                                                  09979013
099800 EJECT                                                            09980013
099810******************************************************************09981013
099820 3720-FETCH-INPK-CSR.                                             09982013
099830*                                                                 09983013
099840** added internal table to track paragraph execution time         09984013
099850** dmh 2014-12-22 - begin                                         09985013
099860*                                                                 09986013
099870     MOVE  '3720'  TO  PT-CURR-PARA.                              09987013
099880     IF  PS-BLD-INTERNAL-TABLE-YES                                09988013
099890         PERFORM 0200-INTERNAL-TABLE                              09989013
099900     ELSE                                                         09990013
099910         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       09991013
099920     END-IF.                                                      09992013
099930                                                                  09993013
099940*                                                                 09994013
099950** DMH 2014-12-22 - END                                           09995013
099960*                                                                 09996013
099970                                                                  09997013
099980      EXEC SQL                                                    09998013
099990        FETCH VRTL-LBL-PRT-CSR                                    09999013
100000        INTO     :LBVRDA-CART-LBL-TYP-CDE                         10000013
100010                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       10001013
100020                ,:LBVRDA-INPK-UNT-QTY                             10002013
100030                ,:LBVRDA-PREPK-RATO-QTY                           10003013
100040                ,:LBVRDA-DEST-OPER-UNT-ID                         10004013
100050                ,:LBVRDA-CSE-PK-QTY                               10005013
100060                ,:LBVRDA-ODD-CART-IND                             10006013
100070                ,:LBVRDA-INPK-CNVYB-IND                           10007013
100080                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       10008013
100090                ,:LBVRDA-LBL-TYP-TOT-QTY                          10009013
100100                ,:LBVRDA-BRCDE-NBR                                10010013
100110                ,:LBVRDA-STR-ZN-ID                                10011013
100120                ,:LBVRDA-MODU-DESC                                10012013
100130                ,:LBVRDA-ITM-NBR                                  10013013
100140                ,:LBVRDA-DEPT-DESC                                10014013
100150                ,:LBVRDA-MAJ-CL-DESC                              10015013
100160                ,:LBVRDA-SEASET-NM                                10016013
100170                ,:LBVRDA-FIXT-ID                                  10017013
100180                ,:LBVRDA-LBL-TYP-CDE                              10018013
100190                ,:LBVRDA-PRNT-CART-SEQ-ID                         10019013
100200                ,:LBVRDA-STRG-AREA-CDE                            10020013
100210                ,:LBVRDA-OTPK-UNT-QTY                             10021013
100220                ,:LBVRDA-EAS-TAG-IND                              10022013
100230                ,:LBVRDA-DOOR-ID                                  10023013
100240                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         10024013
100250*CLP 06/24/2105 START                                             10025013
100260                ,:LBVRDA-LBL-MSG-TXT                              10026013
100270*CLP 06/24/2105 END                                               10027013
100280         END-EXEC                                                 10028013
100290                                                                  10029013
100300     EVALUATE TRUE                                                10030013
100310         WHEN SQLCODE = ZERO                                      10031013
100320              MOVE  LBVRDA-BRCDE-NBR TO DK-BARCODE-NBR            10032013
100330              MOVE  LBVRDA-CART-LBL-TYP-CDE TO                    10033013
100340                                        DK-CART-LBL-TYP-CDE       10034013
100350              MOVE  LBVRDA-DEST-OPER-UNT-ID  TO                   10035013
100360                                        DK-DEST-OPER-UNT-ID       10036013
100370                                        PV-DEST-STORE             10037013
100380              MOVE LBVRDA-EAS-TAG-IND TO                          10038013
100390                                        PS-EAS-TAG-IND-FOUND-SW   10039013
100400              PERFORM 3570-POPULATE-CRTN-LBL-XREF                 10040013
100410              PERFORM 7210-GET-STORE-INFO                         10041013
100420         WHEN SQLCODE = +100                                      10042013
100430              SET PS-END-OF-VRTL-LBL-CSR TO TRUE                  10043013
100440         WHEN SQLWARN0 NOT = SPACE                                10044013
100450         WHEN SQLCODE NOT = ZERO                                  10045013
100460                                                                  10046013
100470              INITIALIZE PV-CICS-MSG-AREA1                        10047013
100480              INITIALIZE PV-CICS-MSG-AREA2                        10048013
100490                                                                  10049013
100500              MOVE SQLCODE              TO PV-DISP-SQLCODE        10050013
100510              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10051013
100520              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10052013
100530              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10053013
100540                                                                  10054013
100550              STRING  'SUKCS782 3720-'                            10055099
100560                      ' DC:'               PV-DISP-DC             10056013
100570                      ' B1:'               SU054-BAR-CODE-1       10057013
100580                      ' B2:'               SU054-BAR-CODE-2       10058013
100590                      ' B3:'               SU054-BAR-CODE-3       10059013
100600                                           DELIMITED BY SIZE      10060013
100610                                      INTO PV-CICS-MSG-AREA1      10061013
100620                                                                  10062013
100630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10063013
100640              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10064013
100650                                                                  10065013
100660              PERFORM 9999-WRITE-TO-CSSL                          10066013
100670                                                                  10067013
100680              STRING  'SUKCS782 '          SU054-KOHLS-SML        10068099
100690                      ' TRIP:'             PV-DISP-TRIP           10069013
100700                      ' DR:'               SU054-DOOR-NUMBER      10070013
100710                      ' USR:'              SU054-USER-ID          10071013
100720                      ' STA:'              PV-DISP-PNA-STA        10072013
100730                      ' SQL:'              PV-DISP-SQLCODE        10073013
100740                      ' TLBVRDA'                                  10074013
100750                                           DELIMITED BY SIZE      10075013
100760                                      INTO PV-CICS-MSG-AREA2      10076013
100770                                                                  10077013
100780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10078013
100790              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10079013
100800                                                                  10080013
100810              PERFORM 9999-WRITE-TO-CSSL                          10081013
100820                                                                  10082013
100830              INITIALIZE PV-CICS-MSG-AREA3                        10083013
100840              MOVE DK-PO                 TO PV-DISP-PO            10084013
100850              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          10085013
100860              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          10086013
100870              MOVE DK-PREPK-ID           TO PV-DISP-PREPK         10087013
100880              MOVE DK-OUTER-QTY          TO pv-disp-otpk          10088013
100890              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      10089013
100900                                                                  10090013
100910              STRING  'SUKCS782 '                                 10091099
100920                      ' FETCH VRTL-LBL-PRT-CSR '                  10092013
100930                      ' '                  PV-DISP-PO             10093013
100940                      '-'                  PV-DISP-RCVR           10094013
100950                      '-'                  PV-DISP-LINE           10095013
100960                      '-'                  PV-DISP-PREPK          10096013
100970                      ' OUTER:'            pv-disp-otpk           10097013
100980                      ' LBL-SEQ:'          PV-DISP-LBL-SEQ        10098013
100990                                           DELIMITED BY SIZE      10099013
101000                                      INTO PV-CICS-MSG-AREA3      10100013
101010                                                                  10101013
101020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10102013
101030              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10103013
101040                                                                  10104013
101050              PERFORM 9999-WRITE-TO-CSSL                          10105013
101060                                                                  10106013
101070              SET PS-PROCESSING-ERROR-YES TO TRUE                 10107013
101080              PERFORM 9998-WRITE-TO-CSSL                          10108013
101090     END-EVALUATE.                                                10109013
101100******************************************************************10110013
101110*  CLOSE VIRTUAL LABEL PRINT CURSOR                            * *10111013
101120******************************************************************10112013
101130 3730-CLOSE-INPK-CSR.                                             10113013
101140*                                                                 10114013
101150** added internal table to track paragraph execution time         10115013
101160** dmh 2014-12-22 - begin                                         10116013
101170*                                                                 10117013
101180     MOVE  '3730'  TO  PT-CURR-PARA.                              10118013
101190     IF  PS-BLD-INTERNAL-TABLE-YES                                10119013
101200         PERFORM 0200-INTERNAL-TABLE                              10120013
101210     ELSE                                                         10121013
101220         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       10122013
101230     END-IF.                                                      10123013
101240                                                                  10124013
101250*                                                                 10125013
101260** DMH 2014-12-22 - END                                           10126013
101270*                                                                 10127013
101280         EXEC SQL                                                 10128013
101290             CLOSE VRTL-LBL-PRT-CSR                               10129013
101300         END-EXEC                                                 10130013
101310                                                                  10131013
101320     EVALUATE TRUE                                                10132013
101330         WHEN SQLCODE = ZERO                                      10133013
101340             CONTINUE                                             10134013
101350         WHEN SQLWARN0 NOT = SPACES                               10135013
101360         WHEN SQLCODE < ZERO                                      10136013
101370         WHEN SQLCODE > ZERO                                      10137013
101380                                                                  10138013
101390              INITIALIZE PV-CICS-MSG-AREA1                        10139013
101400              INITIALIZE PV-CICS-MSG-AREA2                        10140013
101410                                                                  10141013
101420              MOVE SQLCODE              TO PV-DISP-SQLCODE        10142013
101430              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10143013
101440              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10144013
101450              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10145013
101460                                                                  10146013
101470              STRING  'SUKCS782 3730-'                            10147099
101480                      ' DC:'               PV-DISP-DC             10148013
101490                      ' B1:'               SU054-BAR-CODE-1       10149013
101500                      ' B2:'               SU054-BAR-CODE-2       10150013
101510                      ' B3:'               SU054-BAR-CODE-3       10151013
101520                                           DELIMITED BY SIZE      10152013
101530                                      INTO PV-CICS-MSG-AREA1      10153013
101540                                                                  10154013
101550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10155013
101560              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10156013
101570                                                                  10157013
101580              PERFORM 9999-WRITE-TO-CSSL                          10158013
101590                                                                  10159013
101600              STRING  'SUKCS782 '          SU054-KOHLS-SML        10160099
101610                      ' TRIP:'             PV-DISP-TRIP           10161013
101620                      ' DR:'               SU054-DOOR-NUMBER      10162013
101630                      ' USR:'              SU054-USER-ID          10163013
101640                      ' STA:'              PV-DISP-PNA-STA        10164013
101650                      ' SQL:'              PV-DISP-SQLCODE        10165013
101660                      ' TLBVRDA'                                  10166013
101670                                           DELIMITED BY SIZE      10167013
101680                                      INTO PV-CICS-MSG-AREA2      10168013
101690                                                                  10169013
101700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10170013
101710              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10171013
101720                                                                  10172013
101730              PERFORM 9999-WRITE-TO-CSSL                          10173013
101740                                                                  10174013
101750              INITIALIZE PV-CICS-MSG-AREA3                        10175013
101760              MOVE DK-PO                 TO PV-DISP-PO            10176013
101770              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          10177013
101780              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          10178013
101790              MOVE DK-PREPK-ID           TO PV-DISP-PREPK         10179013
101800              MOVE DK-OUTER-QTY          TO pv-disp-otpk          10180013
101810              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      10181013
101820                                                                  10182013
101830              STRING  'SUKCS782 '                                 10183099
101840                      ' CLOSE VRTL-LBL-PRT-CSR '                  10184013
101850                      ' '                  PV-DISP-PO             10185013
101860                      '-'                  PV-DISP-RCVR           10186013
101870                      '-'                  PV-DISP-LINE           10187013
101880                      '-'                  PV-DISP-PREPK          10188013
101890                      ' OUTER:'            pv-disp-otpk           10189013
101900                      ' LBL-SEQ:'          PV-DISP-LBL-SEQ        10190013
101910                                           DELIMITED BY SIZE      10191013
101920                                      INTO PV-CICS-MSG-AREA3      10192013
101930                                                                  10193013
101940              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10194013
101950              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10195013
101960                                                                  10196013
101970              PERFORM 9999-WRITE-TO-CSSL                          10197013
101980                                                                  10198013
101990             SET PS-PROCESSING-ERROR-YES TO TRUE                  10199013
102000             PERFORM 9998-WRITE-TO-CSSL                           10200013
102010     END-EVALUATE.                                                10201013
102020                                                                  10202013
102030******************************************************************10203013
102040*  UPDATE ALL THE INNER PACK VIRTUAL ROWS TO CONSUMED          * *10204013
102050******************************************************************10205013
102060 3735-CONSUME-INPK-ROWS.                                          10206013
102070*                                                                 10207013
102080** added internal table to track paragraph execution time         10208013
102090** dmh 2014-12-22 - begin                                         10209013
102100*                                                                 10210013
102110     MOVE  '3735'  TO  PT-CURR-PARA.                              10211013
102120     IF  PS-BLD-INTERNAL-TABLE-YES                                10212013
102130         PERFORM 0200-INTERNAL-TABLE                              10213013
102140     ELSE                                                         10214013
102150         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       10215013
102160     END-IF.                                                      10216013
102170                                                                  10217013
102180*                                                                 10218013
102190** DMH 2014-12-22 - END                                           10219013
102200*                                                                 10220013
102210                                                                  10221013
102220     EXEC SQL                                                     10222013
102230        UPDATE TLBVRDA                                            10223013
102240          SET  LBL_ASG_IND           =   'Y'                      10224013
102250        WHERE  PO_NBR                =   :DK-PO                   10225013
102260          AND  RCVR_SEQ_NBR          =   :DK-REC-SEQ-NBR          10226013
102270          AND  PO_LNE_NBR            =   :DK-PO-LNE-NBR           10227013
102280          AND  PREPK_ID              =   :DK-PREPK-ID             10228013
102290          AND  OTPK_UNT_QTY          =   :DK-OUTER-QTY            10229013
102300          AND  LBL_ASG_IND           =   'N'                      10230013
102310          AND  PRNT_CART_SEQ_ID      =   :LBVRDA-LBL-ASG-SEQ-NBR  10231013
102320     END-EXEC                                                     10232013
102330                                                                  10233013
102340     EVALUATE TRUE                                                10234013
102350         WHEN SQLCODE = ZERO                                      10235013
102360             CONTINUE                                             10236013
102370         WHEN SQLWARN0 NOT = SPACES                               10237013
102380         WHEN SQLCODE < ZERO                                      10238013
102390         WHEN SQLCODE > ZERO                                      10239013
102400                                                                  10240013
102410              INITIALIZE PV-CICS-MSG-AREA1                        10241013
102420              INITIALIZE PV-CICS-MSG-AREA2                        10242013
102430                                                                  10243013
102440              MOVE SQLCODE              TO PV-DISP-SQLCODE        10244013
102450              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10245013
102460              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10246013
102470              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10247013
102480                                                                  10248013
102490              STRING  'SUKCS782 3735-'                            10249099
102500                      ' DC:'               PV-DISP-DC             10250013
102510                      ' B1:'               SU054-BAR-CODE-1       10251013
102520                      ' B2:'               SU054-BAR-CODE-2       10252013
102530                      ' B3:'               SU054-BAR-CODE-3       10253013
102540                                           DELIMITED BY SIZE      10254013
102550                                      INTO PV-CICS-MSG-AREA1      10255013
102560                                                                  10256013
102570              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10257013
102580              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10258013
102590                                                                  10259013
102600              PERFORM 9999-WRITE-TO-CSSL                          10260013
102610                                                                  10261013
102620              STRING  'SUKCS782 '          SU054-KOHLS-SML        10262099
102630                      ' TRIP:'             PV-DISP-TRIP           10263013
102640                      ' DR:'               SU054-DOOR-NUMBER      10264013
102650                      ' USR:'              SU054-USER-ID          10265013
102660                      ' STA:'              PV-DISP-PNA-STA        10266013
102670                      ' SQL:'              PV-DISP-SQLCODE        10267013
102680                      ' TLBVRDA'                                  10268013
102690                                           DELIMITED BY SIZE      10269013
102700                                      INTO PV-CICS-MSG-AREA2      10270013
102710                                                                  10271013
102720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10272013
102730              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10273013
102740                                                                  10274013
102750              PERFORM 9999-WRITE-TO-CSSL                          10275013
102760                                                                  10276013
102770              INITIALIZE PV-CICS-MSG-AREA3                        10277013
102780              MOVE DK-PO                 TO PV-DISP-PO            10278013
102790              MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR          10279013
102800              MOVE DK-PO-LNE-NBR         TO PV-DISP-LINE          10280013
102810              MOVE DK-PREPK-ID           TO PV-DISP-PREPK         10281013
102820              MOVE DK-OUTER-QTY          TO pv-disp-otpk          10282013
102830              MOVE LBVRDA-LBL-ASG-SEQ-NBR TO PV-DISP-LBL-SEQ      10283013
102840                                                                  10284013
102850              STRING  'SUKCS782 '                                 10285099
102860                      ' '                  PV-DISP-PO             10286013
102870                      '-'                  PV-DISP-RCVR           10287013
102880                      '-'                  PV-DISP-LINE           10288013
102890                      '-'                  PV-DISP-PREPK          10289013
102900                      ' OUTER:'            pv-disp-otpk           10290013
102910                      ' LBL-SEQ:'          PV-DISP-LBL-SEQ        10291013
102920                                           DELIMITED BY SIZE      10292013
102930                                      INTO PV-CICS-MSG-AREA3      10293013
102940                                                                  10294013
102950              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10295013
102960              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10296013
102970                                                                  10297013
102980              PERFORM 9999-WRITE-TO-CSSL                          10298013
102990                                                                  10299013
103000             SET PS-PROCESSING-ERROR-YES TO TRUE                  10300013
103010             PERFORM 9998-WRITE-TO-CSSL                           10301013
103020     END-EVALUATE.                                                10302013
103030                                                                  10303013
103040                                                                  10304013
103050*----------------------------------------------------------------*10305013
103060*  CHECK IF THERE ARE CS OR ECOMMERCE LOCATIONS USING             10306013
103070*  BLIND RECEIVING FOR RDM                                        10307013
103080*                                                                *10308013
103090*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *10309013
103100*----------------------------------------------------------------*10310013
103110 3800-CHECK-RDM-BLIND-RCVNG.                                      10311013
103120*                                                                 10312013
103130** added internal table to track paragraph execution time         10313013
103140** dmh 2014-12-22 - begin                                         10314013
103150*                                                                 10315013
103160     MOVE  '3800'  TO  PT-CURR-PARA.                              10316013
103170     IF  PS-BLD-INTERNAL-TABLE-YES                                10317013
103180         PERFORM 0200-INTERNAL-TABLE                              10318013
103190     ELSE                                                         10319013
103200         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       10320013
103210     END-IF.                                                      10321013
103220                                                                  10322013
103230*                                                                 10323013
103240** DMH 2014-12-22 - END                                           10324013
103250*                                                                 10325013
103260                                                                  10326013
103270     EXEC SQL                                                     10327013
103280          SELECT FUNC_END_TMST                                    10328013
103290          INTO  :KRPRPM-FUNC-END-TMST                             10329013
103300          FROM   TKRPRPM                                          10330013
103310          WHERE  SYS_PRC_FUNC_CDE  = 'RDMRCV'                     10331013
103320            AND  INTFC_SYS_CDE     = 'RDM'                        10332013
103330            AND  FUNC_PRC_STAT_CDE = 'AC'                         10333013
103340            AND  FUNC_TXT          = 'Y'                          10334013
103350            AND  LOC_ID            =  :LBVRDA-DEST-OPER-UNT-ID    10335013
103360           WITH UR                                                10336013
103370     END-EXEC.                                                    10337013
103380                                                                  10338013
103390                                                                  10339013
103400     EVALUATE TRUE                                                10340013
103410         WHEN SQLCODE = ZERO                                      10341013
103420             SET PS-BLND-RECV-SIMPL-LOC-FND TO TRUE               10342013
103430         WHEN SQLCODE = +100                                      10343013
103440             SET PS-BLND-RECV-SIMPL-LOC-NOT-FND TO TRUE           10344013
103450         WHEN SQLWARN0 NOT = SPACES                               10345013
103460         WHEN SQLCODE < ZERO                                      10346013
103470         WHEN SQLCODE > ZERO                                      10347013
103480                                                                  10348013
103490              INITIALIZE PV-CICS-MSG-AREA1                        10349013
103500              INITIALIZE PV-CICS-MSG-AREA2                        10350013
103510                                                                  10351013
103520              MOVE SQLCODE              TO PV-DISP-SQLCODE        10352013
103530              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10353013
103540              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10354013
103550              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10355013
103560                                                                  10356013
103570              STRING  'SUKCS782 3800-'                            10357099
103580                      ' DC:'               PV-DISP-DC             10358013
103590                      ' B1:'               SU054-BAR-CODE-1       10359013
103600                      ' B2:'               SU054-BAR-CODE-2       10360013
103610                      ' B3:'               SU054-BAR-CODE-3       10361013
103620                                           DELIMITED BY SIZE      10362013
103630                                      INTO PV-CICS-MSG-AREA1      10363013
103640                                                                  10364013
103650              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10365013
103660              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10366013
103670                                                                  10367013
103680              PERFORM 9999-WRITE-TO-CSSL                          10368013
103690                                                                  10369013
103700              STRING  'SUKCS782 '          SU054-KOHLS-SML        10370099
103710                      ' TRIP:'             PV-DISP-TRIP           10371013
103720                      ' DR:'               SU054-DOOR-NUMBER      10372013
103730                      ' USR:'              SU054-USER-ID          10373013
103740                      ' STA:'              PV-DISP-PNA-STA        10374013
103750                      ' SQL:'              PV-DISP-SQLCODE        10375013
103760                      ' TKRPRPM'                                  10376013
103770                                           DELIMITED BY SIZE      10377013
103780                                      INTO PV-CICS-MSG-AREA2      10378013
103790                                                                  10379013
103800              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10380013
103810              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10381013
103820                                                                  10382013
103830              PERFORM 9999-WRITE-TO-CSSL                          10383013
103840                                                                  10384013
103850              INITIALIZE PV-CICS-MSG-AREA3                        10385013
103860              MOVE LBVRDA-DEST-OPER-UNT-ID TO PV-DISP-OPER        10386013
103870                                                                  10387013
103880              STRING  'SUKCS782 '                                 10388099
103890                      ' OPER:'             PV-DISP-OPER           10389013
103900                      ' PARM:RDMRCV'                              10390013
103910                                           DELIMITED BY SIZE      10391013
103920                                      INTO PV-CICS-MSG-AREA3      10392013
103930                                                                  10393013
103940              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10394013
103950              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10395013
103960                                                                  10396013
103970              PERFORM 9999-WRITE-TO-CSSL                          10397013
103980                                                                  10398013
103990             SET PS-PROCESSING-ERROR-YES TO TRUE                  10399013
104000             PERFORM 9998-WRITE-TO-CSSL                           10400013
104010                                                                  10401013
104020     END-EVALUATE.                                                10402013
104030*----------------------------------------------------------------*10403013
104040*  CHECK IF THE PO FOR THE DC IS AUTOVE                           10404013
104050*----------------------------------------------------------------*10405013
104060 3805-CHECK-TKRPRPM-AUTOVE.                                       10406013
104070*                                                                 10407013
104080** added internal table to track paragraph execution time         10408013
104090** dmh 2014-12-22 - begin                                         10409013
104100*                                                                 10410013
104110     MOVE  '3805'  TO  PT-CURR-PARA.                              10411013
104120     IF  PS-BLD-INTERNAL-TABLE-YES                                10412013
104130         PERFORM 0200-INTERNAL-TABLE                              10413013
104140     ELSE                                                         10414013
104150         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       10415013
104160     END-IF.                                                      10416013
104170                                                                  10417013
104180*                                                                 10418013
104190** DMH 2014-12-22 - END                                           10419013
104200*                                                                 10420013
104210                                                                  10421013
104220     INITIALIZE RC040-FIELDS.                                     10422013
104230     MOVE PV-PO-NBR                TO RC040-PO-NBR                10423013
104240     MOVE PV-RCVR-SEQ-NBR          TO RC040-PO-RCVR               10424013
104250                                                                  10425013
104260     IF PV-RCVR-SEQ-NBR > 0                                       10426013
104270        SET RC040-RCVR-EXISTS         TO TRUE                     10427013
104280     ELSE                                                         10428013
104290        SET RC040-NO-RCVR-EXISTS      TO TRUE                     10429013
104300     END-IF                                                       10430013
104310                                                                  10431013
104320     IF ((SHPUNT-ORGN-OPER-UNT-ID = SU054-DC-NUMBER) OR           10432013
104330         (RECEIV-CURR-OPER-UNT-ID = SU054-DC-NUMBER))             10433013
104340             CONTINUE                                             10434013
104350     ELSE                                                         10435013
104360         IF PS-PACK-BY-STORE AND PS-INACTV-PBS-CARTON-NO          10436013
104370            SET RC040-CHCK-MSDIRCT-YES    TO TRUE                 10437013
104380         ELSE                                                     10438013
104390            SET RC040-CHCK-MSDIRCT-NO                             10439013
104400                RC040-PROCESS-MSDIRCT-NO  TO TRUE                 10440013
104410         END-IF                                                   10441013
104420     END-IF                                                       10442013
104430                                                                  10443013
104440     MOVE SU054-DC-NUMBER          TO RC040-SIGNON-LOCATION.      10444013
104450                                                                  10445013
104460     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  10446013
104470                                        RC040-COMMAREA            10447013
104480                                        RC040-FIELDS.             10448013
104490                                                                  10449013
104500     EVALUATE TRUE                                                10450013
104510         WHEN RC040-SUCCESSFUL                                    10451013
104520             IF RC040-AUTO-VE-YES                                 10452013
104530                SET PS-AUTO-VE-YES     TO TRUE                    10453013
104540             ELSE                                                 10454013
104550                SET PS-AUTO-VE-NO      TO TRUE                    10455013
104560             END-IF                                               10456013
104570         WHEN OTHER                                               10457013
104580                                                                  10458013
104590              INITIALIZE PV-CICS-MSG-AREA1                        10459013
104600              INITIALIZE PV-CICS-MSG-AREA2                        10460013
104610                                                                  10461013
104620              MOVE SQLCODE              TO PV-DISP-SQLCODE        10462013
104630              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10463013
104640              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10464013
104650              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10465013
104660                                                                  10466013
104670              STRING  'SUKCS782 3805-'                            10467099
104680                      ' DC:'               PV-DISP-DC             10468013
104690                      ' B1:'               SU054-BAR-CODE-1       10469013
104700                      ' B2:'               SU054-BAR-CODE-2       10470013
104710                      ' B3:'               SU054-BAR-CODE-3       10471013
104720                                           DELIMITED BY SIZE      10472013
104730                                      INTO PV-CICS-MSG-AREA1      10473013
104740                                                                  10474013
104750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10475013
104760              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10476013
104770                                                                  10477013
104780              PERFORM 9999-WRITE-TO-CSSL                          10478013
104790                                                                  10479013
104800              STRING  'SUKCS782 '          SU054-KOHLS-SML        10480099
104810                      ' TRIP:'             PV-DISP-TRIP           10481013
104820                      ' DR:'               SU054-DOOR-NUMBER      10482013
104830                      ' USR:'              SU054-USER-ID          10483013
104840                      ' STA:'              PV-DISP-PNA-STA        10484013
104850                      ' SQL:'              PV-DISP-SQLCODE        10485013
104860                      ' TKRPRPM'                                  10486013
104870                                           DELIMITED BY SIZE      10487013
104880                                      INTO PV-CICS-MSG-AREA2      10488013
104890                                                                  10489013
104900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10490013
104910              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10491013
104920                                                                  10492013
104930              PERFORM 9999-WRITE-TO-CSSL                          10493013
104940                                                                  10494013
104950              INITIALIZE PV-CICS-MSG-AREA3                        10495013
104960                                                                  10496013
104970              STRING  'SUKCS782 (RCKUT127)'                       10497099
104980                      ' CHECK AUTOVE'                             10498013
104990                      ' IND:'              RC040-SUCCESS-IND      10499013
105000                      ' MSG:'              RC040-CRA-RET-MSG      10500013
105010                      ' REQID:'            RC040-CRA-REQ-ID       10501013
105020                                           DELIMITED BY SIZE      10502013
105030                                      INTO PV-CICS-MSG-AREA3      10503013
105040                                                                  10504013
105050              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10505013
105060              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10506013
105070                                                                  10507013
105080              PERFORM 9999-WRITE-TO-CSSL                          10508013
105090                                                                  10509013
105100              INITIALIZE PV-CICS-MSG-AREA4                        10510013
105110                                                                  10511013
105120              STRING  'SUKCS782 (RCKUT127)'                       10512099
105130                      ' CHECK AUTOVE'                             10513013
105140                      ' SQLCA:'            RC040-SQLCA            10514013
105150                                           DELIMITED BY SIZE      10515013
105160                                      INTO PV-CICS-MSG-AREA4      10516013
105170                                                                  10517013
105180              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10518013
105190              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     10519013
105200                                                                  10520013
105210              PERFORM 9999-WRITE-TO-CSSL                          10521013
105220                                                                  10522013
105230              INITIALIZE PV-CICS-MSG-AREA5                        10523013
105240                                                                  10524013
105250              STRING  'SUKCS782 (RCKUT127)'                       10525099
105260                      ' SWITCHES:'                                10526013
105270                      ' AUTOVE:'     RC040-AUTO-VE-SW             10527013
105280                      ' 0 RCVR:'     RC040-ZERO-RCVR-SW           10528013
105290                      ' FCLTY:'      RC040-FACILITY-AUTOVE-SW     10529013
105300                      ' MOD:'        RC040-MODULE-EXECUTION-LEVEL 10530013
105310                      ' CK-MISD:'    RC040-CHECK-MISDRCT-PARM-SW  10531013
105320                      ' PRC-MISD:'   RC040-PROCESS-MSDIRCT-SW     10532013
105330                                     DELIMITED BY SIZE            10533013
105340                                INTO PV-CICS-MSG-AREA5            10534013
105350                                                                  10535013
105360              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10536013
105370              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     10537013
105380                                                                  10538013
105390              PERFORM 9999-WRITE-TO-CSSL                          10539013
105400                                                                  10540013
105410              INITIALIZE PV-CICS-MSG-AREA6                        10541013
105420              MOVE RC040-SIGNON-LOCATION  TO PV-DISP-OPER         10542013
105430              MOVE RC040-PO-NBR           TO PV-DISP-PO           10543013
105440              MOVE RC040-PO-RCVR          TO PV-DISP-RCVR         10544013
105450              MOVE RC040-DEPT             TO PV-DISP-DEPT         10545013
105460                                                                  10546013
105470              STRING  'SUKCS782 (RCKUT127)'                       10547099
105480                      ' '              PV-DISP-OPER               10548013
105490                      '-'              PV-DISP-PO                 10549013
105500                      '-'              PV-DISP-RCVR               10550013
105510                      ' DEPT:'         PV-DISP-DEPT               10551013
105520                      ' CALLING PGM:'  RC040-CALLING-PROGRAM      10552013
105530                      ' USER:'         RC040-USER-ID              10553013
105540                                     DELIMITED BY SIZE            10554013
105550                                INTO PV-CICS-MSG-AREA6            10555013
105560                                                                  10556013
105570              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10557013
105580              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     10558013
105590                                                                  10559013
105600              PERFORM 9999-WRITE-TO-CSSL                          10560013
105610                                                                  10561013
105620              SET PV-DONE-PROCESSING          TO TRUE             10562013
105630              SET PS-PROCESSING-ERROR-YES TO TRUE                 10563013
105640              PERFORM 9998-WRITE-TO-CSSL                          10564013
105650     END-EVALUATE.                                                10565013
105660                                                                  10566013
105670** slh - BEGIN - 05/08                                            10567013
105680*----------------------------------------------------------------*10568013
105690*                                                                *10569013
105700*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *10570013
105710*                     Added "FETCH FIRST 1 ROW" program is only  *10571013
105720*                     checking for existence of                  *10572013
105730*----------------------------------------------------------------*10573013
105740******************************************************************10574013
105750 3806-CHECK-FOR-REPURP.                                           10575013
105760*                                                                 10576013
105770** added internal table to track paragraph execution time         10577013
105780** dmh 2014-12-22 - begin                                         10578013
105790*                                                                 10579013
105800     MOVE  '3806'  TO  PT-CURR-PARA.                              10580013
105810     IF  PS-BLD-INTERNAL-TABLE-YES                                10581013
105820         PERFORM 0200-INTERNAL-TABLE                              10582013
105830     ELSE                                                         10583013
105840         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       10584013
105850     END-IF.                                                      10585013
105860                                                                  10586013
105870*                                                                 10587013
105880** DMH 2014-12-22 - END                                           10588013
105890*                                                                 10589013
105900                                                                  10590013
105910     MOVE RECEIV-OPER-UNT-ID      TO PV-OPER-UNT-ID.              10591013
105920     MOVE RECEIV-CURR-OPER-UNT-ID TO PV-CURR-OPER-UNT-ID.         10592013
105930                                                                  10593013
105940         EXEC SQL                                                 10594013
105950            SELECT   COUNT(*)                                     10595013
105960              INTO :PV-REPURP-COUNT                               10596013
105970              FROM                                                10597013
105980                    wST_INTGRTN_TYP  A                            10598013
105990                 ,  wST_ATTR_DEFN    B                            10599013
106000                 ,  WST_ATTR_ELEM    C                            10600013
106010                 ,  WST_ATTR_ELEM    D                            10601013
106020                 ,  WST_ATTR_ELEM    E                            10602013
106030                 ,  WST_ATTR_ELEM    F                            10603013
106040                 ,  WST_ATTR_ELEM    G                            10604013
106050              WHERE                                               10605013
106060                    A.INTGRTN_TYP_CDE   = 'EFCREPURP'             10606013
106070                AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE       10607013
106080                AND B.ATTR_DEFN_SEQ_NBR = 1                       10608013
106090                AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE       10609013
106100                AND C.ATTR_DEFN_SEQ_NBR = 1                       10610013
106110                AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE       10611013
106120                AND D.ATTR_DEFN_SEQ_NBR = 2                       10612013
106130                AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE       10613013
106140                AND E.ATTR_DEFN_SEQ_NBR = 3                       10614013
106150                AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE       10615013
106160                AND F.ATTR_DEFN_SEQ_NBR = 4                       10616013
106170                AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE       10617013
106180                AND G.ATTR_DEFN_SEQ_NBR = 5                       10618013
106190                AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR     10619013
106200                AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR     10620013
106210                AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR     10621013
106220                AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR     10622013
106230                AND C.ATTR_ELEM_NBR     = :PV-CURR-OPER-UNT-ID    10623013
106240                AND D.ATTR_ELEM_NBR     = :PV-OPER-UNT-ID         10624013
106250                AND E.ATTR_ELEM_TXT     = 'Y'                     10625013
106260                AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP       10626013
106270             AND G.ATTR_ELEM_TMST = '9999-09-09-23.59.59.999999'  10627013
106280            FETCH FIRST 1 ROW ONLY                                10628013
106290             WITH UR                                              10629013
106300         END-EXEC.                                                10630013
106310                                                                  10631013
106320***  C.ATTR_ELEM_NBR = 1 = DC NUMBER                              10632013
106330***  D.ATTR_ELEM_NBR = 2 = EFC NUMBER                             10633013
106340                                                                  10634013
106350***  WHEN 810 PROCESING FOR 870, CURR OPER = 810, OPER = 870      10635013
106360                                                                  10636013
106370         EVALUATE TRUE                                            10637013
106380             WHEN SQLCODE = +0                                    10638013
106390             WHEN SQLCODE = +100                                  10639013
106400                  continue                                        10640013
106410                                                                  10641013
106420             WHEN SQLCODE = -904                                  10642013
106430             WHEN SQLCODE = -913                                  10643013
106440                                                                  10644013
106450              INITIALIZE PV-CICS-MSG-AREA1                        10645013
106460              INITIALIZE PV-CICS-MSG-AREA2                        10646013
106470                                                                  10647013
106480              MOVE SQLCODE              TO PV-DISP-SQLCODE        10648013
106490              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10649013
106500              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10650013
106510              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10651013
106520                                                                  10652013
106530              STRING  ' SUKCS782 3806-'                           10653099
106540                      ' DC:'               PV-DISP-DC             10654013
106550                      ' B1:'               SU054-BAR-CODE-1       10655013
106560                      ' B2:'               SU054-BAR-CODE-2       10656013
106570                      ' B3:'               SU054-BAR-CODE-3       10657013
106580                                           DELIMITED BY SIZE      10658013
106590                                      INTO PV-CICS-MSG-AREA1      10659013
106600                                                                  10660013
106610              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10661013
106620              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10662013
106630                                                                  10663013
106640              PERFORM 9999-WRITE-TO-CSSL                          10664013
106650                                                                  10665013
106660              STRING  ' SUKCS782 '          SU054-KOHLS-SML       10666099
106670                      ' TRIP:'             PV-DISP-TRIP           10667013
106680                      ' DR:'               SU054-DOOR-NUMBER      10668013
106690                      ' USR:'              SU054-USER-ID          10669013
106700                      ' STA:'              PV-DISP-PNA-STA        10670013
106710                      ' SQL:'              PV-DISP-SQLCODE        10671013
106720                      ' WST_INTGRTN_TYP/WST_ATTR_DEFN/ELEM'       10672013
106730                                           DELIMITED BY SIZE      10673013
106740                                      INTO PV-CICS-MSG-AREA2      10674013
106750                                                                  10675013
106760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10676013
106770              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10677013
106780                                                                  10678013
106790              PERFORM 9999-WRITE-TO-CSSL                          10679013
106800                                                                  10680013
106810              INITIALIZE PV-CICS-MSG-AREA3                        10681013
106820              MOVE PV-OPER-UNT-ID       TO  PV-DISP-OPER          10682013
106830              MOVE PV-CURR-OPER-UNT-ID  TO  PV-DISP-CURR-OPER     10683013
106840                                                                  10684013
106850              STRING  ' SUKCS782 (RCKUT127)'                      10685099
106860                      ' PARM: EFCREPURP'                          10686013
106870                      ' OPER:'             PV-DISP-OPER           10687013
106880                      ' CURR:'             PV-DISP-CURR-OPER      10688013
106890                                           DELIMITED BY SIZE      10689013
106900                                      INTO PV-CICS-MSG-AREA3      10690013
106910                                                                  10691013
106920              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10692013
106930              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10693013
106940                                                                  10694013
106950              PERFORM 9999-WRITE-TO-CSSL                          10695013
106960                                                                  10696013
106970             WHEN SQLWARN0 NOT = SPACES                           10697013
106980             WHEN SQLCODE < +0                                    10698013
106990             WHEN SQLCODE > +0                                    10699013
107000                                                                  10700013
107010              INITIALIZE PV-CICS-MSG-AREA1                        10701013
107020              INITIALIZE PV-CICS-MSG-AREA2                        10702013
107030                                                                  10703013
107040              MOVE SQLCODE              TO PV-DISP-SQLCODE        10704013
107050              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10705013
107060              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10706013
107070              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10707013
107080                                                                  10708013
107090              STRING  'SUKCS782 3806-'                            10709099
107100                      ' DC:'               PV-DISP-DC             10710013
107110                      ' B1:'               SU054-BAR-CODE-1       10711013
107120                      ' B2:'               SU054-BAR-CODE-2       10712013
107130                      ' B3:'               SU054-BAR-CODE-3       10713013
107140                                           DELIMITED BY SIZE      10714013
107150                                      INTO PV-CICS-MSG-AREA1      10715013
107160                                                                  10716013
107170              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10717013
107180              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10718013
107190                                                                  10719013
107200              PERFORM 9999-WRITE-TO-CSSL                          10720013
107210                                                                  10721013
107220              STRING  'SUKCS782 '          SU054-KOHLS-SML        10722099
107230                      ' TRIP:'             PV-DISP-TRIP           10723013
107240                      ' DR:'               SU054-DOOR-NUMBER      10724013
107250                      ' USR:'              SU054-USER-ID          10725013
107260                      ' STA:'              PV-DISP-PNA-STA        10726013
107270                      ' SQL:'              PV-DISP-SQLCODE        10727013
107280                      ' WST_INTGRTN_TYP/WST_ATTR_DEFN/ELEM'       10728013
107290                                           DELIMITED BY SIZE      10729013
107300                                      INTO PV-CICS-MSG-AREA2      10730013
107310                                                                  10731013
107320              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10732013
107330              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10733013
107340                                                                  10734013
107350              PERFORM 9999-WRITE-TO-CSSL                          10735013
107360                                                                  10736013
107370              INITIALIZE PV-CICS-MSG-AREA3                        10737013
107380              MOVE PV-OPER-UNT-ID       TO  PV-DISP-OPER          10738013
107390              MOVE PV-CURR-OPER-UNT-ID  TO  PV-DISP-CURR-OPER     10739013
107400                                                                  10740013
107410              STRING  'SUKCS782 (RCKUT127)'                       10741099
107420                      ' PARM: EFCREPURP'                          10742013
107430                      ' OPER:'             PV-DISP-OPER           10743013
107440                      ' CURR:'             PV-DISP-CURR-OPER      10744013
107450                                           DELIMITED BY SIZE      10745013
107460                                      INTO PV-CICS-MSG-AREA3      10746013
107470                                                                  10747013
107480              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10748013
107490              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10749013
107500                                                                  10750013
107510              PERFORM 9999-WRITE-TO-CSSL                          10751013
107520                                                                  10752013
107530                SET PS-PROCESSING-ERROR-YES TO TRUE               10753013
107540                PERFORM 9998-WRITE-TO-CSSL                        10754013
107550         END-EVALUATE.                                            10755013
107560** slh end                                                        10756013
107570* 07/19/13 RLK BEG                                                10757013
107580*----------------------------------------------------------------*10758061
107590*  DETERMINE CARTON LABEL                                         10759061
107600*----------------------------------------------------------------*10760061
107610 3807-DETERMINE-CRTN-LBL.                                         10761061
107620                                                                  10762061
107630     IF SU093-PRINT-RFID                                          10763061
107640        PERFORM 3808-TKRPRPM-RFID-LBL-INFO                        10764061
107650     ELSE                                                         10765061
107660        IF SU093-PRINT-EAS                                        10766061
107670           PERFORM 3809-TKRPRPM-EAS-LBL-INFO                      10767061
107680        ELSE                                                      10768061
107690           PERFORM 3810-TKRPRPM-RFEACR-LBL-INFO                   10769061
107700        END-IF                                                    10770061
107710     END-IF.                                                      10771061
107720                                                                  10772061
107730*----------------------------------------------------------------*10773020
107740*  GET PARM THAT PROVIDES TEXT & DIVERT CODE FOR RFID CART LABELS 10774013
107750*                                                                *10775013
107760*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *10776013
107770*----------------------------------------------------------------*10777013
107780 3808-TKRPRPM-RFID-LBL-INFO.                                      10778013
107790*                                                                 10779013
107800** added internal table to track paragraph execution time         10780013
107810** dmh 2014-12-22 - begin                                         10781013
107820*                                                                 10782013
107830     MOVE  '3808'  TO  PT-CURR-PARA.                              10783013
107840     IF  PS-BLD-INTERNAL-TABLE-YES                                10784013
107850         PERFORM 0200-INTERNAL-TABLE                              10785013
107860     ELSE                                                         10786013
107870         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       10787013
107880     END-IF.                                                      10788013
107890                                                                  10789013
107900*                                                                 10790013
107910** DMH 2014-12-22 - END                                           10791013
107920*                                                                 10792013
107930                                                                  10793013
107940     EXEC SQL                                                     10794013
107950          SELECT FUNC_TXT                                         10795013
107960          INTO  :KRPRPM-FUNC-TXT                                  10796013
107970          FROM   TKRPRPM                                          10797013
107980          WHERE  SYS_PRC_FUNC_CDE  = 'RFDCRT'                     10798013
107990            AND  INTFC_SYS_CDE     = 'KHL'                        10799013
108000            AND  FUNC_PRC_STAT_CDE = 'AC'                         10800013
108010            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         10801013
108020           WITH UR                                                10802013
108030     END-EXEC.                                                    10803013
108040                                                                  10804013
108050                                                                  10805013
108060     EVALUATE TRUE                                                10806013
108070         WHEN SQLCODE = ZERO                                      10807013
108080             SET PS-LABEL-PARM-FOUND     TO TRUE                  10808061
108090                                                                  10809061
108100         WHEN SQLCODE = +100                                      10810013
108110             SET PS-LABEL-PARM-NOT-FOUND TO TRUE                  10811061
108120                                                                  10812061
108130         WHEN SQLWARN0 NOT = SPACES                               10813013
108140         WHEN SQLCODE < ZERO                                      10814013
108150         WHEN SQLCODE > ZERO                                      10815013
108160                                                                  10816013
108170              INITIALIZE PV-CICS-MSG-AREA1                        10817013
108180              INITIALIZE PV-CICS-MSG-AREA2                        10818013
108190                                                                  10819013
108200              MOVE SQLCODE              TO PV-DISP-SQLCODE        10820013
108210              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             10821013
108220              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           10822013
108230              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        10823013
108240                                                                  10824013
108250              STRING  'SUKCS782 3808-'                            10825099
108260                      ' DC:'               PV-DISP-DC             10826013
108270                      ' B1:'               SU054-BAR-CODE-1       10827013
108280                      ' B2:'               SU054-BAR-CODE-2       10828013
108290                      ' B3:'               SU054-BAR-CODE-3       10829013
108300                                           DELIMITED BY SIZE      10830013
108310                                      INTO PV-CICS-MSG-AREA1      10831013
108320                                                                  10832013
108330              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10833013
108340              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     10834013
108350                                                                  10835013
108360              PERFORM 9999-WRITE-TO-CSSL                          10836013
108370                                                                  10837013
108380              STRING  'SUKCS782 '          SU054-KOHLS-SML        10838099
108390                      ' TRIP:'             PV-DISP-TRIP           10839013
108400                      ' DR:'               SU054-DOOR-NUMBER      10840013
108410                      ' USR:'              SU054-USER-ID          10841013
108420                      ' STA:'              PV-DISP-PNA-STA        10842013
108430                      ' SQL:'              PV-DISP-SQLCODE        10843013
108440                      ' TKRPRPM'                                  10844013
108450                                           DELIMITED BY SIZE      10845013
108460                                      INTO PV-CICS-MSG-AREA2      10846013
108470                                                                  10847013
108480              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10848013
108490              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     10849013
108500                                                                  10850013
108510              PERFORM 9999-WRITE-TO-CSSL                          10851013
108520                                                                  10852013
108530              INITIALIZE PV-CICS-MSG-AREA3                        10853013
108540              MOVE LBPTDA-OPER-UNT-ID   TO  PV-DISP-OPER          10854013
108550                                                                  10855013
108560              STRING  'SUKCS782 '                                 10856099
108570                      ' PARM: RFDCRT'                             10857013
108580                      ' OPER:'             PV-DISP-OPER           10858013
108590                                           DELIMITED BY SIZE      10859013
108600                                      INTO PV-CICS-MSG-AREA3      10860013
108610                                                                  10861013
108620              MOVE SPACES               TO PV-CICS-MSG-AREA-A     10862013
108630              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     10863013
108640                                                                  10864013
108650              PERFORM 9999-WRITE-TO-CSSL                          10865013
108660                                                                  10866013
108670             MOVE '3808-TKRPRPM-RFID-LBL-INFO'                    10867013
108680                             TO DP013-PARAGRAPH                   10868013
108690             MOVE 'SUKCS782 - CHECK RFID'                         10869099
108700                             TO DP013-MESSAGE-TEXT(1)             10870013
108710             MOVE PV-DISP-OPER                                    10871013
108720                             TO DP013-MESSAGE-TEXT(2)             10872013
108730             MOVE SQLCA      TO DP013-SQLCA                       10873013
108740             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           10874013
108750             SET DP013-DB2-ABEND                                  10875013
108760                             TO TRUE                              10876013
108770             SET DP013-ROLLBACK                                   10877013
108780                             TO TRUE                              10878013
108790             SET DP013-XCTL-DISPLAY-RESTART                       10879013
108800                             TO TRUE                              10880013
108810                                                                  10881013
108820     END-EVALUATE.                                                10882013
108830                                                                  10883013
108840* 07/19/13 RLK END                                                10884013
108850*                                                                 10885013
108860*----------------------------------------------------------------*10886061
108870*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR EAS LABELS     10887061
108880*----------------------------------------------------------------*10888061
108890 3809-TKRPRPM-EAS-LBL-INFO.                                       10889061
108900                                                                  10890061
108910     EXEC SQL                                                     10891061
108920          SELECT FUNC_TXT                                         10892061
108930          INTO  :KRPRPM-FUNC-TXT                                  10893061
108940          FROM   TKRPRPM                                          10894061
108950          WHERE  SYS_PRC_FUNC_CDE  = 'EASCRT'                     10895061
108960            AND  INTFC_SYS_CDE     = 'KHL'                        10896061
108970            AND  FUNC_PRC_STAT_CDE = 'AC'                         10897061
108980            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         10898061
108990     END-EXEC.                                                    10899061
109000                                                                  10900061
109010     EVALUATE TRUE                                                10901061
109020         WHEN SQLCODE = ZERO                                      10902061
109030             SET PS-LABEL-PARM-FOUND     TO TRUE                  10903061
109040                                                                  10904061
109050         WHEN SQLCODE = +100                                      10905061
109060             SET PS-LABEL-PARM-NOT-FOUND TO TRUE                  10906061
109070                                                                  10907061
109080         WHEN SQLWARN0 NOT = SPACES                               10908061
109090         WHEN SQLCODE < ZERO                                      10909061
109100         WHEN SQLCODE > ZERO                                      10910061
109110             INITIALIZE PV-CICS-MSG-AREA1                         10911061
109120             INITIALIZE PV-CICS-MSG-AREA2                         10912061
109130                                                                  10913061
109140             MOVE SQLCODE              TO PV-DISP-SQLCODE         10914061
109150             MOVE SU054-DC-NUMBER      TO PV-DISP-DC              10915061
109160             MOVE SU054-TRIP-ID        TO PV-DISP-TRIP            10916061
109170             MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA         10917061
109180                                                                  10918061
109190             STRING  'SUKCS782 3809-'                             10919099
109200                     ' DC:'               PV-DISP-DC              10920061
109210                     ' B1:'               SU054-BAR-CODE-1        10921061
109220                     ' B2:'               SU054-BAR-CODE-2        10922061
109230                     ' B3:'               SU054-BAR-CODE-3        10923061
109240                                          DELIMITED BY SIZE       10924061
109250                                     INTO PV-CICS-MSG-AREA1       10925061
109260                                                                  10926061
109270             MOVE SPACES               TO PV-CICS-MSG-AREA-A      10927061
109280             MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A      10928061
109290                                                                  10929061
109300             PERFORM 9999-WRITE-TO-CSSL                           10930061
109310                                                                  10931061
109320             STRING  'SUKCS782 '          SU054-KOHLS-SML         10932099
109330                     ' TRIP:'             PV-DISP-TRIP            10933061
109340                     ' DR:'               SU054-DOOR-NUMBER       10934061
109350                     ' USR:'              SU054-USER-ID           10935061
109360                     ' STA:'              PV-DISP-PNA-STA         10936061
109370                     ' SQL:'              PV-DISP-SQLCODE         10937061
109380                     ' TKRPRPM'                                   10938061
109390                                          DELIMITED BY SIZE       10939061
109400                                     INTO PV-CICS-MSG-AREA2       10940061
109410                                                                  10941061
109420             MOVE SPACES               TO PV-CICS-MSG-AREA-A      10942061
109430             MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A      10943061
109440                                                                  10944061
109450             PERFORM 9999-WRITE-TO-CSSL                           10945061
109460                                                                  10946061
109470             INITIALIZE PV-CICS-MSG-AREA3                         10947061
109480             MOVE LBPTDA-OPER-UNT-ID   TO  PV-DISP-OPER           10948061
109490                                                                  10949061
109500             STRING  'SUKCS782 '                                  10950099
109510                     ' PARM: EASCRT'                              10951061
109520                     ' OPER:'             PV-DISP-OPER            10952061
109530                                          DELIMITED BY SIZE       10953061
109540                                     INTO PV-CICS-MSG-AREA3       10954061
109550                                                                  10955061
109560             MOVE SPACES               TO PV-CICS-MSG-AREA-A      10956061
109570             MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A      10957061
109580                                                                  10958061
109590             PERFORM 9999-WRITE-TO-CSSL                           10959061
109600                                                                  10960061
109610             MOVE '3809-TKRPRPM-EAS-LBL-INFO'                     10961061
109620                             TO DP013-PARAGRAPH                   10962061
109630             MOVE 'SUKCS782 - CHECK RFID'                         10963099
109640                             TO DP013-MESSAGE-TEXT(1)             10964061
109650             MOVE PV-DISP-OPER                                    10965061
109660                             TO DP013-MESSAGE-TEXT(2)             10966061
109670             MOVE SQLCA      TO DP013-SQLCA                       10967061
109680             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           10968061
109690             SET DP013-DB2-ABEND                                  10969061
109700                             TO TRUE                              10970061
109710             SET DP013-ROLLBACK                                   10971061
109720                             TO TRUE                              10972061
109730             SET DP013-XCTL-DISPLAY-RESTART                       10973061
109740                             TO TRUE                              10974061
109750     END-EVALUATE.                                                10975061
109760                                                                  10976061
109770*----------------------------------------------------------------*10977061
109780*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR RF & EAS LABELS10978061
109790*----------------------------------------------------------------*10979061
109800 3810-TKRPRPM-RFEACR-LBL-INFO.                                    10980061
109810                                                                  10981061
109820     EXEC SQL                                                     10982061
109830          SELECT FUNC_TXT                                         10983061
109840          INTO  :KRPRPM-FUNC-TXT                                  10984061
109850          FROM   TKRPRPM                                          10985061
109860          WHERE  SYS_PRC_FUNC_CDE  = 'RFEACR'                     10986061
109870            AND  INTFC_SYS_CDE     = 'KHL'                        10987061
109880            AND  FUNC_PRC_STAT_CDE = 'AC'                         10988061
109890            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         10989061
109900     END-EXEC.                                                    10990061
109910                                                                  10991061
109920     EVALUATE TRUE                                                10992061
109930         WHEN SQLCODE = ZERO                                      10993061
109940             SET PS-LABEL-PARM-FOUND     TO TRUE                  10994061
109950                                                                  10995061
109960         WHEN SQLCODE = +100                                      10996061
109970             SET PS-LABEL-PARM-NOT-FOUND TO TRUE                  10997061
109980                                                                  10998061
109990         WHEN SQLWARN0 NOT = SPACES                               10999061
110000         WHEN SQLCODE < ZERO                                      11000061
110010         WHEN SQLCODE > ZERO                                      11001061
110020             INITIALIZE PV-CICS-MSG-AREA1                         11002061
110030             INITIALIZE PV-CICS-MSG-AREA2                         11003061
110040                                                                  11004061
110050             MOVE SQLCODE              TO PV-DISP-SQLCODE         11005061
110060             MOVE SU054-DC-NUMBER      TO PV-DISP-DC              11006061
110070             MOVE SU054-TRIP-ID        TO PV-DISP-TRIP            11007061
110080             MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA         11008061
110090                                                                  11009061
110100             STRING  'SUKCS782 3810-'                             11010099
110110                     ' DC:'               PV-DISP-DC              11011061
110120                     ' B1:'               SU054-BAR-CODE-1        11012061
110130                     ' B2:'               SU054-BAR-CODE-2        11013061
110140                     ' B3:'               SU054-BAR-CODE-3        11014061
110150                                          DELIMITED BY SIZE       11015061
110160                                     INTO PV-CICS-MSG-AREA1       11016061
110170                                                                  11017061
110180             MOVE SPACES               TO PV-CICS-MSG-AREA-A      11018061
110190             MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A      11019061
110200                                                                  11020061
110210             PERFORM 9999-WRITE-TO-CSSL                           11021061
110220                                                                  11022061
110230             STRING  'SUKCS782 '          SU054-KOHLS-SML         11023099
110240                     ' TRIP:'             PV-DISP-TRIP            11024061
110250                     ' DR:'               SU054-DOOR-NUMBER       11025061
110260                     ' USR:'              SU054-USER-ID           11026061
110270                     ' STA:'              PV-DISP-PNA-STA         11027061
110280                     ' SQL:'              PV-DISP-SQLCODE         11028061
110290                     ' TKRPRPM'                                   11029061
110300                                          DELIMITED BY SIZE       11030061
110310                                     INTO PV-CICS-MSG-AREA2       11031061
110320                                                                  11032061
110330             MOVE SPACES               TO PV-CICS-MSG-AREA-A      11033061
110340             MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A      11034061
110350                                                                  11035061
110360             PERFORM 9999-WRITE-TO-CSSL                           11036061
110370                                                                  11037061
110380             INITIALIZE PV-CICS-MSG-AREA3                         11038061
110390             MOVE LBPTDA-OPER-UNT-ID   TO  PV-DISP-OPER           11039061
110400                                                                  11040061
110410             STRING  'SUKCS782 '                                  11041099
110420                     ' PARM: RFEACR'                              11042061
110430                     ' OPER:'             PV-DISP-OPER            11043061
110440                                          DELIMITED BY SIZE       11044061
110450                                     INTO PV-CICS-MSG-AREA3       11045061
110460                                                                  11046061
110470             MOVE SPACES               TO PV-CICS-MSG-AREA-A      11047061
110480             MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A      11048061
110490                                                                  11049061
110500             PERFORM 9999-WRITE-TO-CSSL                           11050061
110510                                                                  11051061
110520             MOVE '3810-TKRPRPM-RFEACR-LBL-INFO'                  11052061
110530                             TO DP013-PARAGRAPH                   11053061
110540             MOVE 'SUKCS782 - CHECK RFID'                         11054099
110550                             TO DP013-MESSAGE-TEXT(1)             11055061
110560             MOVE PV-DISP-OPER                                    11056061
110570                             TO DP013-MESSAGE-TEXT(2)             11057061
110580             MOVE SQLCA      TO DP013-SQLCA                       11058061
110590             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           11059061
110600             SET DP013-DB2-ABEND                                  11060061
110610                             TO TRUE                              11061061
110620             SET DP013-ROLLBACK                                   11062061
110630                             TO TRUE                              11063061
110640             SET DP013-XCTL-DISPLAY-RESTART                       11064061
110650                             TO TRUE                              11065061
110660     END-EVALUATE.                                                11066061
110670                                                                  11067061
110680*                                                                 11068020
110681                                                                  11068169
110682******************************************************************11068269
110683* THIS PARAGRAPH WILL CHECK PARM RFIDMS TO SEE IF THE LAST 4      11068369
110684* DIGITS OF THE MICRO SECONDS FROM A TIMESTAMP SHOULD BE          11068469
110685* POPULATED TO THE LAST 4 DIGITS OF THE RFID LABEL BARCODE OR IF  11068569
110686* WE JUST POPULATE ZEROS.                                         11068669
110687******************************************************************11068769
110688                                                                  11068869
110689 3812-LAST-4-OF-BARCODE-PARM.                                     11068969
110690                                                                  11069069
110691     EXEC SQL                                                     11069169
110692          SELECT FUNC_END_TMST                                    11069269
110693          INTO  :KRPRPM-FUNC-END-TMST                             11069369
110694          FROM   TKRPRPM                                          11069469
110695          WHERE  SYS_PRC_FUNC_CDE  = 'RFIDMS'                     11069569
110696            AND  INTFC_SYS_CDE     = 'KHL'                        11069669
110697            AND  FUNC_PRC_STAT_CDE = 'AC'                         11069769
110698            AND  FUNC_TXT          = 'Y'                          11069869
110699            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         11069969
110700     END-EXEC.                                                    11070069
110701                                                                  11070169
110702                                                                  11070269
110703     EVALUATE TRUE                                                11070369
110704         WHEN SQLCODE = ZERO                                      11070469
110705             SET PS-USE-LAST-4-FROM-TMST TO TRUE                  11070569
110706         WHEN SQLCODE = +100                                      11070669
110707             SET PS-USE-LAST-4-ZEROS TO TRUE                      11070769
110712         WHEN SQLWARN0 NOT = SPACES                               11071269
110713         WHEN SQLCODE NOT EQUAL ZERO                              11071369
110714                                                                  11071469
110715              INITIALIZE PV-CICS-MSG-AREA1                        11071569
110716              INITIALIZE PV-CICS-MSG-AREA2                        11071669
110717                                                                  11071769
110718              MOVE SQLCODE              TO PV-DISP-SQLCODE        11071869
110719              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             11071969
110720              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           11072069
110721              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        11072169
110722                                                                  11072269
110723              STRING  'SUKCS782 3812-'                            11072399
110724                      ' DC:'               PV-DISP-DC             11072469
110725                      ' B1:'               SU054-BAR-CODE-1       11072569
110726                      ' B2:'               SU054-BAR-CODE-2       11072669
110727                      ' B3:'               SU054-BAR-CODE-3       11072769
110728                                           DELIMITED BY SIZE      11072869
110729                                      INTO PV-CICS-MSG-AREA1      11072969
110730                                                                  11073069
110731              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11073169
110732              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     11073269
110733                                                                  11073369
110734              PERFORM 9999-WRITE-TO-CSSL                          11073469
110735                                                                  11073569
110736              STRING  'SUKCS782 '          SU054-KOHLS-SML        11073699
110737                      ' TRIP:'             PV-DISP-TRIP           11073769
110738                      ' DR:'               SU054-DOOR-NUMBER      11073869
110739                      ' USR:'              SU054-USER-ID          11073969
110740                      ' STA:'              PV-DISP-PNA-STA        11074069
110741                      ' SQL:'              PV-DISP-SQLCODE        11074169
110742                      ' TKRPRPM'                                  11074269
110743                                           DELIMITED BY SIZE      11074369
110744                                      INTO PV-CICS-MSG-AREA2      11074469
110745                                                                  11074569
110746              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11074669
110747              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     11074769
110748                                                                  11074869
110749              PERFORM 9999-WRITE-TO-CSSL                          11074969
110750                                                                  11075069
110751              INITIALIZE PV-CICS-MSG-AREA3                        11075169
110752              MOVE LBPTDA-OPER-UNT-ID       TO  PV-DISP-OPER      11075269
110753                                                                  11075369
110754              STRING  'SUKCS782 '                                 11075499
110755                      ' OPER:'         PV-DISP-OPER               11075569
110756                      ' PARM: RFIDMS'                             11075669
110757                                           DELIMITED BY SIZE      11075769
110758                                      INTO PV-CICS-MSG-AREA3      11075869
110759                                                                  11075969
110760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11076069
110761              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     11076169
110762                                                                  11076269
110763              PERFORM 9999-WRITE-TO-CSSL                          11076369
110764                                                                  11076469
110765             SET PS-PROCESSING-ERROR-YES TO TRUE                  11076569
110766             PERFORM 9998-WRITE-TO-CSSL                           11076669
110767     END-EVALUATE.                                                11076769
110768                                                                  11076869
110788 4250-LINK-TO-FRASTY-HANDLER.                                     11078820
110789*                                                                 11078920
110790** added internal table to track paragraph execution time         11079020
110791** dmh 2014-12-22 - begin                                         11079120
110792*                                                                 11079220
110793     MOVE  '4250'  TO  PT-CURR-PARA.                              11079320
110794     IF  PS-BLD-INTERNAL-TABLE-YES                                11079420
110795         PERFORM 0200-INTERNAL-TABLE                              11079520
110796     ELSE                                                         11079620
110797         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11079713
110798     END-IF.                                                      11079813
110800                                                                  11080013
110810*                                                                 11081013
110820** DMH 2014-12-22 - END                                           11082013
110830*                                                                 11083013
110840                                                                  11084013
110850*    INITIALIZE SU044-COMM-AREA.                                  11085013
110860     MOVE PV-CTN-N                 TO SU044-SHIPT-UNT-ID.         11086013
110870     MOVE PV-PO-NBR                TO SU044-PO.                   11087013
110880     MOVE PV-RCVR-SEQ-NBR          TO SU044-ORIG-REC-SEQ-NBR.     11088013
110890     MOVE SU054-DC-NUMBER          TO SU044-OPER-UNT-ID.          11089013
110900     MOVE +1                       TO SU044-FCLTY-ID.             11090013
110910     MOVE VHTRIP-OWNER-SCAC-ID     TO SU044-SCAC-ID.              11091013
110920     MOVE SU054-TRIP-ID            TO SU044-TRIP-ID.              11092013
110930     MOVE VHTRIP-VEH-NBR           TO SU044-VEH-NBR.              11093013
110940     MOVE SHPUNT-ORGN-OPER-UNT-ID  TO SU044-CRTN-OPER-UNT-ID.     11094013
110950     MOVE PC-CURRENT-PROGRAM-NAME  TO SU044-PROGRAM-NAME.         11095013
110960     MOVE SU054-USER-ID            TO SU044-SIGNON-USER-ID.       11096013
110970     SET  SU044-SRC-CHECKIN        TO TRUE.                       11097013
110980     IF PS-PACK-BY-STORE                                          11098013
110990        SET SU044-RCVR-PBS         TO TRUE                        11099013
111000        MOVE PV-DEST-STORE         TO SU044-DEST-STR-NBR          11100013
111010     ELSE                                                         11101013
111020        MOVE ZEROES                TO SU044-DEST-STR-NBR          11102013
111030        IF RECEIV-PKGNG-CDE  = PC-M OR PC-I                       11103013
111040           SET SU044-RCVR-PREPK    TO TRUE                        11104013
111050        ELSE                                                      11105013
111060           SET SU044-RCVR-BULK     TO TRUE                        11106013
111070        END-IF                                                    11107013
111080     END-IF                                                       11108013
111090                                                                  11109013
111100     MOVE lENGTH OF SU044-COMM-AREA TO  PV-COMMAREA-LENGTH.       11110013
111110                                                                  11111013
111120     EXEC CICS                                                    11112013
111130         LINK PROGRAM  (PC-FA-HANDLER-PGM)                        11113013
111140              COMMAREA (SU044-COMM-AREA)                          11114013
111150              LENGTH   (PV-COMMAREA-LENGTH)                       11115013
111160     END-EXEC.                                                    11116013
111170                                                                  11117013
111180     EVALUATE TRUE                                                11118013
111190         WHEN SU044-SUCCESSFUL                                    11119013
111200              CONTINUE                                            11120013
111210         WHEN OTHER                                               11121013
111220              SET PV-DONE-PROCESSING          TO TRUE             11122013
111230              MOVE SQLCODE              TO PV-SQLCODE             11123013
111240                                                                  11124013
111250              INITIALIZE PV-CICS-MSG-AREA1                        11125013
111260              INITIALIZE PV-CICS-MSG-AREA2                        11126013
111270                                                                  11127013
111280              MOVE SQLCODE              TO PV-DISP-SQLCODE        11128013
111290              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             11129013
111300              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           11130013
111310              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        11131013
111320                                                                  11132013
111330              STRING  'SUKCS782 4250-'                            11133099
111340                      ' DC:'               PV-DISP-DC             11134013
111350                      ' B1:'               SU054-BAR-CODE-1       11135013
111360                      ' B2:'               SU054-BAR-CODE-2       11136013
111370                      ' B3:'               SU054-BAR-CODE-3       11137013
111380                                           DELIMITED BY SIZE      11138013
111390                                      INTO PV-CICS-MSG-AREA1      11139013
111400                                                                  11140013
111410              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11141013
111420              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     11142013
111430                                                                  11143013
111440              PERFORM 9999-WRITE-TO-CSSL                          11144013
111450                                                                  11145013
111460              STRING  'SUKCS782 '          SU054-KOHLS-SML        11146099
111470                      ' TRIP:'             PV-DISP-TRIP           11147013
111480                      ' DR:'               SU054-DOOR-NUMBER      11148013
111490                      ' USR:'              SU054-USER-ID          11149013
111500                      ' STA:'              PV-DISP-PNA-STA        11150013
111510                      ' SQL:'              PV-DISP-SQLCODE        11151013
111520                      ' 4250-LINK-SUKUT705 (OTHER)'               11152013
111530                                           DELIMITED BY SIZE      11153013
111540                                      INTO PV-CICS-MSG-AREA2      11154013
111550                                                                  11155013
111560              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11156013
111570              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     11157013
111580                                                                  11158013
111590              PERFORM 9999-WRITE-TO-CSSL                          11159013
111600                                                                  11160013
111610              INITIALIZE PV-CICS-MSG-AREA3                        11161013
111620              MOVE LBPTDA-OPER-UNT-ID   TO  PV-DISP-OPER          11162013
111630                                                                  11163013
111640              STRING  'SUKCS782 '                                 11164099
111650                      ' msg:'   SU044-CRA-RET-MSG                 11165013
111660                      ' para:'  SU044-CRA-REQ-ID                  11166013
111670                                           DELIMITED BY SIZE      11167013
111680                                      INTO PV-CICS-MSG-AREA3      11168013
111690                                                                  11169013
111700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11170013
111710              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     11171013
111720                                                                  11172013
111730              PERFORM 9999-WRITE-TO-CSSL                          11173013
111740                                                                  11174013
111750              INITIALIZE PV-CICS-MSG-AREA4                        11175013
111760                                                                  11176013
111770              MOVE SU054-TRIP-ID TO   PV-DISP-trip                11177013
111780              MOVE PV-CTN         TO  PV-DISP-sscc                11178013
111790              MOVE PV-DEST-STORE  TO  PV-DISP-STR                 11179013
111800                                                                  11180013
111810              STRING  'SUKCS782 '                                 11181099
111820                      ' TRIP:'             PV-DISP-TRIP           11182013
111830                      ' SSCC:'             PV-DISP-SSCC           11183013
111840                      ' STR:'              PV-DISP-STR            11184013
111850                                           DELIMITED BY SIZE      11185013
111860                                      INTO PV-CICS-MSG-AREA4      11186013
111870                                                                  11187013
111880              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11188013
111890              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     11189013
111900                                                                  11190013
111910              PERFORM 9999-WRITE-TO-CSSL                          11191013
111920                                                                  11192013
111930              SET PS-PROCESSING-ERROR-YES TO TRUE                 11193013
111940              PERFORM 9998-WRITE-TO-CSSL                          11194013
111950     END-EVALUATE.                                                11195013
111960                                                                  11196013
111970*----------------------------------------------------------------*11197013
111980* CHECK IF PO/RECEIVER IS IN TROUBLE                             *11198013
111990* EXCEPTIONS ARE STORAGE TROUBLE (999,301,998,)  AND             *11199013
112000* PBS EDIT TROUBLE  (350,351,352,353,354)                        *11200013
112010*                                                                *11201013
112020*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *11202013
112030*                     Added "FETCH FIRST 1 ROW" PROGRAM WAS ONLY *11203013
112040*                     CHECKING FOR EXISTENCE OF                  *11204013
112050*----------------------------------------------------------------*11205013
112060 4450-CHECK-TROUBLE.                                              11206013
112070*                                                                 11207013
112080** added internal table to track paragraph execution time         11208013
112090** dmh 2014-12-22 - begin                                         11209013
112100*                                                                 11210013
112110     MOVE  '4450'  TO  PT-CURR-PARA.                              11211013
112120     IF  PS-BLD-INTERNAL-TABLE-YES                                11212013
112130         PERFORM 0200-INTERNAL-TABLE                              11213013
112140     ELSE                                                         11214013
112150         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11215013
112160     END-IF.                                                      11216013
112170                                                                  11217013
112180*                                                                 11218013
112190** DMH 2014-12-22 - END                                           11219013
112200*                                                                 11220013
112210     MOVE PV-RCVR-SEQ-NBR          TO DK-REC-SEQ-NBR.             11221013
112220     MOVE ZEROES                   TO PV-TROUBLE-COUNT.           11222013
112230                                                                  11223013
112240     EXEC SQL                                                     11224013
112250        SELECT COUNT(*)                                           11225013
112260          INTO :PV-TROUBLE-COUNT                                  11226013
112270          FROM TTRBNTF A                                          11227013
112280              ,TTRBRSN C                                          11228013
112290         WHERE A.PO_NBR       =  :DK-PO                           11229013
112300           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  11230013
112310           AND A.RESOLVED_IND IN ('N','I','R')                    11231013
112320           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    11232013
112330           AND C.NOTIF_IND    =  'T'                              11233013
112340           AND NOT EXISTS                                         11234013
112350              ( SELECT *                                          11235013
112360                FROM  TTRBRCN B                                   11236013
112370                WHERE B.RPT_PGM_NM  = 'SUKRF502'                  11237013
112380                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         11238013
112390         FETCH FIRST 1 ROW ONLY                                   11239013
112400          WITH UR                                                 11240013
112410     END-EXEC                                                     11241013
112420                                                                  11242013
112430     EVALUATE TRUE                                                11243013
112440         WHEN SQLCODE = ZERO                                      11244013
112450             IF PV-TROUBLE-COUNT > +0                             11245013
112460                SET PS-TROUBLE-FOUND TO TRUE                      11246013
112470             ELSE                                                 11247013
112480                SET PS-NO-TROUBLE-FOUND TO TRUE                   11248013
112490             END-IF                                               11249013
112500         WHEN SQLCODE = +100                                      11250013
112510             SET PS-NO-TROUBLE-FOUND TO TRUE                      11251013
112520         WHEN SQLWARN0 NOT = SPACES                               11252013
112530         WHEN SQLCODE < ZERO                                      11253013
112540         WHEN SQLCODE > ZERO                                      11254013
112550                                                                  11255013
112560              INITIALIZE PV-CICS-MSG-AREA1                        11256013
112570              INITIALIZE PV-CICS-MSG-AREA2                        11257013
112580                                                                  11258013
112590              MOVE SQLCODE              TO PV-DISP-SQLCODE        11259013
112600              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             11260013
112610              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           11261013
112620              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        11262013
112630                                                                  11263013
112640              STRING  'SUKCS782 4450-'                            11264099
112650                      ' DC:'               PV-DISP-DC             11265013
112660                      ' B1:'               SU054-BAR-CODE-1       11266013
112670                      ' B2:'               SU054-BAR-CODE-2       11267013
112680                      ' B3:'               SU054-BAR-CODE-3       11268013
112690                                           DELIMITED BY SIZE      11269013
112700                                      INTO PV-CICS-MSG-AREA1      11270013
112710                                                                  11271013
112720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11272013
112730              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     11273013
112740                                                                  11274013
112750              PERFORM 9999-WRITE-TO-CSSL                          11275013
112760                                                                  11276013
112770              STRING  'SUKCS782 '          SU054-KOHLS-SML        11277099
112780                      ' TRIP:'             PV-DISP-TRIP           11278013
112790                      ' DR:'               SU054-DOOR-NUMBER      11279013
112800                      ' USR:'              SU054-USER-ID          11280013
112810                      ' STA:'              PV-DISP-PNA-STA        11281013
112820                      ' SQL:'              PV-DISP-SQLCODE        11282013
112830                      ' TTRBRSN/TTRBNTF'                          11283013
112840                                           DELIMITED BY SIZE      11284013
112850                                      INTO PV-CICS-MSG-AREA2      11285013
112860                                                                  11286013
112870              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11287013
112880              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     11288013
112890                                                                  11289013
112900              PERFORM 9999-WRITE-TO-CSSL                          11290013
112910                                                                  11291013
112920              INITIALIZE PV-CICS-MSG-AREA3                        11292013
112930              MOVE DK-PO                TO  PV-DISP-PO            11293013
112940              MOVE DK-REC-SEQ-NBR       TO  PV-DISP-RCVR          11294013
112950                                                                  11295013
112960              STRING  'SUKCS782 '                                 11296099
112970                      ' '                  PV-DISP-PO             11297013
112980                      '-'                  PV-DISP-RCVR           11298013
112990                                           DELIMITED BY SIZE      11299013
113000                                      INTO PV-CICS-MSG-AREA3      11300013
113010                                                                  11301013
113020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11302013
113030              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     11303013
113040                                                                  11304013
113050              PERFORM 9999-WRITE-TO-CSSL                          11305013
113060                                                                  11306013
113070             SET PS-PROCESSING-ERROR-YES TO TRUE                  11307013
113080             PERFORM 9998-WRITE-TO-CSSL                           11308013
113090                                                                  11309013
113100     END-EVALUATE.                                                11310013
113110                                                                  11311013
113120/                                                                 11312013
113130*----------------------------------------------------------------*11313013
113140* CHECK IF THE PBS PO/RCVR THAT IS IN TROUBLE NEEDS TO CONTINUE  *11314013
113150* TO BE CHECKED FOR QC AUDIT                                     *11315013
113160*                                                                *11316013
113170*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *11317013
113180*----------------------------------------------------------------*11318013
113190 4460-CHECK-PO-AUD-REQ.                                           11319013
113200*                                                                 11320013
113210** added internal table to track paragraph execution time         11321013
113220** dmh 2014-12-22 - begin                                         11322013
113230*                                                                 11323013
113240     MOVE  '4460'  TO  PT-CURR-PARA.                              11324013
113250     IF  PS-BLD-INTERNAL-TABLE-YES                                11325013
113260         PERFORM 0200-INTERNAL-TABLE                              11326013
113270     ELSE                                                         11327013
113280         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11328013
113290     END-IF.                                                      11329013
113300                                                                  11330013
113310*                                                                 11331013
113320** DMH 2014-12-22 - END                                           11332013
113330*                                                                 11333013
113340     MOVE PV-PO-NBR                TO SUT00015-PO-NBR.            11334013
113350     MOVE PV-RCVR-SEQ-NBR          TO SUT00015-RCVR-SEQ-NBR.      11335013
113360                                                                  11336013
113370     EXEC SQL                                                     11337013
113380         SELECT CART_PRMPT_CDE                                    11338013
113390         INTO   :SUT00015-CART-PRMPT-CDE                          11339013
113400         FROM  SUT_PO_AUD_REQ                                     11340013
113410         WHERE  PO_NBR           =  :SUT00015-PO-NBR              11341013
113420          AND   RCVR_SEQ_NBR     =  :SUT00015-RCVR-SEQ-NBR        11342013
113430     END-EXEC                                                     11343013
113440                                                                  11344013
113450     EVALUATE TRUE                                                11345013
113460         WHEN SQLCODE = ZERO                                      11346013
113470              IF SUT00015-CART-PRMPT-CDE = 'C'                    11347013
113480                 SET PS-AUDIT-PROMPT-CHECK-YES TO TRUE            11348013
113490              ELSE                                                11349013
113500                 SET PS-AUDIT-PROMPT-CHECK-NO TO TRUE             11350013
113510              END-IF                                              11351013
113520         WHEN SQLCODE = +100                                      11352013
113530              SET PS-AUDIT-PROMPT-CHECK-YES TO TRUE               11353013
113540         WHEN SQLWARN0 NOT = SPACES                               11354013
113550         WHEN SQLCODE < ZERO                                      11355013
113560         WHEN SQLCODE > ZERO                                      11356013
113570                                                                  11357013
113580              INITIALIZE PV-CICS-MSG-AREA1                        11358013
113590              INITIALIZE PV-CICS-MSG-AREA2                        11359013
113600                                                                  11360013
113610              MOVE SQLCODE              TO PV-DISP-SQLCODE        11361013
113620              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             11362013
113630              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           11363013
113640              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        11364013
113650                                                                  11365013
113660              STRING  'SUKCS782 4460-'                            11366099
113670                      ' DC:'               PV-DISP-DC             11367013
113680                      ' B1:'               SU054-BAR-CODE-1       11368013
113690                      ' B2:'               SU054-BAR-CODE-2       11369013
113700                      ' B3:'               SU054-BAR-CODE-3       11370013
113710                                           DELIMITED BY SIZE      11371013
113720                                      INTO PV-CICS-MSG-AREA1      11372013
113730                                                                  11373013
113740              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11374013
113750              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     11375013
113760                                                                  11376013
113770              PERFORM 9999-WRITE-TO-CSSL                          11377013
113780                                                                  11378013
113790              STRING  'SUKCS782 '          SU054-KOHLS-SML        11379099
113800                      ' TRIP:'             PV-DISP-TRIP           11380013
113810                      ' DR:'               SU054-DOOR-NUMBER      11381013
113820                      ' USR:'              SU054-USER-ID          11382013
113830                      ' STA:'              PV-DISP-PNA-STA        11383013
113840                      ' SQL:'              PV-DISP-SQLCODE        11384013
113850                      ' SUT_PO_AUD_REQ '                          11385013
113860                                           DELIMITED BY SIZE      11386013
113870                                      INTO PV-CICS-MSG-AREA2      11387013
113880                                                                  11388013
113890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11389013
113900              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     11390013
113910                                                                  11391013
113920              PERFORM 9999-WRITE-TO-CSSL                          11392013
113930                                                                  11393013
113940              INITIALIZE PV-CICS-MSG-AREA3                        11394013
113950              MOVE SUT00015-PO-NBR       TO  PV-DISP-PO           11395013
113960              MOVE SUT00015-RCVR-SEQ-NBR TO  PV-DISP-RCVR         11396013
113970                                                                  11397013
113980              STRING  'SUKCS782 '                                 11398099
113990                      ' '                  PV-DISP-PO             11399013
114000                      '-'                  PV-DISP-RCVR           11400013
114010                                           DELIMITED BY SIZE      11401013
114020                                      INTO PV-CICS-MSG-AREA3      11402013
114030                                                                  11403013
114040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11404013
114050              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     11405013
114060                                                                  11406013
114070              PERFORM 9999-WRITE-TO-CSSL                          11407013
114080                                                                  11408013
114090             SET PS-PROCESSING-ERROR-YES TO TRUE                  11409013
114100             PERFORM 9998-WRITE-TO-CSSL                           11410013
114110                                                                  11411013
114120     END-EVALUATE.                                                11412013
114130                                                                  11413013
114140/                                                                 11414013
114150 4500-CREATE-TROUBLE.                                             11415013
114160*                                                                 11416013
114170** added internal table to track paragraph execution time         11417013
114180** dmh 2014-12-22 - begin                                         11418013
114190*                                                                 11419013
114200     MOVE  '4500'  TO  PT-CURR-PARA.                              11420013
114210     IF  PS-BLD-INTERNAL-TABLE-YES                                11421013
114220         PERFORM 0200-INTERNAL-TABLE                              11422013
114230     ELSE                                                         11423013
114240         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11424013
114250     END-IF.                                                      11425013
114260                                                                  11426013
114270*                                                                 11427013
114280** DMH 2014-12-22 - END                                           11428013
114290*                                                                 11429013
114300                                                                  11430013
114310     SET  TM500-ADD-DETAILS                                       11431013
114320          TM500-CREATE-AUTO        TO TRUE.                       11432013
114330                                                                  11433013
114340     EVALUATE TRUE                                                11434013
114350       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSA                          11435013
114360            MOVE PC-QTY-ERR-TRBL-CODE-350  TO TM500-TRBL-RSN-CDE  11436013
114370       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSB                          11437013
114380            MOVE PC-UPC-NOT-ON-PO-TRBL-351 TO TM500-TRBL-RSN-CDE  11438013
114390       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSC                          11439013
114400            MOVE PC-LNE-ZERO-TRBL-CODE-352 TO TM500-TRBL-RSN-CDE  11440013
114410       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSD                          11441013
114420            MOVE PC-UPC-CRTN-TRBL-CODE-353 TO TM500-TRBL-RSN-CDE  11442013
114430       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSE                          11443013
114440            MOVE PC-UPC-PKSL-TRBL-CODE-354 TO TM500-TRBL-RSN-CDE  11444013
114450     END-EVALUATE                                                 11445013
114460                                                                  11446013
114470                                                                  11447013
114480     MOVE PV-PO-NBR                TO TM500-PO-NBR.               11448013
114490     MOVE SU054-DC-NUMBER          TO TM500-OPER-UNT-ID.          11449013
114500     MOVE +1                       TO TM500-FCLTY-ID.             11450013
114510     MOVE PV-RCVR-SEQ-NBR          TO TM500-REC-SEQ-NBR.          11451013
114520     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            11452013
114530                                                                  11453013
114540                                                                  11454013
114550     EXEC CICS                                                    11455013
114560         LINK PROGRAM  (PC-TROUBLE-WTR)                           11456013
114570              COMMAREA (TM500-FIELDS)                             11457013
114580              LENGTH   (PC-TROUBLE-LENGTH)                        11458013
114590     END-EXEC.                                                    11459013
114600                                                                  11460013
114610                                                                  11461013
114620     EVALUATE TRUE                                                11462013
114630         WHEN TM500-CALL-SUCCESSFUL                               11463013
114640         WHEN TM500-DUPLICATE-TROUBLE                             11464013
114650              CONTINUE                                            11465013
114660         WHEN OTHER                                               11466013
114670                                                                  11467013
114680              INITIALIZE PV-CICS-MSG-AREA1                        11468013
114690              INITIALIZE PV-CICS-MSG-AREA2                        11469013
114700                                                                  11470013
114710              MOVE TM500-SQLCODE        TO PV-DISP-SQLCODE        11471013
114720              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             11472013
114730              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           11473013
114740              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        11474013
114750                                                                  11475013
114760              STRING  'SUKCS782 4500-'                            11476099
114770                      ' DC:'               PV-DISP-DC             11477013
114780                      ' B1:'               SU054-BAR-CODE-1       11478013
114790                      ' B2:'               SU054-BAR-CODE-2       11479013
114800                      ' B3:'               SU054-BAR-CODE-3       11480013
114810                                           DELIMITED BY SIZE      11481013
114820                                      INTO PV-CICS-MSG-AREA1      11482013
114830                                                                  11483013
114840              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11484013
114850              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     11485013
114860                                                                  11486013
114870              PERFORM 9999-WRITE-TO-CSSL                          11487013
114880                                                                  11488013
114890              STRING  'SUKCS782 '          SU054-KOHLS-SML        11489099
114900                      ' TRIP:'             PV-DISP-TRIP           11490013
114910                      ' DR:'               SU054-DOOR-NUMBER      11491013
114920                      ' USR:'              SU054-USER-ID          11492013
114930                      ' STA:'              PV-DISP-PNA-STA        11493013
114940                      ' SQL:'              PV-DISP-SQLCODE        11494013
114950                      ' SUT_PO_AUD_REQ '                          11495013
114960                                           DELIMITED BY SIZE      11496013
114970                                      INTO PV-CICS-MSG-AREA2      11497013
114980                                                                  11498013
114990              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11499013
115000              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     11500013
115010                                                                  11501013
115020              PERFORM 9999-WRITE-TO-CSSL                          11502013
115030                                                                  11503013
115040              INITIALIZE PV-CICS-MSG-AREA3                        11504013
115050              MOVE PV-PO-NBR             TO  PV-DISP-PO           11505013
115060              MOVE PV-RCVR-SEQ-NBR       TO  PV-DISP-RCVR         11506013
115070              MOVE TM500-TRBL-RSN-CDE    TO  PV-DISP-TRBL         11507013
115080                                                                  11508013
115090              STRING  'SUKCS782 (TMKCS521)'                       11509099
115100                      ' '                  TM500-PROCESS-IND      11510013
115110                      ' LVL:'              TM500-LEVEL-IND        11511013
115120                      ' DTL:'              TM500-DETAILS-IND      11512013
115130                      ' PO:'               PV-DISP-PO             11513013
115140                      '-'                  PV-DISP-RCVR           11514013
115150                      ' TRBL:'             PV-DISP-TRBL           11515013
115160                      ' '                  TM500-NOTIF-UID        11516013
115170                      ' RC:'               TM500-RETURN-CODE      11517013
115180                                           DELIMITED BY SIZE      11518013
115190                                      INTO PV-CICS-MSG-AREA3      11519013
115200                                                                  11520013
115210              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11521013
115220              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     11522013
115230                                                                  11523013
115240              PERFORM 9999-WRITE-TO-CSSL                          11524013
115250                                                                  11525013
115260              INITIALIZE PV-CICS-MSG-AREA4                        11526013
115270                                                                  11527013
115280              STRING  'SUKCS782 '                                 11528099
115290                      ' '                  TM500-SQLCA            11529013
115300                                           DELIMITED BY SIZE      11530013
115310                                      INTO PV-CICS-MSG-AREA4      11531013
115320                                                                  11532013
115330              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11533013
115340              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     11534013
115350                                                                  11535013
115360              PERFORM 9999-WRITE-TO-CSSL                          11536013
115370                                                                  11537013
115380             SET PS-PROCESSING-ERROR-YES TO TRUE                  11538013
115390             PERFORM 9998-WRITE-TO-CSSL                           11539013
115400     END-EVALUATE.                                                11540013
115410                                                                  11541013
115420******************************************************************11542013
115430**CHECK IF THE PBS ORDER IS RTV WHERE THERE ARE NO ALLOCATIONS   *11543013
115440**FOR A STORE OR THE ALLOCATIONS ARE 'DC' OR 'RV'                *11544013
115450**FORMAT A MESSAGE LABEL IN THESE CASES (PBS RTV OR NO ALLOC)    *11545013
115460******************************************************************11546013
115470 4510-PROCESS-CHECK-RTV.                                          11547013
115480*                                                                 11548013
115490** added internal table to track paragraph execution time         11549013
115500** dmh 2014-12-22 - begin                                         11550013
115510*                                                                 11551013
115520     MOVE  '4510'  TO  PT-CURR-PARA.                              11552013
115530     IF  PS-BLD-INTERNAL-TABLE-YES                                11553013
115540         PERFORM 0200-INTERNAL-TABLE                              11554013
115550     ELSE                                                         11555013
115560         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11556013
115570     END-IF.                                                      11557013
115580                                                                  11558013
115590*                                                                 11559013
115600** DMH 2014-12-22 - END                                           11560013
115610*                                                                 11561013
115620     MOVE SPACE TO PS-PBS-RTV-ALLOC-SW.                           11562013
115630     PERFORM 4520-CHECK-PBS-STORE-ALLOC.                          11563013
115640     IF PV-DB2-ALLOC-COUNT >  0                                   11564013
115650        CONTINUE                                                  11565013
115660     ELSE                                                         11566013
115670        PERFORM 4530-CHECK-RTV-ALLOC                              11567013
115680        IF PV-DB2-RTV-COUNT >  0                                  11568013
115690           SET PS-PBS-RTV-ALLOC TO TRUE                           11569013
115700        ELSE                                                      11570013
115710           SET PS-PBS-RTV-NO-ALLOC TO TRUE                        11571013
115720        END-IF                                                    11572013
115730     END-IF.                                                      11573013
115740******************************************************************11574013
115750                                                                  11575013
115760                                                                  11576013
115770*----------------------------------------------------------------*11577013
115780*                                                                *11578013
115790*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *11579013
115800*                     Added "FETCH FIRST 1 ROW" program was only *11580013
115810*                     checking existence of                      *11581013
115820*----------------------------------------------------------------*11582013
115830 4520-CHECK-PBS-STORE-ALLOC.                                      11583013
115840*                                                                 11584013
115850** added internal table to track paragraph execution time         11585013
115860** dmh 2014-12-22 - begin                                         11586013
115870*                                                                 11587013
115880     MOVE  '4520'  TO  PT-CURR-PARA.                              11588013
115890     IF  PS-BLD-INTERNAL-TABLE-YES                                11589013
115900         PERFORM 0200-INTERNAL-TABLE                              11590013
115910     ELSE                                                         11591013
115920         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11592013
115930     END-IF.                                                      11593013
115940                                                                  11594013
115950*                                                                 11595013
115960** DMH 2014-12-22 - END                                           11596013
115970*                                                                 11597013
115980     MOVE PV-DEST-STORE            TO RECDIS-STR-NBR.             11598013
115990     MOVE ZEROES                   TO PV-DB2-ALLOC-COUNT.         11599013
116000                                                                  11600013
116010     EXEC SQL                                                     11601013
116020         SELECT COUNT(*)                                          11602013
116030           INTO :PV-DB2-ALLOC-COUNT                               11603013
116040           FROM TRECDIS A                                         11604013
116050          WHERE A.ORD_NBR         =  :DK-PO                       11605013
116060            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              11606013
116070            AND A.STR_NBR         =  :RECDIS-STR-NBR              11607013
116080            AND A.VERIFY_ITM_QTY  >  0                            11608013
116090          FETCH FIRST 1 ROW ONLY                                  11609013
116100           WITH UR                                                11610013
116110     END-EXEC                                                     11611013
116120                                                                  11612013
116130     EVALUATE TRUE                                                11613013
116140         WHEN SQLCODE = ZERO                                      11614013
116150         WHEN SQLCODE = +100                                      11615013
116160             CONTINUE                                             11616013
116170         WHEN SQLWARN0 NOT = SPACES                               11617013
116180         WHEN SQLCODE < ZERO                                      11618013
116190         WHEN SQLCODE > ZERO                                      11619013
116200                                                                  11620013
116210              INITIALIZE PV-CICS-MSG-AREA1                        11621013
116220              INITIALIZE PV-CICS-MSG-AREA2                        11622013
116230                                                                  11623013
116240              MOVE SQLCODE              TO PV-DISP-SQLCODE        11624013
116250              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             11625013
116260              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           11626013
116270              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        11627013
116280                                                                  11628013
116290              STRING  'SUKCS782 4520-'                            11629099
116300                      ' DC:'               PV-DISP-DC             11630013
116310                      ' B1:'               SU054-BAR-CODE-1       11631013
116320                      ' B2:'               SU054-BAR-CODE-2       11632013
116330                      ' B3:'               SU054-BAR-CODE-3       11633013
116340                                           DELIMITED BY SIZE      11634013
116350                                      INTO PV-CICS-MSG-AREA1      11635013
116360                                                                  11636013
116370              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11637013
116380              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     11638013
116390                                                                  11639013
116400              PERFORM 9999-WRITE-TO-CSSL                          11640013
116410                                                                  11641013
116420              STRING  'SUKCS782 '          SU054-KOHLS-SML        11642099
116430                      ' TRIP:'             PV-DISP-TRIP           11643013
116440                      ' DR:'               SU054-DOOR-NUMBER      11644013
116450                      ' USR:'              SU054-USER-ID          11645013
116460                      ' STA:'              PV-DISP-PNA-STA        11646013
116470                      ' SQL:'              PV-DISP-SQLCODE        11647013
116480                      ' TRECDIS'                                  11648013
116490                                           DELIMITED BY SIZE      11649013
116500                                      INTO PV-CICS-MSG-AREA2      11650013
116510                                                                  11651013
116520              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11652013
116530              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     11653013
116540                                                                  11654013
116550              PERFORM 9999-WRITE-TO-CSSL                          11655013
116560                                                                  11656013
116570              INITIALIZE PV-CICS-MSG-AREA3                        11657013
116580              MOVE DK-PO                 TO  PV-DISP-PO           11658013
116590              MOVE DK-REC-SEQ-NBR        TO  PV-DISP-RCVR         11659013
116600              MOVE RECDIS-STR-NBR        TO  PV-disp-DEST-OPER    11660013
116610                                                                  11661013
116620              STRING  'SUKCS782 '                                 11662099
116630                      ' PO:'               PV-DISP-PO             11663013
116640                      '-'                  PV-DISP-RCVR           11664013
116650                      ' STR:'              PV-disp-DEST-OPER      11665013
116660                                           DELIMITED BY SIZE      11666013
116670                                      INTO PV-CICS-MSG-AREA3      11667013
116680                                                                  11668013
116690              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11669013
116700              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     11670013
116710                                                                  11671013
116720              PERFORM 9999-WRITE-TO-CSSL                          11672013
116730                                                                  11673013
116740             SET PS-PROCESSING-ERROR-YES TO TRUE                  11674013
116750             PERFORM 9998-WRITE-TO-CSSL                           11675013
116760                                                                  11676013
116770     END-EVALUATE.                                                11677013
116780                                                                  11678013
116790                                                                  11679013
116800*----------------------------------------------------------------*11680013
116810*                                                                *11681013
116820*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *11682013
116830*                     Added "FETCH FIRST 1 ROW" program was only *11683013
116840*                     checking existence of                      *11684013
116850*----------------------------------------------------------------*11685013
116860 4530-CHECK-RTV-ALLOC.                                            11686013
116870*                                                                 11687013
116880** added internal table to track paragraph execution time         11688013
116890** dmh 2014-12-22 - begin                                         11689013
116900*                                                                 11690013
116910     MOVE  '4530'  TO  PT-CURR-PARA.                              11691013
116920     IF  PS-BLD-INTERNAL-TABLE-YES                                11692013
116930         PERFORM 0200-INTERNAL-TABLE                              11693013
116940     ELSE                                                         11694013
116950         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11695013
116960     END-IF.                                                      11696013
116970                                                                  11697013
116980*                                                                 11698013
116990** DMH 2014-12-22 - END                                           11699013
117000*                                                                 11700013
117010     MOVE ZEROES                   TO PV-DB2-RTV-COUNT.           11701013
117020                                                                  11702013
117030     EXEC SQL                                                     11703013
117040         SELECT COUNT(*)                                          11704013
117050           INTO :PV-DB2-RTV-COUNT                                 11705013
117060           FROM TRECDIS A                                         11706013
117070              , XLT_LOC B                                         11707013
117080          WHERE A.ORD_NBR         =  :DK-PO                       11708013
117090            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              11709013
117100            AND A.STR_NBR         =  B.LOC_NBR                    11710013
117110            AND B.LOC_TYP_CDE     IN  ('DC' , 'RV')               11711013
117120            AND A.VERIFY_ITM_QTY  >  0                            11712013
117130          FETCH FIRST 1 ROW ONLY                                  11713013
117140           WITH UR                                                11714013
117150     END-EXEC                                                     11715013
117160                                                                  11716013
117170     EVALUATE TRUE                                                11717013
117180         WHEN SQLCODE = ZERO                                      11718013
117190             CONTINUE                                             11719013
117200         WHEN SQLWARN0 NOT = SPACES                               11720013
117210         WHEN SQLCODE < ZERO                                      11721013
117220         WHEN SQLCODE > ZERO                                      11722013
117230                                                                  11723013
117240              INITIALIZE PV-CICS-MSG-AREA1                        11724013
117250              INITIALIZE PV-CICS-MSG-AREA2                        11725013
117260                                                                  11726013
117270              MOVE SQLCODE              TO PV-DISP-SQLCODE        11727013
117280              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             11728013
117290              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           11729013
117300              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        11730013
117310                                                                  11731013
117320              STRING  'SUKCS782 4530-'                            11732099
117330                      ' DC:'               PV-DISP-DC             11733013
117340                      ' B1:'               SU054-BAR-CODE-1       11734013
117350                      ' B2:'               SU054-BAR-CODE-2       11735013
117360                      ' B3:'               SU054-BAR-CODE-3       11736013
117370                                           DELIMITED BY SIZE      11737013
117380                                      INTO PV-CICS-MSG-AREA1      11738013
117390                                                                  11739013
117400              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11740013
117410              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     11741013
117420                                                                  11742013
117430              PERFORM 9999-WRITE-TO-CSSL                          11743013
117440                                                                  11744013
117450              STRING  'SUKCS782 '          SU054-KOHLS-SML        11745099
117460                      ' TRIP:'             PV-DISP-TRIP           11746013
117470                      ' DR:'               SU054-DOOR-NUMBER      11747013
117480                      ' USR:'              SU054-USER-ID          11748013
117490                      ' STA:'              PV-DISP-PNA-STA        11749013
117500                      ' SQL:'              PV-DISP-SQLCODE        11750013
117510                      ' TRECDIS/XLT_LOC'                          11751013
117520                                           DELIMITED BY SIZE      11752013
117530                                      INTO PV-CICS-MSG-AREA2      11753013
117540                                                                  11754013
117550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11755013
117560              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     11756013
117570                                                                  11757013
117580              PERFORM 9999-WRITE-TO-CSSL                          11758013
117590                                                                  11759013
117600              INITIALIZE PV-CICS-MSG-AREA3                        11760013
117610              MOVE DK-PO                 TO  PV-DISP-PO           11761013
117620              MOVE DK-REC-SEQ-NBR        TO  PV-DISP-RCVR         11762013
117630                                                                  11763013
117640              STRING  'SUKCS782 '                                 11764099
117650                      ' PO:'               PV-DISP-PO             11765013
117660                      '-'                  PV-DISP-RCVR           11766013
117670                                           DELIMITED BY SIZE      11767013
117680                                      INTO PV-CICS-MSG-AREA3      11768013
117690                                                                  11769013
117700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     11770013
117710              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     11771013
117720                                                                  11772013
117730              PERFORM 9999-WRITE-TO-CSSL                          11773013
117740                                                                  11774013
117750             SET PS-PROCESSING-ERROR-YES TO TRUE                  11775013
117760             PERFORM 9998-WRITE-TO-CSSL                           11776013
117770                                                                  11777013
117780     END-EVALUATE.                                                11778013
117790                                                                  11779013
117800******************************************************************11780013
117810 5000-PRINT-LABEL.                                                11781013
117820******************************************************************11782013
117830*                                                                 11783013
117840** added internal table to track paragraph execution time         11784013
117850** dmh 2014-12-22 - begin                                         11785013
117860*                                                                 11786013
117870     MOVE  '5000'  TO  PT-CURR-PARA.                              11787013
117880     IF  PS-BLD-INTERNAL-TABLE-YES                                11788013
117890         PERFORM 0200-INTERNAL-TABLE                              11789013
117900     ELSE                                                         11790013
117910         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       11791013
117920     END-IF.                                                      11792013
117930                                                                  11793013
117940*                                                                 11794013
117950** DMH 2014-12-22 - END                                           11795013
117960*                                                                 11796013
117970                                                                  11797013
117980* CT 11/04/08 BEGIN                                               11798013
117990                                                                  11799013
118000     MOVE SU054-ACCM-LINE-NMBR TO SUT00107-ACM-LBL-STA-NBR.       11800013
118010     PERFORM 5003-SELECT-CONVEY-LVL.                              11801013
118020                                                                  11802013
118030* CT 11/04/08 END                                                 11803013
118040                                                                  11804013
118050*****FILL BAR CODE FOR SHIPPING LABEL - PACK BY STORE             11805013
118060     IF PS-PACK-BY-STORE                                          11806013
118070** PV-DUPLICATE-IND (true duplicate flag)                         11807013
118080       IF PV-DUPLICATE-IND     = 'Y'                              11808013
118090          SET PS-XREF-PBS-NOT-FOUND TO TRUE                       11809013
118100       ELSE                                                       11810013
118110          PERFORM 3696-CHECK-SULBXF-FOR-PBS                       11811013
118120       END-IF                                                     11812013
118130        IF PS-XREF-PBS-FOUND                                      11813013
118140           MOVE SULBXF-BRCDE-NBR TO PC160-BTCH-BARCODE            11814013
118150           MOVE PC160-BTCH-SML-BC-MNFST-NBR TO                    11815013
118160                                    PV-LBL-MANIFEST-NBR           11816013
118170           MOVE PC160-BTCH-SML-BC-DIVERT-PFX  TO                  11817013
118180                                    PV-STORE-NBR-PFX-HOLD         11818013
118190        ELSE                                                      11819013
118200           MOVE PV-DEST-STORE         TO PC187-STR-NBR            11820013
118210           MOVE  +1                   TO PC187-NO-OF-LBLS         11821013
118220           PERFORM 7250-LINK-PCKCS721                             11822013
118230           MOVE PC187-START-MFST-NBR TO PV-LBL-MANIFEST-NBR       11823013
118240        END-IF                                                    11824013
118250        MOVE 'K'                 TO DK-CART-LBL-TYP-CDE           11825013
118260        PERFORM 7210-GET-STORE-INFO                               11826013
118270        MOVE SU054-DC-NUMBER TO DK-OPER-UNT-ID                    11827013
118280        PERFORM 7215-GET-ECOMM-DC-INFO                            11828013
118290        PERFORM 2100-GET-ZONE-DESC                                11829013
118300        PERFORM 5060-CALL-SEA-SET-MODULE                          11830013
118310                                                                  11831013
118320        PERFORM 7400-GET-DEPT-NAME                                11832013
118330        PERFORM 7235-GET-OUTER-PACK                               11833013
118340        MOVE ZEROES             TO PC160-BTCH-SML-CONTAINER-CDE   11834013
118350                                   PC160-PORT-SML-TXT-CONTANR-CDE 11835013
118360        SET  PC160-BTCH-SML-INTERNAL-LBL                          11836013
118370             PC160-BTCH-SML-FROM-KOHLS                            11837013
118380             PC160-PORT-SML-TXT-INTERNL-LBL                       11838013
118390             PC160-PORT-SML-TXT-FROM-KOHLS   TO TRUE              11839013
118400        MOVE PV-DEST-STORE         TO PV-STORE-9-4                11840013
118410                                      DK-DEST-OPER-UNT-ID         11841013
118420        MOVE PV-STORE-X-4          TO PV-STORE-NBR-4              11842013
118430        MOVE PV-STORE-NBR          TO PC160-BTCH-SML-BC-DIVERT    11843013
118440                                      PC160-PORT-SML-TXT-DIVERT   11844013
118450        MOVE RECEIV-CURR-OPER-UNT-ID                              11845013
118460                                   TO PC160-BTCH-SML-BC-DC-ORIGIN 11846013
118470                                      PC160-PORT-SML-TXT-DC-ORIGIN11847013
118480                                      PV-BAR-CODE-OPER-UNIT       11848013
118490        MOVE PV-LBL-MANIFEST-NBR    TO                            11849013
118500                                      PC160-BTCH-SML-BC-MNFST-NBR 11850013
118510                                      PC160-PORT-SML-TXT-MNFST-NBR11851013
118520                                      PV-BAR-CODE-LBL-MANIFEST    11852013
118530                                                                  11853013
118540        MOVE PC160-BTCH-BARCODE    TO DK-BARCODE-NBR              11854013
118550        PERFORM 6400-DETERMINE-HANG-FOLD                          11855013
118560        PERFORM 7234-GET-CURRENT-DOOR                             11856013
118570                                                                  11857013
118580                                                                  11858013
118590*       IF PS-NOT-REPRINT-DUP                                     11859013
118600*          PERFORM 3570-POPULATE-CRTN-LBL-XREF                    11860013
118610*       ELSE                                                      11861013
118620           IF PS-XREF-PBS-FOUND                                   11862013
118630              IF PV-STORE-NBR-PFX-HOLD = PV-STORE-NBR-PFX         11863013
118640                 CONTINUE                                         11864013
118650              ELSE                                                11865013
118660                 PERFORM 3580-INACTIVATE-XREF                     11866013
118670                 PERFORM 3581-INACTIVATE-OTBND-CART               11867013
118680                 PERFORM 3570-POPULATE-CRTN-LBL-XREF              11868013
118690              END-IF                                              11869013
118700           ELSE                                                   11870013
118710              PERFORM 3570-POPULATE-CRTN-LBL-XREF                 11871013
118720           END-IF                                                 11872013
118730*       END-IF                                                    11873013
118740     END-IF.                                                      11874013
118750                                                                  11875013
118760     SET SU021-AUDIT-IS-COMPLETE                                  11876013
118770*CLP 10/29/13 START                                               11877013
118780         SU021-RFID-AUDIT-IS-COMPLETE                             11878013
118790*CLP 10/29/13   END                                               11879013
118800         PS-OPER-NOT-ECOMM-DC    TO TRUE                          11880013
118810     MOVE SU054-DC-NUMBER TO DK-OPER-UNT-ID                       11881013
118820     PERFORM 7215-GET-ECOMM-DC-INFO                               11882013
118830     IF PS-OPER-NOT-ECOMM-DC                                      11883013
118840        IF PS-WRONG-FCLTY                                         11884013
118850           OR PS-ODD-UNT-CRTN-FOUND                               11885013
118860           OR PS-NOT-CRTN-ATT-TO-RCVR                             11886013
118870           OR PS-MISDIRECT-PACK-BY-STORE                          11887013
118880           OR LBVRDA-INPK-CNVYB-IND = 'Y'                         11888013
118890              CONTINUE                                            11889013
118900        ELSE                                                      11890013
118910           PERFORM 7000-AUDIT-CHECK-PROCESSING                    11891013
118920        END-IF                                                    11892013
118930     END-IF                                                       11893013
118940                                                                  11894013
118950     PERFORM 7150-CHECK-DC-LOC                                    11895013
118960                                                                  11896013
118970     IF PS-PACK-BY-STORE                                          11897013
118980         MOVE 'N' TO LBVRDA-INPK-CNVYB-IND                        11898013
118990         PERFORM 7200-GATHER-LABEL-INFO                           11899013
119000     ELSE                                                         11900013
119010         PERFORM 7500-POPULATE-TLBPTDA-BULK                       11901013
119020     END-IF                                                       11902013
119030                                                                  11903013
119040     IF  SU021-AUDIT-REQUIRED OR                                  11904013
119050*CLP 10/29/13 START                                               11905013
119060         SU021-RFID-AUDIT-REQUIRED                                11906013
119070*CLP 10/29/13 END                                                 11907013
119080         MOVE ZEROES  TO  PV-HNG-FOLD-SEQ-NBR                     11908013
119090                          PV-BUS-AREA-ID                          11909013
119100     ELSE                                                         11910013
119110                                                                  11911013
119120         IF PV-DEPT-NUMBER > SPACES                               11912013
119130            PERFORM 6700-LINK-XLKUT073                            11913013
119140         ELSE                                                     11914013
119150            MOVE ZEROES TO PV-BUS-AREA-ID                         11915013
119160         END-IF                                                   11916013
119170     END-IF                                                       11917013
119180                                                                  11918013
119190* CLP 06/20/13 PR5148B START                                      11919013
119200                                                                  11920013
119210     INITIALIZE SU093-ITEM-COMMAREA                               11921013
119220     SET SU093-RFID-NO TO TRUE                                    11922013
119230     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE                    11923013
119240     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE                    11924013
119250     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE                    11925013
119260     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE                    11926013
119270     SET SU093-DC-DEPT-TAGS-NO         TO TRUE                    11927013
119280     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE                    11928013
119290     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE                    11929013
119300     SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE                    11930013
119310     SET SU093-P2L-CHK-IN-NO           TO TRUE                    11931013
119320*CLP 10/29/2013 - START                                           11932013
119330     SET SU093-IR-CHK-IN-NO            TO TRUE                    11933013
119340*CLP 10/29/2013 - END                                             11934013
119350     PERFORM 6010-CALL-RFID-DETERMINATION                         11935013
119360                                                                  11936013
119370* CLP 06/20/13 PR5148B END                                        11937013
119380                                                                  11938013
119390     IF PS-LOG-MESSAGE                                            11939013
119400        MOVE SPACE TO PV-CICS-MSG-AREA-A                          11940013
119410        STRING ' SUKCS782  '                                      11941099
119420               ' Auto CNVY:'  PS-AUTO-CONVEY-LVL-SW               11942013
119430               ' ERR SW:'     PS-PROCESSING-ERROR-SW              11943013
119440               ' RFID-SW:'    PS-RFID-ON-LABEL-SW                 11944013
119450               ' SML-SW:'     PS-SML-CREATION-SW                  11945013
119460               ' reprt:'      PS-LBL-REPrINT-IND                  11946013
119470                              DELIMITED BY SIZE                   11947013
119480                         iNTO PV-CICS-MSG-AREA-B                  11948013
119490             PERFORM 9999-WRITE-TO-CSSL                           11949013
119500     END-IF                                                       11950013
119510                                                                  11951013
119520       EVALUATE TRUE                                              11952013
119530           WHEN PS-AUTO-CONVEY-NO-CRTNS                           11953013
119540* CLP 06/20/13 PR5148B START                                      11954013
119550                 IF PS-RFID-ON-LABEL-SW = 'Y'                     11955013
119560                    IF PS-LBL-REPRINT                             11956013
119570                       CONTINUE                                   11957013
119580                    ELSE                                          11958013
119590                       IF PS-PROCESSING-ERROR-NO AND              11959013
119600                          PS-CARTON-SML-CREATED                   11960013
119610                          PERFORM 8600-INSERT-PROCESS-MSG         11961013
119620                       END-IF                                     11962013
119630                    END-IF                                        11963013
119640                END-IF                                            11964013
119650* CLP 06/20/13 PR5148B END                                        11965013
119660           WHEN PS-AUTO-CONVEY-ALL-CRTNS                          11966013
119670              PERFORM 6000-FORMAT-DIRECTIVE-CALL                  11967013
119680           WHEN PS-AUTO-CONVEY-EXCPT-CRTNS                        11968013
119690**gb 9/17/12  IF SU021-AUDIT-IS-COMPLETE                          11969013
119700**gb 9/17/12      CONTINUE                                        11970013
119710**gb 9/17/12  ELSE                                                11971013
119720                 IF PS-PROCESSING-ERROR-NO                        11972013
119730                    IF PS-LBL-REPRINT                             11973013
119740                       PERFORM 6005-DETERMINE-FRCED-DVRT          11974013
119750                    ELSE                                          11975013
119760                       PERFORM 6000-FORMAT-DIRECTIVE-CALL         11976013
119770                    END-IF                                        11977013
119780                 END-IF                                           11978013
119790**gb 9/17/12  END-IF                                              11979013
119800       END-EVALUATE.                                              11980013
119810                                                                  11981013
119820* CT 11/04/08 END                                                 11982013
119830                                                                  11983013
119840     PERFORM 7205-INSERT-LABEL-TABLE                              11984013
119850                                                                  11985013
119860     IF SU054-ASGMT-STRT-DTE  > SPACES                            11986013
119870        AND (PS-CARTON-SML-CREATED OR PS-CARTON-P2L-CREATED)      11987013
119880        PERFORM 5700-CALL-XLKUP033-EAI                            11988013
119890     END-IF                                                       11989013
119900                                                                  11990013
119910******************************************************************11991013
119920*** MODULE TO SEE IF LAST CARTON SCANNED AND CONF/VERIF CAN       11992013
119930*** BE STARTED                                                    11993013
119940******************************************************************11994013
119950         IF PS-AUTO-VE-YES                                        11995013
119960            IF LBPTDA-CART-LBL-TYP-CDE = 'P'                      11996013
119970               CONTINUE                                           11997013
119980            ELSE                                                  11998013
119990               PERFORM 7350-START-VERIF-TRIGGER                   11999013
120000            END-IF                                                12000013
120010         END-IF.                                                  12001013
120020                                                                  12002013
120030         IF LBPTDA-CART-LBL-TYP-CDE = 'P' AND                     12003038
120040            SU054-P2L-DC-DIVERT-YES                               12004013
120050             SET PS-P2L-FORCED-DIVERT-YES TO TRUE                 12005013
120060         ELSE                                                     12006013
120070             SET PS-P2L-FORCED-DIVERT-NO  TO TRUE                 12007013
120080         END-IF                                                   12008013
120090***********************************************************       12009013
120100****************************************************************  12010013
120110*CLP 03-13-2017                                                   12011013
120120* IF ITS A P2L FORCED DIVERT CHECK IF DC ON TABLE                 12012013
120130* BLUE SPRINGS IS SET UP FOR DIVERT OF 2                          12013013
120140****************************************************************  12014013
120150       IF PS-VALID-SML-BRCDE-YES                                  12015013
120160            MOVE DK-SML-BARCODE TO SU054-KOHLS-SML                12016013
120170*CLP 10/29/13                                                     12017013
120180            IF SU021-AUDIT-IS-COMPLETE AND                        12018013
120190               SU021-RFID-AUDIT-IS-COMPLETE                       12019013
120200*CLP 10/29/13                                                     12020013
120210               IF PS-P2L-FORCED-DIVERT-YES                        12021013
120220                 SET SU054-P2L-FORCED-DIVERT                      12022013
120230                     SU054-NO-LABEL-REQ  TO TRUE                  12023013
120240*CLP 03-13-2017                                                   12024013
120250                 MOVE +1                 TO SU054-DWNLD-PRINT-IND 12025013
120260                 PERFORM 5070-GET-DC-PADCLS                       12026013
120270                 MOVE KRPRPM-FUNC-QTY    TO PV-FUNC-QTY           12027013
120280                 MOVE PV-FUNC-QTYX       TO SU054-FRCD-DIVERT-IND 12028013
120290                                                                  12029013
120300               ELSE                                               12030013
120310* CT 11/04/08 BEGIN                                               12031013
120320                   IF PS-SET-NEW-FRCED-DIVERT-YES                 12032013
120330                       MOVE SUT00108-FRC-DIVERT-CDE TO            12033013
120340                            SU054-FRCD-DIVERT-IND                 12034013
120350                   ELSE                                           12035013
120360                       MOVE +0           TO SU054-FRCD-DIVERT-IND 12036013
120370                   END-IF                                         12037013
120380                   SET SU054-NO-REJECT                            12038013
120390                       SU054-NO-LABEL-REQ  TO TRUE                12039013
120400                       MOVE +1           TO SU054-DWNLD-PRINT-IND 12040013
120410               END-IF                                             12041013
120420            ELSE                                                  12042013
120430               IF PS-SET-NEW-FRCED-DIVERT-YES                     12043013
120440                   PERFORM 8550-CHECK-AUDIT-CRTN                  12044013
120450                   IF PS-AUDIT-CARTON-FOUND-YES                   12045013
120460                      MOVE +1      TO SU054-FRCD-DIVERT-IND       12046013
120470                   ELSE                                           12047013
120480                      MOVE SUT00108-FRC-DIVERT-CDE TO             12048013
120490                           SU054-FRCD-DIVERT-IND                  12049013
120500                   END-IF                                         12050013
120510               ELSE                                               12051013
120520                   MOVE +1               TO SU054-FRCD-DIVERT-IND 12052013
120530               END-IF                                             12053013
120540* CT 11/04/08 END                                                 12054013
120550               SET SU054-CARTON-NEEDS-AUDIT                       12055013
120560                   SU054-NO-LABEL-REQ  TO TRUE                    12056013
120570                   MOVE +1             TO SU054-DWNLD-PRINT-IND   12057013
120580            END-IF                                                12058013
120590       ELSE                                                       12059013
120600          PERFORM 8000-LOAD-LABEL-DATA-SML                        12060013
120610       END-IF.                                                    12061013
120620                                                                  12062013
120630***gb 2/23/09 beg                                                 12063013
120640     IF PS-LOG-MESSAGE                                            12064013
120650         inITIALIZE PV-CICS-MSG-AREA1                             12065013
120660         INITIALIZE PV-CICS-MSG-AREA2                             12066013
120670                                                                  12067013
120680         MOVE SQLCODE                  TO PV-DISP-SQLCODE         12068013
120690         MOVE SU054-DC-NUMBER          TO PV-DISP-DC              12069013
120700         MOVE SU054-TRIP-ID            TO PV-DISP-TRIP            12070013
120710         MOVE SU054-ACCM-LINE-NMBR     TO PV-DISP-PNA-STA         12071013
120720         MOVE LBVRDA-DEST-OPER-UNT-ID  TO PV-DISP-DEST-OPER       12072013
120730                                                                  12073013
120740         STRING  ' SUKCS782 5000-'                                12074099
120750                 ' DC:'     PV-DISP-DC                            12075013
120760                 ' B1:'     SU054-BAR-CODE-1                      12076013
120770                 ' B2:'     SU054-BAR-CODE-2                      12077013
120780                 ' B3:'     SU054-BAR-CODE-3                      12078013
120790                            DELIMITED BY SIZE                     12079013
120800                       INTO PV-CICS-MSG-AREA1                     12080013
120810                                                                  12081013
120820         MOVE SPACES             TO PV-CICS-MSG-AREA-A            12082013
120830         MOVE PV-CICS-MSG-AREA1  TO PV-CICS-MSG-AREA-A            12083013
120840                                                                  12084013
120850         PERFORM 9999-WRITE-TO-CSSL                               12085013
120860                                                                  12086013
120870         STRING  ' SUKCS782 '                                     12087099
120880                            SU054-KOHLS-SML                       12088013
120890                 ' DEST:'   PV-DISP-DEST-OPER                     12089013
120900                 ' TRIP:'   PV-DISP-TRIP                          12090013
120910                 ' DR:'     SU054-DOOR-NUMBER                     12091013
120920                 ' USR:'    SU054-USER-ID                         12092013
120930                 ' STA:'    PV-DISP-PNA-STA                       12093013
120940                 ' SQL:'    PV-DISP-SQLCODE                       12094013
120950                 ' TKRPRPM-PACRTN'                                12095013
120960                            DELIMITED BY SIZE                     12096013
120970                       INTO PV-CICS-MSG-AREA2                     12097013
120980                                                                  12098013
120990         MOVE SPACES             TO PV-CICS-MSG-AREA-A            12099013
121000         MOVE PV-CICS-MSG-AREA2  TO PV-CICS-MSG-AREA-A            12100013
121010                                                                  12101013
121020         PERFORM 9999-WRITE-TO-CSSL                               12102013
121030                                                                  12103013
121040         INITIALIZE PV-CICS-MSG-AREA3                             12104013
121050                                                                  12105013
121060         STRING  ' SUKCS782 '                                     12106099
121070                 ' SU054-REQUEST-LABEL-CDE:'                      12107013
121080                   SU054-REQUEST-LABEL-CDE                        12108013
121090                 ' SU054-FRCD-DIVERT-IND:'                        12109013
121100                   SU054-FRCD-DIVERT-IND                          12110013
121110                            DELIMITED BY SIZE                     12111013
121120                       INTO PV-CICS-MSG-AREA3                     12112013
121130                                                                  12113013
121140         MOVE SPACES             TO PV-CICS-MSG-AREA-A            12114013
121150         MOVE PV-CICS-MSG-AREA3  TO PV-CICS-MSG-AREA-A            12115013
121160                                                                  12116013
121170         PERFORM 9999-WRITE-TO-CSSL                               12117013
121180                                                                  12118013
121190         INITIALIZE PV-CICS-MSG-AREA4                             12119013
121200         move pv-duration-sec  to  PV-disp-duration               12120013
121210         STRING  ' SUKCS782 '                                     12121099
121220                 ' START TMST:'  PV-INIT-TIMESTAMP  '  '          12122013
121230                 ' END TMST:'    PV-CURR-TIMESTAMP                12123013
121240                 ' duration:'    PV-disp-duration                 12124013
121250                            DELIMITED BY SIZE                     12125013
121260                       INTO PV-CICS-MSG-AREA4                     12126013
121270                                                                  12127013
121280         MOVE SPACES             TO PV-CICS-MSG-AREA-A            12128013
121290         MOVE PV-CICS-MSG-AREA4  TO PV-CICS-MSG-AREA-A            12129013
121300                                                                  12130013
121310         PERFORM 9999-WRITE-TO-CSSL                               12131013
121320     END-IF                                                       12132013
121330***gb 2/23/09 end                                                 12133013
121340       MOVE SU054-CRTN-CHECKIN-RECORD TO  DFHCOMMAREA             12134013
121350                                                                  12135013
121360     IF  PS-BLD-INTERNAL-TABLE-YES  and                           12136013
121370         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  12137013
121380                                                                  12138013
121390         move spaces to  pv-ciCS-MSG-AREA-A                       12139013
121400         PERFORM 9999-WRITE-TO-CSSL                               12140013
121410                                                                  12141013
121420         INITIALIZE PV-CICS-MSG-AREA-A                            12142013
121430         move pv-duration-sec to  PV-disp-duration                12143013
121440         STRING ' SUKCS782-DID NOT MEET SLA'                      12144099
121450               ' 5000-'                                           12145013
121460               ' DC:'        SU054-DC-NUMBER                      12146013
121470               ' STA:'       SU054-ACCM-LINE-NMBR                 12147013
121480               ' KEY:'       PV-INIT-TIME-KEY                     12148013
121490               ' tmst:'      PV-curr-TIMESTAMP                    12149013
121500               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   12150013
121510                                        INTO PV-CICS-MSG-AREA-A   12151013
121520         PERFORM 9999-WRITE-TO-CSSL                               12152013
121530                                                                  12153013
121540         INITIALIZE PV-CICS-MSG-AREA-A                            12154013
121550         STRING ' SUKCS782-'                                      12155099
121560               ' 5000-'                                           12156013
121570               ' KEY:'       PV-INIT-TIME-KEY                     12157013
121580               ' init:'      PV-init-TIMESTAMP                    12158013
121590               ' curr:'      PV-curr-timestamp DELIMITED BY SIZE  12159013
121600                                        INTO PV-CICS-MSG-AREA-A   12160013
121610         PERFORM 9999-WRITE-TO-CSSL                               12161013
121620                                                                  12162013
121630         PERFORM 0205-WRITE-SUWS054-TO-CSSL                       12163013
121640                                                                  12164013
121650         move spaces to  pv-ciCS-MSG-AREA-A                       12165013
121660         PERFORM 9999-WRITE-TO-CSSL                               12166013
121670                                                                  12167013
121680         PERFORM 0210-DUMP-TABLE-TO-CSSL                          12168013
121690         VARYING PT-TRACK-IDX                                     12169013
121700            FROM 1 BY 1                                           12170013
121710           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 12171013
121720              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             12172013
121730                                                                  12173013
121740         PERFORM 0220-CLEAR-TABLE                                 12174013
121750         VARYING PT-TRACK-IDX                                     12175013
121760            FROM 1 BY 1                                           12176013
121770           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 12177013
121780              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             12178013
121790                                                                  12179013
121800         MOVE ZEROES TO PT-CURR-ENTRIES                           12180013
121810         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   12181013
121820                                                                  12182013
121830         INITIALIZE PV-CICS-MSG-AREA-A                            12183013
121840         move pv-duration-sec to  PV-disp-duration                12184013
121850         STRING ' SUKCS782-DID NOT MEET SLA'                      12185099
121860               ' 5000-'                                           12186013
121870               ' DC:'        SU054-DC-NUMBER                      12187013
121880               ' STA:'       SU054-ACCM-LINE-NMBR                 12188013
121890               ' KEY:'       PV-INIT-TIME-KEY                     12189013
121900               ' done'                       delimited by size    12190013
121910                                        INTO PV-CICS-MSG-AREA-A   12191013
121920         PERFORM 9999-WRITE-TO-CSSL                               12192013
121930                                                                  12193013
121940         move spaces to  pv-ciCS-MSG-AREA-A                       12194013
121950         PERFORM 9999-WRITE-TO-CSSL                               12195013
121960                                                                  12196013
121970     END-IF.                                                      12197013
121980                                                                  12198013
121990     IF  PS-LOG-MESSAGE                                           12199013
122000         INITIALIZE PV-CICS-MSG-AREA-A                            12200013
122010         move pv-duration-sec  to   PV-disp-duration              12201013
122020         STRING ' SUKCS782-ENDED  '                               12202099
122030               ' 5000-'                                           12203013
122040               ' DC:'        SU054-DC-NUMBER                      12204013
122050               ' STA:'       SU054-ACCM-LINE-NMBR                 12205013
122060               ' KEY:'       PV-INIT-TIME-KEY                     12206013
122070               ' tmst:'      PV-curr-TIMESTAMP                    12207013
122080               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   12208013
122090                                        INTO PV-CICS-MSG-AREA-A   12209013
122100         PERFORM 9999-WRITE-TO-CSSL                               12210013
122110                                                                  12211013
122120     END-IF.                                                      12212013
122130                                                                  12213013
122140       GOBACK.                                                    12214013
122150***********************************************************       12215013
122160                                                                  12216013
122170* CT 11/04/08 BEGIN                                               12217013
122180******************************************************************12218013
122190* DETERMINE WHAT LEVEL THE DC IS TURNED ON FOR DUAL FEED P&A     *12219013
122200*                                                                *12220013
122210*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *12221013
122220*----------------------------------------------------------------*12222013
122230 5003-SELECT-CONVEY-LVL.                                          12223013
122240*                                                                 12224013
122250** added internal table to track paragraph execution time         12225013
122260** dmh 2014-12-22 - begin                                         12226013
122270*                                                                 12227013
122280     MOVE  '5003'  TO  PT-CURR-PARA.                              12228013
122290     IF  PS-BLD-INTERNAL-TABLE-YES                                12229013
122300         PERFORM 0200-INTERNAL-TABLE                              12230013
122310     ELSE                                                         12231013
122320         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       12232013
122330     END-IF.                                                      12233013
122340                                                                  12234013
122350*                                                                 12235013
122360** DMH 2014-12-22 - END                                           12236013
122370*                                                                 12237013
122380     MOVE SU054-DC-NUMBER  TO SUT00107-OPER-UNT-ID                12238013
122390     EXEC SQL                                                     12239013
122400        SELECT                                                    12240013
122410            CNVYR_DIRV_LVL_CDE                                    12241013
122420        INTO                                                      12242013
122430            :PS-AUTO-CONVEY-LVL-SW                                12243013
122440        FROM                                                      12244013
122450            SUT_PNA_STA A                                         12245013
122460        WHERE A.OPER_UNT_ID     = :SUT00107-OPER-UNT-ID           12246013
122470          AND A.ACM_LBL_STA_NBR = :SUT00107-ACM-LBL-STA-NBR       12247013
122480         WITH UR                                                  12248013
122490     END-EXEC.                                                    12249013
122500                                                                  12250013
122510         EVALUATE TRUE                                            12251013
122520             WHEN SQLCODE = ZERO                                  12252013
122530                 CONTINUE                                         12253016
122540             WHEN SQLCODE = +100                                  12254013
122550                 MOVE 'NNE' TO PS-AUTO-CONVEY-LVL-SW              12255013
122560             WHEN SQLWARN0 NOT = SPACES                           12256013
122570             WHEN SQLCODE NOT EQUAL ZERO                          12257013
122580                                                                  12258013
122590              INITIALIZE PV-CICS-MSG-AREA1                        12259013
122600              INITIALIZE PV-CICS-MSG-AREA2                        12260013
122610                                                                  12261013
122620              MOVE SQLCODE              TO PV-DISP-SQLCODE        12262013
122630              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             12263013
122640              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           12264013
122650              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        12265013
122660                                                                  12266013
122670              STRING  ' SUKCS782 5003-'                           12267099
122680                      ' DC:'               PV-DISP-DC             12268013
122690                      ' B1:'               SU054-BAR-CODE-1       12269013
122700                      ' B2:'               SU054-BAR-CODE-2       12270013
122710                      ' B3:'               SU054-BAR-CODE-3       12271013
122720                                           DELIMITED BY SIZE      12272013
122730                                      INTO PV-CICS-MSG-AREA1      12273013
122740                                                                  12274013
122750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12275013
122760              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     12276013
122770                                                                  12277013
122780              PERFORM 9999-WRITE-TO-CSSL                          12278013
122790                                                                  12279013
122800              STRING  ' SUKCS782 '         SU054-KOHLS-SML        12280099
122810                      ' TRIP:'             PV-DISP-TRIP           12281013
122820                      ' DR:'               SU054-DOOR-NUMBER      12282013
122830                      ' USR:'              SU054-USER-ID          12283013
122840                      ' STA:'              PV-DISP-PNA-STA        12284013
122850                      ' SQL:'              PV-DISP-SQLCODE        12285013
122860                      ' SUT_PNA_STA'                              12286013
122870                                           DELIMITED BY SIZE      12287013
122880                                      INTO PV-CICS-MSG-AREA2      12288013
122890                                                                  12289013
122900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12290013
122910              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     12291013
122920                                                                  12292013
122930              PERFORM 9999-WRITE-TO-CSSL                          12293013
122940                                                                  12294013
122950              INITIALIZE PV-CICS-MSG-AREA3                        12295013
122960              MOVE SUT00107-OPER-UNT-ID     TO  PV-DISP-OPER      12296013
122970              MOVE SUT00107-ACM-LBL-STA-NBR TO  PV-DISP-PNA-STA   12297013
122980                                                                  12298013
122990              STRING  ' SUKCS782 '                                12299099
123000                      ' OPER:'         PV-DISP-OPER               12300013
123010                      ' PNA STA:'      PV-DISP-PNA-STA            12301013
123020                                           DELIMITED BY SIZE      12302013
123030                                      INTO PV-CICS-MSG-AREA3      12303013
123040                                                                  12304013
123050              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12305013
123060              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     12306013
123070                                                                  12307013
123080              PERFORM 9999-WRITE-TO-CSSL                          12308013
123090                                                                  12309013
123100                 SET PS-PROCESSING-ERROR-YES TO TRUE              12310013
123110                 PERFORM 9998-WRITE-TO-CSSL                       12311013
123120         END-EVALUATE.                                            12312013
123130                                                                  12313013
123140     IF PS-LOG-MESSAGE                                            12314013
123150              INITIALIZE PV-CICS-MSG-AREA1                        12315013
123160              INITIALIZE PV-CICS-MSG-AREA2                        12316013
123170                                                                  12317013
123180              MOVE SQLCODE              TO PV-DISP-SQLCODE        12318013
123190              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             12319013
123200              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           12320013
123210              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        12321013
123220                                                                  12322013
123230              STRING  ' SUKCS782 5003-'                           12323099
123240                      ' DC:'               PV-DISP-DC             12324013
123250                      ' B1:'               SU054-BAR-CODE-1       12325013
123260                      ' B2:'               SU054-BAR-CODE-2       12326013
123270                      ' B3:'               SU054-BAR-CODE-3       12327013
123280                                           DELIMITED BY SIZE      12328013
123290                                      INTO PV-CICS-MSG-AREA1      12329013
123300                                                                  12330013
123310              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12331013
123320              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     12332013
123330                                                                  12333013
123340              PERFORM 9999-WRITE-TO-CSSL                          12334013
123350                                                                  12335013
123360              STRING  ' SUKCS782 '         SU054-KOHLS-SML        12336099
123370                      ' TRIP:'             PV-DISP-TRIP           12337013
123380                      ' DR:'               SU054-DOOR-NUMBER      12338013
123390                      ' USR:'              SU054-USER-ID          12339013
123400                      ' STA:'              PV-DISP-PNA-STA        12340013
123410                      ' SQL:'              PV-DISP-SQLCODE        12341013
123420                      ' SUT_PNA_STA'                              12342013
123430                                           DELIMITED BY SIZE      12343013
123440                                      INTO PV-CICS-MSG-AREA2      12344013
123450                                                                  12345013
123460              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12346013
123470              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     12347013
123480                                                                  12348013
123490              PERFORM 9999-WRITE-TO-CSSL                          12349013
123500                                                                  12350013
123510              INITIALIZE PV-CICS-MSG-AREA3                        12351013
123520              MOVE SUT00107-OPER-UNT-ID     TO  PV-DISP-OPER      12352013
123530              MOVE SUT00107-ACM-LBL-STA-NBR TO  PV-DISP-PNA-STA   12353013
123540                                                                  12354013
123550              STRING  ' SUKCS782 '                                12355099
123560                      ' OPER:'         PV-DISP-OPER               12356013
123570                      ' PNA STA:'      PV-DISP-PNA-STA            12357013
123580                                           DELIMITED BY SIZE      12358013
123590                                      INTO PV-CICS-MSG-AREA3      12359013
123600                                                                  12360013
123610              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12361013
123620              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     12362013
123630                                                                  12363013
123640              PERFORM 9999-WRITE-TO-CSSL                          12364013
123650                                                                  12365013
123660     END-IF.                                                      12366013
123670                                                                  12367013
123680                                                                  12368013
123690* 09/23/13 SB BEG                                                 12369013
123700******************************************************************12370013
123710* CHECK FOR IMPORT REPLEN CARTONS                                *12371013
123720*                                                                *12372013
123730*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *12373013
123740*----------------------------------------------------------------*12374013
123750 5004-SELECT-FUNC-TXT.                                            12375013
123760*                                                                 12376013
123770** added internal table to track paragraph execution time         12377013
123780** dmh 2014-12-22 - begin                                         12378013
123790*                                                                 12379013
123800     MOVE  '5004'  TO  PT-CURR-PARA.                              12380013
123810     IF  PS-BLD-INTERNAL-TABLE-YES                                12381013
123820         PERFORM 0200-INTERNAL-TABLE                              12382013
123830     ELSE                                                         12383013
123840         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       12384013
123850     END-IF.                                                      12385013
123860                                                                  12386013
123870*                                                                 12387013
123880** DMH 2014-12-22 - END                                           12388013
123890*                                                                 12389013
123900                                                                  12390013
123910     INITIALIZE DCLTKRPRPM                                        12391013
123920                PV-20-DIGIT-BARCODE.                              12392013
123930     SET  PV-RFID-REPLEN-NO        TO TRUE.                       12393013
123940     MOVE PV-CTN-N                 TO PV-20-DIGIT-BARCODE.        12394013
123950     MOVE PV-20-SML-BC-DC-ORIGIN-R TO KRPRPM-LOC-ID.              12395013
123960                                                                  12396013
123970     EXEC SQL                                                     12397013
123980        SELECT                                                    12398013
123990            FUNC_TXT                                              12399013
124000        INTO                                                      12400013
124010            :PV-RFID-REPLEN-CHK-SW                                12401013
124020        FROM                                                      12402013
124030            TKRPRPM                                               12403013
124040        WHERE SYS_PRC_FUNC_CDE  = 'CIIRRT'                        12404013
124050          AND LOC_ID            = :KRPRPM-LOC-ID                  12405013
124060          AND CURRENT TIMESTAMP > FUNC_BEG_TMST                   12406013
124070     END-EXEC.                                                    12407013
124080                                                                  12408013
124090*    MOVE KRPRPM-FUNC-TXT TO PS-AUTO-CONVEY-LVL-SW.               12409013
124100                                                                  12410013
124110     EVALUATE TRUE                                                12411013
124120         WHEN SQLCODE = ZERO                                      12412013
124130         WHEN SQLCODE = +100                                      12413013
124140             CONTINUE                                             12414013
124150         WHEN SQLWARN0 NOT = SPACES                               12415013
124160         WHEN SQLCODE NOT EQUAL ZERO                              12416013
124170                                                                  12417013
124180              INITIALIZE PV-CICS-MSG-AREA1                        12418013
124190              INITIALIZE PV-CICS-MSG-AREA2                        12419013
124200                                                                  12420013
124210              MOVE SQLCODE              TO PV-DISP-SQLCODE        12421013
124220              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             12422013
124230              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           12423013
124240              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        12424013
124250                                                                  12425013
124260              STRING  'SUKCS782 5004-'                            12426099
124270                      ' DC:'               PV-DISP-DC             12427013
124280                      ' B1:'               SU054-BAR-CODE-1       12428013
124290                      ' B2:'               SU054-BAR-CODE-2       12429013
124300                      ' B3:'               SU054-BAR-CODE-3       12430013
124310                                           DELIMITED BY SIZE      12431013
124320                                      INTO PV-CICS-MSG-AREA1      12432013
124330                                                                  12433013
124340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12434013
124350              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     12435013
124360                                                                  12436013
124370              PERFORM 9999-WRITE-TO-CSSL                          12437013
124380                                                                  12438013
124390              STRING  'SUKCS782 '          SU054-KOHLS-SML        12439099
124400                      ' TRIP:'             PV-DISP-TRIP           12440013
124410                      ' DR:'               SU054-DOOR-NUMBER      12441013
124420                      ' USR:'              SU054-USER-ID          12442013
124430                      ' STA:'              PV-DISP-PNA-STA        12443013
124440                      ' SQL:'              PV-DISP-SQLCODE        12444013
124450                      ' TKRPRPM'                                  12445013
124460                                           DELIMITED BY SIZE      12446013
124470                                      INTO PV-CICS-MSG-AREA2      12447013
124480                                                                  12448013
124490              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12449013
124500              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     12450013
124510                                                                  12451013
124520              PERFORM 9999-WRITE-TO-CSSL                          12452013
124530                                                                  12453013
124540              INITIALIZE PV-CICS-MSG-AREA3                        12454013
124550              MOVE KRPRPM-LOC-ID            TO  PV-DISP-OPER      12455013
124560                                                                  12456013
124570              STRING  'SUKCS782 '                                 12457099
124580                      ' OPER:'         PV-DISP-OPER               12458013
124590                      ' PARM: CIIRRT'                             12459013
124600                                           DELIMITED BY SIZE      12460013
124610                                      INTO PV-CICS-MSG-AREA3      12461013
124620                                                                  12462013
124630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12463013
124640              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     12464013
124650                                                                  12465013
124660              PERFORM 9999-WRITE-TO-CSSL                          12466013
124670                                                                  12467013
124680             SET PS-PROCESSING-ERROR-YES TO TRUE                  12468013
124690             PERFORM 9998-WRITE-TO-CSSL                           12469013
124700     END-EVALUATE.                                                12470013
124710* 09/23/13 SB END                                                 12471013
124720                                                                  12472013
124730******************************************************************12473013
124740* CT 11/04/08 END                                                 12474013
124750                                                                  12475013
124760******************************************************************12476013
124770 5005-PRINT-MESSAGE-LABELS.                                       12477013
124780******************************************************************12478013
124790*                                                                 12479013
124800** added internal table to track paragraph execution time         12480013
124810** dmh 2014-12-22 - begin                                         12481013
124820*                                                                 12482013
124830     MOVE  '5005'  TO  PT-CURR-PARA.                              12483013
124840     IF  PS-BLD-INTERNAL-TABLE-YES                                12484013
124850         PERFORM 0200-INTERNAL-TABLE                              12485013
124860     ELSE                                                         12486013
124870         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       12487013
124880     END-IF.                                                      12488013
124890                                                                  12489013
124900*                                                                 12490013
124910** DMH 2014-12-22 - END                                           12491013
124920*                                                                 12492013
124930                                                                  12493013
124940       SET SU021-AUDIT-IS-COMPLETE TO TRUE                        12494013
124950*CLP 10/29/13                                                     12495013
124960       SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE                   12496013
124970*CLP 10/29/13                                                     12497013
124980       MOVE  3  TO PV-HNG-FOLD-SEQ-NBR                            12498013
124990       MOVE  0  TO PV-BUS-AREA-ID                                 12499013
125000**will not call hang fold module as indicator does not appear on  12500013
125010**the message label, however, a value is required for insert to   12501013
125020**tlbptda field gb 2/1/02                                         12502013
125030       IF PS-ECOMM-DC-REPURPOSE AND PS-PROCESSING-ERROR-NO        12503013
125040*gb 5/8/08 pbs flag checked when deteriming label type in 8000-   12504013
125050*      if not turned off, will create pbs sml not                 12505013
125060*      repurp label                                               12506013
125070          SET PS-NOT-PACK-BY-STORE  TO TRUE                       12507013
125080*gb 5/8/08 end                                                    12508013
125090          PERFORM 6560-DETERMINE-WEIGHTS-MSRS                     12509013
125100       END-IF                                                     12510013
125110                                                                  12511013
125120       EVALUATE TRUE                                              12512013
125130           WHEN PS-MULTI-LINE                                     12513013
125140              MOVE  '*MULTIPLE LINES*' TO  PV-VEND-STYL-NAME      12514013
125150           WHEN  PS-NO-LINE                                       12515013
125160              MOVE  '** NO LINE NUMBER **' TO  PV-VEND-STYL-NAME  12516013
125170           WHEN  OTHER                                            12517013
125180               CONTINUE                                           12518013
125190       END-EVALUATE                                               12519013
125200       MOVE 'N' TO LBVRDA-INPK-CNVYB-IND                          12520013
125210       IF PS-WHSE-OTBND-CART-YES                                  12521013
125220           CONTINUE                                               12522013
125230       ELSE                                                       12523013
125240           IF PS-PROCESSING-ERROR-NO AND PS-VALID-BRCDE-FOUND     12524013
125250              PERFORM 7235-GET-OUTER-PACK                         12525013
125260              PERFORM 7230-GET-DEPT-CL-SKU                        12526013
125270              PERFORM 7400-GET-DEPT-NAME                          12527013
125280              PERFORM 7150-CHECK-DC-LOC                           12528013
125290           END-IF                                                 12529013
125300       END-IF                                                     12530013
125310                                                                  12531013
125320*  THE FOLLOWING IF STATEMENT WAS PUT IN TO ELIMINATE A LOOP      12532013
125330*  CONDITION.  IF THE ORIGINAL ERROR WAS CAUSED BY A BAD SQL      12533013
125340*  CODE IN THE INSERT IN 7205, THE PROGRAM CAME THROUGH THIS      12534013
125350*  PARAGRAPH AGAIN VIA 9998-WRITE-TO-CSSL AND TRIED TO INSERT     12535013
125360*  AGAIN AND THEN GOT IN A LOOP.  THE PS-INSERT-ERROR-YES SWITCH  12536013
125370*  WILL BYPASS THE ATTEMPT TO GO INTO THE 7205 PARAGRAPH AGAIN.   12537013
125380                                                                  12538013
125390       IF  PS-INSERT-ERROR-YES                                    12539013
125400           CONTINUE                                               12540013
125410       ELSE                                                       12541013
125420           PERFORM 7200-GATHER-LABEL-INFO                         12542013
125430           PERFORM 7205-INSERT-LABEL-TABLE                        12543013
125440       END-IF.                                                    12544013
125450                                                                  12545013
125460       IF PS-PROCESSING-ERROR-NO                                  12546013
125470          IF PS-UCC128-PKSLIP-ERROR-NO AND                        12547013
125480             PS-VALID-BRCDE-FOUND      AND                        12548013
125490* CLP 06/20/13 PR5148B START                                      12549013
125500             PS-RECITM-VERIFIED-LINES-NO AND                      12550013
125510             PS-WHSE-OTBND-CART-NO                                12551013
125520* CLP 06/20/13 PR5148B END                                        12552013
125530             IF SU054-ASGMT-STRT-DTE  > SPACES                    12553013
125540                PERFORM 5700-CALL-XLKUP033-EAI                    12554013
125550             END-IF                                               12555013
125560          END-IF                                                  12556013
125570       END-IF                                                     12557013
125580       PERFORM 8000-LOAD-LABEL-DATA-SML.                          12558013
125590                                                                  12559013
125600       MOVE SU054-CRTN-CHECKIN-RECORD TO  DFHCOMMAREA             12560013
125610                                                                  12561013
125620     IF  PS-BLD-INTERNAL-TABLE-YES  and                           12562013
125630         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  12563013
125640                                                                  12564013
125650         move spaces to  pv-ciCS-MSG-AREA-A                       12565013
125660         PERFORM 9999-WRITE-TO-CSSL                               12566013
125670                                                                  12567013
125680         INITIALIZE PV-CICS-MSG-AREA-A                            12568013
125690         move pv-duration-sec to  PV-disp-duration                12569013
125700         STRING ' SUKCS782-DID NOT MEET SLA'                      12570099
125710               ' 5005-'                                           12571013
125720               ' DC:'        SU054-DC-NUMBER                      12572013
125730               ' STA:'       SU054-ACCM-LINE-NMBR                 12573013
125740               ' KEY:'       PV-INIT-TIME-KEY                     12574013
125750               ' tmst:'      PV-curr-TIMESTAMP                    12575013
125760               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   12576013
125770                                        INTO PV-CICS-MSG-AREA-A   12577013
125780         PERFORM 9999-WRITE-TO-CSSL                               12578013
125790                                                                  12579013
125800         INITIALIZE PV-CICS-MSG-AREA-A                            12580013
125810         STRING ' SUKCS782-'                                      12581099
125820               ' 5005-'                                           12582013
125830               ' KEY:'       PV-INIT-TIME-KEY                     12583013
125840               ' init:'      PV-init-TIMESTAMP                    12584013
125850               ' curr:'      PV-curr-timestamp DELIMITED BY SIZE  12585013
125860                                        INTO PV-CICS-MSG-AREA-A   12586013
125870         PERFORM 9999-WRITE-TO-CSSL                               12587013
125880                                                                  12588013
125890         PERFORM 0205-WRITE-SUWS054-TO-CSSL                       12589013
125900                                                                  12590013
125910         move spaces to  pv-ciCS-MSG-AREA-A                       12591013
125920         PERFORM 9999-WRITE-TO-CSSL                               12592013
125930                                                                  12593013
125940         PERFORM 0210-DUMP-TABLE-TO-CSSL                          12594013
125950         VARYING PT-TRACK-IDX                                     12595013
125960            FROM 1 BY 1                                           12596013
125970           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 12597013
125980              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             12598013
125990                                                                  12599013
126000         PERFORM 0220-CLEAR-TABLE                                 12600013
126010         VARYING PT-TRACK-IDX                                     12601013
126020            FROM 1 BY 1                                           12602013
126030           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 12603013
126040              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             12604013
126050                                                                  12605013
126060         MOVE ZEROES TO PT-CURR-ENTRIES                           12606013
126070         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   12607013
126080                                                                  12608013
126090         INITIALIZE PV-CICS-MSG-AREA-A                            12609013
126100         move pv-duration-sec to  PV-disp-duration                12610013
126110         STRING ' SUKCS782-DID NOT MEET SLA'                      12611099
126120               ' 5005-'                                           12612013
126130               ' DC:'        SU054-DC-NUMBER                      12613013
126140               ' STA:'       SU054-ACCM-LINE-NMBR                 12614013
126150               ' KEY:'       PV-INIT-TIME-KEY                     12615013
126160               ' done'                       delimited by size    12616013
126170                                        INTO PV-CICS-MSG-AREA-A   12617013
126180         PERFORM 9999-WRITE-TO-CSSL                               12618013
126190                                                                  12619013
126200         move spaces to  pv-ciCS-MSG-AREA-A                       12620013
126210         PERFORM 9999-WRITE-TO-CSSL                               12621013
126220                                                                  12622013
126230     END-IF.                                                      12623013
126240                                                                  12624013
126250     IF  PS-LOG-MESSAGE                                           12625013
126260         INITIALIZE PV-CICS-MSG-AREA-A                            12626013
126270         move pv-duration-sec  to   PV-disp-duration              12627013
126280         STRING ' SUKCS782-ENDED  '                               12628099
126290               ' 5005-'                                           12629013
126300               ' DC:'        SU054-DC-NUMBER                      12630013
126310               ' STA:'       SU054-ACCM-LINE-NMBR                 12631013
126320               ' KEY:'       PV-INIT-TIME-KEY                     12632013
126330               ' tmst:'      PV-curr-TIMESTAMP                    12633013
126340               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   12634013
126350                                        INTO PV-CICS-MSG-AREA-A   12635013
126360         PERFORM 9999-WRITE-TO-CSSL                               12636013
126370                                                                  12637013
126380     END-IF.                                                      12638013
126390                                                                  12639013
126400       GOBACK.                                                    12640013
126401                                                                  12640184
126402                                                                  12640284
126403******************************************************************12640384
126404 5005B-THIN-SLICE-LABELS.                                         12640484
126405******************************************************************12640584
126406                                                                  12640684
126410     MOVE  '500B'  TO  PT-CURR-PARA.                              12641084
126411     IF  PS-BLD-INTERNAL-TABLE-YES                                12641184
126412         PERFORM 0200-INTERNAL-TABLE                              12641284
126413     ELSE                                                         12641384
126414         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       12641484
126415     END-IF.                                                      12641584
126420                                                                  12642084
126421     IF  PS-LOG-MESSAGE                                           12642195
126422         move spaces to  pv-ciCS-MSG-AREA-A                       12642295
126423         PERFORM 9999-WRITE-TO-CSSL                               12642395
126424         PERFORM 0205-WRITE-SUWS054-TO-CSSL                       12642495
126425                                                                  12642595
126426         INITIALIZE PV-CICS-MSG-AREA-A                            12642695
126427         STRING ' SUKCS782-5005B - '                              12642799
126429               ' DC:'   SU054-DC-NUMBER                           12642995
126430               ' STA:'  SU054-ACCM-LINE-NMBR                      12643095
126432               ' BARCODE:' SU054-KOHLS-SML    DELIMITED BY SIZE   12643295
126433                                        INTO PV-CICS-MSG-AREA-A   12643395
126434         PERFORM 9999-WRITE-TO-CSSL                               12643495
126435                                                                  12643595
126436     END-IF.                                                      12643695
126437                                                                  12643795
126438     SET PS-UCC128-GENERAL-MESS                                   12643890
126439         PS-RFID-ON-LABEL-NO                                      12643990
126440         PS-WHSE-OTBND-CART-NO                                    12644090
126441         SU021-AUDIT-IS-COMPLETE                                  12644190
126442         SU021-RFID-AUDIT-IS-COMPLETE TO TRUE.                    12644290
126450                                                                  12645084
126451     move zeroes               to  LBPTDA-TRIP-ID                 12645187
126452                                   LBPTDA-LBL-PRT-BTCH-ID         12645287
126453                                   LBPTDA-SHIPT-UNT-ID            12645387
126454                                   LBPTDA-OPER-UNT-ID             12645487
126455                                   LBPTDA-FCLTY-ID                12645587
126456                                   LBPTDA-MISDIR-OPER-UNT-ID      12645687
126457                                   LBPTDA-PO-NBR                  12645787
126458                                   LBPTDA-RCVR-SEQ-NBR            12645887
126459                                   LBPTDA-PO-LNE-NBR              12645987
126460                                   LBPTDA-DEST-OPER-UNT-ID        12646087
126461                                   LBPTDA-OTPK-UNT-QTY            12646187
126462                                   LBPTDA-INPK-UNT-QTY            12646287
126463                                   LBPTDA-PREPK-ID                12646387
126464                                   LBPTDA-PREPK-RATO-QTY          12646487
126465                                   LBPTDA-PREPK-UNT-QTY           12646587
126466                                   LBPTDA-CSE-PK-QTY              12646687
126467                                   LBPTDA-LBL-TYP-LBL-SEQ-ID      12646787
126468                                   LBPTDA-LBL-TYP-TOT-QTY         12646887
126469                                   LBPTDA-ITM-NBR                 12646987
126470                                   LBPTDA-HNG-FOLD-SEQ-NBR        12647087
126471                                   LBPTDA-BUS-AREA-ID             12647187
126472                                   LBPTDA-SKU-NBR.                12647287
126473                                                                  12647387
126475     MOVE SPACES               TO  LBPTDA-CRE-USR-ID              12647587
126476                                   LBPTDA-CRE-TMST                12647687
126477                                   LBPTDA-OWNR-SCAC-ID            12647787
126478                                   LBPTDA-VEH-NBR                 12647887
126479                                   LBPTDA-RPRT-IND                12647987
126480                                   LBPTDA-SU-DUP-LBL-IND          12648087
126481                                   LBPTDA-SU-FRE-ASTRA-IND        12648187
126482                                   LBPTDA-SU-MSSG-DAT-IND         12648287
126483                                   LBPTDA-SU-MISDIR-IND           12648387
126484                                   LBPTDA-STR-NM                  12648487
126485                                   LBPTDA-STR-ZN-ID               12648587
126486                                   LBPTDA-SKU-DEPT-NBR            12648687
126487                                   LBPTDA-SKU-CL-NBR              12648787
126488                                   LBPTDA-VS-NBR                  12648887
126489                                   LBPTDA-PRTR-ID                 12648987
126490                                   LBPTDA-BRCDE-NBR               12649087
126491                                   LBPTDA-DC-PRTD-AT-CDE          12649187
126492                                   LBPTDA-INVLD-DAT-ERR-CDE       12649287
126493                                   LBPTDA-ODD-CART-IND            12649387
126494                                   LBPTDA-INPK-CNVYB-IND          12649487
126495                                   LBPTDA-MODU-DESC               12649587
126498                                   LBPTDA-DEPT-DESC               12649887
126499                                   LBPTDA-MAJ-CL-DESC             12649987
126500                                   LBPTDA-SEASET-NM               12650087
126501                                   LBPTDA-FIXT-ID                 12650187
126502                                   LBPTDA-CART-LBL-TYP-CDE        12650287
126510                                   LBPTDA-STRG-AREA-CDE           12651087
126511                                   LBPTDA-CART-ACTN-CDE           12651187
126523                                   LBPTDA-DOOR-ID                 12652387
126524                                   LBPTDA-PRC-MSG-CDE.            12652488
126525                                                                  12652589
126526     move  'N'                     to  LBPTDA-EAS-TAG-IND.        12652689
126529                                                                  12652987
126530     MOVE  'N'                     TO  LBVRDA-INPK-CNVYB-IND.     12653084
126531     MOVE  SPACE                   TO  LBPTDA-PRC-MSG-CDE.        12653184
126532     MOVE  PV-CTN-N                TO  LBPTDA-SHIPT-UNT-ID.       12653284
126533     MOVE  SU054-TRIP-ID           TO  LBPTDA-TRIP-ID.            12653384
126534     MOVE  SU054-ACCM-LINE-NMBR    TO  LBPTDA-PRTR-ID.            12653484
126535     MOVE  PV-BATCH-NUMBER         TO  LBPTDA-LBL-PRT-BTCH-ID.    12653584
126536     MOVE  RECEIV-CURR-OPER-UNT-ID TO  LBPTDA-OPER-UNT-ID.        12653684
126537     MOVE  +1                      TO  LBPTDA-FCLTY-ID.           12653784
126538     MOVE  SU109-ORD-NBR           TO  LBPTDA-PO-NBR.             12653884
126539     MOVE  SU109-REC-SEQ-NBR       TO  LBPTDA-RCVR-SEQ-NBR.       12653984
126540     MOVE  SU109-ORD-LNE-NBR       TO  LBPTDA-PO-LNE-NBR.         12654084
126541     MOVE  SU109-DOOR-NUMBER       TO  LBPTDA-DOOR-ID.            12654184
126542     MOVE  ZEROES                  TO  LBPTDA-DEST-OPER-UNT-ID.   12654284
126543     MOVE  SU054-DC-NUMBER         TO  LBPTDA-MISDIR-OPER-UNT-ID. 12654384
126544     MOVE  ZEROES                  TO  LBPTDA-OTPK-UNT-QTY.       12654484
126545     MOVE  ZEROES                  TO  LBPTDA-HNG-FOLD-SEQ-NBR.   12654584
126546     MOVE  ZEROES                  TO  LBPTDA-SKU-NBR.            12654686
126547                                                                  12654786
126548     MOVE 'NEW CK-IN'              TO  LBPTDA-BRCDE-NBR.          12654885
126549                                                                  12654990
126550     MOVE 'J'                      TO  LBPTDA-CART-LBL-TYP-CDE.   12655090
126560     MOVE PS-MESSG-LBL-IND         TO  LBPTDA-SU-MSSG-DAT-IND.    12656091
126570                                                                  12657090
126619     PERFORM 7205B-INSERT-LABEL-TABLE.                            12661985
126620                                                                  12662084
126623     SET  SU054-GENERIC-MESSAGE-LBL-REQ                           12662393
126624          SU054-KOHLS-MESSAGE-LABEL                               12662490
126625          SU054-THIN-SLICE-ELIGIBLE      TO  TRUE.                12662590
126626                                                                  12662690
126627     MOVE +1                          TO SU054-FRCD-DIVERT-IND.   12662799
126628                                                                  12662890
126648     MOVE 'NEW CK-IN'                 TO PC248-IINFO-MSG          12664899
126649                                                                  12664999
126650     MOVE '@@@@@'                     TO PC248-CARTON-ID          12665099
126656     MOVE '@@@@@@@@'                  TO PC248-LNE-PCK-HDG        12665699
126657     MOVE '@@@@@@@@@@@@@@'            TO PC248-PCK-UNTS-HDG       12665799
126658     MOVE '@@@@@@@@@@@@@@@@'          TO PC248-PKINOT-UNTS-HDG    12665899
126659     MOVE '@@@@'                      TO PC248-PCK-UNTS           12665999
126660     MOVE '@@@@@@@@@@'                TO PC248-FIXTURE            12666099
126661     MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO PC248-SET                12666199
126662     MOVE '@@@@@@@@@'                 TO PC248-TRIP-ID            12666299
126663                                                                  12666399
126664     MOVE 0                           TO PC248-PO-LNE-NBR         12666499
126665                                         PC248-PCK-UNTS           12666599
126666                                         PC248-OUTPK-UNTS         12666699
126678                                         PC248-PKINOUT-UNTS       12667899
126679                                         PC248-SKU-NBR            12667999
126680                                         PC248-STORE-NBR          12668099
126681                                         PC248-LABEL-NBR          12668199
126682                                         PC248-TOT-LABEL.         12668299
126683                                                                  12668399
126684     MOVE SPACES                      TO PC248-STYLE              12668499
126685                                         PC248-SML-PRTR-NBR       12668599
126686                                         PC248-LBL-PRT-DATE       12668699
126687                                         PC248-LBL-PRT-TIME       12668799
126688                                         PC248-DEPT-CLASS-NAME    12668899
126689                                         PC248-FIXTURE.           12668999
126690                                                                  12669099
126691     MOVE PV-PO-RCVR                  TO PC248-PO-RCVR-NBR        12669199
126692     MOVE PC248-FORM-OTPK-HDG         TO PC248-OUTPK-UNTS-HDG     12669299
126693     MOVE PC248-FORM-NO-INPK-BOX      TO PC248-INPK-CONVY-BOX     12669399
126694                                                                  12669499
126698     MOVE PC248-FORM-NO-RPRT-BOX      TO PC248-REPRINT-BOX        12669899
126699     MOVE PC248-FORM-NO-RPRT-FLD      TO PC248-REPRINT-TEXT       12669999
126712                                                                  12671299
126750     MOVE 'CI'                        TO PC248-FROM-APPLICATION   12675099
126751     MOVE 'PRTAP'                     TO PC248-PRTR-ATTACHED      12675199
126752     MOVE '-SML-'                     TO PC248-LBL-DESC           12675299
126753     MOVE PC248-LABEL-INFO-WORK       TO PC248-LABEL-INFO         12675399
126776                                                                  12677699
126796     MOVE SU054-USER-ID               TO PC248-USER-ID.           12679699
126797                                                                  12679799
126801     MOVE ' CARTON SELECTED'          TO PC248-ERROR-MSG-1        12680199
126804     MOVE ' THIN SLICE PROCESSING'    TO PC248-ERROR-MSG-2        12680499
126952                                                                  12695299
126993     MOVE PC-OF                       TO PC248-LABEL-OF.          12699399
126995                                                                  12699599
126996     MOVE PC248-SML-BATCH-LBL       TO SU054-LABEL-DATA-FORMAT.   12699699
126997                                                                  12699799
126998     MOVE SU054-CRTN-CHECKIN-RECORD TO  DFHCOMMAREA.              12699899
126999                                                                  12699999
127001                                                                  12700190
127002     IF  PS-BLD-INTERNAL-TABLE-YES  and                           12700284
127003         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  12700384
127004                                                                  12700484
127005         move spaces to  pv-ciCS-MSG-AREA-A                       12700584
127006         PERFORM 9999-WRITE-TO-CSSL                               12700684
127007                                                                  12700784
127008         INITIALIZE PV-CICS-MSG-AREA-A                            12700884
127009         move pv-duration-sec to  PV-disp-duration                12700984
127010         STRING ' SUKCS782-DID NOT MEET SLA'                      12701099
127011               ' 5005-'                                           12701184
127012               ' DC:'        SU054-DC-NUMBER                      12701284
127013               ' STA:'       SU054-ACCM-LINE-NMBR                 12701384
127014               ' KEY:'       PV-INIT-TIME-KEY                     12701484
127015               ' tmst:'      PV-curr-TIMESTAMP                    12701584
127016               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   12701684
127017                                        INTO PV-CICS-MSG-AREA-A   12701784
127018         PERFORM 9999-WRITE-TO-CSSL                               12701884
127019                                                                  12701984
127020         INITIALIZE PV-CICS-MSG-AREA-A                            12702084
127021         STRING ' SUKCS782-'                                      12702199
127022               ' 5005-'                                           12702284
127023               ' KEY:'       PV-INIT-TIME-KEY                     12702384
127024               ' init:'      PV-init-TIMESTAMP                    12702484
127025               ' curr:'      PV-curr-timestamp DELIMITED BY SIZE  12702584
127026                                        INTO PV-CICS-MSG-AREA-A   12702684
127027         PERFORM 9999-WRITE-TO-CSSL                               12702784
127028                                                                  12702884
127029         PERFORM 0205-WRITE-SUWS054-TO-CSSL                       12702984
127030                                                                  12703084
127031         move spaces to  pv-ciCS-MSG-AREA-A                       12703184
127032         PERFORM 9999-WRITE-TO-CSSL                               12703284
127033                                                                  12703384
127034         PERFORM 0210-DUMP-TABLE-TO-CSSL                          12703484
127035         VARYING PT-TRACK-IDX                                     12703584
127036            FROM 1 BY 1                                           12703684
127037           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 12703784
127038              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             12703884
127039                                                                  12703984
127040         PERFORM 0220-CLEAR-TABLE                                 12704084
127041         VARYING PT-TRACK-IDX                                     12704184
127042            FROM 1 BY 1                                           12704284
127043           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 12704384
127044              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             12704484
127045                                                                  12704584
127046         MOVE ZEROES TO PT-CURR-ENTRIES                           12704684
127047         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   12704784
127048                                                                  12704884
127049         INITIALIZE PV-CICS-MSG-AREA-A                            12704984
127050         move pv-duration-sec to  PV-disp-duration                12705084
127051         STRING ' SUKCS782-DID NOT MEET SLA'                      12705199
127052               ' 5005-'                                           12705284
127053               ' DC:'        SU054-DC-NUMBER                      12705384
127054               ' STA:'       SU054-ACCM-LINE-NMBR                 12705484
127055               ' KEY:'       PV-INIT-TIME-KEY                     12705584
127056               ' done'                       delimited by size    12705684
127057                                        INTO PV-CICS-MSG-AREA-A   12705784
127058         PERFORM 9999-WRITE-TO-CSSL                               12705884
127059                                                                  12705984
127060         move spaces to  pv-ciCS-MSG-AREA-A                       12706084
127061         PERFORM 9999-WRITE-TO-CSSL                               12706184
127062                                                                  12706284
127063     END-IF.                                                      12706384
127064                                                                  12706484
127065     IF  PS-LOG-MESSAGE                                           12706584
127066         INITIALIZE PV-CICS-MSG-AREA-A                            12706684
127067         move pv-duration-sec  to   PV-disp-duration              12706784
127068         STRING ' SUKCS782-ENDED  '                               12706899
127069               ' 5005-'                                           12706984
127070               ' DC:'        SU054-DC-NUMBER                      12707084
127071               ' STA:'       SU054-ACCM-LINE-NMBR                 12707184
127072               ' KEY:'       PV-INIT-TIME-KEY                     12707284
127073               ' tmst:'      PV-curr-TIMESTAMP                    12707384
127074               ' DURATION:'  PV-disp-duration DELIMITED BY SIZE   12707484
127075                                        INTO PV-CICS-MSG-AREA-A   12707584
127076         PERFORM 9999-WRITE-TO-CSSL                               12707684
127077                                                                  12707784
127078     END-IF.                                                      12707884
127079                                                                  12707995
127080     IF  PS-LOG-MESSAGE                                           12708095
127081         MOVE SPACES TO  PV-CICS-MSG-AREA-A                       12708198
127082         PERFORM 9999-WRITE-TO-CSSL                               12708295
127083         PERFORM 0205-WRITE-SUWS054-TO-CSSL                       12708395
127084                                                                  12708495
127085         MOVE SPACES TO  PV-CICS-MSG-AREA-A                       12708598
127086         STRING ' SUKCS782-5005B - '                              12708699
127087               ' BEFORE GOBACK'                                   12708795
127088               ' BARCODE:' SU054-KOHLS-SML                        12708898
127089               ' DVRT:'    SU054-MODULE-DIVERT-CDE                12708998
127090               ' REQ:'     SU054-REQUEST-LABEL-CDE                12709098
127091               ' LBL:'     SU054-LABEL-PROCESSING                 12709198
127092               ' THIN:'    SU054-THIN-SLICE-IND                   12709298
127093               ' ***'                                             12709398
127094                                              DELIMITED BY SIZE   12709498
127095                                        INTO PV-CICS-MSG-AREA-A   12709598
127096         PERFORM 9999-WRITE-TO-CSSL                               12709698
127097                                                                  12709798
127098         MOVE SPACES TO  PV-CICS-MSG-AREA-A                       12709898
127099         PERFORM 9999-WRITE-TO-CSSL                               12709998
127100                                                                  12710098
127101     END-IF.                                                      12710198
127102                                                                  12710298
127103                                                                  12710398
127104       GOBACK.                                                    12710498
127105                                                                  12710598
127106                                                                  12710698
127107***********************************************************       12710798
127108 5060-CALL-SEA-SET-MODULE.                                        12710898
127109*                                                                 12710998
127110** added internal table to track paragraph execution time         12711098
127111** dmh 2014-12-22 - begin                                         12711198
127112*                                                                 12711298
127113     MOVE  '5060'  TO  PT-CURR-PARA.                              12711398
127114     IF  PS-BLD-INTERNAL-TABLE-YES                                12711498
127115         PERFORM 0200-INTERNAL-TABLE                              12711598
127116     ELSE                                                         12711698
127117         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       12711798
127118     END-IF.                                                      12711898
127119                                                                  12711998
127120*                                                                 12712098
127121** DMH 2014-12-22 - END                                           12712198
127122*                                                                 12712298
127123                                                                  12712398
127124     INITIALIZE PC240-ITEM-COMMAREA                               12712498
127125     MOVE PV-CTN-N                    TO PC240-KEY-CARTON-ID      12712598
127126     MOVE PV-PO-NBR                   TO PC240-KEY-PO             12712698
127127     MOVE PV-DEST-STORE               TO PC240-KEY-DEST-LOC       12712798
127128     SET  PC240-CHECK-IN              TO TRUE                     12712898
127129     CALL PC240-VSM-PGM USING DFHEIBLK                            12712998
127130                              PC240-COMMAREA                      12713098
127131                              PC240-ITEM-COMMAREA                 12713198
127132     EVALUATE TRUE                                                12713298
127133         WHEN PC240-SUCCESSFUL                                    12713398
127134             MOVE PC240-DIVERT-PFX-NBR TO PV-STORE-NBR-PFX        12713498
127135                                          PV-BAR-CODE-DIVERT-PFX  12713598
127136             MOVE PC240-SEASET-NM      TO SEASET-SEASET-NM        12713698
127137             IF PC240-FIXT-ID  > SPACES                           12713798
127138                MOVE PC240-FIXT-ID    TO PV-FIXTURE-ID            12713898
127139             END-IF                                               12713998
127140         WHEN PC240-ITEM-NOT-FOUND                                12714098
127141                MOVE PC-00 TO PV-STORE-NBR-PFX                    12714198
127142                              PV-BAR-CODE-DIVERT-PFX              12714298
127143         WHEN PC240-SQL-ERROR                                     12714398
127144         WHEN PC240-INVALID-ACCESS                                12714498
127145                                                                  12714598
127146              INITIALIZE PV-CICS-MSG-AREA1                        12714698
127147              INITIALIZE PV-CICS-MSG-AREA2                        12714713
127148                                                                  12714813
127149              MOVE SQLCODE              TO PV-DISP-SQLCODE        12714913
127150              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             12715013
127151              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           12715113
127152              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        12715213
127153                                                                  12715313
127154              STRING  'SUKCS782 5060-'                            12715499
127155                      ' DC:'               PV-DISP-DC             12715513
127156                      ' B1:'               SU054-BAR-CODE-1       12715613
127157                      ' B2:'               SU054-BAR-CODE-2       12715713
127158                      ' B3:'               SU054-BAR-CODE-3       12715813
127159                                           DELIMITED BY SIZE      12715913
127160                                      INTO PV-CICS-MSG-AREA1      12716013
127161                                                                  12716113
127162              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12716213
127163              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     12716313
127164                                                                  12716413
127165              PERFORM 9999-WRITE-TO-CSSL                          12716513
127166                                                                  12716613
127167              STRING  'SUKCS782 '          SU054-KOHLS-SML        12716799
127168                      ' TRIP:'             PV-DISP-TRIP           12716813
127169                      ' DR:'               SU054-DOOR-NUMBER      12716913
127170                      ' USR:'              SU054-USER-ID          12717013
127171                      ' STA:'              PV-DISP-PNA-STA        12717113
127172                      ' SQL:'              PV-DISP-SQLCODE        12717213
127173                      ' TKRPRPM'                                  12717313
127174                                           DELIMITED BY SIZE      12717413
127175                                      INTO PV-CICS-MSG-AREA2      12717513
127176                                                                  12717613
127177              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12717713
127178              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     12717813
127179                                                                  12717913
127180              PERFORM 9999-WRITE-TO-CSSL                          12718013
127181                                                                  12718113
127182              INITIALIZE PV-CICS-MSG-AREA3                        12718213
127183                                                                  12718313
127184              STRING  'SUKCS782 (PCKUT025)'                       12718499
127190                      ' SQL ERROR/INVALID ACCESS '                12719013
127200                      ' METH:'         PC240-ACCESS-METHOD        12720013
127210                      ' RC:'           PC240-RETURN-CODE          12721013
127220                      ' FLAGS:'        PC240-FLAGS                12722013
127230                      ' ERR:'          PC240-ERROR-NBR            12723013
127240                                           DELIMITED BY SIZE      12724013
127250                                      INTO PV-CICS-MSG-AREA3      12725013
127260                                                                  12726013
127270              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12727013
127280              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     12728013
127290                                                                  12729013
127300              PERFORM 9999-WRITE-TO-CSSL                          12730013
127310                                                                  12731013
127320              INITIALIZE PV-CICS-MSG-AREA4                        12732013
127330              MOVE PC240-KEY-PO          TO PV-DISP-PO            12733013
127340              MOVE PC240-KEY-REC-SEQ-NBR TO PV-DISP-RCVR          12734013
127350              MOVE PC240-KEY-LNE-NBR     TO pv-disp-line          12735013
127360              MOVE PC240-KEY-PREPK-ID    TO PV-DISP-PREPK         12736013
127370              MOVE PC240-KEY-UPC-NBR     TO PV-DISP-UPC           12737013
127380              MOVE PC240-KEY-DEST-LOC    TO PV-DISP-DEST-OPER     12738013
127390                                                                  12739013
127400              STRING  'SUKCS782 '                                 12740099
127410                      ' PO:'           PV-DISP-PO                 12741013
127420                      '-'              PV-DISP-RCVR               12742013
127430                      '-'              pv-disp-line               12743013
127440                      ' PREPK:'        PV-DISP-PREPK              12744013
127450                      ' UPC:'          PV-DISP-UPC                12745013
127460                      ' DEST:'         PV-DISP-DEST-OPER          12746013
127470                      ' DEPT-CL-SUB'   PC240-KEY-DEPT-NBR         12747013
127480                      '-'              PC240-KEY-CL-NBR           12748013
127490                      '-'              PC240-KEY-SKU-SEQ-NBR      12749013
127500                                           DELIMITED BY SIZE      12750013
127510                                      INTO PV-CICS-MSG-AREA4      12751013
127520                                                                  12752013
127530              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12753013
127540              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     12754013
127550                                                                  12755013
127560              PERFORM 9999-WRITE-TO-CSSL                          12756013
127570                                                                  12757013
127580              INITIALIZE PV-CICS-MSG-AREA5                        12758013
127590              MOVE PC240-KEY-SKU         TO PV-DISP-SKU           12759013
127600              MOVE PC240-KEY-CARTON-ID   TO PV-DISP-SSCC          12760013
127610              MOVE PC240-INTR-UPC-ID     TO PV-DISP-UPCID         12761013
127620              MOVE PC240-SKU-NBR         TO PV-DISP-SKU2          12762013
127630                                                                  12763013
127640              STRING  'SUKCS782 '                                 12764099
127650                      ' KEY-SKU'       PV-DISP-SKU                12765013
127660                      ' SSCC:'         PV-DISP-SSCC               12766013
127670                      ' INTR UPC:'     PV-DISP-UPCID              12767013
127680                      ' PREPK:'        PV-DISP-SKU2               12768013
127690                                           DELIMITED BY SIZE      12769013
127700                                      INTO PV-CICS-MSG-AREA5      12770013
127710                                                                  12771013
127720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12772013
127730              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     12773013
127740                                                                  12774013
127750              PERFORM 9999-WRITE-TO-CSSL                          12775013
127760                                                                  12776013
127770              INITIALIZE PV-CICS-MSG-AREA6                        12777013
127780                                                                  12778013
127790              STRING  'SUKCS782 '                                 12779099
127800                      ' SQLCA:'        PC240-SQLCA                12780013
127810                                           DELIMITED BY SIZE      12781013
127820                                      INTO PV-CICS-MSG-AREA6      12782013
127830                                                                  12783013
127840              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12784013
127850              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     12785013
127860                                                                  12786013
127870              PERFORM 9999-WRITE-TO-CSSL                          12787013
127880                                                                  12788013
127890             SET PS-PROCESSING-ERROR-YES TO TRUE                  12789013
127900             PERFORM 9998-WRITE-TO-CSSL                           12790013
127910                                                                  12791013
127920         WHEN OTHER                                               12792013
127930                                                                  12793013
127940              INITIALIZE PV-CICS-MSG-AREA1                        12794013
127950              INITIALIZE PV-CICS-MSG-AREA2                        12795013
127960                                                                  12796013
127970              MOVE SQLCODE              TO PV-DISP-SQLCODE        12797013
127980              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             12798013
127990              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           12799013
128000              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        12800013
128010                                                                  12801013
128020              STRING  'SUKCS782 5060-'                            12802099
128030                      ' DC:'               PV-DISP-DC             12803013
128040                      ' B1:'               SU054-BAR-CODE-1       12804013
128050                      ' B2:'               SU054-BAR-CODE-2       12805013
128060                      ' B3:'               SU054-BAR-CODE-3       12806013
128070                                           DELIMITED BY SIZE      12807013
128080                                      INTO PV-CICS-MSG-AREA1      12808013
128090                                                                  12809013
128100              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12810013
128110              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     12811013
128120                                                                  12812013
128130              PERFORM 9999-WRITE-TO-CSSL                          12813013
128140                                                                  12814013
128150              STRING  'SUKCS782 '          SU054-KOHLS-SML        12815099
128160                      ' TRIP:'             PV-DISP-TRIP           12816013
128170                      ' DR:'               SU054-DOOR-NUMBER      12817013
128180                      ' USR:'              SU054-USER-ID          12818013
128190                      ' STA:'              PV-DISP-PNA-STA        12819013
128200                      ' SQL:'              PV-DISP-SQLCODE        12820013
128210                      ' TKRPRPM'                                  12821013
128220                                           DELIMITED BY SIZE      12822013
128230                                      INTO PV-CICS-MSG-AREA2      12823013
128240                                                                  12824013
128250              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12825013
128260              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     12826013
128270                                                                  12827013
128280              PERFORM 9999-WRITE-TO-CSSL                          12828013
128290                                                                  12829013
128300              INITIALIZE PV-CICS-MSG-AREA3                        12830013
128310                                                                  12831013
128320              STRING  'SUKCS782 (PCKUT025)'                       12832099
128330                      ' METH:'         PC240-ACCESS-METHOD        12833013
128340                      ' RC:'           PC240-RETURN-CODE          12834013
128350                      ' FLAGS:'        PC240-FLAGS                12835013
128360                      ' ERR:'          PC240-ERROR-NBR            12836013
128370                                           DELIMITED BY SIZE      12837013
128380                                      INTO PV-CICS-MSG-AREA3      12838013
128390                                                                  12839013
128400              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12840013
128410              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     12841013
128420                                                                  12842013
128430              PERFORM 9999-WRITE-TO-CSSL                          12843013
128440                                                                  12844013
128450              INITIALIZE PV-CICS-MSG-AREA4                        12845013
128460              MOVE PC240-KEY-PO          TO PV-DISP-PO            12846013
128470              MOVE PC240-KEY-REC-SEQ-NBR TO PV-DISP-RCVR          12847013
128480              MOVE PC240-KEY-LNE-NBR     TO pv-disp-line          12848013
128490              MOVE PC240-KEY-PREPK-ID    TO PV-DISP-PREPK         12849013
128500              MOVE PC240-KEY-UPC-NBR     TO PV-DISP-UPC           12850013
128510              MOVE PC240-KEY-DEST-LOC    TO PV-DISP-DEST-OPER     12851013
128520                                                                  12852013
128530              STRING  'SUKCS782 '                                 12853099
128540                      ' PO:'           PV-DISP-PO                 12854013
128550                      '-'              PV-DISP-RCVR               12855013
128560                      '-'              pv-disp-line               12856013
128570                      ' PREPK:'        PV-DISP-PREPK              12857013
128580                      ' UPC:'          PV-DISP-UPC                12858013
128590                      ' DEST:'         PV-DISP-DEST-OPER          12859013
128600                      ' DEPT-CL-SUB'   PC240-KEY-DEPT-NBR         12860013
128610                      '-'              PC240-KEY-CL-NBR           12861013
128620                      '-'              PC240-KEY-SKU-SEQ-NBR      12862013
128630                                           DELIMITED BY SIZE      12863013
128640                                      INTO PV-CICS-MSG-AREA4      12864013
128650                                                                  12865013
128660              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12866013
128670              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     12867013
128680                                                                  12868013
128690              PERFORM 9999-WRITE-TO-CSSL                          12869013
128700                                                                  12870013
128710              INITIALIZE PV-CICS-MSG-AREA5                        12871013
128720              MOVE PC240-KEY-SKU         TO PV-DISP-SKU           12872013
128730              MOVE PC240-KEY-CARTON-ID   TO PV-DISP-SSCC          12873013
128740              MOVE PC240-INTR-UPC-ID     TO PV-DISP-UPCID         12874013
128750              MOVE PC240-SKU-NBR         TO PV-DISP-SKU2          12875013
128760                                                                  12876013
128770              STRING  'SUKCS782 '                                 12877099
128780                      ' KEY-SKU'       PV-DISP-SKU                12878013
128790                      ' SSCC:'         PV-DISP-SSCC               12879013
128800                      ' INTR UPC:'     PV-DISP-UPCID              12880013
128810                      ' SKU:'          PV-DISP-SKU2               12881013
128820                                           DELIMITED BY SIZE      12882013
128830                                      INTO PV-CICS-MSG-AREA5      12883013
128840                                                                  12884013
128850              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12885013
128860              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     12886013
128870                                                                  12887013
128880              PERFORM 9999-WRITE-TO-CSSL                          12888013
128890                                                                  12889013
128900              INITIALIZE PV-CICS-MSG-AREA6                        12890013
128910                                                                  12891013
128920              STRING  'SUKCS782 '                                 12892099
128930                      ' SQLCA:'        PC240-SQLCA                12893013
128940                                           DELIMITED BY SIZE      12894013
128950                                      INTO PV-CICS-MSG-AREA6      12895013
128960                                                                  12896013
128970              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12897013
128980              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     12898013
128990                                                                  12899013
129000              PERFORM 9999-WRITE-TO-CSSL                          12900013
129010                                                                  12901013
129020             SET PS-PROCESSING-ERROR-YES TO TRUE                  12902013
129030             PERFORM 9998-WRITE-TO-CSSL                           12903013
129040     END-EVALUATE.                                                12904013
129050                                                                  12905013
129060                                                                  12906013
129070******************************************************************12907013
129080* NEED TO MOVE THE FUNCTION QTY FOR THE P2L DIVERT IT MAY VARY    12908013
129090* BY DC. THIS WAS ADDED FOR PHASE 1 BLUE SPRINGS REMODEL PROJECT  12909013
129100******************************************************************12910013
129110 5070-GET-DC-PADCLS.                                              12911013
129120                                                                  12912013
129130     MOVE SU054-DC-NUMBER        TO KRPRPM-LOC-ID.                12913013
129140                                                                  12914013
129150     EXEC SQL                                                     12915013
129160          SELECT  SYS_PRC_FUNC_CDE                                12916013
129170                 ,FUNC_QTY                                        12917013
129180                 ,FUNC_TXT                                        12918013
129190            INTO :KRPRPM-SYS-PRC-FUNC-CDE                         12919013
129200                ,:KRPRPM-FUNC-QTY                                 12920013
129210                ,:KRPRPM-FUNC-TXT                                 12921013
129220            FROM  TKRPRPM                                         12922013
129230           WHERE  LOC_ID            = :KRPRPM-LOC-ID              12923013
129240             AND  INTFC_SYS_CDE     = 'ACM'                       12924013
129250             AND  SYS_PRC_FUNC_CDE  = 'PADCLS'                    12925013
129260            WITH UR                                               12926013
129270     END-EXEC.                                                    12927013
129280                                                                  12928013
129290     EVALUATE TRUE                                                12929013
129300       WHEN SQLCODE = +0                                          12930013
129310           CONTINUE                                               12931013
129320       WHEN SQLCODE = +100                                        12932013
129330           MOVE +1                  TO KRPRPM-FUNC-QTY            12933013
129340       WHEN SQLWARN0 NOT = SPACES                                 12934013
129350       WHEN SQLCODE < ZERO                                        12935013
129360       WHEN SQLCODE > ZERO                                        12936013
129370                                                                  12937013
129380              INITIALIZE PV-CICS-MSG-AREA1                        12938013
129390              INITIALIZE PV-CICS-MSG-AREA2                        12939013
129400                                                                  12940013
129410              MOVE SQLCODE              TO PV-DISP-SQLCODE        12941013
129420              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             12942013
129430              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           12943013
129440              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        12944013
129450                                                                  12945013
129460              STRING  'SUKCS782 5070-'                            12946099
129470                      ' DC:'               PV-DISP-DC             12947013
129480                      ' B1:'               SU054-BAR-CODE-1       12948013
129490                      ' B2:'               SU054-BAR-CODE-2       12949013
129500                      ' B3:'               SU054-BAR-CODE-3       12950013
129510                                           DELIMITED BY SIZE      12951013
129520                                      INTO PV-CICS-MSG-AREA1      12952013
129530                                                                  12953013
129540              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12954013
129550              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     12955013
129560                                                                  12956013
129570              PERFORM 9999-WRITE-TO-CSSL                          12957013
129580                                                                  12958013
129590              STRING  'SUKCS782 '          SU054-KOHLS-SML        12959099
129600                      ' TRIP:'             PV-DISP-TRIP           12960013
129610                      ' DR:'               SU054-DOOR-NUMBER      12961013
129620                      ' USR:'              SU054-USER-ID          12962013
129630                      ' STA:'              PV-DISP-PNA-STA        12963013
129640                      ' SQL:'              PV-DISP-SQLCODE        12964013
129650                      ' TKRPRPM'                                  12965013
129660                                           DeLIMITED BY SIZE      12966013
129670                                      INTO PV-CICS-MSG-AREA2      12967013
129680                                                                  12968013
129690              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12969013
129700              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     12970013
129710                                                                  12971013
129720              PERFORM 9999-WRITE-TO-CSSL                          12972013
129730                                                                  12973013
129740              INITIALIZE PV-CICS-MSG-AREA3                        12974013
129750                                                                  12975013
129760              MOVE  KRPRPM-LOC-ID      TO PV-DISP-OPER            12976013
129770                                                                  12977013
129780              STRING  'SUKCS782 '                                 12978099
129790                      ' PARM: PADCLS'                             12979013
129800                      ' OPER:'             PV-DISP-OPER           12980013
129810                                           DELIMITED BY SIZE      12981013
129820                                      INTO PV-CICS-MSG-AREA3      12982013
129830                                                                  12983013
129840              MOVE SPACES               TO PV-CICS-MSG-AREA-A     12984013
129850              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     12985013
129860                                                                  12986013
129870              PERFORM 9999-WRITE-TO-CSSL                          12987013
129880                                                                  12988013
129890             SET PS-PROCESSING-ERROR-YES TO TRUE                  12989013
129900             PERFORM 9998-WRITE-TO-CSSL                           12990013
129910     END-EVALUATE.                                                12991013
129920                                                                  12992013
129930******************************************************************12993013
129940* NEED TO MOVE THE FUNCTION QTY FOR THE P2L DIVERT IT MAY VARY    12994013
129950* BY DC. THIS WAS ADDED FOR PHASE 1 BLUE SPRINGS REMODEL PROJECT  12995013
129960******************************************************************12996013
129970 5071-GET-DC-PADCLS.                                              12997013
129980                                                                  12998013
129990     MOVE SU054-DC-NUMBER        TO KRPRPM-LOC-ID.                12999013
130000                                                                  13000013
130010     EXEC SQL                                                     13001013
130020          SELECT  SYS_PRC_FUNC_CDE                                13002013
130030                 ,FUNC_QTY                                        13003013
130040                 ,FUNC_TXT                                        13004013
130050            INTO :KRPRPM-SYS-PRC-FUNC-CDE                         13005013
130060                ,:KRPRPM-FUNC-QTY                                 13006013
130070                ,:KRPRPM-FUNC-TXT                                 13007013
130080            FROM  TKRPRPM                                         13008013
130090           WHERE  LOC_ID            = :KRPRPM-LOC-ID              13009013
130100             AND  INTFC_SYS_CDE     = 'ACM'                       13010013
130110             AND  SYS_PRC_FUNC_CDE  = 'PADCLS'                    13011013
130120            WITH UR                                               13012013
130130     END-EXEC.                                                    13013013
130140                                                                  13014013
130150     EVALUATE TRUE                                                13015013
130160       WHEN SQLCODE = +0                                          13016013
130170           CONTINUE                                               13017013
130180       WHEN SQLCODE = +100                                        13018013
130190           CONTINUE                                               13019016
130200       WHEN SQLWARN0 NOT = SPACES                                 13020013
130210       WHEN SQLCODE < ZERO                                        13021013
130220       WHEN SQLCODE > ZERO                                        13022013
130230                                                                  13023013
130240              INITIALIZE PV-CICS-MSG-AREA1                        13024013
130250              INITIALIZE PV-CICS-MSG-AREA2                        13025013
130260                                                                  13026013
130270              MOVE SQLCODE              TO PV-DISP-SQLCODE        13027013
130280              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             13028013
130290              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           13029013
130300              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        13030013
130310                                                                  13031013
130320              STRING  'SUKCS782 5071-'                            13032099
130330                      ' DC:'               PV-DISP-DC             13033013
130340                      ' B1:'               SU054-BAR-CODE-1       13034013
130350                      ' B2:'               SU054-BAR-CODE-2       13035013
130360                      ' B3:'               SU054-BAR-CODE-3       13036013
130370                                           DELIMITED BY SIZE      13037013
130380                                      INTO PV-CICS-MSG-AREA1      13038013
130390                                                                  13039013
130400              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13040013
130410              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     13041013
130420                                                                  13042013
130430              PERFORM 9999-WRITE-TO-CSSL                          13043013
130440                                                                  13044013
130450              STRING  'SUKCS782 '          SU054-KOHLS-SML        13045099
130460                      ' TRIP:'             PV-DISP-TRIP           13046013
130470                      ' DR:'               SU054-DOOR-NUMBER      13047013
130480                      ' USR:'              SU054-USER-ID          13048013
130490                      ' STA:'              PV-DISP-PNA-STA        13049013
130500                      ' SQL:'              PV-DISP-SQLCODE        13050013
130510                      ' TKRPRPM'                                  13051013
130520                                           DeLIMITED BY SIZE      13052013
130530                                      INTO PV-CICS-MSG-AREA2      13053013
130540                                                                  13054013
130550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13055013
130560              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     13056013
130570                                                                  13057013
130580              PERFORM 9999-WRITE-TO-CSSL                          13058013
130590                                                                  13059013
130600              INITIALIZE PV-CICS-MSG-AREA3                        13060013
130610                                                                  13061013
130620              MOVE  KRPRPM-LOC-ID      TO PV-DISP-OPER            13062013
130630                                                                  13063013
130640              STRING  'SUKCS782 '                                 13064099
130650                      ' PARM: PADCLS'                             13065013
130660                      ' OPER:'             PV-DISP-OPER           13066013
130670                                           DELIMITED BY SIZE      13067013
130680                                      INTO PV-CICS-MSG-AREA3      13068013
130690                                                                  13069013
130700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13070013
130710              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     13071013
130720                                                                  13072013
130730              PERFORM 9999-WRITE-TO-CSSL                          13073013
130740                                                                  13074013
130750             SET PS-PROCESSING-ERROR-YES TO TRUE                  13075013
130760             PERFORM 9998-WRITE-TO-CSSL                           13076013
130770     END-EVALUATE.                                                13077013
130780                                                                  13078013
130790*----------------------------------------------------------------*13079013
130800 5700-CALL-XLKUP033-EAI.                                          13080013
130810*----------------------------------------------------------------*13081013
130820*                                                                 13082013
130830** added internal table to track paragraph execution time         13083013
130840** dmh 2014-12-22 - begin                                         13084013
130850*                                                                 13085013
130860     MOVE  '5700'  TO  PT-CURR-PARA.                              13086013
130870     IF  PS-BLD-INTERNAL-TABLE-YES                                13087013
130880         PERFORM 0200-INTERNAL-TABLE                              13088013
130890     ELSE                                                         13089013
130900         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       13090013
130910     END-IF.                                                      13091013
130920                                                                  13092013
130930*                                                                 13093013
130940** DMH 2014-12-22 - END                                           13094013
130950*                                                                 13095013
130960     IF PS-LOG-MESSAGE                                            13096013
130970        STRING 'SUKCS782 (OTHER) -' DELIMITED BY SIZE             13097099
130980         '5700-CALL-XLKUP033-EAI '   DELIMITED BY SIZE            13098013
130990                                INTO PV-CICS-MSG-AREA             13099013
131000        MOVE LENGTH OF PV-CICS-MSG-AREA                           13100013
131010                                  TO PV-COMMAREA-LENGTH           13101013
131020        PERFORM 9998-WRITE-TO-CSSL                                13102013
131030                                                                  13103013
131040        MOVE SU054-ASGMT-NBR-SEQ-NBR TO PV-DISPL-ASGMT-SEQ-NBR    13104013
131050                                                                  13105013
131060        STRING 'SUKCS782-2287-'                                   13106099
131070             ' ASGMT TXT'                                         13107013
131080             SU054-ASGMT-NBR-TXT                                  13108013
131090             ' ASGMT SEQ'                                         13109013
131100             PV-DISPL-ASGMT-SEQ-NBR                               13110013
131110             ' ASGMT DTE'                                         13111013
131120             SU054-ASGMT-STRT-DTE                                 13112013
131130            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA               13113013
131140        PERFORM 9998-WRITE-TO-CSSL                                13114013
131150     END-IF                                                       13115013
131160                                                                  13116013
131170     IF PV-TSHUNLO-TMST-EAI > SPACES                              13117013
131180        CONTINUE                                                  13118013
131190     ELSE                                                         13119013
131200        PERFORM 3569-SEL-MAX-CHECK-IN-TMST                        13120013
131210     END-IF                                                       13121013
131220                                                                  13122013
131230     INITIALIZE XL072-EAI-EXPORT-COMMAREA                         13123013
131240                SU050-DTL-TXT-AREA.                               13124013
131250     SET XL072-SU-APP-ID                                          13125013
131260         XL072-DO-NOT-COMMIT-UPDATE  TO TRUE.                     13126013
131270                                                                  13127013
131280                                                                  13128013
131290     MOVE 'CARTON'                TO XL072-EVNT-OBJ-TXT.          13129013
131300     MOVE 'CHECKIN'               TO XL072-EVNT-OBJ-ACTN-TXT.     13130013
131310     MOVE SU054-USER-ID           TO XL072-CRE-BY-USR-ID.         13131013
131320     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            13132013
131330                                                                  13133013
131340     MOVE PV-CTN-N                TO XL072-EVNT-KY-1-NBR.         13134013
131350     MOVE SU054-TRIP-ID           TO XL072-EVNT-KY-2-NBR.         13135013
131360     MOVE PV-TSHUNLO-TMST-EAI     TO XL072-EVNT-KY-1-TMST.        13136013
131370                                                                  13137013
131380     SET XL072-SUWS050-COPYBOOK   TO TRUE.                        13138013
131390     SET SU050-CRTN-CHECK-IN      TO TRUE.                        13139013
131400     MOVE SU054-ASGMT-STRT-DTE    TO SU050-AB-ASGMT-STRT-DTE.     13140013
131410     MOVE SU054-ASGMT-NBR-TXT     TO SU050-AB-ASGMT-NBR-TXT.      13141013
131420     MOVE SU054-ASGMT-NBR-SEQ-NBR TO SU050-AB-ASGMT-NBR-SEQ-NBR.  13142013
131430                                                                  13143013
131440     MOVE SU054-SEQ-START-NBR     TO SU050-AB-ASGMT-SEQ-DTL-NBR.  13144013
131450     MOVE SU054-DOOR-NUMBER       TO SU050-AB-DOOR-NBR.           13145013
131460     MOVE ZEROES                  TO SU050-AB-CRTN-DEST-LOC-NBR.  13146013
131470                                                                  13147013
131480     IF SU021-100-PC-AUDIT-REQD OR SU021-REWORK                   13148013
131490         SET SU050-AB-CRTN-AUDIT-NEEDED TO TRUE                   13149013
131500     ELSE                                                         13150013
131510         SET SU050-AB-CRTN-ACTN-NONE    TO TRUE                   13151013
131520     END-IF                                                       13152013
131530                                                                  13153013
131540     EVALUATE TRUE                                                13154013
131550        WHEN PS-CARTON-SML-CREATED                                13155013
131560           IF LBVRDA-INPK-CNVYB-IND = 'Y'                         13156013
131570              SET SU050-AB-CRTN-TO-MULT-LOC TO TRUE               13157013
131580           ELSE                                                   13158013
131590              SET SU050-AB-CRTN-TO-LOC  TO TRUE                   13159013
131600           END-IF                                                 13160013
131610           MOVE PV-DEST-STORE        TO SU050-AB-CRTN-DEST-LOC-NBR13161013
131620        WHEN PS-CARTON-P2L-CREATED                                13162013
131630           SET SU050-AB-CRTN-TO-P2L  TO TRUE                      13163013
131640           MOVE LBVRDA-STR-ZN-ID TO SU050-AB-STR-ZN-ID            13164013
131650           MOVE LBVRDA-MODU-DESC TO SU050-AB-P2L-MODU-DESC        13165013
131660        WHEN PS-ECOMM-DC-REPURPOSE                                13166013
131670           SET SU050-AB-CRTN-TO-NONE TO TRUE                      13167013
131680        WHEN PS-NO-CASEPK-FND                                     13168013
131690           SET SU050-AB-CRTN-TO-NONE TO TRUE                      13169013
131700        WHEN OTHER                                                13170013
131710           SET SU050-AB-CRTN-FREE-ASTRAY TO TRUE                  13171013
131720     END-EVALUATE                                                 13172013
131730                                                                  13173013
131740     MOVE SU050-DTL-TXT-AREA             TO XL072-DTL-TXT         13174013
131750                                                                  13175013
131760     CALL XL072-USER-PGM USING DFHEIBLK                           13176013
131770                              XL072-COMMAREA                      13177013
131780                              XL072-EAI-EXPORT-COMMAREA.          13178013
131790                                                                  13179013
131800     EVALUATE TRUE                                                13180013
131810         WHEN XL072-SUCCESSFUL                                    13181013
131820              CONTINUE                                            13182013
131830         WHEN OTHER                                               13183013
131840                                                                  13184013
131850              INITIALIZE PV-CICS-MSG-AREA1                        13185013
131860              INITIALIZE PV-CICS-MSG-AREA2                        13186013
131870                                                                  13187013
131880              MOVE XL072-EAI-DB-SQLCODE TO PV-DISP-SQLCODE        13188013
131890              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             13189013
131900              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           13190013
131910              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        13191013
131920                                                                  13192013
131930              STRING  'SUKCS782 5700-'                            13193099
131940                      ' DC:'               PV-DISP-DC             13194013
131950                      ' B1:'               SU054-BAR-CODE-1       13195013
131960                      ' B2:'               SU054-BAR-CODE-2       13196013
131970                      ' B3:'               SU054-BAR-CODE-3       13197013
131980                                           DELIMITED BY SIZE      13198013
131990                                      INTO PV-CICS-MSG-AREA1      13199013
132000                                                                  13200013
132010              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13201013
132020              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     13202013
132030                                                                  13203013
132040              PERFORM 9999-WRITE-TO-CSSL                          13204013
132050                                                                  13205013
132060              STRING  'SUKCS782 '          SU054-KOHLS-SML        13206099
132070                      ' TRIP:'             PV-DISP-TRIP           13207013
132080                      ' DR:'               SU054-DOOR-NUMBER      13208013
132090                      ' USR:'              SU054-USER-ID          13209013
132100                      ' STA:'              PV-DISP-PNA-STA        13210013
132110                      ' SQL:'              PV-DISP-SQLCODE        13211013
132120                      ' XL TABLES'                                13212013
132130                                           DELIMITED BY SIZE      13213013
132140                                      INTO PV-CICS-MSG-AREA2      13214013
132150                                                                  13215013
132160              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13216013
132170              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     13217013
132180                                                                  13218013
132190              PERFORM 9999-WRITE-TO-CSSL                          13219013
132200                                                                  13220013
132210              INITIALIZE PV-CICS-MSG-AREA3                        13221013
132220                                                                  13222013
132230              STRING  'SUKCS782 (XLKUP033)'                       13223099
132240                      ' APP:'          XL072-APP-ID-EXPORT-CDE    13224013
132250                      ' EVNT:'         XL072-EVNT-OBJ-TXT         13225013
132260                      '-'              XL072-EVNT-OBJ-ACTN-TXT    13226013
132270                                           DELIMITED BY SIZE      13227013
132280                                      INTO PV-CICS-MSG-AREA3      13228013
132290                                                                  13229013
132300              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13230013
132310              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     13231013
132320                                                                  13232013
132330              PERFORM 9999-WRITE-TO-CSSL                          13233013
132340                                                                  13234013
132350              INITIALIZE PV-CICS-MSG-AREA4                        13235013
132360              MOVE  PV-CTN-N            TO PV-DISP-SSCC           13236013
132370              MOVE  SU054-TRIP-ID       TO PV-DISP-TRIP           13237013
132380                                                                  13238013
132390              STRING  'SUKCS782 '                                 13239099
132400                      ' KEY SSCC:'     PV-DISP-SSCC               13240013
132410                      ' TRIP:'         PV-DISP-TRIP               13241013
132420                      ' TMST:'         PV-TSHUNLO-TMST-EAI        13242013
132430                      ' COPYBOOK:'     XL072-DTL-COPYBOOK-NM      13243013
132440                                           DELIMITED BY SIZE      13244013
132450                                      INTO PV-CICS-MSG-AREA4      13245013
132460                                                                  13246013
132470              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13247013
132480              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     13248013
132490                                                                  13249013
132500              PERFORM 9999-WRITE-TO-CSSL                          13250013
132510                                                                  13251013
132520              INITIALIZE PV-CICS-MSG-AREA5                        13252013
132530                                                                  13253013
132540              STRING  'SUKCS782 '                                 13254099
132550                      ' DTL:'          SU050-DTL-TXT-TYPE         13255013
132560                      '-'              SU050-AB-ASGMT-STRT-DTE    13256013
132570                      '-'              SU050-AB-ASGMT-NBR-TXT     13257013
132580                      '-'              SU050-AB-ASGMT-NBR-SEQ-NBR 13258013
132590                      '-'              SU050-AB-ASGMT-SEQ-DTL-NBR 13259013
132600                      '-'              SU050-AB-DOOR-NBR          13260013
132610                      '-'              SU050-AB-CRTN-DEST-CD      13261013
132620                      '-'              SU050-AB-CRTN-DEST-LOC-NBR 13262013
132630                      '-'              SU050-AB-P2L-MODU-DESC     13263013
132640                      '-'              SU050-AB-STR-ZN-ID         13264013
132650                      '-'              SU050-AB-CRTN-ACTN-CDE     13265013
132660                                           DELIMITED BY SIZE      13266013
132670                                      INTO PV-CICS-MSG-AREA5      13267013
132680                                                                  13268013
132690              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13269013
132700              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     13270013
132710                                                                  13271013
132720              PERFORM 9999-WRITE-TO-CSSL                          13272013
132730                                                                  13273013
132740              INITIALIZE PV-CICS-MSG-AREA6                        13274013
132750                                                                  13275013
132760              STRING  'SUKCS782 '                                 13276099
132770                      ' COMMIT:'       XL072-COMMIT-CDE           13277013
132780                      ' RC:'           XL072-RETURN-CODE          13278013
132790                      ' PARA:'         XL072-SQL-ERROR-PARA       13279013
132800                      ' MOD:'          XL072-CALL-MOD-FAIL-NM     13280013
132810                      ' ERR:'          XL072-CALL-MOD-FAIL-ERR-CDE13281013
132820                                           DELIMITED BY SIZE      13282013
132830                                      INTO PV-CICS-MSG-AREA6      13283013
132840                                                                  13284013
132850              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13285013
132860              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     13286013
132870                                                                  13287013
132880              PERFORM 9999-WRITE-TO-CSSL                          13288013
132890                                                                  13289013
132900              MOVE XL072-RETURN-CODE     TO PV-SQLCODE            13290013
132910              SET PV-DONE-PROCESSING          TO TRUE             13291013
132920                                                                  13292013
132930              SET PS-PROCESSING-ERROR-YES TO TRUE                 13293013
132940              PERFORM 9998-WRITE-TO-CSSL                          13294013
132950     END-EVALUATE.                                                13295013
132960                                                                  13296013
132970*CT 11/04/08 BEGIN                                                13297013
132980                                                                  13298013
132990*----------------------------------------------------------------*13299013
133000 6000-FORMAT-DIRECTIVE-CALL.                                      13300013
133010*----------------------------------------------------------------*13301013
133020*                                                                 13302013
133030** added internal table to track paragraph execution time         13303013
133040** dmh 2014-12-22 - begin                                         13304013
133050*                                                                 13305013
133060     MOVE  '6000'  TO  PT-CURR-PARA.                              13306013
133070     IF  PS-BLD-INTERNAL-TABLE-YES                                13307013
133080         PERFORM 0200-INTERNAL-TABLE                              13308013
133090     ELSE                                                         13309013
133100         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       13310013
133110     END-IF.                                                      13311013
133120                                                                  13312013
133130*                                                                 13313013
133140** DMH 2014-12-22 - END                                           13314013
133150*                                                                 13315013
133160                                                                  13316013
133170      INITIALIZE                       SU090-DG-REQUEST-COMMAREA  13317013
133180                                       SUT00015-DIRV-RLSE-IND.    13318013
133190      MOVE SU054-DC-NUMBER             TO SU090-OPER-UNT-ID.      13319013
133200      MOVE '1'                         TO SU090-ACTN-CDE.         13320013
133210      MOVE '1'                         TO SU090-DIRECTIVE-LVL-CDE.13321013
133220                                                                  13322013
133230      SET        SU090-ONLINE          TO TRUE                    13323013
133240      MOVE SPACE                       TO SU090-AUD-STAT-CDE      13324013
133250      PERFORM 6001-GET-DIRV-RLSE-IND                              13325013
133260                                                                  13326013
133270      EVALUATE TRUE                                               13327013
133280* JAK WR41309 - ADD WHEN CLAUSE FOR RFID CHECK                    13328013
133290**gb 9/17/12 WR41309                                              13329013
133300* CLP 06/20/13 PR5148B START                                      13330013
133310* CLP 10/29/13 PR5148B START                                      13331013
133320        WHEN SU021-AUDIT-IS-COMPLETE AND                          13332013
133330             SU021-RFID-AUDIT-IS-COMPLETE                         13333013
133340* CLP 10/29/13 PR5148B   END                                      13334013
133350             IF PS-DIRECTIVE-YES                                  13335013
133360                MOVE 'RFD'            TO SU090-DIRV-RSN-CDE       13336013
133370                MOVE 'R'              TO SU090-AUD-STAT-CDE       13337013
133380                MOVE  ZERO            TO SU021-AUDIT-NUMBER       13338013
133390             END-IF                                               13339013
133400        WHEN PS-DIRECTIVE-YES                                     13340013
133410             MOVE 'RFD'                 TO SU090-DIRV-RSN-CDE     13341013
133420             MOVE 'R'                   TO SU090-AUD-STAT-CDE     13342013
133430* CLP 06/20/13 PR5148B END                                        13343013
133440* JAK WR41309 - END                                               13344013
133450        WHEN SU021-AUDIT-REQUIRED                                 13345013
133460*CLP 10/29/13                                                     13346013
133470        WHEN SU021-RFID-AUDIT-REQUIRED                            13347013
133480             MOVE 'AUQ'                 TO SU090-DIRV-RSN-CDE     13348013
133490             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     13349013
133500        WHEN SU021-AUDIT-PENDING                                  13350013
133510        WHEN SU021-RFID-AUDIT-PENDING                             13351013
133520             MOVE 'AUU'                 TO SU090-DIRV-RSN-CDE     13352013
133530             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     13353013
133540        WHEN SU021-100-PC-AUDIT-REQD                              13354013
133550        WHEN SU021-RFID-100-PC-AUDIT-REQD                         13355013
133560             MOVE 'AU%'                TO SU090-DIRV-RSN-CDE      13356013
133570             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     13357013
133580        WHEN SU021-REWORK                                         13358013
133590             MOVE SU021-AUDIT-NUMBER TO SUT00015-AUD-CNTL-NBR     13359013
133600             MOVE SU021-PO-NUMBER    TO SUT00015-PO-NBR           13360013
133610        WHEN SU021-RFID-REWORK                                    13361013
133620             MOVE SU021-RFID-AUDIT-NUMBER TO SUT00015-AUD-CNTL-NBR13362013
133630             MOVE SU021-PO-NUMBER    TO SUT00015-PO-NBR           13363013
133640*CLP 10/29/13                                                     13364013
133650        WHEN OTHER                                                13365013
133660             MOVE 'BRC'                TO SU090-DIRV-RSN-CDE      13366013
133670             MOVE ' '                  TO SU090-AUD-STAT-CDE      13367013
133680      END-EVALUATE.                                               13368013
133690                                                                  13369013
133700                                                                  13370013
133710      IF PS-CARTON-SML-CREATED                                    13371013
133720          MOVE 'SML'                   TO SU090-BRCDE-TYP-CDE     13372013
133730          MOVE SUT00024-SHIPT-UNT-ID   TO SU090-SML-BRCDE-NBR     13373013
133740          MOVE PV-STORE-N              TO SU090-STR-NBR.          13374013
133750      IF PS-CARTON-P2L-CREATED                                    13375013
133760          MOVE 'P2L'                   TO SU090-BRCDE-TYP-CDE     13376013
133770          MOVE DK-BARCODE-NBR          TO SU090-P2L-BRCDE-NBR     13377013
133780          MOVE SU054-DC-NUMBER         TO SU090-STR-NBR.          13378013
133790      MOVE PV-PO-NBR                   TO SU090-PO-NBR.           13379013
133800                                                                  13380013
133810      IF RECEIV-PACK-BY-ST-IND = 'Y'                              13381013
133820          MOVE +0                      TO SU090-PO-PREPK-ID       13382013
133830                                          SU090-PO-LNE-NBR        13383013
133840         IF PC240-SEASET-SHRT-NM > SPACES                         13384013
133850            MOVE PC240-SEASET-SHRT-NM     TO SU090-SEASET-CDE     13385013
133860            MOVE PC240-SEASET-YR          TO SU090-SEASET-YR      13386013
133870         ELSE                                                     13387013
133880            MOVE SPACES                   TO SU090-SEASET-CDE     13388013
133890                                             SU090-SEASET-YR      13389013
133900         END-IF                                                   13390013
133910      ELSE                                                        13391013
133920          IF LBPTDA-PREPK-ID > 0                                  13392013
133930              MOVE LBPTDA-PREPK-ID     TO SU090-PO-PREPK-ID       13393013
133940              MOVE +0                  TO SU090-PO-LNE-NBR        13394013
133950          ELSE                                                    13395013
133960              MOVE PV-PO-LINE-N           TO SU090-PO-LNE-NBR     13396013
133970              MOVE +0                   TO SU090-PO-PREPK-ID      13397013
133980          END-IF                                                  13398013
133990          IF LBVRDA-SEASET-NM     > SPACES                        13399013
134000             PERFORM 7220-SELECT-TPURCHS                          13400013
134010             MOVE PURCHS-SEASET-YR      TO SU090-SEASET-YR        13401013
134020             MOVE PURCHS-SEASET-SHRT-NM TO SU090-SEASET-CDE       13402013
134030          ELSE                                                    13403013
134040             MOVE SPACES                TO SU090-SEASET-CDE       13404013
134050          END-IF                                                  13405013
134060          MOVE SPACES                   TO SU090-SEASET-YR        13406013
134070      END-IF.                                                     13407013
134080                                                                  13408013
134090      MOVE PV-RCVR-SEQ-NBR             TO SU090-RCVR-SEQ-NBR.     13409013
134100***** MOVE SU021-AUDIT-VALIDATION-SW   TO SU090-CASI-CDE.         13410013
134110      MOVE 'A'                         TO SU090-CART-STAT-CDE.    13411013
134120                                                                  13412013
134130     EVALUATE TRUE                                                13413013
134140      WHEN NOT SU021-AUDIT-IS-COMPLETE                            13414013
134150          MOVE SU021-AUDIT-NUMBER      TO SU090-AUD-CNTL-NBR      13415013
134160          MOVE SU021-AUDIT-VALIDATION-SW   TO SU090-CASI-CDE      13416013
134170**gb 2/12/14                                                      13417013
134180          IF SUT00015-AUD-STAT-CDE = 'F' AND                      13418013
134190             SU021-RFID-AUDIT-REQUIRED                            13419013
134200             MOVE 'AUR'                 TO SU090-DIRV-RSN-CDE     13420013
134210          END-IF                                                  13421013
134220**gb 2/12/14                                                      13422013
134230      WHEN NOT SU021-RFID-AUDIT-IS-COMPLETE                       13423013
134240          MOVE SU021-RFID-AUDIT-NUMBER TO SU090-AUD-CNTL-NBR      13424013
134250          MOVE SU021-RFID-AUDIT-VALIDATION-SW TO SU090-CASI-CDE   13425013
134260     END-EVALUATE.                                                13426013
134270                                                                  13427013
134280      MOVE LBPTDA-STR-ZN-ID            TO SU090-STR-ZN.           13428013
134290      MOVE SU054-USER-ID               TO SU090-ASSOC-ID.         13429013
134300                                                                  13430013
134310      IF SUT00015-DIRV-RLSE-IND = 'Y'                             13431013
134320* JAK WR41309 - ADD RFID CHECK                                    13432013
134330         AND SU093-RFID-NO                                        13433013
134340          CONTINUE                                                13434013
134350      ELSE                                                        13435013
134360* CLP 06/20/13 PR5148B START                                      13436013
134370* CLP 10/29/13 PR5148D START                                      13437013
134380          IF SU021-AUDIT-IS-COMPLETE AND                          13438013
134390             SU021-RFID-AUDIT-IS-COMPLETE AND                     13439013
134400            (SU093-RFID-NO OR SU093-DPT-STR-P2L-FIRST-YES OR      13440013
134410             PS-DIRECTIVE-NO)                                     13441013
134420* CLP 06/20/13 PR5148B END                                        13442013
134430              CONTINUE                                            13443013
134440          ELSE                                                    13444013
134450             PERFORM 6100-CALL-DIRECTIVE-GEN-129                  13445013
134460             continue                                             13446013
134470          END-IF                                                  13447013
134480      END-IF.                                                     13448013
134490                                                                  13449013
134500* JAK WR41309 - IF RFID, WRITE REC TO SUT_PRC_MSG_CNTL            13450013
134510      IF PS-RFID-ON-LABEL-YES                                     13451013
134520        IF PS-CARTON-SML-CREATED                                  13452013
134530            PERFORM 8600-INSERT-PROCESS-MSG                       13453013
134540        END-IF                                                    13454013
134550        IF SU021-AUDIT-REQUIRED OR                                13455013
134560           SU021-RFID-AUDIT-REQUIRED                              13456013
134570              MOVE 'AUQ' to SU090-DIRV-RSN-CDE                    13457013
134580        END-IF                                                    13458013
134590      END-IF.                                                     13459013
134600*CLP 10/29/13   END                                               13460013
134610* JAK WR41309 - END                                               13461013
134620                                                                  13462013
134630      IF PS-PROCESSING-ERROR-NO                                   13463013
134640          PERFORM 6200-GET-FRC-DIVERT-CDE.                        13464013
134650                                                                  13465013
134660 6000A-FORMAT-DIR-CALL-IR.                                        13466013
134670*----------------------------------------------------------------*13467013
134680*                                                                 13468013
134690** added internal table to track paragraph execution time         13469013
134700** dmh 2014-12-22 - begin                                         13470013
134710*                                                                 13471013
134720     MOVE  '600A'  TO  PT-CURR-PARA.                              13472013
134730     IF  PS-BLD-INTERNAL-TABLE-YES                                13473013
134740         PERFORM 0200-INTERNAL-TABLE                              13474013
134750     ELSE                                                         13475013
134760         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       13476013
134770     END-IF.                                                      13477013
134780                                                                  13478013
134790*                                                                 13479013
134800** DMH 2014-12-22 - END                                           13480013
134810*                                                                 13481013
134820                                                                  13482013
134830* CLP 06/20/13 PR5148B START                                      13483013
134840                                                                  13484013
134850     SET SU093-RFID-NO TO TRUE                                    13485013
134860     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   13486013
134870     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   13487013
134880     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE.                   13488013
134890     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE.                   13489013
134900     SET SU093-DC-DEPT-TAGS-NO         TO TRUE.                   13490013
134910     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   13491013
134920     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   13492013
134930     SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE.                   13493013
134940     SET SU093-P2L-CHK-IN-NO           TO TRUE.                   13494013
134950*CLP 10/29/13 - START                                             13495013
134960     SET SU093-IR-CHK-IN-NO            TO TRUE.                   13496013
134970*CLP 10/29/13 - END                                               13497013
134980     PERFORM 6010-CALL-RFID-DETERMINATION                         13498013
134990* CLP 06/20/13 PR5148B END                                        13499013
135000     IF PS-DIRECTIVE-YES AND PS-AUTO-CONVEY-EXCPT-CRTNS           13500013
135010         INITIALIZE SU090-DG-REQUEST-COMMAREA                     13501013
135020         MOVE SU054-DC-NUMBER           TO SU090-OPER-UNT-ID      13502013
135030         SET  SU090-CARTON-DIRECTIVE                              13503013
135040              SU090-ONLINE                                        13504013
135050              SU090-ADD-ACTION                                    13505013
135060              SU090-SML-BARCODE         TO TRUE                   13506013
135070         MOVE 'RFD'                 TO SU090-DIRV-RSN-CDE         13507013
135080         MOVE 'R'                   TO SU090-AUD-STAT-CDE         13508013
135090                                                                  13509013
135100         MOVE SPACES                TO SU090-ERR-PROGRAM          13510013
135110                                       SU090-ERR-PARAGRAPH        13511013
135120                                       SU090-SQLCA                13512013
135130                                       SU090-MQ-REAS-TXT          13513013
135140         MOVE ZEROES                TO SU090-SQLCODE              13514013
135150                                       SU090-MQ-COND-CODE         13515013
135160                                       SU090-MQ-REAS-CODE         13516013
135170                                                                  13517013
135180         MOVE 'SUKCS782'            TO SU090-CALLING-PGM          13518099
135190         MOVE SPACES                TO SU090-P2L-BRCDE-NBR        13519013
135200         MOVE ZEROS                    TO SU090-AUD-CNTL-NBR      13520013
135210         MOVE SUT00024-SHIPT-UNT-ID    TO SU090-SML-BRCDE-NBR     13521013
135220         MOVE SUT00028-TRN-NBR         TO SU090-PO-NBR            13522013
135230         MOVE ZEROS                    TO SU090-RCVR-SEQ-NBR      13523013
135240         MOVE SUT00028-TRN-LNE-NBR     TO SU090-PO-LNE-NBR        13524013
135250         MOVE ZEROS                    TO SU090-PO-PREPK-ID       13525013
135260         MOVE PV-STORE-N               TO SU090-STR-NBR           13526013
135270         MOVE SPACES                   TO SU090-CASI-CDE          13527013
135280         SET  SU090-ACTIVE-CART        TO TRUE                    13528013
135290         MOVE SPACES                   TO SU090-AUD-FAIL-RSN      13529013
135300         MOVE SPACES                   TO SU090-STR-ZN            13530013
135310         MOVE SPACES                   TO SU090-SEASET-YR         13531013
135320         MOVE SPACES                   TO SU090-SEASET-CDE        13532013
135330         MOVE SU054-USER-ID            TO SU090-ASSOC-ID          13533013
135340                                                                  13534013
135350         SET SU090-SUCCESS             TO TRUE                    13535013
135360         PERFORM 6100-CALL-DIRECTIVE-GEN-129                      13536013
135370      END-IF.                                                     13537013
135380                                                                  13538013
135390                                                                  13539013
135400*----------------------------------------------------------------*13540013
135410* GET RLSE IND TO DETERMINE DIRV REASON CODE                      13541013
135420*                                                                *13542013
135430*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *13543013
135440*----------------------------------------------------------------*13544013
135450 6001-GET-DIRV-RLSE-IND.                                          13545013
135460*                                                                 13546013
135470** added internal table to track paragraph execution time         13547013
135480** dmh 2014-12-22 - begin                                         13548013
135490*                                                                 13549013
135500     MOVE  '6001'  TO  PT-CURR-PARA.                              13550013
135510     IF  PS-BLD-INTERNAL-TABLE-YES                                13551013
135520         PERFORM 0200-INTERNAL-TABLE                              13552013
135530     ELSE                                                         13553013
135540         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       13554013
135550     END-IF.                                                      13555013
135560                                                                  13556013
135570*                                                                 13557013
135580** DMH 2014-12-22 - END                                           13558013
135590*                                                                 13559013
135600                                                                  13560013
135610     MOVE SU021-AUDIT-NUMBER TO SUT00015-AUD-CNTL-NBR.            13561013
135620     MOVE SU021-PO-NUMBER    TO SUT00015-PO-NBR.                  13562013
135630                                                                  13563013
135640     EXEC SQL                                                     13564013
135650        SELECT                                                    13565013
135660            DIRV_RLSE_IND                                         13566013
135670           ,AUD_STAT_CDE                                          13567013
135680        INTO                                                      13568013
135690            :SUT00015-DIRV-RLSE-IND                               13569013
135700           ,:SUT00015-AUD-STAT-CDE                                13570013
135710        FROM                                                      13571013
135720            SUT_PO_AUD_REQ                                        13572013
135730        WHERE PO_NBR          = :SUT00015-PO-NBR                  13573013
135740          AND AUD_CNTL_NBR    = :SUT00015-AUD-CNTL-NBR            13574013
135750     END-EXEC.                                                    13575013
135760                                                                  13576013
135770         EVALUATE TRUE                                            13577013
135780             WHEN SQLCODE = ZERO                                  13578013
135790                 IF SUT00015-DIRV-RLSE-IND = ' ' OR 'N'           13579013
135800                     MOVE 'AUR'     TO SU090-DIRV-RSN-CDE         13580013
135810                     MOVE  SUT00015-AUD-STAT-CDE                  13581013
135820                                    TO SU090-AUD-STAT-CDE         13582013
135830                 ELSE                                             13583013
135840                     MOVE 'BRC' TO SU090-DIRV-RSN-CDE             13584013
135850                     MOVE ' '   TO SU090-AUD-STAT-CDE             13585013
135860                     SET SU021-AUDIT-IS-COMPLETE TO TRUE          13586013
135870*CLP 10/29/13 - START                                             13587013
135880                     SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE     13588013
135890*CLP 10/29/13 - END                                               13589013
135900                 END-IF                                           13590013
135910             WHEN SQLCODE = +100                                  13591013
135920                 MOVE 'AUR'         TO SU090-DIRV-RSN-CDE         13592013
135930                 MOVE ' '      TO SUT00015-AUD-STAT-CDE           13593013
135940             WHEN SQLWARN0 NOT = SPACES                           13594013
135950             WHEN SQLCODE NOT EQUAL ZERO                          13595013
135960                                                                  13596013
135970              INITIALIZE PV-CICS-MSG-AREA1                        13597013
135980              INITIALIZE PV-CICS-MSG-AREA2                        13598013
135990                                                                  13599013
136000              MOVE SQLCODE              TO PV-DISP-SQLCODE        13600013
136010              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             13601013
136020              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           13602013
136030              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        13603013
136040                                                                  13604013
136050              STRING  'SUKCS782 6001-'                            13605099
136060                      ' DC:'               PV-DISP-DC             13606013
136070                      ' B1:'               SU054-BAR-CODE-1       13607013
136080                      ' B2:'               SU054-BAR-CODE-2       13608013
136090                      ' B3:'               SU054-BAR-CODE-3       13609013
136100                                           DELIMITED BY SIZE      13610013
136110                                      INTO PV-CICS-MSG-AREA1      13611013
136120                                                                  13612013
136130              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13613013
136140              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     13614013
136150                                                                  13615013
136160              PERFORM 9999-WRITE-TO-CSSL                          13616013
136170                                                                  13617013
136180              STRING  'SUKCS782 '          SU054-KOHLS-SML        13618099
136190                      ' TRIP:'             PV-DISP-TRIP           13619013
136200                      ' DR:'               SU054-DOOR-NUMBER      13620013
136210                      ' USR:'              SU054-USER-ID          13621013
136220                      ' STA:'              PV-DISP-PNA-STA        13622013
136230                      ' SQL:'              PV-DISP-SQLCODE        13623013
136240                      ' SUT_PO_AUD_REQ'                           13624013
136250                                           DELIMITED BY SIZE      13625013
136260                                      INTO PV-CICS-MSG-AREA2      13626013
136270                                                                  13627013
136280              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13628013
136290              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     13629013
136300                                                                  13630013
136310              PERFORM 9999-WRITE-TO-CSSL                          13631013
136320                                                                  13632013
136330              INITIALIZE PV-CICS-MSG-AREA3                        13633013
136340              MOVE  SUT00015-PO-NBR       TO PV-DISP-PO           13634013
136350              MOVE  SUT00015-AUD-CNTL-NBR TO PV-DISP-AUDIT        13635013
136360                                                                  13636013
136370              STRING  'SUKCS782 '                                 13637099
136380                      ' PO:'           PV-DISP-PO                 13638013
136390                      ' AUDIT:'        PV-DISP-AUDIT              13639013
136400                                           DELIMITED BY SIZE      13640013
136410                                      INTO PV-CICS-MSG-AREA3      13641013
136420                                                                  13642013
136430              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13643013
136440              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     13644013
136450                                                                  13645013
136460              PERFORM 9999-WRITE-TO-CSSL                          13646013
136470                                                                  13647013
136480                 SET PS-PROCESSING-ERROR-YES TO TRUE              13648013
136490                 PERFORM 9998-WRITE-TO-CSSL                       13649013
136500        END-EVALUATE.                                             13650013
136510                                                                  13651013
136520                                                                  13652013
136530 6005-DETERMINE-FRCED-DVRT.                                       13653013
136540*                                                                 13654013
136550** added internal table to track paragraph execution time         13655013
136560** dmh 2014-12-22 - begin                                         13656013
136570*                                                                 13657013
136580     MOVE  '6005'  TO  PT-CURR-PARA.                              13658013
136590     IF  PS-BLD-INTERNAL-TABLE-YES                                13659013
136600         PERFORM 0200-INTERNAL-TABLE                              13660013
136610     ELSE                                                         13661013
136620         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       13662013
136630     END-IF.                                                      13663013
136640                                                                  13664013
136650*                                                                 13665013
136660** DMH 2014-12-22 - END                                           13666013
136670*                                                                 13667013
136680                                                                  13668013
136690** gb 3/5/09                                                      13669013
136700      IF SU021-AUDIT-PENDING OR                                   13670013
136710         SU021-RFID-AUDIT-PENDING                                 13671013
136720         PERFORM 8530-CHECK-AUDIT-CRT-PNDG                        13672013
136730         PERFORM 8535-CHECK-AUDIT-CRT-PNDG-RF                     13673013
136740         IF PS-AUDIT-CARTON-PNDG-YES                              13674013
136750            SET SU021-AUDIT-REQUIRED TO TRUE                      13675013
136760         END-IF                                                   13676013
136770         IF PS-AUDIT-CRTN-PNDG-RF-YES                             13677013
136780            SET SU021-RFID-AUDIT-REQUIRED TO TRUE                 13678013
136790         END-IF                                                   13679013
136800      END-IF                                                      13680013
136810** gb 3/5/09                                                      13681013
136820      EVALUATE TRUE                                               13682013
136830        WHEN SU021-AUDIT-REQUIRED                                 13683013
136840*CLP 10/29/13                                                     13684013
136850        WHEN SU021-RFID-AUDIT-REQUIRED                            13685013
136860             MOVE 'AUQ'                TO SU090-DIRV-RSN-CDE      13686013
136870        WHEN SU021-AUDIT-PENDING                                  13687013
136880        WHEN SU021-RFID-AUDIT-PENDING                             13688013
136890             MOVE 'AUU'                TO SU090-DIRV-RSN-CDE      13689013
136900        WHEN SU021-100-PC-AUDIT-REQD                              13690013
136910        WHEN SU021-RFID-100-PC-AUDIT-REQD                         13691013
136920             MOVE 'AU%'                TO SU090-DIRV-RSN-CDE      13692013
136930        WHEN SU021-REWORK                                         13693013
136940        WHEN SU021-RFID-REWORK                                    13694013
136950             MOVE SU021-AUDIT-NUMBER TO SUT00015-AUD-CNTL-NBR     13695013
136960             MOVE SU021-PO-NUMBER    TO SUT00015-PO-NBR           13696013
136970             PERFORM 6001-GET-DIRV-RLSE-IND                       13697013
136980        WHEN OTHER                                                13698013
136990             MOVE 'BRC'                TO SU090-DIRV-RSN-CDE      13699013
137000      END-EVALUATE.                                               13700013
137010                                                                  13701013
137020      PERFORM 6200-GET-FRC-DIVERT-CDE.                            13702013
137030                                                                  13703013
137040* CALL SUKUT129 DIRECTIVE GENERATOR                               13704013
137050                                                                  13705013
137060 6100-CALL-DIRECTIVE-GEN-129.                                     13706013
137070*                                                                 13707013
137080** added internal table to track paragraph execution time         13708013
137090** dmh 2014-12-22 - begin                                         13709013
137100*                                                                 13710013
137110     MOVE  '6100'  TO  PT-CURR-PARA.                              13711013
137120     IF  PS-BLD-INTERNAL-TABLE-YES                                13712013
137130         PERFORM 0200-INTERNAL-TABLE                              13713013
137140     ELSE                                                         13714013
137150         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       13715013
137160     END-IF.                                                      13716013
137170                                                                  13717013
137180*                                                                 13718013
137190** DMH 2014-12-22 - END                                           13719013
137200*                                                                 13720013
137210                                                                  13721013
137220     INSPECT SU090-DG-REQUEST-COMMAREA                            13722013
137230         REPLACING ALL LOW-VALUES BY '?'.                         13723013
137240                                                                  13724013
137250     MOVE 'SUKCS782'                TO SU090-CALLING-PGM.         13725099
137260     CALL SU090-DIRV-GEN-PGM   USING DFHEIBLK                     13726013
137270                                     SU090-COMMAREA               13727013
137280                                     SU090-DG-REQUEST-COMMAREA.   13728013
137290     EVALUATE TRUE                                                13729013
137300         WHEN SU090-SUCCESS                                       13730013
137310             CONTINUE                                             13731013
137320         WHEN SU090-PARAMETER-ERROR                               13732013
137330              SET PS-PROCESSING-ERROR-YES     TO TRUE             13733013
137340              MOVE SU090-SQLCODE        TO PV-SQLCODE             13734013
137350                                                                  13735013
137360              INITIALIZE PV-CICS-MSG-AREA1                        13736013
137370              INITIALIZE PV-CICS-MSG-AREA2                        13737013
137380                                                                  13738013
137390              MOVE SU090-SQLCODE        TO PV-DISP-SQLCODE        13739013
137400              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             13740013
137410              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           13741013
137420              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        13742013
137430                                                                  13743013
137440              STRING  'SUKCS782 6100-'                            13744099
137450                      ' DC:'               PV-DISP-DC             13745013
137460                      ' B1:'               SU054-BAR-CODE-1       13746013
137470                      ' B2:'               SU054-BAR-CODE-2       13747013
137480                      ' B3:'               SU054-BAR-CODE-3       13748013
137490                                           DELIMITED BY SIZE      13749013
137500                                      INTO PV-CICS-MSG-AREA1      13750013
137510                                                                  13751013
137520              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13752013
137530              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     13753013
137540                                                                  13754013
137550              PERFORM 9999-WRITE-TO-CSSL                          13755013
137560                                                                  13756013
137570              STRING  'SUKCS782 '          SU054-KOHLS-SML        13757099
137580                      ' TRIP:'             PV-DISP-TRIP           13758013
137590                      ' DR:'               SU054-DOOR-NUMBER      13759013
137600                      ' USR:'              SU054-USER-ID          13760013
137610                      ' STA:'              PV-DISP-PNA-STA        13761013
137620                      ' SQL:'              PV-DISP-SQLCODE        13762013
137630                      ' DIRECTIVE GENERATOR - PARAMETER ERROR'    13763013
137640                                           DELIMITED BY SIZE      13764013
137650                                      INTO PV-CICS-MSG-AREA2      13765013
137660                                                                  13766013
137670              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13767013
137680              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     13768013
137690                                                                  13769013
137700              PERFORM 9999-WRITE-TO-CSSL                          13770013
137710                                                                  13771013
137720              INITIALIZE PV-CICS-MSG-AREA3                        13772013
137730              MOVE  SU090-MQ-COND-CODE    TO PV-DISP-MQ-COND      13773013
137740              MOVE  SU090-MQ-REAS-CODE    TO PV-DISP-MQ-REAS      13774013
137750                    SU090-MQ-REAS-TXT                             13775013
137760              STRING  'SUKCS782 (SUKUT129)'                       13776099
137770                      ' RC:'           SU090-RET-CODE             13777013
137780                      ' ERR PGM:'      SU090-ERR-PROGRAM          13778013
137790                      ' PARA:'         SU090-ERR-PARAGRAPH        13779013
137800                      ' mq:'           PV-DISP-MQ-COND            13780013
137810                      '-'              PV-DISP-MQ-REAS            13781013
137820                      '-'              SU090-MQ-REAS-TXT          13782013
137830                                           DELIMITED BY SIZE      13783013
137840                                      INTO PV-CICS-MSG-AREA3      13784013
137850                                                                  13785013
137860              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13786013
137870              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     13787013
137880                                                                  13788013
137890              PERFORM 9999-WRITE-TO-CSSL                          13789013
137900                                                                  13790013
137910              INITIALIZE PV-CICS-MSG-AREA4                        13791013
137920              STRING  'SUKCS782 '                                 13792099
137930                      ' SQLCA:'        SU090-SQLCA                13793013
137940                                           DELIMITED BY SIZE      13794013
137950                                      INTO PV-CICS-MSG-AREA4      13795013
137960                                                                  13796013
137970              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13797013
137980              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     13798013
137990                                                                  13799013
138000              PERFORM 9999-WRITE-TO-CSSL                          13800013
138010                                                                  13801013
138020              INITIALIZE PV-CICS-MSG-AREA5                        13802013
138030              STRING  'SUKCS782 '                                 13803099
138040                      ' OPER:'           SU090-OPER-UNT-ID        13804013
138050                      ' ACTN:'           SU090-ACTN-CDE           13805013
138060                      ' LVL:'            SU090-DIRECTIVE-LVL-CDE  13806013
138070                      ' RSN:'            SU090-DIRV-RSN-CDE       13807013
138080                      ' BC:'             SU090-BRCDE-TYP-CDE      13808013
138090                      ' SML:'            SU090-SML-BRCDE-NBR      13809013
138100                      ' P2L:'            SU090-P2L-BRCDE-NBR      13810013
138110                                           DELIMITED BY SIZE      13811013
138120                                      INTO PV-CICS-MSG-AREA5      13812013
138130                                                                  13813013
138140              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13814013
138150              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     13815013
138160                                                                  13816013
138170              PERFORM 9999-WRITE-TO-CSSL                          13817013
138180                                                                  13818013
138190              INITIALIZE PV-CICS-MSG-AREA5                        13819013
138200              STRING  'SUKCS782 '                                 13820099
138210                      ' PO:'             SU090-PO-NBR             13821013
138220                      '-'                SU090-RCVR-SEQ-NBR       13822013
138230                      '-'                SU090-PO-LNE-NBR         13823013
138240                      ' PREPK:'          SU090-PO-PREPK-ID        13824013
138250                      ' CASI:'           SU090-CASI-CDE           13825013
138260                      ' CTN STAT:'       SU090-CART-STAT-CDE      13826013
138270                      ' AUD:'            SU090-AUD-CNTL-NBR       13827013
138280                      ' AUD STAT:'       SU090-AUD-STAT-CDE       13828013
138290                      ' FAIL RSN:'       SU090-AUD-FAIL-RSN       13829013
138300                                           DELIMITED BY SIZE      13830013
138310                                      INTO PV-CICS-MSG-AREA5      13831013
138320                                                                  13832013
138330              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13833013
138340              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     13834013
138350                                                                  13835013
138360              PERFORM 9999-WRITE-TO-CSSL                          13836013
138370                                                                  13837013
138380              INITIALIZE PV-CICS-MSG-AREA6                        13838013
138390              STRING  'SUKCS782 '                                 13839099
138400                      ' ZN:'          SU090-STR-ZN                13840013
138410                      ' SET:'         SU090-SEASET-YR             13841013
138420                      '-'             SU090-SEASET-CDE            13842013
138430                      ' STR:'         SU090-STR-NBR               13843013
138440                      ' MQ CONN:'     SU090-QMNGR-CONNECTED-SW    13844013
138450                      ' RESEND:'      SU090-DIRECTIVE-RESEND-SW   13845013
138460                      ' RFID:'        SU090-RFID-AUD-DIRECTIVE-SW 13846013
138470                      ' RFID AUD:'    SU090-RFID-AUD-CNTL-NBR     13847013
138480                                           DELIMITED BY SIZE      13848013
138490                                      INTO PV-CICS-MSG-AREA6      13849013
138500                                                                  13850013
138510              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13851013
138520              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     13852013
138530                                                                  13853013
138540              PERFORM 9999-WRITE-TO-CSSL                          13854013
138550                                                                  13855013
138560              SET PS-PROCESSING-ERROR-YES TO TRUE                 13856013
138570              PERFORM 9998-WRITE-TO-CSSL                          13857013
138580         WHEN SU090-DB2-ERROR                                     13858013
138590              SET PS-PROCESSING-ERROR-YES     TO TRUE             13859013
138600                                                                  13860013
138610              INITIALIZE PV-CICS-MSG-AREA1                        13861013
138620              INITIALIZE PV-CICS-MSG-AREA2                        13862013
138630                                                                  13863013
138640              MOVE SU090-SQLCODE        TO PV-DISP-SQLCODE        13864013
138650              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             13865013
138660              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           13866013
138670              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        13867013
138680                                                                  13868013
138690              STRING  'SUKCS782 6100-'                            13869099
138700                      ' DC:'               PV-DISP-DC             13870013
138710                      ' B1:'               SU054-BAR-CODE-1       13871013
138720                      ' B2:'               SU054-BAR-CODE-2       13872013
138730                      ' B3:'               SU054-BAR-CODE-3       13873013
138740                                           DELIMITED BY SIZE      13874013
138750                                      INTO PV-CICS-MSG-AREA1      13875013
138760                                                                  13876013
138770              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13877013
138780              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     13878013
138790                                                                  13879013
138800              PERFORM 9999-WRITE-TO-CSSL                          13880013
138810                                                                  13881013
138820              STRING  'SUKCS782 '          SU054-KOHLS-SML        13882099
138830                      ' TRIP:'             PV-DISP-TRIP           13883013
138840                      ' DR:'               SU054-DOOR-NUMBER      13884013
138850                      ' USR:'              SU054-USER-ID          13885013
138860                      ' STA:'              PV-DISP-PNA-STA        13886013
138870                      ' SQL:'              PV-DISP-SQLCODE        13887013
138880                      ' DIRECTIVE GENERATOR-DB2 ERROR'            13888013
138890                                           DELIMITED BY SIZE      13889013
138900                                      INTO PV-CICS-MSG-AREA2      13890013
138910                                                                  13891013
138920              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13892013
138930              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     13893013
138940                                                                  13894013
138950              PERFORM 9999-WRITE-TO-CSSL                          13895013
138960                                                                  13896013
138970              INITIALIZE PV-CICS-MSG-AREA3                        13897013
138980              MOVE  SU090-MQ-COND-CODE    TO PV-DISP-MQ-COND      13898013
138990              MOVE  SU090-MQ-REAS-CODE    TO PV-DISP-MQ-REAS      13899013
139000                    SU090-MQ-REAS-TXT                             13900013
139010              STRING  'SUKCS782 (SUKUT129)'                       13901099
139020                      ' RC:'           SU090-RET-CODE             13902013
139030                      ' ERR PGM:'      SU090-ERR-PROGRAM          13903013
139040                      ' PARA:'         SU090-ERR-PARAGRAPH        13904013
139050                      ' mq:'           PV-DISP-MQ-COND            13905013
139060                      '-'              PV-DISP-MQ-REAS            13906013
139070                      '-'              SU090-MQ-REAS-TXT          13907013
139080                                           DELIMITED BY SIZE      13908013
139090                                      INTO PV-CICS-MSG-AREA3      13909013
139100                                                                  13910013
139110              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13911013
139120              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     13912013
139130                                                                  13913013
139140              PERFORM 9999-WRITE-TO-CSSL                          13914013
139150                                                                  13915013
139160              INITIALIZE PV-CICS-MSG-AREA4                        13916013
139170              STRING  'SUKCS782 '                                 13917099
139180                      ' SQLCA:'        SU090-SQLCA                13918013
139190                                           DELIMITED BY SIZE      13919013
139200                                      INTO PV-CICS-MSG-AREA4      13920013
139210                                                                  13921013
139220              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13922013
139230              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     13923013
139240                                                                  13924013
139250              PERFORM 9999-WRITE-TO-CSSL                          13925013
139260                                                                  13926013
139270              INITIALIZE PV-CICS-MSG-AREA5                        13927013
139280              STRING  'SUKCS782 '                                 13928099
139290                      ' OPER:'           SU090-OPER-UNT-ID        13929013
139300                      ' ACTN:'           SU090-ACTN-CDE           13930013
139310                      ' LVL:'            SU090-DIRECTIVE-LVL-CDE  13931013
139320                      ' RSN:'            SU090-DIRV-RSN-CDE       13932013
139330                      ' BC:'             SU090-BRCDE-TYP-CDE      13933013
139340                      ' SML:'            SU090-SML-BRCDE-NBR      13934013
139350                      ' P2L:'            SU090-P2L-BRCDE-NBR      13935013
139360                                           DELIMITED BY SIZE      13936013
139370                                      INTO PV-CICS-MSG-AREA5      13937013
139380                                                                  13938013
139390              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13939013
139400              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     13940013
139410                                                                  13941013
139420              PERFORM 9999-WRITE-TO-CSSL                          13942013
139430                                                                  13943013
139440              INITIALIZE PV-CICS-MSG-AREA5                        13944013
139450              STRING  'SUKCS782 '                                 13945099
139460                      ' PO:'             SU090-PO-NBR             13946013
139470                      '-'                SU090-RCVR-SEQ-NBR       13947013
139480                      '-'                SU090-PO-LNE-NBR         13948013
139490                      ' PREPK:'          SU090-PO-PREPK-ID        13949013
139500                      ' CASI:'           SU090-CASI-CDE           13950013
139510                      ' CTN STAT:'       SU090-CART-STAT-CDE      13951013
139520                      ' AUD:'            SU090-AUD-CNTL-NBR       13952013
139530                      ' AUD STAT:'       SU090-AUD-STAT-CDE       13953013
139540                      ' FAIL RSN:'       SU090-AUD-FAIL-RSN       13954013
139550                                           DELIMITED BY SIZE      13955013
139560                                      INTO PV-CICS-MSG-AREA5      13956013
139570                                                                  13957013
139580              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13958013
139590              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     13959013
139600                                                                  13960013
139610              PERFORM 9999-WRITE-TO-CSSL                          13961013
139620                                                                  13962013
139630              INITIALIZE PV-CICS-MSG-AREA6                        13963013
139640              STRING  'SUKCS782 '                                 13964099
139650                      ' ZN:'          SU090-STR-ZN                13965013
139660                      ' SET:'         SU090-SEASET-YR             13966013
139670                      '-'             SU090-SEASET-CDE            13967013
139680                      ' STR:'         SU090-STR-NBR               13968013
139690                      ' MQ CONN:'     SU090-QMNGR-CONNECTED-SW    13969013
139700                      ' RESEND:'      SU090-DIRECTIVE-RESEND-SW   13970013
139710                      ' RFID:'        SU090-RFID-AUD-DIRECTIVE-SW 13971013
139720                      ' RFID AUD:'    SU090-RFID-AUD-CNTL-NBR     13972013
139730                                           DELIMITED BY SIZE      13973013
139740                                      INTO PV-CICS-MSG-AREA6      13974013
139750                                                                  13975013
139760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     13976013
139770              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     13977013
139780                                                                  13978013
139790              PERFORM 9999-WRITE-TO-CSSL                          13979013
139800                                                                  13980013
139810              SET PS-PROCESSING-ERROR-YES TO TRUE                 13981013
139820              PERFORM 9998-WRITE-TO-CSSL                          13982013
139830         WHEN SU090-MQ-ERROR                                      13983013
139840              SET PS-PROCESSING-ERROR-YES     TO TRUE             13984013
139850                                                                  13985013
139860              INITIALIZE PV-CICS-MSG-AREA1                        13986013
139870              INITIALIZE PV-CICS-MSG-AREA2                        13987013
139880                                                                  13988013
139890              MOVE SU090-SQLCODE        TO PV-DISP-SQLCODE        13989013
139900              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             13990013
139910              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           13991013
139920              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        13992013
139930                                                                  13993013
139940              STRING  'SUKCS782 6100-'                            13994099
139950                      ' DC:'               PV-DISP-DC             13995013
139960                      ' B1:'               SU054-BAR-CODE-1       13996013
139970                      ' B2:'               SU054-BAR-CODE-2       13997013
139980                      ' B3:'               SU054-BAR-CODE-3       13998013
139990                                           DELIMITED BY SIZE      13999013
140000                                      INTO PV-CICS-MSG-AREA1      14000013
140010                                                                  14001013
140020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14002013
140030              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     14003013
140040                                                                  14004013
140050              PERFORM 9999-WRITE-TO-CSSL                          14005013
140060                                                                  14006013
140070              STRING  'SUKCS782 '          SU054-KOHLS-SML        14007099
140080                      ' TRIP:'             PV-DISP-TRIP           14008013
140090                      ' DR:'               SU054-DOOR-NUMBER      14009013
140100                      ' USR:'              SU054-USER-ID          14010013
140110                      ' STA:'              PV-DISP-PNA-STA        14011013
140120                      ' SQL:'              PV-DISP-SQLCODE        14012013
140130                      ' DIRECTIVE GENERATOR-MQ ERROR'             14013013
140140                                           DELIMITED BY SIZE      14014013
140150                                      INTO PV-CICS-MSG-AREA2      14015013
140160                                                                  14016013
140170              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14017013
140180              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     14018013
140190                                                                  14019013
140200              PERFORM 9999-WRITE-TO-CSSL                          14020013
140210                                                                  14021013
140220              INITIALIZE PV-CICS-MSG-AREA3                        14022013
140230              MOVE  SU090-MQ-COND-CODE    TO PV-DISP-MQ-COND      14023013
140240              MOVE  SU090-MQ-REAS-CODE    TO PV-DISP-MQ-REAS      14024013
140250                    SU090-MQ-REAS-TXT                             14025013
140260              STRING  'SUKCS782 (SUKUT129)'                       14026099
140270                      ' RC:'           SU090-RET-CODE             14027013
140280                      ' ERR PGM:'      SU090-ERR-PROGRAM          14028013
140290                      ' PARA:'         SU090-ERR-PARAGRAPH        14029013
140300                      ' mq:'           PV-DISP-MQ-COND            14030013
140310                      '-'              PV-DISP-MQ-REAS            14031013
140320                      '-'              SU090-MQ-REAS-TXT          14032013
140330                                           DELIMITED BY SIZE      14033013
140340                                      INTO PV-CICS-MSG-AREA3      14034013
140350                                                                  14035013
140360              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14036013
140370              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     14037013
140380                                                                  14038013
140390              PERFORM 9999-WRITE-TO-CSSL                          14039013
140400                                                                  14040013
140410              INITIALIZE PV-CICS-MSG-AREA4                        14041013
140420              STRING  'SUKCS782 '                                 14042099
140430                      ' SQLCA:'        SU090-SQLCA                14043013
140440                                           DELIMITED BY SIZE      14044013
140450                                      INTO PV-CICS-MSG-AREA4      14045013
140460                                                                  14046013
140470              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14047013
140480              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     14048013
140490                                                                  14049013
140500              PERFORM 9999-WRITE-TO-CSSL                          14050013
140510                                                                  14051013
140520              INITIALIZE PV-CICS-MSG-AREA5                        14052013
140530              STRING  'SUKCS782 '                                 14053099
140540                      ' OPER:'           SU090-OPER-UNT-ID        14054013
140550                      ' ACTN:'           SU090-ACTN-CDE           14055013
140560                      ' LVL:'            SU090-DIRECTIVE-LVL-CDE  14056013
140570                      ' RSN:'            SU090-DIRV-RSN-CDE       14057013
140580                      ' BC:'             SU090-BRCDE-TYP-CDE      14058013
140590                      ' SML:'            SU090-SML-BRCDE-NBR      14059013
140600                      ' P2L:'            SU090-P2L-BRCDE-NBR      14060013
140610                                           DELIMITED BY SIZE      14061013
140620                                      INTO PV-CICS-MSG-AREA5      14062013
140630                                                                  14063013
140640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14064013
140650              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     14065013
140660                                                                  14066013
140670              PERFORM 9999-WRITE-TO-CSSL                          14067013
140680                                                                  14068013
140690              INITIALIZE PV-CICS-MSG-AREA5                        14069013
140700              STRING  'SUKCS782 '                                 14070099
140710                      ' PO:'             SU090-PO-NBR             14071013
140720                      '-'                SU090-RCVR-SEQ-NBR       14072013
140730                      '-'                SU090-PO-LNE-NBR         14073013
140740                      ' PREPK:'          SU090-PO-PREPK-ID        14074013
140750                      ' CASI:'           SU090-CASI-CDE           14075013
140760                      ' CTN STAT:'       SU090-CART-STAT-CDE      14076013
140770                      ' AUD:'            SU090-AUD-CNTL-NBR       14077013
140780                      ' AUD STAT:'       SU090-AUD-STAT-CDE       14078013
140790                      ' FAIL RSN:'       SU090-AUD-FAIL-RSN       14079013
140800                                           DELIMITED BY SIZE      14080013
140810                                      INTO PV-CICS-MSG-AREA5      14081013
140820                                                                  14082013
140830              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14083013
140840              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     14084013
140850                                                                  14085013
140860              PERFORM 9999-WRITE-TO-CSSL                          14086013
140870                                                                  14087013
140880              INITIALIZE PV-CICS-MSG-AREA6                        14088013
140890              STRING  'SUKCS782 '                                 14089099
140900                      ' ZN:'          SU090-STR-ZN                14090013
140910                      ' SET:'         SU090-SEASET-YR             14091013
140920                      '-'             SU090-SEASET-CDE            14092013
140930                      ' STR:'         SU090-STR-NBR               14093013
140940                      ' MQ CONN:'     SU090-QMNGR-CONNECTED-SW    14094013
140950                      ' RESEND:'      SU090-DIRECTIVE-RESEND-SW   14095013
140960                      ' RFID:'        SU090-RFID-AUD-DIRECTIVE-SW 14096013
140970                      ' RFID AUD:'    SU090-RFID-AUD-CNTL-NBR     14097013
140980                                           DELIMITED BY SIZE      14098013
140990                                      INTO PV-CICS-MSG-AREA6      14099013
141000                                                                  14100013
141010              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14101013
141020              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     14102013
141030                                                                  14103013
141040              PERFORM 9999-WRITE-TO-CSSL                          14104013
141050                                                                  14105013
141060              SET PS-PROCESSING-ERROR-YES TO TRUE                 14106013
141070              PERFORM 9998-WRITE-TO-CSSL                          14107013
141080         WHEN SU090-OTHER-ERROR                                   14108013
141090              SET PS-PROCESSING-ERROR-YES     TO TRUE             14109013
141100              MOVE SQLCODE              TO PV-SQLCODE             14110013
141110                                                                  14111013
141120              INITIALIZE PV-CICS-MSG-AREA1                        14112013
141130              INITIALIZE PV-CICS-MSG-AREA2                        14113013
141140                                                                  14114013
141150              MOVE SU090-SQLCODE        TO PV-DISP-SQLCODE        14115013
141160              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             14116013
141170              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           14117013
141180              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        14118013
141190                                                                  14119013
141200              STRING  'SUKCS782 6100-'                            14120099
141210                      ' DC:'               PV-DISP-DC             14121013
141220                      ' B1:'               SU054-BAR-CODE-1       14122013
141230                      ' B2:'               SU054-BAR-CODE-2       14123013
141240                      ' B3:'               SU054-BAR-CODE-3       14124013
141250                                           DELIMITED BY SIZE      14125013
141260                                      INTO PV-CICS-MSG-AREA1      14126013
141270                                                                  14127013
141280              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14128013
141290              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     14129013
141300                                                                  14130013
141310              PERFORM 9999-WRITE-TO-CSSL                          14131013
141320                                                                  14132013
141330              STRING  'SUKCS782 '          SU054-KOHLS-SML        14133099
141340                      ' TRIP:'             PV-DISP-TRIP           14134013
141350                      ' DR:'               SU054-DOOR-NUMBER      14135013
141360                      ' USR:'              SU054-USER-ID          14136013
141370                      ' STA:'              PV-DISP-PNA-STA        14137013
141380                      ' SQL:'              PV-DISP-SQLCODE        14138013
141390                      ' DIRECTIVE GENERATOR'                      14139013
141400                                           DELIMITED BY SIZE      14140013
141410                                      INTO PV-CICS-MSG-AREA2      14141013
141420                                                                  14142013
141430              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14143013
141440              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     14144013
141450                                                                  14145013
141460              PERFORM 9999-WRITE-TO-CSSL                          14146013
141470                                                                  14147013
141480              INITIALIZE PV-CICS-MSG-AREA3                        14148013
141490              MOVE  SU090-MQ-COND-CODE    TO PV-DISP-MQ-COND      14149013
141500              MOVE  SU090-MQ-REAS-CODE    TO PV-DISP-MQ-REAS      14150013
141510                    SU090-MQ-REAS-TXT                             14151013
141520              STRING  'SUKCS782 (SUKUT129)'                       14152099
141530                      ' RC:'           SU090-RET-CODE             14153013
141540                      ' ERR PGM:'      SU090-ERR-PROGRAM          14154013
141550                      ' PARA:'         SU090-ERR-PARAGRAPH        14155013
141560                      ' mq:'           PV-DISP-MQ-COND            14156013
141570                      '-'              PV-DISP-MQ-REAS            14157013
141580                      '-'              SU090-MQ-REAS-TXT          14158013
141590                                           DELIMITED BY SIZE      14159013
141600                                      INTO PV-CICS-MSG-AREA3      14160013
141610                                                                  14161013
141620              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14162013
141630              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     14163013
141640                                                                  14164013
141650              PERFORM 9999-WRITE-TO-CSSL                          14165013
141660                                                                  14166013
141670              INITIALIZE PV-CICS-MSG-AREA4                        14167013
141680              STRING  'SUKCS782 '                                 14168099
141690                      ' SQLCA:'        SU090-SQLCA                14169013
141700                                           DELIMITED BY SIZE      14170013
141710                                      INTO PV-CICS-MSG-AREA4      14171013
141720                                                                  14172013
141730              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14173013
141740              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     14174013
141750                                                                  14175013
141760              PERFORM 9999-WRITE-TO-CSSL                          14176013
141770                                                                  14177013
141780              INITIALIZE PV-CICS-MSG-AREA5                        14178013
141790              STRING  'SUKCS782 '                                 14179099
141800                      ' OPER:'           SU090-OPER-UNT-ID        14180013
141810                      ' ACTN:'           SU090-ACTN-CDE           14181013
141820                      ' LVL:'            SU090-DIRECTIVE-LVL-CDE  14182013
141830                      ' RSN:'            SU090-DIRV-RSN-CDE       14183013
141840                      ' BC:'             SU090-BRCDE-TYP-CDE      14184013
141850                      ' SML:'            SU090-SML-BRCDE-NBR      14185013
141860                      ' P2L:'            SU090-P2L-BRCDE-NBR      14186013
141870                                           DELIMITED BY SIZE      14187013
141880                                      INTO PV-CICS-MSG-AREA5      14188013
141890                                                                  14189013
141900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14190013
141910              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     14191013
141920                                                                  14192013
141930              PERFORM 9999-WRITE-TO-CSSL                          14193013
141940                                                                  14194013
141950              INITIALIZE PV-CICS-MSG-AREA5                        14195013
141960              STRING  'SUKCS782 '                                 14196099
141970                      ' PO:'             SU090-PO-NBR             14197013
141980                      '-'                SU090-RCVR-SEQ-NBR       14198013
141990                      '-'                SU090-PO-LNE-NBR         14199013
142000                      ' PREPK:'          SU090-PO-PREPK-ID        14200013
142010                      ' CASI:'           SU090-CASI-CDE           14201013
142020                      ' CTN STAT:'       SU090-CART-STAT-CDE      14202013
142030                      ' AUD:'            SU090-AUD-CNTL-NBR       14203013
142040                      ' AUD STAT:'       SU090-AUD-STAT-CDE       14204013
142050                      ' FAIL RSN:'       SU090-AUD-FAIL-RSN       14205013
142060                                           DELIMITED BY SIZE      14206013
142070                                      INTO PV-CICS-MSG-AREA5      14207013
142080                                                                  14208013
142090              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14209013
142100              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     14210013
142110                                                                  14211013
142120              PERFORM 9999-WRITE-TO-CSSL                          14212013
142130                                                                  14213013
142140              INITIALIZE PV-CICS-MSG-AREA6                        14214013
142150              STRING  'SUKCS782 '                                 14215099
142160                      ' ZN:'          SU090-STR-ZN                14216013
142170                      ' SET:'         SU090-SEASET-YR             14217013
142180                      '-'             SU090-SEASET-CDE            14218013
142190                      ' STR:'         SU090-STR-NBR               14219013
142200                      ' MQ CONN:'     SU090-QMNGR-CONNECTED-SW    14220013
142210                      ' RESEND:'      SU090-DIRECTIVE-RESEND-SW   14221013
142220                      ' RFID:'        SU090-RFID-AUD-DIRECTIVE-SW 14222013
142230                      ' RFID AUD:'    SU090-RFID-AUD-CNTL-NBR     14223013
142240                                           DELIMITED BY SIZE      14224013
142250                                      INTO PV-CICS-MSG-AREA6      14225013
142260                                                                  14226013
142270              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14227013
142280              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     14228013
142290                                                                  14229013
142300              PERFORM 9999-WRITE-TO-CSSL                          14230013
142310                                                                  14231013
142320              SET PS-PROCESSING-ERROR-YES TO TRUE                 14232013
142330              PERFORM 9998-WRITE-TO-CSSL                          14233013
142340     END-EVALUATE.                                                14234013
142350                                                                  14235013
142360* JAK WR41309 - ADD PARAGRAM FOR CALL TO SUKUT149                 14236013
142370* CALL SUKUT149 TO DETERMINE IF CARTON IS RFID                    14237013
142380 6010-CALL-RFID-DETERMINATION.                                    14238013
142390                                                                  14239013
142400* CLP 06/20/13 PR5148B START                                      14240013
142410                                                                  14241013
142420     MOVE  '6010'  TO  PT-CURR-PARA.                              14242013
142430     IF  PS-BLD-INTERNAL-TABLE-YES                                14243013
142440         PERFORM 0200-INTERNAL-TABLE                              14244013
142450     ELSE                                                         14245013
142460         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       14246013
142470     END-IF.                                                      14247013
142480                                                                  14248013
142490     IF PS-LOG-MESSAGE                                            14249013
142500        STRING 'SUKCS782  6010-'                                  14250099
142510             ' CARTON-SW '                                        14251013
142520              PS-SML-CREATION-SW                                  14252013
142530             ' DC= '                                              14253013
142540             SU054-DC-NUMBER                                      14254013
142550             ' STR = '                                            14255013
142560             PV-STORE-N                                           14256013
142570             ' CTN ='                                             14257013
142580             PV-CTN-N                                             14258013
142590             ' WHSE='                                             14259013
142600             PS-WHSE-OTBND-CART-SW                                14260013
142610             ' IR FAC='                                           14261013
142620             PV-20-SML-BC-DC-ORIGIN-R                             14262013
142630             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B            14263013
142640             PERFORM 9999-WRITE-TO-CSSL                           14264013
142650     END-IF.                                                      14265013
142660                                                                  14266013
142670     INITIALIZE SU093-ITEM-COMMAREA.                              14267013
142680                                                                  14268013
142690     IF PS-WHSE-OTBND-CART-YES                                    14269013
142700          SET SU093-OUTBOUND-CTN                TO TRUE           14270013
142710          SET SU093-CARTON-STATUS               TO TRUE           14271013
142720          SET SU093-CHECK-BY-DEPT-SUBCLS-YES    TO TRUE           14272013
142730          SET SU093-CHECK-BY-DEPT-IN-STR-YES    TO TRUE           14273013
142740          SET SU093-RFID-STR-CHK-NEEDED-YES     TO TRUE           14274013
142750          SET SU093-CHECK-BY-DC                 TO TRUE           14275013
142760          MOVE SU054-DC-NUMBER           TO SU093-KEY-OPER-UNT-ID 14276013
142770          MOVE PV-STORE-N                TO SU093-KEY-DEST-LOC    14277013
142780          MOVE PV-CTN-N                  TO SU093-KEY-CARTON-ID   14278013
142790*CLP 10/29/13 - START                                             14279013
142800          INITIALIZE PV-20-DIGIT-BARCODE                          14280013
142810          SET  PV-RFID-REPLEN-NO         TO TRUE                  14281013
142820          MOVE PV-CTN-N                  TO PV-20-DIGIT-BARCODE   14282013
142830*         THIS IS THE FACILITY #                                  14283013
142840          MOVE PV-20-SML-BC-DC-ORIGIN-R  TO SU093-KEY-IR-NBR      14284013
142850          SET SU093-IR-CHK-IN-YES        TO TRUE                  14285013
142860*CLP 10/29/13 - END                                               14286013
142870     ELSE                                                         14287013
142880          SET  SU093-CHECK-IN          TO TRUE                    14288013
142890          IF PS-CARTON-P2L-CREATED                                14289013
142900             SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE           14290013
142910             SET SU093-CHECK-BY-DEPT-IN-STR-NO  TO TRUE           14291013
142920             SET SU093-RFID-STR-CHK-NEEDED-NO   TO TRUE           14292013
142930             SET SU093-CHECK-BY-DC              TO TRUE           14293013
142940             SET SU093-P2L-CHK-IN-YES TO TRUE                     14294013
142950             MOVE SU054-DC-NUMBER         TO SU093-KEY-OPER-UNT-ID14295013
142960             MOVE PV-CTN-N                TO SU093-KEY-CARTON-ID  14296013
142970          ELSE                                                    14297013
142980             SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE           14298013
142990             SET SU093-CHECK-BY-DEPT-IN-STR-YES TO TRUE           14299013
143000             SET SU093-CHECK-BY-DC              TO TRUE           14300013
143010             MOVE SU054-DC-NUMBER        TO SU093-KEY-OPER-UNT-ID 14301013
143020             MOVE PV-STORE-N             TO SU093-KEY-DEST-LOC    14302013
143030             MOVE PV-CTN-N               TO SU093-KEY-CARTON-ID   14303013
143040             SET SU093-RFID-STR-CHK-NEEDED-YES  TO TRUE           14304013
143050             SET SU093-P2L-CHK-IN-NO  TO TRUE                     14305013
143060     END-IF.                                                      14306013
143070                                                                  14307013
143080     CALL SU093-RFID-PGM       USING DFHEIBLK                     14308013
143090                                     SU093-COMMAREA               14309013
143100                                     SU093-ITEM-COMMAREA.         14310013
143110                                                                  14311013
143120*    SWITCHES COMING BACK FROM SUBROUTINE                         14312013
143130     IF PS-LOG-MESSAGE                                            14313013
143140        MOVE SPACE to PV-CICS-MSG-AREA-B                          14314013
143150        STRING 'SUKCS782  SW= '                                   14315099
143160             ' COMPLI= '                                          14316013
143170               SU093-VNDR-DPT-RFID-COMPLI-SW                      14317013
143180             ' VRFD-TAGS= '                                       14318013
143190             SU093-VNDR-DPT-RFID-TAGS-SW                          14319013
143200             ' DC-DEPT-TAGS='                                     14320013
143210             SU093-DC-DEPT-TAGS-SW                                14321013
143220             ' CART='                                             14322013
143230             SU093-DC-USE-RFID-CART-LBL-SW                        14323013
143240             ' AUTO= '                                            14324013
143250             SU093-RFID-DC-AUTO-CONVEYR-SW                        14325013
143260             ' P2L= '                                             14326013
143270             SU093-DPT-STR-P2L-FIRST-SW                           14327013
143280             ' IR = '                                             14328013
143290             SU093-IR-CHK-IN-SW                                   14329013
143300             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B            14330013
143310             PERFORM 9999-WRITE-TO-CSSL                           14331013
143320     END-IF.                                                      14332013
143330*                                                                 14333013
143340     IF PS-LOG-MESSAGE                                            14334013
143350         MOVE SPACE to PV-CICS-MSG-AREA-B                         14335013
143360         STRING 'SUKCS782  AFTER SUB CALL '                       14336099
143370                ' RETURN CODE   '                                 14337013
143380                SU093-RETURN-CODE                                 14338013
143390                ' RFID-IND=  '                                    14339013
143400                SU093-RFID-IND                                    14340013
143410                ' ERROR-NBR  '                                    14341013
143420                SU093-ERROR-NBR                                   14342013
143430                DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B         14343013
143440                PERFORM 9999-WRITE-TO-CSSL                        14344013
143450     END-IF.                                                      14345013
143460                                                                  14346013
143470     EVALUATE TRUE                                                14347013
143480       WHEN SU093-SUCCESSFUL                                      14348013
143490           IF SU093-RFID-IND = 'Y'                                14349013
143500               PERFORM 6020-SET-DIRECT-AND-LABEL                  14350013
143510           END-IF                                                 14351013
143520       WHEN OTHER                                                 14352013
143530                                                                  14353013
143540              INITIALIZE PV-CICS-MSG-AREA1                        14354013
143550              INITIALIZE PV-CICS-MSG-AREA2                        14355013
143560                                                                  14356013
143570              MOVE SU093-SQLCODE        TO PV-DISP-SQLCODE        14357013
143580              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             14358013
143590              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           14359013
143600              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        14360013
143610                                                                  14361013
143620              STRING  'SUKCS782 6010-'                            14362099
143630                      ' DC:'               PV-DISP-DC             14363013
143640                      ' B1:'               SU054-BAR-CODE-1       14364013
143650                      ' B2:'               SU054-BAR-CODE-2       14365013
143660                      ' B3:'               SU054-BAR-CODE-3       14366013
143670                                           DELIMITED BY SIZE      14367013
143680                                      INTO PV-CICS-MSG-AREA1      14368013
143690                                                                  14369013
143700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14370013
143710              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     14371013
143720                                                                  14372013
143730              PERFORM 9999-WRITE-TO-CSSL                          14373013
143740                                                                  14374013
143750              STRING  'SUKCS782 '          SU054-KOHLS-SML        14375099
143760                      ' TRIP:'             PV-DISP-TRIP           14376013
143770                      ' DR:'               SU054-DOOR-NUMBER      14377013
143780                      ' USR:'              SU054-USER-ID          14378013
143790                      ' STA:'              PV-DISP-PNA-STA        14379013
143800                      ' SQL:'              PV-DISP-SQLCODE        14380013
143810                      ' RFID DIRECTIVE MODULE'                    14381013
143820                                           DELIMITED BY SIZE      14382013
143830                                      INTO PV-CICS-MSG-AREA2      14383013
143840                                                                  14384013
143850              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14385013
143860              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     14386013
143870                                                                  14387013
143880              PERFORM 9999-WRITE-TO-CSSL                          14388013
143890                                                                  14389013
143900              INITIALIZE PV-CICS-MSG-AREA3                        14390013
143910              MOVE  SU093-KEY-PO          TO  PV-DISP-PO          14391013
143920              MOVE  SU093-KEY-REC-SEQ-NBR TO  PV-DISP-RCVR        14392013
143930              MOVE  SU093-KEY-LNE-NBR     TO  pv-disp-line        14393013
143940              MOVE  SU093-KEY-PREPK-ID    TO  PV-DISP-PREPK       14394013
143950              MOVE  SU093-KEY-OPER-UNT-ID TO  PV-DISP-OPER        14395013
143960              MOVE  SU093-KEY-DEST-LOC    TO  PV-DISP-DEST-OPER   14396013
143970                                                                  14397013
143980              STRING  'SUKCS782 (SUKUT149)'                       14398099
143990                      ' METHOD:'       SU093-ACCESS-METHOD        14399013
144000                      ' VIEW:'         SU093-VIEW-SELECTION       14400013
144010                      ' RC:'           SU093-RETURN-CODE          14401013
144020                      ' FLAGS:'        SU093-FLAGS                14402013
144030                      ' ERR:'          SU093-ERROR-NBR            14403013
144040                      ' PO:'           PV-DISP-PO                 14404013
144050                      '-'              PV-DISP-RCVR               14405013
144060                      '-'              pv-disp-line               14406013
144070                      '/'              PV-DISP-PREPK              14407013
144080                      ' OPER:'         PV-DISP-OPER               14408013
144090                      ' DEST:'         PV-DISP-DEST-OPER          14409013
144100                                           DELIMITED BY SIZE      14410013
144110                                      INTO PV-CICS-MSG-AREA3      14411013
144120                                                                  14412013
144130              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14413013
144140              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     14414013
144150                                                                  14415013
144160              PERFORM 9999-WRITE-TO-CSSL                          14416013
144170                                                                  14417013
144180              INITIALIZE PV-CICS-MSG-AREA4                        14418013
144190              MOVE  SU093-KEY-CARTON-ID   TO  PV-DISP-SSCC        14419013
144200              MOVE  SU093-KEY-SKU-NBR     TO  PV-DISP-SKU         14420013
144210              MOVE  SU093-KEY-IR-NBR      TO  PV-DISP-IR          14421013
144220              STRING  'SUKCS782 '                                 14422099
144230                      ' SSCC:'      PV-DISP-SSCC                  14423013
144240                      ' SKU:'       PV-DISP-SKU                   14424013
144250                      ' IR:'        PV-DISP-IR                    14425013
144260                      ' RFID:'      SU093-RFID-IND                14426013
144270                      ' IN STR:'    SU093-RFID-KOHL-DPT-IN-STR-SW 14427013
144280                      ' RFID DEPT:' SU093-RFID-KOHL-DEPT-SUBCL-SW 14428013
144290                                           DELIMITED BY SIZE      14429013
144300                                      INTO PV-CICS-MSG-AREA4      14430013
144310                                                                  14431013
144320              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14432013
144330              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     14433013
144340                                                                  14434013
144350              PERFORM 9999-WRITE-TO-CSSL                          14435013
144360                                                                  14436013
144370              INITIALIZE PV-CICS-MSG-AREA5                        14437013
144380              STRING  'SUKCS782 '                                 14438099
144390                      ' compli:'    SU093-VNDR-DPT-RFID-COMPLI-SW 14439013
144400                      ' vnd tags:'  SU093-VNDR-DPT-RFID-TAGS-SW   14440013
144410                      ' dc tags:'   SU093-DC-DEPT-TAGS-SW         14441013
144420                      ' dc lbl:'    SU093-DC-USE-RFID-CART-LBL-SW 14442013
144430                      ' auto cnvy:' SU093-RFID-DC-AUTO-CONVEYr-sw 14443013
144440                      ' p2l 1st:'   SU093-DPT-STR-P2L-FIRST-SW    14444013
144450                      ' p2l ckn:'   SU093-P2L-CHK-IN-SW           14445013
144460                      ' ir tag:'    SU093-IR-NEEDS-DC-TAGGING-SW  14446013
144470                                           DELIMITED BY SIZE      14447013
144480                                      INTO PV-CICS-MSG-AREA5      14448013
144490                                                                  14449013
144500              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14450013
144510              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     14451013
144520                                                                  14452013
144530              PERFORM 9999-WRITE-TO-CSSL                          14453013
144540                                                                  14454013
144550              INITIALIZE PV-CICS-MSG-AREA6                        14455013
144560              STRING  'SUKCS782 '                                 14456099
144570                      ' SQLCA:'     SU093-SQLCA                   14457013
144580                                           DELIMITED BY SIZE      14458013
144590                                      INTO PV-CICS-MSG-AREA6      14459013
144600                                                                  14460013
144610              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14461013
144620              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     14462013
144630                                                                  14463013
144640              PERFORM 9999-WRITE-TO-CSSL                          14464013
144650                                                                  14465013
144660     END-EVALUATE.                                                14466013
144670* JAK WR41309 - END                                               14467013
144680                                                                  14468013
144690 6020-SET-DIRECT-AND-LABEL.                                       14469013
144700*                                                                 14470013
144710** added internal table to track paragraph execution time         14471013
144720** dmh 2014-12-22 - begin                                         14472013
144730*                                                                 14473013
144740     MOVE  '6020'  TO  PT-CURR-PARA.                              14474013
144750     IF  PS-BLD-INTERNAL-TABLE-YES                                14475013
144760         PERFORM 0200-INTERNAL-TABLE                              14476013
144770     ELSE                                                         14477013
144780         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       14478013
144790     END-IF.                                                      14479013
144800                                                                  14480013
144810*                                                                 14481013
144820** DMH 2014-12-22 - END                                           14482013
144830*                                                                 14483013
144840* **************************************************************  14484013
144850* ONCE COMING BACK FROM ROUTINE AND YOU KNOW ITS RFID YOU      *  14485013
144860* STILL NEED TO CHECK THE FOLLOWING SWITCHES TO DETERMINE IF   *  14486013
144870* RFID IS PRINTED ON THE LABEL AND ALSO IF THERE IS A DIRECTIVE*  14487013
144880* **************************************************************  14488013
144890* * ALSO SETS CARTON LABEL                                     *  14489013
144900* **************************************************************  14490013
144910* * ALSO CHECK FOR P2L AND NOT AUTO CONVEYOR TURN DIRECTIVE OFF*  14491013
144920* **************************************************************  14492013
144930* * ALSO CHECK IF IR FACILITY IS TAGGING                       *  14493013
144940* **************************************************************  14494013
144950                                                                  14495013
144960     SET PS-DIRECTIVE-NO     TO TRUE.                             14496013
144970     SET PS-RFID-ON-LABEL-NO TO TRUE.                             14497013
144980     SET PS-DC-USE-RFID-CART-LBL-NO TO TRUE.                      14498013
144990*CLP 10/29/13                                                     14499013
145000     SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE.                    14500013
145010*CLP 10/29/13                                                     14501013
145020                                                                  14502013
145030     IF SU093-VNDR-DPT-RFID-COMPLI-YES                            14503013
145040*       Means no directive and no RFID on labels                  14504013
145050        SET PS-DIRECTIVE-NO     TO TRUE                           14505013
145060        SET PS-RFID-ON-LABEL-NO TO TRUE                           14506013
145070     ELSE                                                         14507013
145080        IF SU093-VNDR-DPT-RFID-TAGS-YES AND                       14508013
145090            SU093-DC-DEPT-TAGS-NO                                 14509013
145100*           Means no directive and no RFID on labels              14510013
145110            SET PS-DIRECTIVE-NO      TO TRUE                      14511013
145120            SET PS-RFID-ON-LABEL-NO  TO TRUE                      14512013
145130        ELSE                                                      14513013
145140            IF SU093-VNDR-DPT-RFID-TAGS-NO AND                    14514013
145150              SU093-DC-DEPT-TAGS-YES AND                          14515013
145160              SU093-RFID-KOHL-DPT-IN-STR-YES                      14516013
145170*             generate directive and yes TO RFID on labels        14517013
145180              SET PS-DIRECTIVE-YES     TO TRUE                    14518013
145190              SET PS-RFID-ON-LABEL-YES TO TRUE                    14519013
145200              IF PS-LOG-MESSAGE                                   14520013
145210                MOVE SPACE to PV-CICS-MSG-AREA-B                  14521013
145220                STRING ' get directive - '                        14522013
145230                    ' VNDR NO TG '                                14523013
145240                  ' ps-dir-sw = '                                 14524013
145250                   ps-directive-sw                                14525013
145260                  ' RF-ON-LBL-SW = '                              14526013
145270                    PS-RFID-ON-LABEL-SW                           14527013
145280                  ' SU093-CART-SW = '                             14528013
145290                   SU093-DC-USE-RFID-CART-LBL-SW                  14529013
145300                   DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B      14530013
145310                   PERFORM 9999-WRITE-TO-CSSL                     14531013
145320              END-IF                                              14532013
145330* 07/19/13 RLK BEG                                                14533013
145340              IF SU093-DC-USE-RFID-CART-LBL-YES                   14534013
145350              AND SU093-LABEL-PRINT-IND > SPACES                  14535061
145360                SET PS-DC-USE-RFID-CART-LBL-YES TO TRUE           14536013
145370              ELSE                                                14537013
145380                SET PS-DC-USE-RFID-CART-LBL-NO TO TRUE            14538013
145390              END-IF                                              14539013
145400* 07/19/13 RLK END                                                14540013
145410            ELSE                                                  14541013
145420              IF SU093-VNDR-DPT-RFID-TAGS-NO AND                  14542013
145430                 SU093-DC-DEPT-TAGS-NO                            14543013
145440*                NO DIRECTIVE AND NO RFID on labels               14544013
145450                 SET PS-DIRECTIVE-NO     TO TRUE                  14545042
145460                 SET PS-RFID-ON-LABEL-NO TO TRUE                  14546013
145470              ELSE                                                14547013
145480                  IF SU093-VNDR-DPT-RFID-TAGS-YES AND             14548013
145490                     SU093-DC-DEPT-TAGS-YES                       14549031
145500**07/31/17 gb        SU093-RFID-KOHL-DPT-IN-STR-YES               14550061
145510* 10/29/13 CLP BEG   NO DIRECTIVE AND NO RFID ON LABELS -         14551013
145520*                    CHANGE MADE WITH AUDIT CHANGES               14552013
145530                     SET PS-DIRECTIVE-NO     TO TRUE              14553013
145540                     SET PS-RFID-ON-LABEL-NO  TO TRUE             14554013
145550                     PERFORM 6025-CHECK-RFID-AUDITING-LVL         14555063
145560                     IF PS-RFID-DEPT-LEVEL-YES                    14556063
145570                         PERFORM 6028-RFID-AUDITING-DEPT          14557063
145580                         IF PS-RFID-AUDIT-YES                     14558063
145590                             PERFORM 6030-CHECK-FOR-RFID-AUDIT    14559031
145600                         END-IF                                   14560063
145610                     END-IF                                       14561063
145620**07/31/17 gb - END                                               14562061
145630* 10/29/13 CLP END                                                14563013
145640* 07/19/13 RLK BEG                                                14564013
145650                     IF PS-LOG-MESSAGE                            14565013
145660                       MOVE SPACE to PV-CICS-MSG-AREA-B           14566013
145670                       STRING ' NO dir AFT 6030- '                14567013
145680                       ' VND TAG '                                14568013
145690                       ' ps-dir-sw = '                            14569013
145700                        ps-directive-sw                           14570013
145710                       ' RF-ON-LBL-SW = '                         14571013
145720                       PS-RFID-ON-LABEL-SW                        14572013
145730                      ' SU093-CART-SW = '                         14573013
145740                       SU093-DC-USE-RFID-CART-LBL-SW              14574013
145750                       DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B  14575013
145760                       PERFORM 9999-WRITE-TO-CSSL                 14576013
145770                     END-IF                                       14577013
145780*CLP 10/29/13          WILL NEVER SET TO YES, BECAUSE VNDR TAG 'Y'14578046
145790                        SET PS-DC-USE-RFID-CART-LBL-NO  TO TRUE   14579046
145800**                   END-IF                                       14580061
145810* 07/19/13 RLK END                                                14581013
145820                  END-IF                                          14582013
145830              END-IF                                              14583013
145840            END-IF                                                14584013
145850        END-IF                                                    14585013
145860     END-IF.                                                      14586013
145870                                                                  14587038
145880*    ONLY CHECK THE AUTO CONVEYR IF ITS P2L (NOT SML)             14588013
145890     IF PS-CARTON-P2L-CREATED                                     14589013
145900         IF SU093-RFID-DC-AUTO-CONVEYR-NO or                      14590013
145910            SU093-LABEL-PRINT-IND = SPACES OR                     14591066
145920            SU093-DPT-STR-P2L-FIRST-YES                           14592013
145930              SET PS-DIRECTIVE-NO TO TRUE                         14593067
145940         END-IF                                                   14594013
145950     END-IF.                                                      14595013
145960                                                                  14596013
145970     IF SU093-PRINT-EAS OR SU093-PRINT-RFID-EAS                   14597061
145980        SET PS-RFID-ON-LABEL-YES TO TRUE                          14598061
145990        SET PS-DIRECTIVE-YES    TO TRUE                           14599061
146000        IF PS-CARTON-P2L-CREATED                                  14600038
146010           SET SU093-DPT-STR-P2L-FIRST-NO TO TRUE                 14601038
146020        END-IF                                                    14602038
146030        IF SU093-DC-USE-RFID-CART-LBL-YES                         14603061
146040          SET PS-DC-USE-RFID-CART-LBL-YES TO TRUE                 14604061
146050        END-IF                                                    14605061
146060     END-IF.                                                      14606061
146070                                                                  14607038
146080*CLP 04/08/14 -BEGIN                                              14608013
146090*    ADDED CHECK FOR IR FACILITY TAGGING                          14609013
146100     IF  PS-WHSE-OTBND-CART-YES                                   14610013
146110        IF SU093-IR-NEEDS-DC-TAGGING-NO AND                       14611013
146120           SU093-IR-CHK-IN-YES                                    14612013
146130*          Means no directive and no RFID on labels               14613013
146140           SET PS-DIRECTIVE-NO     TO TRUE                        14614013
146150           SET PS-RFID-ON-LABEL-NO TO TRUE                        14615013
146160               IF PS-LOG-MESSAGE                                  14616013
146170                   MOVE SPACE to PV-CICS-MSG-AREA-B               14617013
146180                   STRING ' IR TAG NO '                           14618013
146190                   PS-RFID-ON-LABEL-SW                            14619013
146200                ' ps-dir-sw = '                                   14620013
146210                  ps-directive-sw                                 14621013
146220                DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B         14622013
146230                PERFORM 9999-WRITE-TO-CSSL                        14623013
146240               END-IF                                             14624013
146250        END-IF                                                    14625013
146260        IF SU093-IR-NEEDS-DC-TAGGING-YES AND                      14626013
146270           SU093-IR-CHK-IN-YES                                    14627013
146280*CLP 04/25/14 START                                               14628013
146290*          Means YES GETS A DIRECTIVE                             14629013
146300           SET PS-DIRECTIVE-YES     TO TRUE                       14630013
146310*          (AUTO CONVEYOR DC)                                     14631013
146320           IF PS-AUTO-CONVEY-EXCPT-CRTNS                          14632013
146330*              DO NOT PRINT 'REPL RFID' LABEL FOR AUTO DC         14633013
146340               SET PS-RFID-ON-LABEL-NO TO TRUE                    14634013
146350               IF PS-LOG-MESSAGE                                  14635013
146360                   MOVE SPACE to PV-CICS-MSG-AREA-B               14636013
146370                   STRING ' autox '                               14637013
146380                   PS-RFID-ON-LABEL-SW                            14638013
146390                   ' ps-dir-sw = '                                14639013
146400                     ps-directive-sw                              14640013
146410                   ' conv = '                                     14641013
146420                   PS-AUTO-CONVEY-LVL-SW                          14642013
146430                   DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B      14643013
146440                   PERFORM 9999-WRITE-TO-CSSL                     14644013
146450               END-IF                                             14645013
146460           ELSE                                                   14646013
146470*              Means YES RFID on labels - THEY GET 'REPL RFID' LAB14647013
146480               SET PS-RFID-ON-LABEL-YES TO TRUE                   14648013
146490               IF PS-LOG-MESSAGE                                  14649013
146500                   MOVE SPACE to PV-CICS-MSG-AREA-B               14650013
146510                   STRING ' non autox '                           14651013
146520                   PS-RFID-ON-LABEL-SW                            14652013
146530                ' ps-dir-sw = '                                   14653013
146540                  ps-directive-sw                                 14654013
146550                ' conv = '                                        14655013
146560                PS-AUTO-CONVEY-LVL-SW                             14656013
146570                DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B         14657013
146580                PERFORM 9999-WRITE-TO-CSSL                        14658013
146590               END-IF                                             14659013
146600           END-IF                                                 14660013
146610*CLP 04/25/14 END                                                 14661013
146620        END-IF                                                    14662013
146630     END-IF.                                                      14663013
146640*CLP 04/08/14 -END                                                14664013
146650                                                                  14665013
146660**04/08/14************ dont use this flag anymore **************  14666013
146670*CLP 10/29/13 BEGIN                                               14667013
146680*    ADDED CHECK FOR IR FACILITY TAGGING                          14668013
146690     IF  PS-WHSE-OTBND-CART-YES                                   14669013
146700         IF SU093-IR-CHK-IN-NO                                    14670013
146710             SET PV-RFID-REPLEN-NO TO TRUE                        14671013
146720             IF PS-LOG-MESSAGE                                    14672013
146730                MOVE SPACE to PV-CICS-MSG-AREA-B                  14673013
146740                STRING ' SU093-IR-CHK-IN-NO '                     14674013
146750                       ' PV-RFID-REPLEN-NO '                      14675013
146760                DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B         14676013
146770                PERFORM 9999-WRITE-TO-CSSL                        14677013
146780             END-IF                                               14678013
146790         END-IF                                                   14679013
146800     END-IF.                                                      14680013
146810                                                                  14681013
146820     IF SU021-AUDIT-NUMBER IS NOT NUMERIC                         14682013
146830         MOVE 0 TO SU021-AUDIT-NUMBER                             14683013
146840     END-IF.                                                      14684013
146850     IF SU021-RFID-AUDIT-NUMBER IS NOT NUMERIC                    14685013
146860         MOVE 0 TO SU021-RFID-AUDIT-NUMBER                        14686013
146870     END-IF.                                                      14687013
146880                                                                  14688013
146890     IF SU021-AUDIT-NUMBER > 0                                    14689013
146900        IF SU021-RFID-AUDIT-NUMBER > 0                            14690013
146910*          COMBINED - QC AND RFID                                 14691013
146920*             ITS QC AND RFID AUDIT                               14692013
146930              SET PS-QC-AND-RFID-AUD TO TRUE                      14693013
146940          ELSE                                                    14694013
146950*             ONLY QC AUDIT                                       14695013
146960              SET PS-QC-AUD-ONLY TO TRUE                          14696013
146970      ELSE                                                        14697013
146980        IF SU021-RFID-AUDIT-NUMBER > 0                            14698013
146990*            ONLY RFID AUDIT                                      14699013
147000             SET PS-RFID-AUD-ONLY TO TRUE                         14700013
147010          END-IF                                                  14701013
147020      END-IF.                                                     14702013
147030                                                                  14703013
147040     IF PS-LOG-MESSAGE                                            14704013
147050         MOVE SPACE to PV-CICS-MSG-AREA-B                         14705013
147060        STRING ' AUDIT SW: 6020- '                                14706013
147070               ' RFID-QC COMB IND = '                             14707013
147080                PS-RFID-QC-AUD-CMB-IND                            14708013
147090                DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B         14709013
147100                PERFORM 9999-WRITE-TO-CSSL                        14710013
147110     END-IF.                                                      14711013
147120*CLP 10/29/13 END                                                 14712013
147130                                                                  14713013
147140     IF PS-LOG-MESSAGE                                            14714013
147150        STRING 'SUKCS782  6020- '                                 14715099
147160             ' RTN CODE = '                                       14716013
147170              SU093-RETURN-CODE                                   14717013
147180             ' RFID IND = '                                       14718013
147190             SU093-RFID-IND                                       14719013
147200             ' CART LBL = '                                       14720013
147210             SU093-DC-USE-RFID-CART-LBL-SW                        14721013
147220             ' DIRV-SW = '                                        14722013
147230             PS-DIRECTIVE-SW                                      14723013
147240             ' RF PRT = '                                         14724013
147250             PS-RFID-ON-LABEL-SW                                  14725013
147260             ' IR = '                                             14726013
147270             SU093-IR-CHK-IN-SW                                   14727013
147280             ' PV IR SW = '                                       14728013
147290              PV-RFID-REPLEN-CHK-SW                               14729013
147300            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B             14730013
147310            PERFORM 9999-WRITE-TO-CSSL                            14731013
147320     END-IF.                                                      14732013
147330                                                                  14733013
147340* CLP 06/20/13 PR5148B END                                        14734013
147350                                                                  14735013
147360*********************************************************         14736063
147370* CHECK AT THE DC LEVEL IF AN ADDITIONAL CHECK SHOULD             14737063
147380* BE MADE AT THE DEPARTMENT LEVEL FOR RFID AUDITING               14738063
147390*********************************************************         14739063
147400 6025-CHECK-RFID-AUDITING-LVL.                                    14740063
147410                                                                  14741063
147420     MOVE SU054-DC-NUMBER        TO KRPRPM-LOC-ID.                14742063
147430                                                                  14743063
147440     EXEC SQL                                                     14744063
147450          SELECT FUNC_END_TMST                                    14745063
147460          INTO  :KRPRPM-FUNC-END-TMST                             14746063
147470          FROM   TKRPRPM                                          14747063
147480          WHERE  SYS_PRC_FUNC_CDE  = 'AUDPMT'                     14748063
147490            AND  INTFC_SYS_CDE     = 'KHL'                        14749063
147500            AND  FUNC_PRC_STAT_CDE = 'AC'                         14750063
147510            AND  FUNC_TXT          = 'Y'                          14751063
147520            AND  LOC_ID            =  :KRPRPM-LOC-ID              14752063
147530     END-EXEC.                                                    14753063
147540                                                                  14754063
147550     EVALUATE TRUE                                                14755063
147560         WHEN SQLCODE = ZERO                                      14756063
147570             SET PS-RFID-DEPT-LEVEL-YES TO TRUE                   14757063
147580         WHEN SQLCODE = +100                                      14758063
147590             SET PS-RFID-DEPT-LEVEL-NO TO TRUE                    14759063
147600         WHEN SQLWARN0 NOT = SPACES                               14760063
147610         WHEN SQLCODE < ZERO                                      14761063
147620         WHEN SQLCODE > ZERO                                      14762063
147630             MOVE '6025-CHECK-RFID-AUDITING-LVL'                  14763063
147640                             TO DP013-PARAGRAPH                   14764063
147650             MOVE 'SUKCS782 - CHECK RFID AUDITING LVL'            14765099
147660                             TO DP013-MESSAGE-TEXT(1)             14766063
147670             MOVE SU054-DC-NUMBER                                 14767063
147680                             TO DP013-MESSAGE-TEXT(2)             14768063
147690             MOVE SQLCA      TO DP013-SQLCA                       14769063
147700             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           14770063
147710             SET DP013-DB2-ABEND                                  14771063
147720                             TO TRUE                              14772063
147730             SET DP013-ROLLBACK                                   14773063
147740                             TO TRUE                              14774063
147750             SET DP013-XCTL-DISPLAY-RESTART                       14775063
147760                             TO TRUE                              14776063
147770                                                                  14777063
147780     END-EVALUATE.                                                14778063
147790                                                                  14779063
147800*********************************************************         14780063
147810* CHECK AT THE DC DEPARMENT LEVEL IF THE AUDIT MODULE             14781063
147820* SHOULD BE CALLED                                                14782063
147830*********************************************************         14783063
147840 6028-RFID-AUDITING-DEPT.                                         14784063
147850                                                                  14785063
147860     MOVE SU054-DC-NUMBER        TO KRPRPM-LOC-ID.                14786063
147870     MOVE PV-DEPT-NUMBER         TO WST00010-ATTR-ELEM-NBR.       14787063
147880                                                                  14788063
147890     EXEC SQL                                                     14789063
147900       SELECT   E.ATTR_ELEM_TXT                                   14790063
147910        INTO   :PV-FUNC-TXT                                       14791063
147920        FROM                                                      14792063
147930              WST_INTGRTN_TYP  A                                  14793063
147940           ,  WST_ATTR_DEFN    B                                  14794063
147950           ,  WST_ATTR_ELEM    C                                  14795063
147960           ,  WST_ATTR_ELEM    D                                  14796063
147970           ,  WST_ATTR_ELEM    E                                  14797063
147980           ,  WST_ATTR_ELEM    F                                  14798063
147990           ,  WST_ATTR_ELEM    G                                  14799063
148000       WHERE                                                      14800063
148010             A.INTGRTN_TYP_CDE   = 'RFDAUDDPT'                    14801063
148020         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              14802063
148030         AND B.ATTR_DEFN_SEQ_NBR = 1                              14803063
148040         AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              14804063
148050         AND C.ATTR_DEFN_SEQ_NBR = 1                              14805063
148060         AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              14806063
148070         AND D.ATTR_DEFN_SEQ_NBR = 2                              14807063
148080         AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              14808063
148090         AND E.ATTR_DEFN_SEQ_NBR = 3                              14809063
148100         AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              14810063
148110         AND F.ATTR_DEFN_SEQ_NBR = 4                              14811063
148120         AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              14812063
148130         AND G.ATTR_DEFN_SEQ_NBR = 5                              14813063
148140         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            14814063
148150         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            14815063
148160         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            14816063
148170         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            14817063
148180         AND C.ATTR_ELEM_NBR     = :KRPRPM-LOC-ID                 14818063
148190         AND D.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR        14819063
148200         AND E.ATTR_ELEM_TXT     =  'Y'                           14820063
148210         AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP             14821063
148220         AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP             14822063
148230     END-EXEC.                                                    14823063
148240                                                                  14824063
148250     EVALUATE TRUE                                                14825063
148260         WHEN SQLCODE = ZERO                                      14826063
148270             SET PS-RFID-AUDIT-YES TO TRUE                        14827063
148280                                                                  14828063
148290         WHEN SQLCODE = +100                                      14829063
148300             SET PS-RFID-AUDIT-NO  TO TRUE                        14830063
148310                                                                  14831063
148320         WHEN SQLWARN0 NOT = SPACES                               14832063
148330         WHEN SQLCODE < ZERO                                      14833063
148340         WHEN SQLCODE > ZERO                                      14834063
148350             MOVE '6028-RFID-AUDITING-DEPT'                       14835063
148360                             TO DP013-PARAGRAPH                   14836063
148370             MOVE 'SUKCS782 - RFID AUDITING DEPT'                 14837099
148380                             TO DP013-MESSAGE-TEXT(1)             14838063
148390             MOVE SU054-DC-NUMBER                                 14839063
148400                             TO DP013-MESSAGE-TEXT(2)             14840063
148410             MOVE PV-DEPT-NUMBER                                  14841063
148420                             TO DP013-MESSAGE-TEXT(3)             14842063
148430             MOVE SQLCA      TO DP013-SQLCA                       14843063
148440             MOVE 'WST_INTGRTN_TYP'                               14844063
148450                             TO DP013-DB2-TABLE-NAME(1)           14845063
148460             MOVE 'WST_ATTR_DEFN'                                 14846063
148470                             TO DP013-DB2-TABLE-NAME(2)           14847063
148480             MOVE 'WST_ATTR_ELEM'                                 14848063
148490                             TO DP013-DB2-TABLE-NAME(3)           14849063
148500             SET DP013-DB2-ABEND                                  14850063
148510                             TO TRUE                              14851063
148520             SET DP013-ROLLBACK                                   14852063
148530                             TO TRUE                              14853063
148540             SET DP013-XCTL-DISPLAY-RESTART                       14854063
148550                             TO TRUE                              14855063
148560                                                                  14856063
148570     END-EVALUATE.                                                14857063
148580                                                                  14858031
148590*CLP 10/29/13 - BEGIN PR#5148D                                    14859013
148600*----------------------------------------------------------------*14860013
148610*  CALL TO RFID AUDIT MODULE TO CHECK CARTON AUDIT STATUS        *14861013
148620*----------------------------------------------------------------*14862013
148630 6030-CHECK-FOR-RFID-AUDIT.                                       14863013
148640*                                                                 14864013
148650** added internal table to track paragraph execution time         14865013
148660** dmh 2014-12-22 - begin                                         14866013
148670*                                                                 14867013
148680     MOVE  '6030'  TO  PT-CURR-PARA.                              14868013
148690     IF  PS-BLD-INTERNAL-TABLE-YES                                14869013
148700         PERFORM 0200-INTERNAL-TABLE                              14870013
148710     ELSE                                                         14871013
148720         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       14872013
148730     END-IF.                                                      14873013
148740                                                                  14874013
148750*                                                                 14875013
148760** DMH 2014-12-22 - END                                           14876013
148770*                                                                 14877013
148780                                                                  14878013
148790     INITIALIZE SU021-RFID-AUDIT-NUMBER.                          14879013
148800     SET  SU021-CARTON-CHECK-IN                                   14880013
148810*CLP 10/29/13 - START                                             14881013
148820          SU021-RFID-AUDIT-IS-COMPLETE  TO TRUE.                  14882013
148830*CLP 10/29/13 - END                                               14883013
148840     MOVE 'Y'          TO SU021-DEFERRED-AUDIT-IND.               14884013
148850                                                                  14885013
148860     MOVE PV-PO-NBR           TO SU021-PO-NUMBER                  14886013
148870     MOVE SHUUPC-TRN-LNE-NBR  TO SU021-LINE-NBR                   14887013
148880                                    RECITM-PREPK-ID               14888013
148890     MOVE +0              TO SU021-DRIVER-LINE-NBR                14889013
148900                             SU021-PRE-PACK-ID                    14890013
148910     MOVE PC-RF       TO SU021-PACKAGE-TYPE-CODE                  14891013
148920     MOVE SU054-DC-NUMBER     TO SU021-OPER-UNT-ID                14892013
148930     MOVE PV-RCVR-SEQ-NBR     TO SU021-REC-SEQ-NBR                14893013
148940     MOVE SU054-TRIP-ID       TO SU021-INBOUND-TRIP-ID            14894013
148950     MOVE PV-CTN-N            TO SU021-SHIPT-UNT-ID               14895013
148960     MOVE SU054-USER-ID       TO SU021-USER-ID.                   14896013
148970     SET  SU021-PRINT-APPLY   TO TRUE.                            14897013
148980     PERFORM 7265-LINK-SUKCS720.                                  14898013
148990*CLP 10/29/13 - END   PR#5148D                                    14899013
149000                                                                  14900013
149010     IF PS-LOG-MESSAGE                                            14901013
149020        STRING 'SUKCS782  6030- '                                 14902099
149030             ' SU021-rfid-AUD = '                                 14903013
149040              SU021-RFID-AUDIT-NUMBER                             14904013
149050             ' SU021-PRINT-APPLY= '                               14905013
149060              SU021-PRINT-APPLY-SW                                14906013
149070            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B             14907013
149080            PERFORM 9999-WRITE-TO-CSSL                            14908013
149090     END-IF.                                                      14909013
149100                                                                  14910013
149110                                                                  14911013
149120*----------------------------------------------------------------*14912013
149130* GET RLSE IND TO DETERMINE DIRV REASON CODE                      14913013
149140*                                                                *14914013
149150*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *14915013
149160*----------------------------------------------------------------*14916013
149170 6200-GET-FRC-DIVERT-CDE.                                         14917013
149180*                                                                 14918013
149190** added internal table to track paragraph execution time         14919013
149200** dmh 2014-12-22 - begin                                         14920013
149210*                                                                 14921013
149220     MOVE  '6200'  TO  PT-CURR-PARA.                              14922013
149230     IF  PS-BLD-INTERNAL-TABLE-YES                                14923013
149240         PERFORM 0200-INTERNAL-TABLE                              14924013
149250     ELSE                                                         14925013
149260         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       14926013
149270     END-IF.                                                      14927013
149280                                                                  14928013
149290*                                                                 14929013
149300** DMH 2014-12-22 - END                                           14930013
149310*                                                                 14931013
149320                                                                  14932013
149330     EXEC SQL                                                     14933013
149340        SELECT                                                    14934013
149350            FRC_DIVERT_CDE                                        14935013
149360        INTO                                                      14936013
149370            :SUT00108-FRC-DIVERT-CDE                              14937013
149380        FROM                                                      14938013
149390            SUT_PNA_STA_DIVERT                                    14939013
149400        WHERE OPER_UNT_ID     = :DK-OPER-UNT-ID                   14940013
149410          AND ACM_LBL_STA_NBR = :SUT00107-ACM-LBL-STA-NBR         14941013
149420          AND DIRV_RSN_CDE    = :SU090-DIRV-RSN-CDE               14942013
149430         WITH UR                                                  14943013
149440     END-EXEC.                                                    14944013
149450                                                                  14945013
149460                                                                  14946013
149470         EVALUATE TRUE                                            14947013
149480             WHEN SQLCODE = ZERO                                  14948013
149490                 SET PS-SET-NEW-FRCED-DIVERT-YES TO TRUE          14949013
149500             WHEN SQLCODE = +100                                  14950013
149510                 SET PS-SET-NEW-FRCED-DIVERT-NO  TO TRUE          14951013
149520             WHEN SQLWARN0 NOT = SPACES                           14952013
149530             WHEN SQLCODE NOT EQUAL ZERO                          14953013
149540                                                                  14954013
149550              INITIALIZE PV-CICS-MSG-AREA1                        14955013
149560              INITIALIZE PV-CICS-MSG-AREA2                        14956013
149570                                                                  14957013
149580              MOVE SQLCODE              TO PV-DISP-SQLCODE        14958013
149590              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             14959013
149600              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           14960013
149610              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        14961013
149620                                                                  14962013
149630              STRING  'SUKCS782 6200-'                            14963099
149640                      ' DC:'               PV-DISP-DC             14964013
149650                      ' B1:'               SU054-BAR-CODE-1       14965013
149660                      ' B2:'               SU054-BAR-CODE-2       14966013
149670                      ' B3:'               SU054-BAR-CODE-3       14967013
149680                                           DELIMITED BY SIZE      14968013
149690                                      INTO PV-CICS-MSG-AREA1      14969013
149700                                                                  14970013
149710              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14971013
149720              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     14972013
149730                                                                  14973013
149740              PERFORM 9999-WRITE-TO-CSSL                          14974013
149750                                                                  14975013
149760              STRING  'SUKCS782 '          SU054-KOHLS-SML        14976099
149770                      ' TRIP:'             PV-DISP-TRIP           14977013
149780                      ' DR:'               SU054-DOOR-NUMBER      14978013
149790                      ' USR:'              SU054-USER-ID          14979013
149800                      ' STA:'              PV-DISP-PNA-STA        14980013
149810                      ' SQL:'              PV-DISP-SQLCODE        14981013
149820                      ' SUT_PNA_STA_DIVERT'                       14982013
149830                                           DELIMITED BY SIZE      14983013
149840                                      INTO PV-CICS-MSG-AREA2      14984013
149850                                                                  14985013
149860              MOVE SPACES               TO PV-CICS-MSG-AREA-A     14986013
149870              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     14987013
149880                                                                  14988013
149890              PERFORM 9999-WRITE-TO-CSSL                          14989013
149900                                                                  14990013
149910              INITIALIZE PV-CICS-MSG-AREA3                        14991013
149920              MOVE  DK-OPER-UNT-ID            TO PV-DISP-OPER     14992013
149930              MOVE  SUT00107-ACM-LBL-STA-NBR  TO PV-DISP-PNA-STA  14993013
149940                                                                  14994013
149950              STRING  'SUKCS782 '                                 14995099
149960                      ' OPER:'             PV-DISP-OPER           14996013
149970                      ' STA:'              PV-DISP-PNA-STA        14997013
149980                      ' DIRV RSN CDE:'     SU090-DIRV-RSN-CDE     14998013
149990                                           DELIMITED BY SIZE      14999013
150000                                      INTO PV-CICS-MSG-AREA3      15000013
150010                                                                  15001013
150020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15002013
150030              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15003013
150040                                                                  15004013
150050              PERFORM 9999-WRITE-TO-CSSL                          15005013
150060                                                                  15006013
150070                 SET PS-PROCESSING-ERROR-YES TO TRUE              15007013
150080                 PERFORM 9998-WRITE-TO-CSSL                       15008013
150090         END-EVALUATE.                                            15009013
150100                                                                  15010013
150110*CT 11/04/08 END                                                  15011013
150120                                                                  15012013
150130 6400-DETERMINE-HANG-FOLD.                                        15013013
150140*                                                                 15014013
150150** added internal table to track paragraph execution time         15015013
150160** dmh 2014-12-22 - begin                                         15016013
150170*                                                                 15017013
150180     MOVE  '6400'  TO  PT-CURR-PARA.                              15018013
150190     IF  PS-BLD-INTERNAL-TABLE-YES                                15019013
150200         PERFORM 0200-INTERNAL-TABLE                              15020013
150210     ELSE                                                         15021013
150220         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15022013
150230     END-IF.                                                      15023013
150240                                                                  15024013
150250*                                                                 15025013
150260** DMH 2014-12-22 - END                                           15026013
150270*                                                                 15027013
150280      INITIALIZE PV-HNG-FOLD-SEQ-NBR                              15028013
150290                 PV-PREV-HANG-FOLD-IND                            15029013
150300                 PV-HANG-FOLD-IND.                                15030013
150310      MOVE  PV-CTN-N       TO  DK-CTN.                            15031013
150320      SET PS-NOT-EO-HANG-FOLD-CSR                                 15032013
150330          PS-NOT-HANG-FOLD-MIXED                                  15033013
150340          PS-FIRST-UPC-CALL    TO TRUE                            15034013
150350                                                                  15035013
150360      PERFORM 6450-OPEN-HANG-FOLD-CSR                             15036013
150370      PERFORM 6500-FETCH-HANG-FOLD-CSR                            15037013
150380        UNTIL PS-EO-HANG-FOLD-CSR OR                              15038013
150390              PS-HANG-FOLD-MIXED                                  15039013
150400      PERFORM 6550-CLOSE-HANG-FOLD-CSR.                           15040013
150410                                                                  15041013
150420******************************************************************15042013
150430 6450-OPEN-HANG-FOLD-CSR.                                         15043013
150440*                                                                 15044013
150450** added internal table to track paragraph execution time         15045013
150460** dmh 2014-12-22 - begin                                         15046013
150470*                                                                 15047013
150480     MOVE  '6450'  TO  PT-CURR-PARA.                              15048013
150490     IF  PS-BLD-INTERNAL-TABLE-YES                                15049013
150500         PERFORM 0200-INTERNAL-TABLE                              15050013
150510     ELSE                                                         15051013
150520         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15052013
150530     END-IF.                                                      15053013
150540                                                                  15054013
150550*                                                                 15055013
150560** DMH 2014-12-22 - END                                           15056013
150570*                                                                 15057013
150580                                                                  15058013
150590         EXEC SQL                                                 15059013
150600              OPEN HANG_FOLD_CSR                                  15060013
150610         END-EXEC                                                 15061013
150620                                                                  15062013
150630                                                                  15063013
150640         EVALUATE TRUE                                            15064013
150650             WHEN SQLCODE = ZERO                                  15065013
150660                 CONTINUE                                         15066013
150670             WHEN SQLWARN0 NOT = SPACES                           15067013
150680             WHEN SQLCODE < ZERO                                  15068013
150690             WHEN SQLCODE > ZERO                                  15069013
150700                                                                  15070013
150710              INITIALIZE PV-CICS-MSG-AREA1                        15071013
150720              INITIALIZE PV-CICS-MSG-AREA2                        15072013
150730                                                                  15073013
150740              MOVE SQLCODE              TO PV-DISP-SQLCODE        15074013
150750              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15075013
150760              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15076013
150770              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15077013
150780                                                                  15078013
150790              STRING  'SUKCS782 6450-'                            15079099
150800                      ' DC:'               PV-DISP-DC             15080013
150810                      ' B1:'               SU054-BAR-CODE-1       15081013
150820                      ' B2:'               SU054-BAR-CODE-2       15082013
150830                      ' B3:'               SU054-BAR-CODE-3       15083013
150840                                           DELIMITED BY SIZE      15084013
150850                                      INTO PV-CICS-MSG-AREA1      15085013
150860                                                                  15086013
150870              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15087013
150880              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15088013
150890                                                                  15089013
150900              PERFORM 9999-WRITE-TO-CSSL                          15090013
150910                                                                  15091013
150920              STRING  'SUKCS782 '          SU054-KOHLS-SML        15092099
150930                      ' TRIP:'             PV-DISP-TRIP           15093013
150940                      ' DR:'               SU054-DOOR-NUMBER      15094013
150950                      ' USR:'              SU054-USER-ID          15095013
150960                      ' STA:'              PV-DISP-PNA-STA        15096013
150970                      ' SQL:'              PV-DISP-SQLCODE        15097013
150980                      ' OPEN HANG_FOLD_CSR - TSHUUPC'             15098013
150990                                           DELIMITED BY SIZE      15099013
151000                                      INTO PV-CICS-MSG-AREA2      15100013
151010                                                                  15101013
151020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15102013
151030              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15103013
151040                                                                  15104013
151050              PERFORM 9999-WRITE-TO-CSSL                          15105013
151060                                                                  15106013
151070              INITIALIZE PV-CICS-MSG-AREA3                        15107013
151080              MOVE  DK-CTN                    TO PV-DISP-sscc     15108013
151090                                                                  15109013
151100              STRING  'SUKCS782 '                                 15110099
151110                      ' SSCC:'         PV-DISP-SSCC               15111013
151120                                           DELIMITED BY SIZE      15112013
151130                                      INTO PV-CICS-MSG-AREA3      15113013
151140                                                                  15114013
151150              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15115013
151160              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15116013
151170                                                                  15117013
151180              PERFORM 9999-WRITE-TO-CSSL                          15118013
151190                                                                  15119013
151200                 SET PS-PROCESSING-ERROR-YES TO TRUE              15120013
151210                 PERFORM 9998-WRITE-TO-CSSL                       15121013
151220         END-EVALUATE.                                            15122013
151230                                                                  15123013
151240 EJECT                                                            15124013
151250*----------------------------------------------------------------*15125013
151260*                                                                *15126013
151270*----------------------------------------------------------------*15127013
151280 6500-FETCH-HANG-FOLD-CSR.                                        15128013
151290*                                                                 15129013
151300** added internal table to track paragraph execution time         15130013
151310** dmh 2014-12-22 - begin                                         15131013
151320*                                                                 15132013
151330     MOVE  '6500'  TO  PT-CURR-PARA.                              15133013
151340     IF  PS-BLD-INTERNAL-TABLE-YES                                15134013
151350         PERFORM 0200-INTERNAL-TABLE                              15135013
151360     ELSE                                                         15136013
151370         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15137013
151380     END-IF.                                                      15138013
151390                                                                  15139013
151400*                                                                 15140013
151410** DMH 2014-12-22 - END                                           15141013
151420*                                                                 15142013
151430                                                                  15143013
151440                                                                  15144013
151450     EXEC SQL                                                     15145013
151460        FETCH   HANG_FOLD_CSR                                     15146013
151470        INTO   :SHUUPC-UPC-NBR                                    15147013
151480             , :SHUUPC-TRN-LNE-NBR                                15148013
151490     END-EXEC.                                                    15149013
151500                                                                  15150013
151510     EVALUATE TRUE                                                15151013
151520       WHEN SQLCODE = ZEROS                                       15152013
151530            PERFORM 7245-CALL-XLKUT-DOMAIN-BY-UPC                 15153013
151540            IF XL001-UPC-NOT-FOUND                                15154013
151550               CONTINUE                                           15155013
151560            ELSE                                                  15156013
151570               IF PS-EAS-TAG-IND-FOUND-NO                         15157013
151580                  MOVE SHUUPC-TRN-LNE-NBR TO PURITM-PO-LNE-NBR    15158013
151590                  PERFORM 7225-SELECT-TPURITM                     15159013
151600                  PERFORM 7233-CHECK-EAS-TAG                      15160013
151610               END-IF                                             15161013
151620                                                                  15162013
151630               IF PS-HANG-FOLD-IND-FOUND-NO                       15163013
151640                  EVALUATE TRUE                                   15164013
151650                    WHEN PV-HANG-FOLD-IND = 'H'                   15165013
151660                       MOVE 1 TO  PV-HNG-FOLD-SEQ-NBR             15166013
151670                       SET PS-HANG-FOLD-IND-FOUND-YES TO TRUE     15167013
151680                    WHEN PV-HANG-FOLD-IND = 'F'                   15168013
151690                       MOVE 2 TO  PV-HNG-FOLD-SEQ-NBR             15169013
151700                       SET PS-HANG-FOLD-IND-FOUND-YES TO TRUE     15170013
151710                    WHEN OTHER                                    15171013
151720                       MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR             15172013
151730                  END-EVALUATE                                    15173013
151740               END-IF                                             15174013
151750                                                                  15175013
151760*CLP 06/24/2015 START                                             15176013
151770               IF PS-BRAND-FOUND-NO                               15177013
151780                  PERFORM 7236-CHECK-BRAND                        15178013
151790               END-IF                                             15179013
151800                                                                  15180013
151810               IF PS-EAS-TAG-IND-FOUND-YES AND                    15181013
151820                  PS-HANG-FOLD-IND-FOUND-YES AND                  15182013
151830                  PS-BRAND-FOUND-YES                              15183013
151840*CLP 06/24/2015 END                                               15184013
151850                     SET PS-EO-HANG-FOLD-CSR TO TRUE              15185013
151860               END-IF                                             15186013
151870            END-IF                                                15187013
151880       WHEN SQLCODE = +100                                        15188013
151890                SET  PS-EO-HANG-FOLD-CSR TO TRUE                  15189013
151900       WHEN OTHER                                                 15190013
151910                                                                  15191013
151920              INITIALIZE PV-CICS-MSG-AREA1                        15192013
151930              INITIALIZE PV-CICS-MSG-AREA2                        15193013
151940                                                                  15194013
151950              MOVE SQLCODE              TO PV-DISP-SQLCODE        15195013
151960              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15196013
151970              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15197013
151980              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15198013
151990                                                                  15199013
152000              STRING  'SUKCS782 6500-'                            15200099
152010                      ' DC:'               PV-DISP-DC             15201013
152020                      ' B1:'               SU054-BAR-CODE-1       15202013
152030                      ' B2:'               SU054-BAR-CODE-2       15203013
152040                      ' B3:'               SU054-BAR-CODE-3       15204013
152050                                           DELIMITED BY SIZE      15205013
152060                                      INTO PV-CICS-MSG-AREA1      15206013
152070                                                                  15207013
152080              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15208013
152090              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15209013
152100                                                                  15210013
152110              PERFORM 9999-WRITE-TO-CSSL                          15211013
152120                                                                  15212013
152130              STRING  'SUKCS782 '          SU054-KOHLS-SML        15213099
152140                      ' TRIP:'             PV-DISP-TRIP           15214013
152150                      ' DR:'               SU054-DOOR-NUMBER      15215013
152160                      ' USR:'              SU054-USER-ID          15216013
152170                      ' STA:'              PV-DISP-PNA-STA        15217013
152180                      ' SQL:'              PV-DISP-SQLCODE        15218013
152190                      ' FETCH HANG_FOLD_CSR - TSHUUPC'            15219013
152200                                           DELIMITED BY SIZE      15220013
152210                                      INTO PV-CICS-MSG-AREA2      15221013
152220                                                                  15222013
152230              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15223013
152240              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15224013
152250                                                                  15225013
152260              PERFORM 9999-WRITE-TO-CSSL                          15226013
152270                                                                  15227013
152280              INITIALIZE PV-CICS-MSG-AREA3                        15228013
152290              MOVE  DK-CTN                    TO PV-DISP-sscc     15229013
152300                                                                  15230013
152310              STRING  'SUKCS782 '                                 15231099
152320                      ' SSCC:'         PV-DISP-SSCC               15232013
152330                                           DELIMITED BY SIZE      15233013
152340                                      INTO PV-CICS-MSG-AREA3      15234013
152350                                                                  15235013
152360              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15236013
152370              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15237013
152380                                                                  15238013
152390              PERFORM 9999-WRITE-TO-CSSL                          15239013
152400                                                                  15240013
152410             SET PS-PROCESSING-ERROR-YES TO TRUE                  15241013
152420             PERFORM 9998-WRITE-TO-CSSL                           15242013
152430     END-EVALUATE.                                                15243013
152440                                                                  15244013
152450 6550-CLOSE-HANG-FOLD-CSR.                                        15245013
152460*                                                                 15246013
152470** added internal table to track paragraph execution time         15247013
152480** dmh 2014-12-22 - begin                                         15248013
152490*                                                                 15249013
152500     MOVE  '6550'  TO  PT-CURR-PARA.                              15250013
152510     IF  PS-BLD-INTERNAL-TABLE-YES                                15251013
152520         PERFORM 0200-INTERNAL-TABLE                              15252013
152530     ELSE                                                         15253013
152540         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15254013
152550     END-IF.                                                      15255013
152560                                                                  15256013
152570*                                                                 15257013
152580** DMH 2014-12-22 - END                                           15258013
152590*                                                                 15259013
152600                                                                  15260013
152610         EXEC SQL                                                 15261013
152620             CLOSE HANG_FOLD_CSR                                  15262013
152630         END-EXEC                                                 15263013
152640                                                                  15264013
152650                                                                  15265013
152660         EVALUATE TRUE                                            15266013
152670             WHEN SQLCODE = ZERO                                  15267013
152680                 CONTINUE                                         15268013
152690             WHEN SQLWARN0 NOT = SPACES                           15269013
152700             WHEN SQLCODE < ZERO                                  15270013
152710             WHEN SQLCODE > ZERO                                  15271013
152720                                                                  15272013
152730              INITIALIZE PV-CICS-MSG-AREA1                        15273013
152740              INITIALIZE PV-CICS-MSG-AREA2                        15274013
152750                                                                  15275013
152760              MOVE SQLCODE              TO PV-DISP-SQLCODE        15276013
152770              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15277013
152780              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15278013
152790              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15279013
152800                                                                  15280013
152810              STRING  'SUKCS782 6550-'                            15281099
152820                      ' DC:'               PV-DISP-DC             15282013
152830                      ' B1:'               SU054-BAR-CODE-1       15283013
152840                      ' B2:'               SU054-BAR-CODE-2       15284013
152850                      ' B3:'               SU054-BAR-CODE-3       15285013
152860                                           DELIMITED BY SIZE      15286013
152870                                      INTO PV-CICS-MSG-AREA1      15287013
152880                                                                  15288013
152890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15289013
152900              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15290013
152910                                                                  15291013
152920              PERFORM 9999-WRITE-TO-CSSL                          15292013
152930                                                                  15293013
152940              STRING  'SUKCS782 '          SU054-KOHLS-SML        15294099
152950                      ' TRIP:'             PV-DISP-TRIP           15295013
152960                      ' DR:'               SU054-DOOR-NUMBER      15296013
152970                      ' USR:'              SU054-USER-ID          15297013
152980                      ' STA:'              PV-DISP-PNA-STA        15298013
152990                      ' SQL:'              PV-DISP-SQLCODE        15299013
153000                      ' CLOSE HANG_FOLD_CSR - TSHUUPC'            15300013
153010                                           DELIMITED BY SIZE      15301013
153020                                      INTO PV-CICS-MSG-AREA2      15302013
153030                                                                  15303013
153040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15304013
153050              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15305013
153060                                                                  15306013
153070              PERFORM 9999-WRITE-TO-CSSL                          15307013
153080                                                                  15308013
153090              INITIALIZE PV-CICS-MSG-AREA3                        15309013
153100              MOVE  DK-CTN                    TO PV-DISP-sscc     15310013
153110                                                                  15311013
153120              STRING  'SUKCS782 '                                 15312099
153130                      ' SSCC:'         PV-DISP-SSCC               15313013
153140                                           DELIMITED BY SIZE      15314013
153150                                      INTO PV-CICS-MSG-AREA3      15315013
153160                                                                  15316013
153170              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15317013
153180              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15318013
153190                                                                  15319013
153200              PERFORM 9999-WRITE-TO-CSSL                          15320013
153210                                                                  15321013
153220                 SET PS-PROCESSING-ERROR-YES TO TRUE              15322013
153230                 PERFORM 9998-WRITE-TO-CSSL                       15323013
153240         END-EVALUATE.                                            15324013
153250                                                                  15325013
153260                                                                  15326013
153270 EJECT                                                            15327013
153280                                                                  15328013
153290 6560-DETERMINE-WEIGHTS-MSRS.                                     15329013
153300*                                                                 15330013
153310** added internal table to track paragraph execution time         15331013
153320** dmh 2014-12-22 - begin                                         15332013
153330*                                                                 15333013
153340     MOVE  '6560'  TO  PT-CURR-PARA.                              15334013
153350     IF  PS-BLD-INTERNAL-TABLE-YES                                15335013
153360         PERFORM 0200-INTERNAL-TABLE                              15336013
153370     ELSE                                                         15337013
153380         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15338013
153390     END-IF.                                                      15339013
153400                                                                  15340013
153410*                                                                 15341013
153420** DMH 2014-12-22 - END                                           15342013
153430*                                                                 15343013
153440                                                                  15344013
153450      SET PS-NOT-EO-WEIGHTS-MSRS-CSR                              15345013
153460          PS-WEIGHTS-MEAUSURES-CHECK-NO TO TRUE                   15346013
153470                                                                  15347013
153480      PERFORM 6570-OPEN-WEIGHTS-MSRS-CSR                          15348013
153490      PERFORM 6580-FETCH-WEIGHTS-MSRS-CSR                         15349013
153500        UNTIL PS-EO-WEIGHTS-MSRS-CSR OR                           15350013
153510              PS-WEIGHTS-MEAUSURES-CHECK.                         15351013
153520      PERFORM 6590-CLOSE-WEIGHTS-MSRS-CSR.                        15352013
153530                                                                  15353013
153540******************************************************************15354013
153550 6570-OPEN-WEIGHTS-MSRS-CSR.                                      15355013
153560*                                                                 15356013
153570** added internal table to track paragraph execution time         15357013
153580** dmh 2014-12-22 - begin                                         15358013
153590*                                                                 15359013
153600     MOVE  '6570'  TO  PT-CURR-PARA.                              15360013
153610     IF  PS-BLD-INTERNAL-TABLE-YES                                15361013
153620         PERFORM 0200-INTERNAL-TABLE                              15362013
153630     ELSE                                                         15363013
153640         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15364013
153650     END-IF.                                                      15365013
153660                                                                  15366013
153670*                                                                 15367013
153680** DMH 2014-12-22 - END                                           15368013
153690*                                                                 15369013
153700                                                                  15370013
153710         EXEC SQL                                                 15371013
153720              OPEN WGHTS_MSRS_CSR                                 15372013
153730         END-EXEC                                                 15373013
153740                                                                  15374013
153750                                                                  15375013
153760         EVALUATE TRUE                                            15376013
153770             WHEN SQLCODE = ZERO                                  15377013
153780                 CONTINUE                                         15378013
153790             WHEN SQLWARN0 NOT = SPACES                           15379013
153800             WHEN SQLCODE < ZERO                                  15380013
153810             WHEN SQLCODE > ZERO                                  15381013
153820                                                                  15382013
153830              INITIALIZE PV-CICS-MSG-AREA1                        15383013
153840              INITIALIZE PV-CICS-MSG-AREA2                        15384013
153850                                                                  15385013
153860              MOVE SQLCODE              TO PV-DISP-SQLCODE        15386013
153870              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15387013
153880              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15388013
153890              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15389013
153900                                                                  15390013
153910              STRING  'SUKCS782 6570-'                            15391099
153920                      ' DC:'               PV-DISP-DC             15392013
153930                      ' B1:'               SU054-BAR-CODE-1       15393013
153940                      ' B2:'               SU054-BAR-CODE-2       15394013
153950                      ' B3:'               SU054-BAR-CODE-3       15395013
153960                                           DELIMITED BY SIZE      15396013
153970                                      INTO PV-CICS-MSG-AREA1      15397013
153980                                                                  15398013
153990              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15399013
154000              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15400013
154010                                                                  15401013
154020              PERFORM 9999-WRITE-TO-CSSL                          15402013
154030                                                                  15403013
154040              STRING  'SUKCS782 '          SU054-KOHLS-SML        15404099
154050                      ' TRIP:'             PV-DISP-TRIP           15405013
154060                      ' DR:'               SU054-DOOR-NUMBER      15406013
154070                      ' USR:'              SU054-USER-ID          15407013
154080                      ' STA:'              PV-DISP-PNA-STA        15408013
154090                      ' SQL:'              PV-DISP-SQLCODE        15409013
154100                      ' OPEN WGHTS_MSRS_CSR - TSHUUPC'            15410013
154110                                           DELIMITED BY SIZE      15411013
154120                                      INTO PV-CICS-MSG-AREA2      15412013
154130                                                                  15413013
154140              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15414013
154150              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15415013
154160                                                                  15416013
154170              PERFORM 9999-WRITE-TO-CSSL                          15417013
154180                                                                  15418013
154190              INITIALIZE PV-CICS-MSG-AREA3                        15419013
154200              MOVE  DK-CTN                    TO PV-DISP-sscc     15420013
154210                                                                  15421013
154220              STRING  'SUKCS782 '                                 15422099
154230                      ' SSCC:'         PV-DISP-SSCC               15423013
154240                                           DELIMITED BY SIZE      15424013
154250                                      INTO PV-CICS-MSG-AREA3      15425013
154260                                                                  15426013
154270              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15427013
154280              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15428013
154290                                                                  15429013
154300              PERFORM 9999-WRITE-TO-CSSL                          15430013
154310                                                                  15431013
154320                 SET PS-PROCESSING-ERROR-YES TO TRUE              15432013
154330                 PERFORM 9998-WRITE-TO-CSSL                       15433013
154340         END-EVALUATE.                                            15434013
154350                                                                  15435013
154360 EJECT                                                            15436013
154370*----------------------------------------------------------------*15437013
154380*                                                                *15438013
154390*----------------------------------------------------------------*15439013
154400 6580-FETCH-WEIGHTS-MSRS-CSR.                                     15440013
154410*                                                                 15441013
154420** added internal table to track paragraph execution time         15442013
154430** dmh 2014-12-22 - begin                                         15443013
154440*                                                                 15444013
154450     MOVE  '6580'  TO  PT-CURR-PARA.                              15445013
154460     IF  PS-BLD-INTERNAL-TABLE-YES                                15446013
154470         PERFORM 0200-INTERNAL-TABLE                              15447013
154480     ELSE                                                         15448013
154490         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15449013
154500     END-IF.                                                      15450013
154510                                                                  15451013
154520*                                                                 15452013
154530** DMH 2014-12-22 - END                                           15453013
154540*                                                                 15454013
154550                                                                  15455013
154560                                                                  15456013
154570     EXEC SQL                                                     15457013
154580        FETCH   WGHTS_MSRS_CSR                                    15458013
154590        INTO   :SHUUPC-UPC-NBR                                    15459013
154600     END-EXEC.                                                    15460013
154610                                                                  15461013
154620     EVALUATE TRUE                                                15462013
154630       WHEN SQLCODE = ZEROS                                       15463013
154640            PERFORM 7245-CALL-XLKUT-DOMAIN-BY-UPC                 15464013
154650            IF XL001-SHIP-WD-QTY = 0 OR                           15465013
154660               XL001-SHIP-DPTH-QTY = 0 OR                         15466013
154670               XL001-SHIP-HT-QTY = 0 OR                           15467013
154680               XL001-SHIP-WT-QTY = 0                              15468013
154690                    SET PS-WEIGHTS-MEAUSURES-CHECK TO TRUE        15469013
154700            END-IF                                                15470013
154710       WHEN SQLCODE = +100                                        15471013
154720                SET  PS-EO-WEIGHTS-MSRS-CSR TO TRUE               15472013
154730       WHEN OTHER                                                 15473013
154740                                                                  15474013
154750              INITIALIZE PV-CICS-MSG-AREA1                        15475013
154760              INITIALIZE PV-CICS-MSG-AREA2                        15476013
154770                                                                  15477013
154780              MOVE SQLCODE              TO PV-DISP-SQLCODE        15478013
154790              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15479013
154800              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15480013
154810              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15481013
154820                                                                  15482013
154830              STRING  'SUKCS782 6580-'                            15483099
154840                      ' DC:'               PV-DISP-DC             15484013
154850                      ' B1:'               SU054-BAR-CODE-1       15485013
154860                      ' B2:'               SU054-BAR-CODE-2       15486013
154870                      ' B3:'               SU054-BAR-CODE-3       15487013
154880                                           DELIMITED BY SIZE      15488013
154890                                      INTO PV-CICS-MSG-AREA1      15489013
154900                                                                  15490013
154910              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15491013
154920              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15492013
154930                                                                  15493013
154940              PERFORM 9999-WRITE-TO-CSSL                          15494013
154950                                                                  15495013
154960              STRING  'SUKCS782 '          SU054-KOHLS-SML        15496099
154970                      ' TRIP:'             PV-DISP-TRIP           15497013
154980                      ' DR:'               SU054-DOOR-NUMBER      15498013
154990                      ' USR:'              SU054-USER-ID          15499013
155000                      ' STA:'              PV-DISP-PNA-STA        15500013
155010                      ' SQL:'              PV-DISP-SQLCODE        15501013
155020                      ' FETCH WGHTS_MSRS_CSR - TSHUUPC'           15502013
155030                                           DELIMITED BY SIZE      15503013
155040                                      INTO PV-CICS-MSG-AREA2      15504013
155050                                                                  15505013
155060              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15506013
155070              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15507013
155080                                                                  15508013
155090              PERFORM 9999-WRITE-TO-CSSL                          15509013
155100                                                                  15510013
155110              INITIALIZE PV-CICS-MSG-AREA3                        15511013
155120              MOVE  DK-CTN                    TO PV-DISP-sscc     15512013
155130                                                                  15513013
155140              STRING  'SUKCS782 '                                 15514099
155150                      ' SSCC:'         PV-DISP-SSCC               15515013
155160                                           DELIMITED BY SIZE      15516013
155170                                      INTO PV-CICS-MSG-AREA3      15517013
155180                                                                  15518013
155190              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15519013
155200              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15520013
155210                                                                  15521013
155220              PERFORM 9999-WRITE-TO-CSSL                          15522013
155230                                                                  15523013
155240             SET PS-PROCESSING-ERROR-YES TO TRUE                  15524013
155250             PERFORM 9998-WRITE-TO-CSSL                           15525013
155260     END-EVALUATE.                                                15526013
155270                                                                  15527013
155280 6590-CLOSE-WEIGHTS-MSRS-CSR.                                     15528013
155290*                                                                 15529013
155300** added internal table to track paragraph execution time         15530013
155310** dmh 2014-12-22 - begin                                         15531013
155320*                                                                 15532013
155330     MOVE  '6590'  TO  PT-CURR-PARA.                              15533013
155340     IF  PS-BLD-INTERNAL-TABLE-YES                                15534013
155350         PERFORM 0200-INTERNAL-TABLE                              15535013
155360     ELSE                                                         15536013
155370         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15537013
155380     END-IF.                                                      15538013
155390                                                                  15539013
155400*                                                                 15540013
155410** DMH 2014-12-22 - END                                           15541013
155420*                                                                 15542013
155430                                                                  15543013
155440         EXEC SQL                                                 15544013
155450             CLOSE WGHTS_MSRS_CSR                                 15545013
155460         END-EXEC                                                 15546013
155470                                                                  15547013
155480                                                                  15548013
155490         EVALUATE TRUE                                            15549013
155500             WHEN SQLCODE = ZERO                                  15550013
155510                 CONTINUE                                         15551013
155520             WHEN SQLWARN0 NOT = SPACES                           15552013
155530             WHEN SQLCODE < ZERO                                  15553013
155540             WHEN SQLCODE > ZERO                                  15554013
155550                                                                  15555013
155560              INITIALIZE PV-CICS-MSG-AREA1                        15556013
155570              INITIALIZE PV-CICS-MSG-AREA2                        15557013
155580                                                                  15558013
155590              MOVE SQLCODE              TO PV-DISP-SQLCODE        15559013
155600              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15560013
155610              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15561013
155620              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15562013
155630                                                                  15563013
155640              STRING  'SUKCS782 6590-'                            15564099
155650                      ' DC:'               PV-DISP-DC             15565013
155660                      ' B1:'               SU054-BAR-CODE-1       15566013
155670                      ' B2:'               SU054-BAR-CODE-2       15567013
155680                      ' B3:'               SU054-BAR-CODE-3       15568013
155690                                           DELIMITED BY SIZE      15569013
155700                                      INTO PV-CICS-MSG-AREA1      15570013
155710                                                                  15571013
155720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15572013
155730              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15573013
155740                                                                  15574013
155750              PERFORM 9999-WRITE-TO-CSSL                          15575013
155760                                                                  15576013
155770              STRING  'SUKCS782 '          SU054-KOHLS-SML        15577099
155780                      ' TRIP:'             PV-DISP-TRIP           15578013
155790                      ' DR:'               SU054-DOOR-NUMBER      15579013
155800                      ' USR:'              SU054-USER-ID          15580013
155810                      ' STA:'              PV-DISP-PNA-STA        15581013
155820                      ' SQL:'              PV-DISP-SQLCODE        15582013
155830                      ' CLOSE WGHTS_MSRS_CSR - TSHUUPC'           15583013
155840                                           DELIMITED BY SIZE      15584013
155850                                      INTO PV-CICS-MSG-AREA2      15585013
155860                                                                  15586013
155870              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15587013
155880              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15588013
155890                                                                  15589013
155900              PERFORM 9999-WRITE-TO-CSSL                          15590013
155910                                                                  15591013
155920              INITIALIZE PV-CICS-MSG-AREA3                        15592013
155930              MOVE  DK-CTN                    TO PV-DISP-sscc     15593013
155940                                                                  15594013
155950              STRING  'SUKCS782 '                                 15595099
155960                      ' SSCC:'         PV-DISP-SSCC               15596013
155970                                           DELIMITED BY SIZE      15597013
155980                                      INTO PV-CICS-MSG-AREA3      15598013
155990                                                                  15599013
156000              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15600013
156010              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15601013
156020                                                                  15602013
156030              PERFORM 9999-WRITE-TO-CSSL                          15603013
156040                                                                  15604013
156050                 SET PS-PROCESSING-ERROR-YES TO TRUE              15605013
156060                 PERFORM 9998-WRITE-TO-CSSL                       15606013
156070         END-EVALUATE.                                            15607013
156080                                                                  15608013
156090 6700-LINK-XLKUT073.                                              15609013
156100*                                                                 15610013
156110** added internal table to track paragraph execution time         15611013
156120** dmh 2014-12-22 - begin                                         15612013
156130*                                                                 15613013
156140     MOVE  '6700'  TO  PT-CURR-PARA.                              15614013
156150     IF  PS-BLD-INTERNAL-TABLE-YES                                15615013
156160         PERFORM 0200-INTERNAL-TABLE                              15616013
156170     ELSE                                                         15617013
156180         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15618013
156190     END-IF.                                                      15619013
156200                                                                  15620013
156210*                                                                 15621013
156220** DMH 2014-12-22 - END                                           15622013
156230*                                                                 15623013
156240                                                                  15624013
156250     INITIALIZE XL073-COMMAREA-REC                                15625013
156260     MOVE PV-DEPT-NUMBER              TO XL073-DEPT-NBR           15626013
156270     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     15627013
156280                                     XL073-COMMAREA               15628013
156290                                     XL073-COMMAREA-REC           15629013
156300     EVALUATE TRUE                                                15630013
156310         WHEN XL073-NO-ERRORS                                     15631013
156320             MOVE XL073-BUS-AREA-ID  TO PV-BUS-AREA-ID            15632013
156330         WHEN XL073-DEPT-NOT-FND                                  15633013
156340         WHEN XL073-MAJ-CL-NOT-FND                                15634013
156350         WHEN XL073-SUB-CL-NOT-FND                                15635013
156360             MOVE ZEROES TO PV-BUS-AREA-ID                        15636013
156370         WHEN OTHER                                               15637013
156380                                                                  15638013
156390              INITIALIZE PV-CICS-MSG-AREA1                        15639013
156400              INITIALIZE PV-CICS-MSG-AREA2                        15640013
156410                                                                  15641013
156420              MOVE XL073-SQLCODE        TO PV-DISP-SQLCODE        15642013
156430              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15643013
156440              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15644013
156450              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15645013
156460                                                                  15646013
156470              STRING  'SUKCS782 6700-'                            15647099
156480                      ' DC:'               PV-DISP-DC             15648013
156490                      ' B1:'               SU054-BAR-CODE-1       15649013
156500                      ' B2:'               SU054-BAR-CODE-2       15650013
156510                      ' B3:'               SU054-BAR-CODE-3       15651013
156520                                           DELIMITED BY SIZE      15652013
156530                                      INTO PV-CICS-MSG-AREA1      15653013
156540                                                                  15654013
156550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15655013
156560              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15656013
156570                                                                  15657013
156580              PERFORM 9999-WRITE-TO-CSSL                          15658013
156590                                                                  15659013
156600              STRING  'SUKCS782 '          SU054-KOHLS-SML        15660099
156610                      ' TRIP:'             PV-DISP-TRIP           15661013
156620                      ' DR:'               SU054-DOOR-NUMBER      15662013
156630                      ' USR:'              SU054-USER-ID          15663013
156640                      ' STA:'              PV-DISP-PNA-STA        15664013
156650                      ' SQL:'              PV-DISP-SQLCODE        15665013
156660                      ' DEPT/CLASS XL MODULE - XL TABLES'         15666013
156670                                           DeLIMITED BY SIZE      15667013
156680                                      INTO PV-CICS-MSG-AREA2      15668013
156690                                                                  15669013
156700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15670013
156710              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15671013
156720                                                                  15672013
156730              PERFORM 9999-WRITE-TO-CSSL                          15673013
156740                                                                  15674013
156750              INITIALIZE PV-CICS-MSG-AREA3                        15675013
156760                                                                  15676013
156770              STRING  'SUKCS782 (XLKUT073)'                       15677099
156780                      ' INPUT:'        XL073-INPUT-DATA           15678013
156790                      ' DEPT:'         XL073-DEPT-NAME            15679013
156800                      ' MDSE:'         XL073-MDSE-LNE-CDE         15680013
156810                      ' GP:'           XL073-BUS-GP-NBR           15681013
156820                      ' ZN:'           XL073-STR-ZN-CDE           15682013
156830                      ' BUYER:'        XL073-BUYER-NBR            15683013
156840                      ' DMA:'          XL073-DMA-NBR              15684013
156850                      ' CONT:'         XL073-CONT-IND             15685013
156860                                           DELIMITED BY SIZE      15686013
156870                                      INTO PV-CICS-MSG-AREA3      15687013
156880                                                                  15688013
156890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15689013
156900              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15690013
156910                                                                  15691013
156920              PERFORM 9999-WRITE-TO-CSSL                          15692013
156930                                                                  15693013
156940              INITIALIZE PV-CICS-MSG-AREA4                        15694013
156950                                                                  15695013
156960              STRING  'SUKCS782 '                                 15696099
156970                      ' MAJ:'          XL073-MAJ-CL-NAME          15697013
156980                      ' SUB:'          XL073-SUB-CL-NAME          15698013
156990                      ' POS:'          XL073-POS-MDSE-DESC        15699013
157000                                           DELIMITED BY SIZE      15700013
157010                                      INTO PV-CICS-MSG-AREA4      15701013
157020                                                                  15702013
157030              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15703013
157040              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     15704013
157050                                                                  15705013
157060              PERFORM 9999-WRITE-TO-CSSL                          15706013
157070                                                                  15707013
157080              INITIALIZE PV-CICS-MSG-AREA5                        15708013
157090                                                                  15709013
157100              STRING  'SUKCS782 '                                 15710099
157110                      ' TAX:'          XL073-TAX-DFLT-IND         15711013
157120                      ' DISC:'         XL073-DISC-ELIG-IND        15712013
157130                      ' BUS GP:'       XL073-BUS-GP-DESC          15713013
157140                      ' AREA:'         XL073-BUS-AREA-ID          15714013
157150                      ' DESC:'         XL073-BUS-AREA-DESC        15715013
157160                      ' RC:'           XL073-RETURN-CODE          15716013
157170                      ' TABLE:'        XL073-DB2-TABLE            15717013
157180                      ' RC:'           XL073-RETURN-CODE          15718013
157190                                           DELIMITED BY SIZE      15719013
157200                                      INTO PV-CICS-MSG-AREA5      15720013
157210                                                                  15721013
157220              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15722013
157230              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     15723013
157240                                                                  15724013
157250              PERFORM 9999-WRITE-TO-CSSL                          15725013
157260                                                                  15726013
157270             SET PS-PROCESSING-ERROR-YES TO TRUE                  15727013
157280             PERFORM 9998-WRITE-TO-CSSL                           15728013
157290     END-EVALUATE.                                                15729013
157300                                                                  15730013
157310******************************************************************15731013
157320******************************************************************15732013
157330 6750-CHECK-ECOMM-REPURPOSE.                                      15733013
157340******************************************************************15734013
157350*                                                                 15735013
157360** added internal table to track paragraph execution time         15736013
157370** dmh 2014-12-22 - begin                                         15737013
157380*                                                                 15738013
157390     MOVE  '6750'  TO  PT-CURR-PARA.                              15739013
157400     IF  PS-BLD-INTERNAL-TABLE-YES                                15740013
157410         PERFORM 0200-INTERNAL-TABLE                              15741013
157420     ELSE                                                         15742013
157430         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15743013
157440     END-IF.                                                      15744013
157450                                                                  15745013
157460*                                                                 15746013
157470** DMH 2014-12-22 - END                                           15747013
157480*                                                                 15748013
157490*      --REPURPOSE--                                              15749013
157500     SET PS-ECOMM-DC-REPURPOSE-NO TO TRUE                         15750013
157510     MOVE ZEROES             TO LBVRDA-PREPK-ID                   15751013
157520     PERFORM 6760-CHECK-TROUBLE-REPURP.                           15752013
157530     IF PV-TROUBLE-COUNT-REPUR > +0                               15753013
157540        SET PS-ECOMM-DC-REPURPOSE TO TRUE                         15754013
157550        PERFORM 7220-SELECT-TPURCHS                               15755013
157560        IF PURCHS-PKGNG-CDE = PC-M OR PC-I                        15756013
157570           PERFORM 7225-SELECT-TPURITM                            15757013
157580           MOVE PURITM-PO-PREPK-ID TO PV-PREPK-ID                 15758013
157590        END-IF                                                    15759013
157600     ELSE                                                         15760013
157610       IF PV-REPURP-COUNT > 0                                     15761013
157620        IF RECEIV-PKGNG-CDE = PC-B OR PC-C                        15762013
157630           PERFORM 7220-SELECT-TPURCHS                            15763013
157640           IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-SPACE         15764013
157650              IF PURCHS-PKGNG-CDE = PC-M OR PC-I                  15765013
157660                 PERFORM 7225-SELECT-TPURITM                      15766013
157670                 MOVE PURITM-PO-PREPK-ID TO PV-PREPK-ID           15767013
157680              END-IF                                              15768013
157690              SET PS-ECOMM-DC-REPURPOSE TO TRUE                   15769013
157700           ELSE                                                   15770013
157710              PERFORM 6771-CHCK-TRBL-REPUR-INNR                   15771013
157720              IF PV-TROUBLE-CNT-REPUR-INNR > +0                   15772013
157730                 SET PS-ECOMM-DC-REPURPOSE TO TRUE                15773013
157740              END-IF                                              15774013
157750           END-IF                                                 15775013
157760        END-IF                                                    15776013
157770       END-IF                                                     15777013
157780     END-IF.                                                      15778013
157790                                                                  15779013
157800                                                                  15780013
157810*----------------------------------------------------------------*15781013
157820* CHECK IF PO/RECEIVER IS IN TROUBLE                             *15782013
157830* CHECK IF TROUBLE 405 WAS CREATED. FLAG FOR REPURPOSE EVEN IF THE15783013
157840* TROUBLE HAS BEEN ACKNOWLEDGED.                                 *15784013
157850*                                                                *15785013
157860*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *15786013
157870*                     Added "FETCH FIRST 1 ROW" program was only *15787013
157880*                     checking for the existence of              *15788013
157890*----------------------------------------------------------------*15789013
157900 6760-CHECK-TROUBLE-REPURP.                                       15790013
157910*                                                                 15791013
157920** added internal table to track paragraph execution time         15792013
157930** dmh 2014-12-22 - begin                                         15793013
157940*                                                                 15794013
157950     MOVE  '6760'  TO  PT-CURR-PARA.                              15795013
157960     IF  PS-BLD-INTERNAL-TABLE-YES                                15796013
157970         PERFORM 0200-INTERNAL-TABLE                              15797013
157980     ELSE                                                         15798013
157990         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15799013
158000     END-IF.                                                      15800013
158010                                                                  15801013
158020*                                                                 15802013
158030** DMH 2014-12-22 - END                                           15803013
158040*                                                                 15804013
158050     MOVE PV-RCVR-SEQ-NBR          TO DK-REC-SEQ-NBR.             15805013
158060     MOVE ZEROES                   TO PV-TROUBLE-COUNT-REPUR.     15806013
158070                                                                  15807013
158080     EXEC SQL                                                     15808013
158090        SELECT COUNT(*)                                           15809013
158100          INTO :PV-TROUBLE-COUNT-REPUR                            15810013
158110          FROM TTRBNTF A                                          15811013
158120              ,TTRBRSN C                                          15812013
158130         WHERE A.PO_NBR       =  :DK-PO                           15813013
158140           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  15814013
158150           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    15815013
158160           AND C.NOTIF_IND    =  'T'                              15816013
158170           AND EXISTS                                             15817013
158180              ( SELECT *                                          15818013
158190                FROM  TTRBRCN B                                   15819013
158200                WHERE B.RPT_PGM_NM  = 'SUKEC502'                  15820013
158210                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         15821013
158220         FETCH FIRST 1 ROW ONLY                                   15822013
158230          WITH UR                                                 15823013
158240     END-EXEC                                                     15824013
158250                                                                  15825013
158260     EVALUATE TRUE                                                15826013
158270         WHEN SQLCODE = ZERO                                      15827013
158280         WHEN SQLCODE = +100                                      15828013
158290             CONTINUE                                             15829013
158300         WHEN SQLWARN0 NOT = SPACES                               15830013
158310         WHEN SQLCODE < ZERO                                      15831013
158320         WHEN SQLCODE > ZERO                                      15832013
158330                                                                  15833013
158340              INITIALIZE PV-CICS-MSG-AREA1                        15834013
158350              INITIALIZE PV-CICS-MSG-AREA2                        15835013
158360                                                                  15836013
158370              MOVE SQLCODE              TO PV-DISP-SQLCODE        15837013
158380              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15838013
158390              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15839013
158400              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15840013
158410                                                                  15841013
158420              STRING  'SUKCS782 6760-'                            15842099
158430                      ' DC:'               PV-DISP-DC             15843013
158440                      ' B1:'               SU054-BAR-CODE-1       15844013
158450                      ' B2:'               SU054-BAR-CODE-2       15845013
158460                      ' B3:'               SU054-BAR-CODE-3       15846013
158470                                           DELIMITED BY SIZE      15847013
158480                                      INTO PV-CICS-MSG-AREA1      15848013
158490                                                                  15849013
158500              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15850013
158510              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15851013
158520                                                                  15852013
158530              PERFORM 9999-WRITE-TO-CSSL                          15853013
158540                                                                  15854013
158550              STRING  'SUKCS782 '          SU054-KOHLS-SML        15855099
158560                      ' TRIP:'             PV-DISP-TRIP           15856013
158570                      ' DR:'               SU054-DOOR-NUMBER      15857013
158580                      ' USR:'              SU054-USER-ID          15858013
158590                      ' STA:'              PV-DISP-PNA-STA        15859013
158600                      ' SQL:'              PV-DISP-SQLCODE        15860013
158610                      ' TTRBNTF/TTRBRSN/TTRBRCN'                  15861013
158620                                           DeLIMITED BY SIZE      15862013
158630                                      INTO PV-CICS-MSG-AREA2      15863013
158640                                                                  15864013
158650              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15865013
158660              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15866013
158670                                                                  15867013
158680              PERFORM 9999-WRITE-TO-CSSL                          15868013
158690                                                                  15869013
158700              INITIALIZE PV-CICS-MSG-AREA3                        15870013
158710                                                                  15871013
158720              MOVE  DK-PO              TO PV-DISP-PO              15872013
158730              MOVE  DK-REC-SEQ-NBR     TO PV-DISP-RCVR            15873013
158740                                                                  15874013
158750              STRING  'SUKCS782 '                                 15875099
158760                      ' PO:'            PV-DISP-PO                15876013
158770                      '-'               PV-DISP-RCVR              15877013
158780                      '  RPT_PGM_NM  =  SUKEC502'                 15878013
158790                                           DELIMITED BY SIZE      15879013
158800                                      INTO PV-CICS-MSG-AREA3      15880013
158810                                                                  15881013
158820              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15882013
158830              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15883013
158840                                                                  15884013
158850              PERFORM 9999-WRITE-TO-CSSL                          15885013
158860                                                                  15886013
158870             SET PS-PROCESSING-ERROR-YES TO TRUE                  15887013
158880             PERFORM 9998-WRITE-TO-CSSL                           15888013
158890                                                                  15889013
158900     END-EVALUATE.                                                15890013
158910                                                                  15891013
158920*----------------------------------------------------------------*15892013
158930* CHECK IF PO/RECEIVER IS IN TROUBLE                             *15893013
158940* CHECK IF TROUBLE 406 WAS CREATED. TROUBLE CREATED WHEN CURRENT  15894013
158950* LOCATION ANY DC OTHER THAN 870 ECOMM AND CREATED FOR LOCATION  *15895013
158960* IS 870, AND THE INNER CRTN QTY IS > 1                           15896013
158970*                                                                *15897013
158980*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *15898013
158990*                     Added "FETCH FIRST 1 ROW" program was only *15899013
159000*                     checking for the existence of              *15900013
159010*----------------------------------------------------------------*15901013
159020 6771-CHCK-TRBL-REPUR-INNR.                                       15902013
159030*                                                                 15903013
159040** added internal table to track paragraph execution time         15904013
159050** dmh 2014-12-22 - begin                                         15905013
159060*                                                                 15906013
159070     MOVE  '6771'  TO  PT-CURR-PARA.                              15907013
159080     IF  PS-BLD-INTERNAL-TABLE-YES                                15908013
159090         PERFORM 0200-INTERNAL-TABLE                              15909013
159100     ELSE                                                         15910013
159110         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       15911013
159120     END-IF.                                                      15912013
159130                                                                  15913013
159140*                                                                 15914013
159150** DMH 2014-12-22 - END                                           15915013
159160*                                                                 15916013
159170     MOVE PV-RCVR-SEQ-NBR          TO DK-REC-SEQ-NBR.             15917013
159180     MOVE ZEROES                   TO PV-TROUBLE-CNT-REPUR-INNR.  15918013
159190                                                                  15919013
159200     EXEC SQL                                                     15920013
159210        SELECT COUNT(*)                                           15921013
159220          INTO :PV-TROUBLE-CNT-REPUR-INNR                         15922013
159230          FROM TTRBNTF A                                          15923013
159240              ,TTRBRSN C                                          15924013
159250         WHERE A.PO_NBR       =  :DK-PO                           15925013
159260           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  15926013
159270           AND A.RESOLVED_IND IN ('N','I','R')                    15927013
159280           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    15928013
159290           AND C.NOTIF_IND    =  'T'                              15929013
159300           AND EXISTS                                             15930013
159310              ( SELECT *                                          15931013
159320                FROM  TTRBRCN B                                   15932013
159330                WHERE B.RPT_PGM_NM  = 'SUEC1502'                  15933013
159340                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         15934013
159350         FETCH FIRST 1 ROW ONLY                                   15935013
159360          WITH UR                                                 15936013
159370     END-EXEC                                                     15937013
159380                                                                  15938013
159390     EVALUATE TRUE                                                15939013
159400         WHEN SQLCODE = ZERO                                      15940013
159410         WHEN SQLCODE = +100                                      15941013
159420             CONTINUE                                             15942013
159430         WHEN SQLWARN0 NOT = SPACES                               15943013
159440         WHEN SQLCODE < ZERO                                      15944013
159450         WHEN SQLCODE > ZERO                                      15945013
159460                                                                  15946013
159470              INITIALIZE PV-CICS-MSG-AREA1                        15947013
159480              INITIALIZE PV-CICS-MSG-AREA2                        15948013
159490                                                                  15949013
159500              MOVE SQLCODE              TO PV-DISP-SQLCODE        15950013
159510              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             15951013
159520              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           15952013
159530              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        15953013
159540                                                                  15954013
159550              STRING  'SUKCS782 6771-'                            15955099
159560                      ' DC:'               PV-DISP-DC             15956013
159570                      ' B1:'               SU054-BAR-CODE-1       15957013
159580                      ' B2:'               SU054-BAR-CODE-2       15958013
159590                      ' B3:'               SU054-BAR-CODE-3       15959013
159600                                           DELIMITED BY SIZE      15960013
159610                                      INTO PV-CICS-MSG-AREA1      15961013
159620                                                                  15962013
159630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15963013
159640              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     15964013
159650                                                                  15965013
159660              PERFORM 9999-WRITE-TO-CSSL                          15966013
159670                                                                  15967013
159680              STRING  'SUKCS782 '          SU054-KOHLS-SML        15968099
159690                      ' TRIP:'             PV-DISP-TRIP           15969013
159700                      ' DR:'               SU054-DOOR-NUMBER      15970013
159710                      ' USR:'              SU054-USER-ID          15971013
159720                      ' STA:'              PV-DISP-PNA-STA        15972013
159730                      ' SQL:'              PV-DISP-SQLCODE        15973013
159740                      ' TTRBNTF/TTRBRSN/TTRBRCN'                  15974013
159750                                           DeLIMITED BY SIZE      15975013
159760                                      INTO PV-CICS-MSG-AREA2      15976013
159770                                                                  15977013
159780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15978013
159790              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     15979013
159800                                                                  15980013
159810              PERFORM 9999-WRITE-TO-CSSL                          15981013
159820                                                                  15982013
159830              INITIALIZE PV-CICS-MSG-AREA3                        15983013
159840                                                                  15984013
159850              MOVE  DK-PO              TO PV-DISP-PO              15985013
159860              MOVE  DK-REC-SEQ-NBR     TO PV-DISP-RCVR            15986013
159870                                                                  15987013
159880              STRING  'SUKCS782 '                                 15988099
159890                      ' PO:'            PV-DISP-PO                15989013
159900                      '-'               PV-DISP-RCVR              15990013
159910                      '  RPT_PGM_NM  =  SUEC1502'                 15991013
159920                                           DELIMITED BY SIZE      15992013
159930                                      INTO PV-CICS-MSG-AREA3      15993013
159940                                                                  15994013
159950              MOVE SPACES               TO PV-CICS-MSG-AREA-A     15995013
159960              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     15996013
159970                                                                  15997013
159980              PERFORM 9999-WRITE-TO-CSSL                          15998013
159990                                                                  15999013
160000             SET PS-PROCESSING-ERROR-YES TO TRUE                  16000013
160010             PERFORM 9998-WRITE-TO-CSSL                           16001013
160020                                                                  16002013
160030     END-EVALUATE.                                                16003013
160040                                                                  16004013
160050*----------------------------------------------------------------*16005013
160060******************************************************************16006013
160070* Temporary code to check if audits labels had been requested    *16007013
160080* prior to the changes for audit prompting.                     **16008013
160090* If an audit label had been previously printed for bulk/casepack,16009013
160100* or if cartons have been previoulsy checked in for a po/trip for*16010013
160110* Pack by Store, the new audit module will not be called.       **16011013
160120* 2002-03-18 date two weeks after install                       **16012013
160130******************************************************************16013013
160140 7000-AUDIT-CHECK-PROCESSING.                                     16014013
160150*                                                                 16015013
160160** added internal table to track paragraph execution time         16016013
160170** dmh 2014-12-22 - begin                                         16017013
160180*                                                                 16018013
160190     MOVE  '7000'  TO  PT-CURR-PARA.                              16019013
160200     IF  PS-BLD-INTERNAL-TABLE-YES                                16020013
160210         PERFORM 0200-INTERNAL-TABLE                              16021013
160220     ELSE                                                         16022013
160230         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16023013
160240     END-IF.                                                      16024013
160250                                                                  16025013
160260*                                                                 16026013
160270** DMH 2014-12-22 - END                                           16027013
160280*                                                                 16028013
160290                                                                  16029013
160300     PERFORM 7405-GET-CURRENT-DATE                                16030013
160310     IF PV-CURRENT-DATE <  '2002-03-04'                           16031013
160320        PERFORM 7050-CHECK-TKRPRPM                                16032013
160330        IF KRPRPM-FUNC-BEG-TMST =  PC-DEFAULT-TIME                16033013
160340            CONTINUE                                              16034013
160350        ELSE                                                      16035013
160360           IF PS-PACK-BY-STORE                                    16036013
160370              PERFORM 7070-CHECK-PREV-CKED-CRTNS                  16037013
160380              IF SHUNLO-CRE-TMST >  KRPRPM-FUNC-BEG-TMST          16038013
160390                 PERFORM 7100-CHECK-CRTN-AUDIT-STATUS             16039013
160400              END-IF                                              16040013
160410           ELSE                                                   16041013
160420              PERFORM 3560-CHECK-FOR-NEW-PO-LINE                  16042013
160430              IF LBVRMG-CRE-TMST >  KRPRPM-FUNC-BEG-TMST          16043013
160440                 PERFORM 7100-CHECK-CRTN-AUDIT-STATUS             16044013
160450              END-IF                                              16045013
160460           END-IF                                                 16046013
160470        END-IF                                                    16047013
160480     ELSE                                                         16048013
160490         PERFORM 7100-CHECK-CRTN-AUDIT-STATUS                     16049013
160500     END-IF.                                                      16050013
160510     SET PS-DONT-PRINT-AUDIT-LABEL  TO TRUE.                      16051013
160520                                                                  16052013
160530                                                                  16053013
160540******************************************************************16054013
160550*CHECK INSTALL DATE FROM THE PARM TABLE                           16055013
160560*                                                                *16056013
160570*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *16057013
160580*----------------------------------------------------------------*16058013
160590 7050-CHECK-TKRPRPM.                                              16059013
160600*                                                                 16060013
160610** added internal table to track paragraph execution time         16061013
160620** dmh 2014-12-22 - begin                                         16062013
160630*                                                                 16063013
160640     MOVE  '7050'  TO  PT-CURR-PARA.                              16064013
160650     IF  PS-BLD-INTERNAL-TABLE-YES                                16065013
160660         PERFORM 0200-INTERNAL-TABLE                              16066013
160670     ELSE                                                         16067013
160680         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16068013
160690     END-IF.                                                      16069013
160700                                                                  16070013
160710*                                                                 16071013
160720** DMH 2014-12-22 - END                                           16072013
160730*                                                                 16073013
160740                                                                  16074013
160750     EXEC SQL                                                     16075013
160760          SELECT FUNC_BEG_TMST                                    16076013
160770          INTO  :KRPRPM-FUNC-BEG-TMST                             16077013
160780          FROM   TKRPRPM                                          16078013
160790          WHERE  LOC_ID            =  90                          16079013
160800            AND  SYS_PRC_FUNC_CDE  = 'BEGAUD'                     16080013
160810           WITH UR                                                16081013
160820     END-EXEC.                                                    16082013
160830                                                                  16083013
160840                                                                  16084013
160850     EVALUATE TRUE                                                16085013
160860         WHEN SQLCODE = ZERO                                      16086013
160870             CONTINUE                                             16087013
160880         WHEN SQLCODE = +100                                      16088013
160890             MOVE ZEROES TO KRPRPM-FUNC-BEG-TMST                  16089013
160900         WHEN SQLWARN0 NOT = SPACES                               16090013
160910         WHEN SQLCODE < ZERO                                      16091013
160920         WHEN SQLCODE > ZERO                                      16092013
160930                                                                  16093013
160940              INITIALIZE PV-CICS-MSG-AREA1                        16094013
160950              INITIALIZE PV-CICS-MSG-AREA2                        16095013
160960                                                                  16096013
160970              MOVE SQLCODE              TO PV-DISP-SQLCODE        16097013
160980              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             16098013
160990              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           16099013
161000              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        16100013
161010                                                                  16101013
161020              STRING  'SUKCS782 7050-'                            16102099
161030                      ' DC:'               PV-DISP-DC             16103013
161040                      ' B1:'               SU054-BAR-CODE-1       16104013
161050                      ' B2:'               SU054-BAR-CODE-2       16105013
161060                      ' B3:'               SU054-BAR-CODE-3       16106013
161070                                           DELIMITED BY SIZE      16107013
161080                                      INTO PV-CICS-MSG-AREA1      16108013
161090                                                                  16109013
161100              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16110013
161110              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     16111013
161120                                                                  16112013
161130              PERFORM 9999-WRITE-TO-CSSL                          16113013
161140                                                                  16114013
161150              STRING  'SUKCS782 '          SU054-KOHLS-SML        16115099
161160                      ' TRIP:'             PV-DISP-TRIP           16116013
161170                      ' DR:'               SU054-DOOR-NUMBER      16117013
161180                      ' USR:'              SU054-USER-ID          16118013
161190                      ' STA:'              PV-DISP-PNA-STA        16119013
161200                      ' SQL:'              PV-DISP-SQLCODE        16120013
161210                      ' TKRPRPM'                                  16121013
161220                                           DeLIMITED BY SIZE      16122013
161230                                      INTO PV-CICS-MSG-AREA2      16123013
161240                                                                  16124013
161250              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16125013
161260              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     16126013
161270                                                                  16127013
161280              PERFORM 9999-WRITE-TO-CSSL                          16128013
161290                                                                  16129013
161300              INITIALIZE PV-CICS-MSG-AREA3                        16130013
161310                                                                  16131013
161320              STRING  'SUKCS782 '                                 16132099
161330                      ' Parm: 90 BEGAUD '                         16133013
161340                                           DELIMITED BY SIZE      16134013
161350                                      INTO PV-CICS-MSG-AREA3      16135013
161360                                                                  16136013
161370              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16137013
161380              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     16138013
161390                                                                  16139013
161400              PERFORM 9999-WRITE-TO-CSSL                          16140013
161410                                                                  16141013
161420             SET PS-PROCESSING-ERROR-YES TO TRUE                  16142013
161430             PERFORM 9998-WRITE-TO-CSSL                           16143013
161440                                                                  16144013
161450     END-EVALUATE.                                                16145013
161460                                                                  16146013
161470                                                                  16147013
161480******************************************************************16148013
161490*SELECT DIVERT LOCATION BARCODE  FOR REPURPOSE                    16149013
161500*                                                                *16150013
161510*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *16151013
161520*----------------------------------------------------------------*16152013
161530 7055-CHECK-TKRPRPM-REPURP-LOC.                                   16153013
161540*                                                                 16154013
161550** added internal table to track paragraph execution time         16155013
161560** dmh 2014-12-22 - begin                                         16156013
161570*                                                                 16157013
161580     MOVE  '7055'  TO  PT-CURR-PARA.                              16158013
161590     IF  PS-BLD-INTERNAL-TABLE-YES                                16159013
161600         PERFORM 0200-INTERNAL-TABLE                              16160013
161610     ELSE                                                         16161013
161620         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16162013
161630     END-IF.                                                      16163013
161640                                                                  16164013
161650*                                                                 16165013
161660** DMH 2014-12-22 - END                                           16166013
161670*                                                                 16167013
161680                                                                  16168013
161690     MOVE RECEIV-CURR-OPER-UNT-ID TO KRPRPM-LOC-ID.               16169013
161700                                                                  16170013
161710     EXEC SQL                                                     16171013
161720          SELECT FUNC_TXT                                         16172013
161730          INTO  :KRPRPM-FUNC-TXT                                  16173013
161740          FROM   TKRPRPM                                          16174013
161750          WHERE  LOC_ID            =  :KRPRPM-LOC-ID              16175013
161760            AND  SYS_PRC_FUNC_CDE  = 'ECRPRP'                     16176013
161770           WITH UR                                                16177013
161780     END-EXEC.                                                    16178013
161790                                                                  16179013
161800                                                                  16180013
161810     EVALUATE TRUE                                                16181013
161820         WHEN SQLCODE = ZERO                                      16182013
161830             CONTINUE                                             16183013
161840         WHEN SQLWARN0 NOT = SPACES                               16184013
161850         WHEN SQLCODE < ZERO                                      16185013
161860         WHEN SQLCODE > ZERO                                      16186013
161870                                                                  16187013
161880              INITIALIZE PV-CICS-MSG-AREA1                        16188013
161890              INITIALIZE PV-CICS-MSG-AREA2                        16189013
161900                                                                  16190013
161910              MOVE SQLCODE              TO PV-DISP-SQLCODE        16191013
161920              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             16192013
161930              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           16193013
161940              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        16194013
161950                                                                  16195013
161960              STRING  'SUKCS782 7055-'                            16196099
161970                      ' DC:'               PV-DISP-DC             16197013
161980                      ' B1:'               SU054-BAR-CODE-1       16198013
161990                      ' B2:'               SU054-BAR-CODE-2       16199013
162000                      ' B3:'               SU054-BAR-CODE-3       16200013
162010                                           DELIMITED BY SIZE      16201013
162020                                      INTO PV-CICS-MSG-AREA1      16202013
162030                                                                  16203013
162040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16204013
162050              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     16205013
162060                                                                  16206013
162070              PERFORM 9999-WRITE-TO-CSSL                          16207013
162080                                                                  16208013
162090              STRING  'SUKCS782 '          SU054-KOHLS-SML        16209099
162100                      ' TRIP:'             PV-DISP-TRIP           16210013
162110                      ' DR:'               SU054-DOOR-NUMBER      16211013
162120                      ' USR:'              SU054-USER-ID          16212013
162130                      ' STA:'              PV-DISP-PNA-STA        16213013
162140                      ' SQL:'              PV-DISP-SQLCODE        16214013
162150                      ' TKRPRPM'                                  16215013
162160                                           DeLIMITED BY SIZE      16216013
162170                                      INTO PV-CICS-MSG-AREA2      16217013
162180                                                                  16218013
162190              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16219013
162200              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     16220013
162210                                                                  16221013
162220              PERFORM 9999-WRITE-TO-CSSL                          16222013
162230                                                                  16223013
162240              INITIALIZE PV-CICS-MSG-AREA3                        16224013
162250                                                                  16225013
162260              MOVE  KRPRPM-LOC-ID      TO PV-DISP-OPER            16226013
162270                                                                  16227013
162280              STRING  'SUKCS782 '                                 16228099
162290                      ' PARM: ECRPRP'                             16229013
162300                      ' OPER:'             PV-DISP-OPER           16230013
162310                                           DELIMITED BY SIZE      16231013
162320                                      INTO PV-CICS-MSG-AREA3      16232013
162330                                                                  16233013
162340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16234013
162350              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     16235013
162360                                                                  16236013
162370              PERFORM 9999-WRITE-TO-CSSL                          16237013
162380                                                                  16238013
162390             SET PS-PROCESSING-ERROR-YES TO TRUE                  16239013
162400             PERFORM 9998-WRITE-TO-CSSL                           16240013
162410                                                                  16241013
162420     END-EVALUATE.                                                16242013
162430******************************************************************16243013
162440                                                                  16244013
162450                                                                  16245013
162460******************************************************************16246013
162470*CHECK FOR PREVIOUSLY CHECKED CARTONS                             16247013
162480*                                                                *16248013
162490*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *16249013
162500*----------------------------------------------------------------*16250013
162510 7070-CHECK-PREV-CKED-CRTNS.                                      16251013
162520*                                                                 16252013
162530** added internal table to track paragraph execution time         16253013
162540** dmh 2014-12-22 - begin                                         16254013
162550*                                                                 16255013
162560     MOVE  '7070'  TO  PT-CURR-PARA.                              16256013
162570     IF  PS-BLD-INTERNAL-TABLE-YES                                16257013
162580         PERFORM 0200-INTERNAL-TABLE                              16258013
162590     ELSE                                                         16259013
162600         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16260013
162610     END-IF.                                                      16261013
162620                                                                  16262013
162630*                                                                 16263013
162640** DMH 2014-12-22 - END                                           16264013
162650*                                                                 16265013
162660                                                                  16266013
162670                                                                  16267013
162680     EXEC SQL                                                     16268013
162690         SELECT  MIN(B.CRE_TMST)                                  16269013
162700         INTO   :SHUNLO-CRE-TMST :PV-NULL-CRE-TMST                16270013
162710         FROM   TSHUUPC A                                         16271013
162720              , TSHUNLO B                                         16272013
162730         WHERE  A.SHIPT_UNT_ID   =  B.SHIPT_UNT_ID                16273013
162740           AND  A.TRN_NBR        = :PV-PO-NBR                     16274013
162750           AND  B.TRIP_ID        = :DK-MANIFEST                   16275013
162760     END-EXEC.                                                    16276013
162770                                                                  16277013
162780     EVALUATE TRUE                                                16278013
162790         WHEN SQLCODE = ZERO                                      16279013
162800             IF PV-NULL-CRE-TMST = -1                             16280013
162810                MOVE PC-DEFAULT-TIME TO SHUNLO-CRE-TMST           16281013
162820             END-IF                                               16282013
162830         WHEN SQLCODE = +100                                      16283013
162840             MOVE ZEROES TO SHUNLO-CRE-TMST                       16284013
162850         WHEN SQLWARN0 NOT = SPACES                               16285013
162860         WHEN SQLCODE NOT EQUAL ZERO                              16286013
162870                                                                  16287013
162880              INITIALIZE PV-CICS-MSG-AREA1                        16288013
162890              INITIALIZE PV-CICS-MSG-AREA2                        16289013
162900                                                                  16290013
162910              MOVE SQLCODE              TO PV-DISP-SQLCODE        16291013
162920              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             16292013
162930              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           16293013
162940              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        16294013
162950                                                                  16295013
162960              STRING  'SUKCS782 7070-'                            16296099
162970                      ' DC:'               PV-DISP-DC             16297013
162980                      ' B1:'               SU054-BAR-CODE-1       16298013
162990                      ' B2:'               SU054-BAR-CODE-2       16299013
163000                      ' B3:'               SU054-BAR-CODE-3       16300013
163010                                           DELIMITED BY SIZE      16301013
163020                                      INTO PV-CICS-MSG-AREA1      16302013
163030                                                                  16303013
163040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16304013
163050              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     16305013
163060                                                                  16306013
163070              PERFORM 9999-WRITE-TO-CSSL                          16307013
163080                                                                  16308013
163090              STRING  'SUKCS782 '          SU054-KOHLS-SML        16309099
163100                      ' TRIP:'             PV-DISP-TRIP           16310013
163110                      ' DR:'               SU054-DOOR-NUMBER      16311013
163120                      ' USR:'              SU054-USER-ID          16312013
163130                      ' STA:'              PV-DISP-PNA-STA        16313013
163140                      ' SQL:'              PV-DISP-SQLCODE        16314013
163150                      ' TSHUNLO/SHUUPC'                           16315013
163160                                           DeLIMITED BY SIZE      16316013
163170                                      INTO PV-CICS-MSG-AREA2      16317013
163180                                                                  16318013
163190              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16319013
163200              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     16320013
163210                                                                  16321013
163220              PERFORM 9999-WRITE-TO-CSSL                          16322013
163230                                                                  16323013
163240              INITIALIZE PV-CICS-MSG-AREA3                        16324013
163250                                                                  16325013
163260              MOVE  PV-PO-NBR          TO PV-DISP-PO              16326013
163270              MOVE  DK-MANIFEST        TO PV-DISP-TRIP            16327013
163280                                                                  16328013
163290              STRING  'SUKCS782 '                                 16329099
163300                      ' PO:'               PV-DISP-PO             16330013
163310                      ' TRIP:'             PV-DISP-TRIP           16331013
163320                                           DELIMITED BY SIZE      16332013
163330                                      INTO PV-CICS-MSG-AREA3      16333013
163340                                                                  16334013
163350              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16335013
163360              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     16336013
163370                                                                  16337013
163380              PERFORM 9999-WRITE-TO-CSSL                          16338013
163390                                                                  16339013
163400             SET PS-PROCESSING-ERROR-YES TO TRUE                  16340013
163410             PERFORM 9998-WRITE-TO-CSSL                           16341013
163420     END-EVALUATE.                                                16342013
163430                                                                  16343013
163440*----------------------------------------------------------------*16344013
163450*  CALL TO AUDIT MODULE TO CHECK CARTON AUDIT STATUS             *16345013
163460*----------------------------------------------------------------*16346013
163470 7100-CHECK-CRTN-AUDIT-STATUS.                                    16347013
163480*                                                                 16348013
163490** added internal table to track paragraph execution time         16349013
163500** dmh 2014-12-22 - begin                                         16350013
163510*                                                                 16351013
163520     MOVE  '7100'  TO  PT-CURR-PARA.                              16352013
163530     IF  PS-BLD-INTERNAL-TABLE-YES                                16353013
163540         PERFORM 0200-INTERNAL-TABLE                              16354013
163550     ELSE                                                         16355013
163560         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16356013
163570     END-IF.                                                      16357013
163580                                                                  16358013
163590*                                                                 16359013
163600** DMH 2014-12-22 - END                                           16360013
163610*                                                                 16361013
163620      INITIALIZE SU021-CARTON-AUDIT-RECORD.                       16362013
163630                                                                  16363013
163640      SET  SU021-CARTON-CHECK-IN                                  16364013
163650           SU021-AUDIT-IS-COMPLETE                                16365013
163660*CLP 10/29/13 - START                                             16366013
163670           SU021-RFID-AUDIT-IS-COMPLETE  TO TRUE.                 16367013
163680*CLP 10/29/13 - END                                               16368013
163690      MOVE 'Y'          TO SU021-DEFERRED-AUDIT-IND.              16369013
163700                                                                  16370013
163710      MOVE PV-PO-NBR           TO SU021-PO-NUMBER                 16371013
163720      MOVE SHUUPC-TRN-LNE-NBR  TO SU021-LINE-NBR                  16372013
163730                                     RECITM-PREPK-ID              16373013
163740      IF RECEIV-PACK-BY-ST-IND = 'Y'                              16374013
163750          MOVE +0              TO SU021-DRIVER-LINE-NBR           16375013
163760                                  SU021-PRE-PACK-ID               16376013
163770          MOVE PC-PS       TO SU021-PACKAGE-TYPE-CODE             16377013
163780      ELSE                                                        16378013
163790          IF RECEIV-PKGNG-CDE = PC-M OR PC-I                      16379013
163800              PERFORM 2380-SELECT-PREPAK-INFO                     16380013
163810              MOVE PC-PP           TO SU021-PACKAGE-TYPE-CODE     16381013
163820              MOVE PV-DRIVER-LINE-NO                              16382013
163830                                   TO SU021-DRIVER-LINE-NBR       16383013
163840              MOVE RECITM-PREPK-ID TO SU021-PRE-PACK-ID           16384013
163850          ELSE                                                    16385013
163860              MOVE +0              TO SU021-DRIVER-LINE-NBR       16386013
163870                                      SU021-PRE-PACK-ID           16387013
163880              MOVE PC-BC       TO SU021-PACKAGE-TYPE-CODE         16388013
163890          END-IF                                                  16389013
163900      END-IF.                                                     16390013
163910      MOVE SU054-DC-NUMBER     TO SU021-OPER-UNT-ID               16391013
163920      MOVE PV-RCVR-SEQ-NBR     TO SU021-REC-SEQ-NBR               16392013
163930      MOVE SU054-TRIP-ID       TO SU021-INBOUND-TRIP-ID           16393013
163940      MOVE PV-CTN-N            TO SU021-SHIPT-UNT-ID              16394013
163950      MOVE SU054-USER-ID       TO SU021-USER-ID.                  16395013
163960      SET  SU021-PRINT-APPLY   TO TRUE.                           16396013
163970      PERFORM 7260-LINK-SUKCS583.                                 16397013
163980                                                                  16398013
163990                                                                  16399013
164000*----------------------------------------------------------------*16400013
164010*                                                                *16401013
164020*                                                                *16402013
164030*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *16403013
164040*----------------------------------------------------------------*16404013
164050 7150-CHECK-DC-LOC.                                               16405013
164060*                                                                 16406013
164070** added internal table to track paragraph execution time         16407013
164080** dmh 2014-12-22 - begin                                         16408013
164090*                                                                 16409013
164100     MOVE  '7150'  TO  PT-CURR-PARA.                              16410013
164110     IF  PS-BLD-INTERNAL-TABLE-YES                                16411013
164120         PERFORM 0200-INTERNAL-TABLE                              16412013
164130     ELSE                                                         16413013
164140         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16414013
164150     END-IF.                                                      16415013
164160                                                                  16416013
164170*                                                                 16417013
164180** DMH 2014-12-22 - END                                           16418013
164190*                                                                 16419013
164200                                                                  16420013
164210     MOVE  SU054-DC-NUMBER TO XLT00010-LOC-NBR                    16421013
164220                                                                  16422013
164230     EXEC SQL                                                     16423013
164240          SELECT  LOC_5_ABBR_NM                                   16424013
164250          INTO    :XLT00010-LOC-5-ABBR-NM                         16425013
164260          FROM   XLT_LOC                                          16426013
164270          WHERE  LOC_NBR   = :XLT00010-LOC-NBR                    16427013
164280           WITH UR                                                16428013
164290     END-EXEC.                                                    16429013
164300                                                                  16430013
164310     EVALUATE TRUE                                                16431013
164320         WHEN SQLCODE = ZERO                                      16432013
164330         WHEN SQLCODE = +100                                      16433013
164340              MOVE XLT00010-LOC-5-ABBR-NM TO PV-DC-5-CHAR-ABBR    16434013
164350         WHEN SQLWARN0 NOT = SPACES                               16435013
164360         WHEN SQLCODE NOT EQUAL ZERO                              16436013
164370                                                                  16437013
164380              INITIALIZE PV-CICS-MSG-AREA1                        16438013
164390              INITIALIZE PV-CICS-MSG-AREA2                        16439013
164400                                                                  16440013
164410              MOVE SQLCODE              TO PV-DISP-SQLCODE        16441013
164420              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             16442013
164430              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           16443013
164440              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        16444013
164450                                                                  16445013
164460              STRING  'SUKCS782 7150-'                            16446099
164470                      ' DC:'               PV-DISP-DC             16447013
164480                      ' B1:'               SU054-BAR-CODE-1       16448013
164490                      ' B2:'               SU054-BAR-CODE-2       16449013
164500                      ' B3:'               SU054-BAR-CODE-3       16450013
164510                                           DELIMITED BY SIZE      16451013
164520                                      INTO PV-CICS-MSG-AREA1      16452013
164530                                                                  16453013
164540              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16454013
164550              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     16455013
164560                                                                  16456013
164570              PERFORM 9999-WRITE-TO-CSSL                          16457013
164580                                                                  16458013
164590              STRING  'SUKCS782 '          SU054-KOHLS-SML        16459099
164600                      ' TRIP:'             PV-DISP-TRIP           16460013
164610                      ' DR:'               SU054-DOOR-NUMBER      16461013
164620                      ' USR:'              SU054-USER-ID          16462013
164630                      ' STA:'              PV-DISP-PNA-STA        16463013
164640                      ' SQL:'              PV-DISP-SQLCODE        16464013
164650                      ' XLT_LOC'                                  16465013
164660                                           DeLIMITED BY SIZE      16466013
164670                                      INTO PV-CICS-MSG-AREA2      16467013
164680                                                                  16468013
164690              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16469013
164700              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     16470013
164710                                                                  16471013
164720              PERFORM 9999-WRITE-TO-CSSL                          16472013
164730                                                                  16473013
164740              INITIALIZE PV-CICS-MSG-AREA3                        16474013
164750                                                                  16475013
164760              MOVE  XLT00010-LOC-NBR   TO PV-DISP-oper            16476013
164770                                                                  16477013
164780              STRING  'SUKCS782 '                                 16478099
164790                      ' oper:'             PV-DISP-oper           16479013
164800                                           DELIMITED BY SIZE      16480013
164810                                      INTO PV-CICS-MSG-AREA3      16481013
164820                                                                  16482013
164830              MOVE SPACES               TO PV-CICS-MSG-AREA-A     16483013
164840              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     16484013
164850                                                                  16485013
164860              PERFORM 9999-WRITE-TO-CSSL                          16486013
164870                                                                  16487013
164880             SET PS-PROCESSING-ERROR-YES TO TRUE                  16488013
164890             PERFORM 9998-WRITE-TO-CSSL                           16489013
164900     END-EVALUATE.                                                16490013
164910                                                                  16491013
164920*CLP 04/04/2014                                                   16492013
164930     IF PS-LOG-MESSAGE                                            16493013
164940        MOVE SPACE TO PV-CICS-MSG-AREA-A                          16494013
164950              MOVE XLT00010-LOC-NBR TO  PV-DISPLAY-STORE          16495013
164960        STRING 'SUKCS782  7150 '                                  16496099
164970             ' DC= '                                              16497013
164980               PV-DISPLAY-STORE                                   16498013
164990             ' ABBR= '                                            16499013
165000               PV-DC-5-CHAR-ABBR                                  16500013
165010             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B            16501013
165020             PERFORM 9999-WRITE-TO-CSSL                           16502013
165030     END-IF.                                                      16503013
165040                                                                  16504013
165050*----------------------------------------------------------------*16505013
165060*  GATHER LABEL INFORMATION                                      *16506013
165070*----------------------------------------------------------------*16507013
165080 7200-GATHER-LABEL-INFO.                                          16508013
165090*                                                                 16509013
165100** added internal table to track paragraph execution time         16510013
165110** dmh 2014-12-22 - begin                                         16511013
165120*                                                                 16512013
165130     MOVE  '7200'  TO  PT-CURR-PARA.                              16513013
165140     IF  PS-BLD-INTERNAL-TABLE-YES                                16514013
165150         PERFORM 0200-INTERNAL-TABLE                              16515013
165160     ELSE                                                         16516013
165170         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16517013
165180     END-IF.                                                      16518013
165190                                                                  16519013
165200*                                                                 16520013
165210** DMH 2014-12-22 - END                                           16521013
165220*                                                                 16522013
165230                                                                  16523013
165240     INITIALIZE DCLTLBPTDA.                                       16524013
165250                                                                  16525013
165260     MOVE  ZEROES                 TO  LBPTDA-PREPK-ID             16526013
165270                                      LBPTDA-PREPK-RATO-QTY       16527013
165280                                      LBPTDA-PREPK-UNT-QTY        16528013
165290                                      LBPTDA-CSE-PK-QTY           16529013
165300                                      LBPTDA-LBL-TYP-LBL-SEQ-ID   16530013
165310                                      LBPTDA-LBL-TYP-TOT-QTY      16531013
165320                                      LBPTDA-ITM-NBR.             16532013
165330     MOVE  SPACES                 TO  LBPTDA-MODU-DESC            16533013
165340                                      LBPTDA-ODD-CART-IND         16534013
165350                                      LBPTDA-STRG-AREA-CDE.       16535013
165360***                                                               16536013
165370     MOVE  SEASET-SEASET-NM        TO  LBPTDA-SEASET-NM.          16537013
165380     MOVE  PV-FIXTURE-ID           TO  LBPTDA-FIXT-ID.            16538013
165390     MOVE  'N'                     TO  LBPTDA-INPK-CNVYB-IND.     16539013
165400     MOVE  'S'                     TO  LBPTDA-CART-LBL-TYP-CDE.   16540013
165410     MOVE  PV-DEPT-DESC            TO  LBPTDA-DEPT-DESC.          16541013
165420     MOVE  PV-MAJ-CL-DESC          TO  LBPTDA-MAJ-CL-DESC.        16542013
165430     MOVE  PV-INNR-PACK-QTY        TO  LBPTDA-INPK-UNT-QTY.       16543013
165440     MOVE  PC160-BTCH-BARCODE      TO  LBPTDA-BRCDE-NBR.          16544013
165450                                                                  16545013
165460*gb 5/16/06 begin                                                 16546013
165470     MOVE PV-HNG-FOLD-SEQ-NBR      TO  LBPTDA-HNG-FOLD-SEQ-NBR    16547013
165480     MOVE PS-EAS-TAG-IND-FOUND-SW                                 16548013
165490                               TO LBPTDA-EAS-TAG-IND              16549013
165500     MOVE CNDCDR-DOOR-ID       TO LBPTDA-DOOR-ID                  16550013
165510*CLP 06/24/2015 START                                             16551013
165520     IF PS-BRAND-FOUND-YES                                        16552013
165530*       FIRST GET THE BUSINESS AREA DESC                          16553013
165540        PERFORM 6700-LINK-XLKUT073                                16554013
165550        MOVE 35 TO LBPTDA-LBL-MSG-TXT-LEN                         16555013
165560        PERFORM 7207-INSPECT-BUS-AREA                             16556013
165570        MOVE PV-BUS-AREA-BRAND TO LBPTDA-LBL-MSG-TXT-TEXT         16557013
165580*CLP 06/24/2015 END                                               16558013
165590     END-IF                                                       16559013
165600*gb 5/16/06 end                                                   16560013
165610** SLH 05/08     ADDED PV-REPURP-COUNT > 0 CHECK                  16561013
165620     IF PS-NOT-MULTI-LINE                                         16562013
165630        IF PS-OPER-IS-ECOMM-DS                                    16563013
165640               MOVE  'E'           TO  LBPTDA-CART-LBL-TYP-CDE    16564013
165650               MOVE   PV-SKU-OUT-9 TO  LBPTDA-ITM-NBR             16565013
165660        END-IF                                                    16566013
165670     ELSE                                                         16567013
165680        IF PS-OPER-IS-ECOMM-DC AND                                16568013
165690             PS-OPER-IS-ECOMM-DS AND                              16569013
165700               PV-REPURP-COUNT > 0                                16570013
165710               MOVE  PC-FLAT  TO XLT00010-LOC-10-ABBR-NM          16571013
165720        END-IF                                                    16572013
165730     END-IF                                                       16573013
165740                                                                  16574013
165750                                                                  16575013
165760     IF PS-ODD-UNT-CRTN-FOUND                                     16576013
165770        MOVE RECITM-PREPK-ID       TO LBPTDA-PREPK-ID             16577013
165780     END-IF                                                       16578013
165790                                                                  16579013
165800     IF PS-MULTI-LINE                                             16580013
165810        MOVE  '*MULTIPLE LINES*' TO  PV-VEND-STYL-NAME            16581013
165820     ELSE                                                         16582013
165830        IF PS-NO-LINE                                             16583013
165840           MOVE  '** NO LINE NUMBER **' TO  PV-VEND-STYL-NAME     16584013
165850        ELSE                                                      16585013
165860           PERFORM 7230-GET-DEPT-CL-SKU                           16586013
165870        END-IF                                                    16587013
165880     END-IF.                                                      16588013
165890                                                                  16589013
165900*----------------------------------------------------------------*16590013
165910*  INSERT ROW INTO LABEL TABLE FOR BATCH LABEL OPTION            *16591013
165920*----------------------------------------------------------------*16592013
165930 7205-INSERT-LABEL-TABLE.                                         16593013
165940*                                                                 16594013
165950** added internal table to track paragraph execution time         16595013
165960** dmh 2014-12-22 - begin                                         16596013
165970*                                                                 16597013
165980     MOVE  '7205'  TO  PT-CURR-PARA.                              16598013
165990     IF  PS-BLD-INTERNAL-TABLE-YES                                16599013
166000         PERFORM 0200-INTERNAL-TABLE                              16600013
166010     ELSE                                                         16601013
166020         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       16602013
166030     END-IF.                                                      16603013
166040                                                                  16604013
166050*                                                                 16605013
166060** DMH 2014-12-22 - END                                           16606013
166070*                                                                 16607013
166080                                                                  16608013
166090*CLP 04/08/14 START                                               16609013
166100     PERFORM 7150-CHECK-DC-LOC.                                   16610013
166110*CLP 04/08/14 END                                                 16611013
166120* CLP 06/20/13 PR5148B START - MOVED THIS TO TOP OF PARA 11/11/13 16612013
166130     IF PS-RFID-ON-LABEL-YES                                      16613013
166140         IF SU093-PRINT-RFID                                      16614061
166150             MOVE 'RD'  TO LBPTDA-PRC-MSG-CDE                     16615020
166160         ELSE                                                     16616061
166170             IF SU093-PRINT-EAS                                   16617061
166180                 MOVE 'EA'  TO LBPTDA-PRC-MSG-CDE                 16618061
166190             ELSE                                                 16619061
166200                 IF SU093-PRINT-RFID-EAS                          16620061
166210                     MOVE 'RE'  TO LBPTDA-PRC-MSG-CDE             16621061
166220                 ELSE                                             16622061
166230                     MOVE SPACE TO LBPTDA-PRC-MSG-CDE             16623061
166240                 END-IF                                           16624061
166250             END-IF                                               16625061
166260         END-IF                                                   16626061
166270         MOVE  LBPTDA-PRC-MSG-CDE TO PV-PRC-MSG-CDE               16627061
166280     ELSE                                                         16628061
166290         MOVE SPACE TO LBPTDA-PRC-MSG-CDE                         16629061
166300     END-IF.                                                      16630027
166310* CLP 06/20/13 PR5148B END                                        16631013
166320                                                                  16632013
166330     MOVE  PV-CTN-N               TO  LBPTDA-SHIPT-UNT-ID.        16633013
166340     MOVE  SU054-TRIP-ID          TO  LBPTDA-TRIP-ID.             16634013
166350     MOVE  SU054-ACCM-LINE-NMBR   TO  LBPTDA-PRTR-ID.             16635013
166360     MOVE  PV-BATCH-NUMBER        TO  LBPTDA-LBL-PRT-BTCH-ID.     16636013
166370     MOVE  RECEIV-CURR-OPER-UNT-ID TO  LBPTDA-OPER-UNT-ID.        16637013
166380     MOVE  +1                     TO  LBPTDA-FCLTY-ID.            16638013
166390     MOVE  PV-PO-NBR              TO  LBPTDA-PO-NBR.              16639013
166400     IF PS-AUTO-VE-YES AND SU044-NEW-REC-SEQ-NBR > 0              16640013
166410        MOVE SU044-NEW-REC-SEQ-NBR TO LBPTDA-RCVR-SEQ-NBR         16641013
166420     ELSE                                                         16642013
166430        MOVE PV-RCVR-SEQ-NBR      TO  LBPTDA-RCVR-SEQ-NBR         16643013
166440     END-IF                                                       16644013
166450* ekta                                                            16645013
166460     IF PS-WHSE-OTBND-CART-YES                                    16646013
166470        IF PS-RFID-ON-LABEL-YES                                   16647013
166480             MOVE 'REPL RFID'      TO LBPTDA-BRCDE-NBR            16648013
166490        ELSE                                                      16649013
166500             MOVE DK-SML-BARCODE   TO LBPTDA-BRCDE-NBR            16650013
166510        END-IF                                                    16651013
166520        MOVE SUT00028-TRN-NBR      TO LBPTDA-PO-NBR               16652013
166530        MOVE SUT00028-TRN-LNE-NBR  TO LBPTDA-PO-LNE-NBR           16653013
166540        MOVE SU054-DOOR-NUMBER     TO LBPTDA-DOOR-ID              16654013
166550        SET SU021-AUDIT-IS-COMPLETE TO TRUE                       16655013
166560*CLP 10/29/13 START                                               16656013
166570        SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE                  16657013
166580*CLP 10/29/13   END                                               16658013
166590        MOVE  3  TO PV-HNG-FOLD-SEQ-NBR                           16659013
166600        MOVE  0  TO PV-BUS-AREA-ID                                16660013
166610     ELSE                                                         16661013
166620        MOVE  SHUUPC-TRN-LNE-NBR     TO  LBPTDA-PO-LNE-NBR        16662013
166630     END-IF                                                       16663013
166640*    MOVE  SHUUPC-TRN-LNE-NBR     TO  LBPTDA-PO-LNE-NBR.          16664013
166650* ekta                                                            16665013
166660     MOVE  PV-DEST-STORE          TO  LBPTDA-DEST-OPER-UNT-ID.    16666013
166670     MOVE  SU054-DC-NUMBER        TO  LBPTDA-MISDIR-OPER-UNT-ID.  16667013
166680     MOVE  PV-2-DIGIT-DC-ABBR     TO  LBPTDA-DC-PRTD-AT-CDE.      16668013
166690     MOVE  PV-OUTR-PACK-QTY       TO  LBPTDA-OTPK-UNT-QTY.        16669013
166700     MOVE  PV-HNG-FOLD-SEQ-NBR    TO  LBPTDA-HNG-FOLD-SEQ-NBR.    16670013
166710*                                                                 16671013
166720     IF PS-LOG-MESSAGE                                            16672013
166730        MOVE SPACE TO PV-CICS-MSG-AREA-A                          16673013
166740        STRING 'SUKCS782  7205 '                                  16674099
166750             ' CART= '                                            16675013
166760               PV-CTN-N                                           16676013
166770             ' AB= '                                              16677013
166780               PV-2-DIGIT-DC-ABBR                                 16678013
166790             ' COMB SW=   '                                       16679013
166800               PS-RFID-QC-AUD-CMB-IND                             16680013
166810             ' RF SW= '                                           16681013
166820               SU021-RFID-AUDIT-VALIDATION-SW                     16682013
166830             ' AUD SW= '                                          16683013
166840               SU021-AUDIT-VALIDATION-SW                          16684013
166850             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B            16685013
166860             PERFORM 9999-WRITE-TO-CSSL                           16686013
166870     END-IF                                                       16687013
166880                                                                  16688013
166890*    IF CASEPACK WAS NOT DONE PRIOR - VALUE WASNT INITIALIZED     16689013
166900                                                                  16690013
166910     IF SU021-AUDIT-NUMBER IS NOT NUMERIC                         16691013
166920         MOVE 0 TO SU021-AUDIT-NUMBER                             16692013
166930     END-IF.                                                      16693013
166940     IF SU021-RFID-AUDIT-NUMBER IS NOT NUMERIC                    16694013
166950         MOVE 0 TO SU021-RFID-AUDIT-NUMBER                        16695013
166960     END-IF.                                                      16696013
166970                                                                  16697013
166980*    FIRST SET TO QC, THEN FUTHER CHECK                           16698013
166990     MOVE  SU021-AUDIT-VALIDATION-SW                              16699013
167000                                  TO  LBPTDA-CART-ACTN-CDE        16700013
167010     EVALUATE TRUE                                                16701013
167020       WHEN SU021-AUDIT-REQUIRED  AND SU021-RFID-AUDIT-REQUIRED   16702013
167030         MOVE 'Q' TO LBPTDA-CART-ACTN-CDE                         16703013
167040         MOVE 'QR' TO LBPTDA-PRC-MSG-CDE                          16704050
167050       WHEN SU021-AUDIT-REQUIRED                                  16705013
167060           MOVE  SU021-AUDIT-VALIDATION-SW                        16706013
167070                                     TO  LBPTDA-CART-ACTN-CDE     16707013
167080       WHEN SU021-RFID-AUDIT-REQUIRED                             16708013
167090            MOVE 'RA' TO LBPTDA-PRC-MSG-CDE                       16709013
167100            MOVE  SU021-RFID-AUDIT-VALIDATION-SW                  16710013
167110                                     TO  LBPTDA-CART-ACTN-CDE     16711013
167120       WHEN NOT SU021-AUDIT-IS-COMPLETE                           16712013
167130           MOVE  SU021-AUDIT-VALIDATION-SW                        16713013
167140                                  TO  LBPTDA-CART-ACTN-CDE        16714013
167150       WHEN NOT SU021-RFID-AUDIT-IS-COMPLETE                      16715013
167160           MOVE  SU021-RFID-AUDIT-VALIDATION-SW                   16716013
167170                                  TO  LBPTDA-CART-ACTN-CDE        16717013
167180                                                                  16718013
167190     END-EVALUATE.                                                16719013
167200*CLP 10/29/13   - END                                             16720013
167210                                                                  16721013
167220     MOVE  PV-BUS-AREA-ID         TO  LBPTDA-BUS-AREA-ID.         16722013
167230     MOVE  PV-SKU-NBR-LBL         TO  LBPTDA-SKU-NBR.             16723013
167240                                                                  16724013
167250     IF PS-MULTI-LINE                                             16725013
167260         IF LBVRDA-PREPK-ID > 0 OR                                16726013
167270            PS-ECOMM-DC-REPURPOSE                                 16727013
167280            CONTINUE                                              16728013
167290         ELSE                                                     16729013
167300            MOVE ZEROES               TO  LBPTDA-PO-LNE-NBR       16730013
167310                                          XL001-SKU-NBR           16731013
167320                                          LBPTDA-SKU-NBR          16732013
167330            MOVE SPACES               TO  PV-DEPT-NUMBER          16733013
167340                                          PV-CL-NBR               16734013
167350                                          XL001-DEPT-NBR-3CH      16735013
167360                                          XL001-SUB-CL-NBR-2CH    16736013
167370         END-IF                                                   16737013
167380     END-IF.                                                      16738013
167390                                                                  16739013
167400     MOVE  SPACE                 TO  LBPTDA-SU-FRE-ASTRA-IND      16740013
167410     IF PS-DUPLICATE-CARTON                                       16741013
167420         MOVE 'F'               TO  LBPTDA-CART-LBL-TYP-CDE       16742013
167430         MOVE 'DUP CARTN'       TO  LBPTDA-BRCDE-NBR              16743013
167440     ELSE                                                         16744013
167450     IF  PS-NOT-CRTN-ATT-TO-RCVR                                  16745013
167460          IF SU044-NEW-REC-SEQ-NBR > 0 OR                         16746013
167470             PKSLIP-CRE-SRC-CDE = PC-FA                           16747013
167480             MOVE 'C'               TO  LBPTDA-SU-FRE-ASTRA-IND   16748013
167490          ELSE                                                    16749013
167500             MOVE 'R'               TO  LBPTDA-SU-FRE-ASTRA-IND   16750013
167510          END-IF                                                  16751013
167520          MOVE 'F'               TO  LBPTDA-CART-LBL-TYP-CDE      16752013
167530          IF RC040-PROCESS-MSDIRCT-YES                            16753013
167540             MOVE 'PBS MSDRT'       TO  LBPTDA-BRCDE-NBR          16754013
167550          ELSE                                                    16755013
167560             MOVE 'FREE ASTY'       TO  LBPTDA-BRCDE-NBR          16756013
167570          END-IF                                                  16757013
167580     ELSE                                                         16758013
167590     IF  PS-NOT-CRTN-ATT-TO-TRIP                                  16759013
167600          IF SU044-NEW-REC-SEQ-NBR > 0 OR                         16760013
167610             PKSLIP-CRE-SRC-CDE = PC-FA                           16761013
167620             MOVE 'A'               TO  LBPTDA-SU-FRE-ASTRA-IND   16762013
167630          ELSE                                                    16763013
167640             MOVE 'T'               TO  LBPTDA-SU-FRE-ASTRA-IND   16764013
167650          END-IF                                                  16765013
167660          MOVE 'F'               TO  LBPTDA-CART-LBL-TYP-CDE      16766013
167670          IF RC040-PROCESS-MSDIRCT-YES                            16767013
167680             MOVE 'PBS MSDRT'       TO  LBPTDA-BRCDE-NBR          16768013
167690          ELSE                                                    16769013
167700             MOVE 'FREE ASTY'       TO  LBPTDA-BRCDE-NBR          16770013
167710          END-IF                                                  16771013
167720     END-IF                                                       16772013
167730     END-IF                                                       16773013
167740     END-IF.                                                      16774013
167750                                                                  16775013
167760     MOVE   XLT00010-LOC-10-ABBR-NM TO LBPTDA-STR-NM              16776013
167770                                                                  16777013
167780     EVALUATE TRUE                                                16778013
167790        WHEN PS-PROCESSING-ERROR-YES                              16779013
167800             IF  PS-SML-UCC128-MISMATCH                           16780013
167810                 MOVE 'LBL MSMCH'     TO  LBPTDA-BRCDE-NBR        16781013
167820             ELSE                                                 16782013
167830                 MOVE 'SYSTM ERR'     TO  LBPTDA-BRCDE-NBR        16783013
167840             END-IF                                               16784013
167850        WHEN PS-BRCDE-ERROR-FND                                   16785013
167860          MOVE 'MULT BRCD'            TO  LBPTDA-BRCDE-NBR        16786013
167870        WHEN PS-NO-VALID-BRCDES-FND                               16787013
167880             IF  PS-SML-UCC128-MISMATCH                           16788013
167890                 MOVE 'LBL MSMCH'     TO  LBPTDA-BRCDE-NBR        16789013
167900             ELSE                                                 16790013
167910                 MOVE 'NOT FOUND'     TO  LBPTDA-BRCDE-NBR        16791013
167920             END-IF                                               16792013
167930        WHEN PS-SML-UCC128-MISMATCH                               16793013
167940          MOVE 'LBL MSMCH'            TO  LBPTDA-BRCDE-NBR        16794013
167950        WHEN PS-MULT-SSCC-YES                                     16795013
167960          MOVE 'MULT SSCC'            TO  LBPTDA-BRCDE-NBR        16796013
167970        WHEN PS-INPK-CNVYB-FOUND-YES                              16797013
167980          MOVE 'INPK ERR '            TO  LBPTDA-BRCDE-NBR        16798013
167990        WHEN PS-RECITM-VERIFIED-LINES-YES                         16799013
168000          MOVE 'VRFD LNES'            TO  LBPTDA-BRCDE-NBR        16800013
168010        WHEN PS-UCC128-PKSLIP-ERROR-YES                           16801013
168020          MOVE 'D'                    TO  LBPTDA-SU-FRE-ASTRA-IND 16802013
168030          MOVE '128 ERROR'            TO  LBPTDA-BRCDE-NBR        16803013
168040        WHEN PS-UCC128-PKSLIP-ERROR-YES                           16804013
168050          MOVE 'D'                    TO  LBPTDA-SU-FRE-ASTRA-IND 16805013
168060          MOVE '128 ERROR'            TO  LBPTDA-BRCDE-NBR        16806013
168070        WHEN PS-ECOMM-DC-REPURPOSE                                16807013
168080          PERFORM 2100-GET-ZONE-DESC                              16808013
168090          PERFORM 7055-CHECK-TKRPRPM-REPURP-LOC                   16809013
168100          MOVE KRPRPM-FUNC-TXT        TO  LBPTDA-BRCDE-NBR        16810013
168110          MOVE 'R'                    TO  LBPTDA-CART-LBL-TYP-CDE 16811013
168120          MOVE 'EC REPR'              TO  LBPTDA-MODU-DESC        16812013
168130          IF PS-WEIGHTS-MEAUSURES-CHECK                           16813013
168140             MOVE 'M'                 TO  LBPTDA-SU-MSSG-DAT-IND  16814013
168150          END-IF                                                  16815013
168160          MOVE PV-PREPK-ID            TO  LBPTDA-PREPK-ID         16816013
168170        WHEN PS-UCC128-PKSLIP-ERROR-YES                           16817013
168180          MOVE 'D'                    TO  LBPTDA-SU-FRE-ASTRA-IND 16818013
168190          MOVE '128 ERROR'            TO  LBPTDA-BRCDE-NBR        16819013
168200        WHEN PS-INACTV-PBS-CARTON-YES                             16820013
168210          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 16821013
168220                                          LBPTDA-SU-MSSG-DAT-IND  16822013
168230          IF  PS-NOT-CRTN-ATT-TO-RCVR OR                          16823013
168240              PS-NOT-CRTN-ATT-TO-TRIP                             16824013
168250                MOVE 'F A PBS E'            TO  LBPTDA-BRCDE-NBR  16825013
168260          ELSE                                                    16826013
168270                MOVE 'PBS ERROR'            TO  LBPTDA-BRCDE-NBR  16827013
168280          END-IF                                                  16828013
168290                                                                  16829013
168300          MOVE '*** INACTIVATED ***'  TO  LBPTDA-DEPT-DESC        16830013
168310          MOVE  PV-TSHUNLO-PBS-TMST-R TO  LBPTDA-MAJ-CL-DESC      16831013
168320        WHEN PS-TROUBLE-FOUND                                     16832013
168330          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 16833013
168340          MOVE 'PBS TRBL '            TO  LBPTDA-BRCDE-NBR        16834013
168350                                                                  16835013
168360        WHEN PS-PBS-RTV-ALLOC                                     16836013
168370          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 16837013
168380          MOVE 'PBS RTV  '            TO  LBPTDA-BRCDE-NBR        16838013
168390        WHEN PS-PBS-RTV-NO-ALLOC                                  16839013
168400          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 16840013
168410          MOVE 'NO ALLOC '            TO  LBPTDA-BRCDE-NBR        16841013
168420                                                                  16842013
168430        WHEN PS-PBS-CRTN-RCVR-MISMTCH-YES                         16843013
168440          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 16844013
168450          MOVE 'RC NT PBS'            TO  LBPTDA-BRCDE-NBR        16845013
168460                                                                  16846013
168470        WHEN PS-NO-CASEPK-FND                                     16847013
168480          MOVE 'NO CASEPK'         TO  LBPTDA-BRCDE-NBR           16848013
168490          MOVE 'I'                    TO  LBPTDA-CART-LBL-TYP-CDE 16849013
168500          MOVE PS-MESSG-LBL-IND TO        LBPTDA-SU-MSSG-DAT-IND  16850013
168510        WHEN PS-PRINT-AUDIT-LABEL                                 16851013
168520          MOVE 'Q'               TO  LBPTDA-CART-LBL-TYP-CDE      16852013
168530*CLP 10/29/13 - START                                             16853013
168540          IF LBPTDA-PRC-MSG-CDE = PC-QR                           16854013
168550              MOVE 'COMBO    '           TO  LBPTDA-BRCDE-NBR     16855013
168560          ELSE                                                    16856013
168570              IF LBPTDA-PRC-MSG-CDE = PC-RA                       16857013
168580                  MOVE 'RF ONLY  '       TO  LBPTDA-BRCDE-NBR     16858013
168590              ELSE                                                16859013
168600                  MOVE 'QCAUDIT '        TO  LBPTDA-BRCDE-NBR     16860013
168610              END-IF                                              16861013
168620          END-IF                                                  16862013
168630*CLP 10/29/13 - END                                               16863013
168640                                                                  16864013
168650        WHEN PS-WRONG-FCLTY                                       16865013
168660        WHEN PS-ECOMM-STORE-NO-RCVR                               16866013
168670          MOVE 'W'               TO  LBPTDA-CART-LBL-TYP-CDE      16867013
168680          MOVE 'Y'               TO  LBPTDA-SU-MISDIR-IND         16868013
168690          MOVE 'MISDIRECT'       TO  LBPTDA-BRCDE-NBR             16869013
168700     END-EVALUATE                                                 16870013
168710                                                                  16871013
168720     IF PS-ODD-UNT-CRTN-FOUND                                     16872013
168730          MOVE 'O'               TO  LBPTDA-CART-LBL-TYP-CDE      16873013
168740          MOVE 'ODD UNITS'       TO  LBPTDA-BRCDE-NBR             16874013
168750          MOVE 'Y'               TO  LBPTDA-ODD-CART-IND          16875013
168760          MOVE SPACES            TO  PV-VEND-STYL-NAME            16876013
168770     END-IF                                                       16877013
168780                                                                  16878013
168790*CLP 10/29/13 - BEGIN PR#5418D                                    16879013
168800     IF SU021-AUDIT-REQUIRED OR                                   16880013
168810        SU021-RFID-AUDIT-REQUIRED                                 16881013
168820        MOVE  'S'                TO  LBPTDA-CART-LBL-TYP-CDE      16882013
168830        IF PS-LOG-MESSAGE                                         16883013
168840           STRING 'SUKCS782  7205-'                               16884099
168850              ' AUD NUM = '                                       16885013
168860               SU021-AUDIT-NUMBER                                 16886013
168870              ' RF AUD NUM = '                                    16887013
168880              SU021-RFID-AUDIT-NUMBER                             16888013
168890              DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B           16889013
168900              PERFORM 9999-WRITE-TO-CSSL                          16890013
168910        END-IF                                                    16891013
168920                                                                  16892013
168930        MOVE  SU021-AUDIT-NUMBER TO  LBPTDA-BRCDE-NBR             16893013
168940        IF NOT SU021-AUDIT-REQUIRED AND                           16894013
168950                SU021-RFID-AUDIT-REQUIRED                         16895013
168960            MOVE  SU021-RFID-AUDIT-NUMBER TO  LBPTDA-BRCDE-NBR    16896013
168970        END-IF                                                    16897013
168980     END-IF                                                       16898013
168990*CLP 10/29/13 -   END PR#5418D                                    16899013
169000                                                                  16900013
169010     MOVE LBPTDA-CART-LBL-TYP-CDE TO PV-HOLD-LBL-TYP-CDE.         16901013
169020     IF  PS-REPRINT                                               16902013
169030           MOVE PS-REPRINT-IND   TO     LBPTDA-RPRT-IND.          16903013
169040                                                                  16904013
169050                                                                  16905013
169060* 07/19/13 RLK BEG                                                16906013
169070* IF DC USES RFID CARTON LABEL INSTEAD OF NORMAL SML LABEL        16907013
169080* AN INACTIVE ROW IS WRITTEN TO THE TSHUNLO TABLE.                16908013
169090* IF THIS IS A REPRINT AND THE RFID FINAL LABEL HAS BEEN          16909013
169100* PRINTED, THEN, A REGULEAR SML LABEL IS PRINTED, OTHERWISE       16910013
169110* AN RFID CARTON LABEL IS PRINTED.                                16911013
169120     IF PS-WHSE-OTBND-CART-YES                                    16912013
169130       NEXT SENTENCE                                              16913013
169140     ELSE                                                         16914013
169150*CLP 10/29/13 BEGIN                                               16915013
169160     IF SU021-AUDIT-REQUIRED OR                                   16916013
169170        SU021-RFID-AUDIT-REQUIRED                                 16917013
169180*CLP 10/29/13 END                                                 16918013
169190       IF PS-DC-USE-RFID-CART-LBL-YES                             16919013
169200         PERFORM 2275-INSERT-CRTN-LBL-TSHUNLO                     16920013
169210       END-IF                                                     16921013
169220     ELSE                                                         16922013
169230     IF  PS-REPRINT                                               16923013
169240*      AND PS-DC-USE-RFID-CART-LBL-YES                            16924013
169250        MOVE PV-CTN-N           TO SHPUNT-SHIPT-UNT-ID            16925013
169260        PERFORM 2262-SELECT-CRTN-LBL-TSHUNLO                      16926013
169270       IF SHUNLO-SCN-LOC-ID = PC-RFDC                             16927013
169280         SET PS-DC-USE-RFID-CART-LBL-YES TO TRUE                  16928013
169290         PERFORM 3807-DETERMINE-CRTN-LBL                          16929063
169300**       PERFORM 3808-TKRPRPM-RFID-LBL-INFO                       16930063
169310         MOVE KRPRPM-FUNC-TXT (1:6) TO LBPTDA-MODU-DESC           16931013
169320         MOVE KRPRPM-FUNC-TXT (7:4) TO PV-RFID-DIVERT-CDE         16932013
169330         MOVE PV-RFID-DIVERT-CDE    TO PV-22-CRTN-DIVERT-CDE      16933013
169340         MOVE 0                     TO PV-22-CRTN-TYPE-IND        16934013
169350         MOVE LBPTDA-PO-NBR         TO PV-22-CRTN-PO-NBR          16935013
169360         MOVE LBPTDA-RCVR-SEQ-NBR   TO PV-22-CTRN-RCVR-SEQ-NBR    16936013
169370         MOVE LBPTDA-PO-LNE-NBR     TO PV-22-CRTN-PO-LNE-NBR      16937013
169371* RPK 2018-05-09 - BEGIN                                          16937168
169372         PERFORM 3812-LAST-4-OF-BARCODE-PARM                      16937269
169373         IF  PS-USE-LAST-4-FROM-TMST                              16937369
169374             MOVE PV-CURRENT-TMST-R-LAST-4                        16937469
169380                                    TO PV-22-CRTN-CART-NBR        16938068
169381         ELSE                                                     16938169
169382             MOVE 0000 TO PV-22-CRTN-CART-NBR                     16938269
169383         END-IF                                                   16938369
169384* RPK 2018-05-09 - END                                            16938468
169390         MOVE LBPTDA-SHIPT-UNT-ID   TO DK-CTN                     16939013
169400         MOVE PV-22-DIGIT-BARCODE TO LBPTDA-BRCDE-NBR             16940013
169410                                     DK-BARCODE-NBR               16941013
169420         MOVE 'D'                   TO LBPTDA-CART-LBL-TYP-CDE    16942013
169430                                       DK-CART-LBL-TYP-CDE        16943013
169440         MOVE LBVRDA-DEST-OPER-UNT-ID TO DK-DEST-OPER-UNT-ID      16944013
169450       END-IF                                                     16945013
169460     ELSE                                                         16946013
169470         PERFORM 3807-DETERMINE-CRTN-LBL                          16947061
169480       IF  PS-LABEL-PARM-FOUND                                    16948061
169490       AND PS-DC-USE-RFID-CART-LBL-YES                            16949063
169500**       PERFORM 3807-DETERMINE-CRTN-LBL                          16950061
169510**       PERFORM 3808-TKRPRPM-RFID-LBL-INFO                       16951037
169520         MOVE KRPRPM-FUNC-TXT (1:6) TO LBPTDA-MODU-DESC           16952013
169530         MOVE KRPRPM-FUNC-TXT (7:4) TO PV-RFID-DIVERT-CDE         16953013
169540         MOVE PV-RFID-DIVERT-CDE    TO PV-22-CRTN-DIVERT-CDE      16954013
169550         MOVE 0                     TO PV-22-CRTN-TYPE-IND        16955013
169560         MOVE LBPTDA-PO-NBR         TO PV-22-CRTN-PO-NBR          16956013
169570         MOVE LBPTDA-RCVR-SEQ-NBR   TO PV-22-CTRN-RCVR-SEQ-NBR    16957013
169580         MOVE LBPTDA-PO-LNE-NBR     TO PV-22-CRTN-PO-LNE-NBR      16958013
169581* RPK 2018-05-09 - BEGIN                                          16958168
169582         PERFORM 3812-LAST-4-OF-BARCODE-PARM                      16958269
169583         IF  PS-USE-LAST-4-FROM-TMST                              16958369
169584             MOVE PV-CURRENT-TMST-R-LAST-4                        16958469
169585                                    TO PV-22-CRTN-CART-NBR        16958569
169586         ELSE                                                     16958669
169587             MOVE 0000 TO PV-22-CRTN-CART-NBR                     16958769
169588         END-IF                                                   16958869
169591* RPK 2018-05-09 - END                                            16959168
169600         MOVE LBPTDA-SHIPT-UNT-ID   TO DK-CTN                     16960013
169610         MOVE PV-22-DIGIT-BARCODE TO LBPTDA-BRCDE-NBR             16961013
169620                                     DK-BARCODE-NBR               16962013
169630         MOVE 'D'                   TO LBPTDA-CART-LBL-TYP-CDE    16963013
169640                                       DK-CART-LBL-TYP-CDE        16964013
169650         MOVE LBVRDA-DEST-OPER-UNT-ID TO DK-DEST-OPER-UNT-ID      16965013
169660         PERFORM 2275-INSERT-CRTN-LBL-TSHUNLO                     16966013
169670       END-IF                                                     16967013
169680     END-IF                                                       16968013
169690     END-IF                                                       16969013
169700     END-IF                                                       16970013
169710     IF PS-LOG-MESSAGE                                            16971013
169720        STRING 'SUKCS782  7205-'                                  16972099
169730*            ' BC= '                                              16973013
169740*             LBPTDA-BRCDE-NBR                                    16974013
169750             ' RFID-CRT-LBL-SW = '                                16975013
169760             PS-DC-USE-RFID-CART-LBL-SW                           16976013
169770             ' RFIDON-LBL-SW = '                                  16977013
169780             PS-RFID-ON-LABEL-SW                                  16978013
169790             ' DPT-IN-SW = '                                      16979013
169800             SU093-RFID-KOHL-DPT-IN-STR-SW                        16980013
169810             ' FN-TXT= '                                          16981013
169820             KRPRPM-FUNC-TXT                                      16982013
169830            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B             16983013
169840            PERFORM 9999-WRITE-TO-CSSL                            16984013
169850     END-IF.                                                      16985013
169860     IF PS-LOG-MESSAGE                                            16986013
169870        MOVE SPACE TO PV-CICS-MSG-AREA-B                          16987013
169880        STRING 'SUKCS782  7205-B '                                16988099
169890             ' PRC-MSG-CD '                                       16989013
169900              LBPTDA-PRC-MSG-CDE                                  16990013
169910             ' CMB-IND = '                                        16991013
169920              PS-RFID-QC-AUD-CMB-IND                              16992013
169930            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B             16993013
169940            PERFORM 9999-WRITE-TO-CSSL                            16994013
169950     END-IF.                                                      16995013
169960* 07/19/13 RLK END                                                16996013
169961                                                                  16996184
169967                                                                  16996784
169968     PERFORM 7205B-INSERT-LABEL-TABLE.                            16996885
172960                                                                  17296013
172961                                                                  17296185
172962*----------------------------------------------------------------*17296285
172963*  INSERT ROW INTO LABEL TABLE FOR BATCH LABEL OPTION            *17296385
172964*----------------------------------------------------------------*17296485
172965 7205B-INSERT-LABEL-TABLE.                                        17296585
172968                                                                  17296885
172969     MOVE  '720B'  TO  PT-CURR-PARA.                              17296990
172970     IF  PS-BLD-INTERNAL-TABLE-YES                                17297085
172971         PERFORM 0200-INTERNAL-TABLE                              17297185
172972     ELSE                                                         17297285
172973         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       17297385
172974     END-IF.                                                      17297485
172975                                                                  17297585
173390                                                                  17339085
173391     EXEC SQL                                                     17339185
173392         INSERT INTO TLBPTDA                                      17339285
173393                ( TRIP_ID                                         17339385
173394                , CRE_USR_ID                                      17339485
173395                , LBL_PRT_BTCH_ID                                 17339585
173396                , SHIPT_UNT_ID                                    17339685
173397                , OPER_UNT_ID                                     17339785
173398                , FCLTY_ID                                        17339885
173399                , CRE_TMST                                        17339985
173400                , OWNR_SCAC_ID                                    17340085
173401                , VEH_NBR                                         17340185
173402                , RPRT_IND                                        17340285
173403                , SU_DUP_LBL_IND                                  17340385
173404                , SU_FRE_ASTRA_IND                                17340485
173405                , SU_MSSG_DAT_IND                                 17340585
173406                , SU_MISDIR_IND                                   17340685
173407                , MISDIR_OPER_UNT_ID                              17340785
173408                , PO_NBR                                          17340885
173409                , RCVR_SEQ_NBR                                    17340985
173410                , PO_LNE_NBR                                      17341085
173411                , DEST_OPER_UNT_ID                                17341185
173412                , STR_NM                                          17341285
173413                , STR_ZN_ID                                       17341385
173414                , SKU_DEPT_NBR                                    17341485
173415                , SKU_CL_NBR                                      17341585
173416                , VS_NBR                                          17341685
173417                , OTPK_UNT_QTY                                    17341785
173418                , INPK_UNT_QTY                                    17341885
173419                , PRTR_ID                                         17341985
173420                , BRCDE_NBR                                       17342085
173421                , DC_PRTD_AT_CDE                                  17342185
173422                , INVLD_DAT_ERR_CDE                               17342285
173423                , PREPK_ID                                        17342385
173424                , PREPK_RATO_QTY                                  17342485
173425                , PREPK_UNT_QTY                                   17342585
173426                , CSE_PK_QTY                                      17342685
173427                , ODD_CART_IND                                    17342785
173428                , INPK_CNVYB_IND                                  17342885
173429                , LBL_TYP_LBL_SEQ_ID                              17342985
173430                , LBL_TYP_TOT_QTY                                 17343085
173431                , MODU_DESC                                       17343185
173432                , ITM_NBR                                         17343285
173433                , DEPT_DESC                                       17343385
173434                , MAJ_CL_DESC                                     17343485
173435                , SEASET_NM                                       17343585
173436                , FIXT_ID                                         17343685
173437                , CART_LBL_TYP_CDE                                17343785
173438                , STRG_AREA_CDE                                   17343885
173439                , CART_ACTN_CDE                                   17343985
173440                , HNG_FOLD_SEQ_NBR                                17344085
173441                , BUS_AREA_ID                                     17344185
173442                , SKU_NBR                                         17344285
173443*CLP 06/24/2015 START                                             17344385
173444                , LBL_MSG_TXT                                     17344485
173445*CLP 06/24/2015 END                                               17344585
173446*               , MDSE_SET_CMNT                                   17344685
173447                , EAS_TAG_IND                                     17344785
173448                , DOOR_ID                                         17344885
173449                , PRC_MSG_CDE)                                    17344985
173450         VALUES                                                   17345085
173451                ( :LBPTDA-TRIP-ID                                 17345185
173452                , :SU054-USER-ID                                  17345285
173453                , 0                                               17345385
173454*               , :LBPTDA-LBL-PRT-BTCH-ID                         17345485
173455                , :LBPTDA-SHIPT-UNT-ID                            17345585
173456                , :LBPTDA-OPER-UNT-ID                             17345685
173457                , :LBPTDA-FCLTY-ID                                17345785
173458                ,  CURRENT TIMESTAMP                              17345885
173459                , :VHTRIP-OWNER-SCAC-ID                           17345985
173460                , :VHTRIP-VEH-NBR                                 17346085
173461                , :LBPTDA-RPRT-IND                                17346185
173462                , :PV-DUPLICATE-IND                               17346285
173463                , :LBPTDA-SU-FRE-ASTRA-IND                        17346385
173464                , :LBPTDA-SU-MSSG-DAT-IND                         17346485
173465                , :LBPTDA-SU-MISDIR-IND                           17346585
173466                , :LBPTDA-MISDIR-OPER-UNT-ID                      17346685
173467                , :LBPTDA-PO-NBR                                  17346785
173468                , :LBPTDA-RCVR-SEQ-NBR                            17346885
173469                , :LBPTDA-PO-LNE-NBR                              17346985
173470                , :LBPTDA-DEST-OPER-UNT-ID                        17347085
173471                , :LBPTDA-STR-NM                                  17347185
173472                , :LBPTDA-STR-ZN-ID                               17347285
173473                , :XL001-DEPT-NBR-3CH                             17347385
173474                , :XL001-SUB-CL-NBR-2CH                           17347485
173475                , :PV-VEND-STYL-NAME                              17347585
173476                , :LBPTDA-OTPK-UNT-QTY                            17347685
173477                , :LBPTDA-INPK-UNT-QTY                            17347785
173478                , :LBPTDA-PRTR-ID                                 17347885
173479                , :LBPTDA-BRCDE-NBR                               17347985
173480                , :LBPTDA-DC-PRTD-AT-CDE                          17348085
173481                , :LBPTDA-INVLD-DAT-ERR-CDE                       17348185
173482                , :LBPTDA-PREPK-ID                                17348285
173483                , :LBPTDA-PREPK-RATO-QTY                          17348385
173484                , :LBPTDA-PREPK-UNT-QTY                           17348485
173485                , :LBPTDA-CSE-PK-QTY                              17348585
173486                , :LBPTDA-ODD-CART-IND                            17348685
173487                , :LBPTDA-INPK-CNVYB-IND                          17348785
173488                , :LBPTDA-LBL-TYP-LBL-SEQ-ID                      17348885
173489                , :LBPTDA-LBL-TYP-TOT-QTY                         17348985
173490                , :LBPTDA-MODU-DESC                               17349085
173491                , :LBPTDA-ITM-NBR                                 17349185
173492                , :LBPTDA-DEPT-DESC                               17349285
173493                , :LBPTDA-MAJ-CL-DESC                             17349385
173494                , :LBPTDA-SEASET-NM                               17349485
173495                , :LBPTDA-FIXT-ID                                 17349585
173496                , :LBPTDA-CART-LBL-TYP-CDE                        17349685
173497                , :LBPTDA-STRG-AREA-CDE                           17349785
173498                , :LBPTDA-CART-ACTN-CDE                           17349885
173499                , :LBPTDA-HNG-FOLD-SEQ-NBR                        17349985
173500                , :LBPTDA-BUS-AREA-ID                             17350085
173501                , :LBPTDA-SKU-NBR                                 17350185
173502*CLP 06/24/2015 START                                             17350285
173503                , :LBPTDA-LBL-MSG-TXT                             17350385
173504*CLP 06/24/2015 END                                               17350485
173505*               , :LBPTDA-MDSE-SET-CMNT-TEXT                      17350585
173506                , :LBPTDA-EAS-TAG-IND                             17350685
173507                , :LBPTDA-DOOR-ID                                 17350785
173508                , :LBPTDA-PRC-MSG-CDE )                           17350885
173509     END-EXEC.                                                    17350985
173510                                                                  17351085
173511     EVALUATE TRUE                                                17351185
173512         WHEN SQLCODE = ZERO                                      17351285
173513              ADD  1  TO  PV-ROWS-INSERTED                        17351385
173514                                                                  17351485
173515         WHEN SQLWARN0 NOT = SPACES                               17351585
173516         WHEN SQLCODE NOT EQUAL ZERO                              17351685
173517                                                                  17351785
173518              INITIALIZE PV-CICS-MSG-AREA1                        17351885
173519              INITIALIZE PV-CICS-MSG-AREA2                        17351985
173520                                                                  17352085
173521              MOVE SQLCODE              TO PV-DISP-SQLCODE        17352185
173522              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             17352285
173523              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           17352385
173524              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        17352485
173525                                                                  17352585
173526              STRING  'SUKCS782 7205B-'                           17352699
173527                      ' DC:'               PV-DISP-DC             17352785
173528                      ' B1:'               SU054-BAR-CODE-1       17352885
173529                      ' B2:'               SU054-BAR-CODE-2       17352985
173530                      ' B3:'               SU054-BAR-CODE-3       17353085
173531                                           DELIMITED BY SIZE      17353185
173532                                      INTO PV-CICS-MSG-AREA1      17353285
173533                                                                  17353385
173534              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17353485
173535              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     17353585
173536                                                                  17353685
173537              PERFORM 9999-WRITE-TO-CSSL                          17353785
173538                                                                  17353885
173539              STRING  'SUKCS782 '          SU054-KOHLS-SML        17353999
173540                      ' TRIP:'             PV-DISP-TRIP           17354085
173541                      ' DR:'               SU054-DOOR-NUMBER      17354185
173542                      ' USR:'              SU054-USER-ID          17354285
173543                      ' STA:'              PV-DISP-PNA-STA        17354385
173544                      ' SQL:'              PV-DISP-SQLCODE        17354485
173545                      ' TLBPTDA - INSERT'                         17354585
173546                                           DeLIMITED BY SIZE      17354685
173547                                      INTO PV-CICS-MSG-AREA2      17354785
173548                                                                  17354885
173549              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17354985
173550              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     17355085
173551                                                                  17355185
173552              PERFORM 9999-WRITE-TO-CSSL                          17355285
173553                                                                  17355385
173554              INITIALIZE PV-CICS-MSG-AREA3                        17355485
173555                                                                  17355585
173556              MOVE LBPTDA-TRIP-ID      TO PV-DISP-TRIP            17355685
173557              MOVE LBPTDA-SHIPT-UNT-ID TO PV-DISP-SSCC            17355785
173558              MOVE LBPTDA-OPER-UNT-ID  TO PV-DISP-OPER            17355885
173559              MOVE LBPTDA-FCLTY-ID     TO PV-DISP-FCLTY           17355985
173560                                                                  17356085
173561              STRING  'SUKCS782 '                                 17356199
173562                      ' TRIP:'             PV-DISP-TRIP           17356285
173563                      ' USR:'              SU054-USER-ID          17356385
173564                      ' CRTN:'             PV-DISP-SSCC           17356485
173565                      ' OPER:'             PV-DISP-OPER           17356585
173566                      '-'                  PV-DISP-FCLTY          17356685
173567                      ' VEHL:'             VHTRIP-OWNER-SCAC-ID   17356785
173568                      '-'                  VHTRIP-VEH-NBR         17356885
173569                      ' RPRT:'             LBPTDA-RPRT-IND        17356985
173570                      ' DUP:'              PV-DUPLICATE-IND       17357085
173571                      ' FA:'               LBPTDA-SU-FRE-ASTRA-IND17357185
173572                                           DELIMITED BY SIZE      17357285
173573                                      INTO PV-CICS-MSG-AREA3      17357385
173574                                                                  17357485
173575              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17357585
173576              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     17357685
173577                                                                  17357785
173578              PERFORM 9999-WRITE-TO-CSSL                          17357885
173579                                                                  17357985
173580              INITIALIZE PV-CICS-MSG-AREA4                        17358085
173581                                                                  17358185
173582              MOVE LBPTDA-MISDIR-OPER-UNT-ID TO PV-DISP-OPER      17358285
173583              MOVE LBPTDA-PO-NBR             TO PV-DISP-PO        17358385
173584              MOVE LBPTDA-RCVR-SEQ-NBR       TO PV-DISP-RCVR      17358485
173585              MOVE LBPTDA-PO-LNE-NBR         TO pv-disp-line      17358585
173586              MOVE LBPTDA-DEST-OPER-UNT-ID   TO PV-DISP-DEST-OPER 17358685
173587                                                                  17358785
173588              STRING  'SUKCS782 '                                 17358899
173589                      ' MSSG:'         LBPTDA-SU-MSSG-DAT-IND     17358985
173590                      ' MSD:'          LBPTDA-SU-MISDIR-IND       17359085
173591                      ' MSD OPER:'     PV-DISP-OPER               17359185
173592                      ' PO:'           PV-DISP-PO                 17359285
173593                      '-'              PV-DISP-RCVR               17359385
173594                      '-'              pv-disp-line               17359485
173595                      ' DEST:'         PV-DISP-DEST-OPER          17359585
173596                      ' STR:'          LBPTDA-STR-NM              17359685
173597                      ' ZN:'           LBPTDA-STR-ZN-ID           17359785
173598                      ' DPT:'          XL001-DEPT-NBR-3CH         17359885
173599                      ' SUB:'          XL001-SUB-CL-NBR-2CH       17359985
173600                      ' STYL:'         PV-VEND-STYL-NAME          17360085
173601                                           DELIMITED BY SIZE      17360185
173602                                      INTO PV-CICS-MSG-AREA4      17360285
173603                                                                  17360385
173604              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17360485
173605              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     17360585
173606                                                                  17360685
173607              PERFORM 9999-WRITE-TO-CSSL                          17360785
173608                                                                  17360885
173609              INITIALIZE PV-CICS-MSG-AREA5                        17360985
173610                                                                  17361085
173611              MOVE LBPTDA-OTPK-UNT-QTY       TO PV-DISP-OTPK      17361185
173612              MOVE LBPTDA-INPK-UNT-QTY       TO PV-DISP-INPK      17361285
173613              MOVE LBPTDA-PREPK-ID           TO PV-DISP-PREPK     17361385
173614              MOVE LBPTDA-PREPK-RATO-QTY     TO PV-DISP-RATIO     17361485
173615              MOVE LBPTDA-PREPK-UNT-QTY      TO PV-DISP-PREPK-UNT 17361585
173616              MOVE LBPTDA-CSE-PK-QTY         TO PV-DISP-CASE-UNT  17361685
173617                                                                  17361785
173618              STRING  'SUKCS782 '                                 17361899
173619                      ' OTPK:'         PV-DISP-OTPK               17361985
173620                      ' INPK:'         PV-DISP-INPK               17362085
173621                      ' MSD OPER:'     LBPTDA-PRTR-ID             17362185
173622                      ' BRCD:'         LBPTDA-BRCDE-NBR           17362285
173623                      ' AT:'           LBPTDA-DC-PRTD-AT-CDE      17362385
173624                      ' ERR:'          LBPTDA-INVLD-DAT-ERR-CDE   17362485
173625                      ' PREPK:'        PV-DISP-PREPK              17362585
173626                      ' RATIO:'        PV-DISP-RATIO              17362685
173627                      ' PREPK UNT:'    PV-DISP-PREPK-UNT          17362785
173628                      ' CASE UNT:'     PV-DISP-CASE-UNT           17362885
173629                                           DELIMITED BY SIZE      17362985
173630                                      INTO PV-CICS-MSG-AREA5      17363085
173631                                                                  17363185
173632              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17363285
173633              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     17363385
173634                                                                  17363485
173635              PERFORM 9999-WRITE-TO-CSSL                          17363585
173636                                                                  17363685
173637              INITIALIZE PV-CICS-MSG-AREA6                        17363785
173638                                                                  17363885
173639              MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID TO PV-DISP-LBL-SEQ   17363985
173640              MOVE LBPTDA-LBL-TYP-TOT-QTY    TO PV-DISP-LBL-TOT   17364085
173641              MOVE LBPTDA-itm-nbr            TO PV-DISP-ITM       17364185
173642                                                                  17364285
173643              STRING  'SUKCS782 '                                 17364399
173644                      ' ODD:'          LBPTDA-ODD-CART-IND        17364485
173645                      ' CNVYB:'        LBPTDA-INPK-CNVYB-IND      17364585
173646                      ' LBL SEQ:'      PV-DISP-LBL-SEQ            17364685
173647                      ' LBL TOT:'      PV-DISP-LBL-TOT            17364785
173648                      ' MOD:'          LBPTDA-MODU-DESC           17364885
173649                      ' ITM:'          PV-DISP-ITM                17364985
173650                      ' DPT:'          LBPTDA-DEPT-DESC           17365085
173651                      ' MAJ CL:'       LBPTDA-MAJ-CL-DESc         17365185
173652                      ' SET:'          LBPTDA-SEASET-NM           17365285
173653                      ' FIXT:'         LBPTDA-FIXT-ID             17365385
173654                                           DELIMITED BY SIZE      17365485
173655                                      INTO PV-CICS-MSG-AREA6      17365585
173656                                                                  17365685
173657              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17365785
173658              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     17365885
173659                                                                  17365985
173660              PERFORM 9999-WRITE-TO-CSSL                          17366085
173661              INITIALIZE PV-CICS-MSG-AREA7                        17366185
173662                                                                  17366285
173663              MOVE LBPTDA-HNG-FOLD-SEQ-NBR   TO PV-DISP-HNG-FLD   17366385
173664              MOVE LBPTDA-SKU-NBR            TO PV-DISP-sku       17366485
173665              MOVE LBPTDA-BUS-AREA-ID        TO PV-DISP-bus-area  17366585
173666                                                                  17366685
173667              STRING  'SUKCS782 '                                 17366799
173668                      ' LBL TYP:'      LBPTDA-CART-LBL-TYP-CDE    17366885
173669                      ' STRG:'         LBPTDA-STRG-AREA-CDE       17366985
173670                      ' ACTN:'         LBPTDA-CART-ACTN-CDE       17367085
173671                      ' HNG/FLD:'      PV-DISP-HNG-FLD            17367185
173672                      ' AREA:'         PV-DISP-bus-area           17367285
173673                      ' SKU:'          pv-disp-sku                17367385
173674                      ' EAS:'          LBPTDA-EAS-TAG-IND         17367485
173675                      ' DOOR:'         LBPTDA-DOOR-ID             17367585
173676                      ' MSG:'          LBPTDA-PRC-MSG-CDE         17367685
173677                                           DELIMITED BY SIZE      17367785
173678                                      INTO PV-CICS-MSG-AREA7      17367885
173679                                                                  17367985
173680              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17368085
173681              MOVE PV-CICS-MSG-AREA7    TO PV-CICS-MSG-AREA-A     17368185
173682                                                                  17368285
173683              PERFORM 9999-WRITE-TO-CSSL                          17368385
173684                                                                  17368485
173685             SET PS-PROCESSING-ERROR-YES TO TRUE                  17368585
173686             SET PS-INSERT-ERROR-YES     TO TRUE                  17368685
173687             PERFORM 9998-WRITE-TO-CSSL                           17368785
173688                                                                  17368885
173689     END-EVALUATE.                                                17368985
173690                                                                  17369085
173691                                                                  17369185
173692*CLP 06/24/2015 START                                             17369285
173693***************************************************************** 17369385
173694* ONLY BRING BACK AS MANY CHARACTERS UP TO 9 FOR THE BUSINESS     17369485
173695* AREA DESCRIPTION                                                17369585
173696***************************************************************** 17369685
173697 7207-INSPECT-BUS-AREA.                                           17369785
173698                                                                  17369885
173699     MOVE XL073-BUS-AREA-DESC(1:9) TO PV-BUS-AREA-DESC-9.         17369985
173700                                                                  17370085
173701     MOVE +0                               TO PV-DESC-LEN.        17370185
173702     MOVE LENGTH OF PV-BUS-AREA-DESC-9     TO PV-DESC-LEN.        17370285
173703                                                                  17370385
173704     PERFORM                                                      17370485
173705       UNTIL PV-BUS-AREA-DESC-9(PV-DESC-LEN:1) > SPACES OR        17370585
173706         PV-DESC-LEN = +0                                         17370685
173707       COMPUTE PV-DESC-LEN   = PV-DESC-LEN - 1                    17370785
173708     END-PERFORM.                                                 17370885
173709                                                                  17370985
173710     MOVE SPACES  TO  PV-BUS-AREA-BRAND.                          17371085
173711                                                                  17371185
173712     EVALUATE TRUE                                                17371285
173713        WHEN  PV-DESC-LEN   =  9                                  17371385
173714            STRING   PV-BUS-AREA-DESC-9(1:9)                      17371485
173715                                 '-'                              17371585
173716                     XLT00043-BRND-DESC DELIMITED BY SIZE         17371685
173717            INTO  PV-BUS-AREA-BRAND                               17371785
173718        WHEN  PV-DESC-LEN   =  8                                  17371885
173719            STRING   PV-BUS-AREA-DESC-9(1:8)                      17371985
173720                                 '-'                              17372085
173721                     XLT00043-BRND-DESC DELIMITED BY SIZE         17372185
173722            INTO  PV-BUS-AREA-BRAND                               17372285
173723        WHEN  PV-DESC-LEN   =  7                                  17372385
173724            STRING   PV-BUS-AREA-DESC-9(1:7)                      17372485
173725                                 '-'                              17372585
173726                     XLT00043-BRND-DESC DELIMITED BY SIZE         17372685
173727            INTO  PV-BUS-AREA-BRAND                               17372785
173728        WHEN  PV-DESC-LEN   =  6                                  17372885
173729            STRING   PV-BUS-AREA-DESC-9(1:6)                      17372985
173730                                 '-'                              17373085
173731                     XLT00043-BRND-DESC DELIMITED BY SIZE         17373185
173732            INTO  PV-BUS-AREA-BRAND                               17373285
173733        WHEN  PV-DESC-LEN   =  5                                  17373385
173734            STRING   PV-BUS-AREA-DESC-9(1:5)                      17373485
173735                                 '-'                              17373585
173736                     XLT00043-BRND-DESC DELIMITED BY SIZE         17373685
173737            INTO  PV-BUS-AREA-BRAND                               17373785
173738        WHEN  PV-DESC-LEN   =  4                                  17373885
173739            STRING   PV-BUS-AREA-DESC-9(1:4)                      17373985
173740                                 '-'                              17374085
173741                     XLT00043-BRND-DESC DELIMITED BY SIZE         17374185
173742            INTO  PV-BUS-AREA-BRAND                               17374285
173743        WHEN  PV-DESC-LEN   =  3                                  17374385
173744            STRING   PV-BUS-AREA-DESC-9(1:3)                      17374485
173745                                 '-'                              17374585
173746                     XLT00043-BRND-DESC DELIMITED BY SIZE         17374685
173747            INTO  PV-BUS-AREA-BRAND                               17374785
173748        WHEN  PV-DESC-LEN   =  2                                  17374885
173749            STRING   PV-BUS-AREA-DESC-9(1:2)                      17374985
173750                                 '-'                              17375085
173751                     XLT00043-BRND-DESC DELIMITED BY SIZE         17375185
173752            INTO  PV-BUS-AREA-BRAND                               17375285
173753        WHEN  PV-DESC-LEN   =  1                                  17375385
173754            STRING   PV-BUS-AREA-DESC-9(1:1)                      17375485
173755                                 '-'                              17375585
173756                     XLT00043-BRND-DESC DELIMITED BY SIZE         17375685
173757            INTO  PV-BUS-AREA-BRAND                               17375785
173758        WHEN  OTHER                                               17375885
173759*           NO BUSINESS AREA AVAILABLE                            17375985
173760            STRING   PV-BUS-AREA-DESC-9(1:9)                      17376085
173761                                 '-'                              17376185
173762                     XLT00043-BRND-DESC DELIMITED BY SIZE         17376285
173763            INTO  PV-BUS-AREA-BRAND                               17376385
173764     END-EVALUATE.                                                17376485
173765                                                                  17376585
173766*CLP 06/24/2015 END                                               17376685
173767                                                                  17376785
173768*----------------------------------------------------------------*17376885
173769*                                                                *17376985
173770*                                                                *17377085
173771*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *17377185
173772*----------------------------------------------------------------*17377285
173780 7210-GET-STORE-INFO.                                             17378013
173790*                                                                 17379013
173800** added internal table to track paragraph execution time         17380013
173810** dmh 2014-12-22 - begin                                         17381013
173820*                                                                 17382013
173830     MOVE  '7210'  TO  PT-CURR-PARA.                              17383013
173840     IF  PS-BLD-INTERNAL-TABLE-YES                                17384013
173850         PERFORM 0200-INTERNAL-TABLE                              17385013
173860     ELSE                                                         17386013
173870         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       17387013
173880     END-IF.                                                      17388013
173890                                                                  17389013
173900*                                                                 17390013
173910** DMH 2014-12-22 - END                                           17391013
173920*                                                                 17392013
173930                                                                  17393013
173940     MOVE  PV-DEST-STORE TO DK-STORE.                             17394013
173950                                                                  17395013
173960     EXEC SQL                                                     17396013
173970          SELECT  LOC_10_ABBR_NM                                  17397013
173980                , LOC_TYP_CDE                                     17398013
173990                , E_BUS_IND                                       17399013
174000          INTO    :XLT00010-LOC-10-ABBR-NM                        17400013
174010                , :XLT00010-LOC-TYP-CDE                           17401013
174020                , :XLT00010-E-BUS-IND :PV-NULL-E-BUS-IND          17402013
174030          FROM   XLT_LOC                                          17403013
174040          WHERE  LOC_NBR   = :DK-STORE                            17404013
174050           WITH UR                                                17405013
174060     END-EXEC.                                                    17406013
174070                                                                  17407013
174080     EVALUATE TRUE                                                17408013
174090         WHEN SQLCODE = ZERO                                      17409013
174100           IF PV-NULL-E-BUS-IND = -1                              17410013
174110              MOVE 'N' TO XLT00010-E-BUS-IND                      17411013
174120           END-IF                                                 17412013
174130                                                                  17413013
174140           IF XLT00010-LOC-TYP-CDE = 'DS' AND                     17414013
174150              XLT00010-E-BUS-IND    = 'Y'                         17415013
174160                SET PS-OPER-IS-ECOMM-DS TO TRUE                   17416013
174170           END-IF                                                 17417013
174180                                                                  17418013
174190           IF XLT00010-LOC-TYP-CDE = 'DC' AND                     17419013
174200              XLT00010-E-BUS-IND    = 'Y'                         17420013
174210                SET PS-OPER-IS-ECOMM-DC TO TRUE                   17421013
174220           END-IF                                                 17422013
174230                                                                  17423013
174240         WHEN SQLCODE = +100                                      17424013
174250              MOVE 'INVALID   ' TO  XLT00010-LOC-10-ABBR-NM       17425013
174260                                                                  17426013
174270         WHEN SQLWARN0 NOT = SPACES                               17427013
174280         WHEN SQLCODE NOT EQUAL ZERO                              17428013
174290                                                                  17429013
174300              INITIALIZE PV-CICS-MSG-AREA1                        17430013
174310              INITIALIZE PV-CICS-MSG-AREA2                        17431013
174320                                                                  17432013
174330              MOVE SQLCODE              TO PV-DISP-SQLCODE        17433013
174340              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             17434013
174350              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           17435013
174360              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        17436013
174370                                                                  17437013
174380              STRING  'SUKCS782 7210-'                            17438099
174390                      ' DC:'               PV-DISP-DC             17439013
174400                      ' B1:'               SU054-BAR-CODE-1       17440013
174410                      ' B2:'               SU054-BAR-CODE-2       17441013
174420                      ' B3:'               SU054-BAR-CODE-3       17442013
174430                                           DELIMITED BY SIZE      17443013
174440                                      INTO PV-CICS-MSG-AREA1      17444013
174450                                                                  17445013
174460              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17446013
174470              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     17447013
174480                                                                  17448013
174490              PERFORM 9999-WRITE-TO-CSSL                          17449013
174500                                                                  17450013
174510              STRING  'SUKCS782 '          SU054-KOHLS-SML        17451099
174520                      ' TRIP:'             PV-DISP-TRIP           17452013
174530                      ' DR:'               SU054-DOOR-NUMBER      17453013
174540                      ' USR:'              SU054-USER-ID          17454013
174550                      ' STA:'              PV-DISP-PNA-STA        17455013
174560                      ' SQL:'              PV-DISP-SQLCODE        17456013
174570                      ' XLT_LOC'                                  17457013
174580                                           DeLIMITED BY SIZE      17458013
174590                                      INTO PV-CICS-MSG-AREA2      17459013
174600                                                                  17460013
174610              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17461013
174620              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     17462013
174630                                                                  17463013
174640              PERFORM 9999-WRITE-TO-CSSL                          17464013
174650                                                                  17465013
174660              INITIALIZE PV-CICS-MSG-AREA3                        17466013
174670                                                                  17467013
174680              MOVE DK-STORE            TO PV-DISP-STR             17468013
174690                                                                  17469013
174700              STRING  'SUKCS782 '                                 17470099
174710                      ' STORE:'            PV-DISP-STR            17471013
174720                                           DELIMITED BY SIZE      17472013
174730                                      INTO PV-CICS-MSG-AREA3      17473013
174740                                                                  17474013
174750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17475013
174760              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     17476013
174770                                                                  17477013
174780              PERFORM 9999-WRITE-TO-CSSL                          17478013
174790                                                                  17479013
174800             SET PS-PROCESSING-ERROR-YES TO TRUE                  17480013
174810             PERFORM 9998-WRITE-TO-CSSL                           17481013
174820     END-EVALUATE.                                                17482013
174830                                                                  17483013
174840                                                                  17484013
174850*----------------------------------------------------------------*17485013
174860*                                                                *17486013
174870*                                                                *17487013
174880*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *17488013
174890*----------------------------------------------------------------*17489013
174900 7215-GET-ECOMM-DC-INFO.                                          17490013
174910*                                                                 17491013
174920** added internal table to track paragraph execution time         17492013
174930** dmh 2014-12-22 - begin                                         17493013
174940*                                                                 17494013
174950     MOVE  '7215'  TO  PT-CURR-PARA.                              17495013
174960     IF  PS-BLD-INTERNAL-TABLE-YES                                17496013
174970         PERFORM 0200-INTERNAL-TABLE                              17497013
174980     ELSE                                                         17498013
174990         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       17499013
175000     END-IF.                                                      17500013
175010                                                                  17501013
175020*                                                                 17502013
175030** DMH 2014-12-22 - END                                           17503013
175040*                                                                 17504013
175050                                                                  17505013
175060     EXEC SQL                                                     17506013
175070          SELECT  LOC_TYP_CDE                                     17507013
175080                , E_BUS_IND                                       17508013
175090          INTO    :XLT00010-LOC-TYP-CDE                           17509013
175100                , :XLT00010-E-BUS-IND :PV-NULL-E-BUS-IND          17510013
175110          FROM   XLT_LOC                                          17511013
175120          WHERE  LOC_NBR   = :DK-OPER-UNT-ID                      17512013
175130           WITH UR                                                17513013
175140     END-EXEC.                                                    17514013
175150                                                                  17515013
175160     EVALUATE TRUE                                                17516013
175170         WHEN SQLCODE = ZERO                                      17517013
175180           IF PV-NULL-E-BUS-IND = -1                              17518013
175190              MOVE 'N' TO XLT00010-E-BUS-IND                      17519013
175200           END-IF                                                 17520013
175210           IF XLT00010-LOC-TYP-CDE = 'DC' AND                     17521013
175220              XLT00010-E-BUS-IND    = 'Y'                         17522013
175230                SET PS-OPER-IS-ECOMM-DC TO TRUE                   17523013
175240           END-IF                                                 17524013
175250                                                                  17525013
175260           IF XLT00010-LOC-TYP-CDE = 'DS' AND                     17526013
175270              XLT00010-E-BUS-IND    = 'Y'                         17527013
175280                SET PS-OPER-IS-ECOMM-DS TO TRUE                   17528013
175290           END-IF                                                 17529013
175300                                                                  17530013
175310         WHEN SQLCODE = +100                                      17531013
175320              MOVE 'INVALID   ' TO  XLT00010-LOC-10-ABBR-NM       17532013
175330                                                                  17533013
175340         WHEN SQLWARN0 NOT = SPACES                               17534013
175350         WHEN SQLCODE NOT EQUAL ZERO                              17535013
175360                                                                  17536013
175370              INITIALIZE PV-CICS-MSG-AREA1                        17537013
175380              INITIALIZE PV-CICS-MSG-AREA2                        17538013
175390                                                                  17539013
175400              MOVE SQLCODE              TO PV-DISP-SQLCODE        17540013
175410              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             17541013
175420              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           17542013
175430              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        17543013
175440                                                                  17544013
175450              STRING  'SUKCS782 7215-'                            17545099
175460                      ' DC:'               PV-DISP-DC             17546013
175470                      ' B1:'               SU054-BAR-CODE-1       17547013
175480                      ' B2:'               SU054-BAR-CODE-2       17548013
175490                      ' B3:'               SU054-BAR-CODE-3       17549013
175500                                           DELIMITED BY SIZE      17550013
175510                                      INTO PV-CICS-MSG-AREA1      17551013
175520                                                                  17552013
175530              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17553013
175540              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     17554013
175550                                                                  17555013
175560              PERFORM 9999-WRITE-TO-CSSL                          17556013
175570                                                                  17557013
175580              STRING  'SUKCS782 '          SU054-KOHLS-SML        17558099
175590                      ' TRIP:'             PV-DISP-TRIP           17559013
175600                      ' DR:'               SU054-DOOR-NUMBER      17560013
175610                      ' USR:'              SU054-USER-ID          17561013
175620                      ' STA:'              PV-DISP-PNA-STA        17562013
175630                      ' SQL:'              PV-DISP-SQLCODE        17563013
175640                      ' XLT_LOC'                                  17564013
175650                                           DeLIMITED BY SIZE      17565013
175660                                      INTO PV-CICS-MSG-AREA2      17566013
175670                                                                  17567013
175680              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17568013
175690              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     17569013
175700                                                                  17570013
175710              PERFORM 9999-WRITE-TO-CSSL                          17571013
175720                                                                  17572013
175730              INITIALIZE PV-CICS-MSG-AREA3                        17573013
175740                                                                  17574013
175750              MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER            17575013
175760                                                                  17576013
175770              STRING  'SUKCS782 '                                 17577099
175780                      ' OPER:'             PV-DISP-OPER           17578013
175790                                           DELIMITED BY SIZE      17579013
175800                                      INTO PV-CICS-MSG-AREA3      17580013
175810                                                                  17581013
175820              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17582013
175830              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     17583013
175840                                                                  17584013
175850              PERFORM 9999-WRITE-TO-CSSL                          17585013
175860                                                                  17586013
175870             SET PS-PROCESSING-ERROR-YES TO TRUE                  17587013
175880             PERFORM 9998-WRITE-TO-CSSL                           17588013
175890     END-EVALUATE.                                                17589013
175900                                                                  17590013
175910                                                                  17591013
175920*----------------------------------------------------------------*17592013
175930*                                                                *17593013
175940*                                                                *17594013
175950*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *17595013
175960*----------------------------------------------------------------*17596013
175970 7218-SELECT-RCVR-CRE-OPER.                                       17597013
175980*                                                                 17598013
175990** added internal table to track paragraph execution time         17599013
176000** dmh 2014-12-22 - begin                                         17600013
176010*                                                                 17601013
176020     MOVE  '7218'  TO  PT-CURR-PARA.                              17602013
176030     IF  PS-BLD-INTERNAL-TABLE-YES                                17603013
176040         PERFORM 0200-INTERNAL-TABLE                              17604013
176050     ELSE                                                         17605013
176060         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       17606013
176070     END-IF.                                                      17607013
176080                                                                  17608013
176090*                                                                 17609013
176100** DMH 2014-12-22 - END                                           17610013
176110*                                                                 17611013
176120                                                                  17612013
176130     MOVE PV-PO-NBR            TO DK-PO.                          17613013
176140     MOVE PV-RCVR-SEQ-NBR      TO DK-REC-SEQ-NBR.                 17614013
176150                                                                  17615013
176160     EXEC SQL                                                     17616013
176170         SELECT  OPER_UNT_ID                                      17617013
176180         INTO   :RECEIV-OPER-UNT-ID                               17618013
176190         FROM   TRECEIV                                           17619013
176200         WHERE  ORD_NBR        = :DK-PO                           17620013
176210           AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  17621013
176220          WITH UR                                                 17622013
176230     END-EXEC.                                                    17623013
176240                                                                  17624013
176250     EVALUATE TRUE                                                17625013
176260         WHEN SQLCODE = ZERO                                      17626013
176270         WHEN SQLCODE = +100                                      17627013
176280             CONTINUE                                             17628013
176290         WHEN SQLWARN0 NOT = SPACES                               17629013
176300         WHEN SQLCODE NOT EQUAL ZERO                              17630013
176310                                                                  17631013
176320              INITIALIZE PV-CICS-MSG-AREA1                        17632013
176330              INITIALIZE PV-CICS-MSG-AREA2                        17633013
176340                                                                  17634013
176350              MOVE SQLCODE              TO PV-DISP-SQLCODE        17635013
176360              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             17636013
176370              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           17637013
176380              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        17638013
176390                                                                  17639013
176400              STRING  'SUKCS782 7218-'                            17640099
176410                      ' DC:'               PV-DISP-DC             17641013
176420                      ' B1:'               SU054-BAR-CODE-1       17642013
176430                      ' B2:'               SU054-BAR-CODE-2       17643013
176440                      ' B3:'               SU054-BAR-CODE-3       17644013
176450                                           DELIMITED BY SIZE      17645013
176460                                      INTO PV-CICS-MSG-AREA1      17646013
176470                                                                  17647013
176480              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17648013
176490              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     17649013
176500                                                                  17650013
176510              PERFORM 9999-WRITE-TO-CSSL                          17651013
176520                                                                  17652013
176530              STRING  'SUKCS782 '          SU054-KOHLS-SML        17653099
176540                      ' TRIP:'             PV-DISP-TRIP           17654013
176550                      ' DR:'               SU054-DOOR-NUMBER      17655013
176560                      ' USR:'              SU054-USER-ID          17656013
176570                      ' STA:'              PV-DISP-PNA-STA        17657013
176580                      ' SQL:'              PV-DISP-SQLCODE        17658013
176590                      ' TRECEIV'                                  17659013
176600                                           DeLIMITED BY SIZE      17660013
176610                                      INTO PV-CICS-MSG-AREA2      17661013
176620                                                                  17662013
176630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17663013
176640              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     17664013
176650                                                                  17665013
176660              PERFORM 9999-WRITE-TO-CSSL                          17666013
176670                                                                  17667013
176680              INITIALIZE PV-CICS-MSG-AREA3                        17668013
176690                                                                  17669013
176700              MOVE DK-PO               TO PV-DISP-PO              17670013
176710              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR            17671013
176720                                                                  17672013
176730              STRING  'SUKCS782 '                                 17673099
176740                      ' PO:'               PV-DISP-PO             17674013
176750                      '-'                  PV-DISP-OPER           17675013
176760                                           DELIMITED BY SIZE      17676013
176770                                      INTO PV-CICS-MSG-AREA3      17677013
176780                                                                  17678013
176790              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17679013
176800              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     17680013
176810                                                                  17681013
176820              PERFORM 9999-WRITE-TO-CSSL                          17682013
176830                                                                  17683013
176840             SET PS-PROCESSING-ERROR-YES TO TRUE                  17684013
176850             PERFORM 9998-WRITE-TO-CSSL                           17685013
176860     END-EVALUATE.                                                17686013
176870                                                                  17687013
176880                                                                  17688013
176890*----------------------------------------------------------------*17689013
176900*                                                                *17690013
176910*                                                                *17691013
176920*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *17692013
176930*----------------------------------------------------------------*17693013
176940 7220-SELECT-TPURCHS.                                             17694013
176950*                                                                 17695013
176960** added internal table to track paragraph execution time         17696013
176970** dmh 2014-12-22 - begin                                         17697013
176980*                                                                 17698013
176990     MOVE  '7220'  TO  PT-CURR-PARA.                              17699013
177000     IF  PS-BLD-INTERNAL-TABLE-YES                                17700013
177010         PERFORM 0200-INTERNAL-TABLE                              17701013
177020     ELSE                                                         17702013
177030         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       17703013
177040     END-IF.                                                      17704013
177050                                                                  17705013
177060*                                                                 17706013
177070** DMH 2014-12-22 - END                                           17707013
177080*                                                                 17708013
177090                                                                  17709013
177100     EXEC SQL                                                     17710013
177110         SELECT  PKGNG_CDE                                        17711013
177120               , SEASET_YR                                        17712013
177130                ,SEASET_SHRT_NM                                   17713013
177140         INTO   :PURCHS-PKGNG-CDE                                 17714013
177150              , :PURCHS-SEASET-YR                                 17715013
177160              , :PURCHS-SEASET-SHRT-NM                            17716013
177170         FROM   TPURCHS                                           17717013
177180         WHERE  PO_NBR         = :DK-PO                           17718013
177190           AND  VER_STATUS_CDE = 'A'                              17719013
177200          WITH UR                                                 17720013
177210     END-EXEC.                                                    17721013
177220                                                                  17722013
177230     EVALUATE TRUE                                                17723013
177240         WHEN SQLCODE = ZERO                                      17724013
177250             CONTINUE                                             17725013
177260         WHEN SQLWARN0 NOT = SPACES                               17726013
177270         WHEN SQLCODE NOT EQUAL ZERO                              17727013
177280                                                                  17728013
177290              INITIALIZE PV-CICS-MSG-AREA1                        17729013
177300              INITIALIZE PV-CICS-MSG-AREA2                        17730013
177310                                                                  17731013
177320              MOVE SQLCODE              TO PV-DISP-SQLCODE        17732013
177330              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             17733013
177340              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           17734013
177350              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        17735013
177360                                                                  17736013
177370              STRING  'SUKCS782 7220-'                            17737099
177380                      ' DC:'               PV-DISP-DC             17738013
177390                      ' B1:'               SU054-BAR-CODE-1       17739013
177400                      ' B2:'               SU054-BAR-CODE-2       17740013
177410                      ' B3:'               SU054-BAR-CODE-3       17741013
177420                                           DELIMITED BY SIZE      17742013
177430                                      INTO PV-CICS-MSG-AREA1      17743013
177440                                                                  17744013
177450              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17745013
177460              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     17746013
177470                                                                  17747013
177480              PERFORM 9999-WRITE-TO-CSSL                          17748013
177490                                                                  17749013
177500              STRING  'SUKCS782 '          SU054-KOHLS-SML        17750099
177510                      ' TRIP:'             PV-DISP-TRIP           17751013
177520                      ' DR:'               SU054-DOOR-NUMBER      17752013
177530                      ' USR:'              SU054-USER-ID          17753013
177540                      ' STA:'              PV-DISP-PNA-STA        17754013
177550                      ' SQL:'              PV-DISP-SQLCODE        17755013
177560                      ' TPURCHS'                                  17756013
177570                                           DeLIMITED BY SIZE      17757013
177580                                      INTO PV-CICS-MSG-AREA2      17758013
177590                                                                  17759013
177600              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17760013
177610              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     17761013
177620                                                                  17762013
177630              PERFORM 9999-WRITE-TO-CSSL                          17763013
177640                                                                  17764013
177650              INITIALIZE PV-CICS-MSG-AREA3                        17765013
177660                                                                  17766013
177670              MOVE DK-PO               TO PV-DISP-PO              17767013
177680                                                                  17768013
177690              STRING  'SUKCS782 '                                 17769099
177700                      ' PO:'               PV-DISP-PO             17770013
177710                                           DELIMITED BY SIZE      17771013
177720                                      INTO PV-CICS-MSG-AREA3      17772013
177730                                                                  17773013
177740              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17774013
177750              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     17775013
177760                                                                  17776013
177770              PERFORM 9999-WRITE-TO-CSSL                          17777013
177780                                                                  17778013
177790             SET PS-PROCESSING-ERROR-YES TO TRUE                  17779013
177800             PERFORM 9998-WRITE-TO-CSSL                           17780013
177810     END-EVALUATE.                                                17781013
177820                                                                  17782013
177830                                                                  17783013
177840*----------------------------------------------------------------*17784013
177850*                                                                *17785013
177860*                                                                *17786013
177870*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *17787013
177880*----------------------------------------------------------------*17788013
177890 7225-SELECT-TPURITM.                                             17789013
177900*                                                                 17790013
177910** added internal table to track paragraph execution time         17791013
177920** dmh 2014-12-22 - begin                                         17792013
177930*                                                                 17793013
177940     MOVE  '7225'  TO  PT-CURR-PARA.                              17794013
177950     IF  PS-BLD-INTERNAL-TABLE-YES                                17795013
177960         PERFORM 0200-INTERNAL-TABLE                              17796013
177970     ELSE                                                         17797013
177980         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       17798013
177990     END-IF.                                                      17799013
178000                                                                  17800013
178010*                                                                 17801013
178020** DMH 2014-12-22 - END                                           17802013
178030*                                                                 17803013
178040                                                                  17804013
178050     MOVE SHUUPC-TRN-LNE-NBR      TO PURITM-PO-LNE-NBR            17805013
178060     EXEC SQL                                                     17806013
178070         SELECT  PO_PREPK_ID                                      17807013
178080               , UNT_RTL_PR_AMT                                   17808013
178090         INTO   :PURITM-PO-PREPK-ID                               17809013
178100              , :PURITM-UNT-RTL-PR-AMT                            17810013
178110         FROM   TPURITM                                           17811013
178120         WHERE  PO_NBR            = :DK-PO                        17812013
178130           AND  APP_PO_LNE_NBR    = :PURITM-PO-LNE-NBR            17813013
178140           AND  VER_STATUS_CDE    = 'A'                           17814013
178150          WITH UR                                                 17815013
178160     END-EXEC.                                                    17816013
178170                                                                  17817013
178180     EVALUATE TRUE                                                17818013
178190         WHEN SQLCODE = ZERO                                      17819013
178200         WHEN SQLCODE = +100                                      17820013
178210             CONTINUE                                             17821013
178220         WHEN SQLWARN0 NOT = SPACES                               17822013
178230         WHEN SQLCODE NOT EQUAL ZERO                              17823013
178240                                                                  17824013
178250              INITIALIZE PV-CICS-MSG-AREA1                        17825013
178260              INITIALIZE PV-CICS-MSG-AREA2                        17826013
178270                                                                  17827013
178280              MOVE SQLCODE              TO PV-DISP-SQLCODE        17828013
178290              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             17829013
178300              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           17830013
178310              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        17831013
178320                                                                  17832013
178330              STRING  'SUKCS782 7225-'                            17833099
178340                      ' DC:'               PV-DISP-DC             17834013
178350                      ' B1:'               SU054-BAR-CODE-1       17835013
178360                      ' B2:'               SU054-BAR-CODE-2       17836013
178370                      ' B3:'               SU054-BAR-CODE-3       17837013
178380                                           DELIMITED BY SIZE      17838013
178390                                      INTO PV-CICS-MSG-AREA1      17839013
178400                                                                  17840013
178410              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17841013
178420              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     17842013
178430                                                                  17843013
178440              PERFORM 9999-WRITE-TO-CSSL                          17844013
178450                                                                  17845013
178460              STRING  'SUKCS782 '          SU054-KOHLS-SML        17846099
178470                      ' TRIP:'             PV-DISP-TRIP           17847013
178480                      ' DR:'               SU054-DOOR-NUMBER      17848013
178490                      ' USR:'              SU054-USER-ID          17849013
178500                      ' STA:'              PV-DISP-PNA-STA        17850013
178510                      ' SQL:'              PV-DISP-SQLCODE        17851013
178520                      ' TPURITM'                                  17852013
178530                                           DeLIMITED BY SIZE      17853013
178540                                      INTO PV-CICS-MSG-AREA2      17854013
178550                                                                  17855013
178560              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17856013
178570              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     17857013
178580                                                                  17858013
178590              PERFORM 9999-WRITE-TO-CSSL                          17859013
178600                                                                  17860013
178610              INITIALIZE PV-CICS-MSG-AREA3                        17861013
178620                                                                  17862013
178630              MOVE DK-PO               TO PV-DISP-PO              17863013
178640              MOVE PURITM-PO-LNE-NBR   TO PV-DISP-LINE            17864013
178650                                                                  17865013
178660              STRING  'SUKCS782 '                                 17866099
178670                      ' PO:'               PV-DISP-PO             17867013
178680                      ' LINE:'             PV-DISP-LINE           17868013
178690                                           DELIMITED BY SIZE      17869013
178700                                      INTO PV-CICS-MSG-AREA3      17870013
178710                                                                  17871013
178720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17872013
178730              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     17873013
178740                                                                  17874013
178750              PERFORM 9999-WRITE-TO-CSSL                          17875013
178760                                                                  17876013
178770             SET PS-PROCESSING-ERROR-YES TO TRUE                  17877013
178780             PERFORM 9998-WRITE-TO-CSSL                           17878013
178790     END-EVALUATE.                                                17879013
178800                                                                  17880013
178810                                                                  17881013
178820*----------------------------------------------------------------*17882013
178830*                                                                *17883013
178840*                                                                *17884013
178850*  2014-12-03 - DMH - ADDED "WITH UR" TO SQL                     *17885013
178860*----------------------------------------------------------------*17886013
178870 7230-GET-DEPT-CL-SKU.                                            17887013
178880*                                                                 17888013
178890** added internal table to track paragraph execution time         17889013
178900** dmh 2014-12-22 - begin                                         17890013
178910*                                                                 17891013
178920     MOVE  '7230'  TO  PT-CURR-PARA.                              17892013
178930     IF  PS-BLD-INTERNAL-TABLE-YES                                17893013
178940         PERFORM 0200-INTERNAL-TABLE                              17894013
178950     ELSE                                                         17895013
178960         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       17896013
178970     END-IF.                                                      17897013
178980                                                                  17898013
178990*                                                                 17899013
179000** DMH 2014-12-22 - END                                           17900013
179010*                                                                 17901013
179020                                                                  17902013
179030     INITIALIZE       PV-DEPT-NUMBER-LBL                          17903013
179040                      PV-INNR-PACK-QTY                            17904013
179050                      PV-CL-NBR-LBL                               17905013
179060                      PV-SKU-NBR-LBL.                             17906013
179070*                     PV-VEND-STYL-NAME.                          17907013
179080                                                                  17908013
179090     MOVE  PV-PO-NBR          TO DK-PO.                           17909013
179100     MOVE  PV-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                     17910013
179110     MOVE  SHUUPC-TRN-LNE-NBR TO DK-PO-LNE-NBR.                   17911013
179120                                                                  17912013
179130     EXEC SQL                                                     17913013
179140         SELECT A.DEPT_NBR                                        17914013
179150               ,C.INNR_PACK_QTY                                   17915013
179160               ,C.ITM_NBR                                         17916013
179170               ,D.CL_NBR                                          17917013
179180               ,D.VEND_STYL_NAME                                  17918013
179190               ,D.PO_PREPK_ID                                     17919013
179200           INTO :PV-DEPT-NUMBER,                                  17920013
179210                :PV-INNR-PACK-QTY,                                17921013
179220                :RECITM-ITM-NBR,                                  17922013
179230                :PV-CL-NBR,                                       17923013
179240                :PV-VEND-STYL-NAME ,                              17924013
179250                :PURITM-PO-PREPK-ID                               17925013
179260           FROM TPURCHS A                                         17926013
179270               ,TVNDDPT B                                         17927013
179280               ,TRECITM C                                         17928013
179290               ,TPURITM D                                         17929013
179300          WHERE A.PO_NBR         =  :DK-PO                        17930013
179310            AND A.VER_STATUS_CDE =  'A'                           17931013
179320            AND A.ENT_ID         =  B.ENT_ID                      17932013
179330            AND A.DEPT_NBR       =  B.DEPT_NBR                    17933013
179340            AND C.ORD_NBR        =  A.PO_NBR                      17934013
179350            AND C.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR               17935013
179360            AND C.ORD_NBR        =  D.PO_NBR                      17936013
179370            AND C.ORD_LNE_NBR    =  :DK-PO-LNE-NBR                17937013
179380            AND C.ORD_LNE_NBR    =  D.APP_PO_LNE_NBR              17938013
179390            AND C.VER_STATUS_CDE =  'A'                           17939013
179400            AND C.PO_VER_NBR     =  D.VER_NBR                     17940013
179410           WITH UR                                                17941013
179420     END-EXEC                                                     17942013
179430                                                                  17943013
179440     EVALUATE TRUE                                                17944013
179450         WHEN SQLCODE = ZERO                                      17945013
179460              PERFORM 7240-CALL-XLKUT-DOMAIN                      17946013
179470              MOVE  XL001-DEPT-NBR-3CH   TO PV-DEPT-NUMBER-LBL    17947013
179480              MOVE  XL001-SUB-CL-NBR-2CH TO PV-CL-NBR-LBL         17948013
179490              MOVE  XL001-SKU-NBR        TO PV-SKU-NBR-LBL        17949013
179500                                            PV-SKU-OUT-9          17950013
179510         WHEN SQLCODE = +100                                      17951013
179520              CONTINUE                                            17952013
179530         WHEN SQLWARN0 NOT = SPACES                               17953013
179540         WHEN SQLCODE NOT EQUAL ZERO                              17954013
179550                                                                  17955013
179560              INITIALIZE PV-CICS-MSG-AREA1                        17956013
179570              INITIALIZE PV-CICS-MSG-AREA2                        17957013
179580                                                                  17958013
179590              MOVE SQLCODE              TO PV-DISP-SQLCODE        17959013
179600              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             17960013
179610              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           17961013
179620              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        17962013
179630                                                                  17963013
179640              STRING  'SUKCS782 7230-'                            17964099
179650                      ' DC:'               PV-DISP-DC             17965013
179660                      ' B1:'               SU054-BAR-CODE-1       17966013
179670                      ' B2:'               SU054-BAR-CODE-2       17967013
179680                      ' B3:'               SU054-BAR-CODE-3       17968013
179690                                           DELIMITED BY SIZE      17969013
179700                                      INTO PV-CICS-MSG-AREA1      17970013
179710                                                                  17971013
179720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17972013
179730              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     17973013
179740                                                                  17974013
179750              PERFORM 9999-WRITE-TO-CSSL                          17975013
179760                                                                  17976013
179770              STRING  'SUKCS782 '          SU054-KOHLS-SML        17977099
179780                      ' TRIP:'             PV-DISP-TRIP           17978013
179790                      ' DR:'               SU054-DOOR-NUMBER      17979013
179800                      ' USR:'              SU054-USER-ID          17980013
179810                      ' STA:'              PV-DISP-PNA-STA        17981013
179820                      ' SQL:'              PV-DISP-SQLCODE        17982013
179830                      ' TPURCHS/TVNDDPT/TRECITM/TPURITM'          17983013
179840                                           DeLIMITED BY SIZE      17984013
179850                                      INTO PV-CICS-MSG-AREA2      17985013
179860                                                                  17986013
179870              MOVE SPACES               TO PV-CICS-MSG-AREA-A     17987013
179880              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     17988013
179890                                                                  17989013
179900              PERFORM 9999-WRITE-TO-CSSL                          17990013
179910                                                                  17991013
179920              INITIALIZE PV-CICS-MSG-AREA3                        17992013
179930                                                                  17993013
179940              MOVE DK-PO               TO PV-DISP-PO              17994013
179950              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR            17995013
179960              MOVE DK-PO-LNE-NBR       TO PV-DISP-LINE            17996013
179970                                                                  17997013
179980              STRING  'SUKCS782 '                                 17998099
179990                      ' PO:'               PV-DISP-PO             17999013
180000                      '-'                  PV-DISP-RCVR           18000013
180010                      '-'                  PV-DISP-LINE           18001013
180020                                           DELIMITED BY SIZE      18002013
180030                                      INTO PV-CICS-MSG-AREA3      18003013
180040                                                                  18004013
180050              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18005013
180060              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     18006013
180070                                                                  18007013
180080              PERFORM 9999-WRITE-TO-CSSL                          18008013
180090                                                                  18009013
180100             SET PS-PROCESSING-ERROR-YES TO TRUE                  18010013
180110             PERFORM 9998-WRITE-TO-CSSL                           18011013
180120     END-EVALUATE.                                                18012013
180130                                                                  18013013
180140                                                                  18014013
180150*----------------------------------------------------------------*18015013
180160*                                                                *18016013
180170*                                                                *18017013
180180*  2014-12-03 - DMH - ADDED "WITH UR" TO SQL                     *18018013
180190*----------------------------------------------------------------*18019013
180200 7233-CHECK-EAS-TAG.                                              18020013
180210*                                                                 18021013
180220** added internal table to track paragraph execution time         18022013
180230** dmh 2014-12-22 - begin                                         18023013
180240*                                                                 18024013
180250     MOVE  '7233'  TO  PT-CURR-PARA.                              18025013
180260     IF  PS-BLD-INTERNAL-TABLE-YES                                18026013
180270         PERFORM 0200-INTERNAL-TABLE                              18027013
180280     ELSE                                                         18028013
180290         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       18029013
180300     END-IF.                                                      18030013
180310                                                                  18031013
180320*                                                                 18032013
180330** DMH 2014-12-22 - END                                           18033013
180340*                                                                 18034013
180350                                                                  18035013
180360     MOVE PURITM-UNT-RTL-PR-AMT TO SFT00000-BEG-PRPT-AMT.         18036013
180370                                                                  18037013
180380     EXEC SQL                                                     18038013
180390          SELECT DEPT_NBR                                         18039013
180400          INTO  :SFT00000-DEPT-NBR                                18040013
180410          FROM   SFT_EAS_TG_MDSE                                  18041013
180420          WHERE ( DEPT_NBR        = :XL001-DEPT-NBR               18042013
180430                AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR             18043013
180440                AND SUB_CL_NBR    = :XL001-SUB-CL-NBR )           18044013
180450            OR  ( DEPT_NBR        = :XL001-DEPT-NBR               18045013
180460                AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR             18046013
180470                AND SUB_CL_NBR IS NULL )                          18047013
180480            AND BEG_PRPT_AMT      <= :SFT00000-BEG-PRPT-AMT       18048013
180490           WITH UR                                                18049013
180500     END-EXEC.                                                    18050013
180510                                                                  18051013
180520     EVALUATE TRUE                                                18052013
180530         WHEN SQLCODE = ZERO                                      18053013
180540              SET PS-EAS-TAG-IND-FOUND-YES TO TRUE                18054013
180550         WHEN SQLCODE = +100                                      18055013
180560              SET PS-EAS-TAG-IND-FOUND-NO  TO TRUE                18056013
180570         WHEN SQLWARN0 NOT = SPACES                               18057013
180580         WHEN SQLCODE NOT EQUAL ZERO                              18058013
180590                                                                  18059013
180600              INITIALIZE PV-CICS-MSG-AREA1                        18060013
180610              INITIALIZE PV-CICS-MSG-AREA2                        18061013
180620                                                                  18062013
180630              MOVE SQLCODE              TO PV-DISP-SQLCODE        18063013
180640              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18064013
180650              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18065013
180660              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18066013
180670                                                                  18067013
180680              STRING  'SUKCS782 7233-'                            18068099
180690                      ' DC:'               PV-DISP-DC             18069013
180700                      ' B1:'               SU054-BAR-CODE-1       18070013
180710                      ' B2:'               SU054-BAR-CODE-2       18071013
180720                      ' B3:'               SU054-BAR-CODE-3       18072013
180730                                           DELIMITED BY SIZE      18073013
180740                                      INTO PV-CICS-MSG-AREA1      18074013
180750                                                                  18075013
180760              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18076013
180770              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18077013
180780                                                                  18078013
180790              PERFORM 9999-WRITE-TO-CSSL                          18079013
180800                                                                  18080013
180810              STRING  'SUKCS782 '          SU054-KOHLS-SML        18081099
180820                      ' TRIP:'             PV-DISP-TRIP           18082013
180830                      ' DR:'               SU054-DOOR-NUMBER      18083013
180840                      ' USR:'              SU054-USER-ID          18084013
180850                      ' STA:'              PV-DISP-PNA-STA        18085013
180860                      ' SQL:'              PV-DISP-SQLCODE        18086013
180870                      ' SFT_EAS_TG_MDSE'                          18087013
180880                                           DeLIMITED BY SIZE      18088013
180890                                      INTO PV-CICS-MSG-AREA2      18089013
180900                                                                  18090013
180910              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18091013
180920              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18092013
180930                                                                  18093013
180940              PERFORM 9999-WRITE-TO-CSSL                          18094013
180950                                                                  18095013
180960              INITIALIZE PV-CICS-MSG-AREA3                        18096013
180970                                                                  18097013
180980              MOVE  XL001-DEPT-NBR    TO  PV-DISP-DEPT            18098013
180990              MOVE  XL001-MAJ-CL-NBR  TO  PV-DISP-MAJ-CL          18099013
181000              MOVE  XL001-SUB-CL-NBR  TO  PV-DISP-SUB-CL          18100013
181010              move  SFT00000-BEG-PRPT-AMT to  pv-disp-prpt-amt    18101013
181020                                                                  18102013
181030              STRING  'SUKCS782 '                                 18103099
181040                      ' DEPT:'             PV-DISP-dept           18104013
181050                      ' MAJ CL:'           PV-DISP-MAJ-CL         18105013
181060                      ' SUB CL:'           PV-DISP-SUB-CL         18106013
181070                      ' BEG PRPT AMT:'     pv-disp-prpt-amt       18107013
181080                                           DELIMITED BY SIZE      18108013
181090                                      INTO PV-CICS-MSG-AREA3      18109013
181100                                                                  18110013
181110              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18111013
181120              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     18112013
181130                                                                  18113013
181140              PERFORM 9999-WRITE-TO-CSSL                          18114013
181150                                                                  18115013
181160             SET PS-PROCESSING-ERROR-YES TO TRUE                  18116013
181170             PERFORM 9998-WRITE-TO-CSSL                           18117013
181180     END-EVALUATE.                                                18118013
181190                                                                  18119013
181200*----------------------------------------------------------------*18120013
181210*                                                                *18121013
181220*                                                                *18122013
181230*  2014-12-03 - DMH - ADDED "WITH UR" TO SQL                     *18123013
181240*----------------------------------------------------------------*18124013
181250 7234-GET-CURRENT-DOOR.                                           18125013
181260*                                                                 18126013
181270** added internal table to track paragraph execution time         18127013
181280** dmh 2014-12-22 - begin                                         18128013
181290*                                                                 18129013
181300     MOVE  '7234'  TO  PT-CURR-PARA.                              18130013
181310     IF  PS-BLD-INTERNAL-TABLE-YES                                18131013
181320         PERFORM 0200-INTERNAL-TABLE                              18132013
181330     ELSE                                                         18133013
181340         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       18134013
181350     END-IF.                                                      18135013
181360                                                                  18136013
181370*                                                                 18137013
181380** DMH 2014-12-22 - END                                           18138013
181390*                                                                 18139013
181400                                                                  18140013
181410     MOVE PV-DEST-STORE TO CNDRST-STR-NBR.                        18141013
181420     MOVE SU054-DC-NUMBER TO CNDCDR-OPER-UNT-ID.                  18142013
181430                                                                  18143013
181440     EXEC SQL                                                     18144013
181450          SELECT A.DOOR_ID                                        18145013
181460          INTO   :CNDCDR-DOOR-ID                                  18146013
181470          FROM   TCNDCDR A                                        18147013
181480               , TCNDRST B                                        18148013
181490          WHERE  A.DOOR_ID         = B.DOOR_ID                    18149013
181500            AND  A.OPER_UNT_ID     = B.OPER_UNT_ID                18150013
181510            AND  A.OPER_UNT_ID     = :CNDCDR-OPER-UNT-ID          18151013
181520            AND  A.DOOR_TYP_CDE    = 'SH'                         18152013
181530            AND  B.STR_NBR         = :CNDRST-STR-NBR              18153013
181540            AND  B.END_TMST        = '9999-09-09-09.09.09.999999' 18154013
181550            AND  NOT   (DOOR_LOC_DESC  LIKE  '%UPS%'     OR       18155013
181560                        DOOR_LOC_DESC  LIKE  '%VIRTUAL%' OR       18156013
181570                        DOOR_LOC_DESC  LIKE  '%RE-OPEN%'          18157013
181580                       )                                          18158013
181590           WITH UR                                                18159013
181600     END-EXEC.                                                    18160013
181610                                                                  18161013
181620     EVALUATE TRUE                                                18162013
181630         WHEN SQLCODE = ZERO                                      18163013
181640              CONTINUE                                            18164013
181650         WHEN SQLCODE = +100                                      18165013
181660         WHEN SQLCODE = -811                                      18166013
181670              MOVE SPACES TO CNDCDR-DOOR-ID                       18167013
181680         WHEN SQLWARN0 NOT = SPACES                               18168013
181690         WHEN SQLCODE NOT EQUAL ZERO                              18169013
181700                                                                  18170013
181710              INITIALIZE PV-CICS-MSG-AREA1                        18171013
181720              INITIALIZE PV-CICS-MSG-AREA2                        18172013
181730                                                                  18173013
181740              MOVE SQLCODE              TO PV-DISP-SQLCODE        18174013
181750              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18175013
181760              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18176013
181770              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18177013
181780                                                                  18178013
181790              STRING  'SUKCS782 7234-'                            18179099
181800                      ' DC:'               PV-DISP-DC             18180013
181810                      ' B1:'               SU054-BAR-CODE-1       18181013
181820                      ' B2:'               SU054-BAR-CODE-2       18182013
181830                      ' B3:'               SU054-BAR-CODE-3       18183013
181840                                           DELIMITED BY SIZE      18184013
181850                                      INTO PV-CICS-MSG-AREA1      18185013
181860                                                                  18186013
181870              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18187013
181880              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18188013
181890                                                                  18189013
181900              PERFORM 9999-WRITE-TO-CSSL                          18190013
181910                                                                  18191013
181920              STRING  'SUKCS782 '          SU054-KOHLS-SML        18192099
181930                      ' TRIP:'             PV-DISP-TRIP           18193013
181940                      ' DR:'               SU054-DOOR-NUMBER      18194013
181950                      ' USR:'              SU054-USER-ID          18195013
181960                      ' STA:'              PV-DISP-PNA-STA        18196013
181970                      ' SQL:'              PV-DISP-SQLCODE        18197013
181980                      ' TCNDCDR/TCNDRST'                          18198013
181990                                           DeLIMITED BY SIZE      18199013
182000                                      INTO PV-CICS-MSG-AREA2      18200013
182010                                                                  18201013
182020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18202013
182030              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18203013
182040                                                                  18204013
182050              PERFORM 9999-WRITE-TO-CSSL                          18205013
182060                                                                  18206013
182070              INITIALIZE PV-CICS-MSG-AREA3                        18207013
182080                                                                  18208013
182090              MOVE CNDRST-STR-NBR      TO  PV-DISP-STR            18209013
182100              MOVE CNDCDR-OPER-UNT-ID  TO  PV-DISP-OPER           18210013
182110                                                                  18211013
182120              STRING  'SUKCS782 '                                 18212099
182130                      ' OPER:'             PV-DISP-OPER           18213013
182140                      ' STORE:'            PV-DISP-STR            18214013
182150                                           DELIMITED BY SIZE      18215013
182160                                      INTO PV-CICS-MSG-AREA3      18216013
182170                                                                  18217013
182180              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18218013
182190              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     18219013
182200                                                                  18220013
182210              PERFORM 9999-WRITE-TO-CSSL                          18221013
182220                                                                  18222013
182230             SET PS-PROCESSING-ERROR-YES TO TRUE                  18223013
182240             PERFORM 9998-WRITE-TO-CSSL                           18224013
182250     END-EVALUATE.                                                18225013
182260                                                                  18226013
182270*----------------------------------------------------------------*18227013
182280*                                                                *18228013
182290*                                                                *18229013
182300*  2014-12-03 - DMH - ADDED "WITH UR" TO SQL                     *18230013
182310*----------------------------------------------------------------*18231013
182320 7235-GET-OUTER-PACK.                                             18232013
182330*                                                                 18233013
182340** added internal table to track paragraph execution time         18234013
182350** dmh 2014-12-22 - begin                                         18235013
182360*                                                                 18236013
182370     MOVE  '7235'  TO  PT-CURR-PARA.                              18237013
182380     IF  PS-BLD-INTERNAL-TABLE-YES                                18238013
182390         PERFORM 0200-INTERNAL-TABLE                              18239013
182400     ELSE                                                         18240013
182410         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       18241013
182420     END-IF.                                                      18242013
182430                                                                  18243013
182440*                                                                 18244013
182450** DMH 2014-12-22 - END                                           18245013
182460*                                                                 18246013
182470                                                                  18247013
182480*CLP 04/08/14 - START - ADDED NULL CHECK                          18248013
182490     EXEC SQL                                                     18249013
182500          SELECT  SUM(SHPD_QTY)                                   18250013
182510            INTO :PV-SHIPPED-QTY  :PV-NULL-IND                    18251013
182520            FROM  TSHUUPC                                         18252013
182530           WHERE  SHIPT_UNT_ID  = :DK-CTN                         18253013
182540            WITH UR                                               18254013
182550     END-EXEC                                                     18255013
182560                                                                  18256013
182570     EVALUATE TRUE                                                18257013
182580         WHEN SQLCODE = ZERO                                      18258013
182590             MOVE PV-SHIPPED-QTY      TO  PV-OUTR-PACK-QTY        18259013
182600         WHEN SQLCODE = -310                                      18260013
182610             MOVE 0                   TO  PV-OUTR-PACK-QTY        18261013
182620         WHEN SQLWARN0 NOT = SPACES                               18262013
182630         WHEN SQLCODE NOT EQUAL ZERO                              18263013
182640                                                                  18264013
182650              INITIALIZE PV-CICS-MSG-AREA1                        18265013
182660              INITIALIZE PV-CICS-MSG-AREA2                        18266013
182670                                                                  18267013
182680              MOVE SQLCODE              TO PV-DISP-SQLCODE        18268013
182690              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18269013
182700              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18270013
182710              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18271013
182720                                                                  18272013
182730              STRING  'SUKCS782 7235-'                            18273099
182740                      ' DC:'               PV-DISP-DC             18274013
182750                      ' B1:'               SU054-BAR-CODE-1       18275013
182760                      ' B2:'               SU054-BAR-CODE-2       18276013
182770                      ' B3:'               SU054-BAR-CODE-3       18277013
182780                                           DELIMITED BY SIZE      18278013
182790                                      INTO PV-CICS-MSG-AREA1      18279013
182800                                                                  18280013
182810              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18281013
182820              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18282013
182830                                                                  18283013
182840              PERFORM 9999-WRITE-TO-CSSL                          18284013
182850                                                                  18285013
182860              STRING  'SUKCS782 '          SU054-KOHLS-SML        18286099
182870                      ' TRIP:'             PV-DISP-TRIP           18287013
182880                      ' DR:'               SU054-DOOR-NUMBER      18288013
182890                      ' USR:'              SU054-USER-ID          18289013
182900                      ' STA:'              PV-DISP-PNA-STA        18290013
182910                      ' SQL:'              PV-DISP-SQLCODE        18291013
182920                      ' TSHUUPC'                                  18292013
182930                                           DeLIMITED BY SIZE      18293013
182940                                      INTO PV-CICS-MSG-AREA2      18294013
182950                                                                  18295013
182960              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18296013
182970              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18297013
182980                                                                  18298013
182990              PERFORM 9999-WRITE-TO-CSSL                          18299013
183000                                                                  18300013
183010              INITIALIZE PV-CICS-MSG-AREA3                        18301013
183020                                                                  18302013
183030              MOVE DK-CTN              TO  PV-DISP-SSCC           18303013
183040                                                                  18304013
183050              STRING  'SUKCS782 '                                 18305099
183060                      ' SSCC:'             PV-DISP-SSCC           18306013
183070                                           DELIMITED BY SIZE      18307013
183080                                      INTO PV-CICS-MSG-AREA3      18308013
183090                                                                  18309013
183100              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18310013
183110              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     18311013
183120                                                                  18312013
183130              PERFORM 9999-WRITE-TO-CSSL                          18313013
183140                                                                  18314013
183150             SET PS-PROCESSING-ERROR-YES TO TRUE                  18315013
183160             PERFORM 9998-WRITE-TO-CSSL                           18316013
183170     END-EVALUATE.                                                18317013
183180                                                                  18318013
183190*----------------------------------------------------------------*18319013
183200*                                                                *18320013
183210*                                                                *18321013
183220*  2014-12-03 - DMH - ADDED "WITH UR" TO SQL                     *18322013
183230*----------------------------------------------------------------*18323013
183240 7236-CHECK-BRAND.                                                18324013
183250*                                                                 18325013
183260** added internal table to track paragraph execution time         18326013
183270** dmh 2014-12-22 - begin                                         18327013
183280*                                                                 18328013
183290     MOVE  '7236'  TO  PT-CURR-PARA.                              18329013
183300     IF  PS-BLD-INTERNAL-TABLE-YES                                18330013
183310         PERFORM 0200-INTERNAL-TABLE                              18331013
183320     ELSE                                                         18332013
183330         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       18333013
183340     END-IF.                                                      18334013
183350                                                                  18335013
183360*                                                                 18336013
183370** DMH 2014-12-22 - END                                           18337013
183380*                                                                 18338013
183390                                                                  18339013
183400     MOVE XL001-SKU-NBR TO XLT00003-SKU-NBR.                      18340013
183410                                                                  18341013
183420     EXEC SQL                                                     18342013
183430        SELECT  BRND_DESC                                         18343013
183440         INTO   :XLT00043-BRND-DESC                               18344013
183450          FROM  XLT_SKU      A                                    18345013
183460             ,  XLT_VND_STYL B                                    18346013
183470             ,  XLT_BRND     C                                    18347013
183480         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            18348013
183490           AND  A.STYL_ID         =  B.STYL_ID                    18349013
183500           AND  B.BRND_ID         =  C.BRND_ID                    18350013
183510           AND  C.BRND_ID         >  0                            18351013
183520         WITH UR                                                  18352013
183530     END-EXEC.                                                    18353013
183540                                                                  18354013
183550     EVALUATE TRUE                                                18355013
183560         WHEN SQLCODE = ZERO                                      18356013
183570              SET PS-BRAND-FOUND-YES TO TRUE                      18357013
183580         WHEN SQLCODE = +100                                      18358013
183590              SET PS-BRAND-FOUND-NO TO TRUE                       18359013
183600         WHEN SQLWARN0 NOT = SPACES                               18360013
183610         WHEN SQLCODE NOT EQUAL ZERO                              18361013
183620                                                                  18362013
183630              INITIALIZE PV-CICS-MSG-AREA1                        18363013
183640              INITIALIZE PV-CICS-MSG-AREA2                        18364013
183650                                                                  18365013
183660              MOVE SQLCODE              TO PV-DISP-SQLCODE        18366013
183670              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18367013
183680              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18368013
183690              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18369013
183700                                                                  18370013
183710              STRING  'SUKCS782 7236-'                            18371099
183720                      ' DC:'               PV-DISP-DC             18372013
183730                      ' B1:'               SU054-BAR-CODE-1       18373013
183740                      ' B2:'               SU054-BAR-CODE-2       18374013
183750                      ' B3:'               SU054-BAR-CODE-3       18375013
183760                                           DELIMITED BY SIZE      18376013
183770                                      INTO PV-CICS-MSG-AREA1      18377013
183780                                                                  18378013
183790              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18379013
183800              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18380013
183810                                                                  18381013
183820              PERFORM 9999-WRITE-TO-CSSL                          18382013
183830                                                                  18383013
183840              STRING  'SUKCS782 '          SU054-KOHLS-SML        18384099
183850                      ' TRIP:'             PV-DISP-TRIP           18385013
183860                      ' DR:'               SU054-DOOR-NUMBER      18386013
183870                      ' USR:'              SU054-USER-ID          18387013
183880                      ' STA:'              PV-DISP-PNA-STA        18388013
183890                      ' SQL:'              PV-DISP-SQLCODE        18389013
183900                      ' XLT_BRND/XLT_VND_STYL/XLT_SKU'            18390013
183910                                           DeLIMITED BY SIZE      18391013
183920                                      INTO PV-CICS-MSG-AREA2      18392013
183930                                                                  18393013
183940              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18394013
183950              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18395013
183960                                                                  18396013
183970              PERFORM 9999-WRITE-TO-CSSL                          18397013
183980                                                                  18398013
183990              INITIALIZE PV-CICS-MSG-AREA3                        18399013
184000                                                                  18400013
184010              MOVE XLT00003-SKU-NBR  TO  PV-DISP-SKU              18401013
184020                                                                  18402013
184030              STRING  'SUKCS782 '                                 18403099
184040                      ' sku:'              pv-disp-sku            18404013
184050                                           DELIMITED BY SIZE      18405013
184060                                      INTO PV-CICS-MSG-AREA3      18406013
184070                                                                  18407013
184080              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18408013
184090              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     18409013
184100                                                                  18410013
184110              PERFORM 9999-WRITE-TO-CSSL                          18411013
184120                                                                  18412013
184130             SET PS-PROCESSING-ERROR-YES TO TRUE                  18413013
184140             PERFORM 9998-WRITE-TO-CSSL                           18414013
184150     END-EVALUATE.                                                18415013
184160                                                                  18416013
184170                                                                  18417013
184180 7240-CALL-XLKUT-DOMAIN.                                          18418013
184190*                                                                 18419013
184200** added internal table to track paragraph execution time         18420013
184210** dmh 2014-12-22 - begin                                         18421013
184220*                                                                 18422013
184230     MOVE  '7240'  TO  PT-CURR-PARA.                              18423013
184240     IF  PS-BLD-INTERNAL-TABLE-YES                                18424013
184250         PERFORM 0200-INTERNAL-TABLE                              18425013
184260     ELSE                                                         18426013
184270         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       18427013
184280     END-IF.                                                      18428013
184290                                                                  18429013
184300*                                                                 18430013
184310** DMH 2014-12-22 - END                                           18431013
184320*                                                                 18432013
184330     INITIALIZE XL001-ITEM-COMMAREA.                              18433013
184340                                                                  18434013
184350     MOVE RECITM-ITM-NBR        TO XL001-KEY-ITM-NBR.             18435013
184360                                                                  18436013
184370     SET  XL001-BY-ITEM                                           18437013
184380          XL001-SELECT-SKU                                        18438013
184390          XL001-SELECT-VND-STYL TO TRUE.                          18439013
184400                                                                  18440013
184410     CALL XL001-VSM-PGM USING  DFHEIBLK                           18441013
184420                               XL001-COMMAREA                     18442013
184430                               XL001-ITEM-COMMAREA.               18443013
184440     EVALUATE TRUE                                                18444013
184450                                                                  18445013
184460         WHEN XL001-SKU-SQLCODE = +0                              18446013
184470             CONTINUE                                             18447013
184480                                                                  18448013
184490         WHEN XL001-SKU-SQLCODE = +100                            18449013
184500             MOVE SPACES              TO XL001-DEPT-NBR-3CH       18450013
184510                                         XL001-SUB-CL-NBR-2CH     18451013
184520             MOVE ZEROES              TO XL001-SKU-NBR            18452013
184530                                                                  18453013
184540         WHEN XL001-INVALID-ACCESS                                18454013
184550                                                                  18455013
184560              INITIALIZE PV-CICS-MSG-AREA1                        18456013
184570              INITIALIZE PV-CICS-MSG-AREA2                        18457013
184580                                                                  18458013
184590              MOVE SQLCODE              TO PV-DISP-SQLCODE        18459013
184600              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18460013
184610              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18461013
184620              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18462013
184630                                                                  18463013
184640              STRING  'SUKCS782 7240-'                            18464099
184650                      ' DC:'               PV-DISP-DC             18465013
184660                      ' B1:'               SU054-BAR-CODE-1       18466013
184670                      ' B2:'               SU054-BAR-CODE-2       18467013
184680                      ' B3:'               SU054-BAR-CODE-3       18468013
184690                                           DELIMITED BY SIZE      18469013
184700                                      INTO PV-CICS-MSG-AREA1      18470013
184710                                                                  18471013
184720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18472013
184730              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18473013
184740                                                                  18474013
184750              PERFORM 9999-WRITE-TO-CSSL                          18475013
184760                                                                  18476013
184770              STRING  'SUKCS782 '          SU054-KOHLS-SML        18477099
184780                      ' TRIP:'             PV-DISP-TRIP           18478013
184790                      ' DR:'               SU054-DOOR-NUMBER      18479013
184800                      ' USR:'              SU054-USER-ID          18480013
184810                      ' STA:'              PV-DISP-PNA-STA        18481013
184820                      ' SQL:'              PV-DISP-SQLCODE        18482013
184830                      ' XLV_SKU - INVALID ACCESS'                 18483013
184840                                           DeLIMITED BY SIZE      18484013
184850                                      INTO PV-CICS-MSG-AREA2      18485013
184860                                                                  18486013
184870              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18487013
184880              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18488013
184890                                                                  18489013
184900              PERFORM 9999-WRITE-TO-CSSL                          18490013
184910                                                                  18491013
184920              INITIALIZE PV-CICS-MSG-AREA3                        18492013
184930                                                                  18493013
184940              MOVE XL001-KEY-ITM-NBR      TO  PV-DISP-ITM         18494013
184950              MOVE XL001-SKU-SQLCODE      TO  PV-DISP-SQL1        18495013
184960              MOVE XL001-VND-STYL-SQLCODE TO  PV-DISP-SQL2        18496013
184970              MOVE XL001-SKU-STR-SQLCODE  TO  PV-DISP-SQL3        18497013
184980              MOVE XL001-UPC-SQLCODE      TO  PV-DISP-SQL4        18498013
184990              MOVE XL001-WEB-SKU-SQLCODE  TO  PV-DISP-SQL5        18499013
185000                                                                  18500013
185010              STRING  'SUKCS782 (XLKUT001)'                       18501099
185020                      ' ACCESS:'           XL001-ACCESS-METHOD    18502013
185030                      ' SELECT:'           XL001-VIEW-SELECTION   18503013
185040                      '-'                                         18504013
185050                      ' ITM NBR:'          PV-DISP-ITM            18505013
185060                      ' RC:'               XL001-RETURN-CODE      18506013
185070                      ' SKU SQL:'          PV-DISP-SQL1           18507013
185080                      ' STYL SQL:'         PV-DISP-SQL2           18508013
185090                      ' SKUSTR SQL:'       PV-DISP-SQL3           18509013
185100                      ' UPC SQL:'          PV-DISP-SQL4           18510013
185110                      ' WEB SQL:'          PV-DISP-SQL5           18511013
185120                                           DELIMITED BY SIZE      18512013
185130                                      INTO PV-CICS-MSG-AREA4      18513013
185140                                                                  18514013
185150              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18515013
185160              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     18516013
185170                                                                  18517013
185180              PERFORM 9999-WRITE-TO-CSSL                          18518013
185190                                                                  18519013
185200              INITIALIZE PV-CICS-MSG-AREA4                        18520013
185210                                                                  18521013
185220              MOVE XL001-INTR-UPC-ID      TO  PV-DISP-UPCID       18522013
185230              MOVE XL001-STYL-ID          TO  PV-DISP-STYL        18523013
185240              MOVE XL001-ITM-NBR          TO  PV-DISP-ITM         18524013
185250              MOVE XL001-SKU-NBR          TO  PV-DISP-SKU         18525013
185260              MOVE XL001-INNR-PACK-QTY    TO  PV-DISP-INPK        18526013
185270              MOVE XL001-OUTR-PACK-QTY    TO  PV-DISP-OTPK        18527013
185280                                                                  18528013
185290              STRING  'SUKCS782 '                                 18529099
185300                      ' PARA:'      XL001-ERROR-PARAGRAPH-NBR     18530013
185310                      ' CONTENTN:'  XL001-CONTENTION-ERR-PARA-NBR 18531013
185320                      ' UPCID:'            PV-DISP-UPCID          18532013
185330                      ' STYL:'             PV-DISP-STYL           18533013
185340                      ' ITM:'              PV-DISP-ITM            18534013
185350                      ' SKU:'              PV-DISP-SKU            18535013
185360                      ' INPK:'             PV-DISP-INPK           18536013
185370                      ' OTPK:'             PV-DISP-OTPK           18537013
185380                      ' DESC:'             XL001-SKU-DESC         18538013
185390                                           DELIMITED BY SIZE      18539013
185400                                      INTO PV-CICS-MSG-AREA4      18540013
185410                                                                  18541013
185420              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18542013
185430              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     18543013
185440                                                                  18544013
185450              PERFORM 9999-WRITE-TO-CSSL                          18545013
185460                                                                  18546013
185470              INITIALIZE PV-CICS-MSG-AREA5                        18547013
185480                                                                  18548013
185490              MOVE XL001-KOHLS-SIZE-CDE   TO  PV-DISP-SIZE        18549013
185500                                                                  18550013
185510              STRING  'SUKCS782 '                                 18551099
185520                      ' SZ:'               PV-DISP-SIZE           18552013
185530                      '-'                  XL001-SIZE-DESC        18553013
185540                      ' NRF CL:'           XL001-NRF-CLOR-CDE     18554013
185550                      ' SHRT CL:'          XL001-SHRT-CLOR-DESC   18555013
185560                      ' CSTM CL:'          XL001-CSTM-CLOR-DESC   18556013
185570                      ' RGN:'              XL001-REGN-PRIC-IND    18557013
185580                      ' KY:'               XL001-KY-ITM-IND       18558013
185590                      ' GP:'               XL001-GP-CDE           18559013
185600                      ' STAT:'             XL001-SKU-STAT-CDE     18560013
185610                      '-'                  XL001-SKU-STAT-DESC    18561013
185620                                           DELIMITED BY SIZE      18562013
185630                                      INTO PV-CICS-MSG-AREA5      18563013
185640                                                                  18564013
185650              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18565013
185660              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     18566013
185670                                                                  18567013
185680              PERFORM 9999-WRITE-TO-CSSL                          18568013
185690                                                                  18569013
185700              INITIALIZE PV-CICS-MSG-AREA6                        18570013
185710                                                                  18571013
185720              MOVE XL001-VS-ID            TO  PV-DISP-styl        18572013
185730              MOVE XL001-ENT-ID           TO  PV-DISP-ENT-ID      18573013
185740              MOVE XL001-STKR-NBR         TO  PV-DISP-STKR-NBR    18574013
185750                                                                  18575013
185760              STRING  'SUKCS782 '                                 18576099
185770                      ' '                  XL001-DEPT-NBR-3CH     18577013
185780                      '-'                  XL001-MAJ-CL-NBR-2CH   18578013
185790                      '-'                  XL001-SUB-CL-NBR-2CH   18579013
185800                      ' VS ID:'            PV-DISP-styl           18580013
185810                      ' CSTM CL:'          XL001-VS-NBR           18581013
185820                      ' ENT ID:'           PV-DISP-ENT-ID         18582013
185830                      ' STKR:'             PV-DISP-STKR-NBR       18583013
185840                      ' TKT:'              XL001-TKT-TYP-DESC     18584013
185850                      ' H/F:'              XL001-HNG-FOLD-CDE     18585013
185860                      '-'                  XL001-HNG-FOLD-DESC    18586013
185870                                           DELIMITED BY SIZE      18587013
185880                                      INTO PV-CICS-MSG-AREA6      18588013
185890                                                                  18589013
185900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18590013
185910              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     18591013
185920                                                                  18592013
185930              PERFORM 9999-WRITE-TO-CSSL                          18593013
185940                                                                  18594013
185950             SET PS-PROCESSING-ERROR-YES TO TRUE                  18595013
185960             PERFORM 9998-WRITE-TO-CSSL                           18596013
185970                                                                  18597013
185980         WHEN OTHER                                               18598013
185990                                                                  18599013
186000              INITIALIZE PV-CICS-MSG-AREA1                        18600013
186010              INITIALIZE PV-CICS-MSG-AREA2                        18601013
186020                                                                  18602013
186030              MOVE SQLCODE              TO PV-DISP-SQLCODE        18603013
186040              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18604013
186050              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18605013
186060              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18606013
186070                                                                  18607013
186080              STRING  'SUKCS782 7240-'                            18608099
186090                      ' DC:'               PV-DISP-DC             18609013
186100                      ' B1:'               SU054-BAR-CODE-1       18610013
186110                      ' B2:'               SU054-BAR-CODE-2       18611013
186120                      ' B3:'               SU054-BAR-CODE-3       18612013
186130                                           DELIMITED BY SIZE      18613013
186140                                      INTO PV-CICS-MSG-AREA1      18614013
186150                                                                  18615013
186160              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18616013
186170              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18617013
186180                                                                  18618013
186190              PERFORM 9999-WRITE-TO-CSSL                          18619013
186200                                                                  18620013
186210              STRING  'SUKCS782 '          SU054-KOHLS-SML        18621099
186220                      ' TRIP:'             PV-DISP-TRIP           18622013
186230                      ' DR:'               SU054-DOOR-NUMBER      18623013
186240                      ' USR:'              SU054-USER-ID          18624013
186250                      ' STA:'              PV-DISP-PNA-STA        18625013
186260                      ' SQL:'              PV-DISP-SQLCODE        18626013
186270                      ' XLV_SKU - OTHER'                          18627013
186280                                           DeLIMITED BY SIZE      18628013
186290                                      INTO PV-CICS-MSG-AREA2      18629013
186300                                                                  18630013
186310              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18631013
186320              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18632013
186330                                                                  18633013
186340              PERFORM 9999-WRITE-TO-CSSL                          18634013
186350                                                                  18635013
186360              INITIALIZE PV-CICS-MSG-AREA3                        18636013
186370                                                                  18637013
186380              MOVE XL001-KEY-ITM-NBR      TO  PV-DISP-ITM         18638013
186390              MOVE XL001-SKU-SQLCODE      TO  PV-DISP-SQL1        18639013
186400              MOVE XL001-VND-STYL-SQLCODE TO  PV-DISP-SQL2        18640013
186410              MOVE XL001-SKU-STR-SQLCODE  TO  PV-DISP-SQL3        18641013
186420              MOVE XL001-UPC-SQLCODE      TO  PV-DISP-SQL4        18642013
186430              MOVE XL001-WEB-SKU-SQLCODE  TO  PV-DISP-SQL5        18643013
186440                                                                  18644013
186450              STRING  'SUKCS782 (XLKUT001)'                       18645099
186460                      ' ACCESS:'           XL001-ACCESS-METHOD    18646013
186470                      ' SELECT:'           XL001-VIEW-SELECTION   18647013
186480                      '-'                                         18648013
186490                      ' ITM NBR:'          PV-DISP-ITM            18649013
186500                      ' RC:'               XL001-RETURN-CODE      18650013
186510                      ' SKU SQL:'          PV-DISP-SQL1           18651013
186520                      ' STYL SQL:'         PV-DISP-SQL2           18652013
186530                      ' SKUSTR SQL:'       PV-DISP-SQL3           18653013
186540                      ' UPC SQL:'          PV-DISP-SQL4           18654013
186550                      ' WEB SQL:'          PV-DISP-SQL5           18655013
186560                                           DELIMITED BY SIZE      18656013
186570                                      INTO PV-CICS-MSG-AREA4      18657013
186580                                                                  18658013
186590              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18659013
186600              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     18660013
186610                                                                  18661013
186620              PERFORM 9999-WRITE-TO-CSSL                          18662013
186630                                                                  18663013
186640              INITIALIZE PV-CICS-MSG-AREA4                        18664013
186650                                                                  18665013
186660              MOVE XL001-INTR-UPC-ID      TO  PV-DISP-UPCID       18666013
186670              MOVE XL001-STYL-ID          TO  PV-DISP-STYL        18667013
186680              MOVE XL001-ITM-NBR          TO  PV-DISP-ITM         18668013
186690              MOVE XL001-SKU-NBR          TO  PV-DISP-SKU         18669013
186700              MOVE XL001-INNR-PACK-QTY    TO  PV-DISP-INPK        18670013
186710              MOVE XL001-OUTR-PACK-QTY    TO  PV-DISP-OTPK        18671013
186720                                                                  18672013
186730              STRING  'SUKCS782 '                                 18673099
186740                      ' PARA:'      XL001-ERROR-PARAGRAPH-NBR     18674013
186750                      ' CONTENTN:'  XL001-CONTENTION-ERR-PARA-NBR 18675013
186760                      ' UPCID:'            PV-DISP-UPCID          18676013
186770                      ' STYL:'             PV-DISP-STYL           18677013
186780                      ' ITM:'              PV-DISP-ITM            18678013
186790                      ' SKU:'              PV-DISP-SKU            18679013
186800                      ' INPK:'             PV-DISP-INPK           18680013
186810                      ' OTPK:'             PV-DISP-OTPK           18681013
186820                      ' DESC:'             XL001-SKU-DESC         18682013
186830                                           DELIMITED BY SIZE      18683013
186840                                      INTO PV-CICS-MSG-AREA4      18684013
186850                                                                  18685013
186860              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18686013
186870              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     18687013
186880                                                                  18688013
186890              PERFORM 9999-WRITE-TO-CSSL                          18689013
186900                                                                  18690013
186910              INITIALIZE PV-CICS-MSG-AREA5                        18691013
186920                                                                  18692013
186930              MOVE XL001-KOHLS-SIZE-CDE   TO  PV-DISP-SIZE        18693013
186940                                                                  18694013
186950              STRING  'SUKCS782 '                                 18695099
186960                      ' SZ:'               PV-DISP-SIZE           18696013
186970                      '-'                  XL001-SIZE-DESC        18697013
186980                      ' NRF CL:'           XL001-NRF-CLOR-CDE     18698013
186990                      ' SHRT CL:'          XL001-SHRT-CLOR-DESC   18699013
187000                      ' CSTM CL:'          XL001-CSTM-CLOR-DESC   18700013
187010                      ' RGN:'              XL001-REGN-PRIC-IND    18701013
187020                      ' KY:'               XL001-KY-ITM-IND       18702013
187030                      ' GP:'               XL001-GP-CDE           18703013
187040                      ' STAT:'             XL001-SKU-STAT-CDE     18704013
187050                      '-'                  XL001-SKU-STAT-DESC    18705013
187060                                           DELIMITED BY SIZE      18706013
187070                                      INTO PV-CICS-MSG-AREA5      18707013
187080                                                                  18708013
187090              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18709013
187100              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     18710013
187110                                                                  18711013
187120              PERFORM 9999-WRITE-TO-CSSL                          18712013
187130                                                                  18713013
187140              INITIALIZE PV-CICS-MSG-AREA6                        18714013
187150                                                                  18715013
187160              MOVE XL001-VS-ID            TO  PV-DISP-styl        18716013
187170              MOVE XL001-ENT-ID           TO  PV-DISP-ENT-ID      18717013
187180              MOVE XL001-STKR-NBR         TO  PV-DISP-STKR-NBR    18718013
187190                                                                  18719013
187200              STRING  'SUKCS782 '                                 18720099
187210                      ' '                  XL001-DEPT-NBR-3CH     18721013
187220                      '-'                  XL001-MAJ-CL-NBR-2CH   18722013
187230                      '-'                  XL001-SUB-CL-NBR-2CH   18723013
187240                      ' VS ID:'            PV-DISP-styl           18724013
187250                      ' CSTM CL:'          XL001-VS-NBR           18725013
187260                      ' ENT ID:'           PV-DISP-ENT-ID         18726013
187270                      ' STKR:'             PV-DISP-STKR-NBR       18727013
187280                      ' TKT:'              XL001-TKT-TYP-DESC     18728013
187290                      ' H/F:'              XL001-HNG-FOLD-CDE     18729013
187300                      '-'                  XL001-HNG-FOLD-DESC    18730013
187310                                           DELIMITED BY SIZE      18731013
187320                                      INTO PV-CICS-MSG-AREA6      18732013
187330                                                                  18733013
187340              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18734013
187350              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     18735013
187360                                                                  18736013
187370              PERFORM 9999-WRITE-TO-CSSL                          18737013
187380                                                                  18738013
187390             SET PS-PROCESSING-ERROR-YES TO TRUE                  18739013
187400             PERFORM 9998-WRITE-TO-CSSL                           18740013
187410     END-EVALUATE.                                                18741013
187420                                                                  18742013
187430*----------------------------------------------------------------*18743013
187440 7245-CALL-XLKUT-DOMAIN-BY-UPC.                                   18744013
187450*                                                                 18745013
187460** added internal table to track paragraph execution time         18746013
187470** dmh 2014-12-22 - begin                                         18747013
187480*                                                                 18748013
187490     MOVE  '7245'  TO  PT-CURR-PARA.                              18749013
187500     IF  PS-BLD-INTERNAL-TABLE-YES                                18750013
187510         PERFORM 0200-INTERNAL-TABLE                              18751013
187520     ELSE                                                         18752013
187530         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       18753013
187540     END-IF.                                                      18754013
187550                                                                  18755013
187560*                                                                 18756013
187570** DMH 2014-12-22 - END                                           18757013
187580*                                                                 18758013
187590     INITIALIZE XL001-ITEM-COMMAREA.                              18759013
187600                                                                  18760013
187610     MOVE SHUUPC-UPC-NBR        TO XL001-KEY-UPC-NBR.             18761013
187620                                                                  18762013
187630     SET  XL001-BY-UPC-NBR                                        18763013
187640          XL001-SELECT-SKU                                        18764013
187650          XL001-SELECT-VND-STYL TO TRUE.                          18765013
187660                                                                  18766013
187670     IF PS-ECOMM-DC-REPURPOSE                                     18767013
187680        SET XL001-SELECT-WEB-SKU TO TRUE                          18768013
187690     END-IF                                                       18769013
187700                                                                  18770013
187710     CALL XL001-VSM-PGM USING  DFHEIBLK                           18771013
187720                               XL001-COMMAREA                     18772013
187730                               XL001-ITEM-COMMAREA.               18773013
187740     EVALUATE TRUE                                                18774013
187750                                                                  18775013
187760         WHEN XL001-SUCCESSFUL                                    18776013
187770             MOVE XL001-HNG-FOLD-CDE TO PV-HANG-FOLD-IND          18777013
187780             IF PS-FIRST-UPC-CALL                                 18778013
187790                MOVE XL001-HNG-FOLD-CDE  TO                       18779013
187800                                         PV-PREV-HANG-FOLD-IND    18780013
187810                SET PS-NOT-FIRST-UPC-CALL TO TRUE                 18781013
187820             END-IF                                               18782013
187830                                                                  18783013
187840         WHEN XL001-UPC-NOT-FOUND                                 18784013
187850                MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR                    18785013
187860                SET  PS-EO-HANG-FOLD-CSR                          18786013
187870                     PS-WEIGHTS-MEAUSURES-CHECK TO TRUE           18787013
187880         WHEN XL001-WEB-ITEM-NOT-FOUND                            18788013
187890                SET  PS-WEIGHTS-MEAUSURES-CHECK TO TRUE           18789013
187900         WHEN XL001-INVALID-ACCESS                                18790013
187910                                                                  18791013
187920              INITIALIZE PV-CICS-MSG-AREA1                        18792013
187930              INITIALIZE PV-CICS-MSG-AREA2                        18793013
187940                                                                  18794013
187950              MOVE SQLCODE              TO PV-DISP-SQLCODE        18795013
187960              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18796013
187970              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18797013
187980              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18798013
187990                                                                  18799013
188000              STRING  'SUKCS782 7245-'                            18800099
188010                      ' DC:'               PV-DISP-DC             18801013
188020                      ' B1:'               SU054-BAR-CODE-1       18802013
188030                      ' B2:'               SU054-BAR-CODE-2       18803013
188040                      ' B3:'               SU054-BAR-CODE-3       18804013
188050                                           DELIMITED BY SIZE      18805013
188060                                      INTO PV-CICS-MSG-AREA1      18806013
188070                                                                  18807013
188080              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18808013
188090              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18809013
188100                                                                  18810013
188110              PERFORM 9999-WRITE-TO-CSSL                          18811013
188120                                                                  18812013
188130              STRING  'SUKCS782 '          SU054-KOHLS-SML        18813099
188140                      ' TRIP:'             PV-DISP-TRIP           18814013
188150                      ' DR:'               SU054-DOOR-NUMBER      18815013
188160                      ' USR:'              SU054-USER-ID          18816013
188170                      ' STA:'              PV-DISP-PNA-STA        18817013
188180                      ' SQL:'              PV-DISP-SQLCODE        18818013
188190                      ' XLV_UPC - INVALID ACCESS'                 18819013
188200                                           DeLIMITED BY SIZE      18820013
188210                                      INTO PV-CICS-MSG-AREA2      18821013
188220                                                                  18822013
188230              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18823013
188240              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18824013
188250                                                                  18825013
188260              PERFORM 9999-WRITE-TO-CSSL                          18826013
188270                                                                  18827013
188280              INITIALIZE PV-CICS-MSG-AREA3                        18828013
188290                                                                  18829013
188300              MOVE XL001-KEY-UPC-NBR      TO  PV-DISP-upc         18830013
188310              MOVE XL001-SKU-SQLCODE      TO  PV-DISP-SQL1        18831013
188320              MOVE XL001-VND-STYL-SQLCODE TO  PV-DISP-SQL2        18832013
188330              MOVE XL001-SKU-STR-SQLCODE  TO  PV-DISP-SQL3        18833013
188340              MOVE XL001-UPC-SQLCODE      TO  PV-DISP-SQL4        18834013
188350              MOVE XL001-WEB-SKU-SQLCODE  TO  PV-DISP-SQL5        18835013
188360                                                                  18836013
188370              STRING  'SUKCS782 (XLKUT001)'                       18837099
188380                      ' ACCESS:'           XL001-ACCESS-METHOD    18838013
188390                      ' SELECT:'           XL001-VIEW-SELECTION   18839013
188400                      '-'                                         18840013
188410                      ' upc NBR:'          PV-DISP-upc            18841013
188420                      ' RC:'               XL001-RETURN-CODE      18842013
188430                      ' SKU SQL:'          PV-DISP-SQL1           18843013
188440                      ' STYL SQL:'         PV-DISP-SQL2           18844013
188450                      ' SKUSTR SQL:'       PV-DISP-SQL3           18845013
188460                      ' UPC SQL:'          PV-DISP-SQL4           18846013
188470                      ' WEB SQL:'          PV-DISP-SQL5           18847013
188480                                           DELIMITED BY SIZE      18848013
188490                                      INTO PV-CICS-MSG-AREA3      18849013
188500                                                                  18850013
188510              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18851013
188520              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     18852013
188530                                                                  18853013
188540              PERFORM 9999-WRITE-TO-CSSL                          18854013
188550                                                                  18855013
188560              INITIALIZE PV-CICS-MSG-AREA4                        18856013
188570                                                                  18857013
188580              MOVE XL001-INTR-UPC-ID      TO  PV-DISP-UPCID       18858013
188590              MOVE XL001-STYL-ID          TO  PV-DISP-STYL        18859013
188600              MOVE XL001-ITM-NBR          TO  PV-DISP-ITM         18860013
188610              MOVE XL001-SKU-NBR          TO  PV-DISP-SKU         18861013
188620              MOVE XL001-INNR-PACK-QTY    TO  PV-DISP-INPK        18862013
188630              MOVE XL001-OUTR-PACK-QTY    TO  PV-DISP-OTPK        18863013
188640                                                                  18864013
188650              STRING  'SUKCS782 '                                 18865099
188660                      ' PARA:'      XL001-ERROR-PARAGRAPH-NBR     18866013
188670                      ' CONTENTN:'  XL001-CONTENTION-ERR-PARA-NBR 18867013
188680                      ' UPCID:'            PV-DISP-UPCID          18868013
188690                      ' STYL:'             PV-DISP-STYL           18869013
188700                      ' ITM:'              PV-DISP-ITM            18870013
188710                      ' SKU:'              PV-DISP-SKU            18871013
188720                      ' INPK:'             PV-DISP-INPK           18872013
188730                      ' OTPK:'             PV-DISP-OTPK           18873013
188740                      ' DESC:'             XL001-SKU-DESC         18874013
188750                                           DELIMITED BY SIZE      18875013
188760                                      INTO PV-CICS-MSG-AREA4      18876013
188770                                                                  18877013
188780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18878013
188790              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     18879013
188800                                                                  18880013
188810              PERFORM 9999-WRITE-TO-CSSL                          18881013
188820                                                                  18882013
188830              INITIALIZE PV-CICS-MSG-AREA5                        18883013
188840                                                                  18884013
188850              MOVE XL001-KOHLS-SIZE-CDE   TO  PV-DISP-SIZE        18885013
188860                                                                  18886013
188870              STRING  'SUKCS782 '                                 18887099
188880                      ' SZ:'               PV-DISP-SIZE           18888013
188890                      '-'                  XL001-SIZE-DESC        18889013
188900                      ' NRF CL:'           XL001-NRF-CLOR-CDE     18890013
188910                      ' SHRT CL:'          XL001-SHRT-CLOR-DESC   18891013
188920                      ' CSTM CL:'          XL001-CSTM-CLOR-DESC   18892013
188930                      ' RGN:'              XL001-REGN-PRIC-IND    18893013
188940                      ' KY:'               XL001-KY-ITM-IND       18894013
188950                      ' GP:'               XL001-GP-CDE           18895013
188960                      ' STAT:'             XL001-SKU-STAT-CDE     18896013
188970                      '-'                  XL001-SKU-STAT-DESC    18897013
188980                                           DELIMITED BY SIZE      18898013
188990                                      INTO PV-CICS-MSG-AREA5      18899013
189000                                                                  18900013
189010              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18901013
189020              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     18902013
189030                                                                  18903013
189040              PERFORM 9999-WRITE-TO-CSSL                          18904013
189050                                                                  18905013
189060              INITIALIZE PV-CICS-MSG-AREA6                        18906013
189070                                                                  18907013
189080              MOVE XL001-VS-ID            TO  PV-DISP-styl        18908013
189090              MOVE XL001-ENT-ID           TO  PV-DISP-ENT-ID      18909013
189100              MOVE XL001-STKR-NBR         TO  PV-DISP-STKR-NBR    18910013
189110                                                                  18911013
189120              STRING  'SUKCS782 '                                 18912099
189130                      ' '                  XL001-DEPT-NBR-3CH     18913013
189140                      '-'                  XL001-MAJ-CL-NBR-2CH   18914013
189150                      '-'                  XL001-SUB-CL-NBR-2CH   18915013
189160                      ' VS ID:'            PV-DISP-styl           18916013
189170                      ' CSTM CL:'          XL001-VS-NBR           18917013
189180                      ' ENT ID:'           PV-DISP-ENT-ID         18918013
189190                      ' STKR:'             PV-DISP-STKR-NBR       18919013
189200                      ' TKT:'              XL001-TKT-TYP-DESC     18920013
189210                      ' H/F:'              XL001-HNG-FOLD-CDE     18921013
189220                      '-'                  XL001-HNG-FOLD-DESC    18922013
189230                                           DELIMITED BY SIZE      18923013
189240                                      INTO PV-CICS-MSG-AREA6      18924013
189250                                                                  18925013
189260              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18926013
189270              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     18927013
189280                                                                  18928013
189290              PERFORM 9999-WRITE-TO-CSSL                          18929013
189300                                                                  18930013
189310             SET PS-PROCESSING-ERROR-YES TO TRUE                  18931013
189320             PERFORM 9998-WRITE-TO-CSSL                           18932013
189330                                                                  18933013
189340         WHEN OTHER                                               18934013
189350                                                                  18935013
189360              INITIALIZE PV-CICS-MSG-AREA1                        18936013
189370              INITIALIZE PV-CICS-MSG-AREA2                        18937013
189380                                                                  18938013
189390              MOVE SQLCODE              TO PV-DISP-SQLCODE        18939013
189400              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             18940013
189410              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           18941013
189420              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        18942013
189430                                                                  18943013
189440              STRING  'SUKCS782 7245-'                            18944099
189450                      ' DC:'               PV-DISP-DC             18945013
189460                      ' B1:'               SU054-BAR-CODE-1       18946013
189470                      ' B2:'               SU054-BAR-CODE-2       18947013
189480                      ' B3:'               SU054-BAR-CODE-3       18948013
189490                                           DELIMITED BY SIZE      18949013
189500                                      INTO PV-CICS-MSG-AREA1      18950013
189510                                                                  18951013
189520              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18952013
189530              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     18953013
189540                                                                  18954013
189550              PERFORM 9999-WRITE-TO-CSSL                          18955013
189560                                                                  18956013
189570              STRING  'SUKCS782 '          SU054-KOHLS-SML        18957099
189580                      ' TRIP:'             PV-DISP-TRIP           18958013
189590                      ' DR:'               SU054-DOOR-NUMBER      18959013
189600                      ' USR:'              SU054-USER-ID          18960013
189610                      ' STA:'              PV-DISP-PNA-STA        18961013
189620                      ' SQL:'              PV-DISP-SQLCODE        18962013
189630                      ' XLV_UPC - other'                          18963013
189640                                           DeLIMITED BY SIZE      18964013
189650                                      INTO PV-CICS-MSG-AREA2      18965013
189660                                                                  18966013
189670              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18967013
189680              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     18968013
189690                                                                  18969013
189700              PERFORM 9999-WRITE-TO-CSSL                          18970013
189710                                                                  18971013
189720              INITIALIZE PV-CICS-MSG-AREA3                        18972013
189730                                                                  18973013
189740              MOVE XL001-KEY-UPC-NBR      TO  PV-DISP-upc         18974013
189750              MOVE XL001-SKU-SQLCODE      TO  PV-DISP-SQL1        18975013
189760              MOVE XL001-VND-STYL-SQLCODE TO  PV-DISP-SQL2        18976013
189770              MOVE XL001-SKU-STR-SQLCODE  TO  PV-DISP-SQL3        18977013
189780              MOVE XL001-UPC-SQLCODE      TO  PV-DISP-SQL4        18978013
189790              MOVE XL001-WEB-SKU-SQLCODE  TO  PV-DISP-SQL5        18979013
189800                                                                  18980013
189810              STRING  'SUKCS782 (XLKUT001)'                       18981099
189820                      ' ACCESS:'           XL001-ACCESS-METHOD    18982013
189830                      ' SELECT:'           XL001-VIEW-SELECTION   18983013
189840                      '-'                                         18984013
189850                      ' upc NBR:'          PV-DISP-upc            18985013
189860                      ' RC:'               XL001-RETURN-CODE      18986013
189870                      ' SKU SQL:'          PV-DISP-SQL1           18987013
189880                      ' STYL SQL:'         PV-DISP-SQL2           18988013
189890                      ' SKUSTR SQL:'       PV-DISP-SQL3           18989013
189900                      ' UPC SQL:'          PV-DISP-SQL4           18990013
189910                      ' WEB SQL:'          PV-DISP-SQL5           18991013
189920                                           DELIMITED BY SIZE      18992013
189930                                      INTO PV-CICS-MSG-AREA3      18993013
189940                                                                  18994013
189950              MOVE SPACES               TO PV-CICS-MSG-AREA-A     18995013
189960              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     18996013
189970                                                                  18997013
189980              PERFORM 9999-WRITE-TO-CSSL                          18998013
189990                                                                  18999013
190000              INITIALIZE PV-CICS-MSG-AREA4                        19000013
190010                                                                  19001013
190020              MOVE XL001-INTR-UPC-ID      TO  PV-DISP-UPCID       19002013
190030              MOVE XL001-STYL-ID          TO  PV-DISP-STYL        19003013
190040              MOVE XL001-ITM-NBR          TO  PV-DISP-ITM         19004013
190050              MOVE XL001-SKU-NBR          TO  PV-DISP-SKU         19005013
190060              MOVE XL001-INNR-PACK-QTY    TO  PV-DISP-INPK        19006013
190070              MOVE XL001-OUTR-PACK-QTY    TO  PV-DISP-OTPK        19007013
190080                                                                  19008013
190090              STRING  'SUKCS782 '                                 19009099
190100                      ' PARA:'      XL001-ERROR-PARAGRAPH-NBR     19010013
190110                      ' CONTENTN:'  XL001-CONTENTION-ERR-PARA-NBR 19011013
190120                      ' UPCID:'            PV-DISP-UPCID          19012013
190130                      ' STYL:'             PV-DISP-STYL           19013013
190140                      ' ITM:'              PV-DISP-ITM            19014013
190150                      ' SKU:'              PV-DISP-SKU            19015013
190160                      ' INPK:'             PV-DISP-INPK           19016013
190170                      ' OTPK:'             PV-DISP-OTPK           19017013
190180                      ' DESC:'             XL001-SKU-DESC         19018013
190190                                           DELIMITED BY SIZE      19019013
190200                                      INTO PV-CICS-MSG-AREA4      19020013
190210                                                                  19021013
190220              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19022013
190230              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     19023013
190240                                                                  19024013
190250              PERFORM 9999-WRITE-TO-CSSL                          19025013
190260                                                                  19026013
190270              INITIALIZE PV-CICS-MSG-AREA5                        19027013
190280                                                                  19028013
190290              MOVE XL001-KOHLS-SIZE-CDE   TO  PV-DISP-SIZE        19029013
190300                                                                  19030013
190310              STRING  'SUKCS782 '                                 19031099
190320                      ' SZ:'               PV-DISP-SIZE           19032013
190330                      '-'                  XL001-SIZE-DESC        19033013
190340                      ' NRF CL:'           XL001-NRF-CLOR-CDE     19034013
190350                      ' SHRT CL:'          XL001-SHRT-CLOR-DESC   19035013
190360                      ' CSTM CL:'          XL001-CSTM-CLOR-DESC   19036013
190370                      ' RGN:'              XL001-REGN-PRIC-IND    19037013
190380                      ' KY:'               XL001-KY-ITM-IND       19038013
190390                      ' GP:'               XL001-GP-CDE           19039013
190400                      ' STAT:'             XL001-SKU-STAT-CDE     19040013
190410                      '-'                  XL001-SKU-STAT-DESC    19041013
190420                                           DELIMITED BY SIZE      19042013
190430                                      INTO PV-CICS-MSG-AREA5      19043013
190440                                                                  19044013
190450              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19045013
190460              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     19046013
190470                                                                  19047013
190480              PERFORM 9999-WRITE-TO-CSSL                          19048013
190490                                                                  19049013
190500              INITIALIZE PV-CICS-MSG-AREA6                        19050013
190510                                                                  19051013
190520              MOVE XL001-VS-ID            TO  PV-DISP-styl        19052013
190530              MOVE XL001-ENT-ID           TO  PV-DISP-ENT-ID      19053013
190540              MOVE XL001-STKR-NBR         TO  PV-DISP-STKR-NBR    19054013
190550                                                                  19055013
190560              STRING  'SUKCS782 '                                 19056099
190570                      ' '                  XL001-DEPT-NBR-3CH     19057013
190580                      '-'                  XL001-MAJ-CL-NBR-2CH   19058013
190590                      '-'                  XL001-SUB-CL-NBR-2CH   19059013
190600                      ' VS ID:'            PV-DISP-styl           19060013
190610                      ' CSTM CL:'          XL001-VS-NBR           19061013
190620                      ' ENT ID:'           PV-DISP-ENT-ID         19062013
190630                      ' STKR:'             PV-DISP-STKR-NBR       19063013
190640                      ' TKT:'              XL001-TKT-TYP-DESC     19064013
190650                      ' H/F:'              XL001-HNG-FOLD-CDE     19065013
190660                      '-'                  XL001-HNG-FOLD-DESC    19066013
190670                                           DELIMITED BY SIZE      19067013
190680                                      INTO PV-CICS-MSG-AREA6      19068013
190690                                                                  19069013
190700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19070013
190710              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     19071013
190720                                                                  19072013
190730              PERFORM 9999-WRITE-TO-CSSL                          19073013
190740                                                                  19074013
190750             SET PS-PROCESSING-ERROR-YES TO TRUE                  19075013
190760             PERFORM 9998-WRITE-TO-CSSL                           19076013
190770     END-EVALUATE.                                                19077013
190780                                                                  19078013
190790*----------------------------------------------------------------*19079013
190800*  GET MANIFEST FROM PCKCS721.                                   *19080013
190810*----------------------------------------------------------------*19081013
190820 7250-LINK-PCKCS721.                                              19082013
190830*                                                                 19083013
190840** added internal table to track paragraph execution time         19084013
190850** dmh 2014-12-22 - begin                                         19085013
190860*                                                                 19086013
190870     MOVE  '7250'  TO  PT-CURR-PARA.                              19087013
190880     IF  PS-BLD-INTERNAL-TABLE-YES                                19088013
190890         PERFORM 0200-INTERNAL-TABLE                              19089013
190900     ELSE                                                         19090013
190910         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19091013
190920     END-IF.                                                      19092013
190930                                                                  19093013
190940*                                                                 19094013
190950** DMH 2014-12-22 - END                                           19095013
190960*                                                                 19096013
190970                                                                  19097013
190980     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   19098013
190990                                                                  19099013
191000     EXEC CICS                                                    19100013
191010         LINK PROGRAM  (PV-PCKCS721)                              19101013
191020              COMMAREA (PC187-COMMAREA-REC)                       19102013
191030              LENGTH   (PV-COMMAREA-LENGTH)                       19103013
191040              RESP     (PV-CICS-RESPONSE)                         19104013
191050     END-EXEC.                                                    19105013
191060                                                                  19106013
191070     EVALUATE TRUE                                                19107013
191080         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 19108013
191090              IF  PC187-CRA-SUCCESSFUL                            19109013
191100                  CONTINUE                                        19110013
191110              ELSE                                                19111013
191120                  SET PV-DONE-PROCESSING          TO TRUE         19112013
191130                  MOVE SQLCODE              TO PV-SQLCODE         19113013
191140                                                                  19114013
191150              INITIALIZE PV-CICS-MSG-AREA1                        19115013
191160              INITIALIZE PV-CICS-MSG-AREA2                        19116013
191170                                                                  19117013
191180              MOVE SQLCODE              TO PV-DISP-SQLCODE        19118013
191190              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             19119013
191200              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           19120013
191210              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        19121013
191220                                                                  19122013
191230              STRING  'SUKCS782 7250-'                            19123099
191240                      ' DC:'               PV-DISP-DC             19124013
191250                      ' B1:'               SU054-BAR-CODE-1       19125013
191260                      ' B2:'               SU054-BAR-CODE-2       19126013
191270                      ' B3:'               SU054-BAR-CODE-3       19127013
191280                                           DELIMITED BY SIZE      19128013
191290                                      INTO PV-CICS-MSG-AREA1      19129013
191300                                                                  19130013
191310              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19131013
191320              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     19132013
191330                                                                  19133013
191340              PERFORM 9999-WRITE-TO-CSSL                          19134013
191350                                                                  19135013
191360              STRING  'SUKCS782 '          SU054-KOHLS-SML        19136099
191370                      ' TRIP:'             PV-DISP-TRIP           19137013
191380                      ' DR:'               SU054-DOOR-NUMBER      19138013
191390                      ' USR:'              SU054-USER-ID          19139013
191400                      ' STA:'              PV-DISP-PNA-STA        19140013
191410                      ' SQL:'              PV-DISP-SQLCODE        19141013
191420                      ' TDCSTMF - GET MANIFEST NUMBER'            19142013
191430                                           DeLIMITED BY SIZE      19143013
191440                                      INTO PV-CICS-MSG-AREA2      19144013
191450                                                                  19145013
191460              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19146013
191470              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     19147013
191480                                                                  19148013
191490              PERFORM 9999-WRITE-TO-CSSL                          19149013
191500                                                                  19150013
191510              INITIALIZE PV-CICS-MSG-AREA3                        19151013
191520                                                                  19152013
191530              STRING  'SUKCS782 (PCKCS721)'                       19153099
191540                      ' STORE:'            PC187-STR-NBR          19154013
191550                      ' NBR OF LBLS:'      PC187-NO-OF-LBLS       19155013
191560                      ' START:'            PC187-START-MFST-NBR   19156013
191570                      ' END:'              PC187-END-MFST-NBR     19157013
191580                      ' RC:'               PC187-CRA-RET-CDE      19158013
191590                      ' MSG:'              PC187-CRA-RET-MSG      19159013
191600                      ' REQ ID:'           PC187-CRA-REQ-ID       19160013
191610                                           DELIMITED BY SIZE      19161013
191620                                      INTO PV-CICS-MSG-AREA3      19162013
191630                                                                  19163013
191640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19164013
191650              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     19165013
191660                                                                  19166013
191670              PERFORM 9999-WRITE-TO-CSSL                          19167013
191680                                                                  19168013
191690                  SET PS-PROCESSING-ERROR-YES TO TRUE             19169013
191700                  PERFORM 9998-WRITE-TO-CSSL                      19170013
191710              END-IF                                              19171013
191720         WHEN OTHER                                               19172013
191730              SET PV-DONE-PROCESSING          TO TRUE             19173013
191740              MOVE SQLCODE              TO PV-SQLCODE             19174013
191750                                                                  19175013
191760              INITIALIZE PV-CICS-MSG-AREA1                        19176013
191770              INITIALIZE PV-CICS-MSG-AREA2                        19177013
191780                                                                  19178013
191790              MOVE SQLCODE              TO PV-DISP-SQLCODE        19179013
191800              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             19180013
191810              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           19181013
191820              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        19182013
191830                                                                  19183013
191840              STRING  'SUKCS782 7250-'                            19184099
191850                      ' DC:'               PV-DISP-DC             19185013
191860                      ' B1:'               SU054-BAR-CODE-1       19186013
191870                      ' B2:'               SU054-BAR-CODE-2       19187013
191880                      ' B3:'               SU054-BAR-CODE-3       19188013
191890                                           DELIMITED BY SIZE      19189013
191900                                      INTO PV-CICS-MSG-AREA1      19190013
191910                                                                  19191013
191920              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19192013
191930              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     19193013
191940                                                                  19194013
191950              PERFORM 9999-WRITE-TO-CSSL                          19195013
191960                                                                  19196013
191970              STRING  'SUKCS782 '          SU054-KOHLS-SML        19197099
191980                      ' TRIP:'             PV-DISP-TRIP           19198013
191990                      ' DR:'               SU054-DOOR-NUMBER      19199013
192000                      ' USR:'              SU054-USER-ID          19200013
192010                      ' STA:'              PV-DISP-PNA-STA        19201013
192020                      ' SQL:'              PV-DISP-SQLCODE        19202013
192030                      ' TDCSTMF - GET MANIFEST NUMBER - OTHER'    19203013
192040                                           DeLIMITED BY SIZE      19204013
192050                                      INTO PV-CICS-MSG-AREA2      19205013
192060                                                                  19206013
192070              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19207013
192080              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     19208013
192090                                                                  19209013
192100              PERFORM 9999-WRITE-TO-CSSL                          19210013
192110                                                                  19211013
192120              INITIALIZE PV-CICS-MSG-AREA3                        19212013
192130                                                                  19213013
192140              STRING  'SUKCS782 (PCKCS721)'                       19214099
192150                      ' STORE:'            PC187-STR-NBR          19215013
192160                      ' NBR OF LBLS:'      PC187-NO-OF-LBLS       19216013
192170                      ' START:'            PC187-START-MFST-NBR   19217013
192180                      ' END:'              PC187-END-MFST-NBR     19218013
192190                      ' RC:'               PC187-CRA-RET-CDE      19219013
192200                      ' MSG:'              PC187-CRA-RET-MSG      19220013
192210                      ' REQ ID:'           PC187-CRA-REQ-ID       19221013
192220                                           DELIMITED BY SIZE      19222013
192230                                      INTO PV-CICS-MSG-AREA3      19223013
192240                                                                  19224013
192250              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19225013
192260              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     19226013
192270                                                                  19227013
192280              PERFORM 9999-WRITE-TO-CSSL                          19228013
192290                                                                  19229013
192300              SET PS-PROCESSING-ERROR-YES TO TRUE                 19230013
192310              PERFORM 9998-WRITE-TO-CSSL                          19231013
192320     END-EVALUATE.                                                19232013
192330                                                                  19233013
192340                                                                  19234013
192350*----------------------------------------------------------------*19235013
192360*  LINK TO SUKCS583 TO DETERMINE IF THE CARTON NEEDS TO BE AUDITED19236013
192370*----------------------------------------------------------------*19237013
192380 7260-LINK-SUKCS583.                                              19238013
192390*                                                                 19239013
192400** added internal table to track paragraph execution time         19240013
192410** dmh 2014-12-22 - begin                                         19241013
192420*                                                                 19242013
192430     MOVE  '7260'  TO  PT-CURR-PARA.                              19243013
192440     IF  PS-BLD-INTERNAL-TABLE-YES                                19244013
192450         PERFORM 0200-INTERNAL-TABLE                              19245013
192460     ELSE                                                         19246013
192470         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19247013
192480     END-IF.                                                      19248013
192490*                                                                 19249013
192500** DMH 2014-12-22 - END                                           19250013
192510*                                                                 19251013
192520                                                                  19252013
192530     MOVE LENGTH OF SU021-CARTON-AUDIT-RECORD                     19253013
192540                                         TO PV-COMMAREA-LENGTH.   19254013
192550                                                                  19255013
192560     EXEC CICS                                                    19256013
192570         LINK PROGRAM  (PV-SUKCS583)                              19257013
192580              COMMAREA (SU021-CARTON-AUDIT-RECORD)                19258013
192590              LENGTH   (PV-COMMAREA-LENGTH)                       19259013
192600              RESP     (PV-CICS-RESPONSE)                         19260013
192610     END-EXEC.                                                    19261013
192620                                                                  19262013
192630     EVALUATE TRUE                                                19263013
192640         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 19264013
192650              IF  SU021-INVALID-REQUEST OR                        19265013
192660                  SU021-DB2-ERROR                                 19266013
192670                  SET PV-DONE-PROCESSING          TO TRUE         19267013
192680                  MOVE SQLCODE              TO PV-SQLCODE         19268013
192690                                                                  19269013
192700              INITIALIZE PV-CICS-MSG-AREA1                        19270013
192710              INITIALIZE PV-CICS-MSG-AREA2                        19271013
192720                                                                  19272013
192730              MOVE SQLCODE              TO PV-DISP-SQLCODE        19273013
192740              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             19274013
192750              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           19275013
192760              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        19276013
192770                                                                  19277013
192780              STRING  'SUKCS782 7260-'                            19278099
192790                      ' DC:'               PV-DISP-DC             19279013
192800                      ' B1:'               SU054-BAR-CODE-1       19280013
192810                      ' B2:'               SU054-BAR-CODE-2       19281013
192820                      ' B3:'               SU054-BAR-CODE-3       19282013
192830                                           DELIMITED BY SIZE      19283013
192840                                      INTO PV-CICS-MSG-AREA1      19284013
192850                                                                  19285013
192860              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19286013
192870              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     19287013
192880                                                                  19288013
192890              PERFORM 9999-WRITE-TO-CSSL                          19289013
192900                                                                  19290013
192910              STRING  'SUKCS782 '          SU054-KOHLS-SML        19291099
192920                      ' TRIP:'             PV-DISP-TRIP           19292013
192930                      ' DR:'               SU054-DOOR-NUMBER      19293013
192940                      ' USR:'              SU054-USER-ID          19294013
192950                      ' STA:'              PV-DISP-PNA-STA        19295013
192960                      ' SQL:'              PV-DISP-SQLCODE        19296013
192970                      ' CARTON AUDIT DETERMINATION MODULE'        19297013
192980                      ' INVALID REQ/DB2 ERROR'                    19298013
192990                                           DeLIMITED BY SIZE      19299013
193000                                      INTO PV-CICS-MSG-AREA2      19300013
193010                                                                  19301013
193020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19302013
193030              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     19303013
193040                                                                  19304013
193050              PERFORM 9999-WRITE-TO-CSSL                          19305013
193060                                                                  19306013
193070              INITIALIZE PV-CICS-MSG-AREA3                        19307013
193080                                                                  19308013
193090              MOVE SU021-PO-NUMBER       TO PV-DISP-PO            19309013
193100              MOVE SU021-LINE-NBR        TO PV-DISP-LINE          19310013
193110              MOVE SU021-DRIVER-LINE-NBR TO PV-DISP-DRVR          19311013
193120              MOVE SU021-PRE-PACK-ID     TO PV-DISP-PREPK         19312013
193130              MOVE SU021-OPER-UNT-ID     TO PV-DISP-OPER          19313013
193140              MOVE SU021-REC-SEQ-NBR     TO PV-DISP-RCVR          19314013
193150                                                                  19315013
193160              STRING  'SUKCS782 (SUKCS583)'                       19316099
193170                      ' TYPE:'         SU021-AUDIT-REQUEST-TYPE   19317013
193180                      ' PO:'           PV-DISP-OPER               19318013
193190                      '-'              PV-DISP-PO                 19319013
193200                      '-'              PV-DISP-RCVR               19320013
193210                      ' LINE:'         PV-DISP-LINE               19321013
193220                      ' DRVR:'         PV-DISP-DRVR               19322013
193230                      ' PRPK:'         PV-DISP-PREPK              19323013
193240                      ' PKG:'          SU021-PACKAGE-TYPE-CODE    19324013
193250                      ' REQ ID:'       PC187-CRA-REQ-ID           19325013
193260                                           DELIMITED BY SIZE      19326013
193270                                      INTO PV-CICS-MSG-AREA3      19327013
193280                                                                  19328013
193290              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19329013
193300              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     19330013
193310                                                                  19331013
193320              PERFORM 9999-WRITE-TO-CSSL                          19332013
193330                                                                  19333013
193340              INITIALIZE PV-CICS-MSG-AREA4                        19334013
193350                                                                  19335013
193360              MOVE SU021-INBOUND-TRIP-ID TO PV-DISP-TRIP          19336013
193370              MOVE SU021-SHIPT-UNT-ID    TO PV-DISP-SSCC          19337013
193380              MOVE SU021-AUDIT-NUMBER    TO PV-DISP-AUDIT         19338013
193390                                                                  19339013
193400              STRING  'SUKCS782 '                                 19340099
193410                      ' TRIP:'         PV-DISP-TRIP               19341013
193420                      ' SSCC:'         PV-DISP-SSCC               19342013
193430                      ' USR:'          SU021-USER-ID              19343013
193440                      ' DEF:'          SU021-DEFERRED-AUDIT-IND   19344013
193450                      ' REQ:'          SU021-AUDIT-REQUIRED-SW    19345013
193460                      ' AUD:'          PV-DISP-AUDIT              19346013
193470                                           DELIMITED BY SIZE      19347013
193480                                      INTO PV-CICS-MSG-AREA4      19348013
193490                                                                  19349013
193500              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19350013
193510              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     19351013
193520                                                                  19352013
193530              PERFORM 9999-WRITE-TO-CSSL                          19353013
193540                                                                  19354013
193550              INITIALIZE PV-CICS-MSG-AREA5                        19355013
193560                                                                  19356013
193570              MOVE SU021-RFID-AUDIT-NUMBER TO PV-DISP-AUDIT       19357013
193580                                                                  19358013
193590              STRING  'SUKCS782 '                                 19359099
193600                      ' AUD SW:'     SU021-AUDIT-VALIDATION-SW    19360013
193610                      ' PNA SW:'     SU021-PRINT-APPLY-SW         19361013
193620                      ' RFID AUD:'   SU021-RFID-AUDIT-REQUIRED-SW 19362013
193630                      ' RFID AUD:'   PV-DISP-AUDIT                19363013
193640                      ' RFID AUD SW:'                             19364013
193650                                   SU021-RFID-AUDIT-VALIDATION-SW 19365013
193660                      ' AUD:'          PV-DISP-AUDIT              19366013
193670                                           DELIMITED BY SIZE      19367013
193680                                      INTO PV-CICS-MSG-AREA5      19368013
193690                                                                  19369013
193700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19370013
193710              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     19371013
193720                                                                  19372013
193730              PERFORM 9999-WRITE-TO-CSSL                          19373013
193740                                                                  19374013
193750                  SET PS-PROCESSING-ERROR-YES TO TRUE             19375013
193760                  PERFORM 9998-WRITE-TO-CSSL                      19376013
193770              END-IF                                              19377013
193780         WHEN OTHER                                               19378013
193790              SET PV-DONE-PROCESSING          TO TRUE             19379013
193800              MOVE SQLCODE              TO PV-SQLCODE             19380013
193810                                                                  19381013
193820              INITIALIZE PV-CICS-MSG-AREA1                        19382013
193830              INITIALIZE PV-CICS-MSG-AREA2                        19383013
193840                                                                  19384013
193850              MOVE SQLCODE              TO PV-DISP-SQLCODE        19385013
193860              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             19386013
193870              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           19387013
193880              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        19388013
193890                                                                  19389013
193900              STRING  'SUKCS782 7260-'                            19390099
193910                      ' DC:'               PV-DISP-DC             19391013
193920                      ' B1:'               SU054-BAR-CODE-1       19392013
193930                      ' B2:'               SU054-BAR-CODE-2       19393013
193940                      ' B3:'               SU054-BAR-CODE-3       19394013
193950                                           DELIMITED BY SIZE      19395013
193960                                      INTO PV-CICS-MSG-AREA1      19396013
193970                                                                  19397013
193980              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19398013
193990              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     19399013
194000                                                                  19400013
194010              PERFORM 9999-WRITE-TO-CSSL                          19401013
194020                                                                  19402013
194030              STRING  'SUKCS782 '          SU054-KOHLS-SML        19403099
194040                      ' TRIP:'             PV-DISP-TRIP           19404013
194050                      ' DR:'               SU054-DOOR-NUMBER      19405013
194060                      ' USR:'              SU054-USER-ID          19406013
194070                      ' STA:'              PV-DISP-PNA-STA        19407013
194080                      ' SQL:'              PV-DISP-SQLCODE        19408013
194090                      ' CARTON AUDIT DETERMINATION MODULE'        19409013
194100                      ' OTHER'                                    19410013
194110                                           DeLIMITED BY SIZE      19411013
194120                                      INTO PV-CICS-MSG-AREA2      19412013
194130                                                                  19413013
194140              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19414013
194150              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     19415013
194160                                                                  19416013
194170              PERFORM 9999-WRITE-TO-CSSL                          19417013
194180                                                                  19418013
194190              INITIALIZE PV-CICS-MSG-AREA3                        19419013
194200                                                                  19420013
194210              MOVE SU021-PO-NUMBER       TO PV-DISP-PO            19421013
194220              MOVE SU021-LINE-NBR        TO PV-DISP-LINE          19422013
194230              MOVE SU021-DRIVER-LINE-NBR TO PV-DISP-DRVR          19423013
194240              MOVE SU021-PRE-PACK-ID     TO PV-DISP-PREPK         19424013
194250              MOVE SU021-OPER-UNT-ID     TO PV-DISP-OPER          19425013
194260              MOVE SU021-REC-SEQ-NBR     TO PV-DISP-RCVR          19426013
194270                                                                  19427013
194280              STRING  'SUKCS782 (SUKCS583)'                       19428099
194290                      ' TYPE:'         SU021-AUDIT-REQUEST-TYPE   19429013
194300                      ' PO:'           PV-DISP-OPER               19430013
194310                      '-'              PV-DISP-PO                 19431013
194320                      '-'              PV-DISP-RCVR               19432013
194330                      ' LINE:'         PV-DISP-LINE               19433013
194340                      ' DRVR:'         PV-DISP-DRVR               19434013
194350                      ' PRPK:'         PV-DISP-PREPK              19435013
194360                      ' PKG:'          SU021-PACKAGE-TYPE-CODE    19436013
194370                      ' REQ ID:'       PC187-CRA-REQ-ID           19437013
194380                                           DELIMITED BY SIZE      19438013
194390                                      INTO PV-CICS-MSG-AREA3      19439013
194400                                                                  19440013
194410              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19441013
194420              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     19442013
194430                                                                  19443013
194440              PERFORM 9999-WRITE-TO-CSSL                          19444013
194450                                                                  19445013
194460              INITIALIZE PV-CICS-MSG-AREA4                        19446013
194470                                                                  19447013
194480              MOVE SU021-INBOUND-TRIP-ID TO PV-DISP-TRIP          19448013
194490              MOVE SU021-SHIPT-UNT-ID    TO PV-DISP-SSCC          19449013
194500              MOVE SU021-AUDIT-NUMBER    TO PV-DISP-AUDIT         19450013
194510                                                                  19451013
194520              STRING  'SUKCS782 '                                 19452099
194530                      ' TRIP:'         PV-DISP-TRIP               19453013
194540                      ' SSCC:'         PV-DISP-SSCC               19454013
194550                      ' USR:'          SU021-USER-ID              19455013
194560                      ' DEF:'          SU021-DEFERRED-AUDIT-IND   19456013
194570                      ' REQ:'          SU021-AUDIT-REQUIRED-SW    19457013
194580                      ' AUD:'          PV-DISP-AUDIT              19458013
194590                                           DELIMITED BY SIZE      19459013
194600                                      INTO PV-CICS-MSG-AREA4      19460013
194610                                                                  19461013
194620              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19462013
194630              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     19463013
194640                                                                  19464013
194650              PERFORM 9999-WRITE-TO-CSSL                          19465013
194660                                                                  19466013
194670              INITIALIZE PV-CICS-MSG-AREA5                        19467013
194680                                                                  19468013
194690              MOVE SU021-RFID-AUDIT-NUMBER TO PV-DISP-AUDIT       19469013
194700                                                                  19470013
194710              STRING  'SUKCS782 '                                 19471099
194720                      ' AUD SW:'     SU021-AUDIT-VALIDATION-SW    19472013
194730                      ' PNA SW:'     SU021-PRINT-APPLY-SW         19473013
194740                      ' RFID AUD:'   SU021-RFID-AUDIT-REQUIRED-SW 19474013
194750                      ' RFID AUD:'   PV-DISP-AUDIT                19475013
194760                      ' RFID AUD SW:'                             19476013
194770                                   SU021-RFID-AUDIT-VALIDATION-SW 19477013
194780                      ' AUD:'          PV-DISP-AUDIT              19478013
194790                                           DELIMITED BY SIZE      19479013
194800                                      INTO PV-CICS-MSG-AREA5      19480013
194810                                                                  19481013
194820              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19482013
194830              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     19483013
194840                                                                  19484013
194850              PERFORM 9999-WRITE-TO-CSSL                          19485013
194860                                                                  19486013
194870              SET PS-PROCESSING-ERROR-YES TO TRUE                 19487013
194880              PERFORM 9998-WRITE-TO-CSSL                          19488013
194890     END-EVALUATE.                                                19489013
194900                                                                  19490013
194910                                                                  19491013
194920*CLP 10/29/13 - BEGIN PR#5148D                                    19492013
194930*----------------------------------------------------------------*19493013
194940*  LINK TO SUKCS720 TO DETERMINE IF THE CARTON NEEDS TO BE RFID   19494013
194950*  AUDITED                                                        19495013
194960*----------------------------------------------------------------*19496013
194970 7265-LINK-SUKCS720.                                              19497013
194980*                                                                 19498013
194990** added internal table to track paragraph execution time         19499013
195000** dmh 2014-12-22 - begin                                         19500013
195010*                                                                 19501013
195020     MOVE  '7265'  TO  PT-CURR-PARA.                              19502013
195030     IF  PS-BLD-INTERNAL-TABLE-YES                                19503013
195040         PERFORM 0200-INTERNAL-TABLE                              19504013
195050     ELSE                                                         19505013
195060         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19506013
195070     END-IF.                                                      19507013
195080                                                                  19508013
195090*                                                                 19509013
195100** DMH 2014-12-22 - END                                           19510013
195110*                                                                 19511013
195120                                                                  19512013
195130     MOVE LENGTH OF SU021-CARTON-AUDIT-RECORD                     19513013
195140                                   TO PV-COMMAREA-LENGTH.         19514013
195150                                                                  19515013
195160     EXEC CICS                                                    19516013
195170         LINK PROGRAM  (PV-SUKCS720)                              19517013
195180              COMMAREA (SU021-CARTON-AUDIT-RECORD)                19518013
195190              LENGTH   (PV-COMMAREA-LENGTH)                       19519013
195200              RESP     (PV-CICS-RESPONSE)                         19520013
195210     END-EXEC.                                                    19521013
195220                                                                  19522013
195230     EVALUATE TRUE                                                19523013
195240         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 19524013
195250              IF  SU021-INVALID-REQUEST OR                        19525013
195260                  SU021-DB2-ERROR                                 19526013
195270                  SET PV-DONE-PROCESSING          TO TRUE         19527013
195280                                                                  19528013
195290              INITIALIZE PV-CICS-MSG-AREA1                        19529013
195300              INITIALIZE PV-CICS-MSG-AREA2                        19530013
195310                                                                  19531013
195320              MOVE SQLCODE              TO PV-DISP-SQLCODE        19532013
195330              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             19533013
195340              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           19534013
195350              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        19535013
195360                                                                  19536013
195370              STRING  'SUKCS782 7265-'                            19537099
195380                      ' DC:'               PV-DISP-DC             19538013
195390                      ' B1:'               SU054-BAR-CODE-1       19539013
195400                      ' B2:'               SU054-BAR-CODE-2       19540013
195410                      ' B3:'               SU054-BAR-CODE-3       19541013
195420                                           DELIMITED BY SIZE      19542013
195430                                      INTO PV-CICS-MSG-AREA1      19543013
195440                                                                  19544013
195450              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19545013
195460              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     19546013
195470                                                                  19547013
195480              PERFORM 9999-WRITE-TO-CSSL                          19548013
195490                                                                  19549013
195500              STRING  'SUKCS782 '          SU054-KOHLS-SML        19550099
195510                      ' TRIP:'             PV-DISP-TRIP           19551013
195520                      ' DR:'               SU054-DOOR-NUMBER      19552013
195530                      ' USR:'              SU054-USER-ID          19553013
195540                      ' STA:'              PV-DISP-PNA-STA        19554013
195550                      ' SQL:'              PV-DISP-SQLCODE        19555013
195560                      ' RFID AUDIT DETERMINATION MODULE'          19556013
195570                      ' INVALID REQ/DB2 ERROR'                    19557013
195580                                           DeLIMITED BY SIZE      19558013
195590                                      INTO PV-CICS-MSG-AREA2      19559013
195600                                                                  19560013
195610              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19561013
195620              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     19562013
195630                                                                  19563013
195640              PERFORM 9999-WRITE-TO-CSSL                          19564013
195650                                                                  19565013
195660              INITIALIZE PV-CICS-MSG-AREA3                        19566013
195670                                                                  19567013
195680              MOVE SU021-PO-NUMBER       TO PV-DISP-PO            19568013
195690              MOVE SU021-LINE-NBR        TO PV-DISP-LINE          19569013
195700              MOVE SU021-DRIVER-LINE-NBR TO PV-DISP-DRVR          19570013
195710              MOVE SU021-PRE-PACK-ID     TO PV-DISP-PREPK         19571013
195720              MOVE SU021-OPER-UNT-ID     TO PV-DISP-OPER          19572013
195730              MOVE SU021-REC-SEQ-NBR     TO PV-DISP-RCVR          19573013
195740                                                                  19574013
195750              STRING  'SUKCS782 (SUKCS720)'                       19575099
195760                      ' TYPE:'         SU021-AUDIT-REQUEST-TYPE   19576013
195770                      ' PO:'           PV-DISP-OPER               19577013
195780                      '-'              PV-DISP-PO                 19578013
195790                      '-'              PV-DISP-RCVR               19579013
195800                      ' LINE:'         PV-DISP-LINE               19580013
195810                      ' DRVR:'         PV-DISP-DRVR               19581013
195820                      ' PRPK:'         PV-DISP-PREPK              19582013
195830                      ' PKG:'          SU021-PACKAGE-TYPE-CODE    19583013
195840                      ' REQ ID:'       PC187-CRA-REQ-ID           19584013
195850                                           DELIMITED BY SIZE      19585013
195860                                      INTO PV-CICS-MSG-AREA3      19586013
195870                                                                  19587013
195880              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19588013
195890              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     19589013
195900                                                                  19590013
195910              PERFORM 9999-WRITE-TO-CSSL                          19591013
195920                                                                  19592013
195930              INITIALIZE PV-CICS-MSG-AREA4                        19593013
195940                                                                  19594013
195950              MOVE SU021-INBOUND-TRIP-ID TO PV-DISP-TRIP          19595013
195960              MOVE SU021-SHIPT-UNT-ID    TO PV-DISP-SSCC          19596013
195970              MOVE SU021-AUDIT-NUMBER    TO PV-DISP-AUDIT         19597013
195980                                                                  19598013
195990              STRING  'SUKCS782 '                                 19599099
196000                      ' TRIP:'         PV-DISP-TRIP               19600013
196010                      ' SSCC:'         PV-DISP-SSCC               19601013
196020                      ' USR:'          SU021-USER-ID              19602013
196030                      ' DEF:'          SU021-DEFERRED-AUDIT-IND   19603013
196040                      ' REQ:'          SU021-AUDIT-REQUIRED-SW    19604013
196050                      ' AUD:'          PV-DISP-AUDIT              19605013
196060                                           DELIMITED BY SIZE      19606013
196070                                      INTO PV-CICS-MSG-AREA4      19607013
196080                                                                  19608013
196090              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19609013
196100              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     19610013
196110                                                                  19611013
196120              PERFORM 9999-WRITE-TO-CSSL                          19612013
196130                                                                  19613013
196140              INITIALIZE PV-CICS-MSG-AREA5                        19614013
196150                                                                  19615013
196160              MOVE SU021-RFID-AUDIT-NUMBER TO PV-DISP-AUDIT       19616013
196170                                                                  19617013
196180              STRING  'SUKCS782 '                                 19618099
196190                      ' AUD SW:'     SU021-AUDIT-VALIDATION-SW    19619013
196200                      ' PNA SW:'     SU021-PRINT-APPLY-SW         19620013
196210                      ' RFID AUD:'   SU021-RFID-AUDIT-REQUIRED-SW 19621013
196220                      ' RFID AUD:'   PV-DISP-AUDIT                19622013
196230                      ' RFID AUD SW:'                             19623013
196240                                   SU021-RFID-AUDIT-VALIDATION-SW 19624013
196250                      ' AUD:'          PV-DISP-AUDIT              19625013
196260                                           DELIMITED BY SIZE      19626013
196270                                      INTO PV-CICS-MSG-AREA5      19627013
196280                                                                  19628013
196290              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19629013
196300              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     19630013
196310                                                                  19631013
196320              PERFORM 9999-WRITE-TO-CSSL                          19632013
196330                                                                  19633013
196340                  SET PS-PROCESSING-ERROR-YES TO TRUE             19634013
196350                  PERFORM 9998-WRITE-TO-CSSL                      19635013
196360              END-IF                                              19636013
196370         WHEN OTHER                                               19637013
196380              SET PV-DONE-PROCESSING          TO TRUE             19638013
196390                                                                  19639013
196400              INITIALIZE PV-CICS-MSG-AREA1                        19640013
196410              INITIALIZE PV-CICS-MSG-AREA2                        19641013
196420                                                                  19642013
196430              MOVE SQLCODE              TO PV-DISP-SQLCODE        19643013
196440              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             19644013
196450              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           19645013
196460              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        19646013
196470                                                                  19647013
196480              STRING  'SUKCS782 7265-'                            19648099
196490                      ' DC:'               PV-DISP-DC             19649013
196500                      ' B1:'               SU054-BAR-CODE-1       19650013
196510                      ' B2:'               SU054-BAR-CODE-2       19651013
196520                      ' B3:'               SU054-BAR-CODE-3       19652013
196530                                           DELIMITED BY SIZE      19653013
196540                                      INTO PV-CICS-MSG-AREA1      19654013
196550                                                                  19655013
196560              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19656013
196570              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     19657013
196580                                                                  19658013
196590              PERFORM 9999-WRITE-TO-CSSL                          19659013
196600                                                                  19660013
196610              STRING  'SUKCS782 '          SU054-KOHLS-SML        19661099
196620                      ' TRIP:'             PV-DISP-TRIP           19662013
196630                      ' DR:'               SU054-DOOR-NUMBER      19663013
196640                      ' USR:'              SU054-USER-ID          19664013
196650                      ' STA:'              PV-DISP-PNA-STA        19665013
196660                      ' SQL:'              PV-DISP-SQLCODE        19666013
196670                      ' RFID AUDIT DETERMINATION MODULE'          19667013
196680                      ' OTHER'                                    19668013
196690                                           DeLIMITED BY SIZE      19669013
196700                                      INTO PV-CICS-MSG-AREA2      19670013
196710                                                                  19671013
196720              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19672013
196730              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     19673013
196740                                                                  19674013
196750              PERFORM 9999-WRITE-TO-CSSL                          19675013
196760                                                                  19676013
196770              INITIALIZE PV-CICS-MSG-AREA3                        19677013
196780                                                                  19678013
196790              MOVE SU021-PO-NUMBER       TO PV-DISP-PO            19679013
196800              MOVE SU021-LINE-NBR        TO PV-DISP-LINE          19680013
196810              MOVE SU021-DRIVER-LINE-NBR TO PV-DISP-DRVR          19681013
196820              MOVE SU021-PRE-PACK-ID     TO PV-DISP-PREPK         19682013
196830              MOVE SU021-OPER-UNT-ID     TO PV-DISP-OPER          19683013
196840              MOVE SU021-REC-SEQ-NBR     TO PV-DISP-RCVR          19684013
196850                                                                  19685013
196860              STRING  'SUKCS782 (SUKCS720)'                       19686099
196870                      ' TYPE:'         SU021-AUDIT-REQUEST-TYPE   19687013
196880                      ' PO:'           PV-DISP-OPER               19688013
196890                      '-'              PV-DISP-PO                 19689013
196900                      '-'              PV-DISP-RCVR               19690013
196910                      ' LINE:'         PV-DISP-LINE               19691013
196920                      ' DRVR:'         PV-DISP-DRVR               19692013
196930                      ' PRPK:'         PV-DISP-PREPK              19693013
196940                      ' PKG:'          SU021-PACKAGE-TYPE-CODE    19694013
196950                      ' REQ ID:'       PC187-CRA-REQ-ID           19695013
196960                                           DELIMITED BY SIZE      19696013
196970                                      INTO PV-CICS-MSG-AREA3      19697013
196980                                                                  19698013
196990              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19699013
197000              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     19700013
197010                                                                  19701013
197020              PERFORM 9999-WRITE-TO-CSSL                          19702013
197030                                                                  19703013
197040              INITIALIZE PV-CICS-MSG-AREA4                        19704013
197050                                                                  19705013
197060              MOVE SU021-INBOUND-TRIP-ID TO PV-DISP-TRIP          19706013
197070              MOVE SU021-SHIPT-UNT-ID    TO PV-DISP-SSCC          19707013
197080              MOVE SU021-AUDIT-NUMBER    TO PV-DISP-AUDIT         19708013
197090                                                                  19709013
197100              STRING  'SUKCS782 '                                 19710099
197110                      ' TRIP:'         PV-DISP-TRIP               19711013
197120                      ' SSCC:'         PV-DISP-SSCC               19712013
197130                      ' USR:'          SU021-USER-ID              19713013
197140                      ' DEF:'          SU021-DEFERRED-AUDIT-IND   19714013
197150                      ' REQ:'          SU021-AUDIT-REQUIRED-SW    19715013
197160                      ' AUD:'          PV-DISP-AUDIT              19716013
197170                                           DELIMITED BY SIZE      19717013
197180                                      INTO PV-CICS-MSG-AREA4      19718013
197190                                                                  19719013
197200              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19720013
197210              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     19721013
197220                                                                  19722013
197230              PERFORM 9999-WRITE-TO-CSSL                          19723013
197240                                                                  19724013
197250              INITIALIZE PV-CICS-MSG-AREA5                        19725013
197260                                                                  19726013
197270              MOVE SU021-RFID-AUDIT-NUMBER TO PV-DISP-AUDIT       19727013
197280                                                                  19728013
197290              STRING  'SUKCS782 '                                 19729099
197300                      ' AUD SW:'     SU021-AUDIT-VALIDATION-SW    19730013
197310                      ' PNA SW:'     SU021-PRINT-APPLY-SW         19731013
197320                      ' RFID AUD:'   SU021-RFID-AUDIT-REQUIRED-SW 19732013
197330                      ' RFID AUD:'   PV-DISP-AUDIT                19733013
197340                      ' RFID AUD SW:'                             19734013
197350                                   SU021-RFID-AUDIT-VALIDATION-SW 19735013
197360                      ' AUD:'          PV-DISP-AUDIT              19736013
197370                                           DELIMITED BY SIZE      19737013
197380                                      INTO PV-CICS-MSG-AREA5      19738013
197390                                                                  19739013
197400              MOVE SPACES               TO PV-CICS-MSG-AREA-A     19740013
197410              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     19741013
197420                                                                  19742013
197430              PERFORM 9999-WRITE-TO-CSSL                          19743013
197440                                                                  19744013
197450              SET PS-PROCESSING-ERROR-YES TO TRUE                 19745013
197460              PERFORM 9998-WRITE-TO-CSSL                          19746013
197470     END-EVALUATE.                                                19747013
197480*CLP 10/29/13 - END   PR#5148D                                    19748013
197490*----------------------------------------------------------------*19749013
197500* AUTOMATIC START OF CHECK FOR TRIGGER OF                        *19750013
197510* CONFIRMATION/VERIFICATION  (SUKUT707)                          *19751013
197520*----------------------------------------------------------------*19752013
197530 7350-START-VERIF-TRIGGER.                                        19753013
197540*                                                                 19754013
197550** added internal table to track paragraph execution time         19755013
197560** dmh 2014-12-22 - begin                                         19756013
197570*                                                                 19757013
197580     MOVE  '7350'  TO  PT-CURR-PARA.                              19758013
197590     IF  PS-BLD-INTERNAL-TABLE-YES                                19759013
197600         PERFORM 0200-INTERNAL-TABLE                              19760013
197610     ELSE                                                         19761013
197620         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19762013
197630     END-IF.                                                      19763013
197640                                                                  19764013
197650*                                                                 19765013
197660** DMH 2014-12-22 - END                                           19766013
197670*                                                                 19767013
197680      INITIALIZE RC041-FIELDS.                                    19768013
197690      MOVE PV-PO-NBR          TO RC041-PO-NBR                     19769013
197700      MOVE PV-RCVR-SEQ-NBR TO RC041-REC-SEQ-NBR                   19770013
197710      MOVE RECEIV-CURR-OPER-UNT-ID TO RC041-OPER-UNT-ID           19771013
197720      MOVE SU054-USER-ID      TO RC041-USER-ID                    19772013
197730      MOVE PC-CURRENT-PROGRAM-NAME TO RC041-PROGRAM-NAME          19773013
197740                                                                  19774013
197750      MOVE SHUUPC-TRN-LNE-NBR TO RC041-PO-LNE-NBR                 19775013
197760      MOVE PV-PREPK-ID        TO RC041-PREPACK-ID                 19776013
197770                                                                  19777013
197780      IF PS-PACK-BY-STORE                                         19778013
197790         SET RC041-PBS TO TRUE                                    19779013
197800      ELSE                                                        19780013
197810         MOVE RECEIV-PKGNG-CDE TO RC041-PKGNG-CDE                 19781013
197820      END-IF                                                      19782013
197830                                                                  19783013
197840     EXEC CICS                                                    19784013
197850          START TRANSID (PC-SU-CRTN-VERIF-TRIGGER)                19785013
197860               FROM (RC041-FIELDS)                                19786013
197870     END-EXEC.                                                    19787013
197880                                                                  19788013
197890                                                                  19789013
197900*----------------------------------------------------------------*19790013
197910* GET DEPT NAME & MAJOR CLASS DESCRIPTION                         19791013
197920*----------------------------------------------------------------*19792013
197930 7400-GET-DEPT-NAME.                                              19793013
197940*                                                                 19794013
197950** added internal table to track paragraph execution time         19795013
197960** dmh 2014-12-22 - begin                                         19796013
197970*                                                                 19797013
197980     MOVE  '7400'  TO  PT-CURR-PARA.                              19798013
197990     IF  PS-BLD-INTERNAL-TABLE-YES                                19799013
198000         PERFORM 0200-INTERNAL-TABLE                              19800013
198010     ELSE                                                         19801013
198020         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19802013
198030     END-IF.                                                      19803013
198040                                                                  19804013
198050*                                                                 19805013
198060** DMH 2014-12-22 - END                                           19806013
198070*                                                                 19807013
198080     PERFORM 7405-GET-CURRENT-DATE.                               19808013
198090                                                                  19809013
198100     SET DP003-MCL-LOOKUP              TO TRUE.                   19810013
198110     SET DP003-DPT-LOOKUP              TO TRUE.                   19811013
198120     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      19812013
198130     MOVE '03'                         TO DP003-OP-CO-NMBR.       19813013
198140     MOVE PV-CURRENT-YY                TO PV-DPKUT038-YY.         19814013
198150     MOVE PV-CURRENT-MM                TO PV-DPKUT038-MM.         19815013
198160     MOVE PV-CURRENT-DD                TO PV-DPKUT038-DD          19816013
198170     MOVE PV-DPKUT038-DATE             TO DP003-CURRENT-DATE      19817013
198180                                          DP003-EFF-DATE.         19818013
198190                                                                  19819013
198200     MOVE PV-DEPT-NUMBER               TO DP003-DPT-INPUT.        19820013
198210     MOVE PV-CL-NBR                    TO PV-DPKUT038-MJR-CL.     19821013
198220     MOVE ZERO                         TO PV-DPKUT038-MJR-CL-2.   19822013
198230     MOVE PV-DPKUT038-MJR-CL           TO DP003-MCL-INPUT.        19823013
198240                                                                  19824013
198250     EXEC CICS                                                    19825013
198260         LINK PROGRAM  (PV-DPKUT038)                              19826013
198270              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              19827013
198280              LENGTH   (PV-DPKUT038-CA-LENGTH)                    19828013
198290              RESP     (PV-DPKUT038-CICS-RESP)                    19829013
198300     END-EXEC.                                                    19830013
198310                                                                  19831013
198320     EVALUATE TRUE                                                19832013
198330         WHEN PV-DPKUT038-CICS-RESP = DFHRESP (NORMAL)            19833013
198340              MOVE DP003-DPT-DESCRIPTION TO PV-DEPT-DESC          19834013
198350              MOVE DP003-MCL-DESCRIPTION TO PV-MAJ-CL-DESC        19835013
198360         WHEN OTHER                                               19836013
198370              MOVE SPACES          TO   PV-DEPT-DESC              19837013
198380     END-EVALUATE.                                                19838013
198390                                                                  19839013
198400                                                                  19840013
198410*-----------------------------------------------------------------19841013
198420*  GET CURRENT DATE                                               19842013
198430*                                                                *19843013
198440*  2014-12-03 - DMH - ADDED "WITH UR" TO SQL                     *19844013
198450*----------------------------------------------------------------*19845013
198460 7405-GET-CURRENT-DATE.                                           19846013
198470*                                                                 19847013
198480** added internal table to track paragraph execution time         19848013
198490** dmh 2014-12-22 - begin                                         19849013
198500*                                                                 19850013
198510     MOVE  '7405'  TO  PT-CURR-PARA.                              19851013
198520     IF  PS-BLD-INTERNAL-TABLE-YES                                19852013
198530         PERFORM 0200-INTERNAL-TABLE                              19853013
198540     ELSE                                                         19854013
198550         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19855013
198560     END-IF.                                                      19856013
198570                                                                  19857013
198580*                                                                 19858013
198590** DMH 2014-12-22 - END                                           19859013
198600*                                                                 19860013
198610                                                                  19861013
198620     EXEC SQL                                                     19862013
198630         SELECT  CURRENT DATE                                     19863013
198640                ,CURRENT TIME                                     19864013
198650           INTO  :PV-CURRENT-DATE                                 19865013
198660                ,:PV-CURRENT-TIME                                 19866013
198670           FROM  TCOCNTL                                          19867013
198680          WHERE  OPER_UNT_ID = 90                                 19868013
198690           WITH UR                                                19869013
198700     END-EXEC.                                                    19870013
198710                                                                  19871013
198720     MOVE PV-CURRENT-DATE TO PV-WORK-DB2-DATE.                    19872013
198730     MOVE PV-CURRENT-TIME TO PV-CURRENT-TIME-LBL.                 19873013
198740*----------------------------------------------------------------*19874013
198750* POPULATE TLBPTDA PRIOR TO INSERT TO TABLE                       19875013
198760*----------------------------------------------------------------*19876013
198770 7500-POPULATE-TLBPTDA-BULK.                                      19877013
198780*                                                                 19878013
198790** added internal table to track paragraph execution time         19879013
198800** dmh 2014-12-22 - begin                                         19880013
198810*                                                                 19881013
198820     MOVE  '7500'  TO  PT-CURR-PARA.                              19882013
198830     IF  PS-BLD-INTERNAL-TABLE-YES                                19883013
198840         PERFORM 0200-INTERNAL-TABLE                              19884013
198850     ELSE                                                         19885013
198860         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19886013
198870     END-IF.                                                      19887013
198880                                                                  19888013
198890*                                                                 19889013
198900** DMH 2014-12-22 - END                                           19890013
198910*                                                                 19891013
198920                                                                  19892013
198930     INITIALIZE  DCLTLBPTDA.                                      19893013
198940                                                                  19894013
198950     IF PS-PRINT-AUDIT-LABEL                                      19895013
198960        MOVE 'Q'                    TO LBPTDA-CART-LBL-TYP-CDE    19896013
198970     ELSE                                                         19897013
198980        MOVE LBVRDA-CART-LBL-TYP-CDE TO LBPTDA-CART-LBL-TYP-CDE   19898013
198990     END-IF                                                       19899013
199000                                                                  19900013
199010*    IF LBVRDA-CART-LBL-TYP-CDE = 'P'                             19901013
199020*       SET SU001-P2L-LBL-CREATED   TO TRUE                       19902013
199030*    END-IF.                                                      19903013
199040     MOVE LBVRDA-DEST-OPER-UNT-ID   TO PV-STORE.                  19904013
199050     MOVE LBVRDA-PREPK-ID           TO LBPTDA-PREPK-ID            19905013
199060     MOVE LBVRDA-PREPK-RATO-QTY     TO LBPTDA-PREPK-RATO-QTY.     19906013
199070     MOVE LBVRDA-PREPK-UNT-QTY      TO LBPTDA-PREPK-UNT-QTY.      19907013
199080     MOVE LBVRDA-INPK-UNT-QTY       TO LBPTDA-INPK-UNT-QTY.       19908013
199090     MOVE LBVRDA-CSE-PK-QTY         TO LBPTDA-CSE-PK-QTY.         19909013
199100     MOVE LBVRDA-ODD-CART-IND       TO LBPTDA-ODD-CART-IND.       19910013
199110     MOVE LBVRDA-INPK-CNVYB-IND     TO LBPTDA-INPK-CNVYB-IND.     19911013
199120     MOVE LBVRDA-LBL-TYP-LBL-SEQ-ID TO LBPTDA-LBL-TYP-LBL-SEQ-ID. 19912013
199130     MOVE LBVRDA-LBL-TYP-TOT-QTY    TO LBPTDA-LBL-TYP-TOT-QTY.    19913013
199140     MOVE LBVRDA-MODU-DESC          TO LBPTDA-MODU-DESC.          19914013
199150     MOVE LBVRDA-ITM-NBR            TO LBPTDA-ITM-NBR.            19915013
199160     MOVE LBVRDA-DEPT-DESC          TO LBPTDA-DEPT-DESC.          19916013
199170     MOVE LBVRDA-MAJ-CL-DESC        TO LBPTDA-MAJ-CL-DESC.        19917013
199180     MOVE LBVRDA-SEASET-NM          TO LBPTDA-SEASET-NM.          19918013
199190     MOVE LBVRDA-FIXT-ID            TO LBPTDA-FIXT-ID.            19919013
199200     MOVE LBVRDA-BRCDE-NBR          TO LBPTDA-BRCDE-NBR.          19920013
199210     MOVE LBVRDA-STR-ZN-ID          TO LBPTDA-STR-ZN-ID.          19921013
199220     MOVE LBVRDA-STRG-AREA-CDE      TO LBPTDA-STRG-AREA-CDE.      19922013
199230     MOVE LBVRDA-HNG-FOLD-SEQ-NBR   TO LBPTDA-HNG-FOLD-SEQ-NBR    19923013
199240                                       PV-HNG-FOLD-SEQ-NBR.       19924013
199250     MOVE LBVRDA-EAS-TAG-IND        TO LBPTDA-EAS-TAG-IND         19925013
199260                                       PS-EAS-TAG-IND-FOUND-SW.   19926013
199270     MOVE LBVRDA-DOOR-ID            TO LBPTDA-DOOR-ID             19927013
199280                                       CNDCDR-DOOR-ID.            19928013
199290*CLP 06/24/2015 START                                             19929013
199300     MOVE 35                        TO LBPTDA-LBL-MSG-TXT-LEN.    19930013
199310     MOVE LBVRDA-LBL-MSG-TXT-TEXT   TO LBPTDA-LBL-MSG-TXT-TEXT.   19931013
199320*CLP 06/24/2015 END                                               19932013
199330*----------------------------------------------------------------*19933013
199340 7590-CREATE-RTV-OTBND.                                           19934013
199350*                                                                 19935013
199360** added internal table to track paragraph execution time         19936013
199370** dmh 2014-12-22 - begin                                         19937013
199380*                                                                 19938013
199390     MOVE  '7590'  TO  PT-CURR-PARA.                              19939013
199400     IF  PS-BLD-INTERNAL-TABLE-YES                                19940013
199410         PERFORM 0200-INTERNAL-TABLE                              19941013
199420     ELSE                                                         19942013
199430         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19943013
199440     END-IF.                                                      19944013
199450                                                                  19945013
199460*                                                                 19946013
199470** DMH 2014-12-22 - END                                           19947013
199480*                                                                 19948013
199490      MOVE RECEIV-CURR-OPER-UNT-ID TO PC187-STR-NBR               19949013
199500      MOVE  +1                    TO PC187-NO-OF-LBLS             19950013
199510      PERFORM 7250-LINK-PCKCS721                                  19951013
199520      MOVE PC187-START-MFST-NBR TO PV-LBL-MANIFEST-NBR            19952013
199530      MOVE 'K'                  TO DK-CART-LBL-TYP-CDE            19953013
199540      MOVE ZEROES               TO PC160-BTCH-SML-CONTAINER-CDE   19954013
199550      SET  PC160-BTCH-SML-INTERNAL-LBL                            19955013
199560           PC160-BTCH-SML-FROM-KOHLS                              19956013
199570           PC160-PORT-SML-TXT-INTERNL-LBL                         19957013
199580           PC160-PORT-SML-TXT-FROM-KOHLS   TO TRUE                19958013
199590      MOVE RECEIV-CURR-OPER-UNT-ID TO PV-STORE-9-4                19959013
199600      MOVE PV-STORE-X-4           TO PV-STORE-NBR-4               19960013
199610      MOVE PV-STORE-NBR           TO PC160-BTCH-SML-BC-DIVERT     19961013
199620      MOVE RECEIV-CURR-OPER-UNT-ID                                19962013
199630                                 TO PC160-BTCH-SML-BC-DC-ORIGIN   19963013
199640                                    DK-DEST-OPER-UNT-ID           19964013
199650      MOVE PV-LBL-MANIFEST-NBR    TO                              19965013
199660                                    PC160-BTCH-SML-BC-MNFST-NBR   19966013
199670      MOVE PC160-BTCH-BARCODE    TO DK-BARCODE-NBR.               19967013
199680      SET PS-EAS-TAG-IND-FOUND-NO TO TRUE                         19968013
199690      PERFORM 3570-POPULATE-CRTN-LBL-XREF.                        19969013
199700      PERFORM 7350-START-VERIF-TRIGGER.                           19970013
199710                                                                  19971013
199720*----------------------------------------------------------------*19972013
199730 7600-PROCESS-INSERTS-TO-OTBND.                                   19973013
199740*                                                                 19974013
199750** added internal table to track paragraph execution time         19975013
199760** dmh 2014-12-22 - begin                                         19976013
199770*                                                                 19977013
199780     MOVE  '7600'  TO  PT-CURR-PARA.                              19978013
199790     IF  PS-BLD-INTERNAL-TABLE-YES                                19979013
199800         PERFORM 0200-INTERNAL-TABLE                              19980013
199810     ELSE                                                         19981013
199820         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       19982013
199830     END-IF.                                                      19983013
199840                                                                  19984013
199850*                                                                 19985013
199860** DMH 2014-12-22 - END                                           19986013
199870*                                                                 19987013
199880      PERFORM 7610-INSERT-OTBND-CART.                             19988013
199890      PERFORM 7620-SELECT-CRTN-UPC.                               19989013
199900      PERFORM 7645-INSERT-OTBND-LOC.                              19990013
199910      IF PS-AUTO-VE-NO                                            19991013
199920         PERFORM 7650-INSERT-OTBND-VND                            19992013
199930      ELSE                                                        19993013
199940          IF RECEIV-PKGNG-CDE = PC-M OR PC-I                      19994013
199950             PERFORM 7680-SELECT-PK-SKU-NBR                       19995013
199960             PERFORM 7685-INSERT-OTBND-PACK                       19996013
199970          END-IF                                                  19997013
199980      END-IF.                                                     19998013
199990*----------------------------------------------------------------*19999013
200000*----------------------------------------------------------------*20000013
200010 7610-INSERT-OTBND-CART.                                          20001013
200020*----------------------------------------------------------------*20002013
200030*                                                                 20003013
200040** added internal table to track paragraph execution time         20004013
200050** dmh 2014-12-22 - begin                                         20005013
200060*                                                                 20006013
200070     MOVE  '7610'  TO  PT-CURR-PARA.                              20007013
200080     IF  PS-BLD-INTERNAL-TABLE-YES                                20008013
200090         PERFORM 0200-INTERNAL-TABLE                              20009013
200100     ELSE                                                         20010013
200110         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20011013
200120     END-IF.                                                      20012013
200130                                                                  20013013
200140*                                                                 20014013
200150** DMH 2014-12-22 - END                                           20015013
200160*                                                                 20016013
200170                                                                  20017013
200180      MOVE DK-BARCODE-NBR         TO PV-BAR-CODE.                 20018013
200190      MOVE PV-BAR-CODE-OTBND      TO SUT00024-SHIPT-UNT-ID        20019013
200200                                     SUT00024-PRNT-CART-ID.       20020013
200210      MOVE RECEIV-CURR-OPER-UNT-ID TO SUT00024-ORGN-LOC-NBR.      20021013
200220      MOVE DK-DEST-OPER-UNT-ID    TO SUT00024-DEST-LOC-NBR.       20022013
200230      MOVE 'ASN'                  TO SUT00024-CART-SRC-CDE.       20023013
200240      MOVE  SU054-USER-ID         TO SUT00024-CRE-USR-ID.         20024013
200250      MOVE 'SUKCS782'             TO SUT00024-CRE-PGM-NM.         20025099
200260      MOVE 'N'                    TO SUT00024-MSTR-CART-IND.      20026013
200270      MOVE PV-CTN-N               TO SUT00024-ORIG-CART-ID.       20027013
200280      MOVE 'Y'                    TO SUT00024-ACTV-IND.           20028013
200290      IF LBVRDA-INPK-CNVYB-IND  = 'Y'                             20029013
200300         MOVE PC-I                TO SUT00024-CART-TYP-CDE        20030013
200310      ELSE                                                        20031013
200320         MOVE DK-CART-LBL-TYP-CDE TO SUT00024-CART-TYP-CDE        20032013
200330      END-IF                                                      20033013
200340                                                                  20034013
200350     MOVE PS-EAS-TAG-IND-FOUND-SW TO SUT00024-EAS-TAG-IND.        20035013
200360                                                                  20036013
200370     EXEC SQL                                                     20037013
200380         INSERT INTO SUT_OTBND_CART                               20038013
200390             ( SHIPT_UNT_ID                                       20039013
200400              ,ORGN_LOC_NBR                                       20040013
200410              ,DEST_LOC_NBR                                       20041013
200420              ,CART_SRC_CDE                                       20042013
200430              ,CRE_DTE                                            20043013
200440              ,CRE_TM                                             20044013
200450              ,CRE_USR_ID                                         20045013
200460              ,CRE_PGM_NM                                         20046013
200470              ,MSTR_CART_IND                                      20047013
200480              ,PRNT_CART_ID                                       20048013
200490              ,ORIG_CART_ID                                       20049013
200500              ,CART_TYP_CDE                                       20050013
200510              ,LBL_PRT_SEQ_NBR                                    20051013
200520              ,CART_RVSN_NBR                                      20052013
200530              ,OTBND_TRIP_ID                                      20053013
200540              ,ACTV_IND                                           20054013
200550              ,EAS_TAG_IND)                                       20055013
200560         VALUES (:SUT00024-SHIPT-UNT-ID                           20056013
200570                ,:SUT00024-ORGN-LOC-NBR                           20057013
200580                ,:SUT00024-DEST-LOC-NBR                           20058013
200590                ,:SUT00024-CART-SRC-CDE                           20059013
200600                , CURRENT DATE                                    20060013
200610                , CURRENT TIME                                    20061013
200620                ,:SUT00024-CRE-USR-ID                             20062013
200630                ,:SUT00024-CRE-PGM-NM                             20063013
200640                ,:SUT00024-MSTR-CART-IND                          20064013
200650                ,:SUT00024-PRNT-CART-ID                           20065013
200660                ,:SUT00024-ORIG-CART-ID                           20066013
200670                ,:SUT00024-CART-TYP-CDE                           20067013
200680                , 0                                               20068013
200690                , 0                                               20069013
200700                , NULL                                            20070013
200710                ,:SUT00024-ACTV-IND                               20071013
200720                ,:SUT00024-EAS-TAG-IND)                           20072013
200730     END-EXEC                                                     20073013
200740                                                                  20074013
200750         EVALUATE TRUE                                            20075013
200760             WHEN SQLCODE = ZERO                                  20076013
200770                SET PS-DONE                                       20077013
200780                    PS-CARTON-SML-CREATED TO TRUE                 20078013
200790                                                                  20079013
200800* DMH 11/29/02 - BEGIN - TEMPORARY FIX UNTIL RECLAIM REDONE       20080013
200810             WHEN SQLCODE = -803                                  20081013
200820                  PERFORM 7660-DELETE-OTBD-UPC                    20082013
200830                  PERFORM 7665-DELETE-OTBD-VND                    20083013
200840                  PERFORM 7670-UPDATE-OTBD-CART                   20084013
200850                  SET PS-CARTON-SML-CREATED TO TRUE               20085013
200860* DMH 11/29/02 - END                                              20086013
200870                                                                  20087013
200880             WHEN SQLWARN0 NOT = SPACES                           20088013
200890             WHEN SQLCODE < ZERO                                  20089013
200900             WHEN SQLCODE > ZERO                                  20090013
200910                                                                  20091013
200920              INITIALIZE PV-CICS-MSG-AREA1                        20092013
200930              INITIALIZE PV-CICS-MSG-AREA2                        20093013
200940                                                                  20094013
200950              MOVE SQLCODE              TO PV-DISP-SQLCODE        20095013
200960              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20096013
200970              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20097013
200980              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20098013
200990                                                                  20099013
201000              STRING  'SUKCS782 7610-'                            20100099
201010                      ' DC:'               PV-DISP-DC             20101013
201020                      ' B1:'               SU054-BAR-CODE-1       20102013
201030                      ' B2:'               SU054-BAR-CODE-2       20103013
201040                      ' B3:'               SU054-BAR-CODE-3       20104013
201050                                           DELIMITED BY SIZE      20105013
201060                                      INTO PV-CICS-MSG-AREA1      20106013
201070                                                                  20107013
201080              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20108013
201090              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20109013
201100                                                                  20110013
201110              PERFORM 9999-WRITE-TO-CSSL                          20111013
201120                                                                  20112013
201130              STRING  'SUKCS782 '          SU054-KOHLS-SML        20113099
201140                      ' TRIP:'             PV-DISP-TRIP           20114013
201150                      ' DR:'               SU054-DOOR-NUMBER      20115013
201160                      ' USR:'              SU054-USER-ID          20116013
201170                      ' STA:'              PV-DISP-PNA-STA        20117013
201180                      ' SQL:'              PV-DISP-SQLCODE        20118013
201190                      ' SUT_OTBND_CART - INSERT'                  20119013
201200                                           DeLIMITED BY SIZE      20120013
201210                                      INTO PV-CICS-MSG-AREA2      20121013
201220                                                                  20122013
201230              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20123013
201240              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20124013
201250                                                                  20125013
201260              PERFORM 9999-WRITE-TO-CSSL                          20126013
201270                                                                  20127013
201280              INITIALIZE PV-CICS-MSG-AREA3                        20128013
201290                                                                  20129013
201300              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISP-sml           20130013
201310              MOVE SUT00024-ORGN-LOC-NBR TO PV-DISP-oper          20131013
201320              MOVE SUT00024-DEST-LOC-NBR TO PV-DISP-dest-oper     20132013
201330                                                                  20133013
201340              STRING  'SUKCS782 '                                 20134099
201350                      ' SML:'          PV-DISP-SML                20135013
201360                      ' OPER:'         PV-DISP-OPER               20136013
201370                      ' DEST:'         PV-DISP-DEST-OPER          20137013
201380                      ' SRC:'          SUT00024-CART-SRC-CDE      20138013
201390                      ' DTE:'          SUT00024-CRE-DTE           20139013
201400                      ' TME:'          SUT00024-CRE-TM            20140013
201410                                           DELIMITED BY SIZE      20141013
201420                                      INTO PV-CICS-MSG-AREA3      20142013
201430                                                                  20143013
201440              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20144013
201450              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20145013
201460                                                                  20146013
201470              PERFORM 9999-WRITE-TO-CSSL                          20147013
201480                                                                  20148013
201490              INITIALIZE PV-CICS-MSG-AREA4                        20149013
201500                                                                  20150013
201510              MOVE SUT00024-PRNT-CART-ID TO PV-DISP-PARENT        20151013
201520              MOVE SUT00024-ORIG-CART-ID TO PV-DISP-ORIG          20152013
201530                                                                  20153013
201540              STRING  'SUKCS782 '                                 20154099
201550                      ' USR:'          SUT00024-CRE-USR-ID        20155013
201560                      ' PGM:'          SUT00024-CRE-PGM-NM        20156013
201570                      ' MST:'          SUT00024-MSTR-CART-IND     20157013
201580                      ' PARENT:'       PV-DISP-PARENT             20158013
201590                      ' ORIG:'         PV-DISP-ORIG               20159013
201600                                           DELIMITED BY SIZE      20160013
201610                                      INTO PV-CICS-MSG-AREA4      20161013
201620                                                                  20162013
201630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20163013
201640              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     20164013
201650                                                                  20165013
201660              PERFORM 9999-WRITE-TO-CSSL                          20166013
201670                                                                  20167013
201680              INITIALIZE PV-CICS-MSG-AREA5                        20168013
201690                                                                  20169013
201700              MOVE SUT00024-CART-RVSN-NBR TO PV-DISP-RVSN         20170013
201710              MOVE SUT00024-OTBND-TRIP-ID TO PV-DISP-TRIP         20171013
201720                                                                  20172013
201730              STRING  'SUKCS782 '                                 20173099
201740                      ' TYP:'          SUT00024-CART-TYP-CDE      20174013
201750                      ' RVSN:'         PV-DISP-RVSN               20175013
201760                      ' TRIP:'         PV-DISP-TRIP               20176013
201770                      ' ACTV:'         SUT00024-ACTV-IND          20177013
201780                      ' ODD:'          SUT00024-ODD-UNT-IND       20178013
201790                      ' EAS:'          SUT00024-EAS-TAG-IND       20179013
201800                                           DELIMITED BY SIZE      20180013
201810                                      INTO PV-CICS-MSG-AREA5      20181013
201820                                                                  20182013
201830              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20183013
201840              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     20184013
201850                                                                  20185013
201860              PERFORM 9999-WRITE-TO-CSSL                          20186013
201870                                                                  20187013
201880                 SET PS-PROCESSING-ERROR-YES TO TRUE              20188013
201890                 PERFORM 9998-WRITE-TO-CSSL                       20189013
201900         END-EVALUATE.                                            20190013
201910                                                                  20191013
201920 EJECT                                                            20192013
201930*----------------------------------------------------------------*20193013
201940 7620-SELECT-CRTN-UPC.                                            20194013
201950*                                                                 20195013
201960** added internal table to track paragraph execution time         20196013
201970** dmh 2014-12-22 - begin                                         20197013
201980*                                                                 20198013
201990     MOVE  '7620'  TO  PT-CURR-PARA.                              20199013
202000     IF  PS-BLD-INTERNAL-TABLE-YES                                20200013
202010         PERFORM 0200-INTERNAL-TABLE                              20201013
202020     ELSE                                                         20202013
202030         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20203013
202040     END-IF.                                                      20204013
202050                                                                  20205013
202060*                                                                 20206013
202070** DMH 2014-12-22 - END                                           20207013
202080*                                                                 20208013
202090      SET PS-NOT-END-OF-UPC-UNLOAD-CSR TO TRUE.                   20209013
202100      PERFORM 7625-OPEN-UPC-UNLOAD-CSR.                           20210013
202110      PERFORM 7630-FETCH-UPC-UNLOAD-CSR                           20211013
202120            UNTIL PS-END-OF-UPC-UNLOAD-CSR.                       20212013
202130      PERFORM 7640-CLOSE-UPC-UNLOAD-CSR.                          20213013
202140*----------------------------------------------------------------*20214013
202150 7625-OPEN-UPC-UNLOAD-CSR.                                        20215013
202160******************************************************************20216013
202170*                                                                 20217013
202180** added internal table to track paragraph execution time         20218013
202190** dmh 2014-12-22 - begin                                         20219013
202200*                                                                 20220013
202210     MOVE  '7625'  TO  PT-CURR-PARA.                              20221013
202220     IF  PS-BLD-INTERNAL-TABLE-YES                                20222013
202230         PERFORM 0200-INTERNAL-TABLE                              20223013
202240     ELSE                                                         20224013
202250         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20225013
202260     END-IF.                                                      20226013
202270                                                                  20227013
202280*                                                                 20228013
202290** DMH 2014-12-22 - END                                           20229013
202300*                                                                 20230013
202310                                                                  20231013
202320         EXEC SQL                                                 20232013
202330              OPEN UPC_UNLOAD_CSR                                 20233013
202340         END-EXEC                                                 20234013
202350                                                                  20235013
202360                                                                  20236013
202370         EVALUATE TRUE                                            20237013
202380             WHEN SQLCODE = ZERO                                  20238013
202390                 CONTINUE                                         20239013
202400             WHEN SQLWARN0 NOT = SPACES                           20240013
202410             WHEN SQLCODE < ZERO                                  20241013
202420             WHEN SQLCODE > ZERO                                  20242013
202430                                                                  20243013
202440              INITIALIZE PV-CICS-MSG-AREA1                        20244013
202450              INITIALIZE PV-CICS-MSG-AREA2                        20245013
202460                                                                  20246013
202470              MOVE SQLCODE              TO PV-DISP-SQLCODE        20247013
202480              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20248013
202490              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20249013
202500              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20250013
202510                                                                  20251013
202520              STRING  'SUKCS782 7625-'                            20252099
202530                      ' DC:'               PV-DISP-DC             20253013
202540                      ' B1:'               SU054-BAR-CODE-1       20254013
202550                      ' B2:'               SU054-BAR-CODE-2       20255013
202560                      ' B3:'               SU054-BAR-CODE-3       20256013
202570                                           DELIMITED BY SIZE      20257013
202580                                      INTO PV-CICS-MSG-AREA1      20258013
202590                                                                  20259013
202600              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20260013
202610              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20261013
202620                                                                  20262013
202630              PERFORM 9999-WRITE-TO-CSSL                          20263013
202640                                                                  20264013
202650              STRING  'SUKCS782 '          SU054-KOHLS-SML        20265099
202660                      ' TRIP:'             PV-DISP-TRIP           20266013
202670                      ' DR:'               SU054-DOOR-NUMBER      20267013
202680                      ' USR:'              SU054-USER-ID          20268013
202690                      ' STA:'              PV-DISP-PNA-STA        20269013
202700                      ' SQL:'              PV-DISP-SQLCODE        20270013
202710                      ' TSHUUPC - OPEN UPC_UNLOAD_CSR'            20271013
202720                                           DELIMITED BY SIZE      20272013
202730                                      INTO PV-CICS-MSG-AREA2      20273013
202740                                                                  20274013
202750              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20275013
202760              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20276013
202770                                                                  20277013
202780              PERFORM 9999-WRITE-TO-CSSL                          20278013
202790                                                                  20279013
202800              INITIALIZE PV-CICS-MSG-AREA3                        20280013
202810                                                                  20281013
202820              MOVE DK-CTN  TO  PV-DISP-SSCC                       20282013
202830                                                                  20283013
202840              STRING  'SUKCS782 '                                 20284099
202850                      ' SSCC:'         PV-DISP-SSCC               20285013
202860                                           DELIMITED BY SIZE      20286013
202870                                      INTO PV-CICS-MSG-AREA3      20287013
202880                                                                  20288013
202890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20289013
202900              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20290013
202910                                                                  20291013
202920              PERFORM 9999-WRITE-TO-CSSL                          20292013
202930                                                                  20293013
202940                 SET PS-PROCESSING-ERROR-YES TO TRUE              20294013
202950                 PERFORM 9998-WRITE-TO-CSSL                       20295013
202960         END-EVALUATE.                                            20296013
202970                                                                  20297013
202980 EJECT                                                            20298013
202990*----------------------------------------------------------------*20299013
203000 7630-FETCH-UPC-UNLOAD-CSR.                                       20300013
203010*----------------------------------------------------------------*20301013
203020*                                                                 20302013
203030** added internal table to track paragraph execution time         20303013
203040** dmh 2014-12-22 - begin                                         20304013
203050*                                                                 20305013
203060     MOVE  '7630'  TO  PT-CURR-PARA.                              20306013
203070     IF  PS-BLD-INTERNAL-TABLE-YES                                20307013
203080         PERFORM 0200-INTERNAL-TABLE                              20308013
203090     ELSE                                                         20309013
203100         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20310013
203110     END-IF.                                                      20311013
203120                                                                  20312013
203130*                                                                 20313013
203140** DMH 2014-12-22 - END                                           20314013
203150*                                                                 20315013
203160                                                                  20316013
203170     EXEC SQL                                                     20317013
203180        FETCH UPC_UNLOAD_CSR                                      20318013
203190        INTO   :SUT00028-UPC-NBR                                  20319013
203200              ,:SUT00028-TRN-NBR                                  20320013
203210              ,:SUT00028-TRN-LNE-NBR                              20321013
203220              ,:SUT00028-TRN-TYP-CDE                              20322013
203230              ,:SUT00028-SHPD-UNT-QTY                             20323013
203240     END-EXEC.                                                    20324013
203250                                                                  20325013
203260     EVALUATE TRUE                                                20326013
203270       WHEN SQLCODE = ZEROS                                       20327013
203280            PERFORM 7635-INSERT-OTBND-UPC                         20328013
203290       WHEN SQLCODE = +100                                        20329013
203300                SET  PS-END-OF-UPC-UNLOAD-CSR TO TRUE             20330013
203310       WHEN OTHER                                                 20331013
203320                                                                  20332013
203330              INITIALIZE PV-CICS-MSG-AREA1                        20333013
203340              INITIALIZE PV-CICS-MSG-AREA2                        20334013
203350                                                                  20335013
203360              MOVE SQLCODE              TO PV-DISP-SQLCODE        20336013
203370              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20337013
203380              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20338013
203390              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20339013
203400                                                                  20340013
203410              STRING  'SUKCS782 7630-'                            20341099
203420                      ' DC:'               PV-DISP-DC             20342013
203430                      ' B1:'               SU054-BAR-CODE-1       20343013
203440                      ' B2:'               SU054-BAR-CODE-2       20344013
203450                      ' B3:'               SU054-BAR-CODE-3       20345013
203460                                           DELIMITED BY SIZE      20346013
203470                                      INTO PV-CICS-MSG-AREA1      20347013
203480                                                                  20348013
203490              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20349013
203500              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20350013
203510                                                                  20351013
203520              PERFORM 9999-WRITE-TO-CSSL                          20352013
203530                                                                  20353013
203540              STRING  'SUKCS782 '          SU054-KOHLS-SML        20354099
203550                      ' TRIP:'             PV-DISP-TRIP           20355013
203560                      ' DR:'               SU054-DOOR-NUMBER      20356013
203570                      ' USR:'              SU054-USER-ID          20357013
203580                      ' STA:'              PV-DISP-PNA-STA        20358013
203590                      ' SQL:'              PV-DISP-SQLCODE        20359013
203600                      ' TSHUUPC - FETCH UPC_UNLOAD_CSR'           20360013
203610                                           DELIMITED BY SIZE      20361013
203620                                      INTO PV-CICS-MSG-AREA2      20362013
203630                                                                  20363013
203640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20364013
203650              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20365013
203660                                                                  20366013
203670              PERFORM 9999-WRITE-TO-CSSL                          20367013
203680                                                                  20368013
203690              INITIALIZE PV-CICS-MSG-AREA3                        20369013
203700                                                                  20370013
203710              MOVE DK-CTN  TO  PV-DISP-SSCC                       20371013
203720                                                                  20372013
203730              STRING  'SUKCS782 '                                 20373099
203740                      ' SSCC:'         PV-DISP-SSCC               20374013
203750                                           DELIMITED BY SIZE      20375013
203760                                      INTO PV-CICS-MSG-AREA3      20376013
203770                                                                  20377013
203780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20378013
203790              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20379013
203800                                                                  20380013
203810              PERFORM 9999-WRITE-TO-CSSL                          20381013
203820                                                                  20382013
203830             SET PS-PROCESSING-ERROR-YES TO TRUE                  20383013
203840             PERFORM 9998-WRITE-TO-CSSL                           20384013
203850     END-EVALUATE.                                                20385013
203860                                                                  20386013
203870*----------------------------------------------------------------*20387013
203880 7635-INSERT-OTBND-UPC.                                           20388013
203890*----------------------------------------------------------------*20389013
203900*                                                                 20390013
203910** added internal table to track paragraph execution time         20391013
203920** dmh 2014-12-22 - begin                                         20392013
203930*                                                                 20393013
203940     MOVE  '7635'  TO  PT-CURR-PARA.                              20394013
203950     IF  PS-BLD-INTERNAL-TABLE-YES                                20395013
203960         PERFORM 0200-INTERNAL-TABLE                              20396013
203970     ELSE                                                         20397013
203980         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20398013
203990     END-IF.                                                      20399013
204000                                                                  20400013
204010*                                                                 20401013
204020** DMH 2014-12-22 - END                                           20402013
204030*                                                                 20403013
204040                                                                  20404013
204050     MOVE SUT00024-SHIPT-UNT-ID    TO SUT00028-SHIPT-UNT-ID.      20405013
204060                                                                  20406013
204070     IF PS-AUTO-VE-YES                                            20407013
204080        MOVE PV-RCVR-SEQ-NBR          TO SUT00028-RCVR-SEQ-NBR    20408013
204090     ELSE                                                         20409013
204100        MOVE ZEROES                   TO SUT00028-RCVR-SEQ-NBR    20410013
204110     END-IF                                                       20411013
204120                                                                  20412013
204130     IF LBVRDA-INPK-CNVYB-IND = 'Y'                               20413013
204140        MOVE LBVRDA-INPK-UNT-QTY  TO SUT00028-SHPD-UNT-QTY        20414013
204150     END-IF                                                       20415013
204160                                                                  20416013
204170     EXEC SQL                                                     20417013
204180         INSERT INTO SUT_OTBND_UPC                                20418013
204190             ( SHIPT_UNT_ID                                       20419013
204200              ,TRN_NBR                                            20420013
204210              ,RCVR_SEQ_NBR                                       20421013
204220              ,TRN_LNE_NBR                                        20422013
204230              ,TRN_TYP_CDE                                        20423013
204240              ,UPC_NBR                                            20424013
204250              ,SHPD_UNT_QTY)                                      20425013
204260         VALUES (:SUT00028-SHIPT-UNT-ID                           20426013
204270                ,:SUT00028-TRN-NBR                                20427013
204280                ,:SUT00028-RCVR-SEQ-NBR                           20428013
204290                ,:SUT00028-TRN-LNE-NBR                            20429013
204300                ,:SUT00028-TRN-TYP-CDE                            20430013
204310                ,:SUT00028-UPC-NBR                                20431013
204320                ,:SUT00028-SHPD-UNT-QTY)                          20432013
204330     END-EXEC                                                     20433013
204340                                                                  20434013
204350         EVALUATE TRUE                                            20435013
204360             WHEN SQLCODE = ZERO                                  20436013
204370             WHEN SQLCODE = +100                                  20437013
204380                CONTINUE                                          20438013
204390             WHEN SQLWARN0 NOT = SPACES                           20439013
204400             WHEN SQLCODE < ZERO                                  20440013
204410             WHEN SQLCODE > ZERO                                  20441013
204420                                                                  20442013
204430              INITIALIZE PV-CICS-MSG-AREA1                        20443013
204440              INITIALIZE PV-CICS-MSG-AREA2                        20444013
204450                                                                  20445013
204460              MOVE SQLCODE              TO PV-DISP-SQLCODE        20446013
204470              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20447013
204480              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20448013
204490              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20449013
204500                                                                  20450013
204510              STRING  'SUKCS782 7635-'                            20451099
204520                      ' DC:'               PV-DISP-DC             20452013
204530                      ' B1:'               SU054-BAR-CODE-1       20453013
204540                      ' B2:'               SU054-BAR-CODE-2       20454013
204550                      ' B3:'               SU054-BAR-CODE-3       20455013
204560                                           DELIMITED BY SIZE      20456013
204570                                      INTO PV-CICS-MSG-AREA1      20457013
204580                                                                  20458013
204590              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20459013
204600              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20460013
204610                                                                  20461013
204620              PERFORM 9999-WRITE-TO-CSSL                          20462013
204630                                                                  20463013
204640              STRING  'SUKCS782 '          SU054-KOHLS-SML        20464099
204650                      ' TRIP:'             PV-DISP-TRIP           20465013
204660                      ' DR:'               SU054-DOOR-NUMBER      20466013
204670                      ' USR:'              SU054-USER-ID          20467013
204680                      ' STA:'              PV-DISP-PNA-STA        20468013
204690                      ' SQL:'              PV-DISP-SQLCODE        20469013
204700                      ' SUT_OTBND_UPC - INSERT'                   20470013
204710                                           DELIMITED BY SIZE      20471013
204720                                      INTO PV-CICS-MSG-AREA2      20472013
204730                                                                  20473013
204740              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20474013
204750              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20475013
204760                                                                  20476013
204770              PERFORM 9999-WRITE-TO-CSSL                          20477013
204780                                                                  20478013
204790              INITIALIZE PV-CICS-MSG-AREA3                        20479013
204800                                                                  20480013
204810              MOVE SUT00028-SHIPT-UNT-ID TO PV-DISP-SML           20481013
204820              MOVE SUT00028-TRN-NBR      TO PV-DISP-PO            20482013
204830              MOVE SUT00028-RCVR-SEQ-NBR TO PV-DISP-RCVR          20483013
204840              MOVE SUT00028-TRN-LNE-NBR  TO pv-disp-line          20484013
204850              MOVE SUT00028-UPC-NBR      TO PV-DISP-UPC           20485013
204860              MOVE SUT00028-SHPD-UNT-QTY TO PV-DISP-QTY           20486013
204870                                                                  20487013
204880              STRING  'SUKCS782 '                                 20488099
204890                      ' SML:'          PV-DISP-SML                20489013
204900                      ' PO:'           PV-DISP-PO                 20490013
204910                      '-'              PV-DISP-RCVR               20491013
204920                      '-'              pv-disp-line               20492013
204930                      ' TYP:'          SUT00028-TRN-TYP-CDE       20493013
204940                      ' UPC:'          PV-DISP-UPC                20494013
204950                      ' QTY:'          PV-DISP-QTY                20495013
204960                                           DELIMITED BY SIZE      20496013
204970                                      INTO PV-CICS-MSG-AREA3      20497013
204980                                                                  20498013
204990              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20499013
205000              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20500013
205010                                                                  20501013
205020              PERFORM 9999-WRITE-TO-CSSL                          20502013
205030                                                                  20503013
205040                 SET PS-PROCESSING-ERROR-YES TO TRUE              20504013
205050                 PERFORM 9998-WRITE-TO-CSSL                       20505013
205060         END-EVALUATE.                                            20506013
205070                                                                  20507013
205080 EJECT                                                            20508013
205090*----------------------------------------------------------------*20509013
205100 7640-CLOSE-UPC-UNLOAD-CSR.                                       20510013
205110*----------------------------------------------------------------*20511013
205120*                                                                 20512013
205130** added internal table to track paragraph execution time         20513013
205140** dmh 2014-12-22 - begin                                         20514013
205150*                                                                 20515013
205160     MOVE  '7640'  TO  PT-CURR-PARA.                              20516013
205170     IF  PS-BLD-INTERNAL-TABLE-YES                                20517013
205180         PERFORM 0200-INTERNAL-TABLE                              20518013
205190     ELSE                                                         20519013
205200         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20520013
205210     END-IF.                                                      20521013
205220                                                                  20522013
205230*                                                                 20523013
205240** DMH 2014-12-22 - END                                           20524013
205250*                                                                 20525013
205260                                                                  20526013
205270         EXEC SQL                                                 20527013
205280             CLOSE UPC_UNLOAD_CSR                                 20528013
205290         END-EXEC                                                 20529013
205300                                                                  20530013
205310                                                                  20531013
205320         EVALUATE TRUE                                            20532013
205330             WHEN SQLCODE = ZERO                                  20533013
205340                 CONTINUE                                         20534013
205350             WHEN SQLWARN0 NOT = SPACES                           20535013
205360             WHEN SQLCODE < ZERO                                  20536013
205370             WHEN SQLCODE > ZERO                                  20537013
205380                                                                  20538013
205390              INITIALIZE PV-CICS-MSG-AREA1                        20539013
205400              INITIALIZE PV-CICS-MSG-AREA2                        20540013
205410                                                                  20541013
205420              MOVE SQLCODE              TO PV-DISP-SQLCODE        20542013
205430              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20543013
205440              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20544013
205450              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20545013
205460                                                                  20546013
205470              STRING  'SUKCS782 7640-'                            20547099
205480                      ' DC:'               PV-DISP-DC             20548013
205490                      ' B1:'               SU054-BAR-CODE-1       20549013
205500                      ' B2:'               SU054-BAR-CODE-2       20550013
205510                      ' B3:'               SU054-BAR-CODE-3       20551013
205520                                           DELIMITED BY SIZE      20552013
205530                                      INTO PV-CICS-MSG-AREA1      20553013
205540                                                                  20554013
205550              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20555013
205560              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20556013
205570                                                                  20557013
205580              PERFORM 9999-WRITE-TO-CSSL                          20558013
205590                                                                  20559013
205600              STRING  'SUKCS782 '          SU054-KOHLS-SML        20560099
205610                      ' TRIP:'             PV-DISP-TRIP           20561013
205620                      ' DR:'               SU054-DOOR-NUMBER      20562013
205630                      ' USR:'              SU054-USER-ID          20563013
205640                      ' STA:'              PV-DISP-PNA-STA        20564013
205650                      ' SQL:'              PV-DISP-SQLCODE        20565013
205660                      ' TSHUUPC - CLOSE UPC_UNLOAD_CSR'           20566013
205670                                           DELIMITED BY SIZE      20567013
205680                                      INTO PV-CICS-MSG-AREA2      20568013
205690                                                                  20569013
205700              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20570013
205710              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20571013
205720                                                                  20572013
205730              PERFORM 9999-WRITE-TO-CSSL                          20573013
205740                                                                  20574013
205750              INITIALIZE PV-CICS-MSG-AREA3                        20575013
205760                                                                  20576013
205770              MOVE DK-CTN  TO  PV-DISP-SSCC                       20577013
205780                                                                  20578013
205790              STRING  'SUKCS782 '                                 20579099
205800                      ' SSCC:'         PV-DISP-SSCC               20580013
205810                                           DELIMITED BY SIZE      20581013
205820                                      INTO PV-CICS-MSG-AREA3      20582013
205830                                                                  20583013
205840              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20584013
205850              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20585013
205860                                                                  20586013
205870              PERFORM 9999-WRITE-TO-CSSL                          20587013
205880                                                                  20588013
205890                 SET PS-PROCESSING-ERROR-YES TO TRUE              20589013
205900                 PERFORM 9998-WRITE-TO-CSSL                       20590013
205910         END-EVALUATE.                                            20591013
205920                                                                  20592013
205930*----------------------------------------------------------------*20593013
205940 7645-INSERT-OTBND-LOC.                                           20594013
205950*----------------------------------------------------------------*20595013
205960*                                                                 20596013
205970** added internal table to track paragraph execution time         20597013
205980** dmh 2014-12-22 - begin                                         20598013
205990*                                                                 20599013
206000     MOVE  '7645'  TO  PT-CURR-PARA.                              20600013
206010     IF  PS-BLD-INTERNAL-TABLE-YES                                20601013
206020         PERFORM 0200-INTERNAL-TABLE                              20602013
206030     ELSE                                                         20603013
206040         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20604013
206050     END-IF.                                                      20605013
206060                                                                  20606013
206070*                                                                 20607013
206080** DMH 2014-12-22 - END                                           20608013
206090*                                                                 20609013
206100     MOVE SUT00024-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID.        20610013
206110     MOVE RECEIV-CURR-OPER-UNT-ID TO SUT00027-LOC-NBR.            20611013
206120     MOVE PV-DEST-STORE          TO SUT00024-DEST-LOC-NBR.        20612013
206130     MOVE 'RECV'                 TO SUT00027-SCN-CDE.             20613013
206140     MOVE  SU054-USER-ID         TO SUT00027-CRE-USR-ID.          20614013
206150     MOVE  'A'                   TO SUT00027-ACTV-CDE.            20615013
206160     MOVE SU054-TRIP-ID          TO SUT00027-INBD-TRIP-ID.        20616013
206170                                                                  20617013
206180                                                                  20618013
206190     EXEC SQL                                                     20619013
206200         INSERT INTO SUT_OTBND_LOC                                20620013
206210             ( SHIPT_UNT_ID                                       20621013
206220              ,CRE_TMST                                           20622013
206230              ,OTBND_TRIP_ID                                      20623013
206240              ,LOC_NBR                                            20624013
206250              ,SCN_CDE                                            20625013
206260              ,CRE_USR_ID                                         20626013
206270              ,ACTV_CDE                                           20627013
206280              ,INBD_TRIP_ID)                                      20628013
206290        VALUES (:SUT00027-SHIPT-UNT-ID                            20629013
206300               , CURRENT TIMESTAMP                                20630013
206310               , NULL                                             20631013
206320               ,:SUT00027-LOC-NBR                                 20632013
206330               ,:SUT00027-SCN-CDE                                 20633013
206340               ,:SUT00027-CRE-USR-ID                              20634013
206350               ,:SUT00027-ACTV-CDE                                20635013
206360               ,:SUT00027-INBD-TRIP-ID)                           20636013
206370     END-EXEC                                                     20637013
206380                                                                  20638013
206390         EVALUATE TRUE                                            20639013
206400             WHEN SQLCODE = ZERO                                  20640013
206410             WHEN SQLCODE = +100                                  20641013
206420                CONTINUE                                          20642013
206430             WHEN SQLWARN0 NOT = SPACES                           20643013
206440             WHEN SQLCODE < ZERO                                  20644013
206450             WHEN SQLCODE > ZERO                                  20645013
206460                                                                  20646013
206470              INITIALIZE PV-CICS-MSG-AREA1                        20647013
206480              INITIALIZE PV-CICS-MSG-AREA2                        20648013
206490                                                                  20649013
206500              MOVE SQLCODE              TO PV-DISP-SQLCODE        20650013
206510              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20651013
206520              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20652013
206530              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20653013
206540                                                                  20654013
206550              STRING  'SUKCS782 7645-'                            20655099
206560                      ' DC:'               PV-DISP-DC             20656013
206570                      ' B1:'               SU054-BAR-CODE-1       20657013
206580                      ' B2:'               SU054-BAR-CODE-2       20658013
206590                      ' B3:'               SU054-BAR-CODE-3       20659013
206600                                           DELIMITED BY SIZE      20660013
206610                                      INTO PV-CICS-MSG-AREA1      20661013
206620                                                                  20662013
206630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20663013
206640              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20664013
206650                                                                  20665013
206660              PERFORM 9999-WRITE-TO-CSSL                          20666013
206670                                                                  20667013
206680              STRING  'SUKCS782 '          SU054-KOHLS-SML        20668099
206690                      ' TRIP:'             PV-DISP-TRIP           20669013
206700                      ' DR:'               SU054-DOOR-NUMBER      20670013
206710                      ' USR:'              SU054-USER-ID          20671013
206720                      ' STA:'              PV-DISP-PNA-STA        20672013
206730                      ' SQL:'              PV-DISP-SQLCODE        20673013
206740                      ' SUT_OTBND_LOC - INSERT'                   20674013
206750                                           DELIMITED BY SIZE      20675013
206760                                      INTO PV-CICS-MSG-AREA2      20676013
206770                                                                  20677013
206780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20678013
206790              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20679013
206800                                                                  20680013
206810              PERFORM 9999-WRITE-TO-CSSL                          20681013
206820                                                                  20682013
206830              INITIALIZE PV-CICS-MSG-AREA3                        20683013
206840                                                                  20684013
206850              MOVE SUT00027-SHIPT-UNT-ID TO PV-DISP-SML           20685013
206860              MOVE SUT00027-LOC-NBR      TO PV-DISP-OPER          20686013
206870              MOVE SUT00027-INBD-TRIP-ID TO PV-DISP-TRIP          20687013
206880                                                                  20688013
206890              STRING 'SUKCS782 '                                  20689099
206900                     ' SML:'           PV-DISP-SML                20690013
206910                     ' OPER:'          PV-DISP-OPER               20691013
206920                     ' SCN:'           SUT00027-SCN-CDE           20692013
206930                     ' USR:'           SUT00027-CRE-USR-ID        20693013
206940                     ' ACTV:'          SUT00027-ACTV-CDE          20694013
206950                     ' TRIP:'          PV-DISP-TRIP               20695013
206960                                           DELIMITED BY SIZE      20696013
206970                                      INTO PV-CICS-MSG-AREA3      20697013
206980                                                                  20698013
206990              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20699013
207000              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20700013
207010                                                                  20701013
207020              PERFORM 9999-WRITE-TO-CSSL                          20702013
207030                                                                  20703013
207040                 SET PS-PROCESSING-ERROR-YES TO TRUE              20704013
207050                 PERFORM 9998-WRITE-TO-CSSL                       20705013
207060         END-EVALUATE.                                            20706013
207070                                                                  20707013
207080                                                                  20708013
207090*----------------------------------------------------------------*20709013
207100*                                                                *20710013
207110*                                                                *20711013
207120*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *20712013
207130*----------------------------------------------------------------*20713013
207140 7650-INSERT-OTBND-VND.                                           20714013
207150*                                                                 20715013
207160** added internal table to track paragraph execution time         20716013
207170** dmh 2014-12-22 - begin                                         20717013
207180*                                                                 20718013
207190     MOVE  '7650'  TO  PT-CURR-PARA.                              20719013
207200     IF  PS-BLD-INTERNAL-TABLE-YES                                20720013
207210         PERFORM 0200-INTERNAL-TABLE                              20721013
207220     ELSE                                                         20722013
207230         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20723013
207240     END-IF.                                                      20724013
207250                                                                  20725013
207260*                                                                 20726013
207270** DMH 2014-12-22 - END                                           20727013
207280*                                                                 20728013
207290     MOVE PV-CTN TO INPKSU-SHIPT-UNT-ID.                          20729013
207300                                                                  20730013
207310     EXEC SQL                                                     20731013
207320         SELECT PO_NBR                                            20732013
207330               ,SEQ_NBR                                           20733013
207340          INTO :INPKSU-PO-NBR                                     20734013
207350              ,:INPKSU-SEQ-NBR                                    20735013
207360          FROM  TINPKSU                                           20736013
207370         WHERE  SHIPT_UNT_ID = :INPKSU-SHIPT-UNT-ID               20737013
207380          WITH UR                                                 20738013
207390     END-EXEC                                                     20739013
207400                                                                  20740013
207410         EVALUATE TRUE                                            20741013
207420             WHEN SQLCODE = ZERO                                  20742013
207430                CONTINUE                                          20743013
207440             WHEN SQLCODE = +100                                  20744013
207450                                                                  20745013
207460              INITIALIZE PV-CICS-MSG-AREA1                        20746013
207470              INITIALIZE PV-CICS-MSG-AREA2                        20747013
207480                                                                  20748013
207490              MOVE SQLCODE              TO PV-DISP-SQLCODE        20749013
207500              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20750013
207510              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20751013
207520              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20752013
207530                                                                  20753013
207540              STRING  'SUKCS782 7650-'                            20754099
207550                      ' DC:'               PV-DISP-DC             20755013
207560                      ' B1:'               SU054-BAR-CODE-1       20756013
207570                      ' B2:'               SU054-BAR-CODE-2       20757013
207580                      ' B3:'               SU054-BAR-CODE-3       20758013
207590                                           DELIMITED BY SIZE      20759013
207600                                      INTO PV-CICS-MSG-AREA1      20760013
207610                                                                  20761013
207620              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20762013
207630              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20763013
207640                                                                  20764013
207650              PERFORM 9999-WRITE-TO-CSSL                          20765013
207660                                                                  20766013
207670              STRING  'SUKCS782 '          SU054-KOHLS-SML        20767099
207680                      ' TRIP:'             PV-DISP-TRIP           20768013
207690                      ' DR:'               SU054-DOOR-NUMBER      20769013
207700                      ' USR:'              SU054-USER-ID          20770013
207710                      ' STA:'              PV-DISP-PNA-STA        20771013
207720                      ' SQL:'              PV-DISP-SQLCODE        20772013
207730                      ' TINPKSU - SELECT (+100)'                  20773013
207740                                           DELIMITED BY SIZE      20774013
207750                                      INTO PV-CICS-MSG-AREA2      20775013
207760                                                                  20776013
207770              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20777013
207780              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20778013
207790                                                                  20779013
207800              PERFORM 9999-WRITE-TO-CSSL                          20780013
207810                                                                  20781013
207820              INITIALIZE PV-CICS-MSG-AREA3                        20782013
207830                                                                  20783013
207840              MOVE INPKSU-SHIPT-UNT-ID   TO PV-DISP-sscc          20784013
207850                                                                  20785013
207860              STRING 'SUKCS782 '                                  20786099
207870                     ' SSCC:'          PV-DISP-SSCC               20787013
207880                                           DELIMITED BY SIZE      20788013
207890                                      INTO PV-CICS-MSG-AREA3      20789013
207900                                                                  20790013
207910              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20791013
207920              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20792013
207930                                                                  20793013
207940              PERFORM 9999-WRITE-TO-CSSL                          20794013
207950                                                                  20795013
207960                SET PS-PROCESSING-ERROR-YES TO TRUE               20796013
207970                PERFORM 9998-WRITE-TO-CSSL                        20797013
207980             WHEN SQLWARN0 NOT = SPACES                           20798013
207990             WHEN SQLCODE < ZERO                                  20799013
208000             WHEN SQLCODE > ZERO                                  20800013
208010                                                                  20801013
208020              INITIALIZE PV-CICS-MSG-AREA1                        20802013
208030              INITIALIZE PV-CICS-MSG-AREA2                        20803013
208040                                                                  20804013
208050              MOVE SQLCODE              TO PV-DISP-SQLCODE        20805013
208060              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20806013
208070              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20807013
208080              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20808013
208090                                                                  20809013
208100              STRING  'SUKCS782 7650-'                            20810099
208110                      ' DC:'               PV-DISP-DC             20811013
208120                      ' B1:'               SU054-BAR-CODE-1       20812013
208130                      ' B2:'               SU054-BAR-CODE-2       20813013
208140                      ' B3:'               SU054-BAR-CODE-3       20814013
208150                                           DELIMITED BY SIZE      20815013
208160                                      INTO PV-CICS-MSG-AREA1      20816013
208170                                                                  20817013
208180              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20818013
208190              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20819013
208200                                                                  20820013
208210              PERFORM 9999-WRITE-TO-CSSL                          20821013
208220                                                                  20822013
208230              STRING  'SUKCS782 '          SU054-KOHLS-SML        20823099
208240                      ' TRIP:'             PV-DISP-TRIP           20824013
208250                      ' DR:'               SU054-DOOR-NUMBER      20825013
208260                      ' USR:'              SU054-USER-ID          20826013
208270                      ' STA:'              PV-DISP-PNA-STA        20827013
208280                      ' SQL:'              PV-DISP-SQLCODE        20828013
208290                      ' TINPKSU - SELECT (OTHER)'                 20829013
208300                                           DELIMITED BY SIZE      20830013
208310                                      INTO PV-CICS-MSG-AREA2      20831013
208320                                                                  20832013
208330              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20833013
208340              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20834013
208350                                                                  20835013
208360              PERFORM 9999-WRITE-TO-CSSL                          20836013
208370                                                                  20837013
208380              INITIALIZE PV-CICS-MSG-AREA3                        20838013
208390                                                                  20839013
208400              MOVE INPKSU-SHIPT-UNT-ID   TO PV-DISP-sscc          20840013
208410                                                                  20841013
208420              STRING 'SUKCS782 '                                  20842099
208430                     ' SSCC:'          PV-DISP-SSCC               20843013
208440                                           DELIMITED BY SIZE      20844013
208450                                      INTO PV-CICS-MSG-AREA3      20845013
208460                                                                  20846013
208470              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20847013
208480              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20848013
208490                                                                  20849013
208500              PERFORM 9999-WRITE-TO-CSSL                          20850013
208510                                                                  20851013
208520                 SET PS-PROCESSING-ERROR-YES TO TRUE              20852013
208530                 PERFORM 9998-WRITE-TO-CSSL                       20853013
208540         END-EVALUATE.                                            20854013
208550                                                                  20855013
208560     MOVE SUT00024-SHIPT-UNT-ID  TO SUT00026-SHIPT-UNT-ID.        20856013
208570     MOVE INPKSU-PO-NBR          TO SUT00026-PO-NBR.              20857013
208580     MOVE INPKSU-SEQ-NBR         TO SUT00026-PKSL-SEQ-NBR.        20858013
208590                                                                  20859013
208600     EXEC SQL                                                     20860013
208610         INSERT INTO SUT_OTBND_VND                                20861013
208620             ( SHIPT_UNT_ID                                       20862013
208630              ,PO_NBR                                             20863013
208640              ,PKSL_SEQ_NBR)                                      20864013
208650         VALUES (:SUT00026-SHIPT-UNT-ID                           20865013
208660                ,:SUT00026-PO-NBR                                 20866013
208670                ,:SUT00026-PKSL-SEQ-NBR)                          20867013
208680     END-EXEC                                                     20868013
208690                                                                  20869013
208700                                                                  20870013
208710         EVALUATE TRUE                                            20871013
208720             WHEN SQLCODE = ZERO                                  20872013
208730             WHEN SQLCODE = +100                                  20873013
208740                CONTINUE                                          20874013
208750             WHEN SQLWARN0 NOT = SPACES                           20875013
208760             WHEN SQLCODE < ZERO                                  20876013
208770             WHEN SQLCODE > ZERO                                  20877013
208780                                                                  20878013
208790              INITIALIZE PV-CICS-MSG-AREA1                        20879013
208800              INITIALIZE PV-CICS-MSG-AREA2                        20880013
208810                                                                  20881013
208820              MOVE SQLCODE              TO PV-DISP-SQLCODE        20882013
208830              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20883013
208840              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20884013
208850              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20885013
208860                                                                  20886013
208870              STRING  'SUKCS782 7650-'                            20887099
208880                      ' DC:'               PV-DISP-DC             20888013
208890                      ' B1:'               SU054-BAR-CODE-1       20889013
208900                      ' B2:'               SU054-BAR-CODE-2       20890013
208910                      ' B3:'               SU054-BAR-CODE-3       20891013
208920                                           DELIMITED BY SIZE      20892013
208930                                      INTO PV-CICS-MSG-AREA1      20893013
208940                                                                  20894013
208950              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20895013
208960              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20896013
208970                                                                  20897013
208980              PERFORM 9999-WRITE-TO-CSSL                          20898013
208990                                                                  20899013
209000              STRING  'SUKCS782 '          SU054-KOHLS-SML        20900099
209010                      ' TRIP:'             PV-DISP-TRIP           20901013
209020                      ' DR:'               SU054-DOOR-NUMBER      20902013
209030                      ' USR:'              SU054-USER-ID          20903013
209040                      ' STA:'              PV-DISP-PNA-STA        20904013
209050                      ' SQL:'              PV-DISP-SQLCODE        20905013
209060                      ' SUT_OTBND_VND - INSERT'                   20906013
209070                                           DELIMITED BY SIZE      20907013
209080                                      INTO PV-CICS-MSG-AREA2      20908013
209090                                                                  20909013
209100              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20910013
209110              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20911013
209120                                                                  20912013
209130              PERFORM 9999-WRITE-TO-CSSL                          20913013
209140                                                                  20914013
209150              INITIALIZE PV-CICS-MSG-AREA3                        20915013
209160                                                                  20916013
209170              MOVE SUT00026-SHIPT-UNT-ID TO PV-DISP-SML           20917013
209180              MOVE SUT00026-PO-NBR       TO PV-DISP-PO            20918013
209190              MOVE SUT00026-PKSL-SEQ-NBR TO PV-DISP-PKSL          20919013
209200                                                                  20920013
209210              STRING 'SUKCS782 '                                  20921099
209220                     ' SML:'           PV-DISP-SML                20922013
209230                     ' PO:'            PV-DISP-PO                 20923013
209240                     ' PKSL:'          PV-DISP-PKSL               20924013
209250                                           DELIMITED BY SIZE      20925013
209260                                      INTO PV-CICS-MSG-AREA3      20926013
209270                                                                  20927013
209280              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20928013
209290              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     20929013
209300                                                                  20930013
209310              PERFORM 9999-WRITE-TO-CSSL                          20931013
209320                                                                  20932013
209330                 SET PS-PROCESSING-ERROR-YES TO TRUE              20933013
209340                 PERFORM 9998-WRITE-TO-CSSL                       20934013
209350         END-EVALUATE.                                            20935013
209360                                                                  20936013
209370                                                                  20937013
209380 7660-DELETE-OTBD-UPC.                                            20938013
209390*                                                                 20939013
209400** added internal table to track paragraph execution time         20940013
209410** dmh 2014-12-22 - begin                                         20941013
209420*                                                                 20942013
209430     MOVE  '7660'  TO  PT-CURR-PARA.                              20943013
209440     IF  PS-BLD-INTERNAL-TABLE-YES                                20944013
209450         PERFORM 0200-INTERNAL-TABLE                              20945013
209460     ELSE                                                         20946013
209470         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       20947013
209480     END-IF.                                                      20948013
209490                                                                  20949013
209500*                                                                 20950013
209510** DMH 2014-12-22 - END                                           20951013
209520*                                                                 20952013
209530                                                                  20953013
209540     EXEC SQL                                                     20954013
209550          DELETE FROM SUT_OTBND_UPC                               20955013
209560           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         20956013
209570     END-EXEC.                                                    20957013
209580                                                                  20958013
209590     EVALUATE TRUE                                                20959013
209600       WHEN SQLCODE = ZEROS                                       20960013
209610       WHEN SQLCODE = +100                                        20961013
209620            CONTINUE                                              20962013
209630       WHEN OTHER                                                 20963013
209640                                                                  20964013
209650              INITIALIZE PV-CICS-MSG-AREA1                        20965013
209660              INITIALIZE PV-CICS-MSG-AREA2                        20966013
209670                                                                  20967013
209680              MOVE SQLCODE              TO PV-DISP-SQLCODE        20968013
209690              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             20969013
209700              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           20970013
209710              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        20971013
209720                                                                  20972013
209730              STRING  'SUKCS782 7660-'                            20973099
209740                      ' DC:'               PV-DISP-DC             20974013
209750                      ' B1:'               SU054-BAR-CODE-1       20975013
209760                      ' B2:'               SU054-BAR-CODE-2       20976013
209770                      ' B3:'               SU054-BAR-CODE-3       20977013
209780                                           DELIMITED BY SIZE      20978013
209790                                      INTO PV-CICS-MSG-AREA1      20979013
209800                                                                  20980013
209810              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20981013
209820              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     20982013
209830                                                                  20983013
209840              PERFORM 9999-WRITE-TO-CSSL                          20984013
209850                                                                  20985013
209860              STRING  'SUKCS782 '          SU054-KOHLS-SML        20986099
209870                      ' TRIP:'             PV-DISP-TRIP           20987013
209880                      ' DR:'               SU054-DOOR-NUMBER      20988013
209890                      ' USR:'              SU054-USER-ID          20989013
209900                      ' STA:'              PV-DISP-PNA-STA        20990013
209910                      ' SQL:'              PV-DISP-SQLCODE        20991013
209920                      ' SUT_OTBND_UPC - DELETE'                   20992013
209930                                           DELIMITED BY SIZE      20993013
209940                                      INTO PV-CICS-MSG-AREA2      20994013
209950                                                                  20995013
209960              MOVE SPACES               TO PV-CICS-MSG-AREA-A     20996013
209970              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     20997013
209980                                                                  20998013
209990              PERFORM 9999-WRITE-TO-CSSL                          20999013
210000                                                                  21000013
210010              INITIALIZE PV-CICS-MSG-AREA3                        21001013
210020                                                                  21002013
210030              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISP-SML           21003013
210040                                                                  21004013
210050              STRING 'SUKCS782 '                                  21005099
210060                     ' SML:'           PV-DISP-SML                21006013
210070                                           DELIMITED BY SIZE      21007013
210080                                      INTO PV-CICS-MSG-AREA3      21008013
210090                                                                  21009013
210100              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21010013
210110              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     21011013
210120                                                                  21012013
210130              PERFORM 9999-WRITE-TO-CSSL                          21013013
210140                                                                  21014013
210150             SET PS-PROCESSING-ERROR-YES TO TRUE                  21015013
210160             PERFORM 9998-WRITE-TO-CSSL                           21016013
210170     END-EVALUATE.                                                21017013
210180                                                                  21018013
210190                                                                  21019013
210200 7665-DELETE-OTBD-VND.                                            21020013
210210*                                                                 21021013
210220** added internal table to track paragraph execution time         21022013
210230** dmh 2014-12-22 - begin                                         21023013
210240*                                                                 21024013
210250     MOVE  '7665'  TO  PT-CURR-PARA.                              21025013
210260     IF  PS-BLD-INTERNAL-TABLE-YES                                21026013
210270         PERFORM 0200-INTERNAL-TABLE                              21027013
210280     ELSE                                                         21028013
210290         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       21029013
210300     END-IF.                                                      21030013
210310                                                                  21031013
210320*                                                                 21032013
210330** DMH 2014-12-22 - END                                           21033013
210340*                                                                 21034013
210350                                                                  21035013
210360     EXEC SQL                                                     21036013
210370          DELETE FROM SUT_OTBND_VND                               21037013
210380           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         21038013
210390     END-EXEC.                                                    21039013
210400                                                                  21040013
210410     EVALUATE TRUE                                                21041013
210420       WHEN SQLCODE = ZEROS                                       21042013
210430       WHEN SQLCODE = +100                                        21043013
210440            CONTINUE                                              21044013
210450       WHEN OTHER                                                 21045013
210460                                                                  21046013
210470              INITIALIZE PV-CICS-MSG-AREA1                        21047013
210480              INITIALIZE PV-CICS-MSG-AREA2                        21048013
210490                                                                  21049013
210500              MOVE SQLCODE              TO PV-DISP-SQLCODE        21050013
210510              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             21051013
210520              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           21052013
210530              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        21053013
210540                                                                  21054013
210550              STRING  'SUKCS782 7665-'                            21055099
210560                      ' DC:'               PV-DISP-DC             21056013
210570                      ' B1:'               SU054-BAR-CODE-1       21057013
210580                      ' B2:'               SU054-BAR-CODE-2       21058013
210590                      ' B3:'               SU054-BAR-CODE-3       21059013
210600                                           DELIMITED BY SIZE      21060013
210610                                      INTO PV-CICS-MSG-AREA1      21061013
210620                                                                  21062013
210630              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21063013
210640              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     21064013
210650                                                                  21065013
210660              PERFORM 9999-WRITE-TO-CSSL                          21066013
210670                                                                  21067013
210680              STRING  'SUKCS782 '          SU054-KOHLS-SML        21068099
210690                      ' TRIP:'             PV-DISP-TRIP           21069013
210700                      ' DR:'               SU054-DOOR-NUMBER      21070013
210710                      ' USR:'              SU054-USER-ID          21071013
210720                      ' STA:'              PV-DISP-PNA-STA        21072013
210730                      ' SQL:'              PV-DISP-SQLCODE        21073013
210740                      ' SUT_OTBND_VND - DELETE'                   21074013
210750                                           DELIMITED BY SIZE      21075013
210760                                      INTO PV-CICS-MSG-AREA2      21076013
210770                                                                  21077013
210780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21078013
210790              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     21079013
210800                                                                  21080013
210810              PERFORM 9999-WRITE-TO-CSSL                          21081013
210820                                                                  21082013
210830              INITIALIZE PV-CICS-MSG-AREA3                        21083013
210840                                                                  21084013
210850              MOVE SUT00024-SHIPT-UNT-ID tO PV-DISP-SML           21085013
210860                                                                  21086013
210870              STRING 'SUKCS782 '                                  21087099
210880                     ' SML:'           PV-DISP-SML                21088013
210890                                           DELIMITED BY SIZE      21089013
210900                                      INTO PV-CICS-MSG-AREA3      21090013
210910                                                                  21091013
210920              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21092013
210930              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     21093013
210940                                                                  21094013
210950              PERFORM 9999-WRITE-TO-CSSL                          21095013
210960                                                                  21096013
210970             SET PS-PROCESSING-ERROR-YES TO TRUE                  21097013
210980             PERFORM 9998-WRITE-TO-CSSL                           21098013
210990     END-EVALUATE.                                                21099013
211000                                                                  21100013
211010                                                                  21101013
211020 7670-UPDATE-OTBD-CART.                                           21102013
211030*                                                                 21103013
211040** added internal table to track paragraph execution time         21104013
211050** dmh 2014-12-22 - begin                                         21105013
211060*                                                                 21106013
211070     MOVE  '7670'  TO  PT-CURR-PARA.                              21107013
211080     IF  PS-BLD-INTERNAL-TABLE-YES                                21108013
211090         PERFORM 0200-INTERNAL-TABLE                              21109013
211100     ELSE                                                         21110013
211110         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       21111013
211120     END-IF.                                                      21112013
211130                                                                  21113013
211140*                                                                 21114013
211150** DMH 2014-12-22 - END                                           21115013
211160*                                                                 21116013
211170                                                                  21117013
211180     EXEC SQL                                                     21118013
211190         UPDATE SUT_OTBND_CART                                    21119013
211200            SET                                                   21120013
211210               ORGN_LOC_NBR     =  :SUT00024-ORGN-LOC-NBR         21121013
211220              ,DEST_LOC_NBR     =  :SUT00024-DEST-LOC-NBR         21122013
211230              ,CART_SRC_CDE     =  :SUT00024-CART-SRC-CDE         21123013
211240              ,CRE_DTE          =   CURRENT DATE                  21124013
211250              ,CRE_TM           =   CURRENT TIME                  21125013
211260              ,CRE_USR_ID       =  :SUT00024-CRE-USR-ID           21126013
211270              ,CRE_PGM_NM       =  :SUT00024-CRE-PGM-NM           21127013
211280              ,MSTR_CART_IND    =  :SUT00024-MSTR-CART-IND        21128013
211290              ,PRNT_CART_ID     =  :SUT00024-PRNT-CART-ID         21129013
211300              ,ORIG_CART_ID     =  :SUT00024-ORIG-CART-ID         21130013
211310              ,CART_TYP_CDE     =  :SUT00024-CART-TYP-CDE         21131013
211320              ,LBL_PRT_SEQ_NBR  =   0                             21132013
211330              ,CART_RVSN_NBR    =   0                             21133013
211340              ,OTBND_TRIP_ID    =   NULL                          21134013
211350              ,ACTV_IND         =  :SUT00024-ACTV-IND             21135013
211360          WHERE                                                   21136013
211370               SHIPT_UNT_ID     =  :SUT00024-SHIPT-UNT-ID         21137013
211380     END-EXEC.                                                    21138013
211390                                                                  21139013
211400         EVALUATE TRUE                                            21140013
211410             WHEN SQLCODE = ZERO                                  21141013
211420                SET PS-DONE TO TRUE                               21142013
211430                                                                  21143013
211440             WHEN SQLWARN0 NOT = SPACES                           21144013
211450             WHEN SQLCODE < ZERO                                  21145013
211460             WHEN SQLCODE > ZERO                                  21146013
211470                                                                  21147013
211480              INITIALIZE PV-CICS-MSG-AREA1                        21148013
211490              INITIALIZE PV-CICS-MSG-AREA2                        21149013
211500                                                                  21150013
211510              MOVE SQLCODE              TO PV-DISP-SQLCODE        21151013
211520              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             21152013
211530              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           21153013
211540              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        21154013
211550                                                                  21155013
211560              STRING  'SUKCS782 7670-'                            21156099
211570                      ' DC:'               PV-DISP-DC             21157013
211580                      ' B1:'               SU054-BAR-CODE-1       21158013
211590                      ' B2:'               SU054-BAR-CODE-2       21159013
211600                      ' B3:'               SU054-BAR-CODE-3       21160013
211610                                           DELIMITED BY SIZE      21161013
211620                                      INTO PV-CICS-MSG-AREA1      21162013
211630                                                                  21163013
211640              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21164013
211650              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     21165013
211660                                                                  21166013
211670              PERFORM 9999-WRITE-TO-CSSL                          21167013
211680                                                                  21168013
211690              STRING  'SUKCS782 '          SU054-KOHLS-SML        21169099
211700                      ' TRIP:'             PV-DISP-TRIP           21170013
211710                      ' DR:'               SU054-DOOR-NUMBER      21171013
211720                      ' USR:'              SU054-USER-ID          21172013
211730                      ' STA:'              PV-DISP-PNA-STA        21173013
211740                      ' SQL:'              PV-DISP-SQLCODE        21174013
211750                      ' SUT_OTBND_CART - UPDATE'                  21175013
211760                                           DELIMITED BY SIZE      21176013
211770                                      INTO PV-CICS-MSG-AREA2      21177013
211780                                                                  21178013
211790              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21179013
211800              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     21180013
211810                                                                  21181013
211820              PERFORM 9999-WRITE-TO-CSSL                          21182013
211830                                                                  21183013
211840              INITIALIZE PV-CICS-MSG-AREA3                        21184013
211850                                                                  21185013
211860              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISP-SML           21186013
211870              MOVE SUT00024-ORGN-LOC-NBR TO PV-DISP-OPER          21187013
211880              MOVE SUT00024-DEST-LOC-NBR TO PV-DISP-DEST-OPER     21188013
211890              MOVE SUT00024-CRE-USR-ID   TO PV-DISP-DEST-OPER     21189013
211900              MOVE SUT00024-CRE-PGM-NM   TO PV-DISP-DEST-OPER     21190013
211910                                                                  21191013
211920              STRING 'SUKCS782 '                                  21192099
211930                     ' SML:'           PV-DISP-SML                21193013
211940                     ' OPER:'          PV-DISP-OPER               21194013
211950                     ' DEST:'          PV-DISP-DEST-OPER          21195013
211960                     ' SRC:'           SUT00024-CART-SRC-CDE      21196013
211970                     ' USR:'           SUT00024-CRE-USR-ID        21197013
211980                     ' PGM:'           SUT00024-CRE-PGM-NM        21198013
211990                                           DELIMITED BY SIZE      21199013
212000                                      INTO PV-CICS-MSG-AREA3      21200013
212010                                                                  21201013
212020              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21202013
212030              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     21203013
212040                                                                  21204013
212050              PERFORM 9999-WRITE-TO-CSSL                          21205013
212060                                                                  21206013
212070              INITIALIZE PV-CICS-MSG-AREA4                        21207013
212080                                                                  21208013
212090              MOVE SUT00024-PRNT-CART-ID TO PV-DISP-PARENT        21209013
212100              MOVE SUT00024-ORIG-CART-ID TO PV-DISP-SSCC          21210013
212110                                                                  21211013
212120              STRING 'SUKCS782 '                                  21212099
212130                     ' PARENT:'        PV-DISP-PARENT             21213013
212140                     ' SSCC:'          PV-DISP-SSCC               21214013
212150                     ' TYPE:'          SUT00024-CART-TYP-CDE      21215013
212160                     ' ACTV:'          SUT00024-ACTV-IND          21216013
212170                                           DELIMITED BY SIZE      21217013
212180                                      INTO PV-CICS-MSG-AREA4      21218013
212190                                                                  21219013
212200              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21220013
212210              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     21221013
212220                                                                  21222013
212230              PERFORM 9999-WRITE-TO-CSSL                          21223013
212240                                                                  21224013
212250                 SET PS-PROCESSING-ERROR-YES TO TRUE              21225013
212260                 PERFORM 9998-WRITE-TO-CSSL                       21226013
212270         END-EVALUATE.                                            21227013
212280                                                                  21228013
212290                                                                  21229013
212300*----------------------------------------------------------------*21230013
212310*                                                                *21231013
212320*                                                                *21232013
212330*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *21233013
212340*----------------------------------------------------------------*21234013
212350 7680-SELECT-PK-SKU-NBR.                                          21235013
212360*                                                                 21236013
212370** added internal table to track paragraph execution time         21237013
212380** dmh 2014-12-22 - begin                                         21238013
212390*                                                                 21239013
212400     MOVE  '7680'  TO  PT-CURR-PARA.                              21240013
212410     IF  PS-BLD-INTERNAL-TABLE-YES                                21241013
212420         PERFORM 0200-INTERNAL-TABLE                              21242013
212430     ELSE                                                         21243013
212440         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       21244013
212450     END-IF.                                                      21245013
212460                                                                  21246013
212470*                                                                 21247013
212480** DMH 2014-12-22 - END                                           21248013
212490*                                                                 21249013
212500                                                                  21250013
212510     EXEC SQL                                                     21251013
212520          SELECT PK_SKU_NBR                                       21252013
212530          INTO  :POPRPK-PK-SKU-NBR                                21253013
212540          FROM   TPOPRPK                                          21254013
212550          WHERE  PO_NBR         = :SUT00028-TRN-NBR               21255013
212560          AND    PO_PREPK_ID    = :LBVRDA-PREPK-ID                21256013
212570          AND    PREPK_STAT_CDE =  'A'                            21257013
212580         WITH UR                                                  21258013
212590     END-EXEC.                                                    21259013
212600                                                                  21260013
212610     EVALUATE TRUE                                                21261013
212620         WHEN SQLCODE = ZERO                                      21262013
212630              CONTINUE                                            21263013
212640         WHEN SQLCODE = +100                                      21264013
212650             CONTINUE                                             21265013
212660         WHEN SQLWARN0 NOT = SPACES                               21266013
212670         WHEN SQLCODE NOT EQUAL ZERO                              21267013
212680                                                                  21268013
212690              INITIALIZE PV-CICS-MSG-AREA1                        21269013
212700              INITIALIZE PV-CICS-MSG-AREA2                        21270013
212710                                                                  21271013
212720              MOVE SQLCODE              TO PV-DISP-SQLCODE        21272013
212730              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             21273013
212740              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           21274013
212750              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        21275013
212760                                                                  21276013
212770              STRING  'SUKCS782 7680-'                            21277099
212780                      ' DC:'               PV-DISP-DC             21278013
212790                      ' B1:'               SU054-BAR-CODE-1       21279013
212800                      ' B2:'               SU054-BAR-CODE-2       21280013
212810                      ' B3:'               SU054-BAR-CODE-3       21281013
212820                                           DELIMITED BY SIZE      21282013
212830                                      INTO PV-CICS-MSG-AREA1      21283013
212840                                                                  21284013
212850              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21285013
212860              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     21286013
212870                                                                  21287013
212880              PERFORM 9999-WRITE-TO-CSSL                          21288013
212890                                                                  21289013
212900              STRING  'SUKCS782 '          SU054-KOHLS-SML        21290099
212910                      ' TRIP:'             PV-DISP-TRIP           21291013
212920                      ' DR:'               SU054-DOOR-NUMBER      21292013
212930                      ' USR:'              SU054-USER-ID          21293013
212940                      ' STA:'              PV-DISP-PNA-STA        21294013
212950                      ' SQL:'              PV-DISP-SQLCODE        21295013
212960                      ' TPOPRPK - SELECT'                         21296013
212970                                           DELIMITED BY SIZE      21297013
212980                                      INTO PV-CICS-MSG-AREA2      21298013
212990                                                                  21299013
213000              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21300013
213010              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     21301013
213020                                                                  21302013
213030              PERFORM 9999-WRITE-TO-CSSL                          21303013
213040                                                                  21304013
213050              INITIALIZE PV-CICS-MSG-AREA3                        21305013
213060                                                                  21306013
213070              MOVE SUT00028-TRN-NBR      TO PV-DISP-PO            21307013
213080              MOVE LBVRDA-PREPK-ID       TO PV-DISP-PREPK         21308013
213090                                                                  21309013
213100              STRING 'SUKCS782 '                                  21310099
213110                     ' PO:'            PV-DISP-PO                 21311013
213120                     ' PREPK:'         PV-DISP-PREPK              21312013
213130                                           DELIMITED BY SIZE      21313013
213140                                      INTO PV-CICS-MSG-AREA3      21314013
213150                                                                  21315013
213160              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21316013
213170              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     21317013
213180                                                                  21318013
213190              PERFORM 9999-WRITE-TO-CSSL                          21319013
213200                                                                  21320013
213210             SET PS-PROCESSING-ERROR-YES TO TRUE                  21321013
213220             PERFORM 9998-WRITE-TO-CSSL                           21322013
213230     END-EVALUATE.                                                21323013
213240                                                                  21324013
213250*----------------------------------------------------------------*21325013
213260 7685-INSERT-OTBND-PACK.                                          21326013
213270*----------------------------------------------------------------*21327013
213280*                                                                 21328013
213290** added internal table to track paragraph execution time         21329013
213300** dmh 2014-12-22 - begin                                         21330013
213310*                                                                 21331013
213320     MOVE  '7685'  TO  PT-CURR-PARA.                              21332013
213330     IF  PS-BLD-INTERNAL-TABLE-YES                                21333013
213340         PERFORM 0200-INTERNAL-TABLE                              21334013
213350     ELSE                                                         21335013
213360         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       21336013
213370     END-IF.                                                      21337013
213380                                                                  21338013
213390*                                                                 21339013
213400** DMH 2014-12-22 - END                                           21340013
213410*                                                                 21341013
213420     MOVE ZEROES                 TO PV-SHPD-PK-QTY.               21342013
213430     MOVE PV-RCVR-SEQ-NBR        TO SUT00041-RCVR-SEQ-NBR.        21343013
213440     COMPUTE PV-SHPD-PK-QTY =                                     21344013
213450                 (LBVRDA-OTPK-UNT-QTY / LBVRDA-PREPK-RATO-QTY )   21345013
213460     MOVE PV-SHPD-PK-QTY TO SUT00041-SHPD-PK-QTY.                 21346013
213470                                                                  21347013
213480     EXEC SQL                                                     21348013
213490         INSERT INTO SUT_OTBND_PK                                 21349013
213500             ( SHIPT_UNT_ID                                       21350013
213510              ,TRN_NBR                                            21351013
213520              ,RCVR_SEQ_NBR                                       21352013
213530              ,TRN_TYP_CDE                                        21353013
213540              ,PK_SKU_NBR                                         21354013
213550              ,SHPD_PK_QTY )                                      21355013
213560        VALUES (:SUT00024-SHIPT-UNT-ID                            21356013
213570               ,:SUT00028-TRN-NBR                                 21357013
213580               ,:SUT00041-RCVR-SEQ-NBR                            21358013
213590               ,'PO'                                              21359013
213600               ,:POPRPK-PK-SKU-NBR                                21360013
213610               ,:SUT00041-SHPD-PK-QTY)                            21361013
213620     END-EXEC                                                     21362013
213630                                                                  21363013
213640     EVALUATE TRUE                                                21364013
213650         WHEN SQLCODE = ZERO                                      21365013
213660         WHEN SQLCODE = +100                                      21366013
213670             CONTINUE                                             21367013
213680         WHEN SQLCODE = -803                                      21368013
213690             PERFORM 7690-DELETE-OTBND-PACK                       21369013
213700         WHEN SQLWARN0 NOT = SPACES                               21370013
213710         WHEN SQLCODE < ZERO                                      21371013
213720         WHEN SQLCODE > ZERO                                      21372013
213730                                                                  21373013
213740              INITIALIZE PV-CICS-MSG-AREA1                        21374013
213750              INITIALIZE PV-CICS-MSG-AREA2                        21375013
213760                                                                  21376013
213770              MOVE SQLCODE              TO PV-DISP-SQLCODE        21377013
213780              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             21378013
213790              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           21379013
213800              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        21380013
213810                                                                  21381013
213820              STRING  'SUKCS782 7680-'                            21382099
213830                      ' DC:'               PV-DISP-DC             21383013
213840                      ' B1:'               SU054-BAR-CODE-1       21384013
213850                      ' B2:'               SU054-BAR-CODE-2       21385013
213860                      ' B3:'               SU054-BAR-CODE-3       21386013
213870                                           DELIMITED BY SIZE      21387013
213880                                      INTO PV-CICS-MSG-AREA1      21388013
213890                                                                  21389013
213900              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21390013
213910              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     21391013
213920                                                                  21392013
213930              PERFORM 9999-WRITE-TO-CSSL                          21393013
213940                                                                  21394013
213950              STRING  'SUKCS782 '          SU054-KOHLS-SML        21395099
213960                      ' TRIP:'             PV-DISP-TRIP           21396013
213970                      ' DR:'               SU054-DOOR-NUMBER      21397013
213980                      ' USR:'              SU054-USER-ID          21398013
213990                      ' STA:'              PV-DISP-PNA-STA        21399013
214000                      ' SQL:'              PV-DISP-SQLCODE        21400013
214010                      ' SUT_OTBND_PK - INSERT'                    21401013
214020                                           DELIMITED BY SIZE      21402013
214030                                      INTO PV-CICS-MSG-AREA2      21403013
214040                                                                  21404013
214050              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21405013
214060              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     21406013
214070                                                                  21407013
214080              PERFORM 9999-WRITE-TO-CSSL                          21408013
214090                                                                  21409013
214100              INITIALIZE PV-CICS-MSG-AREA3                        21410013
214110                                                                  21411013
214120              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISP-SML           21412013
214130              MOVE SUT00028-TRN-NBR      TO PV-DISP-PO            21413013
214140              MOVE SUT00041-RCVR-SEQ-NBR TO PV-DISP-RCVR          21414013
214150              MOVE POPRPK-PK-SKU-NBR     TO PV-DISP-PK-SKU        21415013
214160              MOVE SUT00041-SHPD-PK-QTY  TO PV-DISP-PK-QTY        21416013
214170                                                                  21417013
214180              STRING 'SUKCS782 '                                  21418099
214190                     ' SML:'           PV-DISP-SML                21419013
214200                     ' PO:'            PV-DISP-PO                 21420013
214210                     ' RCVR:'          PV-DISP-RCVR               21421013
214220                     ' PK SKU:'        PV-DISP-PK-SKU             21422013
214230                     ' PK QTY:'        PV-DISP-PK-QTY             21423013
214240                                           DELIMITED BY SIZE      21424013
214250                                      INTO PV-CICS-MSG-AREA3      21425013
214260                                                                  21426013
214270              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21427013
214280              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     21428013
214290                                                                  21429013
214300              PERFORM 9999-WRITE-TO-CSSL                          21430013
214310                                                                  21431013
214320             SET PS-PROCESSING-ERROR-YES TO TRUE                  21432013
214330             PERFORM 9998-WRITE-TO-CSSL                           21433013
214340     END-EVALUATE.                                                21434013
214350                                                                  21435013
214360                                                                  21436013
214370 EJECT                                                            21437013
214380                                                                  21438013
214390 7690-DELETE-OTBND-PACK.                                          21439013
214400*                                                                 21440013
214410** added internal table to track paragraph execution time         21441013
214420** dmh 2014-12-22 - begin                                         21442013
214430*                                                                 21443013
214440     MOVE  '7690'  TO  PT-CURR-PARA.                              21444013
214450     IF  PS-BLD-INTERNAL-TABLE-YES                                21445013
214460         PERFORM 0200-INTERNAL-TABLE                              21446013
214470     ELSE                                                         21447013
214480         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       21448013
214490     END-IF.                                                      21449013
214500                                                                  21450013
214510*                                                                 21451013
214520** DMH 2014-12-22 - END                                           21452013
214530*                                                                 21453013
214540                                                                  21454013
214550                                                                  21455013
214560     EXEC SQL                                                     21456013
214570          DELETE FROM SUT_OTBND_PK                                21457013
214580           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         21458013
214590             AND TRN_NBR         = :SUT00028-TRN-NBR              21459013
214600             AND RCVR_SEQ_NBR    = :SUT00041-RCVR-SEQ-NBR         21460013
214610             AND TRN_TYP_CDE     = 'PO'                           21461013
214620             AND PK_SKU_NBR      = :POPRPK-PK-SKU-NBR             21462013
214630     END-EXEC.                                                    21463013
214640                                                                  21464013
214650     EVALUATE TRUE                                                21465013
214660         WHEN SQLCODE = ZERO                                      21466013
214670         WHEN SQLCODE = +100                                      21467013
214680             CONTINUE                                             21468013
214690         WHEN SQLWARN0 NOT = SPACES                               21469013
214700         WHEN SQLCODE < ZERO                                      21470013
214710         WHEN SQLCODE > ZERO                                      21471013
214720                                                                  21472013
214730              INITIALIZE PV-CICS-MSG-AREA1                        21473013
214740              INITIALIZE PV-CICS-MSG-AREA2                        21474013
214750                                                                  21475013
214760              MOVE SQLCODE              TO PV-DISP-SQLCODE        21476013
214770              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             21477013
214780              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           21478013
214790              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        21479013
214800                                                                  21480013
214810              STRING  'SUKCS782 7690-'                            21481099
214820                      ' DC:'               PV-DISP-DC             21482013
214830                      ' B1:'               SU054-BAR-CODE-1       21483013
214840                      ' B2:'               SU054-BAR-CODE-2       21484013
214850                      ' B3:'               SU054-BAR-CODE-3       21485013
214860                                           DELIMITED BY SIZE      21486013
214870                                      INTO PV-CICS-MSG-AREA1      21487013
214880                                                                  21488013
214890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21489013
214900              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     21490013
214910                                                                  21491013
214920              PERFORM 9999-WRITE-TO-CSSL                          21492013
214930                                                                  21493013
214940              STRING  'SUKCS782 '          SU054-KOHLS-SML        21494099
214950                      ' TRIP:'             PV-DISP-TRIP           21495013
214960                      ' DR:'               SU054-DOOR-NUMBER      21496013
214970                      ' USR:'              SU054-USER-ID          21497013
214980                      ' STA:'              PV-DISP-PNA-STA        21498013
214990                      ' SQL:'              PV-DISP-SQLCODE        21499013
215000                      ' SUT_OTBND_PK - DELETE'                    21500013
215010                                           DELIMITED BY SIZE      21501013
215020                                      INTO PV-CICS-MSG-AREA2      21502013
215030                                                                  21503013
215040              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21504013
215050              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     21505013
215060                                                                  21506013
215070              PERFORM 9999-WRITE-TO-CSSL                          21507013
215080                                                                  21508013
215090              INITIALIZE PV-CICS-MSG-AREA3                        21509013
215100                                                                  21510013
215110              MOVE SUT00024-SHIPT-UNT-ID to pv-DISP-SML           21511013
215120              MOVE SUT00028-TRN-NBR      to pv-DISP-PO            21512013
215130              MOVE SUT00041-RCVR-SEQ-NBR to pv-DISP-RCVR          21513013
215140              MOVE POPRPK-PK-SKU-NBR     to pv-DISP-PK-sku        21514013
215150                                                                  21515013
215160              STRING 'SUKCS782 '                                  21516099
215170                     ' SML:'           PV-DISP-SML                21517013
215180                     ' PO:'            PV-DISP-PO                 21518013
215190                     ' RCVR:'          PV-DISP-RCVR               21519013
215200                     ' PK SKU:'        PV-DISP-PK-SKU             21520013
215210                                           DELIMITED BY SIZE      21521013
215220                                      INTO PV-CICS-MSG-AREA3      21522013
215230                                                                  21523013
215240              MOVE SPACES               TO PV-CICS-MSG-AREA-A     21524013
215250              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     21525013
215260                                                                  21526013
215270              PERFORM 9999-WRITE-TO-CSSL                          21527013
215280                                                                  21528013
215290             SET PS-PROCESSING-ERROR-YES TO TRUE                  21529013
215300             PERFORM 9998-WRITE-TO-CSSL                           21530013
215310     END-EVALUATE.                                                21531013
215320                                                                  21532013
215330 8000-LOAD-LABEL-DATA-SML.                                        21533013
215340*                                                                 21534013
215350** added internal table to track paragraph execution time         21535013
215360** dmh 2014-12-22 - begin                                         21536013
215370*                                                                 21537013
215380     MOVE  '8000'  TO  PT-CURR-PARA.                              21538013
215390     IF  PS-BLD-INTERNAL-TABLE-YES                                21539013
215400         PERFORM 0200-INTERNAL-TABLE                              21540013
215410     ELSE                                                         21541013
215420         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       21542013
215430     END-IF.                                                      21543013
215440                                                                  21544013
215450*                                                                 21545013
215460** DMH 2014-12-22 - END                                           21546013
215470*                                                                 21547013
215480     IF LBPTDA-BRCDE-NBR IS ALPHABETIC                            21548013
215490           SET SU054-KOHLS-MESSAGE-LABEL                          21549013
215500               SU054-GENERIC-MESSAGE-LBL                          21550013
215510               SU054-GENERIC-MESSAGE-LBL-REQ TO TRUE              21551013
215520           PERFORM 8100-LOAD-LABEL-DATA-MSG                       21552013
215530     ELSE                                                         21553013
215540        EVALUATE TRUE                                             21554013
215550          WHEN SU021-AUDIT-REQUIRED                               21555013
215560*CLP 10/29/13 START                                               21556013
215570          WHEN SU021-RFID-AUDIT-REQUIRED                          21557013
215580*CLP 10/29/13   END                                               21558013
215590          WHEN PS-PACK-BY-STORE                                   21559013
215600          WHEN LBVRDA-CART-LBL-TYP-CDE = 'S'                      21560013
215610            SET SU054-KOHLS-SML-LABEL TO TRUE                     21561013
215620* 07/19/13 RLK BEG                                                21562013
215630* IF THE CARTON NEEDS TO BE AUDITED AN SML LABEL IS PRINTED.      21563013
215640* IF THE CARTON IS RFID AND THE DC USES CARTON LABELS INSTEAD OF  21564013
215650* SML LABELS, THE CARTON LABEL WILL BE PRINTED INSTEAD OF SML     21565013
215660* PS-DC-USE-RFID-CART-LBL-YES WILL ONLY BE SET TO TRUE IF RFID    21566013
215670* AND DC SET UP TO USE CARTON LABELS.                             21567013
215680            IF LBPTDA-CART-ACTN-CDE = PC-Q                        21568013
215690              PERFORM 8200-LOAD-LABEL-DATA-SML                    21569013
215700            ELSE                                                  21570013
215710              IF PS-DC-USE-RFID-CART-LBL-YES                      21571013
215720                PERFORM 8250-BUILD-CRTN-LBL-FORM                  21572013
215730              ELSE                                                21573013
215740                PERFORM 8200-LOAD-LABEL-DATA-SML                  21574013
215750              END-IF                                              21575013
215760            END-IF                                                21576013
215770* 07/19/13 RLK END                                                21577013
215780            IF SU021-AUDIT-IS-COMPLETE AND                        21578013
215790*CLP 10/29/13 START                                               21579013
215800               SU021-RFID-AUDIT-IS-COMPLETE                       21580013
215810*CLP 10/29/13 END                                                 21581013
215820               SET SU054-SML-REQ                                  21582013
215830                   SU054-NO-REJECT TO TRUE                        21583013
215840            ELSE                                                  21584013
215850               IF LBPTDA-CART-ACTN-CDE = PC-Q                     21585013
215860                  SET SU054-CARTON-NEEDS-AUDIT                    21586013
215870                      SU054-AUDIT-PENDING-REQ TO TRUE             21587013
215880               ELSE                                               21588013
215890                  SET SU054-PENDING-AUD-RESULTS                   21589013
215900                      SU054-AUDIT-PENDING-REQ   TO TRUE           21590013
215910               END-IF                                             21591013
215920            END-IF                                                21592013
215930          WHEN LBVRDA-CART-LBL-TYP-CDE = 'P'                      21593013
215940            SET SU054-KOHLS-P2L-LABEL TO TRUE                     21594013
215950* 07/19/13 RLK BEG                                                21595013
215960* IF THE CARTON NEEDS TO BE AUDITED A P2L LABEL IS PRINTED.       21596013
215970* IF THE CARTON IS RFID AND THE DC USES CARTON LABELS INSTEAD OF  21597013
215980* P2L LABELS, THE CARTON LABEL WILL BE PRINTED INSTEAD OF P2L     21598013
215990* PS-DC-USE-RFID-CART-LBL-YES WILL ONLY BE SET TO TRUE IF RFID    21599013
216000* AND DC SET UP TO USE CARTON LABELS.                             21600013
216010            IF PS-DC-USE-RFID-CART-LBL-YES                        21601013
216020              PERFORM 8250-BUILD-CRTN-LBL-FORM                    21602013
216030            ELSE                                                  21603013
216040              PERFORM 8300-LOAD-LABEL-DATA-P2L                    21604013
216050            END-IF                                                21605013
216060* 07/19/13 RLK END                                                21606013
216070            SET SU054-P2L-REQ    TO TRUE                          21607013
216080            IF PS-P2L-FORCED-DIVERT-NO                            21608013
216090               SET SU054-NO-REJECT  TO TRUE                       21609013
216100            ELSE                                                  21610013
216110               SET SU054-P2L-FORCED-DIVERT TO TRUE                21611013
216120            END-IF                                                21612013
216130          WHEN PS-ECOMM-DC-REPURPOSE                              21613013
216140            SET SU054-KOHLS-P2L-LABEL TO TRUE                     21614013
216150            PERFORM 8300-LOAD-LABEL-DATA-P2L                      21615013
216160            SET SU054-P2L-REQ    TO TRUE                          21616013
216170            IF SU054-P2L-DC-DIVERT-YES                            21617013
216180               SET SU054-P2L-FORCED-DIVERT                        21618013
216190                   PS-P2L-FORCED-DIVERT-YES TO TRUE               21619013
216200            ELSE                                                  21620013
216210               SET SU054-NO-REJECT                                21621013
216220                   PS-P2L-FORCED-DIVERT-NO TO TRUE                21622013
216230            END-IF                                                21623013
216240          WHEN LBVRDA-CART-LBL-TYP-CDE = 'C'                      21624013
216250          WHEN LBVRDA-CART-LBL-TYP-CDE = 'E'                      21625013
216260            SET SU054-NO-REJECT                                   21626013
216270                SU054-BLND-RCT-LABEL-REQ                          21627013
216280                SU054-KOHLS-BLIND-RCPT TO TRUE                    21628013
216290            PERFORM 8400-LOAD-LABEL-DATA-CS                       21629013
216300          WHEN OTHER                                              21630013
216310            SET SU054-KOHLS-MESSAGE-LABEL TO TRUE                 21631013
216320            PERFORM 8100-LOAD-LABEL-DATA-MSG                      21632013
216330            SET SU054-GENERIC-MESSAGE-LBL                         21633013
216340                SU054-GENERIC-MESSAGE-LBL-REQ  TO TRUE            21634013
216350        END-EVALUATE                                              21635013
216360     END-IF.                                                      21636013
216370                                                                  21637013
216380*CT 11/04/08 BEGIN                                               *21638013
216390     IF PS-SET-NEW-FRCED-DIVERT-YES                               21639013
216400**gb begin -12/23/09   with dual feed the divert should always be 21640013
216410**controlled by what is on the  SUT_PNA_STA_DIVERT with the       21641013
216420* exception of p2l-forced-divert                                  21642013
216430*        IF PS-DONT-PRINT-AUDIT-LABEL AND                         21643013
216440*           PS-AUDIT-CARTON-FOUND-YES AND                         21644013
216450*           NOT SU021-AUDIT-IS-COMPLETE                           21645013
216460*             MOVE +1      TO SU054-FRCD-DIVERT-IND               21646013
216470*        ELSE                                                     21647013
216480            IF PS-P2L-FORCED-DIVERT-YES                           21648013
216490              PERFORM 5071-GET-DC-PADCLS                          21649013
216500*clp 06/20/17    BRC is actually 'AUP' after it passed audit      21650016
216510              IF KRPRPM-FUNC-TXT = 'Y'                            21651013
216520                 AND (SUT00015-AUD-STAT-CDE = ' ' OR              21652013
216530                      SUT00015-AUD-STAT-CDE = 'P' OR              21653013
216540                      SU090-DIRV-RSN-CDE = 'BRC')                 21654018
216550*                IT WAS FOUND ON TABLE FOR OVERRIDE (BLUE SPR)    21655013
216560*                                                                 21656013
216570                    MOVE KRPRPM-FUNC-QTY  TO PV-FUNC-QTY          21657013
216580                    MOVE PV-FUNC-QTYx     TO SU054-FRCD-DIVERT-IND21658013
216590              ELSE                                                21659013
216600                    MOVE SUT00108-FRC-DIVERT-CDE TO               21660013
216610                         SU054-FRCD-DIVERT-IND                    21661013
216620              END-IF                                              21662013
216630            ELSE                                                  21663013
216640                MOVE SUT00108-FRC-DIVERT-CDE TO                   21664016
216650                                           SU054-FRCD-DIVERT-IND  21665016
216660            END-IF                                                21666013
216670                                                                  21667013
216680*        END-IF                                                   21668013
216690     ELSE                                                         21669013
216700******************************************************************21670013
216710*CLP 03-13-2017                                                   21671013
216720* IF ITS A p2L FORCED DIVERT CHECK IF DC ON TABLE                 21672013
216730* BLUE SPRINGS IS SET UP FOR DIVERT OF 2 - ONLY AFTER AUDITS PASS 21673013
216740* ALL OTHER DC'S ITS 0                                            21674013
216750******************************************************************21675013
216760         IF PS-PRINT-AUDIT-LABEL      OR                          21676013
216770            SU054-KOHLS-MESSAGE-LABEL OR                          21677013
216780            PS-P2L-FORCED-DIVERT-YES  OR                          21678013
216790            NOT SU021-AUDIT-IS-COMPLETE OR                        21679013
216800*CLP 10/29/13 START                                               21680013
216810            NOT SU021-RFID-AUDIT-IS-COMPLETE                      21681013
216820*CLP 10/29/13 END                                                 21682013
216830            MOVE +1                TO SU054-FRCD-DIVERT-IND       21683013
216840            IF SU021-AUDIT-IS-COMPLETE AND                        21684013
216850               SU021-RFID-AUDIT-IS-COMPLETE                       21685013
216860               IF PS-P2L-FORCED-DIVERT-YES                        21686013
216870                    PERFORM 5070-GET-DC-PADCLS                    21687013
216880                    MOVE KRPRPM-FUNC-QTY  TO PV-FUNC-QTY          21688013
216890                    MOVE PV-FUNC-QTYx     TO SU054-FRCD-DIVERT-IND21689013
216900               END-if                                             21690013
216910            END-IF                                                21691013
216920         ELSE                                                     21692013
216930            MOVE +0                TO SU054-FRCD-DIVERT-IND       21693013
216940*           did this on no audit for 875                          21694016
216950         END-IF                                                   21695013
216960*CT 11/04/08 END                                                 *21696013
216970     END-IF                                                       21697013
216980                                                                  21698013
216990     MOVE LBPTDA-BRCDE-NBR          TO SU054-KOHLS-SML.           21699013
217000                                                                  21700013
217010 8100-LOAD-LABEL-DATA-MSG.                                        21701013
217020*                                                                 21702013
217030** added internal table to track paragraph execution time         21703013
217040** dmh 2014-12-22 - begin                                         21704013
217050*                                                                 21705013
217060     MOVE  '8100'  TO  PT-CURR-PARA.                              21706013
217070     IF  PS-BLD-INTERNAL-TABLE-YES                                21707013
217080         PERFORM 0200-INTERNAL-TABLE                              21708013
217090     ELSE                                                         21709013
217100         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       21710013
217110     END-IF.                                                      21711013
217120                                                                  21712013
217130*                                                                 21713013
217140** DMH 2014-12-22 - END                                           21714013
217150*                                                                 21715013
217160                                                                  21716013
217170*CRTN                                                             21717013
217180         MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM    21718013
217190         MOVE PV-SHIPT-UNT-14-18       TO  PC248-CARTON-ID        21719013
217200*BRCDE DATA                                                       21720013
217210     MOVE LBPTDA-BRCDE-NBR              TO PC248-IINFO-MSG        21721013
217220*PREPACK ORDERS                                                   21722013
217230     IF  LBPTDA-PREPK-ID > 0                                      21723013
217240         MOVE 'PACK ID:'                TO PC248-LNE-PCK-HDG      21724013
217250         MOVE 'UNITS IN PACK:'          TO PC248-PCK-UNTS-HDG     21725013
217260         MOVE 'PCKS IN OUTR PK:'        TO PC248-PKINOT-UNTS-HDG  21726013
217270         MOVE '0000'                    TO PC248-PCK-UNTS         21727013
217280     ELSE                                                         21728013
217290         MOVE 'LINE NO:'                TO PC248-LNE-PCK-HDG      21729013
217300         MOVE '@@@@@@@@@@@@@@'          TO PC248-PCK-UNTS-HDG     21730013
217310         MOVE '@@@@@@@@@@@@@@@@'        TO PC248-PKINOT-UNTS-HDG  21731013
217320         MOVE '@@@@'                    TO PC248-PCK-UNTS         21732013
217330     END-IF                                                       21733013
217340     IF LBPTDA-PREPK-ID > 0                                       21734013
217350        MOVE LBPTDA-PREPK-ID       TO PC248-PO-LNE-NBR            21735013
217360        MOVE LBPTDA-PREPK-UNT-QTY  TO PV-PREPK-QTY                21736013
217370        MOVE PV-PREPK-UNIT-QTY     TO PC248-PCK-UNTS              21737013
217380        MOVE LBPTDA-OTPK-UNT-QTY   TO PC248-OUTPK-UNTS            21738013
217390*GB 7/26/05 BEGIN                                                 21739013
217400        IF (LBPTDA-PREPK-UNT-QTY > 0 AND                          21740013
217410            LBPTDA-OTPK-UNT-QTY  > 0 )                            21741013
217420           DIVIDE LBPTDA-OTPK-UNT-QTY BY                          21742013
217430                         LBPTDA-PREPK-UNT-QTY                     21743013
217440                         GIVING   PV-PACKS-IN-CARTON              21744013
217450        ELSE                                                      21745013
217460           MOVE 0     TO PV-PACKS-IN-CARTON                       21746013
217470        END-IF                                                    21747013
217480*GB 7/26/05 END                                                   21748013
217490                                                                  21749013
217500        MOVE PV-PACKS-IN-CARTON-X                                 21750013
217510                                TO PC248-PKINOUT-UNTS             21751013
217520     ELSE                                                         21752013
217530        MOVE LBPTDA-PO-LNE-NBR     TO PC248-PO-LNE-NBR            21753013
217540        MOVE '@@@@'                TO PC248-PCK-UNTS              21754013
217550                                      PC248-PKINOUT-UNTS          21755013
217560        MOVE LBPTDA-OTPK-UNT-QTY   TO PC248-OUTPK-UNTS            21756013
217570     END-IF.                                                      21757013
217580                                                                  21758013
217590*PO/RCVR                                                          21759013
217600         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           21760013
217610         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         21761013
217620         MOVE PV-PO-RCVR               TO  PC248-PO-RCVR-NBR      21762013
217630         MOVE PC248-FORM-OTPK-HDG      TO PC248-OUTPK-UNTS-HDG    21763013
217640         MOVE PC248-FORM-NO-INPK-BOX   TO PC248-INPK-CONVY-BOX    21764013
217650                                                                  21765013
217660*REPRINT                                                          21766013
217670     IF  LBPTDA-RPRT-IND  =  PC-Y                                 21767013
217680         MOVE PC248-FORM-REPRT-BOX      TO  PC248-REPRINT-BOX     21768013
217690         MOVE PC248-FORM-REPRT-FLD      TO  PC248-REPRINT-TEXT    21769013
217700     ELSE                                                         21770013
217710         MOVE PC248-FORM-NO-RPRT-BOX    TO  PC248-REPRINT-BOX     21771013
217720         MOVE PC248-FORM-NO-RPRT-FLD    TO  PC248-REPRINT-TEXT    21772013
217730     END-IF.                                                      21773013
217740***                                                               21774013
217750*SKU                                                              21775013
217760         IF LBPTDA-SKU-NBR > ZERO                                 21776013
217770             MOVE XL001-DEPT-NBR-3CH  TO PV-SML-DEPT1             21777013
217780             MOVE XL001-SUB-CL-NBR-2CH TO PV-SML-CLASS-NBR1       21778013
217790             MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU              21779013
217800             MOVE PV-SML-SKU-NUMBER    TO PC248-SKU-NBR           21780013
217810         ELSE                                                     21781013
217820             MOVE SPACES               TO PC248-SKU-NBR           21782013
217830         END-IF                                                   21783013
217840***                                                               21784013
217850*STYLE                                                            21785013
217860         MOVE PV-VEND-STYL-NAME        TO PC248-STYLE             21786013
217870***                                                               21787013
217880     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DSPLY-DC.              21788013
217890     MOVE '-'                       TO  PV-DSPLY-DASH.            21789013
217900     MOVE LBPTDA-PRTR-ID            TO  PV-DSPLY-PRTR-ID.         21790013
217910     MOVE PV-DSPLY-PRTR             TO  PC248-SML-PRTR-NBR.       21791013
217920*                                                                 21792013
217930                                                                  21793013
217940* 04/08/14 - CLP START - POPULATE DATE                            21794013
217950     PERFORM 7405-GET-CURRENT-DATE                                21795013
217960     MOVE PV-CURRENT-YY             TO  PV-LBL-DATE-YY.           21796013
217970     MOVE PV-CURRENT-MM             TO  PV-LBL-DATE-MM.           21797013
217980     MOVE PV-CURRENT-DD             TO  PV-LBL-DATE-DD.           21798013
217990     MOVE '-'                       TO  PV-LBL-DASH1              21799013
218000                                        PV-LBL-DASH2              21800013
218010     MOVE PV-LBL-DATE               TO  PC248-LBL-PRT-DATE.       21801013
218020* 04/08/14 - CLP END                                              21802013
218030*                                                                 21803013
218040     MOVE PV-CURRENT-TIME-LBL       TO  PC248-LBL-PRT-TIME.       21804013
218050     IF PS-LOG-MESSAGE                                            21805013
218060        MOVE SPACE TO PV-CICS-MSG-AREA-A                          21806013
218070        STRING 'SUKCS782  MSG-LBL '                               21807099
218080                PC248-LBL-PRT-DATE                                21808013
218090             ' TIME= '                                            21809013
218100               PC248-LBL-PRT-TIME                                 21810013
218110             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B            21811013
218120             PERFORM 9999-WRITE-TO-CSSL                           21812013
218130     END-IF                                                       21813013
218140*    MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           21814013
218150*    MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           21815013
218160*    MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           21816013
218170*    MOVE '-'                       TO  PV-LBL-DASH1              21817013
218180*                                       PV-LBL-DASH2.             21818013
218190*    MOVE PV-LBL-DATE               TO  PC248-LBL-PRT-DATE.       21819013
218200*                                                                 21820013
218210*    MOVE PV-CURRENT-TIME-LBL       TO  PC248-LBL-PRT-TIME.       21821013
218220*                                                                 21822013
218230     MOVE 'CI'                      TO  PC248-FROM-APPLICATION.   21823013
218240     MOVE 'PRTAP'                   TO  PC248-PRTR-ATTACHED       21824013
218250     MOVE '-SML-'                   TO  PC248-LBL-DESC.           21825013
218260     MOVE PC248-LABEL-INFO-WORK     TO  PC248-LABEL-INFO.         21826013
218270*                                                                 21827013
218280*    IF  LBPTDA-DEPT-DESC > SPACES                                21828013
218290*        MOVE LBPTDA-DEPT-DESC      TO  PC248-DEPT-NAME           21829013
218300*    ELSE                                                         21830013
218310*        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                         21831013
218320*                                   TO  PC248-DEPT-NAME           21832013
218330*    END-IF.                                                      21833013
218340*                                                                 21834013
218350*    IF  LBPTDA-MAJ-CL-DESC > SPACES                              21835013
218360*        MOVE LBPTDA-MAJ-CL-DESC    TO  PC248-MAJOR-CLASS         21836013
218370*    ELSE                                                         21837013
218380*        MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                         21838013
218390*                                   TO  PC248-MAJOR-CLASS         21839013
218400*    END-IF.                                                      21840013
218410                                                                  21841013
218420*    STRING LBPTDA-DEPT-DESC       DELIMITED BY '  '              21842013
218430*            '/'                   DELIMITED BY SIZE              21843013
218440*            LBPTDA-MAJ-CL-DESC    DELIMITED BY '   '             21844013
218450*                           INTO PC248-DEPT-CLASS-NAME            21845013
218460*CLP 08/25/2015 START                                             21846013
218470     MOVE LBPTDA-LBL-MSG-TXT-TEXT   TO PC248-DEPT-CLASS-NAME.     21847013
218480*CLP 08/25/2015 END                                               21848013
218490                                                                  21849013
218500     IF  LBPTDA-FIXT-ID  >  SPACES                                21850013
218510         MOVE LBPTDA-FIXT-ID        TO  PC248-FIXTURE             21851013
218520     ELSE                                                         21852013
218530         MOVE '@@@@@@@@@@'          TO  PC248-FIXTURE             21853013
218540     END-IF.                                                      21854013
218550     IF  LBPTDA-SEASET-NM  >  SPACES                              21855013
218560         MOVE LBPTDA-SEASET-NM            TO  PC248-SET           21856013
218570     ELSE                                                         21857013
218580         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO  PC248-SET           21858013
218590     END-IF.                                                      21859013
218600     IF  LBPTDA-TRIP-ID    >  ZERO                                21860013
218610* dmh - 11-14-11 begin                                            21861013
218620***      MOVE LBPTDA-TRIP-ID   TO  PC248-TRIP-ID                  21862013
218630         MOVE LBPTDA-TRIP-ID     TO  PV-TRIP-ID-10-NUM            21863013
218640         MOVE PV-TRIP-ID-10-NUM  TO  PC248-TRIP-ID                21864013
218650* dmh - 11-14-11 end                                              21865013
218660     ELSE                                                         21866013
218670         MOVE '@@@@@@@@@'      TO  PC248-TRIP-ID                  21867013
218680     END-IF.                                                      21868013
218690     MOVE SU054-USER-ID             TO  PC248-USER-ID.            21869013
218700                                                                  21870013
218710     EVALUATE TRUE                                                21871013
218720       WHEN PS-BRCDE-ERROR-FND                                    21872013
218730         MOVE PC-MULT-BRCDES-FND-MSG                              21873013
218740                                   TO PC248-ERROR-MSG-1           21874013
218750         IF PS-KOHLS-SML-BRCD3-FOUND                              21875013
218760            MOVE PC-MULT-SML-P2L-MSG                              21876013
218770                                   TO PC248-ERROR-MSG-2           21877013
218780         ELSE                                                     21878013
218790            MOVE PC-MULT-SML-ERR-MSG                              21879013
218800                                   TO PC248-ERROR-MSG-2           21880013
218810         END-IF                                                   21881013
218820         SET PS-YES-MSG-1                                         21882013
218830             PS-YES-MSG-2  TO TRUE                                21883013
218840       WHEN PS-INPK-CNVYB-FOUND-YES                               21884013
218850         MOVE PC-INPK-CNVYB-MSG                                   21885013
218860                                   TO PC248-ERROR-MSG-1           21886013
218870         MOVE PC-MULT-LABELS-MSG                                  21887013
218880                                   TO PC248-ERROR-MSG-2           21888013
218890         SET PS-YES-MSG-1                                         21889013
218900             PS-YES-MSG-2  TO TRUE                                21890013
218910       WHEN PS-NO-VALID-BRCDES-FND                                21891013
218920            if  PS-SML-UCC128-MISMATCH                            21892013
218930                MOVE  PV-CTN-N         TO PC-BARCODE-1-ERROR      21893013
218940                MOVE  DK-SML-BARCODE   TO PC-BARCODE-2-ERROR      21894013
218950                MOVE PC-BARCODE-1-ERROR-MSG                       21895013
218960                                   TO PC248-ERROR-MSG-1           21896013
218970                MOVE PC-BARCODE-2-ERROR-MSG                       21897013
218980                                   TO PC248-ERROR-MSG-2           21898013
218990                SET PS-YES-MSG-1                                  21899013
219000                    PS-YES-MSG-2  TO TRUE                         21900013
219010            ELSE                                                  21901013
219020                MOVE PC-VALID-BRCDE-MESSAGE                       21902013
219030                                   TO PC248-ERROR-MSG-1           21903013
219040                MOVE PC-DEFAULT-LABEL-MSG                         21904013
219050                                   TO PC248-ERROR-MSG-2           21905013
219060                SET PS-YES-MSG-1                                  21906013
219070                    PS-YES-MSG-2  TO TRUE                         21907013
219080            END-IF                                                21908013
219090                                                                  21909013
219100*** DMH 9-22-11 BEGIN                                             21910013
219110       WHEN PS-SML-UCC128-MISMATCH                                21911013
219120         MOVE  PV-CTN-N            TO PC-BARCODE-1-ERROR          21912013
219130         MOVE  DK-SML-BARCODE      TO PC-BARCODE-2-ERROR          21913013
219140         MOVE PC-BARCODE-1-ERROR-MSG                              21914013
219150                                   TO PC248-ERROR-MSG-1           21915013
219160         MOVE PC-BARCODE-2-ERROR-MSG                              21916013
219170                                   TO PC248-ERROR-MSG-2           21917013
219180         SET PS-YES-MSG-1                                         21918013
219190             PS-YES-MSG-2  TO TRUE                                21919013
219200*                                                                 21920013
219210       WHEN PS-MULT-SSCC-YES                                      21921013
219220         MOVE  SU054-BAR-CODE-1    TO PC-BARCODE-1-ERROR          21922013
219230         MOVE  SU054-BAR-CODE-2    TO PC-BARCODE-2-ERROR          21923013
219240         MOVE PC-BARCODE-1-ERROR-MSG                              21924013
219250                                   TO PC248-ERROR-MSG-1           21925013
219260         MOVE PC-BARCODE-2-ERROR-MSG                              21926013
219270                                   TO PC248-ERROR-MSG-2           21927013
219280         SET PS-YES-MSG-1                                         21928013
219290             PS-YES-MSG-2  TO TRUE                                21929013
219300*** DMH 9-22-11 END                                               21930013
219310*                                                                 21931013
219320       WHEN PS-RECITM-VERIFIED-LINES-YES                          21932013
219330         MOVE PC-VRFD-LINE-EXIST-MSG                              21933013
219340                                   TO PC248-ERROR-MSG-1           21934013
219350         MOVE PC-DEFAULT-LABEL-MSG                                21935013
219360                                   TO PC248-ERROR-MSG-2           21936013
219370         SET PS-YES-MSG-1                                         21937013
219380             PS-YES-MSG-2  TO TRUE                                21938013
219390       WHEN LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                       21939013
219400         MOVE PC-NOT-FOUND-MSG                                    21940013
219410                                   TO PC248-ERROR-MSG-1           21941013
219420         MOVE PC-DETAIL-CK-NEED-MSG                               21942013
219430                                   TO PC248-ERROR-MSG-2           21943013
219440         SET PS-YES-MSG-1                                         21944013
219450             PS-YES-MSG-2  TO TRUE                                21945013
219460       WHEN LBPTDA-SU-MSSG-DAT-IND  =  PC-K                       21946013
219470         IF LBPTDA-SU-FRE-ASTRA-IND  = PC-R OR PC-T               21947013
219480            MOVE PC-INACT-PKSK-CRE-NEW-RCVR                       21948013
219490                                   TO PC248-ERROR-MSG-1           21949013
219500         ELSE                                                     21950013
219510            MOVE PC-PKSLIP-CARTON-UNEQUAL                         21951013
219520                                   TO PC248-ERROR-MSG-1           21952013
219530         END-IF                                                   21953013
219540         MOVE PC-DETAIL-CK-NEED-MSG                               21954013
219550                                   TO PC248-ERROR-MSG-2           21955013
219560         SET PS-YES-MSG-1                                         21956013
219570             PS-YES-MSG-2  TO TRUE                                21957013
219580       WHEN LBPTDA-SU-DUP-LBL-IND  =  PC-Y                        21958013
219590         MOVE PC-DUPLICATE-SCAN-MSG                               21959013
219600                                   TO PC248-ERROR-MSG-1           21960013
219610         MOVE PC-DETAIL-CK-NEED-MSG                               21961013
219620                                   TO PC248-ERROR-MSG-2           21962013
219630         SET PS-YES-MSG-1                                         21963013
219640             PS-YES-MSG-2  TO TRUE                                21964013
219650       WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                      21965013
219660         MOVE PC-FREE-ASTRY-NO-RCVR-MSG                           21966013
219670                                   TO PC248-ERROR-MSG-1           21967013
219680         MOVE PC-DEFAULT-LABEL-MSG                                21968013
219690                                   TO PC248-ERROR-MSG-2           21969013
219700         SET PS-YES-MSG-1                                         21970013
219710             PS-YES-MSG-2      TO TRUE                            21971013
219720       WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                      21972013
219730         MOVE PC-FREE-ASTRY-NO-TRIP-MSG                           21973013
219740                                   TO PC248-ERROR-MSG-1           21974013
219750         MOVE PC-DEFAULT-LABEL-MSG                                21975013
219760                                   TO PC248-ERROR-MSG-2           21976013
219770         SET PS-YES-MSG-1                                         21977013
219780             PS-YES-MSG-2      TO TRUE                            21978013
219790       WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-A                      21979013
219800         MOVE PC-HOLD-CRTN-TRIP-END                               21980013
219810                                   TO PC248-ERROR-MSG-1           21981013
219820         MOVE PC-FREE-ASTY-NEED-TRANS                             21982013
219830                                   TO PC248-ERROR-MSG-2           21983013
219840         SET PS-YES-MSG-1                                         21984013
219850             PS-YES-MSG-2      TO TRUE                            21985013
219860       WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-C                      21986013
219870         MOVE PC-TRANSC-CHECK-IN-RCVR                             21987013
219880                                   TO PC248-ERROR-MSG-1           21988013
219890         MOVE PC-FREE-ASTY-NEED-TRANS                             21989013
219900                                   TO PC248-ERROR-MSG-2           21990013
219910         SET PS-YES-MSG-1                                         21991013
219920             PS-YES-MSG-2      TO TRUE                            21992013
219930       WHEN LBPTDA-SU-FRE-ASTRA-IND  =  PC-D                      21993013
219940         MOVE PC-UNUSABLE-128-NO-PKSLIP                           21994013
219950                                   TO PC248-ERROR-MSG-1           21995013
219960         MOVE PC-DEFAULT-LABEL-MSG                                21996013
219970                                   TO PC248-ERROR-MSG-2           21997013
219980         SET PS-YES-MSG-1                                         21998013
219990             PS-YES-MSG-2      TO TRUE                            21999013
220000       WHEN PS-DUPLICATE-CARTON                                   22000013
220010         MOVE PC-DUP-VNDR-BRCDE-MSG                               22001013
220020                                   TO PC248-ERROR-MSG-1           22002013
220030                                                                  22003013
220040         MOVE PV-FMT-DUPLICATE-CRTN-MSG TO                        22004013
220050              PC-DUPLICATE-TRIP-DISPLAY                           22005013
220060         MOVE PC-DUPLICATE-TRIP-DISPLAY                           22006013
220070                                   TO PC248-ERROR-MSG-2           22007013
220080         SET PS-YES-MSG-1                                         22008013
220090             PS-YES-MSG-2      TO TRUE                            22009013
220100     END-EVALUATE                                                 22010013
220110                                                                  22011013
220120     IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                         22012013
220130         IF PS-NO-MSG-1                                           22013013
220140             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       22014013
220150                                   TO PC248-ERROR-MSG-1           22015013
220160             SET PS-YES-MSG-1  TO TRUE                            22016013
220170         ELSE                                                     22017013
220180         IF PS-NO-MSG-2                                           22018013
220190             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       22019013
220200                                   TO PC248-ERROR-MSG-1           22020013
220210             SET PS-YES-MSG-2  TO TRUE                            22021013
220220         END-IF                                                   22022013
220230         END-IF                                                   22023013
220240     END-IF                                                       22024013
220250                                                                  22025013
220260     IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                            22026013
220270         IF PS-NO-MSG-1                                           22027013
220280             MOVE PC-MISDIRECT-MSG                                22028013
220290                                   TO PC248-ERROR-MSG-1           22029013
220300             SET PS-YES-MSG-1  TO TRUE                            22030013
220310         ELSE                                                     22031013
220320         IF PS-NO-MSG-2                                           22032013
220330             MOVE PC-MISDIRECT-MSG                                22033013
220340                                   TO PC248-ERROR-MSG-1           22034013
220350             SET PS-YES-MSG-2  TO TRUE                            22035013
220360         END-IF                                                   22036013
220370         END-IF                                                   22037013
220380     END-IF                                                       22038013
220390     EVALUATE TRUE                                                22039013
220400       WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-G                      22040013
220410       WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-L                      22041013
220420         MOVE PC-CASEPK-NOT-DNLD-RECVR                            22042013
220430                                   TO PC248-ERROR-MSG-2           22043013
220440         SET PS-YES-MSG-2  TO TRUE                                22044013
220450       WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-I                      22045013
220460       WHEN  LBPTDA-SU-MSSG-DAT-IND  =  PC-N                      22046013
220470           MOVE PC-CASEPK-DNLD-PHYSCL                             22047013
220480                                     TO PC248-ERROR-MSG-2         22048013
220490           SET PS-YES-MSG-2  TO TRUE                              22049013
220500     END-EVALUATE                                                 22050013
220510                                                                  22051013
220520     IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-K                          22052013
220530         SET  PC248-STR-LNE-1-YES                                 22053013
220540              PC248-STR-LNE-2-YES                                 22054013
220550              PC248-STR-LNE-3-YES       TO  TRUE                  22055013
220560         MOVE PC248-FORM-PRT-STORE      TO  PC248-STORE-NBR       22056013
220570     ELSE                                                         22057013
220580         SET  PC248-STR-LNE-1-NO                                  22058013
220590              PC248-STR-LNE-2-NO                                  22059013
220600              PC248-STR-LNE-3-NO        TO  TRUE                  22060013
220610         MOVE PC248-FORM-NO-STORE       TO  PC248-STORE-NBR       22061013
220620     END-IF.                                                      22062013
220630*    MOVE +1                            TO PC248-SML-LBL-QTY.     22063013
220640     MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                               22064013
220650                                   TO PC248-LABEL-NBR.            22065013
220660     MOVE PC-OF                    TO PC248-LABEL-OF.             22066013
220670     MOVE LBPTDA-LBL-TYP-TOT-QTY   TO PC248-TOT-LABEL.            22067013
220680                                                                  22068013
220690     MOVE PC248-SML-BATCH-LBL       TO                            22069013
220700                                        SU054-LABEL-DATA-FORMAT.  22070013
220710                                                                  22071013
220720 8200-LOAD-LABEL-DATA-SML.                                        22072013
220730*                                                                 22073013
220740** added internal table to track paragraph execution time         22074013
220750** dmh 2014-12-22 - begin                                         22075013
220760*                                                                 22076013
220770     MOVE  '8200'  TO  PT-CURR-PARA.                              22077013
220780     IF  PS-BLD-INTERNAL-TABLE-YES                                22078013
220790         PERFORM 0200-INTERNAL-TABLE                              22079013
220800     ELSE                                                         22080013
220810         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       22081013
220820     END-IF.                                                      22082013
220830                                                                  22083013
220840*                                                                 22084013
220850** DMH 2014-12-22 - END                                           22085013
220860*                                                                 22086013
220870         SET PC257-CRTN-HDG             TO  TRUE.                 22087013
220880                                                                  22088013
220890*CRTN                                                             22089013
220900         MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM    22090013
220910         MOVE PV-SHIPT-UNT-14-18       TO  PC257-CARTON-ID        22091013
220920*PO/RCVR                                                          22092013
220930         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           22093013
220940         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         22094013
220950         MOVE PV-PO-RCVR               TO  PC257-PO-RCVR-NBR      22095013
220960*PREPACK ORDERS                                                   22096013
220970     IF  LBPTDA-PREPK-ID > 0                                      22097013
220980         SET  PC257-PACK-HDG           TO TRUE                    22098013
220990         MOVE LBPTDA-PREPK-ID       TO PC257-PO-LNE-NBR           22099013
221000     ELSE                                                         22100013
221010         SET  PC257-LINE-HDG           TO TRUE                    22101013
221020         MOVE LBPTDA-PO-LNE-NBR     TO PC257-PO-LNE-NBR           22102013
221030     END-IF                                                       22103013
221040                                                                  22104013
221050                                                                  22105013
221060*SKU                                                              22106013
221070         IF LBPTDA-SKU-NBR > ZERO                                 22107013
221080                                                                  22108013
221090             MOVE XL001-DEPT-NBR-3CH  TO PV-SML-DEPT1             22109013
221100             MOVE XL001-SUB-CL-NBR-2CH TO PV-SML-CLASS-NBR1       22110013
221110             MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU              22111013
221120             MOVE PV-SML-SKU-NUMBER    TO PC257-SKU-NBR           22112013
221130         ELSE                                                     22113013
221140             MOVE SPACES               TO PC257-SKU-NBR           22114013
221150         END-IF                                                   22115013
221160*STYLE                                                            22116013
221170         MOVE PV-VEND-STYL-NAME        TO PC257-STYLE             22117013
221180*OUTER PK UNTS                                                    22118013
221190         IF  LBPTDA-RPRT-IND  =  PC-Y                             22119013
221200             MOVE LBPTDA-OTPK-UNT-QTY                             22120013
221210                                       TO PV-OTPK-QTY             22121013
221220            SET  PC257-FORM-REPRT-BOX                             22122013
221230                 PC257-FORM-REPRT-FLD      TO TRUE                22123013
221240         ELSE                                                     22124013
221250            SET  PC257-FORM-NO-RPRT-BOX                           22125013
221260                 PC257-FORM-NO-RPRT-FLD    TO TRUE                22126013
221270         END-IF                                                   22127013
221280         SET  PC257-FORM-NO-INPK-BOX                              22128013
221290              PC257-FORM-NO-UNT-HDG        TO TRUE                22129013
221300                                                                  22130013
221310         SET  PS-NO-MSG-1                                         22131013
221320              PS-NO-MSG-2              TO TRUE                    22132013
221330         MOVE PC-DEFAULT-LABEL-MSG     TO PC257-ERROR-MSG-1       22133013
221340                                                                  22134013
221350         IF  LBPTDA-SU-MSSG-DAT-IND  =  PC-Y                      22135013
221360             MOVE PC-NOT-FOUND-MSG                                22136013
221370                                       TO PC257-ERROR-MSG-1       22137013
221380             SET PS-YES-MSG-1                                     22138013
221390                 PS-YES-MSG-2  TO TRUE                            22139013
221400         ELSE                                                     22140013
221410         IF  LBPTDA-SU-DUP-LBL-IND  =  PC-Y                       22141013
221420             MOVE PC-DUPLICATE-SCAN-MSG                           22142013
221430                                       TO PC257-ERROR-MSG-1       22143013
221440             SET PS-YES-MSG-1                                     22144013
221450                 PS-YES-MSG-2  TO TRUE                            22145013
221460         ELSE                                                     22146013
221470         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-R                     22147013
221480             MOVE PC-FREE-ASTRY-NO-RCVR-MSG                       22148013
221490                                       TO PC257-ERROR-MSG-1       22149013
221500             SET PS-YES-MSG-1                                     22150013
221510                 PS-YES-MSG-2      TO TRUE                        22151013
221520         ELSE                                                     22152013
221530         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-T                     22153013
221540             MOVE PC-FREE-ASTRY-NO-TRIP-MSG                       22154013
221550                                       TO PC257-ERROR-MSG-1       22155013
221560             SET PS-YES-MSG-1                                     22156013
221570                 PS-YES-MSG-2      TO TRUE                        22157013
221580         END-IF                                                   22158013
221590         END-IF                                                   22159013
221600         END-IF                                                   22160013
221610         END-IF                                                   22161013
221620                                                                  22162013
221630         IF  LBPTDA-SU-FRE-ASTRA-IND  =  PC-Y                     22163013
221640             IF PS-NO-MSG-1                                       22164013
221650                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   22165013
221660                                       TO PC257-ERROR-MSG-1       22166013
221670                 SET PS-YES-MSG-1  TO TRUE                        22167013
221680             ELSE                                                 22168013
221690             IF PS-NO-MSG-2                                       22169013
221700                 MOVE PC-FREE-ASTRY-NO-TRIP-MSG                   22170013
221710                                       TO PC257-ERROR-MSG-1       22171013
221720                 SET PS-YES-MSG-2  TO TRUE                        22172013
221730             END-IF                                               22173013
221740             END-IF                                               22174013
221750         END-IF                                                   22175013
221760                                                                  22176013
221770         IF  LBPTDA-SU-MISDIR-IND  =  PC-Y                        22177013
221780             IF PS-NO-MSG-1                                       22178013
221790                 MOVE PC-MISDIRECT-MSG                            22179013
221800                                       TO PC257-ERROR-MSG-1       22180013
221810                 SET PS-YES-MSG-1  TO TRUE                        22181013
221820             ELSE                                                 22182013
221830             IF PS-NO-MSG-2                                       22183013
221840                 MOVE PC-MISDIRECT-MSG                            22184013
221850                                       TO PC257-ERROR-MSG-1       22185013
221860                 SET PS-YES-MSG-2  TO TRUE                        22186013
221870             END-IF                                               22187013
221880             END-IF                                               22188013
221890         END-IF                                                   22189013
221900         MOVE LBPTDA-CART-ACTN-CDE TO PC257-AUDIT-IND             22190013
221910*                                                                 22191013
221920         EVALUATE LBPTDA-HNG-FOLD-SEQ-NBR                         22192013
221930            WHEN  PC-1                                            22193013
221940                SET PC257-HANG  TO TRUE                           22194013
221950            WHEN  PC-2                                            22195013
221960                SET PC257-FOLD  TO TRUE                           22196013
221970            WHEN  OTHER                                           22197013
221980                SET PC257-DEFLT-PRESENTATION TO TRUE              22198013
221990         END-EVALUATE                                             22199013
222000                                                                  22200013
222010*                                                                 22201013
222020*BARCODE                                                          22202013
222030                                                                  22203013
222040         MOVE SPACES                 TO  PC257-SML-BARCODE        22204013
222050         IF LBPTDA-CART-ACTN-CDE = PC-Q                           22205013
222060            MOVE LBPTDA-BRCDE-NBR    TO  PC257-AUDIT-BARCODE      22206013
222070                                         PC257-BARCODE-TEXT       22207013
222080            SET  PC257-AUDT-BRCDE-EOT   TO TRUE                   22208013
222090            MOVE SPACES                 TO                        22209013
222100                                         PC257-AUDIT-FILLER       22210013
222110                                         PC257-SML-STR-NBR        22211013
222120            IF LBPTDA-SU-FRE-ASTRA-IND =  PC-T                    22212013
222130               SET PC257-FSTY-AUDIT-YES TO TRUE                   22213013
222140            ELSE                                                  22214013
222150*CLP 10/29/13 - START                                             22215013
222160               IF LBPTDA-PRC-MSG-CDE = PC-RA                      22216013
222170                   SET PC257-AUDIT-RFID-YES  TO TRUE              22217013
222180               ELSE                                               22218013
222190                   IF LBPTDA-PRC-MSG-CDE = PC-QR                  22219013
222200                      SET PC257-AUDIT-QCRD-YES  TO TRUE           22220013
222210                   ELSE                                           22221013
222220                      SET PC257-AUDIT-HDG-YES  TO TRUE            22222013
222230                   END-IF                                         22223013
222240               END-IF                                             22224013
222250            END-IF                                                22225013
222260*CLP 10/29/13 - END                                               22226013
222270            SET PC257-DEFLT-PRESENTATION TO TRUE                  22227013
222280                                                                  22228013
222290            IF  LBPTDA-TRIP-ID    >  ZERO                         22229013
222300                MOVE LBPTDA-TRIP-ID   TO  PC257-SEASET            22230013
222310            ELSE                                                  22231013
222320                SET  PC257-SEASET-NO        TO  TRUE              22232013
222330            END-IF                                                22233013
222340                                                                  22234013
222350            SET PC257-AUDIT-BRCD                                  22235013
222360                PC255-NO-ZONE-HDG                                 22236013
222370                PC257-DOOR-HDG-NO                                 22237013
222380                PC257-FORM-NO-REVRSE-STR                          22238013
222390                PC257-AUDIT-YES                                   22239013
222400                PC257-MFST-BOX-NO                                 22240013
222410                PC257-AUDIT-NBR-SIDE                              22241013
222420                PC257-TRIP-HDG                                    22242013
222430                PC255-TEST-LNE-NO                                 22243013
222440                PC257-DEFLT-PRESENTATION TO TRUE                  22244013
222450                                                                  22245013
222460         ELSE                                                     22246013
222470             MOVE  LBPTDA-BRCDE-NBR       TO  PV-2O-DIGIT-BARCODE 22247013
222480             MOVE  PV-20-SML-CONTAINER-CDE                        22248013
222490               TO  PC160-20-SML-NBR-CONTAINER-CDE                 22249013
222500             MOVE  PV-20-SML-PACKAGING-TYP                        22250013
222510               TO  PC160-20-SML-NBR-PACKAGING-TYP                 22251013
222520             MOVE  PV-20-SML-SOFTWARE-SRC                         22252013
222530               TO  PC160-20-SML-NBR-SOFTWARE-SRC                  22253013
222540             MOVE  PV-20-SML-BC-DIVERT                            22254013
222550               TO  PC160-20-SML-NBR-BC-DIVERT                     22255013
222560             MOVE  PV-20-SML-BC-DC-ORIGIN                         22256013
222570               TO  PC160-20-SML-NBR-BC-DC-ORIGIN                  22257013
222580             MOVE  PV-20-SML-BC-MNFST-NBR                         22258013
222590               TO  PC160-20-SML-NBR-BC-MNFST-NBR                  22259013
222600                                                                  22260013
222610             MOVE PC160-20-DIGIT-BARCODE-NBR TO PC257-BARCODE-TEXT22261013
222620             MOVE LBPTDA-BRCDE-NBR           TO PC257-SML-BARCODE 22262013
222630** SEASONAL SET                                                   22263013
222640             IF  LBPTDA-SEASET-NM  >  SPACES                      22264013
222650                 MOVE LBPTDA-SEASET-NM     TO  PC257-SEASET       22265013
222660                 SET  PC257-SET-HDG        TO TRUE                22266013
222670             ELSE                                                 22267013
222680                 SET PC257-SEASET-NO                              22268013
222690                     PC257-NO-SET-HDG      TO  TRUE               22269013
222700             END-IF                                               22270013
222710**STORE NUMBER                                                    22271013
222720             IF LBPTDA-STR-NM   =  PC-FLAT                        22272013
222730                MOVE   ZEROES              TO  PV-STORE-NUMBER    22273013
222740                MOVE   PV-STORE-NUMBER     TO  PC257-SML-STR-NBR  22274013
222750             ELSE                                                 22275013
222760                MOVE LBPTDA-DEST-OPER-UNT-ID TO  PV-STORE-NUMBER  22276013
222770                MOVE PV-STORE-NUMBER         TO  PC257-SML-STR-NBR22277013
222780             END-IF                                               22278013
222790                                                                  22279013
222800             SET  PC257-FORM-REVRSE-STR    TO  TRUE               22280013
222810** MERCHANDISE GROUP                                              22281013
222820             IF  LBPTDA-BUS-AREA-ID > ZEROES                      22282013
222830                 SET  PC255-ZONE-HDG       TO TRUE                22283013
222840                 MOVE LBPTDA-BUS-AREA-ID   TO PC257-MDSE-GROUP    22284013
222850             ELSE                                                 22285013
222860                 SET  PC255-NO-ZONE-HDG    TO TRUE                22286013
222870                 MOVE '@@'                 TO PC257-MDSE-GROUP    22287013
222880             END-IF                                               22288013
222890** CRTN AUDIT HEADING                                             22289013
222900             PERFORM 8550-CHECK-AUDIT-CRTN                        22290013
222910                                                                  22291013
222920             SET PC257-SML-BRCD                                   22292013
222930                 PC255-TEST-LNE-YES                               22293013
222940                 PC257-AUDIT-HDG-NO                               22294013
222950                 PC257-DOOR-HDG-YES                               22295013
222960                 PC257-MFST-BOX-YES                               22296013
222970                 PC257-BRCD-NBR-ABOVE TO TRUE                     22297013
222980         END-IF                                                   22298013
222990                                                                  22299013
223000*        MOVE +1                       TO PC257-SML-LBL-QTY       22300013
223010                                                                  22301013
223020*                                                                 22302013
223030         MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                           22303013
223040                                       TO PC257-LABEL-NBR.        22304013
223050         MOVE PC-OF                    TO PC257-LABEL-OF.         22305013
223060         MOVE LBPTDA-LBL-TYP-TOT-QTY   TO PC257-TOT-LABEL.        22306013
223070* DEPARTMENT NAME (INSIDE OF BOX)                                 22307013
223080*        IF  LBPTDA-DEPT-DESC  >  SPACES                          22308013
223090*            MOVE LBPTDA-DEPT-DESC     TO  PC257-DEPT-NAME        22309013
223100*        ELSE                                                     22310013
223110*            MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     22311013
223120*                                      TO  PC257-DEPT-NAME        22312013
223130*        END-IF.                                                  22313013
223140* MAJOR CLASS (INSIDE OF BOX)                                     22314013
223150*        IF  LBPTDA-MAJ-CL-DESC  >  SPACES                        22315013
223160*            MOVE LBPTDA-MAJ-CL-DESC   TO  PC257-MAJOR-CLASS      22316013
223170*        ELSE                                                     22317013
223180*            MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     22318013
223190*                                      TO  PC257-MAJOR-CLASS      22319013
223200*        END-IF.                                                  22320013
223210*****CLP 06/24/2015 START - COMBINED BUS AREA AND BRAND           22321013
223220     IF LBPTDA-LBL-MSG-TXT-TEXT  > SPACES                         22322013
223230        MOVE LBPTDA-LBL-MSG-TXT-TEXT TO PC257-POG-PROGRAM-NAME    22323013
223240*****CLP 06/24/2015 END                                           22324013
223250     ELSE                                                         22325013
223260       STRING LBPTDA-DEPT-DESC       DELIMITED BY '  '            22326013
223270               '/'                   DELIMITED BY SIZE            22327013
223280               LBPTDA-MAJ-CL-DESC    DELIMITED BY '   '           22328013
223290                              INTO PC257-POG-PROGRAM-NAME         22329013
223300     END-IF.                                                      22330027
223310* FIXTURE ID                                                      22331013
223320         IF  LBPTDA-FIXT-ID  >  SPACES                            22332013
223330             SET  PC257-FORM-FIX-HDG   to true                    22333013
223340*dmh 6/30/11      PC257-FIXTURE-YES    TO TRUE                    22334013
223350             MOVE LBPTDA-FIXT-ID       TO  PC257-FIXTURE          22335013
223360         ELSE                                                     22336013
223370             SET  PC257-FORM-NO-FIX-HDG                           22337013
223380*dmh 6/30/11      PC257-FIXTURE-NO                                22338013
223390                  PC257-FORM-NO-FIXTURE TO TRUE                   22339013
223400         END-IF.                                                  22340013
223410*                                                                 22341013
223420     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           22342013
223430     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           22343013
223440     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           22344013
223450     MOVE '-'                       TO  PV-LBL-DASH1              22345013
223460                                        PV-LBL-DASH2.             22346013
223470     MOVE PV-LBL-DATE               TO  PC257-LBL-PRT-DATE.       22347013
223480*                                                                 22348013
223490     MOVE PV-CURRENT-TIME-LBL       TO  PC257-LBL-PRT-TIME.       22349013
223500***                                                               22350013
223510     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DSPLY-DC.              22351013
223520     MOVE '-'                       TO  PV-DSPLY-DASH.            22352013
223530     MOVE LBPTDA-PRTR-ID            TO  PV-DSPLY-PRTR-ID.         22353013
223540     MOVE PV-DSPLY-PRTR             TO  PC257-SML-PRTR-NBR.       22354013
223550*                                                                 22355013
223560     MOVE SU054-USER-ID             TO PC257-USER-ID              22356063
223570*                                                                 22357013
223580*                                                                 22358013
223590     MOVE '@@@@'                    TO PC257-OUTPK-UNTS.          22359013
223600*                                                                 22360013
223610                                                                  22361013
223620**   DOOR ID                                                      22362013
223630     IF CNDCDR-DOOR-ID  > SPACES                                  22363013
223640        MOVE CNDCDR-DOOR-ID  TO PC257-DOOR-NUMBER                 22364013
223650     END-IF                                                       22365063
223660                                                                  22366013
223670**   EAS TAG                                                      22367013
223680     IF PS-EAS-TAG-IND-FOUND-YES                                  22368013
223690        SET PC257-EAS-TAG-NEEDED   TO TRUE                        22369013
223700     ELSE                                                         22370013
223710        SET PC257-EAS-TAG-NOT-NEEDED TO TRUE                      22371013
223720     END-IF.                                                      22372020
223730                                                                  22373013
223740     PERFORM 8500-CALL-STORE-ON-HAND-MOD                          22374063
223750                                                                  22375013
223760     IF XL088-NO-PROCESS-MESSAGE OR                               22376013
223770        LBPTDA-CART-ACTN-CDE = PC-Q                               22377013
223780        SET PC257-OH-ZERO-NO                                      22378013
223790            PC257-OH-ZERO-MSG-NO  TO TRUE                         22379013
223800     ELSE                                                         22380013
223810        SET PC257-OH-ZERO-YES     TO TRUE                         22381013
223820        MOVE XL088-PROCESS-MESSAGE-TXT                            22382013
223830                 TO PC257-STR-ON-HAND                             22383013
223840        IF XL088-FIRST-STORE-RCPT                                 22384013
223850           MOVE PV-FIRST-STORE-RCPT-TXT-1 TO PC257-TEXT-LINE-1    22385013
223860           MOVE PV-FIRST-STORE-RCPT-TXT-2 TO PC257-TEXT-LINE-2    22386013
223870           MOVE PV-FIRST-STORE-RCPT-TXT-3 TO PC257-TEXT-LINE-3    22387013
223880           SET PC257-FORM-NO-TEXT-4       TO TRUE                 22388013
223890        ELSE                                                      22389013
223900           SET PC257-FORM-NO-TEXT-1                               22390013
223910               PC257-FORM-NO-TEXT-2                               22391013
223920               PC257-FORM-NO-TEXT-3                               22392013
223930               PC257-FORM-NO-TEXT-4       TO TRUE                 22393013
223940        END-IF                                                    22394013
223950     END-IF                                                       22395063
223960                                                                  22396013
223970* JAK WR41309 - ADD CHECK FOR RFID TO SET PC257-TEXT-4            22397013
223980*                                       IF AUTO CONVEY            22398013
223990*                                       IF KNOWN RFID             22399013
224000     IF PS-RFID-ON-LABEL-YES OR                                   22400048
224010       PV-PRC-MSG-CDE     = 'RD' OR                               22401061
224020       PV-PRC-MSG-CDE     = 'EA' OR                               22402061
224030       PV-PRC-MSG-CDE     = 'RE'                                  22403061
224040*** CHANGE LBPTDA-PRC-MSG-CDE TO PV-PRC-MSG-CDE IN EVALUATE       22404061
224050        EVALUATE TRUE                                             22405061
224060           WHEN PV-PRC-MSG-CDE     = 'RD'                         22406061
224070             MOVE PV-RFID-STORE-TXT-4   TO PC257-TEXT-LINE-4      22407061
224080           WHEN PV-PRC-MSG-CDE     = 'EA'                         22408061
224090             MOVE PV-EAS-STORE-TXT-4    TO PC257-TEXT-LINE-4      22409061
224100           WHEN PV-PRC-MSG-CDE     = 'RE'                         22410061
224110             MOVE PV-EAS-RF-STORE-TXT-4 TO PC257-TEXT-LINE-4      22411061
224120        END-EVALUATE                                              22412061
224130     ELSE                                                         22413061
224140*    IF REPRINT, CHECK FOR RFID                                   22414061
224150        IF LBPTDA-RPRT-IND = PC-Y                                 22415061
224160           MOVE PV-SHIPT-UNT-ID-NUM TO SUT00094-SHIPT-UNT-ID      22416061
224170           PERFORM 8700-COUNT-MSG-RD                              22417061
224180           IF PV-PRC-MSG-CDE = 'RD' OR                            22418061
224190              LBPTDA-PRC-MSG-CDE = 'RD'                           22419061
224200                 MOVE PV-RFID-STORE-TXT-4 TO PC257-TEXT-LINE-4    22420061
224210           ELSE                                                   22421061
224220              IF PV-PRC-MSG-CDE = 'EA' OR                         22422061
224230                 LBPTDA-PRC-MSG-CDE = 'EA'                        22423061
224240                 MOVE PV-EAS-STORE-TXT-4 TO PC257-TEXT-LINE-4     22424061
224250              ELSE                                                22425061
224260                 IF PV-PRC-MSG-CDE = 'RE' OR                      22426061
224270                    LBPTDA-PRC-MSG-CDE = 'RE'                     22427061
224280                       MOVE PV-EAS-RF-STORE-TXT-4 TO              22428061
224290                          PC257-TEXT-LINE-4                       22429061
224300                 ELSE                                             22430061
224310*        NOT A REPRINT                                            22431027
224320                    SET PC257-FORM-NO-TEXT-4 TO TRUE              22432061
224330                 END-IF                                           22433061
224340              END-IF                                              22434061
224350           END-IF                                                 22435061
224360        END-IF                                                    22436061
224370     END-IF.                                                      22437061
224380*                                       NOT AUTO CONVEY           22438013
224390**** ELSE                                                         22439013
224400****     SET PC257-FORM-NO-TEXT-4  TO TRUE                        22440013
224410**** END-IF                                                       22441013
224420* JAK WR41309 - END                                               22442013
224430                                                                  22443013
224440     IF LBPTDA-CART-ACTN-CDE = PC-Q                               22444013
224450        SET PC257-OH-ZERO-NO                                      22445013
224460            PC257-OH-ZERO-MSG-NO  TO TRUE                         22446013
224470     END-IF                                                       22447013
224480                                                                  22448013
224490     MOVE PC257-SML-BATCH-LBL       TO                            22449013
224500                                        SU054-LABEL-DATA-FORMAT.  22450013
224510                                                                  22451013
224520* 07/19/13 RLK BEG                                                22452013
224530*----------------------------------------------------------------*22453013
224540* BUILD SML LABEL FORM                                           *22454013
224550*----------------------------------------------------------------*22455013
224560 8250-BUILD-CRTN-LBL-FORM.                                        22456013
224570*                                                                 22457013
224580** added internal table to track paragraph execution time         22458013
224590** dmh 2014-12-22 - begin                                         22459013
224600*                                                                 22460013
224610     MOVE  '8250'  TO  PT-CURR-PARA.                              22461013
224620     IF  PS-BLD-INTERNAL-TABLE-YES                                22462013
224630         PERFORM 0200-INTERNAL-TABLE                              22463013
224640     ELSE                                                         22464013
224650         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       22465013
224660     END-IF.                                                      22466013
224670                                                                  22467013
224680*                                                                 22468013
224690** DMH 2014-12-22 - END                                           22469013
224700*                                                                 22470013
224710                                                                  22471013
224720*dmh INITIALIZE PC267-CARTON-LABEL.                               22472013
224730     move  spaces    to  PC267-BC-BARCODE                         22473013
224740                         PC267-NO-BRCDE-FLD                       22474013
224750                         PC267-BC-NBR-UNDR                        22475013
224760                         PC267-USERID                             22476013
224770                         PC267-CASI                               22477013
224780                         PC267-sscc-nbr                           22478013
224790                         PC267-PRINTER-NBR                        22479013
224800                         PC267-PO-NBR                             22480013
224810                         PC267-RECV-SEQ-NBR                       22481013
224820                         PC267-PO-LNE-NBR                         22482013
224830                         PC267-PROCESS-AREA                       22483013
224840                         PC267-ARVD-DTE                           22484013
224850                         PC267-SKU                                22485013
224860                         PC267-MSG-1                              22486013
224870                         PC267-MSG-2                              22487013
224880                         PC267-MSG-3.                             22488013
224890                                                                  22489013
224900                                                                  22490013
224910* 08/01/13 RLK END                                                22491013
224920     SET SU054-KOHLS-CRTN-LABEL TO TRUE.                          22492013
224930*    SET SU054-P2L-REQ TO TRUE.                                   22493013
224940*BARCODE IS NEEDED                                                22494013
224950     PERFORM 7405-GET-CURRENT-DATE                                22495013
224960     MOVE PV-CURRENT-YY             TO  PV-LBL-DATE-YY.           22496013
224970     MOVE PV-CURRENT-MM             TO  PV-LBL-DATE-MM.           22497013
224980     MOVE PV-CURRENT-DD             TO  PV-LBL-DATE-DD.           22498013
224990     MOVE PV-DATE-YY                TO  PV-ARVD-DATE-YY.          22499013
225000     MOVE PV-DATE-MM                TO  PV-ARVD-DATE-MM.          22500013
225010     MOVE PV-DATE-DD                TO  PV-ARVD-DATE-DD.          22501013
225020     MOVE '-'                       TO  PV-LBL-DASH1              22502013
225030                                        PV-LBL-DASH2              22503013
225040                                        PV-ARVD-DASH1             22504013
225050                                        PV-ARVD-DASH2.            22505013
225060     MOVE PV-LBL-DATE               TO  PC267-LBL-PRT-DATE.       22506013
225070     MOVE PV-ARVD-DATE              TO  PC267-ARVD-DTE.           22507013
225080*                                       PC267-RCVD-DTE.           22508013
225090     MOVE PV-CURRENT-TIME           TO  PC267-LBL-PRT-TIME.       22509013
225100     MOVE LBPTDA-DC-PRTD-AT-CDE     TO  PV-DSPLY-DC.              22510013
225110     MOVE '-'                       TO  PV-DSPLY-DASH.            22511013
225120     MOVE LBPTDA-PRTR-ID            TO  PV-DSPLY-PRTR-ID.         22512013
225130     MOVE PV-DSPLY-PRTR             TO  PC267-PRINTER-NBR.        22513013
225140     MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM.       22514013
225150     MOVE PV-SHIPT-UNT-14-18       TO  PC267-SSCC-NBR.            22515013
225160     MOVE LBPTDA-BRCDE-NBR         TO  PV-22-DIGIT-BARCODE.       22516013
225170     IF LBPTDA-SKU-NBR > ZERO                                     22517013
225180                                                                  22518013
225190         MOVE XL001-DEPT-NBR-3CH   TO PV-SML-DEPT1                22519013
225200         MOVE XL001-SUB-CL-NBR-2CH TO PV-SML-CLASS-NBR1           22520013
225210         MOVE LBPTDA-SKU-NBR       TO PV-SML-SKU                  22521013
225220         MOVE PV-SML-SKU-NUMBER    TO PC267-SKU                   22522013
225230     ELSE                                                         22523013
225240         MOVE SPACES               TO PC267-SKU                   22524013
225250     END-IF.                                                      22525013
225260     MOVE LBPTDA-CART-ACTN-CDE     TO PC267-CASI.                 22526013
225270     MOVE SU054-USER-ID            TO PC267-USERID.               22527013
225280     MOVE LBPTDA-PO-NBR TO PV-PO-NBR-K.                           22528013
225290     MOVE PV-PO-NBR-7POS TO                                       22529013
225300               PC267-PO-NBR.                                      22530013
225310     MOVE LBPTDA-RCVR-SEQ-NBR TO PV-RCVR-NBR.                     22531013
225320     MOVE PV-RCVR-NBR-3POS TO                                     22532013
225330               PC267-RECV-SEQ-NBR.                                22533013
225340     MOVE LBPTDA-PO-LNE-NBR TO PV-LINE-NBR.                       22534013
225350     MOVE PV-PO-LINE-NBR TO                                       22535013
225360               PC267-PO-LNE-NBR.                                  22536013
225370     MOVE LBPTDA-MODU-DESC      TO PC267-PROCESS-AREA.            22537013
225380     MOVE LBPTDA-CART-ACTN-CDE TO PC267-CASI.                     22538013
225390     SET  PC160-DEST-TYP-0          TO  true.                     22539013
225400     MOVE  PV-22-CRTN-DIVERT-CDE    TO  PC160-DEST-DIVERT-CODE.   22540013
225410     MOVE  PV-PO-NBR-7POS           TO  PC160-DEST-PO-NBR.        22541013
225420     MOVE  PV-RCVR-NBR-3POS         TO  PC160-DEST-RCVR-SEQ-NBR.  22542013
225430     MOVE  PV-PO-LINE-NBR           TO  PC160-DEST-PO-LNE-NBR.    22543013
225431     MOVE  PV-22-CRTN-CART-NBR      to  PC160-DEST-LBL-SEQ-NBR.   22543170
225450*                                                                 22545013
225460******************************************************************22546013
225470*  this is basic code for RFID Carton Labels - barcd or no barcd *22547013
225480*  dmh - 7/31/13                                                  22548013
225490* 08/01/13 RLK BEG                                                22549013
225500     IF PV-RFID-DIVERT-CDE = 'XXXX'                               22550013
225510        SET   PC267-NO-BRCDE-NBR        TO  TRUE                  22551013
225520        MOVE  SPACES                    TO  PC267-NO-BRCDE-FLD    22552013
225530                                            PC267-BC-NBR-UNDR     22553013
225540     ELSE                                                         22554013
225550         SET  PC267-BRCD-NBR            TO  TRUE                  22555013
225560         MOVE PC160-DEST-BARCODE-TEXT   TO  PC267-BC-BARCODE      22556013
225570                                            PC267-BC-NBR-UNDR     22557013
225580     END-IF.                                                      22558013
225590* 08/01/13 RLK END                                                22559013
225600*                                                                 22560013
225610******************************************************************22561013
225620*                                                                 22562013
225630* 08/01/13 RLK BEG                                                22563013
225640* PV-HOLD-LBL-TYP-CDE HOLDS THE VALUE OF LBPTDA-CART-LBL-TYP-CDE  22564013
225650* BEFORE IT WAS CHANGED FOR THE CARTON LABEL PROCESSING.          22565013
225660* THIS IS USED TO DETERMINE TEXT ON LABEL AS EITHER CROSSDOCK     22566013
225670* OR P2L OR BLANK.                                                22567013
225680* P2L                                                             22568013
225690     IF LBVRDA-CART-LBL-TYP-CDE = 'P'                             22569013
225700       MOVE 'P2L'                   TO PC267-MSG-1                22570013
225710     ELSE                                                         22571013
225720* SML                                                             22572013
225730       MOVE 'Crossdock'             TO PC267-MSG-1                22573013
225740     END-IF.                                                      22574013
225750** MERCHANDISE GROUP                                              22575013
225760     MOVE LBPTDA-PO-NBR TO PURCHS-PO-NBR.                         22576013
225770     PERFORM 2150-GET-ZONE-DESC-FOR-CL.                           22577013
225780     MOVE MDSEDP-STR-ZN-ID     TO PC267-MSG-2.                    22578013
225790* No values for PC267-MSG-3 has been established yet              22579013
225800*dmh MOVE '@@@@@@@@@@@@@@@@@'     TO PC267-MSG-3.                 22580013
225810     MOVE '@@@@@@@@@@@@@@@@ '     TO PC267-MSG-3.                 22581013
225820* 08/01/13 RLK END                                                22582013
225830                                                                  22583013
225840* 05/27/15 dmh BEG                                                22584013
225850     IF PS-REPRINT-FORM                                           22585013
225860       SET PC267-REPRINT-BOX TO TRUE                              22586013
225870       SET PC267-REPRINT-TEXT TO TRUE                             22587013
225880     ELSE                                                         22588013
225890       SET PC267-NO-RPRT-BOX TO TRUE                              22589013
225900       SET PC267-NO-RPRT-TEXT TO TRUE                             22590013
225910     END-IF.                                                      22591013
225920* 05/27/15 dmh end                                                22592013
225930                                                                  22593013
225940*                                                                 22594013
225950*                                                                 22595013
225960*** BEGIN - FOR TESTING ONLY                                      22596013
225970*    IF PS-LOG-MESSAGE                                            22597013
225980*    STRING ' '                  DELIMITED BY SIZE                22598013
225990*           'SUKCS782-'          DELIMITED BY SIZE                22599099
226000*    '8250-BUILD- '              DELIMITED BY SIZE                22600013
226010*           'PRTR- '             DELIMITED BY SIZE                22601013
226020*           PC267-PRINTER-NBR    DELIMITED BY SIZE                22602013
226030*           'BC- '               DELIMITED BY SIZE                22603013
226040*           PV-22-DIGIT-BARCODE                                   22604013
226050*           DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B             22605013
226060*           PERFORM 9999-WRITE-TO-CSSL                            22606013
226070*    STRING ' '                  DELIMITED BY SIZE                22607013
226080*           'SUKCS782-'          DELIMITED BY SIZE                22608099
226090*    '8250-BUILD- '              DELIMITED BY SIZE                22609013
226100*              'STORE ZONE-'     DELIMITED BY SIZE                22610013
226110*       LBPTDA-STR-ZN-ID         DELIMITED BY SIZE                22611013
226120*       LBVRDA-STR-ZN-ID         DELIMITED BY SIZE                22612013
226130*       MDSEDP-STR-ZN-ID         DELIMITED BY SIZE                22613013
226140*               ' TDA-TYP-CDE- ' DELIMITED BY SIZE                22614013
226150*         LBPTDA-CART-LBL-TYP-CDE                                 22615013
226160*                ' H-TYP-CDE- ' DELIMITED BY SIZE                 22616013
226170*         PV-HOLD-LBL-TYP-CDE                                     22617013
226180*           DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-B             22618013
226190*           PERFORM 9999-WRITE-TO-CSSL                            22619013
226200*    END-IF.                                                      22620013
226210*** END - FOR TESTING ONLY                                        22621013
226220     MOVE PC267-CARTON-LABEL        TO                            22622013
226230                                        SU054-LABEL-DATA-FORMAT.  22623013
226240* 07/19/13 RLK END                                                22624013
226250                                                                  22625013
226260 8300-LOAD-LABEL-DATA-P2L.                                        22626013
226270*                                                                 22627013
226280** added internal table to track paragraph execution time         22628013
226290** dmh 2014-12-22 - begin                                         22629013
226300*                                                                 22630013
226310     MOVE  '8300'  TO  PT-CURR-PARA.                              22631013
226320     IF  PS-BLD-INTERNAL-TABLE-YES                                22632013
226330         PERFORM 0200-INTERNAL-TABLE                              22633013
226340     ELSE                                                         22634013
226350         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       22635013
226360     END-IF.                                                      22636013
226370                                                                  22637013
226380*                                                                 22638013
226390** DMH 2014-12-22 - END                                           22639013
226400*                                                                 22640013
226410                                                                  22641013
226420     IF PS-RFID-ON-LABEL-YES                                      22642013
226430        IF LBPTDA-PRC-MSG-CDE = 'RD'                              22643061
226440           MOVE PC249-RFID-BOX    TO PC249-LBL-RFID-BOX           22644061
226450           MOVE PC249-RFID-FLD    TO PC249-LBL-RFID-FLD           22645061
226460        ELSE                                                      22646061
226470           IF LBPTDA-PRC-MSG-CDE = 'EA'                           22647061
226480              MOVE PC249-RFID-BOX    TO PC249-LBL-RFID-BOX        22648061
226490              MOVE PC249-EAS-FLD     TO PC249-LBL-RFID-FLD        22649061
226500           ELSE                                                   22650061
226510              IF LBPTDA-PRC-MSG-CDE = 'RE'                        22651061
226520                 MOVE PC249-RFID-BOX    TO PC249-LBL-RFID-BOX     22652061
226530                 MOVE PC249-RF-EAS-FLD  TO PC249-LBL-RFID-FLD     22653061
226540              ELSE                                                22654061
226550                 MOVE PC249-NO-RFID-BOX TO PC249-LBL-RFID-BOX     22655061
226560                 MOVE PC249-NO-RFID-FLD TO PC249-LBL-RFID-FLD     22656061
226570              END-IF                                              22657061
226580           END-IF                                                 22658061
226590        END-IF                                                    22659061
226600     END-IF.                                                      22660061
226610                                                                  22661013
226620     IF LBPTDA-PREPK-ID > 0                                       22662013
226630***PACK DIVIDE***                                                 22663013
226640              MOVE PC249-PK-DIVIDE-FLD                            22664013
226650                                      TO PC249-PACK-DIVIDE-FLD    22665013
226660*PACK-XXXX                                                        22666013
226670              MOVE LBPTDA-PREPK-ID                                22667013
226680                                      TO PV-PREPK-ID-LBL          22668013
226690              MOVE PV-PACK                                        22669013
226700                                      TO PC249-SKU                22670013
226710*DRIVR LINE RATIO:                                                22671013
226720              MOVE PC249-DRVR-LNE-RATIO-DESC                      22672013
226730                                      TO PC249-LNE-NO-DESC        22673013
226740              MOVE LBPTDA-PREPK-RATO-QTY                          22674013
226750                                      TO PV-LINE-RATO             22675013
226760              MOVE PV-LINE-RATO-NBR   TO PC249-LINE-NO            22676013
226770*TOT UNTS IN PACK:                                                22677013
226780              MOVE PC249-TOT-UNITS-DESC                           22678013
226790                                      TO PC249-DES-INPK-DESC      22679013
226800              MOVE LBPTDA-PREPK-UNT-QTY                           22680013
226810                                      TO PC249-DES-INPK-QTY       22681013
226820*PACKS IN CARTON:                                                 22682013
226830              MOVE PC249-PCKS-INCTN-DESC                          22683013
226840                                      TO PC249-DES-UNT-PK-DESC    22684013
226850*GB 3/21/01*******************************************************22685013
226860                                                                  22686013
226870          IF (LBPTDA-PREPK-UNT-QTY > 0 AND                        22687013
226880              LBPTDA-OTPK-UNT-QTY  > 0 )                          22688013
226890             DIVIDE LBPTDA-OTPK-UNT-QTY BY                        22689013
226900                           LBPTDA-PREPK-UNT-QTY                   22690013
226910                           GIVING   PV-PACKS-IN-CARTON            22691013
226920          ELSE                                                    22692013
226930             MOVE 0     TO PV-PACKS-IN-CARTON                     22693013
226940          END-IF                                                  22694013
226950                                                                  22695013
226960          MOVE PV-PACKS-IN-CARTON-X                               22696013
226970                                    TO PC249-DES-UNT-PK-QTY       22697013
226980*DRIVR LNE SKU:                                                   22698013
226990          MOVE PC249-DRVR-LINE-DESC                               22699013
227000                                  TO PC249-DES-DWN-SK-DESC        22700013
227010                                                                  22701013
227020          MOVE   LBPTDA-SKU-NBR                                   22702013
227030                                  TO PC249-DES-DWN-SK-QTY         22703013
227040                                                                  22704013
227050                                                                  22705013
227060          MOVE PC249-PK-DIVIDE-BOX                                22706013
227070                                  TO PC249-PACK-DIVIDE-BOX        22707013
227080                                                                  22708013
227090           MOVE LBPTDA-BRCDE-NBR      TO PC249-BC-BARCODE         22709013
227100                                         PC249-TXT-BARCODE        22710013
227110           MOVE SU054-USER-ID                                     22711013
227120                                      TO PC249-USER-ID            22712013
227130*                                                                 22713013
227140           MOVE PV-2-DIGIT-DC-ABBR    TO PV-DC-PRTD-AT            22714013
227150           MOVE LBPTDA-PRTR-ID                                    22715013
227160                                      TO PV-PRTR-ID               22716013
227170           MOVE PV-PRINTER-FORMAT     TO PC249-DES-PRINTER-ID     22717013
227180*                                                                 22718013
227190           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         22719013
227200                                      TO PC249-LABEL-NBR          22720013
227210           MOVE LBPTDA-LBL-TYP-TOT-QTY                            22721013
227220                                      TO PC249-TOT-LABEL          22722013
227230           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           22723013
227240           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           22724013
227250           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           22725013
227260           MOVE '-'                   TO PV-LBL-DASH1             22726013
227270                                         PV-LBL-DASH2             22727013
227280           MOVE PV-LBL-DATE           TO PC249-LBL-PRT-DATE       22728013
227290           MOVE PV-CURRENT-TIME-LBL                               22729013
227300                                      TO PC249-LBL-PRT-TIME       22730013
227310           MOVE PC249-LABEL-DESCRIPTION                           22731013
227320                                      TO PC249-DEST-LBL-DESC      22732013
227330*CRTN                                                             22733013
227340           MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM  22734013
227350           MOVE PV-SHIPT-UNT-14-18       TO  PC249-CRTN-NBR       22735013
227360*LBL SEQ                                                          22736013
227370           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         22737013
227380                                      TO PC249-START-CARTON-CNT-1 22738013
227390*SKU                                                              22739013
227400           MOVE LBPTDA-SKU-NBR        TO PC249-DES-DWN-SK-QTY     22740013
227410*PO/RCVR                                                          22741013
227420         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           22742013
227430         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         22743013
227440         MOVE PV-PO-RCVR               TO  PC249-DES-PO-RCVR      22744013
227450*DEPT-CLASS                                                       22745013
227460           MOVE XL001-DEPT-NBR-3CH                                22746013
227470                                      TO PV-P2L-DEPT1             22747013
227480           MOVE XL001-SUB-CL-NBR-2CH                              22748013
227490                                      TO PV-P2L-CLASS-NBR1        22749013
227500           MOVE PV-P2L-DEPT-CLASS                                 22750013
227510                                      TO PC249-DEPT-CLASS         22751013
227520                                                                  22752013
227530*ZONE                                                             22753013
227540           MOVE LBPTDA-STR-ZN-ID                                  22754013
227550                                      TO PC249-DES-ZONE           22755013
227560*MODULE NAME                                                      22756013
227570           MOVE LBPTDA-MODU-DESC                                  22757013
227580                                      TO PC249-MODULE-NAME        22758013
227590*****************IF NON-PREPACK ORDER*****************************22759013
227600     ELSE                                                         22760013
227610           MOVE LBPTDA-BRCDE-NBR      TO PC249-BC-BARCODE         22761013
227620                                         PC249-TXT-BARCODE        22762013
227630           MOVE LBPTDA-CRE-USR-ID                                 22763013
227640                                      TO PC249-USER-ID            22764013
227650                                                                  22765013
227660           MOVE PV-2-DIGIT-DC-ABBR    TO PV-DC-PRTD-AT            22766013
227670           MOVE LBPTDA-PRTR-ID                                    22767013
227680                                      TO PV-PRTR-ID               22768013
227690           MOVE PV-PRINTER-FORMAT     TO PC249-DES-PRINTER-ID     22769013
227700*                                                                 22770013
227710           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         22771013
227720                                      TO PC249-LABEL-NBR          22772013
227730           MOVE LBPTDA-LBL-TYP-TOT-QTY                            22773013
227740                                      TO PC249-TOT-LABEL          22774013
227750           MOVE PV-WORK-YY            TO PV-LBL-DATE-YY           22775013
227760           MOVE PV-WORK-MM            TO PV-LBL-DATE-MM           22776013
227770           MOVE PV-WORK-DD            TO PV-LBL-DATE-DD           22777013
227780           MOVE '-'                   TO PV-LBL-DASH1             22778013
227790                                         PV-LBL-DASH2             22779013
227800           MOVE PV-LBL-DATE           TO PC249-LBL-PRT-DATE       22780013
227810           MOVE PV-CURRENT-TIME                                   22781013
227820                                      TO PC249-LBL-PRT-TIME       22782013
227830           MOVE PC249-LABEL-DESCRIPTION                           22783013
227840                                      TO PC249-DEST-LBL-DESC      22784013
227850*CRTN                                                             22785013
227860           MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM  22786013
227870           MOVE PV-SHIPT-UNT-14-18       TO  PC249-CRTN-NBR       22787013
227880*LBL SEQ                                                          22788013
227890           MOVE LBPTDA-LBL-TYP-LBL-SEQ-ID                         22789013
227900                                      TO PC249-START-CARTON-CNT-1 22790013
227910*SKU                                                              22791013
227920           MOVE LBPTDA-SKU-NBR                                    22792013
227930                                      TO PC249-SKU                22793013
227940*PO/RCVR                                                          22794013
227950         MOVE LBPTDA-PO-NBR            TO  PV-PO-NUMBER           22795013
227960         MOVE LBPTDA-RCVR-SEQ-NBR      TO  PV-PO-RECEIVER         22796013
227970         MOVE PV-PO-RCVR               TO  PC249-DES-PO-RCVR      22797013
227980*DEPT-CLASS                                                       22798013
227990           MOVE XL001-DEPT-NBR-3CH                                22799013
228000                                      TO PV-P2L-DEPT1             22800013
228010           MOVE XL001-SUB-CL-NBR-2CH                              22801013
228020                                      TO PV-P2L-CLASS-NBR1        22802013
228030           MOVE PV-P2L-DEPT-CLASS                                 22803013
228040                                      TO PC249-DEPT-CLASS         22804013
228050*LINE NUMBER                                                      22805013
228060           MOVE PC249-LINE-NO-DESC                                22806013
228070                                      TO PC249-LNE-NO-DESC        22807013
228080           MOVE LBPTDA-PO-LNE-NBR                                 22808013
228090                                      TO PV-LINE-NBR              22809013
228100           MOVE PV-PO-LINE-NBR                                    22810013
228110                                      TO PC249-LINE-NO            22811013
228120           MOVE PC249-INNER-PACK-DESC                             22812013
228130                                      TO PC249-DES-INPK-DESC      22813013
228140           MOVE PC249-NO-INPK-CNVY-BOX                            22814013
228150                                      TO PC249-INPK-BOX           22815013
228160           MOVE LBPTDA-INPK-UNT-QTY                               22816013
228170                                      TO PV-INPK-QTY              22817013
228180           MOVE PV-INPK-UNIT-QTY                                  22818013
228190                                      TO PC249-DES-INPK-QTY       22819013
228200                                                                  22820013
228210*ZONE                                                             22821013
228220           MOVE LBPTDA-STR-ZN-ID                                  22822013
228230                                      TO PC249-DES-ZONE           22823013
228240*MODULE NAME                                                      22824013
228250           MOVE LBPTDA-MODU-DESC                                  22825013
228260                                      TO PC249-MODULE-NAME        22826013
228270                                                                  22827013
228280           MOVE SPACES                TO PC249-DES-UNT-PK-DESC    22828013
228290                                         PC249-DES-UNT-PK-QTY     22829013
228300                                         PC249-DES-DWN-SK-DESC    22830013
228310                                         PC249-DES-DWN-SK-QTY     22831013
228320           MOVE PC249-NO-PK-DIVIDE-BOX                            22832013
228330                                      TO PC249-PACK-DIVIDE-BOX    22833013
228340           MOVE PC249-NO-PK-DIVIDE-FLD                            22834013
228350                                      TO PC249-PACK-DIVIDE-FLD    22835013
228360     END-IF.                                                      22836013
228370     IF PS-WEIGHTS-MEAUSURES-CHECK  AND PS-ECOMM-DC-REPURPOSE     22837013
228380          MOVE PC249-PK-DIVIDE-BOX                                22838013
228390                                  TO PC249-PACK-DIVIDE-BOX        22839013
228400                                                                  22840013
228410        MOVE PC249-REPURP-WGHTS-MSURES TO PC249-PACK-DIVIDE-FLD   22841013
228420     END-IF                                                       22842013
228430*                                                                 22843013
228440* GB 12/20/01 BEG                                                 22844013
228450*AUDIT INDICATOR                                                  22845013
228460     MOVE LBPTDA-CART-ACTN-CDE TO PC249-AUDIT-IND                 22846013
228470* GB 12/20/01 END                                                 22847013
228480                                                                  22848013
228490                                                                  22849013
228500*    MOVE 0001  TO PC249-LBL-QTY-TO-PRT.                          22850013
228510                                                                  22851013
228520     MOVE PC249-P2L-DESTIN-LABEL    TO                            22852013
228530                                        SU054-LABEL-DATA-FORMAT.  22853013
228540*                                                                 22854013
228550 8400-LOAD-LABEL-DATA-CS.                                         22855013
228560*                                                                 22856013
228570** added internal table to track paragraph execution time         22857013
228580** dmh 2014-12-22 - begin                                         22858013
228590*                                                                 22859013
228600     MOVE  '8400'  TO  PT-CURR-PARA.                              22860013
228610     IF  PS-BLD-INTERNAL-TABLE-YES                                22861013
228620         PERFORM 0200-INTERNAL-TABLE                              22862013
228630     ELSE                                                         22863013
228640         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       22864013
228650     END-IF.                                                      22865013
228660                                                                  22866013
228670*                                                                 22867013
228680** DMH 2014-12-22 - END                                           22868013
228690*                                                                 22869013
228700                                                                  22870013
228710*                                                                 22871013
228720*CRTN                                                             22872013
228730           MOVE LBPTDA-SHIPT-UNT-ID      TO  PV-SHIPT-UNT-ID-NUM  22873013
228740           MOVE PV-SHIPT-UNT-14-18       TO  PC250-CRTN-NBR       22874013
228750                                                                  22875013
228760*STORE NAME                                                       22876013
228770         MOVE LBPTDA-STR-NM           TO  PC250-STR-NAME          22877013
228780*STORE Nbr                                                        22878013
228790         MOVE LBPTDA-DEST-OPER-UNT-ID TO  PV-STORE-NUMBER         22879013
228800         MOVE PV-STORE-NUMBER         TO  PC250-STORE-NBR         22880013
228810*ODD CRTN                                                         22881013
228820     MOVE PC250-FORM-NO-ODD-BOX                                   22882013
228830                                    TO PC250-ODD-CARTON-BOX       22883013
228840     MOVE PC250-FORM-NO-ODD-FLD                                   22884013
228850                                    TO PC250-ODD-CARTON-FIELD     22885013
228860                                                                  22886013
228870*AUDIT INDICATOR                                                  22887013
228880         MOVE LBPTDA-CART-ACTN-CDE TO PC250-AUDIT-IND             22888013
228890                                                                  22889013
228900                                                                  22890013
228910*INNER PACK CONVEYABLE                                            22891013
228920     IF  LBPTDA-INPK-CNVYB-IND = 'Y'                              22892013
228930         MOVE PC250-FORM-INPK-BOX       TO PC250-INPK-CONVY-BOX   22893013
228940     ELSE                                                         22894013
228950         MOVE PC250-FORM-NO-INPK-BOX    TO PC250-INPK-CONVY-BOX   22895013
228960     END-IF                                                       22896013
228970                                                                  22897013
228980*REPRINT                                                          22898013
228990     IF  LBPTDA-RPRT-IND  =  PC-Y                                 22899013
229000         MOVE PC250-FORM-REPRT-BOX      TO  PC250-REPRINT-BOX     22900013
229010         MOVE PC250-FORM-REPRT-FLD      TO  PC250-REPRINT-TEXT    22901013
229020     ELSE                                                         22902013
229030         MOVE PC250-FORM-NO-RPRT-BOX    TO  PC250-REPRINT-BOX     22903013
229040         MOVE PC250-FORM-NO-RPRT-FLD    TO  PC250-REPRINT-TEXT    22904013
229050     END-IF.                                                      22905013
229060*CRTN                                                             22906013
229070     MOVE 'CRTN:'                   TO  PC250-CRTN-HDG.           22907013
229080*PRTR                                                             22908013
229090     MOVE PV-2-DIGIT-DC-ABBR    TO PV-DC-PRTD-AT                  22909013
229100     MOVE LBPTDA-PRTR-ID                                          22910013
229110                                TO PV-PRTR-ID                     22911013
229120     MOVE PV-PRINTER-FORMAT     TO PC250-SML-PRTR-NBR.            22912013
229130                                                                  22913013
229140*                                                                 22914013
229150*LABEL COUNT                                                      22915013
229160     MOVE PC250-FORM-OF             TO  PC250-LABEL-CNT.          22916013
229170     MOVE LBPTDA-LBL-TYP-TOT-QTY    TO  PC250-TOT-LBL-CNT.        22917013
229180*                                                                 22918013
229190*DATE                                                             22919013
229200     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           22920013
229210     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           22921013
229220     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           22922013
229230     MOVE '-'                       TO  PV-LBL-DASH1              22923013
229240                                        PV-LBL-DASH2.             22924013
229250     MOVE PV-LBL-DATE               TO  PC250-LBL-PRT-DATE.       22925013
229260*TIME                                                             22926013
229270     MOVE PV-CURRENT-TIME           TO  PC250-LBL-PRT-TIME.       22927013
229280*                                                                 22928013
229290*LABEL DESC                                                       22929013
229300*    MOVE PC250-CI-CTL-STK-LBL      TO  PC250-SML-LBL-DESC.       22930013
229310*                                                                 22931013
229320*LABEL TYPE                                                       22932013
229330     IF LBPTDA-CART-LBL-TYP-CDE = 'C'                             22933013
229340        MOVE  PC250-CI-CTL-STK-LBL     TO  PC250-SML-LBL-DESC     22934013
229350        MOVE  PC250-ZONE-HDG-VALUE     TO  PC250-ZONE-STRG-HDG    22935013
229360        MOVE  LBPTDA-STR-ZN-ID         TO  PC250-ZONE-STRG-DESC   22936013
229370     ELSE                                                         22937013
229380     IF LBPTDA-CART-LBL-TYP-CDE = 'E'                             22938013
229390        MOVE  PC250-CI-E-COMM-LBL      TO  PC250-SML-LBL-DESC     22939013
229400        MOVE  PC250-STORAGE-HDG-VALUE  TO  PC250-ZONE-STRG-HDG    22940013
229410        IF    LBPTDA-STRG-AREA-CDE  > SPACES                      22941013
229420              MOVE LBPTDA-STRG-AREA-CDE TO PC250-ZONE-STRG-DESC   22942013
229430        ELSE                                                      22943013
229440              MOVE '@@@@@'  TO PC250-ZONE-STRG-DESC               22944013
229450        END-IF                                                    22945013
229460     END-IF                                                       22946013
229470     END-IF                                                       22947013
229480*ZONE                                                             22948013
229490     IF LBPTDA-CART-LBL-TYP-CDE = 'C'                             22949013
229500        MOVE LBPTDA-STR-ZN-ID          TO  PC250-ZONE-STRG-DESC   22950013
229510     ELSE                                                         22951013
229520        MOVE '@@@@@'                   TO  PC250-ZONE-STRG-DESC   22952013
229530     END-IF                                                       22953013
229540*                                                                 22954013
229550*RCVR                                                             22955013
229560     MOVE LBPTDA-PO-NBR             TO  PV-PO-NUMBER              22956013
229570                                        PV-BC-PO-NBR-BC           22957013
229580                                        PV-BC-PO-NBR              22958013
229590     MOVE LBPTDA-RCVR-SEQ-NBR       TO  PV-PO-RECEIVER.           22959013
229600     MOVE PV-PO-RCVR                TO  PC250-PO-RCVR-NBR.        22960013
229610*BARCODE                                                          22961013
229620         MOVE LBPTDA-BRCDE-NBR         TO  PV-2O-DIGIT-BARCODE    22962013
229630                                           PC250-SML-FORM-BC      22963013
229640         MOVE  PV-20-SML-CONTAINER-CDE                            22964013
229650           TO  PC160-20-SML-CONTAINER-CDE                         22965013
229660               PC160-20-SML-NBR-CONTAINER-CDE                     22966013
229670         MOVE  PV-20-SML-PACKAGING-TYP                            22967013
229680           TO  PC160-20-SML-PACKAGING-TYP                         22968013
229690               PC160-20-SML-NBR-PACKAGING-TYP                     22969013
229700         MOVE  PV-20-SML-SOFTWARE-SRC                             22970013
229710           TO  PC160-20-SML-SOFTWARE-SRC                          22971013
229720               PC160-20-SML-NBR-SOFTWARE-SRC                      22972013
229730         MOVE  PV-20-SML-BC-DIVERT                                22973013
229740           TO  PC160-20-SML-BC-DIVERT                             22974013
229750               PC160-20-SML-NBR-BC-DIVERT                         22975013
229760         MOVE  PV-20-SML-BC-DC-ORIGIN                             22976013
229770           TO  PC160-20-SML-BC-DC-ORIGIN                          22977013
229780               PC160-20-SML-NBR-BC-DC-ORIGIN                      22978013
229790         MOVE  PV-20-SML-BC-MNFST-NBR                             22979013
229800           TO  PC160-20-SML-BC-MNFST-NBR                          22980013
229810               PC160-20-SML-NBR-BC-MNFST-NBR                      22981013
229820*        SET   PC160-20-SML-BC-END-OF-TEXT                        22982013
229830*                                        TO TRUE                  22983013
229840         MOVE PC160-20-DIGIT-BARCODE-NBR TO PC250-SML-BC-NBR      22984013
229850                                                                  22985013
229860*                                                                 22986013
229870     MOVE  LBPTDA-ITM-NBR            TO PV-BC-ITEM-NBR-BC         22987013
229880                                        PV-BC-ITEM-NBR            22988013
229890     MOVE LBPTDA-OTPK-UNT-QTY                                     22989013
229900                                     TO PV-OTPK-QTY               22990013
229910     MOVE PV-OTPK-UNIT-QTY           TO PV-BC-UNITS-BC            22991013
229920                                           PV-BC-UNITS            22992013
229930                                           PC250-PACK-UNT         22993013
229940*GB 6/15/01******                                                 22994013
229950*        MOVE  PC205-PACK-UNT          TO PV-BC-UNITS-BC          22995013
229960*                                         PV-BC-UNITS             22996013
229970*****************                                                 22997013
229980         MOVE  PV-PO-ITM-UNITS-NBR     TO PC250-PO-ITM-UNITS      22998013
229990         MOVE  PV-PO-ITM-UNITS-BC      TO PC250-PO-ITM-UNITS-BC   22999013
230000*LINE NUMBER                                                      23000013
230010     MOVE LBPTDA-PO-LNE-NBR         TO  PV-LINE-NBR.              23001013
230020     MOVE PV-PO-LINE-NBR            TO  PC250-PO-LNE-NBR.         23002013
230030*                                                                 23003013
230040*SKU                                                              23004013
230050     MOVE XL001-DEPT-NBR-3CH        TO  PV-CS-DEPT.               23005013
230060     MOVE XL001-SUB-CL-NBR-2CH      to  PV-CS-CLASS-NBR.          23006013
230070     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU.                23007013
230080     MOVE PV-CS-SKU-NUMBER          TO  PC250-SKU-NBR.            23008013
230090                                                                  23009013
230100*SKU FOR RDM ITEM NUMBER BARCODE                                  23010013
230110     MOVE LBPTDA-SKU-NBR            TO  PV-CS-SKU-ONLY.           23011013
230120     MOVE PV-CS-SKU-NBR             TO  PC250-ITEM-NBR-BC.        23012013
230130     MOVE PV-CS-SKU-NBR             TO  PC250-ITEM-NBR-BC-NBR.    23013013
230140*STYLE                                                            23014013
230150     MOVE PV-VEND-STYL-NAME         TO  PC250-STYLE.              23015013
230160*                                                                 23016013
230170*INNER PACK UNITS                                                 23017013
230180                                                                  23018013
230190*OUTER PK UNTS                                                    23019013
230200     MOVE PC250-FORM-OTPK-HDG                                     23020013
230210                                TO  PC250-INPK-CONVY-TEXT         23021013
230220     MOVE LBPTDA-OTPK-UNT-QTY                                     23022013
230230                                TO PV-OTPK-QTY                    23023013
230240     MOVE PV-OTPK-UNIT-QTY                                        23024013
230250                                TO PC250-PACK-UNT                 23025013
230260*USER ID                                                          23026013
230270                                                                  23027013
230280     MOVE SU054-USER-ID             TO  PC250-USER-ID.            23028013
230290                                                                  23029013
230300*                                                                 23030013
230310     MOVE PC250-SHIP-MFST-LBL       TO                            23031013
230320                                        SU054-LABEL-DATA-FORMAT.  23032013
230330*                                                                 23033013
230340 8500-CALL-STORE-ON-HAND-MOD.                                     23034013
230350*                                                                 23035013
230360** added internal table to track paragraph execution time         23036013
230370** dmh 2014-12-22 - begin                                         23037013
230380*                                                                 23038013
230390     MOVE  '8500'  TO  PT-CURR-PARA.                              23039013
230400     IF  PS-BLD-INTERNAL-TABLE-YES                                23040013
230410         PERFORM 0200-INTERNAL-TABLE                              23041013
230420     ELSE                                                         23042013
230430         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       23043013
230440     END-IF.                                                      23044013
230450                                                                  23045013
230460*                                                                 23046013
230470** DMH 2014-12-22 - END                                           23047013
230480*                                                                 23048013
230490                                                                  23049013
230500     INITIALIZE XL088-ITEM-COMMAREA.                              23050013
230510     SET  XL088-ONHAND-YES        TO TRUE                         23051013
230520     MOVE PV-PO-NBR               TO XL088-KEY-PO                 23052013
230530     MOVE PV-RCVR-SEQ-NBR         TO XL088-KEY-REC-SEQ-NBR        23053013
230540     MOVE LBPTDA-DEST-OPER-UNT-ID TO XL088-KEY-STR-NBR            23054013
230550     MOVE SU054-DC-NUMBER         TO XL088-OPER-UNT-ID            23055013
230560                                                                  23056013
230570     SET XL088-BY-OTBND-CRTN TO TRUE                              23057013
230580     MOVE LBPTDA-BRCDE-NBR TO PV-OTBND-CRTN                       23058013
230590     MOVE PV-OTBND-SML     TO XL088-OTBND-CRTN                    23059013
230600                                                                  23060013
230610     CALL XL088-USER-PGM USING DFHEIBLK                           23061013
230620                               XL088-COMMAREA                     23062013
230630                               XL088-ITEM-COMMAREA.               23063013
230640                                                                  23064013
230650     EVALUATE TRUE                                                23065013
230660         WHEN XL088-SUCCESSFUL                                    23066013
230670             CONTINUE                                             23067013
230680         WHEN OTHER                                               23068013
230690                                                                  23069013
230700              INITIALIZE PV-CICS-MSG-AREA1                        23070013
230710              INITIALIZE PV-CICS-MSG-AREA2                        23071013
230720                                                                  23072013
230730              MOVE XL088-RETURN-SQLCODE TO PV-DISP-SQLCODE        23073013
230740              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             23074013
230750              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           23075013
230760              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        23076013
230770                                                                  23077013
230780              STRING  'SUKCS782 8500-'                            23078099
230790                      ' DC:'               PV-DISP-DC             23079013
230800                      ' B1:'               SU054-BAR-CODE-1       23080013
230810                      ' B2:'               SU054-BAR-CODE-2       23081013
230820                      ' B3:'               SU054-BAR-CODE-3       23082013
230830                                           DELIMITED BY SIZE      23083013
230840                                      INTO PV-CICS-MSG-AREA1      23084013
230850                                                                  23085013
230860              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23086013
230870              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     23087013
230880                                                                  23088013
230890              PERFORM 9999-WRITE-TO-CSSL                          23089013
230900                                                                  23090013
230910              STRING  'SUKCS782 '          SU054-KOHLS-SML        23091099
230920                      ' TRIP:'             PV-DISP-TRIP           23092013
230930                      ' DR:'               SU054-DOOR-NUMBER      23093013
230940                      ' USR:'              SU054-USER-ID          23094013
230950                      ' STA:'              PV-DISP-PNA-STA        23095013
230960                      ' SQL:'              PV-DISP-SQLCODE        23096013
230970                      ' store on hand module'                     23097013
230980                                           DELIMITED BY SIZE      23098013
230990                                      INTO PV-CICS-MSG-AREA2      23099013
231000                                                                  23100013
231010              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23101013
231020              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     23102013
231030                                                                  23103013
231040              PERFORM 9999-WRITE-TO-CSSL                          23104013
231050                                                                  23105013
231060              INITIALIZE PV-CICS-MSG-AREA3                        23106013
231070                                                                  23107013
231080              MOVE XL088-KEY-SKU         TO PV-DISP-SKU           23108013
231090              MOVE XL088-KEY-STR-NBR     TO PV-DISP-DEST-OPER     23109013
231100              MOVE XL088-ITEM-NBR        TO PV-DISP-ITM           23110013
231110              MOVE XL088-UPC-NBR         TO PV-DISP-UPC           23111013
231120              MOVE XL088-OPER-UNT-ID     TO PV-DISP-OPER          23112013
231130                                                                  23113013
231140              STRING 'SUKCS782 (XLKUT088)'                        23114099
231150                     ' METHOD:'        XL088-ITEM-ACCESS-METHOD   23115013
231160                     ' SKU:'           PV-DISP-SKU                23116013
231170                     ' STR:'           PV-DISP-DEST-OPER          23117013
231180                     ' ITM:'           PV-DISP-ITM                23118013
231190                     ' UPC:'           PV-DISP-UPC                23119013
231200                     ' OPER:'          PV-DISP-OPER               23120013
231210                                           DELIMITED BY SIZE      23121013
231220                                      INTO PV-CICS-MSG-AREA3      23122013
231230                                                                  23123013
231240              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23124013
231250              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     23125013
231260                                                                  23126013
231270              PERFORM 9999-WRITE-TO-CSSL                          23127013
231280                                                                  23128013
231290              INITIALIZE PV-CICS-MSG-AREA4                        23129013
231300                                                                  23130013
231310              MOVE XL088-OTBND-CRTN      TO PV-DISP-SML           23131013
231320              MOVE XL088-KEY-PO          TO PV-DISP-PO            23132013
231330              MOVE XL088-KEY-REC-SEQ-NBR TO PV-DISP-RCVR          23133013
231340              MOVE XL088-KEY-LNE-NBR     TO pv-disp-line          23134013
231350                                                                  23135013
231360              STRING 'SUKCS782 '                                  23136099
231370                     ' SML:'           PV-DISP-SML                23137013
231380                     ' PBS:'           XL088-PACK-BY-STORE-IND    23138013
231390                     ' OH:'            XL088-ONHAND-FLAG          23139013
231400                     ' PGM:'           XL088-CALLING-PROGRAM      23140013
231410                     ' PO:'            PV-DISP-PO                 23141013
231420                     '-'               PV-DISP-RCVR               23142013
231430                     '-'               pv-disp-line               23143013
231440                                           DELIMITED BY SIZE      23144013
231450                                      INTO PV-CICS-MSG-AREA4      23145013
231460                                                                  23146013
231470              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23147013
231480              MOVE PV-CICS-MSG-AREA4    TO PV-CICS-MSG-AREA-A     23148013
231490                                                                  23149013
231500              PERFORM 9999-WRITE-TO-CSSL                          23150013
231510                                                                  23151013
231520              INITIALIZE PV-CICS-MSG-AREA5                        23152013
231530                                                                  23153013
231540              MOVE XL088-ONHAND          TO PV-DISP-OH-QTY        23154013
231550                                                                  23155013
231560              STRING 'SUKCS782 '                                  23156099
231570                     ' OH:'            XL088-ONHAND-QTY-FLAG      23157013
231580                     ' MSG:'           XL088-PROCESS-MSG-IND      23158013
231590                     ' OH QTY:'        PV-DISP-OH-QTY             23159013
231600                     ' MSG CDE:'       XL088-PROCESS-MSG-CDE      23160013
231610                     ' MSG TXT:'       XL088-PROCESS-MESSAGE-TXT  23161013
231620                                           DELIMITED BY SIZE      23162013
231630                                      INTO PV-CICS-MSG-AREA5      23163013
231640                                                                  23164013
231650              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23165013
231660              MOVE PV-CICS-MSG-AREA5    TO PV-CICS-MSG-AREA-A     23166013
231670                                                                  23167013
231680              PERFORM 9999-WRITE-TO-CSSL                          23168013
231690                                                                  23169013
231700              INITIALIZE PV-CICS-MSG-AREA6                        23170013
231710                                                                  23171013
231720              MOVE XL088-RETURN-SQLCODE  TO PV-DISP-SQLCODE       23172013
231730                                                                  23173013
231740              STRING 'SUKCS782 '                                  23174099
231750                     ' 1ST:'           XL088-FIRST-STORE-RCPT-IND 23175013
231760                     ' RET SQL:'       XL088-RETURN-SQL           23176013
231770                     ' RET OH:'        XL088-RETURN-ONHAND        23177013
231780                     ' SQL:'           PV-DISP-SQLCODE            23178013
231790                                           DELIMITED BY SIZE      23179013
231800                                      INTO PV-CICS-MSG-AREA6      23180013
231810                                                                  23181013
231820              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23182013
231830              MOVE PV-CICS-MSG-AREA6    TO PV-CICS-MSG-AREA-A     23183013
231840                                                                  23184013
231850              PERFORM 9999-WRITE-TO-CSSL                          23185013
231860                                                                  23186013
231870              INITIALIZE PV-CICS-MSG-AREA7                        23187013
231880                                                                  23188013
231890              STRING 'SUKCS782 '                                  23189099
231900                     ' MSG:'           XL088-CRA-RET-MSG          23190013
231910                                           DELIMITED BY SIZE      23191013
231920                                      INTO PV-CICS-MSG-AREA6      23192013
231930                                                                  23193013
231940              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23194013
231950              MOVE PV-CICS-MSG-AREA7    TO PV-CICS-MSG-AREA-A     23195013
231960                                                                  23196013
231970              PERFORM 9999-WRITE-TO-CSSL                          23197013
231980                                                                  23198013
231990             SET PS-PROCESSING-ERROR-YES TO TRUE                  23199013
232000             PERFORM 9998-WRITE-TO-CSSL                           23200013
232010     END-EVALUATE.                                                23201013
232020                                                                  23202013
232030                                                                  23203013
232040*----------------------------------------------------------------*23204013
232050*                                                                *23205013
232060*                                                                *23206013
232070*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *23207013
232080*----------------------------------------------------------------*23208013
232090 8530-CHECK-AUDIT-CRT-PNDG.                                       23209013
232100*                                                                 23210013
232110** added internal table to track paragraph execution time         23211013
232120** dmh 2014-12-22 - begin                                         23212013
232130*                                                                 23213013
232140     MOVE  '8530'  TO  PT-CURR-PARA.                              23214013
232150     IF  PS-BLD-INTERNAL-TABLE-YES                                23215013
232160         PERFORM 0200-INTERNAL-TABLE                              23216013
232170     ELSE                                                         23217013
232180         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       23218013
232190     END-IF.                                                      23219013
232200                                                                  23220013
232210*                                                                 23221013
232220** DMH 2014-12-22 - END                                           23222013
232230*                                                                 23223013
232240                                                                  23224013
232250     MOVE LBPTDA-BRCDE-NBR     TO SULBXF-BRCDE-NBR.               23225013
232260                                                                  23226013
232270     EXEC SQL                                                     23227013
232280          SELECT C.AUD_CNTL_NBR                                   23228013
232290            INTO :SUATRN-AUD-CNTL-NBR                             23229013
232300            FROM TSULBXF A                                        23230013
232310               , TSUATRN B                                        23231013
232320               , SUT_PO_AUD_REQ C                                 23232013
232330           WHERE A.BRCDE_NBR        = :SULBXF-BRCDE-NBR           23233013
232340             AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID              23234013
232350             AND A.STAT_CDE         = 'A'                         23235013
232360             AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR              23236013
232370             AND B.UNT_AUD_STP_TMST = :PC-DEFAULT-TIME            23237013
232380             AND C.PKGNG_TYP_CDE  <> 'RF'                         23238013
232390     END-EXEC.                                                    23239013
232400                                                                  23240013
232410     EVALUATE TRUE                                                23241013
232420         WHEN SQLCODE = ZERO                                      23242013
232430         WHEN SQLCODE = -811                                      23243013
232440             SET PS-AUDIT-CARTON-PNDG-YES TO TRUE                 23244013
232450         WHEN SQLCODE = +100                                      23245013
232460             SET PS-AUDIT-CARTON-PNDG-NO TO TRUE                  23246013
232470         WHEN OTHER                                               23247013
232480                                                                  23248013
232490              INITIALIZE PV-CICS-MSG-AREA1                        23249013
232500              INITIALIZE PV-CICS-MSG-AREA2                        23250013
232510                                                                  23251013
232520              MOVE SQLCODE              TO PV-DISP-SQLCODE        23252013
232530              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             23253013
232540              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           23254013
232550              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        23255013
232560                                                                  23256013
232570              STRING  'SUKCS782 8530-'                            23257099
232580                      ' DC:'               PV-DISP-DC             23258013
232590                      ' B1:'               SU054-BAR-CODE-1       23259013
232600                      ' B2:'               SU054-BAR-CODE-2       23260013
232610                      ' B3:'               SU054-BAR-CODE-3       23261013
232620                                           DELIMITED BY SIZE      23262013
232630                                      INTO PV-CICS-MSG-AREA1      23263013
232640                                                                  23264013
232650              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23265013
232660              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     23266013
232670                                                                  23267013
232680              PERFORM 9999-WRITE-TO-CSSL                          23268013
232690                                                                  23269013
232700              STRING  'SUKCS782 '          SU054-KOHLS-SML        23270099
232710                      ' TRIP:'             PV-DISP-TRIP           23271013
232720                      ' DR:'               SU054-DOOR-NUMBER      23272013
232730                      ' USR:'              SU054-USER-ID          23273013
232740                      ' STA:'              PV-DISP-PNA-STA        23274013
232750                      ' SQL:'              PV-DISP-SQLCODE        23275013
232760                      ' TSULBXF/TSUATRN/SUT_PO_AUD_REQ'           23276013
232770                                           DELIMITED BY SIZE      23277013
232780                                      INTO PV-CICS-MSG-AREA2      23278013
232790                                                                  23279013
232800              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23280013
232810              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     23281013
232820                                                                  23282013
232830              PERFORM 9999-WRITE-TO-CSSL                          23283013
232840                                                                  23284013
232850              INITIALIZE PV-CICS-MSG-AREA3                        23285013
232860                                                                  23286013
232870              STRING 'SUKCS782 '                                  23287099
232880                     ' BARCODE:'       XL088-RETURN-SQLCODE       23288013
232890                                           DELIMITED BY SIZE      23289013
232900                                      INTO PV-CICS-MSG-AREA3      23290013
232910                                                                  23291013
232920              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23292013
232930              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     23293013
232940                                                                  23294013
232950              PERFORM 9999-WRITE-TO-CSSL                          23295013
232960                                                                  23296013
232970             SET PS-PROCESSING-ERROR-YES TO TRUE                  23297013
232980             PERFORM 9998-WRITE-TO-CSSL                           23298013
232990     END-EVALUATE.                                                23299013
233000                                                                  23300013
233010*----------------------------------------------------------------*23301013
233020*                                                                *23302013
233030*                                                                *23303013
233040*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *23304013
233050*----------------------------------------------------------------*23305013
233060 8535-CHECK-AUDIT-CRT-PNDG-RF.                                    23306013
233070*                                                                 23307013
233080** added internal table to track paragraph execution time         23308013
233090** dmh 2014-12-22 - begin                                         23309013
233100*                                                                 23310013
233110     MOVE  '8535'  TO  PT-CURR-PARA.                              23311013
233120     IF  PS-BLD-INTERNAL-TABLE-YES                                23312013
233130         PERFORM 0200-INTERNAL-TABLE                              23313013
233140     ELSE                                                         23314013
233150         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       23315013
233160     END-IF.                                                      23316013
233170                                                                  23317013
233180*                                                                 23318013
233190** DMH 2014-12-22 - END                                           23319013
233200*                                                                 23320013
233210                                                                  23321013
233220     MOVE LBPTDA-BRCDE-NBR     TO SULBXF-BRCDE-NBR.               23322013
233230                                                                  23323013
233240     EXEC SQL                                                     23324013
233250          SELECT C.AUD_CNTL_NBR                                   23325013
233260            INTO :SUATRN-AUD-CNTL-NBR                             23326013
233270            FROM TSULBXF A                                        23327013
233280               , TSUATRN B                                        23328013
233290               , SUT_PO_AUD_REQ C                                 23329013
233300           WHERE A.BRCDE_NBR        = :SULBXF-BRCDE-NBR           23330013
233310             AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID              23331013
233320             AND A.STAT_CDE         = 'A'                         23332013
233330             AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR              23333013
233340             AND B.UNT_AUD_STP_TMST = :PC-DEFAULT-TIME            23334013
233350             AND C.PKGNG_TYP_CDE  =  'RF'                         23335013
233360     END-EXEC.                                                    23336013
233370                                                                  23337013
233380     EVALUATE TRUE                                                23338013
233390         WHEN SQLCODE = ZERO                                      23339013
233400         WHEN SQLCODE = -811                                      23340013
233410             SET PS-AUDIT-CRTN-PNDG-RF-YES TO TRUE                23341013
233420         WHEN SQLCODE = +100                                      23342013
233430             SET PS-AUDIT-CRTN-PNDG-RF-NO TO TRUE                 23343013
233440         WHEN OTHER                                               23344013
233450                                                                  23345013
233460              INITIALIZE PV-CICS-MSG-AREA1                        23346013
233470              INITIALIZE PV-CICS-MSG-AREA2                        23347013
233480                                                                  23348013
233490              MOVE SQLCODE              TO PV-DISP-SQLCODE        23349013
233500              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             23350013
233510              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           23351013
233520              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        23352013
233530                                                                  23353013
233540              STRING  'SUKCS782 8535-'                            23354099
233550                      ' DC:'               PV-DISP-DC             23355013
233560                      ' B1:'               SU054-BAR-CODE-1       23356013
233570                      ' B2:'               SU054-BAR-CODE-2       23357013
233580                      ' B3:'               SU054-BAR-CODE-3       23358013
233590                                           DELIMITED BY SIZE      23359013
233600                                      INTO PV-CICS-MSG-AREA1      23360013
233610                                                                  23361013
233620              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23362013
233630              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     23363013
233640                                                                  23364013
233650              PERFORM 9999-WRITE-TO-CSSL                          23365013
233660                                                                  23366013
233670              STRING  'SUKCS782 '          SU054-KOHLS-SML        23367099
233680                      ' TRIP:'             PV-DISP-TRIP           23368013
233690                      ' DR:'               SU054-DOOR-NUMBER      23369013
233700                      ' USR:'              SU054-USER-ID          23370013
233710                      ' STA:'              PV-DISP-PNA-STA        23371013
233720                      ' SQL:'              PV-DISP-SQLCODE        23372013
233730                      ' TSULBXF/TSUATRN/SUT_PO_AUD_REQ'           23373013
233740                                           DELIMITED BY SIZE      23374013
233750                                      INTO PV-CICS-MSG-AREA2      23375013
233760                                                                  23376013
233770              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23377013
233780              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     23378013
233790                                                                  23379013
233800              PERFORM 9999-WRITE-TO-CSSL                          23380013
233810                                                                  23381013
233820              INITIALIZE PV-CICS-MSG-AREA3                        23382013
233830                                                                  23383013
233840              STRING 'SUKCS782 '                                  23384099
233850                     ' BARCODE:'       XL088-RETURN-SQLCODE       23385013
233860                                           DELIMITED BY SIZE      23386013
233870                                      INTO PV-CICS-MSG-AREA3      23387013
233880                                                                  23388013
233890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23389013
233900              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     23390013
233910                                                                  23391013
233920              PERFORM 9999-WRITE-TO-CSSL                          23392013
233930                                                                  23393013
233940             SET PS-PROCESSING-ERROR-YES TO TRUE                  23394013
233950             PERFORM 9998-WRITE-TO-CSSL                           23395013
233960     END-EVALUATE.                                                23396013
233970                                                                  23397013
233980                                                                  23398013
233990*----------------------------------------------------------------*23399013
234000*                                                                *23400013
234010*                                                                *23401013
234020*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *23402013
234030*----------------------------------------------------------------*23403013
234040 8550-CHECK-AUDIT-CRTN.                                           23404013
234050*                                                                 23405013
234060** added internal table to track paragraph execution time         23406013
234070** dmh 2014-12-22 - begin                                         23407013
234080*                                                                 23408013
234090     MOVE  '8550'  TO  PT-CURR-PARA.                              23409013
234100     IF  PS-BLD-INTERNAL-TABLE-YES                                23410013
234110         PERFORM 0200-INTERNAL-TABLE                              23411013
234120     ELSE                                                         23412013
234130         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       23413013
234140     END-IF.                                                      23414013
234150                                                                  23415013
234160*                                                                 23416013
234170** DMH 2014-12-22 - END                                           23417013
234180*                                                                 23418013
234190                                                                  23419013
234200     MOVE LBPTDA-BRCDE-NBR     TO SULBXF-BRCDE-NBR.               23420013
234210                                                                  23421013
234220     EXEC SQL                                                     23422013
234230          SELECT C.AUD_CNTL_NBR                                   23423013
234240            INTO :SUATRN-AUD-CNTL-NBR                             23424013
234250            FROM TSULBXF A                                        23425013
234260               , TSUATRN B                                        23426013
234270               , SUT_PO_AUD_REQ C                                 23427013
234280           WHERE A.BRCDE_NBR        = :SULBXF-BRCDE-NBR           23428013
234290             AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID              23429013
234300             AND A.STAT_CDE         = 'A'                         23430013
234310             AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR              23431013
234320     END-EXEC.                                                    23432013
234330                                                                  23433013
234340     EVALUATE TRUE                                                23434013
234350         WHEN SQLCODE = ZERO                                      23435013
234360*CLP 03/18/14 START                                               23436013
234370         WHEN SQLCODE = -811                                      23437013
234380*CLP 03/18/14 END                                                 23438013
234390             SET PC257-AUDIT-YES                                  23439013
234400                 PS-AUDIT-CARTON-FOUND-YES TO TRUE                23440013
234410         WHEN SQLCODE = +100                                      23441013
234420             SET PC257-AUDIT-NO                                   23442013
234430                 PS-AUDIT-CARTON-FOUND-NO  TO TRUE                23443013
234440         WHEN OTHER                                               23444013
234450                                                                  23445013
234460              INITIALIZE PV-CICS-MSG-AREA1                        23446013
234470              INITIALIZE PV-CICS-MSG-AREA2                        23447013
234480                                                                  23448013
234490              MOVE SQLCODE              TO PV-DISP-SQLCODE        23449013
234500              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             23450013
234510              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           23451013
234520              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        23452013
234530                                                                  23453013
234540              STRING  'SUKCS782 8550-'                            23454099
234550                      ' DC:'               PV-DISP-DC             23455013
234560                      ' B1:'               SU054-BAR-CODE-1       23456013
234570                      ' B2:'               SU054-BAR-CODE-2       23457013
234580                      ' B3:'               SU054-BAR-CODE-3       23458013
234590                                           DELIMITED BY SIZE      23459013
234600                                      INTO PV-CICS-MSG-AREA1      23460013
234610                                                                  23461013
234620              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23462013
234630              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     23463013
234640                                                                  23464013
234650              PERFORM 9999-WRITE-TO-CSSL                          23465013
234660                                                                  23466013
234670              STRING  'SUKCS782 '          SU054-KOHLS-SML        23467099
234680                      ' TRIP:'             PV-DISP-TRIP           23468013
234690                      ' DR:'               SU054-DOOR-NUMBER      23469013
234700                      ' USR:'              SU054-USER-ID          23470013
234710                      ' STA:'              PV-DISP-PNA-STA        23471013
234720                      ' SQL:'              PV-DISP-SQLCODE        23472013
234730                      ' TSULBXF/TSUATRN/SUT_PO_AUD_REQ'           23473013
234740                                           DELIMITED BY SIZE      23474013
234750                                      INTO PV-CICS-MSG-AREA2      23475013
234760                                                                  23476013
234770              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23477013
234780              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     23478013
234790                                                                  23479013
234800              PERFORM 9999-WRITE-TO-CSSL                          23480013
234810                                                                  23481013
234820              INITIALIZE PV-CICS-MSG-AREA3                        23482013
234830                                                                  23483013
234840              STRING 'SUKCS782 '                                  23484099
234850                     ' BARCODE:'       XL088-RETURN-SQLCODE       23485013
234860                                           DELIMITED BY SIZE      23486013
234870                                      INTO PV-CICS-MSG-AREA3      23487013
234880                                                                  23488013
234890              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23489013
234900              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     23490013
234910                                                                  23491013
234920              PERFORM 9999-WRITE-TO-CSSL                          23492013
234930                                                                  23493013
234940             SET PS-PROCESSING-ERROR-YES TO TRUE                  23494013
234950             PERFORM 9998-WRITE-TO-CSSL                           23495013
234960     END-EVALUATE.                                                23496013
234970                                                                  23497013
234980* JAK WR41309 - ADD PARAGRAPHS 8600 AND 8700                      23498013
234990*----------------------------------------------------------------*23499013
235000* INSERT ROW TO SUT_PRC_MSG_CNTL TO INDICATE AN RFID CARTON      *23500013
235010*----------------------------------------------------------------*23501013
235020 8600-INSERT-PROCESS-MSG.                                         23502013
235030*                                                                 23503013
235040** added internal table to track paragraph execution time         23504013
235050** dmh 2014-12-22 - begin                                         23505013
235060*                                                                 23506013
235070     MOVE  '8600'  TO  PT-CURR-PARA.                              23507013
235080     IF  PS-BLD-INTERNAL-TABLE-YES                                23508013
235090         PERFORM 0200-INTERNAL-TABLE                              23509013
235100     ELSE                                                         23510013
235110         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       23511013
235120     END-IF.                                                      23512013
235130                                                                  23513013
235140*                                                                 23514013
235150** DMH 2014-12-22 - END                                           23515013
235160*                                                                 23516013
235170                                                                  23517013
235180     MOVE SUT00024-SHIPT-UNT-ID TO SUT00094-SHIPT-UNT-ID          23518013
235190     MOVE PV-STORE-N            TO SUT00094-DEST-LOC-NBR          23519013
235200     IF SU093-PRINT-RFID                                          23520061
235210        MOVE 'RD'               TO SUT00094-PRC-MSG-CDE           23521061
235220     ELSE                                                         23522061
235230        IF SU093-PRINT-EAS                                        23523061
235240           MOVE 'EA'            TO SUT00094-PRC-MSG-CDE           23524061
235250        ELSE                                                      23525061
235260           IF SU093-PRINT-RFID-EAS                                23526061
235270              MOVE 'RE'         TO SUT00094-PRC-MSG-CDE           23527061
235280           END-IF                                                 23528061
235290        END-IF                                                    23529061
235300     END-IF                                                       23530061
235310     MOVE PV-PO-NBR             TO SUT00094-PO-NBR                23531019
235320     MOVE PV-PO-LINE-NBR        TO SUT00094-RCVR-LNE-NBR          23532013
235330     MOVE PV-RCVR-SEQ-NBR       TO SUT00094-RCVR-SEQ-NBR          23533013
235340                                                                  23534013
235350     EXEC SQL                                                     23535013
235360         INSERT INTO SUT_PRC_MSG_CNTL                             23536013
235370               (PO_NBR                                            23537013
235380              , RCVR_LNE_NBR                                      23538013
235390              , RCVR_SEQ_NBR                                      23539013
235400              , DEST_LOC_NBR                                      23540013
235410              , SHIPT_UNT_ID                                      23541013
235420              , CRE_TMST                                          23542013
235430              , PRC_MSG_CDE )                                     23543013
235440         VALUES                                                   23544013
235450              (:SUT00094-PO-NBR                                   23545013
235460             , :SUT00094-RCVR-LNE-NBR                             23546013
235470             , :SUT00094-RCVR-SEQ-NBR                             23547013
235480             , :SUT00094-DEST-LOC-NBR                             23548013
235490             , :SUT00094-SHIPT-UNT-ID                             23549013
235500             ,  CURRENT TIMESTAMP                                 23550013
235510             , :SUT00094-PRC-MSG-CDE )                            23551013
235520     END-EXEC.                                                    23552013
235530                                                                  23553013
235540     EVALUATE TRUE                                                23554013
235550         WHEN SQLCODE = ZERO                                      23555013
235560         WHEN SQLCODE = -803                                      23556013
235570             CONTINUE                                             23557013
235580         WHEN SQLWARN0 NOT = SPACES                               23558013
235590         WHEN SQLCODE < ZERO                                      23559013
235600         WHEN SQLCODE > ZERO                                      23560013
235610                                                                  23561013
235620              INITIALIZE PV-CICS-MSG-AREA1                        23562013
235630              INITIALIZE PV-CICS-MSG-AREA2                        23563013
235640                                                                  23564013
235650              MOVE SQLCODE              TO PV-DISP-SQLCODE        23565013
235660              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             23566013
235670              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           23567013
235680              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        23568013
235690                                                                  23569013
235700              STRING  'SUKCS782 8600-'                            23570099
235710                      ' DC:'               PV-DISP-DC             23571013
235720                      ' B1:'               SU054-BAR-CODE-1       23572013
235730                      ' B2:'               SU054-BAR-CODE-2       23573013
235740                      ' B3:'               SU054-BAR-CODE-3       23574013
235750                                           DELIMITED BY SIZE      23575013
235760                                      INTO PV-CICS-MSG-AREA1      23576013
235770                                                                  23577013
235780              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23578013
235790              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     23579013
235800                                                                  23580013
235810              PERFORM 9999-WRITE-TO-CSSL                          23581013
235820                                                                  23582013
235830              STRING  'SUKCS782 '          SU054-KOHLS-SML        23583099
235840                      ' TRIP:'             PV-DISP-TRIP           23584013
235850                      ' DR:'               SU054-DOOR-NUMBER      23585013
235860                      ' USR:'              SU054-USER-ID          23586013
235870                      ' STA:'              PV-DISP-PNA-STA        23587013
235880                      ' SQL:'              PV-DISP-SQLCODE        23588013
235890                      ' SUT_PRC_MSG_CNTL - INSERT'                23589013
235900                                           DELIMITED BY SIZE      23590013
235910                                      INTO PV-CICS-MSG-AREA2      23591013
235920                                                                  23592013
235930              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23593013
235940              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     23594013
235950                                                                  23595013
235960              PERFORM 9999-WRITE-TO-CSSL                          23596013
235970                                                                  23597013
235980              INITIALIZE PV-CICS-MSG-AREA3                        23598013
235990                                                                  23599013
236000              MOVE SUT00094-PO-NBR       TO PV-DISP-PO            23600013
236010              MOVE SUT00094-RCVR-LNE-NBR TO PV-DISP-LINE          23601013
236020              MOVE SUT00094-RCVR-SEQ-NBR TO PV-DISP-RCVR          23602013
236030              MOVE SUT00094-DEST-LOC-NBR TO PV-DISP-DEST-OPER     23603013
236040              MOVE SUT00094-SHIPT-UNT-ID TO PV-DISP-SML           23604013
236050                                                                  23605013
236060              STRING 'SUKCS782 '                                  23606099
236070                     ' PO:'            PV-DISP-PO                 23607013
236080                     '-'               PV-DISP-RCVR               23608013
236090                     '-'               PV-DISP-LINE               23609013
236100                     ' DEST:'          PV-DISP-DEST-OPER          23610013
236110                     ' SML:'           PV-DISP-SML                23611013
236120                     'MSG CDE:'       SUT00094-PRC-MSG-CDE        23612013
236130                                           DELIMITED BY SIZE      23613013
236140                                      INTO PV-CICS-MSG-AREA3      23614013
236150                                                                  23615013
236160              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23616013
236170              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     23617013
236180                                                                  23618013
236190              PERFORM 9999-WRITE-TO-CSSL                          23619013
236200                                                                  23620013
236210             SET PS-PROCESSING-ERROR-YES TO TRUE                  23621013
236220             PERFORM 9998-WRITE-TO-CSSL                           23622013
236230                                                                  23623013
236240     END-EVALUATE.                                                23624013
236250                                                                  23625013
236260*----------------------------------------------------------------*23626013
236270* DETERMINE IF CARTON IS RFID                                    *23627013
236280*                                                                *23628013
236290*  2014-12-03 - DMH - Added "WITH UR" to SQL                     *23629013
236300*                     Added "FETCH FIRST 1 ROW" program is only  *23630013
236310*                     checking for existence of                  *23631013
236320*----------------------------------------------------------------*23632013
236330 8700-COUNT-MSG-RD.                                               23633013
236340*                                                                 23634013
236350** added internal table to track paragraph execution time         23635013
236360** dmh 2014-12-22 - begin                                         23636013
236370*                                                                 23637013
236380     MOVE  '8700'  TO  PT-CURR-PARA.                              23638013
236390     IF  PS-BLD-INTERNAL-TABLE-YES                                23639013
236400         PERFORM 0200-INTERNAL-TABLE                              23640013
236410     ELSE                                                         23641013
236420         PERFORM 0202-BUILD-MESSAGE-DISPLAY                       23642013
236430     END-IF.                                                      23643013
236440                                                                  23644013
236450     EXEC SQL                                                     23645061
236460         SELECT DISTINCT (PRC_MSG_CDE)                            23646061
236470         INTO :PV-PRC-MSG-CDE                                     23647061
236480         FROM SUT_PRC_MSG_CNTL                                    23648061
236490         WHERE SHIPT_UNT_ID = :SUT00094-SHIPT-UNT-ID              23649061
236500           AND PRC_MSG_CDE IN ('RD', 'RE', 'EA')                  23650061
236510         FETCH FIRST 1 ROW ONLY                                   23651061
236520          with ur                                                 23652064
236530     END-EXEC.                                                    23653061
236540                                                                  23654061
236550     EVALUATE TRUE                                                23655061
236560         WHEN SQLCODE = ZERO                                      23656061
236570             CONTINUE                                             23657061
236580         WHEN SQLCODE = +100                                      23658061
236590         WHEN SQLWARN0 NOT = SPACES                               23659061
236600         WHEN SQLCODE < ZERO                                      23660061
236610         WHEN SQLCODE > ZERO                                      23661061
236620             MOVE '8700-COUNT-MSG-RD'                             23662061
236630                             TO DP013-PARAGRAPH                   23663061
236640             MOVE 'SUKCS782 - CHECK RFID LBL PARM'                23664099
236650                             TO DP013-MESSAGE-TEXT(1)             23665061
236660             MOVE LBVRDA-DEST-OPER-UNT-ID                         23666061
236670                             TO DP013-MESSAGE-TEXT(2)             23667061
236680             MOVE SUT00094-SHIPT-UNT-ID                           23668061
236690                             TO PV-DISP-SSCC                      23669061
236700             MOVE PV-DISP-SSCC TO DP013-MESSAGE-TEXT(3)           23670061
236710             MOVE SQLCA      TO DP013-SQLCA                       23671061
236720             MOVE 'SUT_PRC_MSG_CNTL'                              23672063
236730                             TO DP013-DB2-TABLE-NAME(1)           23673063
236740             SET DP013-DB2-ABEND                                  23674061
236750                             TO TRUE                              23675061
236760             SET DP013-ROLLBACK                                   23676061
236770                             TO TRUE                              23677061
236780             SET DP013-XCTL-DISPLAY-RESTART                       23678061
236790                             TO TRUE                              23679061
236800*            PERFORM DP014-0000-PROCESS-ABEND                     23680061
236810     END-EVALUATE.                                                23681061
236820                                                                  23682063
236830     EVALUATE TRUE                                                23683061
236840         WHEN SQLCODE = ZERO                                      23684061
236850         when SQLCODE = -811                                      23685061
236860            IF PV-RD-COUNT > 0                                    23686061
236870              SET PS-RF-ID-FOUND-YES TO TRUE                      23687061
236880            ELSE                                                  23688061
236890              SET PS-RF-ID-FOUND-NO  TO TRUE                      23689061
236900            END-IF                                                23690061
236910         WHEN SQLCODE = +100                                      23691061
236920              SET PS-RF-ID-FOUND-NO  TO TRUE                      23692061
236930         WHEN OTHER                                               23693061
236940                                                                  23694061
236950              INITIALIZE PV-CICS-MSG-AREA1                        23695061
236960              INITIALIZE PV-CICS-MSG-AREA2                        23696061
236970                                                                  23697061
236980              MOVE SQLCODE              TO PV-DISP-SQLCODE        23698061
236990              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             23699061
237000              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           23700061
237010              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        23701061
237020                                                                  23702061
237030              STRING  'SUKCS782 8700-'                            23703099
237040                      ' DC:'               PV-DISP-DC             23704061
237050                      ' B1:'               SU054-BAR-CODE-1       23705061
237060                      ' B2:'               SU054-BAR-CODE-2       23706061
237070                      ' B3:'               SU054-BAR-CODE-3       23707061
237080                                           DELIMITED BY SIZE      23708061
237090                                      INTO PV-CICS-MSG-AREA1      23709061
237100                                                                  23710061
237110              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23711061
237120              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     23712061
237130                                                                  23713061
237140              PERFORM 9999-WRITE-TO-CSSL                          23714061
237150                                                                  23715061
237160              STRING  'SUKCS782 '          SU054-KOHLS-SML        23716099
237170                      ' TRIP:'             PV-DISP-TRIP           23717061
237180                      ' DR:'               SU054-DOOR-NUMBER      23718061
237190                      ' USR:'              SU054-USER-ID          23719061
237200                      ' STA:'              PV-DISP-PNA-STA        23720061
237210                      ' SQL:'              PV-DISP-SQLCODE        23721061
237220                      ' SUT_PRC_MSG_CNTL - SELECT'                23722061
237230                                           DELIMITED BY SIZE      23723061
237240                                      INTO PV-CICS-MSG-AREA2      23724061
237250                                                                  23725061
237260              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23726061
237270              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     23727061
237280                                                                  23728061
237290              PERFORM 9999-WRITE-TO-CSSL                          23729061
237300                                                                  23730061
237310              INITIALIZE PV-CICS-MSG-AREA3                        23731061
237320                                                                  23732061
237330              MOVE SUT00094-SHIPT-UNT-ID tO PV-DISP-SML           23733061
237340                                                                  23734061
237350              STRING 'SUKCS782 '                                  23735099
237360                     ' SML:'           PV-DISP-SML                23736061
237370                                           DELIMITED BY SIZE      23737061
237380                                      INTO PV-CICS-MSG-AREA3      23738061
237390                                                                  23739061
237400              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23740061
237410              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     23741061
237420                                                                  23742061
237430              PERFORM 9999-WRITE-TO-CSSL                          23743061
237440                                                                  23744061
237450             SET PS-PROCESSING-ERROR-YES TO TRUE                  23745061
237460             PERFORM 9998-WRITE-TO-CSSL                           23746061
237470     END-EVALUATE.                                                23747061
237480                                                                  23748061
237490*                                                                 23749013
237500** DMH 2014-12-22 - END                                           23750013
237510*                                                                 23751013
237520         MOVE LBPTDA-BRCDE-NBR       TO PV-BAR-CODE.              23752013
237530         MOVE PV-BAR-CODE-OTBND      TO SUT00094-SHIPT-UNT-ID     23753013
237540         EXEC SQL                                                 23754013
237550              SELECT COUNT(*)                                     23755013
237560         INTO   :PV-RD-COUNT                                      23756013
237570                FROM SUT_PRC_MSG_CNTL                             23757013
237580               WHERE SHIPT_UNT_ID = :SUT00094-SHIPT-UNT-ID        23758013
237590                 AND PRC_MSG_CDE  ='RD'                           23759013
237600               FETCH FIRST 1 ROW ONLY                             23760013
237610         END-EXEC                                                 23761013
237620                                                                  23762013
237630     EVALUATE TRUE                                                23763013
237640         WHEN SQLCODE = ZERO                                      23764013
237650         when SQLCODE = -811                                      23765013
237660            IF PV-RD-COUNT > 0                                    23766013
237670              SET PS-RF-ID-FOUND-YES TO TRUE                      23767013
237680            ELSE                                                  23768013
237690              SET PS-RF-ID-FOUND-NO  TO TRUE                      23769013
237700            END-IF                                                23770013
237710         WHEN SQLCODE = +100                                      23771013
237720              SET PS-RF-ID-FOUND-NO  TO TRUE                      23772013
237730         WHEN OTHER                                               23773013
237740                                                                  23774013
237750              INITIALIZE PV-CICS-MSG-AREA1                        23775013
237760              INITIALIZE PV-CICS-MSG-AREA2                        23776013
237770                                                                  23777013
237780              MOVE SQLCODE              TO PV-DISP-SQLCODE        23778013
237790              MOVE SU054-DC-NUMBER      TO PV-DISP-DC             23779013
237800              MOVE SU054-TRIP-ID        TO PV-DISP-TRIP           23780013
237810              MOVE SU054-ACCM-LINE-NMBR TO PV-DISP-PNA-STA        23781013
237820                                                                  23782013
237830              STRING  'SUKCS782 8700-'                            23783099
237840                      ' DC:'               PV-DISP-DC             23784013
237850                      ' B1:'               SU054-BAR-CODE-1       23785013
237860                      ' B2:'               SU054-BAR-CODE-2       23786013
237870                      ' B3:'               SU054-BAR-CODE-3       23787013
237880                                           DELIMITED BY SIZE      23788013
237890                                      INTO PV-CICS-MSG-AREA1      23789013
237900                                                                  23790013
237910              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23791013
237920              MOVE PV-CICS-MSG-AREA1    TO PV-CICS-MSG-AREA-A     23792013
237930                                                                  23793013
237940              PERFORM 9999-WRITE-TO-CSSL                          23794013
237950                                                                  23795013
237960              STRING  'SUKCS782 '          SU054-KOHLS-SML        23796099
237970                      ' TRIP:'             PV-DISP-TRIP           23797013
237980                      ' DR:'               SU054-DOOR-NUMBER      23798013
237990                      ' USR:'              SU054-USER-ID          23799013
238000                      ' STA:'              PV-DISP-PNA-STA        23800013
238010                      ' SQL:'              PV-DISP-SQLCODE        23801013
238020                      ' SUT_PRC_MSG_CNTL - SELECT'                23802013
238030                                           DELIMITED BY SIZE      23803013
238040                                      INTO PV-CICS-MSG-AREA2      23804013
238050                                                                  23805013
238060              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23806013
238070              MOVE PV-CICS-MSG-AREA2    TO PV-CICS-MSG-AREA-A     23807013
238080                                                                  23808013
238090              PERFORM 9999-WRITE-TO-CSSL                          23809013
238100                                                                  23810013
238110              INITIALIZE PV-CICS-MSG-AREA3                        23811013
238120                                                                  23812013
238130              MOVE SUT00094-SHIPT-UNT-ID tO PV-DISP-SML           23813013
238140                                                                  23814013
238150              STRING 'SUKCS782 '                                  23815099
238160                     ' SML:'           PV-DISP-SML                23816013
238170                                           DELIMITED BY SIZE      23817013
238180                                      INTO PV-CICS-MSG-AREA3      23818013
238190                                                                  23819013
238200              MOVE SPACES               TO PV-CICS-MSG-AREA-A     23820013
238210              MOVE PV-CICS-MSG-AREA3    TO PV-CICS-MSG-AREA-A     23821013
238220                                                                  23822013
238230              PERFORM 9999-WRITE-TO-CSSL                          23823013
238240                                                                  23824013
238250             SET PS-PROCESSING-ERROR-YES TO TRUE                  23825013
238260             PERFORM 9998-WRITE-TO-CSSL                           23826013
238270     END-EVALUATE.                                                23827013
238280                                                                  23828013
238290* JAK WR41309 - END                                               23829013
238300                                                                  23830013
238310                                                                  23831013
238320*------------------------------------------------------------*    23832013
238330* DISPLAY 2 LINE ERROR MESSAGE IN CSSL                       *    23833013
238340* THEN REQUEST ERROR LABEL TO BE CREATED                     *    23834013
238350*------------------------------------------------------------*    23835013
238360 9998-WRITE-TO-CSSL.                                              23836013
238370                                                                  23837013
238380     IF PS-PROCESSING-ERROR-YES                                   23838013
238390        PERFORM 5005-PRINT-MESSAGE-LABELS                         23839013
238400     END-IF.                                                      23840013
238410                                                                  23841013
238420                                                                  23842013
238430*------------------------------------------------------------*    23843013
238440* DISPLAY 1 LINE ERROR MESSAGE IN CSSL                       *    23844013
238450*------------------------------------------------------------*    23845013
238460 9999-WRITE-TO-CSSL.                                              23846013
238470      MOVE LENGTH OF PV-CICS-MSG-AREA-A                           23847013
238480                              TO PV-COMMAREA-LENGTH               23848013
238490      EXEC CICS                                                   23849013
238500          WRITEQ TD                                               23850013
238510              QUEUE   ('CSSL')                                    23851013
238520              FROM    (PV-CICS-MSG-AREA-A)                        23852013
238530              LENGTH  (PV-COMMAREA-LENGTH)                        23853013
238540              RESP    (PV-CICS-RESPONSE)                          23854013
238550      END-EXEC.                                                   23855013
