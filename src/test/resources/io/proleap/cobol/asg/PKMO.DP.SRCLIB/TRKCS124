000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    TRKCS124.                                         00040000
000500 AUTHOR.        STEPHANIE HERON.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  MAY 1995.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    Z124 - UPDATE FORECAST SHIPMENT                             *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO UPDATE A  FORECAST SHIPMENT *00120000
001300*    ON THE SYSTEM.                                              *00130000
001400*                                                                *00140000
001500*    THE USER MAY INQUIRE ON THE PO TO OBTAIN THE PO STATUS      *00150000
001600*    BEFORE UPDATING THE INFORMATION.                            *00160000
001700*----------------------------------------------------------------*00170000
001800* CHANGED 12-02-2011 CHRSITINE TWIEHAUS      WR40574              00180000
001900*         ADDED CARR-AUTH-ID                                      00190000
002000*---------------------------------------------------------------* 00200000
002010* CHANGED 10-29-2014 CHERI PARMLEY           CHG0094517           00201005
002020*         RE-COMPILE DUE TO TRWS001 COPYBOOK CHANGE WITH PO#      00202003
002021*         COMMENT PV-TEMP-PO-NBR NOT BEING USED                   00202103
002030*---------------------------------------------------------------* 00203003
273427* CHANGED 08-17-2022 BARB SCHULTZ            CHG0273427           00204008
273427*    CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE  00205008
273427*    MAKING THE CALL DYNAMIC VS STATIC.                           00206008
002030*---------------------------------------------------------------* 00207007
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00208009
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00209009
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00209109
CICS  *-----------------------------------------------------------------00209209
002100                                                                  00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500                                                                  00250000
002600                                                                  00260000
002700 WORKING-STORAGE SECTION.                                         00270000
002800                                                                  00280000
002900 01  DK-DB2-KEYS.                                                 00290000
003000     05  DK-OPERATING-COMPANY           PIC  X(02)  VALUE SPACE.  00300000
003100     05  DK-APLSYS-CDE                  PIC  X(02)  VALUE SPACE.  00310000
003200     05  DK-SCAC-ID                     PIC  X(04)  VALUE SPACE.  00320000
003300     05  DK-VEH-NBR                     PIC  X(10) VALUE SPACES.  00330000
003400     05  DK-TRIP-ID                     PIC  S9(9)  COMP VALUE +0.00340000
003500     05  DK-SHIPT-ID                    PIC  S9(9)  COMP VALUE +0.00350000
003600     05  DK-PRO-NBR                     PIC X(22).                00360000
003700     05  DK-BOL-NBR                     PIC X(30).                00370000
003800     05  DK-PO-NBR                PIC S9(9)   VALUE +0 COMP.      00380000
003900     05  DK-PO-CARTON-CNT         PIC S9(4)   VALUE +0 COMP.      00390000
004000     05  DK-FB-CARTON-CNT         PIC S9(4)   VALUE +0 COMP.      00400000
004100     05  DK-SCAC                  PIC X(04).                      00410000
004200     05  DK-ORIG-SCAC             PIC X(04).                      00420000
004300     05  DK-PRO-SCAC              PIC X(04).                      00430000
004400     05  DK-PRO-SCAC-ID           PIC X(04).                      00440000
004500*                                                                 00450000
004600 01  DN-DB2-NULL-INDICATORS.                                      00460000
004700     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00470000
004800     05  DN-EST-AR-TMST               PIC S9(04) COMP VALUE +0.   00480000
004900     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   00490000
005000     05  DN-CURR-TRIP-ID              PIC S9(04) COMP VALUE +0.   00500000
005100*                                                                 00510000
005200 01  PC-PROGRAM-CONSTANTS.                                        00520000
005300     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'TR124A  '.  00530000
005400     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'TRKM124 '.  00540000
005500     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'TRKCS124'.  00550000
005600     05  PC-RANDNBR-PGM                 PIC X(08)   VALUE         00560000
005700                                                    'DPKUT902'.   00570004
006000     05  PC-RCKUT023                    PIC X(08)   VALUE         00600000
006100         'RCKUT023'.                                              00610000
006200     05  PC-DEFAULT-DATE                PIC  X(10)  VALUE         00620000
006300                                                    '0001-01-01'. 00630000
006400     05  PC-DEFAULT-DATE-RDF            PIC  X(10)  VALUE         00640000
006500                                                    '01/01/0001'. 00650000
006600     05  PC-DEFAULT-TIME                PIC  X(08)  VALUE         00660000
006700                                                    '00.00.00'.   00670000
006800     05  PC-DEFAULT-TIMEHHMN            PIC  X(05)  VALUE         00680000
006900                                                    '00.00'.      00690000
007000     05  PC-DEFAULT-TMST                PIC  X(26)  VALUE         00700000
007100                                   '0001-01-01-00.00.00.000000'.  00710000
007200     05  PC-ACTIVE                PIC X(01)   VALUE 'A'.          00720000
007300     05  PC-PO-ACTIVE             PIC X(02)   VALUE 'AC'.         00730000
007400     05  PC-APPROVED              PIC X(02)   VALUE 'AP'.         00740000
007500     05  PC-CANCELLED             PIC X(02)   VALUE 'CA'.         00750000
007600     05  PC-CANBALENCE            PIC X(02)   VALUE 'CB'.         00760000
007700     05  PC-COMPLETE              PIC X(02)   VALUE 'CM'.         00770000
007800     05  PC-Y                     PIC X(1)    VALUE 'Y'.          00780000
007900     05  PC-24                    PIC 9(02)   VALUE 24.           00790000
008000     05  PC-59                    PIC 9(02)   VALUE 59.           00800000
008100     05  PC-19                    PIC X(02)   VALUE '19'.         00810000
008200     05  PC-20                    PIC X(02)   VALUE '20'.         00820000
008300     05  PC-01                    PIC X(02)   VALUE '01'.         00830000
008400     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00840000
008500                                              COMP.               00850000
008600     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE  +3           00860000
008700                                              COMP.               00870000
008800     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE +1            00880000
008900                                              COMP.               00890000
009000     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00900000
009100     05  PC-VALID-VND-DT-RANGE    PIC 9(05)   VALUE 7.            00910000
009200     05  PC-INTER-APPL-CODES.                                     00920000
009300         10  PC-INTER-APPL-CRIT-SPEC   PIC X(01)  VALUE '1'.      00930000
009400         10  PC-INTER-APPL-ADD-SCREEN  PIC X(01)  VALUE '2'.      00940000
009500         10  PC-INTER-APPL-SHIP-LIST   PIC X(01)  VALUE '3'.      00950000
009600     05  PC-TSYMSG-NUMBERS.                                       00960000
009700         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00970000
009800*   INVALID VALUE                                                 00980000
009900         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00990000
010000*   PRESS F2 TO CONFIRM                                           01000000
010100         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       01010000
010200*   REQUIRED ENTRY                                                01020000
010300         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       01030000
010400*   MUST BE NUMERIC                                               01040000
010500         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       01050000
010600*   INVALID DATE                                                  01060000
010700         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       01070000
010800*   INVALID FUNCTION KEY                                          01080000
010900         10  PC-TSYMSG-00046      PIC  9(05)  VALUE  00046.       01090000
011000*   DATA HAS NOT CHANGED, NO UPDATE PERFORMED                     01100000
011100         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       01110000
011200*   UPDATE(S) SUCCESSFUL                                          01120000
011300         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       01130000
011400*   BOTTOM OF LIST                                                01140000
011500         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       01150000
011600*   DATA DOES NOT EXIST                                           01160000
011700         10  PC-TSYMSG-00991      PIC  9(05)  VALUE  00991.       01170000
011800*   PLEASE ENTER THE FREIGHT BILL OR BILL OF LADING NUMBER        01180000
011900         10  PC-TSYMSG-00992      PIC  9(05)  VALUE  00992.       01190000
012000*   SHIPMENT EXIST WITH A STATUS OF &VAR                          01200000
012100         10  PC-TSYMSG-00997      PIC  9(05)  VALUE  00997.       01210000
012200*   SCAC REQUIRED WHEN FREIGHT BILL ENTERED                       01220000
012300         10  PC-TSYMSG-01004      PIC  9(05)  VALUE  01004.       01230000
012400*   INVALID OPERATING UNIT/FACILITY ID ENTERED                    01240000
012500         10  PC-TSYMSG-01014      PIC  9(05)  VALUE  01014.       01250000
012600*   SCAC,FREIGHT BILL AND/OR BILL OF LADING ARE REQUIRED          01260000
012700         10  PC-TSYMSG-01015      PIC  9(05)  VALUE  01015.       01270000
012800*   VEHICLE HAS A STATUS OF &VAR                                  01280000
012900         10  PC-TSYMSG-01016      PIC  9(05)  VALUE  01016.       01290000
013000*   FORECAST SHIPMENT DOES NOT EXIST.                             01300000
013100         10  PC-TSYMSG-01039      PIC  9(05)  VALUE  01039.       01310000
013200*   UPDATE SUCCESSFUL - SHIPMENT NOT ADDED TO TRLR DUE TO ETA RANG01320000
013300         10  PC-TSYMSG-01838      PIC  9(05)  VALUE  01838.       01330000
013400*   DATE OUTSIDE RECOMMENDED RANGE - PRESS F2 TO CONFIRM          01340000
013500                                                                  01350000
013600 01  PS-PROGRAM-SWITCHES.                                         01360000
013700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01370000
013800         88  PS-ERROR                         VALUE  'Y'.         01380000
013900         88  PS-NO-ERROR                      VALUE  'N'.         01390000
014000     05  PS-SHIPMENT-EXIST-SW     PIC X(01)   VALUE 'N'.          01400000
014100         88  PS-SHIPMENT-DOESNT-EXIST         VALUE 'N'.          01410000
014200         88  PS-SHIPMENT-EXIST                VALUE 'Y'.          01420000
014300     05  PS-MSG-SET-SW            PIC  X(01)  VALUE 'N'.          01430000
014400         88  PS-MSG-SET                       VALUE 'Y'.          01440000
014500         88  PS-MSG-NOT-SET                   VALUE 'N'.          01450000
014600     05  PS-CHANGES-OCCURRED-SW   PIC X(01)   VALUE ' '.          01460000
014700         88  PS-CHANGES-OCCURRED              VALUE 'Y'.          01470000
014800         88  PS-NO-CHANGES                    VALUE ' '.          01480000
014900     05  PS-TSHIPMT-AUD-SHIPTID-SW PIC X(01)  VALUE 'N'.          01490000
015000         88  PS-TSHIPMT-AUD-SHIPTID           VALUE 'Y'.          01500000
015100         88  PS-TSHIPMT-NOAUD-SHIPTID         VALUE 'N'.          01510000
015200     05  PS-TVHTRIP-AUD-TRIPID-SW PIC X(01)   VALUE 'N'.          01520000
015300         88  PS-TVHTRIP-AUD-TRIPID            VALUE 'Y'.          01530000
015400         88  PS-TVHTRIP-NOAUD-TRIPID          VALUE 'N'.          01540000
015500     05  PS-TVHTRIP-AUD-TRIPIN-SW PIC X(01)   VALUE 'N'.          01550000
015600         88  PS-TVHTRIP-AUD-TRIPID-N          VALUE 'Y'.          01560000
015700         88  PS-TVHTRIP-NOAUD-TRIPID-N        VALUE 'N'.          01570000
015800     05  PS-TVEHICL-AUD-VEHSCAC-SW PIC X(01)  VALUE 'N'.          01580000
015900         88  PS-TVEHICL-AUD-VEHSCAC           VALUE 'Y'.          01590000
016000         88  PS-TVEHICL-NOAUD-VEHSCAC         VALUE 'N'.          01600000
016100     05  PS-TVEHICL-AUD-PVEHSCAC-SW PIC X(01) VALUE 'N'.          01610000
016200         88  PS-TVEHICL-AUD-PVEHSCAC          VALUE 'Y'.          01620000
016300         88  PS-TVEHICL-NOAUD-PVEHSCAC        VALUE 'N'.          01630000
016400     05  PS-RECEIVERS-EXIST-SW    PIC X(01)   VALUE 'N'.          01640000
016500         88  PS-RECEIVERS-EXIST               VALUE 'Y'.          01650000
016600         88  PS-NO-RECEIVERS                  VALUE 'N'.          01660000
016700     05  PS-FOUND-SW              PIC  X(01)  VALUE ' '.          01670000
016800         88  PS-FOUND                         VALUE 'Y'.          01680000
016900         88  PS-NOT-FOUND                     VALUE 'N'.          01690000
017000     05  PS-VALID-DATE-SW               PIC X(01)    VALUE 'N'.   01700000
017100         88  PS-VALID-DATE                           VALUE 'Y'.   01710000
017200         88  PS-INVALID-DATE                         VALUE 'N'.   01720000
017300     05  PS-VALID-ETA-DTE-SW            PIC X(01)    VALUE 'N'.   01730000
017400         88  PS-VALID-ETA-DTE                        VALUE 'Y'.   01740000
017500         88  PS-INVALID-ETA-DTE                      VALUE 'N'.   01750000
017600     05  PS-VALID-VND-DTE-SW            PIC X(01)    VALUE 'N'.   01760000
017700         88  PS-VALID-VND-DTE                        VALUE 'Y'.   01770000
017800         88  PS-INVALID-VND-DTE                      VALUE 'N'.   01780000
017900     05  PS-VALID-AUTH-DTE-SW           PIC X(01)    VALUE 'N'.   01790000
018000         88  PS-VALID-AUTH-DTE                       VALUE 'Y'.   01800000
018100         88  PS-INVALID-AUTH-DTE                     VALUE 'N'.   01810000
018200     05  PS-VALID-DATE-RANGE-SW         PIC X(01)    VALUE 'N'.   01820000
018300         88  PS-VALID-DATE-RANGE                     VALUE 'Y'.   01830000
018400         88  PS-INVALID-DATE-RANGE                   VALUE 'N'.   01840000
018500     05  PS-VALID-SCAC-SW               PIC X(01)    VALUE 'N'.   01850000
018600         88  PS-VALID-SCAC                           VALUE 'Y'.   01860000
018700         88  PS-INVALID-SCAC                         VALUE 'N'.   01870000
018800     05  PS-PO-INQUIRY-SW               PIC X(01)    VALUE 'N'.   01880000
018900         88  PS-PO-INQUIRY                           VALUE 'Y'.   01890000
019000         88  PS-NOT-PO-INQUIRY                       VALUE 'N'.   01900000
019100     05  PS-USE-TRIP-SW                 PIC X(01)    VALUE 'N'.   01910000
019200         88  PS-USE-TRIP                             VALUE 'Y'.   01920000
019300     05  PS-UPDATE-PRO-SCAC-SW          PIC X(01)    VALUE 'N'.   01930000
019400         88  PS-UPDATE-PRO-SCAC                      VALUE 'Y'.   01940000
019500         88  PS-NO-UPDATE-PRO-SCAC                   VALUE 'N'.   01950000
019600     05  PS-INSERT-INDICATORS-SW        PIC X(01)    VALUE ' '.   01960000
019700         88  PS-ADD-NEW-TRIP                         VALUE '1'.   01970000
019800         88  PS-LINK-SHIPMENT                        VALUE '2'.   01980000
019900         88  PS-ADD-NEW-TRAILER                      VALUE '3'.   01990000
020000         88  PS-LINK-TRIP                            VALUE '4'.   02000000
020100     05  PS-USE-VEHICLE-NBR-SW          PIC X(01)    VALUE ' '.   02010000
020200         88  PS-NULL-VEHICLE-NBR                     VALUE '1'.   02020000
020300     05  PS-INSERT-ERROR-SW             PIC X(01)    VALUE ' '.   02030000
020400         88  PS-INSERT-ERROR                         VALUE 'Y'.   02040000
020500     05  PS-DELETE-VHTRIP-SW            PIC  X(01)   VALUE 'N'.   02050000
020600         88  PS-DELETE-VHTRIP                        VALUE 'Y'.   02060000
020700         88  PS-UPDATE-VHTRIP                        VALUE 'N'.   02070000
020800     05  PS-VALID-VND-DT-RANGE-SW       PIC  X(01)   VALUE 'Y'.   02080000
020900         88  PS-VALID-VND-DT-RANGE                   VALUE 'Y'.   02090000
021000         88  PS-INVALID-VND-DT-RANGE                 VALUE 'N'.   02100000
021100     05  PS-VND-DT-MM-SW                PIC  X(01)   VALUE 'Y'.   02110000
021200         88  PS-VND-DT-MM-CHGD                       VALUE 'Y'.   02120000
021300         88  PS-VND-DT-MM-NOT-CHGD                   VALUE 'N'.   02130000
021400     05  PS-VND-DT-DD-SW                PIC  X(01)   VALUE 'Y'.   02140000
021500         88  PS-VND-DT-DD-CHGD                       VALUE 'Y'.   02150000
021600         88  PS-VND-DT-DD-NOT-CHGD                   VALUE 'N'.   02160000
021700     05  PS-VND-DT-YY-SW                PIC  X(01)   VALUE 'Y'.   02170000
021800         88  PS-VND-DT-YY-CHGD                       VALUE 'Y'.   02180000
021900         88  PS-VND-DT-YY-NOT-CHGD                   VALUE 'N'.   02190000
022000                                                                  02200000
022100*                                                                 02210000
022200 01  PV-PROGRAM-VARIABLES.                                        02220000
022300     05  PV-CICS-RESP             PIC S9(04)  VALUE +0            02230000
022400                                              COMP SYNC.          02240000
022500     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            02250000
022600                                              COMP SYNC.          02260000
022700     05  PV-LOCK-RETRY-COUNTER    PIC S9(04)  VALUE +0            02270000
022800                                              COMP SYNC.          02280000
022900     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            02290000
023000                                              COMP SYNC.          02300000
023100     05  PV-ABSTIME               PIC S9(15)  COMP.               02310000
023200     05  PV-CURRENT-DATE          PIC  9(06).                     02320000
023300     05  PV-CURRENT-TIME          PIC  9(06).                     02330000
023400     05  PV-STATUS-CDE            PIC  X(02).                     02340000
023500     05  PV-NEW-TRIP-ID           PIC S9(09)  VALUE +0            02350000
023600                                              COMP.               02360000
023700     05  PV-TRIP-ID               PIC S9(09)  VALUE +0            02370000
023800                                              COMP.               02380000
023900     05  PV-COUNT                 PIC S9(09)  VALUE +0            02390000
024000                                              COMP-3.             02400000
024100     05  PV-VHTRIP-COUNT          PIC S9(09)  VALUE +0            02410000
024200                                              COMP-3.             02420000
024300     05  PV-TEMP-TMST.                                            02430000
024400         10  PV-TMST-CCYY             PIC X(04).                  02440000
024500         10  FILLER                   PIC X(01).                  02450000
024600         10  PV-TMST-MM               PIC X(02).                  02460000
024700         10  FILLER                   PIC X(01).                  02470000
024800         10  PV-TMST-DD               PIC X(02).                  02480000
024900         10  FILLER                   PIC X(01).                  02490000
025000         10  PV-TMST-HH               PIC X(02).                  02500000
025100         10  FILLER                   PIC X(01).                  02510000
025200         10  PV-TMST-MN               PIC X(02).                  02520000
025300         10  FILLER                   PIC X(01).                  02530000
025400         10  PV-TMST-SEC              PIC X(02).                  02540000
025500         10  FILLER                   PIC X(07).                  02550000
025600     05  PV-DATE                      PIC X(10).                  02560000
025700     05  PV-TEMP-DATE.                                            02570000
025800         10  PV-DATE-CCYY             PIC X(04).                  02580000
025900         10  FILLER                   PIC X(01).                  02590000
026000         10  PV-DATE-MM               PIC X(02).                  02600000
026100         10  FILLER                   PIC X(01).                  02610000
026200         10  PV-DATE-DD               PIC X(02).                  02620000
026300     05  PV-DB2-DATE.                                             02630000
026400         10  PV-DB2-CCYY              PIC X(04).                  02640000
026500         10  FILLER                   PIC X(01) VALUE '-'.        02650000
026600         10  PV-DB2-MM                PIC X(02).                  02660000
026700         10  FILLER                   PIC X(01) VALUE '-'.        02670000
026800         10  PV-DB2-DD                PIC X(02).                  02680000
026900     05  PV-WORK-DATE.                                            02690000
027000         10  PV-WK-DTE-MM             PIC X(02).                  02700000
027100         10  FILLER                   PIC X(01) VALUE '/'.        02710000
027200         10  PV-WK-DTE-DD             PIC X(02).                  02720000
027300         10  FILLER                   PIC X(01) VALUE '/'.        02730000
027400         10  PV-WK-DTE-YY             PIC X(04).                  02740000
027500     05  PV-WORK-DATE2.                                           02750000
027600         10  PV-WK2-DTE-MM            PIC X(02).                  02760000
027700         10  PV-WK2-DTE-DD            PIC X(02).                  02770000
027800         10  PV-WK2-DTE-YY            PIC X(04).                  02780000
027900     05  PV-VEND-SHIP-DTE.                                        02790000
028000         10  PV-VEND-SHIP-CCYY        PIC X(04).                  02800000
028100         10  PV-VEND-SHIP-MM          PIC X(02).                  02810000
028200         10  PV-VEND-SHIP-DD          PIC X(02).                  02820000
028300     05  PV-DONT-SHIP-BEF-DTE.                                    02830000
028400         10  PV-DONT-SHIP-CCYY        PIC X(04).                  02840000
028500         10  PV-DONT-SHIP-MM          PIC X(02).                  02850000
028600         10  PV-DONT-SHIP-DD          PIC X(02).                  02860000
028700     05  PV-CAN-IFNOT-SHIP-DTE.                                   02870000
028800         10  PV-CAN-IFNOT-CCYY        PIC X(04).                  02880000
028900         10  PV-CAN-IFNOT-MM          PIC X(02).                  02890000
029000         10  PV-CAN-IFNOT-DD          PIC X(02).                  02900000
029100     05  PV-EXT-CAN-DTE.                                          02910000
029200         10  PV-EXT-CAN-CCYY          PIC X(04).                  02920000
029300         10  PV-EXT-CAN-MM            PIC X(02).                  02930000
029400         10  PV-EXT-CAN-DD            PIC X(02).                  02940000
029500     05  PV-W-FIRST-NAME.                                         02950000
029600         10  PV-WORKER-FIR-NAME       PIC X(10).                  02960000
029700         10  FILLER                   PIC X(02).                  02970000
029800     05  PV-W-LAST-NAME.                                          02980000
029900         10  PV-WORKER-LAST-NAME      PIC X(10).                  02990000
030000         10  FILLER                   PIC X(08).                  03000000
030100     05  PV-WORKER-NAME.                                          03010000
030200         10  PV-WORKER-FIRST          PIC X(10).                  03020000
030300         10  PV-WORKER-LAST           PIC X(10).                  03030000
030400     05  PV-INPUT-DATE.                                           03040000
030500         10  PV-INPUT-DATE-MM           PIC 9(2)     VALUE ZEROES.03050000
030600         10  PV-INPUT-DATE-DD           PIC 9(2)     VALUE ZEROES.03060000
030700         10  PV-INPUT-DATE-CCYY         PIC 9(4)     VALUE ZEROES.03070000
030800         10  FILLER REDEFINES PV-INPUT-DATE-CCYY.                 03080000
030900             15  PV-INPUT-DATE-CC       PIC 9(2).                 03090000
031000             15  PV-INPUT-DATE-YY       PIC 9(2).                 03100000
031100     05  PV-VALID-DATE.                                           03110000
031200         10  PV-VALID-DATE-MM           PIC X(2)     VALUE SPACES.03120000
031300         10  PV-VALID-DATE-DD           PIC X(2)     VALUE SPACES.03130000
031400         10  PV-VALID-DATE-CCYY         PIC X(4)     VALUE SPACES.03140000
031500         10  FILLER REDEFINES PV-VALID-DATE-CCYY.                 03150000
031600             15  PV-VALID-DATE-CC       PIC X(2).                 03160000
031700             15  PV-VALID-DATE-YY       PIC X(2).                 03170000
031800     05  PV-OPER-UNT-ID                 PIC S9(04)   VALUE ZEROS  03180000
031900                                                     COMP.        03190000
032000     05  PV-FCLTY-ID                    PIC S9(04)   VALUE ZEROS  03200000
032100                                                     COMP.        03210000
032200     05  PV-VALID-ETA-DTE               PIC X(8)     VALUE SPACES.03220000
032300     05  PV-VALID-ETA-DTE-2             PIC X(8)     VALUE SPACES.03230000
032400     05  PV-MESSAGE.                                              03240000
032500         10  PV-MESSAGE1                PIC X(10).                03250000
032600         10  PV-FILLER                  PIC X(01).                03260000
032700         10  PV-MESSAGE2                PIC X(10).                03270000
032800         10  PV-FILLER                  PIC X(01).                03280000
032900         10  PV-MESSAGE3                PIC X(10).                03290000
033000     05  PV-DB2-CURRENT-DATE            PIC X(10).                03300000
033100     05  PV-DB2-CURRENT-TIME            PIC X(10).                03310000
033200     05  PV-DB2-CURRENT-DATE-M7DD       PIC X(10).                03320000
033300     05  PV-VND-SHIP-DATE-FMT.                                    03330000
033400         10  PV-VND-SHIP-CCYY           PIC X(04).                03340000
033500         10  FILLER                     PIC X(01) VALUE '-'.      03350000
033600         10  PV-VND-SHIP-MM             PIC X(02).                03360000
033700         10  FILLER                     PIC X(01) VALUE '-'.      03370000
033800         10  PV-VND-SHIP-DD             PIC X(10).                03380000
033900     05  PV-TEMP-FIELDS.                                          03390000
034000*********10  PV-TEMP-PO-NBR           PIC 9(07)  VALUE ZEROS.     03400003
034100         10  PV-TEMP-OPER-UNT         PIC 9(04)  VALUE ZEROS.     03410000
034200         10  PV-TEMP-FCLTY            PIC 9(04)  VALUE ZEROS.     03420000
034300         10  PV-TEMP-FB-CARTON-CNT    PIC 9(04)  VALUE ZEROS.     03430000
034400                                                                  03440000
034500 EJECT                                                            03450000
034600*----------------------------------------------------------------*03460000
034700*    CALLING PARAMETERS FOR LOCKING MODULE DPKCS044              *03470000
034800*----------------------------------------------------------------*03480000
034900                                                                  03490000
035000     COPY DPWS044.                                                03500000
035100 EJECT                                                            03510000
035200*----------------------------------------------------------------*03520000
035300*    MAP LAYOUT                                                  *03530000
035400*----------------------------------------------------------------*03540000
035500                                                                  03550000
035600     COPY TRKM124.                                                03560000
035700                                                                  03570000
035800                                                                  03580000
035900     EJECT                                                        03590000
036000*----------------------------------------------------------------*03600000
036100*    ATTRIBUTE SETTINGS COPYBOOK.                                *03610000
036200*----------------------------------------------------------------*03620000
036300                                                                  03630000
036400     COPY DPWS015.                                                03640000
036500                                                                  03650000
036600*----------------------------------------------------------------*03660000
036700*    FUNCTION KEYS COPYBOOK                                      *03670000
036800*----------------------------------------------------------------*03680000
036900                                                                  03690000
037000     COPY DPWS016.                                                03700000
037100 EJECT                                                            03710000
037200******************************************************************03720000
037300** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **03730000
037400** SUB-ROUTINE (DPKUT100).                                      **03740000
037500******************************************************************03750000
037600     COPY DPWS010I.                                               03760000
037700 EJECT                                                            03770000
037800*----------------------------------------------------------------*03780000
037900*  COPYBOOK FOR RANDOM NUMBER GENERATOR DPKUT902                 *03790004
038000*----------------------------------------------------------------*03800000
038100     COPY DPWS902.                                                03810004
038200                                                                  03820000
038300***************************************************************** 03830000
038400*    COPY BOOKS FOR THE CALENDAR ROUTINE                          03840000
038500***************************************************************** 03850000
038600                                                                  03860000
038700     COPY DPWS500.                                                03870000
038800                                                                  03880000
038900 EJECT                                                            03890000
039000***************************************************************** 03900000
039100*    COPY BOOKS FOR THE VALIDATION ROUTINE FOR THE FREIGHT BILL   03910000
039200*    BILL OF LADING, AND VEHICLE NUMBER                           03920000
039300***************************************************************** 03930000
039400     COPY RCWS023.                                                03940000
039500                                                                  03950000
039600 EJECT                                                            03960000
039700***************************************************************** 03970000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            03980009
039900***************************************************************** 03990000
040000     COPY DPWS030.                                                04000000
CICS       COPY DPWS930.                                                04001009
040100 EJECT                                                            04010000
040200***************************************************************** 04020000
040300*    STANDARD COMMAREA.                                           04030000
040400***************************************************************** 04040000
040500                                                                  04050000
040600     COPY DPWS020.                                                04060000
040700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04070000
040800                                                                  04080000
040900***************************************************************** 04090000
041000*    INTER-APPLICATION COMMAREA.                                  04100000
041100***************************************************************** 04110000
041200                                                                  04120000
041300         10  INTER-APPL-COMM-AREA PIC X(200).                     04130000
041400     COPY TRWS001.                                                04140000
041500     COPY DPWS058.                                                04150000
041600     COPY RCWS015.                                                04160000
041700***************************************************************** 04170000
041800*    SPECIFIC COMMMAREA FOR TRKCS124.                             04180000
041900***************************************************************** 04190000
042000         10  ASC-SPECIFIC-COMMAREA.                               04200000
042100             15  ASC-INT-APPL-FORMAT-IND     PIC X(01).           04210000
042200             15  ASC-SHIPT-STATUS-OK-SW    PIC X(01).             04220000
042300                 88  ASC-SHIPT-STATUS-OK                VALUE 'Y'.04230000
042400                 88  ASC-SHIPT-STATUS-NOTOK             VALUE 'N'.04240000
042500             15  ASC-UPD-PRO-SW            PIC X(01).             04250000
042600                 88  ASC-UPD-PRO                        VALUE 'Y'.04260000
042700                 88  ASC-NO-UPD-PRO                     VALUE 'N'.04270000
042800             15  ASC-UPD-BOL-SW            PIC X(01).             04280000
042900                 88  ASC-UPD-BOL                        VALUE 'Y'.04290000
043000                 88  ASC-NO-UPD-BOL                     VALUE 'N'.04300000
043100             15  ASC-ENT-ID                PIC S9(9) COMP.        04310000
043200             15  ASC-DN-VEH-NBR            PIC S9(04) COMP.       04320000
043300             15  ASC-TRIP-STATUS-CDE         PIC X(02).           04330000
043400             15  ASC-TRIP-ID                 PIC S9(9) COMP.      04340000
043500             15  ASC-SHIPT-ID                PIC S9(9) COMP.      04350000
043600             15  ASC-SCREEN-FIELDS.                               04360000
043700                 20  ASC-OPER-UNT-ID         PIC X(04).           04370000
043800                 20  ASC-OPER-UNT-ID-N REDEFINES                  04380000
043900                     ASC-OPER-UNT-ID         PIC 9(04).           04390000
044000                 20  ASC-FCLTY-ID            PIC X(04).           04400000
044100                 20  ASC-FCLTY-ID-N    REDEFINES                  04410000
044200                     ASC-FCLTY-ID            PIC 9(04).           04420000
044300                 20  ASC-FCLTY-NME           PIC X(25).           04430000
044400                 20  ASC-PRO-NBR             PIC X(22).           04440000
044500                 20  ASC-COMPLETE-PRO-NBR    PIC X(22).           04450000
044600                 20  ASC-BOL-NBR             PIC X(30).           04460000
044700                 20  ASC-COMPLETE-BOL-NBR    PIC X(30).           04470000
044800                 20  ASC-FB-CARTON-CNT       PIC X(05).           04480000
044900                 20  ASC-FB-CARTON-CNT-N REDEFINES                04490000
045000                     ASC-FB-CARTON-CNT       PIC 9(05).           04500000
045100                 20  ASC-ASN-CARTON-CNT      PIC X(05).           04510000
045200                 20  ASC-ASN-CARTON-CNT-N REDEFINES               04520000
045300                     ASC-ASN-CARTON-CNT      PIC 9(05).           04530000
045400                 20  ASC-FOR-CARTON-CNT      PIC X(05).           04540000
045500                 20  ASC-FOR-CARTON-CNT-N REDEFINES               04550000
045600                     ASC-FOR-CARTON-CNT      PIC 9(05).           04560000
045700                 20  ASC-VEND-SHIP-DTE.                           04570000
045800                     25  ASC-VEND-SHIP-MM    PIC X(02).           04580000
045900                     25  ASC-VEND-SHIP-DD    PIC X(02).           04590000
046000                     25  ASC-VEND-SHIP-CCYY.                      04600000
046100                         30 ASC-VEND-SHIP-CC PIC X(02).           04610000
046200                         30 ASC-VEND-SHIP-YY PIC X(02).           04620000
046300                 20  ASC-AUTH-NBR            PIC X(07).           04630000
046400                 20  ASC-AUTH-DTE.                                04640000
046500                     25  ASC-AUTH-MM         PIC X(02).           04650000
046600                     25  ASC-AUTH-DD         PIC X(02).           04660000
046700                     25  ASC-AUTH-CCYY.                           04670000
046800                         30 ASC-AUTH-CC      PIC X(02).           04680000
046900                         30 ASC-AUTH-YY      PIC X(02).           04690000
047000                 20  ASC-PRO-SCAC-ID         PIC X(04).           04700000
047100                 20  ASC-PRO-SCAC-DESC       PIC X(25).           04710000
047200                 20  ASC-ORIG-SCAC-ID        PIC X(04).           04720000
047300                 20  ASC-ORIG-SCAC-DESC      PIC X(25).           04730000
047400                 20  ASC-VEH-NBR             PIC X(10).           04740000
047500                 20  ASC-ETA-DTE.                                 04750000
047600                     25  ASC-ETA-MM          PIC X(02).           04760000
047700                     25  ASC-ETA-DD          PIC X(02).           04770000
047800                     25  ASC-ETA-CCYY.                            04780000
047900                         30 ASC-ETA-CC       PIC X(02).           04790000
048000                         30 ASC-ETA-YY       PIC X(02).           04800000
048100                 20  ASC-ETA-TIME.                                04810000
048200                     25  ASC-ETA-TIME-HH     PIC X(02).           04820000
048300                     25  ASC-ETA-TIME-HH-N REDEFINES              04830000
048400                         ASC-ETA-TIME-HH     PIC 9(02).           04840000
048500                     25  ASC-ETA-TIME-MN     PIC X(02).           04850000
048600                     25  ASC-ETA-TIME-MN-N REDEFINES              04860000
048700                         ASC-ETA-TIME-MN     PIC 9(02).           04870000
048800             15  ASC-PREV-SCREEN-FIELDS.                          04880000
048900                 20  ASC-PREV-PRO-NBR        PIC X(22).           04890000
049000                 20  ASC-PREV-COMP-PRO-NBR   PIC X(22).           04900000
049100                 20  ASC-PREV-BOL-NBR        PIC X(30).           04910000
049200                 20  ASC-PREV-COMP-BOL-NBR   PIC X(30).           04920000
049300                 20  ASC-PREV-FB-CARTON-CNT  PIC X(05).           04930000
049400                 20  ASC-PREV-FB-CARTON-CNT-N REDEFINES           04940000
049500                     ASC-PREV-FB-CARTON-CNT  PIC 9(05).           04950000
049600                 20  ASC-PREV-PRO-SCAC-ID    PIC X(04).           04960000
049700                 20  ASC-PREV-VEND-SHIP-DTE  PIC X(08).           04970000
049800                 20  ASC-PREV-AUTH-NBR       PIC X(07).           04980000
049900                 20  ASC-PREV-AUTH-DTE       PIC X(08).           04990000
050000                 20  ASC-PREV-ORIG-SCAC-ID   PIC X(04).           05000000
050100                 20  ASC-PREV-VEH-NBR        PIC X(10).           05010000
050200                 20  ASC-PREV-ETA-DTE        PIC X(08).           05020000
050300                 20  ASC-PREV-ETA-TIME       PIC X(04).           05030000
050400             15  ASC-BLK-SUB                 PIC S9(04)           05040000
050500                                                  COMP            05050000
050600                                                  SYNC.           05060000
050700             15  ASC-ITEM-SUB                PIC S9(04)           05070000
050800                                                 COMP             05080000
050900                                                 SYNC.            05090000
051000             15  ASC-SEL-SUB                 PIC S9(04)           05100000
051100                                                 COMP.            05110000
051200             15  ASC-SEL-ITEM                PIC S9(04)           05120000
051300                                                 COMP.            05130000
051400             15  ASC-NUMBER-OF-ITEMS-READ    PIC S9(09)           05140000
051500                                                 COMP-3.          05150000
051600             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09)          05160000
051700                                                 COMP-3.          05170000
051800             15  ASC-NUMBER-OF-TS-ITEMS      PIC S9(05)           05180000
051900                                                 COMP-3.          05190000
052000             15  ASC-ITEMS-DISPLAYED         PIC S9(03)           05200000
052100                                                 COMP-3.          05210000
052200             15  ASC-ITEM-AT-TOP-OF-PANEL    PIC S9(09)           05220000
052300                                                 COMP-3.          05230000
052400             15  ASC-ITEM-AT-BOT-OF-PANEL    PIC S9(09)           05240000
052500                                                 COMP-3.          05250000
052600             15  ASC-HIGHEST-BLOCK-WRITTEN   PIC S9(04)           05260000
052700                                                 COMP             05270000
052800                                                 SYNC.            05280000
052900             15  ASC-START-OF-SELECTED-RANGE PIC S9(09)           05290000
053000                                                 COMP-3.          05300000
053100             15  ASC-END-OF-SELECTED-RANGE   PIC S9(09)           05310000
053200                                                 COMP-3.          05320000
053300             15  ASC-ITEMS-LEFT-INDICATOR    PIC  X(01).          05330000
053400                 88  ASC-ITEMS-LEFT-ON-DB      VALUE 'Y'.         05340000
053500                 88  ASC-NO-ITEMS-LEFT-ON-DB   VALUE 'N'.         05350000
053600             15  ASC-USE-SELECTION-QUEUE-IND PIC  X(01).          05360000
053700                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         05370000
053800             15  ASC-DESC-LINE-IND           PIC  X(01).          05380000
053900                 88  ASC-DESC-LINE-DONE        VALUE 'Y'.         05390000
054000             15  ASC-CORR-LINE-IND           PIC  X(01).          05400000
054100                 88  ASC-CORR-LINE-DONE        VALUE 'Y'.         05410000
054200             15  ASC-LIST-QUEUE-NAME.                             05420000
054300                 20  ASC-LIST-TERM-ID        PIC  X(04).          05430000
054400                 20  ASC-LIST-TASK-NUMBER    PIC S9(05)           05440000
054500                                                 COMP-3.          05450000
054600                 20  ASC-LIST-SEQ            PIC  9(01).          05460000
054700             15  ASC-SEL-QUEUE-NAME.                              05470000
054800                 20  ASC-SEL-TERM-ID         PIC  X(04).          05480000
054900                 20  ASC-SEL-TASK-NUMBER     PIC S9(05)           05490000
055000                                                  COMP-3.         05500000
055100                 20  ASC-SEL-SEQ             PIC  9(01).          05510000
055200             15  ASC-DTL-QUEUE-NAME.                              05520000
055300                 20  ASC-DTL-TERM-ID         PIC  X(04).          05530000
055400                 20  ASC-DTL-TASK-NUMBER     PIC S9(05)           05540000
055500                                                 COMP-3.          05550000
055600                 20  ASC-DTL-SEQ             PIC  9(01).          05560000
055700                                                                  05570000
055800             15  ASC-START-ITEM-REQUEST.                          05580000
055900                 20  ASC-START-ITEM-REQUEST-N  PIC  9(05).        05590000
056000             15  ASC-VEND-SHIP-DATE-EDIT-FIELDS.                  05600000
056100                 20  ASC-VND-DT-F2-REQUIRED-SW     PIC  X(01).    05610000
056200                     88  ASC-VND-DT-F2-REQUIRED       VALUE 'Y'.  05620000
056300                     88  ASC-VND-DT-F2-NOT-REQUIRED   VALUE 'N'.  05630000
056400                 20  ASC-VND-DT-CHGD-SW            PIC  X(01).    05640000
056500                     88  ASC-VND-DT-CHGD              VALUE 'Y'.  05650000
056600                     88  ASC-VND-DT-NOT-CHGD          VALUE 'N'.  05660000
056700                 20  ASC-VND-DT-CHG-PENDING-SW     PIC  X(01).    05670000
056800                     88  ASC-VND-DT-CHG-PENDING       VALUE 'Y'.  05680000
056900                     88  ASC-VND-DT-CHG-NOT-PENDING   VALUE ' '.  05690000
057000                 20  ASC-VEND-SHIP-DATE-OLD.                      05700000
057100                     25  ASC-VEND-SHIP-MM-OLD      PIC X(02).     05710000
057200                     25  ASC-VEND-SHIP-DD-OLD      PIC X(02).     05720000
057300                     25  ASC-VEND-SHIP-CCYY-OLD.                  05730000
057400                         30  ASC-VEND-SHIP-CC-OLD  PIC X(02).     05740000
057500                         30  ASC-VEND-SHIP-YY-OLD  PIC X(02).     05750000
057600                                                                  05760000
057700*        10  FILLER                          PIC  X(2787).        05770000
057800     EJECT                                                        05780000
057900*---------------------------------------------------------------* 05790000
058000*    MESSAGE SELECTION TSQ B QUEUE RECORD LAYOUT.               * 05800000
058100*---------------------------------------------------------------* 05810000
058200                                                                  05820000
058300     COPY RCWS013.                                                05830000
058400                                                                  05840000
058500*----------------------------------------------------------------*05850000
058600*    ABEND PROCESSING COPYBOOK.                                  *05860000
058700*----------------------------------------------------------------*05870000
058800                                                                  05880000
058900     COPY DPWS013.                                                05890000
059000                                                                  05900000
059100*    DB2 AREA FOR TSYMSG  (SYSTEM MESSAGE - SHORT MESSAGE)        05910000
059200                                                                  05920000
059300     EXEC SQL                                                     05930000
059400          INCLUDE TSYMSG                                          05940000
059500     END-EXEC.                                                    05950000
059600                                                                  05960000
059700*    DB2 AREA FOR TAPLSYS (APPLICATION SYSTEM MASTER)             05970000
059800                                                                  05980000
059900     EXEC SQL                                                     05990000
060000          INCLUDE TAPLSYS                                         06000000
060100     END-EXEC.                                                    06010000
060200                                                                  06020000
060300*    DB2 AREA FOR COMMUNICATIONS                                  06030000
060400                                                                  06040000
060500     EXEC SQL                                                     06050000
060600          INCLUDE SQLCA                                           06060000
060700     END-EXEC.                                                    06070000
060800                                                                  06080000
060900*    DB2 AREA FOR SHIPMENT TABLE                                  06090000
061000                                                                  06100000
061100     EXEC SQL                                                     06110000
061200          INCLUDE TSHIPMT                                         06120000
061300     END-EXEC.                                                    06130000
061400                                                                  06140000
061500*    DB2 AREA FOR PO ASSOCIATION TABLE                            06150000
061600                                                                  06160000
061700     EXEC SQL                                                     06170000
061800          INCLUDE TSHPTPO                                         06180000
061900     END-EXEC.                                                    06190000
062000                                                                  06200000
062100*    DB2 AREA FOR TRIP TABLE                                      06210000
062200                                                                  06220000
062300     EXEC SQL                                                     06230000
062400          INCLUDE TVHTRIP                                         06240000
062500     END-EXEC.                                                    06250000
062600                                                                  06260000
062700*    DB2 AREA FOR PLANNED SHIPMENT TABLE                          06270000
062800                                                                  06280000
062900     EXEC SQL                                                     06290000
063000          INCLUDE TPLNSHP                                         06300000
063100     END-EXEC.                                                    06310000
063200                                                                  06320000
063300*    DB2 AREA FOR PURCHASE HEADER TABLE                           06330000
063400                                                                  06340000
063500     EXEC SQL                                                     06350000
063600          INCLUDE TPURCHS                                         06360000
063700     END-EXEC.                                                    06370000
063800                                                                  06380000
063900*    DB2 AREA FOR VEHICLE TABLE                                   06390000
064000                                                                  06400000
064100     EXEC SQL                                                     06410000
064200          INCLUDE TVEHICL                                         06420000
064300     END-EXEC.                                                    06430000
064400                                                                  06440000
064500*    DB2 AREA FOR VEHICLE AUDIT TRAIL                             06450000
064600                                                                  06460000
064700     EXEC SQL                                                     06470000
064800          INCLUDE TAUVHCL                                         06480000
064900     END-EXEC.                                                    06490000
065000                                                                  06500000
065100*    DB2 AREA FOR TRIP AUDIT TRAIL                                06510000
065200                                                                  06520000
065300     EXEC SQL                                                     06530000
065400          INCLUDE TAUTRIP                                         06540000
065500     END-EXEC.                                                    06550000
065600                                                                  06560000
065700*    DB2 AREA FOR SHIPMENT AUDIT TRAIL                            06570000
065800                                                                  06580000
065900     EXEC SQL                                                     06590000
066000          INCLUDE TAUSHIP                                         06600000
066100     END-EXEC.                                                    06610000
066200                                                                  06620000
066300*    DB2 AREA FOR VENDOR NAME                                     06630000
066400                                                                  06640000
066500     EXEC SQL                                                     06650000
066600          INCLUDE TENTNME                                         06660000
066700     END-EXEC.                                                    06670000
066800                                                                  06680000
066900*    DB2 AREA FOR TRIP STATUS                                     06690000
067000                                                                  06700000
067100     EXEC SQL                                                     06710000
067200          INCLUDE TTRIPST                                         06720000
067300     END-EXEC.                                                    06730000
067400                                                                  06740000
067500*    DB2 AREA FOR SHIPMENT STATUS                                 06750000
067600                                                                  06760000
067700     EXEC SQL                                                     06770000
067800          INCLUDE TSHIPST                                         06780000
067900     END-EXEC.                                                    06790000
068000                                                                  06800000
068100*    DB2 AREA FOR SHIPMENT STATUS TYPE                            06810000
068200                                                                  06820000
068300     EXEC SQL                                                     06830000
068400          INCLUDE TSHSTYP                                         06840000
068500     END-EXEC.                                                    06850000
068600                                                                  06860000
068700*    DB2 AREA FOR PO LINE ITEM TABLE                              06870000
068800                                                                  06880000
068900     EXEC SQL                                                     06890000
069000          INCLUDE TPURITM                                         06900000
069100     END-EXEC.                                                    06910000
069200                                                                  06920000
069300*    DB2 AREA FOR DC ALLOC SPLIT TABLE                            06930000
069400                                                                  06940000
069500     EXEC SQL                                                     06950000
069600          INCLUDE TALLPLN                                         06960000
069700     END-EXEC.                                                    06970000
069800                                                                  06980000
069900*    DB2 AREA FOR STORE ALLOCATION PLAN TABLE                     06990000
070000                                                                  07000000
070100     EXEC SQL                                                     07010000
070200          INCLUDE TMESTDS                                         07020000
070300     END-EXEC.                                                    07030000
070400                                                                  07040000
070500*    DB2 AREA FOR MERCHANDISE AREA                                07050000
070600                                                                  07060000
070700     EXEC SQL                                                     07070000
070800          INCLUDE TMDSEAR                                         07080000
070900     END-EXEC.                                                    07090000
071000                                                                  07100000
071100*    DB2 AREA FOR RESPONSIBILITY AREA                             07110000
071200                                                                  07120000
071300     EXEC SQL                                                     07130000
071400          INCLUDE TRSPBAR                                         07140000
071500     END-EXEC.                                                    07150000
071600                                                                  07160000
071700*    DB2 AREA FOR THE STATUS CODE DESCRIPTIONS                    07170000
071800                                                                  07180000
071900     EXEC SQL                                                     07190000
072000          INCLUDE TSTATCD                                         07200000
072100     END-EXEC.                                                    07210000
072200                                                                  07220000
072300*    DB2 AREA FOR THE EXTERMAL ENTERPRISE TABLE                   07230000
072400                                                                  07240000
072500     EXEC SQL                                                     07250000
072600          INCLUDE TEXTENT                                         07260000
072700     END-EXEC.                                                    07270000
072800                                                                  07280000
072900*    DB2 AREA FOR THE TRIP STATUS TABLE                           07290000
073000                                                                  07300000
073100     EXEC SQL                                                     07310000
073200          INCLUDE TTRSTYP                                         07320000
073300     END-EXEC.                                                    07330000
073400                                                                  07340000
073500*    DB2 AREA FOR THE TRIP STATUS TABLE                           07350000
073600     EXEC SQL                                                     07360000
073700          INCLUDE TFACLTY                                         07370000
073800     END-EXEC.                                                    07380000
073900                                                                  07390000
074000 EJECT                                                            07400000
074100*    CURSOR USED TO DETERMINE IF THE 'NO DISTRO' MESSAGE SHOULD BE07410000
074200*    DISPLAYED.                                                   07420000
074300                                                                  07430000
074400     EXEC SQL                                                     07440000
074500          DECLARE PO_CSR CURSOR FOR                               07450000
074600            SELECT PO_NBR                                         07460000
074700            FROM   TSHPTPO                                        07470000
074800            WHERE  SHIPT_ID        = :DK-SHIPT-ID                 07480000
074900            AND    REC_SEQ_NBR    ^= 0                            07490000
075000     END-EXEC.                                                    07500000
075100 EJECT                                                            07510000
075200 LINKAGE SECTION.                                                 07520000
075300                                                                  07530000
075400 01  DFHCOMMAREA.                                                 07540000
075500     05  FILLER                         OCCURS  1 TO 4072 TIMES   07550000
075600                                        DEPENDING ON EIBCALEN.    07560000
075700         10  FILLER                     PIC  X(01).               07570000
075800                                                                  07580000
075900                                                                  07590000
076000 PROCEDURE DIVISION.                                              07600000
076100***************************************************************** 07610000
076200** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 07620000
076300** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 07630000
076400** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 07640000
076500**                                                             ** 07650000
076600** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 07660000
076700** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 07670000
076800***************************************************************** 07680000
076900 0000-MAIN-MODULE.                                                07690000
077000     INITIALIZE DP030-CICS-API-FIELDS.                            07700000
077100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07710000
077200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07720000
077300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07730000
077400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07740000
077500     MOVE LENGTH OF TR124AI        TO DP030-MAP-LENGTH (1).       07750000
077600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07760000
077700     PERFORM 0001-CALL-CICS-ARCH-API.                             07770000
077800*                                                                 07780000
077900     PERFORM 1000-CONTROL-PROCESSING                              07790000
078000*                                                                 07800000
078100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07810000
078200     PERFORM 0001-CALL-CICS-ARCH-API.                             07820000
078300                                                                  07830000
078400 0001-CALL-CICS-ARCH-API.                                         07840000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07850009
078600                                    DFHCOMMAREA                   07860009
078700                                    DP030-CICS-API-FIELDS         07870009
078800                                    DP020-STANDARD-COMMAREA       07880009
078900                                    TR124AI.                      07890009
079000*                                                                 07900000
079100     IF  DP030-RC-CALL-SUCCESSFUL                                 07910000
079200         CONTINUE                                                 07920000
079300     ELSE                                                         07930000
079400         SET DP013-NO-ROLLBACK                                    07940000
079500             DP013-XCTL-DISPLAY-RESTART                           07950000
079600             DP013-CICS-ABEND      TO TRUE                        07960000
079700         MOVE 'BEFORE 0000-MAIN-MODULE'                           07970000
079800                                   TO DP013-PARAGRAPH             07980000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07990009
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08000009
080100         MOVE DP030-RETURN-CODE                                   08010000
080200                                   TO DP013-MESSAGE-TEXT (3)      08020000
080300         PERFORM DP013-0000-PROCESS-ABEND                         08030000
080400     END-IF.                                                      08040000
080500 EJECT                                                            08050000
080600*----------------------------------------------------------------*08060000
080700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *08070000
080800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *08080000
080900*----------------------------------------------------------------*08090000
081000                                                                  08100000
081100 1000-CONTROL-PROCESSING.                                         08110000
081200                                                                  08120000
081300     EVALUATE TRUE                                                08130000
081400         WHEN DP020-NEXT-ACT-INITIAL                              08140000
081500             INITIALIZE ASC-SPECIFIC-COMMAREA                     08150000
081600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08160000
081700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08170000
081800             PERFORM 4000-BUILD-INITIAL-PANEL                     08180000
081900                                                                  08190000
082000         WHEN DP020-NEXT-ACT-READ-MAP                             08200000
082100             PERFORM 2000-PROCESS-PANEL                           08210000
082200                                                                  08220000
082300         WHEN DP020-NEXT-ACT-RETURN                               08230000
082400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08240000
082500             PERFORM 4000-BUILD-INITIAL-PANEL                     08250000
082600                                                                  08260000
082700         WHEN OTHER                                               08270000
082800             SET DP013-LOGIC-ABEND                                08280000
082900                 DP013-NO-ROLLBACK TO TRUE                        08290000
083000             MOVE '1000-CONTROL-PROCESSING'                       08300000
083100                                   TO DP013-PARAGRAPH             08310000
083200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   08320000
083300                                   TO DP013-MESSAGE-TEXT(1)       08330000
083400             MOVE DP020-NEXT-APPL-ACTIVITY                        08340000
083500                                   TO DP013-MESSAGE-TEXT(2)       08350000
083600             PERFORM DP013-0000-PROCESS-ABEND                     08360000
083700     END-EVALUATE.                                                08370000
083800                                                                  08380000
083900*----------------------------------------------------------------*08390000
084000* LOAD THE APPLICATION SPECIFIC COMMAREA                         *08400000
084100*----------------------------------------------------------------*08410000
084200 1100-PROCESS-INTER-APPL-COMM.                                    08420000
084300                                                                  08430000
084400     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   08440000
084500                                                                  08450000
084600     EVALUATE DP020-INT-APPL-FORMAT-IND                           08460000
084700        WHEN PC-INTER-APPL-CRIT-SPEC                              08470000
084800            IF TR001-SCAC = SPACES OR                             08480000
084900              (TR001-PRO-NBR = SPACES AND TR001-BOL-NBR = SPACES) 08490000
085000               SET DP020-NEXT-ACT-APPL-ERROR TO TRUE              08500000
085100               MOVE PC-TSYMSG-01014 TO DP020-MSG-NUMBER           08510000
085200               SET DP020-MSG-FATAL                                08520000
085300                   PS-ERROR        TO TRUE                        08530000
085400            ELSE                                                  08540000
085500               MOVE TR001-PRO-NBR     TO ASC-COMPLETE-PRO-NBR     08550000
085600                                         ASC-PREV-COMP-PRO-NBR    08560000
085700               MOVE TR001-SCAC        TO ASC-PRO-SCAC-ID          08570000
085800                                         ASC-PREV-PRO-SCAC-ID     08580000
085900               MOVE TR001-BOL-NBR     TO ASC-COMPLETE-BOL-NBR     08590000
086000                                         ASC-PREV-COMP-BOL-NBR    08600000
086100               IF TR001-OPER-UNT-ID = SPACES                      08610000
086200                  MOVE DP020-LOCATION TO ASC-OPER-UNT-ID          08620000
086300               ELSE                                               08630000
086400                  MOVE TR001-OPER-UNT-ID-N TO ASC-OPER-UNT-ID     08640000
086500               END-IF                                             08650000
086600                                                                  08660000
086700               IF TR001-FCLTY-ID = SPACES                         08670000
086800                  MOVE DP020-FCLTY-ID TO ASC-FCLTY-ID             08680000
086900               ELSE                                               08690000
087000                  MOVE TR001-FCLTY-ID TO ASC-FCLTY-ID             08700000
087100               END-IF                                             08710000
087200            END-IF                                                08720000
087300        WHEN PC-INTER-APPL-ADD-SCREEN                             08730000
087400            MOVE TR001-OPER-UNT-ID    TO ASC-OPER-UNT-ID          08740000
087500            MOVE TR001-FCLTY-ID       TO ASC-FCLTY-ID             08750000
087600            MOVE TR001-PRO-NBR        TO ASC-COMPLETE-PRO-NBR     08760000
087700                                         ASC-PREV-COMP-PRO-NBR    08770000
087800            MOVE TR001-BOL-NBR        TO ASC-COMPLETE-BOL-NBR     08780000
087900                                         ASC-PREV-COMP-BOL-NBR    08790000
088000            MOVE TR001-SCAC           TO ASC-PRO-SCAC-ID          08800000
088100                                         ASC-PREV-PRO-SCAC-ID     08810000
088200            MOVE TR001-SHIPT-ID       TO ASC-SHIPT-ID             08820000
088300        WHEN PC-INTER-APPL-SHIP-LIST                              08830000
088400             SET ASC-USE-SELECTION-QUEUE TO TRUE                  08840000
088500             MOVE RC015-NUMBER-OF-TS-ITEMS                        08850000
088600                               TO ASC-NUMBER-OF-TS-ITEMS          08860000
088700             MOVE RC015-SEL-QUEUE-NAME                            08870000
088800                               TO ASC-SEL-QUEUE-NAME              08880000
088900             PERFORM 1120-PREPARE-LIST-ENTRY                      08890000
089000        WHEN OTHER                                                08900000
089100            SET DP013-LOGIC-ABEND TO TRUE                         08910000
089200            SET DP013-NO-ROLLBACK TO TRUE                         08920000
089300            MOVE '1100-PROCESS-INTER-APPL-COMM'                   08930000
089400                                  TO DP013-PARAGRAPH              08940000
089500            MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'    08950000
089600                                  TO DP013-MESSAGE-TEXT(1)        08960000
089700            MOVE DP020-NEXT-APPL-ACTIVITY                         08970000
089800                                  TO DP013-MESSAGE-TEXT(2)        08980000
089900            PERFORM DP013-0000-PROCESS-ABEND                      08990000
090000     END-EVALUATE.                                                09000000
090100                                                                  09010000
090200*----------------------------------------------------------------*09020000
090300*    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *09030000
090400*----------------------------------------------------------------*09040000
090500                                                                  09050000
090600 1120-PREPARE-LIST-ENTRY.                                         09060000
090700                                                                  09070000
090800     MOVE RC013-MAX-ITEMS TO ASC-SEL-SUB.                         09080000
090900     MOVE ZERO            TO ASC-SEL-ITEM.                        09090000
091000     PERFORM 2140-GET-NEXT-RECORD.                                09100000
091100                                                                  09110000
091200*----------------------------------------------------------------*09120000
091300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*09130000
091400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*09140000
091500* EDITS.                                                         *09150000
091600*----------------------------------------------------------------*09160000
091700 2000-PROCESS-PANEL.                                              09170000
091800                                                                  09180000
091900     EVALUATE TRUE                                                09190000
092000                                                                  09200000
092100         WHEN DP020-SRC-AID = DP016-CLEAR                         09210000
092200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09220000
092300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09230000
092400                                                                  09240000
092500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     09250000
092600             MOVE TR001-PRO-NBR    TO ASC-COMPLETE-PRO-NBR        09260000
092700             MOVE TR001-BOL-NBR    TO ASC-COMPLETE-BOL-NBR        09270000
092800             MOVE TR001-SCAC       TO ASC-PRO-SCAC-ID             09280000
092900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09290000
093000             PERFORM 4000-BUILD-INITIAL-PANEL                     09300000
093100                                                                  09310000
093200         WHEN OTHER                                               09320000
093300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09330000
093400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09340000
093500             IF  PS-NO-ERROR                                      09350000
093600                 PERFORM 2100-CHECK-FUNCTION-KEY                  09360000
093700                 SET DP030-CONTINUE-GO TO TRUE                    09370000
093800             ELSE                                                 09380000
093900                 SET DP030-OVERRIDE-GO TO TRUE                    09390000
094000             END-IF                                               09400000
094100     END-EVALUATE.                                                09410000
094200                                                                  09420000
094300 EJECT                                                            09430000
094400******************************************************************09440000
094500** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **09450000
094600** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **09460000
094700** FROM THE CICS ARCHITECTURE API.                              **09470000
094800******************************************************************09480000
094900 2100-CHECK-FUNCTION-KEY.                                         09490000
095000                                                                  09500000
095100     EVALUATE TRUE                                                09510000
095200                                                                  09520000
095300         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 09530000
095400             SET ASC-VND-DT-CHG-NOT-PENDING TO TRUE               09540000
095500             SET ASC-VND-DT-NOT-CHGD        TO TRUE               09550000
095600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 09560000
095700                                                                  09570000
095800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09580000
095900******* CHECK IF VENDOR DATE IS WITHIN THE REQUIRED RANGE         09590000
096000*******    VENDOR DATE NOT > CURRENT DATE  OR                     09600000
096100*******      < CURRENT-DATE - PC-VALID-VND-DT-RANGE  DAYS         09610000
096200             IF ASC-VND-DT-CHG-PENDING                            09620000
096300                 PERFORM 3365-CHK-VND-DATE-RANGE                  09630000
096400                 IF PS-VALID-VND-DT-RANGE                         09640000
096500                     PERFORM 2150-UPDATE                          09650000
096600                     SET ASC-VND-DT-CHG-NOT-PENDING TO TRUE       09660000
096700                 ELSE                                             09670000
096800                     SET ASC-VND-DT-F2-REQUIRED                   09680000
096900                         PS-ERROR                                 09690000
097000                         DP020-MSG-WARNING  TO TRUE               09700000
097100                     MOVE DP015-YELLOW      TO AVNDMMC            09710000
097200                                               AVNDDDC            09720000
097300                                               AVNDYYC            09730000
097400                     MOVE DP015-REVERSE     TO AVNDMMH            09740000
097500                                               AVNDDDH            09750000
097600                                               AVNDYYH            09760000
097700                     MOVE -1                TO AVNDMML            09770000
097800                     MOVE PC-TSYMSG-01838   TO DP020-MSG-NUMBER   09780000
097900                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09790000
098000                 END-IF                                           09800000
098100             ELSE                                                 09810000
098200                 PERFORM 2150-UPDATE                              09820000
098300             END-IF                                               09830000
098400                                                                  09840000
098500         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    09850000
098600             IF ASC-VND-DT-F2-REQUIRED                            09860000
098700                 IF (ASC-VEND-SHIP-MM = ASC-VEND-SHIP-MM-OLD      09870000
098800                     AND ASC-VEND-SHIP-DD = ASC-VEND-SHIP-DD-OLD  09880000
098900                     AND ASC-VEND-SHIP-CCYY =                     09890000
099000                                         ASC-VEND-SHIP-CCYY-OLD)  09900000
099100                     AND ASC-VND-DT-CHG-PENDING                   09910000
099200                     PERFORM 2150-UPDATE                          09920000
099300                     SET ASC-VND-DT-CHG-NOT-PENDING TO TRUE       09930000
099400                     MOVE DP015-UNP-ALP-NOR-OFF TO AVNDMMA        09940000
099500                                                   AVNDDDA        09950000
099600                                                   AVNDYYA        09960000
099700                     MOVE DP015-GREEN           TO AVNDMMC        09970000
099800                                                   AVNDDDC        09980000
099900                                                   AVNDYYC        09990000
100000                     MOVE DP015-UNDERLINE       TO AVNDMMH        10000000
100100                                                   AVNDDDH        10010000
100200                                                   AVNDYYH        10020000
100300                 ELSE                                             10030000
100400                     IF ASC-VND-DT-CHG-PENDING                    10040000
100500                         PERFORM 3365-CHK-VND-DATE-RANGE          10050000
100600                         IF PS-VALID-VND-DT-RANGE                 10060000
100700                            PERFORM 2150-UPDATE                   10070000
100800                           SET ASC-VND-DT-CHG-NOT-PENDING TO TRUE 10080000
100900                            MOVE DP015-UNP-ALP-NOR-OFF TO AVNDMMA 10090000
101000                                                          AVNDDDA 10100000
101100                                                          AVNDYYA 10110000
101200                            MOVE DP015-GREEN           TO AVNDMMC 10120000
101300                                                          AVNDDDC 10130000
101400                                                          AVNDYYC 10140000
101500                            MOVE DP015-UNDERLINE       TO AVNDMMH 10150000
101600                                                          AVNDDDH 10160000
101700                                                          AVNDYYH 10170000
101800                         ELSE                                     10180000
101900                             SET ASC-VND-DT-F2-REQUIRED           10190000
102000                                 PS-ERROR                         10200000
102100                                 DP020-MSG-WARNING  TO TRUE       10210000
102200                                 MOVE DP015-YELLOW     TO AVNDMMC 10220000
102300                                                          AVNDDDC 10230000
102400                                                          AVNDYYC 10240000
102500                                 MOVE DP015-REVERSE    TO AVNDMMH 10250000
102600                                                          AVNDDDH 10260000
102700                                                          AVNDYYH 10270000
102800                                 MOVE -1               TO AVNDMML 10280000
102900                                 MOVE PC-TSYMSG-01838             10290000
103000                                              TO DP020-MSG-NUMBER 10300000
103100                              SET DP030-SET-CURSOR-APPL-1 TO TRUE 10310000
103200                         END-IF                                   10320000
103300                     END-IF                                       10330000
103400                 END-IF                                           10340000
103500             ELSE                                                 10350000
103600                 SET PS-ERROR                                     10360000
103700                     DP020-MSG-WARNING  TO TRUE                   10370000
103800                 MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         10380000
103900             END-IF                                               10390000
104000                                                                  10400000
104100         WHEN DP020-SRC-AID = DP016-ENTER                         10410000
104200             CONTINUE                                             10420000
104300                                                                  10430000
104400         WHEN OTHER                                               10440000
104500             SET DP013-NO-ROLLBACK                                10450000
104600                 DP013-XCTL-DISPLAY-RESTART                       10460000
104700                 DP013-CICS-ABEND  TO TRUE                        10470000
104800             MOVE '2100-CHECK-FUNCTION-KEY'                       10480000
104900                                   TO DP013-PARAGRAPH             10490000
105000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10500000
105100                                   TO DP013-MESSAGE-TEXT (1)      10510000
105200             PERFORM DP013-0000-PROCESS-ABEND                     10520000
105300     END-EVALUATE.                                                10530000
105400 EJECT                                                            10540000
105500******************************************************************10550000
105600** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **10560000
105700** INTER-APPLICATION COMMAREA.                                  **10570000
105800******************************************************************10580000
105900 2110-PREPARE-INTER-APPL-COMM.                                    10590000
106000                                                                  10600000
106100     INITIALIZE TR001-INTER-APPL-COMMAREA.                        10610000
106200                                                                  10620000
106300     MOVE ASC-COMPLETE-BOL-NBR     TO TR001-BOL-NBR.              10630000
106400     MOVE ASC-COMPLETE-PRO-NBR     TO TR001-PRO-NBR.              10640000
106500     MOVE ASC-VEH-NBR              TO TR001-TRLR-NBR.             10650000
106600     MOVE ASC-OPER-UNT-ID          TO TR001-OPER-UNT-ID.          10660000
106700     MOVE ASC-FCLTY-ID             TO TR001-FCLTY-ID.             10670000
106800     MOVE ASC-FCLTY-NME            TO TR001-FCLTY-NME.            10680000
106900     MOVE ASC-PRO-SCAC-ID          TO TR001-SCAC.                 10690000
107000     MOVE ASC-PRO-SCAC-DESC        TO TR001-NAME.                 10700000
107100     MOVE ASC-ETA-DTE              TO TR001-ETA-DTE.              10710000
107200     MOVE ASC-ETA-TIME             TO TR001-ETA-TIME.             10720000
107300     MOVE ASC-SHIPT-ID             TO TR001-SHIPT-ID.             10730000
107400                                                                  10740000
107500 2140-GET-NEXT-RECORD.                                            10750000
107600                                                                  10760000
107700     ADD +1                       TO ASC-SEL-SUB.                 10770000
107800     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            10780000
107900         ADD +1                   TO ASC-SEL-ITEM                 10790000
108000         MOVE +1                  TO ASC-SEL-SUB                  10800000
108100     END-IF.                                                      10810000
108200     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10820000
108300         PERFORM 9100-READ-SEL-QUEUE                              10830000
108400         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      10840000
108500             MOVE RC013-SHIPT-ID (ASC-SEL-SUB)                    10850000
108600                                       TO ASC-SHIPT-ID            10860000
108700             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 10870000
108800                                       TO ASC-OPER-UNT-ID         10880000
108900             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    10890000
109000                                       TO ASC-FCLTY-ID            10900000
109100             MOVE RC013-PRO-NBR (ASC-SEL-SUB)                     10910000
109200                                       TO ASC-COMPLETE-PRO-NBR    10920000
109300                                          ASC-PREV-COMP-PRO-NBR   10930000
109400             MOVE RC013-BOL-NBR (ASC-SEL-SUB)                     10940000
109500                                       TO ASC-COMPLETE-BOL-NBR    10950000
109600                                          ASC-PREV-COMP-BOL-NBR   10960000
109700             MOVE RC013-OWNER-SCAC-ID (ASC-SEL-SUB)               10970000
109800                                       TO ASC-PRO-SCAC-ID         10980000
109900                                          ASC-PREV-PRO-SCAC-ID    10990000
110000             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  11000000
110100             PERFORM 9200-REWRITE-SEL-QUEUE                       11010000
110200         ELSE                                                     11020000
110300             SUBTRACT +1 FROM ASC-SEL-SUB                         11030000
110400             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             11040000
110500             SET DP020-MSG-INFORMATIONAL TO TRUE                  11050000
110600*            SET PS-LIST-END             TO TRUE                  11060000
110700         END-IF                                                   11070000
110800     ELSE                                                         11080000
110900         SUBTRACT +1 FROM ASC-SEL-ITEM                            11090000
111000         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  11100000
111100         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             11110000
111200         SET DP020-MSG-INFORMATIONAL TO TRUE                      11120000
111300*        SET PS-LIST-END             TO TRUE                      11130000
111400     END-IF.                                                      11140000
111500                                                                  11150000
111600******************************************************************11160000
111700*  PARAGRAPH 2150- UPDATE DONE WHEN LOCAL-FUNC-01 PRESSED       **11170000
111800******************************************************************11180000
111900 2150-UPDATE.                                                     11190000
112000     PERFORM 3600-CHECK-FOR-CHANGES                               11200000
112100     IF PS-CHANGES-OCCURRED                                       11210000
112200        IF PS-MSG-SET                                             11220000
112300           CONTINUE                                               11230000
112400        ELSE                                                      11240000
112500           MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER               11250000
112600           SET DP020-MSG-INFORMATIONAL TO TRUE                    11260000
112700        END-IF                                                    11270000
112800        PERFORM 4000-BUILD-INITIAL-PANEL                          11280000
112900     ELSE                                                         11290000
113000        IF PS-NO-ERROR                                            11300000
113100           MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER               11310000
113200           SET DP020-MSG-INFORMATIONAL TO TRUE                    11320000
113300        END-IF                                                    11330000
113400     END-IF.                                                      11340000
113500                                                                  11350000
113600*----------------------------------------------------------------*11360000
113700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*11370000
113800* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *11380000
113900* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *11390000
114000*----------------------------------------------------------------*11400000
114100                                                                  11410000
114200 2200-MOVE-SCREEN-TO-COMMAREA.                                    11420000
114300                                                                  11430000
114400     IF AFBNBRL > ZERO                                            11440000
114500        MOVE AFBNBRI              TO ASC-COMPLETE-PRO-NBR         11450000
114600     ELSE                                                         11460000
114700        IF AFBNBRF = DP015-ERASE-EOF                              11470000
114800           MOVE SPACES            TO ASC-COMPLETE-PRO-NBR         11480000
114900                                     ASC-PRO-NBR                  11490000
115000        END-IF                                                    11500000
115100     END-IF.                                                      11510000
115200                                                                  11520000
115300     IF ABOLNBRL > ZERO                                           11530000
115400        MOVE ABOLNBRI             TO ASC-COMPLETE-BOL-NBR         11540000
115500     ELSE                                                         11550000
115600        IF ABOLNBRF = DP015-ERASE-EOF                             11560000
115700           MOVE SPACES            TO ASC-COMPLETE-BOL-NBR         11570000
115800                                     ASC-BOL-NBR                  11580000
115900        END-IF                                                    11590000
116000     END-IF.                                                      11600000
116100                                                                  11610000
116200     IF AFBCNTL > ZERO                                            11620000
116300        MOVE AFBCNTI              TO ASC-FB-CARTON-CNT            11630000
116400     ELSE                                                         11640000
116500        IF AFBCNTF = DP015-ERASE-EOF                              11650000
116600           MOVE SPACES            TO ASC-FB-CARTON-CNT            11660000
116700        END-IF                                                    11670000
116800     END-IF.                                                      11680000
116900                                                                  11690000
117000     IF AVNDMML > ZERO                                            11700000
117100        MOVE AVNDMMI              TO ASC-VEND-SHIP-MM             11710000
117200        SET PS-VND-DT-MM-CHGD     TO TRUE                         11720000
117300     ELSE                                                         11730000
117400        SET PS-VND-DT-MM-NOT-CHGD TO TRUE                         11740000
117500        IF AVNDMMF = DP015-ERASE-EOF                              11750000
117600           MOVE SPACES            TO ASC-VEND-SHIP-MM             11760000
117700        END-IF                                                    11770000
117800     END-IF.                                                      11780000
117900                                                                  11790000
118000     IF AVNDDDL > ZERO                                            11800000
118100        MOVE AVNDDDI              TO ASC-VEND-SHIP-DD             11810000
118200        SET PS-VND-DT-DD-CHGD     TO TRUE                         11820000
118300     ELSE                                                         11830000
118400        SET PS-VND-DT-DD-NOT-CHGD TO TRUE                         11840000
118500        IF AVNDDDF = DP015-ERASE-EOF                              11850000
118600           MOVE SPACES            TO ASC-VEND-SHIP-DD             11860000
118700        END-IF                                                    11870000
118800     END-IF.                                                      11880000
118900                                                                  11890000
119000     IF AVNDYYL > ZERO                                            11900000
119100        MOVE AVNDYYI              TO ASC-VEND-SHIP-YY             11910000
119200        SET PS-VND-DT-YY-CHGD     TO TRUE                         11920000
119300        IF ASC-VEND-SHIP-YY > '60'                                11930000
119400           MOVE '19'              TO ASC-VEND-SHIP-CC             11940000
119500        ELSE                                                      11950000
119600           MOVE '20'              TO ASC-VEND-SHIP-CC             11960000
119700        END-IF                                                    11970000
119800     ELSE                                                         11980000
119900        SET PS-VND-DT-YY-NOT-CHGD TO TRUE                         11990000
120000        IF AVNDYYF = DP015-ERASE-EOF                              12000000
120100           MOVE SPACES            TO ASC-VEND-SHIP-YY             12010000
120200        END-IF                                                    12020000
120300     END-IF.                                                      12030000
120400                                                                  12040000
120500     IF PS-VND-DT-DD-CHGD OR                                      12050000
120600        PS-VND-DT-MM-CHGD OR                                      12060000
120700        PS-VND-DT-YY-CHGD                                         12070000
120800         SET ASC-VND-DT-CHGD      TO TRUE                         12080000
120900         SET ASC-VND-DT-CHG-PENDING  TO TRUE                      12090000
121000     END-IF.                                                      12100000
121100                                                                  12110000
121200     IF AAUTHNOL > ZERO                                           12120000
121300        MOVE AAUTHNOI             TO ASC-AUTH-NBR                 12130000
121400     ELSE                                                         12140000
121500        IF AAUTHNOF = DP015-ERASE-EOF                             12150000
121600           MOVE SPACES            TO ASC-AUTH-NBR                 12160000
121700        END-IF                                                    12170000
121800     END-IF.                                                      12180000
121900                                                                  12190000
122000     IF AAUTHMML > ZERO                                           12200000
122100        MOVE AAUTHMMI             TO ASC-AUTH-MM                  12210000
122200     ELSE                                                         12220000
122300        IF AAUTHMMF = DP015-ERASE-EOF                             12230000
122400           MOVE SPACES            TO ASC-AUTH-MM                  12240000
122500        END-IF                                                    12250000
122600     END-IF.                                                      12260000
122700                                                                  12270000
122800     IF AAUTHDDL > ZERO                                           12280000
122900        MOVE AAUTHDDI             TO ASC-AUTH-DD                  12290000
123000     ELSE                                                         12300000
123100        IF AAUTHDDF = DP015-ERASE-EOF                             12310000
123200           MOVE SPACES            TO ASC-AUTH-DD                  12320000
123300        END-IF                                                    12330000
123400     END-IF.                                                      12340000
123500                                                                  12350000
123600     IF AAUTHYYL > ZERO                                           12360000
123700        MOVE AAUTHYYI             TO ASC-AUTH-YY                  12370000
123800        IF ASC-AUTH-YY > '60'                                     12380000
123900           MOVE '19'              TO ASC-AUTH-CC                  12390000
124000        ELSE                                                      12400000
124100           MOVE '20'              TO ASC-AUTH-CC                  12410000
124200        END-IF                                                    12420000
124300     ELSE                                                         12430000
124400        IF AAUTHYYF = DP015-ERASE-EOF                             12440000
124500           MOVE SPACES            TO ASC-AUTH-YY                  12450000
124600        END-IF                                                    12460000
124700     END-IF.                                                      12470000
124800                                                                  12480000
124900     IF AOSCACL > ZERO                                            12490000
125000        MOVE AOSCACI              TO ASC-ORIG-SCAC-ID             12500000
125100     ELSE                                                         12510000
125200        IF AOSCACF = DP015-ERASE-EOF                              12520000
125300           MOVE SPACES            TO ASC-ORIG-SCAC-ID             12530000
125400        END-IF                                                    12540000
125500     END-IF.                                                      12550000
125600                                                                  12560000
125700     IF ADSCACL > ZERO                                            12570000
125800        MOVE ADSCACI              TO ASC-PRO-SCAC-ID              12580000
125900     ELSE                                                         12590000
126000        IF ADSCACF = DP015-ERASE-EOF                              12600000
126100           MOVE SPACES            TO ASC-PRO-SCAC-ID              12610000
126200        END-IF                                                    12620000
126300     END-IF.                                                      12630000
126400                                                                  12640000
126500     IF ATRLRNOL > ZERO                                           12650000
126600        MOVE ATRLRNOI             TO ASC-VEH-NBR                  12660000
126700     ELSE                                                         12670000
126800        IF ATRLRNOF = DP015-ERASE-EOF                             12680000
126900           MOVE SPACES            TO ASC-VEH-NBR                  12690000
127000        END-IF                                                    12700000
127100     END-IF.                                                      12710000
127200                                                                  12720000
127300     IF AETAMML > ZERO                                            12730000
127400        MOVE AETAMMI              TO ASC-ETA-MM                   12740000
127500     ELSE                                                         12750000
127600        IF AETAMMF = DP015-ERASE-EOF                              12760000
127700           MOVE SPACES            TO ASC-ETA-MM                   12770000
127800        END-IF                                                    12780000
127900     END-IF.                                                      12790000
128000                                                                  12800000
128100     IF AETADDL > ZERO                                            12810000
128200        MOVE AETADDI              TO ASC-ETA-DD                   12820000
128300     ELSE                                                         12830000
128400        IF AETADDF = DP015-ERASE-EOF                              12840000
128500           MOVE SPACES               TO ASC-ETA-DD                12850000
128600        END-IF                                                    12860000
128700     END-IF.                                                      12870000
128800                                                                  12880000
128900     IF AETAYYL > ZERO                                            12890000
129000        MOVE AETAYYI              TO ASC-ETA-YY                   12900000
129100        IF ASC-ETA-YY > '60'                                      12910000
129200           MOVE '19'              TO ASC-ETA-CC                   12920000
129300        ELSE                                                      12930000
129400           MOVE '20'              TO ASC-ETA-CC                   12940000
129500        END-IF                                                    12950000
129600     ELSE                                                         12960000
129700        IF AETAYYF = DP015-ERASE-EOF                              12970000
129800           MOVE SPACES            TO ASC-ETA-YY                   12980000
129900        END-IF                                                    12990000
130000     END-IF.                                                      13000000
130100                                                                  13010000
130200     IF AETAHHL > ZERO                                            13020000
130300        MOVE AETAHHI              TO ASC-ETA-TIME-HH              13030000
130400     ELSE                                                         13040000
130500        IF AETAHHF = DP015-ERASE-EOF                              13050000
130600           MOVE SPACES            TO ASC-ETA-TIME-HH              13060000
130700        END-IF                                                    13070000
130800     END-IF.                                                      13080000
130900                                                                  13090000
131000     IF AETAMNL > ZERO                                            13100000
131100        MOVE AETAMNI              TO ASC-ETA-TIME-MN              13110000
131200     ELSE                                                         13120000
131300        IF AETAMNF = DP015-ERASE-EOF                              13130000
131400           MOVE SPACES            TO ASC-ETA-TIME-MN              13140000
131500        END-IF                                                    13150000
131600     END-IF.                                                      13160000
131700                                                                  13170000
131800     IF ASC-ETA-TIME = SPACES                                     13180000
131900        MOVE '0000'               TO ASC-ETA-TIME                 13190000
132000     END-IF.                                                      13200000
132100*----------------------------------------------------------------*13210000
132200* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *13220000
132300* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *13230000
132400* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *13240000
132500*----------------------------------------------------------------*13250000
132600                                                                  13260000
132700 3000-EDIT-DATA-IN-COMMAREA.                                      13270000
132800                                                                  13280000
132900     PERFORM 3200-RESET-ATTRIBUTES.                               13290000
133000                                                                  13300000
133100     IF  ASC-OPER-UNT-ID    > SPACES                              13310000
133200         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         13320000
133300         MOVE LENGTH OF ASC-OPER-UNT-ID                           13330000
133400                                 TO DP010I-MAXIMUM-DIGITS         13340000
133500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       13350000
133600         SET DP010I-NEGATIVE-NOT-ALLOWED                          13360000
133700                                 TO TRUE                          13370000
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13381008
273427              USING DP010I-NUMERIC-EDIT-AREA                      13382008
133900         IF  DP010I-ERROR-DETECTED                                13390000
134000             SET PS-ERROR                                         13400000
134100                 DP020-MSG-FATAL TO TRUE                          13410000
134200             MOVE PC-TSYMSG-00008                                 13420000
134300                                 TO DP020-MSG-NUMBER              13430000
134400             MOVE DP015-UNP-ALP-BRT-OFF                           13440000
134500                                 TO AOPERA                        13450000
134600             MOVE DP015-RED      TO AOPERC                        13460000
134700             MOVE DP015-REVERSE  TO AOPERH                        13470000
134800             MOVE -1             TO AOPERL                        13480000
134900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13490000
135000         ELSE                                                     13500000
135100             MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-OPER-UNT        13510000
135200             MOVE PV-TEMP-OPER-UNT TO ASC-OPER-UNT-ID-N           13520000
135300                                    PV-OPER-UNT-ID                13530000
135400             MOVE ASC-OPER-UNT-ID                                 13540000
135500                                 TO AOPERO                        13550000
135600             PERFORM 3900-VALIDATE-OPER-UNT-ID                    13560000
135700         END-IF                                                   13570000
135800     END-IF.                                                      13580000
135900                                                                  13590000
136000     IF  ASC-FCLTY-ID > SPACES                                    13600000
136100         MOVE ASC-FCLTY-ID       TO DP010I-UNEDITED-FIELD         13610000
136200         MOVE LENGTH OF ASC-FCLTY-ID                              13620000
136300                                 TO DP010I-MAXIMUM-DIGITS         13630000
136400         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       13640000
136500         SET DP010I-NEGATIVE-NOT-ALLOWED                          13650000
136600                                 TO TRUE                          13660000
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13671008
273427              USING DP010I-NUMERIC-EDIT-AREA                      13672008
136800         IF  DP010I-ERROR-DETECTED                                13680000
136900             SET PS-ERROR                                         13690000
137000                 DP020-MSG-FATAL TO TRUE                          13700000
137100             MOVE PC-TSYMSG-00008                                 13710000
137200                                 TO DP020-MSG-NUMBER              13720000
137300             MOVE DP015-UNP-ALP-BRT-OFF                           13730000
137400                                 TO AFCLTYA                       13740000
137500             MOVE DP015-RED      TO AFCLTYC                       13750000
137600             MOVE DP015-REVERSE  TO AFCLTYH                       13760000
137700             MOVE -1             TO AFCLTYL                       13770000
137800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13780000
137900         ELSE                                                     13790000
138000             MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-FCLTY           13800000
138100             MOVE PV-TEMP-FCLTY  TO ASC-FCLTY-ID-N                13810000
138200                                    PV-FCLTY-ID                   13820000
138300             MOVE ASC-FCLTY-ID TO AFCLTYO                         13830000
138400         END-IF                                                   13840000
138500     END-IF.                                                      13850000
138600                                                                  13860000
138700     IF ASC-FCLTY-ID-N      > ZEROS AND                           13870000
138800        ASC-OPER-UNT-ID-N > ZEROS                                 13880000
138900         MOVE ASC-FCLTY-ID TO PV-FCLTY-ID                         13890000
139000         MOVE ASC-OPER-UNT-ID TO PV-OPER-UNT-ID                   13900000
139100         PERFORM 3800-VALIDATE-FCLTY-ID                           13910000
139200     ELSE                                                         13920000
139300         MOVE SPACES TO ASC-FCLTY-NME                             13930000
139400                        AFDESCO                                   13940000
139500     END-IF.                                                      13950000
139600                                                                  13960000
139700     IF  ASC-FB-CARTON-CNT > SPACES AND PS-NO-ERROR               13970000
139800        MOVE ASC-FB-CARTON-CNT TO DP010I-UNEDITED-FIELD           13980000
139900        MOVE +5                TO DP010I-MAXIMUM-DIGITS           13990000
140000        MOVE +0                TO DP010I-MAXIMUM-DECIMALS         14000000
140100        SET DP010I-NEGATIVE-NOT-ALLOWED                           14010000
140200                                    TO TRUE                       14020000
273427        CALL DP010I-NUMERIC-EDIT-ROUTINE                          14031008
273427             USING DP010I-NUMERIC-EDIT-AREA                       14032008
140400        IF DP010I-ERROR-DETECTED                                  14040000
140500            MOVE DP015-RED      TO AFBCNTC                        14050000
140600            MOVE DP015-REVERSE  TO AFBCNTH                        14060000
140700            MOVE -1             TO AFBCNTL                        14070000
140800            MOVE PC-TSYMSG-00008                                  14080000
140900                                TO DP020-MSG-NUMBER               14090000
141000            SET DP020-MSG-FATAL TO TRUE                           14100000
141100            SET PS-ERROR        TO TRUE                           14110000
141200            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   14120000
141300        ELSE                                                      14130000
141400            MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-FB-CARTON-CNT    14140000
141500            MOVE PV-TEMP-FB-CARTON-CNT TO ASC-FB-CARTON-CNT-N     14150000
141600                                       DK-FB-CARTON-CNT           14160000
141700                                       AFBCNTO                    14170000
141800        END-IF                                                    14180000
141900      END-IF.                                                     14190000
142000                                                                  14200000
142100     IF ASC-COMPLETE-PRO-NBR > SPACES AND PS-NO-ERROR             14210000
142200        MOVE ASC-COMPLETE-PRO-NBR  TO RC023-FREIGHT-BILL          14220000
142300                                      AFBNBRO                     14230000
142400        CALL PC-RCKUT023 USING RC023-FORMAT-DATA-AREA             14240000
142500        MOVE RC023-FREIGHT-BILL  TO ASC-PRO-NBR                   14250000
142600      END-IF.                                                     14260000
142700                                                                  14270000
142800     IF ASC-COMPLETE-BOL-NBR > SPACES AND PS-NO-ERROR             14280000
142900        MOVE ASC-COMPLETE-BOL-NBR  TO RC023-BILL-OF-LADING        14290000
143000                                      ABOLNBRO                    14300000
143100        CALL PC-RCKUT023 USING RC023-FORMAT-DATA-AREA             14310000
143200        MOVE RC023-BILL-OF-LADING  TO ASC-BOL-NBR                 14320000
143300      END-IF.                                                     14330000
143400                                                                  14340000
143500     IF ASC-VEH-NBR > SPACES AND PS-NO-ERROR                      14350000
143600        MOVE ASC-VEH-NBR       TO RC023-VEHICLE                   14360000
143700        CALL PC-RCKUT023 USING RC023-FORMAT-DATA-AREA             14370000
143800        MOVE RC023-VEHICLE     TO ASC-VEH-NBR                     14380000
143900                                  ATRLRNOO                        14390000
144000      END-IF.                                                     14400000
144100                                                                  14410000
144200     IF ASC-VEND-SHIP-DTE > SPACES AND PS-NO-ERROR                14420000
144300          PERFORM 3360-VALIDATE-VEND-SHIP-DTE                     14430000
144400          IF PS-INVALID-VND-DTE                                   14440000
144500              MOVE DP015-RED  TO AVNDMMC                          14450000
144600                                 AVNDDDC                          14460000
144700                                 AVNDYYC                          14470000
144800              MOVE DP015-REVERSE TO AVNDMMH                       14480000
144900                                    AVNDDDH                       14490000
145000                                    AVNDYYH                       14500000
145100              MOVE -1         TO AVNDMML                          14510000
145200              MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER            14520000
145300              SET DP020-MSG-FATAL TO TRUE                         14530000
145400              SET PS-ERROR    TO TRUE                             14540000
145500              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 14550000
145600          END-IF                                                  14560000
145700     END-IF.                                                      14570000
145800                                                                  14580000
145900     IF  ASC-AUTH-DTE > SPACES AND PS-NO-ERROR AND                14590000
146000         ASC-AUTH-DTE > '01010001'                                14600000
146100         PERFORM 3370-VALIDATE-AUTH-DTE                           14610000
146200         IF  PS-INVALID-AUTH-DTE                                  14620000
146300             MOVE DP015-RED      TO AAUTHMMC                      14630000
146400                                    AAUTHDDC                      14640000
146500                                    AAUTHYYC                      14650000
146600             MOVE DP015-REVERSE  TO AAUTHMMH                      14660000
146700                                    AAUTHDDH                      14670000
146800                                    AAUTHYYH                      14680000
146900             MOVE -1             TO AAUTHMML                      14690000
147000             MOVE PC-TSYMSG-00009                                 14700000
147100                                 TO DP020-MSG-NUMBER              14710000
147200             SET DP020-MSG-FATAL TO TRUE                          14720000
147300             SET PS-ERROR        TO TRUE                          14730000
147400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14740000
147500         END-IF                                                   14750000
147600     END-IF.                                                      14760000
147700                                                                  14770000
147800                                                                  14780000
147900     IF  ASC-ETA-DTE > SPACES AND PS-NO-ERROR                     14790000
148000         PERFORM 3350-VALIDATE-ETA-DTE                            14800000
148100         IF  PS-INVALID-ETA-DTE                                   14810000
148200             MOVE DP015-RED      TO AETAMMC                       14820000
148300                                    AETADDC                       14830000
148400                                    AETAYYC                       14840000
148500             MOVE DP015-REVERSE  TO AETAMMH                       14850000
148600                                    AETADDH                       14860000
148700                                    AETAYYH                       14870000
148800             MOVE -1             TO AETAMML                       14880000
148900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14890000
149000             MOVE PC-TSYMSG-00009                                 14900000
149100                                 TO DP020-MSG-NUMBER              14910000
149200             SET DP020-MSG-FATAL TO TRUE                          14920000
149300             SET PS-ERROR        TO TRUE                          14930000
149400         END-IF                                                   14940000
149500     END-IF.                                                      14950000
149600                                                                  14960000
149700     IF ASC-ETA-TIME-MN = SPACES                                  14970000
149800        MOVE '00' TO ASC-ETA-TIME-MN                              14980000
149900     END-IF.                                                      14990000
150000                                                                  15000000
150100     IF ASC-ETA-TIME-HH = SPACES                                  15010000
150200        MOVE '00' TO ASC-ETA-TIME-HH                              15020000
150300     END-IF.                                                      15030000
150400                                                                  15040000
150500     IF ASC-ETA-TIME-HH = SPACES OR                               15050000
150600        ASC-ETA-TIME-HH = '00' OR PS-ERROR                        15060000
150700         CONTINUE                                                 15070000
150800     ELSE                                                         15080000
150900         MOVE ASC-ETA-TIME-HH      TO DP010I-UNEDITED-FIELD       15090000
151000         MOVE LENGTH OF ASC-ETA-TIME-HH TO DP010I-MAXIMUM-DIGITS  15100000
151100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     15110000
151200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15120000
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15131008
273427              USING DP010I-NUMERIC-EDIT-AREA                      15132008
151400         IF  DP010I-ERROR-DETECTED                                15140000
151500             SET PS-ERROR                                         15150000
151600                 DP020-MSG-FATAL   TO TRUE                        15160000
151700             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        15170000
151800             MOVE DP015-UNP-NUM-BRT-OFF                           15180000
151900                                       TO AETAHHA                 15190000
152000             MOVE DP015-RED            TO AETAHHC                 15200000
152100             MOVE DP015-REVERSE        TO AETAHHH                 15210000
152200             MOVE -1                   TO AETAHHL                 15220000
152300             SET DP030-SET-CURSOR-APPL-1                          15230000
152400                 PS-ERROR TO TRUE                                 15240000
152500         ELSE                                                     15250000
152600             IF DP010I-NUMERIC-FIELD > PC-24                      15260000
152700                 SET PS-ERROR              TO TRUE                15270000
152800                 SET DP020-MSG-FATAL       TO TRUE                15280000
152900                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    15290000
153000                 MOVE DP015-UNP-NUM-BRT-OFF                       15300000
153100                                           TO AETAHHA             15310000
153200                 MOVE DP015-RED            TO AETAHHC             15320000
153300                 MOVE DP015-REVERSE        TO AETAHHH             15330000
153400                 MOVE -1                   TO AETAHHL             15340000
153500                 SET DP030-SET-CURSOR-APPL-1                      15350000
153600                     PS-ERROR TO TRUE                             15360000
153700             ELSE                                                 15370000
153800                 MOVE DP010I-NUMERIC-FIELD TO ASC-ETA-TIME-HH-N   15380000
153900                 MOVE ASC-ETA-TIME-HH  TO AETAHHO                 15390000
154000             END-IF                                               15400000
154100         END-IF                                                   15410000
154200     END-IF.                                                      15420000
154300                                                                  15430000
154400                                                                  15440000
154500     IF PS-ERROR OR                                               15450000
154600        ASC-ETA-TIME-MN = '00'                                    15460000
154700         CONTINUE                                                 15470000
154800     ELSE                                                         15480000
154900         MOVE ASC-ETA-TIME-MN      TO DP010I-UNEDITED-FIELD       15490000
155000         MOVE LENGTH OF ASC-ETA-TIME-MN TO DP010I-MAXIMUM-DIGITS  15500000
155100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     15510000
155200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15520000
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15531008
273427              USING DP010I-NUMERIC-EDIT-AREA                      15532008
155400         IF  DP010I-ERROR-DETECTED                                15540000
155500             SET PS-ERROR                                         15550000
155600                 DP020-MSG-FATAL   TO TRUE                        15560000
155700             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        15570000
155800             MOVE DP015-UNP-NUM-BRT-OFF                           15580000
155900                                       TO AETAMNA                 15590000
156000             MOVE DP015-RED            TO AETAMNC                 15600000
156100             MOVE DP015-REVERSE        TO AETAMNH                 15610000
156200             MOVE -1                   TO AETAMNL                 15620000
156300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15630000
156400         ELSE                                                     15640000
156500             IF DP010I-NUMERIC-FIELD > PC-59                      15650000
156600                 SET PS-ERROR              TO TRUE                15660000
156700                 SET DP020-MSG-FATAL       TO TRUE                15670000
156800                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    15680000
156900                 MOVE DP015-UNP-NUM-BRT-OFF                       15690000
157000                                           TO AETAMNA             15700000
157100                 MOVE DP015-RED            TO AETAMNC             15710000
157200                 MOVE DP015-REVERSE        TO AETAMNH             15720000
157300                 MOVE -1                   TO AETAMNL             15730000
157400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15740000
157500             ELSE                                                 15750000
157600                 MOVE DP010I-NUMERIC-FIELD TO ASC-ETA-TIME-MN-N   15760000
157700                 MOVE ASC-ETA-TIME-MN  TO AETAMNO                 15770000
157800             END-IF                                               15780000
157900         END-IF                                                   15790000
158000      END-IF.                                                     15800000
158100                                                                  15810000
158200     IF  ASC-ORIG-SCAC-ID > SPACES AND PS-NO-ERROR                15820000
158300         MOVE ASC-ORIG-SCAC-ID TO DK-SCAC                         15830000
158400         PERFORM 3340-VALIDATE-SCAC                               15840000
158500         IF  PS-INVALID-SCAC                                      15850000
158600             MOVE DP015-RED      TO AOSCACC                       15860000
158700             MOVE DP015-REVERSE  TO AOSCACH                       15870000
158800             MOVE -1             TO AOSCACL                       15880000
158900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15890000
159000             MOVE PC-TSYMSG-00148                                 15900000
159100                                 TO DP020-MSG-NUMBER              15910000
159200             SET DP020-MSG-FATAL TO TRUE                          15920000
159300             SET PS-ERROR        TO TRUE                          15930000
159400         ELSE                                                     15940000
159500             PERFORM 3345-GET-SCAC-NAME                           15950000
159600             MOVE ENTNME-ENT-NAME-DESC                            15960000
159700                             TO ASC-ORIG-SCAC-DESC                15970000
159800                                AOSCACDO                          15980000
159900         END-IF                                                   15990000
160000     ELSE                                                         16000000
160100         IF PS-NO-ERROR                                           16010000
160200            MOVE SPACES TO ASC-ORIG-SCAC-DESC                     16020000
160300                           AOSCACDO                               16030000
160400         END-IF                                                   16040000
160500     END-IF.                                                      16050000
160600                                                                  16060000
160700     IF  ASC-PRO-SCAC-ID > SPACES AND PS-NO-ERROR                 16070000
160800         MOVE ASC-PRO-SCAC-ID TO DK-SCAC                          16080000
160900         PERFORM 3340-VALIDATE-SCAC                               16090000
161000         IF  PS-INVALID-SCAC                                      16100000
161100             MOVE DP015-RED      TO ADSCACC                       16110000
161200             MOVE DP015-REVERSE  TO ADSCACH                       16120000
161300             MOVE -1             TO ADSCACL                       16130000
161400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16140000
161500             MOVE PC-TSYMSG-00148                                 16150000
161600                                 TO DP020-MSG-NUMBER              16160000
161700             SET DP020-MSG-FATAL TO TRUE                          16170000
161800             SET PS-ERROR        TO TRUE                          16180000
161900         ELSE                                                     16190000
162000             PERFORM 3345-GET-SCAC-NAME                           16200000
162100             MOVE ENTNME-ENT-NAME-DESC                            16210000
162200                             TO ASC-PRO-SCAC-DESC                 16220000
162300                                ADSCACDO                          16230000
162400         END-IF                                                   16240000
162500      ELSE                                                        16250000
162600         IF PS-NO-ERROR                                           16260000
162700            MOVE SPACES TO ASC-PRO-SCAC-DESC                      16270000
162800                           ADSCACDO                               16280000
162900         END-IF                                                   16290000
163000     END-IF.                                                      16300000
163100                                                                  16310000
163200     IF  PS-NO-ERROR                                              16320000
163300         MOVE -1                   TO AFBNBRL                     16330000
163400         SET DP030-SET-CURSOR-APPL-1                              16340000
163500                                   TO TRUE                        16350000
163600     END-IF.                                                      16360000
163700                                                                  16370000
163800*                                                                 16380000
163900*                                                                 16390000
164000                                                                  16400000
164100 3200-RESET-ATTRIBUTES.                                           16410000
164200*                                                                 16420000
164300     MOVE DP015-UNP-ALP-NOR-OFF    TO AFBNBRA                     16430000
164400                                      ABOLNBRA                    16440000
164500                                      AVNDMMA                     16450000
164600                                      AVNDDDA                     16460000
164700                                      AVNDYYA                     16470000
164800                                      AFBCNTA                     16480000
164900                                      AFBNBRA                     16490000
165000                                      ABOLNBRA                    16500000
165100                                      AOSCACA                     16510000
165200                                      ADSCACA                     16520000
165300                                      AAUTHNOA                    16530000
165400                                      AAUTHMMA                    16540000
165500                                      AAUTHDDA                    16550000
165600                                      AAUTHYYA                    16560000
165700                                      AOSCACA                     16570000
165800                                      ADSCACA                     16580000
165900                                      ATRLRNOA                    16590000
166000                                      AETAMMA                     16600000
166100                                      AETADDA                     16610000
166200                                      AETAYYA                     16620000
166300                                      AETAHHA                     16630000
166400                                      AETAMNA.                    16640000
166500     MOVE DP015-GREEN              TO AFBNBRC                     16650000
166600                                      ABOLNBRC                    16660000
166700                                      AVNDMMC                     16670000
166800                                      AVNDDDC                     16680000
166900                                      AVNDYYC                     16690000
167000                                      AFBCNTC                     16700000
167100                                      AFBNBRC                     16710000
167200                                      ABOLNBRC                    16720000
167300                                      AOSCACC                     16730000
167400                                      ADSCACC                     16740000
167500                                      AAUTHNOC                    16750000
167600                                      AAUTHMMC                    16760000
167700                                      AAUTHDDC                    16770000
167800                                      AAUTHYYC                    16780000
167900                                      AOSCACC                     16790000
168000                                      ADSCACC                     16800000
168100                                      ATRLRNOC                    16810000
168200                                      AETAMMC                     16820000
168300                                      AETADDC                     16830000
168400                                      AETAYYC                     16840000
168500                                      AETAHHC                     16850000
168600                                      AETAMNC.                    16860000
168700     MOVE DP015-UNDERLINE          TO AFBNBRH                     16870000
168800                                      ABOLNBRH                    16880000
168900                                      AFBCNTH                     16890000
169000                                      AVNDMMH                     16900000
169100                                      AVNDDDH                     16910000
169200                                      AVNDYYH                     16920000
169300                                      AFBNBRH                     16930000
169400                                      ABOLNBRH                    16940000
169500                                      AOSCACH                     16950000
169600                                      ADSCACH                     16960000
169700                                      AAUTHNOH                    16970000
169800                                      AAUTHMMH                    16980000
169900                                      AAUTHDDH                    16990000
170000                                      AAUTHYYH                    17000000
170100                                      AOSCACH                     17010000
170200                                      ADSCACH                     17020000
170300                                      ATRLRNOH                    17030000
170400                                      AETAMMH                     17040000
170500                                      AETADDH                     17050000
170600                                      AETAYYH                     17060000
170700                                      AETAHHH                     17070000
170800                                      AETAMNH.                    17080000
170900                                                                  17090000
171000*    MOVE DP015-BLUE               TO AASNCNTC                    17100000
171100*                                     AFORCNTC.                   17110000
171200                                                                  17120000
171300 3340-VALIDATE-SCAC.                                              17130000
171400*----------------------------------------------------------------*17140000
171500*    ENSURE THE STANDARD CARRIER ALPHA CODE (SCAC) ENTERED ON    *17150000
171600*    THE SCREEN IS SET UP ON THE VENDOR DATABASE.                *17160000
171700*                                                                *17170000
171800*    PERFORMED FROM 3000-EDIT-DATA-IN-COMMAREA.                  *17180000
171900*----------------------------------------------------------------*17190000
171910* CLT 03/16/2012 WR40574 ADDED WITH UR      BELOW                 17191002
172000                                                                  17200000
172100     PERFORM WITH TEST AFTER                                      17210000
172200         VARYING PV-RETRY-COUNTER                                 17220000
172300         FROM 1 BY 1                                              17230000
172400         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 17240000
172500                 OR SQLCODE = 0                                   17250000
172600                 OR SQLCODE = +100)                               17260000
172700                                                                  17270000
172800         EXEC SQL                                                 17280000
172900             SELECT SCAC_CDE                                      17290000
173000             INTO   :EXTENT-SCAC-CDE                              17300000
173100             FROM   TEXTENT                                       17310000
173200             WHERE  SCAC_CDE    = :DK-SCAC                        17320000
173300             AND    CARRIER_IND = :PC-Y                           17330000
173310             WITH UR                                              17331002
173400         END-EXEC                                                 17340000
173500                                                                  17350000
173600         EVALUATE TRUE                                            17360000
173700             WHEN SQLCODE = ZERO                                  17370000
173800             WHEN SQLCODE = +100                                  17380000
173900             WHEN SQLCODE = -904                                  17390000
174000             WHEN SQLCODE = -913                                  17400000
174100                 CONTINUE                                         17410000
174200             WHEN SQLWARN0 NOT = SPACES                           17420000
174300             WHEN SQLCODE NOT EQUAL ZERO                          17430000
174400                 MOVE '3340-VALIDATE-SCAC'                        17440000
174500                                 TO DP013-PARAGRAPH               17450000
174600                 MOVE 'VALIDATE SCAC'                             17460000
174700                                 TO DP013-MESSAGE-TEXT(1)         17470000
174800                 MOVE DK-SCAC    TO DP013-MESSAGE-TEXT(2)         17480000
174900                 MOVE SQLCA      TO DP013-SQLCA                   17490000
175000                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME(1)       17500000
175100                 SET DP013-DB2-ABEND                              17510000
175200                                 TO TRUE                          17520000
175300                 SET DP013-NO-ROLLBACK                            17530000
175400                                 TO TRUE                          17540000
175500                 SET DP013-XCTL-DISPLAY-RESTART                   17550000
175600                                 TO TRUE                          17560000
175700                 PERFORM DP013-0000-PROCESS-ABEND                 17570000
175800         END-EVALUATE                                             17580000
175900     END-PERFORM.                                                 17590000
176000                                                                  17600000
176100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         17610000
176200         MOVE '3340-VALIDATE-SCAC'                                17620000
176300                                 TO DP013-PARAGRAPH               17630000
176400         MOVE 'VALIDATE SCAC'    TO DP013-MESSAGE-TEXT(1)         17640000
176500         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    17650000
176600                                 TO DP013-MESSAGE-TEXT(2)         17660000
176700         MOVE SQLCA              TO DP013-SQLCA                   17670000
176800         MOVE 'TEXTENT'          TO DP013-DB2-TABLE-NAME(1)       17680000
176900         SET DP013-DB2-ABEND     TO TRUE                          17690000
177000         SET DP013-NO-ROLLBACK   TO TRUE                          17700000
177100         SET DP013-XCTL-DISPLAY-RESTART                           17710000
177200                                 TO TRUE                          17720000
177300         PERFORM DP013-0000-PROCESS-ABEND                         17730000
177400     END-IF.                                                      17740000
177500                                                                  17750000
177600     EVALUATE TRUE                                                17760000
177700         WHEN SQLCODE = ZERO                                      17770000
177800              SET PS-VALID-SCAC  TO TRUE                          17780000
177900         WHEN SQLCODE = +100                                      17790000
178000              SET PS-INVALID-SCAC                                 17800000
178100                                 TO TRUE                          17810000
178200     END-EVALUATE.                                                17820000
178300                                                                  17830000
178400 EJECT                                                            17840000
178500                                                                  17850000
178600*----------------------------------------------------------------*17860000
178700*    GET THE SCAC DESC FROM THE EXTERNAL ENTERPRISE NAME TABLE   *17870000
178800*----------------------------------------------------------------*17880000
178810* CLT 03/16/2012 WR40574 ADDED WITH UR      BELOW                 17881002
178900                                                                  17890000
179000 3345-GET-SCAC-NAME.                                              17900000
179100                                                                  17910000
179200     PERFORM                                                      17920000
179300         WITH TEST AFTER                                          17930000
179400         VARYING PV-RETRY-COUNTER                                 17940000
179500         FROM 1 BY 1                                              17950000
179600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17960000
179700             OR (SQLCODE = +0)                                    17970000
179800             OR (SQLCODE = +100))                                 17980000
179900                                                                  17990000
180000         EXEC SQL                                                 18000000
180100              SELECT ENT_NAME_DESC                                18010000
180200                INTO :ENTNME-ENT-NAME-DESC                        18020000
180300                FROM TEXTENT A                                    18030000
180400                    ,TENTNME B                                    18040000
180500               WHERE A.SCAC_CDE    = :DK-SCAC                     18050000
180600                 AND A.CARRIER_IND = 'Y'                          18060000
180700                 AND B.TYPE_CDE    = '01'                         18070000
180800                 AND A.ENT_ID = B.ENT_ID                          18080000
180810               WITH UR                                            18081002
180900         END-EXEC                                                 18090000
181000                                                                  18100000
181100         EVALUATE TRUE                                            18110000
181200             WHEN SQLCODE = +0                                    18120000
181300             WHEN SQLCODE = +100                                  18130000
181400             WHEN SQLCODE = -904                                  18140000
181500             WHEN SQLCODE = -913                                  18150000
181600                  CONTINUE                                        18160000
181700                                                                  18170000
181800             WHEN SQLWARN0 NOT = SPACES                           18180000
181900             WHEN SQLCODE < +0                                    18190000
182000             WHEN SQLCODE > +0                                    18200000
182100                  MOVE '3345-GET-SCAC-NAME'                       18210000
182200                                  TO DP013-PARAGRAPH              18220000
182300                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME TABLE'     18230000
182400                                  TO DP013-MESSAGE-TEXT (1)       18240000
182500                  MOVE DK-SCAC    TO DP013-MESSAGE-TEXT (2)       18250000
182600                  MOVE SQLCA      TO DP013-SQLCA                  18260000
182700                  MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)     18270000
182800                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)     18280000
182900                  SET DP013-DB2-ABEND                             18290000
183000                      DP013-XCTL-DISPLAY-RESTART                  18300000
183100                                  TO TRUE                         18310000
183200                  PERFORM DP013-0000-PROCESS-ABEND                18320000
183300         END-EVALUATE                                             18330000
183400     END-PERFORM.                                                 18340000
183500                                                                  18350000
183600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18360000
183700         MOVE '3345-GET-SCAC-NAME'                                18370000
183800                                  TO DP013-PARAGRAPH              18380000
183900         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME TABLE'      18390000
184000                                  TO DP013-MESSAGE-TEXT (1)       18400000
184100         MOVE SQLCA               TO DP013-SQLCA                  18410000
184200         MOVE 'TEXTENT'           TO DP013-DB2-TABLE-NAME (1)     18420000
184300         MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (2)     18430000
184400         SET DP013-DB2-ABEND                                      18440000
184500             DP013-XCTL-DISPLAY-RESTART                           18450000
184600                                  TO TRUE                         18460000
184700         PERFORM DP013-0000-PROCESS-ABEND                         18470000
184800     END-IF.                                                      18480000
184900                                                                  18490000
185000 3350-VALIDATE-ETA-DTE.                                           18500000
185100*----------------------------------------------------------------*18510000
185200*    ENSURE THE ESTIMATED TIME OF ARRIVAL ENTERED ON THE SCREEN  *18520000
185300*    IS IN VALID MM DD CCYY FORMAT.  IF THE CCYY IS NOT ENTERED, *18530000
185400*    THE CURRENT CCYY IS USED.                                   *18540000
185500*                                                                *18550000
185600*    PERFORMED FROM 3000-EDIT-DATA-IN-COMMAREA.                  *18560000
185700*----------------------------------------------------------------*18570000
185800                                                                  18580000
185900     MOVE ASC-ETA-MM             TO PV-INPUT-DATE-MM              18590000
186000                                    PV-VALID-DATE-MM.             18600000
186100     MOVE ASC-ETA-DD             TO PV-INPUT-DATE-DD              18610000
186200                                    PV-VALID-DATE-DD.             18620000
186300                                                                  18630000
186400     MOVE ASC-ETA-CCYY           TO PV-INPUT-DATE-CCYY            18640000
186500                                    PV-VALID-DATE-CCYY.           18650000
186600                                                                  18660000
186700     PERFORM 3700-VALIDATE-DATE.                                  18670000
186800                                                                  18680000
186900     IF PS-VALID-DATE                                             18690000
187000         MOVE PV-INPUT-DATE-MM   TO ASC-ETA-MM                    18700000
187100         MOVE PV-INPUT-DATE-DD   TO ASC-ETA-DD                    18710000
187200         MOVE PV-INPUT-DATE-CCYY TO ASC-ETA-CCYY                  18720000
187300         PERFORM 3500-CALL-DATE-RTN                               18730000
187400                                                                  18740000
187500         IF DPG54-DATE-VALID                                      18750000
187600             SET PS-VALID-ETA-DTE  TO TRUE                        18760000
187700             MOVE DPG55-GREG-CC-DATE                              18770000
187800                                 TO PV-VALID-ETA-DTE              18780000
187900         ELSE                                                     18790000
188000             SET PS-INVALID-ETA-DTE                               18800000
188100                                   TO TRUE                        18810000
188200         END-IF                                                   18820000
188300     ELSE                                                         18830000
188400         SET PS-INVALID-ETA-DTE    TO TRUE                        18840000
188500     END-IF.                                                      18850000
188600                                                                  18860000
188700 EJECT                                                            18870000
188800                                                                  18880000
188900 3360-VALIDATE-VEND-SHIP-DTE.                                     18890000
189000*----------------------------------------------------------------*18900000
189100*                                                                *18910000
189200*    PERFORMED FROM 3000-EDIT-DATA-IN-COMMAREA.                  *18920000
189300*----------------------------------------------------------------*18930000
189400                                                                  18940000
189500     MOVE ASC-VEND-SHIP-MM       TO PV-INPUT-DATE-MM              18950000
189600                                    PV-VALID-DATE-MM.             18960000
189700     MOVE ASC-VEND-SHIP-DD       TO PV-INPUT-DATE-DD              18970000
189800                                    PV-VALID-DATE-DD.             18980000
189900                                                                  18990000
190000     MOVE ASC-VEND-SHIP-CCYY     TO PV-INPUT-DATE-CCYY            19000000
190100                                    PV-VALID-DATE-CCYY.           19010000
190200                                                                  19020000
190300     PERFORM 3700-VALIDATE-DATE.                                  19030000
190400                                                                  19040000
190500     IF PS-VALID-DATE                                             19050000
190600         MOVE PV-INPUT-DATE-MM   TO ASC-VEND-SHIP-MM              19060000
190700                                    ASC-VEND-SHIP-MM-OLD          19070000
190800         MOVE PV-INPUT-DATE-DD   TO ASC-VEND-SHIP-DD              19080000
190900                                    ASC-VEND-SHIP-DD-OLD          19090000
191000         MOVE PV-INPUT-DATE-CCYY TO ASC-VEND-SHIP-CCYY            19100000
191100                                    ASC-VEND-SHIP-CCYY-OLD        19110000
191200         PERFORM 3500-CALL-DATE-RTN                               19120000
191300                                                                  19130000
191400         IF DPG54-DATE-VALID                                      19140000
191500             SET PS-VALID-VND-DTE  TO TRUE                        19150000
191600     ELSE                                                         19160000
191700         SET PS-INVALID-VND-DTE    TO TRUE                        19170000
191800     END-IF.                                                      19180000
191900                                                                  19190000
192000 3365-CHK-VND-DATE-RANGE.                                         19200000
192100     EXEC SQL                                                     19210000
192200         SET :PV-DB2-CURRENT-DATE = CURRENT_DATE                  19220000
192300     END-EXEC.                                                    19230000
192400                                                                  19240000
192500****** GET CURRENT DATE MINUS PC-VALID-VND-DT-RANGE               19250000
192600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              19260000
192700     SET DPG51-ACTUAL-CALENDAR-ONLY                               19270000
192800         DPG51-DECREMENT-DATE                                     19280000
192900         DPG52-LK-DTE-ISO-FMT      TO TRUE.                       19290000
193000                                                                  19300000
193100     MOVE PC-VALID-VND-DT-RANGE TO DPG51-INCR-DECR-DAYS-9.        19310000
193200     MOVE PV-DB2-CURRENT-DATE TO DPG52-LK-DATE-INPUT.             19320000
193300                                                                  19330000
193400     CALL DP500-KOHLS-CALENDAR-ROUTINE                            19340000
193500             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.           19350000
193600                                                                  19360000
193700     IF DPG54-INCR-DECR-VALID                                     19370000
193800         MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DB2-CURRENT-DATE-M7DD  19380000
193900         MOVE ASC-VEND-SHIP-MM   TO PV-VND-SHIP-MM                19390000
194000         MOVE ASC-VEND-SHIP-DD   TO PV-VND-SHIP-DD                19400000
194100         MOVE ASC-VEND-SHIP-CCYY TO PV-VND-SHIP-CCYY              19410000
194200***** CHECK IF VEND SHIP DATE WITHIN THE RANGE                    19420000
194300         IF PV-VND-SHIP-DATE-FMT > PV-DB2-CURRENT-DATE OR         19430000
194400            PV-VND-SHIP-DATE-FMT < PV-DB2-CURRENT-DATE-M7DD       19440000
194500             SET PS-INVALID-VND-DT-RANGE TO TRUE                  19450000
194600         ELSE                                                     19460000
194700             SET PS-VALID-VND-DT-RANGE TO TRUE                    19470000
194800         END-IF                                                   19480000
194900     ELSE                                                         19490000
195000         SET PS-INVALID-VND-DT-RANGE TO TRUE                      19500000
195100     END-IF.                                                      19510000
195200                                                                  19520000
195300                                                                  19530000
195400 3370-VALIDATE-AUTH-DTE.                                          19540000
195500*----------------------------------------------------------------*19550000
195600*                                                                *19560000
195700*    PERFORMED FROM 3300-EDIT-DATA-IN-COMMAREA.                  *19570000
195800*----------------------------------------------------------------*19580000
195900                                                                  19590000
196000     MOVE ASC-AUTH-MM            TO PV-INPUT-DATE-MM              19600000
196100                                    PV-VALID-DATE-MM.             19610000
196200     MOVE ASC-AUTH-DD            TO PV-INPUT-DATE-DD              19620000
196300                                    PV-VALID-DATE-DD.             19630000
196400                                                                  19640000
196500     MOVE ASC-AUTH-CCYY          TO PV-INPUT-DATE-CCYY            19650000
196600                                    PV-VALID-DATE-CCYY.           19660000
196700                                                                  19670000
196800     PERFORM 3700-VALIDATE-DATE.                                  19680000
196900                                                                  19690000
197000     IF PS-VALID-DATE                                             19700000
197100         MOVE PV-INPUT-DATE-MM   TO ASC-AUTH-MM                   19710000
197200         MOVE PV-INPUT-DATE-DD   TO ASC-AUTH-DD                   19720000
197300         MOVE PV-INPUT-DATE-CCYY TO ASC-AUTH-CCYY                 19730000
197400         PERFORM 3500-CALL-DATE-RTN                               19740000
197500                                                                  19750000
197600         IF DPG54-DATE-VALID                                      19760000
197700             SET PS-VALID-AUTH-DTE TO TRUE                        19770000
197800         ELSE                                                     19780000
197900             SET PS-INVALID-AUTH-DTE                              19790000
198000                                   TO TRUE                        19800000
198100         END-IF                                                   19810000
198200     ELSE                                                         19820000
198300         SET PS-INVALID-AUTH-DTE   TO TRUE                        19830000
198400     END-IF.                                                      19840000
198500                                                                  19850000
198600 EJECT                                                            19860000
198700                                                                  19870000
198800 3400-CALL-DATE-RANGE-RTN.                                        19880000
198900*----------------------------------------------------------------*19890000
199000*    SETS ALL THE PROPER INDICATORS FOR A DATE VALIDATION AND    *19900000
199100*    DATE RANGE COMPARISON.                                      *19910000
199200*                                                                *19920000
199300*    PERFORMED FROM 3300-EDIT-DATA-IN-COMMAREA.                  *19930000
199400*----------------------------------------------------------------*19940000
199500     INITIALIZE DPG51 DPG52 DPG53                                 19950000
199600                DPG54 DPG55 DPG56.                                19960000
199700     SET DPG51-ACTUAL-CALENDAR-ONLY                               19970000
199800                                 TO TRUE.                         19980000
199900     SET DPG52-LK-DTE-GREG-CC    TO TRUE.                         19990000
200000*    SET DPG52-LK-DTE-GREG       TO TRUE.                         20000000
200100     SET DPG53-LK-CMPR-DTE-GREG-CC                                20010000
200200*    SET DPG53-LK-CMPR-DTE-GREG                                   20020000
200300                                 TO TRUE.                         20030000
200400     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     20040000
200500                                                                  20050000
200600     MOVE PV-VALID-ETA-DTE       TO DPG52-LK-DATE-INPUT.          20060000
200700     MOVE PV-VALID-ETA-DTE-2     TO DPG53-LK-CMPR-DATE-INPUT.     20070000
200800                                                                  20080000
200900     CALL DP500-KOHLS-CALENDAR-ROUTINE                            20090000
201000         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               20100000
201100                                                                  20110000
201200 EJECT                                                            20120000
201300                                                                  20130000
201400 3500-CALL-DATE-RTN.                                              20140000
201500*----------------------------------------------------------------*20150000
201600*    SETS ALL THE PROPER INDICATORS FOR A DATE VALIDATION        *20160000
201700*                                                                *20170000
201800*    PERFORMED BY 3350-VALIDATE-ETA-DATE.                        *20180000
201900*----------------------------------------------------------------*20190000
202000                                                                  20200000
202100     INITIALIZE DPG51 DPG52 DPG53                                 20210000
202200                DPG54 DPG55 DPG56.                                20220000
202300     SET DPG51-ACTUAL-CALENDAR-ONLY                               20230000
202400                                 TO TRUE.                         20240000
202500     SET DPG52-LK-DTE-GREG-CC    TO TRUE.                         20250000
202600                                                                  20260000
202700     MOVE PV-INPUT-DATE          TO DPG52-LK-DATE-INPUT.          20270000
202800                                                                  20280000
202900     CALL DP500-KOHLS-CALENDAR-ROUTINE                            20290000
203000         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               20300000
203100                                                                  20310000
203200 EJECT                                                            20320000
203300                                                                  20330000
203400 3600-CHECK-FOR-CHANGES.                                          20340000
203500                                                                  20350000
203600     IF  ASC-PRO-NBR         =  ASC-PREV-PRO-NBR        AND       20360000
203700         ASC-BOL-NBR         =  ASC-PREV-BOL-NBR        AND       20370000
203800         ASC-PRO-SCAC-ID     =  ASC-PREV-PRO-SCAC-ID              20380000
203900         CONTINUE                                                 20390000
204000     ELSE                                                         20400000
204100         PERFORM 3615-CHECK-SHIPMENT                              20410000
204200         IF PS-SHIPMENT-EXIST                                     20420000
204300            MOVE PC-TSYMSG-00992 TO DP020-MSG-NUMBER              20430000
204400            MOVE TRIPST-TRIP-STATUS-CDE TO DP020-MSG-TEXT         20440000
204500            SET DP020-MSG-FATAL                                   20450000
204600                PS-ERROR TO TRUE                                  20460000
204700            MOVE DP015-RED TO AFBNBRC                             20470000
204800                              ABOLNBRC                            20480000
204900                              ADSCACC                             20490000
205000         ELSE                                                     20500000
205100            SET PS-TSHIPMT-AUD-SHIPTID                            20510000
205200                PS-CHANGES-OCCURRED TO TRUE                       20520000
205300            PERFORM 3715-UPDATE-TSHIPMT-PROBOL                    20530000
205400         END-IF                                                   20540000
205500      END-IF.                                                     20550000
205600                                                                  20560000
205700     IF ASC-ORIG-SCAC-ID    =  ASC-PREV-ORIG-SCAC-ID   AND        20570000
205800        ASC-FB-CARTON-CNT   =  ASC-PREV-FB-CARTON-CNT  AND        20580000
205900        ASC-VEND-SHIP-DTE   =  ASC-PREV-VEND-SHIP-DTE  AND        20590000
206000        ASC-AUTH-DTE        =  ASC-PREV-AUTH-DTE       AND        20600000
206100        ASC-ETA-DTE         =  ASC-PREV-ETA-DTE        AND        20610000
206200        ASC-ETA-TIME        =  ASC-PREV-ETA-TIME       AND        20620000
206300        ASC-AUTH-NBR        =  ASC-PREV-AUTH-NBR                  20630000
206400           NEXT SENTENCE                                          20640000
206500     ELSE                                                         20650000
206600         IF PS-NO-ERROR                                           20660000
206700             SET PS-TSHIPMT-AUD-SHIPTID                           20670000
206800                 PS-CHANGES-OCCURRED TO TRUE                      20680000
206900             PERFORM 3710-UPDATE-TSHIPMT                          20690000
207000             IF ASC-ETA-DTE = ASC-PREV-ETA-DTE AND                20700000
207100                ASC-ETA-TIME = ASC-PREV-ETA-TIME                  20710000
207200                  CONTINUE                                        20720000
207300             ELSE                                                 20730000
207400                  PERFORM 3676-UPDATE-TVHTRIP                     20740000
207500                  SET PS-TVHTRIP-AUD-TRIPID TO TRUE               20750000
207600             END-IF                                               20760000
207700         END-IF                                                   20770000
207800     END-IF.                                                      20780000
207900                                                                  20790000
208000     IF  ASC-VEH-NBR     =  ASC-PREV-VEH-NBR  AND                 20800000
208100         ASC-PRO-SCAC-ID =  ASC-PREV-PRO-SCAC-ID                  20810000
208200         NEXT SENTENCE                                            20820000
208300     ELSE                                                         20830000
208400         IF PS-NO-ERROR                                           20840000
208500            IF ASC-VEH-NBR > SPACES                               20850000
208600               PERFORM 3605-DETERMINE-UPDATES                     20860000
208700            ELSE                                                  20870000
208800               SET PS-CHANGES-OCCURRED TO TRUE                    20880000
208900               PERFORM 3725-UPDATE-TSHIPMT-SCACONLY               20890000
209000               PERFORM 3730-UPDATE-TVHTRIP-SCACONLY               20900000
209100               IF ASC-DN-VEH-NBR NOT = -1                         20910000
209200                  SET PS-CHANGES-OCCURRED TO TRUE                 20920000
209300                  MOVE -1 TO DN-VEH-NBR                           20930000
209400                  PERFORM 3670-UPDATE-TVHTRIP-TRIP                20940000
209500                  PERFORM 3697-RELEASE-OLD-VEHICLE                20950000
209600                  MOVE SPACES TO DK-VEH-NBR                       20960000
209700                  PERFORM 3660-UPDATE-TSHIPMT-TRIPSHIP            20970000
209800               END-IF                                             20980000
209900            END-IF                                                20990000
210000         END-IF                                                   21000000
210100      END-IF.                                                     21010000
210200                                                                  21020000
210300      IF PS-TSHIPMT-AUD-SHIPTID                                   21030000
210400         PERFORM 5010-AUDIT-SHIPMENT                              21040000
210500      END-IF.                                                     21050000
210600                                                                  21060000
210700      IF PS-TVHTRIP-AUD-TRIPID                                    21070000
210800         MOVE ASC-TRIP-ID TO DK-TRIP-ID                           21080000
210900         PERFORM 5000-AUDIT-TRIP                                  21090000
211000      END-IF.                                                     21100000
211100                                                                  21110000
211200      IF PS-TVHTRIP-AUD-TRIPID-N                                  21120000
211300         MOVE PV-TRIP-ID TO DK-TRIP-ID                            21130000
211400         PERFORM 5000-AUDIT-TRIP                                  21140000
211500      END-IF.                                                     21150000
211600                                                                  21160000
211700      IF PS-TVEHICL-AUD-VEHSCAC                                   21170000
211800         MOVE ASC-VEH-NBR     TO DK-VEH-NBR                       21180000
211900         MOVE ASC-PRO-SCAC-ID TO DK-PRO-SCAC-ID                   21190000
212000         PERFORM 5020-AUDIT-TVEHICL                               21200000
212100      END-IF.                                                     21210000
212200                                                                  21220000
212300      IF PS-TVEHICL-AUD-PVEHSCAC                                  21230000
212400         MOVE ASC-PREV-VEH-NBR     TO DK-VEH-NBR                  21240000
212500         MOVE ASC-PREV-PRO-SCAC-ID TO DK-PRO-SCAC-ID              21250000
212600         PERFORM 5020-AUDIT-TVEHICL                               21260000
212700      END-IF.                                                     21270000
212800                                                                  21280000
212900 3605-DETERMINE-UPDATES.                                          21290000
213000                                                                  21300000
213100     PERFORM 3610-CHECK-TRIP.                                     21310000
213200     IF PS-FOUND                                                  21320000
213300        IF DN-TRIP-ID = -1                                        21330000
213400           SET PS-CHANGES-OCCURRED TO TRUE                        21340000
213500           PERFORM 3650-GET-COUNT                                 21350000
213600           IF PV-COUNT > 1                                        21360000
213700              PERFORM 3950-GET-RANDOM-NUMBER                      21370000
213800              PERFORM 3960-READ-DUPL-TVHTRIP                      21380000
213900                      WITH TEST AFTER                             21390000
214000                      UNTIL PV-VHTRIP-COUNT = 0                   21400000
214100              MOVE +1 TO DN-VEH-NBR                               21410000
214200              PERFORM 3690-INSERT-TVHTRIP                         21420000
214300              MOVE PV-TRIP-ID TO PV-NEW-TRIP-ID                   21430000
214400              PERFORM 3630-UPDATE-TSHIPMT-NEWTRIP                 21440000
214500           ELSE                                                   21450000
214600              MOVE +1 TO DN-VEH-NBR                               21460000
214700              PERFORM 3670-UPDATE-TVHTRIP-TRIP                    21470000
214800              MOVE ASC-VEH-NBR TO DK-VEH-NBR                      21480000
214900              PERFORM 3660-UPDATE-TSHIPMT-TRIPSHIP                21490000
215000              IF ASC-DN-VEH-NBR NOT EQUAL -1                      21500000
215100                 PERFORM 3697-RELEASE-OLD-VEHICLE                 21510000
215200              END-IF                                              21520000
215300           END-IF                                                 21530000
215400           MOVE ASC-VEH-NBR TO DK-VEH-NBR                         21540000
215500           MOVE ASC-PRO-SCAC-ID TO DK-PRO-SCAC-ID                 21550000
215600           MOVE +1 TO DN-TRIP-ID                                  21560000
215700           MOVE 'EN' TO PV-STATUS-CDE                             21570000
215800           PERFORM 3640-UPDATE-TVEHICL-TRIP                       21580000
215900           IF SQLCODE = +0                                        21590000
216000              SET PS-TVEHICL-AUD-VEHSCAC TO TRUE                  21600000
216100           END-IF                                                 21610000
216200        ELSE                                                      21620000
216300           MOVE PV-NEW-TRIP-ID TO DK-TRIP-ID                      21630000
216400           PERFORM 3620-GET-STATUS                                21640000
216500           IF TRSTYP-PRTY-CDE <= '30'                             21650000
216600              SET PS-CHANGES-OCCURRED TO TRUE                     21660000
216700              PERFORM 3720-GET-ETA-DATE                           21670000
216800              IF DPG55-DAYS-DIFFERENCE > 3 OR                     21680000
216900                 DPG55-DAYS-DIFFERENCE < -3                       21690000
217000* * THE DIFFERENCE IS OUTSIDE THE +-3 DAY VARIENCE                21700000
217100                 PERFORM 3650-GET-COUNT                           21710000
217200                 MOVE PC-TSYMSG-01039 TO DP020-MSG-NUMBER         21720000
217300                 SET DP020-MSG-INFORMATIONAL                      21730000
217400                     PS-MSG-SET       TO TRUE                     21740000
217500                 IF PV-COUNT > 1                                  21750000
217600                    PERFORM 3950-GET-RANDOM-NUMBER                21760000
217700                    PERFORM 3960-READ-DUPL-TVHTRIP                21770000
217800                            WITH TEST AFTER                       21780000
217900                            UNTIL PV-VHTRIP-COUNT = 0             21790000
218000                    MOVE -1 TO DN-VEH-NBR                         21800000
218100                    PERFORM 3690-INSERT-TVHTRIP                   21810000
218200                    MOVE PV-TRIP-ID TO PV-NEW-TRIP-ID             21820000
218300                    MOVE SPACES TO ASC-VEH-NBR                    21830000
218400                    PERFORM 3630-UPDATE-TSHIPMT-NEWTRIP           21840000
218500                 ELSE                                             21850000
218600                    MOVE -1 TO DN-VEH-NBR                         21860000
218700                    PERFORM 3675-UPDATE-TVHTRIP-VEHONLY           21870000
218800                    MOVE SPACES TO ASC-VEH-NBR                    21880000
218900                    PERFORM 3665-UPDATE-TSHIPMT-VEHONLY           21890000
219000                    IF ASC-DN-VEH-NBR NOT EQUAL -1                21900000
219100                       PERFORM 3697-RELEASE-OLD-VEHICLE           21910000
219200                    END-IF                                        21920000
219300                 END-IF                                           21930000
219400              ELSE                                                21940000
219500* * THE DIFFERENCE IS WITHIN THE +-3 DAY VARIENCE                 21950000
219600                 PERFORM 3630-UPDATE-TSHIPMT-NEWTRIP              21960000
219700                 PERFORM 3650-GET-COUNT                           21970000
219800                 IF PV-COUNT > 0                                  21980000
219900                    CONTINUE                                      21990000
220000                 ELSE                                             22000000
220100                    SET PS-DELETE-VHTRIP TO TRUE                  22010000
220200                    MOVE ASC-TRIP-ID TO DK-TRIP-ID                22020000
220300                    PERFORM 5000-AUDIT-TRIP                       22030000
220400                    PERFORM 3655-DELETE-TVHTRIP                   22040000
220500                    SET PS-UPDATE-VHTRIP TO TRUE                  22050000
220600                    IF ASC-DN-VEH-NBR NOT EQUAL -1                22060000
220700                       PERFORM 3697-RELEASE-OLD-VEHICLE           22070000
220800                    END-IF                                        22080000
220900                 END-IF                                           22090000
221000              END-IF                                              22100000
221100           ELSE                                                   22110000
221200              MOVE PC-TSYMSG-01015 TO DP020-MSG-NUMBER            22120000
221300              MOVE TRIPST-TRIP-STATUS-CDE                         22130000
221400                                   TO DP020-MSG-TEXT              22140000
221500              SET DP020-MSG-FATAL                                 22150000
221600                  PS-ERROR         TO TRUE                        22160000
221700              MOVE DP015-RED       TO ADSCACC                     22170000
221800                                      ATRLRNOC                    22180000
221900           END-IF                                                 22190000
222000        END-IF                                                    22200000
222100     ELSE                                                         22210000
222200* *  VEHICLE WAS NOT FOUND, SO ADD IT                             22220000
222300        SET PS-CHANGES-OCCURRED TO TRUE                           22230000
222400        PERFORM 3650-GET-COUNT                                    22240000
222500        IF PV-COUNT > 1                                           22250000
222600           PERFORM 3950-GET-RANDOM-NUMBER                         22260000
222700           PERFORM 3960-READ-DUPL-TVHTRIP                         22270000
222800                   WITH TEST AFTER                                22280000
222900                   UNTIL PV-VHTRIP-COUNT = 0                      22290000
223000           MOVE +1 TO DN-VEH-NBR                                  22300000
223100           PERFORM 3690-INSERT-TVHTRIP                            22310000
223200           MOVE PV-TRIP-ID TO PV-NEW-TRIP-ID                      22320000
223300                              ASC-TRIP-ID                         22330000
223400           PERFORM 3630-UPDATE-TSHIPMT-NEWTRIP                    22340000
223500        ELSE                                                      22350000
223600           MOVE ASC-VEH-NBR TO DK-VEH-NBR                         22360000
223700           PERFORM 3660-UPDATE-TSHIPMT-TRIPSHIP                   22370000
223800           MOVE +1 TO DN-VEH-NBR                                  22380000
223900           PERFORM 3670-UPDATE-TVHTRIP-TRIP                       22390000
224000           IF ASC-DN-VEH-NBR NOT EQUAL -1                         22400000
224100              PERFORM 3697-RELEASE-OLD-VEHICLE                    22410000
224200           END-IF                                                 22420000
224300        END-IF                                                    22430000
224400        PERFORM 3680-INSERT-TVEHICL                               22440000
224500     END-IF.                                                      22450000
224600                                                                  22460000
224700 3610-CHECK-TRIP.                                                 22470000
224800                                                                  22480000
224900     PERFORM                                                      22490000
225000         WITH TEST AFTER                                          22500000
225100         VARYING PV-RETRY-COUNTER                                 22510000
225200         FROM 1 BY 1                                              22520000
225300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22530000
225400                   OR (SQLCODE = ZERO)                            22540000
225500                   OR (SQLCODE = +100))                           22550000
225600                                                                  22560000
225700         EXEC SQL                                                 22570000
225800             SELECT CURR_TRIP_ID                                  22580000
225900             INTO   :PV-NEW-TRIP-ID :DN-TRIP-ID                   22590000
226000             FROM   TVEHICL                                       22600000
226100             WHERE  VEH_NBR       = :ASC-VEH-NBR                  22610000
226200               AND  OWNER_SCAC_ID = :DK-SCAC                      22620000
226300         END-EXEC                                                 22630000
226400                                                                  22640000
226500                                                                  22650000
226600         EVALUATE TRUE                                            22660000
226700             WHEN SQLCODE = ZERO                                  22670000
226800             WHEN SQLCODE = +100                                  22680000
226900             WHEN SQLCODE = -904                                  22690000
227000             WHEN SQLCODE = -913                                  22700000
227100                 CONTINUE                                         22710000
227200                                                                  22720000
227300             WHEN SQLWARN0 NOT = SPACES                           22730000
227400             WHEN SQLCODE < ZERO                                  22740000
227500             WHEN SQLCODE > ZERO                                  22750000
227600                 MOVE SPACES TO PV-MESSAGE                        22760000
227700                 MOVE ASC-VEH-NBR TO PV-MESSAGE1                  22770000
227800                 MOVE DK-SCAC     TO PV-MESSAGE2                  22780000
227900                 MOVE '3610-CHECK-TRIP'                           22790000
228000                                 TO DP013-PARAGRAPH               22800000
228100                 MOVE 'CHECK NEW TRIP     '                       22810000
228200                                 TO DP013-MESSAGE-TEXT (1)        22820000
228300                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)        22830000
228400                 MOVE SQLCA      TO DP013-SQLCA                   22840000
228500                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (1)      22850000
228600                 SET DP013-DB2-ABEND                              22860000
228700                                 TO TRUE                          22870000
228800                 SET DP013-XCTL-DISPLAY-RESTART                   22880000
228900                                 TO TRUE                          22890000
229000                 PERFORM DP013-0000-PROCESS-ABEND                 22900000
229100         END-EVALUATE                                             22910000
229200     END-PERFORM.                                                 22920000
229300                                                                  22930000
229400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22940000
229500         MOVE '3610-CHECK-TRIP'                                   22950000
229600                                 TO DP013-PARAGRAPH               22960000
229700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22970000
229800                                 TO DP013-MESSAGE-TEXT (1)        22980000
229900         MOVE 'NEW TRIP FROM '   TO DP013-MESSAGE-TEXT (2)        22990000
230000         MOVE SQLCA              TO DP013-SQLCA                   23000000
230100         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (1)      23010000
230200         SET DP013-DB2-ABEND     TO TRUE                          23020000
230300         SET DP013-XCTL-DISPLAY-RESTART                           23030000
230400                                 TO TRUE                          23040000
230500         PERFORM DP013-0000-PROCESS-ABEND                         23050000
230600     END-IF.                                                      23060000
230700                                                                  23070000
230800     EVALUATE TRUE                                                23080000
230900        WHEN SQLCODE = +0                                         23090000
231000             SET PS-FOUND TO TRUE                                 23100000
231100        WHEN SQLCODE = +100                                       23110000
231200             SET PS-NOT-FOUND TO TRUE                             23120000
231300     END-EVALUATE.                                                23130000
231400                                                                  23140000
231500 3615-CHECK-SHIPMENT.                                             23150000
231600                                                                  23160000
231700     PERFORM                                                      23170000
231800         WITH TEST AFTER                                          23180000
231900         VARYING PV-RETRY-COUNTER                                 23190000
232000         FROM 1 BY 1                                              23200000
232100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23210000
232200                   OR (SQLCODE = ZERO)                            23220000
232300                   OR (SQLCODE = +100))                           23230000
232400                                                                  23240000
232500         EXEC SQL                                                 23250000
232600             SELECT TRIP_ID                                       23260000
232700             INTO   :SHIPMT-TRIP-ID                               23270000
232800             FROM   TSHIPMT A                                     23280000
232900             WHERE  PRO_NBR       = :ASC-PRO-NBR                  23290000
233000               AND  BOL_NBR       = :ASC-BOL-NBR                  23300000
233100               AND  PRO_SCAC_ID   = :ASC-PRO-SCAC-ID              23310000
233200         END-EXEC                                                 23320000
233300                                                                  23330000
233400                                                                  23340000
233500         EVALUATE TRUE                                            23350000
233600             WHEN SQLCODE = ZERO                                  23360000
233700             WHEN SQLCODE = +100                                  23370000
233800             WHEN SQLCODE = -904                                  23380000
233900             WHEN SQLCODE = -913                                  23390000
234000                 CONTINUE                                         23400000
234100                                                                  23410000
234200             WHEN SQLWARN0 NOT = SPACES                           23420000
234300             WHEN SQLCODE < ZERO                                  23430000
234400             WHEN SQLCODE > ZERO                                  23440000
234500                 MOVE SPACES TO PV-MESSAGE                        23450000
234600                 MOVE ASC-PRO-NBR TO PV-MESSAGE1                  23460000
234700                 MOVE ASC-BOL-NBR TO PV-MESSAGE2                  23470000
234800                 MOVE ASC-PRO-SCAC-ID TO PV-MESSAGE3              23480000
234900                 MOVE '3610-CHECK-TRIP'                           23490000
235000                                 TO DP013-PARAGRAPH               23500000
235100                 MOVE 'CHECK NEW TRIP     '                       23510000
235200                                 TO DP013-MESSAGE-TEXT (1)        23520000
235300                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)        23530000
235400                 MOVE SQLCA      TO DP013-SQLCA                   23540000
235500                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (1)      23550000
235600                 SET DP013-DB2-ABEND                              23560000
235700                                 TO TRUE                          23570000
235800                 SET DP013-XCTL-DISPLAY-RESTART                   23580000
235900                                 TO TRUE                          23590000
236000                 PERFORM DP013-0000-PROCESS-ABEND                 23600000
236100         END-EVALUATE                                             23610000
236200     END-PERFORM.                                                 23620000
236300                                                                  23630000
236400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23640000
236500         MOVE '3610-CHECK-TRIP'                                   23650000
236600                                 TO DP013-PARAGRAPH               23660000
236700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23670000
236800                                 TO DP013-MESSAGE-TEXT (1)        23680000
236900         MOVE 'NEW TRIP FROM '   TO DP013-MESSAGE-TEXT (2)        23690000
237000         MOVE SQLCA              TO DP013-SQLCA                   23700000
237100         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (1)      23710000
237200         SET DP013-DB2-ABEND     TO TRUE                          23720000
237300         SET DP013-XCTL-DISPLAY-RESTART                           23730000
237400                                 TO TRUE                          23740000
237500         PERFORM DP013-0000-PROCESS-ABEND                         23750000
237600     END-IF.                                                      23760000
237700                                                                  23770000
237800     EVALUATE TRUE                                                23780000
237900        WHEN SQLCODE = +0                                         23790000
238000             SET PS-FOUND TO TRUE                                 23800000
238100        WHEN SQLCODE = +100                                       23810000
238200             SET PS-NOT-FOUND TO TRUE                             23820000
238300     END-EVALUATE.                                                23830000
238400                                                                  23840000
238500     IF PS-FOUND                                                  23850000
238600        MOVE SHIPMT-TRIP-ID TO DK-TRIP-ID                         23860000
238700        PERFORM 3620-GET-STATUS                                   23870000
238800        SET PS-SHIPMENT-EXIST TO TRUE                             23880000
238900     ELSE                                                         23890000
239000        SET PS-SHIPMENT-DOESNT-EXIST TO TRUE                      23900000
239100     END-IF.                                                      23910000
239200                                                                  23920000
239300 3620-GET-STATUS.                                                 23930000
239400                                                                  23940000
239500     PERFORM                                                      23950000
239600         WITH TEST AFTER                                          23960000
239700         VARYING PV-RETRY-COUNTER                                 23970000
239800         FROM 1 BY 1                                              23980000
239900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23990000
240000                   OR (SQLCODE = ZERO))                           24000000
240100                                                                  24010000
240200         EXEC SQL                                                 24020000
240300            SELECT  A.TRIP_STATUS_CDE                             24030000
240400                   ,B.PRTY_CDE                                    24040000
240500              INTO :TRIPST-TRIP-STATUS-CDE                        24050000
240600                  ,:TRSTYP-PRTY-CDE                               24060000
240700              FROM  TTRIPST A                                     24070000
240800                   ,TTRSTYP B                                     24080000
240900             WHERE  A.TRIP_ID     = :DK-TRIP-ID                   24090000
241000               AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE         24100000
241100               AND  B.PRTY_CDE =                                  24110000
241200                   (SELECT DISTINCT                               24120000
241300                       MAX(D.PRTY_CDE)                            24130000
241400                    FROM   TTRIPST C                              24140000
241500                          ,TTRSTYP D                              24150000
241600                    WHERE C.TRIP_ID  = :DK-TRIP-ID                24160000
241700                      AND C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  24170000
241800         END-EXEC                                                 24180000
241900                                                                  24190000
242000         EVALUATE TRUE                                            24200000
242100             WHEN SQLCODE = ZERO                                  24210000
242200             WHEN SQLCODE = -904                                  24220000
242300             WHEN SQLCODE = -913                                  24230000
242400                 CONTINUE                                         24240000
242500                                                                  24250000
242600             WHEN SQLWARN0 NOT = SPACES                           24260000
242700             WHEN SQLCODE < ZERO                                  24270000
242800             WHEN SQLCODE > ZERO                                  24280000
242900                 MOVE '3620-GET-STATUS'                           24290000
243000                                 TO DP013-PARAGRAPH               24300000
243100                 MOVE 'GET STATUS FOR NEW TRIP'                   24310000
243200                                 TO DP013-MESSAGE-TEXT (1)        24320000
243300                 MOVE DK-TRIP-ID TO DP013-MESSAGE-TEXT (2)        24330000
243400                 MOVE SQLCA      TO DP013-SQLCA                   24340000
243500                 MOVE 'TTRIPST'  TO DP013-DB2-TABLE-NAME (1)      24350000
243600                 MOVE 'TTRSTYP'  TO DP013-DB2-TABLE-NAME (2)      24360000
243700                 SET DP013-DB2-ABEND                              24370000
243800                                 TO TRUE                          24380000
243900                 SET DP013-XCTL-DISPLAY-RESTART                   24390000
244000                                 TO TRUE                          24400000
244100                 PERFORM DP013-0000-PROCESS-ABEND                 24410000
244200         END-EVALUATE                                             24420000
244300     END-PERFORM.                                                 24430000
244400                                                                  24440000
244500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24450000
244600         MOVE '3620-GET-STATUS'                                   24460000
244700                                 TO DP013-PARAGRAPH               24470000
244800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     24480000
244900                                 TO DP013-MESSAGE-TEXT (1)        24490000
245000         MOVE 'STATUS CODE   '   TO DP013-MESSAGE-TEXT (2)        24500000
245100         MOVE SQLCA              TO DP013-SQLCA                   24510000
245200         MOVE 'TTRIPST'          TO DP013-DB2-TABLE-NAME (1)      24520000
245300         MOVE 'TTRSTYP'          TO DP013-DB2-TABLE-NAME (2)      24530000
245400         SET DP013-DB2-ABEND     TO TRUE                          24540000
245500         SET DP013-XCTL-DISPLAY-RESTART                           24550000
245600                                 TO TRUE                          24560000
245700         PERFORM DP013-0000-PROCESS-ABEND                         24570000
245800     END-IF.                                                      24580000
245900                                                                  24590000
246000 3630-UPDATE-TSHIPMT-NEWTRIP.                                     24600000
246100                                                                  24610000
246200     PERFORM                                                      24620000
246300         WITH TEST AFTER                                          24630000
246400         VARYING PV-RETRY-COUNTER                                 24640000
246500         FROM 1 BY 1                                              24650000
246600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24660000
246700                   OR (SQLCODE = ZERO))                           24670000
246800                                                                  24680000
246900         EXEC SQL                                                 24690000
247000            UPDATE TSHIPMT                                        24700000
247100               SET TRIP_ID         = :PV-NEW-TRIP-ID              24710000
247200                  ,VEH_NBR         = :ASC-VEH-NBR                 24720000
247300                  ,PRO_SCAC_ID     = :ASC-PRO-SCAC-ID             24730000
247400                  ,LAST_UPD_DTE    = CURRENT DATE                 24740000
247500                  ,LAST_UPD_TME    = CURRENT TIME                 24750000
247600                  ,LAST_UPD_UID    = :DP020-USERID                24760000
247700                  ,LAST_UPD_PGM_ID = :PC-CURRENT-PROGRAM-NAME     24770000
247800               WHERE SHIPT_ID      = :ASC-SHIPT-ID                24780000
247900         END-EXEC                                                 24790000
248000                                                                  24800000
248100         EVALUATE TRUE                                            24810000
248200             WHEN SQLCODE = ZERO                                  24820000
248300             WHEN SQLCODE = -904                                  24830000
248400             WHEN SQLCODE = -913                                  24840000
248500                 CONTINUE                                         24850000
248600                                                                  24860000
248700             WHEN SQLWARN0 NOT = SPACES                           24870000
248800             WHEN SQLCODE < ZERO                                  24880000
248900             WHEN SQLCODE > ZERO                                  24890000
249000                 MOVE '3630-UPDATE-TSHIPMT-TRIPID'                24900000
249100                                 TO DP013-PARAGRAPH               24910000
249200                 MOVE 'UPDATE TRIP ON SHIPMENT'                   24920000
249300                                 TO DP013-MESSAGE-TEXT (1)        24930000
249400                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT (2)      24940000
249500                 MOVE SQLCA      TO DP013-SQLCA                   24950000
249600                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      24960000
249700                 SET DP013-DB2-ABEND                              24970000
249800                                 TO TRUE                          24980000
249900                 SET DP013-XCTL-DISPLAY-RESTART                   24990000
250000                                 TO TRUE                          25000000
250100                 PERFORM DP013-0000-PROCESS-ABEND                 25010000
250200         END-EVALUATE                                             25020000
250300     END-PERFORM.                                                 25030000
250400                                                                  25040000
250500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25050000
250600         MOVE '3630-UPDATE-TSHIPMT-TRIPID'                        25060000
250700                                 TO DP013-PARAGRAPH               25070000
250800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     25080000
250900                                 TO DP013-MESSAGE-TEXT (1)        25090000
251000         MOVE 'TRIP ID       '   TO DP013-MESSAGE-TEXT (2)        25100000
251100         MOVE SQLCA              TO DP013-SQLCA                   25110000
251200         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      25120000
251300         SET DP013-DB2-ABEND     TO TRUE                          25130000
251400         SET DP013-XCTL-DISPLAY-RESTART                           25140000
251500                                 TO TRUE                          25150000
251600         PERFORM DP013-0000-PROCESS-ABEND                         25160000
251700     END-IF.                                                      25170000
251800                                                                  25180000
251900     IF SQLCODE = +0                                              25190000
252000        SET PS-TSHIPMT-AUD-SHIPTID TO TRUE                        25200000
252100     END-IF.                                                      25210000
252200                                                                  25220000
252300 3640-UPDATE-TVEHICL-TRIP.                                        25230000
252400                                                                  25240000
252500     MOVE ASC-OPER-UNT-ID   TO VEHICL-CURR-OPER-UNT-ID.           25250000
252600     MOVE ASC-FCLTY-ID      TO VEHICL-CURR-FCLTY-ID.              25260000
252700                                                                  25270000
252800     PERFORM                                                      25280000
252900         WITH TEST AFTER                                          25290000
253000         VARYING PV-RETRY-COUNTER                                 25300000
253100         FROM 1 BY 1                                              25310000
253200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25320000
253300                   OR (SQLCODE = ZERO))                           25330000
253400                                                                  25340000
253500         EXEC SQL                                                 25350000
253600            UPDATE TVEHICL                                        25360000
253700               SET CURR_TRIP_ID    = :ASC-TRIP-ID :DN-TRIP-ID     25370000
253800                  ,CURR_STATUS_CDE = :PV-STATUS-CDE               25380000
253900                  ,CURR_STATUS_DTE = CURRENT DATE                 25390000
254000                  ,CURR_STATUS_TME = CURRENT TIME                 25400000
254100                  ,CURR_OPER_UNT_ID = :VEHICL-CURR-OPER-UNT-ID    25410000
254200                  ,CURR_FCLTY_ID   = :VEHICL-CURR-FCLTY-ID        25420000
254300                  ,LAST_UPD_DTE    = CURRENT DATE                 25430000
254400                  ,LAST_UPD_TME    = CURRENT TIME                 25440000
254500                  ,LAST_UPD_UID    = :DP020-USERID                25450000
254600               WHERE VEH_NBR       = :DK-VEH-NBR                  25460000
254700                 AND OWNER_SCAC_ID = :DK-PRO-SCAC-ID              25470000
254800         END-EXEC                                                 25480000
254900                                                                  25490000
255000         EVALUATE TRUE                                            25500000
255100             WHEN SQLCODE = ZERO                                  25510000
255200             WHEN SQLCODE = -904                                  25520000
255300             WHEN SQLCODE = -913                                  25530000
255400                 CONTINUE                                         25540000
255500                                                                  25550000
255600             WHEN SQLWARN0 NOT = SPACES                           25560000
255700             WHEN SQLCODE < ZERO                                  25570000
255800             WHEN SQLCODE > ZERO                                  25580000
255900                 MOVE SPACES TO PV-MESSAGE                        25590000
256000                 MOVE DK-VEH-NBR TO PV-MESSAGE1                   25600000
256100                 MOVE DK-PRO-SCAC-ID TO PV-MESSAGE2               25610000
256200                 MOVE '3640-UPDATE-TVEHICL-TRIP  '                25620000
256300                                 TO DP013-PARAGRAPH               25630000
256400                 MOVE 'UPDATE TRIP ON VEHICLE '                   25640000
256500                                 TO DP013-MESSAGE-TEXT (1)        25650000
256600                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)        25660000
256700                 MOVE SQLCA      TO DP013-SQLCA                   25670000
256800                 MOVE 'TVEHICL'  TO DP013-DB2-TABLE-NAME (1)      25680000
256900                 SET DP013-DB2-ABEND                              25690000
257000                                 TO TRUE                          25700000
257100                 SET DP013-XCTL-DISPLAY-RESTART                   25710000
257200                                 TO TRUE                          25720000
257300                 PERFORM DP013-0000-PROCESS-ABEND                 25730000
257400         END-EVALUATE                                             25740000
257500     END-PERFORM.                                                 25750000
257600                                                                  25760000
257700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25770000
257800         MOVE '3640-UPDATE-TVEHICL-TRIP  '                        25780000
257900                                 TO DP013-PARAGRAPH               25790000
258000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     25800000
258100                                 TO DP013-MESSAGE-TEXT (1)        25810000
258200         MOVE 'TRIP ID       '   TO DP013-MESSAGE-TEXT (2)        25820000
258300         MOVE SQLCA              TO DP013-SQLCA                   25830000
258400         MOVE 'TVEHICL'          TO DP013-DB2-TABLE-NAME (1)      25840000
258500         SET DP013-DB2-ABEND     TO TRUE                          25850000
258600         SET DP013-XCTL-DISPLAY-RESTART                           25860000
258700                                 TO TRUE                          25870000
258800         PERFORM DP013-0000-PROCESS-ABEND                         25880000
258900     END-IF.                                                      25890000
259000                                                                  25900000
259100                                                                  25910000
259200 3650-GET-COUNT.                                                  25920000
259300                                                                  25930000
259400     PERFORM                                                      25940000
259500         WITH TEST AFTER                                          25950000
259600         VARYING PV-RETRY-COUNTER                                 25960000
259700         FROM 1 BY 1                                              25970000
259800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25980000
259900                   OR (SQLCODE = ZERO)                            25990000
260000                   OR (SQLCODE = +100))                           26000000
260100                                                                  26010000
260200         EXEC SQL                                                 26020000
260300            SELECT COUNT(*)                                       26030000
260400             INTO :PV-COUNT                                       26040000
260500             FROM  TSHIPMT                                        26050000
260600             WHERE TRIP_ID      = :ASC-TRIP-ID                    26060000
260700         END-EXEC                                                 26070000
260800                                                                  26080000
260900         EVALUATE TRUE                                            26090000
261000             WHEN SQLCODE = ZERO                                  26100000
261100             WHEN SQLCODE = +100                                  26110000
261200             WHEN SQLCODE = -904                                  26120000
261300             WHEN SQLCODE = -913                                  26130000
261400                 CONTINUE                                         26140000
261500                                                                  26150000
261600             WHEN SQLWARN0 NOT = SPACES                           26160000
261700             WHEN SQLCODE < ZERO                                  26170000
261800             WHEN SQLCODE > ZERO                                  26180000
261900                 MOVE '3650-DETERMINE-TVHTRIP-DELETE'             26190000
262000                                 TO DP013-PARAGRAPH               26200000
262100                 MOVE 'SELECT COUNT FOR TRIP  '                   26210000
262200                                 TO DP013-MESSAGE-TEXT (1)        26220000
262300                 MOVE ASC-TRIP-ID TO DP013-MESSAGE-TEXT (2)       26230000
262400                 MOVE SQLCA      TO DP013-SQLCA                   26240000
262500                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      26250000
262600                 SET DP013-DB2-ABEND                              26260000
262700                                 TO TRUE                          26270000
262800                 SET DP013-XCTL-DISPLAY-RESTART                   26280000
262900                                 TO TRUE                          26290000
263000                 PERFORM DP013-0000-PROCESS-ABEND                 26300000
263100         END-EVALUATE                                             26310000
263200     END-PERFORM.                                                 26320000
263300                                                                  26330000
263400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26340000
263500         MOVE '3650-DETERMINE-TVHTIRP-DELETE'                     26350000
263600                                 TO DP013-PARAGRAPH               26360000
263700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26370000
263800                                 TO DP013-MESSAGE-TEXT (1)        26380000
263900         MOVE 'COUNT         '   TO DP013-MESSAGE-TEXT (2)        26390000
264000         MOVE SQLCA              TO DP013-SQLCA                   26400000
264100         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      26410000
264200         SET DP013-DB2-ABEND     TO TRUE                          26420000
264300         SET DP013-XCTL-DISPLAY-RESTART                           26430000
264400                                 TO TRUE                          26440000
264500         PERFORM DP013-0000-PROCESS-ABEND                         26450000
264600     END-IF.                                                      26460000
264700                                                                  26470000
264800*    EVALUATE TRUE                                                26480000
264900*      WHEN SQLCODE = 0                                           26490000
265000*           IF PV-COUNT > 0                                       26500000
265100*              CONTINUE                                           26510000
265200*           ELSE                                                  26520000
265300*              PERFORM 3655-DELETE-TVHTRIP                        26530000
265400*           END-IF                                                26540000
265500*    END-EVALUATE.                                                26550000
265600                                                                  26560000
265700 3655-DELETE-TVHTRIP.                                             26570000
265800                                                                  26580000
265900     PERFORM                                                      26590000
266000         WITH TEST AFTER                                          26600000
266100         VARYING PV-RETRY-COUNTER                                 26610000
266200         FROM 1 BY 1                                              26620000
266300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26630000
266400                   OR (SQLCODE = ZERO))                           26640000
266500                                                                  26650000
266600         EXEC SQL                                                 26660000
266700            DELETE                                                26670000
266800             FROM TVHTRIP                                         26680000
266900             WHERE TRIP_ID     = :ASC-TRIP-ID                     26690000
267000         END-EXEC                                                 26700000
267100                                                                  26710000
267200         EVALUATE TRUE                                            26720000
267300             WHEN SQLCODE = ZERO                                  26730000
267400             WHEN SQLCODE = -904                                  26740000
267500             WHEN SQLCODE = -913                                  26750000
267600                 CONTINUE                                         26760000
267700                                                                  26770000
267800             WHEN SQLWARN0 NOT = SPACES                           26780000
267900             WHEN SQLCODE < ZERO                                  26790000
268000             WHEN SQLCODE > ZERO                                  26800000
268100                 MOVE '3655-DELETE-TVHTRIP'                       26810000
268200                                 TO DP013-PARAGRAPH               26820000
268300                 MOVE 'DELETE TRIP '                              26830000
268400                                 TO DP013-MESSAGE-TEXT (1)        26840000
268500                 MOVE ASC-TRIP-ID TO DP013-MESSAGE-TEXT (2)       26850000
268600                 MOVE SQLCA      TO DP013-SQLCA                   26860000
268700                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (1)      26870000
268800                 SET DP013-DB2-ABEND                              26880000
268900                                 TO TRUE                          26890000
269000                 SET DP013-XCTL-DISPLAY-RESTART                   26900000
269100                                 TO TRUE                          26910000
269200                 PERFORM DP013-0000-PROCESS-ABEND                 26920000
269300         END-EVALUATE                                             26930000
269400     END-PERFORM.                                                 26940000
269500                                                                  26950000
269600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26960000
269700         MOVE '3655-DELETE-TVHTRIP'                               26970000
269800                                 TO DP013-PARAGRAPH               26980000
269900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO DELETE'     26990000
270000                                 TO DP013-MESSAGE-TEXT (1)        27000000
270100         MOVE 'TRIP          '   TO DP013-MESSAGE-TEXT (2)        27010000
270200         MOVE SQLCA              TO DP013-SQLCA                   27020000
270300         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (1)      27030000
270400         SET DP013-DB2-ABEND     TO TRUE                          27040000
270500         SET DP013-XCTL-DISPLAY-RESTART                           27050000
270600                                 TO TRUE                          27060000
270700         PERFORM DP013-0000-PROCESS-ABEND                         27070000
270800     END-IF.                                                      27080000
270900                                                                  27090000
271000                                                                  27100000
271100 3660-UPDATE-TSHIPMT-TRIPSHIP.                                    27110000
271200                                                                  27120000
271300     PERFORM                                                      27130000
271400         WITH TEST AFTER                                          27140000
271500         VARYING PV-RETRY-COUNTER                                 27150000
271600         FROM 1 BY 1                                              27160000
271700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27170000
271800                   OR (SQLCODE = ZERO))                           27180000
271900                                                                  27190000
272000         EXEC SQL                                                 27200000
272100            UPDATE TSHIPMT                                        27210000
272200               SET PRO_SCAC_ID     = :ASC-PRO-SCAC-ID             27220000
272300                  ,VEH_NBR         = :DK-VEH-NBR                  27230000
272400                  ,LAST_UPD_DTE    = CURRENT DATE                 27240000
272500                  ,LAST_UPD_TME    = CURRENT TIME                 27250000
272600                  ,LAST_UPD_UID    = :DP020-USERID                27260000
272700                  ,LAST_UPD_PGM_ID = :PC-CURRENT-PROGRAM-NAME     27270000
272800             WHERE TRIP_ID         = :ASC-TRIP-ID                 27280000
272900               AND SHIPT_ID        = :ASC-SHIPT-ID                27290000
273000         END-EXEC                                                 27300000
273100                                                                  27310000
273200         EVALUATE TRUE                                            27320000
273300             WHEN SQLCODE = ZERO                                  27330000
273400             WHEN SQLCODE = -904                                  27340000
273500             WHEN SQLCODE = -913                                  27350000
273600                 CONTINUE                                         27360000
273700                                                                  27370000
273800             WHEN SQLWARN0 NOT = SPACES                           27380000
273900             WHEN SQLCODE < ZERO                                  27390000
274000             WHEN SQLCODE > ZERO                                  27400000
274100                 MOVE SPACES TO PV-MESSAGE                        27410000
274200                 MOVE ASC-TRIP-ID TO PV-MESSAGE1                  27420000
274300                 MOVE ASC-SHIPT-ID TO PV-MESSAGE2                 27430000
274400                 MOVE '3660-UPDATE-TSHIPMT-TRIPSHIP'              27440000
274500                                 TO DP013-PARAGRAPH               27450000
274600                 MOVE 'UPDATE TSHIPMT'                            27460000
274700                                 TO DP013-MESSAGE-TEXT (1)        27470000
274800                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)        27480000
274900                 MOVE SQLCA      TO DP013-SQLCA                   27490000
275000                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      27500000
275100                 SET DP013-DB2-ABEND                              27510000
275200                                 TO TRUE                          27520000
275300                 SET DP013-XCTL-DISPLAY-RESTART                   27530000
275400                                 TO TRUE                          27540000
275500                 PERFORM DP013-0000-PROCESS-ABEND                 27550000
275600         END-EVALUATE                                             27560000
275700     END-PERFORM.                                                 27570000
275800                                                                  27580000
275900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27590000
276000         MOVE '3660-UPDATE-TSHIPMT-TRIPSHIP'                      27600000
276100                                 TO DP013-PARAGRAPH               27610000
276200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     27620000
276300                                 TO DP013-MESSAGE-TEXT (1)        27630000
276400         MOVE 'SHIPMENT      '   TO DP013-MESSAGE-TEXT (2)        27640000
276500         MOVE SQLCA              TO DP013-SQLCA                   27650000
276600         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      27660000
276700         SET DP013-DB2-ABEND     TO TRUE                          27670000
276800         SET DP013-XCTL-DISPLAY-RESTART                           27680000
276900                                 TO TRUE                          27690000
277000         PERFORM DP013-0000-PROCESS-ABEND                         27700000
277100     END-IF.                                                      27710000
277200                                                                  27720000
277300     IF SQLCODE = 0                                               27730000
277400        SET PS-TSHIPMT-AUD-SHIPTID TO TRUE                        27740000
277500     END-IF.                                                      27750000
277600                                                                  27760000
277700 3665-UPDATE-TSHIPMT-VEHONLY.                                     27770000
277800                                                                  27780000
277900     PERFORM                                                      27790000
278000         WITH TEST AFTER                                          27800000
278100         VARYING PV-RETRY-COUNTER                                 27810000
278200         FROM 1 BY 1                                              27820000
278300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27830000
278400                   OR (SQLCODE = ZERO))                           27840000
278500                                                                  27850000
278600         EXEC SQL                                                 27860000
278700            UPDATE TSHIPMT                                        27870000
278800               SET VEH_NBR         = :ASC-VEH-NBR                 27880000
278900                  ,LAST_UPD_DTE    = CURRENT DATE                 27890000
279000                  ,LAST_UPD_TME    = CURRENT TIME                 27900000
279100                  ,LAST_UPD_UID    = :DP020-USERID                27910000
279200                  ,LAST_UPD_PGM_ID = :PC-CURRENT-PROGRAM-NAME     27920000
279300             WHERE TRIP_ID         = :ASC-TRIP-ID                 27930000
279400               AND SHIPT_ID        = :ASC-SHIPT-ID                27940000
279500         END-EXEC                                                 27950000
279600                                                                  27960000
279700         EVALUATE TRUE                                            27970000
279800             WHEN SQLCODE = ZERO                                  27980000
279900             WHEN SQLCODE = -904                                  27990000
280000             WHEN SQLCODE = -913                                  28000000
280100                 CONTINUE                                         28010000
280200                                                                  28020000
280300             WHEN SQLWARN0 NOT = SPACES                           28030000
280400             WHEN SQLCODE < ZERO                                  28040000
280500             WHEN SQLCODE > ZERO                                  28050000
280600                 MOVE SPACES TO PV-MESSAGE                        28060000
280700                 MOVE ASC-TRIP-ID TO PV-MESSAGE1                  28070000
280800                 MOVE ASC-SHIPT-ID TO PV-MESSAGE2                 28080000
280900                 MOVE '3665-UPDATE-TSHIPMT-VEHONLY'               28090000
281000                                 TO DP013-PARAGRAPH               28100000
281100                 MOVE 'UPDATE TSHIPMT'                            28110000
281200                                 TO DP013-MESSAGE-TEXT (1)        28120000
281300                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)        28130000
281400                 MOVE SQLCA      TO DP013-SQLCA                   28140000
281500                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      28150000
281600                 SET DP013-DB2-ABEND                              28160000
281700                                 TO TRUE                          28170000
281800                 SET DP013-XCTL-DISPLAY-RESTART                   28180000
281900                                 TO TRUE                          28190000
282000                 PERFORM DP013-0000-PROCESS-ABEND                 28200000
282100         END-EVALUATE                                             28210000
282200     END-PERFORM.                                                 28220000
282300                                                                  28230000
282400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28240000
282500         MOVE '3665-UPDATE-TSHIPMT-VEHONLY'                       28250000
282600                                 TO DP013-PARAGRAPH               28260000
282700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     28270000
282800                                 TO DP013-MESSAGE-TEXT (1)        28280000
282900         MOVE 'SHIPMENT      '   TO DP013-MESSAGE-TEXT (2)        28290000
283000         MOVE SQLCA              TO DP013-SQLCA                   28300000
283100         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      28310000
283200         SET DP013-DB2-ABEND     TO TRUE                          28320000
283300         SET DP013-XCTL-DISPLAY-RESTART                           28330000
283400                                 TO TRUE                          28340000
283500         PERFORM DP013-0000-PROCESS-ABEND                         28350000
283600     END-IF.                                                      28360000
283700                                                                  28370000
283800     IF SQLCODE = 0                                               28380000
283900        SET PS-TSHIPMT-AUD-SHIPTID TO TRUE                        28390000
284000     END-IF.                                                      28400000
284100                                                                  28410000
284200 3670-UPDATE-TVHTRIP-TRIP.                                        28420000
284300                                                                  28430000
284400     PERFORM                                                      28440000
284500         WITH TEST AFTER                                          28450000
284600         VARYING PV-RETRY-COUNTER                                 28460000
284700         FROM 1 BY 1                                              28470000
284800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28480000
284900                   OR (SQLCODE = ZERO))                           28490000
285000                                                                  28500000
285100         EXEC SQL                                                 28510000
285200            UPDATE TVHTRIP                                        28520000
285300               SET VEH_NBR         = :ASC-VEH-NBR :DN-VEH-NBR     28530000
285400                  ,OWNER_SCAC_ID   = :ASC-PRO-SCAC-ID             28540000
285500                  ,LAST_UPD_DTE    = CURRENT DATE                 28550000
285600                  ,LAST_UPD_TME    = CURRENT TIME                 28560000
285700                  ,LAST_UPD_UID    = :DP020-USERID                28570000
285800             WHERE TRIP_ID         = :ASC-TRIP-ID                 28580000
285900         END-EXEC                                                 28590000
286000                                                                  28600000
286100         EVALUATE TRUE                                            28610000
286200             WHEN SQLCODE = ZERO                                  28620000
286300             WHEN SQLCODE = -904                                  28630000
286400             WHEN SQLCODE = -913                                  28640000
286500                 CONTINUE                                         28650000
286600                                                                  28660000
286700             WHEN SQLWARN0 NOT = SPACES                           28670000
286800             WHEN SQLCODE < ZERO                                  28680000
286900             WHEN SQLCODE > ZERO                                  28690000
287000                 MOVE '3670-UPDATE-TVHTRIP-TRIP'                  28700000
287100                                 TO DP013-PARAGRAPH               28710000
287200                 MOVE 'UPDATING TRIP TABLE'                       28720000
287300                                 TO DP013-MESSAGE-TEXT (1)        28730000
287400                 MOVE ASC-TRIP-ID TO DP013-MESSAGE-TEXT (2)       28740000
287500                 MOVE SQLCA      TO DP013-SQLCA                   28750000
287600                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (1)      28760000
287700                 SET DP013-DB2-ABEND                              28770000
287800                                 TO TRUE                          28780000
287900                 SET DP013-XCTL-DISPLAY-RESTART                   28790000
288000                                 TO TRUE                          28800000
288100                 PERFORM DP013-0000-PROCESS-ABEND                 28810000
288200         END-EVALUATE                                             28820000
288300     END-PERFORM.                                                 28830000
288400                                                                  28840000
288500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28850000
288600         MOVE '3670-UPDATE-TVHTRIP-TRIP'                          28860000
288700                                 TO DP013-PARAGRAPH               28870000
288800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     28880000
288900                                 TO DP013-MESSAGE-TEXT (1)        28890000
289000         MOVE 'TRIP          '   TO DP013-MESSAGE-TEXT (2)        28900000
289100         MOVE SQLCA              TO DP013-SQLCA                   28910000
289200         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (1)      28920000
289300         SET DP013-DB2-ABEND     TO TRUE                          28930000
289400         SET DP013-XCTL-DISPLAY-RESTART                           28940000
289500                                 TO TRUE                          28950000
289600         PERFORM DP013-0000-PROCESS-ABEND                         28960000
289700     END-IF.                                                      28970000
289800                                                                  28980000
289900     IF SQLCODE = 0                                               28990000
290000        SET PS-TVHTRIP-AUD-TRIPID TO TRUE                         29000000
290100     END-IF.                                                      29010000
290200                                                                  29020000
290300 3675-UPDATE-TVHTRIP-VEHONLY.                                     29030000
290400                                                                  29040000
290500     PERFORM                                                      29050000
290600         WITH TEST AFTER                                          29060000
290700         VARYING PV-RETRY-COUNTER                                 29070000
290800         FROM 1 BY 1                                              29080000
290900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29090000
291000                   OR (SQLCODE = ZERO))                           29100000
291100                                                                  29110000
291200         EXEC SQL                                                 29120000
291300            UPDATE TVHTRIP                                        29130000
291400               SET VEH_NBR         = :ASC-VEH-NBR :DN-VEH-NBR     29140000
291500                  ,LAST_UPD_DTE    = CURRENT DATE                 29150000
291600                  ,LAST_UPD_TME    = CURRENT TIME                 29160000
291700                  ,LAST_UPD_UID    = :DP020-USERID                29170000
291800             WHERE TRIP_ID         = :ASC-TRIP-ID                 29180000
291900         END-EXEC                                                 29190000
292000                                                                  29200000
292100         EVALUATE TRUE                                            29210000
292200             WHEN SQLCODE = ZERO                                  29220000
292300             WHEN SQLCODE = -904                                  29230000
292400             WHEN SQLCODE = -913                                  29240000
292500                 CONTINUE                                         29250000
292600                                                                  29260000
292700             WHEN SQLWARN0 NOT = SPACES                           29270000
292800             WHEN SQLCODE < ZERO                                  29280000
292900             WHEN SQLCODE > ZERO                                  29290000
293000                 MOVE '3675-UPDATE-TVHTRIP-VEHONLY'               29300000
293100                                 TO DP013-PARAGRAPH               29310000
293200                 MOVE 'UPDATING TRIP TABLE'                       29320000
293300                                 TO DP013-MESSAGE-TEXT (1)        29330000
293400                 MOVE ASC-TRIP-ID TO DP013-MESSAGE-TEXT (2)       29340000
293500                 MOVE SQLCA      TO DP013-SQLCA                   29350000
293600                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (1)      29360000
293700                 SET DP013-DB2-ABEND                              29370000
293800                                 TO TRUE                          29380000
293900                 SET DP013-XCTL-DISPLAY-RESTART                   29390000
294000                                 TO TRUE                          29400000
294100                 PERFORM DP013-0000-PROCESS-ABEND                 29410000
294200         END-EVALUATE                                             29420000
294300     END-PERFORM.                                                 29430000
294400                                                                  29440000
294500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29450000
294600         MOVE '3675-UPDATE-TVHTRIP-VEHONLY'                       29460000
294700                                 TO DP013-PARAGRAPH               29470000
294800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     29480000
294900                                 TO DP013-MESSAGE-TEXT (1)        29490000
295000         MOVE 'TRIP          '   TO DP013-MESSAGE-TEXT (2)        29500000
295100         MOVE SQLCA              TO DP013-SQLCA                   29510000
295200         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (1)      29520000
295300         SET DP013-DB2-ABEND     TO TRUE                          29530000
295400         SET DP013-XCTL-DISPLAY-RESTART                           29540000
295500                                 TO TRUE                          29550000
295600         PERFORM DP013-0000-PROCESS-ABEND                         29560000
295700     END-IF.                                                      29570000
295800                                                                  29580000
295900     IF SQLCODE = 0                                               29590000
296000        SET PS-TVHTRIP-AUD-TRIPID TO TRUE                         29600000
296100     END-IF.                                                      29610000
296200                                                                  29620000
296300 3676-UPDATE-TVHTRIP.                                             29630000
296400                                                                  29640000
296500     PERFORM                                                      29650000
296600         WITH TEST AFTER                                          29660000
296700         VARYING PV-RETRY-COUNTER                                 29670000
296800         FROM 1 BY 1                                              29680000
296900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29690000
297000                   OR (SQLCODE = ZERO))                           29700000
297100                                                                  29710000
297200         EXEC SQL                                                 29720000
297300            UPDATE TVHTRIP                                        29730000
297400               SET EST_AR_TMST     = :SHIPMT-EST-AR-TMST          29740000
297500                  ,LAST_UPD_DTE    = CURRENT DATE                 29750000
297600                  ,LAST_UPD_TME    = CURRENT TIME                 29760000
297700                  ,LAST_UPD_UID    = :DP020-USERID                29770000
297800             WHERE TRIP_ID         = :ASC-TRIP-ID                 29780000
297900         END-EXEC                                                 29790000
298000                                                                  29800000
298100         EVALUATE TRUE                                            29810000
298200             WHEN SQLCODE = ZERO                                  29820000
298300             WHEN SQLCODE = -904                                  29830000
298400             WHEN SQLCODE = -913                                  29840000
298500                 CONTINUE                                         29850000
298600                                                                  29860000
298700             WHEN SQLWARN0 NOT = SPACES                           29870000
298800             WHEN SQLCODE < ZERO                                  29880000
298900             WHEN SQLCODE > ZERO                                  29890000
299000                 MOVE '3676-UPDATE-TVHTRIP'                       29900000
299100                                 TO DP013-PARAGRAPH               29910000
299200                 MOVE 'UPDATING TRIP TABLE'                       29920000
299300                                 TO DP013-MESSAGE-TEXT (1)        29930000
299400                 MOVE ASC-TRIP-ID TO DP013-MESSAGE-TEXT (2)       29940000
299500                 MOVE SQLCA      TO DP013-SQLCA                   29950000
299600                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (1)      29960000
299700                 SET DP013-DB2-ABEND                              29970000
299800                                 TO TRUE                          29980000
299900                 SET DP013-XCTL-DISPLAY-RESTART                   29990000
300000                                 TO TRUE                          30000000
300100                 PERFORM DP013-0000-PROCESS-ABEND                 30010000
300200         END-EVALUATE                                             30020000
300300     END-PERFORM.                                                 30030000
300400                                                                  30040000
300500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30050000
300600         MOVE '3676-UPDATE-TVHTRIP'                               30060000
300700                                 TO DP013-PARAGRAPH               30070000
300800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     30080000
300900                                 TO DP013-MESSAGE-TEXT (1)        30090000
301000         MOVE 'TRIP          '   TO DP013-MESSAGE-TEXT (2)        30100000
301100         MOVE SQLCA              TO DP013-SQLCA                   30110000
301200         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (1)      30120000
301300         SET DP013-DB2-ABEND     TO TRUE                          30130000
301400         SET DP013-XCTL-DISPLAY-RESTART                           30140000
301500                                 TO TRUE                          30150000
301600         PERFORM DP013-0000-PROCESS-ABEND                         30160000
301700     END-IF.                                                      30170000
301800                                                                  30180000
301900     IF SQLCODE = 0                                               30190000
302000        SET PS-TVHTRIP-AUD-TRIPID TO TRUE                         30200000
302100     END-IF.                                                      30210000
302200                                                                  30220000
302300 3680-INSERT-TVEHICL.                                             30230000
302400                                                                  30240000
302500     INITIALIZE DCLTVEHICL.                                       30250000
302600                                                                  30260000
302700     MOVE ASC-PRO-SCAC-ID          TO VEHICL-OWNER-SCAC-ID.       30270000
302800     MOVE ASC-VEH-NBR              TO VEHICL-VEH-NBR.             30280000
302900     MOVE 'CE'                     TO VEHICL-CRT-SRC-CDE.         30290000
303000     MOVE 'RCV'                    TO VEHICL-USAGE-CDE.           30300000
303100     MOVE 'TR'                     TO VEHICL-VEH-TYP-CDE.         30310000
303200     MOVE 'EN'                     TO VEHICL-CURR-STATUS-CDE.     30320000
303300     MOVE ASC-OPER-UNT-ID          TO VEHICL-CURR-OPER-UNT-ID.    30330000
303400     MOVE ASC-FCLTY-ID             TO VEHICL-CURR-FCLTY-ID.       30340000
303500     MOVE ASC-TRIP-ID              TO VEHICL-CURR-TRIP-ID.        30350000
303600     MOVE +1                       TO DN-TRIP-ID.                 30360000
303700                                                                  30370000
303800     PERFORM                                                      30380000
303900         WITH TEST AFTER                                          30390000
304000         VARYING PV-RETRY-COUNTER                                 30400000
304100         FROM 1 BY 1                                              30410000
304200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30420000
304300             OR (SQLCODE = +0))                                   30430000
304400                                                                  30440000
304500         EXEC SQL                                                 30450000
304600             INSERT  INTO TVEHICL                                 30460000
304700                   ( OWNER_SCAC_ID                                30470000
304800                    ,VEH_NBR                                      30480000
304900                    ,CRT_SRC_CDE                                  30490000
305000                    ,LAST_UPD_UID                                 30500000
305100                    ,USAGE_CDE                                    30510000
305200                    ,VEH_TYP_CDE                                  30520000
305300                    ,CURR_STATUS_CDE                              30530000
305400                    ,CURR_STATUS_DTE                              30540000
305500                    ,CURR_STATUS_TME                              30550000
305600                    ,CURR_OPER_UNT_ID                             30560000
305700                    ,CURR_FCLTY_ID                                30570000
305800                    ,CURR_TRIP_ID )                               30580000
305900             VALUES                                               30590000
306000                   ( :VEHICL-OWNER-SCAC-ID                        30600000
306100                    ,:VEHICL-VEH-NBR                              30610000
306200                    ,:VEHICL-CRT-SRC-CDE                          30620000
306300                    ,:DP020-USERID                                30630000
306400                    ,:VEHICL-USAGE-CDE                            30640000
306500                    ,:VEHICL-VEH-TYP-CDE                          30650000
306600                    ,:VEHICL-CURR-STATUS-CDE                      30660000
306700                    ,CURRENT DATE                                 30670000
306800                    ,CURRENT TIME                                 30680000
306900                    ,:VEHICL-CURR-OPER-UNT-ID                     30690000
307000                    ,:VEHICL-CURR-FCLTY-ID                        30700000
307100                    ,:VEHICL-CURR-TRIP-ID :DN-TRIP-ID)            30710000
307200         END-EXEC                                                 30720000
307300                                                                  30730000
307400         EVALUATE TRUE                                            30740000
307500             WHEN SQLCODE = +0                                    30750000
307600             WHEN SQLCODE = -904                                  30760000
307700             WHEN SQLCODE = -913                                  30770000
307800                 CONTINUE                                         30780000
307900                                                                  30790000
308000             WHEN SQLWARN0 NOT = SPACES                           30800000
308100             WHEN SQLCODE < +0                                    30810000
308200             WHEN SQLCODE > +0                                    30820000
308300                 MOVE SPACES TO PV-MESSAGE                        30830000
308400                 MOVE VEHICL-OWNER-SCAC-ID TO PV-MESSAGE1         30840000
308500                 MOVE VEHICL-VEH-NBR  TO PV-MESSAGE2              30850000
308600                 MOVE '3680-INSERT-TVEHICL'                       30860000
308700                                   TO DP013-PARAGRAPH             30870000
308800                 MOVE 'INSERT A ROW ON TVEHICL'                   30880000
308900                                   TO DP013-MESSAGE-TEXT(1)       30890000
309000                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       30900000
309100                 MOVE SQLCA        TO DP013-SQLCA                 30910000
309200                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    30920000
309300                 SET DP013-DB2-ABEND                              30930000
309400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           30940000
309500                 PERFORM DP013-0000-PROCESS-ABEND                 30950000
309600         END-EVALUATE                                             30960000
309700     END-PERFORM.                                                 30970000
309800                                                                  30980000
309900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30990000
310000         MOVE '3680-INSERT-TVEHICL'                               31000000
310100                                   TO DP013-PARAGRAPH             31010000
310200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              31020000
310300                                   TO DP013-MESSAGE-TEXT (1)      31030000
310400         MOVE 'TO INSERT A TVEHICL ROW'                           31040000
310500                                   TO DP013-MESSAGE-TEXT (2)      31050000
310600         MOVE SQLCA                TO DP013-SQLCA                 31060000
310700         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    31070000
310800         SET DP013-DB2-ABEND                                      31080000
310900             DP013-XCTL-DISPLAY-RESTART                           31090000
311000                                   TO TRUE                        31100000
311100         PERFORM DP013-0000-PROCESS-ABEND                         31110000
311200     END-IF.                                                      31120000
311300                                                                  31130000
311400     IF SQLCODE = ZERO                                            31140000
311500        SET PS-TVEHICL-AUD-VEHSCAC TO TRUE                        31150000
311600     END-IF.                                                      31160000
311700 EJECT                                                            31170000
311800                                                                  31180000
311900 3690-INSERT-TVHTRIP.                                             31190000
312000                                                                  31200000
312100     INITIALIZE DCLTVHTRIP.                                       31210000
312200                                                                  31220000
312300     MOVE ASC-PRO-SCAC-ID          TO VHTRIP-OWNER-SCAC-ID.       31230000
312400     MOVE ASC-VEH-NBR              TO VHTRIP-VEH-NBR.             31240000
312500     MOVE PV-TRIP-ID               TO VHTRIP-TRIP-ID              31250000
312600                                      VHTRIP-REF-TRIP-ID          31260000
312700                                      DK-TRIP-ID.                 31270000
312800     MOVE 'CE'                     TO VHTRIP-CRT-SRC-CDE.         31280000
312900     MOVE SPACES                   TO VHTRIP-MANIFEST-NBR         31290000
313000                                      VHTRIP-PLND-ACTVY-CDE.      31300000
313100     MOVE ZEROES                   TO VHTRIP-PLND-TRIP-SEQ.       31310000
313200     MOVE PC-DEFAULT-TMST          TO PV-TEMP-TMST.               31320000
313300     MOVE ASC-ETA-MM               TO PV-TMST-MM.                 31330000
313400     MOVE ASC-ETA-DD               TO PV-TMST-DD.                 31340000
313500     MOVE ASC-ETA-CCYY             TO PV-TMST-CCYY.               31350000
313600     IF ASC-ETA-TIME NOT EQUAL SPACES OR                          31360000
313700        ASC-ETA-TIME NOT EQUAL '0000'                             31370000
313800        MOVE ASC-ETA-TIME-HH       TO PV-TMST-HH                  31380000
313900        MOVE ASC-ETA-TIME-MN       TO PV-TMST-MN                  31390000
314000     END-IF.                                                      31400000
314100     MOVE PV-TEMP-TMST             TO VHTRIP-EST-AR-TMST.         31410000
314200                                                                  31420000
314300     PERFORM                                                      31430000
314400         WITH TEST AFTER                                          31440000
314500         VARYING PV-RETRY-COUNTER                                 31450000
314600         FROM 1 BY 1                                              31460000
314700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31470000
314800             OR (SQLCODE = +0))                                   31480000
314900                                                                  31490000
315000         EXEC SQL                                                 31500000
315100             INSERT  INTO TVHTRIP                                 31510000
315200                   ( OWNER_SCAC_ID                                31520000
315300                    ,VEH_NBR                                      31530000
315400                    ,TRIP_ID                                      31540000
315500                    ,CRT_SRC_CDE                                  31550000
315600                    ,LAST_UPD_UID                                 31560000
315700                    ,MANIFEST_NBR                                 31570000
315800                    ,PLND_TRIP_SEQ                                31580000
315900                    ,PLND_ACTVY_CDE                               31590000
316000                    ,OWNR_SCAC_SHIP_DTE                           31600000
316100                    ,REF_TRIP_ID                                  31610000
316200                    ,EST_AR_TMST                                  31620000
316300                    ,SPLT_XMIT_IND                                31630000
316400                    ,SPLT_XMIT_DTE                                31640000
316500                    ,SPLT_XMIT_TM )                               31650000
316600             VALUES                                               31660000
316700                   ( :VHTRIP-OWNER-SCAC-ID                        31670000
316800                    ,:VHTRIP-VEH-NBR :DN-VEH-NBR                  31680000
316900                    ,:VHTRIP-TRIP-ID                              31690000
317000                    ,:VHTRIP-CRT-SRC-CDE                          31700000
317100                    ,:DP020-USERID                                31710000
317200                    ,:VHTRIP-MANIFEST-NBR                         31720000
317300                    ,:VHTRIP-PLND-TRIP-SEQ                        31730000
317400                    ,:VHTRIP-PLND-ACTVY-CDE                       31740000
317500                    ,:PC-DEFAULT-DATE                             31750000
317600                    ,:VHTRIP-REF-TRIP-ID                          31760000
317700                    ,:VHTRIP-EST-AR-TMST                          31770000
317800                    ,:VHTRIP-SPLT-XMIT-IND                        31780000
317900                    ,:PC-DEFAULT-DATE                             31790000
318000                    ,:PC-DEFAULT-TIME)                            31800000
318100         END-EXEC                                                 31810000
318200                                                                  31820000
318300         EVALUATE TRUE                                            31830000
318400             WHEN SQLCODE = +0                                    31840000
318500             WHEN SQLCODE = -904                                  31850000
318600             WHEN SQLCODE = -913                                  31860000
318700                 CONTINUE                                         31870000
318800                                                                  31880000
318900             WHEN SQLWARN0 NOT = SPACES                           31890000
319000             WHEN SQLCODE < +0                                    31900000
319100             WHEN SQLCODE > +0                                    31910000
319200                 MOVE SPACES TO PV-MESSAGE                        31920000
319300                 MOVE VHTRIP-OWNER-SCAC-ID TO PV-MESSAGE1         31930000
319400                 MOVE VHTRIP-VEH-NBR  TO PV-MESSAGE2              31940000
319500                 MOVE VHTRIP-TRIP-ID TO PV-MESSAGE3               31950000
319600                 MOVE '3690-INSERT-TVHTRIP'                       31960000
319700                                   TO DP013-PARAGRAPH             31970000
319800                 MOVE 'INSERT A ROW ON TVHTRIP'                   31980000
319900                                   TO DP013-MESSAGE-TEXT(1)       31990000
320000                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       32000000
320100                 MOVE SQLCA        TO DP013-SQLCA                 32010000
320200                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    32020000
320300                 SET DP013-DB2-ABEND                              32030000
320400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32040000
320500                 PERFORM DP013-0000-PROCESS-ABEND                 32050000
320600         END-EVALUATE                                             32060000
320700     END-PERFORM.                                                 32070000
320800                                                                  32080000
320900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32090000
321000         MOVE '3690-INSERT-TVHTRIP'                               32100000
321100                                   TO DP013-PARAGRAPH             32110000
321200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              32120000
321300                                   TO DP013-MESSAGE-TEXT (1)      32130000
321400         MOVE 'TO INSERT A TVHTRIP ROW'                           32140000
321500                                   TO DP013-MESSAGE-TEXT (2)      32150000
321600         MOVE SQLCA                TO DP013-SQLCA                 32160000
321700         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    32170000
321800         SET DP013-DB2-ABEND                                      32180000
321900             DP013-XCTL-DISPLAY-RESTART                           32190000
322000                                   TO TRUE                        32200000
322100         PERFORM DP013-0000-PROCESS-ABEND                         32210000
322200     END-IF.                                                      32220000
322300                                                                  32230000
322400     EVALUATE TRUE                                                32240000
322500         WHEN SQLCODE = ZERO                                      32250000
322600              PERFORM 3695-INSERT-TTRIPST                         32260000
322700              SET PS-TVHTRIP-AUD-TRIPID-N TO TRUE                 32270000
322800     END-EVALUATE.                                                32280000
322900                                                                  32290000
323000 EJECT                                                            32300000
323100                                                                  32310000
323200*----------------------------------------------------------------*32320000
323300*  INSERT A ROW TO THE TRIP STATUS TABLE                          32330000
323400*                                                                 32340000
323500*  PERFORMED FROM 3690-INSERT-TVHTRIP.                            32350000
323600*----------------------------------------------------------------*32360000
323700 3695-INSERT-TTRIPST.                                             32370000
323800                                                                  32380000
323900     INITIALIZE DCLTTRIPST.                                       32390000
324000                                                                  32400000
324100     MOVE PV-TRIP-ID               TO TRIPST-TRIP-ID.             32410000
324200     MOVE 'EN'                     TO TRIPST-TRIP-STATUS-CDE.     32420000
324300     MOVE ASC-OPER-UNT-ID          TO TRIPST-OPER-UNT-ID.         32430000
324400     MOVE ASC-FCLTY-ID             TO TRIPST-FCLTY-ID.            32440000
324500     MOVE SPACES                   TO TRIPST-FCLTY-AREA-ID.       32450000
324600                                                                  32460000
324700     PERFORM                                                      32470000
324800         WITH TEST AFTER                                          32480000
324900         VARYING PV-RETRY-COUNTER                                 32490000
325000         FROM 1 BY 1                                              32500000
325100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32510000
325200             OR (SQLCODE = +0))                                   32520000
325300                                                                  32530000
325400         EXEC SQL                                                 32540000
325500             INSERT  INTO TTRIPST                                 32550000
325600                   ( TRIP_ID                                      32560000
325700                    ,TRIP_STATUS_CDE                              32570000
325800                    ,STATUS_UID                                   32580000
325900                    ,OPER_UNT_ID                                  32590000
326000                    ,FCLTY_ID                                     32600000
326100                    ,FCLTY_AREA_ID )                              32610000
326200             VALUES                                               32620000
326300                   ( :TRIPST-TRIP-ID                              32630000
326400                    ,:TRIPST-TRIP-STATUS-CDE                      32640000
326500                    ,:DP020-USERID                                32650000
326600                    ,:TRIPST-OPER-UNT-ID                          32660000
326700                    ,:TRIPST-FCLTY-ID                             32670000
326800                    ,:TRIPST-FCLTY-AREA-ID )                      32680000
326900         END-EXEC                                                 32690000
327000                                                                  32700000
327100         EVALUATE TRUE                                            32710000
327200             WHEN SQLCODE = +0                                    32720000
327300             WHEN SQLCODE = -904                                  32730000
327400             WHEN SQLCODE = -913                                  32740000
327500                 CONTINUE                                         32750000
327600                                                                  32760000
327700             WHEN SQLWARN0 NOT = SPACES                           32770000
327800             WHEN SQLCODE < +0                                    32780000
327900             WHEN SQLCODE > +0                                    32790000
328000                 MOVE SPACES TO PV-MESSAGE                        32800000
328100                 MOVE TRIPST-TRIP-ID TO PV-MESSAGE1               32810000
328200                 MOVE TRIPST-TRIP-STATUS-CDE TO PV-MESSAGE2       32820000
328300                 MOVE '5030-INSERT-TTRIPST'                       32830000
328400                                   TO DP013-PARAGRAPH             32840000
328500                 MOVE 'INSERT A ROW ON TTRIPST'                   32850000
328600                                   TO DP013-MESSAGE-TEXT(1)       32860000
328700                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       32870000
328800                 MOVE SQLCA        TO DP013-SQLCA                 32880000
328900                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    32890000
329000                 SET DP013-DB2-ABEND                              32900000
329100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32910000
329200                 PERFORM DP013-0000-PROCESS-ABEND                 32920000
329300         END-EVALUATE                                             32930000
329400     END-PERFORM.                                                 32940000
329500                                                                  32950000
329600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32960000
329700         MOVE '5030-INSERT-TTRIPST'                               32970000
329800                                   TO DP013-PARAGRAPH             32980000
329900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              32990000
330000                                   TO DP013-MESSAGE-TEXT (1)      33000000
330100         MOVE 'TO INSERT A TTRIPST ROW'                           33010000
330200                                   TO DP013-MESSAGE-TEXT (2)      33020000
330300         MOVE SQLCA                TO DP013-SQLCA                 33030000
330400         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    33040000
330500         SET DP013-DB2-ABEND                                      33050000
330600             DP013-XCTL-DISPLAY-RESTART                           33060000
330700                                   TO TRUE                        33070000
330800         PERFORM DP013-0000-PROCESS-ABEND                         33080000
330900     END-IF.                                                      33090000
331000                                                                  33100000
331100 3697-RELEASE-OLD-VEHICLE.                                        33110000
331200                                                                  33120000
331300     MOVE ASC-PREV-VEH-NBR               TO DK-VEH-NBR.           33130000
331400     MOVE ASC-PREV-PRO-SCAC-ID           TO DK-PRO-SCAC-ID.       33140000
331500     MOVE -1                             TO DN-TRIP-ID.           33150000
331600     MOVE 'DP'                           TO PV-STATUS-CDE.        33160000
331700     PERFORM 3640-UPDATE-TVEHICL-TRIP                             33170000
331800     IF SQLCODE = +0                                              33180000
331900        SET PS-TVEHICL-AUD-PVEHSCAC      TO TRUE                  33190000
332000     END-IF.                                                      33200000
332100                                                                  33210000
332200 3700-VALIDATE-DATE.                                              33220000
332300*----------------------------------------------------------------*33230000
332400*    TAKES THE DATE FIELDS ENTERED AND ADDS LEADING ZEROS IF     *33240000
332500*    NEEDED.  IF THE FIELDS ENTERED ON THE SCREEN ARE NOT NUMERIC*33250000
332600*    A SWITCH IS SET.                                            *33260000
332700*                                                                *33270000
332800*    PERFORMED BY 3350-VALIDATE-ETA-DATE.                        *33280000
332900*----------------------------------------------------------------*33290000
333000                                                                  33300000
333100     SET PS-VALID-DATE           TO TRUE.                         33310000
333200                                                                  33320000
333300     MOVE PV-VALID-DATE-MM       TO DP010I-UNEDITED-FIELD.        33330000
333400     MOVE +2                     TO DP010I-MAXIMUM-DIGITS.        33340000
333500     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      33350000
333600                                                                  33360000
333700     SET DP010I-NEGATIVE-NOT-ALLOWED                              33370000
333800                                 TO TRUE.                         33380000
333900                                                                  33390000
273427     CALL DP010I-NUMERIC-EDIT-ROUTINE                             33401008
273427          USING DP010I-NUMERIC-EDIT-AREA.                         33402008
334100                                                                  33410000
334200     IF DP010I-ERROR-DETECTED                                     33420000
334300         SET PS-INVALID-DATE     TO TRUE                          33430000
334400     ELSE                                                         33440000
334500         MOVE DP010I-NUMERIC-FIELD                                33450000
334600                                 TO PV-INPUT-DATE-MM              33460000
334700     END-IF.                                                      33470000
334800                                                                  33480000
334900     MOVE PV-VALID-DATE-DD       TO DP010I-UNEDITED-FIELD.        33490000
335000     MOVE +2                     TO DP010I-MAXIMUM-DIGITS.        33500000
335100     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      33510000
335200                                                                  33520000
335300     SET DP010I-NEGATIVE-NOT-ALLOWED                              33530000
335400                                 TO TRUE.                         33540000
335500                                                                  33550000
273427     CALL DP010I-NUMERIC-EDIT-ROUTINE                             33561008
273427          USING DP010I-NUMERIC-EDIT-AREA.                         33562008
335700                                                                  33570000
335800     IF DP010I-ERROR-DETECTED                                     33580000
335900         SET PS-INVALID-DATE     TO TRUE                          33590000
336000     ELSE                                                         33600000
336100         MOVE DP010I-NUMERIC-FIELD                                33610000
336200                                 TO PV-INPUT-DATE-DD              33620000
336300     END-IF.                                                      33630000
336400                                                                  33640000
336500     MOVE PV-VALID-DATE-CCYY     TO DP010I-UNEDITED-FIELD.        33650000
336600     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        33660000
336700     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      33670000
336800                                                                  33680000
336900     SET DP010I-NEGATIVE-NOT-ALLOWED                              33690000
337000                                 TO TRUE.                         33700000
337100                                                                  33710000
273427     CALL DP010I-NUMERIC-EDIT-ROUTINE                             33721008
273427          USING DP010I-NUMERIC-EDIT-AREA.                         33722008
337300                                                                  33730000
337400     IF DP010I-ERROR-DETECTED                                     33740000
337500         SET PS-INVALID-DATE     TO TRUE                          33750000
337600     ELSE                                                         33760000
337700         MOVE DP010I-NUMERIC-FIELD                                33770000
337800                                 TO PV-INPUT-DATE-CCYY            33780000
337900     END-IF.                                                      33790000
338000                                                                  33800000
338100*                                                                 33810000
338200*                                                                 33820000
338300 3710-UPDATE-TSHIPMT.                                             33830000
338400                                                                  33840000
338500     MOVE ASC-FB-CARTON-CNT   TO SHIPMT-EXPTED-PKG-QTY.           33850000
338600     MOVE ASC-VEND-SHIP-MM    TO PV-DB2-MM.                       33860000
338700     MOVE ASC-VEND-SHIP-DD    TO PV-DB2-DD.                       33870000
338800     MOVE ASC-VEND-SHIP-CCYY  TO PV-DB2-CCYY.                     33880000
338900     MOVE PV-DB2-DATE         TO SHIPMT-VEND-SHIP-DTE.            33890000
339000     MOVE ASC-AUTH-MM         TO PV-DB2-MM.                       33900000
339100     MOVE ASC-AUTH-DD         TO PV-DB2-DD.                       33910000
339200     MOVE ASC-AUTH-CCYY       TO PV-DB2-CCYY.                     33920000
339300     MOVE PV-DB2-DATE         TO SHIPMT-AUTH-DTE.                 33930000
339400     MOVE PC-DEFAULT-TMST     TO PV-TEMP-TMST.                    33940000
339500     IF ASC-ETA-DTE = SPACES                                      33950000
339600         MOVE '01'            TO PV-TMST-DD                       33960000
339700                                 PV-TMST-MM                       33970000
339800         MOVE '0001'          TO PV-TMST-CCYY                     33980000
339900     ELSE                                                         33990000
340000         MOVE ASC-ETA-DD          TO PV-TMST-DD                   34000000
340100         MOVE ASC-ETA-MM          TO PV-TMST-MM                   34010000
340200         MOVE ASC-ETA-CCYY        TO PV-TMST-CCYY                 34020000
340300     END-IF.                                                      34030000
340400     MOVE ASC-ETA-TIME-HH     TO PV-TMST-HH.                      34040000
340500     MOVE ASC-ETA-TIME-MN     TO PV-TMST-MN.                      34050000
340600     MOVE PV-TEMP-TMST        TO SHIPMT-EST-AR-TMST.              34060000
340700                                                                  34070000
340800                                                                  34080000
340900     PERFORM                                                      34090000
341000         WITH TEST AFTER                                          34100000
341100         VARYING PV-RETRY-COUNTER                                 34110000
341200         FROM 1 BY 1                                              34120000
341300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34130000
341400                   OR (SQLCODE = ZERO))                           34140000
341500                                                                  34150000
341600         EXEC SQL                                                 34160000
341700            UPDATE TSHIPMT                                        34170000
341800               SET PRO_NBR          = :ASC-PRO-NBR                34180000
341900                  ,BOL_NBR          = :ASC-BOL-NBR                34190000
342000                  ,ORIG_SCAC_ID     = :ASC-ORIG-SCAC-ID           34200000
342100                  ,EXPTED_PKG_QTY   = :SHIPMT-EXPTED-PKG-QTY      34210000
342200                  ,VEND_SHIP_DTE    = :SHIPMT-VEND-SHIP-DTE       34220000
342300                  ,AUTH_DTE         = :SHIPMT-AUTH-DTE            34230000
342400                  ,AUTH_NBR         = :ASC-AUTH-NBR               34240000
342500                  ,EST_AR_TMST      = :SHIPMT-EST-AR-TMST         34250000
342600                  ,LAST_UPD_DTE     = CURRENT DATE                34260000
342700                  ,LAST_UPD_TME     = CURRENT TIME                34270000
342800                  ,LAST_UPD_UID     = :DP020-USERID               34280000
342900                  ,COMPLETE_PRO_NBR = :ASC-COMPLETE-PRO-NBR       34290000
343000                  ,COMPLETE_BOL_NBR = :ASC-COMPLETE-BOL-NBR       34300000
343100             WHERE SHIPT_ID         = :ASC-SHIPT-ID               34310000
343200               AND TRIP_ID          = :ASC-TRIP-ID                34320000
343300         END-EXEC                                                 34330000
343400                                                                  34340000
343500         EVALUATE TRUE                                            34350000
343600             WHEN SQLCODE = ZERO                                  34360000
343700             WHEN SQLCODE = -904                                  34370000
343800             WHEN SQLCODE = -913                                  34380000
343900                 CONTINUE                                         34390000
344000                                                                  34400000
344100             WHEN SQLWARN0 NOT = SPACES                           34410000
344200             WHEN SQLCODE < ZERO                                  34420000
344300             WHEN SQLCODE > ZERO                                  34430000
344400                 MOVE '3710-UPDATE-TSHIPMT'                       34440000
344500                                 TO DP013-PARAGRAPH               34450000
344600                 MOVE 'UPDATING THE SHIPMENT TABLE'               34460000
344700                                 TO DP013-MESSAGE-TEXT (1)        34470000
344800                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT (2)      34480000
344900                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT (2)      34490000
345000                 MOVE SQLCA      TO DP013-SQLCA                   34500000
345100                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      34510000
345200                 SET DP013-DB2-ABEND                              34520000
345300                                 TO TRUE                          34530000
345400                 SET DP013-XCTL-DISPLAY-RESTART                   34540000
345500                                 TO TRUE                          34550000
345600                 PERFORM DP013-0000-PROCESS-ABEND                 34560000
345700         END-EVALUATE                                             34570000
345800     END-PERFORM.                                                 34580000
345900                                                                  34590000
346000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34600000
346100         MOVE '3710-UPDATE-TSHIPMT'                               34610000
346200                                 TO DP013-PARAGRAPH               34620000
346300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     34630000
346400                                 TO DP013-MESSAGE-TEXT (1)        34640000
346500         MOVE 'SHIPMENT      '   TO DP013-MESSAGE-TEXT (2)        34650000
346600         MOVE SQLCA              TO DP013-SQLCA                   34660000
346700         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      34670000
346800         SET DP013-DB2-ABEND     TO TRUE                          34680000
346900         SET DP013-XCTL-DISPLAY-RESTART                           34690000
347000                                 TO TRUE                          34700000
347100         PERFORM DP013-0000-PROCESS-ABEND                         34710000
347200     END-IF.                                                      34720000
347300                                                                  34730000
347400 3715-UPDATE-TSHIPMT-PROBOL.                                      34740000
347500                                                                  34750000
347600     PERFORM                                                      34760000
347700         WITH TEST AFTER                                          34770000
347800         VARYING PV-RETRY-COUNTER                                 34780000
347900         FROM 1 BY 1                                              34790000
348000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34800000
348100                   OR (SQLCODE = ZERO))                           34810000
348200                                                                  34820000
348300         EXEC SQL                                                 34830000
348400            UPDATE TSHIPMT                                        34840000
348500               SET PRO_NBR          = :ASC-PRO-NBR                34850000
348600                  ,BOL_NBR          = :ASC-BOL-NBR                34860000
348700                  ,LAST_UPD_DTE     = CURRENT DATE                34870000
348800                  ,LAST_UPD_TME     = CURRENT TIME                34880000
348900                  ,LAST_UPD_UID     = :DP020-USERID               34890000
349000                  ,COMPLETE_PRO_NBR = :ASC-COMPLETE-PRO-NBR       34900000
349100                  ,COMPLETE_BOL_NBR = :ASC-COMPLETE-BOL-NBR       34910000
349200             WHERE SHIPT_ID         = :ASC-SHIPT-ID               34920000
349300               AND TRIP_ID          = :ASC-TRIP-ID                34930000
349400         END-EXEC                                                 34940000
349500                                                                  34950000
349600         EVALUATE TRUE                                            34960000
349700             WHEN SQLCODE = ZERO                                  34970000
349800             WHEN SQLCODE = -904                                  34980000
349900             WHEN SQLCODE = -913                                  34990000
350000                 CONTINUE                                         35000000
350100                                                                  35010000
350200             WHEN SQLWARN0 NOT = SPACES                           35020000
350300             WHEN SQLCODE < ZERO                                  35030000
350400             WHEN SQLCODE > ZERO                                  35040000
350500                 MOVE '3715-UPDATE-TSHIPMT-PROBOL'                35050000
350600                                 TO DP013-PARAGRAPH               35060000
350700                 MOVE 'UPDATING THE SHIPMENT TABLE'               35070000
350800                                 TO DP013-MESSAGE-TEXT (1)        35080000
350900                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT (2)      35090000
351000                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT (3)      35100000
351100                 MOVE SQLCA      TO DP013-SQLCA                   35110000
351200                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      35120000
351300                 SET DP013-DB2-ABEND                              35130000
351400                                 TO TRUE                          35140000
351500                 SET DP013-XCTL-DISPLAY-RESTART                   35150000
351600                                 TO TRUE                          35160000
351700                 PERFORM DP013-0000-PROCESS-ABEND                 35170000
351800         END-EVALUATE                                             35180000
351900     END-PERFORM.                                                 35190000
352000                                                                  35200000
352100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35210000
352200         MOVE '3715-UPDATE-TSHIPMT-PROBOL'                        35220000
352300                                 TO DP013-PARAGRAPH               35230000
352400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     35240000
352500                                 TO DP013-MESSAGE-TEXT (1)        35250000
352600         MOVE 'SHIPMENT      '   TO DP013-MESSAGE-TEXT (2)        35260000
352700         MOVE SQLCA              TO DP013-SQLCA                   35270000
352800         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      35280000
352900         SET DP013-DB2-ABEND     TO TRUE                          35290000
353000         SET DP013-XCTL-DISPLAY-RESTART                           35300000
353100                                 TO TRUE                          35310000
353200         PERFORM DP013-0000-PROCESS-ABEND                         35320000
353300     END-IF.                                                      35330000
353400                                                                  35340000
353500 3720-GET-ETA-DATE.                                               35350000
353600                                                                  35360000
353700     PERFORM WITH TEST AFTER                                      35370000
353800         VARYING PV-RETRY-COUNTER                                 35380000
353900         FROM 1 BY 1                                              35390000
354000         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 35400000
354100                 OR SQLCODE = 0)                                  35410000
354200                                                                  35420000
354300         EXEC SQL                                                 35430000
354400             SELECT (DATE(EST_AR_TMST))                           35440000
354500             INTO   :PV-DATE :DN-EST-AR-TMST                      35450000
354600             FROM   TVHTRIP                                       35460000
354700             WHERE  VEH_NBR       = :ASC-VEH-NBR                  35470000
354800               AND  OWNER_SCAC_ID = :DK-SCAC                      35480000
354900               AND  TRIP_ID       = :DK-TRIP-ID                   35490000
355000         END-EXEC                                                 35500000
355100                                                                  35510000
355200         EVALUATE TRUE                                            35520000
355300             WHEN SQLCODE = ZERO                                  35530000
355400             WHEN SQLCODE = -904                                  35540000
355500             WHEN SQLCODE = -913                                  35550000
355600                 CONTINUE                                         35560000
355700             WHEN SQLWARN0 NOT = SPACES                           35570000
355800             WHEN SQLCODE NOT EQUAL ZERO                          35580000
355900                 MOVE SPACES TO PV-MESSAGE                        35590000
356000                 MOVE ASC-VEH-NBR TO PV-MESSAGE1                  35600000
356100                 MOVE DK-SCAC TO PV-MESSAGE2                      35610000
356200                 MOVE DK-TRIP-ID TO PV-MESSAGE3                   35620000
356300                 MOVE '3720-GET-ETA-DATE'                         35630000
356400                                 TO DP013-PARAGRAPH               35640000
356500                 MOVE 'GET ETA DATE '                             35650000
356600                                 TO DP013-MESSAGE-TEXT(1)         35660000
356700                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT(2)         35670000
356800                 MOVE SQLCA      TO DP013-SQLCA                   35680000
356900                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME(1)       35690000
357000                 SET DP013-DB2-ABEND                              35700000
357100                                 TO TRUE                          35710000
357200                 SET DP013-NO-ROLLBACK                            35720000
357300                                 TO TRUE                          35730000
357400                 SET DP013-XCTL-DISPLAY-RESTART                   35740000
357500                                 TO TRUE                          35750000
357600                 PERFORM DP013-0000-PROCESS-ABEND                 35760000
357700         END-EVALUATE                                             35770000
357800     END-PERFORM.                                                 35780000
357900                                                                  35790000
358000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         35800000
358100         MOVE '3720-GET-ETA-DATE'                                 35810000
358200                                 TO DP013-PARAGRAPH               35820000
358300         MOVE 'GET ETA DATE '        TO DP013-MESSAGE-TEXT(1)     35830000
358400         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    35840000
358500                                 TO DP013-MESSAGE-TEXT(2)         35850000
358600         MOVE SQLCA              TO DP013-SQLCA                   35860000
358700         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME(1)       35870000
358800         SET DP013-DB2-ABEND     TO TRUE                          35880000
358900         SET DP013-NO-ROLLBACK   TO TRUE                          35890000
359000         SET DP013-XCTL-DISPLAY-RESTART                           35900000
359100                                 TO TRUE                          35910000
359200         PERFORM DP013-0000-PROCESS-ABEND                         35920000
359300     END-IF.                                                      35930000
359400                                                                  35940000
359500     EVALUATE TRUE                                                35950000
359600         WHEN SQLCODE = ZERO                                      35960000
359700              IF  DN-EST-AR-TMST NOT EQUAL -1                     35970000
359800                  MOVE PV-DATE TO PV-TEMP-DATE                    35980000
359900                  MOVE PV-DATE-CCYY TO PV-VALID-DATE-CCYY         35990000
360000                  MOVE PV-DATE-MM   TO PV-VALID-DATE-MM           36000000
360100                  MOVE PV-DATE-DD   TO PV-VALID-DATE-DD           36010000
360200                  MOVE PV-VALID-DATE TO PV-VALID-ETA-DTE-2        36020000
360300                  PERFORM 3400-CALL-DATE-RANGE-RTN                36030000
360400                     IF DPG54-DATE-VALID                          36040000
360500                        CONTINUE                                  36050000
360600                     ELSE                                         36060000
360700                        MOVE '3720-GET-ETA-DATE'                  36070000
360800                                       TO DP013-PARAGRAPH         36080000
360900                        MOVE 'INVALID DATE RANGE'                 36090000
361000                                  TO DP013-MESSAGE-TEXT(1)        36100000
361100                        SET DP013-CICS-ABEND                      36110000
361200                            DP013-XCTL-DISPLAY-RESTART            36120000
361300                                          TO TRUE                 36130000
361400                        PERFORM DP013-0000-PROCESS-ABEND          36140000
361500                     END-IF                                       36150000
361600              END-IF                                              36160000
361700     END-EVALUATE.                                                36170000
361800 3725-UPDATE-TSHIPMT-SCACONLY.                                    36180000
361900                                                                  36190000
362000     PERFORM                                                      36200000
362100         WITH TEST AFTER                                          36210000
362200         VARYING PV-RETRY-COUNTER                                 36220000
362300         FROM 1 BY 1                                              36230000
362400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36240000
362500                   OR (SQLCODE = ZERO))                           36250000
362600                                                                  36260000
362700         EXEC SQL                                                 36270000
362800            UPDATE TSHIPMT                                        36280000
362900               SET PRO_SCAC_ID      = :ASC-PRO-SCAC-ID            36290000
363000                  ,LAST_UPD_DTE     = CURRENT DATE                36300000
363100                  ,LAST_UPD_TME     = CURRENT TIME                36310000
363200                  ,LAST_UPD_UID     = :DP020-USERID               36320000
363300             WHERE SHIPT_ID         = :ASC-SHIPT-ID               36330000
363400               AND TRIP_ID          = :ASC-TRIP-ID                36340000
363500         END-EXEC                                                 36350000
363600                                                                  36360000
363700         EVALUATE TRUE                                            36370000
363800             WHEN SQLCODE = ZERO                                  36380000
363900             WHEN SQLCODE = -904                                  36390000
364000             WHEN SQLCODE = -913                                  36400000
364100                 CONTINUE                                         36410000
364200                                                                  36420000
364300             WHEN SQLWARN0 NOT = SPACES                           36430000
364400             WHEN SQLCODE < ZERO                                  36440000
364500             WHEN SQLCODE > ZERO                                  36450000
364600                 MOVE '3725-UPDATE-TSHIPMT-SCACONLY'              36460000
364700                                 TO DP013-PARAGRAPH               36470000
364800                 MOVE 'UPDATING THE SHIPMENT TABLE'               36480000
364900                                 TO DP013-MESSAGE-TEXT (1)        36490000
365000                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT (2)      36500000
365100                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT (3)      36510000
365200                 MOVE SQLCA      TO DP013-SQLCA                   36520000
365300                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      36530000
365400                 SET DP013-DB2-ABEND                              36540000
365500                                 TO TRUE                          36550000
365600                 SET DP013-XCTL-DISPLAY-RESTART                   36560000
365700                                 TO TRUE                          36570000
365800                 PERFORM DP013-0000-PROCESS-ABEND                 36580000
365900         END-EVALUATE                                             36590000
366000     END-PERFORM.                                                 36600000
366100                                                                  36610000
366200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36620000
366300         MOVE '3725-UPDATE-TSHIPMT'                               36630000
366400                                 TO DP013-PARAGRAPH               36640000
366500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     36650000
366600                                 TO DP013-MESSAGE-TEXT (1)        36660000
366700         MOVE 'SHIPMENT      '   TO DP013-MESSAGE-TEXT (2)        36670000
366800         MOVE SQLCA              TO DP013-SQLCA                   36680000
366900         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      36690000
367000         SET DP013-DB2-ABEND     TO TRUE                          36700000
367100         SET DP013-XCTL-DISPLAY-RESTART                           36710000
367200                                 TO TRUE                          36720000
367300         PERFORM DP013-0000-PROCESS-ABEND                         36730000
367400     END-IF.                                                      36740000
367500                                                                  36750000
367600     EVALUATE TRUE                                                36760000
367700        WHEN SQLCODE = +0                                         36770000
367800           SET PS-TSHIPMT-AUD-SHIPTID TO TRUE                     36780000
367900     END-EVALUATE.                                                36790000
368000                                                                  36800000
368100 3730-UPDATE-TVHTRIP-SCACONLY.                                    36810000
368200                                                                  36820000
368300     PERFORM                                                      36830000
368400         WITH TEST AFTER                                          36840000
368500         VARYING PV-RETRY-COUNTER                                 36850000
368600         FROM 1 BY 1                                              36860000
368700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36870000
368800                   OR (SQLCODE = ZERO))                           36880000
368900                                                                  36890000
369000         EXEC SQL                                                 36900000
369100            UPDATE TVHTRIP                                        36910000
369200               SET OWNER_SCAC_ID   = :ASC-PRO-SCAC-ID             36920000
369300                  ,LAST_UPD_DTE    = CURRENT DATE                 36930000
369400                  ,LAST_UPD_TME    = CURRENT TIME                 36940000
369500                  ,LAST_UPD_UID    = :DP020-USERID                36950000
369600             WHERE TRIP_ID         = :ASC-TRIP-ID                 36960000
369700         END-EXEC                                                 36970000
369800                                                                  36980000
369900         EVALUATE TRUE                                            36990000
370000             WHEN SQLCODE = ZERO                                  37000000
370100             WHEN SQLCODE = -904                                  37010000
370200             WHEN SQLCODE = -913                                  37020000
370300                 CONTINUE                                         37030000
370400                                                                  37040000
370500             WHEN SQLWARN0 NOT = SPACES                           37050000
370600             WHEN SQLCODE < ZERO                                  37060000
370700             WHEN SQLCODE > ZERO                                  37070000
370800                 MOVE '3730-UPDATE-TVHTRIP-SCACONLY'              37080000
370900                                 TO DP013-PARAGRAPH               37090000
371000                 MOVE 'UPDATING TRIP TABLE'                       37100000
371100                                 TO DP013-MESSAGE-TEXT (1)        37110000
371200                 MOVE ASC-TRIP-ID TO DP013-MESSAGE-TEXT (2)       37120000
371300                 MOVE SQLCA      TO DP013-SQLCA                   37130000
371400                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (1)      37140000
371500                 SET DP013-DB2-ABEND                              37150000
371600                                 TO TRUE                          37160000
371700                 SET DP013-XCTL-DISPLAY-RESTART                   37170000
371800                                 TO TRUE                          37180000
371900                 PERFORM DP013-0000-PROCESS-ABEND                 37190000
372000         END-EVALUATE                                             37200000
372100     END-PERFORM.                                                 37210000
372200                                                                  37220000
372300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37230000
372400         MOVE '3730-UPDATE-TVHTRIP-SCACONLY'                      37240000
372500                                 TO DP013-PARAGRAPH               37250000
372600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     37260000
372700                                 TO DP013-MESSAGE-TEXT (1)        37270000
372800         MOVE 'TRIP          '   TO DP013-MESSAGE-TEXT (2)        37280000
372900         MOVE SQLCA              TO DP013-SQLCA                   37290000
373000         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (1)      37300000
373100         SET DP013-DB2-ABEND     TO TRUE                          37310000
373200         SET DP013-XCTL-DISPLAY-RESTART                           37320000
373300                                 TO TRUE                          37330000
373400         PERFORM DP013-0000-PROCESS-ABEND                         37340000
373500     END-IF.                                                      37350000
373600                                                                  37360000
373700     IF SQLCODE = 0                                               37370000
373800        SET PS-TVHTRIP-AUD-TRIPID TO TRUE                         37380000
373900     END-IF.                                                      37390000
374000                                                                  37400000
374100 3800-VALIDATE-FCLTY-ID.                                          37410000
374200                                                                  37420000
374300     PERFORM                                                      37430000
374400         WITH TEST AFTER                                          37440000
374500         VARYING PV-RETRY-COUNTER                                 37450000
374600         FROM 1 BY 1                                              37460000
374700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37470000
374800                   OR (SQLCODE = ZERO)                            37480000
374900                   OR (SQLCODE = +100))                           37490000
375000                                                                  37500000
375100         EXEC SQL                                                 37510000
375200            SELECT  FCLTY_ID                                      37520000
375300                   ,FCLTY_NME                                     37530000
375400              INTO :FACLTY-FCLTY-ID                               37540000
375500                  ,:FACLTY-FCLTY-NME                              37550000
375600              FROM  TFACLTY                                       37560000
375700             WHERE  OPER_UNT_ID = :PV-OPER-UNT-ID                 37570000
375800               AND  FCLTY_ID    = :PV-FCLTY-ID                    37580000
375900         END-EXEC                                                 37590000
376000                                                                  37600000
376100         EVALUATE TRUE                                            37610000
376200             WHEN SQLCODE = ZERO                                  37620000
376300                 MOVE FACLTY-FCLTY-NME                            37630000
376400                                 TO ASC-FCLTY-NME                 37640000
376500                                    AFDESCO                       37650000
376600                                                                  37660000
376700             WHEN SQLCODE = +100                                  37670000
376800             WHEN SQLCODE = -904                                  37680000
376900             WHEN SQLCODE = -913                                  37690000
377000                 CONTINUE                                         37700000
377100                                                                  37710000
377200             WHEN SQLWARN0 NOT = SPACES                           37720000
377300             WHEN SQLCODE < ZERO                                  37730000
377400             WHEN SQLCODE > ZERO                                  37740000
377500                 MOVE '3800-VALIDATE-FCLTY-ID'                    37750000
377600                                 TO DP013-PARAGRAPH               37760000
377700                 MOVE 'GET FCLTY NAME     '                       37770000
377800                                 TO DP013-MESSAGE-TEXT (1)        37780000
377900                 MOVE PV-OPER-UNT-ID                              37790000
378000                                 TO DP013-MESSAGE-TEXT (2)        37800000
378100                 MOVE PV-FCLTY-ID                                 37810000
378200                                 TO DP013-MESSAGE-TEXT (2)        37820000
378300                 MOVE SQLCA      TO DP013-SQLCA                   37830000
378400                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      37840000
378500                 SET DP013-DB2-ABEND                              37850000
378600                                 TO TRUE                          37860000
378700                 SET DP013-XCTL-DISPLAY-RESTART                   37870000
378800                                 TO TRUE                          37880000
378900                 PERFORM DP013-0000-PROCESS-ABEND                 37890000
379000         END-EVALUATE                                             37900000
379100     END-PERFORM.                                                 37910000
379200                                                                  37920000
379300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37930000
379400         MOVE '3800-VALIDATE-FCLTY-ID'                            37940000
379500                                 TO DP013-PARAGRAPH               37950000
379600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     37960000
379700                                 TO DP013-MESSAGE-TEXT (1)        37970000
379800         MOVE 'GET FCLTY NAME'   TO DP013-MESSAGE-TEXT (2)        37980000
379900         MOVE SQLCA              TO DP013-SQLCA                   37990000
380000         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      38000000
380100         SET DP013-DB2-ABEND     TO TRUE                          38010000
380200         SET DP013-XCTL-DISPLAY-RESTART                           38020000
380300                                 TO TRUE                          38030000
380400         PERFORM DP013-0000-PROCESS-ABEND                         38040000
380500     END-IF.                                                      38050000
380600                                                                  38060000
380700     IF SQLCODE = +100                                            38070000
380800        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     38080000
380900        MOVE PC-TSYMSG-01004 TO DP020-MSG-NUMBER                  38090000
381000        SET DP020-MSG-FATAL                                       38100000
381100            PS-ERROR      TO TRUE                                 38110000
381200     END-IF.                                                      38120000
381300                                                                  38130000
381400 3900-VALIDATE-OPER-UNT-ID.                                       38140000
381500                                                                  38150000
381600     PERFORM                                                      38160000
381700         WITH TEST AFTER                                          38170000
381800         VARYING PV-RETRY-COUNTER                                 38180000
381900         FROM 1 BY 1                                              38190000
382000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38200000
382100                   OR (SQLCODE = ZERO)                            38210000
382200                   OR (SQLCODE = +100)                            38220000
382300                   OR (SQLCODE = -811))                           38230000
382400                                                                  38240000
382500         EXEC SQL                                                 38250000
382600            SELECT  OPER_UNT_ID                                   38260000
382700              INTO :FACLTY-OPER-UNT-ID                            38270000
382800              FROM  TFACLTY                                       38280000
382900             WHERE  OPER_UNT_ID = :PV-OPER-UNT-ID                 38290000
383000         END-EXEC                                                 38300000
383100                                                                  38310000
383200         EVALUATE TRUE                                            38320000
383300             WHEN SQLCODE = ZERO                                  38330000
383400             WHEN SQLCODE = +100                                  38340000
383500             WHEN SQLCODE = -811                                  38350000
383600             WHEN SQLCODE = -904                                  38360000
383700             WHEN SQLCODE = -913                                  38370000
383800                 CONTINUE                                         38380000
383900             WHEN SQLWARN0 NOT = SPACES                           38390000
384000             WHEN SQLCODE < ZERO                                  38400000
384100             WHEN SQLCODE > ZERO                                  38410000
384200                 MOVE '3900-VALIDATE-FCLTY-ID'                    38420000
384300                                 TO DP013-PARAGRAPH               38430000
384400                 MOVE 'SELECT STORE NUMBER'                       38440000
384500                                 TO DP013-MESSAGE-TEXT (1)        38450000
384600                 MOVE PV-OPER-UNT-ID                              38460000
384700                                 TO DP013-MESSAGE-TEXT (2)        38470000
384800                 MOVE SQLCA      TO DP013-SQLCA                   38480000
384900                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      38490000
385000                 SET DP013-DB2-ABEND                              38500000
385100                                 TO TRUE                          38510000
385200                 SET DP013-XCTL-DISPLAY-RESTART                   38520000
385300                                 TO TRUE                          38530000
385400                 PERFORM DP013-0000-PROCESS-ABEND                 38540000
385500         END-EVALUATE                                             38550000
385600     END-PERFORM.                                                 38560000
385700                                                                  38570000
385800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38580000
385900         MOVE '3900-VALIDATE-FCLTY-ID'                            38590000
386000                                 TO DP013-PARAGRAPH               38600000
386100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38610000
386200                                 TO DP013-MESSAGE-TEXT (1)        38620000
386300         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        38630000
386400         MOVE SQLCA              TO DP013-SQLCA                   38640000
386500         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      38650000
386600         SET DP013-DB2-ABEND     TO TRUE                          38660000
386700         SET DP013-XCTL-DISPLAY-RESTART                           38670000
386800                                 TO TRUE                          38680000
386900         PERFORM DP013-0000-PROCESS-ABEND                         38690000
387000     END-IF.                                                      38700000
387100                                                                  38710000
387200     IF SQLCODE = +100                                            38720000
387300        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     38730000
387400        MOVE PC-TSYMSG-01004 TO DP020-MSG-NUMBER                  38740000
387500        SET DP020-MSG-FATAL                                       38750000
387600            PS-ERROR      TO TRUE                                 38760000
387700     END-IF.                                                      38770000
387800                                                                  38780000
387900 EJECT                                                            38790000
388000 3950-GET-RANDOM-NUMBER.                                          38800000
388100     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     38810004
388200                                                                  38820000
389500     CALL PC-RANDNBR-PGM USING DFHEIBLK                           38950005
389510                               DFHCOMMAREA                        38951005
389520                               DP902-RANDNBR-ROUTINE-FIELDS.      38952005
389600                                                                  38960000
389700     IF  DP902-SUCCESSFUL                                         38970004
389800         NEXT SENTENCE                                            38980000
389900     ELSE                                                         38990000
390000         MOVE '3950-GET-RANDOM-NUMBER'  TO DP013-PARAGRAPH        39000000
390100         MOVE 'CALL TO DPKUT902 FAILED'                           39010004
390200                                   TO DP013-MESSAGE-TEXT(1)       39020000
390300         SET DP013-XCTL-DISPLAY-RESTART                           39030000
390400                                   TO TRUE                        39040000
390500         PERFORM DP013-0000-PROCESS-ABEND                         39050000
390600     END-IF.                                                      39060000
390700  EJECT                                                           39070000
390800                                                                  39080000
390900 3960-READ-DUPL-TVHTRIP.                                          39090000
391000                                                                  39100000
391100     MOVE DP902-RANDOM-NUMBER   TO PV-TRIP-ID.                    39110004
391200                                                                  39120000
391300     PERFORM                                                      39130000
391400         WITH TEST AFTER                                          39140000
391500         VARYING PV-RETRY-COUNTER                                 39150000
391600         FROM 1 BY 1                                              39160000
391700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39170000
391800             OR (SQLCODE = +0))                                   39180000
391900                                                                  39190000
392000         EXEC SQL                                                 39200000
392100              SELECT COUNT(*)                                     39210000
392200               INTO :PV-VHTRIP-COUNT                              39220000
392300                FROM  TVHTRIP                                     39230000
392400               WHERE (TRIP_ID         = :PV-TRIP-ID)              39240000
392500         END-EXEC                                                 39250000
392600                                                                  39260000
392700         EVALUATE TRUE                                            39270000
392800             WHEN SQLCODE = +0                                    39280000
392900             WHEN SQLCODE = -904                                  39290000
393000             WHEN SQLCODE = -913                                  39300000
393100                 CONTINUE                                         39310000
393200                                                                  39320000
393300             WHEN SQLWARN0 NOT = SPACES                           39330000
393400             WHEN SQLCODE < +0                                    39340000
393500             WHEN SQLCODE > +0                                    39350000
393600                 MOVE '3960-READ-DUPL-TVHTRIP'                    39360000
393700                                   TO DP013-PARAGRAPH             39370000
393800                 MOVE 'GET COUNT OF TRIPS'                        39380000
393900                                   TO DP013-MESSAGE-TEXT(1)       39390000
394000                 MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT(2)       39400000
394100                 MOVE SQLCA        TO DP013-SQLCA                 39410000
394200                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    39420000
394300                 SET DP013-DB2-ABEND                              39430000
394400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39440000
394500                 PERFORM DP013-0000-PROCESS-ABEND                 39450000
394600         END-EVALUATE                                             39460000
394700     END-PERFORM.                                                 39470000
394800                                                                  39480000
394900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39490000
395000         MOVE '3960-READ-DUPL-TVHTRIP'                            39500000
395100                                   TO DP013-PARAGRAPH             39510000
395200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              39520000
395300                                   TO DP013-MESSAGE-TEXT (1)      39530000
395400         MOVE 'TO COUNT TVHTRIP ROWS'                             39540000
395500                                   TO DP013-MESSAGE-TEXT (2)      39550000
395600         MOVE SQLCA                TO DP013-SQLCA                 39560000
395700         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    39570000
395800         SET DP013-DB2-ABEND                                      39580000
395900             DP013-XCTL-DISPLAY-RESTART                           39590000
396000                                   TO TRUE                        39600000
396100         PERFORM DP013-0000-PROCESS-ABEND                         39610000
396200     END-IF.                                                      39620000
396300                                                                  39630000
396400     IF PV-VHTRIP-COUNT > 0                                       39640000
396500         PERFORM 3950-GET-RANDOM-NUMBER                           39650000
396600     END-IF.                                                      39660000
396700                                                                  39670000
396800                                                                  39680000
396900*----------------------------------------------------------------*39690000
397000* OBTAIN THE PURCHASE ORDER INFORMATION FROM THE PO TABLES AND   *39700000
397100* DISPLAY THEM ON THE SCREEN.                                    *39710000
397200*----------------------------------------------------------------*39720000
397300                                                                  39730000
397400 4000-BUILD-INITIAL-PANEL.                                        39740000
397500                                                                  39750000
397600     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       39760000
397700     MOVE -1                       TO AFBNBRL.                    39770000
397800                                                                  39780000
397900     IF PS-NO-ERROR                                               39790000
398000        PERFORM 4100-GET-SHIPMENT-INFO                            39800000
398100        IF PS-SHIPMENT-EXIST                                      39810000
398200           PERFORM 4130-MOVE-SHIPMENT-INFO                        39820000
398300           PERFORM 4135-SAVE-FIELDS                               39830000
398400           MOVE SHIPMT-SHIPT-ID TO DK-SHIPT-ID                    39840000
398500                                   ASC-SHIPT-ID                   39850000
398600           MOVE SHIPMT-TRIP-ID  TO DK-TRIP-ID                     39860000
398700                                   ASC-TRIP-ID                    39870000
398800           PERFORM 4310-OPEN-PO-CSR                               39880000
398900           PERFORM 4320-FETCH-PO-CSR                              39890000
399000           PERFORM 4330-CLOSE-PO-CSR                              39900000
399100           IF PS-RECEIVERS-EXIST                                  39910000
399200              MOVE DP015-ASK-NOR-OFF  TO AFBCNTA                  39920000
399300              MOVE DP015-BLUE         TO AFBCNTC                  39930000
399400           END-IF                                                 39940000
399500        ELSE                                                      39950000
399600           SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                  39960000
399700           MOVE PC-TSYMSG-01016 TO DP020-MSG-NUMBER               39970000
399800           SET DP020-MSG-FATAL                                    39980000
399900               PS-ERROR        TO TRUE                            39990000
400000        END-IF                                                    40000000
400100     END-IF.                                                      40010000
400200                                                                  40020000
400300                                                                  40030000
400400 EJECT                                                            40040000
400500 4100-GET-SHIPMENT-INFO.                                          40050000
400600                                                                  40060000
400700     MOVE ASC-PRO-SCAC-ID        TO DK-PRO-SCAC.                  40070000
400800                                                                  40080000
400900     MOVE ASC-PRO-NBR TO DK-PRO-NBR.                              40090000
401000     MOVE ASC-BOL-NBR TO DK-BOL-NBR.                              40100000
401100     PERFORM 4110-SELECT-SHIP1.                                   40110000
401200                                                                  40120000
401300     IF PS-SHIPMENT-EXIST                                         40130000
401400        PERFORM 4120-CHECK-SHIPT-STATUS                           40140000
401500        IF ASC-SHIPT-STATUS-OK                                    40150000
401600           CONTINUE                                               40160000
401700        ELSE                                                      40170000
401800           SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                  40180000
401900           MOVE PC-TSYMSG-00992 TO DP020-MSG-NUMBER               40190000
402000           MOVE TRIPST-TRIP-STATUS-CDE TO DP020-MSG-TEXT          40200000
402100           SET DP020-MSG-FATAL                                    40210000
402200               PS-ERROR        TO TRUE                            40220000
402300        END-IF                                                    40230000
402400     END-IF.                                                      40240000
402500                                                                  40250000
402600 4110-SELECT-SHIP1.                                               40260000
402700*----------------------------------------------------------------*40270000
402800*----------------------------------------------------------------*40280000
402900                                                                  40290000
403000     MOVE +0 TO ASC-DN-VEH-NBR.                                   40300000
403100                                                                  40310000
403200     PERFORM WITH TEST AFTER                                      40320000
403300         VARYING PV-RETRY-COUNTER                                 40330000
403400         FROM 1 BY 1                                              40340000
403500         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 40350000
403600                 OR SQLCODE = 0                                   40360000
403700                 OR SQLCODE = +100                                40370000
403800                 OR SQLCODE = -811)                               40380000
403900                                                                  40390000
404000         EXEC SQL                                                 40400000
404100             SELECT A.TRIP_ID,                                    40410000
404200                    A.SHIPT_ID,                                   40420000
404300                    A.PRO_SCAC_ID,                                40430000
404400                    A.EXPTED_PKG_QTY,                             40440000
404500                    A.VEND_SHIP_DTE,                              40450000
404600                    A.AUTH_NBR,                                   40460000
404700                    A.AUTH_DTE,                                   40470000
404800                    A.ORIG_SCAC_ID,                               40480000
404900                    A.PRO_NBR,                                    40490000
405000                    A.BOL_NBR,                                    40500000
405100                    A.CARR_CART_CT,                               40510000
405200                    A.VEND_CART_CT,                               40520000
405300                    B.EST_AR_TMST,                                40530000
405400                    B.VEH_NBR,                                    40540000
405500                    B.OWNER_SCAC_ID                               40550000
405600             INTO   :SHIPMT-TRIP-ID,                              40560000
405700                    :SHIPMT-SHIPT-ID,                             40570000
405800                    :SHIPMT-PRO-SCAC-ID,                          40580000
405900                    :SHIPMT-EXPTED-PKG-QTY,                       40590000
406000                    :SHIPMT-VEND-SHIP-DTE,                        40600000
406100                    :SHIPMT-AUTH-NBR,                             40610000
406200                    :SHIPMT-AUTH-DTE,                             40620000
406300                    :SHIPMT-ORIG-SCAC-ID,                         40630000
406400                    :SHIPMT-PRO-NBR,                              40640000
406500                    :SHIPMT-BOL-NBR,                              40650000
406600                    :SHIPMT-CARR-CART-CT,                         40660000
406700                    :SHIPMT-VEND-CART-CT,                         40670000
406800                    :VHTRIP-EST-AR-TMST :DN-EST-AR-TMST,          40680000
406900                    :VHTRIP-VEH-NBR :ASC-DN-VEH-NBR,              40690000
407000                    :VHTRIP-OWNER-SCAC-ID                         40700000
407100             FROM   TSHIPMT A,                                    40710000
407200                    TVHTRIP B                                     40720000
407300             WHERE  A.PRO_SCAC_ID   = :ASC-PRO-SCAC-ID            40730000
407400             AND    A.PRO_NBR       = :DK-PRO-NBR                 40740000
407500             AND    A.BOL_NBR       = :DK-BOL-NBR                 40750000
407600             AND    A.TRIP_ID       = B.TRIP_ID                   40760000
407700         END-EXEC                                                 40770000
407800                                                                  40780000
407900         EVALUATE TRUE                                            40790000
408000             WHEN SQLCODE = ZERO                                  40800000
408100             WHEN SQLCODE = +100                                  40810000
408200             WHEN SQLCODE = -811                                  40820000
408300             WHEN SQLCODE = -904                                  40830000
408400             WHEN SQLCODE = -913                                  40840000
408500                 CONTINUE                                         40850000
408600             WHEN SQLWARN0 NOT = SPACES                           40860000
408700             WHEN SQLCODE NOT EQUAL ZERO                          40870000
408800                 MOVE SPACES TO PV-MESSAGE                        40880000
408900                 MOVE ASC-PRO-SCAC-ID TO PV-MESSAGE1              40890000
409000                 MOVE DK-PRO-NBR TO PV-MESSAGE2                   40900000
409100                 MOVE DK-BOL-NBR TO PV-MESSAGE3                   40910000
409200                 MOVE '4110-SELECT-SHIP1'                         40920000
409300                                 TO DP013-PARAGRAPH               40930000
409400                 MOVE 'CHECK SHIPMENT'                            40940000
409500                                 TO DP013-MESSAGE-TEXT(1)         40950000
409600                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT(2)         40960000
409700                 MOVE SQLCA      TO DP013-SQLCA                   40970000
409800                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)       40980000
409900                 SET DP013-DB2-ABEND                              40990000
410000                                 TO TRUE                          41000000
410100                 SET DP013-NO-ROLLBACK                            41010000
410200                                 TO TRUE                          41020000
410300                 SET DP013-XCTL-DISPLAY-RESTART                   41030000
410400                                 TO TRUE                          41040000
410500                 PERFORM DP013-0000-PROCESS-ABEND                 41050000
410600         END-EVALUATE                                             41060000
410700     END-PERFORM.                                                 41070000
410800                                                                  41080000
410900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41090000
411000         MOVE '4110-SELECT-SHIP1'                                 41100000
411100                                 TO DP013-PARAGRAPH               41110000
411200         MOVE 'CHECK SHIPMENT'   TO DP013-MESSAGE-TEXT(1)         41120000
411300         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    41130000
411400                                 TO DP013-MESSAGE-TEXT(2)         41140000
411500         MOVE SQLCA              TO DP013-SQLCA                   41150000
411600         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME(1)       41160000
411700         SET DP013-DB2-ABEND     TO TRUE                          41170000
411800         SET DP013-NO-ROLLBACK   TO TRUE                          41180000
411900         SET DP013-XCTL-DISPLAY-RESTART                           41190000
412000                                 TO TRUE                          41200000
412100         PERFORM DP013-0000-PROCESS-ABEND                         41210000
412200     END-IF.                                                      41220000
412300                                                                  41230000
412400     EVALUATE TRUE                                                41240000
412500         WHEN SQLCODE = ZERO                                      41250000
412600         WHEN SQLCODE = -811                                      41260000
412700              SET PS-SHIPMENT-EXIST TO TRUE                       41270000
412800         WHEN SQLCODE = +100                                      41280000
412900              SET PS-SHIPMENT-DOESNT-EXIST TO TRUE                41290000
413000     END-EVALUATE.                                                41300000
413100                                                                  41310000
413200 EJECT                                                            41320000
413300                                                                  41330000
413400*                                                                 41340000
413500 4120-CHECK-SHIPT-STATUS.                                         41350000
413600                                                                  41360000
413700     PERFORM WITH TEST AFTER                                      41370000
413800         VARYING PV-RETRY-COUNTER                                 41380000
413900         FROM 1 BY 1                                              41390000
414000         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 41400000
414100                 OR SQLCODE = 0                                   41410000
414200                 OR SQLCODE = +100)                               41420000
414300                                                                  41430000
414400         EXEC SQL                                                 41440000
414500           SELECT DISTINCT                                        41450000
414600                  A.TRIP_STATUS_CDE                               41460000
414700                 ,B.PRTY_CDE                                      41470000
414800           INTO   :TRIPST-TRIP-STATUS-CDE                         41480000
414900                 ,:TRSTYP-PRTY-CDE                                41490000
415000           FROM   TTRIPST A                                       41500000
415100                 ,TTRSTYP B                                       41510000
415200           WHERE  A.TRIP_ID     = :SHIPMT-TRIP-ID                 41520000
415300             AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE           41530000
415400             AND  B.PRTY_CDE =                                    41540000
415500                 (SELECT DISTINCT                                 41550000
415600                      MAX(D.PRTY_CDE)                             41560000
415700                   FROM   TTRIPST C                               41570000
415800                         ,TTRSTYP D                               41580000
415900                   WHERE  C.TRIP_ID     = :SHIPMT-TRIP-ID         41590000
416000                     AND  C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  41600000
416100         END-EXEC                                                 41610000
416200                                                                  41620000
416300         EVALUATE TRUE                                            41630000
416400             WHEN SQLCODE = ZERO                                  41640000
416500             WHEN SQLCODE = +100                                  41650000
416600             WHEN SQLCODE = -904                                  41660000
416700             WHEN SQLCODE = -913                                  41670000
416800                 CONTINUE                                         41680000
416900             WHEN SQLWARN0 NOT = SPACES                           41690000
417000             WHEN SQLCODE NOT EQUAL ZERO                          41700000
417100                 MOVE '4120-CHECK-SHIPT-STATUS'                   41710000
417200                                 TO DP013-PARAGRAPH               41720000
417300                 MOVE 'CHECK TRIP STATUS'                         41730000
417400                                 TO DP013-MESSAGE-TEXT(1)         41740000
417500                 MOVE SHIPMT-TRIP-ID                              41750000
417600                                 TO DP013-MESSAGE-TEXT(2)         41760000
417700                 MOVE SQLCA      TO DP013-SQLCA                   41770000
417800                 MOVE 'TTRIPST'  TO DP013-DB2-TABLE-NAME(1)       41780000
417900                 SET DP013-DB2-ABEND                              41790000
418000                                 TO TRUE                          41800000
418100                 SET DP013-NO-ROLLBACK                            41810000
418200                                 TO TRUE                          41820000
418300                 SET DP013-XCTL-DISPLAY-RESTART                   41830000
418400                                 TO TRUE                          41840000
418500                 PERFORM DP013-0000-PROCESS-ABEND                 41850000
418600         END-EVALUATE                                             41860000
418700     END-PERFORM.                                                 41870000
418800                                                                  41880000
418900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41890000
419000         MOVE '4120-CHECK-SHIPT-STATUS'                           41900000
419100                                 TO DP013-PARAGRAPH               41910000
419200         MOVE 'CHECK TRIP STATUS'  TO DP013-MESSAGE-TEXT(1)       41920000
419300         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    41930000
419400                                 TO DP013-MESSAGE-TEXT(2)         41940000
419500         MOVE SQLCA              TO DP013-SQLCA                   41950000
419600         MOVE 'TTRIPST'          TO DP013-DB2-TABLE-NAME(1)       41960000
419700         SET DP013-DB2-ABEND     TO TRUE                          41970000
419800         SET DP013-NO-ROLLBACK   TO TRUE                          41980000
419900         SET DP013-XCTL-DISPLAY-RESTART                           41990000
420000                                 TO TRUE                          42000000
420100         PERFORM DP013-0000-PROCESS-ABEND                         42010000
420200     END-IF.                                                      42020000
420300                                                                  42030000
420400     EVALUATE TRUE                                                42040000
420500         WHEN SQLCODE = ZERO                                      42050000
420600              IF TRSTYP-PRTY-CDE <= '50'                          42060000
420700                 SET ASC-SHIPT-STATUS-OK TO TRUE                  42070000
420800              ELSE                                                42080000
420900                 SET ASC-SHIPT-STATUS-NOTOK TO TRUE               42090000
421000              END-IF                                              42100000
421100         WHEN SQLCODE = +100                                      42110000
421200              SET ASC-SHIPT-STATUS-NOTOK TO TRUE                  42120000
421300              MOVE SPACES TO ASC-TRIP-STATUS-CDE                  42130000
421400     END-EVALUATE.                                                42140000
421500                                                                  42150000
421600 EJECT                                                            42160000
421700 4130-MOVE-SHIPMENT-INFO.                                         42170000
421800                                                                  42180000
421900     MOVE SHIPMT-EXPTED-PKG-QTY   TO ASC-FB-CARTON-CNT-N.         42190000
422000     MOVE SHIPMT-AUTH-DTE         TO PV-TEMP-DATE.                42200000
422100     MOVE PV-DATE-CCYY            TO ASC-AUTH-CCYY.               42210000
422200     MOVE PV-DATE-MM              TO ASC-AUTH-MM.                 42220000
422300     MOVE PV-DATE-DD              TO ASC-AUTH-DD.                 42230000
422400     MOVE SHIPMT-AUTH-NBR         TO ASC-AUTH-NBR.                42240000
422500     MOVE SHIPMT-ORIG-SCAC-ID     TO ASC-ORIG-SCAC-ID.            42250000
422600     MOVE SHIPMT-PRO-SCAC-ID      TO ASC-PRO-SCAC-ID.             42260000
422700     MOVE SHIPMT-CARR-CART-CT     TO ASC-ASN-CARTON-CNT-N.        42270000
422800     MOVE SHIPMT-VEND-CART-CT     TO ASC-FOR-CARTON-CNT-N.        42280000
422900     MOVE SHIPMT-VEND-SHIP-DTE    TO PV-TEMP-DATE.                42290000
423000     MOVE PV-DATE-CCYY            TO ASC-VEND-SHIP-CCYY.          42300000
423100     MOVE PV-DATE-MM              TO ASC-VEND-SHIP-MM.            42310000
423200     MOVE PV-DATE-DD              TO ASC-VEND-SHIP-DD.            42320000
423300                                                                  42330000
423400     IF DN-VEH-NBR = -1                                           42340000
423500        MOVE SPACES               TO ASC-VEH-NBR                  42350000
423600     ELSE                                                         42360000
423700        MOVE VHTRIP-VEH-NBR       TO ASC-VEH-NBR                  42370000
423800     END-IF.                                                      42380000
423900                                                                  42390000
424000     IF DN-EST-AR-TMST = -1                                       42400000
424100        MOVE SPACES               TO ASC-ETA-DTE                  42410000
424200                                     ASC-ETA-TIME                 42420000
424300     ELSE                                                         42430000
424400        MOVE VHTRIP-EST-AR-TMST   TO PV-TEMP-TMST                 42440000
424500        MOVE PV-TMST-CCYY         TO ASC-ETA-CCYY                 42450000
424600        MOVE PV-TMST-MM           TO ASC-ETA-MM                   42460000
424700        MOVE PV-TMST-DD           TO ASC-ETA-DD                   42470000
424800        MOVE PV-TMST-HH           TO ASC-ETA-TIME-HH              42480000
424900        MOVE PV-TMST-MN           TO ASC-ETA-TIME-MN              42490000
425000     END-IF.                                                      42500000
425100                                                                  42510000
425200  4135-SAVE-FIELDS.                                               42520000
425300     MOVE ASC-PRO-NBR             TO ASC-PREV-PRO-NBR.            42530000
425400     MOVE ASC-COMPLETE-PRO-NBR    TO ASC-PREV-COMP-PRO-NBR.       42540000
425500     MOVE ASC-BOL-NBR             TO ASC-PREV-BOL-NBR.            42550000
425600     MOVE ASC-COMPLETE-BOL-NBR    TO ASC-PREV-COMP-BOL-NBR.       42560000
425700     MOVE ASC-FB-CARTON-CNT       TO ASC-PREV-FB-CARTON-CNT.      42570000
425800     MOVE ASC-AUTH-DTE            TO ASC-PREV-AUTH-DTE.           42580000
425900     MOVE ASC-AUTH-NBR            TO ASC-PREV-AUTH-NBR.           42590000
426000     MOVE ASC-ORIG-SCAC-ID        TO ASC-PREV-ORIG-SCAC-ID.       42600000
426100     MOVE ASC-PRO-SCAC-ID         TO ASC-PREV-PRO-SCAC-ID.        42610000
426200     MOVE ASC-VEND-SHIP-DTE       TO ASC-PREV-VEND-SHIP-DTE.      42620000
426300     MOVE ASC-VEH-NBR             TO ASC-PREV-VEH-NBR.            42630000
426400     MOVE ASC-ETA-DTE             TO ASC-PREV-ETA-DTE.            42640000
426500     MOVE ASC-ETA-TIME            TO ASC-PREV-ETA-TIME.           42650000
426600                                                                  42660000
426700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        42670000
426800                                                                  42680000
426900 4310-OPEN-PO-CSR.                                                42690000
427000                                                                  42700000
427100     PERFORM                                                      42710000
427200         WITH TEST AFTER                                          42720000
427300         VARYING PV-RETRY-COUNTER                                 42730000
427400         FROM 1 BY 1                                              42740000
427500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42750000
427600            OR (SQLCODE = +0))                                    42760000
427700                                                                  42770000
427800         EXEC SQL                                                 42780000
427900              OPEN PO_CSR                                         42790000
428000         END-EXEC                                                 42800000
428100                                                                  42810000
428200         EVALUATE TRUE                                            42820000
428300             WHEN SQLCODE = +0                                    42830000
428400                  CONTINUE                                        42840000
428500             WHEN SQLCODE = -904                                  42850000
428600             WHEN SQLCODE = -913                                  42860000
428700                  CONTINUE                                        42870000
428800             WHEN SQLWARN0 NOT = SPACE                            42880000
428900             WHEN SQLCODE  NOT = +0                               42890000
429000                  MOVE '4310-OPEN-PO-CSR'                         42900000
429100                                   TO DP013-PARAGRAPH             42910000
429200                  MOVE 'OPEN PO CURSOR'                           42920000
429300                                   TO DP013-MESSAGE-TEXT (1)      42930000
429400                  MOVE DK-SHIPT-ID TO DP013-MESSAGE-TEXT (2)      42940000
429500                  MOVE SQLCA       TO DP013-SQLCA                 42950000
429600                  MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)    42960000
429700                  SET DP013-DB2-ABEND                             42970000
429800                                   TO TRUE                        42980000
429900                  PERFORM DP013-0000-PROCESS-ABEND                42990000
430000         END-EVALUATE                                             43000000
430100     END-PERFORM.                                                 43010000
430200                                                                  43020000
430300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43030000
430400         MOVE '4310-OPEN-PO-CSR' TO DP013-PARAGRAPH               43040000
430500         MOVE 'MAX RETRIES EXCEEDED FOR OPEN PO CURSOR'           43050000
430600                                   TO DP013-MESSAGE-TEXT (1)      43060000
430700         MOVE SQLCA                TO DP013-SQLCA                 43070000
430800         SET DP013-DB2-ABEND       TO TRUE                        43080000
430900         PERFORM DP013-0000-PROCESS-ABEND                         43090000
431000     END-IF.                                                      43100000
431100                                                                  43110000
431200 4320-FETCH-PO-CSR.                                               43120000
431300                                                                  43130000
431400     EXEC SQL                                                     43140000
431500          FETCH PO_CSR                                            43150000
431600          INTO :PURITM-PO-NBR                                     43160000
431700     END-EXEC                                                     43170000
431800                                                                  43180000
431900     EVALUATE TRUE                                                43190000
432000         WHEN SQLCODE = +0                                        43200000
432100              SET PS-RECEIVERS-EXIST TO TRUE                      43210000
432200                                                                  43220000
432300         WHEN SQLCODE = +100                                      43230000
432400              CONTINUE                                            43240000
432500                                                                  43250000
432600         WHEN SQLWARN0 NOT = SPACE                                43260000
432700         WHEN SQLCODE < +0                                        43270000
432800         WHEN SQLCODE > +0                                        43280000
432900              MOVE '4320-FETCH-PO-CSR'                            43290000
433000                                   TO DP013-PARAGRAPH             43300000
433100              MOVE 'FETCH PO CURSOR'                              43310000
433200                                   TO DP013-MESSAGE-TEXT (1)      43320000
433300              MOVE PURITM-PO-NBR   TO DP013-MESSAGE-TEXT (2)      43330000
433400              MOVE SQLCA           TO DP013-SQLCA                 43340000
433500              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    43350000
433600              SET DP013-DB2-ABEND  TO TRUE                        43360000
433700              PERFORM DP013-0000-PROCESS-ABEND                    43370000
433800     END-EVALUATE.                                                43380000
433900                                                                  43390000
434000 4330-CLOSE-PO-CSR.                                               43400000
434100                                                                  43410000
434200     EXEC SQL                                                     43420000
434300          CLOSE PO_CSR                                            43430000
434400     END-EXEC                                                     43440000
434500                                                                  43450000
434600     EVALUATE TRUE                                                43460000
434700         WHEN SQLCODE = +0                                        43470000
434800              CONTINUE                                            43480000
434900                                                                  43490000
435000         WHEN SQLWARN0 NOT = SPACE                                43500000
435100         WHEN SQLCODE < +0                                        43510000
435200         WHEN SQLCODE > +0                                        43520000
435300              MOVE '4330-CLOSE-PO-CSR'                            43530000
435400                                   TO DP013-PARAGRAPH             43540000
435500              MOVE 'CLOSE PO CURSOR'                              43550000
435600                                   TO DP013-MESSAGE-TEXT (1)      43560000
435700              MOVE SQLCA           TO DP013-SQLCA                 43570000
435800              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    43580000
435900              SET DP013-DB2-ABEND  TO TRUE                        43590000
436000              PERFORM DP013-0000-PROCESS-ABEND                    43600000
436100     END-EVALUATE.                                                43610000
436200                                                                  43620000
436300 EJECT                                                            43630000
436400*----------------------------------------------------------------*43640000
436500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *43650000
436600*----------------------------------------------------------------*43660000
436700                                                                  43670000
436800 4400-MOVE-COMMAREA-TO-SCREEN.                                    43680000
436900     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     43690000
437000     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    43700000
437100     MOVE ASC-FCLTY-NME            TO AFDESCO.                    43710000
437200     MOVE ASC-COMPLETE-PRO-NBR     TO AFBNBRO.                    43720000
437300     MOVE ASC-COMPLETE-BOL-NBR     TO ABOLNBRO.                   43730000
437400     MOVE ASC-FB-CARTON-CNT        TO AFBCNTO.                    43740000
437500     MOVE ASC-ASN-CARTON-CNT       TO AASNCNTO.                   43750000
437600     MOVE ASC-FOR-CARTON-CNT       TO AFORCNTO.                   43760000
437700     IF ASC-VEND-SHIP-DTE = '01010001'                            43770000
437800        MOVE SPACES TO AVNDMMO                                    43780000
437900                       AVNDDDO                                    43790000
438000                       AVNDYYO                                    43800000
438100     ELSE                                                         43810000
438200        MOVE ASC-VEND-SHIP-MM         TO AVNDMMO                  43820000
438300        MOVE ASC-VEND-SHIP-DD         TO AVNDDDO                  43830000
438400        MOVE ASC-VEND-SHIP-YY         TO AVNDYYO                  43840000
438500     END-IF.                                                      43850000
438600                                                                  43860000
438700     MOVE ASC-AUTH-NBR             TO AAUTHNOO.                   43870000
438800                                                                  43880000
438900     IF ASC-AUTH-DTE    = '01010001'                              43890000
439000        MOVE SPACES     TO AAUTHMMO                               43900000
439100                           AAUTHDDO                               43910000
439200                           AAUTHYYO                               43920000
439300     ELSE                                                         43930000
439400        MOVE ASC-AUTH-MM              TO AAUTHMMO                 43940000
439500        MOVE ASC-AUTH-DD              TO AAUTHDDO                 43950000
439600        MOVE ASC-AUTH-YY              TO AAUTHYYO                 43960000
439700     END-IF.                                                      43970000
439800     MOVE ASC-PRO-SCAC-ID          TO ADSCACO.                    43980000
439900     MOVE ASC-PRO-SCAC-DESC        TO ADSCACDO.                   43990000
440000     MOVE ASC-ORIG-SCAC-ID         TO AOSCACO.                    44000000
440100     MOVE ASC-ORIG-SCAC-DESC       TO AOSCACDO.                   44010000
440200     MOVE ASC-VEH-NBR              TO ATRLRNOO.                   44020000
440300     IF ASC-ETA-DTE  = '01010001'                                 44030000
440400        MOVE SPACES   TO AETAMMO                                  44040000
440500                         AETADDO                                  44050000
440600                         AETAYYO                                  44060000
440700     ELSE                                                         44070000
440800        MOVE ASC-ETA-MM               TO AETAMMO                  44080000
440900        MOVE ASC-ETA-DD               TO AETADDO                  44090000
441000        MOVE ASC-ETA-YY               TO AETAYYO                  44100000
441100     END-IF.                                                      44110000
441200                                                                  44120000
441300     IF ASC-ETA-TIME = '0000'                                     44130000
441400        MOVE SPACES TO AETAHHO AETAMNO                            44140000
441500     ELSE                                                         44150000
441600        MOVE ASC-ETA-TIME-HH          TO AETAHHO                  44160000
441700        MOVE ASC-ETA-TIME-MN          TO AETAMNO                  44170000
441800     END-IF.                                                      44180000
441900                                                                  44190000
442000 EJECT                                                            44200000
442100 EJECT                                                            44210000
442200*----------------------------------------------------------------*44220000
442300*  INSERT A ROW TO THE TRIP AUDIT TABLE                           44230000
442400*                                                                 44240000
442500*  PERFORMED FROM                                                 44250000
442600*----------------------------------------------------------------*44260000
442700 5000-AUDIT-TRIP.                                                 44270000
442800                                                                  44280000
442900                                                                  44290000
443000     INITIALIZE DCLTAUTRIP.                                       44300000
443100                                                                  44310000
443200     PERFORM                                                      44320000
443300         WITH TEST AFTER                                          44330000
443400         VARYING PV-RETRY-COUNTER                                 44340000
443500         FROM 1 BY 1                                              44350000
443600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44360000
443700             OR (SQLCODE = +0)                                    44370000
443800             OR (SQLCODE = +100))                                 44380000
443900                                                                  44390000
444000         EXEC SQL                                                 44400000
444100             SELECT  OWNER_SCAC_ID                                44410000
444200                    ,VEH_NBR                                      44420000
444300                    ,TRIP_ID                                      44430000
444400                    ,TRIP_BEG_DTE                                 44440000
444500                    ,TRIP_BEG_TME                                 44450000
444600                    ,CRT_SRC_CDE                                  44460000
444700                    ,LAST_UPD_DTE                                 44470000
444800                    ,LAST_UPD_TME                                 44480000
444900                    ,LAST_UPD_UID                                 44490000
445000                    ,MANIFEST_NBR                                 44500000
445100                    ,PLND_TRIP_SEQ                                44510000
445200                    ,PLND_ACTVY_CDE                               44520000
445300                    ,OWNR_SCAC_SHIP_DTE                           44530000
445400                    ,REF_TRIP_ID                                  44540000
445500                    ,EST_AR_TMST                                  44550000
445600                    ,SPLT_XMIT_IND                                44560000
445700                    ,SPLT_XMIT_DTE                                44570000
445800                    ,SPLT_XMIT_TM                                 44580000
445900            INTO     :VHTRIP-OWNER-SCAC-ID                        44590000
446000                    ,:VHTRIP-VEH-NBR                              44600000
446100                       :DN-VEH-NBR                                44610000
446200                    ,:VHTRIP-TRIP-ID                              44620000
446300                    ,:VHTRIP-TRIP-BEG-DTE                         44630000
446400                    ,:VHTRIP-TRIP-BEG-TME                         44640000
446500                    ,:VHTRIP-CRT-SRC-CDE                          44650000
446600                    ,:VHTRIP-LAST-UPD-DTE                         44660000
446700                    ,:VHTRIP-LAST-UPD-TME                         44670000
446800                    ,:VHTRIP-LAST-UPD-UID                         44680000
446900                    ,:VHTRIP-MANIFEST-NBR                         44690000
447000                    ,:VHTRIP-PLND-TRIP-SEQ                        44700000
447100                    ,:VHTRIP-PLND-ACTVY-CDE                       44710000
447200                    ,:VHTRIP-OWNR-SCAC-SHIP-DTE                   44720000
447300                    ,:VHTRIP-REF-TRIP-ID                          44730000
447400                    ,:VHTRIP-EST-AR-TMST                          44740000
447500                           :DN-EST-AR-TMST                        44750000
447600                    ,:VHTRIP-SPLT-XMIT-IND                        44760000
447700                    ,:VHTRIP-SPLT-XMIT-DTE                        44770000
447800                    ,:VHTRIP-SPLT-XMIT-TM                         44780000
447900           FROM   TVHTRIP                                         44790000
448000           WHERE  TRIP_ID       = :DK-TRIP-ID                     44800000
448100         END-EXEC                                                 44810000
448200                                                                  44820000
448300         EVALUATE TRUE                                            44830000
448400             WHEN SQLCODE = +0                                    44840000
448500             WHEN SQLCODE = +100                                  44850000
448600             WHEN SQLCODE = -904                                  44860000
448700             WHEN SQLCODE = -913                                  44870000
448800                 CONTINUE                                         44880000
448900                                                                  44890000
449000             WHEN SQLWARN0 NOT = SPACES                           44900000
449100             WHEN SQLCODE < +0                                    44910000
449200             WHEN SQLCODE > +0                                    44920000
449300                 MOVE '5000-AUDIT-TRIP '                          44930000
449400                                   TO DP013-PARAGRAPH             44940000
449500                 MOVE 'SELECT A ROW ON TVHTRIP'                   44950000
449600                                   TO DP013-MESSAGE-TEXT(1)       44960000
449700                 MOVE DK-TRIP-ID   TO DP013-MESSAGE-TEXT(2)       44970000
449800                 MOVE SQLCA        TO DP013-SQLCA                 44980000
449900                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    44990000
450000                 SET DP013-DB2-ABEND                              45000000
450100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           45010000
450200                 PERFORM DP013-0000-PROCESS-ABEND                 45020000
450300         END-EVALUATE                                             45030000
450400     END-PERFORM.                                                 45040000
450500                                                                  45050000
450600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        45060000
450700         MOVE '5000-AUDIT-TRIP'                                   45070000
450800                                   TO DP013-PARAGRAPH             45080000
450900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              45090000
451000                                   TO DP013-MESSAGE-TEXT (1)      45100000
451100         MOVE 'TO SELECT A TVHTRIP ROW'                           45110000
451200                                   TO DP013-MESSAGE-TEXT (2)      45120000
451300         MOVE SQLCA                TO DP013-SQLCA                 45130000
451400         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    45140000
451500         SET DP013-DB2-ABEND                                      45150000
451600             DP013-XCTL-DISPLAY-RESTART                           45160000
451700                                   TO TRUE                        45170000
451800         PERFORM DP013-0000-PROCESS-ABEND                         45180000
451900     END-IF.                                                      45190000
452000                                                                  45200000
452100     EVALUATE TRUE                                                45210000
452200        WHEN SQLCODE = +0                                         45220000
452300             SET PS-FOUND TO TRUE                                 45230000
452400        WHEN SQLCODE = +100                                       45240000
452500             SET PS-NOT-FOUND TO TRUE                             45250000
452600     END-EVALUATE.                                                45260000
452700                                                                  45270000
452800     IF PS-FOUND                                                  45280000
452900         MOVE 'CE'                  TO VHTRIP-CRT-SRC-CDE         45290000
453000         IF PS-DELETE-VHTRIP                                      45300000
453100             EXEC SQL                                             45310000
453200                 SET :PV-DB2-CURRENT-DATE = CURRENT DATE          45320000
453300             END-EXEC                                             45330000
453400                                                                  45340000
453500             EXEC SQL                                             45350000
453600                 SET :PV-DB2-CURRENT-TIME = CURRENT TIME          45360000
453700             END-EXEC                                             45370000
453800                                                                  45380000
453900             MOVE PV-DB2-CURRENT-DATE  TO VHTRIP-LAST-UPD-DTE     45390000
454000             MOVE PV-DB2-CURRENT-TIME  TO VHTRIP-LAST-UPD-TME     45400000
454100             MOVE DP020-USERID         TO VHTRIP-LAST-UPD-UID     45410000
454200         END-IF                                                   45420000
454300                                                                  45430000
454400                                                                  45440000
454500         PERFORM                                                  45450000
454600            WITH TEST AFTER                                       45460000
454700            VARYING PV-RETRY-COUNTER                              45470000
454800            FROM 1 BY 1                                           45480000
454900            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)            45490000
455000                OR (SQLCODE = +0))                                45500000
455100                                                                  45510000
455200            EXEC SQL                                              45520000
455300                INSERT  INTO TAUTRIP                              45530000
455400                       (OWNER_SCAC_ID                             45540000
455500                       ,VEH_NBR                                   45550000
455600                       ,TRIP_ID                                   45560000
455700                       ,TRIP_BEG_DTE                              45570000
455800                       ,TRIP_BEG_TME                              45580000
455900                       ,CRT_SRC_CDE                               45590000
456000                       ,LAST_UPD_DTE                              45600000
456100                       ,LAST_UPD_TME                              45610000
456200                       ,LAST_UPD_UID                              45620000
456300                       ,MANIFEST_NBR                              45630000
456400                       ,PLND_TRIP_SEQ                             45640000
456500                       ,PLND_ACTVY_CDE                            45650000
456600                       ,OWNR_SCAC_SHIP_DTE                        45660000
456700                       ,REF_TRIP_ID                               45670000
456800                       ,EST_AR_TMST                               45680000
456900                       ,AUD_STATUS_CDE                            45690000
457000                       ,SPLT_XMIT_IND                             45700000
457100                       ,SPLT_XMIT_DTE                             45710000
457200                       ,SPLT_XMIT_TM )                            45720000
457300               VALUES  (:VHTRIP-OWNER-SCAC-ID                     45730000
457400                       ,:VHTRIP-VEH-NBR                           45740000
457500                          :DN-VEH-NBR                             45750000
457600                       ,:VHTRIP-TRIP-ID                           45760000
457700                       ,:VHTRIP-TRIP-BEG-DTE                      45770000
457800                       ,:VHTRIP-TRIP-BEG-TME                      45780000
457900                       ,:VHTRIP-CRT-SRC-CDE                       45790000
458000                       ,:VHTRIP-LAST-UPD-DTE                      45800000
458100                       ,:VHTRIP-LAST-UPD-TME                      45810000
458200                       ,:VHTRIP-LAST-UPD-UID                      45820000
458300                       ,:VHTRIP-MANIFEST-NBR                      45830000
458400                       ,:VHTRIP-PLND-TRIP-SEQ                     45840000
458500                       ,:VHTRIP-PLND-ACTVY-CDE                    45850000
458600                       ,:VHTRIP-OWNR-SCAC-SHIP-DTE                45860000
458700                       ,:VHTRIP-REF-TRIP-ID                       45870000
458800                       ,:VHTRIP-EST-AR-TMST                       45880000
458900                              :DN-EST-AR-TMST                     45890000
459000                       ,:TRIPST-TRIP-STATUS-CDE                   45900000
459100                       ,:VHTRIP-SPLT-XMIT-IND                     45910000
459200                       ,:VHTRIP-SPLT-XMIT-DTE                     45920000
459300                       ,:VHTRIP-SPLT-XMIT-TM )                    45930000
459400            END-EXEC                                              45940000
459500            EVALUATE TRUE                                         45950000
459600                WHEN SQLCODE = +0                                 45960000
459700                WHEN SQLCODE = -904                               45970000
459800                WHEN SQLCODE = -913                               45980000
459900                    CONTINUE                                      45990000
460000                                                                  46000000
460100                WHEN SQLWARN0 NOT = SPACES                        46010000
460200                WHEN SQLCODE < +0                                 46020000
460300                WHEN SQLCODE > +0                                 46030000
460400                    MOVE '5000-AUDIT-TRIP'                        46040000
460500                                      TO DP013-PARAGRAPH          46050000
460600                    MOVE 'INSERT A ROW ON TAUTRIP'                46060000
460700                                      TO DP013-MESSAGE-TEXT(1)    46070000
460800                    MOVE DK-TRIP-ID   TO DP013-MESSAGE-TEXT(2)    46080000
460900                    MOVE SQLCA        TO DP013-SQLCA              46090000
461000                    MOVE 'TAUTRIP'    TO DP013-DB2-TABLE-NAME (1) 46100000
461100                    SET DP013-DB2-ABEND                           46110000
461200                        DP013-XCTL-DISPLAY-RESTART TO TRUE        46120000
461300                    PERFORM DP013-0000-PROCESS-ABEND              46130000
461400            END-EVALUATE                                          46140000
461500         END-PERFORM                                              46150000
461600                                                                  46160000
461700        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                     46170000
461800            MOVE '5000-AUDIT-TRIP '                               46180000
461900                                      TO DP013-PARAGRAPH          46190000
462000            MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '           46200000
462100                                      TO DP013-MESSAGE-TEXT (1)   46210000
462200            MOVE 'TO INSERT A TAUTRIP ROW'                        46220000
462300                                      TO DP013-MESSAGE-TEXT (2)   46230000
462400            MOVE SQLCA                TO DP013-SQLCA              46240000
462500            MOVE 'TAUTRIP'            TO DP013-DB2-TABLE-NAME (1) 46250000
462600            SET DP013-DB2-ABEND                                   46260000
462700                DP013-XCTL-DISPLAY-RESTART                        46270000
462800                                      TO TRUE                     46280000
462900            PERFORM DP013-0000-PROCESS-ABEND                      46290000
463000        END-IF                                                    46300000
463100     END-IF.                                                      46310000
463200                                                                  46320000
463300*----------------------------------------------------------------*46330000
463400*  INSERT A ROW TO THE SHIPTMENT AUDIT TABLE                      46340000
463500*----------------------------------------------------------------*46350000
463600 5010-AUDIT-SHIPMENT.                                             46360000
463700                                                                  46370000
463800     INITIALIZE DCLTAUSHIP.                                       46380000
463900                                                                  46390000
463910* CLT 12/08/2011 WR40574 ADDED CARR-AUTH-ID BELOW                 46391000
464000     PERFORM                                                      46400000
464100         WITH TEST AFTER                                          46410000
464200         VARYING PV-RETRY-COUNTER                                 46420000
464300         FROM 1 BY 1                                              46430000
464400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46440000
464500             OR (SQLCODE = +0))                                   46450000
464600                                                                  46460000
464700         EXEC SQL                                                 46470000
464800             SELECT  A.TRIP_ID                                    46480000
464900                    ,A.SHIPT_ID                                   46490000
465000                    ,A.CRT_SRC_CDE                                46500000
465100                    ,A.LAST_UPD_DTE                               46510000
465200                    ,A.LAST_UPD_TME                               46520000
465300                    ,A.LAST_UPD_UID                               46530000
465400                    ,A.PRO_SCAC_ID                                46540000
465500                    ,A.PRO_NBR                                    46550000
465600                    ,A.BOL_NBR                                    46560000
465700                    ,A.SHIPPER_NME                                46570000
465800                    ,A.SHIPT_TYP_CDE                              46580000
465900                    ,A.EXPTED_GRO_WGHT                            46590000
466000                    ,A.PKG_TYP_CDE                                46600000
466100                    ,A.EXPTED_PKG_QTY                             46610000
466200                    ,A.FRGT_CHG_AMT                               46620000
466300                    ,A.FRGT_TERMS_CDE                             46630000
466400                    ,A.EXPTED_PLT_QTY                             46640000
466500                    ,A.VEND_SHIP_DTE                              46650000
466600                    ,A.EST_AR_TMST                                46660000
466700                    ,A.ORIG_SCAC_ID                               46670000
466800                    ,A.LAST_UPD_PGM_ID                            46680000
466900                    ,A.CRE_USER_ID                                46690000
467000                    ,A.CARR_CART_CT                               46700000
467100                    ,A.CARR_LAST_UPD_DTE                          46710000
467200                    ,A.CARR_LAST_UPD_TIME                         46720000
467300                    ,A.VEND_CART_CT                               46730000
467400                    ,A.VEND_LAST_UPD_DTE                          46740000
467500                    ,A.VEND_LAST_UPD_TIME                         46750000
467600                    ,A.VEH_NBR                                    46760000
467700                    ,A.AUTH_NBR                                   46770000
467800                    ,A.AUTH_DTE                                   46780000
467900                    ,A.CONFIRM_DTE                                46790000
468000                    ,A.CONFIRM_TIME                               46800000
468100                    ,A.COMPLETE_PRO_NBR                           46810000
468200                    ,A.COMPLETE_BOL_NBR                           46820000
468300                    ,A.PROCESSED_DTE                              46830000
468400                    ,A.INVC_NBR                                   46840000
468410                    ,A.CARR_AUTH_ID                               46841000
468500            INTO     :SHIPMT-TRIP-ID                              46850000
468600                       :DN-TRIP-ID                                46860000
468700                    ,:SHIPMT-SHIPT-ID                             46870000
468800                    ,:SHIPMT-CRT-SRC-CDE                          46880000
468900                    ,:SHIPMT-LAST-UPD-DTE                         46890000
469000                    ,:SHIPMT-LAST-UPD-TME                         46900000
469100                    ,:SHIPMT-LAST-UPD-UID                         46910000
469200                    ,:SHIPMT-PRO-SCAC-ID                          46920000
469300                    ,:SHIPMT-PRO-NBR                              46930000
469400                    ,:SHIPMT-BOL-NBR                              46940000
469500                    ,:SHIPMT-SHIPPER-NME                          46950000
469600                    ,:SHIPMT-SHIPT-TYP-CDE                        46960000
469700                    ,:SHIPMT-EXPTED-GRO-WGHT                      46970000
469800                    ,:SHIPMT-PKG-TYP-CDE                          46980000
469900                    ,:SHIPMT-EXPTED-PKG-QTY                       46990000
470000                    ,:SHIPMT-FRGT-CHG-AMT                         47000000
470100                    ,:SHIPMT-FRGT-TERMS-CDE                       47010000
470200                    ,:SHIPMT-EXPTED-PLT-QTY                       47020000
470300                    ,:SHIPMT-VEND-SHIP-DTE                        47030000
470400                    ,:SHIPMT-EST-AR-TMST                          47040000
470500                       :DN-EST-AR-TMST                            47050000
470600                    ,:SHIPMT-ORIG-SCAC-ID                         47060000
470700                    ,:SHIPMT-LAST-UPD-PGM-ID                      47070000
470800                    ,:SHIPMT-CRE-USER-ID                          47080000
470900                    ,:SHIPMT-CARR-CART-CT                         47090000
471000                    ,:SHIPMT-CARR-LAST-UPD-DTE                    47100000
471100                    ,:SHIPMT-CARR-LAST-UPD-TIME                   47110000
471200                    ,:SHIPMT-VEND-CART-CT                         47120000
471300                    ,:SHIPMT-VEND-LAST-UPD-DTE                    47130000
471400                    ,:SHIPMT-VEND-LAST-UPD-TIME                   47140000
471500                    ,:SHIPMT-VEH-NBR                              47150000
471600                    ,:SHIPMT-AUTH-NBR                             47160000
471700                    ,:SHIPMT-AUTH-DTE                             47170000
471800                    ,:SHIPMT-CONFIRM-DTE                          47180000
471900                    ,:SHIPMT-CONFIRM-TIME                         47190000
472000                    ,:SHIPMT-COMPLETE-PRO-NBR                     47200000
472100                    ,:SHIPMT-COMPLETE-BOL-NBR                     47210000
472200                    ,:SHIPMT-PROCESSED-DTE                        47220000
472300                    ,:SHIPMT-INVC-NBR                             47230000
472310                    ,:SHIPMT-CARR-AUTH-ID                         47231001
472400           FROM   TSHIPMT A                                       47240000
472500           WHERE  A.SHIPT_ID         = :ASC-SHIPT-ID              47250000
472600         END-EXEC                                                 47260000
472700                                                                  47270000
472800         EVALUATE TRUE                                            47280000
472900             WHEN SQLCODE = +0                                    47290000
473000             WHEN SQLCODE = -904                                  47300000
473100             WHEN SQLCODE = -913                                  47310000
473200                 CONTINUE                                         47320000
473300                                                                  47330000
473400             WHEN SQLWARN0 NOT = SPACES                           47340000
473500             WHEN SQLCODE < +0                                    47350000
473600             WHEN SQLCODE > +0                                    47360000
473700                 MOVE '5010-AUDIT-SHIPMENT'                       47370000
473800                                   TO DP013-PARAGRAPH             47380000
473900                 MOVE 'SELECT A TSHIPMT ROW   '                   47390000
474000                                   TO DP013-MESSAGE-TEXT(1)       47400000
474100                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(2)       47410000
474200                 MOVE SQLCA        TO DP013-SQLCA                 47420000
474300                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    47430000
474400                 SET DP013-DB2-ABEND                              47440000
474500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47450000
474600                 PERFORM DP013-0000-PROCESS-ABEND                 47460000
474700         END-EVALUATE                                             47470000
474800     END-PERFORM.                                                 47480000
474900                                                                  47490000
475000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47500000
475100         MOVE '5010-AUDIT-SHIPMENT'                               47510000
475200                                   TO DP013-PARAGRAPH             47520000
475300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              47530000
475400                                   TO DP013-MESSAGE-TEXT (1)      47540000
475500         MOVE 'TO SELECT A TSHIPMT ROW'                           47550000
475600                                   TO DP013-MESSAGE-TEXT (2)      47560000
475700         MOVE SQLCA                TO DP013-SQLCA                 47570000
475800         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    47580000
475900         SET DP013-DB2-ABEND                                      47590000
476000             DP013-XCTL-DISPLAY-RESTART                           47600000
476100                                   TO TRUE                        47610000
476200         PERFORM DP013-0000-PROCESS-ABEND                         47620000
476300     END-IF.                                                      47630000
476400                                                                  47640000
476500     PERFORM                                                      47650000
476600         WITH TEST AFTER                                          47660000
476700         VARYING PV-RETRY-COUNTER                                 47670000
476800         FROM 1 BY 1                                              47680000
476900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47690000
477000             OR (SQLCODE = +0))                                   47700000
477100                                                                  47710000
477200         EXEC SQL                                                 47720000
477300             SELECT  A.SHIPT_STATUS_CDE                           47730000
477400             INTO    :SHIPST-SHIPT-STATUS-CDE                     47740000
477500           FROM   TSHIPST A                                       47750000
477600                 ,TSHSTYP B                                       47760000
477700           WHERE  A.SHIPT_ID = :ASC-SHIPT-ID                      47770000
477800             AND  B.PRTY_CDE =                                    47780000
477900                  (SELECT MAX(D.PRTY_CDE)                         47790000
478000                     FROM TSHIPST C                               47800000
478100                         ,TSHSTYP D                               47810000
478200                    WHERE C.SHIPT_ID         = A.SHIPT_ID         47820000
478300                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)47830000
478400             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         47840000
478500         END-EXEC                                                 47850000
478600                                                                  47860000
478700         EVALUATE TRUE                                            47870000
478800             WHEN SQLCODE = +0                                    47880000
478900             WHEN SQLCODE = -904                                  47890000
479000             WHEN SQLCODE = -913                                  47900000
479100                 CONTINUE                                         47910000
479200                                                                  47920000
479300             WHEN SQLWARN0 NOT = SPACES                           47930000
479400             WHEN SQLCODE < +0                                    47940000
479500             WHEN SQLCODE > +0                                    47950000
479600                 MOVE '5010-AUDIT-SHIPMENT'                       47960000
479700                                   TO DP013-PARAGRAPH             47970000
479800                 MOVE 'SELECT A TSHIPST ROW   '                   47980000
479900                                   TO DP013-MESSAGE-TEXT(1)       47990000
480000                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(2)       48000000
480100                 MOVE SQLCA        TO DP013-SQLCA                 48010000
480200                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    48020000
480300                 SET DP013-DB2-ABEND                              48030000
480400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48040000
480500                 PERFORM DP013-0000-PROCESS-ABEND                 48050000
480600         END-EVALUATE                                             48060000
480700     END-PERFORM.                                                 48070000
480800                                                                  48080000
480900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48090000
481000         MOVE '5010-AUDIT-SHIPMENT'                               48100000
481100                                   TO DP013-PARAGRAPH             48110000
481200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              48120000
481300                                   TO DP013-MESSAGE-TEXT (1)      48130000
481400         MOVE 'TO SELECT A TSHIPST ROW'                           48140000
481500                                   TO DP013-MESSAGE-TEXT (2)      48150000
481600         MOVE SQLCA                TO DP013-SQLCA                 48160000
481700         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    48170000
481800         SET DP013-DB2-ABEND                                      48180000
481900             DP013-XCTL-DISPLAY-RESTART                           48190000
482000                                   TO TRUE                        48200000
482100         PERFORM DP013-0000-PROCESS-ABEND                         48210000
482200     END-IF.                                                      48220000
482300                                                                  48230000
482310* CLT 12/08/2011 WR40574 ADDED CARR-AUTH-ID BELOW                 48231000
482400     PERFORM                                                      48240000
482500         WITH TEST AFTER                                          48250000
482600         VARYING PV-RETRY-COUNTER                                 48260000
482700         FROM 1 BY 1                                              48270000
482800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48280000
482900             OR (SQLCODE = +0))                                   48290000
483000                                                                  48300000
483100         EXEC SQL                                                 48310000
483200             INSERT  INTO TAUSHIP                                 48320000
483300                    (TRIP_ID                                      48330000
483400                    ,SHIPT_ID                                     48340000
483500                    ,CRT_SRC_CDE                                  48350000
483600                    ,LAST_UPD_DTE                                 48360000
483700                    ,LAST_UPD_TME                                 48370000
483800                    ,LAST_UPD_UID                                 48380000
483900                    ,PRO_SCAC_ID                                  48390000
484000                    ,PRO_NBR                                      48400000
484100                    ,BOL_NBR                                      48410000
484200                    ,SHIPPER_NME                                  48420000
484300                    ,SHIPT_TYP_CDE                                48430000
484400                    ,EXPTED_GRO_WGHT                              48440000
484500                    ,PKG_TYP_CDE                                  48450000
484600                    ,EXPTED_PKG_QTY                               48460000
484700                    ,FRGT_CHG_AMT                                 48470000
484800                    ,FRGT_TERMS_CDE                               48480000
484900                    ,EST_AR_TMST                                  48490000
485000                    ,VEND_SHIP_DTE                                48500000
485100                    ,EXPTED_PLT_QTY                               48510000
485200                    ,ORIG_SCAC_ID                                 48520000
485300                    ,LAST_UPD_PGM_ID                              48530000
485400                    ,CRE_USER_ID                                  48540000
485500                    ,CARR_CART_CT                                 48550000
485600                    ,CARR_LAST_UPD_DTE                            48560000
485700                    ,CARR_LAST_UPD_TIME                           48570000
485800                    ,VEND_CART_CT                                 48580000
485900                    ,VEND_LAST_UPD_DTE                            48590000
486000                    ,VEND_LAST_UPD_TIME                           48600000
486100                    ,VEH_NBR                                      48610000
486200                    ,AUTH_NBR                                     48620000
486300                    ,AUTH_DTE                                     48630000
486400                    ,CONFIRM_DTE                                  48640000
486500                    ,CONFIRM_TIME                                 48650000
486600                    ,AUD_STATUS_CDE                               48660000
486700                    ,PROCESSED_DTE                                48670000
486800                    ,INVC_NBR                                     48680000
486810                    ,CARR_AUTH_ID )                               48681000
486900            VALUES  (:SHIPMT-TRIP-ID                              48690000
487000                       :DN-TRIP-ID                                48700000
487100                    ,:SHIPMT-SHIPT-ID                             48710000
487200                    ,:SHIPMT-CRT-SRC-CDE                          48720000
487300                    ,:SHIPMT-LAST-UPD-DTE                         48730000
487400                    ,:SHIPMT-LAST-UPD-TME                         48740000
487500                    ,:SHIPMT-LAST-UPD-UID                         48750000
487600                    ,:SHIPMT-PRO-SCAC-ID                          48760000
487700                    ,:SHIPMT-COMPLETE-PRO-NBR                     48770000
487800                    ,:SHIPMT-COMPLETE-BOL-NBR                     48780000
487900                    ,:SHIPMT-SHIPPER-NME                          48790000
488000                    ,:SHIPMT-SHIPT-TYP-CDE                        48800000
488100                    ,:SHIPMT-EXPTED-GRO-WGHT                      48810000
488200                    ,:SHIPMT-PKG-TYP-CDE                          48820000
488300                    ,:SHIPMT-EXPTED-PKG-QTY                       48830000
488400                    ,:SHIPMT-FRGT-CHG-AMT                         48840000
488500                    ,:SHIPMT-FRGT-TERMS-CDE                       48850000
488600                    ,:SHIPMT-EST-AR-TMST                          48860000
488700                       :DN-EST-AR-TMST                            48870000
488800                    ,:SHIPMT-VEND-SHIP-DTE                        48880000
488900                    ,:SHIPMT-EXPTED-PLT-QTY                       48890000
489000                    ,:SHIPMT-ORIG-SCAC-ID                         48900000
489100                    ,:SHIPMT-LAST-UPD-PGM-ID                      48910000
489200                    ,:SHIPMT-CRE-USER-ID                          48920000
489300                    ,:SHIPMT-CARR-CART-CT                         48930000
489400                    ,:SHIPMT-CARR-LAST-UPD-DTE                    48940000
489500                    ,:SHIPMT-CARR-LAST-UPD-TIME                   48950000
489600                    ,:SHIPMT-VEND-CART-CT                         48960000
489700                    ,:SHIPMT-VEND-LAST-UPD-DTE                    48970000
489800                    ,:SHIPMT-VEND-LAST-UPD-TIME                   48980000
489900                    ,:SHIPMT-VEH-NBR                              48990000
490000                    ,:SHIPMT-AUTH-NBR                             49000000
490100                    ,:SHIPMT-AUTH-DTE                             49010000
490200                    ,:SHIPMT-CONFIRM-DTE                          49020000
490300                    ,:SHIPMT-CONFIRM-TIME                         49030000
490400                    ,:SHIPST-SHIPT-STATUS-CDE                     49040000
490500                    ,:SHIPMT-PROCESSED-DTE                        49050000
490600                    ,:SHIPMT-INVC-NBR                             49060000
490610                    ,:SHIPMT-CARR-AUTH-ID )                       49061001
490700         END-EXEC                                                 49070000
490800                                                                  49080000
490900                                                                  49090000
491000         EVALUATE TRUE                                            49100000
491100             WHEN SQLCODE = +0                                    49110000
491200             WHEN SQLCODE = -904                                  49120000
491300             WHEN SQLCODE = -913                                  49130000
491400                 CONTINUE                                         49140000
491500                                                                  49150000
491600             WHEN SQLWARN0 NOT = SPACES                           49160000
491700             WHEN SQLCODE < +0                                    49170000
491800             WHEN SQLCODE > +0                                    49180000
491900                 MOVE '5010-AUDIT-SHIPMENT'                       49190000
492000                                   TO DP013-PARAGRAPH             49200000
492100                 MOVE 'INSERT A ROW ON TAUSHIP'                   49210000
492200                                   TO DP013-MESSAGE-TEXT(1)       49220000
492300                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(2)       49230000
492400                 MOVE SQLCA        TO DP013-SQLCA                 49240000
492500                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    49250000
492600                 SET DP013-DB2-ABEND                              49260000
492700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           49270000
492800                 PERFORM DP013-0000-PROCESS-ABEND                 49280000
492900         END-EVALUATE                                             49290000
493000     END-PERFORM.                                                 49300000
493100                                                                  49310000
493200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49320000
493300         MOVE '5010-AUDIT-SHIPMENT'                               49330000
493400                                   TO DP013-PARAGRAPH             49340000
493500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              49350000
493600                                   TO DP013-MESSAGE-TEXT (1)      49360000
493700         MOVE 'TO INSERT A TAUSHIP ROW'                           49370000
493800                                   TO DP013-MESSAGE-TEXT (2)      49380000
493900         MOVE SQLCA                TO DP013-SQLCA                 49390000
494000         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    49400000
494100         SET DP013-DB2-ABEND                                      49410000
494200             DP013-XCTL-DISPLAY-RESTART                           49420000
494300                                   TO TRUE                        49430000
494400         PERFORM DP013-0000-PROCESS-ABEND                         49440000
494500     END-IF.                                                      49450000
494600                                                                  49460000
494700*----------------------------------------------------------------*49470000
494800*  INSERT A ROW TO THE VEHICLE AUDIT TABLE                        49480000
494900*                                                                 49490000
495000*  PERFORMED FROM                                                 49500000
495100*----------------------------------------------------------------*49510000
495200 5020-AUDIT-TVEHICL.                                              49520000
495300                                                                  49530000
495400     INITIALIZE DCLTAUVHCL.                                       49540000
495500                                                                  49550000
495600     PERFORM                                                      49560000
495700         WITH TEST AFTER                                          49570000
495800         VARYING PV-RETRY-COUNTER                                 49580000
495900         FROM 1 BY 1                                              49590000
496000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49600000
496100             OR (SQLCODE = +0))                                   49610000
496200                                                                  49620000
496300         EXEC SQL                                                 49630000
496400             SELECT  OWNER_SCAC_ID                                49640000
496500                    ,VEH_NBR                                      49650000
496600                    ,CRT_SRC_CDE                                  49660000
496700                    ,LAST_UPD_DTE                                 49670000
496800                    ,LAST_UPD_TME                                 49680000
496900                    ,LAST_UPD_UID                                 49690000
497000                    ,USAGE_CDE                                    49700000
497100                    ,VEH_TYP_CDE                                  49710000
497200                    ,CURR_STATUS_CDE                              49720000
497300                    ,CURR_STATUS_DTE                              49730000
497400                    ,CURR_STATUS_TME                              49740000
497500                    ,CURR_OPER_UNT_ID                             49750000
497600                    ,CURR_FCLTY_ID                                49760000
497700                    ,CURR_FAC_AREA_ID                             49770000
497800                    ,CURR_LOC_DTE                                 49780000
497900                    ,CURR_LOC_TME                                 49790000
498000                    ,CURR_TRIP_ID                                 49800000
498100                    ,VEH_SIZE_CDE                                 49810000
498200            INTO     :VEHICL-OWNER-SCAC-ID                        49820000
498300                    ,:VEHICL-VEH-NBR                              49830000
498400                    ,:VEHICL-CRT-SRC-CDE                          49840000
498500                    ,:VEHICL-LAST-UPD-DTE                         49850000
498600                    ,:VEHICL-LAST-UPD-TME                         49860000
498700                    ,:VEHICL-LAST-UPD-UID                         49870000
498800                    ,:VEHICL-USAGE-CDE                            49880000
498900                    ,:VEHICL-VEH-TYP-CDE                          49890000
499000                    ,:VEHICL-CURR-STATUS-CDE                      49900000
499100                    ,:VEHICL-CURR-STATUS-DTE                      49910000
499200                    ,:VEHICL-CURR-STATUS-TME                      49920000
499300                    ,:VEHICL-CURR-OPER-UNT-ID                     49930000
499400                    ,:VEHICL-CURR-FCLTY-ID                        49940000
499500                    ,:VEHICL-CURR-FAC-AREA-ID                     49950000
499600                    ,:VEHICL-CURR-LOC-DTE                         49960000
499700                    ,:VEHICL-CURR-LOC-TME                         49970000
499800                    ,:VEHICL-CURR-TRIP-ID                         49980000
499900                       :DN-CURR-TRIP-ID                           49990000
500000                    ,:VEHICL-VEH-SIZE-CDE                         50000000
500100           FROM   TVEHICL                                         50010000
500200           WHERE  VEH_NBR       = :DK-VEH-NBR                     50020000
500300             AND  OWNER_SCAC_ID = :DK-PRO-SCAC-ID                 50030000
500400         END-EXEC                                                 50040000
500500                                                                  50050000
500600         EVALUATE TRUE                                            50060000
500700             WHEN SQLCODE = +0                                    50070000
500800             WHEN SQLCODE = -904                                  50080000
500900             WHEN SQLCODE = -913                                  50090000
501000                 CONTINUE                                         50100000
501100                                                                  50110000
501200             WHEN SQLWARN0 NOT = SPACES                           50120000
501300             WHEN SQLCODE < +0                                    50130000
501400             WHEN SQLCODE > +0                                    50140000
501500                 MOVE '5030-AUDIT-TVEHICL'                        50150000
501600                                   TO DP013-PARAGRAPH             50160000
501700                 MOVE 'SELECT A TVEHICL ROW   '                   50170000
501800                                   TO DP013-MESSAGE-TEXT(1)       50180000
501900                 MOVE DK-VEH-NBR                                  50190000
502000                                   TO DP013-MESSAGE-TEXT(2)       50200000
502100                 MOVE DK-PRO-SCAC-ID                              50210000
502200                                   TO DP013-MESSAGE-TEXT(3)       50220000
502300                 MOVE SQLCA        TO DP013-SQLCA                 50230000
502400                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    50240000
502500                 SET DP013-DB2-ABEND                              50250000
502600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           50260000
502700                 PERFORM DP013-0000-PROCESS-ABEND                 50270000
502800         END-EVALUATE                                             50280000
502900     END-PERFORM.                                                 50290000
503000                                                                  50300000
503100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50310000
503200         MOVE '5030-AUDIT-TVEHICL'                                50320000
503300                                   TO DP013-PARAGRAPH             50330000
503400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              50340000
503500                                   TO DP013-MESSAGE-TEXT (1)      50350000
503600         MOVE 'TO SELECT A TVEHICL ROW'                           50360000
503700                                   TO DP013-MESSAGE-TEXT (2)      50370000
503800         MOVE SQLCA                TO DP013-SQLCA                 50380000
503900         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    50390000
504000         SET DP013-DB2-ABEND                                      50400000
504100             DP013-XCTL-DISPLAY-RESTART                           50410000
504200                                   TO TRUE                        50420000
504300         PERFORM DP013-0000-PROCESS-ABEND                         50430000
504400     END-IF.                                                      50440000
504500                                                                  50450000
504600                                                                  50460000
504700     PERFORM                                                      50470000
504800         WITH TEST AFTER                                          50480000
504900         VARYING PV-RETRY-COUNTER                                 50490000
505000         FROM 1 BY 1                                              50500000
505100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50510000
505200             OR (SQLCODE = +0))                                   50520000
505300                                                                  50530000
505400         EXEC SQL                                                 50540000
505500             INSERT  INTO TAUVHCL                                 50550000
505600                    (OWNER_SCAC_ID                                50560000
505700                    ,VEH_NBR                                      50570000
505800                    ,CRT_SRC_CDE                                  50580000
505900                    ,LAST_UPD_DTE                                 50590000
506000                    ,LAST_UPD_TME                                 50600000
506100                    ,LAST_UPD_UID                                 50610000
506200                    ,USAGE_CDE                                    50620000
506300                    ,VEH_TYP_CDE                                  50630000
506400                    ,CURR_STATUS_CDE                              50640000
506500                    ,CURR_STATUS_DTE                              50650000
506600                    ,CURR_STATUS_TME                              50660000
506700                    ,CURR_OPER_UNT_ID                             50670000
506800                    ,CURR_FCLTY_ID                                50680000
506900                    ,CURR_FAC_AREA_ID                             50690000
507000                    ,CURR_LOC_DTE                                 50700000
507100                    ,CURR_LOC_TME                                 50710000
507200                    ,CURR_TRIP_ID                                 50720000
507300                    ,VEH_SIZE_CDE)                                50730000
507400            VALUES  (:VEHICL-OWNER-SCAC-ID                        50740000
507500                    ,:VEHICL-VEH-NBR                              50750000
507600                    ,:VEHICL-CRT-SRC-CDE                          50760000
507700                    ,:VEHICL-LAST-UPD-DTE                         50770000
507800                    ,:VEHICL-LAST-UPD-TME                         50780000
507900                    ,:VEHICL-LAST-UPD-UID                         50790000
508000                    ,:VEHICL-USAGE-CDE                            50800000
508100                    ,:VEHICL-VEH-TYP-CDE                          50810000
508200                    ,:VEHICL-CURR-STATUS-CDE                      50820000
508300                    ,:VEHICL-CURR-STATUS-DTE                      50830000
508400                    ,:VEHICL-CURR-STATUS-TME                      50840000
508500                    ,:VEHICL-CURR-OPER-UNT-ID                     50850000
508600                    ,:VEHICL-CURR-FCLTY-ID                        50860000
508700                    ,:VEHICL-CURR-FAC-AREA-ID                     50870000
508800                    ,:VEHICL-CURR-LOC-DTE                         50880000
508900                    ,:VEHICL-CURR-LOC-TME                         50890000
509000                    ,:VEHICL-CURR-TRIP-ID                         50900000
509100                       :DN-CURR-TRIP-ID                           50910000
509200                    ,:VEHICL-VEH-SIZE-CDE)                        50920000
509300         END-EXEC                                                 50930000
509400                                                                  50940000
509500         EVALUATE TRUE                                            50950000
509600             WHEN SQLCODE = +0                                    50960000
509700             WHEN SQLCODE = -904                                  50970000
509800             WHEN SQLCODE = -913                                  50980000
509900                 CONTINUE                                         50990000
510000                                                                  51000000
510100             WHEN SQLWARN0 NOT = SPACES                           51010000
510200             WHEN SQLCODE < +0                                    51020000
510300             WHEN SQLCODE > +0                                    51030000
510400                 MOVE '5030-AUDIT-TAUVHCL'                        51040000
510500                                   TO DP013-PARAGRAPH             51050000
510600                 MOVE 'INSERT A ROW ON TAUVHCL'                   51060000
510700                                   TO DP013-MESSAGE-TEXT(1)       51070000
510800                 MOVE DK-VEH-NBR                                  51080000
510900                                   TO DP013-MESSAGE-TEXT(2)       51090000
511000                 MOVE DK-PRO-SCAC-ID                              51100000
511100                                   TO DP013-MESSAGE-TEXT(3)       51110000
511200                 MOVE SQLCA        TO DP013-SQLCA                 51120000
511300                 MOVE 'TAUVHCL'    TO DP013-DB2-TABLE-NAME (1)    51130000
511400                 SET DP013-DB2-ABEND                              51140000
511500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           51150000
511600                 PERFORM DP013-0000-PROCESS-ABEND                 51160000
511700         END-EVALUATE                                             51170000
511800     END-PERFORM.                                                 51180000
511900                                                                  51190000
512000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        51200000
512100         MOVE '5030-AUDIT-TAUVHCL'                                51210000
512200                                   TO DP013-PARAGRAPH             51220000
512300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              51230000
512400                                   TO DP013-MESSAGE-TEXT (1)      51240000
512500         MOVE 'TO INSERT A TAUVHCL ROW'                           51250000
512600                                   TO DP013-MESSAGE-TEXT (2)      51260000
512700         MOVE SQLCA                TO DP013-SQLCA                 51270000
512800         MOVE 'TAUVHCL'            TO DP013-DB2-TABLE-NAME (1)    51280000
512900         SET DP013-DB2-ABEND                                      51290000
513000             DP013-XCTL-DISPLAY-RESTART                           51300000
513100                                   TO TRUE                        51310000
513200         PERFORM DP013-0000-PROCESS-ABEND                         51320000
513300     END-IF.                                                      51330000
513400                                                                  51340000
513500*----------------------------------------------------------------*51350000
513600* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *51360000
513700*----------------------------------------------------------------*51370000
513800                                                                  51380000
513900 9100-READ-SEL-QUEUE.                                             51390000
514000     EXEC CICS                                                    51400000
514100         READQ TS                                                 51410000
514200             QUEUE (ASC-SEL-QUEUE-NAME)                           51420000
514300             INTO  (RC013-DC-SELECT-RECORD)                       51430000
514400             ITEM  (ASC-SEL-ITEM)                                 51440000
514500             RESP  (PV-CICS-RESP)                                 51450000
514600     END-EXEC.                                                    51460000
514700                                                                  51470000
514800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       51480000
514900         CONTINUE                                                 51490000
515000     ELSE                                                         51500000
515100         SET DP013-LOGIC-ABEND                                    51510000
515200             DP013-NO-ROLLBACK     TO TRUE                        51520000
515300         MOVE '9100-READ-SEL-QUEUE'                               51530000
515400                                   TO DP013-PARAGRAPH             51540000
515500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   51550000
515600                                   TO DP013-MESSAGE-TEXT (1)      51560000
515700         PERFORM DP013-0000-PROCESS-ABEND                         51570000
515800     END-IF.                                                      51580000
515900*----------------------------------------------------------------*51590000
516000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *51600000
516100*----------------------------------------------------------------*51610000
516200 9200-REWRITE-SEL-QUEUE.                                          51620000
516300     EXEC CICS                                                    51630000
516400          WRITEQ TS                                               51640000
516500              QUEUE  (ASC-SEL-QUEUE-NAME)                         51650000
516600              FROM   (RC013-DC-SELECT-RECORD)                     51660000
516700              ITEM   (ASC-SEL-ITEM)                               51670000
516800              RESP   (PV-CICS-RESP)                               51680000
516900              REWRITE                                             51690000
517000     END-EXEC.                                                    51700000
517100                                                                  51710000
517200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   51720000
517300         SET DP013-CICS-ABEND                                     51730000
517400             DP013-NO-ROLLBACK     TO TRUE                        51740000
517500         MOVE '9200-REWRITE-SEL-QUEUE'                            51750000
517600                                   TO DP013-PARAGRAPH             51760000
517700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   51770000
517800                                   TO DP013-MESSAGE-TEXT (1)      51780000
517900         PERFORM DP013-0000-PROCESS-ABEND                         51790000
518000     END-IF.                                                      51800000
518100                                                                  51810000
518200 EJECT                                                            51820000
518300*----------------------------------------------------------------*51830000
518400*    ABEND PROCESSOR MODULE                                      *51840000
518500*----------------------------------------------------------------*51850000
518600                                                                  51860000
518700     COPY DPPD013.                                                51870000
518800                                                                  51880000
518900*----------------------------------------------------------------*51890000
519000*    LINK TO CICS OBJECT LOCKING MODULE                          *51900000
519100*----------------------------------------------------------------*51910000
519200                                                                  51920000
519300     COPY DPPD044.                                                51930000
