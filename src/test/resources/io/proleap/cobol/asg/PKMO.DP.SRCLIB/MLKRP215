       IDENTIFICATION DIVISION.                                                 
                                                                                
       PROGRAM-ID.    MLKRP215.                                                 
       AUTHOR.        RONNA BUTZ.                                               
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  05/03/99.                                                 
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *     MLKRP215 - COMBINED LEDGER REPORT                                   
      *                                                                         
      * THIS PROGRAM READS EXTRACTS FROM THE DEPARTMENT-LEVEL MONTH AND         
      * WEEK TO DATE MERCHANDISE LEDGER TABLE AND PRODUCES THE                  
      * DEPARTMENT-LEVEL COMBINED LEDGER REPORT.                                
      *                                                                         
      * TOTALS ARE REPORTED FOR THE FOLLOWING LEVELS:                           
      *       DEPARTMENT                                                        
      *       BUYER                                                             
      *       MANAGER  (DMM)                                                    
      *       DIVISION (GMM)                                                    
      *       COMPANY                                                           
      *                                                                         
      * RLB - 7-9-99 - ADDED LOGIC TO INCLUDE PLANNING AND OTB                  
      * P. KEBER - 7/27/99 - ADDED LOGIC TO INCLUDE PLANNING AND OTB            
      * RLB - 8/02/99 - ADDED LOGIC TO CORRECT FORCAST RECEIPT AMOUNT           
      * RLB - 8/19/99 - REMOVE OPEN ORDER HEADING ON WEEKLY SECTION             
      *                 OF REPORT.  THIS WILL NEED TO BE ADDED BACK IN          
      *                 FOR PHASE III.                                          
      * RLB -10/28/99   PHASE III &PLANNING RECEIPT ADJUSTMENT                  
      * RLB -01/03/00   CORRECTED FORECAST MARKON % CONDITION - THE             
      *                 CHECK FOR THE DIVISOR = ZERO WAS CHANGED FROM           
      *                 AT-FC-ONORD-EXT-CST-AMT TO                              
      *                 AT-FC-ONORD-EXT-RTL-AMT                                 
      * RLB -04/04/00   PHASE IV                                                
      *                 ITEM 1 - COMP SALES PERCENT                             
      *                 ITEM 2 - PLAN CUM MARKUP PERCENT SEASON TO DATE         
      *                 ITEM 3 - PRINT OTB, PLAN, AND LAST YEAR DATA            
      *                          WITH WHATEVER VALUES ARE AVAILABLE             
      *                 ITEM 4 - REPLACE STOCK/SALE RATIO WITH                  
      *                          INVENTORY TURN.  THE EQUATION FOR              
      *                          INVENTORY TURN IS THE SEASON                   
      *                          CUMMULATIVE SALES DIVIDED BY THE               
      *                          AVERAGE INVENTORY                              
      * RLB -04/05/00   CORRECTED ROUNDING FOR WEEKLY THIS YEAR                 
      *                 SALES, WEEKLY PLANNING SALES AND WEEKLY                 
      *                 FORECASTING SALES                                       
      *                                                                         
      * RLB -04/04/00   INCREASED LRECL FOR WEEKLY FILE FROM 1209 TO            
      *                 1449                                                    
      *                                                                         
      * RLB -04/04/00   CORRECTED MONTHLY PLANNING PURCHASE ADJUSTMENT          
      *                 CALCULATION.                                            
      *                                                                         
      * RLB -05/25/00   CORRECTED MARKON% THIS YEAR AND LAST YEAR.              
      *                 WAS CHECKING IF THE PURCHASE RETAIL AMOUNT              
      *                 WAS NOT ZERO FOR THE CALCULATION, BUT NEEDED            
      *                 TO CHECK IF THE RECEIPT RETAIL AMOUNT IS NOT            
      *                 ZERO FOR THE CACLULATION BECAUSE AT THE SEASON          
      *                 LEVEL THE ENDING INVENTORY IS INCLUDED IN THE           
      *                 PURCHASE RETAIL AMOUNT.                                 
      *                                                                         
      * AML -07/12/00   EXPANDED GROSS MARGIN PERCENT TO TWO DECIMALS.          
      *                                                                         
21517 * VLY -09/25/00   CHANGED TO ADD PURCHASE ADJUSTMENT TO WEEKLY            
21517 *                 PLANNING TABLE AND EOM INVENTORY TO MONTHLY             
21517 *                 PLANNING TABLE FOR COMBINED LEDGER PHASE 6              
21517 *                 WR#21517                                                
31355 * RWJ 11/17/00 -E-COMMERCE COMBINED LEDGER REPORT MODIFICATION.           
W04081* RWJ 04/08/01 -DATA DECIMAL ERROR - PLAN NET PURCHASE PERCENT.           
408081* RWJ 06/11/01 -DATA DECIMAL ERROR - SEASONAL PRCH RTL AMT.               
W26603******************************************************************        
W26603* CHG ID   DATE        DESCRIPTION                               *        
W26603* ------   ----------  ----------------------------------------- *        
W26603* W26603   03-18-2004  STORE EXPANSION.  EXPANDED LRECL OF       *        
W26603*                      INP01, INP02, INP03 FILE BECAUSE OF       *        
W26603*                      CHANGES TO MLRD122, MLRD128, MLRD140.     *        
W26603*                      EXPANDED WORKING STORAGE                  *        
W26603*                      VARIABLES.  AT THIS TIME WE ARE NOT       *        
W26603*                      EXPANDING THE REPORT FIELDS.              *        
W26603*                      ADDED 'WITH UR' TO DB2 SELECTS.           *        
W26603*                      - RONNA MCDONALD                          *        
DIVDBY* DIVDBY   02-17-2014  INC0563185 - ADDED NON ZERO CHECK FOR THE          
DIVDBY*                      FIELD AT-SEAS-LY-PRCH-RTL-AMT INSTEAD OF           
DIVDBY*                      AT-SEAS-LY-RCPT-RTL-AMT WHILE CALCULATING          
DIVDBY*                      LAST YEAR MONTHLY MARKON PERCENT TO                
DIVDBY*                      HANDLE DIVIDE BY ZERO ERROR.                       
222725* CHG0222725  04-29-2019                                         *        
222725*                      CHANGES MADE TO PICK ONLY THE BUYER       *        
222725*                      CREATED  UNDER 'DPT' IN TMDSEAR TABLE     *        
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
                                                                                
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
                                                                                
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
                                                                                
           SELECT LEDGER-EXTRACT-WK-FILE                                        
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT LEDGER-EXTRACT-MN-FILE                                        
               ASSIGN TO INP02.                                                 
                                                                                
           SELECT LEDGER-EXTRACT-EOW-FILE                                       
               ASSIGN TO INP03.                                                 
                                                                                
           SELECT LEDGER-EXTRACT-DATE-FILE                                      
               ASSIGN TO INP04.                                                 
                                                                                
31355      SELECT LEDGER-HEADER-CONTROL-FILE                                    
31355          ASSIGN TO INP05.                                                 
31355                                                                           
           SELECT LEDGER-REPORT-FILE                                            
               ASSIGN RPT01.                                                    
                                                                                
                                                                                
                                                                                
       DATA DIVISION.                                                           
                                                                                
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  LEDGER-EXTRACT-WK-FILE                                               
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
W26603*01  LEDGER-EXTRACT-WK-RECORD         PIC  X(1449).                       
W26603 01  LEDGER-EXTRACT-WK-RECORD         PIC  X(1638).                       
                                                                                
       FD  LEDGER-EXTRACT-MN-FILE                                               
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
W26603*01  LEDGER-EXTRACT-MN-RECORD         PIC  X(4432).                       
W26603 01  LEDGER-EXTRACT-MN-RECORD         PIC  X(5131).                       
                                                                                
       FD  LEDGER-EXTRACT-EOW-FILE                                              
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
W26603*01  LEDGER-EXTRACT-EOW-RECORD        PIC X(964).                         
W26603 01  LEDGER-EXTRACT-EOW-RECORD        PIC X(1123).                        
                                                                                
       FD  LEDGER-EXTRACT-DATE-FILE                                             
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  LEDGER-EXTRACT-DATE-RECORD       PIC X(80).                          
                                                                                
31355  FD  LEDGER-HEADER-CONTROL-FILE                                           
  |        RECORDING MODE IS F                                                  
  |        LABEL RECORDS ARE STANDARD                                           
  |        BLOCK CONTAINS 0 RECORDS.                                            
  |    01  LEDGER-HCF-RECORD-RECORD.                                            
  |        05  LCHF-RPT-HEADER-ID          PIC X(01).                           
  |        05  FILLER                      PIC X(79).                           
31355                                                                           
       FD  LEDGER-REPORT-FILE                                                   
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  LEDGER-REPORT-RECORD             PIC  X(200).                        
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR LEDGER EXTRACT WEEKLY RECORD                          
      ****************************************************************          
                                                                                
21517      COPY MLRD122.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR LEDGER EXTRACT MONTHLY RECORD                         
      ****************************************************************          
                                                                                
21517      COPY MLRD128.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR LEDGER EXTRACT DATE RECORD                            
      ****************************************************************          
                                                                                
           COPY MLRD114.                                                        
                                                                                
      ****************************************************************          
      * RECORD LAYOUT FOR EOW INVENTORY.                                        
      ****************************************************************          
                                                                                
           COPY MLRD140.                                                        
                                                                                
      *****************************************************************         
      * 200 CHARACTER REPORT LAYOUT                                             
      *****************************************************************         
                                                                                
           COPY DPWS200O.                                                       
                                                                                
      *****************************************************************         
      *    WORKING STORAGE AREA FOR ROUTINE TO FORMAT NAME                      
      *****************************************************************         
                                                                                
           COPY DPWS024.                                                        
                                                                                
      ******************************************************************        
      *  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004                
      ******************************************************************        
                                                                                
           COPY DPWS004.                                                        
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-COMPANY-TOTALS            PIC  X(22)     VALUE                
                                            '*** COMPANY TOTALS ***'.           
           05  PC-DIVISION-TOTALS           PIC  X(23)     VALUE                
                                            '*** DIVISION TOTALS ***'.          
           05  PC-MANAGER-TOTALS            PIC  X(22)     VALUE                
                                            '*** MANAGER TOTALS ***'.           
           05  PC-BUYER-TOTALS              PIC  X(20)     VALUE                
                                            '*** BUYER TOTALS ***'.             
           05  PC-DEPT-TOTALS               PIC  X(19)     VALUE                
                                            '*** DEPT TOTALS ***'.              
                                                                                
           05  PC-DEPT-LVL                  PIC S9(04)     COMP SYNC            
                                                           VALUE +1.            
           05  PC-BYR-LVL                   PIC S9(04)     COMP SYNC            
                                                           VALUE +2.            
           05  PC-DMA-LVL                   PIC S9(04)     COMP SYNC            
                                                           VALUE +3.            
           05  PC-GMA-LVL                   PIC S9(04)     COMP SYNC            
                                                           VALUE +4.            
           05  PC-OPERCO-LVL                PIC S9(04)     COMP SYNC            
                                                           VALUE +5.            
           05  PC-ONE                       PIC S9(04)     COMP SYNC            
                                                           VALUE +1.            
           05  PC-TWO                       PIC S9(04)     COMP SYNC            
                                                           VALUE +2.            
           05  PC-THREE                     PIC S9(04)     COMP SYNC            
                                                           VALUE +3.            
           05  PC-FOUR                      PIC S9(04)     COMP SYNC            
                                                           VALUE +4.            
           05  PC-FIVE                      PIC S9(04)     COMP SYNC            
                                                           VALUE +5.            
           05  PC-SIX                       PIC S9(04)     COMP SYNC            
                                                           VALUE +6.            
           05  PC-SEVEN                     PIC S9(04)     COMP SYNC            
                                                           VALUE +7.            
           05  PC-TWELVE                    PIC S9(04)     COMP SYNC            
                                                           VALUE +12.           
           05  PC-TWENTY-FIVE               PIC S9(04)     COMP SYNC            
                                                           VALUE +25.           
           05  PC-TWENTY-SEVEN              PIC S9(04)     COMP SYNC            
                                                           VALUE +27.           
           05  PC-FIFTY-THREE               PIC S9(04)     COMP SYNC            
                                                           VALUE +53.           
                                                                                
           05  PC-WK                        PIC  X(03)     VALUE 'WK'.          
           05  PC-D                         PIC  X(03)     VALUE 'D'.           
           05  PC-MT                        PIC  X(03)     VALUE 'MT'.          
           05  PC-TY                        PIC  X(03)     VALUE 'TY'.          
           05  PC-FC                        PIC  X(03)     VALUE 'FC'.          
           05  PC-PL                        PIC  X(03)     VALUE 'PL'.          
           05  PC-LY                        PIC  X(03)     VALUE 'LY'.          
           05  PC-NA                        PIC  X(03)     VALUE 'NA'.          
                                                                                
           05  PC-MDSELV-GMA                PIC  X(03)     VALUE 'GMA'.         
           05  PC-MDSELV-DMA                PIC  X(03)     VALUE 'DMA'.         
           05  PC-MDSELV-DPT                PIC  X(03)     VALUE 'DPT'.         
                                                                                
           05  PC-RSPLVL-CDE-GMM            PIC  X(03)     VALUE 'GMM'.         
           05  PC-RSPLVL-CDE-DMM            PIC  X(03)     VALUE 'DMM'.         
           05  PC-RSPLVL-CDE-BYR            PIC  X(03)     VALUE 'BYR'.         
           05  PC-NO-PLAN                   PIC  X(07)     VALUE                
                 'NO PLAN'.                                                     
           05  PC-PCT-OVER                  PIC  X(08)     VALUE                
                 '******* '.                                                    
           05  PC-THOUSAND                  PIC S9(04)V99  COMP-3               
                                                           VALUE +1000.         
           05  PC-DEPT-NBR-000              PIC  X(03)     VALUE '000'.         
           05  PC-OPERCO-NBR                PIC  X(02)     VALUE '03'.          
           05  PC-APLSYS-CDE                PIC  X(02)     VALUE 'ML'.          
           05  PC-2-SPACES-LIT              PIC  X(02)     VALUE '  '.          
           05  PC-PAREN-SPACE-LIT           PIC  X(02)     VALUE ') '.          
           05  PC-PCT                       PIC  X(01)     VALUE '%'.           
           05  PC-MAX-MN                    PIC S9(04)     COMP SYNC            
                                                           VALUE 12.            
           05  PC-MAX-WK                    PIC S9(04)     COMP SYNC            
                                                           VALUE 53.            
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-OF-FSCL-MN-NM-CSR-SW    PIC X    VALUE 'N'.               
               88 PS-END-OF-FSCL-MN-NM-CSR             VALUE 'Y'.               
           05  PS-END-OF-LEDGER-EXTRACT-WK-SW PIC X    VALUE 'N'.               
               88 PS-END-OF-LEDGER-EXTRACT-WK          VALUE 'Y'.               
           05  PS-END-OF-LEDGER-EXTRACT-MN-SW PIC X    VALUE 'N'.               
               88 PS-END-OF-LEDGER-EXTRACT-MN          VALUE 'Y'.               
           05  PS-END-OF-LEDGER-EOW-FILE-SW   PIC X    VALUE 'N'.               
               88 PS-END-OF-LEDGER-EOW-FILE            VALUE 'Y'.               
           05  PS-END-OF-LEDGER-DATE-FILE-SW  PIC X    VALUE 'N'.               
               88 PS-END-OF-LEDGER-DATE-FILE           VALUE 'Y'.               
           05  PS-FUTURE-SW                   PIC X    VALUE 'N'.               
               88 PS-FUTURE-SW-ON                      VALUE 'Y'.               
                                                                                
           05  PS-BREAK-LEVEL-SW             PIC X     VALUE SPACE.             
               88  PS-BREAK-LEVEL-SW-INIT              VALUE ' '.               
               88  PS-BREAK-IS-OPERCO                  VALUE 'C'.               
               88  PS-BREAK-IS-GMA                     VALUE 'G'.               
               88  PS-BREAK-IS-DMA                     VALUE 'V'.               
               88  PS-BREAK-IS-BYR                     VALUE 'B'.               
               88  PS-BREAK-IS-DEPT                    VALUE 'D'.               
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-TY-BEG-INV-RTL-AMT        PIC S9(11)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-LY-BEG-INV-RTL-AMT        PIC S9(11)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-TY-BEG-INV-COST-AMT       PIC S9(11)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-LY-BEG-INV-COST-AMT       PIC S9(11)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-END-INV-RTL-AMT           PIC S9(11)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-AMT-RNDED                 PIC S9(11)V9   COMP-3               
                                                           VALUE ZERO.          
           05  PV-PCT                       PIC S9(09)V9   COMP-3               
                                                           VALUE ZERO.          
           05  PV-RATIO                     PIC S9(03)V9   COMP-3               
                                                           VALUE ZERO.          
           05  PV-PCT-DEC-TWO               PIC S9(09)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-PCT-DEC-FOUR              PIC S9(09)V9999                     
                                                           COMP-3               
                                                           VALUE ZERO.          
W26603     05  PV-BOM-INV-SEAS              PIC S9(13)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-TY-INV-SUM                PIC S9(15)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-PL-INV-SUM                PIC S9(15)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-LY-INV-SUM                PIC S9(15)V99  COMP-3               
                                                           VALUE ZERO.          
W26603     05  PV-TY-SALES-SUM              PIC S9(13)V99  COMP-3               
                                                           VALUE ZERO.          
W26603     05  PV-PL-SALES-SUM              PIC S9(13)V99  COMP-3               
                                                           VALUE ZERO.          
W26603     05  PV-LY-SALES-SUM              PIC S9(13)V99  COMP-3               
                                                           VALUE ZERO.          
           05  PV-DEPT-NBR                  PIC  X(03)     VALUE SPACE.         
           05  PV-GMA-NBR                   PIC  X(02)     VALUE SPACE.         
           05  PV-DMA-NBR                   PIC  X(02)     VALUE SPACE.         
           05  PV-BYR-NBR                   PIC  X(03)     VALUE SPACE.         
           05  PV-MDSELV-CDE                PIC  X(03)     VALUE SPACE.         
           05  PV-NAME-WITH-PARENS.                                             
               10  PV-NAME-PAREN-1          PIC  X(02)     VALUE ' ('.          
               10  PV-ENTIRE-NAME           PIC  X(20).                         
               10  PV-NAME-PAREN-2          PIC  X(02)     VALUE SPACE.         
           05  PV-DESC                      PIC  X(25)     VALUE SPACE.         
           05  PV-NAME                      PIC  X(24)     VALUE SPACE.         
           05  PV-TY-LAST-WK-IN-MN          PIC S9(04)     COMP-3               
                                                           VALUE ZERO.          
           05  PV-LY-LAST-WK-IN-MN          PIC S9(04)     COMP-3               
                                                           VALUE ZERO.          
           05  TY-LAST-WK-IN-MN             PIC  X(01)     VALUE SPACE.         
           05  LY-LAST-WK-IN-MN             PIC  X(01)     VALUE SPACE.         
           05  PV-WK-NBR                    PIC  9(01)     COMP-3               
                                                           VALUE ZERO.          
           05  PV-PAGE-CNT                  PIC S9(05)     COMP-3               
                                                           VALUE ZERO.          
           05  PV-PARAGRAPH-NAME            PIC  X(30)     VALUE SPACE.         
           05  PV-DB2-OPER-ATTEMPTED        PIC  X(30)     VALUE SPACE.         
           05  PV-ABEND-CODE                PIC S9(04)     COMP                 
                                                           VALUE ZERO.          
           05  PV-WEEK-NBR                  PIC S9(05)     COMP-3               
                                                           VALUE ZERO.          
           05  PV-FSCL-WK-NBR-MN1           PIC   X(2)     VALUE SPACE.         
           05  PV-FSCL-WK-NBR-MN2           PIC   X(2)     VALUE SPACE.         
           05  PV-FSCL-WK-NBR-MN3           PIC   X(2)     VALUE SPACE.         
           05  PV-FSCL-WK-NBR-MN4           PIC   X(2)     VALUE SPACE.         
                                                                                
       01  SS-SUBSCRIPTS.                                                       
           05  SS-MN                        PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-WK                        PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-OPEN-MN                   PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-CURR-MN                   PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-SEASON                    PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-CURR-LVL                  PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-NEXT-LVL                  PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-OPEN-WK                   PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-OPEN-FSCL-WK              PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-CURR-WK                   PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-TY-CURR-WK                PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-PL-CURR-WK                PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
           05  SS-NEXT-WK                   PIC S9(04)     COMP SYNC            
                                                           VALUE ZERO.          
                                                                                
      ******************************************************************        
      * THIS TABLE CONTAINS THE FOLLOWING:                                      
      *                                                                         
      *      5  OCCURRANCES OF BUSINESS LEVEL - COMPANY, GMM, DMM,              
      *                                        BUYER, AND DEPT                  
      *                                                                         
      *   WITHIN THE BUSINESS LEVEL THE TABLE CONTAINS THE FOLLOWING:           
      *                                                                         
      *      5  OCCURANCES OF EACH WEEK FOR THE OPEN MONTH                      
      *      12 OCCURANCES OF EACH MONTH FOR THE FISCAL YEAR                    
      *      2  OCCURANCES OF EACH SEASON FOR THE FISCAL YEAR                   
      *                                                                         
      ******************************************************************        
       01  AT-ACCUMULATION-TABLE.                                               
           05  AT-BUSINESS-LEVEL-TOTALS         OCCURS  5.                      
W26603         10  AT-MN-TY-BEG-INV-COST-AMT    PIC S9(13)V99  COMP-3.          
W26603         10  AT-MN-TY-BEG-INV-RTL-AMT     PIC S9(13)V99  COMP-3.          
W26603         10  AT-MN-LY-BEG-INV-COST-AMT    PIC S9(13)V99  COMP-3.          
W26603         10  AT-MN-LY-BEG-INV-RTL-AMT     PIC S9(13)V99  COMP-3.          
W26603         10  AT-YTD-TY-COMP-INV-AMT       PIC S9(13)V99  COMP-3.          
W26603         10  AT-YTD-LY-COMP-INV-AMT       PIC S9(13)V99  COMP-3.          
               10  AT-WK-TOTALS                 OCCURS 5.                       
                   15  AT-WK-TY-PRCH-NET-COST-AMT                               
W26603                                          PIC S9(13)V99  COMP-3.          
                   15  AT-WK-LY-PRCH-NET-COST-AMT                               
W26603                                          PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-TY-PRCH-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-PRCH-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-TY-SLS-RTL-AMT     PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-FC-SLS-RTL-AMT     PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-PL-SLS-RTL-AMT     PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-SLS-RTL-AMT     PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-TY-COMP-SLS-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-COMP-SLS-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-TY-MKDN-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-FC-MKDN-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-PL-MKDN-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-MKDN-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-TY-EOW-INV-AMT     PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-PL-EOW-INV-AMT     PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-EOW-INV-AMT     PIC S9(13)V99  COMP-3.          
                   15  AT-WK-TY-WKS-SUP-GT-SYM  PIC  X(01).                     
                   15  AT-WK-TY-WKS-SUP-NO-PLN  PIC  X(01).                     
                   15  AT-WK-TY-WKS-SUP         PIC S9(04)     COMP-3.          
                   15  AT-WK-FC-WKS-SUP-GT-SYM  PIC  X(01).                     
                   15  AT-WK-FC-WKS-SUP-NO-PLN  PIC  X(01).                     
                   15  AT-WK-FC-WKS-SUP         PIC S9(04)     COMP-3.          
                   15  AT-WK-PL-WKS-SUP-GT-SYM  PIC  X(01).                     
                   15  AT-WK-PL-WKS-SUP-NO-PLN  PIC  X(01).                     
                   15  AT-WK-PL-WKS-SUP         PIC S9(04)     COMP-3.          
                   15  AT-WK-LY-WKS-SUP-GT-SYM  PIC  X(01).                     
                   15  AT-WK-LY-WKS-SUP         PIC S9(04)     COMP-3.          
W26603             15  AT-WK-TY-OPEN-ORD-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-OPEN-ORD-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-TY-RCPT-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-FC-TOT-ORD-RTL-AMT PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-PL-RCPT-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-RCPT-RTL-AMT    PIC S9(13)V99  COMP-3.          
                   15  AT-WK-TY-RCPT-NET-COST-AMT                               
W26603                                          PIC S9(13)V99  COMP-3.          
                   15  AT-WK-LY-RCPT-NET-COST-AMT                               
W26603                                          PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-TY-PADJ-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-LY-PADJ-RTL-AMT    PIC S9(13)V99  COMP-3.          
                   15  AT-WK-TY-PADJ-NET-COST-AMT                               
W26603                                          PIC S9(13)V99  COMP-3.          
                   15  AT-WK-LY-PADJ-NET-COST-AMT                               
W26603                                          PIC S9(13)V99  COMP-3.          
W26603             15  AT-WK-PL-PADJ-RTL-AMT    PIC S9(13)V99  COMP-3.          
               10  AT-MONTH-TOTALS              OCCURS 12.                      
W26603             15  AT-TY-EOM-ACTUAL         PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-EOM                PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-EOM                PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-EOM-ACTUAL         PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-RCPT-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-RCPT-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-RCPT-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-RCPT-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-PADJ-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-PADJ-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-PADJ-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-NET-SALES-AMT      PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-NET-SALES-AMT      PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-NET-SALES-AMT      PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-NET-SALES-AMT      PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-MKDN-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-MKDN-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-MKDN-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-MKDN-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-COMP-INV-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-COMP-INV-AMT       PIC S9(13)V99  COMP-3.          
                   15  AT-PL-MKUP-RTL-PCT       PIC S9(05)V99  COMP-3.          
W26603             15  AT-TY-PRCH-NET-COST-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-PRCH-NET-COST-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-PRCH-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-PRCH-RTL-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-GRO-MRGN-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-GRO-MRGN-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-GRO-MRGN-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-SLS-COST-AMT       PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-END-INV-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-END-INV-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-END-INV-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-END-INV-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-TY-END-INV-COST-AMT   PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-END-INV-COST-AMT   PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-TOT-ORD-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-ONORD-EXT-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-ONORD-EXT-CST-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-APP-ORD-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-FC-PASTDUE-RTL-AMT    PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-COMP-SLS-RTL-AMT   PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-CMPR-END-INV-AMT   PIC S9(13)V99  COMP-3.          
                                                                                
               10  AT-SEASON-TOTALS             OCCURS  2.                      
                   15  AT-SEAS-PL-BEG-INV-RTL-AMT                               
W26603                                          PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-RCPT-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-FC-RCPT-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-RCPT-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-LY-RCPT-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-PADJ-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-PADJ-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-LY-PADJ-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-NET-SALES-AMT PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-FC-NET-SALES-AMT PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-NET-SALES-AMT PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-LY-NET-SALES-AMT PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-MKDN-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-FC-MKDN-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-MKDN-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-LY-MKDN-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-COMP-INV-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-COMP-INV-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-LY-COMP-INV-AMT  PIC S9(13)V99  COMP-3.          
                   15  AT-SEAS-TY-PRCH-NET-COST-AMT                             
W26603                                          PIC S9(13)V99  COMP-3.          
                   15  AT-SEAS-LY-PRCH-NET-COST-AMT                             
W26603                                          PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-PRCH-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-PRCH-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-LY-PRCH-RTL-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-GRO-MRGN-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-GRO-MRGN-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-LY-GRO-MRGN-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-TY-SLS-COST-AMT  PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-FC-TOT-ORD-RTL   PIC S9(13)V99  COMP-3.          
W26603             15  AT-SEAS-PL-CUM-MKUP-PCT  PIC S9(13)V99  COMP-3.          
               10  AT-YEAR-OF-WEEKLY-TOTALS     OCCURS 53.                      
W26603             15  AT-TY-EOW-ACTUAL         PIC S9(13)V99  COMP-3.          
W26603             15  AT-PL-EOW                PIC S9(13)V99  COMP-3.          
W26603             15  AT-LY-EOW-ACTUAL         PIC S9(13)V99  COMP-3.          
      *                                                                         
       01  MTD-WK-TOTALS.                                                       
           05  MTD-WK-TY-PRCH-NET-COST-AMT                                      
W26603                                  PIC S9(13)V99  COMP-3.                  
           05  MTD-WK-LY-PRCH-NET-COST-AMT                                      
W26603                                  PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-TY-PRCH-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-LY-PRCH-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-TY-SLS-RTL-AMT    PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-FC-SLS-RTL-AMT    PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-PL-SLS-RTL-AMT    PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-LY-SLS-RTL-AMT    PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-TY-COMP-SLS-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-LY-COMP-SLS-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-PL-COMP-SLS-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-TY-MKDN-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-FC-MKDN-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-PL-MKDN-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-LY-MKDN-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-TY-OPEN-ORD-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-LY-OPEN-ORD-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-TY-RCPT-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-FC-TOT-ORD-RTL-AMT PIC S9(13)V99 COMP-3.                  
W26603     05  MTD-WK-PL-RCPT-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-LY-RCPT-RTL-AMT   PIC S9(13)V99  COMP-3.                  
           05  MTD-WK-TY-RCPT-NET-COST-AMT                                      
W26603                                  PIC S9(13)V99  COMP-3.                  
           05  MTD-WK-LY-RCPT-NET-COST-AMT                                      
W26603                                  PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-TY-PADJ-RTL-AMT   PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-LY-PADJ-RTL-AMT   PIC S9(13)V99  COMP-3.                  
           05  MTD-WK-TY-PADJ-NET-COST-AMT                                      
W26603                                  PIC S9(13)V99  COMP-3.                  
           05  MTD-WK-LY-PADJ-NET-COST-AMT                                      
W26603                                  PIC S9(13)V99  COMP-3.                  
W26603     05  MTD-WK-PL-PADJ-RTL-AMT   PIC S9(13)V99  COMP-3.                  
                                                                                
       01  YTD-YEAR-TO-DATE-TOTALS.                                             
W26603     05  YTD-TY-RCPT-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-FC-RCPT-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-PL-RCPT-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-LY-RCPT-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-TY-PADJ-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-PL-PADJ-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-LY-PADJ-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-TY-NET-SALES-AMT     PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-FC-NET-SALES-AMT     PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-PL-NET-SALES-AMT     PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-LY-NET-SALES-AMT     PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-TY-MKDN-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-FC-MKDN-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-PL-MKDN-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-LY-MKDN-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-TY-PRCH-NET-COST-AMT PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-LY-PRCH-NET-COST-AMT PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-TY-PRCH-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-LY-PRCH-RTL-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-TY-GRO-MRGN-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-PL-GRO-MRGN-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-LY-GRO-MRGN-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-TY-SLS-COST-AMT      PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
W26603     05  YTD-FC-TOT-ORD-RTL-AMT   PIC S9(13)V99  COMP-3                   
                                                           VALUE ZERO.          
                                                                                
       01  MT-MONTH-NAME-TABLE.                                                 
           05  MT-FSCL-MN-NM-ENTRY          OCCURS 12.                          
               10  MT-FSCL-MN-NM.                                               
                   15  MT-FSCL-MN-NM-ABBREV PIC  X(03)     VALUE SPACE.         
                   15  FILLER               PIC  X(06)     VALUE SPACE.         
                                                                                
      ******************************************************************        
      *  TABLE TO STORE THE FISCAL WEEK NUMBER FOR THE END OF EACH MONTH        
      ******************************************************************        
       01  FW-FSCL-WEEK-TABLE.                                                  
           05  FW-MN-END-FSCL-WK            OCCURS  12.                         
               10  FS-FSCL-WK-NBR           PIC S9(04) COMP SYNC.               
                                                                                
       01  HN-HOLD-NUMBERS.                                                     
           05  HN-GMA-NBR                   PIC  X(02)     VALUE ZERO.          
           05  HN-DMA-NBR                   PIC  X(02)     VALUE ZERO.          
           05  HN-BYR-NBR                   PIC  X(03)     VALUE ZERO.          
           05  HN-DEPT-NBR                  PIC  X(03)     VALUE ZERO.          
                                                                                
       01  LC-LASER-CONTROL-SWITCHES.                                           
           05  LC-LASER-CONTROL-FF.                                             
               10  FILLER                   PIC S9(04)     COMP                 
                                                           VALUE -1.            
           05  LC-LASER-CONTROL-FD.                                             
               10  FILLER                   PIC S9(04)     COMP                 
                                                           VALUE -513.          
               10  FILLER                   PIC  X(79)     VALUE SPACE.         
                                                                                
       01  TD-TODAYS-DATE.                                                      
           05  TD-YEAR                      PIC  9(02)     VALUE ZERO.          
           05  TD-MONTH                     PIC  9(02)     VALUE ZERO.          
           05  TD-DAY                       PIC  9(02)     VALUE ZERO.          
                                                                                
       01  TT-TODAYS-TIME.                                                      
           05  TT-HOUR                      PIC  9(02)     VALUE ZERO.          
           05  TT-MINUTE                    PIC  9(02)     VALUE ZERO.          
           05  FILLER                       PIC  9(04)     VALUE ZERO.          
                                                                                
31355 *01  PH2-PAGE-HEADING-2.                                                  
  |   *    05  FILLER                       PIC X(76) VALUE SPACE.              
  |   *    05  FILLER                       PIC X(09) VALUE                     
  |   *                                                  'COMBINED '.           
  |   *    05  FILLER                       PIC X(07) VALUE                     
  |   *                                                  'LEDGER '.             
  |   *    05  FILLER                       PIC X(11) VALUE                     
  |   *                                                  'REPORT FOR '.         
  |   *    05  PH2-FSCL-MN-NM               PIC X(09) VALUE SPACE.              
  |   *    05  PH2-FSCL-YR-NBR              PIC X(04) VALUE SPACE.              
  |   *    05  FILLER                       PIC X(06) VALUE ' WEEK '.           
  |   *    05  PH2-WEEK-NBR                 PIC X(01) VALUE SPACE.              
  |   *    05  FILLER                       PIC X(77) VALUE SPACE.              
  |                                                                             
  |    01  PH2-PAGE-HEADING-2.                                                  
  |        05  FILLER                    PIC X(07) VALUE SPACE.                 
  |        05  PH2-PAGE-HEADING-2B.                                             
  |           10  FILLER                 PIC X(65) VALUE SPACE.                 
  |           10  PH2-LDGR-TYPE-VERBIAGE PIC X(11) VALUE SPACE.                 
  |           10  FILLER                 PIC X(09) VALUE 'COMBINED '.           
  |           10  FILLER                 PIC X(07) VALUE 'LEDGER '.             
  |           10  FILLER                 PIC X(11) VALUE 'REPORT FOR '.         
  |           10  PH2-FSCL-MN-NM         PIC X(09) VALUE SPACE.                 
  |           10  PH2-FSCL-YR-NBR        PIC X(04) VALUE SPACE.                 
  |           10  FILLER                 PIC X(06) VALUE ' WEEK '.              
  |           10  PH2-WEEK-NBR           PIC X(01) VALUE SPACE.                 
31355                                                                           
       01  PH3-PAGE-HEADING-3.                                                  
           05  FILLER                       PIC X(88) VALUE SPACE.              
           05  FILLER                       PIC X(20) VALUE                     
                                             '(IN THOUSANDS - $000'.            
           05  FILLER                       PIC X(01) VALUE QUOTE.              
           05  FILLER                       PIC X(02) VALUE 'S)'.               
           05  FILLER                       PIC X(89) VALUE SPACE.              
                                                                                
       01  CH-COMPANY-HEADING.                                                  
           05  FILLER                       PIC X(33) VALUE                     
                                    ' COMPANY: KOHLS DEPARTMENT STORES'.        
           05  FILLER                       PIC X(167) VALUE SPACE.             
                                                                                
       01  GH-GMA-HEADING.                                                      
           05  FILLER                       PIC X(06)  VALUE '  GMM:'.          
           05  FILLER                       PIC X(02)  VALUE SPACE.             
           05  GH-GMA-NBR                   PIC X(02)  VALUE SPACE.             
           05  FILLER                       PIC X(01)  VALUE '-'.               
           05  GH-GMA-DESC-GMM-NAME         PIC X(50)  VALUE SPACE.             
           05  FILLER                       PIC X(139) VALUE SPACE.             
                                                                                
       01  DH-DMA-HEADING.                                                      
           05  FILLER                       PIC X(06)  VALUE '  DMM:'.          
           05  FILLER                       PIC X(02)  VALUE SPACE.             
           05  DH-DMA-NBR                   PIC X(02)  VALUE SPACE.             
           05  FILLER                       PIC X(01)  VALUE '-'.               
           05  DH-DMA-DESC-DMM-NAME         PIC X(50)  VALUE SPACE.             
           05  FILLER                       PIC X(139) VALUE SPACE.             
                                                                                
       01  BH-BUYER-HEADING.                                                    
           05  FILLER                       PIC X(06)  VALUE 'BUYER:'.          
           05  FILLER                       PIC X(01)  VALUE SPACE.             
           05  BH-BYR-NBR                   PIC X(03)  VALUE SPACE.             
           05  FILLER                       PIC X(01)  VALUE '-'.               
           05  BH-BYR-NAME                  PIC X(31)  VALUE SPACE.             
           05  FILLER                       PIC X(158) VALUE SPACE.             
                                                                                
       01  DH-DEPT-HEADING.                                                     
           05  FILLER                       PIC X(06)  VALUE ' DEPT:'.          
           05  FILLER                       PIC X(01)  VALUE SPACE.             
           05  DH-DEPT-NBR                  PIC 9(03)  VALUE ZERO.              
           05  FILLER                       PIC X(01)  VALUE '-'.               
           05  DH-DEPT-NAME                 PIC X(20)  VALUE SPACE.             
           05  FILLER                       PIC X(159) VALUE SPACE.             
                                                                                
       01  WH1-WEEK-HEADER-1A.                                                  
           05  FILLER                       PIC X(24) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                              '                       '.        
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE ' COMP   '.         
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  FILLER                       PIC X(23) VALUE                     
                                             '                       '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       '             '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(06) VALUE   '      '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(12) VALUE                     
                                           '            '.                      
           05  FILLER                       PIC X(16) VALUE                     
                                           '                '.                  
           05  FILLER                       PIC X(28) VALUE                     
                                         '                            '.        
           05  FILLER                       PIC X(13) VALUE                     
                                                       '            '.          
           05  FILLER                       PIC X(20) VALUE SPACES.             
                                                                                
       01  WH1-WEEK-HEADER-1B.                                                  
           05  FILLER                       PIC X(24) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                              '         SALES         '.        
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE ' SALES  '.         
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  FILLER                       PIC X(23) VALUE                     
                                             '        MARKDOWN       '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       ' END OF WEEK '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(06) VALUE   'WEEKS '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(12) VALUE                     
                                           '   RECEIPTS '.                      
           05  FILLER                       PIC X(16) VALUE                     
                                           '    PURCHASE ADJ'.                  
           05  FILLER                       PIC X(28) VALUE                     
                                         '         NET PURCHASES      '.        
           05  FILLER                       PIC X(13) VALUE                     
                                                       'OPEN ORDERS '.          
           05  FILLER                       PIC X(20) VALUE SPACES.             
                                                                                
       01  WH1-WEEK-HEADER-1C.                                                  
           05  FILLER                       PIC X(24) VALUE SPACE.              
           05  FILLER                       PIC X(23) VALUE                     
                                              '     $           %     '.        
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE ' CHANGE '.         
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  FILLER                       PIC X(23) VALUE                     
                                             '      $         % SALES'.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       '  INVENTORY  '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(06) VALUE   'SUPPLY'.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       '   RETAIL    '.         
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       '   RETAIL    '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE ' % MTH  '.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE ' MKON % '.         
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       '      $      '.         
           05  FILLER                       PIC X(20) VALUE SPACES.             
                                                                                
       01  UL1-UNDER-LINE-1.                                                    
           05  FILLER                       PIC X(24) VALUE SPACE.              
           05  FILLER                       PIC X(23) VALUE                     
                                              '-----------------------'.        
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '--------'.         
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  FILLER                       PIC X(23) VALUE                     
                                             '-----------------------'.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       '-------------'.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(06) VALUE   '------'.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(01) VALUE '-'.                
           05  FILLER                       PIC X(13) VALUE                     
                                                       '-------------'.         
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(01) VALUE '-'.                
           05  FILLER                       PIC X(13) VALUE                     
                                                       '-------------'.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '--------'.         
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '--------'.         
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                                       '-------------'.         
           05  FILLER                       PIC X(20) VALUE SPACES.             
                                                                                
       01  DWL1-DETAIL-WK-LINE-1.                                               
           05  FILLER                       PIC X(15) VALUE SPACES.             
           05  DWL1-WK-NBR-PREF             PIC X(02) VALUE 'WK'.               
           05  DWL1-WK-NBR                  PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DWL1-WK-CAT                  PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DWL1-SLS-RTL-AMT             PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DWL1-SLS-RTL-PCT             PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DWL1-SLS-RTL-PCT-C           PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(02) VALUE '  '.               
           05  DWL1-COMP-SLS-PCT            PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DWL1-COMP-SLS-PCT-C          PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  DWL1-MKDN-RTL-AMT            PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DWL1-MKDN-RTL-PCT            PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DWL1-MKDN-RTL-PCT-C          PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(04) VALUE '    '.             
           05  DWL1-EOW-INV-AMT             PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(05) VALUE SPACES.             
           05  DWL1-WEEKS-SUPPLY.                                               
               10  DWL1-WKS-SUP-GT-SYMBOL   PIC X(01).                          
               10  DWL1-WKS-SUP             PIC Z,ZZZ-.                         
           05  FILLER REDEFINES DWL1-WEEKS-SUPPLY.                              
               10  FILLER                   PIC X(02).                          
               10  DWL1-WKS-SUP-NA          PIC X(02).                          
               10  FILLER                   PIC X(03).                          
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DWL1-RCPT-RTL-AMT            PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DWL1-PADJ-RTL-AMT            PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  DWL1-NET-PURCH-PCT           PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DWL1-NET-PURCH-PCT-C         PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  DWL1-MARKON-PCT              PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DWL1-MARKON-PCT-C            PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(04) VALUE '    '.             
           05  DWL1-OPEN-ORD-AMT            PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(19) VALUE SPACES.             
                                                                                
                                                                                
       01  MH2-MN-HEADER-2A.                                                    
           05  FILLER                       PIC X(06) VALUE SPACES.             
           05  FILLER                       PIC X(55) VALUE                     
              '<------------------E.O.M. INVENTORY------------------->'.        
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(55) VALUE                     
              '<----------------------RECEIPTS----------------------->'.        
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(55) VALUE                     
              '<-----------------PURCHASE ADJUSTMENT----------------->'.        
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(26) VALUE                     
                                   '  WEEKLY INVENTORY TURN   '.                
                                                                                
       01  MH2-MN-HEADER-2B.                                                    
           05  FILLER                       PIC X(06) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '   THIS YEAR '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '  LAST YEAR  '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '  THIS YEAR  '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '  LAST YEAR  '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '  THIS YEAR  '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '  LAST YEAR  '.                  
           05  FILLER                       PIC X(24) VALUE SPACES.             
                                                                                
       01  MH2-MN-HEADER-2C.                                                    
           05  FILLER                       PIC X(07) VALUE SPACE.              
           05  FILLER                       PIC X(12) VALUE                     
                                              '   ACTUAL   '.                   
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '  FORECAST   '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '    PLAN     '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   ACTUAL    '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   ACTUAL    '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '  FORECAST   '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '    PLAN     '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   ACTUAL    '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   ACTUAL    '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '  FORECAST   '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '    PLAN     '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   ACTUAL    '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '   TY   '.         
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '   PL   '.         
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '   LY   '.         
                                                                                
       01  UL2-UNDER-LINE-2.                                                    
           05  FILLER                       PIC X(06) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '--------'.         
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '--------'.         
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE '--------'.         
                                                                                
       01  DML2-DETAIL-MN-LINE-2.                                               
           05  FILLER                       PIC X(02) VALUE SPACE.              
           05  DML2-MONTH-ABBREV            PIC X(03) VALUE SPACE.              
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  DML2-TY-EOM-ACTUAL           PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-FC-EOM                  PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-PL-EOM                  PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-LY-EOM-ACTUAL           PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-TY-RCPT-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-FC-RCPT-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-PL-RCPT-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-LY-RCPT-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-TY-PADJ-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-FC-PADJ-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-PL-PADJ-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML2-LY-PADJ-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01)  VALUE SPACES.            
           05  DML2-TY-INV-TURN-AMT         PIC ZZZZ.ZZ-                        
                                                       VALUE ZEROES.            
           05  FILLER                       PIC X(01)  VALUE SPACES.            
           05  DML2-PL-INV-TURN-AMT         PIC ZZZZ.ZZ-                        
                                                       VALUE ZEROES.            
           05  FILLER                       PIC X(01)  VALUE SPACES.            
           05  DML2-LY-INV-TURN-AMT         PIC ZZZZ.ZZ-                        
                                                       VALUE ZEROES.            
                                                                                
       01  MH3-MN-HEADER-3A.                                                    
           05  FILLER                       PIC X(75) VALUE SPACE.              
           05  FILLER                       PIC X(22) VALUE                     
                                     '              MONTHLY '.                  
           05  FILLER                       PIC X(22) VALUE                     
                                     'PERFORMANCE           '.                  
           05  FILLER                       PIC X(81) VALUE SPACES.             
                                                                                
       01  MH3-MN-HEADER-3B.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '<------------'.                  
           05  FILLER                       PIC X(03) VALUE '---'.              
           05  FILLER                       PIC X(22) VALUE                     
                                     '---------------SALES--'.                  
           05  FILLER                       PIC X(02) VALUE '--'.               
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE '--'.               
           05  FILLER                       PIC X(22) VALUE                     
                                     '--------------------->'.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '<---------------------'.                  
           05  FILLER                       PIC X(02) VALUE '--'.               
           05  FILLER                       PIC X(22) VALUE                     
                                     '-------------MARKDOWNS'.                  
           05  FILLER                       PIC X(02) VALUE '--'.               
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE '--'.               
           05  FILLER                       PIC X(22) VALUE                     
                                     '--------------------->'.                  
           05  FILLER                       PIC X(09) VALUE SPACES.             
                                                                                
       01  MH3-MN-HEADER-3C.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '       FORECAST       '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '         PLAN         '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '      LAST YEAR       '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '      THIS YEAR       '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '       FORECAST       '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '         PLAN         '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '      LAST YEAR       '.                  
           05  FILLER                       PIC X(09) VALUE SPACES.             
                                                                                
       01  MH3-MN-HEADER-3D.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '  THIS YEAR  '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(09) VALUE SPACES.             
                                                                                
       01  UL3-UNDER-LINE-3.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(09) VALUE SPACES.             
                                                                                
       01  DML3-DETAIL-MN-LINE-3.                                               
           05  FILLER                       PIC X(02) VALUE SPACE.              
           05  DML3-MONTH-ABBREV            PIC X(03) VALUE SPACE.              
           05  FILLER                       PIC X(03) VALUE SPACE.              
           05  DML3-TY-NET-SALES-AMT        PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  DML3-FC-NET-SALES-AMT        PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML3-FC-NET-SALES-PCT        PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML3-FC-NET-SALES-PCT-C      PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(02) VALUE '  '.               
           05  DML3-PL-NET-SALES-AMT        PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  DML3-PL-NET-SALES-PCT        PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML3-PL-NET-SALES-PCT-C      PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(02) VALUE '  '.               
           05  DML3-LY-NET-SALES-AMT        PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  DML3-LY-NET-SALES-PCT        PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML3-LY-NET-SALES-PCT-C      PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(03) VALUE '  '.               
           05  DML3-TY-MKDN-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML3-TY-MKDN-PCT             PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML3-TY-MKDN-PCT-C           PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(02) VALUE '  '.               
           05  DML3-FC-MKDN-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML3-FC-MKDN-PCT             PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML3-FC-MKDN-PCT-C           PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(02) VALUE '  '.               
           05  DML3-PL-MKDN-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  DML3-PL-MKDN-PCT             PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML3-PL-MKDN-PCT-C           PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(02) VALUE '  '.               
           05  DML3-LY-MKDN-RTL-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  DML3-LY-MKDN-PCT             PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML3-LY-MKDN-PCT-C           PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(09) VALUE                     
                                                 '         '.                   
       01  MH4-MN-HEADER-4A.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '<------------'.                  
           05  FILLER                       PIC X(27) VALUE                     
                                '----------E.O.M. COMP INVEN'.                  
           05  FILLER                       PIC X(23) VALUE                     
                                    'TORY------------------>'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(07) VALUE                     
                                                  '<------'.                    
           05  FILLER                       PIC X(14) VALUE                     
                                             'MARKON PERCENT'.                  
           05  FILLER                       PIC X(07) VALUE                     
                                                  '------>'.                    
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '<---------------------'.                  
           05  FILLER                       PIC X(03) VALUE '---'.              
           05  FILLER                       PIC X(23) VALUE                     
                                     '---- GROSS MARGIN -----'.                 
           05  FILLER                       PIC X(02) VALUE '--'.               
           05  FILLER                       PIC X(23) VALUE                     
                                     '--------------------->'.                  
           05  FILLER                       PIC X(3)  VALUE SPACES.             
           05  FILLER                       PIC X(19) VALUE                     
                                        '<--COST OF SALES-->'.                  
           05  FILLER                       PIC X(2)  VALUE SPACES.             
                                                                                
       01  MH4-MN-HEADER-4B.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '  THIS YEAR  '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                    '          PLAN         '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                    '       LAST YEAR       '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '        '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '        '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '        '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '      THIS YEAR       '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                     '         PLAN         '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                     '      LAST YEAR       '.                  
                                                                                
           05  FILLER                       PIC X(3)  VALUE SPACES.             
           05  FILLER                       PIC X(19) VALUE                     
                                        '     THIS YEAR     '.                  
           05  FILLER                       PIC X(2)  VALUE SPACES.             
                                                                                
       01  MH4-MN-HEADER-4C.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '      $      '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                    '      $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                    '      $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '   TY   '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '   PL   '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '   LY   '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                     '     $           %    '.                  
           05  FILLER                       PIC X(24) VALUE SPACES.             
                                                                                
       01  UL4-UNDER-LINE-4.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                    '-----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                    '-----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '--------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '--------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(08) VALUE                     
                                                   '--------'.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(23) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(4)  VALUE SPACES.             
           05  FILLER                       PIC X(19) VALUE                     
                                        '-------------------'.                  
           05  FILLER                       PIC X(2)  VALUE SPACES.             
                                                                                
       01  DML4-DETAIL-MN-LINE-4.                                               
           05  FILLER                       PIC X(02) VALUE SPACE.              
           05  DML4-MONTH-ABBREV            PIC X(03) VALUE SPACE.              
           05  FILLER                       PIC X(03) VALUE SPACE.              
           05  DML4-TY-COMP-INV-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DML4-PL-COMP-INV-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DML4-PL-COMP-INV-PCT         PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML4-PL-COMP-INV-PCT-C       PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(02) VALUE '  '.               
           05  DML4-LY-COMP-INV-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DML4-LY-COMP-INV-PCT         PIC ZZZ9.9-                         
                                                      VALUE ZEROES.             
           05  DML4-LY-COMP-INV-PCT-BLANK REDEFINES DML4-LY-COMP-INV-PCT        
                                            PIC X(7).                           
           05  DML4-LY-COMP-INV-PCT-C       PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  DML4-TY-MARKON-PCT           PIC ZZZZZ.Z-                        
                                                      VALUE ZEROES.             
           05  DML4-TY-MARKON-PCT-OVFL    REDEFINES DML4-TY-MARKON-PCT          
                                            PIC X(8).                           
           05  DML4-TY-MARKON-PCT-C         PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  DML4-PL-MARKON-PCT           PIC ZZZZZ.Z-                        
                                                      VALUE ZEROES.             
           05  DML4-PL-MARKON-PCT-OVFL    REDEFINES DML4-PL-MARKON-PCT          
                                            PIC X(8).                           
           05  DML4-PL-MARKON-PCT-C         PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  DML4-LY-MARKON-PCT           PIC ZZZZZ.Z-                        
                                                      VALUE ZEROES.             
           05  DML4-LY-MARKON-PCT-OVFL    REDEFINES DML4-LY-MARKON-PCT          
                                            PIC X(8).                           
           05  DML4-LY-MARKON-PCT-C         PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(03) VALUE '   '.              
           05  DML4-TY-GRO-MRGN-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML4-TY-GRO-MRGN-PCT         PIC ZZZ9.99-                        
                                                      VALUE ZEROES.             
           05  DML4-TY-GRO-MRGN-PCT-BLANK REDEFINES DML4-TY-GRO-MRGN-PCT        
                                            PIC X(8).                           
           05  DML4-TY-GRO-MRGN-PCT-C       PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  DML4-PL-GRO-MRGN-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML4-PL-GRO-MRGN-PCT         PIC ZZZZ.ZZ-                        
                                                      VALUE ZEROES.             
           05  DML4-PL-GRO-MRGN-PCT-C       PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(01) VALUE ' '.                
           05  DML4-LY-GRO-MRGN-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML4-LY-GRO-MRGN-PCT         PIC ZZZ9.99-                        
                                                      VALUE ZEROES.             
           05  DML4-LY-GRO-MRGN-PCT-C       PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(05) VALUE '  '.               
           05  DML4-TY-SLS-COST-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(05) VALUE SPACES.             
                                                                                
                                                                                
       01  MH5-MN-HEADER-5A.                                                    
           05  FILLER                       PIC X(34) VALUE SPACE.              
           05  FILLER                       PIC X(34) VALUE                     
                         'F U T U R E  C O M M I T M E N T S'.                  
           05  FILLER                       PIC X(66) VALUE SPACES.             
           05  FILLER                       PIC X(66) VALUE SPACES.             
                                                                                
       01  MH5-MN-HEADER-5B.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(22) VALUE                     
                                     '       ON ORDERS      '.                  
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(28) VALUE                     
                               '                    ACTUAL  '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '    TOTAL    '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(15) VALUE                     
                                             'COMMIT/FORECAST'.                 
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(77) VALUE SPACES.             
                                                                                
       01  MH5-MN-HEADER-5C.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(22) VALUE                     
                                     '      $        MKON%  '.                  
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   PAST DUE  '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   RECEIPTS  '.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '  COMMITMENT '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '   FORECAST  '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '  DIFFERENCE '.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(77) VALUE SPACES.             
                                                                                
       01  UL5-UNDER-LINE-5.                                                    
           05  FILLER                       PIC X(08) VALUE SPACE.              
           05  FILLER                       PIC X(22) VALUE                     
                                     '----------------------'.                  
           05  FILLER                       PIC X(04) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '-------------'.                  
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
                                              '             '.                  
           05  FILLER                       PIC X(77) VALUE SPACES.             
                                                                                
       01  DML5-DETAIL-MN-LINE-5.                                               
           05  FILLER                       PIC X(02) VALUE SPACE.              
           05  DML5-MONTH-ABBREV            PIC X(03) VALUE SPACE.              
           05  FILLER                       PIC X(03) VALUE SPACE.              
           05  DML5-APRVD-ORD-AMT           PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(01) VALUE SPACES.             
           05  DML5-APRVC-ORD-MKON          PIC ZZZZ.Z-                         
                                                      VALUE ZEROES.             
           05  DML5-APRVC-ORD-MKON-OVFL  REDEFINES DML5-APRVC-ORD-MKON          
                                            PIC X(07).                          
           05  DML5-APRVC-ORD-MKON-C        PIC X(01) VALUE '%'.                
           05  FILLER                       PIC X(04) VALUE '    '.             
           05  DML5-PASTDUE-AMT             PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DML5-ACTUAL-RCPT-AMT         PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(03) VALUE SPACES.             
           05  DML5-TOT-COMMIT-AMT          PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DML5-FC-ORDS-AMT             PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  DML5-TC-FC-DIFF              PIC ZZ,ZZZ,ZZZ.Z-                   
                                                      VALUE ZEROES.             
           05  FILLER                       PIC X(02) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE SPACES.             
           05  FILLER                       PIC X(77) VALUE SPACES.             
                                                                                
      ****************************************************************          
      * DATE ATTRIBUTE TABLE                                                    
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               INCLUDE TDTATTR                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  MERCHANDISE AREA TABLE (TMDSEAR)                                       
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TMDSEAR                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  APPLICATION AVAILABILITY TABLE (TAPLAVL)                               
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TAPLAVL                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  RESPONSIBILITY AREA TABLE (TRSPBAR)                           *        
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TRSPBAR                                                  
           END-EXEC.                                                            
                                                                                
                                                                                
      ******************************************************************        
      *    DB2 COMMUNICATION AREA                                               
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
      ****************************************************************          
      *  FISCAL MONTH NAME CURSOR                                               
      ****************************************************************          
                                                                                
           EXEC SQL                                                             
               DECLARE FSCL-MN-NM-CSR CURSOR FOR                                
                   SELECT DISTINCT                                              
                        FSCL_MN_NBR                                             
                       ,FSCL_MN_NM                                              
                   FROM                                                         
                        TDTATTR                                                 
                   WHERE KY_DTE BETWEEN :DTATTR-FSCL-YR-BEG-DTE                 
                                    AND :DTATTR-FSCL-YR-END-DTE                 
W26603             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
       LINKAGE SECTION.                                                         
                                                                                
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
                                                                                
       1000-MAIN-MODULE.                                                        
                                                                                
           OPEN INPUT  LEDGER-EXTRACT-WK-FILE.                                  
           OPEN INPUT  LEDGER-EXTRACT-MN-FILE.                                  
           OPEN INPUT  LEDGER-EXTRACT-EOW-FILE.                                 
           OPEN INPUT  LEDGER-EXTRACT-DATE-FILE.                                
31355      OPEN INPUT  LEDGER-HEADER-CONTROL-FILE.                              
           OPEN OUTPUT LEDGER-REPORT-FILE.                                      
                                                                                
           PERFORM 1150-INIT.                                                   
                                                                                
           PERFORM 7000-READ-LEDGER-EXTRACT-WK.                                 
           PERFORM 7050-READ-LEDGER-EXTRACT-MN.                                 
           PERFORM 7060-READ-LEDGER-EXTRACT-EOW.                                
                                                                                
           PERFORM 2000-PROCESS-EXTRACT                                         
               UNTIL (PS-END-OF-LEDGER-EXTRACT-MN                               
                 AND  PS-END-OF-LEDGER-EXTRACT-WK).                             
                                                                                
           SET PS-BREAK-IS-OPERCO TO TRUE.                                      
                                                                                
           PERFORM 2700-PROCESS-BREAKS.                                         
                                                                                
           CLOSE LEDGER-EXTRACT-WK-FILE                                         
                 LEDGER-EXTRACT-MN-FILE                                         
                 LEDGER-EXTRACT-EOW-FILE                                        
                 LEDGER-EXTRACT-DATE-FILE                                       
31355            LEDGER-HEADER-CONTROL-FILE                                     
                 LEDGER-REPORT-FILE.                                            
                                                                                
           STOP RUN.                                                            
                                                                                
                                                                                
       1150-INIT.                                                               
                                                                                
           PERFORM 7100-READ-LEDGER-EXTRACT-DATE.                               
                                                                                
           IF PS-END-OF-LEDGER-DATE-FILE                                        
               DISPLAY '** ABEND **'                                            
               DISPLAY '** PROGRAM MLKRP215 **'                                 
               DISPLAY '** PARAGRAPH 1150-INIT'                                 
               DISPLAY '** LEDGER EXTRACT DATE FILE IS EMPTY.'                  
               MOVE +4003 TO PV-ABEND-CODE                                      
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
                                                                                
           MOVE ML114-EXTRACT-MN-NBR       TO SS-OPEN-MN.                       
           MOVE ML114-EXTRACT-DTE          TO DTATTR-KY-DTE.                    
                                                                                
31355      PERFORM 8800-LDGR-HDR-CTL-FILE.                                      
  |                                                                             
  |        IF LCHF-RPT-HEADER-ID IS EQUAL TO 'V'                                
  |            MOVE 'E-COMMERCE '  TO PH2-LDGR-TYPE-VERBIAGE                    
  |        ELSE                                                                 
  |            MOVE SPACES         TO PH2-LDGR-TYPE-VERBIAGE.                   
31355                                                                           
           PERFORM 8000-GET-DATE-ATTRIBUTES.                                    
                                                                                
           MOVE DTATTR-FSCL-YR-NBR         TO PH2-FSCL-YR-NBR.                  
           MOVE DTATTR-FSCL-MN-NM          TO PH2-FSCL-MN-NM.                   
           MOVE DTATTR-WK-IN-MN-NBR        TO PH2-WEEK-NBR                      
                                              SS-OPEN-WK.                       
           MOVE DTATTR-FSCL-WK-NBR         TO SS-OPEN-FSCL-WK.                  
           MOVE TY-LAST-WK-IN-MN           TO PV-TY-LAST-WK-IN-MN               
           MOVE LY-LAST-WK-IN-MN           TO PV-LY-LAST-WK-IN-MN               
                                                                                
      *    TABLE THE FISCAL WEEK NUMBERS FOR THE LAST WEEK OF EACH              
      *    MONTH OF THIS YEAR.                                                  
                                                                                
      *    FIRST GET THE FISCAL MONTH END DATE FOR THE 1ST                      
      *    MONTH OF THE YEAR                                                    
           MOVE DTATTR-FSCL-YR-BEG-DTE     TO DTATTR-KY-DTE.                    
           PERFORM 8000-GET-DATE-ATTRIBUTES.                                    
           MOVE DTATTR-FSCL-MN-END-DTE     TO DTATTR-KY-DTE.                    
                                                                                
           MOVE 1 TO SS-MN.                                                     
                                                                                
           PERFORM UNTIL SS-MN >= PC-TWELVE                                     
               PERFORM 8010-GET-FSCL-WK-DTES                                    
                                                                                
               MOVE PV-FSCL-WK-NBR-MN1 TO  FS-FSCL-WK-NBR(SS-MN)                
               MOVE PV-FSCL-WK-NBR-MN2 TO  FS-FSCL-WK-NBR(SS-MN + 1)            
               MOVE PV-FSCL-WK-NBR-MN3 TO  FS-FSCL-WK-NBR(SS-MN + 2)            
               MOVE PV-FSCL-WK-NBR-MN4 TO  FS-FSCL-WK-NBR(SS-MN + 3)            
               MOVE DTATTR-NFM-END-DTE TO DTATTR-KY-DTE                         
               ADD PC-FOUR TO SS-MN                                             
           END-PERFORM.                                                         
                                                                                
      *    TABLE THE MONTH NAMES OF THE MONTHS IN THE OPEN FISCAL               
      *    YEAR.                                                                
                                                                                
           PERFORM 8500-OPEN-FSCL-MN-NM-CSR.                                    
                                                                                
           PERFORM 8600-FETCH-FSCL-MN-NM-CSR.                                   
                                                                                
           PERFORM UNTIL PS-END-OF-FSCL-MN-NM-CSR                               
               MOVE DTATTR-FSCL-MN-NBR TO SS-CURR-MN                            
               MOVE DTATTR-FSCL-MN-NM  TO MT-FSCL-MN-NM (SS-CURR-MN)            
               PERFORM 8600-FETCH-FSCL-MN-NM-CSR                                
           END-PERFORM.                                                         
                                                                                
           PERFORM 8700-CLOSE-FSCL-MN-NM-CSR.                                   
                                                                                
      *    BUILD STANDARD REPORT HEADING.                                       
                                                                                
           ACCEPT TD-TODAYS-DATE FROM DATE.                                     
           MOVE TD-YEAR    TO DP200O-RUN-YEAR.                                  
           MOVE TD-MONTH   TO DP200O-RUN-MONTH.                                 
           MOVE TD-DAY     TO DP200O-RUN-DAY.                                   
                                                                                
           ACCEPT TT-TODAYS-TIME FROM TIME.                                     
           MOVE TT-HOUR    TO DP200O-RUN-HOUR.                                  
           MOVE TT-MINUTE  TO DP200O-RUN-MINUTE.                                
                                                                                
           MOVE 'MLKRP215' TO DP200O-PROGRAM-NAME.                              
31355      IF LCHF-RPT-HEADER-ID IS EQUAL TO 'V'                                
31355          MOVE 2      TO DP200O-REPORT-NUMBER                              
31355      ELSE                                                                 
           MOVE 1      TO DP200O-REPORT-NUMBER.                                 
                                                                                
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-OPERCO-LVL).                 
                                                                                
           MOVE +20        TO DP024-FLNAME-LENGTH.                              
                                                                                
      *    GET THE LAST WEEK NUMBER OF THE CURRENT FISCAL MONTH                 
       2000-PROCESS-EXTRACT.                                                    
                                                                                
      ******************************************************************        
      *    PROCESS ALL GMAS IN THE COMPANY.  WHEN A NEW GMA IS                  
      *    ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS GMA.                    
      ******************************************************************        
                                                                                
           MOVE ML122-GMA-NBR TO HN-GMA-NBR.                                    
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-GMA-LVL).                    
                                                                                
           PERFORM 2100-PROCESS-GMA                                             
               UNTIL (ML122-GMA-NBR NOT = HN-GMA-NBR)                           
                  OR (PS-END-OF-LEDGER-EXTRACT-MN                               
                 AND  PS-END-OF-LEDGER-EXTRACT-WK).                             
                                                                                
           SET PS-BREAK-IS-GMA TO TRUE.                                         
                                                                                
           PERFORM 2700-PROCESS-BREAKS.                                         
                                                                                
                                                                                
       2100-PROCESS-GMA.                                                        
                                                                                
      ******************************************************************        
      *    PROCESS ALL DMAS WITHIN THIS GMA.  WHEN A NEW GMA OR DMA IS          
      *    ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS DMA.                    
      ******************************************************************        
                                                                                
           MOVE ML122-DMA-NBR   TO HN-DMA-NBR.                                  
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-DMA-LVL).                    
                                                                                
           PERFORM 2200-PROCESS-DMA                                             
               UNTIL (ML122-GMA-NBR NOT = HN-GMA-NBR)                           
                  OR (ML122-DMA-NBR NOT = HN-DMA-NBR)                           
                  OR (PS-END-OF-LEDGER-EXTRACT-MN                               
                 AND  PS-END-OF-LEDGER-EXTRACT-WK).                             
                                                                                
           SET PS-BREAK-IS-DMA TO TRUE.                                         
                                                                                
           PERFORM 2700-PROCESS-BREAKS.                                         
                                                                                
                                                                                
       2200-PROCESS-DMA.                                                        
                                                                                
      ******************************************************************        
      *    PROCESS ALL BYRS WITHIN THIS DMA.  WHEN A NEW GMA, DMA, OR           
      *    BYR IS ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS BYR.             
      ******************************************************************        
                                                                                
           MOVE ML122-BYR-NBR TO HN-BYR-NBR.                                    
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-BYR-LVL).                    
                                                                                
           PERFORM 2300-PROCESS-BYR                                             
               UNTIL (ML122-GMA-NBR NOT = HN-GMA-NBR)                           
                  OR (ML122-DMA-NBR NOT = HN-DMA-NBR)                           
                  OR (ML122-BYR-NBR NOT = HN-BYR-NBR)                           
                  OR (PS-END-OF-LEDGER-EXTRACT-MN                               
                 AND  PS-END-OF-LEDGER-EXTRACT-WK).                             
                                                                                
           SET PS-BREAK-IS-BYR TO TRUE.                                         
                                                                                
           PERFORM 2700-PROCESS-BREAKS.                                         
                                                                                
                                                                                
       2300-PROCESS-BYR.                                                        
                                                                                
      ******************************************************************        
      *    PROCESS ALL DEPTS WITHIN THIS BYR.  WHEN A NEW GMA, DMA,             
      *    BYR, OR DEPT IS ENCOUNTERED, PRINT THE INFO FOR THE                  
      *    PREVIOUS DEPT.                                                       
      ******************************************************************        
                                                                                
           MOVE ML122-DEPT-NBR TO HN-DEPT-NBR.                                  
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-DEPT-LVL).                   
                                                                                
           IF NOT (PS-END-OF-LEDGER-EXTRACT-WK AND                              
                   PS-END-OF-LEDGER-EXTRACT-MN)                                 
               PERFORM 3000-FILL-HEADINGS.                                      
                                                                                
           PERFORM 2400-PROCESS-ML-DEPT                                         
               UNTIL (ML122-GMA-NBR  NOT = HN-GMA-NBR)                          
                  OR (ML122-DMA-NBR  NOT = HN-DMA-NBR)                          
                  OR (ML122-BYR-NBR  NOT = HN-BYR-NBR)                          
                  OR (ML122-DEPT-NBR NOT = HN-DEPT-NBR)                         
                  OR (PS-END-OF-LEDGER-EXTRACT-MN                               
                 AND  PS-END-OF-LEDGER-EXTRACT-WK).                             
                                                                                
           SET PS-BREAK-IS-DEPT TO TRUE.                                        
                                                                                
           PERFORM 2700-PROCESS-BREAKS.                                         
                                                                                
                                                                                
       2400-PROCESS-ML-DEPT.                                                    
                                                                                
      ******************************************************************        
      *    PROCESS THE MERCHANDISE LEDGER RECORDS.  UPDATE THE                  
      *    APPROPRIATE BUCKETS USING THE DEPARTMENT INFORMATION.                
      *                                                                         
      *      - PROCESS THE WEEKLY RECORD                                        
      *      - PROCESS THE MONTHLY RECORD                                       
      *                                                                         
      ******************************************************************        
                                                                                
      * PROCESS THIS YEAR AND LAST YEAR WEEKLY LEDGER DATA                      
                                                                                
           PERFORM VARYING SS-CURR-WK FROM 1 BY 1                               
             UNTIL SS-CURR-WK > PV-TY-LAST-WK-IN-MN                             
                                                                                
      *        PURCHASES COST                                                   
               COMPUTE AT-WK-TY-PRCH-NET-COST-AMT                               
                                                (PC-DEPT-LVL SS-CURR-WK)        
                     = ML122-TY-RCPT-NET-COST-AMT(SS-CURR-WK)                   
                     + ML122-TY-PADJ-NET-COST-AMT(SS-CURR-WK)                   
               COMPUTE AT-WK-LY-PRCH-NET-COST-AMT                               
                                                (PC-DEPT-LVL SS-CURR-WK)        
                     = ML122-LY-RCPT-NET-COST-AMT(SS-CURR-WK)                   
                     + ML122-LY-PADJ-NET-COST-AMT(SS-CURR-WK)                   
                                                                                
      *        PURCHASES RETAIL                                                 
               COMPUTE AT-WK-TY-PRCH-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)        
                     = ML122-TY-RCPT-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-TY-PADJ-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-TY-MKUP-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-TY-XFER-IN-RTL-AMT (SS-CURR-WK)                    
                     - ML122-TY-XFER-OUT-RTL-AMT(SS-CURR-WK)                    
               COMPUTE AT-WK-LY-PRCH-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)        
                     = ML122-LY-RCPT-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-LY-PADJ-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-LY-MKUP-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-LY-XFER-IN-RTL-AMT (SS-CURR-WK)                    
                     - ML122-LY-XFER-OUT-RTL-AMT(SS-CURR-WK)                    
                                                                                
      *        WEEKLY SALES                                                     
               MOVE ML122-TY-SLS-RTL-AMT       (SS-CURR-WK)                     
                    TO AT-WK-TY-SLS-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-FC-SLS-RTL-AMT       (SS-CURR-WK)                     
                    TO AT-WK-FC-SLS-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-PL-SLS-RTL-AMT       (SS-CURR-WK)                     
                    TO AT-WK-PL-SLS-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-SLS-RTL-AMT       (SS-CURR-WK)                     
                    TO AT-WK-LY-SLS-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
      *        WEEKLY COMP STORE SALES                                          
               MOVE ML122-TY-COMP-SLS-AMT      (SS-CURR-WK)                     
                    TO AT-WK-TY-COMP-SLS-AMT   (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-COMP-SLS-AMT      (SS-CURR-WK)                     
                    TO AT-WK-LY-COMP-SLS-AMT   (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
      *        WEEKLY MARKDOWN                                                  
               MOVE ML122-TY-MKDN-RTL-AMT      (SS-CURR-WK)                     
                    TO AT-WK-TY-MKDN-RTL-AMT   (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-FC-MKDN-RTL-AMT      (SS-CURR-WK)                     
                    TO AT-WK-FC-MKDN-RTL-AMT   (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-PL-MKDN-RTL-AMT      (SS-CURR-WK)                     
                    TO AT-WK-PL-MKDN-RTL-AMT   (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-MKDN-RTL-AMT      (SS-CURR-WK)                     
                    TO AT-WK-LY-MKDN-RTL-AMT   (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
      *        WEEKLY SUPPLY                                                    
               MOVE ML122-TY-WKS-SUP-GT-SYMBOL (SS-CURR-WK)                     
                    TO AT-WK-TY-WKS-SUP-GT-SYM (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-TY-WKS-SUP-NO-PLAN   (SS-CURR-WK)                     
                    TO AT-WK-TY-WKS-SUP-NO-PLN (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-TY-WKS-SUP-AMT       (SS-CURR-WK)                     
                    TO AT-WK-TY-WKS-SUP        (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-FC-WKS-SUP-GT-SYMBOL (SS-CURR-WK)                     
                    TO AT-WK-FC-WKS-SUP-GT-SYM (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-FC-WKS-SUP-NO-PLAN   (SS-CURR-WK)                     
                    TO AT-WK-FC-WKS-SUP-NO-PLN (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-FC-WKS-SUP-AMT       (SS-CURR-WK)                     
                    TO AT-WK-FC-WKS-SUP        (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-PL-WKS-SUP-GT-SYMBOL (SS-CURR-WK)                     
                    TO AT-WK-PL-WKS-SUP-GT-SYM (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-PL-WKS-SUP-NO-PLAN   (SS-CURR-WK)                     
                    TO AT-WK-PL-WKS-SUP-NO-PLN (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-PL-WKS-SUP-AMT       (SS-CURR-WK)                     
                    TO AT-WK-PL-WKS-SUP        (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-WKS-SUP-GT-SYMBOL (SS-CURR-WK)                     
                    TO AT-WK-LY-WKS-SUP-GT-SYM (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-WKS-SUP-AMT       (SS-CURR-WK)                     
                    TO AT-WK-LY-WKS-SUP        (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
      *        END OF WEEK INVENTORY                                            
               MOVE ML122-TY-END-INV-RTL-AMT   (SS-CURR-WK)                     
                    TO AT-WK-TY-EOW-INV-AMT    (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-PL-END-INV-RTL-AMT   (SS-CURR-WK)                     
                    TO AT-WK-PL-EOW-INV-AMT    (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-END-INV-RTL-AMT   (SS-CURR-WK)                     
                    TO AT-WK-LY-EOW-INV-AMT    (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
      *        RECEIPT RETAIL AMOUNT                                            
               MOVE ML122-TY-RCPT-RTL-AMT      (SS-CURR-WK)                     
                    TO AT-WK-TY-RCPT-RTL-AMT   (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-FC-TOT-ORD-RTL-AMT   (SS-CURR-WK)                     
                    TO AT-WK-FC-TOT-ORD-RTL-AMT(PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-PL-RCPT-RTL-AMT      (SS-CURR-WK)                     
                    TO AT-WK-PL-RCPT-RTL-AMT   (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-RCPT-RTL-AMT      (SS-CURR-WK)                     
                    TO AT-WK-LY-RCPT-RTL-AMT   (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
      *        RECEIPT NET COST AMOUNT                                          
               MOVE ML122-TY-RCPT-NET-COST-AMT (SS-CURR-WK)                     
                    TO AT-WK-TY-RCPT-NET-COST-AMT                               
                                               (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-RCPT-NET-COST-AMT (SS-CURR-WK)                     
                    TO AT-WK-LY-RCPT-NET-COST-AMT                               
                                               (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
      *        PURCHASES ADJUSTED AMOUNT                                        
               COMPUTE AT-WK-TY-PADJ-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)        
                     = ML122-TY-PADJ-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-TY-MKUP-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-TY-XFER-IN-RTL-AMT (SS-CURR-WK)                    
                     - ML122-TY-XFER-OUT-RTL-AMT(SS-CURR-WK)                    
                                                                                
               COMPUTE AT-WK-LY-PADJ-RTL-AMT    (PC-DEPT-LVL SS-CURR-WK)        
                     = ML122-LY-PADJ-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-LY-MKUP-RTL-AMT    (SS-CURR-WK)                    
                     + ML122-LY-XFER-IN-RTL-AMT (SS-CURR-WK)                    
                     - ML122-LY-XFER-OUT-RTL-AMT(SS-CURR-WK)                    
                                                                                
      *        PURCHASES ADJUSTED NET COST AMOUNT                               
               MOVE ML122-TY-PADJ-NET-COST-AMT (SS-CURR-WK)                     
                    TO AT-WK-TY-PADJ-NET-COST-AMT                               
                                               (PC-DEPT-LVL SS-CURR-WK)         
               MOVE ML122-LY-PADJ-NET-COST-AMT (SS-CURR-WK)                     
                    TO AT-WK-LY-PADJ-NET-COST-AMT                               
                                               (PC-DEPT-LVL SS-CURR-WK)         
21517                                                                           
21517 *        PURCHASES ADJUSTED RETAIL AMOUNT                                 
21517          MOVE ML122-PL-PADJ-RTL-AMT (SS-CURR-WK)                          
21517               TO AT-WK-PL-PADJ-RTL-AMT (PC-DEPT-LVL SS-CURR-WK)           
                                                                                
      *        OPEN ORDERS                                                      
               MOVE ML122-TY-OPEN-ORDER-AMT    (SS-CURR-WK)                     
                    TO AT-WK-TY-OPEN-ORD-AMT   (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
           END-PERFORM.                                                         
                                                                                
           PERFORM VARYING SS-CURR-WK FROM SS-CURR-WK BY 1                      
             UNTIL SS-CURR-WK > PV-TY-LAST-WK-IN-MN                             
                                                                                
      *        OPEN ORDERS                                                      
               MOVE ML122-TY-OPEN-ORDER-AMT    (SS-CURR-WK)                     
                    TO AT-WK-TY-OPEN-ORD-AMT   (PC-DEPT-LVL SS-CURR-WK)         
                                                                                
           END-PERFORM.                                                         
                                                                                
      * PROCESS THIS YEAR & LAST YEAR MONTH BEGINNING INVENTORY AMOUNTS         
                                                                                
           MOVE ML128-TY-BEG-INV-COST-AMT                                       
                TO AT-MN-TY-BEG-INV-COST-AMT (PC-DEPT-LVL).                     
           MOVE ML128-LY-BEG-INV-COST-AMT                                       
                TO AT-MN-LY-BEG-INV-COST-AMT (PC-DEPT-LVL).                     
           MOVE ML128-TY-BEG-INV-RTL-AMT                                        
                TO AT-MN-TY-BEG-INV-RTL-AMT  (PC-DEPT-LVL).                     
           MOVE ML128-LY-BEG-INV-RTL-AMT                                        
                TO AT-MN-LY-BEG-INV-RTL-AMT  (PC-DEPT-LVL).                     
                                                                                
      * PROCESS YTD COMP DATA                                                   
                                                                                
           MOVE ML128-TY-YTD-COMP-INV-AMT                                       
                TO AT-YTD-TY-COMP-INV-AMT    (PC-DEPT-LVL).                     
           MOVE ML128-LY-YTD-COMP-INV-AMT                                       
                TO AT-YTD-LY-COMP-INV-AMT    (PC-DEPT-LVL).                     
                                                                                
      * PROCESS SEASON COMP DATA                                                
      * AND SEASON PLANNED CUMMULATIVE MARKON PERCENT                           
           MOVE 1 TO SS-SEASON.                                                 
           MOVE ML128-TY-SEAS-COMP-INV-AMT   (SS-SEASON)                        
                TO AT-SEAS-TY-COMP-INV-AMT   (PC-DEPT-LVL SS-SEASON).           
           MOVE ML128-LY-SEAS-COMP-INV-AMT   (SS-SEASON)                        
                TO AT-SEAS-LY-COMP-INV-AMT   (PC-DEPT-LVL SS-SEASON).           
           MOVE ML128-PL-BEG-INV-RTL-AMT     (SS-SEASON)                        
                TO AT-SEAS-PL-BEG-INV-RTL-AMT(PC-DEPT-LVL SS-SEASON).           
           MOVE ML128-PL-SEAS-CUM-MKUP-PCT   (SS-SEASON)                        
                TO AT-SEAS-PL-CUM-MKUP-PCT   (PC-DEPT-LVL SS-SEASON).           
                                                                                
           MOVE 2 TO SS-SEASON.                                                 
           MOVE ML128-TY-SEAS-COMP-INV-AMT   (SS-SEASON)                        
                TO AT-SEAS-TY-COMP-INV-AMT   (PC-DEPT-LVL SS-SEASON).           
           MOVE ML128-LY-SEAS-COMP-INV-AMT   (SS-SEASON)                        
                TO AT-SEAS-LY-COMP-INV-AMT   (PC-DEPT-LVL SS-SEASON).           
           MOVE ML128-PL-BEG-INV-RTL-AMT     (SS-SEASON)                        
                TO AT-SEAS-PL-BEG-INV-RTL-AMT(PC-DEPT-LVL SS-SEASON).           
           MOVE ML128-PL-SEAS-CUM-MKUP-PCT   (SS-SEASON)                        
                TO AT-SEAS-PL-CUM-MKUP-PCT   (PC-DEPT-LVL SS-SEASON).           
                                                                                
      * PROCESS THIS YEAR AND LAST YEAR MONTHLY LEDGER DATA                     
                                                                                
           PERFORM VARYING SS-CURR-MN FROM 1 BY 1                               
             UNTIL SS-CURR-MN > 12                                              
                                                                                
      *        END OF MONTH INVENTORY                                           
               MOVE ML128-TY-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-TY-EOM-ACTUAL        (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-FC-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-FC-EOM               (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-PL-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-PL-EOM               (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-LY-EOM-ACTUAL        (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        RECEIPT                                                          
               MOVE ML128-TY-RCPT-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-TY-RCPT-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-FC-RCPT-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-FC-RCPT-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-PL-RCPT-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-PL-RCPT-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-RCPT-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-LY-RCPT-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        PURCHASE ADJUSTMENTS                                             
               COMPUTE AT-TY-PADJ-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                     = ML128-TY-PADJ-RTL-AMT   (SS-CURR-MN)                     
                     + ML128-TY-MKUP-RTL-AMT   (SS-CURR-MN)                     
                     + ML128-TY-XFER-IN-RTL-AMT(SS-CURR-MN)                     
                     - ML128-TY-XFER-OUT-RTL-AMT(SS-CURR-MN)                    
                                                                                
               MOVE ML128-PL-PADJ-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-PL-PADJ-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
               COMPUTE AT-LY-PADJ-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                     = ML128-LY-PADJ-RTL-AMT   (SS-CURR-MN)                     
                     + ML128-LY-MKUP-RTL-AMT   (SS-CURR-MN)                     
                     + ML128-LY-XFER-IN-RTL-AMT(SS-CURR-MN)                     
                     - ML128-LY-XFER-OUT-RTL-AMT(SS-CURR-MN)                    
                                                                                
      *        NET SALES                                                        
               MOVE ML128-TY-SLS-RTL-AMT       (SS-CURR-MN)                     
                    TO AT-TY-NET-SALES-AMT     (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-PL-SLS-RTL-AMT       (SS-CURR-MN)                     
                    TO AT-PL-NET-SALES-AMT     (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-FC-SLS-RTL-AMT       (SS-CURR-MN)                     
                    TO AT-FC-NET-SALES-AMT     (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-SLS-RTL-AMT       (SS-CURR-MN)                     
                    TO AT-LY-NET-SALES-AMT     (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        MARKDOWNS                                                        
               MOVE ML128-TY-MKDN-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-TY-MKDN-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-FC-MKDN-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-FC-MKDN-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-PL-MKDN-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-PL-MKDN-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-MKDN-RTL-AMT      (SS-CURR-MN)                     
                    TO AT-LY-MKDN-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        COMP STORE INVENTORY                                             
               MOVE ML128-TY-COMP-INV-AMT      (SS-CURR-MN)                     
                    TO AT-TY-COMP-INV-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-COMP-INV-AMT      (SS-CURR-MN)                     
                    TO AT-LY-COMP-INV-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        MARKON PERCENT                                                   
               MOVE ML128-PL-MKUP-RTL-PCT      (SS-CURR-MN)                     
                    TO AT-PL-MKUP-RTL-PCT      (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        PURCHASES COST                                                   
               COMPUTE AT-TY-PRCH-NET-COST-AMT (PC-DEPT-LVL SS-CURR-MN)         
                     = ML128-TY-RCPT-NET-COST-AMT(SS-CURR-MN)                   
                     + ML128-TY-PADJ-NET-COST-AMT(SS-CURR-MN)                   
               COMPUTE AT-LY-PRCH-NET-COST-AMT (PC-DEPT-LVL SS-CURR-MN)         
                     = ML128-LY-RCPT-NET-COST-AMT(SS-CURR-MN)                   
                     + ML128-LY-PADJ-NET-COST-AMT(SS-CURR-MN)                   
                                                                                
      *        PURCHASES RETAIL                                                 
               COMPUTE AT-TY-PRCH-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                     = ML128-TY-RCPT-RTL-AMT      (SS-CURR-MN)                  
                     + ML128-TY-PADJ-RTL-AMT      (SS-CURR-MN)                  
                     + ML128-TY-MKUP-RTL-AMT      (SS-CURR-MN)                  
                     + ML128-TY-XFER-IN-RTL-AMT   (SS-CURR-MN)                  
                     - ML128-TY-XFER-OUT-RTL-AMT  (SS-CURR-MN)                  
               COMPUTE AT-LY-PRCH-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                     = ML128-LY-RCPT-RTL-AMT      (SS-CURR-MN)                  
                     + ML128-LY-PADJ-RTL-AMT      (SS-CURR-MN)                  
                     + ML128-LY-MKUP-RTL-AMT      (SS-CURR-MN)                  
                     + ML128-LY-XFER-IN-RTL-AMT   (SS-CURR-MN)                  
                     - ML128-LY-XFER-OUT-RTL-AMT  (SS-CURR-MN)                  
                                                                                
      *        GROSS MARGIN                                                     
               MOVE ML128-TY-GRO-MRGN-AMT      (SS-CURR-MN)                     
                    TO AT-TY-GRO-MRGN-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-PL-GRO-MRGN-AMT      (SS-CURR-MN)                     
                    TO AT-PL-GRO-MRGN-AMT      (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-GRO-MRGN-AMT      (SS-CURR-MN)                     
                    TO AT-LY-GRO-MRGN-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        COST OF SALES                                                    
               MOVE ML128-TY-SLS-COST-AMT      (SS-CURR-MN)                     
                    TO AT-TY-SLS-COST-AMT      (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        ENDING INVENTORY RETAIL AMOUNT                                   
               MOVE ML128-TY-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-TY-END-INV-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-FC-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-FC-END-INV-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-PL-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-PL-END-INV-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-END-INV-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-LY-END-INV-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        ENDING INVENTORY COST AMOUNT                                     
               MOVE ML128-TY-END-INV-COST-AMT  (SS-CURR-MN)                     
                    TO AT-TY-END-INV-COST-AMT  (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-LY-END-INV-COST-AMT  (SS-CURR-MN)                     
                    TO AT-LY-END-INV-COST-AMT  (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
      *        FORCAST RECEIPT AMOUNT                                           
               MOVE ML128-FC-TOT-ORD-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-FC-TOT-ORD-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
               MOVE ML128-FC-ONORD-RTL-AMT     (SS-CURR-MN)                     
                    TO AT-FC-ONORD-EXT-RTL-AMT (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-FC-ONORD-CST-AMT     (SS-CURR-MN)                     
                    TO AT-FC-ONORD-EXT-CST-AMT (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-FC-PASTDUE-RTL-AMT   (SS-CURR-MN)                     
                    TO AT-FC-PASTDUE-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)         
               MOVE ML128-PL-COMP-SLS-RTL-AMT  (SS-CURR-MN)                     
                    TO AT-PL-COMP-SLS-RTL-AMT  (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
21517 *        COMP STORE INVENTORY                                             
21517          MOVE ML128-PL-CMPR-END-INV-AMT  (SS-CURR-MN)                     
21517               TO AT-PL-CMPR-END-INV-AMT  (PC-DEPT-LVL SS-CURR-MN)         
                                                                                
           END-PERFORM.                                                         
                                                                                
           MOVE SS-OPEN-MN TO SS-CURR-MN.                                       
           ADD 1           TO SS-CURR-MN.                                       
           PERFORM VARYING SS-CURR-MN FROM SS-CURR-MN BY 1                      
             UNTIL SS-CURR-MN > PC-MAX-MN                                       
                                                                                
      *        FUTURE COMMITMENT FIELDS                                         
               MOVE ML128-FC-ONORD-RTL-AMT     (SS-CURR-MN)                     
                 TO AT-FC-ONORD-EXT-RTL-AMT (PC-DEPT-LVL SS-CURR-MN)            
               MOVE ML128-FC-ONORD-CST-AMT     (SS-CURR-MN)                     
                 TO AT-FC-ONORD-EXT-CST-AMT (PC-DEPT-LVL SS-CURR-MN)            
               MOVE ML128-FC-APP-ORD-RTL-AMT   (SS-CURR-MN)                     
                 TO AT-FC-APP-ORD-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)            
               MOVE ML128-FC-PASTDUE-RTL-AMT   (SS-CURR-MN)                     
                 TO AT-FC-PASTDUE-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)            
               MOVE ML128-FC-RCPT-RTL-AMT      (SS-CURR-MN)                     
                 TO AT-FC-RCPT-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)            
               MOVE ML128-FC-TOT-ORD-RTL-AMT   (SS-CURR-MN)                     
                 TO AT-FC-TOT-ORD-RTL-AMT   (PC-DEPT-LVL SS-CURR-MN)            
               MOVE ML128-PL-RCPT-RTL-AMT      (SS-CURR-MN)                     
                 TO AT-PL-RCPT-RTL-AMT      (PC-DEPT-LVL SS-CURR-MN)            
                                                                                
           END-PERFORM.                                                         
                                                                                
           MOVE PC-ONE     TO SS-CURR-WK.                                       
           PERFORM VARYING SS-CURR-WK FROM SS-CURR-WK BY 1                      
             UNTIL SS-CURR-WK > SS-OPEN-FSCL-WK                                 
                                                                                
      *        EOW ENDING INVENTORY FIELDS FOR INVENTORY TURN                   
               MOVE ML140-TY-END-INV-RTL-AMT   (SS-CURR-WK)                     
                 TO AT-TY-EOW-ACTUAL        (PC-DEPT-LVL SS-CURR-WK)            
                                                                                
           END-PERFORM.                                                         
                                                                                
           MOVE PC-ONE     TO SS-CURR-WK                                        
           PERFORM VARYING SS-CURR-WK FROM SS-CURR-WK BY 1                      
             UNTIL SS-CURR-WK > PC-MAX-WK                                       
                                                                                
      *        EOW ENDING INVENTORY FIELDS FOR INVENTORY TURN                   
               MOVE ML140-LY-END-INV-RTL-AMT   (SS-CURR-WK)                     
                 TO AT-LY-EOW-ACTUAL        (PC-DEPT-LVL SS-CURR-WK)            
               MOVE ML140-PL-END-INV-RTL-AMT   (SS-CURR-WK)                     
                 TO AT-PL-EOW               (PC-DEPT-LVL SS-CURR-WK)            
                                                                                
           END-PERFORM.                                                         
                                                                                
           PERFORM 3200-ADD-TO-DEPT-SEASON-TOTS.                                
                                                                                
           PERFORM 7000-READ-LEDGER-EXTRACT-WK.                                 
           PERFORM 7050-READ-LEDGER-EXTRACT-MN.                                 
           PERFORM 7060-READ-LEDGER-EXTRACT-EOW.                                
                                                                                
                                                                                
       2700-PROCESS-BREAKS.                                                     
                                                                                
      ******************************************************************        
      *    - CREATE A BREAK ACCORDING TO THE BUSINESS LEVEL                     
      *    - PRINT PAGE 1 HEADINGS ALONG WITH WEEKLY DETAIL, MTD, AND           
      *      PART OF MONTHLY DATA                                               
      *    - PRINT PAGE 2 HEADINGS ALONG WITH REMAINING MONTH DATA              
      *                                                                         
      ******************************************************************        
                                                                                
           INITIALIZE MTD-WK-TOTALS.                                            
           INITIALIZE YTD-YEAR-TO-DATE-TOTALS.                                  
                                                                                
      *    DETERMINE WHICH BUSINES LEVEL THE BREAK IS OCCURRING ON AND          
      *    SET THE LEVEL SUBSCRIPT ACCORDINGLY.                                 
                                                                                
           EVALUATE  TRUE                                                       
               WHEN PS-BREAK-IS-DEPT                                            
                   MOVE PC-DEPT-LVL   TO SS-CURR-LVL                            
               WHEN PS-BREAK-IS-BYR                                             
                   MOVE PC-BYR-LVL    TO SS-CURR-LVL                            
               WHEN PS-BREAK-IS-DMA                                             
                   MOVE PC-DMA-LVL    TO SS-CURR-LVL                            
               WHEN PS-BREAK-IS-GMA                                             
                   MOVE PC-GMA-LVL    TO SS-CURR-LVL                            
               WHEN PS-BREAK-IS-OPERCO                                          
                   MOVE PC-OPERCO-LVL TO SS-CURR-LVL                            
           END-EVALUATE.                                                        
                                                                                
      *    PRINT PAGE ONE HEADINGS AND WEEK HEADINGS                            
                                                                                
           PERFORM 7200-PRINT-PAGE-HEADINGS.                                    
           PERFORM 7300-PRINT-TOTAL-HEADING.                                    
           PERFORM 7400-PRINT-WEEK-HEADINGS.                                    
                                                                                
      *    PROCESS AND PRINT WEEKLY DETAIL                                      
           PERFORM 4000-PROCESS-WEEK-DET-LINES                                  
               VARYING SS-CURR-WK FROM 1 BY 1                                   
               UNTIL   SS-CURR-WK > 5.                                          
                                                                                
      *    PROCESS AND PRINT WEEKLY MONTH TO DATE                               
           PERFORM 4100-PROCESS-MTD-TOTALS                                      
                                                                                
      *    PROCESS MONTHLY DATA SECTION 1 ON PAGE 1                             
                                                                                
           PERFORM 7500-PRINT-MONTH-HEADINGS-SET1.                              
                                                                                
           MOVE AT-MN-TY-BEG-INV-COST-AMT (SS-CURR-LVL)                         
                                            TO PV-TY-BEG-INV-COST-AMT.          
           MOVE AT-MN-TY-BEG-INV-RTL-AMT (SS-CURR-LVL)                          
                                            TO PV-TY-BEG-INV-RTL-AMT.           
           MOVE AT-MN-LY-BEG-INV-COST-AMT (SS-CURR-LVL)                         
                                            TO PV-LY-BEG-INV-COST-AMT.          
           MOVE AT-MN-LY-BEG-INV-RTL-AMT (SS-CURR-LVL)                          
                                            TO PV-LY-BEG-INV-RTL-AMT.           
                                                                                
           PERFORM 4200-PROCESS-MONTH-S1-DET-LINE                               
               VARYING SS-CURR-MN FROM 1 BY 1                                   
               UNTIL   SS-CURR-MN > SS-OPEN-MN.                                 
                                                                                
      *    PRINT DATA FOR MONTHS GREATER THAN OPEN MONTH                        
                                                                                
           MOVE SS-OPEN-MN      TO SS-CURR-MN.                                  
           ADD  1               TO SS-CURR-MN.                                  
           MOVE 'Y'             TO PS-FUTURE-SW.                                
           PERFORM 4200-PROCESS-MONTH-S1-DET-LINE                               
               VARYING SS-CURR-MN FROM SS-CURR-MN BY 1                          
               UNTIL   SS-CURR-MN > PC-MAX-MN.                                  
           MOVE 'N'             TO PS-FUTURE-SW.                                
                                                                                
      *    PRINT THE YEAR-TO-DATE TOTALS SECTION 1                              
                                                                                
           PERFORM 4300-PROCESS-YTD-S1-TOTAL-LINE.                              
                                                                                
      *    PROCESS MONTHLY DATA SECTION 2 ON PAGE 2                             
                                                                                
           PERFORM 7200-PRINT-PAGE-HEADINGS.                                    
           PERFORM 7300-PRINT-TOTAL-HEADING.                                    
                                                                                
           PERFORM 7510-PRINT-MONTH-HEADINGS-SET2.                              
                                                                                
           PERFORM 4400-PROCESS-MONTH-S2-DET-LINE                               
               VARYING SS-CURR-MN FROM 1 BY 1                                   
               UNTIL   SS-CURR-MN > SS-OPEN-MN.                                 
                                                                                
      *    PRINT DATA FOR MONTHS GREATER THAN OPEN MONTH                        
                                                                                
           MOVE SS-OPEN-MN      TO SS-CURR-MN.                                  
           ADD  1               TO SS-CURR-MN.                                  
           MOVE 'Y'             TO PS-FUTURE-SW.                                
           PERFORM 4400-PROCESS-MONTH-S2-DET-LINE                               
               VARYING SS-CURR-MN FROM SS-CURR-MN BY 1                          
               UNTIL   SS-CURR-MN > PC-MAX-MN.                                  
      *    PERFORM 7900-PRINT-BLANK-LINE.                                       
           MOVE 'N'             TO PS-FUTURE-SW.                                
                                                                                
      *    PRINT THE YEAR-TO-DATE TOTALS SECTION 2                              
                                                                                
           PERFORM 4500-PROCESS-YTD-S2-TOTAL-LINE.                              
                                                                                
      *    PROCESS MONTHLY DATA SECTION 3 ON PAGE 2                             
                                                                                
           PERFORM 7520-PRINT-MONTH-HEADINGS-SET3.                              
                                                                                
           PERFORM 4600-PROCESS-MONTH-S3-DET-LINE                               
               VARYING SS-CURR-MN FROM 1 BY 1                                   
               UNTIL   SS-CURR-MN > SS-OPEN-MN.                                 
                                                                                
      *    PRINT DATA FOR MONTHS GREATER THAN OPEN MONTH                        
                                                                                
           MOVE SS-OPEN-MN      TO SS-CURR-MN.                                  
           ADD  1               TO SS-CURR-MN.                                  
           MOVE 'Y'             TO PS-FUTURE-SW.                                
           PERFORM 4600-PROCESS-MONTH-S3-DET-LINE                               
               VARYING SS-CURR-MN FROM SS-CURR-MN BY 1                          
               UNTIL   SS-CURR-MN > PC-MAX-MN.                                  
      *    PERFORM 7900-PRINT-BLANK-LINE.                                       
           MOVE 'N'             TO PS-FUTURE-SW.                                
                                                                                
      *    PRINT THE YEAR-TO-DATE TOTALS SECTION 3                              
                                                                                
           PERFORM 4700-PROCESS-YTD-S3-TOTAL-LINE.                              
                                                                                
      *    PROCESS MONTHLY DATA SECTION 4 FOR FUTURE COMMITMENT SECTION         
                                                                                
           PERFORM 7530-PRINT-MONTH-HEADINGS-SET4.                              
      *    PRINT CURRENT MONTH THROUGH END OF YEAR                              
           PERFORM 4800-PROCESS-MONTH-S4-DET-LINE                               
               VARYING SS-CURR-MN FROM SS-OPEN-MN BY 1                          
               UNTIL SS-CURR-MN > PC-MAX-MN.                                    
                                                                                
           IF PS-BREAK-IS-OPERCO                                                
               NEXT SENTENCE                                                    
           ELSE                                                                 
               PERFORM 3100-ADD-TO-NEXT-HIGHER-LEVEL                            
           END-IF.                                                              
                                                                                
           SET PS-BREAK-LEVEL-SW-INIT TO TRUE.                                  
                                                                                
       3000-FILL-HEADINGS.                                                      
                                                                                
      ******************************************************************        
      *    FILL IN THE SUB HEADING INFORMATION.                                 
      ******************************************************************        
                                                                                
      *    GET GMM NAME                                                         
           MOVE ML122-GMA-NBR           TO PV-GMA-NBR.                          
           PERFORM 8100-GET-GMM-NAME.                                           
           MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME.                         
           MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME.                         
           PERFORM DP024-0000-FORMAT-NAME.                                      
                                                                                
      *    PUT PARENTHESES AROUND GMM NAME                                      
           MOVE SPACES                  TO PV-ENTIRE-NAME                       
                                           PV-NAME-PAREN-2                      
                                           PV-NAME.                             
           MOVE DP024-FLNAME            TO PV-ENTIRE-NAME.                      
           INSPECT PV-NAME-WITH-PARENS REPLACING                                
               FIRST PC-2-SPACES-LIT                                            
                  BY PC-PAREN-SPACE-LIT.                                        
           MOVE PV-NAME-WITH-PARENS     TO PV-NAME.                             
                                                                                
      *    GET GMA DESCRIPTION                                                  
           MOVE '??'                    TO PV-DMA-NBR                           
                                           PV-BYR-NBR.                          
           MOVE PC-DEPT-NBR-000         TO PV-DEPT-NBR.                         
           MOVE PC-MDSELV-GMA           TO PV-MDSELV-CDE.                       
           PERFORM 8400-GET-MDSEAR-DESC.                                        
                                                                                
      *    BUILD GMA HEADING LINE                                               
           MOVE ML122-GMA-NBR           TO GH-GMA-NBR.                          
           MOVE SPACES                  TO GH-GMA-DESC-GMM-NAME.                
           MOVE MDSEAR-DESC             TO PV-DESC.                             
           STRING PV-DESC  PV-NAME                                              
               DELIMITED BY PC-2-SPACES-LIT                                     
                                      INTO GH-GMA-DESC-GMM-NAME.                
                                                                                
      *    GET DMM NAME                                                         
           MOVE ML122-DMA-NBR           TO PV-DMA-NBR.                          
           PERFORM 8200-GET-DMM-NAME.                                           
           MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME.                         
           MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME.                         
           PERFORM DP024-0000-FORMAT-NAME.                                      
                                                                                
      *    PUT PARENTHESES AROUND DMM NAME                                      
           MOVE SPACES                  TO PV-ENTIRE-NAME                       
                                           PV-NAME-PAREN-2                      
                                           PV-NAME.                             
           MOVE DP024-FLNAME            TO PV-ENTIRE-NAME.                      
           INSPECT PV-NAME-WITH-PARENS REPLACING                                
               FIRST PC-2-SPACES-LIT   BY                                       
                     PC-PAREN-SPACE-LIT.                                        
           MOVE PV-NAME-WITH-PARENS     TO PV-NAME.                             
                                                                                
      *    GET DMA DESCRIPTION                                                  
           MOVE '??'                    TO  PV-GMA-NBR                          
                                            PV-BYR-NBR.                         
           MOVE PC-DEPT-NBR-000         TO  PV-DEPT-NBR.                        
           MOVE PC-MDSELV-DMA           TO  PV-MDSELV-CDE.                      
           PERFORM 8400-GET-MDSEAR-DESC.                                        
                                                                                
      *    BUILD DMA HEADING LINE                                               
           MOVE ML122-DMA-NBR           TO DH-DMA-NBR.                          
           MOVE SPACES                  TO DH-DMA-DESC-DMM-NAME.                
           MOVE MDSEAR-DESC             TO PV-DESC.                             
           STRING PV-DESC  PV-NAME                                              
           DELIMITED BY PC-2-SPACES-LIT                                         
                                      INTO DH-DMA-DESC-DMM-NAME.                
                                                                                
      *    GET BUYER NAME                                                       
           MOVE ML122-BYR-NBR           TO PV-BYR-NBR.                          
           MOVE ML122-DEPT-NBR          TO PV-DEPT-NBR.                         
           PERFORM 8300-GET-BYR-NAME.                                           
           MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME.                         
           MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME.                         
           PERFORM DP024-0000-FORMAT-NAME.                                      
                                                                                
      *    BUILD BUYER HEADING LINE                                             
           MOVE ML122-BYR-NBR           TO BH-BYR-NBR.                          
           MOVE DP024-FLNAME            TO BH-BYR-NAME.                         
                                                                                
      *    GET DEPT DESCRIPTION                                                 
           MOVE '??'                    TO PV-GMA-NBR                           
                                           PV-DMA-NBR.                          
           MOVE ML122-DEPT-NBR          TO PV-DEPT-NBR.                         
           MOVE PC-MDSELV-DPT           TO PV-MDSELV-CDE.                       
           PERFORM 8400-GET-MDSEAR-DESC.                                        
                                                                                
      *    BUILD DEPT HEADING LINE                                              
           MOVE ML122-DEPT-NBR          TO DH-DEPT-NBR.                         
           MOVE MDSEAR-DESC             TO DH-DEPT-NAME.                        
                                                                                
       3100-ADD-TO-NEXT-HIGHER-LEVEL.                                           
                                                                                
      ******************************************************************        
      * ADD THE BEGINNING INVENTORY, MONTHLY, AND SEASON TOTALS                 
      * FOR THE CURRENT LEVEL TO THE NEXT HIGHER LEVEL.                         
      ******************************************************************        
                                                                                
           ADD 1 SS-CURR-LVL GIVING SS-NEXT-LVL.                                
                                                                                
           ADD AT-MN-TY-BEG-INV-COST-AMT  (SS-CURR-LVL) TO                      
               AT-MN-TY-BEG-INV-COST-AMT  (SS-NEXT-LVL).                        
           ADD AT-MN-TY-BEG-INV-RTL-AMT   (SS-CURR-LVL) TO                      
               AT-MN-TY-BEG-INV-RTL-AMT   (SS-NEXT-LVL).                        
           ADD AT-MN-LY-BEG-INV-COST-AMT  (SS-CURR-LVL) TO                      
               AT-MN-LY-BEG-INV-COST-AMT  (SS-NEXT-LVL).                        
           ADD AT-MN-LY-BEG-INV-RTL-AMT   (SS-CURR-LVL) TO                      
               AT-MN-LY-BEG-INV-RTL-AMT   (SS-NEXT-LVL).                        
           ADD AT-YTD-TY-COMP-INV-AMT     (SS-CURR-LVL) TO                      
               AT-YTD-TY-COMP-INV-AMT     (SS-NEXT-LVL).                        
           ADD AT-YTD-LY-COMP-INV-AMT     (SS-CURR-LVL) TO                      
               AT-YTD-LY-COMP-INV-AMT     (SS-NEXT-LVL).                        
                                                                                
           PERFORM VARYING SS-CURR-WK FROM 1 BY 1                               
             UNTIL SS-CURR-WK > PV-TY-LAST-WK-IN-MN                             
               ADD AT-WK-TY-PRCH-NET-COST-AMT (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-PRCH-NET-COST-AMT (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-PRCH-NET-COST-AMT (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-PRCH-NET-COST-AMT (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-PRCH-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-PRCH-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-PRCH-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-PRCH-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-SLS-RTL-AMT       (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-SLS-RTL-AMT       (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-FC-SLS-RTL-AMT       (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-FC-SLS-RTL-AMT       (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-PL-SLS-RTL-AMT       (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-PL-SLS-RTL-AMT       (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-SLS-RTL-AMT       (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-SLS-RTL-AMT       (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-COMP-SLS-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-COMP-SLS-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-COMP-SLS-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-COMP-SLS-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-MKDN-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-MKDN-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-FC-MKDN-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-FC-MKDN-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-PL-MKDN-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-PL-MKDN-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-MKDN-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-MKDN-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-EOW-INV-AMT       (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-EOW-INV-AMT       (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-PL-EOW-INV-AMT       (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-PL-EOW-INV-AMT       (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-EOW-INV-AMT       (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-EOW-INV-AMT       (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-OPEN-ORD-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-OPEN-ORD-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-OPEN-ORD-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-OPEN-ORD-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-RCPT-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-RCPT-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-FC-TOT-ORD-RTL-AMT   (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-FC-TOT-ORD-RTL-AMT   (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-PL-RCPT-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-PL-RCPT-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-RCPT-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-RCPT-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-TY-PADJ-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-PADJ-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-WK-LY-PADJ-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-LY-PADJ-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
21517          ADD AT-WK-PL-PADJ-RTL-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
21517              AT-WK-PL-PADJ-RTL-AMT      (SS-NEXT-LVL SS-CURR-WK)          
           END-PERFORM.                                                         
                                                                                
           PERFORM VARYING SS-CURR-WK FROM SS-CURR-WK BY 1                      
             UNTIL SS-CURR-WK > 5                                               
               ADD AT-WK-TY-OPEN-ORD-AMT      (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-WK-TY-OPEN-ORD-AMT      (SS-NEXT-LVL SS-CURR-WK)          
           END-PERFORM.                                                         
                                                                                
           PERFORM VARYING SS-CURR-WK FROM 1 BY 1                               
             UNTIL SS-CURR-WK > SS-OPEN-FSCL-WK                                 
               ADD AT-TY-EOW-ACTUAL           (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-TY-EOW-ACTUAL           (SS-NEXT-LVL SS-CURR-WK)          
           END-PERFORM.                                                         
                                                                                
           PERFORM VARYING SS-CURR-WK FROM 1 BY 1                               
             UNTIL SS-CURR-WK > PC-MAX-WK                                       
               ADD AT-LY-EOW-ACTUAL           (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-LY-EOW-ACTUAL           (SS-NEXT-LVL SS-CURR-WK)          
               ADD AT-PL-EOW                  (SS-CURR-LVL SS-CURR-WK)TO        
                   AT-PL-EOW                  (SS-NEXT-LVL SS-CURR-WK)          
           END-PERFORM.                                                         
                                                                                
           PERFORM VARYING SS-CURR-MN FROM 1 BY 1                               
             UNTIL SS-CURR-MN > SS-OPEN-MN                                      
               ADD AT-TY-EOM-ACTUAL           (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-EOM-ACTUAL           (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-EOM                  (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-EOM                  (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-EOM                  (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-EOM                  (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-EOM-ACTUAL           (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-EOM-ACTUAL           (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-RCPT-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-RCPT-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-RCPT-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-RCPT-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-RCPT-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-RCPT-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-RCPT-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-RCPT-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-PADJ-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-PADJ-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-PADJ-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-PADJ-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-PADJ-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-PADJ-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-NET-SALES-AMT        (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-NET-SALES-AMT        (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-NET-SALES-AMT        (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-NET-SALES-AMT        (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-NET-SALES-AMT        (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-NET-SALES-AMT        (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-NET-SALES-AMT        (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-NET-SALES-AMT        (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-MKDN-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-MKDN-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-MKDN-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-MKDN-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-MKDN-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-MKDN-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-MKDN-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-MKDN-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-COMP-INV-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-COMP-INV-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-COMP-INV-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-COMP-INV-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-PRCH-NET-COST-AMT    (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-PRCH-NET-COST-AMT    (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-PRCH-NET-COST-AMT    (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-PRCH-NET-COST-AMT    (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-PRCH-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-PRCH-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-PRCH-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-PRCH-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-GRO-MRGN-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-GRO-MRGN-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-GRO-MRGN-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-GRO-MRGN-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-GRO-MRGN-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-GRO-MRGN-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-SLS-COST-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-SLS-COST-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-END-INV-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-END-INV-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-END-INV-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-END-INV-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-END-INV-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-END-INV-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-END-INV-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-END-INV-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-TY-END-INV-COST-AMT     (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-TY-END-INV-COST-AMT     (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-END-INV-COST-AMT     (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-END-INV-COST-AMT     (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-TOT-ORD-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-TOT-ORD-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-ONORD-EXT-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-ONORD-EXT-RTL-AMT    (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-ONORD-EXT-CST-AMT    (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-ONORD-EXT-CST-AMT    (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-APP-ORD-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-APP-ORD-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-PASTDUE-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-PASTDUE-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-COMP-SLS-RTL-AMT     (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-COMP-SLS-RTL-AMT     (SS-NEXT-LVL SS-CURR-MN)          
21517          ADD AT-PL-CMPR-END-INV-AMT     (SS-CURR-LVL SS-CURR-MN)TO        
21517              AT-PL-CMPR-END-INV-AMT     (SS-NEXT-LVL SS-CURR-MN)          
           END-PERFORM.                                                         
                                                                                
           MOVE SS-OPEN-MN            TO SS-CURR-MN                             
           ADD  1                     TO SS-CURR-MN                             
           PERFORM VARYING SS-CURR-MN FROM SS-CURR-MN BY 1                      
             UNTIL SS-CURR-MN > PC-MAX-MN                                       
               ADD AT-FC-EOM                  (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-EOM                  (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-EOM                  (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-EOM                  (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-EOM-ACTUAL           (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-EOM-ACTUAL           (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-RCPT-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-RCPT-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-RCPT-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-RCPT-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-RCPT-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-RCPT-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-PADJ-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-PADJ-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-PADJ-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-PADJ-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-NET-SALES-AMT        (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-NET-SALES-AMT        (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-NET-SALES-AMT        (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-NET-SALES-AMT        (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-NET-SALES-AMT        (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-NET-SALES-AMT        (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-MKDN-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-MKDN-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-MKDN-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-MKDN-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-MKDN-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-MKDN-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-COMP-INV-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-COMP-INV-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-PRCH-NET-COST-AMT    (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-PRCH-NET-COST-AMT    (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-PRCH-RTL-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-PRCH-RTL-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-GRO-MRGN-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-GRO-MRGN-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-GRO-MRGN-AMT         (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-GRO-MRGN-AMT         (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-END-INV-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-END-INV-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-PL-END-INV-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-PL-END-INV-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-END-INV-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-END-INV-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-LY-END-INV-COST-AMT     (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-LY-END-INV-COST-AMT     (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-TOT-ORD-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-TOT-ORD-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-ONORD-EXT-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-ONORD-EXT-RTL-AMT    (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-ONORD-EXT-CST-AMT    (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-ONORD-EXT-CST-AMT    (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-APP-ORD-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-APP-ORD-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
               ADD AT-FC-PASTDUE-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)TO        
                   AT-FC-PASTDUE-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)          
21517?         ADD AT-PL-CMPR-END-INV-AMT     (SS-CURR-LVL SS-CURR-MN)TO        
21517?             AT-PL-CMPR-END-INV-AMT     (SS-NEXT-LVL SS-CURR-MN)          
           END-PERFORM.                                                         
                                                                                
           PERFORM VARYING SS-SEASON FROM 1 BY 1                                
             UNTIL SS-SEASON > 2                                                
               ADD AT-SEAS-TY-RCPT-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-RCPT-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-FC-RCPT-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-FC-RCPT-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-PL-RCPT-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-PL-RCPT-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-LY-RCPT-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-LY-RCPT-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-TY-PADJ-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-PADJ-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-PL-PADJ-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-PL-PADJ-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-LY-PADJ-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-LY-PADJ-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-TY-NET-SALES-AMT   (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-NET-SALES-AMT   (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-FC-NET-SALES-AMT   (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-FC-NET-SALES-AMT   (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-PL-NET-SALES-AMT   (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-PL-NET-SALES-AMT   (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-LY-NET-SALES-AMT   (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-LY-NET-SALES-AMT   (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-TY-MKDN-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-MKDN-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-FC-MKDN-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-FC-MKDN-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-PL-MKDN-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-PL-MKDN-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-LY-MKDN-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-LY-MKDN-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-TY-COMP-INV-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-COMP-INV-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-PL-COMP-INV-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-PL-COMP-INV-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-LY-COMP-INV-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-LY-COMP-INV-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-TY-PRCH-NET-COST-AMT(SS-CURR-LVL SS-SEASON)TO        
                   AT-SEAS-TY-PRCH-NET-COST-AMT(SS-NEXT-LVL SS-SEASON)          
               ADD AT-SEAS-TY-PRCH-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-PRCH-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-LY-PRCH-NET-COST-AMT(SS-CURR-LVL SS-SEASON)TO        
                   AT-SEAS-LY-PRCH-NET-COST-AMT(SS-NEXT-LVL SS-SEASON)          
               ADD AT-SEAS-LY-PRCH-RTL-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-LY-PRCH-RTL-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-TY-GRO-MRGN-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-GRO-MRGN-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-PL-GRO-MRGN-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-PL-GRO-MRGN-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-LY-GRO-MRGN-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-LY-GRO-MRGN-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-TY-SLS-COST-AMT    (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-TY-SLS-COST-AMT    (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-FC-TOT-ORD-RTL     (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-FC-TOT-ORD-RTL     (SS-NEXT-LVL SS-SEASON)           
               ADD AT-SEAS-PL-BEG-INV-RTL-AMT (SS-CURR-LVL SS-SEASON)TO         
                   AT-SEAS-PL-BEG-INV-RTL-AMT (SS-NEXT-LVL SS-SEASON)           
           END-PERFORM.                                                         
                                                                                
                                                                                
       3200-ADD-TO-DEPT-SEASON-TOTS.                                            
                                                                                
      ******************************************************************        
      * ADD THE DEPARTMENT'S DOLLARS TO THE SEASON TOTALS FOR THE               
      * DEPARTMENT.                                                             
      ******************************************************************        
                                                                                
      *    MOVE THE BEGINNING INVENTORY TO THE SEASON PURCHASE TOTAL            
      *    FOR THE DEPARTMENT.                                                  
           MOVE 1 TO SS-SEASON.                                                 
           MOVE AT-MN-TY-BEG-INV-COST-AMT    (PC-DEPT-LVL)                      
             TO AT-SEAS-TY-PRCH-NET-COST-AMT (PC-DEPT-LVL SS-SEASON).           
           MOVE AT-MN-LY-BEG-INV-COST-AMT    (PC-DEPT-LVL)                      
             TO AT-SEAS-LY-PRCH-NET-COST-AMT (PC-DEPT-LVL SS-SEASON).           
           MOVE AT-MN-TY-BEG-INV-RTL-AMT     (PC-DEPT-LVL)                      
             TO AT-SEAS-TY-PRCH-RTL-AMT      (PC-DEPT-LVL SS-SEASON).           
           MOVE AT-MN-LY-BEG-INV-RTL-AMT     (PC-DEPT-LVL)                      
             TO AT-SEAS-LY-PRCH-RTL-AMT      (PC-DEPT-LVL SS-SEASON).           
                                                                                
           MOVE 2 TO SS-SEASON.                                                 
      *    THIS YEAR'S INVENTORY WHEN THE OPEN MONTH IS IN THE FALL             
           IF SS-OPEN-MN > 6                                                    
               MOVE AT-TY-END-INV-COST-AMT (PC-DEPT-LVL 6)                      
                 TO AT-SEAS-TY-PRCH-NET-COST-AMT(PC-DEPT-LVL SS-SEASON)         
               MOVE AT-TY-END-INV-RTL-AMT  (PC-DEPT-LVL 6)                      
                 TO AT-SEAS-TY-PRCH-RTL-AMT   (PC-DEPT-LVL SS-SEASON)           
           END-IF.                                                              
      *    LAST YEAR'S DATA WILL BE FOR THE ENTIRE YEAR                         
           MOVE AT-LY-END-INV-COST-AMT (PC-DEPT-LVL 6)                          
             TO AT-SEAS-LY-PRCH-NET-COST-AMT(PC-DEPT-LVL SS-SEASON).            
           MOVE AT-LY-END-INV-RTL-AMT  (PC-DEPT-LVL 6)                          
             TO AT-SEAS-LY-PRCH-RTL-AMT   (PC-DEPT-LVL SS-SEASON).              
                                                                                
      *    ADD THE MONTHLY DOLLARS TO THE SEASON TOTALS FOR THE                 
      *    DEPARTMENT. MONTHS 1-6 BELONG TO THE SPRING SEASON.                  
      *    MONTHS 7-12 BELONG TO THE FALL SEASON.                               
                                                                                
           PERFORM VARYING SS-CURR-MN FROM 1 BY 1                               
             UNTIL (SS-CURR-MN > 12)                                            
                                                                                
               IF SS-CURR-MN < 7                                                
                   MOVE 1 TO SS-SEASON                                          
               ELSE                                                             
                   MOVE 2 TO SS-SEASON                                          
               END-IF                                                           
                                                                                
               ADD AT-TY-RCPT-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-RCPT-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-FC-RCPT-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-FC-RCPT-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-PL-RCPT-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-PL-RCPT-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-LY-RCPT-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-LY-RCPT-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
                                                                                
               ADD AT-TY-PADJ-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-PADJ-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-PL-PADJ-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-PL-PADJ-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-LY-PADJ-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-LY-PADJ-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
                                                                                
               ADD AT-TY-NET-SALES-AMT       (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-NET-SALES-AMT  (PC-DEPT-LVL SS-SEASON)            
               ADD AT-FC-NET-SALES-AMT       (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-FC-NET-SALES-AMT  (PC-DEPT-LVL SS-SEASON)            
               ADD AT-PL-NET-SALES-AMT       (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-PL-NET-SALES-AMT  (PC-DEPT-LVL SS-SEASON)            
               ADD AT-LY-NET-SALES-AMT       (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-LY-NET-SALES-AMT  (PC-DEPT-LVL SS-SEASON)            
                                                                                
               ADD AT-TY-MKDN-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-MKDN-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-FC-MKDN-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-FC-MKDN-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-PL-MKDN-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-PL-MKDN-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-LY-MKDN-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-LY-MKDN-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
                                                                                
               ADD AT-TY-PRCH-NET-COST-AMT   (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-PRCH-NET-COST-AMT(PC-DEPT-LVL SS-SEASON)          
               ADD AT-LY-PRCH-NET-COST-AMT   (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-LY-PRCH-NET-COST-AMT(PC-DEPT-LVL SS-SEASON)          
                                                                                
               ADD AT-TY-PRCH-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-PRCH-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-LY-PRCH-RTL-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-LY-PRCH-RTL-AMT   (PC-DEPT-LVL SS-SEASON)            
                                                                                
               ADD AT-TY-GRO-MRGN-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-GRO-MRGN-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-PL-GRO-MRGN-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-PL-GRO-MRGN-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-LY-GRO-MRGN-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-LY-GRO-MRGN-AMT   (PC-DEPT-LVL SS-SEASON)            
                                                                                
               ADD AT-TY-SLS-COST-AMT        (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-TY-SLS-COST-AMT   (PC-DEPT-LVL SS-SEASON)            
               ADD AT-FC-TOT-ORD-RTL-AMT     (PC-DEPT-LVL SS-CURR-MN) TO        
                   AT-SEAS-FC-TOT-ORD-RTL    (PC-DEPT-LVL SS-SEASON)            
                                                                                
           END-PERFORM.                                                         
                                                                                
                                                                                
       4000-PROCESS-WEEK-DET-LINES.                                             
                                                                                
      ******************************************************************        
      * BUILD THE WEEKLY DETAIL LINE FOR THE CURRENT MONTH.                     
      ******************************************************************        
                                                                                
           MOVE PC-WK      TO DWL1-WK-NBR-PREF.                                 
           MOVE SS-CURR-WK TO PV-WK-NBR.                                        
           MOVE PV-WK-NBR  TO DWL1-WK-NBR.                                      
           MOVE PC-TY      TO DWL1-WK-CAT.                                      
                                                                                
      *    THIS YEAR WEEKLY SALES                                               
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-TY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)                
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-SLS-RTL-AMT.                           
                                                                                
      *    THIS YEAR SALES PERCENT                                              
           MOVE ZEROS            TO DWL1-SLS-RTL-PCT.                           
           MOVE SPACE            TO DWL1-SLS-RTL-PCT-C.                         
                                                                                
      *    THIS YEAR COMP SALES - ALWAYS 0.                                     
           MOVE ZEROS            TO DWL1-COMP-SLS-PCT.                          
           MOVE SPACE            TO DWL1-COMP-SLS-PCT-C.                        
                                                                                
      *    THIS YEAR MARK DOWN                                                  
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-TY-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    THIS YEAR MARK DOWN PERCENT                                          
           IF AT-WK-TY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK) NOT = ZERO          
               COMPUTE PV-PCT ROUNDED                                           
                     = (AT-WK-TY-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)          
                     * 100)                                                     
                     / AT-WK-TY-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-WK)          
               MOVE PV-PCT       TO DWL1-MKDN-RTL-PCT                           
           ELSE                                                                 
               MOVE ZERO         TO DWL1-MKDN-RTL-PCT                           
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE        TO DWL1-MKDN-RTL-PCT-C                         
           ELSE                                                                 
               MOVE PC-PCT       TO DWL1-MKDN-RTL-PCT-C                         
           END-IF.                                                              
                                                                                
      *    THIS YEAR END WEEK INVENTORY                                         
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-TY-EOW-INV-AMT  (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    THIS YEAR WEEKS OF SUPPLY                                            
           IF PS-BREAK-IS-OPERCO OR                                             
              PS-BREAK-IS-GMA    OR                                             
              PS-BREAK-IS-DMA    OR                                             
              PS-BREAK-IS-BYR                                                   
               MOVE SPACES       TO DWL1-WEEKS-SUPPLY                           
               MOVE PH2-WEEK-NBR TO PV-WEEK-NBR                                 
               IF SS-CURR-WK <= PV-WEEK-NBR                                     
                   MOVE PC-NA        TO DWL1-WKS-SUP-NA                         
               ELSE                                                             
                   MOVE SPACES       TO DWL1-WKS-SUP-NA                         
               END-IF                                                           
           ELSE                                                                 
               IF AT-WK-TY-WKS-SUP-NO-PLN(SS-CURR-LVL SS-CURR-WK) = 'Y'         
                   MOVE PC-NO-PLAN TO DWL1-WEEKS-SUPPLY                         
               ELSE                                                             
                   MOVE AT-WK-TY-WKS-SUP-GT-SYM(SS-CURR-LVL SS-CURR-WK)         
                                 TO DWL1-WKS-SUP-GT-SYMBOL                      
                   MOVE AT-WK-TY-WKS-SUP(SS-CURR-LVL SS-CURR-WK)                
                                 TO DWL1-WKS-SUP                                
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    THIS YEAR WEEKLY RECEIPTS                                            
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    THIS YEAR WEEKLY PURCHASE ADJUSTMENTS                                
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-PADJ-RTL-AMT.                          
                                                                                
      *    THIS YEAR NET PURCHASE PERCENT                                       
           IF (SS-OPEN-WK = PV-TY-LAST-WK-IN-MN AND                             
              ((AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 1)                           
             +  AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 2)                           
             +  AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 3)                           
             +  AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 4)                           
             +  AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 5))                          
             + (AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 1)                           
             +  AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 2)                           
             +  AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 3)                           
             +  AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 4)                           
             +  AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 5)))                         
             > ZERO)                                                            
              COMPUTE PV-PCT ROUNDED                                            
                    = ((AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-WK)          
                    +   AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-WK))         
                    * 100)                                                      
                    / ((AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 1)                   
                    +   AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 2)                   
                    +   AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 3)                   
                    +   AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 4)                   
                    +   AT-WK-TY-RCPT-RTL-AMT (SS-CURR-LVL 5))                  
                    +  (AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 1)                   
                    +   AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 2)                   
                    +   AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 3)                   
                    +   AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 4)                   
                    +   AT-WK-TY-PADJ-RTL-AMT (SS-CURR-LVL 5)))                 
               MOVE PV-PCT           TO DWL1-NET-PURCH-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DWL1-NET-PURCH-PCT.                     
                                                                                
           IF DWL1-NET-PURCH-PCT = SPACE                                        
               MOVE SPACE            TO DWL1-NET-PURCH-PCT-C                    
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-NET-PURCH-PCT-C.                   
                                                                                
      *    THIS YEAR WEEK MARKON PERCENT                                        
           IF AT-WK-TY-PRCH-RTL-AMT (SS-CURR-LVL SS-CURR-WK) NOT = ZERO         
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-WK-TY-PRCH-RTL-AMT     (SS-CURR-LVL SS-CURR-WK)          
                 -  AT-WK-TY-PRCH-NET-COST-AMT(SS-CURR-LVL SS-CURR-WK))         
                 * 100)                                                         
                 /  AT-WK-TY-PRCH-RTL-AMT     (SS-CURR-LVL SS-CURR-WK)          
               MOVE PV-PCT           TO DWL1-MARKON-PCT                         
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MARKON-PCT                         
           END-IF.                                                              
                                                                                
           IF DWL1-MARKON-PCT = SPACES                                          
               MOVE SPACE            TO DWL1-MARKON-PCT-C                       
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MARKON-PCT-C                       
           END-IF.                                                              
                                                                                
      *    THIS YEAR WEEK OPEN ORDERS                                           
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-TY-OPEN-ORD-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED         TO DWL1-OPEN-ORD-AMT.                      
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
           MOVE SPACES               TO DWL1-WK-NBR-PREF                        
                                        DWL1-WK-NBR.                            
                                                                                
           MOVE PC-FC                TO DWL1-WK-CAT.                            
                                                                                
      *    FORECAST WEEKLY SALES AMOUNT                                         
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-FC-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)                
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED         TO DWL1-SLS-RTL-AMT.                       
                                                                                
      *    FORECAST WEEKLY SALES PERCENT                                        
           IF (AT-WK-FC-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)                    
               NOT = ZERO) AND                                                  
              (SS-CURR-WK <= SS-OPEN-WK)                                        
               COMPUTE PV-PCT ROUNDED                                           
                 = ((AT-WK-TY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)              
                 /   PC-THOUSAND)                                               
                 -  AT-WK-FC-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK))              
                 *  100                                                         
                 /  AT-WK-FC-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
               MOVE PV-PCT           TO DWL1-SLS-RTL-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DWL1-SLS-RTL-PCT                        
           END-IF.                                                              
                                                                                
           IF DWL1-SLS-RTL-PCT = SPACES                                         
               MOVE SPACE            TO DWL1-SLS-RTL-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-SLS-RTL-PCT-C                      
           END-IF.                                                              
                                                                                
      *    FORECAST WEEKLY COMP SALES PERCENT                                   
           MOVE ZEROS            TO DWL1-COMP-SLS-PCT.                          
           MOVE SPACE            TO DWL1-COMP-SLS-PCT-C.                        
                                                                                
      *    FORECAST WEEKLY MARKDOWN AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-FC-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    FORECAST WEEKLY MARKDOWN PERCENT                                     
           IF AT-WK-FC-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK) NOT = ZERO          
               COMPUTE PV-PCT ROUNDED                                           
                     = (AT-WK-FC-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)          
                     * 100)                                                     
                     / AT-WK-FC-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-WK)          
               MOVE PV-PCT           TO DWL1-MKDN-RTL-PCT                       
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MKDN-RTL-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-MKDN-RTL-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MKDN-RTL-PCT-C                     
           END-IF.                                                              
                                                                                
      *    FORECAST END OF WEEK INVENTORY                                       
           MOVE ZEROES           TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    FORECAST WEEKS OF SUPPLY                                             
           IF PS-BREAK-IS-OPERCO OR                                             
              PS-BREAK-IS-GMA    OR                                             
              PS-BREAK-IS-DMA    OR                                             
              PS-BREAK-IS-BYR                                                   
               CONTINUE                                                         
           ELSE                                                                 
               IF AT-WK-FC-WKS-SUP-NO-PLN(SS-CURR-LVL SS-CURR-WK) = 'Y'         
                   MOVE PC-NO-PLAN TO DWL1-WEEKS-SUPPLY                         
               ELSE                                                             
                   MOVE AT-WK-FC-WKS-SUP-GT-SYM(SS-CURR-LVL SS-CURR-WK)         
                                 TO DWL1-WKS-SUP-GT-SYMBOL                      
                   MOVE AT-WK-FC-WKS-SUP(SS-CURR-LVL SS-CURR-WK)                
                                 TO DWL1-WKS-SUP                                
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    FORECAST WEEKLY PURCHASES                                            
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL SS-CURR-WK)            
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    FORECAST WEEKLY PURCHASE ADJUSTMENTS                                 
           MOVE ZEROES           TO DWL1-PADJ-RTL-AMT.                          
                                                                                
      *    FORECAST NET PURCHASE PERCENT                                        
           IF (SS-OPEN-WK = PV-TY-LAST-WK-IN-MN AND                             
              (AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 1)                         
               + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 2)                       
               + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 3)                       
               + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 4)                       
               + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 5))                      
               > ZERO)                                                          
              COMPUTE PV-PCT ROUNDED                                            
                    = (AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL SS-CURR-WK)        
                    *   100)                                                    
                    / (AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 1)                 
                       + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 2)               
                       + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 3)               
                       + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 4)               
                       + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 5))              
               MOVE PV-PCT           TO DWL1-NET-PURCH-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DWL1-NET-PURCH-PCT.                     
                                                                                
           IF DWL1-NET-PURCH-PCT = SPACE                                        
               MOVE SPACE            TO DWL1-NET-PURCH-PCT-C                    
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-NET-PURCH-PCT-C.                   
                                                                                
      *    FORECAST WEEKLY MARKONS PERCENT                                      
           MOVE ZEROES               TO DWL1-MARKON-PCT.                        
           MOVE SPACE                TO DWL1-MARKON-PCT-C.                      
                                                                                
      *    FORECAST WEEKLY OPEN ORDERS                                          
           MOVE ZEROES           TO DWL1-OPEN-ORD-AMT.                          
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
                                                                                
           MOVE PC-PL      TO DWL1-WK-CAT.                                      
                                                                                
      *    PLANNING WEEKLY SALES AMOUNT                                         
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-PL-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)                
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-SLS-RTL-AMT.                           
                                                                                
      *    PLANNING WEEKLY SALES PERCENT                                        
           IF (AT-WK-PL-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)                    
               NOT = ZERO) AND                                                  
              (SS-CURR-WK <= SS-OPEN-WK)                                        
               COMPUTE PV-PCT ROUNDED                                           
                 = ((AT-WK-TY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)              
                 /   PC-THOUSAND)                                               
                 -  AT-WK-PL-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK))              
                 *  100                                                         
                 /  AT-WK-PL-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
               MOVE PV-PCT           TO DWL1-SLS-RTL-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DWL1-SLS-RTL-PCT                        
           END-IF.                                                              
                                                                                
           IF DWL1-SLS-RTL-PCT = SPACES                                         
               MOVE SPACE            TO DWL1-SLS-RTL-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-SLS-RTL-PCT-C                      
           END-IF.                                                              
                                                                                
      *    PLANNING WEEKLY COMP SALES PERCENT                                   
           MOVE ZEROS            TO DWL1-COMP-SLS-PCT.                          
           MOVE SPACE            TO DWL1-COMP-SLS-PCT-C.                        
                                                                                
      *    PLANNING WEEKLY MARKDOWN AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-PL-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    PLANNING WEEKLY MARKDOWN PERCENT                                     
           IF AT-WK-PL-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK) NOT = ZERO          
               COMPUTE PV-PCT ROUNDED                                           
                     = (AT-WK-PL-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)          
                     * 100)                                                     
                     / AT-WK-PL-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-WK)          
               MOVE PV-PCT           TO DWL1-MKDN-RTL-PCT                       
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MKDN-RTL-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-MKDN-RTL-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MKDN-RTL-PCT-C                     
           END-IF.                                                              
                                                                                
      *    PLANNING END OF WEEK INVENTORY                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-PL-EOW-INV-AMT  (SS-CURR-LVL SS-CURR-WK)               
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    PLANNING WEEKS OF SUPPLY                                             
           IF PS-BREAK-IS-OPERCO OR                                             
              PS-BREAK-IS-GMA    OR                                             
              PS-BREAK-IS-DMA    OR                                             
              PS-BREAK-IS-BYR                                                   
               CONTINUE                                                         
           ELSE                                                                 
               IF AT-WK-PL-WKS-SUP-NO-PLN(SS-CURR-LVL SS-CURR-WK) = 'Y'         
                   MOVE PC-NO-PLAN TO DWL1-WEEKS-SUPPLY                         
               ELSE                                                             
                   MOVE AT-WK-PL-WKS-SUP-GT-SYM(SS-CURR-LVL SS-CURR-WK)         
                                 TO DWL1-WKS-SUP-GT-SYMBOL                      
                   MOVE AT-WK-PL-WKS-SUP(SS-CURR-LVL SS-CURR-WK)                
                                 TO DWL1-WKS-SUP                                
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    PLANNING WEEKLY RECEIPTS                                             
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    PLANNING WEEKLY PURCHASE ADJUSTMENTS                                 
21517      COMPUTE PV-AMT-RNDED ROUNDED                                         
21517            = AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
21517            / PC-ONE.                                                      
21517      MOVE PV-AMT-RNDED     TO DWL1-PADJ-RTL-AMT.                          
                                                                                
      *    PLANNING NET PURCHASE PERCENT                                        
           IF (SS-OPEN-WK = PV-TY-LAST-WK-IN-MN AND                             
              (AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 1)                            
               + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 2)                          
               + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 3)                          
               + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 4)                          
W04081         + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 5)                          
W04081         + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 1)                          
W04081         + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 2)                          
W04081         + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 3)                          
W04081         + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 4)                          
W04081         + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 5))                         
               > ZERO)                                                          
              COMPUTE PV-PCT ROUNDED                                            
21517               = ((AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-WK)          
21517                  + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-WK))        
                      * 100)                                                    
                    / (AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 1)                    
                       + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 2)                  
                       + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 3)                  
                       + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 4)                  
21517                  + AT-WK-PL-RCPT-RTL-AMT (SS-CURR-LVL 5)                  
21517                  + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 1)                  
21517                  + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 2)                  
21517                  + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 3)                  
21517                  + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 4)                  
21517                  + AT-WK-PL-PADJ-RTL-AMT (SS-CURR-LVL 5))                 
               MOVE PV-PCT           TO DWL1-NET-PURCH-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DWL1-NET-PURCH-PCT.                     
                                                                                
           IF DWL1-NET-PURCH-PCT = SPACE                                        
               MOVE SPACE            TO DWL1-NET-PURCH-PCT-C                    
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-NET-PURCH-PCT-C.                   
                                                                                
      *    PLANNING WEEKLY MARKONS PERCENT                                      
           MOVE ZEROES               TO DWL1-MARKON-PCT.                        
           MOVE SPACE                TO DWL1-MARKON-PCT-C.                      
                                                                                
      *    PLANNING WEEKLY OPEN ORDERS                                          
           MOVE ZEROES           TO DWL1-OPEN-ORD-AMT.                          
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
                                                                                
           MOVE PC-LY      TO DWL1-WK-CAT.                                      
                                                                                
      *    LAST YEAR WEEKLY SALES AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-LY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)                
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-SLS-RTL-AMT.                           
                                                                                
      *    LAST YEAR WEEKLY SALES PERCENT                                       
           IF (AT-WK-LY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)                    
               NOT = ZERO) AND                                                  
              (SS-CURR-WK <= SS-OPEN-WK)                                        
               COMPUTE PV-PCT ROUNDED                                           
                 = (AT-WK-TY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 -  AT-WK-LY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK))              
                 *  100                                                         
                 /  AT-WK-LY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
               MOVE PV-PCT           TO DWL1-SLS-RTL-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DWL1-SLS-RTL-PCT                        
           END-IF.                                                              
                                                                                
           IF DWL1-SLS-RTL-PCT = SPACES                                         
               MOVE SPACE            TO DWL1-SLS-RTL-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-SLS-RTL-PCT-C                      
           END-IF.                                                              
                                                                                
      *    LAST YEAR WEEKLY COMP SALES PERCENT                                  
           IF (AT-WK-LY-COMP-SLS-AMT (SS-CURR-LVL SS-CURR-WK)                   
               NOT = ZERO) AND                                                  
              (SS-CURR-WK <= SS-OPEN-WK)                                        
               COMPUTE PV-PCT ROUNDED                                           
                     =((AT-WK-TY-COMP-SLS-AMT (SS-CURR-LVL SS-CURR-WK)          
                     -  AT-WK-LY-COMP-SLS-AMT (SS-CURR-LVL SS-CURR-WK))         
                     * 100)                                                     
                     / AT-WK-LY-COMP-SLS-AMT (SS-CURR-LVL SS-CURR-WK)           
               MOVE PV-PCT           TO DWL1-COMP-SLS-PCT                       
           ELSE                                                                 
               MOVE ZEROS            TO DWL1-COMP-SLS-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-COMP-SLS-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-COMP-SLS-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-COMP-SLS-PCT-C                     
           END-IF.                                                              
                                                                                
                                                                                
      *    LAST YEAR WEEKLY MARKDOWN AMOUNT                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-LY-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    LAST YEAR WEEKLY MARKDOWN PERCENT                                    
           IF AT-WK-LY-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-WK) NOT = ZERO          
               COMPUTE PV-PCT ROUNDED                                           
                     = (AT-WK-LY-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-WK)          
                     * 100)                                                     
                     / AT-WK-LY-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-WK)          
               MOVE PV-PCT           TO DWL1-MKDN-RTL-PCT                       
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MKDN-RTL-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-MKDN-RTL-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MKDN-RTL-PCT-C                     
           END-IF.                                                              
                                                                                
      *    LAST YEAR END OF WEEK INVENTORY                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-LY-EOW-INV-AMT  (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    LAST YEAR WEEKS OF SUPPLY                                            
           IF PS-BREAK-IS-OPERCO OR                                             
              PS-BREAK-IS-GMA    OR                                             
              PS-BREAK-IS-DMA    OR                                             
              PS-BREAK-IS-BYR                                                   
               CONTINUE                                                         
           ELSE                                                                 
               MOVE AT-WK-LY-WKS-SUP-GT-SYM(SS-CURR-LVL SS-CURR-WK)             
                                 TO DWL1-WKS-SUP-GT-SYMBOL                      
               MOVE AT-WK-LY-WKS-SUP(SS-CURR-LVL SS-CURR-WK)                    
                                 TO DWL1-WKS-SUP                                
           END-IF.                                                              
                                                                                
      *    LAST YEAR WEEKLY RECEIPTS                                            
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    LAST YEAR WEEKLY PURCHASE ADJUSTMENTS                                
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-WK)               
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-PADJ-RTL-AMT.                          
                                                                                
                                                                                
      *    LAST YEAR NET PURCHASE PERCENT                                       
           IF (SS-OPEN-WK = PV-LY-LAST-WK-IN-MN AND                             
              ((AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 1)                           
             +  AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 2)                           
             +  AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 3)                           
             +  AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 4)                           
             +  AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 5))                          
             + (AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 1)                           
             +  AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 2)                           
             +  AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 3)                           
             +  AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 4)                           
             +  AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 5)))                         
             > ZERO)                                                            
              COMPUTE PV-PCT ROUNDED                                            
                    = ((AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-WK)          
                    +   AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-WK))         
                    *   100)                                                    
                    / ((AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 1)                   
                    +   AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 2)                   
                    +   AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 3)                   
                    +   AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 4)                   
                    +   AT-WK-LY-RCPT-RTL-AMT (SS-CURR-LVL 5))                  
                    +  (AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 1)                   
                    +   AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 2)                   
                    +   AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 3)                   
                    +   AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 4)                   
                    +   AT-WK-LY-PADJ-RTL-AMT (SS-CURR-LVL 5)))                 
               MOVE PV-PCT           TO DWL1-NET-PURCH-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DWL1-NET-PURCH-PCT.                     
                                                                                
           IF DWL1-NET-PURCH-PCT = SPACE                                        
               MOVE SPACE            TO DWL1-NET-PURCH-PCT-C                    
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-NET-PURCH-PCT-C.                   
                                                                                
      *    LAST YEAR WEEKLY MARKONS PERCENT                                     
           IF AT-WK-LY-PRCH-RTL-AMT (SS-CURR-LVL SS-CURR-WK) NOT = ZERO         
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-WK-LY-PRCH-RTL-AMT     (SS-CURR-LVL SS-CURR-WK)          
                 -  AT-WK-LY-PRCH-NET-COST-AMT(SS-CURR-LVL SS-CURR-WK))         
                 * 100)                                                         
                 /  AT-WK-LY-PRCH-RTL-AMT     (SS-CURR-LVL SS-CURR-WK)          
               MOVE PV-PCT           TO DWL1-MARKON-PCT                         
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MARKON-PCT                         
           END-IF.                                                              
                                                                                
           IF DWL1-MARKON-PCT = SPACES                                          
               MOVE SPACE            TO DWL1-MARKON-PCT-C                       
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MARKON-PCT-C                       
           END-IF.                                                              
                                                                                
      *    LAST YEAR WEEKLY OPEN ORDERS                                         
           MOVE ZEROES           TO DWL1-OPEN-ORD-AMT.                          
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
                                                                                
       4100-PROCESS-MTD-TOTALS.                                                 
                                                                                
      ******************************************************************        
      *    PROCESS DETAIL LINES FOR THE MONTH TO DATE INFORMATION               
      ******************************************************************        
                                                                                
           MOVE PC-MT      TO DWL1-WK-NBR-PREF.                                 
           MOVE PC-D       TO DWL1-WK-NBR.                                      
           MOVE PC-TY      TO DWL1-WK-CAT.                                      
                                                                                
           COMPUTE MTD-WK-TY-PRCH-NET-COST-AMT                                  
                 = AT-WK-TY-PRCH-NET-COST-AMT (SS-CURR-LVL 1)                   
                 + AT-WK-TY-PRCH-NET-COST-AMT (SS-CURR-LVL 2)                   
                 + AT-WK-TY-PRCH-NET-COST-AMT (SS-CURR-LVL 3)                   
                 + AT-WK-TY-PRCH-NET-COST-AMT (SS-CURR-LVL 4)                   
                 + AT-WK-TY-PRCH-NET-COST-AMT (SS-CURR-LVL 5).                  
                                                                                
           COMPUTE MTD-WK-LY-PRCH-NET-COST-AMT                                  
                 = AT-WK-LY-PRCH-NET-COST-AMT (SS-CURR-LVL 1)                   
                 + AT-WK-LY-PRCH-NET-COST-AMT (SS-CURR-LVL 2)                   
                 + AT-WK-LY-PRCH-NET-COST-AMT (SS-CURR-LVL 3)                   
                 + AT-WK-LY-PRCH-NET-COST-AMT (SS-CURR-LVL 4)                   
                 + AT-WK-LY-PRCH-NET-COST-AMT (SS-CURR-LVL 5).                  
                                                                                
           COMPUTE MTD-WK-TY-PRCH-RTL-AMT                                       
                 = AT-WK-TY-PRCH-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-TY-PRCH-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-TY-PRCH-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-TY-PRCH-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-TY-PRCH-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-LY-PRCH-RTL-AMT                                       
                 = AT-WK-LY-PRCH-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-LY-PRCH-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-LY-PRCH-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-LY-PRCH-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-LY-PRCH-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-TY-SLS-RTL-AMT                                        
                 = AT-WK-TY-SLS-RTL-AMT    (SS-CURR-LVL 1)                      
                 + AT-WK-TY-SLS-RTL-AMT    (SS-CURR-LVL 2)                      
                 + AT-WK-TY-SLS-RTL-AMT    (SS-CURR-LVL 3)                      
                 + AT-WK-TY-SLS-RTL-AMT    (SS-CURR-LVL 4)                      
                 + AT-WK-TY-SLS-RTL-AMT    (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-FC-SLS-RTL-AMT                                        
                 = AT-WK-FC-SLS-RTL-AMT    (SS-CURR-LVL 1)                      
                 + AT-WK-FC-SLS-RTL-AMT    (SS-CURR-LVL 2)                      
                 + AT-WK-FC-SLS-RTL-AMT    (SS-CURR-LVL 3)                      
                 + AT-WK-FC-SLS-RTL-AMT    (SS-CURR-LVL 4)                      
                 + AT-WK-FC-SLS-RTL-AMT    (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-PL-SLS-RTL-AMT                                        
                 = AT-WK-PL-SLS-RTL-AMT    (SS-CURR-LVL 1)                      
                 + AT-WK-PL-SLS-RTL-AMT    (SS-CURR-LVL 2)                      
                 + AT-WK-PL-SLS-RTL-AMT    (SS-CURR-LVL 3)                      
                 + AT-WK-PL-SLS-RTL-AMT    (SS-CURR-LVL 4)                      
                 + AT-WK-PL-SLS-RTL-AMT    (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-LY-SLS-RTL-AMT                                        
                 = AT-WK-LY-SLS-RTL-AMT    (SS-CURR-LVL 1)                      
                 + AT-WK-LY-SLS-RTL-AMT    (SS-CURR-LVL 2)                      
                 + AT-WK-LY-SLS-RTL-AMT    (SS-CURR-LVL 3)                      
                 + AT-WK-LY-SLS-RTL-AMT    (SS-CURR-LVL 4)                      
                 + AT-WK-LY-SLS-RTL-AMT    (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-TY-COMP-SLS-AMT                                       
                 = AT-WK-TY-COMP-SLS-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-TY-COMP-SLS-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-TY-COMP-SLS-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-TY-COMP-SLS-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-TY-COMP-SLS-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-LY-COMP-SLS-AMT                                       
                 = AT-WK-LY-COMP-SLS-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-LY-COMP-SLS-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-LY-COMP-SLS-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-LY-COMP-SLS-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-LY-COMP-SLS-AMT   (SS-CURR-LVL 5).                     
                                                                                
           MOVE AT-PL-COMP-SLS-RTL-AMT     (SS-CURR-LVL SS-OPEN-MN)             
                                TO MTD-WK-PL-COMP-SLS-AMT.                      
                                                                                
           COMPUTE MTD-WK-TY-MKDN-RTL-AMT                                       
                 = AT-WK-TY-MKDN-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-TY-MKDN-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-TY-MKDN-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-TY-MKDN-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-TY-MKDN-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-FC-MKDN-RTL-AMT                                       
                 = AT-WK-FC-MKDN-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-FC-MKDN-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-FC-MKDN-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-FC-MKDN-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-FC-MKDN-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-PL-MKDN-RTL-AMT                                       
                 = AT-WK-PL-MKDN-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-PL-MKDN-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-PL-MKDN-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-PL-MKDN-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-PL-MKDN-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-LY-MKDN-RTL-AMT                                       
                 = AT-WK-LY-MKDN-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-LY-MKDN-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-LY-MKDN-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-LY-MKDN-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-LY-MKDN-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-TY-OPEN-ORD-AMT                                       
                 = AT-WK-TY-OPEN-ORD-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-TY-OPEN-ORD-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-TY-OPEN-ORD-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-TY-OPEN-ORD-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-TY-OPEN-ORD-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-LY-OPEN-ORD-AMT                                       
                 = AT-WK-LY-OPEN-ORD-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-LY-OPEN-ORD-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-LY-OPEN-ORD-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-LY-OPEN-ORD-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-LY-OPEN-ORD-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-TY-RCPT-RTL-AMT                                       
                 = AT-WK-TY-RCPT-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-TY-RCPT-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-TY-RCPT-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-TY-RCPT-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-TY-RCPT-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-FC-TOT-ORD-RTL-AMT                                    
                 = AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 1)                     
                 + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 2)                     
                 + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 3)                     
                 + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 4)                     
                 + AT-WK-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL 5).                    
                                                                                
           COMPUTE MTD-WK-PL-RCPT-RTL-AMT                                       
                 = AT-WK-PL-RCPT-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-PL-RCPT-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-PL-RCPT-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-PL-RCPT-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-PL-RCPT-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-LY-RCPT-RTL-AMT                                       
                 = AT-WK-LY-RCPT-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-LY-RCPT-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-LY-RCPT-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-LY-RCPT-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-LY-RCPT-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-TY-RCPT-NET-COST-AMT                                  
                 = AT-WK-TY-RCPT-NET-COST-AMT (SS-CURR-LVL 1)                   
                 + AT-WK-TY-RCPT-NET-COST-AMT (SS-CURR-LVL 2)                   
                 + AT-WK-TY-RCPT-NET-COST-AMT (SS-CURR-LVL 3)                   
                 + AT-WK-TY-RCPT-NET-COST-AMT (SS-CURR-LVL 4)                   
                 + AT-WK-TY-RCPT-NET-COST-AMT (SS-CURR-LVL 5).                  
                                                                                
           COMPUTE MTD-WK-LY-RCPT-NET-COST-AMT                                  
                 = AT-WK-LY-RCPT-NET-COST-AMT (SS-CURR-LVL 1)                   
                 + AT-WK-LY-RCPT-NET-COST-AMT (SS-CURR-LVL 2)                   
                 + AT-WK-LY-RCPT-NET-COST-AMT (SS-CURR-LVL 3)                   
                 + AT-WK-LY-RCPT-NET-COST-AMT (SS-CURR-LVL 4)                   
                 + AT-WK-LY-RCPT-NET-COST-AMT (SS-CURR-LVL 5).                  
                                                                                
           COMPUTE MTD-WK-TY-PADJ-RTL-AMT                                       
                 = AT-WK-TY-PADJ-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-TY-PADJ-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-TY-PADJ-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-TY-PADJ-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-TY-PADJ-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
21517      COMPUTE MTD-WK-PL-PADJ-RTL-AMT                                       
21517            = AT-WK-PL-PADJ-RTL-AMT   (SS-CURR-LVL 1)                      
21517            + AT-WK-PL-PADJ-RTL-AMT   (SS-CURR-LVL 2)                      
21517            + AT-WK-PL-PADJ-RTL-AMT   (SS-CURR-LVL 3)                      
21517            + AT-WK-PL-PADJ-RTL-AMT   (SS-CURR-LVL 4)                      
21517            + AT-WK-PL-PADJ-RTL-AMT   (SS-CURR-LVL 5).                     
21517                                                                           
           COMPUTE MTD-WK-LY-PADJ-RTL-AMT                                       
                 = AT-WK-LY-PADJ-RTL-AMT   (SS-CURR-LVL 1)                      
                 + AT-WK-LY-PADJ-RTL-AMT   (SS-CURR-LVL 2)                      
                 + AT-WK-LY-PADJ-RTL-AMT   (SS-CURR-LVL 3)                      
                 + AT-WK-LY-PADJ-RTL-AMT   (SS-CURR-LVL 4)                      
                 + AT-WK-LY-PADJ-RTL-AMT   (SS-CURR-LVL 5).                     
                                                                                
           COMPUTE MTD-WK-TY-PADJ-NET-COST-AMT                                  
                 = AT-WK-TY-PADJ-NET-COST-AMT (SS-CURR-LVL 1)                   
                 + AT-WK-TY-PADJ-NET-COST-AMT (SS-CURR-LVL 2)                   
                 + AT-WK-TY-PADJ-NET-COST-AMT (SS-CURR-LVL 3)                   
                 + AT-WK-TY-PADJ-NET-COST-AMT (SS-CURR-LVL 4)                   
                 + AT-WK-TY-PADJ-NET-COST-AMT (SS-CURR-LVL 5).                  
                                                                                
           COMPUTE MTD-WK-LY-PADJ-NET-COST-AMT                                  
                 = AT-WK-LY-PADJ-NET-COST-AMT (SS-CURR-LVL 1)                   
                 + AT-WK-LY-PADJ-NET-COST-AMT (SS-CURR-LVL 2)                   
                 + AT-WK-LY-PADJ-NET-COST-AMT (SS-CURR-LVL 3)                   
                 + AT-WK-LY-PADJ-NET-COST-AMT (SS-CURR-LVL 4)                   
                 + AT-WK-LY-PADJ-NET-COST-AMT (SS-CURR-LVL 5).                  
                                                                                
      *    MTD THIS YEAR SALES                                                  
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-TY-SLS-RTL-AMT                                        
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-SLS-RTL-AMT.                           
                                                                                
      *    MTD THIS YEAR SALES PERCENT                                          
           MOVE ZEROS            TO DWL1-SLS-RTL-PCT.                           
           MOVE SPACE            TO DWL1-SLS-RTL-PCT-C.                         
                                                                                
      *    MTD THIS YEAR COMP SALES - ALWAYS 0.                                 
           MOVE ZEROS            TO DWL1-COMP-SLS-PCT.                          
           MOVE SPACE            TO DWL1-COMP-SLS-PCT-C.                        
                                                                                
      *    MTD THIS YEAR MARK DOWN                                              
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-TY-MKDN-RTL-AMT                                       
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    MTD THIS YEAR MARK DOWN PERCENT                                      
           IF MTD-WK-TY-SLS-RTL-AMT NOT = ZERO                                  
               COMPUTE PV-PCT ROUNDED                                           
                     =(MTD-WK-TY-MKDN-RTL-AMT                                   
                     * 100)                                                     
                     / MTD-WK-TY-SLS-RTL-AMT                                    
               MOVE PV-PCT           TO DWL1-MKDN-RTL-PCT                       
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MKDN-RTL-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-MKDN-RTL-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MKDN-RTL-PCT-C                     
           END-IF.                                                              
                                                                                
      *    MTD THIS YEAR END WEEK INVENTORY                                     
           MOVE ZEROES           TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    MTD THIS YEAR WEEK OF SUPPLY                                         
           MOVE SPACES           TO DWL1-WKS-SUP-GT-SYMBOL.                     
           MOVE ZEROES           TO DWL1-WKS-SUP.                               
                                                                                
      *    MTD THIS YEAR WEEKLY RECEIPT RETAIL                                  
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-TY-RCPT-RTL-AMT                                       
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    MTD THIS YEAR WEEKLY PURCHASE ADJUSTMENT RETAIL AMOUNT               
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-TY-PADJ-RTL-AMT                                       
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-PADJ-RTL-AMT.                          
                                                                                
      *    MTD THIS YEAR NET PURCHASE PERCENT                                   
           MOVE ZERO             TO DWL1-NET-PURCH-PCT.                         
           MOVE SPACE            TO DWL1-NET-PURCH-PCT-C.                       
                                                                                
      *    MTD THIS YEAR WEEK MARKON PERCENT                                    
           IF MTD-WK-TY-PRCH-RTL-AMT NOT = ZERO                                 
               COMPUTE PV-PCT ROUNDED                                           
                 =((MTD-WK-TY-PRCH-RTL-AMT                                      
                 -  MTD-WK-TY-PRCH-NET-COST-AMT)                                
                 * 100)                                                         
                 /  MTD-WK-TY-PRCH-RTL-AMT                                      
               MOVE PV-PCT           TO DWL1-MARKON-PCT                         
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MARKON-PCT                         
           END-IF.                                                              
                                                                                
           IF DWL1-MARKON-PCT = SPACES                                          
               MOVE SPACE            TO DWL1-MARKON-PCT-C                       
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MARKON-PCT-C                       
           END-IF.                                                              
                                                                                
      *    MTD THIS YEAR WEEK OPEN ORDERS                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-TY-OPEN-ORD-AMT                                       
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-OPEN-ORD-AMT.                          
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
                                                                                
           MOVE SPACES     TO DWL1-WK-NBR-PREF                                  
                              DWL1-WK-NBR.                                      
                                                                                
           MOVE PC-FC      TO DWL1-WK-CAT.                                      
                                                                                
      *    MTD FORECAST SALES                                                   
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-FC-SLS-RTL-AMT                                        
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-SLS-RTL-AMT.                           
                                                                                
      *    MTD FORECAST SALES PERCENT                                           
           IF MTD-WK-FC-SLS-RTL-AMT NOT = ZERO                                  
               COMPUTE PV-PCT ROUNDED                                           
                 =(((MTD-WK-TY-SLS-RTL-AMT                                      
                 / PC-THOUSAND)                                                 
                 -  MTD-WK-FC-SLS-RTL-AMT)                                      
                 * 100)                                                         
                 /  MTD-WK-FC-SLS-RTL-AMT                                       
               MOVE PV-PCT           TO DWL1-SLS-RTL-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DWL1-SLS-RTL-PCT                        
           END-IF.                                                              
                                                                                
           IF DWL1-SLS-RTL-PCT = SPACES                                         
               MOVE SPACE            TO DWL1-SLS-RTL-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-SLS-RTL-PCT-C                      
           END-IF.                                                              
                                                                                
      *    MTD FORECAST COMP SALES - ALWAYS 0.                                  
           MOVE ZEROS            TO DWL1-COMP-SLS-PCT.                          
           MOVE SPACE            TO DWL1-COMP-SLS-PCT-C.                        
                                                                                
      *    MTD FORECAST MARK DOWN                                               
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-FC-MKDN-RTL-AMT                                       
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    MTD FORECAST MARK DOWN PERCENT                                       
           IF MTD-WK-FC-SLS-RTL-AMT NOT = ZERO                                  
               COMPUTE PV-PCT ROUNDED                                           
                     =(MTD-WK-FC-MKDN-RTL-AMT                                   
                     * 100)                                                     
                     / MTD-WK-FC-SLS-RTL-AMT                                    
               MOVE PV-PCT           TO DWL1-MKDN-RTL-PCT                       
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MKDN-RTL-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-MKDN-RTL-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MKDN-RTL-PCT-C                     
           END-IF.                                                              
                                                                                
      *    MTD FORECAST END WEEK INVENTORY                                      
           MOVE ZEROES           TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    MTD FORECAST WEEK OF SUPPLY                                          
           MOVE SPACES           TO DWL1-WKS-SUP-GT-SYMBOL.                     
           MOVE ZEROES           TO DWL1-WKS-SUP.                               
                                                                                
      *    MTD FORECAST WEEKLY PURCHASES                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-FC-TOT-ORD-RTL-AMT                                    
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    MTD FORECAST WEEKLY PURCHASE ADJUSTMENT RETAIL AMOUNT                
           MOVE ZEROES           TO DWL1-PADJ-RTL-AMT.                          
                                                                                
      *    MTD FORECAST NET PURCHASE PERCENT                                    
           MOVE ZERO             TO DWL1-NET-PURCH-PCT.                         
           MOVE SPACE            TO DWL1-NET-PURCH-PCT-C.                       
                                                                                
      *    MTD FORECAST WEEK MARKON PERCENT                                     
           MOVE ZEROES               TO DWL1-MARKON-PCT.                        
           MOVE SPACE                TO DWL1-MARKON-PCT-C.                      
                                                                                
      *    MTD FORECAST WEEK OPEN ORDERS                                        
           MOVE ZEROES           TO DWL1-OPEN-ORD-AMT.                          
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
                                                                                
           MOVE PC-PL      TO DWL1-WK-CAT.                                      
                                                                                
      *    MTD PLANNING SALES                                                   
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-PL-SLS-RTL-AMT                                        
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-SLS-RTL-AMT.                           
                                                                                
      *    MTD PLANNING SALES PERCENT                                           
           IF MTD-WK-PL-SLS-RTL-AMT NOT = ZERO                                  
               COMPUTE PV-PCT ROUNDED                                           
                 =(((MTD-WK-TY-SLS-RTL-AMT                                      
                 /  PC-THOUSAND)                                                
                 -  MTD-WK-PL-SLS-RTL-AMT)                                      
                 * 100)                                                         
                 /  MTD-WK-PL-SLS-RTL-AMT                                       
               MOVE PV-PCT           TO DWL1-SLS-RTL-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DWL1-SLS-RTL-PCT                        
           END-IF.                                                              
                                                                                
           IF DWL1-SLS-RTL-PCT = SPACES                                         
               MOVE SPACE            TO DWL1-SLS-RTL-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-SLS-RTL-PCT-C                      
           END-IF.                                                              
                                                                                
      *    MTD PLANNING WEEKLY COMP SALES PERCENT                               
      *    ONLY CALCULATE AT THE END OF THE MONTH                               
                                                                                
           IF SS-OPEN-WK NOT = PV-TY-LAST-WK-IN-MN                              
               MOVE ZEROS            TO DWL1-COMP-SLS-PCT                       
               MOVE SPACE            TO DWL1-COMP-SLS-PCT-C                     
           ELSE                                                                 
               IF MTD-WK-PL-COMP-SLS-AMT NOT = ZERO                             
                   COMPUTE PV-PCT ROUNDED                                       
                         =(((MTD-WK-TY-COMP-SLS-AMT / PC-THOUSAND)              
                         -   MTD-WK-PL-COMP-SLS-AMT)                            
                         * 100)                                                 
                         / MTD-WK-PL-COMP-SLS-AMT                               
                   MOVE PV-PCT           TO DWL1-COMP-SLS-PCT                   
               ELSE                                                             
                   MOVE ZEROS            TO DWL1-COMP-SLS-PCT                   
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF DWL1-COMP-SLS-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-COMP-SLS-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-COMP-SLS-PCT-C                     
           END-IF.                                                              
                                                                                
      *    MTD PLANNING MARK DOWN                                               
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-PL-MKDN-RTL-AMT                                       
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    MTD PLANNING MARK DOWN PERCENT                                       
           IF MTD-WK-PL-SLS-RTL-AMT NOT = ZERO                                  
               COMPUTE PV-PCT ROUNDED                                           
                     =(MTD-WK-PL-MKDN-RTL-AMT                                   
                     * 100)                                                     
                     / MTD-WK-PL-SLS-RTL-AMT                                    
               MOVE PV-PCT           TO DWL1-MKDN-RTL-PCT                       
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MKDN-RTL-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-MKDN-RTL-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MKDN-RTL-PCT-C                     
           END-IF.                                                              
                                                                                
      *    MTD PLANNING END WEEK INVENTORY                                      
           MOVE ZEROES           TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    MTD PLANNING WEEK OF SUPPLY                                          
           MOVE SPACES           TO DWL1-WKS-SUP-GT-SYMBOL.                     
           MOVE ZEROES           TO DWL1-WKS-SUP.                               
                                                                                
      *    MTD PLANNING WEEKLY RECEIPT RETAIL                                   
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-PL-RCPT-RTL-AMT                                       
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    MTD PLANNING WEEKLY PURCHASE ADJUSTMENT RETAIL AMOUNT                
21517      MOVE MTD-WK-PL-PADJ-RTL-AMT TO DWL1-PADJ-RTL-AMT.                    
                                                                                
      *    MTD PLANNING NET PURCHASE PERCENT                                    
           MOVE ZERO             TO DWL1-NET-PURCH-PCT.                         
           MOVE SPACE            TO DWL1-NET-PURCH-PCT-C.                       
                                                                                
      *    MTD PLANNING WEEK MARKON PERCENT                                     
           MOVE ZEROES               TO DWL1-MARKON-PCT.                        
           MOVE SPACE                TO DWL1-MARKON-PCT-C.                      
                                                                                
      *    MTD PLANNING WEEK OPEN ORDERS                                        
           MOVE ZEROES           TO DWL1-OPEN-ORD-AMT.                          
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
                                                                                
           MOVE PC-LY      TO DWL1-WK-CAT.                                      
                                                                                
      *    MTD LAST YEAR WEEKLY SALES AMOUNT                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-LY-SLS-RTL-AMT                                        
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-SLS-RTL-AMT.                           
                                                                                
      *    MTD LAST YEAR WEEKLY SALES PERCENT                                   
           IF MTD-WK-LY-SLS-RTL-AMT NOT = ZERO                                  
               COMPUTE PV-PCT ROUNDED                                           
                 =((MTD-WK-TY-SLS-RTL-AMT                                       
                 -  MTD-WK-LY-SLS-RTL-AMT)                                      
                 * 100)                                                         
                 /  MTD-WK-LY-SLS-RTL-AMT                                       
               MOVE PV-PCT           TO DWL1-SLS-RTL-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DWL1-SLS-RTL-PCT                        
           END-IF.                                                              
                                                                                
           IF DWL1-SLS-RTL-PCT = SPACES                                         
               MOVE SPACE            TO DWL1-SLS-RTL-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-SLS-RTL-PCT-C                      
           END-IF.                                                              
                                                                                
      *    MTD LAST YEAR WEEKLY COMP SALES PERCENT                              
           IF MTD-WK-LY-COMP-SLS-AMT NOT = ZERO                                 
               COMPUTE PV-PCT ROUNDED                                           
                     =((MTD-WK-TY-COMP-SLS-AMT                                  
                     -  MTD-WK-LY-COMP-SLS-AMT)                                 
                     * 100)                                                     
                     / MTD-WK-LY-COMP-SLS-AMT                                   
               MOVE PV-PCT           TO DWL1-COMP-SLS-PCT                       
           ELSE                                                                 
               MOVE ZEROS            TO DWL1-COMP-SLS-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-COMP-SLS-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-COMP-SLS-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-COMP-SLS-PCT-C                     
           END-IF.                                                              
                                                                                
      *    MTD LAST YEAR WEEKLY MARKDOWN AMOUNT                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-LY-MKDN-RTL-AMT                                       
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-MKDN-RTL-AMT.                          
                                                                                
      *    MTD LAST YEAR WEEKLY MARKDOWN PERCENT                                
           IF MTD-WK-LY-SLS-RTL-AMT NOT = ZERO                                  
               COMPUTE PV-PCT ROUNDED                                           
                     = (MTD-WK-LY-MKDN-RTL-AMT                                  
                     * 100)                                                     
                     / MTD-WK-LY-SLS-RTL-AMT                                    
               MOVE PV-PCT           TO DWL1-MKDN-RTL-PCT                       
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MKDN-RTL-PCT                       
           END-IF.                                                              
                                                                                
           IF DWL1-MKDN-RTL-PCT = SPACES                                        
               MOVE SPACE            TO DWL1-MKDN-RTL-PCT-C                     
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MKDN-RTL-PCT-C                     
           END-IF.                                                              
                                                                                
      *    MTD LAST YEAR END OF WEEK INVENTORY                                  
           MOVE ZEROES           TO DWL1-EOW-INV-AMT.                           
                                                                                
      *    MTD LAST YEAR WEEKS OF SUPPLY                                        
           MOVE SPACE            TO DWL1-WKS-SUP-GT-SYMBOL.                     
           MOVE ZEROES           TO DWL1-WKS-SUP.                               
                                                                                
      *    MTD LAST YEAR WEEKLY RECEIPT RETAIL                                  
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-LY-RCPT-RTL-AMT                                       
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-RCPT-RTL-AMT.                          
                                                                                
      *    MTD LAST YEAR WEEKLY PURCHASE ADJUSTMENT RETAIL AMOUNT               
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = MTD-WK-LY-PADJ-RTL-AMT                                       
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DWL1-PADJ-RTL-AMT.                          
                                                                                
      *    LAST YEAR NET PURCHASE PERCENT                                       
           MOVE ZERO             TO DWL1-NET-PURCH-PCT.                         
           MOVE SPACE            TO DWL1-NET-PURCH-PCT-C.                       
                                                                                
      *    MTD LAST YEAR WEEKLY MARKONS PERCENT                                 
           IF MTD-WK-LY-PRCH-RTL-AMT NOT = ZERO                                 
               COMPUTE PV-PCT ROUNDED                                           
                 =((MTD-WK-LY-PRCH-RTL-AMT                                      
                 -  MTD-WK-LY-PRCH-NET-COST-AMT)                                
                 * 100)                                                         
                 /  MTD-WK-LY-PRCH-RTL-AMT                                      
               MOVE PV-PCT           TO DWL1-MARKON-PCT                         
           ELSE                                                                 
               MOVE ZERO             TO DWL1-MARKON-PCT                         
           END-IF.                                                              
                                                                                
           IF DWL1-MARKON-PCT = SPACES                                          
               MOVE SPACE            TO DWL1-MARKON-PCT-C                       
           ELSE                                                                 
               MOVE PC-PCT           TO DWL1-MARKON-PCT-C                       
           END-IF.                                                              
                                                                                
      *    MTD LAST YEAR WEEKLY OPEN ORDERS                                     
           MOVE ZEROES           TO DWL1-OPEN-ORD-AMT.                          
                                                                                
           PERFORM 7600-PRINT-WK-DETAIL-LINE.                                   
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
                                                                                
       4200-PROCESS-MONTH-S1-DET-LINE.                                          
                                                                                
      ******************************************************************        
      * BUILD THE DETAIL LINE FOR THE CURRENT MONTH.                            
      ******************************************************************        
                                                                                
           MOVE MT-FSCL-MN-NM-ABBREV (SS-CURR-MN) TO DML2-MONTH-ABBREV.         
                                                                                
      *    THIS YEAR END OF MONTH ACTUAL                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-EOM-ACTUAL (SS-CURR-LVL SS-CURR-MN)                    
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-TY-EOM-ACTUAL.                         
                                                                                
      *    END OF MONTH FORECAST                                                
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-FC-EOM (SS-CURR-LVL SS-CURR-MN)                           
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-FC-EOM.                                
                                                                                
      *    END OF MONTH PLANNED                                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-PL-EOM (SS-CURR-LVL SS-CURR-MN)                           
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-PL-EOM.                                
                                                                                
      *    LAST YEAR END OF MONTH ACTUAL                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-LY-EOM-ACTUAL (SS-CURR-LVL SS-CURR-MN)                    
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-LY-EOM-ACTUAL.                         
                                                                                
      *    THIS YEAR MONTHLY ACTUAL RECEIPTS                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-TY-RCPT-RTL-AMT.                       
                                                                                
      *    FORECAST RECEIPTS                                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-FC-TOT-ORD-RTL-AMT (SS-CURR-LVL SS-CURR-MN)               
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-FC-RCPT-RTL-AMT.                       
                                                                                
      *    PLANNED RECEIPTS                                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-PL-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-PL-RCPT-RTL-AMT.                       
                                                                                
      *    LAST YEAR MONTHLY ACTUAL RECEIPTS                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-LY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-LY-RCPT-RTL-AMT.                       
                                                                                
      *    THIS YEAR PURCHASE ADJUSTMENT ACTUAL                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-TY-PADJ-RTL-AMT.                       
                                                                                
      *    FORECAST PURCHASE ADJUSTMENT                                         
           MOVE ZEROES           TO DML2-FC-PADJ-RTL-AMT.                       
                                                                                
      *    PLANNED PURCHASE ADJUSTMENT                                          
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-PL-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-PL-PADJ-RTL-AMT.                       
                                                                                
      *    LAST YEAR PURCHASE ADJUSTMENT ACTUAL                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-LY-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-LY-PADJ-RTL-AMT.                       
                                                                                
      *                                                                         
      *    INVENTORY TURN FOR THIS YEAR, PLANNED, AND LAST YEAR                 
           IF SS-CURR-MN < PC-SEVEN                                             
                                                                                
      *                                                                         
      *        THIS IS FOR COMPUTATIONS FOR THE SPRING                          
      *        GET THE INVENTORY SUMS TO USE IN THE AVERAGE                     
      *        CALCULATION                                                      
               MOVE PC-ONE TO SS-MN                                             
                              SS-WK                                             
               MOVE ZEROS  TO PV-TY-INV-SUM                                     
                              PV-PL-INV-SUM                                     
                              PV-LY-INV-SUM                                     
                              PV-TY-SALES-SUM                                   
                              PV-PL-SALES-SUM                                   
                              PV-LY-SALES-SUM                                   
      *        THIS IS JUST TO GET THE UPPER BOUNDARY FOR SUMMING               
      *        THIS YEAR'S INVENTORY TURN                                       
      *        WHEN THE CURRENT MONTH EQUALS THE OPEN MONTH                     
      *             THEN USE THE OPEN FISCAL WEEK FOR THE UPPER                 
      *             BOUNDARY.  THIS IS ONLY FOR THIS YEAR'S CALC.               
      *        WHEN THE CURRENT MONTH IS LESS THAN THE OPEN MONTH               
      *             OR GREATER THAN THE OPEN MONTH                              
      *             THEN USE THE LAST FISCAL WEEK OF THE MONTH AS               
      *             THE UPPER BOUNDARY                                          
      *             THIS IS FOR LAST YEAR, AND PLANNING, AND THIS               
      *             YEAR ONLY WHEN THIS YEAR IS LESS THAN THE                   
      *             OPEN FISCAL MONTH                                           
                IF SS-CURR-MN = SS-OPEN-MN                                      
                    MOVE SS-OPEN-FSCL-WK                                        
                                      TO SS-TY-CURR-WK                          
                    MOVE FS-FSCL-WK-NBR (SS-CURR-MN)                            
                                      TO SS-CURR-WK                             
                ELSE                                                            
                    MOVE FS-FSCL-WK-NBR (SS-CURR-MN)                            
                                      TO SS-TY-CURR-WK                          
                    MOVE FS-FSCL-WK-NBR (SS-CURR-MN)                            
                                      TO SS-CURR-WK                             
                END-IF                                                          
      *                                                                         
      *        GET THE INVENTORY SUMS BY WEEKS                                  
                                                                                
               PERFORM UNTIL SS-WK > SS-CURR-WK                                 
                    IF SS-WK <= SS-TY-CURR-WK                                   
                        ADD AT-TY-EOW-ACTUAL(SS-CURR-LVL SS-WK)                 
                                      TO PV-TY-INV-SUM                          
                    END-IF                                                      
                    ADD AT-PL-EOW       (SS-CURR-LVL SS-WK)                     
                                      TO PV-PL-INV-SUM                          
                    ADD AT-LY-EOW-ACTUAL(SS-CURR-LVL SS-WK)                     
                                      TO PV-LY-INV-SUM                          
                    ADD 1             TO SS-WK                                  
               END-PERFORM                                                      
                                                                                
      *        GET THE NET SALES SUM BY MONTHS                                  
               PERFORM UNTIL SS-MN > SS-CURR-MN                                 
                    ADD AT-TY-NET-SALES-AMT(SS-CURR-LVL SS-MN)                  
                                      TO PV-TY-SALES-SUM                        
                    ADD AT-PL-NET-SALES-AMT(SS-CURR-LVL SS-MN)                  
                                      TO PV-PL-SALES-SUM                        
                    ADD AT-LY-NET-SALES-AMT(SS-CURR-LVL SS-MN)                  
                                      TO PV-LY-SALES-SUM                        
                    ADD 1 TO SS-MN                                              
               END-PERFORM                                                      
      *                                                                         
      *        THIS YEAR INVENTORY TURN FOR MONTH THAT IS IN                    
      *        SPRING SEASON                                                    
               MOVE AT-MN-TY-BEG-INV-RTL-AMT (SS-CURR-LVL)                      
                                      TO PV-BOM-INV-SEAS                        
      *                                                                         
      *        COMPUTE THIS YEAR INVENTORY TURN                                 
      *        AS LONG AS THE CURRENT MONTH LESS THAN                           
      *        OR EQUAL TO THE OPEN MONTH                                       
               IF SS-CURR-MN <= SS-OPEN-MN                                      
                   IF (PV-BOM-INV-SEAS + PV-TY-INV-SUM) NOT ZERO                
                       COMPUTE PV-PCT-DEC-FOUR                                  
                         = PV-TY-SALES-SUM                                      
                         / ((PV-BOM-INV-SEAS + PV-TY-INV-SUM)                   
                         / (SS-TY-CURR-WK + PC-ONE))                            
                                                                                
                   ELSE                                                         
                       MOVE ZERO         TO PV-PCT-DEC-FOUR                     
                   END-IF                                                       
               ELSE                                                             
                   MOVE ZERO         TO PV-PCT-DEC-FOUR                         
               END-IF                                                           
      *                                                                         
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 = PV-PCT-DEC-FOUR * 1                                          
                                                                                
               MOVE PV-PCT-DEC-TWO    TO DML2-TY-INV-TURN-AMT                   
                                                                                
      *                                                                         
      *        PLANNED INVENTORY TURN FOR MONTH THAT IS IN                      
      *        SPRING SEASON                                                    
               MOVE AT-SEAS-PL-BEG-INV-RTL-AMT  (SS-CURR-LVL PC-ONE)            
                                      TO PV-BOM-INV-SEAS                        
      *                                                                         
      *        COMPUTE PLANNED INVENTORY TURN                                   
               IF (PV-BOM-INV-SEAS + PV-PL-INV-SUM) NOT ZERO                    
                   COMPUTE PV-PCT-DEC-FOUR                                      
                     = PV-PL-SALES-SUM                                          
                     / ((PV-BOM-INV-SEAS + PV-PL-INV-SUM)                       
                     / (SS-CURR-WK + PC-ONE))                                   
               ELSE                                                             
                   MOVE ZERO         TO PV-PCT-DEC-FOUR                         
               END-IF                                                           
      *                                                                         
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 = PV-PCT-DEC-FOUR * 1                                          
                                                                                
               MOVE PV-PCT-DEC-TWO   TO DML2-PL-INV-TURN-AMT                    
      *                                                                         
      *        LAST YEAR INVENTORY TURN FOR MONTH THAT IS IN                    
      *        SPRING SEASON                                                    
               MOVE AT-MN-LY-BEG-INV-RTL-AMT (SS-CURR-LVL)                      
                                      TO PV-BOM-INV-SEAS                        
      *                                                                         
      *        COMPUTE LAST YEAR INVENTORY TURN                                 
               IF (PV-BOM-INV-SEAS + PV-LY-INV-SUM) NOT ZERO                    
                   COMPUTE PV-PCT-DEC-FOUR                                      
                     = PV-LY-SALES-SUM                                          
                     / ((PV-BOM-INV-SEAS + PV-LY-INV-SUM)                       
                     / (SS-CURR-WK + PC-ONE))                                   
               ELSE                                                             
                   MOVE ZERO         TO PV-PCT-DEC-FOUR                         
               END-IF                                                           
      *                                                                         
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 = PV-PCT-DEC-FOUR * 1                                          
                                                                                
               MOVE PV-PCT-DEC-TWO   TO DML2-LY-INV-TURN-AMT                    
           ELSE                                                                 
      *        THIS IS FOR FALL COMPUTATIONS                                    
      *        GET THE INVENTORY SUMS TO USE IN THE AVERAGE                     
      *        CALCULATION                                                      
               MOVE PC-SEVEN          TO SS-MN                                  
               MOVE PC-TWENTY-SEVEN   TO SS-WK                                  
               MOVE ZEROS             TO PV-TY-INV-SUM                          
                                         PV-PL-INV-SUM                          
                                         PV-LY-INV-SUM                          
                                         PV-TY-SALES-SUM                        
                                         PV-PL-SALES-SUM                        
                                         PV-LY-SALES-SUM                        
      *                                                                         
      *    THIS IS JUST TO GET THE UPPER BOUNDARY FOR SUMMING                   
      *    THIS YEAR'S INVENTORY TURN                                           
      *    WHEN THE CURRENT MONTH EQUALS THE OPEN MONTH                         
      *         THEN USE THE OPEN FISCAL WEEK FOR THE UPPER                     
      *         BOUNDARY                                                        
      *    WHEN THE CURRENT MONTH IS LESS THAN THE OPEN MONTH                   
      *         OR GREATER THAN THE OPEN MONTH                                  
      *         THEN USE THE LAST FISCAL WEEK OF THE MONTH AS                   
      *         THE UPPER BOUNDARY                                              
               IF SS-CURR-MN = SS-OPEN-MN                                       
                   MOVE SS-OPEN-FSCL-WK                                         
                                     TO SS-TY-CURR-WK                           
                   MOVE FS-FSCL-WK-NBR (SS-CURR-MN)                             
                                     TO SS-CURR-WK                              
               ELSE                                                             
                   MOVE FS-FSCL-WK-NBR (SS-CURR-MN)                             
                                     TO SS-TY-CURR-WK                           
                   MOVE FS-FSCL-WK-NBR (SS-CURR-MN)                             
                                     TO SS-CURR-WK                              
               END-IF                                                           
                                                                                
               PERFORM UNTIL SS-WK > SS-CURR-WK                                 
                   IF SS-WK <= SS-TY-CURR-WK                                    
                       ADD AT-TY-EOW-ACTUAL(SS-CURR-LVL SS-WK)                  
                                     TO PV-TY-INV-SUM                           
                   END-IF                                                       
                   ADD AT-PL-EOW       (SS-CURR-LVL SS-WK)                      
                                     TO PV-PL-INV-SUM                           
                   ADD AT-LY-EOW-ACTUAL(SS-CURR-LVL SS-WK)                      
                                     TO PV-LY-INV-SUM                           
                   ADD 1 TO SS-WK                                               
               END-PERFORM                                                      
                                                                                
               PERFORM UNTIL SS-MN > SS-CURR-MN                                 
                   ADD AT-TY-NET-SALES-AMT(SS-CURR-LVL SS-MN)                   
                                     TO PV-TY-SALES-SUM                         
                   ADD AT-PL-NET-SALES-AMT(SS-CURR-LVL SS-MN)                   
                                     TO PV-PL-SALES-SUM                         
                   ADD AT-LY-NET-SALES-AMT(SS-CURR-LVL SS-MN)                   
                                     TO PV-LY-SALES-SUM                         
                   ADD 1 TO SS-MN                                               
               END-PERFORM                                                      
      *                                                                         
      *        THIS YEAR INVENTORY TURN FOR MONTH THAT IS IN                    
      *        FALL SEASON                                                      
               MOVE PC-SIX            TO SS-MN                                  
               MOVE AT-TY-EOM-ACTUAL (SS-CURR-LVL SS-MN )                       
                                      TO PV-BOM-INV-SEAS                        
      *                                                                         
      *        COMPUTE THIS YEAR INVENTORY TURN                                 
      *        AS LONG AS THE CURRENT MONTH LESS THAN                           
      *        OR EQUAL TO THE OPEN MONTH                                       
               IF SS-CURR-MN <= SS-OPEN-MN                                      
                   IF (PV-BOM-INV-SEAS + PV-TY-INV-SUM) NOT ZERO                
                       COMPUTE PV-PCT-DEC-FOUR                                  
                         = PV-TY-SALES-SUM                                      
                         / ((PV-BOM-INV-SEAS + PV-TY-INV-SUM)                   
                         /  (SS-TY-CURR-WK - PC-TWENTY-FIVE))                   
                   ELSE                                                         
                       MOVE ZERO         TO PV-PCT-DEC-FOUR                     
                   END-IF                                                       
               ELSE                                                             
                   MOVE ZERO         TO PV-PCT-DEC-FOUR                         
               END-IF                                                           
      *                                                                         
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 = PV-PCT-DEC-FOUR * 1                                          
                                                                                
               MOVE PV-PCT-DEC-TWO   TO DML2-TY-INV-TURN-AMT                    
      *                                                                         
      *        PLANNED INVENTORY TURN FOR MONTH THAT IS IN                      
      *        FALL SEASON                                                      
               MOVE AT-SEAS-PL-BEG-INV-RTL-AMT  (SS-CURR-LVL PC-TWO)            
                                      TO PV-BOM-INV-SEAS                        
      *                                                                         
      *        COMPUTE PLANNED INVENTORY TURN                                   
               IF (PV-BOM-INV-SEAS + PV-PL-INV-SUM) NOT ZERO                    
                   COMPUTE PV-PCT-DEC-FOUR                                      
                     = PV-PL-SALES-SUM                                          
                     / ((PV-BOM-INV-SEAS + PV-PL-INV-SUM)                       
                     /  (SS-CURR-WK - PC-TWENTY-FIVE))                          
               ELSE                                                             
                    MOVE ZERO        TO PV-PCT-DEC-FOUR                         
               END-IF                                                           
      *                                                                         
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 = PV-PCT-DEC-FOUR * 1                                          
                                                                                
               MOVE PV-PCT-DEC-TWO   TO DML2-PL-INV-TURN-AMT                    
                                                                                
      *        LAST YEAR INVENTORY TURN FOR MONTH THAT IS IN                    
      *        FALL SEASON                                                      
               MOVE AT-LY-EOM-ACTUAL (SS-CURR-LVL SS-MN )                       
                                      TO PV-BOM-INV-SEAS                        
      *        IF THE CURRENT WEEK IS 53, IT IS FROM THIS YEAR                  
      *        AND LAST YEAR DID NOT HAVE 53 WEEKS IN IT.                       
      *        SO SUBTRACT ONE FROM THE CURRENT WEEK TO                         
      *        MAKE IT 52 WEEKS.                                                
               IF SS-CURR-WK = PC-FIFTY-THREE                                   
                   SUBTRACT PC-ONE   FROM SS-CURR-WK                            
               END-IF                                                           
      *                                                                         
      *        COMPUTE LAST YEAR INVENTORY TURN                                 
               IF (PV-BOM-INV-SEAS + PV-LY-INV-SUM) NOT ZERO                    
                   COMPUTE PV-PCT-DEC-FOUR                                      
                     = PV-LY-SALES-SUM                                          
                     / ((PV-BOM-INV-SEAS + PV-LY-INV-SUM)                       
                     /  (SS-CURR-WK - PC-TWENTY-FIVE))                          
               ELSE                                                             
                   MOVE ZERO         TO PV-PCT-DEC-FOUR                         
               END-IF                                                           
      *                                                                         
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 = PV-PCT-DEC-FOUR * 1                                          
                                                                                
               MOVE PV-PCT-DEC-TWO   TO DML2-LY-INV-TURN-AMT                    
      *                                                                         
           END-IF.                                                              
                                                                                
           PERFORM 7610-PRINT-MN-S1-DETAIL-LINE.                                
                                                                                
      *    CHECK IF SEASON TOTALS NEED TO BE DONE                               
           IF (SS-CURR-MN = 6           OR                                      
               SS-CURR-MN = 12    )                                             
               PERFORM 4250-PROCESS-SEASON-TOTALS-S1                            
           END-IF.                                                              
                                                                                
                                                                                
       4250-PROCESS-SEASON-TOTALS-S1.                                           
                                                                                
      ******************************************************************        
      * SET UP THE DETAIL LINE FOR THE END OF SEASON INFO.                      
      ******************************************************************        
                                                                                
           INITIALIZE DML2-DETAIL-MN-LINE-2.                                    
                                                                                
           IF SS-CURR-MN < 7                                                    
               MOVE 1        TO SS-SEASON                                       
               MOVE 'SPR'    TO DML2-MONTH-ABBREV                               
           ELSE                                                                 
               MOVE 2        TO SS-SEASON                                       
               MOVE 'FAL'    TO DML2-MONTH-ABBREV                               
           END-IF.                                                              
                                                                                
      *    THIS YEAR MONTHLY ACTUAL RECEIPTS                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-TY-RCPT-RTL-AMT   (SS-CURR-LVL SS-SEASON)            
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-TY-RCPT-RTL-AMT.                       
                                                                                
      *    FORECAST RECEIPTS                                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-FC-TOT-ORD-RTL (SS-CURR-LVL SS-SEASON)               
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-FC-RCPT-RTL-AMT.                       
                                                                                
      *    PLANNED RECEIPTS                                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-PL-RCPT-RTL-AMT   (SS-CURR-LVL SS-SEASON)            
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-PL-RCPT-RTL-AMT.                       
                                                                                
      *    LAST YEAR MONTHLY ACTUAL RECEIPTS                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-LY-RCPT-RTL-AMT   (SS-CURR-LVL SS-SEASON)            
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-LY-RCPT-RTL-AMT.                       
                                                                                
      *    THIS YEAR PURCHASE ADJUSTMENT ACTUAL                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-TY-PADJ-RTL-AMT   (SS-CURR-LVL SS-SEASON)            
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-TY-PADJ-RTL-AMT.                       
                                                                                
      *    FORECAST PURCHASE ADJUSTMENT                                         
           MOVE ZEROES           TO DML2-FC-PADJ-RTL-AMT.                       
                                                                                
      *    PLANNED PURCHASE ADJUSTMENT                                          
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-PL-PADJ-RTL-AMT   (SS-CURR-LVL SS-SEASON)            
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-PL-PADJ-RTL-AMT.                       
                                                                                
      *    LAST YEAR PURCHASE ADJUSTMENT ACTUAL                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-LY-PADJ-RTL-AMT   (SS-CURR-LVL SS-SEASON)            
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-LY-PADJ-RTL-AMT.                       
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL2-UNDER-LINE-2                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           PERFORM 7700-PRINT-TOTAL-LINE-MN-S1.                                 
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
                                                                                
       4300-PROCESS-YTD-S1-TOTAL-LINE.                                          
      ******************************************************************        
      *    CALCULATE AND PRINT THE YTD TOTALS FOR                               
      *    THE MONTHLY SECTION 1 ON THE FIRST PAGE OF THE REPORT.               
      *    THE FOLLOWING ARE NOT INCLUDED IN THE YTD TOTALS BECAUSE             
      *    ENDING INVENTORY IS PART OF THE CALCULATION.                         
      *                                                                         
      *         THIS YEAR END OF MONTH ACTUAL                                   
      *         END OF MONTH FORECAST                                           
      *         END OF MONTH PLANNED                                            
      *         LAST YEAR END OF MONTH ACTUAL                                   
      ******************************************************************        
           COMPUTE YTD-TY-RCPT-RTL-AMT                                          
                 = AT-SEAS-TY-RCPT-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-RCPT-RTL-AMT      (SS-CURR-LVL 2).                
           COMPUTE YTD-FC-TOT-ORD-RTL-AMT                                       
                 = AT-SEAS-FC-TOT-ORD-RTL       (SS-CURR-LVL 1)                 
                 + AT-SEAS-FC-TOT-ORD-RTL       (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-FC-RCPT-RTL-AMT                                          
                 = AT-SEAS-FC-RCPT-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-FC-RCPT-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-PL-RCPT-RTL-AMT                                          
                 = AT-SEAS-PL-RCPT-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-PL-RCPT-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-LY-RCPT-RTL-AMT                                          
                 = AT-SEAS-LY-RCPT-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-LY-RCPT-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-TY-PADJ-RTL-AMT                                          
                 = AT-SEAS-TY-PADJ-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-PADJ-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-PL-PADJ-RTL-AMT                                          
                 = AT-SEAS-PL-PADJ-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-PL-PADJ-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-LY-PADJ-RTL-AMT                                          
                 = AT-SEAS-LY-PADJ-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-LY-PADJ-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
                                                                                
           INITIALIZE     DML2-DETAIL-MN-LINE-2.                                
           MOVE 'YTD'  TO DML2-MONTH-ABBREV.                                    
                                                                                
      *    THIS YEAR MONTHLY ACTUAL RECEIPTS                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-TY-RCPT-RTL-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-TY-RCPT-RTL-AMT.                       
                                                                                
      *    FORECAST RECEIPTS                                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-FC-TOT-ORD-RTL-AMT                                       
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-FC-RCPT-RTL-AMT.                       
                                                                                
      *    PLANNED RECEIPTS                                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-PL-RCPT-RTL-AMT                                          
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-PL-RCPT-RTL-AMT.                       
                                                                                
      *    LAST YEAR MONTHLY ACTUAL RECEIPTS                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-LY-RCPT-RTL-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-LY-RCPT-RTL-AMT.                       
                                                                                
      *    THIS YEAR PURCHASE ADJUSTMENT ACTUAL                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-TY-PADJ-RTL-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-TY-PADJ-RTL-AMT.                       
                                                                                
      *    FORECAST PURCHASE ADJUSTMENT                                         
           MOVE ZEROES           TO DML2-FC-PADJ-RTL-AMT.                       
                                                                                
      *    PLANNED PURCHASE ADJUSTMENT                                          
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-PL-PADJ-RTL-AMT                                          
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML2-PL-PADJ-RTL-AMT.                       
                                                                                
      *    LAST YEAR PURCHASE ADJUSTMENT ACTUAL                                 
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-LY-PADJ-RTL-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML2-LY-PADJ-RTL-AMT.                       
                                                                                
      *    YTD INVENTORY TURN                                                   
      *    GET THE INVENTORY SUMS TO USE IN THE AVERAGE                         
      *    CALCULATION FOR YTD                                                  
           MOVE SS-OPEN-MN       TO SS-CURR-MN.                                 
           MOVE PC-ONE TO SS-MN                                                 
                          SS-WK.                                                
           MOVE ZEROS  TO PV-TY-INV-SUM                                         
                          PV-PL-INV-SUM                                         
                          PV-LY-INV-SUM                                         
                          PV-TY-SALES-SUM                                       
                          PV-PL-SALES-SUM                                       
                          PV-LY-SALES-SUM.                                      
                                                                                
      *    THIS IS JUST TO GET THE UPPER BOUNDARY FOR SUMMING                   
      *    THIS YEAR'S INVENTORY TURN                                           
           MOVE SS-OPEN-FSCL-WK     TO SS-TY-CURR-WK.                           
                                                                                
      *    SUM EOW INVENTORY FOR TY AVERAGE INVENTORY TURN CALCULATION          
           PERFORM UNTIL SS-WK > SS-TY-CURR-WK                                  
                ADD AT-TY-EOW-ACTUAL(SS-CURR-LVL SS-WK)                         
                                  TO PV-TY-INV-SUM                              
                ADD PC-ONE        TO SS-WK                                      
           END-PERFORM.                                                         
                                                                                
      *    THIS IS JUST TO GET THE UPPER BOUNDARY FOR SUMMING                   
      *    LAST YEAR'S INVENTORY TURN                                           
      *    THE ASSUMPTION HERE IS THAT THE MONTH WILL HAVE DATA                 
      *    FOR EVERY WEEK OF THE YEAR                                           
           MOVE FS-FSCL-WK-NBR (PC-TWELVE)                                      
                                  TO SS-CURR-WK.                                
                                                                                
      *    SUM EOW INVENTORY FOR AVERAGE INVENTORY CALCULATION                  
      *    FOR LAST YEAR AND PLANNING                                           
           MOVE PC-ONE TO SS-WK.                                                
           PERFORM UNTIL SS-WK > SS-CURR-WK                                     
                ADD AT-PL-EOW       (SS-CURR-LVL SS-WK)                         
                                  TO PV-PL-INV-SUM                              
                ADD AT-LY-EOW-ACTUAL(SS-CURR-LVL SS-WK)                         
                                  TO PV-LY-INV-SUM                              
                ADD PC-ONE        TO SS-WK                                      
           END-PERFORM.                                                         
                                                                                
      *    SUM NET SALES FOR TY INVENTORY TURN CALCULATIONS                     
           PERFORM UNTIL SS-MN > SS-CURR-MN                                     
                ADD AT-TY-NET-SALES-AMT(SS-CURR-LVL SS-MN)                      
                                  TO PV-TY-SALES-SUM                            
                ADD 1 TO SS-MN                                                  
           END-PERFORM.                                                         
      *                                                                         
      *    SUM NET SALES FOR PL AND LY INVENTORY TURN CALCULATIONS              
           MOVE PC-ONE            TO SS-MN.                                     
           PERFORM UNTIL SS-MN > PC-TWELVE                                      
                ADD AT-LY-NET-SALES-AMT(SS-CURR-LVL SS-MN)                      
                                  TO PV-LY-SALES-SUM                            
                ADD AT-PL-NET-SALES-AMT(SS-CURR-LVL SS-MN)                      
                                  TO PV-PL-SALES-SUM                            
                ADD 1 TO SS-MN                                                  
           END-PERFORM.                                                         
      *                                                                         
      *    THIS YEAR INVENTORY TURN FOR YTD                                     
           MOVE AT-MN-TY-BEG-INV-RTL-AMT (SS-CURR-LVL)                          
                                  TO PV-BOM-INV-SEAS.                           
      *                                                                         
      *    COMPUTE THIS YEAR INVENTORY TURN                                     
      *    AS LONG AS THE CURRENT MONTH LESS THAN                               
      *    OR EQUAL TO THE OPEN MONTH                                           
           IF (PV-BOM-INV-SEAS + PV-TY-INV-SUM) NOT ZERO                        
               COMPUTE PV-PCT-DEC-FOUR                                          
                 = PV-TY-SALES-SUM                                              
                 / ((PV-BOM-INV-SEAS + PV-TY-INV-SUM)                           
                 / (SS-TY-CURR-WK + PC-ONE))                                    
           ELSE                                                                 
               MOVE ZERO         TO PV-PCT-DEC-FOUR                             
           END-IF.                                                              
      *                                                                         
           COMPUTE PV-PCT-DEC-TWO ROUNDED                                       
             = PV-PCT-DEC-FOUR * 1.                                             
                                                                                
           MOVE PV-PCT-DEC-TWO    TO DML2-TY-INV-TURN-AMT.                      
      *                                                                         
      *    PLANNED INVENTORY TURN FOR YTD                                       
           MOVE AT-SEAS-PL-BEG-INV-RTL-AMT  (SS-CURR-LVL PC-ONE)                
                                  TO PV-BOM-INV-SEAS.                           
      *    GET DIVISOR FOR INVENTORY TURN YTD PLANNING                          
      *    PLANNING NUMBERS ARE BY THE SEASON.  THE DIVISOR                     
      *    WILL EITHER BE THE NUMBER OF WEEK THROUGH JULY                       
      *    OR THE NUMBER OF WEEKS THROUGH JANUARY                               
      *    CHECK IF THERE IS DATA FOR FALL                                      
           IF AT-PL-NET-SALES-AMT(SS-CURR-LVL 7) = ZERO                         
              MOVE FS-FSCL-WK-NBR (PC-SIX)                                      
                                  TO SS-PL-CURR-WK                              
           ELSE                                                                 
              MOVE FS-FSCL-WK-NBR (PC-TWELVE)                                   
                                  TO SS-PL-CURR-WK                              
           END-IF                                                               
      *                                                                         
      *    COMPUTE PLANNED INVENTORY TURN                                       
           IF (PV-BOM-INV-SEAS + PV-PL-INV-SUM) NOT ZERO                        
               COMPUTE PV-PCT-DEC-FOUR                                          
                 = PV-PL-SALES-SUM                                              
                 / ((PV-BOM-INV-SEAS + PV-PL-INV-SUM)                           
                 / (SS-PL-CURR-WK + PC-ONE))                                    
           ELSE                                                                 
               MOVE ZERO         TO PV-PCT-DEC-FOUR                             
           END-IF.                                                              
      *                                                                         
           COMPUTE PV-PCT-DEC-TWO ROUNDED                                       
             = PV-PCT-DEC-FOUR * 1.                                             
                                                                                
           MOVE PV-PCT-DEC-TWO   TO DML2-PL-INV-TURN-AMT.                       
      *                                                                         
      *    LAST YEAR INVENTORY TURN FOR MONTH THAT IS IN                        
      *    SPRING SEASON                                                        
           MOVE AT-MN-LY-BEG-INV-RTL-AMT (SS-CURR-LVL)                          
                                  TO PV-BOM-INV-SEAS.                           
      *                                                                         
      *    COMPUTE LAST YEAR INVENTORY TURN                                     
      *    AS LONG AS THE DIVISOR IS NOT ZERO                                   
      *    IF CURRENT WEEK IS 53 THEN SUBTRACT ONE FROM CURRENT WK              
      *    BECAUSE THE CURRENT WEEK IS FOR THIS YEAR, AND IF                    
      *    IT IS 53 THEN LAST YEAR'S CURRENT WEEK IS 52.                        
           IF (PV-BOM-INV-SEAS + PV-LY-INV-SUM) NOT ZERO                        
               IF (SS-CURR-WK = 53)                                             
                   SUBTRACT 1    FROM SS-CURR-WK                                
               END-IF                                                           
               COMPUTE PV-PCT-DEC-FOUR                                          
                 = PV-LY-SALES-SUM                                              
                 / ((PV-BOM-INV-SEAS + PV-LY-INV-SUM)                           
                 / (SS-CURR-WK + PC-ONE))                                       
           ELSE                                                                 
               MOVE ZERO         TO PV-PCT-DEC-FOUR                             
           END-IF.                                                              
      *                                                                         
           COMPUTE PV-PCT-DEC-TWO ROUNDED                                       
             = PV-PCT-DEC-FOUR * 1.                                             
                                                                                
           MOVE PV-PCT-DEC-TWO   TO DML2-LY-INV-TURN-AMT.                       
                                                                                
                                                                                
           PERFORM 7700-PRINT-TOTAL-LINE-MN-S1.                                 
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
                                                                                
       4400-PROCESS-MONTH-S2-DET-LINE.                                          
                                                                                
      ******************************************************************        
      * BUILD THE DETAIL LINE FOR THE CURRENT MONTH.                            
      ******************************************************************        
                                                                                
           MOVE MT-FSCL-MN-NM-ABBREV (SS-CURR-MN) TO DML3-MONTH-ABBREV.         
                                                                                
      *    THIS YEAR MONTHLY SALES AMOUNT                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-NET-SALES-AMT(SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-TY-NET-SALES-AMT.                      
                                                                                
      *    FORECAST MONTHLY SALES AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-FC-NET-SALES-AMT(SS-CURR-LVL SS-CURR-MN)                  
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-FC-NET-SALES-AMT.                      
                                                                                
      *    FORECAST MONTHLY SALES PERCENT                                       
           IF AT-FC-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
              AND (SS-CURR-MN <= SS-OPEN-MN)                                    
               COMPUTE PV-PCT ROUNDED                                           
                 =(((AT-TY-NET-SALES-AMT  (SS-CURR-LVL SS-CURR-MN)              
                 /   PC-THOUSAND)                                               
                 -  AT-FC-NET-SALES-AMT  (SS-CURR-LVL SS-CURR-MN))              
                 * 100)                                                         
                 / AT-FC-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML3-FC-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-FC-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-FC-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-FC-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-FC-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY SALES AMOUNT                                         
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-PL-NET-SALES-AMT(SS-CURR-LVL SS-CURR-MN)                  
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-PL-NET-SALES-AMT.                      
                                                                                
      *    PLANNED MONTHLY SALES PERCENT                                        
           IF AT-PL-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
              AND (SS-CURR-MN <= SS-OPEN-MN)                                    
               COMPUTE PV-PCT ROUNDED                                           
                 =(((AT-TY-NET-SALES-AMT  (SS-CURR-LVL SS-CURR-MN)              
                 /   PC-THOUSAND)                                               
                 -  AT-PL-NET-SALES-AMT  (SS-CURR-LVL SS-CURR-MN))              
                 * 100)                                                         
                 / AT-PL-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML3-PL-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-PL-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-PL-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-PL-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-PL-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY SALES AMOUNT                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-LY-NET-SALES-AMT(SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-LY-NET-SALES-AMT.                      
                                                                                
      *    LAST YEAR MONTHLY SALES PERCENT                                      
           IF AT-LY-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
              AND (SS-CURR-MN <= SS-OPEN-MN)                                    
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-TY-NET-SALES-AMT  (SS-CURR-LVL SS-CURR-MN)               
                 -  AT-LY-NET-SALES-AMT  (SS-CURR-LVL SS-CURR-MN))              
                 * 100)                                                         
                 / AT-LY-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML3-LY-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-LY-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-LY-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-LY-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-LY-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    THIS YEAR MONTHLY MARKDOWN AMOUNT                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-MKDN-RTL-AMT  (SS-CURR-LVL SS-CURR-MN)                 
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-TY-MKDN-RTL-AMT.                       
                                                                                
      *    THIS YEAR MONTHLY MARKDOWN PERCENT                                   
           IF AT-TY-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
               COMPUTE PV-PCT ROUNDED                                           
                 = (AT-TY-MKDN-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)              
                 * 100)                                                         
                 / AT-TY-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML3-TY-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-TY-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-TY-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-TY-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-TY-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    FORECAST MONTHLY MARKDOWN AMOUNT                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-FC-MKDN-RTL-AMT  (SS-CURR-LVL SS-CURR-MN)                 
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-FC-MKDN-RTL-AMT.                       
                                                                                
      *    FORECAST MONTHLY MARKDOWN PERCENT                                    
           IF AT-FC-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
               COMPUTE PV-PCT ROUNDED                                           
                 = (AT-FC-MKDN-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)              
                 * 100)                                                         
                 / AT-FC-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML3-FC-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-FC-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-FC-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-FC-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-FC-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY MARKDOWN AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-PL-MKDN-RTL-AMT  (SS-CURR-LVL SS-CURR-MN)                 
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-PL-MKDN-RTL-AMT.                       
                                                                                
      *    PLANNED MONTHLY MARKDOWN PERCENT                                     
           IF AT-PL-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
               COMPUTE PV-PCT ROUNDED                                           
                 = (AT-PL-MKDN-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)              
                 * 100)                                                         
                 / AT-PL-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML3-PL-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-PL-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-PL-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-PL-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-PL-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY MARKDOWN AMOUNT                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-LY-MKDN-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)             
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-LY-MKDN-RTL-AMT.                       
                                                                                
      *    LAST YEAR MONTHLY MARKDOWN PERCENT                                   
           IF AT-LY-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
               COMPUTE PV-PCT ROUNDED                                           
                 =(AT-LY-MKDN-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)               
                 * 100)                                                         
                 / AT-LY-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML3-LY-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-LY-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-LY-MKDN-PCT = SPACES                                         
               MOVE SPACES           TO DML3-LY-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-LY-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
           PERFORM 7620-PRINT-MN-S2-DETAIL-LINE.                                
                                                                                
           IF (SS-CURR-MN = 6           OR                                      
               SS-CURR-MN = 12    )                                             
               PERFORM 4450-PROCESS-SEASON-TOTALS-S2                            
           END-IF.                                                              
                                                                                
       4450-PROCESS-SEASON-TOTALS-S2.                                           
                                                                                
      ******************************************************************        
      * SET UP THE DETAIL LINE FOR THE END OF SEASON INFO.                      
      ******************************************************************        
                                                                                
           INITIALIZE DML3-DETAIL-MN-LINE-3.                                    
                                                                                
           IF SS-CURR-MN < 7                                                    
               MOVE 1        TO SS-SEASON                                       
               MOVE 'SPR'    TO DML3-MONTH-ABBREV                               
           ELSE                                                                 
               MOVE 2        TO SS-SEASON                                       
               MOVE 'FAL'    TO DML3-MONTH-ABBREV                               
           END-IF.                                                              
                                                                                
      *    THIS YEAR NET SALES AMOUNT                                           
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-TY-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-TY-NET-SALES-AMT.                      
                                                                                
      *    FORECAST NET SALES AMOUNT                                            
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-FC-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-FC-NET-SALES-AMT.                      
                                                                                
      *    FORECAST MONTHLY SALES PERCENT                                       
           IF AT-SEAS-FC-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =(((AT-SEAS-TY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON)            
                 /   PC-THOUSAND)                                               
                 -  AT-SEAS-FC-NET-SALES-AMT(SS-CURR-LVL SS-SEASON))            
                 * 100)                                                         
                 / AT-SEAS-FC-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
               MOVE PV-PCT           TO DML3-FC-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-FC-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-FC-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-FC-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-FC-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY SALES AMOUNT                                         
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-PL-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-PL-NET-SALES-AMT.                      
                                                                                
      *    PLANNED MONTHLY SALES PERCENT                                        
           IF AT-SEAS-TY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
              AND                                                               
              AT-SEAS-PL-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =(((AT-SEAS-TY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON)            
                 /   PC-THOUSAND)                                               
                 -  AT-SEAS-PL-NET-SALES-AMT(SS-CURR-LVL SS-SEASON))            
                 * 100)                                                         
                 / AT-SEAS-PL-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
               MOVE PV-PCT           TO DML3-PL-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-PL-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-PL-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-PL-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-PL-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY SALES AMOUNT                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-LY-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-LY-NET-SALES-AMT.                      
                                                                                
      *    LAST YEAR MONTHLY SALES PERCENT                                      
           IF AT-SEAS-TY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
              AND                                                               
              AT-SEAS-LY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-SEAS-TY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON)             
                 -  AT-SEAS-LY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON))            
                 * 100)                                                         
                 / AT-SEAS-LY-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
               MOVE PV-PCT           TO DML3-LY-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-LY-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-LY-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-LY-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-LY-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    THIS YEAR MONTHLY MARKDOWN AMOUNT                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-TY-MKDN-RTL-AMT  (SS-CURR-LVL SS-SEASON)             
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-TY-MKDN-RTL-AMT.                       
                                                                                
      *    THIS YEAR MONTHLY MARKDOWN PERCENT                                   
           IF AT-SEAS-TY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =(AT-SEAS-TY-MKDN-RTL-AMT  (SS-CURR-LVL SS-SEASON)             
                 * 100)                                                         
                 / AT-SEAS-TY-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
               MOVE PV-PCT           TO DML3-TY-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-TY-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-TY-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-TY-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-TY-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    FORECAST MONTHLY MARKDOWN AMOUNT                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-FC-MKDN-RTL-AMT  (SS-CURR-LVL SS-SEASON)             
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-FC-MKDN-RTL-AMT.                       
                                                                                
      *    FORECAST MONTHLY MARKDOWN PERCENT                                    
           IF AT-SEAS-FC-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =(AT-SEAS-FC-MKDN-RTL-AMT  (SS-CURR-LVL SS-SEASON)             
                 * 100)                                                         
                 / AT-SEAS-FC-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
               MOVE PV-PCT           TO DML3-FC-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-FC-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-FC-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-FC-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-FC-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY MARKDOWN AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-PL-MKDN-RTL-AMT  (SS-CURR-LVL SS-SEASON)             
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-PL-MKDN-RTL-AMT.                       
                                                                                
      *    PLANNED MONTHLY MARKDOWN PERCENT                                     
           IF AT-SEAS-PL-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =(AT-SEAS-PL-MKDN-RTL-AMT  (SS-CURR-LVL SS-SEASON)             
                 * 100)                                                         
                 / AT-SEAS-PL-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
               MOVE PV-PCT           TO DML3-PL-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-PL-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-PL-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-PL-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-PL-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY MARKDOWN AMOUNT                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-LY-MKDN-RTL-AMT (SS-CURR-LVL SS-SEASON)              
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-LY-MKDN-RTL-AMT.                       
                                                                                
      *    LAST YEAR MONTHLY MARKDOWN PERCENT                                   
           IF AT-SEAS-LY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =(AT-SEAS-LY-MKDN-RTL-AMT  (SS-CURR-LVL SS-SEASON)             
                 * 100)                                                         
                 / AT-SEAS-LY-NET-SALES-AMT (SS-CURR-LVL SS-SEASON)             
               MOVE PV-PCT           TO DML3-LY-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-LY-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-LY-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-LY-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-LY-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL3-UNDER-LINE-3                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           PERFORM 7710-PRINT-TOTAL-LINE-MN-S2.                                 
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
       4500-PROCESS-YTD-S2-TOTAL-LINE.                                          
      ******************************************************************        
      *    CALCULATE AND PRINT THE YTD TOTALS FOR                               
      *    THE MONTHLY SECTION 2 ON THE SECOND PAGE OF THE REPORT.              
      *                                                                         
      ******************************************************************        
           COMPUTE YTD-TY-NET-SALES-AMT                                         
                 = AT-SEAS-TY-NET-SALES-AMT     (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-NET-SALES-AMT     (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-FC-NET-SALES-AMT                                         
                 = AT-SEAS-FC-NET-SALES-AMT     (SS-CURR-LVL 1)                 
                 + AT-SEAS-FC-NET-SALES-AMT     (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-PL-NET-SALES-AMT                                         
                 = AT-SEAS-PL-NET-SALES-AMT     (SS-CURR-LVL 1)                 
                 + AT-SEAS-PL-NET-SALES-AMT     (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-LY-NET-SALES-AMT                                         
                 = AT-SEAS-LY-NET-SALES-AMT     (SS-CURR-LVL 1)                 
                 + AT-SEAS-LY-NET-SALES-AMT     (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-TY-MKDN-RTL-AMT                                          
                 = AT-SEAS-TY-MKDN-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-MKDN-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-FC-MKDN-RTL-AMT                                          
                 = AT-SEAS-FC-MKDN-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-FC-MKDN-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-PL-MKDN-RTL-AMT                                          
                 = AT-SEAS-PL-MKDN-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-PL-MKDN-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-LY-MKDN-RTL-AMT                                          
                 = AT-SEAS-LY-MKDN-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-LY-MKDN-RTL-AMT      (SS-CURR-LVL 2).                
                                                                                
                                                                                
           INITIALIZE     DML3-DETAIL-MN-LINE-3.                                
           MOVE 'YTD'  TO DML3-MONTH-ABBREV.                                    
                                                                                
      *    THIS YEAR NET SALES AMOUNT                                           
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-TY-NET-SALES-AMT                                         
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-TY-NET-SALES-AMT.                      
                                                                                
      *    FORECAST NET SALES AMOUNT                                            
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-FC-NET-SALES-AMT                                         
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-FC-NET-SALES-AMT.                      
                                                                                
      *    FORECAST MONTHLY SALES PERCENT                                       
           IF YTD-FC-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT ROUNDED                                           
                 =(((YTD-TY-NET-SALES-AMT                                       
                 /   PC-THOUSAND)                                               
                 -  YTD-FC-NET-SALES-AMT)                                       
                 * 100)                                                         
                 / YTD-FC-NET-SALES-AMT                                         
               MOVE PV-PCT           TO DML3-FC-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-FC-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-FC-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-FC-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-FC-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY SALES AMOUNT                                         
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-PL-NET-SALES-AMT                                         
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-PL-NET-SALES-AMT.                      
                                                                                
      *    PLANNED MONTHLY SALES PERCENT                                        
           IF YTD-PL-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT ROUNDED                                           
                 =(((YTD-TY-NET-SALES-AMT                                       
                 /   PC-THOUSAND)                                               
                 -  YTD-PL-NET-SALES-AMT)                                       
                 * 100)                                                         
                 / YTD-PL-NET-SALES-AMT                                         
               MOVE PV-PCT           TO DML3-PL-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-PL-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-PL-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-PL-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-PL-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY SALES AMOUNT                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-LY-NET-SALES-AMT                                         
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-LY-NET-SALES-AMT.                      
                                                                                
      *    LAST YEAR MONTHLY SALES PERCENT                                      
           IF YTD-LY-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT ROUNDED                                           
                 =((YTD-TY-NET-SALES-AMT                                        
                 -  YTD-LY-NET-SALES-AMT)                                       
                 * 100)                                                         
                 / YTD-LY-NET-SALES-AMT                                         
               MOVE PV-PCT           TO DML3-LY-NET-SALES-PCT                   
           ELSE                                                                 
               MOVE ZERO             TO DML3-LY-NET-SALES-PCT                   
           END-IF.                                                              
                                                                                
           IF DML3-LY-NET-SALES-PCT = SPACES                                    
               MOVE SPACE            TO DML3-LY-NET-SALES-PCT-C                 
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-LY-NET-SALES-PCT-C                 
           END-IF.                                                              
                                                                                
      *    THIS YEAR MONTHLY MARKDOWN AMOUNT                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-TY-MKDN-RTL-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-TY-MKDN-RTL-AMT.                       
                                                                                
      *    THIS YEAR MONTHLY MARKDOWN PERCENT                                   
           IF YTD-TY-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT ROUNDED                                           
                 =(YTD-TY-MKDN-RTL-AMT                                          
                 * 100)                                                         
                 / YTD-TY-NET-SALES-AMT                                         
               MOVE PV-PCT           TO DML3-TY-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-TY-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-TY-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-TY-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-TY-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    FORECAST MONTHLY MARKDOWN AMOUNT                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-FC-MKDN-RTL-AMT                                          
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-FC-MKDN-RTL-AMT.                       
                                                                                
      *    FORECAST MONTHLY MARKDOWN PERCENT                                    
           IF YTD-FC-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT ROUNDED                                           
                 =(YTD-FC-MKDN-RTL-AMT                                          
                 * 100)                                                         
                 / YTD-FC-NET-SALES-AMT                                         
               MOVE PV-PCT           TO DML3-FC-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-FC-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-FC-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-FC-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-FC-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY MARKDOWN AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-PL-MKDN-RTL-AMT                                          
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML3-PL-MKDN-RTL-AMT.                       
                                                                                
      *    PLANNED MONTHLY MARKDOWN PERCENT                                     
           IF YTD-PL-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT ROUNDED                                           
                 =(YTD-PL-MKDN-RTL-AMT                                          
                 * 100)                                                         
                 / YTD-PL-NET-SALES-AMT                                         
               MOVE PV-PCT           TO DML3-PL-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-PL-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-PL-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-PL-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-PL-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY MARKDOWN AMOUNT                                    
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-LY-MKDN-RTL-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML3-LY-MKDN-RTL-AMT.                       
                                                                                
      *    LAST YEAR MONTHLY MARKDOWN PERCENT                                   
           IF YTD-LY-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT ROUNDED                                           
                 =(YTD-LY-MKDN-RTL-AMT                                          
                 * 100)                                                         
                 / YTD-LY-NET-SALES-AMT                                         
               MOVE PV-PCT           TO DML3-LY-MKDN-PCT                        
           ELSE                                                                 
               MOVE ZERO             TO DML3-LY-MKDN-PCT                        
           END-IF.                                                              
                                                                                
           IF DML3-LY-MKDN-PCT = SPACES                                         
               MOVE SPACE            TO DML3-LY-MKDN-PCT-C                      
           ELSE                                                                 
               MOVE PC-PCT           TO DML3-LY-MKDN-PCT-C                      
           END-IF.                                                              
                                                                                
           PERFORM 7710-PRINT-TOTAL-LINE-MN-S2.                                 
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
                                                                                
       4600-PROCESS-MONTH-S3-DET-LINE.                                          
                                                                                
      ******************************************************************        
      * BUILD THE DETAIL LINE FOR THE CURRENT MONTH.                            
      ******************************************************************        
                                                                                
           MOVE MT-FSCL-MN-NM-ABBREV (SS-CURR-MN) TO DML4-MONTH-ABBREV.         
                                                                                
      *    THIS YEAR MONTHLY COMP INVENTORY AMOUNT                              
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-COMP-INV-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-COMP-INV-AMT.                       
                                                                                
      *    PLANNED MONTHLY COMP INVENTORY AMOUNT                                
21517      COMPUTE PV-AMT-RNDED ROUNDED                                         
21517            = AT-PL-CMPR-END-INV-AMT (SS-CURR-LVL SS-CURR-MN)              
21517?           / PC-ONE.                                                      
21517      MOVE PV-AMT-RNDED     TO DML4-PL-COMP-INV-AMT.                       
                                                                                
      *    PLANNED MONTHLY COMP INVENTORY PERCENT                               
           MOVE ZEROES           TO DML4-PL-COMP-INV-PCT.                       
           MOVE SPACE            TO DML4-PL-COMP-INV-PCT-C.                     
           IF (SS-CURR-MN > SS-OPEN-MN)                                         
              NEXT SENTENCE                                                     
           ELSE                                                                 
               IF AT-PL-CMPR-END-INV-AMT (SS-CURR-LVL SS-CURR-MN)               
                  NOT = ZERO                                                    
                   COMPUTE PV-PCT ROUNDED                                       
                     =(((AT-TY-COMP-INV-AMT   (SS-CURR-LVL SS-CURR-MN)          
                       / PC-THOUSAND)                                           
                     -  AT-PL-CMPR-END-INV-AMT(SS-CURR-LVL SS-CURR-MN))         
                     * 100)                                                     
                     / AT-PL-CMPR-END-INV-AMT (SS-CURR-LVL SS-CURR-MN)          
                   MOVE PV-PCT           TO DML4-PL-COMP-INV-PCT                
                   MOVE PC-PCT           TO DML4-PL-COMP-INV-PCT-C              
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY COMP INVENTORY AMOUNT                              
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-LY-COMP-INV-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-LY-COMP-INV-AMT.                       
                                                                                
      *    LAST YEAR MONTHLY COMP INVENTORY PERCENT                             
           IF (SS-CURR-MN > SS-OPEN-MN)                                         
              MOVE SPACES TO DML4-LY-COMP-INV-PCT-BLANK                         
           ELSE                                                                 
               IF AT-LY-COMP-INV-AMT (SS-CURR-LVL SS-CURR-MN)                   
                  NOT = ZERO                                                    
                   COMPUTE PV-PCT ROUNDED                                       
                     =((AT-TY-COMP-INV-AMT   (SS-CURR-LVL SS-CURR-MN)           
                     -  AT-LY-COMP-INV-AMT   (SS-CURR-LVL SS-CURR-MN))          
                     * 100)                                                     
                     / AT-LY-COMP-INV-AMT    (SS-CURR-LVL SS-CURR-MN)           
                   MOVE PV-PCT           TO DML4-LY-COMP-INV-PCT                
               ELSE                                                             
                   MOVE ZERO             TO DML4-LY-COMP-INV-PCT                
               END-IF.                                                          
                                                                                
           IF DML4-LY-COMP-INV-PCT = SPACES                                     
               MOVE SPACE            TO DML4-LY-COMP-INV-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-COMP-INV-PCT-C                  
           END-IF.                                                              
                                                                                
      *    THIS YEAR MONTHLY MARKON PERCENT                                     
           IF AT-TY-PRCH-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO            
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-TY-PRCH-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)               
                 -  AT-TY-PRCH-NET-COST-AMT(SS-CURR-LVL SS-CURR-MN))            
                 * 100)                                                         
                 / AT-TY-PRCH-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT           TO DML4-TY-MARKON-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DML4-TY-MARKON-PCT                      
           END-IF.                                                              
                                                                                
           IF DML4-TY-MARKON-PCT = SPACES                                       
               MOVE SPACE            TO DML4-TY-MARKON-PCT-C                    
           ELSE                                                                 
               IF PV-PCT > 99999.9                                              
                 OR PV-PCT < - 99999.9                                          
                   MOVE PC-PCT-OVER  TO DML4-TY-MARKON-PCT-OVFL                 
                   MOVE SPACE        TO DML4-TY-MARKON-PCT-C                    
               ELSE                                                             
                   MOVE PC-PCT       TO DML4-TY-MARKON-PCT-C                    
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY MARKON PERCENT                                       
           COMPUTE PV-PCT ROUNDED                                               
                 = AT-PL-MKUP-RTL-PCT   (SS-CURR-LVL SS-CURR-MN)                
                 / PC-ONE.                                                      
           MOVE PV-PCT           TO DML4-PL-MARKON-PCT.                         
                                                                                
           IF DML4-PL-MARKON-PCT = SPACES                                       
               MOVE SPACE            TO DML4-PL-MARKON-PCT-C                    
           ELSE                                                                 
               IF PV-PCT > 99999.9                                              
                 OR PV-PCT < - 99999.9                                          
                   MOVE '******* '   TO DML4-PL-MARKON-PCT-OVFL                 
                   MOVE SPACE        TO DML4-PL-MARKON-PCT-C                    
               ELSE                                                             
                   MOVE PC-PCT       TO DML4-PL-MARKON-PCT-C                    
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY MARKON PERCENT                                     
           IF AT-LY-PRCH-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO            
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-LY-PRCH-RTL-AMT     (SS-CURR-LVL SS-CURR-MN)             
                 -  AT-LY-PRCH-NET-COST-AMT(SS-CURR-LVL SS-CURR-MN))            
                 * 100)                                                         
                 / AT-LY-PRCH-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)             
               MOVE PV-PCT           TO DML4-LY-MARKON-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-MARKON-PCT                      
           END-IF.                                                              
                                                                                
           IF DML4-LY-MARKON-PCT = SPACES                                       
               MOVE SPACE            TO DML4-LY-MARKON-PCT-C                    
           ELSE                                                                 
               IF PV-PCT > 99999.9                                              
                 OR PV-PCT < - 99999.9                                          
                   MOVE '******* '   TO DML4-LY-MARKON-PCT-OVFL                 
                   MOVE SPACE        TO DML4-LY-MARKON-PCT-C                    
               ELSE                                                             
                   MOVE PC-PCT       TO DML4-LY-MARKON-PCT-C                    
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    THIS YEAR GROSS MARGIN AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-GRO-MRGN-AMT   (SS-CURR-LVL SS-CURR-MN)                
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-GRO-MRGN-AMT.                       
                                                                                
      *    THIS YEAR GROSS MARGIN PERCENT                                       
           IF SS-CURR-MN >  SS-OPEN-MN                                          
               MOVE SPACES TO DML4-TY-GRO-MRGN-PCT-BLANK                        
           ELSE                                                                 
               IF AT-TY-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN)                  
                  NOT = ZERO                                                    
                   COMPUTE PV-PCT-DEC-TWO ROUNDED                               
                     =( AT-TY-GRO-MRGN-AMT   (SS-CURR-LVL SS-CURR-MN)           
                     * 100)                                                     
                     / AT-TY-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)           
                   MOVE PV-PCT-DEC-TWO   TO DML4-TY-GRO-MRGN-PCT                
               ELSE                                                             
                   MOVE ZERO             TO DML4-TY-GRO-MRGN-PCT                
               END-IF.                                                          
                                                                                
           IF DML4-TY-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-TY-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-TY-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    PLANNED GROSS MARGIN AMOUNT                                          
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-PL-GRO-MRGN-AMT   (SS-CURR-LVL SS-CURR-MN)                
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML4-PL-GRO-MRGN-AMT.                       
                                                                                
      *    PLANNED GROSS MARGIN PERCENT                                         
           IF AT-PL-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =( AT-PL-GRO-MRGN-AMT   (SS-CURR-LVL SS-CURR-MN)               
                 * 100)                                                         
                 / AT-PL-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT-DEC-TWO  TO DML4-PL-GRO-MRGN-PCT                     
           ELSE                                                                 
               MOVE ZERO             TO DML4-PL-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-PL-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-PL-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-PL-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    LAST YEAR GROSS MARGIN AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-LY-GRO-MRGN-AMT   (SS-CURR-LVL SS-CURR-MN)                
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-LY-GRO-MRGN-AMT.                       
                                                                                
      *    LAST YEAR GROSS MARGIN PERCENT                                       
           IF AT-LY-NET-SALES-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO           
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =( AT-LY-GRO-MRGN-AMT   (SS-CURR-LVL SS-CURR-MN)               
                 * 100)                                                         
                 / AT-LY-NET-SALES-AMT   (SS-CURR-LVL SS-CURR-MN)               
               MOVE PV-PCT-DEC-TWO   TO DML4-LY-GRO-MRGN-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-LY-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-LY-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    THIS YEAR COST OF SALES AMOUNT                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-SLS-COST-AMT   (SS-CURR-LVL SS-CURR-MN)                
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-SLS-COST-AMT.                       
                                                                                
           PERFORM 7630-PRINT-MN-S3-DETAIL-LINE.                                
                                                                                
      *                                                                         
           IF (SS-CURR-MN = 6           OR                                      
               SS-CURR-MN = 12    )                                             
               PERFORM 4650-PROCESS-SEASON-TOTALS-S3                            
           END-IF.                                                              
                                                                                
           IF (SS-CURR-MN     = 6)                                              
               MOVE AT-TY-END-INV-COST-AMT (SS-CURR-LVL SS-CURR-MN)             
                    TO PV-TY-BEG-INV-COST-AMT                                   
               MOVE AT-TY-END-INV-RTL-AMT (SS-CURR-LVL SS-CURR-MN)              
                    TO PV-TY-BEG-INV-RTL-AMT                                    
               MOVE AT-LY-END-INV-COST-AMT (SS-CURR-LVL SS-CURR-MN)             
                    TO PV-LY-BEG-INV-COST-AMT                                   
               MOVE AT-LY-END-INV-RTL-AMT (SS-CURR-LVL SS-CURR-MN)              
                    TO PV-LY-BEG-INV-RTL-AMT                                    
           END-IF.                                                              
                                                                                
                                                                                
       4650-PROCESS-SEASON-TOTALS-S3.                                           
                                                                                
      ******************************************************************        
      * SET UP THE DETAIL LINE FOR THE END OF SEASON INFO.                      
      ******************************************************************        
                                                                                
           INITIALIZE DML4-DETAIL-MN-LINE-4.                                    
                                                                                
           IF SS-CURR-MN < 7                                                    
               MOVE 1        TO SS-SEASON                                       
               MOVE 'SPR'    TO DML4-MONTH-ABBREV                               
           ELSE                                                                 
               MOVE 2        TO SS-SEASON                                       
               MOVE 'FAL'    TO DML4-MONTH-ABBREV                               
           END-IF.                                                              
                                                                                
      *    THIS YEAR COMP INVENTORY AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-TY-COMP-INV-AMT      (SS-CURR-LVL SS-SEASON)         
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-COMP-INV-AMT.                       
                                                                                
      *    LAST YEAR COMP INVENTORY AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-LY-COMP-INV-AMT      (SS-CURR-LVL SS-SEASON)         
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-LY-COMP-INV-AMT.                       
                                                                                
      *    LAST YEAR COMP INVENTORY PERCENT                                     
           IF AT-SEAS-TY-COMP-INV-AMT (SS-CURR-LVL SS-SEASON) = ZERO            
               MOVE SPACES           TO DML4-LY-COMP-INV-PCT-BLANK              
           ELSE                                                                 
           IF AT-SEAS-LY-COMP-INV-AMT (SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-SEAS-TY-COMP-INV-AMT (SS-CURR-LVL SS-SEASON)             
                 -  AT-SEAS-LY-COMP-INV-AMT (SS-CURR-LVL SS-SEASON))            
                 * 100)                                                         
                 / AT-SEAS-LY-COMP-INV-AMT (SS-CURR-LVL SS-SEASON)              
               MOVE PV-PCT           TO DML4-LY-COMP-INV-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-COMP-INV-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-LY-COMP-INV-PCT = SPACES                                     
               MOVE SPACE            TO DML4-LY-COMP-INV-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-COMP-INV-PCT-C                  
           END-IF.                                                              
                                                                                
      *    THIS YEAR MONTHLY MARKON PERCENT                                     
408081**** IF AT-SEAS-TY-RCPT-RTL-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO         
408081     IF AT-SEAS-TY-PRCH-RTL-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO         
              COMPUTE PV-PCT ROUNDED                                            
              =(((AT-SEAS-TY-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)               
              -   AT-SEAS-TY-PRCH-NET-COST-AMT                                  
                                          (SS-CURR-LVL SS-SEASON))              
              *   100)                                                          
              /   AT-SEAS-TY-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON))              
              MOVE PV-PCT           TO DML4-TY-MARKON-PCT                       
           ELSE                                                                 
              MOVE ZERO             TO DML4-TY-MARKON-PCT                       
           END-IF.                                                              
                                                                                
           IF DML4-TY-MARKON-PCT = SPACES                                       
              MOVE SPACE            TO DML4-TY-MARKON-PCT-C                     
           ELSE                                                                 
              MOVE PC-PCT           TO DML4-TY-MARKON-PCT-C                     
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY MARKON PERCENT                                       
      *    THIS VALUE COMES DIRECTLY FROM PLANNING.  IT IS                      
      *    ALREADY CALCULATED WHEN WE GET IT FROM PLANNING                      
           IF AT-SEAS-PL-CUM-MKUP-PCT (SS-CURR-LVL SS-SEASON) = ZERO            
               MOVE ZERO             TO DML4-PL-MARKON-PCT                      
           ELSE                                                                 
               MOVE AT-SEAS-PL-CUM-MKUP-PCT (SS-CURR-LVL SS-SEASON)             
                                     TO DML4-PL-MARKON-PCT                      
           END-IF.                                                              
                                                                                
           IF DML4-PL-MARKON-PCT = SPACES                                       
               MOVE SPACE            TO DML4-PL-MARKON-PCT-C                    
           ELSE                                                                 
               IF AT-SEAS-PL-CUM-MKUP-PCT (SS-CURR-LVL SS-SEASON)               
                                     > 99999.9                                  
                 OR AT-SEAS-PL-CUM-MKUP-PCT (SS-CURR-LVL SS-SEASON)             
                                     < - 99999.9                                
                   MOVE '******* '   TO DML4-PL-MARKON-PCT-OVFL                 
                   MOVE SPACE        TO DML4-PL-MARKON-PCT-C                    
               ELSE                                                             
                   MOVE PC-PCT       TO DML4-PL-MARKON-PCT-C                    
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    LAST YEAR MONTHLY MARKON PERCENT                                     
DIVDBY     IF AT-SEAS-LY-PRCH-RTL-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO         
               COMPUTE PV-PCT ROUNDED                                           
               =(((AT-SEAS-LY-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)              
               -   AT-SEAS-LY-PRCH-NET-COST-AMT                                 
                                           (SS-CURR-LVL SS-SEASON))             
               *   100)                                                         
               /   AT-SEAS-LY-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON))             
               MOVE PV-PCT           TO DML4-LY-MARKON-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-MARKON-PCT                      
           END-IF.                                                              
                                                                                
           IF DML4-LY-MARKON-PCT = SPACES                                       
               MOVE SPACE            TO DML4-LY-MARKON-PCT-C                    
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-MARKON-PCT-C                    
           END-IF.                                                              
                                                                                
      *    THIS YEAR GROSS MARGIN AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-TY-GRO-MRGN-AMT      (SS-CURR-LVL SS-SEASON)         
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-GRO-MRGN-AMT.                       
                                                                                
      *    THIS YEAR GROSS MARGIN PERCENT                                       
           IF AT-SEAS-TY-GRO-MRGN-AMT(SS-CURR-LVL SS-SEASON) = ZERO             
              MOVE SPACES            TO DML4-TY-GRO-MRGN-PCT-BLANK              
           ELSE                                                                 
           IF AT-SEAS-TY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =(AT-SEAS-TY-GRO-MRGN-AMT      (SS-CURR-LVL SS-SEASON)         
                 * 100)                                                         
                 / AT-SEAS-TY-NET-SALES-AMT     (SS-CURR-LVL SS-SEASON)         
               MOVE PV-PCT-DEC-TWO   TO DML4-TY-GRO-MRGN-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-TY-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-TY-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-TY-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-TY-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    PLANNED GROSS MARGIN AMOUNT                                          
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-SEAS-PL-GRO-MRGN-AMT      (SS-CURR-LVL SS-SEASON)         
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML4-PL-GRO-MRGN-AMT.                       
                                                                                
      *    PLANNED GROSS MARGIN PERCENT                                         
           IF AT-SEAS-PL-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =(AT-SEAS-PL-GRO-MRGN-AMT      (SS-CURR-LVL SS-SEASON)         
                 * 100)                                                         
                 / AT-SEAS-PL-NET-SALES-AMT     (SS-CURR-LVL SS-SEASON)         
               MOVE PV-PCT-DEC-TWO   TO DML4-PL-GRO-MRGN-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-PL-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-PL-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-PL-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-PL-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    LAST YEAR GROSS MARGIN AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 =  AT-SEAS-LY-GRO-MRGN-AMT     (SS-CURR-LVL SS-SEASON)         
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-LY-GRO-MRGN-AMT.                       
                                                                                
      *    LAST YEAR GROSS MARGIN PERCENT                                       
           IF AT-SEAS-LY-NET-SALES-AMT(SS-CURR-LVL SS-SEASON) NOT = ZERO        
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =( AT-SEAS-LY-GRO-MRGN-AMT     (SS-CURR-LVL SS-SEASON)         
                 * 100)                                                         
                 / AT-SEAS-LY-NET-SALES-AMT     (SS-CURR-LVL SS-SEASON)         
               MOVE PV-PCT-DEC-TWO   TO DML4-LY-GRO-MRGN-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-LY-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-LY-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    THIS YEAR COST OF SALES AMOUNT                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 =  AT-SEAS-TY-SLS-COST-AMT     (SS-CURR-LVL SS-SEASON)         
                / PC-THOUSAND.                                                  
           MOVE PV-AMT-RNDED     TO DML4-TY-SLS-COST-AMT.                       
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL4-UNDER-LINE-4                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           PERFORM 7720-PRINT-TOTAL-LINE-MN-S3.                                 
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
       4700-PROCESS-YTD-S3-TOTAL-LINE.                                          
      ******************************************************************        
      *    CALCULATE AND PRINT THE YTD TOTALS FOR                               
      *    THE MONTHLY SECTION 3 ON THE SECOND PAGE OF THE REPORT.              
      *    COMP INVENTORY IS NOT INCLUDED IN THE YTD TOTALS BECAUSE             
      *    ENDING INVENTORY IS NOT AN ACCUMULATION.                             
      *                                                                         
      ******************************************************************        
           COMPUTE YTD-TY-PRCH-NET-COST-AMT                                     
                 = AT-SEAS-TY-PRCH-NET-COST-AMT (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-PRCH-NET-COST-AMT (SS-CURR-LVL 2)                 
                 - AT-TY-END-INV-COST-AMT       (SS-CURR-LVL 6).                
                                                                                
           COMPUTE YTD-LY-PRCH-NET-COST-AMT                                     
                 = AT-SEAS-LY-PRCH-NET-COST-AMT (SS-CURR-LVL 1)                 
                 + AT-SEAS-LY-PRCH-NET-COST-AMT (SS-CURR-LVL 2)                 
                 - AT-LY-END-INV-COST-AMT       (SS-CURR-LVL 6).                
                                                                                
           COMPUTE YTD-TY-PRCH-RTL-AMT                                          
                 = AT-SEAS-TY-PRCH-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-PRCH-RTL-AMT      (SS-CURR-LVL 2)                 
                 - AT-TY-END-INV-RTL-AMT        (SS-CURR-LVL 6).                
                                                                                
           COMPUTE YTD-LY-PRCH-RTL-AMT                                          
                 = AT-SEAS-LY-PRCH-RTL-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-LY-PRCH-RTL-AMT      (SS-CURR-LVL 2)                 
                 - AT-LY-END-INV-RTL-AMT        (SS-CURR-LVL 6).                
                                                                                
           COMPUTE YTD-TY-GRO-MRGN-AMT                                          
                 = AT-SEAS-TY-GRO-MRGN-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-GRO-MRGN-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-PL-GRO-MRGN-AMT                                          
                 = AT-SEAS-PL-GRO-MRGN-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-PL-GRO-MRGN-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-LY-GRO-MRGN-AMT                                          
                 = AT-SEAS-LY-GRO-MRGN-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-LY-GRO-MRGN-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-TY-SLS-COST-AMT                                          
                 = AT-SEAS-TY-SLS-COST-AMT      (SS-CURR-LVL 1)                 
                 + AT-SEAS-TY-SLS-COST-AMT      (SS-CURR-LVL 2).                
                                                                                
           COMPUTE YTD-FC-TOT-ORD-RTL-AMT                                       
                 = AT-SEAS-FC-TOT-ORD-RTL       (SS-CURR-LVL 1)                 
                 + AT-SEAS-FC-TOT-ORD-RTL       (SS-CURR-LVL 2).                
                                                                                
           INITIALIZE     DML4-DETAIL-MN-LINE-4.                                
           MOVE 'YTD'  TO DML4-MONTH-ABBREV.                                    
                                                                                
      *    THIS YEAR COMP INVENTORY AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-YTD-TY-COMP-INV-AMT      (SS-CURR-LVL)                    
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-COMP-INV-AMT.                       
                                                                                
      *    LAST YEAR COMP INVENTORY AMOUNT                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-YTD-LY-COMP-INV-AMT      (SS-CURR-LVL)                    
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-LY-COMP-INV-AMT.                       
                                                                                
      *    LAST YEAR COMP INVENTORY PERCENT                                     
           IF AT-YTD-LY-COMP-INV-AMT (SS-CURR-LVL) NOT = ZERO                   
               COMPUTE PV-PCT ROUNDED                                           
                 =((AT-YTD-TY-COMP-INV-AMT (SS-CURR-LVL)                        
                 -  AT-YTD-LY-COMP-INV-AMT (SS-CURR-LVL))                       
                 * 100)                                                         
                 / AT-YTD-LY-COMP-INV-AMT  (SS-CURR-LVL)                        
               MOVE PV-PCT           TO DML4-LY-COMP-INV-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-COMP-INV-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-LY-COMP-INV-PCT = SPACES                                     
               MOVE SPACE            TO DML4-LY-COMP-INV-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-COMP-INV-PCT-C                  
           END-IF.                                                              
                                                                                
      *    THIS YEAR MONTHLY MARKON PERCENT                                     
           IF YTD-TY-PRCH-RTL-AMT NOT = ZERO                                    
               COMPUTE PV-PCT ROUNDED                                           
                 =((YTD-TY-PRCH-RTL-AMT                                         
                 -  YTD-TY-PRCH-NET-COST-AMT)                                   
                 * 100)                                                         
                 / YTD-TY-PRCH-RTL-AMT                                          
               MOVE PV-PCT           TO DML4-TY-MARKON-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DML4-TY-MARKON-PCT                      
           END-IF.                                                              
                                                                                
           IF DML4-TY-MARKON-PCT = SPACES                                       
               MOVE SPACE            TO DML4-TY-MARKON-PCT-C                    
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-TY-MARKON-PCT-C                    
           END-IF.                                                              
                                                                                
      *    PLANNED MONTHLY MARKON PERCENT                                       
           MOVE ZEROES           TO DML4-PL-MARKON-PCT.                         
           MOVE SPACE            TO DML4-PL-MARKON-PCT-C.                       
                                                                                
      *    LAST YEAR MONTHLY MARKON PERCENT                                     
           IF YTD-LY-PRCH-RTL-AMT NOT = ZERO                                    
               COMPUTE PV-PCT ROUNDED                                           
                 =((YTD-LY-PRCH-RTL-AMT                                         
                 -  YTD-LY-PRCH-NET-COST-AMT)                                   
                 * 100)                                                         
                 / YTD-LY-PRCH-RTL-AMT                                          
               MOVE PV-PCT           TO DML4-LY-MARKON-PCT                      
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-MARKON-PCT                      
           END-IF.                                                              
                                                                                
           IF DML4-LY-MARKON-PCT = SPACES                                       
               MOVE SPACE            TO DML4-LY-MARKON-PCT-C                    
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-MARKON-PCT-C                    
           END-IF.                                                              
                                                                                
      *    THIS YEAR GROSS MARGIN AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-TY-GRO-MRGN-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-GRO-MRGN-AMT.                       
                                                                                
      *    THIS YEAR GROSS MARGIN PERCENT                                       
           IF YTD-TY-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =(YTD-TY-GRO-MRGN-AMT                                          
                 * 100)                                                         
                 / YTD-TY-NET-SALES-AMT                                         
               MOVE PV-PCT-DEC-TWO   TO DML4-TY-GRO-MRGN-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-TY-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-TY-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-TY-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-TY-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    PLANNED GROSS MARGIN AMOUNT                                          
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-PL-GRO-MRGN-AMT                                          
                 / PC-ONE.                                                      
           MOVE PV-AMT-RNDED     TO DML4-PL-GRO-MRGN-AMT.                       
                                                                                
      *    PLANNED GROSS MARGIN PERCENT                                         
           IF YTD-PL-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =(YTD-PL-GRO-MRGN-AMT                                          
                 * 100)                                                         
                 / YTD-PL-NET-SALES-AMT                                         
               MOVE PV-PCT-DEC-TWO   TO DML4-PL-GRO-MRGN-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-PL-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-PL-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-PL-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-PL-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    LAST YEAR GROSS MARGIN AMOUNT                                        
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 =  YTD-LY-GRO-MRGN-AMT                                         
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-LY-GRO-MRGN-AMT.                       
                                                                                
      *    LAST YEAR GROSS MARGIN PERCENT                                       
           IF YTD-LY-NET-SALES-AMT NOT = ZERO                                   
               COMPUTE PV-PCT-DEC-TWO ROUNDED                                   
                 =( YTD-LY-GRO-MRGN-AMT                                         
                 * 100)                                                         
                 / YTD-LY-NET-SALES-AMT                                         
               MOVE PV-PCT-DEC-TWO   TO DML4-LY-GRO-MRGN-PCT                    
           ELSE                                                                 
               MOVE ZERO             TO DML4-LY-GRO-MRGN-PCT                    
           END-IF.                                                              
                                                                                
           IF DML4-LY-GRO-MRGN-PCT = SPACES                                     
               MOVE SPACE            TO DML4-LY-GRO-MRGN-PCT-C                  
           ELSE                                                                 
               MOVE PC-PCT           TO DML4-LY-GRO-MRGN-PCT-C                  
           END-IF.                                                              
                                                                                
      *    THIS YEAR COST OF SALES AMOUNT                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = YTD-TY-SLS-COST-AMT                                          
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML4-TY-SLS-COST-AMT.                       
                                                                                
           PERFORM 7720-PRINT-TOTAL-LINE-MN-S3.                                 
           PERFORM 7900-PRINT-BLANK-LINE.                                       
                                                                                
                                                                                
       4800-PROCESS-MONTH-S4-DET-LINE.                                          
                                                                                
           MOVE MT-FSCL-MN-NM-ABBREV (SS-CURR-MN) TO DML5-MONTH-ABBREV.         
                                                                                
      *    APPROVED ORDERS                                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
             = AT-FC-ONORD-EXT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                 
             / PC-THOUSAND.                                                     
                                                                                
           MOVE PV-AMT-RNDED     TO DML5-APRVD-ORD-AMT.                         
                                                                                
      *    FORECAST MARKON %                                                    
           IF AT-FC-ONORD-EXT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
              NOT = ZERO                                                        
               COMPUTE PV-PCT ROUNDED                                           
                 = ((AT-FC-ONORD-EXT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)           
                 -   AT-FC-ONORD-EXT-CST-AMT (SS-CURR-LVL SS-CURR-MN))          
                 * 100)                                                         
                 / AT-FC-ONORD-EXT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             
               MOVE PV-PCT           TO DML5-APRVC-ORD-MKON                     
           ELSE                                                                 
               MOVE ZERO             TO DML5-APRVC-ORD-MKON.                    
                                                                                
           IF DML5-APRVC-ORD-MKON = SPACES                                      
               MOVE SPACE            TO DML5-APRVC-ORD-MKON-C                   
           ELSE                                                                 
               IF PV-PCT > 9999.9                                               
                 OR PV-PCT < - 9999.9                                           
                   MOVE PC-PCT-OVER  TO DML5-APRVC-ORD-MKON-OVFL                
                   MOVE SPACE        TO DML5-APRVC-ORD-MKON-C                   
               ELSE                                                             
                   MOVE PC-PCT       TO DML5-APRVC-ORD-MKON-C                   
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    PAST DUE                                                             
           COMPUTE PV-AMT-RNDED ROUNDED                                         
             = AT-FC-PASTDUE-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                   
             / PC-THOUSAND.                                                     
           MOVE PV-AMT-RNDED     TO DML5-PASTDUE-AMT.                           
                                                                                
      *    ACTUAL RECEIPTS                                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-TY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)                  
                 / PC-THOUSAND.                                                 
           MOVE PV-AMT-RNDED     TO DML5-ACTUAL-RCPT-AMT.                       
                                                                                
      *    TOTAL COMMITMENT                                                     
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = (AT-FC-ONORD-EXT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)            
                 +  AT-FC-PASTDUE-RTL-AMT (SS-CURR-LVL SS-CURR-MN)              
                 +  AT-TY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN))                
                 /  PC-THOUSAND.                                                
           MOVE PV-AMT-RNDED     TO DML5-TOT-COMMIT-AMT.                        
                                                                                
      *    FORECAST ORDERS                                                      
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 = AT-FC-TOT-ORD-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)             
                 / PC-ONE.                                                      
                                                                                
           MOVE PV-AMT-RNDED     TO DML5-FC-ORDS-AMT.                           
                                                                                
      *    COMMITMENT/FORECAST DIFFERENCE                                       
           COMPUTE PV-AMT-RNDED ROUNDED                                         
                 =((AT-FC-ONORD-EXT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)            
                 +  AT-FC-PASTDUE-RTL-AMT (SS-CURR-LVL SS-CURR-MN)              
                 +  AT-TY-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN))                
                 /  PC-THOUSAND)                                                
                 - (AT-FC-TOT-ORD-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)            
                 /  PC-ONE).                                                    
                                                                                
           MOVE PV-AMT-RNDED     TO DML5-TC-FC-DIFF.                            
                                                                                
           PERFORM 7640-PRINT-MN-S4-DETAIL-LINE.                                
                                                                                
                                                                                
       7000-READ-LEDGER-EXTRACT-WK.                                             
                                                                                
           READ LEDGER-EXTRACT-WK-FILE INTO ML122-LEDGER-EXTRACT-WK-REC         
               AT END SET PS-END-OF-LEDGER-EXTRACT-WK TO TRUE.                  
                                                                                
                                                                                
       7050-READ-LEDGER-EXTRACT-MN.                                             
                                                                                
           READ LEDGER-EXTRACT-MN-FILE INTO ML128-LEDGER-EXTRACT-MN-REC         
               AT END SET PS-END-OF-LEDGER-EXTRACT-MN TO TRUE.                  
                                                                                
                                                                                
       7060-READ-LEDGER-EXTRACT-EOW.                                            
                                                                                
           READ LEDGER-EXTRACT-EOW-FILE                                         
               INTO ML140-LEDGER-EXTRACT-EOW-REC                                
               AT END SET PS-END-OF-LEDGER-EOW-FILE TO TRUE.                    
                                                                                
                                                                                
       7100-READ-LEDGER-EXTRACT-DATE.                                           
                                                                                
           READ LEDGER-EXTRACT-DATE-FILE                                        
               INTO ML114-LEDGER-EXTRACT-DATE-REC                               
               AT END SET PS-END-OF-LEDGER-DATE-FILE TO TRUE.                   
                                                                                
                                                                                
       7200-PRINT-PAGE-HEADINGS.                                                
                                                                                
      ******************************************************************        
      * PRINT THE PAGE HEADINGS.                                                
      * PRINT THE SUB HEADINGS BASED ON THE VALUE OF THE SUBSCRIPT.             
      ******************************************************************        
                                                                                
           ADD  1           TO PV-PAGE-CNT.                                     
           MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                              
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DP200O-STANDRD-HEADER-200-COLS                              
               AFTER ADVANCING PAGE.                                            
                                                                                
31355      IF LCHF-RPT-HEADER-ID IS EQUAL TO 'V'                                
  |            WRITE LEDGER-REPORT-RECORD                                       
  |                FROM PH2-PAGE-HEADING-2                                      
  |                AFTER ADVANCING 1 LINE                                       
31355      ELSE                                                                 
           WRITE LEDGER-REPORT-RECORD                                           
31355          FROM PH2-PAGE-HEADING-2B                                         
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM PH3-PAGE-HEADING-3                                          
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           IF SS-CURR-LVL = PC-OPERCO-LVL                                       
               WRITE LEDGER-REPORT-RECORD  FROM CH-COMPANY-HEADING              
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
           IF SS-CURR-LVL < PC-OPERCO-LVL                                       
               WRITE LEDGER-REPORT-RECORD  FROM GH-GMA-HEADING                  
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
           IF SS-CURR-LVL < PC-GMA-LVL                                          
               WRITE LEDGER-REPORT-RECORD  FROM DH-DMA-HEADING                  
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
           IF SS-CURR-LVL < PC-DMA-LVL                                          
               WRITE LEDGER-REPORT-RECORD  FROM BH-BUYER-HEADING                
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
           IF SS-CURR-LVL < PC-BYR-LVL                                          
               WRITE LEDGER-REPORT-RECORD  FROM DH-DEPT-HEADING                 
                   AFTER ADVANCING 1 LINE                                       
           END-IF.                                                              
                                                                                
                                                                                
       7300-PRINT-TOTAL-HEADING.                                                
                                                                                
           EVALUATE TRUE                                                        
               WHEN PS-BREAK-IS-OPERCO                                          
                   WRITE LEDGER-REPORT-RECORD FROM PC-COMPANY-TOTALS            
                   AFTER ADVANCING 1 LINE                                       
               WHEN PS-BREAK-IS-GMA                                             
                   WRITE LEDGER-REPORT-RECORD FROM PC-DIVISION-TOTALS           
               WHEN PS-BREAK-IS-DMA                                             
                   WRITE LEDGER-REPORT-RECORD FROM PC-MANAGER-TOTALS            
               WHEN PS-BREAK-IS-BYR                                             
                   WRITE LEDGER-REPORT-RECORD FROM PC-BUYER-TOTALS              
                   AFTER ADVANCING 1 LINE                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       7400-PRINT-WEEK-HEADINGS.                                                
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM WH1-WEEK-HEADER-1A                                          
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM WH1-WEEK-HEADER-1B                                          
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM WH1-WEEK-HEADER-1C                                          
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL1-UNDER-LINE-1                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
       7500-PRINT-MONTH-HEADINGS-SET1.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH2-MN-HEADER-2A                                            
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH2-MN-HEADER-2B                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH2-MN-HEADER-2C                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL2-UNDER-LINE-2                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
       7510-PRINT-MONTH-HEADINGS-SET2.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH3-MN-HEADER-3A                                            
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH3-MN-HEADER-3B                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH3-MN-HEADER-3C                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH3-MN-HEADER-3D                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL3-UNDER-LINE-3                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
       7520-PRINT-MONTH-HEADINGS-SET3.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH4-MN-HEADER-4A                                            
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH4-MN-HEADER-4B                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH4-MN-HEADER-4C                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL4-UNDER-LINE-4                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
       7530-PRINT-MONTH-HEADINGS-SET4.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH5-MN-HEADER-5A                                            
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH5-MN-HEADER-5B                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM MH5-MN-HEADER-5C                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM UL5-UNDER-LINE-5                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
       7600-PRINT-WK-DETAIL-LINE.                                               
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DWL1-DETAIL-WK-LINE-1                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7610-PRINT-MN-S1-DETAIL-LINE.                                            
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DML2-DETAIL-MN-LINE-2                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7620-PRINT-MN-S2-DETAIL-LINE.                                            
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DML3-DETAIL-MN-LINE-3                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7630-PRINT-MN-S3-DETAIL-LINE.                                            
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DML4-DETAIL-MN-LINE-4                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7640-PRINT-MN-S4-DETAIL-LINE.                                            
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DML5-DETAIL-MN-LINE-5                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7700-PRINT-TOTAL-LINE-MN-S1.                                             
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DML2-DETAIL-MN-LINE-2                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7710-PRINT-TOTAL-LINE-MN-S2.                                             
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DML3-DETAIL-MN-LINE-3                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7720-PRINT-TOTAL-LINE-MN-S3.                                             
                                                                                
           WRITE LEDGER-REPORT-RECORD                                           
               FROM DML4-DETAIL-MN-LINE-4                                       
               AFTER ADVANCING 1 LINE.                                          
                                                                                
                                                                                
       7900-PRINT-BLANK-LINE.                                                   
                                                                                
           INITIALIZE LEDGER-REPORT-RECORD.                                     
           WRITE LEDGER-REPORT-RECORD                                           
              AFTER ADVANCING 1 LINE.                                           
                                                                                
                                                                                
       8000-GET-DATE-ATTRIBUTES.                                                
      ******************************************************************        
      * GET THIS YEAR'S AND LAST YEAR'S DATES USED IN THIS PROGRAM.             
      *                                                                         
      * THIS QUERY HANDLES GETTING THE MONTH END DATE WHEN THE CURRENT          
      * MONTH HAS THE 53RD WEEK IN IT.                                          
      *                                                                         
      * IN THE FIRST SELECT:                                                    
      *                                                                         
      *    TABLE TDTATTR A - THIS FISCAL YEAR'S DATES                           
      *    TABLE TDTATTR B - LAST FISCAL YEAR'S DATES WHEN THIS YEAR            
      *                      ONLY HAS 52 WEEKS                                  
      *    TABLE TDTATTR C - LAST FISCAL YEAR'S DATES WHEN THIS YEAR            
      *                      HAS 53 WEEKS                                       
      *    TABLE TDTATTR D - TO GET TOTAL NUMBER OF WEEKS IN MONTH FOR          
      *                      THIS YEAR.                                         
      *    TABLE TDTATTR E - TO GET TOTAL NUMBER OF WEEKS IN MONTH FOR          
      *                      LAST YEAR.                                         
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
                SELECT                                                          
                         A.FSCL_YR_NBR                                          
                        ,A.FSCL_MN_NM                                           
                        ,A.FSCL_MN_NBR                                          
                        ,A.WK_IN_MN_NBR                                         
                        ,A.FSCL_WK_NBR                                          
                        ,A.FSCL_YR_BEG_DTE                                      
                        ,A.FSCL_YR_END_DTE                                      
                        ,A.FSCL_MN_END_DTE                                      
                        ,D.WK_IN_MN_NBR                                         
                        ,E.WK_IN_MN_NBR                                         
                INTO     :DTATTR-FSCL-YR-NBR                                    
                        ,:DTATTR-FSCL-MN-NM                                     
                        ,:DTATTR-FSCL-MN-NBR                                    
                        ,:DTATTR-WK-IN-MN-NBR                                   
                        ,:DTATTR-FSCL-WK-NBR                                    
                        ,:DTATTR-FSCL-YR-BEG-DTE                                
                        ,:DTATTR-FSCL-YR-END-DTE                                
                        ,:DTATTR-FSCL-MN-END-DTE                                
                        ,:TY-LAST-WK-IN-MN                                      
                        ,:LY-LAST-WK-IN-MN                                      
                FROM                                                            
                     TDTATTR A                                                  
                    ,TDTATTR B                                                  
                    ,TDTATTR C                                                  
                    ,TDTATTR D                                                  
                    ,TDTATTR E                                                  
                WHERE A.KY_DTE             =:DTATTR-KY-DTE                      
                 AND E.KY_DTE              = C.FSCL_MN_END_DTE                  
                 AND D.KY_DTE              = A.FSCL_MN_END_DTE                  
                 AND C.KY_DTE              = B.LY_THIS_DAY_KY_DTE               
                 AND B.KY_DTE              = A.FSCL_MN_END_DTE - 7 DAYS         
                 AND A.FSCL_MN_END_DTE     = B.FSCL_MN_END_DTE                  
                 AND A.LY_THIS_DAY_KY_DTE  = '9999-09-09'                       
                                                                                
                UNION                                                           
                                                                                
                SELECT                                                          
                         A.FSCL_YR_NBR                                          
                        ,A.FSCL_MN_NM                                           
                        ,A.FSCL_MN_NBR                                          
                        ,A.WK_IN_MN_NBR                                         
                        ,A.FSCL_WK_NBR                                          
                        ,A.FSCL_YR_BEG_DTE                                      
                        ,A.FSCL_YR_END_DTE                                      
                        ,A.FSCL_MN_END_DTE                                      
                        ,D.WK_IN_MN_NBR                                         
                        ,E.WK_IN_MN_NBR                                         
                INTO     :DTATTR-FSCL-YR-NBR                                    
                        ,:DTATTR-FSCL-MN-NM                                     
                        ,:DTATTR-FSCL-MN-NBR                                    
                        ,:DTATTR-WK-IN-MN-NBR                                   
                        ,:DTATTR-FSCL-WK-NBR                                    
                        ,:DTATTR-FSCL-YR-BEG-DTE                                
                        ,:DTATTR-FSCL-YR-END-DTE                                
                        ,:DTATTR-FSCL-MN-END-DTE                                
                        ,:TY-LAST-WK-IN-MN                                      
                        ,:LY-LAST-WK-IN-MN                                      
                FROM                                                            
                     TDTATTR A                                                  
                    ,TDTATTR B                                                  
                    ,TDTATTR C                                                  
                    ,TDTATTR D                                                  
                    ,TDTATTR E                                                  
                WHERE A.KY_DTE             =:DTATTR-KY-DTE                      
                 AND E.KY_DTE              = B.FSCL_MN_END_DTE                  
                 AND D.KY_DTE              = A.FSCL_MN_END_DTE                  
                 AND C.KY_DTE              = B.LY_THIS_DAY_KY_DTE               
                 AND B.KY_DTE              = A.LY_THIS_DAY_KY_DTE               
                 AND A.FSCL_MN_END_DTE    ^= B.FSCL_MN_END_DTE                  
W26603             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   DISPLAY 'DTATTR-KY-DTE: ' DTATTR-KY-DTE                      
                   MOVE    '8000-GET-DATE-ATTRIBUTES'                           
                                                TO PV-PARAGRAPH-NAME            
                   MOVE    'SELECT ROW FROM TDTATTR'                            
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8010-GET-FSCL-WK-DTES.                                                   
                                                                                
           EXEC SQL                                                             
                SELECT  A.FSCL_WK_NBR                                           
                       ,B.FSCL_WK_NBR                                           
                       ,C.FSCL_WK_NBR                                           
                       ,D.FSCL_WK_NBR                                           
                       ,D.NFM_END_DTE                                           
                INTO :PV-FSCL-WK-NBR-MN1                                        
                    ,:PV-FSCL-WK-NBR-MN2                                        
                    ,:PV-FSCL-WK-NBR-MN3                                        
                    ,:PV-FSCL-WK-NBR-MN4                                        
                    ,:DTATTR-NFM-END-DTE                                        
                FROM TDTATTR A                                                  
                    ,TDTATTR B                                                  
                    ,TDTATTR C                                                  
                    ,TDTATTR D                                                  
                WHERE A.KY_DTE = :DTATTR-KY-DTE                                 
                  AND B.KY_DTE = A.NFM_END_DTE                                  
                  AND C.KY_DTE = B.NFM_END_DTE                                  
                  AND D.KY_DTE = C.NFM_END_DTE                                  
W26603             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME                       
                   MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME                      
               WHEN OTHER                                                       
                   DISPLAY 'DTATTR-KY-DTE: ' DTATTR-KY-DTE                      
                   MOVE    '8010-GET-FSCL-WK-DTES'                              
                                                TO PV-PARAGRAPH-NAME            
                   MOVE    'SELECT ROW FROM TDTATTR'                            
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8100-GET-GMM-NAME.                                                       
                                                                                
           EXEC SQL                                                             
                SELECT      B.WORKER_LAST_NAME                                  
                     ,      B.WORKER_FIR_NAME                                   
                  INTO     :RSPBAR-WORKER-LAST-NAME                             
                     ,     :RSPBAR-WORKER-FIR-NAME                              
                  FROM      TMDSEAR A                                           
                     ,      TRSPBAR B                                           
                     ,      TAPLAVL C                                           
                 WHERE     (A.GMA_NBR     = :PV-GMA-NBR)                        
                   AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-GMM)                 
                   AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)                     
                   AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)                     
                   AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                     
                   AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)                     
                   AND     (:ML114-EXTRACT-DTE                                  
                            BETWEEN B.WORKER_STRT_DTE                           
                            AND     B.WORKER_END_DTE)                           
                   AND     (:ML114-EXTRACT-DTE                                  
                            BETWEEN C.MDSEAR_STRT_DTE                           
                            AND     C.MDSEAR_END_DTE)                           
W26603             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME                       
                   MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME                      
               WHEN OTHER                                                       
                   MOVE '8100-GET-GMM-NAME'     TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TRSPBAR'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8200-GET-DMM-NAME.                                                       
                                                                                
           EXEC SQL                                                             
                SELECT      B.WORKER_LAST_NAME                                  
                     ,      B.WORKER_FIR_NAME                                   
                  INTO     :RSPBAR-WORKER-LAST-NAME                             
                     ,     :RSPBAR-WORKER-FIR-NAME                              
                  FROM      TMDSEAR A                                           
                     ,      TRSPBAR B                                           
                     ,      TAPLAVL C                                           
                 WHERE     (A.DMA_NBR     = :PV-DMA-NBR)                        
                   AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-DMM)                 
                   AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)                     
                   AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)                     
                   AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                     
                   AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)                     
                   AND     (:ML114-EXTRACT-DTE                                  
                            BETWEEN B.WORKER_STRT_DTE                           
                            AND     B.WORKER_END_DTE)                           
                   AND     (:ML114-EXTRACT-DTE                                  
                            BETWEEN C.MDSEAR_STRT_DTE                           
                            AND     C.MDSEAR_END_DTE)                           
W26603             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME                       
                   MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME                      
               WHEN OTHER                                                       
                   MOVE '8200-GET-DMM-NAME'     TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TRSPBAR'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8300-GET-BYR-NAME.                                                       
                                                                                
           EXEC SQL                                                             
                SELECT      DISTINCT                                            
                            A.BYR_NBR                                           
                     ,      B.WORKER_LAST_NAME                                  
                     ,      B.WORKER_FIR_NAME                                   
                  INTO     :MDSEAR-BYR-NBR                                      
                     ,     :RSPBAR-WORKER-LAST-NAME                             
                     ,     :RSPBAR-WORKER-FIR-NAME                              
                  FROM      TMDSEAR A                                           
                     ,      TRSPBAR B                                           
                     ,      TAPLAVL C                                           
                 WHERE     (A.BYR_NBR     = :PV-BYR-NBR)                        
                   AND     (A.DEPT_NBR    = :PV-DEPT-NBR)                       
222725             AND     (A.MDSELV_CDE  = 'DPT')                              
                   AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-BYR)                 
                   AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)                     
                   AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)                     
                   AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                     
                   AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)                     
                   AND     (:ML114-EXTRACT-DTE                                  
                            BETWEEN B.WORKER_STRT_DTE                           
                            AND     B.WORKER_END_DTE)                           
                   AND     (:ML114-EXTRACT-DTE                                  
                            BETWEEN C.MDSEAR_STRT_DTE                           
                            AND     C.MDSEAR_END_DTE)                           
W26603             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME                       
                   MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME                      
               WHEN OTHER                                                       
                   MOVE '8300-GET-BYR-NAME'     TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT ROW FROM TRSPBAR'                               
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8400-GET-MDSEAR-DESC.                                                    
                                                                                
           EXEC SQL                                                             
               SELECT     A.MDSEAR_DESC                                         
                 INTO    :MDSEAR-DESC                                           
                 FROM     TMDSEAR A                                             
                    ,     TAPLAVL B                                             
                WHERE    (A.GMA_NBR     = :PV-GMA-NBR                           
                   OR     A.DMA_NBR     = :PV-DMA-NBR                           
                   OR     A.BYR_NBR     = :PV-BYR-NBR)                          
                  AND    (A.DEPT_NBR    = :PV-DEPT-NBR)                         
                  AND    (A.MDSELV_CDE  = :PV-MDSELV-CDE)                       
                  AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)                       
                  AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)                       
                  AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                       
                  AND    (:ML114-EXTRACT-DTE                                    
                          BETWEEN B.MDSEAR_STRT_DTE                             
                          AND     B.MDSEAR_END_DTE)                             
                  AND    (:ML114-EXTRACT-DTE                                    
                          BETWEEN A.STRT_DTE                                    
                          AND     A.END_DTE)                                    
W26603             WITH UR                                                      
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE 'NOT FOUND' TO MDSEAR-DESC                              
               WHEN OTHER                                                       
                   MOVE '8400-GET-MDSEAR-DESC'  TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT DEPARTMENT ROW ON TMDSEAR'                      
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8500-OPEN-FSCL-MN-NM-CSR.                                                
                                                                                
           EXEC SQL                                                             
                OPEN FSCL-MN-NM-CSR                                             
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8500-OPEN-FSCL-MN-NM-CSR'                              
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'OPEN FSCL-MN-NM-CSR'   TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8600-FETCH-FSCL-MN-NM-CSR.                                               
                                                                                
           EXEC SQL                                                             
               FETCH                                                            
                   FSCL-MN-NM-CSR                                               
               INTO                                                             
                   :DTATTR-FSCL-MN-NBR                                          
                  ,:DTATTR-FSCL-MN-NM                                           
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   SET PS-END-OF-FSCL-MN-NM-CSR TO TRUE                         
               WHEN OTHER                                                       
                   MOVE '8600-FETCH-FSCL-MN-NM-CSR'                             
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'FETCH FSCL-MN-NM-CSR'  TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       8700-CLOSE-FSCL-MN-NM-CSR.                                               
                                                                                
           EXEC SQL                                                             
               CLOSE FSCL-MN-NM-CSR                                             
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE '8700-CLOSE-FSCL-MN-NM-CSR'                             
                                                TO PV-PARAGRAPH-NAME            
                   MOVE 'CLOSE FSCL-MN-NM-CSR'  TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
31355  8800-LDGR-HDR-CTL-FILE.                                                  
  |                                                                             
  |        READ LEDGER-HEADER-CONTROL-FILE NEXT                                 
  |            AT END  MOVE SPACE TO LCHF-RPT-HEADER-ID                         
  |                    CLOSE LEDGER-HEADER-CONTROL-FILE                         
  |                    OPEN INPUT LEDGER-HEADER-CONTROL-FILE.                   
  |                                                                             
31355                                                                           
      *~DPPD024 COMBINES SEPARATE FIRST AND LAST NAME FIELDS INTO ONE  *        
      * FIRST/LAST NAME FIELD.                                         *        
                                                                                
           COPY DPPD024.                                                        
                                                                                
       9998-SQL-ABEND.                                                          
                                                                                
           MOVE +4013 TO PV-ABEND-CODE.                                         
           DISPLAY '** ABEND **         ** = SQLERROR'.                         
           DISPLAY '** PROGRAM          ** = MLKRP215'.                         
           DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.               
           DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.           
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
           COPY DPPD004.                                                        
                                                                                
           PERFORM 9999-ABEND.                                                  
                                                                                
                                                                                
       9999-ABEND.                                                              
                                                                                
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                                
