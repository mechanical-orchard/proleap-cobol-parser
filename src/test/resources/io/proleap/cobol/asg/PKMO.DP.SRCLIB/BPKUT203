       ID DIVISION.                                                     00010020
       PROGRAM-ID.      BPKUT203.                                       00020020
       AUTHOR.          MARK A FRAMNESS.                                00030020
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040020
       DATE-WRITTEN     05/2011.                                        00050020
       DATE-COMPILED.                                                   00060020
      ******************************************************************00070020
      *                                                                 00080020
      *  BPKUT203 - CREATE WEEKLY (SEASON'S WORTH) OF PLAN COST DEPT    00090020
      *             AND DEPT BY CHANNEL ROLLUP TABLES FOR THE DATA      00100020
      *             WAREHOUSE.                                          00110020
      *                                                                 00120020
      *  THIS PROGRAM READS A PLANNING EXTRACT FILE, REFORMATS IT,      00130020
      *  AND CREATES ANOTHER EXTRACT FILE THAT IS USED TO LOAD THE      00140020
      *  WEEKLY DEPARTMENT/CHANNEL COST ROLLUP TABLES.                  00150020
      *  (BPT_WKLY_PLAN_COST_DEPT_RLP & BPT_WKLY_PLAN_DEPTXCHNL_RLP)    00160020
      *                                                                 00170020
      *  BOTH THE INPUT AND OUTPUT EXTRACT FILES ARE AT A DEPT/CHANNEL  00180020
      *  LEVEL AND CONTAIN WEEKLY DATA FOR A PARTICULAR SEASON.         00190020
      *  EACH RECORD ON THE INPUT EXTRACT FILE CONTAINS 26 OR 27        00200020
      *  OCCURRENCES (ONE FOR EACH WEEK IN THE SEASON) OF ONE           00210020
      *  PARTICULAR PIECE OF INFORMATION (SALES RETAIL AMOUNT, FOR      00220020
      *  EXAMPLE).  EACH RECORD ON THE OUTPUT FILE CONTAINS ALL THE     00230020
      *  NECESSARY PIECES OF INFORMATION FOR ONE WEEK.                  00240020
      *                                                                 00250020
      *  TO CONVERT A RECORD FROM THE INPUT FORMAT TO THE OUTPUT        00260020
      *  FORMAT, ALL THE INFORMATION FOR A DEPARTMENT IS TABLED BY      00270020
      *  WEEK AS IT IS READ.  WHEN THE DEPT/CHANNEL CHANGES,            00280020
      *  26 OR 27 OUTPUT RECORDS ARE WRITTEN FROM THE TABLED DATA -     00290020
      *  ONE RECORD FOR EACH WEEK IN THE SEASON.                        00300020
      *                                                                 00310020
      *  THE SEASON BEGIN DATE IS READ FROM A CONTROL CARD.             00320020
      *  IT IS USED TO RETRIEVE THE FISCAL WEEK END DATE AND FISCAL     00330020
      *  WEEK NUMBER FROM TDTATTR FOR EACH WEEK IN THE SEASON.          00340020
      ******************************************************************00350020
SB0405*    CHANGED: 04/30/05    BY: STACY BIESZK    WR#=28077           00360020
SB0405*                         FIX PROBLEM WITH INVALID PLAN-AMT       00370020
SB0405*                         CHANGED PROGRAM TO PUT OUT A RC = 4     00380020
SB0405*                         INSTEAD OF ABENDING THE PROGRAM.  THIS  00390020
SB0405*                         WAS HAPPENING WHEN THEY SENT A PLN-AMT  00400020
SB0405*                         WITH MORE THAN 8 DIGITS TO THE LEFT OF  00410020
SB0405*                         DECIMAL POINT.  ALSO  WHEN PLN-AMT IS   00420020
SB0405*                         NOT VALID (WHEN IT IS MORE THAN 12      00430020
SB0405*                         DIGITS LONG) THE RECORD WILL BE         00440020
SB0405*                         WRITTEN TO A REJECT FILE.               00450020
SB0405******************************************************************00460020
      *    CHANGED: 05/26/11    BY: MARK A FRAMNESS WR#=39512           00470020
      *                         CLONE FROM MWKUT163                     00480020
      *                                                                 00490020
      *                         NO CHANGES BEYOND COMMENTS, COPYBOOK    00500020
      *                         NAMES, AND COPYBOOK FIELD NAMES         00510020
      ************************************************************      00520020
C55777*    CHANGED: 04/16/21    BY: COGNIZANT WR/IR #: CHG0255777       00522023
C55777*                         REMOVED THE OVERFLOW LOGIC SINCE EDW    00523023
C55777*                         CAN ACCEPT VALUES UP TO 99 BILLION AND  00524023
C55777*                         ALSO CHANGED THE LENGTH OF PROGRAM      00525023
C55777*                         VARIABLE TO S9(11)V99. MADE THE LENGTH  00526023
C55777*                         OF DIGITS ACCEPTABLE IN LEFT SIDE OF THE00527023
C55777*                         DECIMAL TO 8 DIGITS. SINCE THIS PROGRAM 00528023
C55777*                         MULTIPLES THE VALUE FROM EP BY 1000,    00529023
C55777*                         MAX DIGITS TO THE LENGTH OF THE DECIMAL 00529123
C55777*                         SHOULD BE 8 SO THAT OUTPUT VALUE SHOULD 00529223
C55777*                         BE IN THE LIMIT OF 99 BILLION WHICH IS  00529323
C55777*                         EDW LIMIT.THE VALUES SENT FROM EP ARE IN00529423
C55777*                         THOUSANDS AND THE PROCESS ON OUR END    00529523
C55777*                         WILL MULTIPLY THE VALUES BY 1000 TO SEND00529623
C55777*                         THE REAL NUMBER TO EDW. (EVEN THOUGH EDW00529723
C55777*                         WILL DISPLAY THE NUMBERS IN 1000'S IN   00529823
C55777*                         THE MSI UI).                            00529923
                                                                        00530020
       ENVIRONMENT DIVISION.                                            00540020
                                                                        00550020
       CONFIGURATION SECTION.                                           00560020
                                                                        00570020
       SOURCE-COMPUTER.        IBM-3090.                                00580020
       OBJECT-COMPUTER.        IBM-3090.                                00590020
                                                                        00600020
       INPUT-OUTPUT SECTION.                                            00610020
                                                                        00620020
       FILE-CONTROL.                                                    00630020
                                                                        00640020
           SELECT  DPT-PLN-FILE                                         00650020
               ASSIGN TO INP01.                                         00660020
                                                                        00670020
           SELECT WKLY-PLN-CST-DPT-FILE                                 00680020
               ASSIGN TO OUT01.                                         00690020
                                                                        00700020
           SELECT WKLY-PLN-CST-DPT-CHNL-FILE                            00710020
               ASSIGN TO OUT02.                                         00720020
                                                                        00730020
SB0405     SELECT REJECTED-FILE                                         00740020
SB0405         ASSIGN TO OUT03.                                         00750020
SB0405                                                                  00760020
       DATA DIVISION.                                                   00770020
                                                                        00780020
       FILE SECTION.                                                    00790020
                                                                        00800020
       FD  DPT-PLN-FILE                                                 00810020
           RECORDING MODE F                                             00820020
           LABEL RECORDS ARE STANDARD                                   00830020
           BLOCK CONTAINS  0 RECORDS                                    00840020
           RECORD CONTAINS 600 CHARACTERS                               00850020
           DATA RECORD IS DPT-PLN-REC.                                  00860020
                                                                        00870020
       01  DPT-PLN-REC                 PIC X(600).                      00880020
                                                                        00890020
       FD  WKLY-PLN-CST-DPT-FILE                                        00900020
           RECORDING MODE IS F                                          00910020
           LABEL RECORDS ARE STANDARD                                   00920020
           BLOCK CONTAINS 0 RECORDS.                                    00930020
                                                                        00940020
C55777 01  WKLY-PLN-CST-DPT-REC      PIC X(50).                         00950023
                                                                        00960020
       FD  WKLY-PLN-CST-DPT-CHNL-FILE                                   00970020
           RECORDING MODE IS F                                          00980020
           LABEL RECORDS ARE STANDARD                                   00990020
           BLOCK CONTAINS 0 RECORDS.                                    01000020
                                                                        01010020
C55777 01  WKLY-PLN-CST-DPT-CHNL-REC PIC X(54).                         01020023
                                                                        01030020
SB0405 FD  REJECTED-FILE                                                01040020
SB0405     RECORDING MODE F                                             01050020
SB0405     LABEL RECORDS ARE STANDARD                                   01060020
SB0405     BLOCK CONTAINS  0 RECORDS                                    01070020
SB0405     RECORD CONTAINS 600 CHARACTERS                               01080020
SB0405     DATA RECORD IS REJECTED-REC.                                 01090020
SB0405                                                                  01100020
SB0405 01  REJECTED-REC                 PIC X(600).                     01110020
                                                                        01120020
       WORKING-STORAGE SECTION.                                         01130020
                                                                        01140020
       01  FWT-FSCL-WK-TABLE.                                           01150020
           05  FWT-FSCL-WK-ENTRY       OCCURS 27.                       01160020
               10  FWT-FSCL-WK-BEG-DTE PIC X(10).                       01170020
               10  FWT-FSCL-WK-NBR     PIC X(02).                       01180020
                                                                        01190020
                                                                        01200020
      *  THIS TABLE IS USED TO HOLD ALL INPUT DATA FOR A DEPARTMENT     01210020
      *  BY WEEK.  IT CONTAINS THE TOTAL COST (PHYSSTR AND VIRTSTR)     01220020
      *  COMBINED (TOTALCO). THE OUTPUT RECORDS FOR THE PLANNING COST   01230020
      *  DEPT ROLLUP TABLE ARE BUILT FROM THIS TABLE.                   01240020
       01  PDT-PLAN-CST-TOT-TABLE.                                      01250020
           05  PDT-PLAN-CST-TOT-ENTRY                                   01260020
                                       OCCURS 27.                       01270020
C55777         10  PDT-EOPINV-COST-AMT  PIC S9(11)V99  COMP-3 VALUE +0. 01280023
C55777         10  PDT-SLS-COST-AMT     PIC S9(11)V99  COMP-3 VALUE +0. 01290023
                                                                        01300020
      *  THIS TABLE IS USED TO HOLD ALL INPUT DATA FOR A DEPT/CHANNEL   01310020
      *  BY WEEK.  IT CONTAINS THE COST BY CHANNEL(PHYSSTR AND VIRTSTR) 01320020
      *  THE OUTPUT RECORDS FOR THE PLANNING COST DEPT CHANNEL ROLLUP   01330020
      *  TABLE ARE BUILT FROM THIS TABLE.                               01340020
       01  PDC-PLAN-CST-CHNL-TABLE.                                     01350020
           05  PDC-PLAN-CST-CHNL-ENTRY                                  01360020
                                       OCCURS 27.                       01370020
C55777         10  PDC-EOPINV-COST-AMT  PIC S9(11)V99  COMP-3 VALUE +0. 01380023
C55777         10  PDC-SLS-COST-AMT     PIC S9(11)V99  COMP-3 VALUE +0. 01390023
                                                                        01400020
       01  PS-PROGRAM-SWITCHES.                                         01410020
           05  PS-END-OF-PLN-CST-FILE-SW    PIC X     VALUE 'N'.        01420020
               88  PS-END-OF-PLN-CST-FILE             VALUE 'Y'.        01430020
                                                                        01440020
           05  PS-DATE-FOUND-SW             PIC X     VALUE 'N'.        01450020
               88  PS-DATE-FOUND                      VALUE 'Y'.        01460020
               88  PS-DATE-NOT-FOUND                  VALUE 'N'.        01470020
                                                                        01480020
           05  PS-END-OF-FSCL-WK-CSR-SW     PIC X      VALUE 'N'.       01490020
               88  PS-END-OF-FSCL-WK-CSR               VALUE 'Y'.       01500020
               88  PS-NOT-END-OF-FSCL-WK-CSR           VALUE 'N'.       01510020
                                                                        01520020
SB0405     05  PS-DATA-ERROR-SW           PIC X        VALUE SPACES.    01530020
SB0405         88  PS-DATA-ERROR                       VALUE 'Y'.       01540020
SB0405                                                                  01550020
SB0405     05  PS-REJ-RECORD-SW             PIC X      VALUE SPACES.    01560020
SB0405         88  PS-REJ-RECORD                       VALUE 'Y'.       01570020
SB0405         88  PS-DONT-REJ-RECORD                  VALUE 'N'.       01580020
SB0405                                                                  01590020
       01  PV-PROGRAM-VARIABLES.                                        01600020
           05  PV-DEL-ID1              PIC X          VALUE ','.        01610020
           05  PV-DEL-ID2              PIC X          VALUE '_'.        01620020
           05  PV-UNSTR-PTR            PIC S9(04)     COMP SYNC         01630020
                                                      VALUE ZERO.       01640020
           05  PV-PARAGRAPH-NAME       PIC X(30)      VALUE SPACE.      01650020
           05  PV-DB2-OPER-ATTEMPTED   PIC X(30)      VALUE SPACE.      01660020
           05  PV-PGM-NAME             PIC X(08)      VALUE 'BPKUT203'. 01670020
           05  PV-ABEND-CODE           PIC S9(04)     COMP SYNC         01680020
                                                      VALUE ZERO.       01690020
           05  PV-PREV-DEPT-NBR        PIC X(03).                       01700020
           05  PV-PREV-STORE-CHNL      PIC X(07)      VALUE SPACE.      01710020
               88 TOTAL-ALL-COMPANY                   VALUE 'TOTALCO'.  01720020
               88 E-STORE                             VALUE 'VIRTSTR'.  01730020
               88 PHYSICAL-STORE                      VALUE 'PHYSSTR'.  01740020
           05  PV-PREV-STORE-CAT       PIC X(02)      VALUE SPACE.      01750020
               88 PV-STORE-COMP                       VALUE 'C_'.       01760020
               88 PV-STORE-NON-COMP                   VALUE 'NC'.       01770020
               88 PV-STORE-NEW                        VALUE 'N_'.       01780020
C55777     05  PV-AMT                  PIC S9(11)V9(04).                01790023
           05  PV-PLN-IN-CNT           PIC S9(09) COMP-3 VALUE +0.      01800020
           05  PV-CST-DPT-CNT          PIC S9(09) COMP-3 VALUE +0.      01810020
           05  PV-CST-DPT-CHNL-CNT     PIC S9(09) COMP-3 VALUE +0.      01820020
           05  PV-DISP-QTY              PIC ZZZ,ZZZ,ZZ9.99.             01830020
           05  PV-DISP-QTY2             PIC ZZZ,ZZ9.9999.               01840020
SB0405     05  PV-REJ-RECORD-CNT       PIC S9(09) COMP-3 VALUE +0.      01850020
                                                                        01860020
                                                                        01870020
       01  SS-SUBSCRIPTS.                                               01880020
           05  SS-WEEK                 PIC S9(04)     COMP SYNC         01890020
                                                      VALUE +0.         01900020
           05  SS-WEEK-MAX             PIC S9(04)     COMP SYNC         01910020
                                                      VALUE +0.         01920020
       01  PV-WEEKLY-AMT-TABLE.                                         01930020
           05  PV-WEEKLY-AMT           OCCURS 27                        01940020
C55777                                 PIC S9(11)V9(02) VALUE ZERO.     01950023
                                                                        01960020
      *************************************************************     01970020
      * SEASONAL PLANNING COST INPUT EXTRACT                      *     01980020
      *************************************************************     01990020
           COPY BPRD207.                                                02000020
                                                                        02010020
      *************************************************************     02020020
      * COPYBOOK FOR THE MERCHANISE PLANNING CONTROL CARD         *     02030020
      *************************************************************     02040020
           COPY BPRD045.                                                02050020
                                                                        02060020
      *************************************************************     02070020
      * COPYBOOK FOR OUTPUT WEEKLY PLANNING COST DEPT ROLLUP FILE *     02080020
      *************************************************************     02090020
           COPY BPRD208.                                                02100020
                                                                        02110020
      *************************************************************     02120020
      * COPYBOOK FOR OUTPUT WEEKLY PLANNING COST DEPT/CHNL ROLLUP *     02130020
      *************************************************************     02140020
           COPY BPRD209.                                                02150020
                                                                        02160020
      *************************************************************     02170020
      * COPYBOOK FOR CALENDAR ROUTINE                             *     02180020
      *************************************************************     02190020
           COPY DPWS500.                                                02200020
                                                                        02210020
      *************************************************************     02220020
      * COPYBOOK FOR NUMERIC EDIT ROUTINE                         *     02230020
      *************************************************************     02240020
           COPY DPWS010I.                                               02250020
                                                                        02260020
      *************************************************************     02270020
      *  DATE ATTRIBUTE TABLE                                     *     02280020
      *************************************************************     02290020
           EXEC SQL                                                     02300020
               INCLUDE TDTATTR                                          02310020
           END-EXEC.                                                    02320020
                                                                        02330020
      *************************************************************     02340020
      * DB2 ERROR MESSAGE AREA                                    *     02350020
      *************************************************************     02360020
           COPY DPWS004.                                                02370020
                                                                        02380020
      *************************************************************     02390020
      * DB2 COMMUNICATION AREA                                    *     02400020
      *************************************************************     02410020
           EXEC SQL                                                     02420020
               INCLUDE SQLCA                                            02430020
           END-EXEC.                                                    02440020
                                                                        02450020
      ****************************************************************  02460020
      * FISCAL WEEK CURSOR                                              02470020
      *                                                                 02480020
      * THIS CURSOR WILL RETURN THE FISCAL WEEK END DATE AND FISCAL     02490020
      * WEEK NUMBER FOR EACH WEEK IN THE SEASON.                        02500020
      ****************************************************************  02510020
                                                                        02520020
           EXEC SQL                                                     02530020
              DECLARE FSCL-WK-CSR CURSOR FOR                            02540020
                  SELECT                                                02550020
                      FSCL_WK_NBR                                       02560020
                     ,FSCL_WK_BEG_DTE                                   02570020
                  FROM                                                  02580020
                      TDTATTR                                           02590020
                  WHERE SEA_BEG_DTE = :DTATTR-KY-DTE                    02600020
                    AND KY_DTE      = FSCL_WK_BEG_DTE                   02610020
                  FOR FETCH ONLY                                        02620020
           END-EXEC.                                                    02630020
                                                                        02640020
       EJECT                                                            02650020
                                                                        02660020
       PROCEDURE DIVISION.                                              02670020
                                                                        02680020
       1000-MAINLINE.                                                   02690020
                                                                        02700020
           PERFORM 1100-INITIALIZATION.                                 02710020
                                                                        02720020
           PERFORM 2000-PROCESS-DATA                                    02730020
                   UNTIL PS-END-OF-PLN-CST-FILE.                        02740020
                                                                        02750020
           PERFORM 9000-EOJ.                                            02760020
                                                                        02770020
SB0405     IF PV-REJ-RECORD-CNT > 0                                     02780020
SB0405        MOVE 4 TO RETURN-CODE                                     02790020
SB0405     END-IF.                                                      02800020
                                                                        02810020
           GOBACK.                                                      02820020
                                                                        02830020
      ******************************************************************02840020
      *  VALIDATE DATE CONTROL CARD AND RETRIEVE WEEKS IN SEASON FOR    02850020
      *  CURRENT SEASAON EXTRACTED BY PLANNING.  OPEN FILES, READ 1ST   02860020
      *  RECORD.                                                        02870020
      ******************************************************************02880020
       1100-INITIALIZATION.                                             02890020
                                                                        02900020
           ACCEPT BP045-REC.                                            02910020
                                                                        02920020
           DISPLAY SPACES.                                              02930020
           DISPLAY PV-PGM-NAME ' CONTROL CARD: ' BP045-REC.             02940020
           DISPLAY SPACES.                                              02950020
                                                                        02960020
      *    MAKE SURE THE LAST PLANNING EXPORT WAS IN TY MODE.           02970020
           IF NOT BP045-TY-RUN-MODE                                     02980020
               DISPLAY '** ABEND **'                                    02990020
               DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'                  03000020
               DISPLAY '** PARAGRAPH 1100-INITIALIZATION  **'           03010020
               DISPLAY '** INVALID RUN MODE ON CONTROL CARD.'           03020020
               DISPLAY '** EXPECTING TY.'                               03030020
               DISPLAY '** CONTROL CARD RUN MODE = ' BP045-RUN-MODE     03040020
               MOVE +4003 TO PV-ABEND-CODE                              03050020
               PERFORM 9999-ABEND                                       03060020
           END-IF.                                                      03070020
                                                                        03080020
      *    CALL THE CALENDAR ROUTINE TO CONVERT THE SEASON BEGIN DATE   03090020
      *    ON THE CONTROL CARD TO DB2 ISO FORMAT.                       03100020
           MOVE BP045-SEASON-START-DATE  TO DPG52-LK-DATE-INPUT.        03110020
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03120020
           SET DPG52-LK-DTE-ISO          TO TRUE                        03130020
                                                                        03140020
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          03150020
                                                   DPG53 DPG54          03160020
                                                   DPG55 DPG56          03170020
           IF DPG54-SEVERE-ERROR                                        03180020
               DISPLAY '** ABEND **'                                    03190020
               DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'                  03200020
               DISPLAY '** PARAGRAPH 1100-INITIALIZATION **'            03210020
               IF DPG54-DATE-INVALID                                    03220020
                   DISPLAY                                              03230020
                       '** INVALID SEASON START DATE ON CONTROL CARD.'  03240020
                   DISPLAY                                              03250020
                       '** EXPECTING CCYYMMDD DATE FORMAT.'             03260020
                   DISPLAY                                              03270020
                       '** SEASON START DATE ON CONTROL CARD: '         03280020
                           BP045-SEASON-START-DATE                      03290020
                   MOVE +4003 TO PV-ABEND-CODE                          03300020
               ELSE                                                     03310020
                   DISPLAY 'ERROR CALLING CALENDAR ROUTINE: '           03320020
                            DPG54-ERROR-MESSAGE                         03330020
                   MOVE +4019 TO PV-ABEND-CODE                          03340020
               END-IF                                                   03350020
               PERFORM 9999-ABEND                                       03360020
           END-IF.                                                      03370020
                                                                        03380020
      *    MAKE SURE THE SEASON BEGIN DATE ON THE CONTROL CARD IS A     03390020
      *    VALID SEASON BEGIN DATE.                                     03400020
           MOVE  DPG55-DB2-ISO-DATE-FMT TO DTATTR-KY-DTE.               03410020
                                                                        03420020
           PERFORM  8000-GET-DATE-ATTRIBUTES.                           03430020
           IF PS-DATE-NOT-FOUND                                         03440020
               DISPLAY '** ABEND **'                                    03450020
               DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'                  03460020
               DISPLAY '** PARAGRAPH 1100-INITIALIZATION **'            03470020
               DISPLAY '** SEASON START DATE ON CONTROL CARD NOT'       03480020
               DISPLAY '** FOUND ON TDTATTR.'                           03490020
               DISPLAY '** SEASON START DATE: ' BP045-SEASON-START-DATE 03500020
               MOVE +4003 TO PV-ABEND-CODE                              03510020
               PERFORM 9999-ABEND                                       03520020
           END-IF.                                                      03530020
                                                                        03540020
           IF DTATTR-KY-DTE NOT = DTATTR-SEA-BEG-DTE                    03550020
               DISPLAY '** ABEND **'                                    03560020
               DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'                  03570020
               DISPLAY '** PARAGRAPH 1100-INITIALIZATION **'            03580020
               DISPLAY '** SEASON START DATE ON CONTROL CARD IS '       03590020
               DISPLAY '** NOT AN ACTUAL SEASON BEGIN DATE.'            03600020
               DISPLAY '** SEASON START DATE ON CONTROL CARD: '         03610020
                        BP045-SEASON-START-DATE                         03620020
               MOVE +4003 TO PV-ABEND-CODE                              03630020
               PERFORM 9999-ABEND                                       03640020
           END-IF.                                                      03650020
                                                                        03660020
      *    GET THE FISCAL-WEEK-BEG-DATE AND FISCAL-WEEK-NUMBER FOR      03670020
      *    EACH WEEK IN THE SEASON.                                     03680020
           PERFORM 8500-OPEN-FSCL-WK-CSR.                               03690020
           PERFORM 8600-FETCH-FSCL-WK-CSR.                              03700020
                                                                        03710020
           PERFORM VARYING SS-WEEK FROM 1 BY 1 UNTIL SS-WEEK > 27       03720020
                                OR PS-END-OF-FSCL-WK-CSR                03730020
             MOVE DTATTR-FSCL-WK-BEG-DTE TO FWT-FSCL-WK-BEG-DTE(SS-WEEK)03740020
             MOVE DTATTR-FSCL-WK-NBR     TO FWT-FSCL-WK-NBR    (SS-WEEK)03750020
             ADD +1 TO SS-WEEK-MAX                                      03760020
             PERFORM 8600-FETCH-FSCL-WK-CSR                             03770020
           END-PERFORM.                                                 03780020
                                                                        03790020
           PERFORM 8700-CLOSE-FSCL-WK-CSR.                              03800020
                                                                        03810020
           DISPLAY 'NUMBER OF WEEKS IN SEASON = ' SS-WEEK-MAX.          03820020
           DISPLAY SPACES.                                              03830020
                                                                        03840020
      *    OPEN THE FILES.                                              03850020
           OPEN INPUT  DPT-PLN-FILE                                     03860020
                OUTPUT WKLY-PLN-CST-DPT-FILE                            03870020
SB0405                 REJECTED-FILE                                    03880020
                       WKLY-PLN-CST-DPT-CHNL-FILE.                      03890020
                                                                        03900020
                                                                        03910020
           PERFORM 7000-READ-DPT-PLN-FILE.                              03920020
           IF PS-END-OF-PLN-CST-FILE                                    03930020
               DISPLAY '** ABEND **'                                    03940020
               DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'                  03950020
               DISPLAY '** PARAGRAPH 1100-INITIALIZATION'               03960020
               DISPLAY '** THE INPUT DEPARTMENT PLAN FILE WAS EMPTY.'   03970020
               MOVE +4008 TO PV-ABEND-CODE                              03980020
               PERFORM 9999-ABEND                                       03990020
           END-IF.                                                      04000020
                                                                        04010020
           MOVE BP207-DEPT-NBR          TO PV-PREV-DEPT-NBR.            04020020
           MOVE BP207-CHNL-CDE          TO PV-PREV-STORE-CHNL.          04030020
                                                                        04040020
       2000-PROCESS-DATA.                                               04050020
                                                                        04060020
           IF   BP207-DEPT-NBR   = PV-PREV-DEPT-NBR                     04070020
            AND BP207-CHNL-CDE   = PV-PREV-STORE-CHNL                   04080020
               CONTINUE                                                 04090020
           ELSE                                                         04100020
             EVALUATE  PV-PREV-STORE-CHNL                               04110020
               WHEN 'TOTALCO'                                           04120020
                 PERFORM 2500-BUILD-WRITE-CST-DPT                       04130020
                 INITIALIZE PDT-PLAN-CST-TOT-TABLE                      04140020
               WHEN 'PHYSSTR'                                           04150020
               WHEN 'VIRTSTR'                                           04160020
                 PERFORM 2600-BUILD-WRITE-CST-DPT-CHNL                  04170020
                 INITIALIZE PDC-PLAN-CST-CHNL-TABLE                     04180020
             END-EVALUATE                                               04190020
             MOVE BP207-DEPT-NBR   TO PV-PREV-DEPT-NBR                  04200020
             MOVE BP207-CHNL-CDE   TO PV-PREV-STORE-CHNL                04210020
           END-IF.                                                      04220020
                                                                        04230020
           PERFORM 2100-FORMAT-AMOUNTS.                                 04240020
                                                                        04250020
SB0405     IF  PS-REJ-RECORD                                            04260020
SB0405         SET PS-DONT-REJ-RECORD TO TRUE                           04270020
SB0405     ELSE                                                         04280020
           EVALUATE  BP207-CHNL-CDE                                     04290020
             WHEN 'TOTALCO'                                             04300020
               PERFORM 2200-LOAD-DPT-CST-TABLE                          04310020
             WHEN 'PHYSSTR'                                             04320020
             WHEN 'VIRTSTR'                                             04330020
               PERFORM 2400-LOAD-DPT-CHNL-CST-TABLE                     04340020
           END-EVALUATE                                                 04350020
SB0405     END-IF.                                                      04360020
                                                                        04370020
                                                                        04380020
           PERFORM 7000-READ-DPT-PLN-FILE.                              04390020
                                                                        04400020
      ******************************************************************04410020
      *  THE INPUT RECORDS ARE IN A FIXED FORMAT.  THE NUMERIC FIELDS   04420020
      *  ARE IN A CHARACTER FORMAT.  THIS PARAGRAPH CONVERTS THE RETAIL 04430020
      *  AMOUNTS INTO A NUMERIC FORMAT.                                 04440020
      ******************************************************************04450020
       2100-FORMAT-AMOUNTS.                                             04460020
                                                                        04470020
           INITIALIZE PV-WEEKLY-AMT-TABLE.                              04480020
                                                                        04490020
      *     CONVERT THE WEEKLY AMT FIELDS TO NUMERIC VALUES.            04500020
                                                                        04510020
SB0405      SET PS-DONT-REJ-RECORD TO TRUE                              04520020
            PERFORM VARYING SS-WEEK FROM 1 BY 1                         04530020
              UNTIL SS-WEEK > SS-WEEK-MAX                               04540020
SB0405        OR PS-REJ-RECORD                                          04550020
                                                                        04560020
C55777*        IF  BP207-OVER-FLOW(SS-WEEK) > SPACES                    04570023
C55777*            DISPLAY '** REJECTED -RECORD **'                     04580023
C55777*            DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'              04590023
C55777*            DISPLAY '** OVER-FLOW EXISTS. PLAN AMT > 12 BYTES'   04600023
C55777*            DISPLAY '** BP207-PLN-AMT = ' BP207-PLN-AMT(SS-WEEK) 04610023
C55777*            DISPLAY '** BP207-OVER-FLOW = '                      04620023
C55777*                                      BP207-OVER-FLOW(SS-WEEK)   04630023
C55777*            DISPLAY '*************************************'      04640023
C55777*            SET PS-REJ-RECORD TO TRUE                            04650023
C55777*            ADD +1 TO PV-REJ-RECORD-CNT                          04660023
C55777*            WRITE REJECTED-REC  FROM                             04670023
C55777*                            BP207-PLANNING-RTL-RECORD            04680023
C55777*        ELSE                                                     04690023
                   MOVE SPACE TO DP010I-UNEDITED-FIELD                  04700020
                   MOVE BP207-PLN-AMT(SS-WEEK) TO DP010I-UNEDITED-FIELD 04710020
C55777             MOVE 8           TO DP010I-MAXIMUM-DIGITS            04720023
C55777*            MOVE 6           TO DP010I-MAXIMUM-DIGITS            04730023
                   MOVE 5           TO DP010I-MAXIMUM-DECIMALS          04740020
                   SET DP010I-NEGATIVE-ALLOWED TO TRUE                  04750020
                                                                        04760020
                   PERFORM 2150-NUMERIC-CONVERSION                      04770020
                                                                        04780020
SB0405             IF  PS-DONT-REJ-RECORD                               04790020
                       MOVE DP010I-NUMERIC-FIELD TO PV-AMT              04800020
                       COMPUTE PV-WEEKLY-AMT(SS-WEEK) ROUNDED =         04810020
                                                       PV-AMT * 1000    04820020
SB0405             END-IF                                               04830020
C55777*        END-IF                                                   04840023
           END-PERFORM.                                                 04850020
                                                                        04860020
                                                                        04870020
       2150-NUMERIC-CONVERSION.                                         04880020
                                                                        04890020
           CALL DP010I-NUMERIC-EDIT-ROUTINE USING                       04900020
                                            DP010I-NUMERIC-EDIT-AREA.   04910020
                                                                        04920020
           IF DP010I-NO-ERROR-DETECTED                                  04930020
               NEXT SENTENCE                                            04940020
           ELSE                                                         04950020
               IF DP010I-INVALID-CHARACTER                              04960020
                   MOVE ZEROES TO DP010I-NUMERIC-FIELD                  04970020
               ELSE                                                     04980020
SB0405             DISPLAY '** REJECTED RECORD **'                      04990020
SB0405             DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'              05000020
SB0405             DISPLAY '** PARAGRAPH 2150-NUMERIC-CONVERSION **'    05010020
SB0405             DISPLAY '** ERROR IN CALLED NUMERIC EDIT ROUTINE.'   05020020
SB0405             DISPLAY '** ERROR INDICATOR = ' DP010I-ERROR-IND     05030020
SB0405             DISPLAY '** INPUT RECORD = ' BP207-PLN-AMT(SS-WEEK)  05040020
SB0405             DISPLAY '*****************************'              05050020
SB0405             SET PS-REJ-RECORD TO TRUE                            05060020
SB0405             ADD +1 TO PV-REJ-RECORD-CNT                          05070020
SB0405             WRITE REJECTED-REC  FROM                             05080020
SB0405                             BP207-PLANNING-RTL-RECORD            05090020
SB0405*            DISPLAY '** ABEND **'                                05100020
SB0405*            DISPLAY '** PROGRAM ' PV-PGM-NAME ' **'              05110020
SB0405*            DISPLAY '** PARAGRAPH 2150-NUMERIC-CONVERSION **'    05120020
SB0405*            DISPLAY '** ERROR IN CALLED NUMERIC EDIT ROUTINE.'   05130020
SB0405*            DISPLAY '** ERROR INDICATOR = ' DP010I-ERROR-IND     05140020
SB0405*            DISPLAY '** INPUT RECORD = ' BP207-PLN-AMT(SS-WEEK)  05150020
SB0405*            MOVE +4008 TO PV-ABEND-CODE                          05160020
SB0405*            PERFORM 9999-ABEND                                   05170020
               END-IF                                                   05180020
           END-IF.                                                      05190020
                                                                        05200020
                                                                        05210020
      ******************************************************************05220020
      *  THIS PARAGRAPH EVALUATES THE INPUT DATA TO DETERMINE           05230020
      *  WHAT TYPE OF RECORD IS BEING PROCESSED.  IF THE RECORD IS ONE  05240020
      *  OF THE TYPES THAT SHOULD BE EXTRACTED, THE RETAIL AMOUNTS      05250020
      *  ARE LOADED BY WEEK INTO A WORKING STORAGE TABLE.               05260020
      ******************************************************************05270020
       2200-LOAD-DPT-CST-TABLE.                                         05280020
                                                                        05290020
           EVALUATE BP207-PLN-ELEMENT                                   05300020
            WHEN 'EOP_CST'                                              05310020
               PERFORM VARYING SS-WEEK FROM 1 BY 1                      05320020
                 UNTIL SS-WEEK > SS-WEEK-MAX                            05330020
                   MOVE PV-WEEKLY-AMT       (SS-WEEK)                   05340020
                     TO PDT-EOPINV-COST-AMT(SS-WEEK)                    05350020
               END-PERFORM                                              05360020
             WHEN 'SLS_CST'                                             05370020
               PERFORM VARYING SS-WEEK FROM 1 BY 1                      05380020
                 UNTIL SS-WEEK > SS-WEEK-MAX                            05390020
                   MOVE PV-WEEKLY-AMT       (SS-WEEK)                   05400020
                     TO PDT-SLS-COST-AMT(SS-WEEK)                       05410020
               END-PERFORM                                              05420020
           END-EVALUATE.                                                05430020
                                                                        05440020
      ******************************************************************05450020
      *  THIS PARAGRAPH EVALUATES THE INPUT DATA TO DETERMINE           05460020
      *  WHAT TYPE OF RECORD IS BEING PROCESSED.  IF THE RECORD IS ONE  05470020
      *  OF THE TYPES THAT SHOULD BE EXTRACTED, THE RETAIL AMOUNTS      05480020
      *  ARE LOADED BY WEEK INTO A WORKING STORAGE TABLE.               05490020
      ******************************************************************05500020
       2400-LOAD-DPT-CHNL-CST-TABLE.                                    05510020
                                                                        05520020
           EVALUATE BP207-PLN-ELEMENT                                   05530020
             WHEN 'EOP_CST'                                             05540020
               PERFORM VARYING SS-WEEK FROM 1 BY 1                      05550020
                 UNTIL SS-WEEK > SS-WEEK-MAX                            05560020
                   MOVE PV-WEEKLY-AMT       (SS-WEEK)                   05570020
                     TO PDC-EOPINV-COST-AMT (SS-WEEK)                   05580020
               END-PERFORM                                              05590020
             WHEN 'SLS_CST'                                             05600020
               PERFORM VARYING SS-WEEK FROM 1 BY 1                      05610020
                 UNTIL SS-WEEK > SS-WEEK-MAX                            05620020
                   MOVE PV-WEEKLY-AMT       (SS-WEEK)                   05630020
                     TO PDC-SLS-COST-AMT (SS-WEEK)                      05640020
               END-PERFORM                                              05650020
           END-EVALUATE.                                                05660020
                                                                        05670020
      ******************************************************************05680020
      *  THIS PARAGRAPH USES THE DATA THAT WAS TABLED FOR THE           05690020
      *  DEPARTMENT TO BUILD AND WRITE AN OUTPUT RECORD FOR EACH WEEK   05700020
      *  IN THE SEASON.                                                 05710020
      ******************************************************************05720020
       2500-BUILD-WRITE-CST-DPT.                                        05730020
                                                                        05740020
           MOVE PV-PREV-DEPT-NBR     TO BP208-DEPT-NBR.                 05750020
                                                                        05760020
           PERFORM VARYING SS-WEEK FROM 1 BY 1                          05770020
             UNTIL SS-WEEK > SS-WEEK-MAX                                05780020
                 MOVE FWT-FSCL-WK-BEG-DTE   (SS-WEEK)                   05790020
                   TO BP208-TM-DIM-KY-DTE                               05800020
                 MOVE PDT-EOPINV-COST-AMT   (SS-WEEK)                   05810020
                   TO BP208-EOPINV-COST-AMT                             05820020
                 MOVE PDT-SLS-COST-AMT      (SS-WEEK)                   05830020
                   TO BP208-SLS-COST-AMT                                05840020
                 PERFORM 7100-WRITE-WKLY-PLN-CST-DPT                    05850020
           END-PERFORM.                                                 05860020
                                                                        05870020
      ******************************************************************05880020
      *  THIS PARAGRAPH USES THE DATA THAT WAS TABLED FOR THE           05890020
      *  DEPARTMENT CHANNEL TO BUILD AND WRITE ON OUTPUT RECORD         05900020
      *  FOR EACH WEEK IN THE SEASON FOR TOTAL COST.                    05910020
      ******************************************************************05920020
       2600-BUILD-WRITE-CST-DPT-CHNL.                                   05930020
                                                                        05940020
           MOVE PV-PREV-DEPT-NBR     TO BP209-DEPT-NBR.                 05950020
                                                                        05960020
           EVALUATE TRUE                                                05970020
             WHEN PHYSICAL-STORE                                        05980020
               MOVE 'P' TO BP209-CHNL-CDE                               05990020
             WHEN E-STORE                                               06000020
               MOVE 'V' TO BP209-CHNL-CDE                               06010020
                                                                        06020020
           END-EVALUATE.                                                06030020
           PERFORM VARYING SS-WEEK FROM 1 BY 1                          06040020
             UNTIL SS-WEEK > SS-WEEK-MAX                                06050020
                 MOVE FWT-FSCL-WK-BEG-DTE   (SS-WEEK)                   06060020
                   TO BP209-TM-DIM-KY-DTE                               06070020
                 MOVE PDC-EOPINV-COST-AMT   (SS-WEEK)                   06080020
                   TO BP209-EOPINV-COST-AMT                             06090020
                 MOVE PDC-SLS-COST-AMT      (SS-WEEK)                   06100020
                   TO BP209-SLS-COST-AMT                                06110020
                 PERFORM 7200-WRITE-WKLY-PLN-CST-DPTCHL                 06120020
           END-PERFORM.                                                 06130020
                                                                        06140020
       7000-READ-DPT-PLN-FILE.                                          06150020
                                                                        06160020
           READ DPT-PLN-FILE                                            06170020
               INTO BP207-PLANNING-RTL-RECORD                           06180020
                   AT END SET PS-END-OF-PLN-CST-FILE TO TRUE.           06190020
                                                                        06200020
           IF NOT PS-END-OF-PLN-CST-FILE                                06210020
             ADD +1 TO PV-PLN-IN-CNT                                    06220020
           END-IF.                                                      06230020
                                                                        06240020
       7100-WRITE-WKLY-PLN-CST-DPT.                                     06250020
                                                                        06260020
      *IF THE DEPT NUMBER IS NON-NUMERIC SUPPRESS OUTPUT AND DISPLAY    06270020
      * THE RECORD                                                      06280020
           IF BP208-DEPT-NBR IS NUMERIC                                 06290020
              WRITE WKLY-PLN-CST-DPT-REC  FROM                          06300020
                    BP208-WKLY-PLN-CST-DPT-REC                          06310020
                                                                        06320020
              ADD +1 TO PV-CST-DPT-CNT                                  06330020
           ELSE                                                         06340020
              DISPLAY 'BP208 NON-NUMERIC DEPT REC: '                    06350020
                  BP208-WKLY-PLN-CST-DPT-REC                            06360020
           END-IF.                                                      06370020
                                                                        06380020
       7200-WRITE-WKLY-PLN-CST-DPTCHL.                                  06390020
                                                                        06400020
           IF BP209-DEPT-NBR IS NUMERIC                                 06410020
              WRITE WKLY-PLN-CST-DPT-CHNL-REC FROM                      06420020
                    BP209-WKLY-PLN-CST-DPTCHL-REC                       06430020
                                                                        06440020
              ADD +1 TO PV-CST-DPT-CHNL-CNT                             06450020
           ELSE                                                         06460020
              DISPLAY 'BP209 NON-NUMERIC DEPT REC: '                    06470020
                  BP209-WKLY-PLN-CST-DPTCHL-REC                         06480020
           END-IF.                                                      06490020
                                                                        06500020
       8000-GET-DATE-ATTRIBUTES.                                        06510020
                                                                        06520020
           EXEC SQL                                                     06530020
                SELECT                                                  06540020
                    SEA_BEG_DTE                                         06550020
                INTO                                                    06560020
                    :DTATTR-SEA-BEG-DTE                                 06570020
                FROM                                                    06580020
                    TDTATTR                                             06590020
                WHERE                                                   06600020
                    KY_DTE = :DTATTR-KY-DTE                             06610020
           END-EXEC.                                                    06620020
                                                                        06630020
           EVALUATE TRUE                                                06640020
               WHEN SQLCODE = ZERO                                      06650020
                   SET PS-DATE-FOUND     TO TRUE                        06660020
               WHEN SQLCODE = +100                                      06670020
                   SET PS-DATE-NOT-FOUND TO TRUE                        06680020
               WHEN OTHER                                               06690020
                   DISPLAY '** DTATTR-KY-DTE: ' DTATTR-KY-DTE           06700020
                   MOVE    '8000-GET-DATE-ATTRIBUTES'                   06710020
                                                TO PV-PARAGRAPH-NAME    06720020
                   MOVE    'SELECT ROW FROM TDTATTR'                    06730020
                                                TO PV-DB2-OPER-ATTEMPTED06740020
                   PERFORM 9998-SQL-ABEND                               06750020
           END-EVALUATE.                                                06760020
                                                                        06770020
                                                                        06780020
       8500-OPEN-FSCL-WK-CSR.                                           06790020
                                                                        06800020
           EXEC SQL                                                     06810020
                OPEN FSCL-WK-CSR                                        06820020
           END-EXEC.                                                    06830020
                                                                        06840020
           EVALUATE TRUE                                                06850020
               WHEN SQLCODE = ZERO                                      06860020
                   CONTINUE                                             06870020
               WHEN OTHER                                               06880020
                   MOVE '8500-OPEN-FSCL-WK-CSR'                         06890020
                                            TO PV-PARAGRAPH-NAME        06900020
                   MOVE 'OPEN FSCL-WK-CSR'  TO PV-DB2-OPER-ATTEMPTED    06910020
                   PERFORM 9998-SQL-ABEND                               06920020
           END-EVALUATE.                                                06930020
                                                                        06940020
                                                                        06950020
      ******************************************************************06960020
      *  THIS PARAGRAPH RETRIEVES THE FISCAL-WEEK-END-DATE AND FISCAL-  06970020
      *  WEEK-NUMBER FOR ALL WEEKS IN THE SEASON.  THESE VALUES WILL    06980020
      *  USED TO BUILD THE OUTPUT RECORDS.                              06990020
      ******************************************************************07000020
       8600-FETCH-FSCL-WK-CSR.                                          07010020
                                                                        07020020
           EXEC SQL                                                     07030020
               FETCH                                                    07040020
                   FSCL-WK-CSR                                          07050020
               INTO                                                     07060020
                  :DTATTR-FSCL-WK-NBR                                   07070020
                 ,:DTATTR-FSCL-WK-BEG-DTE                               07080020
           END-EXEC.                                                    07090020
                                                                        07100020
           EVALUATE TRUE                                                07110020
               WHEN SQLCODE = ZERO                                      07120020
                   CONTINUE                                             07130020
               WHEN SQLCODE = +100                                      07140020
                   SET PS-END-OF-FSCL-WK-CSR TO TRUE                    07150020
               WHEN OTHER                                               07160020
                   MOVE '8600-FETCH-FSCL-WK-CSR' TO PV-PARAGRAPH-NAME   07170020
                   MOVE 'FETCH FSCL-WK-CSR'     TO PV-DB2-OPER-ATTEMPTED07180020
                   PERFORM 9998-SQL-ABEND                               07190020
           END-EVALUATE.                                                07200020
                                                                        07210020
                                                                        07220020
       8700-CLOSE-FSCL-WK-CSR.                                          07230020
                                                                        07240020
           EXEC SQL                                                     07250020
               CLOSE FSCL-WK-CSR                                        07260020
           END-EXEC.                                                    07270020
                                                                        07280020
           EVALUATE TRUE                                                07290020
               WHEN SQLCODE = ZERO                                      07300020
                   CONTINUE                                             07310020
               WHEN OTHER                                               07320020
                   MOVE '8700-CLOSE-FSCL-WK-CSR' TO PV-PARAGRAPH-NAME   07330020
                   MOVE 'CLOSE FSCL-WK-CSR'     TO PV-DB2-OPER-ATTEMPTED07340020
                   PERFORM 9998-SQL-ABEND                               07350020
           END-EVALUATE.                                                07360020
                                                                        07370020
                                                                        07380020
      ******************************************************************07390020
      *  CLOSE FILES AND DISPLAY INPUT/OUTPUT RECORD COUNTS             07400020
      ******************************************************************07410020
       9000-EOJ.                                                        07420020
                                                                        07430020
           EVALUATE  PV-PREV-STORE-CHNL                                 07440020
             WHEN 'TOTALCO'                                             07450020
               PERFORM 2500-BUILD-WRITE-CST-DPT                         07460020
             WHEN 'PHYSSTR'                                             07470020
             WHEN 'VIRTSTR'                                             07480020
               PERFORM 2600-BUILD-WRITE-CST-DPT-CHNL                    07490020
           END-EVALUATE.                                                07500020
                                                                        07510020
           CLOSE DPT-PLN-FILE                                           07520020
                 WKLY-PLN-CST-DPT-FILE                                  07530020
SB0405           REJECTED-FILE                                          07540020
                 WKLY-PLN-CST-DPT-CHNL-FILE.                            07550020
                                                                        07560020
           DISPLAY 'PLANNING INPUT RECORDS   = '  PV-PLN-IN-CNT.        07570020
           DISPLAY 'PLAN COST DEPT RECS      = '  PV-CST-DPT-CNT.       07580020
           DISPLAY 'PLAN COST DEPT CHNL RECS = '  PV-CST-DPT-CHNL-CNT.  07590020
SB0405     DISPLAY 'REJECTED RECORDS         = '  PV-REJ-RECORD-CNT.    07600020
                                                                        07610020
       9998-SQL-ABEND.                                                  07620020
                                                                        07630020
           MOVE +4013 TO PV-ABEND-CODE.                                 07640020
           DISPLAY ' '.                                                 07650020
           DISPLAY '** ABEND **         ** = SQLERROR'.                 07660020
           DISPLAY '** PROGRAM          ** = ' PV-PGM-NAME.             07670020
           DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.       07680020
           DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.   07690020
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         07700020
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        07710020
           COPY DPPD004.                                                07720020
           PERFORM 9999-ABEND.                                          07730020
                                                                        07740020
                                                                        07750020
       9999-ABEND.                                                      07760020
                                                                        07770020
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        07780020
