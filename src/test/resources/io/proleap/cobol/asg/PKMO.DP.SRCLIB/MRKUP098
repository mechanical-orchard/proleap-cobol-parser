000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID.             MRKUP098.                                        
000600 AUTHOR.                 ANNE KINTOPF.                                    
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000800 DATE-WRITTEN            09-28-99.                                        
000900 DATE-COMPILED.                                                           
001000                                                                          
001100******************************************************************        
001200* THIS PROGRAM WILL SELECT ALL THE TRANSACTIONS OFF THE TMRTRN   *        
001300* AND TRMSTTR TABLES WITH THE EFFECTIVE DATE OF THE CURRENT DATE.*        
001400* THEN THE TMRITST AND TMRITEM TABLES WILL BE UPDATED WITH THE   *        
001500* DATA FROM THESE TRANSACTIONS.                                  *        
001600******************************************************************        
001601*  MODIFICATION LOG                                              *        
001602******************************************************************        
001603*  03/16/2000 - CAF - ADDED PARAGRAPH 7400 TO UPDATE AN APPLIED  *        
001604*  INDICATOR ON TMRTRN.  THIS WILL ALLOW MULTIPLE RUNS ON ONE    *        
001605*  DAY.  ALSO, I ADDED INTO THE DRIVING CURSOR A CHECK ON THE    *        
001606*  APLD_IND TO MAKE SURE IT IS A 'N' FOR NOT PROCESSED.          *        
001602******************************************************************        
001603*  07/19/2000 - AOK - ADDED ANOTHER DRIVING CURSOR. AFTER        *        
 01604*  THE STORE-CURSOR IS DONE PROCESSING, THEN THE ITEM-CURSOR IS  *        
001604*  PROCESSED AND TMRITEM IS UPDATED. ALSO CHANGED PROGRAM TO     *        
001604*  UPDATE APLD_IND ON TMRTRN EVEN IF THERE ARE ERRORS.           *        
001602******************************************************************        
001603*  02/24/2004 - AOK - ADDED TO THE COLUMNS THAT ARE UPDATED      *        
 01604*  ON TMRITEM AND TMRITST TO ACCOMODATE CHANGES FOR THE MIO      *        
001604*  ITEM AND STORE MAINTENANCE PROJECT.                           *        
001607******************************************************************        
002410* 07/30/2004 - ANNE KINTOPF STORE NUMBER EXPANSION  WR#26363    *         
002420* -  CHANGED REFERENCES FROM TSTR000 TO XMT_LOC                 *         
C52271******************************************************************        
C52271*  04/23/2013 - COGNIZANT      FIXED INVALID DD VALUE FROM MPX  *         
C52271*  FIELDS WITH NO DIGIT TO THE LEFT OF DECIMAL WILL BE PROCESSED*         
C52271*  CORRECTLY. ALSO THE TRAN ID WILL BE UPDATED ONLY AFTER ALL   *         
C52271*  THE RECS UNDER THE PARTICULAR TRAN ID IS PROCESSED           *         
002490*****************************************************************         
001700 ENVIRONMENT DIVISION.                                                    
001800******************************************************************        
001900                                                                          
002000 CONFIGURATION SECTION.                                                   
002100                                                                          
002200 SOURCE-COMPUTER.        IBM-3090.                                        
002300 OBJECT-COMPUTER.        IBM-3090.                                        
002400                                                                          
002500 INPUT-OUTPUT SECTION.                                                    
002600                                                                          
002700 FILE-CONTROL.                                                            
002800                                                                          
002900     SELECT PRINT-REPORT                                                  
003000         ASSIGN                       TO RPT01.                           
003100                                                                          
003200     EJECT                                                                
003300******************************************************************        
003400 DATA DIVISION.                                                           
003500******************************************************************        
003600 FILE SECTION.                                                            
003700                                                                          
003800 FD  PRINT-REPORT                                                         
003900     LABEL RECORDS ARE STANDARD                                           
004000     RECORDING MODE IS F                                                  
004100     BLOCK CONTAINS 0 RECORDS.                                            
004200                                                                          
004300 01  PRINT-LINE                       PIC X(132).                         
004400                                                                          
004500 WORKING-STORAGE SECTION.                                                 
004600                                                                          
004700 01  FILLER.                                                              
004800     05  FILLER                       PIC  X(36)  VALUE                   
004900        ' ***** WORKING STORAGE PGM=MRKUP098 '.                           
005000     05  FILLER                       PIC  X(10)  VALUE                   
005100         ' LOCATION='.                                                    
005200     05  PGM-LOCATION                 PIC  X(05)  VALUE SPACE.            
005300     05  FILLER                       PIC  X(06)  VALUE                   
005400         ' *****'.                                                        
005500                                                                          
005600 01  ABEND-CODE                       PIC S9(4)   VALUE ZERO              
005700                                      COMP SYNC.                          
005800                                                                          
005900 01  ABEND-AREAS.                                                         
006000     05  AA-ABEND-LIT                 PIC  X(40)  VALUE                   
006100             '*****       ABEND'.                                         
006200     05  AA-PROGRAM-LIT               PIC  X(40)  VALUE                   
006300             '*****   PROGRAM: MRKUP098'.                                 
006400     05  AA-PARAGRAPH-LIT.                                                
006500         10  FILLER                   PIC  X(17)  VALUE                   
006600             '***** PARAGRAPH: '.                                         
006700         10  AA-PARAGRAPH-NAME        PIC  X(35)  VALUE SPACES.           
006800                                                                          
010100 01  PV-NULL-INDICATORS.                                                  
010200     05  PV-END-EFF-DATE-IND          PIC S9(4)   VALUE 0                 
010300                                                  COMP SYNC.              
010200     05  PV-LT-IND                    PIC S9(4)   VALUE 0                 
010300                                                  COMP SYNC.              
010400     05  PV-RNK-ID-IND                PIC S9(4)   VALUE 0                 
010500                                                  COMP SYNC.              
010600                                                                          
010700 01  PV-PROGRAM-VARIABLES.                                                
010710     05  PV-REPORT-VARIABLES.                                             
010800         10  PV-LINE-CNT              PIC S9(3)                           
010900                                      COMP-3      VALUE +61.              
011000         10  PV-PAGE-CNT              PIC  9(3)   VALUE ZEROS.            
011100         10  PV-LINE-CONTROL          PIC  9(1)   VALUE ZEROS.            
011110     05  PV-COUNTERS.                                                     
011120         10  PV-TOTAL-CNT             PIC  S9(7)                          
011121                                      COMP-3      VALUE ZEROS.            
011122         10  PV-GOOD-CNT              PIC  S9(7)                          
011123                                      COMP-3      VALUE ZEROS.            
011130         10  PV-ERROR-CNT             PIC  S9(7)                          
011140                                      COMP-3      VALUE ZEROS.            
C52271         10  PV-ITEM-CNT              PIC  S9(7)                          
C52271                                      COMP-3      VALUE ZEROS.            
011300     05  PV-DEPT                      PIC   S9(4)V COMP-3.                
011300     05  PV-DEPARTMENT                PIC   X(3).                         
C52271     05  PV-HOLD-DEPT                 PIC   X(3).                         
011400     05  PV-CLASS                     PIC   S9(4)V COMP-3.                
011510     05  PV-SKU                       PIC   S9(8)V COMP-3.                
011300     05  PV-HOLD-TRAN-ID              PIC  S9(9)  COMP.                   
C52271     05  PV-TRAN-ID                   PIC  S9(9)  COMP.                   
011400     05  PV-NEW-TRAN-ID               PIC  S9(9)  COMP.                   
011510     05  PV-HOLD-DEPT-REPT            PIC  X(3)    VALUE SPACES.          
011600     05  PV-PARM-TEXT                 PIC  X(10).                         
011700     05  PV-MIN                       PIC  S9(7).                         
011800     05  PV-MIN-PACKED                PIC  S9(7)V COMP-3.                 
011900     05  PV-MAX                       PIC  S9(7).                         
012000     05  PV-MAX-PACKED                PIC  S9(7)V COMP-3.                 
012100     05  PV-CSTOCK                    PIC  S9(9).                         
012200     05  PV-CSTOCK-PACKED             PIC  S9(9)V COMP-3.                 
012211     05  PV-OSTRAT                    PIC  S9(3).                         
012220     05  PV-OSTRAT-PACKED             PIC  S9(3)V9(1) COMP-3.             
012100     05  PV-PTAG                      PIC  X(7).                          
012100     05  PV-DD                        PIC  S9(9).                         
012200     05  PV-DD-PACKED                 PIC  S9(9)V9 COMP-3.                
012100     05  PV-DDI                       PIC  S9(9).                         
012200     05  PV-DDI-PACKED                PIC  S9(9)V9 COMP-3.                
012100     05  PV-COMSTOCK                  PIC  S9(9).                         
012200     05  PV-COMSTOCK-PACKED           PIC  S9(9)V COMP-3.                 
012211     05  PV-LT                        PIC  S9(3).                         
012220     05  PV-LT-PACKED                 PIC  S9(3)V COMP-3.                 
012300     05  PV-FT-CODE                   PIC  X(1).                          
012300     05  PV-ORDER-GROUP               PIC  X(1).                          
012300     05  PV-PACK-SWITCH               PIC  X(1).                          
012300     05  PV-UCYCLE                    PIC  X(1).                          
016120     05  PV-BYPSCL                    PIC  S9(3).                         
016120     05  PV-BYPSCL-PACKED             PIC  S9(1)V9(2) COMP-3.             
016120     05  PV-BYPDDU                    PIC  X(1).                          
016120     05  PV-BYPZOH                    PIC  X(1).                          
016120     05  PV-BYPZSL                    PIC  X(1).                          
016120     05  PV-BYPTFP                    PIC  X(1).                          
016120     05  PV-BYPBEF                    PIC  X(1).                          
016120     05  PV-BYPAFT                    PIC  X(1).                          
016120     05  PV-ZSSTOCK                   PIC  X(1).                          
016120     05  PV-FRCDDU                    PIC  X(1).                          
016120     05  PV-ZOPSW                     PIC  X(1).                          
016120     05  PV-DDUPRM                    PIC  X(1).                          
016120     05  PV-DDFTSW                    PIC  X(1).                          
016120     05  PV-RTF                       PIC  S9V9(1).                       
016120     05  PV-RTF-PACKED                PIC  S9V9(1) COMP-3.                
016120     05  PV-MINBI                     PIC  S9V9(1).                       
016120     05  PV-MINBI-PACKED              PIC  S9V9(1) COMP-3.                
016120     05  PV-OUTLSW                    PIC  X(1).                          
016120     05  PV-DSER                      PIC  X(1).                          
016120     05  PV-TSL                       PIC  9V9(1).                        
016120     05  PV-TSL-PACKED                PIC  S9V9(1) COMP-3.                
016120     05  PV-IMIN                      PIC  S9(7).                         
016120     05  PV-IMIN-PACKED               PIC  S9(7)V COMP-3.                 
016120     05  PV-IMAX                      PIC  S9(7).                         
016120     05  PV-IMAX-PACKED               PIC  S9(7)V COMP-3.                 
012400     05  PV-SKU-DESC                  PIC  X(25).                         
012400     05  PV-STORE                     PIC  9(5).                          
012500*    05  PV-STORE-LARGE               PIC  X(4).                          
012600*    05  PV-STORE-LARGE-X REDEFINES PV-STORE-LARGE.                       
012700*        10  FILLER                   PIC  X(1).                          
012800*        10  PV-STORE                 PIC  X(3).                          
015800     05  PV-CURR-TMST                 PIC  X(26)   VALUE SPACES.          
015900     05  PV-COMMIT-TMST               PIC  X(26)   VALUE SPACES.          
015901                                                                          
015901 01  PV-FORMAT-VARIABLES.                                                 
015900     05  PV-TEXT                      PIC  X(10)   VALUE SPACES.          
015900     05  PV-TEXT-ARRAY REDEFINES PV-TEXT.                                 
015900         10  PV-TEXT-VALUE            PIC  X                              
015901                                      OCCURS 10 TIMES.                    
015900     05  PV-NUMERIC                   PIC  9.                             
015900     05  PV-NUMERIC2                  PIC  99.                            
015900     05  PV-NUMERIC3                  PIC  999.                           
015900     05  PV-NUMERIC4                  PIC  9999.                          
015900     05  PV-NUMERIC5                  PIC  99999.                         
015900     05  PV-DECIMAL                   PIC  9.                             
015900     05  PV-DECIMALS                  PIC  99.                            
015900     05  PV-TOTAL                     PIC  9V9.                           
015900     05  PV-TOTALS                    PIC  9V99.                          
015900     05  PV-TOTAL2                    PIC  99V9.                          
015900     05  PV-TOTAL3                    PIC  999V9.                         
015900     05  PV-TOTAL4                    PIC  9999V9.                        
015900     05  PV-TOTAL5                    PIC  99999V9.                       
015900     05  PV-TOTAL-DD                  PIC  99999V9.                       
015900     05  PV-DIGIT-NUM                 PIC  99.                            
015900     05  PV-DIGIT-DEC                 PIC  99.                            
015900     05  PV-TEXT-INDEX                PIC  99.                            
015900     05  PV-TEXT-INDEX2               PIC  99.                            
015900     05  PV-ZERO                      PIC  9      VALUE 0.                
015901                                                                          
015902 01  PS-PROGRAM-SWITCHES-FLAGS.                                           
015903     05  PS-END-OF-ITEM-CURSOR        PIC  X      VALUE 'N'.              
015904         88  END-OF-ITEM-CURSOR                   VALUE 'Y'.              
015903     05  PS-END-OF-STORE-CURSOR       PIC  X      VALUE 'N'.              
015904         88  END-OF-STORE-CURSOR                  VALUE 'Y'.              
015905     05  PS-RECORDS-WRITTEN           PIC  X      VALUE 'N'.              
015906         88  RECORDS-WRITTEN                      VALUE 'Y'.              
015907         88  NO-RECORDS-WRITTEN                   VALUE 'N'.              
015908     05  PS-ERROR-IN-ROW              PIC  X      VALUE 'N'.              
015909         88  NO-ERROR                             VALUE 'N'.              
015910         88  ERROR-FOUND                          VALUE 'Y'.              
015908     05  PS-REVERT-RECORD-FOUND       PIC  X      VALUE 'Y'.              
015909         88  REVERT-RECORD-FOUND                  VALUE 'Y'.              
015910         88  NO-REVERT-RECORD-FOUND               VALUE 'N'.              
015908     05  PS-STORE-ITEM-FLAG           PIC  X      VALUE ' '.              
015909         88  PS-STORE                             VALUE 'S'.              
015910         88  PS-ITEM                              VALUE 'I'.              
015911                                                                          
015912 01  CT-CPU-TIME.                                                         
015913     05  CT-CPU-HR                    PIC 9(2)       VALUE ZEROS.         
015914     05  CT-CPU-MIN                   PIC 9(2)       VALUE ZEROS.         
015915     05  CT-CPU-SEC                   PIC 9(2)       VALUE ZEROS.         
015916     05  CT-CPU-HSEC                  PIC 9(2)       VALUE ZEROS.         
015917                                                                          
015918 01  CD-SCHEDULE-DATE                 PIC X(10).                          
015919 01  CD-DATE REDEFINES CD-SCHEDULE-DATE.                                  
015920     05  CD-YEAR                      PIC 9(4).                           
015921     05  FILLER                       PIC X.                              
015922     05  CD-MONTH                     PIC 99.                             
015923     05  FILLER                       PIC X.                              
016000     05  CD-DAY                       PIC 99.                             
016100                                                                          
016101 01  PC-CONSTANTS.                                                        
016102     05  PC-ONE                       PIC S9(2)   VALUE +1.               
016103     05  PC-TWO                       PIC S9(2)   VALUE +2.               
016104     05  PC-SIX                       PIC S9(2)   VALUE +6.               
016108     05  PC-PGM-NAME                  PIC  X(08)  VALUE                   
016109                                                  'MRKUP098'.             
016110     05  PC-ROW-NOT-FOUND             PIC S9(04)  VALUE +100              
016111                                                  COMP SYNC.              
016112     05  PC-Y                         PIC  X(1)   VALUE 'Y'.              
016113     05  PC-N                         PIC  X(1)   VALUE 'N'.              
016114     05  PC-MAX-LINES                 PIC S9(3)                           
016115                                      COMP-3      VALUE +60.              
016116     05  PC-MIN                      PIC X(10) VALUE 'MIN       '.        
016117     05  PC-MAX                      PIC X(10) VALUE 'MAX       '.        
016118     05  PC-FTCODE                   PIC X(10) VALUE 'FTCODE    '.        
016119     05  PC-CSTOCK                   PIC X(10) VALUE 'CSTOCK    '.        
016120     05  PC-OSTRAT                   PIC X(10) VALUE 'OSTRAT    '.        
016120     05  PC-PTAG                     PIC X(10) VALUE 'PTAG      '.        
016120     05  PC-DD                       PIC X(10) VALUE 'DD        '.        
016120     05  PC-DDI                      PIC X(10) VALUE 'DDI       '.        
016120     05  PC-COMSTOCK                 PIC X(10) VALUE 'COMSTOCK  '.        
016120     05  PC-LT                       PIC X(10) VALUE 'LT        '.        
016120     05  PC-ORDER-GROUP              PIC X(10) VALUE 'ORDGRP    '.        
016120     05  PC-UCYCLE                   PIC X(10) VALUE 'UCYCLE    '.        
016120     05  PC-PACK-SWITCH              PIC X(10) VALUE 'PACKSW    '.        
016120     05  PC-BYPSCL                   PIC X(10) VALUE 'BYPSCL    '.        
016120     05  PC-BYPDDU                   PIC X(10) VALUE 'BYPDDU    '.        
P16120     05  PC-BYPZOH                   PIC X(10) VALUE 'BYPZOH    '.        
016120     05  PC-BYPZSL                   PIC X(10) VALUE 'BYPZSL    '.        
016120     05  PC-BYPTFP                   PIC X(10) VALUE 'BYPTFP    '.        
016120     05  PC-BYPBEF                   PIC X(10) VALUE 'BYPBEF    '.        
016120     05  PC-BYPAFT                   PIC X(10) VALUE 'BYPAFT    '.        
016120     05  PC-ZSSTOCK                  PIC X(10) VALUE 'ZSSTOCK   '.        
016120     05  PC-FRCDDU                   PIC X(10) VALUE 'FRCDDU    '.        
016120     05  PC-ZOPSW                    PIC X(10) VALUE 'ZOPSW     '.        
016120     05  PC-DDUPRM                   PIC X(10) VALUE 'DDUPRM    '.        
016120     05  PC-DDFTSW                   PIC X(10) VALUE 'DDFTSW    '.        
016120     05  PC-RTF                      PIC X(10) VALUE 'RTF       '.        
016120     05  PC-MINBI                    PIC X(10) VALUE 'MINBI     '.        
016120     05  PC-OUTLSW                   PIC X(10) VALUE 'OUTLSW    '.        
016120     05  PC-DSER                     PIC X(10) VALUE 'DSER      '.        
016120     05  PC-TSL                      PIC X(10) VALUE 'TSL       '.        
016120     05  PC-IMIN                     PIC X(10) VALUE 'IMIN      '.        
016120     05  PC-IMAX                     PIC X(10) VALUE 'IMAX      '.        
015901                                                                          
010700 01  PC-ERROR-MESSAGE.                                                    
010710     05  PC-TMRITST-ERROR             PIC  X(35)  VALUE                   
017100         'ROW DOES NOT EXTIST ON TMRITST     '.                           
010710     05  PC-TMRITEM-ERROR             PIC  X(35)  VALUE                   
017100         'ROW DOES NOT EXTIST ON TMRITEM     '.                           
010710     05  PC-TMRSTTR-ERROR             PIC  X(35)  VALUE                   
017100         'ROW DOES NOT EXTIST ON TMRSTTR     '.                           
010710     05  PC-TMRSKTR-ERROR             PIC  X(35)  VALUE                   
017100         'ROW DOES NOT EXTIST ON TMRSKTR     '.                           
010710     05  PC-TRN-ID-ERROR              PIC  X(35)  VALUE                   
017100         'REVERT TRAN ID NOT FOUND           '.                           
010710     05  PC-PARM-ERROR                PIC  X(35)  VALUE                   
017100         'PARM IS NOT VALID                  '.                           
010710     05  PC-NUM-ERROR                 PIC  X(35)  VALUE                   
017100         'PARM TEXT NOT NUMERIC              '.                           
010710     05  PC-PARM-TEXT-ERROR           PIC  X(35)  VALUE                   
017100         'PARM TEXT IS SPACES                '.                           
016130                                                                          
016300******************************************************************        
016400** STANDARD HEADER LINE - KOHLS 132 COL                          *        
016500******************************************************************        
016600     COPY DPWS132.                                                        
016700                                                                          
016800 01  HL-HEADING-LINE1.                                                    
016900     05  FILLER                       PIC  X(50)  VALUE SPACES.           
017000     05  FILLER                       PIC  X(32)  VALUE                   
017100         '    TRANSACTION ERROR REPORT    '.                              
017200     05  FILLER                       PIC  X(50)  VALUE SPACES.           
017300                                                                          
017400 01  CL-COLUMN-LINE1.                                                     
017500     05  FILLER                       PIC  X(50)  VALUE                   
017600         'DEPT CLASS SKU       DESCRIPTION                ST'.            
017700     05  FILLER                       PIC  X(50)  VALUE                   
017800         'ORE    TRAN ID  PARM CODE   PARM VALUE  EFF DATE  '.            
017900     05  FILLER                       PIC  X(32)  VALUE                   
018000         '  UPDATE TIMESTAMP     USERID  '.                               
018100 01  CL-COLUMN-DASHES.                                                    
018200     05  FILLER                       PIC  X(50)  VALUE                   
018300         '---- ----- --------  -----------                --'.            
018400     05  FILLER                       PIC  X(50)  VALUE                   
018500         '---    -------  ---------   ----------  ----------'.            
018600     05  FILLER                       PIC  X(32)  VALUE                   
018700         '  ----------------     ------  '.                               
018800                                                                          
018900 01  DETAIL-LINE1.                                                        
019000     05  DL-DEPT                      PIC  9(3).                          
019100     05  FILLER                       PIC  X(2)   VALUE SPACES.           
019200     05  DL-CLASS                     PIC  9(2).                          
019300     05  FILLER                       PIC  X(4)   VALUE SPACES.           
019400     05  DL-SKU-SEQ                   PIC  9(8).                          
019500     05  FILLER                       PIC  X(2)   VALUE SPACES.           
019600     05  DL-DESCRIPTION               PIC  X(25).                         
019700     05  FILLER                       PIC  X(2)   VALUE SPACES.           
019800     05  DL-STORE-X                   PIC  X(5).                          
019800     05  DL-STORE REDEFINES DL-STORE-X.                                   
019800         10  DL-STORE-N               PIC  ZZZZ9.                         
019900     05  FILLER                       PIC  X(2)   VALUE SPACES.           
020000     05  DL-TRANS-ID                  PIC  ZZZZZZZZ9.                     
020100     05  FILLER                       PIC  X(2)   VALUE SPACES.           
020200     05  DL-PARM-CODE                 PIC  X(10).                         
020300     05  FILLER                       PIC  X(2)   VALUE SPACES.           
020400     05  DL-PARM-VALUE                PIC  X(10).                         
020500     05  FILLER                       PIC  X(2)   VALUE SPACES.           
020600     05  DL-EFF-DATE                  PIC  X(10).                         
020700     05  FILLER                       PIC  X(2)   VALUE SPACES.           
020800     05  DL-TIMESTAMP                 PIC  X(20).                         
020900     05  FILLER                       PIC  X(1)   VALUE SPACES.           
021000     05  DL-USERID                    PIC  X(8).                          
021100                                                                          
018900 01  DETAIL-LINE2.                                                        
019100     05  FILLER                       PIC  X(16)  VALUE SPACES.           
020800     05  DL-ERROR-MESSAGE             PIC  X(35).                         
020900     05  FILLER                       PIC  X(81)  VALUE SPACES.           
021100                                                                          
021200 01  END-OF-REPORT-LINE.                                                  
021300     05  FILLER                       PIC  X(25)  VALUE                   
021400         ' ** END OF REPORT **     '.                                     
021500                                                                          
021600 01  MSG-NO-ERROR-RECORDS.                                                
021700     05  FILLER                       PIC  X(50)  VALUE                   
021800      '          ** NO RECORDS WERE FOUND WITH ERRORS**  '.               
021900     05  FILLER                       PIC  X(50)  VALUE                   
022000      '                                                  '.               
022100     05  FILLER                       PIC  X(32)  VALUE SPACES.           
022200                                                                          
022300  EJECT.                                                                  
022500                                                                          
022600************************                                                  
022700* DB2 TABLES                                                              
022800************************                                                  
022900                                                                          
023000     EXEC SQL                                                             
023200         INCLUDE TCKRSTCN                                                 
023201     END-EXEC.                                                            
023202                                                                          
023203     EXEC SQL                                                             
023204         INCLUDE TMRSTTR                                                  
023205     END-EXEC.                                                            
023300                                                                          
023203     EXEC SQL                                                             
023204         INCLUDE TMRSKTR                                                  
023205     END-EXEC.                                                            
023300                                                                          
023400     EXEC SQL                                                             
023500         INCLUDE TMRTRN                                                   
023600     END-EXEC.                                                            
023700                                                                          
023800     EXEC SQL                                                             
023900         INCLUDE TMRITST                                                  
024000     END-EXEC.                                                            
023700                                                                          
023800     EXEC SQL                                                             
023900         INCLUDE TMRITEM                                                  
024000     END-EXEC.                                                            
023700                                                                          
024200     EXEC SQL                                                             
024300         INCLUDE TSK                                                      
024400     END-EXEC.                                                            
024500                                                                          
024200     EXEC SQL                                                             
024300         INCLUDE TSKXREF                                                  
024400     END-EXEC.                                                            
024500                                                                          
024600************************                                                  
024700* DB2 COMMUNICATION AREA                                                  
024800************************                                                  
024900                                                                          
025000     EXEC SQL                                                             
025100         INCLUDE SQLCA                                                    
025200     END-EXEC.                                                            
024900                                                                          
025400     COPY SQLCA2.                                                         
024500                                                                          
024600************************                                                  
024700* DB2 CUSRORS                                                             
024800************************                                                  
024900                                                                          
025500* 3/16/2000 - CAF - ADDED APLD_IND CHECK                                  
025600     EXEC SQL                                                             
025700       DECLARE STORE-LEVEL CURSOR WITH HOLD FOR                           
025800             SELECT B.ITM_NBR                                             
025900                  , B.DEPT_NBR                                            
025900                  , B.MAJ_CL_NBR                                          
026000                  , B.SUB_CL_NBR                                          
026100                  , B.SKU_NBR                                             
026200                  , B.STR_NBR                                             
026300                  , B.PARM_VAL_TXT                                        
026900                  , A.TRN_ID                                              
026901                  , A.PARM_CDE                                            
026902                  , A.EFF_STRT_DTE                                        
026903                  , A.EFF_END_DTE                                         
027000                  , A.LAST_UPD_TMST                                       
027100                  , A.LAST_UPD_BY_USR_ID                                  
027101                  , A.RNK_ID                                              
027102                  , A.RVRT_VAL_OBTND_CDE                                  
027200              FROM TMRTRN    A                                            
027300                  ,TMRSTTR   B                                            
027400              WHERE A.DEPT_NBR      = B.DEPT_NBR                          
027500               AND  A.TRN_ID        = B.TRN_ID                            
027600               AND  A.EFF_STRT_DTE  = :CD-SCHEDULE-DATE                   
027610               AND  A.APLD_IND      = :PC-N                               
027700              ORDER BY                                                    
027800                    B.ITM_NBR                                             
027900                  , B.STR_NBR                                             
028000                  , A.TRN_ID                                              
028100     END-EXEC.                                                            
028200                                                                          
025600     EXEC SQL                                                             
025700       DECLARE ITEM-LEVEL CURSOR WITH HOLD FOR                            
025800             SELECT B.ITM_NBR                                             
025900                  , B.DEPT_NBR                                            
025900                  , B.MAJ_CL_NBR                                          
026000                  , B.SUB_CL_NBR                                          
026100                  , B.SKU_NBR                                             
026300                  , B.PARM_VAL_TXT                                        
026900                  , A.TRN_ID                                              
026901                  , A.PARM_CDE                                            
026902                  , A.EFF_STRT_DTE                                        
026903                  , A.EFF_END_DTE                                         
027000                  , A.LAST_UPD_TMST                                       
027100                  , A.LAST_UPD_BY_USR_ID                                  
027101                  , A.RNK_ID                                              
027102                  , A.RVRT_VAL_OBTND_CDE                                  
027200              FROM TMRTRN    A                                            
027300                  ,TMRSKTR   B                                            
027400              WHERE A.DEPT_NBR      = B.DEPT_NBR                          
027500               AND  A.TRN_ID        = B.TRN_ID                            
027600               AND  A.EFF_STRT_DTE  = :CD-SCHEDULE-DATE                   
027610               AND  A.APLD_IND      = :PC-N                               
027700              ORDER BY                                                    
027800                    B.ITM_NBR                                             
028000                  , A.TRN_ID                                              
028100     END-EXEC.                                                            
028200                                                                          
028300******************************************************************        
028400 PROCEDURE DIVISION.                                                      
028500******************************************************************        
028600 0000-MAINLINE.                                                           
028700                                                                          
028800     PERFORM 1000-INITIALIZE.                                             
028700                                                                          
028700     SET PS-STORE             TO TRUE.                                    
C52271     INITIALIZE  PV-HOLD-DEPT                                             
C52271                 PV-HOLD-TRAN-ID                                          
028900     PERFORM 2000-PROCESS-STORE-CURSOR                                    
029000         UNTIL END-OF-STORE-CURSOR.                                       
C52271     IF PV-TOTAL-CNT   > 0                                                
C52271        MOVE PV-DEPARTMENT  TO PV-HOLD-DEPT                               
C52271        MOVE PV-TRAN-ID     TO PV-HOLD-TRAN-ID                            
C52271                                                                          
C52271        PERFORM 7600-UPDATE-TMRTRN-APLD-IND                               
C52271     END-IF.                                                              
029100     PERFORM 6200-CLOSE-STORE-LEVEL-CSR.                                  
028700                                                                          
028700     SET PS-ITEM              TO TRUE.                                    
C52271     INITIALIZE  PV-HOLD-DEPT                                             
C52271                 PV-HOLD-TRAN-ID                                          
094932     PERFORM 6300-OPEN-ITEM-LEVEL-CURSOR.                                 
094933     PERFORM 6400-FETCH-ITEM-CSR.                                         
028900     PERFORM 3000-PROCESS-ITEM-CURSOR                                     
029000         UNTIL END-OF-ITEM-CURSOR.                                        
C52271     IF PV-ITEM-CNT    > 0                                                
C52271        MOVE PV-DEPARTMENT  TO PV-HOLD-DEPT                               
C52271        MOVE PV-TRAN-ID     TO PV-HOLD-TRAN-ID                            
C52271                                                                          
C52271        PERFORM 7600-UPDATE-TMRTRN-APLD-IND                               
C52271     END-IF.                                                              
029100     PERFORM 6500-CLOSE-ITEM-LEVEL-CSR.                                   
028700                                                                          
029100     PERFORM 9900-EOJ-ROUTINE.                                            
029200     STOP RUN.                                                            
029300                                                                          
029400******************************************************************        
029500*  SET UP FOR PROGRAM PROCESSING BY GETTING THE SCHEDULE DATE,   *        
029500*  OPENING THE FILES, SETTING UP THE COMMIT TIMESTAMP, OPENING   *        
029600*  THE STORE CURSOR, AND FETCHING THE FIRST ROW FROM THE CURSOR. *        
029800******************************************************************        
029900 1000-INITIALIZE.                                                         
030000                                                                          
094897     MOVE '1000'                        TO PGM-LOCATION.                  
094898     MOVE '1000-INITIALIZE           '  TO AA-PARAGRAPH-NAME.             
094899                                                                          
094900     OPEN OUTPUT PRINT-REPORT.                                            
094901                                                                          
094902     ACCEPT CT-CPU-TIME FROM TIME.                                        
094903     MOVE CT-CPU-HR                   TO DP132-RUN-HOUR.                  
094904     MOVE CT-CPU-MIN                  TO DP132-RUN-MINUTE.                
094905                                                                          
094906     ACCEPT CD-SCHEDULE-DATE.                                             
094907     MOVE CD-MONTH                    TO DP132-RUN-MONTH.                 
094908     MOVE CD-DAY                      TO DP132-RUN-DAY.                   
094909     MOVE CD-YEAR                     TO DP132-RUN-YEAR.                  
094910                                                                          
094911     MOVE 1                           TO DP132-REPORT-NUMBER.             
094912     MOVE PC-PGM-NAME                 TO DP132-PROGRAM-NAME.              
094913                                                                          
094914*  SET UP FIRST SCHEDULED COMMIT TIME                                     
094915                                                                          
094916     EXEC SQL                                                             
094917         SELECT  (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)            
094918           INTO  :PV-COMMIT-TMST                                          
094919           FROM  TCKRSTCNTL                                               
094920          WHERE  PLAN_NAME = 'MRKUP098'                                   
094921     END-EXEC.                                                            
094922                                                                          
094923     IF SQLCODE = +0                                                      
094924         CONTINUE                                                         
094925     ELSE                                                                 
094926         DISPLAY AA-ABEND-LIT                                             
094927         DISPLAY AA-PROGRAM-LIT                                           
094928         DISPLAY AA-PARAGRAPH-LIT                                         
094929         PERFORM 9999-SQL-ERROR                                           
094930     END-IF.                                                              
094931                                                                          
094932     PERFORM 6000-OPEN-STORE-LEVEL-CURSOR.                                
094933     PERFORM 6100-FETCH-STORE-CSR.                                        
094934                                                                          
094935*****************************************************************         
094936* PROCESS STORE CURSOR.                                                   
094937*****************************************************************         
094938 2000-PROCESS-STORE-CURSOR.                                               
094939                                                                          
094940     MOVE PC-N                          TO PS-ERROR-IN-ROW.               
C52271     MOVE MRTRN-TRN-ID                  TO PV-TRAN-ID.                    
094942*    MOVE MRSTTR-STR-NBR                TO PV-STORE-LARGE.                
094940     MOVE MRSTTR-DEPT-NBR               TO PV-DEPARTMENT.                 
094943                                                                          
094948     IF MRSTTR-PARM-VAL-TXT = SPACES                                      
095026         MOVE PC-PARM-TEXT-ERROR        TO DL-ERROR-MESSAGE               
095025         PERFORM 5000-CREATE-ERROR-REPORT                                 
095026         MOVE PC-Y                      TO PS-ERROR-IN-ROW                
094946     END-IF.                                                              
094943                                                                          
094948     IF NO-ERROR                                                          
094944         IF MRTRN-RVRT-VAL-OBTND-CDE    =  'B'                            
094945             PERFORM 2100-CHANGE-TMRSTTR-TABLE                            
094946         END-IF                                                           
094946     END-IF.                                                              
094943                                                                          
094948     IF NO-ERROR                                                          
094949         PERFORM 2200-CHANGE-TMRITST-TABLE                                
094950     END-IF.                                                              
094943                                                                          
094961* 3/16/2000 - CAF - ADDED PERFORM OF 7600-TMRTRN-APLD-IND                 
C52271                                                                          
C52271     IF PV-HOLD-DEPT  = SPACES                                            
C52271        MOVE PV-DEPARTMENT  TO PV-HOLD-DEPT                               
C52271        MOVE PV-TRAN-ID     TO PV-HOLD-TRAN-ID                            
C52271     END-IF.                                                              
C52271                                                                          
C52271     IF PV-DEPARTMENT  = PV-HOLD-DEPT AND                                 
C52271        PV-TRAN-ID     = PV-HOLD-TRAN-ID                                  
C52271         CONTINUE                                                         
C52271     ELSE                                                                 
C52271         PERFORM 7600-UPDATE-TMRTRN-APLD-IND                              
C52271         MOVE PV-DEPARTMENT TO PV-HOLD-DEPT                               
C52271         MOVE PV-TRAN-ID    TO PV-HOLD-TRAN-ID                            
C52271     END-IF.                                                              
C52271                                                                          
094967     ADD PC-ONE                 TO PV-TOTAL-CNT.                          
094964                                                                          
094962     IF NO-ERROR                                                          
094965         ADD PC-ONE             TO PV-GOOD-CNT                            
094966     ELSE                                                                 
094968         ADD PC-ONE             TO PV-ERROR-CNT                           
094969     END-IF.                                                              
094970                                                                          
094971     PERFORM 9000-COMMIT-TEST.                                            
094972     PERFORM 6100-FETCH-STORE-CSR.                                        
094973                                                                          
094974*****************************************************************         
094975* GET DATA AND UPDATE TMRSTTR TABLE                             *         
094976*****************************************************************         
094977 2100-CHANGE-TMRSTTR-TABLE.                                               
094978                                                                          
094978     SET REVERT-RECORD-FOUND               TO TRUE.                       
094978                                                                          
094979     PERFORM 8000-SELECT-ORIGINAL-TRNID.                                  
094978                                                                          
094981     IF REVERT-RECORD-FOUND                                               
094980         PERFORM 8100-SELECT-TMRITST                                      
094993     END-IF.                                                              
094978                                                                          
094981     IF REVERT-RECORD-FOUND AND NO-ERROR                                  
094982         EVALUATE TRUE                                                    
094983           WHEN MRTRN-PARM-CDE  = PC-MIN                                  
094984             MOVE MRITST-USERMIN-QTY       TO PV-PARM-TEXT                
094992             PERFORM 8200-UPDATE-TMRSTTR                                  
094985           WHEN MRTRN-PARM-CDE  = PC-MAX                                  
094986             MOVE MRITST-USERMAX-QTY       TO PV-PARM-TEXT                
094992             PERFORM 8200-UPDATE-TMRSTTR                                  
094987           WHEN MRTRN-PARM-CDE  = PC-CSTOCK                               
094988             MOVE MRITST-CSTOCK-QTY        TO PV-PARM-TEXT                
094992             PERFORM 8200-UPDATE-TMRSTTR                                  
094989           WHEN MRTRN-PARM-CDE  = PC-FTCODE                               
094990             MOVE MRITST-FT-CDE            TO PV-PARM-TEXT                
094992             PERFORM 8200-UPDATE-TMRSTTR                                  
094989           WHEN MRTRN-PARM-CDE  = PC-OSTRAT                               
094990             MOVE MRITST-OSTRAT-QTY        TO PV-OSTRAT                   
094990             MOVE PV-OSTRAT                TO PV-PARM-TEXT                
094992             PERFORM 8200-UPDATE-TMRSTTR                                  
095024           WHEN OTHER                                                     
095026             MOVE PC-PARM-ERROR    TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
094991         END-EVALUATE                                                     
094993     END-IF.                                                              
094994                                                                          
094995*****************************************************************         
094996* GET DATA AND UPDATE TMRITST TABLE                             *         
094997*****************************************************************         
094998 2200-CHANGE-TMRITST-TABLE.                                               
094999                                                                          
095000     EVALUATE TRUE                                                        
095001       WHEN MRTRN-PARM-CDE = PC-MIN                                       
095002         UNSTRING MRSTTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' OR '.' INTO PV-MIN                            
               IF PV-MIN NUMERIC                                                
095004             MOVE PV-MIN              TO PV-MIN-PACKED                    
095005             PERFORM 7000-UPDATE-TMRITST-MIN                              
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095006       WHEN MRTRN-PARM-CDE      = PC-MAX                                  
095007         UNSTRING MRSTTR-PARM-VAL-TXT                                     
095008           DELIMITED BY ' ' OR '.' INTO PV-MAX                            
               IF PV-MAX NUMERIC                                                
095009             MOVE PV-MAX              TO PV-MAX-PACKED                    
095010             PERFORM 7100-UPDATE-TMRITST-MAX                              
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095011       WHEN MRTRN-PARM-CDE  = PC-CSTOCK                                   
095012         UNSTRING MRSTTR-PARM-VAL-TXT                                     
095013           DELIMITED BY ' ' OR '.' INTO PV-CSTOCK                         
               IF PV-CSTOCK NUMERIC                                             
095014             MOVE PV-CSTOCK           TO PV-CSTOCK-PACKED                 
095015             PERFORM 7200-UPDATE-TMRITST-CSTOCK                           
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095016       WHEN MRTRN-PARM-CDE  = PC-FTCODE                                   
095017         MOVE MRSTTR-PARM-VAL-TXT TO PV-FT-CODE                           
095018         PERFORM 7300-UPDATE-TMRITST-FTCODE                               
095019       WHEN MRTRN-PARM-CDE  = PC-OSTRAT                                   
095020         UNSTRING MRSTTR-PARM-VAL-TXT                                     
095021           DELIMITED BY ' ' OR '.' INTO PV-OSTRAT                         
               IF PV-OSTRAT NUMERIC                                             
095022             MOVE PV-OSTRAT           TO PV-OSTRAT-PACKED                 
095023             PERFORM 7400-UPDATE-TMRITST-OSTRAT                           
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095019       WHEN MRTRN-PARM-CDE  = PC-PTAG                                     
095020         UNSTRING MRSTTR-PARM-VAL-TXT                                     
095021           DELIMITED BY ' ' OR '.' INTO PV-PTAG                           
095023         PERFORM 7410-UPDATE-TMRITST-PTAG                                 
095019       WHEN MRTRN-PARM-CDE  = PC-DD                                       
               PERFORM 4200-FORMAT-FIELD                                        
               IF PV-TOTAL-DD NUMERIC                                           
095022            MOVE PV-TOTAL-DD         TO PV-DD-PACKED                      
095023            PERFORM 7420-UPDATE-TMRITST-DD                                
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095019       WHEN MRTRN-PARM-CDE  = PC-DDI                                      
               PERFORM 4200-FORMAT-FIELD                                        
               IF PV-TOTAL-DD NUMERIC                                           
095022             MOVE PV-TOTAL-DD         TO PV-DDI-PACKED                    
095023             PERFORM 7430-UPDATE-TMRITST-DDI                              
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095019       WHEN MRTRN-PARM-CDE  = PC-COMSTOCK                                 
095020         UNSTRING MRSTTR-PARM-VAL-TXT                                     
095021           DELIMITED BY ' ' OR '.' INTO PV-COMSTOCK                       
               IF PV-COMSTOCK NUMERIC                                           
095022             MOVE PV-COMSTOCK         TO PV-COMSTOCK-PACKED               
095023             PERFORM 7440-UPDATE-TMRITST-COMSTOCK                         
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095024       WHEN OTHER                                                         
095026         MOVE PC-PARM-ERROR    TO DL-ERROR-MESSAGE                        
095025         PERFORM 5000-CREATE-ERROR-REPORT                                 
095026         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095027     END-EVALUATE.                                                        
094935                                                                          
094935*****************************************************************         
094936* PROCESS ITEM CURSOR.                                                    
094937*****************************************************************         
094938 3000-PROCESS-ITEM-CURSOR.                                                
094939                                                                          
094940     MOVE PC-N                          TO PS-ERROR-IN-ROW.               
C52271     MOVE MRTRN-TRN-ID                  TO PV-TRAN-ID.                    
094940     MOVE MRSKTR-DEPT-NBR               TO PV-DEPARTMENT.                 
094943                                                                          
094948     IF MRSKTR-PARM-VAL-TXT = SPACES                                      
095026         MOVE PC-PARM-TEXT-ERROR        TO DL-ERROR-MESSAGE               
095025         PERFORM 5000-CREATE-ERROR-REPORT                                 
095026         MOVE PC-Y                      TO PS-ERROR-IN-ROW                
094946     END-IF.                                                              
094943                                                                          
094948     IF NO-ERROR                                                          
094944         IF MRTRN-RVRT-VAL-OBTND-CDE        =  'B'                        
094945             PERFORM 3100-CHANGE-TMRSKTR-TABLE                            
094946         END-IF                                                           
094946     END-IF.                                                              
094943                                                                          
094948     IF NO-ERROR                                                          
094949         PERFORM 3200-CHANGE-TMRITEM-TABLE                                
094950     END-IF.                                                              
094943                                                                          
094961* 3/16/2000 - CAF - ADDED PERFORM OF 7600-TMRTRN-APLD-IND                 
C52271                                                                          
C52271     IF PV-HOLD-DEPT  = SPACES                                            
C52271        MOVE PV-DEPARTMENT  TO PV-HOLD-DEPT                               
C52271        MOVE PV-TRAN-ID     TO PV-HOLD-TRAN-ID                            
C52271     END-IF.                                                              
C52271                                                                          
C52271     IF PV-DEPARTMENT  = PV-HOLD-DEPT AND                                 
C52271        PV-TRAN-ID     = PV-HOLD-TRAN-ID                                  
C52271         CONTINUE                                                         
C52271     ELSE                                                                 
C52271         PERFORM 7600-UPDATE-TMRTRN-APLD-IND                              
C52271         MOVE PV-DEPARTMENT TO PV-HOLD-DEPT                               
C52271         MOVE PV-TRAN-ID    TO PV-HOLD-TRAN-ID                            
C52271     END-IF.                                                              
C52271                                                                          
094967     ADD PC-ONE                 TO PV-TOTAL-CNT                           
C52271                                   PV-ITEM-CNT.                           
094964                                                                          
094962     IF NO-ERROR                                                          
094965         ADD PC-ONE             TO PV-GOOD-CNT                            
094966     ELSE                                                                 
094968         ADD PC-ONE             TO PV-ERROR-CNT                           
094969     END-IF.                                                              
094970                                                                          
094971     PERFORM 9000-COMMIT-TEST.                                            
094972     PERFORM 6400-FETCH-ITEM-CSR.                                         
094973                                                                          
094974*****************************************************************         
094975* GET DATA AND UPDATE TMRSKTR TABLE                             *         
094976*****************************************************************         
094977 3100-CHANGE-TMRSKTR-TABLE.                                               
094978                                                                          
094978     SET REVERT-RECORD-FOUND               TO TRUE.                       
094978                                                                          
094979     PERFORM 8000-SELECT-ORIGINAL-TRNID.                                  
094978                                                                          
094981     IF REVERT-RECORD-FOUND                                               
094980         PERFORM 8300-SELECT-TMRITEM                                      
094993     END-IF.                                                              
094978                                                                          
094981     IF REVERT-RECORD-FOUND AND NO-ERROR                                  
094982         EVALUATE TRUE                                                    
094983           WHEN MRTRN-PARM-CDE  = PC-LT                                   
094984             MOVE MRITEM-LT-QTY            TO PV-PARM-TEXT                
094992             PERFORM 8400-UPDATE-TMRSKTR                                  
095024           WHEN OTHER                                                     
095026             MOVE PC-PARM-ERROR    TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
094991         END-EVALUATE                                                     
094993     END-IF.                                                              
094994                                                                          
094995*****************************************************************         
094996* GET DATA AND UPDATE TMRITEM TABLE                             *         
094997*****************************************************************         
094998 3200-CHANGE-TMRITEM-TABLE.                                               
094999                                                                          
095000     EVALUATE TRUE                                                        
095001       WHEN MRTRN-PARM-CDE = PC-LT                                        
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-LT                                    
               IF PV-LT  NUMERIC                                                
095004             MOVE PV-LT     TO PV-LT-PACKED                               
095005             PERFORM 7500-UPDATE-TMRITEM-LT                               
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095001       WHEN MRTRN-PARM-CDE = PC-ORDER-GROUP                               
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-ORDER-GROUP                           
095005         PERFORM 7650-UPDATE-TMRITEM-ORDR-GRP                             
095001       WHEN MRTRN-PARM-CDE = PC-UCYCLE                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-UCYCLE                                
095005         PERFORM 7700-UPDATE-TMRITEM-UCYCLE                               
095001       WHEN MRTRN-PARM-CDE = PC-PACK-SWITCH                               
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-PACK-SWITCH                           
095005         PERFORM 7750-UPDATE-TMRITEM-PACK-SW                              
095001       WHEN MRTRN-PARM-CDE = PC-BYPSCL                                    
               PERFORM 4100-FORMAT-FIELD                                        
               IF PV-TOTALS NUMERIC                                             
095004             MOVE PV-TOTALS TO PV-BYPSCL-PACKED                           
095005             PERFORM 7800-UPDATE-TMRITEM-BYPSCL                           
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095001       WHEN MRTRN-PARM-CDE = PC-BYPDDU                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-BYPDDU                                
095005         PERFORM 7810-UPDATE-TMRITEM-BYPDDU                               
095001       WHEN MRTRN-PARM-CDE = PC-BYPZOH                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-BYPZOH                                
095005         PERFORM 7820-UPDATE-TMRITEM-BYPZOH                               
095001       WHEN MRTRN-PARM-CDE = PC-BYPZSL                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-BYPZSL                                
095005         PERFORM 7830-UPDATE-TMRITEM-BYPZSL                               
095001       WHEN MRTRN-PARM-CDE = PC-BYPTFP                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-BYPTFP                                
095005         PERFORM 7840-UPDATE-TMRITEM-BYPTFP                               
095001       WHEN MRTRN-PARM-CDE = PC-BYPBEF                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-BYPBEF                                
095005         PERFORM 7850-UPDATE-TMRITEM-BYPBEF                               
095001       WHEN MRTRN-PARM-CDE = PC-BYPAFT                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-BYPAFT                                
095005         PERFORM 7860-UPDATE-TMRITEM-BYPAFT                               
095001       WHEN MRTRN-PARM-CDE = PC-ZSSTOCK                                   
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-ZSSTOCK                               
095005         PERFORM 7870-UPDATE-TMRITEM-ZSSTOCK                              
095001       WHEN MRTRN-PARM-CDE = PC-FRCDDU                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-FRCDDU                                
095005         PERFORM 7880-UPDATE-TMRITEM-FRCDDU                               
095001       WHEN MRTRN-PARM-CDE = PC-ZOPSW                                     
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-ZOPSW                                 
095005         PERFORM 7890-UPDATE-TMRITEM-ZOPSW                                
095001       WHEN MRTRN-PARM-CDE = PC-DDUPRM                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-DDUPRM                                
095005         PERFORM 7900-UPDATE-TMRITEM-DDUPRM                               
095001       WHEN MRTRN-PARM-CDE = PC-DDFTSW                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-DDFTSW                                
095005         PERFORM 7910-UPDATE-TMRITEM-DDFTSW                               
095001       WHEN MRTRN-PARM-CDE = PC-RTF                                       
               PERFORM 4000-FORMAT-FIELD                                        
               IF PV-TOTAL  NUMERIC                                             
                   MOVE PV-TOTAL TO PV-RTF-PACKED                               
095005             PERFORM 7920-UPDATE-TMRITEM-RTF                              
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095001       WHEN MRTRN-PARM-CDE = PC-MINBI                                     
               PERFORM 4000-FORMAT-FIELD                                        
               IF PV-TOTAL  NUMERIC                                             
095004             MOVE PV-TOTAL  TO PV-MINBI-PACKED                            
095005             PERFORM 7930-UPDATE-TMRITEM-MINBI                            
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095001       WHEN MRTRN-PARM-CDE = PC-OUTLSW                                    
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-OUTLSW                                
095005         PERFORM 7940-UPDATE-TMRITEM-OUTLSW                               
095001       WHEN MRTRN-PARM-CDE = PC-DSER                                      
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' INTO PV-DSER                                  
095005         PERFORM 7950-UPDATE-TMRITEM-DSER                                 
095001       WHEN MRTRN-PARM-CDE = PC-TSL                                       
               PERFORM 4000-FORMAT-FIELD                                        
               IF PV-TOTAL  NUMERIC                                             
095004             MOVE PV-TOTAL TO PV-TSL-PACKED                               
095005             PERFORM 7960-UPDATE-TMRITEM-TSL                              
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095001       WHEN MRTRN-PARM-CDE = PC-IMIN                                      
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' OR '.' INTO PV-IMIN                           
               IF PV-IMIN   NUMERIC                                             
095004             MOVE PV-IMIN   TO PV-IMIN-PACKED                             
095005             PERFORM 7970-UPDATE-TMRITEM-IMIN                     TEM-IMIN
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095001       WHEN MRTRN-PARM-CDE = PC-IMAX                                      
095002         UNSTRING MRSKTR-PARM-VAL-TXT                                     
095003           DELIMITED BY ' ' OR '.' INTO PV-IMAX                           
               IF PV-IMAX   NUMERIC                                             
095004             MOVE PV-IMAX   TO PV-IMAX-PACKED                             
095005             PERFORM 7980-UPDATE-TMRITEM-IMAX                     TEM-IMAX
               ELSE                                                             
095026             MOVE PC-NUM-ERROR     TO DL-ERROR-MESSAGE                    
095025             PERFORM 5000-CREATE-ERROR-REPORT                             
095026             MOVE PC-Y             TO PS-ERROR-IN-ROW                     
               END-IF                                                           
095024       WHEN OTHER                                                         
095026         MOVE PC-PARM-ERROR    TO DL-ERROR-MESSAGE                        
095025         PERFORM 5000-CREATE-ERROR-REPORT                                 
095026         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095027     END-EVALUATE.                                                        
095028                                                                          
095029*****************************************************************         
095030* TSL                                                           *         
095031*****************************************************************         
095032 4000-FORMAT-FIELD.                                                       
095033                                                                          
095033     MOVE MRSKTR-PARM-VAL-TXT TO PV-TEXT.                                 
095033     PERFORM VARYING  PV-TEXT-INDEX FROM 1 BY 1                           
095100       UNTIL PV-TEXT-VALUE(PV-TEXT-INDEX) = '.' OR                        
095100             PV-TEXT-INDEX = 10                                           
095400     END-PERFORM.                                                         
                                                                                
           IF PV-TEXT-INDEX < 10                                                
               SUBTRACT 1 FROM  PV-TEXT-INDEX GIVING PV-DIGIT-NUM               
               ADD 1 TO  PV-TEXT-INDEX GIVING PV-DIGIT-DEC                      
               MOVE PV-TEXT(1:PV-DIGIT-NUM) TO PV-NUMERIC                       
               MOVE PV-TEXT(PV-DIGIT-DEC:1) TO PV-DECIMAL                       
               STRING PV-NUMERIC                                                
                      PV-DECIMAL DELIMITED BY SIZE INTO                         
015900                PV-TOTAL                                                  
095033     END-IF.                                                              
095030                                                                          
095029*****************************************************************         
095030* BYPSCL                                                        *         
095031*****************************************************************         
095032 4100-FORMAT-FIELD.                                                       
095033                                                                          
095033     MOVE MRSKTR-PARM-VAL-TXT TO PV-TEXT.                                 
095033     PERFORM VARYING  PV-TEXT-INDEX FROM 1 BY 1                           
095100       UNTIL PV-TEXT-VALUE(PV-TEXT-INDEX) = '.' OR                        
095100             PV-TEXT-INDEX = 10                                           
095400     END-PERFORM.                                                         
                                                                                
           IF PV-TEXT-INDEX < 10                                                
               SUBTRACT 1 FROM  PV-TEXT-INDEX GIVING PV-DIGIT-NUM               
               ADD 1 TO  PV-TEXT-INDEX GIVING PV-DIGIT-DEC                      
                                                                                
               PERFORM VARYING  PV-TEXT-INDEX2 FROM PV-DIGIT-DEC BY 1           
                 UNTIL PV-TEXT-VALUE(PV-TEXT-INDEX2) = ' ' OR                   
                       PV-TEXT-INDEX2 = 10                                      
               END-PERFORM                                                      
               IF PV-TEXT-INDEX2 = 5 THEN                                       
                   MOVE PV-TEXT(1:PV-DIGIT-NUM) TO PV-NUMERIC                   
                   MOVE PV-TEXT(PV-DIGIT-DEC:2) TO PV-DECIMALS                  
                   STRING PV-NUMERIC                                            
                      PV-DECIMALS DELIMITED BY SIZE INTO                        
                      PV-TOTALS                                                 
               ELSE                                                             
                   MOVE PV-TEXT(1:PV-DIGIT-NUM) TO PV-NUMERIC                   
                   MOVE PV-TEXT(PV-DIGIT-DEC:1) TO PV-DECIMAL                   
                   STRING PV-NUMERIC                                            
                      PV-DECIMAL                                                
                      PV-ZERO     DELIMITED BY SIZE INTO                        
                      PV-TOTALS                                                 
               END-IF                                                           
095033     END-IF.                                                              
095029*****************************************************************         
095030* DD AND DDI                                                    *         
095031*****************************************************************         
095032 4200-FORMAT-FIELD.                                                       
095033                                                                          
095033     MOVE MRSTTR-PARM-VAL-TXT TO PV-TEXT.                                 
095033     PERFORM VARYING  PV-TEXT-INDEX FROM 1 BY 1                           
095100       UNTIL PV-TEXT-VALUE(PV-TEXT-INDEX) = '.' OR                        
095100             PV-TEXT-INDEX = 10                                           
095400     END-PERFORM.                                                         
                                                                                
           IF PV-TEXT-INDEX < 10                                                
               SUBTRACT 1 FROM  PV-TEXT-INDEX GIVING PV-DIGIT-NUM               
               ADD 1 TO  PV-TEXT-INDEX GIVING PV-DIGIT-DEC                      
                                                                                
                                                                                
C52271         IF PV-TEXT-INDEX = 1 THEN                                        
C52271             MOVE 0                       TO PV-NUMERIC                   
C52271             MOVE PV-TEXT(PV-DIGIT-DEC:1) TO PV-DECIMAL                   
C52271             STRING PV-NUMERIC                                            
C52271                PV-DECIMAL  DELIMITED BY SIZE INTO                        
C52271                PV-TOTAL                                                  
C52271             MOVE PV-TOTAL TO PV-TOTAL-DD                                 
C52271         ELSE                                                             
C52271           IF PV-TEXT-INDEX = 2 THEN                                      
C52271               MOVE PV-TEXT(1:PV-DIGIT-NUM) TO PV-NUMERIC                 
C52271               MOVE PV-TEXT(PV-DIGIT-DEC:1) TO PV-DECIMAL                 
C52271               STRING PV-NUMERIC                                          
C52271                  PV-DECIMAL  DELIMITED BY SIZE INTO                      
C52271                  PV-TOTAL                                                
C52271               MOVE PV-TOTAL TO PV-TOTAL-DD                               
C52271           ELSE                                                           
                   IF PV-TEXT-INDEX = 3 THEN                                    
                       MOVE PV-TEXT(1:PV-DIGIT-NUM) TO PV-NUMERIC2              
                       MOVE PV-TEXT(PV-DIGIT-DEC:1) TO PV-DECIMAL               
                       STRING PV-NUMERIC2                                       
                          PV-DECIMAL DELIMITED BY SIZE INTO                     
                          PV-TOTAL2                                             
                       MOVE PV-TOTAL2 TO PV-TOTAL-DD                            
                   ELSE                                                         
                       IF PV-TEXT-INDEX = 4 THEN                                
                           MOVE PV-TEXT(1:PV-DIGIT-NUM) TO PV-NUMERIC3          
                           MOVE PV-TEXT(PV-DIGIT-DEC:1) TO PV-DECIMAL           
                           STRING PV-NUMERIC3                                   
                              PV-DECIMAL DELIMITED BY SIZE INTO                 
                              PV-TOTAL3                                         
                           MOVE PV-TOTAL3 TO PV-TOTAL-DD                        
                       ELSE                                                     
                           IF PV-TEXT-INDEX = 5 THEN                            
                               MOVE PV-TEXT(1:PV-DIGIT-NUM) TO          C       
                                                         PV-NUMERIC4    C       
                               MOVE PV-TEXT(PV-DIGIT-DEC:1) TO          L       
                                                         PV-DECIMAL     L       
                               STRING PV-NUMERIC4                               
                                  PV-DECIMAL DELIMITED BY SIZE INTO             
                                  PV-TOTAL4                                     
                               MOVE PV-TOTAL4 TO PV-TOTAL-DD                    
                           ELSE                                                 
                               IF PV-TEXT-INDEX = 6 THEN                        
                                   MOVE PV-TEXT(1:PV-DIGIT-NUM) TO      MERIC   
                                                         PV-NUMERIC5    C       
                                   MOVE PV-TEXT(PV-DIGIT-DEC:1) TO      CIMAL   
                                                         PV-DECIMAL     L       
                                   STRING PV-NUMERIC5                           
                                      PV-DECIMAL DELIMITED BY SIZE INTO         
                                      PV-TOTAL5                                 
                                   MOVE PV-TOTAL5 TO PV-TOTAL-DD                
                               END-IF                                           
                           END-IF                                               
                       END-IF                                                   
                   END-IF                                                       
               END-IF                                                           
C52271       END-IF                                                             
095033     END-IF.                                                              
095029*****************************************************************         
095030* CREATE ERROR REPORT                                           *         
095031*****************************************************************         
095032 5000-CREATE-ERROR-REPORT.                                                
095033                                                                          
095034     MOVE 'Y' TO PS-RECORDS-WRITTEN.                                      
095035                                                                          
095036     IF MRSTTR-DEPT-NBR NOT = PV-HOLD-DEPT-REPT                           
095037         PERFORM 5100-PRINT-HEADINGS                                      
095038         MOVE MRSTTR-DEPT-NBR TO PV-HOLD-DEPT-REPT                        
095039     END-IF.                                                              
095040                                                                          
095041     IF PV-LINE-CNT > PC-MAX-LINES                                        
095042         PERFORM 5100-PRINT-HEADINGS                                      
095043     END-IF.                                                              
095044                                                                          
095044     IF PS-STORE                                                          
095046         MOVE MRSTTR-DEPT-NBR           TO PV-DEPT                        
095047         MOVE MRSTTR-SUB-CL-NBR         TO PV-CLASS                       
095048         MOVE MRSTTR-SKU-NBR            TO PV-SKU                         
095051         MOVE MRSTTR-PARM-VAL-TXT       TO DL-PARM-VALUE                  
095049         MOVE MRSTTR-STR-NBR            TO PV-STORE                       
095049         MOVE PV-STORE                  TO DL-STORE-N                     
095044     ELSE                                                                 
095044         IF PS-ITEM                                                       
095046             MOVE MRSKTR-DEPT-NBR       TO PV-DEPT                        
095047             MOVE MRSKTR-SUB-CL-NBR     TO PV-CLASS                       
095048             MOVE MRSKTR-SKU-NBR        TO PV-SKU                         
095051             MOVE MRSKTR-PARM-VAL-TXT   TO DL-PARM-VALUE                  
095049             MOVE SPACES                TO DL-STORE-X                     
095044     END-IF.                                                              
095044                                                                          
095046     MOVE PV-DEPT                       TO DL-DEPT                        
095047     MOVE PV-CLASS                      TO DL-CLASS                       
095048     MOVE PV-SKU                        TO DL-SKU-SEQ                     
C52271     MOVE PV-TRAN-ID                    TO DL-TRANS-ID.                   
095050     MOVE MRTRN-PARM-CDE                TO DL-PARM-CODE.                  
095052     MOVE MRTRN-EFF-STRT-DTE            TO DL-EFF-DATE.                   
095053     MOVE MRTRN-LAST-UPD-TMST           TO DL-TIMESTAMP.                  
095054     MOVE MRTRN-LAST-UPD-BY-USR-ID      TO DL-USERID.                     
095055                                                                          
095056     PERFORM 5500-GET-TSK-DESCRIPTION.                                    
095057     MOVE PV-SKU-DESC                   TO DL-DESCRIPTION.                
095058                                                                          
095059     MOVE DETAIL-LINE1                  TO PRINT-LINE.                    
095060     MOVE PC-ONE                        TO PV-LINE-CONTROL.               
095061     PERFORM 5300-WRITE-PRINT-LINE.                                       
095059     MOVE DETAIL-LINE2                  TO PRINT-LINE.                    
095060     MOVE PC-ONE                        TO PV-LINE-CONTROL.               
095061     PERFORM 5300-WRITE-PRINT-LINE.                                       
095062     ADD  PC-TWO                        TO PV-LINE-CNT.                   
095063                                                                          
095064*****************************************************************         
095065* PRINT HEADINGS                                                *         
095066*****************************************************************         
095067 5100-PRINT-HEADINGS.                                                     
095068                                                                          
095069     ADD PC-ONE                         TO PV-PAGE-CNT.                   
095070     MOVE PV-PAGE-CNT                   TO DP132-PAGE-NUMBER.             
095071                                                                          
095072     MOVE DP132-STANDRD-HEADER-132-COLS TO PRINT-LINE.                    
095073     MOVE PC-ONE                        TO PV-LINE-CONTROL.               
095074     PERFORM 5200-WRITE-TOP-OF-PAGE.                                      
095075                                                                          
095076     MOVE  HL-HEADING-LINE1             TO PRINT-LINE.                    
095077     MOVE  PC-ONE                       TO PV-LINE-CONTROL.               
095078     PERFORM 5300-WRITE-PRINT-LINE.                                       
095079                                                                          
095080     MOVE  CL-COLUMN-LINE1              TO PRINT-LINE.                    
095081     MOVE  PC-TWO                       TO PV-LINE-CONTROL.               
095082     PERFORM 5300-WRITE-PRINT-LINE.                                       
095083                                                                          
095084     MOVE  CL-COLUMN-DASHES             TO PRINT-LINE.                    
095085     MOVE  PC-ONE                       TO PV-LINE-CONTROL.               
095086     PERFORM 5300-WRITE-PRINT-LINE.                                       
095083                                                                          
095084     MOVE  SPACES                       TO PRINT-LINE.                    
095085     MOVE  PC-ONE                       TO PV-LINE-CONTROL.               
095086     PERFORM 5300-WRITE-PRINT-LINE.                                       
095088                                                                          
095087     MOVE  PC-SIX                       TO PV-LINE-CNT.                   
095088                                                                          
095089*****************************************************************         
095090* WRITE TOP OF NEW PAGE                                         *         
095091*****************************************************************         
095092 5200-WRITE-TOP-OF-PAGE.                                                  
095093                                                                          
095094     WRITE PRINT-LINE                                                     
095095         AFTER ADVANCING PAGE.                                            
095096                                                                          
095097*****************************************************************         
095098* WRITE PRINT LINE                                              *         
095099*****************************************************************         
095100 5300-WRITE-PRINT-LINE.                                                   
095101                                                                          
095102     WRITE PRINT-LINE                                                     
095103         AFTER ADVANCING PV-LINE-CONTROL.                                 
095104                                                                          
095105******************************************************************        
095106* 5400-PRINT-NO-RECORD-REPORT IS WRITTEN WHEN THERE ARE NO       *        
095107* ERROR RECORDS ON THE INPUT FILE.                               *        
095108******************************************************************        
095109 5400-PRINT-NO-RECORD-REPORT.                                             
095110                                                                          
095111     PERFORM 5100-PRINT-HEADINGS.                                         
095112     MOVE MSG-NO-ERROR-RECORDS        TO PRINT-LINE.                      
095113     MOVE PC-TWO                      TO PV-LINE-CONTROL.                 
095114     PERFORM 5300-WRITE-PRINT-LINE.                                       
095115                                                                          
095116******************************************************************        
095117* 5500-GET-TSK-DESCRIPTION  TO GET SKU DESCRIPTION.              *        
095118******************************************************************        
095119 5500-GET-TSK-DESCRIPTION.                                                
095120                                                                          
095121     MOVE '5500'                        TO PGM-LOCATION.                  
095122     MOVE '5500-GET-TSK-DESCRIPTION  '  TO AA-PARAGRAPH-NAME.             
095123                                                                          
095124     EXEC SQL                                                             
095125         SELECT  SKU_DESC                                                 
095126         INTO    :PV-SKU-DESC                                             
095127         FROM TSK A,                                                      
095127              TSKXREF B                                                   
095128         WHERE A.ITEM_NMBR = B.ITM_NBR                                    
095128           AND DEPT       = :PV-DEPT                                      
095129           AND SUBCLASS   = :PV-CLASS                                     
095130           AND SKU        = :PV-SKU                                       
095131     END-EXEC.                                                            
095132                                                                          
095133     EVALUATE TRUE                                                        
095134       WHEN SQLCODE         = ZERO                                        
095135         CONTINUE                                                         
095136       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095137         MOVE 'NO DESCRIPTION FOUND     '   TO PV-SKU-DESC                
095138       WHEN OTHER                                                         
095139         DISPLAY AA-ABEND-LIT                                             
095140         DISPLAY AA-PROGRAM-LIT                                           
095141         DISPLAY AA-PARAGRAPH-LIT                                         
095142         PERFORM 9999-SQL-ERROR                                           
095143     END-EVALUATE.                                                        
095144                                                                          
095315******************************************************************        
095316* OPEN STORE-LEVEL                                                        
095317******************************************************************        
095318 6000-OPEN-STORE-LEVEL-CURSOR.                                            
095319                                                                          
095320     MOVE '6000'                         TO PGM-LOCATION.                 
095321     MOVE '6000-OPEN-STORE-LEVEL-CURSOR' TO AA-PARAGRAPH-NAME.            
095322                                                                          
095323     EXEC SQL                                                             
095324         OPEN STORE-LEVEL                                                 
095325     END-EXEC.                                                            
095326                                                                          
095327     EVALUATE TRUE                                                        
095328       WHEN SQLCODE         = ZERO                                        
095329       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095330         CONTINUE                                                         
095331       WHEN OTHER                                                         
095332         DISPLAY AA-ABEND-LIT                                             
095333         DISPLAY AA-PROGRAM-LIT                                           
095334         DISPLAY AA-PARAGRAPH-LIT                                         
095335         PERFORM 9999-SQL-ERROR                                           
095336     END-EVALUATE.                                                        
095319                                                                          
095337******************************************************************        
095338* FETCHS ROW FROM THE STORE-LEVEL CURSOR                                  
095339******************************************************************        
095340                                                                          
095341  6100-FETCH-STORE-CSR.                                                   
095342                                                                          
095343     MOVE '6100'                        TO PGM-LOCATION.                  
095344     MOVE '6100-FETCH-STORE-CSR'        TO AA-PARAGRAPH-NAME.             
095345                                                                          
095346     EXEC SQL                                                             
095347       FETCH STORE-LEVEL                                                  
095348         INTO :MRSTTR-ITM-NBR                                             
095349            , :MRSTTR-DEPT-NBR                                            
095350            , :MRSTTR-MAJ-CL-NBR                                          
095350            , :MRSTTR-SUB-CL-NBR                                          
095351            , :MRSTTR-SKU-NBR                                             
095352            , :MRSTTR-STR-NBR                                             
095353            , :MRSTTR-PARM-VAL-TXT                                        
095354            , :MRTRN-TRN-ID                                               
095355            , :MRTRN-PARM-CDE                                             
095356            , :MRTRN-EFF-STRT-DTE                                         
095357            , :MRTRN-EFF-END-DTE:PV-END-EFF-DATE-IND                      
095358            , :MRTRN-LAST-UPD-TMST                                        
095359            , :MRTRN-LAST-UPD-BY-USR-ID                                   
095360            , :MRTRN-RNK-ID:PV-RNK-ID-IND                                 
095361            , :MRTRN-RVRT-VAL-OBTND-CDE                                   
095362     END-EXEC.                                                            
095363                                                                          
095364     EVALUATE TRUE                                                        
095365       WHEN SQLCODE         = ZERO                                        
095366         PERFORM 6150-STORE-CHECK-NULLS                                   
095367       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095368         SET END-OF-STORE-CURSOR            TO TRUE                       
095369       WHEN OTHER                                                         
095370         DISPLAY AA-ABEND-LIT                                             
095371         DISPLAY AA-PROGRAM-LIT                                           
095372         DISPLAY AA-PARAGRAPH-LIT                                         
095373         PERFORM 9999-SQL-ERROR                                           
095374     END-EVALUATE.                                                        
095375                                                                          
095376*****************************************************************         
095377* CHECK FOR NULLS                                               *         
095378*****************************************************************         
095379 6150-STORE-CHECK-NULLS.                                                  
095380                                                                          
095381     IF  PV-RNK-ID-IND       = -1                                         
095382        MOVE '0' TO MRTRN-RNK-ID                                          
095383     END-IF.                                                              
095384                                                                          
095385     IF PV-END-EFF-DATE-IND  = -1                                         
095386        MOVE ' ' TO MRTRN-EFF-END-DTE                                     
095387     END-IF.                                                              
095388                                                                          
095389******************************************************************        
095390*  CLOSE THE STORE CURSOR.                                       *        
095391******************************************************************        
095392 6200-CLOSE-STORE-LEVEL-CSR.                                              
095393                                                                          
095394     MOVE '6200'                        TO PGM-LOCATION.                  
095395     MOVE '6200-CLOSE-STORE-LEVEL-CSR'  TO AA-PARAGRAPH-NAME.             
095396                                                                          
095397     EXEC SQL                                                             
095398         CLOSE STORE-LEVEL                                                
095399     END-EXEC.                                                            
095400                                                                          
095401     EVALUATE TRUE                                                        
095402         WHEN SQLCODE EQUAL ZERO                                          
095403         WHEN SQLCODE EQUAL PC-ROW-NOT-FOUND                              
095404             CONTINUE                                                     
095405         WHEN OTHER                                                       
095406             DISPLAY AA-ABEND-LIT                                         
095407             DISPLAY AA-PROGRAM-LIT                                       
095408             DISPLAY AA-PARAGRAPH-LIT                                     
095409             PERFORM 9999-SQL-ERROR                                       
095410     END-EVALUATE.                                                        
095144                                                                          
095315******************************************************************        
095316* OPEN ITEM-LEVEL                                                         
095317******************************************************************        
095318 6300-OPEN-ITEM-LEVEL-CURSOR.                                             
095319                                                                          
095320     MOVE '6000'                         TO PGM-LOCATION.                 
095321     MOVE '6000-OPEN-ITEM-LEVEL-CURSOR'  TO AA-PARAGRAPH-NAME.            
095322                                                                          
095323     EXEC SQL                                                             
095324         OPEN ITEM-LEVEL                                                  
095325     END-EXEC.                                                            
095326                                                                          
095327     EVALUATE TRUE                                                        
095328       WHEN SQLCODE         = ZERO                                        
095329       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095330         CONTINUE                                                         
095331       WHEN OTHER                                                         
095332         DISPLAY AA-ABEND-LIT                                             
095333         DISPLAY AA-PROGRAM-LIT                                           
095334         DISPLAY AA-PARAGRAPH-LIT                                         
095335         PERFORM 9999-SQL-ERROR                                           
095336     END-EVALUATE.                                                        
095319                                                                          
095337******************************************************************        
095338* FETCHS ROW FROM THE ITEM-LEVEL CURSOR                                   
095339******************************************************************        
095340                                                                          
095341  6400-FETCH-ITEM-CSR.                                                    
095342                                                                          
095343     MOVE '6400'                        TO PGM-LOCATION.                  
095344     MOVE '6400-FETCH-ITEM-CSR'         TO AA-PARAGRAPH-NAME.             
095345                                                                          
095346     EXEC SQL                                                             
095347       FETCH ITEM-LEVEL                                                   
095348         INTO :MRSKTR-ITM-NBR                                             
095349            , :MRSKTR-DEPT-NBR                                            
095349            , :MRSKTR-MAJ-CL-NBR                                          
095350            , :MRSKTR-SUB-CL-NBR                                          
095351            , :MRSKTR-SKU-NBR                                             
095353            , :MRSKTR-PARM-VAL-TXT                                        
095354            , :MRTRN-TRN-ID                                               
095355            , :MRTRN-PARM-CDE                                             
095356            , :MRTRN-EFF-STRT-DTE                                         
095357            , :MRTRN-EFF-END-DTE:PV-END-EFF-DATE-IND                      
095358            , :MRTRN-LAST-UPD-TMST                                        
095359            , :MRTRN-LAST-UPD-BY-USR-ID                                   
095360            , :MRTRN-RNK-ID:PV-RNK-ID-IND                                 
095361            , :MRTRN-RVRT-VAL-OBTND-CDE                                   
095362     END-EXEC.                                                            
095363                                                                          
095364     EVALUATE TRUE                                                        
095365       WHEN SQLCODE         = ZERO                                        
095366         PERFORM 6450-ITEM-CHECK-NULLS                                    
095367       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095368         SET END-OF-ITEM-CURSOR            TO TRUE                        
095369       WHEN OTHER                                                         
095370         DISPLAY AA-ABEND-LIT                                             
095371         DISPLAY AA-PROGRAM-LIT                                           
095372         DISPLAY AA-PARAGRAPH-LIT                                         
095373         PERFORM 9999-SQL-ERROR                                           
095374     END-EVALUATE.                                                        
095375                                                                          
095376*****************************************************************         
095377* CHECK FOR NULLS                                               *         
095378*****************************************************************         
095379 6450-ITEM-CHECK-NULLS.                                                   
095380                                                                          
095381     IF  PV-RNK-ID-IND       = -1                                         
095382        MOVE '0' TO MRTRN-RNK-ID                                          
095383     END-IF.                                                              
095384                                                                          
095385     IF PV-END-EFF-DATE-IND  = -1                                         
095386        MOVE ' ' TO MRTRN-EFF-END-DTE                                     
095387     END-IF.                                                              
095388                                                                          
095389******************************************************************        
095390*  CLOSE THE ITEM CURSOR.                                        *        
095391******************************************************************        
095392 6500-CLOSE-ITEM-LEVEL-CSR.                                               
095393                                                                          
095394     MOVE '6500'                        TO PGM-LOCATION.                  
095395     MOVE '6500-CLOSE-ITEM-LEVEL-CSR'   TO AA-PARAGRAPH-NAME.             
095396                                                                          
095397     EXEC SQL                                                             
095398         CLOSE ITEM-LEVEL                                                 
095399     END-EXEC.                                                            
095400                                                                          
095401     EVALUATE TRUE                                                        
095402         WHEN SQLCODE EQUAL ZERO                                          
095403         WHEN SQLCODE EQUAL PC-ROW-NOT-FOUND                              
095404             CONTINUE                                                     
095405         WHEN OTHER                                                       
095406             DISPLAY AA-ABEND-LIT                                         
095407             DISPLAY AA-PROGRAM-LIT                                       
095408             DISPLAY AA-PARAGRAPH-LIT                                     
095409             PERFORM 9999-SQL-ERROR                                       
095410     END-EVALUATE.                                                        
095396                                                                          
095146*****************************************************************         
095147* UPDATE TMRITST MIN                                            *         
095148*****************************************************************         
095149 7000-UPDATE-TMRITST-MIN.                                                 
095150                                                                          
095151     MOVE '7000'                        TO PGM-LOCATION.                  
095152     MOVE '7000-UPDATE-TMRITST-MIN   '  TO AA-PARAGRAPH-NAME.             
095153                                                                          
095154     EXEC SQL                                                             
095155         UPDATE TMRITST                                                   
095156         SET   USERMIN_QTY  =  :PV-MIN-PACKED                             
095157         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095158           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095159     END-EXEC.                                                            
095160                                                                          
095161     EVALUATE TRUE                                                        
095162       WHEN SQLCODE         = ZERO                                        
095163         CONTINUE                                                         
095164       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095165         PERFORM 5000-CREATE-ERROR-REPORT                                 
095166         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095167       WHEN OTHER                                                         
095168         DISPLAY AA-ABEND-LIT                                             
095169         DISPLAY AA-PROGRAM-LIT                                           
095170         DISPLAY AA-PARAGRAPH-LIT                                         
095171         PERFORM 9999-SQL-ERROR                                           
095172     END-EVALUATE.                                                        
095173                                                                          
095174*****************************************************************         
095175* UPDATE TMRITST MAX                                            *         
095176*****************************************************************         
095177 7100-UPDATE-TMRITST-MAX.                                                 
095178                                                                          
095179     MOVE '7100'                        TO PGM-LOCATION.                  
095180     MOVE '7100-UPDATE-TMRITST-MAX   '  TO AA-PARAGRAPH-NAME.             
095181                                                                          
095182     EXEC SQL                                                             
095183         UPDATE TMRITST                                                   
095184         SET   USERMAX_QTY  =  :PV-MAX-PACKED                             
095185         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095186           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095187     END-EXEC.                                                            
095188                                                                          
095189     EVALUATE TRUE                                                        
095190       WHEN SQLCODE         = ZERO                                        
095191         CONTINUE                                                         
095192       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095193         PERFORM 5000-CREATE-ERROR-REPORT                                 
095194         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095195       WHEN OTHER                                                         
095196         DISPLAY AA-ABEND-LIT                                             
095197         DISPLAY AA-PROGRAM-LIT                                           
095198         DISPLAY AA-PARAGRAPH-LIT                                         
095199         PERFORM 9999-SQL-ERROR                                           
095200     END-EVALUATE.                                                        
095201                                                                          
095202*****************************************************************         
095203* UPDATE TMRITST CSTOCK                                         *         
095204*****************************************************************         
095205 7200-UPDATE-TMRITST-CSTOCK.                                              
095206                                                                          
095207     MOVE '7200'                        TO PGM-LOCATION.                  
095208     MOVE '7200-UPDATE-TMRITST-CSTOCK'  TO AA-PARAGRAPH-NAME.             
095209                                                                          
095210     EXEC SQL                                                             
095211         UPDATE TMRITST                                                   
095212         SET   CSTOCK_QTY   =  :PV-CSTOCK-PACKED                          
095213         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095214           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095215     END-EXEC.                                                            
095216                                                                          
095217     EVALUATE TRUE                                                        
095218       WHEN SQLCODE         = ZERO                                        
095219         CONTINUE                                                         
095220       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095221         PERFORM 5000-CREATE-ERROR-REPORT                                 
095222         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095223       WHEN OTHER                                                         
095224         DISPLAY AA-ABEND-LIT                                             
095225         DISPLAY AA-PROGRAM-LIT                                           
095226         DISPLAY AA-PARAGRAPH-LIT                                         
095227         PERFORM 9999-SQL-ERROR                                           
095228     END-EVALUATE.                                                        
095229                                                                          
095230*****************************************************************         
095231* UPDATE TMRITST FT CODE                                        *         
095232*****************************************************************         
095233 7300-UPDATE-TMRITST-FTCODE.                                              
095234                                                                          
095235     MOVE '7300'                        TO PGM-LOCATION.                  
095236     MOVE '7300-UPDATE-TMRITST-FTCODE'  TO AA-PARAGRAPH-NAME.             
095237                                                                          
095238     EXEC SQL                                                             
095239         UPDATE TMRITST                                                   
095240         SET   FT_CDE       =  :PV-FT-CODE                                
095241         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095242           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095243     END-EXEC.                                                            
095244                                                                          
095245     EVALUATE TRUE                                                        
095246       WHEN SQLCODE         = ZERO                                        
095247         CONTINUE                                                         
095248       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095249         PERFORM 5000-CREATE-ERROR-REPORT                                 
095250         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095251       WHEN OTHER                                                         
095252         DISPLAY AA-ABEND-LIT                                             
095253         DISPLAY AA-PROGRAM-LIT                                           
095254         DISPLAY AA-PARAGRAPH-LIT                                         
095255         PERFORM 9999-SQL-ERROR                                           
095256     END-EVALUATE.                                                        
095257                                                                          
095258*****************************************************************         
095259* UPDATE TMRITST OSTRAT                                         *         
095260*****************************************************************         
095261 7400-UPDATE-TMRITST-OSTRAT.                                              
095262                                                                          
095263     MOVE '7400'                        TO PGM-LOCATION.                  
095264     MOVE '7400-UPDATE-TMRITST-OSTRAT'  TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITST                                                   
095268         SET   OSTRAT_QTY   =  :PV-OSTRAT-PACKED                          
095269         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095270           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITST PTAG                                           *         
095260*****************************************************************         
095261 7410-UPDATE-TMRITST-PTAG.                                                
095262                                                                          
095263     MOVE '7410'                        TO PGM-LOCATION.                  
095264     MOVE '7410-UPDATE-TMRITST-PTAG'  TO AA-PARAGRAPH-NAME.               
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITST                                                   
095268         SET   PTAG_ID      =  :PV-PTAG                                   
095269         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095270           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITST DD                                             *         
095260*****************************************************************         
095261 7420-UPDATE-TMRITST-DD.                                                  
095262                                                                          
095263     MOVE '7420'                        TO PGM-LOCATION.                  
095264     MOVE '7420-UPDATE-TMRITST-DD'    TO AA-PARAGRAPH-NAME.               
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITST                                                   
095268         SET   DD_FCTR      =  :PV-DD-PACKED                              
095269         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095270           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095262                                                                          
095258*****************************************************************         
095259* UPDATE TMRITST DDI                                            *         
095260*****************************************************************         
095261 7430-UPDATE-TMRITST-DDI.                                                 
095262                                                                          
095263     MOVE '7430'                        TO PGM-LOCATION.                  
095264     MOVE '7430-UPDATE-TMRITST-DDI'   TO AA-PARAGRAPH-NAME.               
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITST                                                   
095268         SET   DDI_FCTR     =  :PV-DDI-PACKED                             
095269         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095270           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITST COMSTOCK                                       *         
095260*****************************************************************         
095261 7440-UPDATE-TMRITST-COMSTOCK.                                            
095262                                                                          
095263     MOVE '7440'                        TO PGM-LOCATION.                  
095264     MOVE '7440-UPDATE-TMRITST-COMSTOCK' TO AA-PARAGRAPH-NAME.            
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITST                                                   
095268         SET   COMSTK_QTY   =  :PV-COMSTOCK-PACKED                        
095269         WHERE ITEM_NBR     =  :MRSTTR-ITM-NBR                            
095270           AND STR_NBR      =  :MRSTTR-STR-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM LT                                             *         
095260*****************************************************************         
095261 7500-UPDATE-TMRITEM-LT.                                                  
095262                                                                          
095263     MOVE '7500'                        TO PGM-LOCATION.                  
095264     MOVE '7500-UPDATE-TMRITEM-LT'      TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   LT_QTY       =  :PV-LT-PACKED                              
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095286* 3/16/2000 -CAF - ADDED THE FOLLOWING PARAGRAPH                          
095287*****************************************************************         
095288*UPDATE THE APLD_IND ON TMRTRN IF UPDATES ARE SUCCESSFUL        *         
095289*****************************************************************         
095290 7600-UPDATE-TMRTRN-APLD-IND.                                             
095291                                                                          
095292     MOVE '7600'                        TO PGM-LOCATION.                  
095293     MOVE '7600-UPDATE-TMRTRN-APLD-IND' TO AA-PARAGRAPH-NAME.             
095294                                                                          
095295     EXEC SQL                                                             
095296         UPDATE TMRTRN                                                    
095297         SET APLD_IND       =  :PC-Y                                      
C52271         WHERE TRN_ID       =  :PV-HOLD-TRAN-ID                           
C52271           AND DEPT_NBR     =  :PV-HOLD-DEPT                              
095300     END-EXEC.                                                            
095301                                                                          
095302     EVALUATE TRUE                                                        
095303       WHEN SQLCODE         = ZERO                                        
095304         CONTINUE                                                         
095305*      WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095306       WHEN OTHER                                                         
095307         DISPLAY 'TRN ID: ' MRTRN-TRN-ID                                  
095308         DISPLAY 'DEPT NBR: ' MRSTTR-DEPT-NBR                             
095309         DISPLAY AA-ABEND-LIT                                             
095310         DISPLAY AA-PROGRAM-LIT                                           
095311         DISPLAY AA-PARAGRAPH-LIT                                         
095312         PERFORM 9999-SQL-ERROR                                           
095313     END-EVALUATE.                                                        
095262                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM LT                                             *         
095260*****************************************************************         
095261 7650-UPDATE-TMRITEM-ORDR-GRP.                                            
095262                                                                          
095263     MOVE '7650'                        TO PGM-LOCATION.                  
095264     MOVE '7650-UPDATE-TMRITEM-ORDR-GRP' TO AA-PARAGRAPH-NAME.            
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   ORD_GROUP_SW =  :PV-ORDER-GROUP                            
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM LT                                             *         
095260*****************************************************************         
095261 7700-UPDATE-TMRITEM-UCYCLE.                                              
095262                                                                          
095263     MOVE '7700'                        TO PGM-LOCATION.                  
095264     MOVE '7700-UPDATE-TMRITEM-UCYCLE'  TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   UCYCLE_CDE   =  :PV-UCYCLE                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM LT                                             *         
095260*****************************************************************         
095261 7750-UPDATE-TMRITEM-PACK-SW.                                             
095262                                                                          
095263     MOVE '7750'                        TO PGM-LOCATION.                  
095264     MOVE '7750-UPDATE-TMRITEM-PACK-SW' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   PACKSW_CDE   =  :PV-PACK-SWITCH                            
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM BYPSCL                                         *         
095260*****************************************************************         
095261 7800-UPDATE-TMRITEM-BYPSCL.                                              
095262                                                                          
095263     MOVE '7800'                        TO PGM-LOCATION.                  
095264     MOVE '7800-UPDATE-TMRITEM-BYPSCL'  TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   BYPSCL_NBR   =  :PV-BYPSCL-PACKED                          
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM BYPDDU                                         *         
095260*****************************************************************         
095261 7810-UPDATE-TMRITEM-BYPDDU.                                              
095262                                                                          
095263     MOVE '7810'                        TO PGM-LOCATION.                  
095264     MOVE '7810-UPDATE-TMRITEM-BYPDDU'  TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   BYPDDU_CDE   =  :PV-BYPDDU                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM BYPZOH                                         *         
095260*****************************************************************         
095261 7820-UPDATE-TMRITEM-BYPZOH.                                              
095262                                                                          
095263     MOVE '7820'                        TO PGM-LOCATION.                  
095264     MOVE '7820-UPDATE-TMRITEM-BYPZOH ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   BYPZOH_CDE   =  :PV-BYPZOH                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM BYPZSL                                         *         
095260*****************************************************************         
095261 7830-UPDATE-TMRITEM-BYPZSL.                                              
095262                                                                          
095263     MOVE '7830'                        TO PGM-LOCATION.                  
095264     MOVE '7830-UPDATE-TMRITEM-BYPZSL ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   BYPZSL_CDE   =  :PV-BYPZSL                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM BYPTFP                                         *         
095260*****************************************************************         
095261 7840-UPDATE-TMRITEM-BYPTFP.                                              
095262                                                                          
095263     MOVE '7840'                        TO PGM-LOCATION.                  
095264     MOVE '7840-UPDATE-TMRITEM-BYPTFP ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   BYPTFP_CDE   =  :PV-BYPTFP                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM BYPBEF                                         *         
095260*****************************************************************         
095261 7850-UPDATE-TMRITEM-BYPBEF.                                              
095262                                                                          
095263     MOVE '7850'                        TO PGM-LOCATION.                  
095264     MOVE '7850-UPDATE-TMRITEM-BYPBEF'  TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   BYPBEF_CDE   =  :PV-BYPBEF                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM BYPAFT                                         *         
095260*****************************************************************         
095261 7860-UPDATE-TMRITEM-BYPAFT.                                              
095262                                                                          
095263     MOVE '7860'                        TO PGM-LOCATION.                  
095264     MOVE '7860-UPDATE-TMRITEM-BYPAFT ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   BYPAFT_CDE   =  :PV-BYPAFT                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM ZSSTOCK                                        *         
095260*****************************************************************         
095261 7870-UPDATE-TMRITEM-ZSSTOCK.                                             
095262                                                                          
095263     MOVE '7870'                        TO PGM-LOCATION.                  
095264     MOVE '7870-UPDATE-TMRITEM-ZSSTOCK' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   ZSSTOCK_CDE  =  :PV-ZSSTOCK                                
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM FRCDDU                                         *         
095260*****************************************************************         
095261 7880-UPDATE-TMRITEM-FRCDDU.                                              
095262                                                                          
095263     MOVE '7880'                        TO PGM-LOCATION.                  
095264     MOVE '7880-UPDATE-TMRITEM-FRCDDU ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   FRCDDU_CDE   =  :PV-FRCDDU                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM ZOPSW                                          *         
095260*****************************************************************         
095261 7890-UPDATE-TMRITEM-ZOPSW.                                               
095262                                                                          
095263     MOVE '7890'                        TO PGM-LOCATION.                  
095264     MOVE '7890-UPDATE-TMRITEM-ZOPSW'   TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   ZOPSW_CDE    =  :PV-ZOPSW                                  
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM DDUPRM                                         *         
095260*****************************************************************         
095261 7900-UPDATE-TMRITEM-DDUPRM.                                              
095262                                                                          
095263     MOVE '7900'                        TO PGM-LOCATION.                  
095264     MOVE '7900-UPDATE-TMRITEM-DDUPRM ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   DDUPRM_SW    =  :PV-DDUPRM                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM DDFTSW                                         *         
095260*****************************************************************         
095261 7910-UPDATE-TMRITEM-DDFTSW.                                              
095262                                                                          
095263     MOVE '7910'                        TO PGM-LOCATION.                  
095264     MOVE '7910-UPDATE-TMRITEM-DDFTSW ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   DDFTSW_CDE   =  :PV-DDFTSW                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM RTF                                            *         
095260*****************************************************************         
095261 7920-UPDATE-TMRITEM-RTF.                                                 
095262                                                                          
095263     MOVE '7920'                        TO PGM-LOCATION.                  
095264     MOVE '7920-UPDATE-TMRITEM-RTF    ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   RTF_FCTR     =  :PV-RTF-PACKED                             
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM MINBI                                          *         
095260*****************************************************************         
095261 7930-UPDATE-TMRITEM-MINBI.                                               
095262                                                                          
095263     MOVE '7930'                        TO PGM-LOCATION.                  
095264     MOVE '7930-UPDATE-TMRITEM-MINBI  ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   MINBI_FCTR   =  :PV-MINBI-PACKED                           
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM OUTLSW                                         *         
095260*****************************************************************         
095261 7940-UPDATE-TMRITEM-OUTLSW.                                              
095262                                                                          
095263     MOVE '7940'                        TO PGM-LOCATION.                  
095264     MOVE '7940-UPDATE-TMRITEM-OUTLSW ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   OUTLSW_CDE   =  :PV-OUTLSW                                 
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM DSER                                           *         
095260*****************************************************************         
095261 7950-UPDATE-TMRITEM-DSER.                                                
095262                                                                          
095263     MOVE '7950'                        TO PGM-LOCATION.                  
095264     MOVE '7950-UPDATE-TMRITEM-DSER  '  TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   DSER_CDE     =  :PV-DSER                                   
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM TSL                                            *         
095260*****************************************************************         
095261 7960-UPDATE-TMRITEM-TSL.                                                 
095262                                                                          
095263     MOVE '7960'                        TO PGM-LOCATION.                  
095264     MOVE '7960-UPDATE-TMRITEM-TSL    ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   TSL_NBR      =  :PV-TSL-PACKED                             
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM IMIN                                           *         
095260*****************************************************************         
095261 7970-UPDATE-TMRITEM-IMIN.                                                
095262                                                                          
095263     MOVE '7970'                        TO PGM-LOCATION.                  
095264     MOVE '7970-UPDATE-TMRITEM-IMIN   ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   IMIN_QTY     =  :PV-IMIN-PACKED                            
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095258*****************************************************************         
095259* UPDATE TMRITEM IMAX                                           *         
095260*****************************************************************         
095261 7980-UPDATE-TMRITEM-IMAX.                                                
095262                                                                          
095263     MOVE '7980'                        TO PGM-LOCATION.                  
095264     MOVE '7980-UPDATE-TMRITEM-IMAX   ' TO AA-PARAGRAPH-NAME.             
095265                                                                          
095266     EXEC SQL                                                             
095267         UPDATE TMRITEM                                                   
095268         SET   IMAX_QTY     =  :PV-IMAX-PACKED                            
095269         WHERE ITEM_NBR     =  :MRSKTR-ITM-NBR                            
095271     END-EXEC.                                                            
095272                                                                          
095273     EVALUATE TRUE                                                        
095274       WHEN SQLCODE         = ZERO                                        
095275         CONTINUE                                                         
095276       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095277         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095279       WHEN OTHER                                                         
095280         DISPLAY AA-ABEND-LIT                                             
095281         DISPLAY AA-PROGRAM-LIT                                           
095282         DISPLAY AA-PARAGRAPH-LIT                                         
095283         PERFORM 9999-SQL-ERROR                                           
095284     END-EVALUATE.                                                        
095285                                                                          
095412*****************************************************************         
095413* SELECT ORIGINAL TRAN ID.                                      *         
095414*****************************************************************         
095415 8000-SELECT-ORIGINAL-TRNID.                                              
095416                                                                          
095417     MOVE '8000'                        TO PGM-LOCATION.                  
095418     MOVE '8000-SELECT-ORIGINAL-TRNID'  TO AA-PARAGRAPH-NAME.             
095419                                                                          
095420     EXEC SQL                                                             
095421         SELECT TRN_ID                                                    
095422            INTO :PV-NEW-TRAN-ID                                          
095423         FROM TMRTRN                                                      
095424         WHERE DEPT_NBR     = :PV-DEPARTMENT                              
C52271           AND ORIG_TRN_ID  = :PV-TRAN-ID                                 
095426     END-EXEC.                                                            
095427                                                                          
095428     EVALUATE TRUE                                                        
095429       WHEN SQLCODE         = ZERO                                        
095430         CONTINUE                                                         
095431       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TRN-ID-ERROR       TO DL-ERROR-MESSAGE                   
095432         PERFORM 5000-CREATE-ERROR-REPORT                                 
095433         SET NO-REVERT-RECORD-FOUND TO TRUE                               
095434       WHEN OTHER                                                         
095435        DISPLAY AA-ABEND-LIT                                              
095436         DISPLAY AA-PROGRAM-LIT                                           
095437         DISPLAY AA-PARAGRAPH-LIT                                         
095438         PERFORM 9999-SQL-ERROR                                           
095439     END-EVALUATE.                                                        
095440                                                                          
095441*****************************************************************         
095442* SELECT TMRITST VALUES                                         *         
095443*****************************************************************         
095444 8100-SELECT-TMRITST.                                                     
095445                                                                          
095446     MOVE '8100'                        TO PGM-LOCATION.                  
095447     MOVE '8100-SELECT-TMRITST       '  TO AA-PARAGRAPH-NAME.             
095448                                                                          
095449     EXEC SQL                                                             
095450         SELECT  CSTOCK_QTY                                               
095451               , USERMIN_QTY                                              
095452               , USERMAX_QTY                                              
095453               , FT_CDE                                                   
095453               , OSTRAT_QTY                                               
095454         INTO    :MRITST-CSTOCK-QTY                                       
095455               , :MRITST-USERMIN-QTY                                      
095456               , :MRITST-USERMAX-QTY                                      
095457               , :MRITST-FT-CDE                                           
095457               , :MRITST-OSTRAT-QTY                                       
095458         FROM TMRITST                                                     
095459         WHERE ITEM_NBR = :MRSTTR-ITM-NBR                                 
095460           AND STR_NBR  = :MRSTTR-STR-NBR                                 
095461     END-EXEC.                                                            
095462                                                                          
095463     EVALUATE TRUE                                                        
095464       WHEN SQLCODE         = ZERO                                        
095465         CONTINUE                                                         
095466       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITST-ERROR TO DL-ERROR-MESSAGE                        
095467         PERFORM 5000-CREATE-ERROR-REPORT                                 
095166         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095469       WHEN OTHER                                                         
095470         DISPLAY AA-ABEND-LIT                                             
095471         DISPLAY AA-PROGRAM-LIT                                           
095472         DISPLAY AA-PARAGRAPH-LIT                                         
095473         PERFORM 9999-SQL-ERROR                                           
095474     END-EVALUATE.                                                        
095475                                                                          
095476*****************************************************************         
095477* UPDATE ROW IN THE TMRSTTR TABLE.                              *         
095478*****************************************************************         
095479 8200-UPDATE-TMRSTTR.                                                     
095480                                                                          
095481     MOVE '8200'                        TO PGM-LOCATION.                  
095482     MOVE '8200-UPDATE-TMRSTTR       '  TO AA-PARAGRAPH-NAME.             
095483                                                                          
095484     EXEC SQL                                                             
095485         UPDATE TMRSTTR                                                   
095486            SET PARM_VAL_TXT   = :PV-PARM-TEXT                            
095487            WHERE  DEPT_NBR    = :MRSTTR-DEPT-NBR                         
095488               AND TRN_ID      = :PV-NEW-TRAN-ID                          
095488               AND MAJ_CL_NBR  = :MRSTTR-MAJ-CL-NBR                       
095489               AND SUB_CL_NBR  = :MRSTTR-SUB-CL-NBR                       
095490               AND SKU_NBR     = :MRSTTR-SKU-NBR                          
095491               AND STR_NBR     = :MRSTTR-STR-NBR                          
095492     END-EXEC.                                                            
095493                                                                          
095494     EVALUATE TRUE                                                        
095495       WHEN SQLCODE         = ZERO                                        
095496         CONTINUE                                                         
095497       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRSTTR-ERROR      TO DL-ERROR-MESSAGE                   
095498         PERFORM 5000-CREATE-ERROR-REPORT                                 
095499         SET NO-REVERT-RECORD-FOUND TO TRUE                               
095500       WHEN OTHER                                                         
095501         DISPLAY AA-ABEND-LIT                                             
095502         DISPLAY AA-PROGRAM-LIT                                           
095503         DISPLAY AA-PARAGRAPH-LIT                                         
095510         PERFORM 9999-SQL-ERROR                                           
095600     END-EVALUATE.                                                        
095600                                                                          
095441*****************************************************************         
095442* SELECT TMRITEM VALUES                                         *         
095443*****************************************************************         
095444 8300-SELECT-TMRITEM.                                                     
095445                                                                          
095446     MOVE '8300'                        TO PGM-LOCATION.                  
095447     MOVE '8300-SELECT-TMRITEM       '  TO AA-PARAGRAPH-NAME.             
095448                                                                          
095449     EXEC SQL                                                             
095450         SELECT  LT_QTY                                                   
095454         INTO    :MRITEM-LT-QTY:PV-LT-IND                                 
095458         FROM TMRITEM                                                     
095459         WHERE ITEM_NBR = :MRSKTR-ITM-NBR                                 
095461     END-EXEC.                                                            
095462                                                                          
095463     EVALUATE TRUE                                                        
095365       WHEN SQLCODE         = ZERO                                        
095366         PERFORM 8350-STORE-CHECK-NULLS                                   
095466       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRITEM-ERROR TO DL-ERROR-MESSAGE                        
095467         PERFORM 5000-CREATE-ERROR-REPORT                                 
095278         MOVE PC-Y             TO PS-ERROR-IN-ROW                         
095469       WHEN OTHER                                                         
095470         DISPLAY AA-ABEND-LIT                                             
095471         DISPLAY AA-PROGRAM-LIT                                           
095472         DISPLAY AA-PARAGRAPH-LIT                                         
095473         PERFORM 9999-SQL-ERROR                                           
095474     END-EVALUATE.                                                        
095375                                                                          
095376*****************************************************************         
095377* CHECK FOR NULLS                                               *         
095378*****************************************************************         
095379 8350-STORE-CHECK-NULLS.                                                  
095380                                                                          
095381     IF  PV-LT-IND       = -1                                             
095382        MOVE '0' TO MRITEM-LT-QTY                                         
095383     END-IF.                                                              
095384                                                                          
095476*****************************************************************         
095477* UPDATE ROW IN THE TMRSKTR TABLE.                              *         
095478*****************************************************************         
095479 8400-UPDATE-TMRSKTR.                                                     
095480                                                                          
095481     MOVE '8400'                        TO PGM-LOCATION.                  
095482     MOVE '8400-UPDATE-TMRSKTR       '  TO AA-PARAGRAPH-NAME.             
095483                                                                          
095484     EXEC SQL                                                             
095485         UPDATE TMRSKTR                                                   
095486            SET PARM_VAL_TXT   = :PV-PARM-TEXT                            
095487            WHERE  DEPT_NBR    = :MRSKTR-DEPT-NBR                         
095488               AND TRN_ID      = :PV-NEW-TRAN-ID                          
095489               AND SUB_CL_NBR  = :MRSKTR-SUB-CL-NBR                       
095490               AND SKU_NBR     = :MRSKTR-SKU-NBR                          
095492     END-EXEC.                                                            
095493                                                                          
095494     EVALUATE TRUE                                                        
095495       WHEN SQLCODE         = ZERO                                        
095496         CONTINUE                                                         
095497       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
095026         MOVE PC-TMRSKTR-ERROR      TO DL-ERROR-MESSAGE                   
095498         PERFORM 5000-CREATE-ERROR-REPORT                                 
095499         SET NO-REVERT-RECORD-FOUND TO TRUE                               
095500       WHEN OTHER                                                         
095501         DISPLAY AA-ABEND-LIT                                             
095502         DISPLAY AA-PROGRAM-LIT                                           
095503         DISPLAY AA-PARAGRAPH-LIT                                         
095510         PERFORM 9999-SQL-ERROR                                           
095600     END-EVALUATE.                                                        
095600                                                                          
134300*                                                                *        
134301******************************************************************        
134302*     DB2 COMMIT TEST                                            *        
134400******************************************************************        
134600 9000-COMMIT-TEST.                                                        
134800                                                                          
134900     MOVE '9000'                   TO PGM-LOCATION.                       
135000     MOVE '9000-COMMIT-TEST     '  TO AA-PARAGRAPH-NAME.                  
135100                                                                          
135200*  GET THE CURRENT TIMESTAMP                                              
135300                                                                          
135400     EXEC SQL                                                             
135500         SET :PV-CURR-TMST = CURRENT TIMESTAMP                            
135600     END-EXEC.                                                            
135700                                                                          
135800     IF SQLCODE = +0                                                      
135900         CONTINUE                                                         
136000     ELSE                                                                 
136001         DISPLAY AA-ABEND-LIT                                             
136002         DISPLAY AA-PROGRAM-LIT                                           
136003         DISPLAY AA-PARAGRAPH-LIT                                         
136300         PERFORM 9999-SQL-ERROR                                           
136310     END-IF.                                                              
136400                                                                          
136500*  COMPARE TO THE NEXT SCHEDULED COMMIT TIME                              
136600                                                                          
136700     IF PV-CURR-TMST > PV-COMMIT-TMST                                     
136800         PERFORM 9100-COMMIT-CHANGES                                      
136810     END-IF.                                                              
136900                                                                          
137000 EJECT                                                                    
137001                                                                          
137002*****************************************************************         
137003* COMMIT CHANGES.                                               *         
137004*****************************************************************         
137005 9100-COMMIT-CHANGES.                                                     
137006                                                                          
137007     MOVE '9100'                        TO PGM-LOCATION.                  
137008     MOVE '9100-COMMIT-CHANGES       '  TO AA-PARAGRAPH-NAME.             
137009                                                                          
137010     EXEC SQL                                                             
137011         COMMIT                                                           
137012     END-EXEC.                                                            
137013                                                                          
137014     IF SQLCODE = +0                                                      
137015         CONTINUE                                                         
137016     ELSE                                                                 
137017         DISPLAY AA-ABEND-LIT                                             
137018         DISPLAY AA-PROGRAM-LIT                                           
137019         DISPLAY AA-PARAGRAPH-LIT                                         
137020         PERFORM 9999-SQL-ERROR                                           
137030     END-IF.                                                              
139100                                                                          
139200*  GET THE NEXT SCHEDULED COMMIT TIME                                     
139300                                                                          
139400     EXEC SQL                                                             
139500         SELECT  (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)            
139600           INTO  :PV-COMMIT-TMST                                          
139700           FROM  TCKRSTCNTL                                               
139800          WHERE  PLAN_NAME = 'MRKUP098'                                   
139900     END-EXEC.                                                            
140000                                                                          
140100     IF SQLCODE = +0                                                      
140200         CONTINUE                                                         
140300     ELSE                                                                 
140301         DISPLAY AA-ABEND-LIT                                             
140302         DISPLAY AA-PROGRAM-LIT                                           
140303         DISPLAY AA-PARAGRAPH-LIT                                         
140600         PERFORM 9999-SQL-ERROR                                           
140610     END-IF.                                                              
140700                                                                          
140701                                                                          
140702******************************************************************        
140703* END OF PROGRAM PROCESSING                                      *        
140704******************************************************************        
140705 9900-EOJ-ROUTINE.                                                        
140706                                                                          
140707     IF NO-RECORDS-WRITTEN                                                
140708         PERFORM 5400-PRINT-NO-RECORD-REPORT                              
140709     ELSE                                                                 
140710         MOVE END-OF-REPORT-LINE         TO PRINT-LINE                    
140711         MOVE PC-ONE                     TO PV-LINE-CONTROL               
140712         PERFORM 5300-WRITE-PRINT-LINE                                    
140713     END-IF.                                                              
140714                                                                          
140715     CLOSE PRINT-REPORT.                                                  
140716                                                                          
140719     DISPLAY '********************************************'.              
140720     DISPLAY '**** TOTAL RECORDS PROCESSED: ' PV-TOTAL-CNT.               
140721     DISPLAY '**** GOOD RECORDS PROCESSED:  ' PV-GOOD-CNT.                
140722     DISPLAY '**** ERROR RECORDS PROCESSED: ' PV-ERROR-CNT.               
140723     DISPLAY '********************************************'.              
140724                                                                          
140725******************************************************************        
140726*   SQL ERROR MESSAGE ROUTINE                                             
140727******************************************************************        
140728 9999-SQL-ERROR.                                                          
140729                                                                          
140730     MOVE SQLCODE    TO SQLCODE2.                                         
140731     MOVE SQLERRD(3) TO SQLERRD3.                                         
140732     DISPLAY '** ABEND **       ** = SQLERROR'.                           
140733     DISPLAY '** PROGRAM        ** = MRKUP098'.                           
140734     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                          
140735     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                          
140736     DISPLAY '** SQLERRM        ** = ' SQLERRM.                           
140737     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                          
140738     MOVE +4013 TO ABEND-CODE.                                            
140739     CALL 'ILBOABN0' USING ABEND-CODE.                                    
140740******************************************************************        
140741******************END OF PROGRAM   *******************************        
140742******************************************************************        
