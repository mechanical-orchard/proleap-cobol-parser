       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.         MLKUT709.                                            
       INSTALLATION.       KOHLS DEPARTMENT STORES.                             
       DATE-WRITTEN.       08/27/2002.                                          
       DATE-COMPILED.                                                           
      ******************************************************************        
      *PURPOSE:                                                                 
      *    THE PROGRAM SCRIPTS SQL UPDATES TO TVADPT FOR MARKUP AND             
      * MARKDOWNS.                                                              
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT IN-TVADPT-WORK-FILE                                           
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT OUT-TVADPT-UPDT-FILE                                          
               ASSIGN TO OUT01.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  IN-TVADPT-WORK-FILE                                                  
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           DATA RECORD IS IN-TVADPT-RECORD.                                     
       01  IN-TVADPT-RECORD              PIC X(61).                             
                                                                                
       FD  OUT-TVADPT-UPDT-FILE                                                 
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           DATA RECORD IS OUT-TVADPT-UPDT-RECORD.                               
       01  OUT-TVADPT-UPDT-RECORD        PIC X(80).                             
                                                                                
      /*****************************************************************        
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
                                                                                
       01  ABEND-CODE                  PIC S9(04) VALUE ZERO COMP SYNC.         
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PARA                 PIC X(30)  VALUE SPACES.                 
           05  PV-DB2-OPER-ATTEMPTED   PIC X(30)  VALUE SPACES.                 
           05  PV-READ-RECS-ACCUM      PIC S9(11) COMP-3 VALUE ZEROS.           
           05  PV-WRIT-RECS-ACCUM      PIC S9(11) COMP-3 VALUE ZEROS.           
           05  PV-TVADPT-READS-ACCUM   PIC S9(11) COMP-3 VALUE ZEROS.           
           05  PV-TVADPT-WRIT-ACCUM    PIC S9(11) COMP-3 VALUE ZEROS.           
           05  PV-UPDT-COUNT           PIC S9(11) COMP-3 VALUE ZEROS.           
           05  PV-EDIT-ENT-ID          PIC ZZZZZZZZ9     VALUE ZEROS.           
           05  PV-EDIT-WORK-AMOUNT     PIC S9(09)V9(02)  VALUE ZEROS.           
                                                                                
       01  SWITCHES.                                                            
           05  PS-PROCESS-DONE-SW      PIC X(01) VALUE 'N'.                     
               88  PROCESS-COMPLETE              VALUE 'Y'.                     
                                                                                
       01  WS-DCLTVADPT.                                                        
           10 VADPT-FSCL-MN-NBR             PIC   X(2).                         
           10 VADPT-FSCL-MN-END-DTE         PIC   X(10).                        
           10 VADPT-DEPT-NBR                PIC   X(3).                         
           10 VADPT-ENT-ID                  PIC  S9(9) COMP.                    
           10 VADPT-SLS-REG-RTL-AMT         PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-SLS-PROMO-RTL-AMT       PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-SLS-PROCLR-RTL-AMT      PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-SLS-CLR-RTL-AMT         PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-SLS-OTH-RTL-AMT         PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKDN-PLU-RTL-AMT        PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKDN-RGST-RTL-AMT       PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKDN-UMTCH-RTL-AMT      PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKDN-BYR-RTL-AMT        PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKDN-STR-RTL-AMT        PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKUP-RTL-AMT            PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-XFER-IN-RTL-AMT         PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-XFER-OUT-RTL-AMT        PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-RCPT-RTL-AMT            PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-RCPT-NET-COST-AMT       PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-RCPT-GRO-COST-AMT       PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-PADJ-FRGT-COST-AMT      PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-PADJ-DISC-COST-AMT      PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-PADJ-RTL-AMT            PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-PADJ-NET-COST-AMT       PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-DR-ALW-RTL-AMT          PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-RTV-RTL-AMT             PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-INV-ADJ-RTL-AMT         PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-SHNK-RTL-AMT            PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKUP-INIT-AMT           PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-MKUP-NET-AMT            PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-END-INV-RTL-AMT         PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-CUM-MKUP-PCT            PIC  S9(4)V9(7) COMP-3.             
           10 VADPT-END-INV-COST-AMT        PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-SLS-COST-AMT            PIC  S9(11)V9(2) COMP-3.            
           10 VADPT-GRO-MRGN-AMT            PIC  S9(11)V9(2) COMP-3.            
                                                                                
       01  MKDN-PLU-RTL-AMT-PLUS-LINE.                                          
           05  FILLER               PIC X(45)                                   
               VALUE 'MKDN_PLU_RTL_AMT = MKDN_PLU_RTL_AMT + '.                  
           05  MKDN-PLU-RTL-AMT1    PIC ZZZZZZZZ.99.                            
                                                                                
       01  MKDN-PLU-RTL-AMT-MIN-LINE.                                           
           05  FILLER               PIC X(45)                                   
               VALUE 'MKDN_PLU_RTL_AMT = MKDN_PLU_RTL_AMT - '.                  
           05  MKDN-PLU-RTL-AMT2    PIC ZZZZZZZZ.99.                            
                                                                                
       01  MKDN-RGST-RTL-AMT-PLUS-LINE.                                         
           05  MKDN-RGST-RTL-BYTE1  PIC X(01).                                  
           05  FILLER               PIC X(45)                                   
               VALUE 'MKDN_RGST_RTL_AMT = MKDN_RGST_RTL_AMT + '.                
           05  MKDN-RGST-RTL-AMT1   PIC ZZZZZZZZ.99.                            
                                                                                
       01  MKDN-RGST-RTL-AMT-MIN-LINE.                                          
           05  MKDN-RGST-RTL-BYTE2  PIC X(01).                                  
           05  FILLER               PIC X(45)                                   
               VALUE 'MKDN_RGST_RTL_AMT = MKDN_RGST_RTL_AMT - '.                
           05  MKDN-RGST-RTL-AMT2   PIC ZZZZZZZZ.99.                            
                                                                                
       01  MKDN-UMTCH-RTL-AMT-PLUS-LINE.                                        
           05  MKDN-UMTCH-RTL-BYTE1  PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKDN_UMTCH_RTL_AMT = MKDN_UMTCH_RTL_AMT + '.              
           05  MKDN-UMTCH-RTL-AMT1   PIC ZZZZZZZZ.99.                           
                                                                                
       01  MKDN-UMTCH-RTL-AMT-MIN-LINE.                                         
           05  MKDN-UMTCH-RTL-BYTE2  PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKDN_UMTCH_RTL_AMT = MKDN_UMTCH_RTL_AMT - '.              
           05  MKDN-UMTCH-RTL-AMT2   PIC ZZZZZZZZ.99.                           
                                                                                
       01  MKDN-BYR-RTL-AMT-PLUS-LINE.                                          
           05  MKDN-BYR-RTL-BYTE1    PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKDN_BYR_RTL_AMT = MKDN_BYR_RTL_AMT + '.                  
           05  MKDN-BYR-RTL-AMT1     PIC ZZZZZZZZ.99.                           
                                                                                
       01  MKDN-BYR-RTL-AMT-MIN-LINE.                                           
           05  MKDN-BYR-RTL-BYTE2    PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKDN_BYR_RTL_AMT = MKDN_BYR_RTL_AMT - '.                  
           05  MKDN-BYR-RTL-AMT2     PIC ZZZZZZZZ.99.                           
                                                                                
       01  MKDN-STR-RTL-AMT-PLUS-LINE.                                          
           05  MKDN-STR-RTL-BYTE1    PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKDN_STR_RTL_AMT = MKDN_STR_RTL_AMT + '.                  
           05  MKDN-STR-RTL-AMT1     PIC ZZZZZZZZ.99.                           
                                                                                
       01  MKDN-STR-RTL-AMT-MIN-LINE.                                           
           05  MKDN-STR-RTL-BYTE2    PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKDN_STR_RTL_AMT = MKDN_STR_RTL_AMT - '.                  
           05  MKDN-STR-RTL-AMT2     PIC ZZZZZZZZ.99.                           
                                                                                
       01  MKUP-RTL-AMT-PLUS-LINE.                                              
           05  MKUP-RTL-BYTE1        PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKUP_RTL_AMT = MKUP_RTL_AMT + '.                          
           05  MKUP-RTL-AMT1         PIC ZZZZZZZZ.99.                           
                                                                                
       01  MKUP-RTL-AMT-MIN-LINE.                                               
           05  MKUP-RTL-BYTE2        PIC X(01).                                 
           05  FILLER                PIC X(45)                                  
               VALUE 'MKUP_RTL_AMT = MKUP_RTL_AMT - '.                          
           05  MKUP-RTL-AMT2         PIC ZZZZZZZZ.99.                           
                                                                                
      /****************************************************************         
      *FLOW:    READ THE TVADPT EXTRACT FILE FOR MARKUP AND MARKDOWNS.          
      *      CREATE A SQL UPDATE SCRIPT FOR ENTIDS AT THE DEPARTMENT            
      *      AND MAJOR CLASS LEVEL WHERE THE MARKUP COLUMN OR MARKDOWN          
      *      COLUMNS CONTINUE TO HAVE A VALUE IN THEM. THE VALUE IS THE         
      *      OPPOSITE OF WHAT THE VALUE CURRENTLY IS.                           
      *                                                                         
      *      WRITE A RECORD.                                                    
      *                                                                         
      *****************************************************************         
      *****************************************************************         
       PROCEDURE DIVISION.                                                      
      *****************************************************************         
       0000-MAINLINE-PROCESSING.                                                
                                                                                
           PERFORM 1000-INITIALIZATION.                                         
                                                                                
           PERFORM 2000-MAIN-PROCESS-LOOP                                       
               UNTIL PROCESS-COMPLETE.                                          
                                                                                
           PERFORM 9900-EOJ-TASKS.                                              
                                                                                
       9999-EXIT-PROGRAM.                                                       
           STOP RUN.                                                            
                                                                                
      /****************************************************************         
      * 1000-INITIALIZATION.......                                              
      *****************************************************************         
       1000-INITIALIZATION.                                                     
           MOVE '*1000-INITIALIZATION.              *' TO PV-PARA.              
                                                                                
           OPEN  INPUT IN-TVADPT-WORK-FILE                                      
                OUTPUT OUT-TVADPT-UPDT-FILE.                                    
                                                                                
           INITIALIZE WS-DCLTVADPT.                                             
                                                                                
           MOVE SPACES     TO OUT-TVADPT-UPDT-RECORD.                           
           MOVE ZEROS      TO PV-READ-RECS-ACCUM.                               
           MOVE ZEROS      TO PV-WRIT-RECS-ACCUM.                               
           MOVE ZEROS      TO PV-TVADPT-READS-ACCUM.                            
           MOVE 'N'        TO PS-PROCESS-DONE-SW.                               
                                                                                
      *** TVADPT WORK FILE READ....                                             
           PERFORM 9000-READ-TVADPT-WORK-FILE.                                  
           IF PROCESS-COMPLETE                                                  
               DISPLAY '**  PROGRAM   **  =  MLKUT612'                          
               DISPLAY '**  PARAGRAPH **  = ' PV-PARA                           
               DISPLAY '**  NO RECORDS TO PROCESS **'                           
               MOVE 4095 TO ABEND-CODE                                          
               CALL 'ILBOABN0' USING ABEND-CODE                                 
           END-IF.                                                              
                                                                                
      /****************************************************************         
      * 2000-MAIN-PROCESS-LOOP.                                                 
      *****************************************************************         
       2000-MAIN-PROCESS-LOOP.                                                  
           MOVE '* 2000-MAIN-PROCESS-LOOP*' TO PV-PARA.                         
                                                                                
           PERFORM 3000-EDIT-TVADPT-RECORDS.                                    
                                                                                
           PERFORM 9000-READ-TVADPT-WORK-FILE.                                  
                                                                                
      /****************************************************************         
      * 3000-EDIT-TVADPT-RECORDS.                                               
      *****************************************************************         
       3000-EDIT-TVADPT-RECORDS.                                                
           MOVE '*3000-EDIT-TVADPT-RECORDS *' TO PV-PARA.                       
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           PERFORM 4000-WRITE-TVADPT-UPDATE.                                    
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           MOVE 'UPDATE DB2TDBA.TVADPT' TO OUT-TVADPT-UPDT-RECORD.              
           PERFORM 4000-WRITE-TVADPT-UPDATE.                                    
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           MOVE 'SET'               TO OUT-TVADPT-UPDT-RECORD.                  
           PERFORM 4000-WRITE-TVADPT-UPDATE.                                    
                                                                                
           PERFORM 3100-BUILD-SET.                                              
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           STRING 'WHERE FSCL_MN_END_DTE = ' DELIMITED BY SIZE                  
                  '''2002-08-31''' DELIMITED BY SIZE                            
                                    INTO OUT-TVADPT-UPDT-RECORD.                
           PERFORM 4000-WRITE-TVADPT-UPDATE.                                    
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           STRING 'AND DEPT_NBR = ' DELIMITED BY SIZE                           
                  '''' DELIMITED BY SIZE                                        
                  VADPT-DEPT-NBR DELIMITED BY SIZE                              
                  '''' DELIMITED BY SIZE                                        
                                    INTO OUT-TVADPT-UPDT-RECORD.                
           PERFORM 4000-WRITE-TVADPT-UPDATE.                                    
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           MOVE VADPT-ENT-ID        TO PV-EDIT-ENT-ID.                          
           STRING 'AND ENT_ID = ' DELIMITED BY SIZE                             
                  PV-EDIT-ENT-ID DELIMITED BY SIZE                              
                  ';' DELIMITED BY SIZE                                         
                                    INTO OUT-TVADPT-UPDT-RECORD.                
           PERFORM 4000-WRITE-TVADPT-UPDATE.                                    
                                                                                
      *****************************************************************         
      * 3100-BUILD-SET.                                                         
      *****************************************************************         
       3100-BUILD-SET.                                                          
           MOVE '*3100-BUILD-SET *' TO PV-PARA.                                 
                                                                                
           MOVE ZEROS               TO PV-UPDT-COUNT.                           
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           IF VADPT-MKDN-PLU-RTL-AMT IS NUMERIC  AND                            
              VADPT-MKDN-PLU-RTL-AMT NOT EQUAL ZEROS                            
             IF VADPT-MKDN-PLU-RTL-AMT LESS ZERO                                
               COMPUTE PV-EDIT-WORK-AMOUNT = VADPT-MKDN-PLU-RTL-AMT             
                                           * -1                                 
               MOVE PV-EDIT-WORK-AMOUNT    TO MKDN-PLU-RTL-AMT1                 
               MOVE MKDN-PLU-RTL-AMT-PLUS-LINE                                  
                                           TO OUT-TVADPT-UPDT-RECORD            
               ADD 1                  TO PV-UPDT-COUNT                          
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             ELSE                                                               
               MOVE VADPT-MKDN-PLU-RTL-AMT TO MKDN-PLU-RTL-AMT2                 
               MOVE MKDN-PLU-RTL-AMT-MIN-LINE                                   
                                           TO OUT-TVADPT-UPDT-RECORD            
               ADD 1                  TO PV-UPDT-COUNT                          
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           IF VADPT-MKDN-RGST-RTL-AMT IS NUMERIC  AND                           
              VADPT-MKDN-RGST-RTL-AMT NOT EQUAL ZEROS                           
             IF VADPT-MKDN-RGST-RTL-AMT LESS ZEROS                              
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-RGST-RTL-BYTE1                      
               ELSE                                                             
                 MOVE ','           TO MKDN-RGST-RTL-BYTE1                      
               END-IF                                                           
               COMPUTE PV-EDIT-WORK-AMOUNT = VADPT-MKDN-RGST-RTL-AMT            
                                           * -1                                 
               MOVE PV-EDIT-WORK-AMOUNT    TO MKDN-RGST-RTL-AMT1                
               MOVE MKDN-RGST-RTL-AMT-PLUS-LINE                                 
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             ELSE                                                               
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-RGST-RTL-BYTE2                      
               ELSE                                                             
                 MOVE ','           TO MKDN-RGST-RTL-BYTE2                      
               END-IF                                                           
               MOVE VADPT-MKDN-RGST-RTL-AMT TO MKDN-RGST-RTL-AMT2               
               MOVE MKDN-RGST-RTL-AMT-MIN-LINE                                  
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           IF VADPT-MKDN-UMTCH-RTL-AMT IS NUMERIC  AND                          
              VADPT-MKDN-UMTCH-RTL-AMT NOT EQUAL ZEROS                          
             IF VADPT-MKDN-UMTCH-RTL-AMT LESS ZEROS                             
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-UMTCH-RTL-BYTE1                     
               ELSE                                                             
                 MOVE ','           TO MKDN-UMTCH-RTL-BYTE1                     
               END-IF                                                           
               COMPUTE PV-EDIT-WORK-AMOUNT = VADPT-MKDN-UMTCH-RTL-AMT           
                                           * -1                                 
               MOVE PV-EDIT-WORK-AMOUNT    TO MKDN-UMTCH-RTL-AMT1               
               MOVE MKDN-UMTCH-RTL-AMT-PLUS-LINE                                
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             ELSE                                                               
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-UMTCH-RTL-BYTE2                     
               ELSE                                                             
                 MOVE ','           TO MKDN-UMTCH-RTL-BYTE2                     
               END-IF                                                           
               MOVE VADPT-MKDN-UMTCH-RTL-AMT TO MKDN-UMTCH-RTL-AMT2             
               MOVE MKDN-UMTCH-RTL-AMT-MIN-LINE                                 
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           IF VADPT-MKDN-BYR-RTL-AMT IS NUMERIC  AND                            
              VADPT-MKDN-BYR-RTL-AMT NOT EQUAL ZEROS                            
             IF VADPT-MKDN-BYR-RTL-AMT LESS ZEROS                               
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-BYR-RTL-BYTE1                       
               ELSE                                                             
                 MOVE ','           TO MKDN-BYR-RTL-BYTE1                       
               END-IF                                                           
               COMPUTE PV-EDIT-WORK-AMOUNT = VADPT-MKDN-BYR-RTL-AMT             
                                           * -1                                 
               MOVE PV-EDIT-WORK-AMOUNT    TO MKDN-BYR-RTL-AMT1                 
               MOVE MKDN-BYR-RTL-AMT-PLUS-LINE                                  
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             ELSE                                                               
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-BYR-RTL-BYTE2                       
               ELSE                                                             
                 MOVE ','           TO MKDN-BYR-RTL-BYTE2                       
               END-IF                                                           
               MOVE VADPT-MKDN-BYR-RTL-AMT TO MKDN-BYR-RTL-AMT2                 
               MOVE MKDN-BYR-RTL-AMT-MIN-LINE                                   
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           IF VADPT-MKDN-STR-RTL-AMT IS NUMERIC  AND                            
              VADPT-MKDN-STR-RTL-AMT NOT EQUAL ZEROS                            
             IF VADPT-MKDN-STR-RTL-AMT LESS ZEROS                               
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-STR-RTL-BYTE1                       
               ELSE                                                             
                 MOVE ','           TO MKDN-STR-RTL-BYTE1                       
               END-IF                                                           
               COMPUTE PV-EDIT-WORK-AMOUNT = VADPT-MKDN-STR-RTL-AMT             
                                           * -1                                 
               MOVE PV-EDIT-WORK-AMOUNT    TO MKDN-STR-RTL-AMT1                 
               MOVE MKDN-STR-RTL-AMT-PLUS-LINE                                  
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             ELSE                                                               
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKDN-STR-RTL-BYTE2                       
               ELSE                                                             
                 MOVE ','           TO MKDN-STR-RTL-BYTE2                       
               END-IF                                                           
               MOVE VADPT-MKDN-STR-RTL-AMT TO MKDN-STR-RTL-AMT2                 
               MOVE MKDN-STR-RTL-AMT-MIN-LINE                                   
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE SPACES              TO OUT-TVADPT-UPDT-RECORD.                  
           IF VADPT-MKUP-RTL-AMT IS NUMERIC  AND                                
              VADPT-MKUP-RTL-AMT NOT EQUAL ZEROS                                
             IF VADPT-MKUP-RTL-AMT LESS ZEROS                                   
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKUP-RTL-BYTE1                           
               ELSE                                                             
                 MOVE ','           TO MKUP-RTL-BYTE1                           
               END-IF                                                           
               COMPUTE PV-EDIT-WORK-AMOUNT = VADPT-MKUP-RTL-AMT                 
                                           * -1                                 
               MOVE PV-EDIT-WORK-AMOUNT    TO MKUP-RTL-AMT1                     
               MOVE MKUP-RTL-AMT-PLUS-LINE                                      
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             ELSE                                                               
               IF PV-UPDT-COUNT EQUAL ZERO                                      
                 MOVE SPACE         TO MKUP-RTL-BYTE2                           
               ELSE                                                             
                 MOVE ','           TO MKUP-RTL-BYTE2                           
               END-IF                                                           
               MOVE VADPT-MKUP-RTL-AMT TO MKUP-RTL-AMT2                         
               MOVE MKUP-RTL-AMT-MIN-LINE                                       
                                    TO OUT-TVADPT-UPDT-RECORD                   
               ADD 1                TO PV-UPDT-COUNT                            
               PERFORM 4000-WRITE-TVADPT-UPDATE                                 
             END-IF                                                             
           END-IF.                                                              
                                                                                
      *****************************************************************         
      * 4000-WRITE-TVADPT-UPDATE.                                               
      *****************************************************************         
       4000-WRITE-TVADPT-UPDATE.                                                
           MOVE '*4000-WRITE-TVADPT-UPDATE *' TO PV-PARA.                       
                                                                                
           WRITE OUT-TVADPT-UPDT-RECORD.                                        
                                                                                
           ADD 1                   TO PV-TVADPT-WRIT-ACCUM.                     
                                                                                
      /****************************************************************         
      * 9000-READ-TVADPT-WORK-FILE.                                             
      *****************************************************************         
       9000-READ-TVADPT-WORK-FILE.                                              
           MOVE '*9000-READ-TVADPT-WORK-FILE*' TO PV-PARA.                      
                                                                                
           READ IN-TVADPT-WORK-FILE NEXT RECORD                                 
             INTO WS-DCLTVADPT                                                  
               AT END  MOVE 'Y'    TO PS-PROCESS-DONE-SW.                       
                                                                                
           IF NOT PROCESS-COMPLETE                                              
               ADD 1               TO PV-TVADPT-READS-ACCUM                     
           END-IF.                                                              
                                                                                
      /****************************************************************         
      * 9900-EOJ-TASKS.                                                         
      *****************************************************************         
       9900-EOJ-TASKS.                                                          
           MOVE '*9900-EOJ-TASKS. *' TO PV-PARA.                                
                                                                                
           DISPLAY '*********************************'                          
           DISPLAY '**  CONTROL SUMMARY - MLKUT709 **'                          
           DISPLAY '* TVADPT WRK READS   = ', PV-TVADPT-READS-ACCUM             
           DISPLAY '*            WRITES  = ', PV-TVADPT-WRIT-ACCUM              
           DISPLAY '*********************************'                          
                                                                                
           CLOSE IN-TVADPT-WORK-FILE                                            
                 OUT-TVADPT-UPDT-FILE.                                          
                                                                                
