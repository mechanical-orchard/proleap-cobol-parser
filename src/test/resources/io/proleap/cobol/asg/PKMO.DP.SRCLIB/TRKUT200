000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   TRKUT200.                                          00050000
000600 AUTHOR.       MARGARET MORRISON.                                 00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. APRIL, 1998.                                       00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM EDITS ORIGIN BOOKING DATA.  IT CREATES A FILE    *00120000
001300*  THAT CONTAINS EDITED UPDATE BOOKING RECORDS THAT WILL BE      *00130000
001400*  PASSED TO PROGRAM TRKUP205 WHICH WILL ACTUALLY UPDATE         *00140000
001401*  (ADD, CHANGE, DELETE) THE DB2 IMPORT BOOKING TABLES.          *00140100
001402*  THE PROGRAM ALSO CREATES A FILE THAT CONTAINS ERROR RECORDS   *00140200
001403*  THAT WILL BE PASSED TO THE ERROR REPORT PROGRAM.              *00140300
001404******************************************************************00140400
001405******************************************************************00140500
001406 ENVIRONMENT DIVISION.                                            00140600
001407******************************************************************00140700
001408                                                                  00140800
001409 CONFIGURATION SECTION.                                           00140900
001410                                                                  00141000
001420 SOURCE-COMPUTER.        IBM-3090.                                00142000
001430 OBJECT-COMPUTER.        IBM-3090.                                00143000
001440                                                                  00144000
001450 INPUT-OUTPUT SECTION.                                            00145000
001460                                                                  00146000
001470 FILE-CONTROL.                                                    00147000
001480                                                                  00148000
001490     SELECT TR014-BOOKING-FILE                                    00149000
001500         ASSIGN TO INP01.                                         00150000
001600                                                                  00160000
001700     SELECT TR024-UPDATE-BOOKING-FILE                             00170000
001800         ASSIGN TO OUT01.                                         00180000
001900                                                                  00190000
002000     SELECT TR201-BOOKING-ERROR-FILE                              00200000
002100         ASSIGN TO OUT02.                                         00210000
002200                                                                  00220000
002300******************************************************************00230000
002400 DATA DIVISION.                                                   00240000
002500******************************************************************00250000
002600                                                                  00260000
002700 FILE SECTION.                                                    00270000
002800                                                                  00280000
002900 FD  TR014-BOOKING-FILE                                           00290000
003000     RECORDING MODE IS F                                          00300000
003100     LABEL RECORDS ARE STANDARD                                   00310000
003200     BLOCK CONTAINS 0 RECORDS.                                    00320000
003300                                                                  00330000
003400 01  TR014-BOOKING-RECORD            PIC X(300).                  00340000
003500                                                                  00350000
003600 FD  TR024-UPDATE-BOOKING-FILE                                    00360000
003700     RECORDING MODE IS F                                          00370000
003800     LABEL RECORDS ARE STANDARD                                   00380000
003900     BLOCK CONTAINS 0 RECORDS.                                    00390000
004000                                                                  00400000
004100 01  TR024-UPDATE-BOOKING-RECORD     PIC X(300).                  00410000
004200                                                                  00420000
004300 FD  TR201-BOOKING-ERROR-FILE                                     00430000
004400     RECORDING MODE IS F                                          00440000
004410     LABEL RECORDS ARE STANDARD                                   00441000
004411     BLOCK CONTAINS 0 RECORDS.                                    00441100
004412                                                                  00441200
004413 01  TR201-BOOKING-ERROR-RECORD      PIC X(254).                  00441300
004414                                                                  00441400
004415******************************************************************00441500
004416 WORKING-STORAGE SECTION.                                         00441600
004417******************************************************************00441700
004418                                                                  00441800
004419******************************************************************00441900
004420*  DB2 FORMATTED MESSAGE AREA                                     00442000
004430******************************************************************00443000
004440     COPY DPWS004.                                                00444000
004450                                                                  00445000
004460******************************************************************00446000
004470*  COMMUNICATIONS AREA FOR DB2                                    00447000
004480******************************************************************00448000
004490     EXEC SQL                                                     00449000
004500          INCLUDE SQLCA                                           00450000
004600     END-EXEC.                                                    00460000
004700                                                                  00470000
004800******************************************************************00480000
004900*  DB2 TABLE DECLARATION -  ET-TRADING PARTNERSHIP TABLE.         00490000
005000*      (TTRDPRT)                                                  00500000
005100******************************************************************00510000
005200     EXEC SQL                                                     00520000
005300          INCLUDE TTRDPRT                                         00530000
005400     END-EXEC.                                                    00540000
005500                                                                  00550000
005600******************************************************************00560000
005700*  DB2 TABLE DECLARATION -  ENTERPRISE NAME TABLE.                00570000
005800*      (TENTNME)                                                  00580000
005900******************************************************************00590000
006000     EXEC SQL                                                     00600000
006100          INCLUDE TENTNME                                         00610000
006200     END-EXEC.                                                    00620000
006300                                                                  00630000
006400******************************************************************00640000
006500*  IMPORT ORIGIN BOOKING DATA LAYOUT                              00650000
006600******************************************************************00660000
006700     COPY TRRD014.                                                00670000
006800 EJECT                                                            00680000
006900                                                                  00690000
007000******************************************************************00700000
007100*  EDITED IMPORT ORIGIN BOOKING DATA LAYOUT                       00710000
007200******************************************************************00720000
007300     COPY TRRD024.                                                00730000
007400 EJECT                                                            00740000
007500                                                                  00750000
007600******************************************************************00760000
007700*  BOOKING REPORT RECORD LAYOUT - EXTRACT FOR THE ERROR REPORT.  *00770000
007800*  IT IS USED TO FORMAT THE ERROR RECORDS.  THEY ARE THEN        *00780000
007900*  WRITTEN TO AN OUTPUT FILE.  THE ERRORS WILL BE COMBINED WITH  *00790000
008000*  ERRORS FROM PROGRAM TRKUP205 AND WILL LATER BE USED AS INPUT  *00800000
008100*  TO THE ERROR REPORT PROGRAM WHICH WILL CREATE AN ERROR REPORT *00810000
008200*  OF BOOKING RECORDS.                                           *00820000
008300******************************************************************00830000
008400     COPY TRRD201.                                                00840000
008500 EJECT                                                            00850000
008600                                                                  00860000
008700     COPY DPWS500.                                                00870000
008800 EJECT                                                            00880000
008900                                                                  00890000
009000 01  PV-TR014-REC-TYP-EDD.                                        00900000
009100     05  PV-TR014-EDD-REC-KEY.                                    00910000
009200         10  PV-TR014-EDD-TRN-TYP          PIC X(01).             00920000
009300         10  PV-TR014-EDD-REC-TYP-CDE      PIC X(06).             00930000
009400         10  PV-TR014-EDD-SEQ-NBR          PIC X(02).             00940000
009500         10  PV-TR014-EDD-3RD-PARTY-CDE    PIC X(06).             00950000
009600         10  PV-TR014-EDD-PO-NBR           PIC 9(09).             00960000
009700         10  PV-TR014-EDD-PO-NBR-X REDEFINES                      00970000
009800             PV-TR014-EDD-PO-NBR           PIC X(09).             00980000
009900         10  PV-TR014-EDD-EXTL-REF-NBR     PIC X(15).             00990000
010000         10  PV-TR014-EDD-PO-BKG-DELY-DTE  PIC X(08).             01000000
010100         10  PV-TR014-EDD-PO-BKG-DELY-TM   PIC X(04).             01010000
010200         10  PV-TR014-EDD-ORGN-SHPD-FR-CDE PIC X(03).             01020000
010300         10  PV-TR014-EDD-IMPRT-TRIP-ID    PIC X(10).             01030000
010400         10  PV-TR014-EDD-CARR-SCAC-ID     PIC X(04).             01040000
010500     05  PV-TR014-EDD-IMPRT-VEH-NM         PIC X(25).             01050000
010600     05  PV-TR014-EDD-POE-DELY-DTE         PIC X(08).             01060000
010700     05  PV-TR014-EDD-POE-DELY-TM          PIC X(04).             01070000
010800     05  PV-TR014-EDD-DPRTR-DTE            PIC X(08).             01080000
010900     05  PV-TR014-EDD-DPRTR-TM             PIC X(04).             01090000
011000     05  PV-TR014-EDD-FOB-CDE              PIC X(05).             01100000
011100     05  PV-TR014-EDD-DEST-POE-CDE         PIC X(04).             01110000
011200     05  PV-TR014-EDD-TRIP-TYP-CDE         PIC X(01).             01120000
011300     05  PV-TR014-EDD-EST-LBD-NM           PIC X(18).             01130000
011400     05  PV-TR014-EDD-FILLER               PIC X(131).            01140000
011410     05  PV-TR014-EDD-FILE-ID              PIC X(09).             01141000
011420     05  PV-TR014-EDD-ENT-ID               PIC 9(09).             01142000
011430     05  PV-TR014-EDD-PROC-SEQ-NBR         PIC 9(06).             01144000
011440                                                                  01160000
011450 01  PV-TR014-REC-TYP-EDDRSN.                                     01170000
011460     05  PV-TR014-EDDRSN-REC-KEY.                                 01180000
011470         10  PV-TR014-EDDRSN-TRN-TYP       PIC X(01).             01190000
011480         10  PV-TR014-EDDRSN-REC-TYP-CDE   PIC X(06).             01200000
011490         10  PV-TR014-EDDRSN-SEQ-NBR       PIC X(02).             01210000
011500         10  PV-TR014-EDDRSN-3RD-PARTY-CDE PIC X(06).             01220000
011600         10  PV-TR014-EDDRSN-PO-NBR        PIC 9(09).             01230000
011700         10  PV-TR014-EDDRSN-PO-NBR-X REDEFINES                   01240000
011800             PV-TR014-EDDRSN-PO-NBR        PIC X(09).             01250000
011900         10  PV-TR014-EDDRSN-EXTL-REF-NBR  PIC X(15).             01260000
012000         10  PV-TR014-EDDRSN-PO-BKG-DELY-DT PIC X(08).            01270000
012100         10  PV-TR014-EDDRSN-PO-BKG-DELY-TM PIC X(04).            01280000
012200         10  PV-TR014-EDDRSN-ORG-SHP-FR-CDE PIC X(03).            01290000
012300         10  PV-TR014-EDDRSN-IMPRT-TRIP-ID PIC X(10).             01300000
012400         10  PV-TR014-EDDRSN-CARR-SCAC-ID  PIC X(04).             01310000
012500     05  PV-TR014-EDDRSN-POE-DELY-DTE      PIC X(08).             01320000
012600     05  PV-TR014-EDDRSN-POE-DELY-TM       PIC X(04).             01330000
012700     05  PV-TR014-EDDRSN-DPRTR-DTE         PIC X(08).             01340000
012800     05  PV-TR014-EDDRSN-DPRTR-TM          PIC X(04).             01350000
012900     05  PV-TR014-EDDRSN-VOY-CHG-RSN-DS    PIC X(30).             01360000
013000     05  PV-TR014-EDDRSN-FILLER            PIC X(154).            01370000
013100     05  PV-TR014-EDDRSN-FILE-ID           PIC X(09).             01371000
013200     05  PV-TR014-EDDRSN-ENT-ID            PIC 9(09).             01372000
013300     05  PV-TR014-EDDRSN-PROC-SEQ-NBR      PIC 9(06).             01374000
013400                                                                  01390000
013500 01  PV-TR014-REC-TYP-EDL.                                        01400000
013600     05  PV-TR014-EDL-REC-KEY.                                    01410000
013700         10  PV-TR014-EDL-TRN-TYP          PIC X(01).             01420000
013800         10  PV-TR014-EDL-REC-TYP-CDE      PIC X(06).             01430000
013900         10  PV-TR014-EDL-SEQ-NBR          PIC X(02).             01440000
014000         10  PV-TR014-EDL-3RD-PARTY-CDE    PIC X(06).             01450000
014100         10  PV-TR014-EDL-PO-NBR           PIC 9(09).             01460000
014200         10  PV-TR014-EDL-PO-NBR-X REDEFINES                      01470000
014300             PV-TR014-EDL-PO-NBR           PIC X(09).             01480000
014400         10  PV-TR014-EDL-EXTL-REF-NBR     PIC X(15).             01490000
014500         10  PV-TR014-EDL-PO-BKG-DELY-DTE  PIC X(08).             01500000
014600         10  PV-TR014-EDL-PO-BKG-DELY-TM   PIC X(04).             01510000
014700         05  PV-TR014-EDL-ORGN-SHPD-FR-CDE PIC X(03).             01520000
014800     05  PV-TR014-EDL-PROD-FCTRY-NM        PIC X(35).             01530000
014900     05  PV-TR014-EDL-C-O-PROD-CDE         PIC X(03).             01540000
015000     05  PV-TR014-EDL-PO-CART-CNT          PIC 9(09).             01550000
015100     05  PV-TR014-EDL-PO-CART-CNT-X REDEFINES                     01560000
015200         PV-TR014-EDL-PO-CART-CNT          PIC X(09).             01570000
015300     05  PV-TR014-EDL-PO-UNT-QTY           PIC 9(09).             01580000
015400     05  PV-TR014-EDL-PO-UNT-QTY-X REDEFINES                      01590000
015500         PV-TR014-EDL-PO-UNT-QTY           PIC X(09).             01600000
015600     05  PV-TR014-EDL-PO-CBMT-QTY          PIC 9(07)V99.          01610000
015700     05  PV-TR014-EDL-PO-CBMT-QTY-X REDEFINES                     01620000
015800         PV-TR014-EDL-PO-CBMT-QTY          PIC X(09).             01630000
015900     05  PV-TR014-EDL-PO-WT-KGRM-QTY       PIC 9(09).             01640000
016000     05  PV-TR014-EDL-PO-WT-KGRM-QTY-X REDEFINES                  01650000
016100         PV-TR014-EDL-PO-WT-KGRM-QTY       PIC X(09).             01660000
016200     05  PV-TR014-EDL-CONSOL-SCAC-ID       PIC X(04).             01670000
016300     05  PV-TR014-EDL-FILLER               PIC X(144).            01680000
016400     05  PV-TR014-EDL-FILE-ID              PIC X(09).             01681000
016500     05  PV-TR014-EDL-ENT-ID               PIC 9(09).             01682000
016600     05  PV-TR014-EDL-PROC-SEQ-NBR         PIC 9(06).             01690000
016700                                                                  01700000
016800 01  PV-TR014-REC-TYP-EDLVS.                                      01710000
016900     05  PV-TR014-EDLVS-REC-KEY.                                  01720000
017000         10  PV-TR014-EDLVS-TRN-TYP        PIC X(01).             01730000
017100         10  PV-TR014-EDLVS-REC-TYP-CDE    PIC X(06).             01740000
017200         10  PV-TR014-EDLVS-SEQ-NBR        PIC X(02).             01750000
017300         10  PV-TR014-EDLVS-3RD-PARTY-CDE  PIC X(06).             01760000
017400         10  PV-TR014-EDLVS-PO-NBR         PIC 9(09).             01770000
017500         10  PV-TR014-EDLVS-PO-NBR-X REDEFINES                    01780000
017600             PV-TR014-EDLVS-PO-NBR         PIC X(09).             01790000
017700         10  PV-TR014-EDLVS-EXTL-REF-NBR   PIC X(15).             01800000
017800         10  PV-TR014-EDLVS-PO-BKG-DELY-DTE PIC X(08).            01810000
017900         10  PV-TR014-EDLVS-PO-BKG-DELY-TM PIC X(04).             01820000
018000         10  PV-TR014-EDLVS-ORG-SHP-FR-CDE PIC X(03).             01830000
018100     05  PV-TR014-EDLVS-VS-NBR             PIC X(20).             01840000
018200     05  PV-TR014-EDLVS-CART-CNT           PIC 9(09).             01850000
018300     05  PV-TR014-EDLVS-CART-CNT-X REDEFINES                      01860000
018400         PV-TR014-EDLVS-CART-CNT           PIC X(09).             01870000
018500     05  PV-TR014-EDLVS-UNT-QTY            PIC 9(09).             01880000
018600     05  PV-TR014-EDLVS-UNT-QTY-X REDEFINES                       01890000
018700         PV-TR014-EDLVS-UNT-QTY            PIC X(09).             01900000
018800     05  PV-TR014-EDLVS-CBMT-QTY           PIC 9(07)V99.          01910000
018900     05  PV-TR014-EDLVS-CBMT-QTY-X REDEFINES                      01920000
019000         PV-TR014-EDLVS-CBMT-QTY           PIC X(09).             01930000
019100     05  PV-TR014-EDLVS-WT-KGRM-QTY        PIC 9(09).             01940000
019200     05  PV-TR014-EDLVS-WT-KGRM-QTY-X REDEFINES                   01950000
019300         PV-TR014-EDLVS-WT-KGRM-QTY        PIC X(09).             01960000
019400     05  PV-TR014-EDLVS-FILLER             PIC X(166).            01970000
019500     05  PV-TR014-EDLVS-FILE-ID            PIC X(09).             01971000
019600     05  PV-TR014-EDLVS-ENT-ID             PIC 9(09).             01972000
019700     05  PV-TR014-EDLVS-PROC-SEQ-NBR       PIC 9(06).             01980000
019800                                                                  01990000
019900 01  PV-TR014-REC-TYP-EDLUPC.                                     02000000
020000     05  PV-TR014-EDLUPC-REC-KEY.                                 02010000
020100         10  PV-TR014-EDLUPC-TRN-TYP       PIC X(01).             02020000
020200         10  PV-TR014-EDLUPC-REC-TYP-CDE   PIC X(06).             02030000
020300         10  PV-TR014-EDLUPC-SEQ-NBR       PIC X(02).             02040000
020400         10  PV-TR014-EDLUPC-3RD-PARTY-CDE PIC X(06).             02050000
020500         10  PV-TR014-EDLUPC-PO-NBR        PIC 9(09).             02060000
020600         10  PV-TR014-EDLUPC-PO-NBR-X REDEFINES                   02070000
020700             PV-TR014-EDLUPC-PO-NBR        PIC X(09).             02080000
020800         10  PV-TR014-EDLUPC-EXTL-REF-NBR  PIC X(15).             02090000
020900         10  PV-TR014-EDLUPC-PO-BKG-DELY-DT  PIC X(08).           02100000
021000         10  PV-TR014-EDLUPC-PO-BKG-DELY-TM  PIC X(04).           02110000
021100         10  PV-TR014-EDLUPC-ORG-SHP-FR-CDE  PIC X(03).           02120000
021200     05  PV-TR014-EDLUPC-VS-NBR            PIC X(20).             02130000
021300     05  PV-TR014-EDLUPC-UPC-NBR           PIC 9(15).             02140000
021400     05  PV-TR014-EDLUPC-UPC-NBR-X REDEFINES                      02150000
021500         PV-TR014-EDLUPC-UPC-NBR           PIC X(15).             02160000
021600     05  PV-TR014-EDLUPC-CART-CNT          PIC 9(09).             02170000
021700     05  PV-TR014-EDLUPC-CART-CNT-X REDEFINES                     02180000
021800         PV-TR014-EDLUPC-CART-CNT          PIC X(09).             02190000
021900     05  PV-TR014-EDLUPC-UNT-QTY           PIC 9(09).             02200000
022000     05  PV-TR014-EDLUPC-UNT-QTY-X REDEFINES                      02210000
022100         PV-TR014-EDLUPC-UNT-QTY           PIC X(09).             02220000
022200     05  PV-TR014-EDLUPC-CBMT-QTY          PIC 9(07)V99.          02230000
022300     05  PV-TR014-EDLUPC-CBMT-QTY-X REDEFINES                     02240000
022400         PV-TR014-EDLUPC-CBMT-QTY          PIC X(09).             02250000
022500     05  PV-TR014-EDLUPC-WT-KGRM-QTY       PIC 9(09).             02260000
022600     05  PV-TR014-EDLUPC-WT-KGRM-QTY-X REDEFINES                  02270000
022700         PV-TR014-EDLUPC-WT-KGRM-QTY       PIC X(09).             02280000
022800     05  PV-TR014-EDLUPC-FILLER            PIC X(151).            02290000
022900     05  PV-TR014-EDLUPC-FILE-ID           PIC X(09).             02291000
022910     05  PV-TR014-EDLUPC-ENT-ID            PIC 9(09).             02292000
022920     05  PV-TR014-EDLUPC-PROC-SEQ-NBR      PIC 9(06).             02300000
022930                                                                  02310000
022940                                                                  02320000
022950 01  ABEND-CODE                      PIC S9(04)    VALUE +0       02330000
022960                                                   COMP SYNC.     02340000
022970 01  PA-PROGRAM-ACCUMULATORS.                                     02350000
022980     05  PA-TOTALS.                                               02360000
022990         10 PA-BKG-INPUT-COUNT        PIC  S9(09)  VALUE +0       02370000
023000                                                     COMP-3.      02380000
023100         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0       02390000
023200                                                     COMP-3.      02400000
023300         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0       02410000
023400                                                     COMP-3.      02420000
023500         10 PA-TOTAL-UPDATE-COUNT     PIC  S9(13)  VALUE +0       02430000
023600                                                     COMP-3.      02440000
023700         10 PA-TOT-BKPO-RECS-ADD      PIC  S9(13)  VALUE +0       02450000
023800                                                     COMP-3.      02460000
023900         10 PA-TOT-BKVS-RECS-ADD      PIC  S9(13)  VALUE +0       02470000
024000                                                     COMP-3.      02480000
024100         10 PA-TOT-BKUP-RECS-ADD      PIC  S9(13)  VALUE +0       02490000
024200                                                     COMP-3.      02500000
024300         10 PA-TOT-EDL-RECS-DELETE    PIC  S9(13)  VALUE +0       02510000
024400                                                     COMP-3.      02520000
024500         10 PA-TOT-BKPO-RECS-CHANGE   PIC  S9(13)  VALUE +0       02530000
024600                                                     COMP-3.      02540000
024700         10 PA-TOT-BKVS-RECS-CHANGE   PIC  S9(13)  VALUE +0       02550000
024800                                                     COMP-3.      02560000
024900         10 PA-TOT-BKUP-RECS-CHANGE   PIC  S9(13)  VALUE +0       02570000
025000                                                     COMP-3.      02580000
025100         10 PA-TOT-BKPO-RECS-CHG-ADD  PIC  S9(13)  VALUE +0       02590000
025200                                                     COMP-3.      02600000
025300         10 PA-TOT-BKVS-RECS-CHG-ADD  PIC  S9(13)  VALUE +0       02610000
025400                                                     COMP-3.      02620000
025500         10 PA-TOT-BKUP-RECS-CHG-ADD  PIC  S9(13)  VALUE +0       02630000
025600                                                     COMP-3.      02640000
025700                                                                  02650000
025800 01  PA-PROGRAM-SWITCHES.                                         02660000
025900     05  PS-END-OF-BOOKINGS-SW         PIC  X(01)    VALUE 'N'.   02670000
026000         88  PS-END-OF-BOOKINGS                      VALUE 'Y'.   02680000
026100         88  PS-END-OF-BOOKINGS-NO                   VALUE 'N'.   02690000
026200     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.   02700000
026300         88  PS-EDIT-ERROR                           VALUE 'Y'.   02710000
026400         88  PS-EDIT-ERROR-NO                        VALUE 'N'.   02720000
026500     05  PS-EDI-RECORD-SW              PIC  X(01)    VALUE 'N'.   02730000
026600         88  PS-EDI-RECORD                           VALUE 'Y'.   02740000
026700         88  PS-EDI-RECORD-NO                        VALUE 'N'.   02750000
026800     05  PS-GOOD-RECORD-SW             PIC  X(01)    VALUE 'N'.   02760000
026900         88  PS-GOOD-RECORD                          VALUE 'Y'.   02770000
027000         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   02780000
027100     05  PS-GOOD-EDD-EDL-WRITE-SW      PIC  X(01)    VALUE 'N'.   02790000
027200         88  PS-GOOD-EDD-EDL-WRITE                   VALUE 'Y'.   02800000
027300         88  PS-GOOD-EDD-EDL-WRITE-NO                VALUE 'N'.   02810000
027400     05  PS-GOOD-EDLVS-WRITE-SW        PIC  X(01)    VALUE 'N'.   02820000
027500         88  PS-GOOD-EDLVS-WRITE                     VALUE 'Y'.   02830000
027600         88  PS-GOOD-EDLVS-WRITE-NO                  VALUE 'N'.   02840000
027700     05  PS-SAME-INPUT-FIELDS-SW       PIC  X(01)    VALUE 'N'.   02850000
027800         88  PS-SAME-INPUT-FIELDS                    VALUE 'Y'.   02860000
027900         88  PS-NOT-SAME-INPUT-FIELDS                VALUE 'N'.   02870000
028000     05  PS-EDD-SENT-SW                PIC  X(01)    VALUE 'N'.   02880000
028100         88  PS-EDD-SENT                             VALUE 'Y'.   02890000
028200         88  PS-EDD-NOT-SENT                         VALUE 'N'.   02900000
028300     05  PS-EDDRSN-SENT-SW             PIC  X(01)    VALUE 'N'.   02910000
028400         88  PS-EDDRSN-SENT                          VALUE 'Y'.   02920000
028500         88  PS-EDDRSN-NOT-SENT                      VALUE 'N'.   02930000
028600     05  PS-EDL-SENT-SW                PIC  X(01)    VALUE 'N'.   02940000
028700         88  PS-EDL-SENT                             VALUE 'Y'.   02950000
028800         88  PS-EDL-NOT-SENT                         VALUE 'N'.   02960000
028900     05  PS-EDLVS-SENT-SW              PIC  X(01)    VALUE 'N'.   02970000
029000         88  PS-EDLVS-SENT                           VALUE 'Y'.   02980000
029100         88  PS-EDLVS-NOT-SENT                       VALUE 'N'.   02990000
029200     05  PS-EDL-DELETE-SENT-SW         PIC  X(01)    VALUE 'N'.   03000000
029300         88  PS-EDL-DELETE-SENT                      VALUE 'Y'.   03010000
029400         88  PS-EDL-DELETE-NOT-SENT                  VALUE 'N'.   03020000
029500     05  PS-NEW-BOOKING-SW             PIC  X(01)    VALUE 'N'.   03030000
029600         88  PS-NEW-BOOKING                          VALUE 'Y'.   03040000
029700         88  PS-NEW-BOOKING-NO                       VALUE 'N'.   03050000
029800     05  PS-NEW-GROUP-SW               PIC  X(01)    VALUE 'N'.   03060000
029900         88  PS-NEW-GROUP                            VALUE 'Y'.   03070000
030000         88  PS-NEW-GROUP-NO                         VALUE 'N'.   03080000
030100     05  PS-NEW-VS-SW                  PIC  X(01)    VALUE 'N'.   03090000
030200         88  PS-NEW-VS                               VALUE 'Y'.   03100000
030300         88  PS-NEW-VS-NO                            VALUE 'N'.   03110000
030400     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.   03120000
030500         88  PS-NEW-UPC                              VALUE 'Y'.   03130000
030600         88  PS-NEW-UPC-NO                           VALUE 'N'.   03140000
030700     05  PS-FIELDS-OK-SW               PIC  X(01)    VALUE 'N'.   03150000
030800         88  PS-FIELDS-OK                            VALUE 'Y'.   03160000
030900         88  PS-FIELDS-NOT-OK                        VALUE 'N'.   03170000
031000     05  PS-WARNING-TIME-SW            PIC  X(01)    VALUE 'N'.   03180000
031100         88  PS-WARNING-TIME                         VALUE 'Y'.   03190000
031200         88  PS-WARNING-TIME-NO                      VALUE 'N'.   03200000
031300     05  PS-WARNING-DATE-SW            PIC  X(01)    VALUE 'N'.   03210000
031400         88  PS-WARNING-DATE                         VALUE 'Y'.   03220000
031500         88  PS-WARNING-DATE-NO                      VALUE 'N'.   03230000
031600     05  PS-ENTNME-SW                  PIC X(01)     VALUE 'Y'.   03240000
031700         88  PS-VALID-ENTNME                         VALUE 'Y'.   03250000
031800         88  PS-INVALID-ENTNME                       VALUE 'N'.   03260000
031900     05  PS-TRN-TYP-ADD-SW             PIC  X(01)    VALUE 'N'.   03270000
032000         88  PS-TRN-TYP-ADD                          VALUE 'Y'.   03280000
032100         88  PS-TRN-TYP-ADD-NO                       VALUE 'N'.   03290000
032200                                                                  03300000
032300 01  PC-PROGRAM-CONSTANTS.                                        03310000
032400     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          03320000
032500         'TRKUT200'.                                              03330000
032600     05  PC-01                       PIC X(02)     VALUE '01'.    03340000
032700     05  PC-10                       PIC X(02)     VALUE '10'.    03350000
032800     05  PC-11                       PIC X(02)     VALUE '11'.    03360000
032900     05  PC-19                       PIC X(02)     VALUE '19'.    03370000
033000     05  PC-20                       PIC X(02)     VALUE '20'.    03380000
033100     05  PC-21                       PIC X(02)     VALUE '21'.    03390000
033200     05  PC-22                       PIC X(02)     VALUE '22'.    03400000
033300     05  PC-98                       PIC X(02)     VALUE '98'.    03410000
033400     05  PC-99                       PIC X(02)     VALUE '99'.    03420000
033500     05  PC-A                        PIC X(01)     VALUE 'A'.     03430000
033600     05  PC-B                        PIC X(01)     VALUE 'B'.     03440000
033700     05  PC-C                        PIC X(01)     VALUE 'C'.     03450000
033800     05  PC-D                        PIC X(01)     VALUE 'D'.     03460000
033900     05  PC-E                        PIC X(01)     VALUE 'E'.     03470000
034000     05  PC-M                        PIC X(01)     VALUE 'M'.     03480000
034100     05  PC-O                        PIC X(01)     VALUE 'O'.     03490000
034200     05  PC-Z                        PIC X(01)     VALUE 'Z'.     03500000
034300     05  PC-A0                       PIC X(02)     VALUE 'A0'.    03510000
034400     05  PC-CFS                      PIC X(03)     VALUE 'CFS'.   03520000
034500     05  PC-CY                       PIC X(02)     VALUE 'CY'.    03530000
034600     05  PC-OCS                      PIC 9(09)     VALUE          03531000
034700                                                    000030692.    03532000
034800                                                                  03540000
034900     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.   03550000
035000     05  PC-IEA                      PIC X(06)     VALUE 'IEA   '.03560000
035100     05  PC-EDD                      PIC X(06)     VALUE 'EDD   '.03570000
035200     05  PC-EDDRSN                   PIC X(06)     VALUE 'EDDRSN'.03580000
035300     05  PC-EDL                      PIC X(06)     VALUE 'EDL   '.03590000
035400     05  PC-EDLVS                    PIC X(06)     VALUE 'EDLVS '.03600000
035500     05  PC-EDLUPC                   PIC X(06)     VALUE 'EDLUPC'.03610000
035600                                                                  03620000
035700     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   03630000
035800     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   03640000
035900     05  PC-EMPTY                    PIC X(03)     VALUE 'EMT'.   03650000
036000     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.03660000
036100     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.   03670000
036200     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.   03680000
036300     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.   03690000
036400     05  PC-DASH                     PIC X(01)     VALUE '-'.     03700000
036500     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE          03710000
036600                                     '9999-09-09-00.00.00.000000'.03720000
036700     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          03730000
036800                                     '0001-01-01-00.00.00.000000'.03740000
036900     05  PC-DEFAULT-DTE              PIC X(10)     VALUE          03750000
037000                                     '0001-01-01'.                03760000
037100     05  PC-DEFAULT-DATE             PIC X(08)     VALUE          03770000
037200                                     '00010101'.                  03780000
037300     05  PC-DEFAULT-TIME             PIC X(04)     VALUE          03790000
037400                                     '0000'.                      03800000
037500     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       03810000
037600                                                     COMP-3.      03820000
037700                                                                  03830000
037800 01  PV-PROGRAM-VARIABLES.                                        03840000
037900     05  PV-BKG-DELY-DTE             PIC X(08)     VALUE SPACES.  03850000
038000     05  PV-BKG-DELY-TM              PIC X(04)     VALUE SPACES.  03860000
038100     05  PV-HOLD-DPRTR-DTE           PIC X(08)     VALUE SPACES.  03870000
038200     05  PV-HOLD-DPRTR-TM            PIC X(04)     VALUE SPACES.  03880000
038300     05  PV-HOLD-POE-DELY-DTE        PIC X(08)     VALUE SPACES.  03890000
038400     05  PV-HOLD-POE-DELY-TM         PIC X(04)     VALUE SPACES.  03900000
038500     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0       03910000
038600                                                   COMP.          03920000
038700     05  PV-ENT-ID-SIGNED            PIC S9(09)    VALUE +0       03921000
038800                                                   COMP.          03922000
038900     05  PV-VEND-ID-QUAL             PIC X(02)     VALUE SPACES.  03930000
039000     05  PV-VEND-ID                  PIC X(15)     VALUE SPACES.  03940000
039100     05  PV-HOLD-TR201-RPT-TYP       PIC X(01)     VALUE SPACES.  03950000
039200     05  PV-HOLD-TR201-REC-TYP       PIC X(06).                   03960000
039300         88  PV-HOLD-TR201-REC-TYP-EDD             VALUE 'EDD   '.03970000
039400         88  PV-HOLD-TR201-REC-TYP-EDDRSN          VALUE 'EDDRSN'.03980000
039500         88  PV-HOLD-TR201-REC-TYP-EDL             VALUE 'EDL   '.03990000
039600         88  PV-HOLD-TR201-REC-TYP-EDLVS           VALUE 'EDLVS '.04000000
039700         88  PV-HOLD-TR201-REC-TYP-EDLUPC          VALUE 'EDLUPC'.04010000
039800     05  PV-HOLD-TR201-PO-NBR        PIC 9(09).                   04020000
039900     05  PV-HOLD-TR201-PO-NBR-X REDEFINES                         04030000
040000         PV-HOLD-TR201-PO-NBR        PIC X(09).                   04040000
040100     05  PV-HOLD-TR201-EXTL-REF-NBR  PIC X(15)     VALUE SPACES.  04050000
040200     05  PV-HOLD-TR201-PO-BKG-DELY-DTE PIC X(08)   VALUE SPACES.  04060000
040300     05  PV-HOLD-TR201-PO-BKG-DELY-TM  PIC X(04)   VALUE SPACES.  04070000
040400     05  PV-HOLD-TR201-ORGN-SHPD-FR-CDE PIC X(03)  VALUE SPACES.  04080000
040500     05  PV-HOLD-TR201-TRN-TYP       PIC X(01)     VALUE SPACES.  04090000
040600     05  PV-HOLD-TR201-DATA-IN-ERROR PIC X(15)     VALUE SPACES.  04100000
040700     05  PV-HOLD-TR201-ERROR-TYPE     PIC X(03)    VALUE SPACES.  04110000
040800     05  PV-HOLD-TR201-DATA-VALUE-NUM.                            04120000
040900         10 PV-HOLD-TR201-DATA-VALUE-X PIC 9(02)   VALUE ZEROES.  04130000
041000         10 PV-HOLD-TR201-DATA-VALUE-N PIC 9(15)V9(3) VALUE ZERO. 04140000
041100     05  PV-HOLD-TR201-DATA-VALUE REDEFINES                       04150000
041200         PV-HOLD-TR201-DATA-VALUE-NUM PIC X(20).                  04160000
041300     05  PV-HOLD-TR201-ERROR-MSG      PIC X(50)    VALUE SPACES.  04170000
041400     05  PV-HOLD-TR201-DAT-SRC-ENT-ID PIC X(09)    VALUE SPACES.  04171000
041500                                                                  04180000
041600     05  PV-HOLD-PO-NBR-SELECT       PIC S9(09)    VALUE ZEROS    04190000
041700                                                   COMP.          04200000
041800     05  PV-EXTL-REF-NBR-SELECT      PIC X(15)     VALUE SPACES.  04210000
041900     05  PV-HOLD-UPC-NBR-SELECT      PIC S9(15)V   VALUE ZEROS    04220000
042000                                                   COMP-3.        04230000
042100     05  PV-HOLD-PO-NBR              PIC S9(09).                  04240000
042200     05  PV-HOLD-PO-NBR-X REDEFINES                               04250000
042300         PV-HOLD-PO-NBR              PIC X(09).                   04260000
042400     05  PV-HOLD-EXTL-REF-NBR        PIC X(15)     VALUE SPACES.  04270000
042500     05  PV-HOLD-PO-BKG-DELY-DTE     PIC X(08)     VALUE SPACES.  04280000
042600     05  PV-HOLD-PO-BKG-DELY-TM      PIC X(04)     VALUE SPACES.  04290000
042700     05  PV-HOLD-ORGN-SHPD-FR-CDE    PIC X(03)     VALUE SPACES.  04300000
042800     05  PV-HOLD-VS-NBR              PIC X(20)     VALUE SPACES.  04310000
042900     05  PV-HOLD-UPC-NBR             PIC S9(15)V   VALUE ZEROS    04320000
043000                                                   COMP-3.        04330000
043100     05  PV-HOLD-LAST-TRN-TYP        PIC X(01)     VALUE SPACES.  04340000
043200     05  PV-HOLD-LAST-REC-TYP        PIC X(06)     VALUE SPACES.  04350000
043300                                                                  04380000
043400     05  PV-EVAL-TRN-TYP-CDE         PIC X(01).                   04390000
043500         88  TRN-TYP-ADD                           VALUE 'A'.     04400000
043600         88  TRN-TYP-CHG                           VALUE 'C'.     04410000
043700         88  TRN-TYP-DEL                           VALUE 'D'.     04420000
043800                                                                  04430000
043900     05  PV-HOLD-REC-TYP-CDE         PIC X(06).                   04440000
044000         88  REC-TYP-EDD                           VALUE 'EDD   '.04450000
044100         88  REC-TYP-EDDRSN                        VALUE 'EDDRSN'.04460000
044200         88  REC-TYP-EDL                           VALUE 'EDL   '.04470000
044300         88  REC-TYP-EDLVS                         VALUE 'EDLVS '.04480000
044400         88  REC-TYP-EDLUPC                        VALUE 'EDLUPC'.04490000
044500         88  REC-TYP-EDD-EDL                       VALUE 'EDD   ',04500000
044600                                                         'EDDRSN',04510000
044700                                                         'EDL   '.04520000
044800                                                                  04530000
044900     05  PV-CHECK-REC-TYP-CDE        PIC X(06).                   04540000
045000         88  VALID-REC-TYP-CDE                     VALUE 'EDD   ',04550000
045100                                                         'EDDRSN',04560000
045200                                                         'EDL   ',04570000
045300                                                         'EDLVS ',04580000
045400                                                         'EDLUPC',04590000
045500                                                         'CTT   ',04600000
045600                                                         'IEA   ',04610000
045700                                                         'ISA   '.04620000
045800     05  PV-EDI-RECORDS              PIC  X(03).                  04630000
045900         88  EDI-RECORD                            VALUE 'CTT',   04640000
046000                                                         'IEA',   04650000
046100                                                         'ISA'.   04660000
046200         88  EDI-IEA-RECORD                        VALUE 'IEA'.   04670000
046300                                                                  04680000
046400     05  PV-HOLD-EDI-RECORD.                                      04690000
046500         10  FILLER                  PIC X(32)     VALUE SPACES.  04700000
046600         10  PV-EDI-VEND-ID-QUAL     PIC X(02)     VALUE SPACES.  04710000
046700         10  FILLER                  PIC X(01)     VALUE SPACES.  04720000
046800         10  PV-EDI-VEND-ID          PIC X(15)     VALUE SPACES.  04730000
046900         10  FILLER                  PIC X(20)     VALUE SPACES.  04740000
047000         10  PV-EDI-CONSOL-TRNS-DTE  PIC X(06)     VALUE SPACES.  04750000
047100         10  FILLER                  PIC X(01)     VALUE SPACES.  04760000
047200         10  PV-EDI-CONSOL-TRNS-TM   PIC X(04)     VALUE SPACES.  04770000
047300         10  FILLER                  PIC X(09)     VALUE SPACES.  04780000
047400         10  PV-EDI-CONSOL-FIL-ID    PIC X(09)     VALUE SPACES.  04790000
047500         10  FILLER                  PIC X(51)     VALUE SPACES.  04800000
047600         10  PV-INPUT-FILE-ID        PIC X(09)     VALUE SPACES.  04801000
047700         10  PV-INPUT-ENT-ID         PIC X(09)     VALUE SPACES.  04802000
047800         10  PV-INPUT-ENT-ID-9  REDEFINES                         04802100
047900             PV-INPUT-ENT-ID         PIC 9(09).                   04802200
048000         10  FILLER                  PIC X(132)    VALUE SPACES.  04803000
048100                                                                  04810000
048200     05  PV-TMST                     PIC X(26)     VALUE SPACES.  04820000
048300     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  04830000
048400     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  04840000
048500     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       04850000
048600                                                    COMP SYNC.    04860000
048700                                                                  04870000
048800     05  PV-FORMAT-TMST.                                          04880000
048900         10  PV-FORMAT-TMST-DTE.                                  04890000
049000             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  04900000
049100             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     04910000
049200             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  04920000
049300             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     04930000
049400             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  04940000
049500             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     04950000
049600         10  PV-FORMAT-TMST-TM.                                   04960000
049700             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  04970000
049800             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     04980000
049900             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  04990000
050000             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          05000000
050100                                                     '.00.000000'.05010000
050200     05  PV-FORMAT-BKDT.                                          05020000
050300         10  PV-FORMAT-BKDT-DTE-CY  PIC X(04)  VALUE SPACES.      05030000
050400         10  PV-FORMAT-BKDT-DTE-D1  PIC X(01)  VALUE '-'.         05040000
050500         10  PV-FORMAT-BKDT-DTE-MM  PIC X(02)  VALUE SPACES.      05050000
050600         10  PV-FORMAT-BKDT-DTE-D2  PIC X(01)  VALUE '-'.         05060000
050700         10  PV-FORMAT-BKDT-DTE-DD  PIC X(02)  VALUE SPACES.      05070000
050800         10  PV-FORMAT-BKDT-DTE-D3  PIC X(01)  VALUE '-'.         05080000
050900         10  PV-FORMAT-BKDT-TM-HH   PIC X(02)  VALUE SPACES.      05090000
051000         10  PV-FORMAT-BKDT-TM-D1   PIC X(01)  VALUE '.'.         05100000
051100         10  PV-FORMAT-BKDT-TM-MM   PIC X(02)  VALUE SPACES.      05110000
051200         10  PV-FORMAT-BKDT-TM-D2   PIC X(10)  VALUE '.00.000000'.05120000
051300                                                                  05130000
051400     05  PV-REFORMAT-TMST.                                        05140000
051500         10  PV-REFORMAT-TMST-DTE.                                05150000
051600             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.05160000
051700             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.05170000
051800             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.05180000
051900         10  PV-REFORMAT-TMST-TM.                                 05190000
052000             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.05200000
052100             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.05210000
052200                                                                  05220000
052300     05  PV-HDR-CONSOL-TRNS-DTE.                                  05230000
052400         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.05240000
052500         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.05250000
052600                                                                  05260000
052700******************************************************************05270000
052800 LINKAGE SECTION.                                                 05280000
052900******************************************************************05290000
053000                                                                  05300000
053100******************************************************************05310000
053200 PROCEDURE DIVISION.                                              05320000
053300******************************************************************05330000
053400******************************************************************05340000
053500*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *05350000
053600******************************************************************05360000
053700 0000-PROGRAM-MAINLINE.                                           05370000
053800                                                                  05380000
053900     PERFORM 1000-INITIALIZE.                                     05390000
054000                                                                  05400000
054100     PERFORM 2000-PROCESS-BKG-RECORDS                             05410000
054200         UNTIL PS-END-OF-BOOKINGS.                                05420000
054300                                                                  05430000
054400     PERFORM 8000-EOJ-ROUTINE.                                    05440000
054500     STOP RUN.                                                    05450000
054600                                                                  05460000
054700******************************************************************05470000
054800*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *05480000
054900*  JOB PROCESSES.                                                *05490000
055000******************************************************************05500000
055100 1000-INITIALIZE.                                                 05510000
055200                                                                  05520000
055300     OPEN INPUT TR014-BOOKING-FILE                                05530000
055400         OUTPUT TR024-UPDATE-BOOKING-FILE                         05540000
055500                TR201-BOOKING-ERROR-FILE.                         05550000
055600                                                                  05560000
055700     SET PS-GOOD-RECORD-NO TO TRUE.                               05570000
055800                                                                  05580000
055900     MOVE PC-IEA TO PV-HOLD-LAST-REC-TYP.                         05590000
056000                                                                  05600000
056100     PERFORM 6000-READ-BOOKING-FILE                               05610000
056200         UNTIL PS-GOOD-RECORD OR PS-END-OF-BOOKINGS.              05620000
056300     SET PS-GOOD-RECORD-NO TO TRUE.                               05630000
056400                                                                  05640000
056500     IF PS-END-OF-BOOKINGS                                        05650000
056600         MOVE PC-EMPTY       TO PV-HOLD-TR201-ERROR-TYPE          05660000
056700     END-IF.                                                      05670000
056800                                                                  05680000
056900 EJECT                                                            05690000
057000******************************************************************05700000
057100* MAIN PROCESSING PARAGRAPH.                                     *05710000
057200* THE INCOMING RECORD TYPE CODE IS EVALUATED AND PROCESSED AS    *05720000
057300* FOLLOWS:                                                       *05730000
057400*  REC-TYP-EDD-EDL (EDD, EDDRSN, & EDL)                          *05740000
057500*       THESE RECORD TYPES PERFORM THE PURCHASE ORDER LEVEL      *05750000
057600*       PROCESSING PARAGRAPHS (PARA 3000- THRU 3125-) DEPENDING  *05760000
057700*       ON WHAT TRANS TYPE THEY ARE (ADD, CHANGE, OR DELETE).    *05770000
057800*                                                                *05780000
057900*  REC-TYP-EDLVS                                                 *05790000
058000*       THIS RECORD TYPE PERFORMS THE VENDOR STYLE LEVEL         *05800000
058100*       PROCESSING PARAGRAPHS (PARA 3200- THRU 3300-) DEPENDING  *05810000
058200*       ON WHAT TRAN TYPE IT IS (ADD, CHANGE, OR DELETE).        *05820000
058300*       FOR THIS RECORD TYPE TO BEGIN PROCESSING THE             *05830000
058400*       FOLLOWING CONDITIONS MUST BE MET:                        *05840000
058500*        -- A GOOD WRITE TO THE EDITED UPDATE EXTRACT FILE MUST  *05850000
058600*           HAVE OCCURED FOR THE EDD AND EDL RECORDS.            *05860000
058700*             IF NOT -- AN ERROR FOR EACH RECORD BELONGING TO    *05870000
058800*                       THIS PO IS WRITTEN TO THE ERROR FILE AS  *05880000
058900*                       THE PROGRAM READS TO THE NEXT PO.        *05890000
059000*        -- CERTAIN KEY NUMERIC FIELDS ARE EDITED AND MUST PASS  *05900000
059100*           THE EDIT CONDITIONS                                  *05910000
059200*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *05920000
059300*                       AND THE PROGRAM READS TO THE NEXT VS.    *05930000
059400*        -- THE PO NBR, EXTERNAL REFERENCE NUMBER, TRAN TYPE,    *05940000
059500*           BOOKING DELIVERY DATE/TIME, AND ORIGIN SHIPPED FROM  *05950000
059600*           CODE OF THE INCOMING RECORD MUST EQUAL THE HOLD      *05960000
059700*           FIELDS                                               *05970000
059800*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *05980000
059900*                       AND THE PROGRAM READS TO THE NEXT VS.    *05990000
060000*                                                                *06000000
060100*  REC-TYP-EDLUPC                                                *06010000
060200*       THESE RECORD TYPES PERFORM THE UPC LEVEL PROCESSING      *06020000
060300*       PARAGRAPHS (PARA 3400- THRU 3485-) DEPENDING ON WHAT     *06030000
060400*       TRAN TYPE THEY ARE (ADD, CHANGE, OR DELETE).             *06040000
060500*       FOR THIS RECORD TYPE TO BEGIN PROCESSING THE             *06050000
060600*       FOLLOWING CONDITIONS MUST BE MET:                        *06060000
060700*        -- A GOOD WRITE TO THE EDITED UPDATE EXTRACT FILE MUST  *06070000
060800*           HAVE OCCURED FOR THE EDD AND EDL RECORDS.            *06080000
060900*             IF NOT -- AN ERROR FOR EACH RECORD BELONGING TO    *06090000
061000*                       THIS PO IS WRITTEN TO THE ERROR FILE AS  *06100000
061100*                       THE PROGRAM READS TO THE NEXT PO.        *06110000
061200*        -- A GOOD WRITE TO THE EDITED UPDATE EXTRACT FILE MUST  *06120000
061300*           HAVE OCCURED FOR THE EDLVS RECORDS.                  *06130000
061400*             IF NOT -- AN ERROR FOR EACH RECORD BELONGING TO    *06140000
061500*                       THIS VS IS WRITTEN TO THE ERROR FILE AS  *06150000
061600*                       THE PROGRAM READS TO THE NEXT VS.        *06160000
061700*        -- CERTAIN KEY NUMERIC FIELDS ARE EDITED AND MUST PASS  *06170000
061800*           THE EDIT CONDITIONS                                  *06180000
061900*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *06190000
062000*                       AND THE PROGRAM READS TO THE NEXT UPC.   *06200000
062100*        -- THE PO NBR, EXTERNAL REFERENCE NUMBER, TRAN TYPE,    *06210000
062200*           BOOKING DELIVERY DATE/TIME, ORIGIN SHIPPED FROM CODE *06220000
062300*           AND VS NBR OF THE INCOMING RECORD MUST EQUAL THE     *06230000
062400*           HOLD FIELDS                                          *06240000
062500*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *06250000
062600*                       AND THE PROGRAM READS TO THE NEXT UPC.   *06260000
062700******************************************************************06270000
062800 2000-PROCESS-BKG-RECORDS.                                        06280000
062900                                                                  06290000
063000     MOVE TR014-EDD-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    06300000
063100                                                                  06310000
063200     EVALUATE TRUE                                                06320000
063300                                                                  06330000
063400        WHEN REC-TYP-EDD-EDL                                      06340000
063500            PERFORM 4100-EDIT-EDD-EDL-KEY-FIELDS                  06350000
063600            IF PS-FIELDS-OK                                       06360000
063700                PERFORM 3000-PROCESS-EDD-EDL-REC                  06370000
063800                SET PS-FIELDS-NOT-OK  TO TRUE                     06380000
063900            ELSE                                                  06390000
064000                PERFORM 4000-MOVE-TO-EDD-HOLD                     06400000
064100                SET PS-EDI-RECORD-NO TO TRUE                      06410000
064200                PERFORM 3017-PROCESS-EDD-EDL-ERROR                06420000
064300                    UNTIL PS-NEW-BOOKING  OR                      06430000
064400                          PS-END-OF-BOOKINGS                      06440000
064500                SET PS-NEW-BOOKING-NO TO TRUE                     06450000
064600            END-IF                                                06460000
064700                                                                  06470000
064800        WHEN REC-TYP-EDLVS                                        06480000
064900            IF PS-GOOD-EDD-EDL-WRITE                              06490000
065000                PERFORM 4110-EDIT-EDLVS-KEY-FIELDS                06500000
065100                IF PS-FIELDS-OK                                   06510000
065200                    PERFORM 4250-CHECK-EDD-EDL-HOLD-FIELDS        06520000
065300                    SET PS-FIELDS-NOT-OK  TO TRUE                 06530000
065400                    IF PS-SAME-INPUT-FIELDS                       06540000
065500                        PERFORM 3200-PROCESS-EDLVS-REC            06550000
065600                    ELSE                                          06560000
065700                        PERFORM 4300-DIFFERENT-INPUT-FIELDS       06570000
065800                        PERFORM 4010-MOVE-TO-EDLVS-HOLD           06580000
065900                        SET PS-EDI-RECORD-NO TO TRUE              06590000
066000                        PERFORM 3217-PROCESS-EDLVS-ERROR          06600000
066100                            UNTIL PS-NEW-VS  OR                   06610000
066200                                  PS-END-OF-BOOKINGS              06620000
066300                        SET PS-NEW-VS-NO    TO TRUE               06630000
066400                    END-IF                                        06640000
066500                ELSE                                              06650000
066600                    PERFORM 4010-MOVE-TO-EDLVS-HOLD               06660000
066700                    SET PS-EDI-RECORD-NO TO TRUE                  06670000
066800                    PERFORM 3217-PROCESS-EDLVS-ERROR              06680000
066900                        UNTIL PS-NEW-VS  OR                       06690000
067000                              PS-END-OF-BOOKINGS                  06700000
067100                    SET PS-NEW-VS-NO    TO TRUE                   06710000
067200                END-IF                                            06720000
067300            ELSE                                                  06730000
067400                PERFORM 4200-EDD-EDL-DATA-MISSING-ERR             06740000
067500                SET PS-EDI-RECORD-NO TO TRUE                      06750000
067600                PERFORM 4000-MOVE-TO-EDD-HOLD                     06760000
067700                PERFORM 3017-PROCESS-EDD-EDL-ERROR                06770000
067800                    UNTIL PS-NEW-BOOKING   OR                     06780000
067900                          PS-END-OF-BOOKINGS                      06790000
068000                SET PS-NEW-BOOKING-NO TO TRUE                     06800000
068100            END-IF                                                06810000
068200                                                                  06820000
068300        WHEN REC-TYP-EDLUPC                                       06830000
068400            IF PS-GOOD-EDD-EDL-WRITE  AND                         06840000
068500               PS-GOOD-EDLVS-WRITE                                06850000
068600                PERFORM 4120-EDIT-EDLUPC-KEY-FIELDS               06860000
068700                IF PS-FIELDS-OK                                   06870000
068800                    PERFORM 4260-CHECK-EDLVS-HOLD-FIELDS          06880000
068900                    SET PS-FIELDS-NOT-OK  TO TRUE                 06890000
069000                    IF PS-SAME-INPUT-FIELDS                       06900000
069100                        PERFORM 3400-PROCESS-EDLUPC-REC           06910000
069200                    ELSE                                          06920000
069300                        PERFORM 4300-DIFFERENT-INPUT-FIELDS       06930000
069400                        PERFORM 4020-MOVE-TO-EDLUPC-HOLD          06940000
069500                        SET PS-EDI-RECORD-NO TO TRUE              06950000
069600                        PERFORM 3417-PROCESS-EDLUPC-ERROR         06960000
069700                            UNTIL PS-NEW-UPC OR                   06970000
069800                                  PS-END-OF-BOOKINGS              06980000
069900                        SET PS-NEW-UPC-NO   TO TRUE               06990000
070000                    END-IF                                        07000000
070100                ELSE                                              07010000
070200                    PERFORM 4020-MOVE-TO-EDLUPC-HOLD              07020000
070300                    SET PS-EDI-RECORD-NO TO TRUE                  07030000
070400                    PERFORM 3417-PROCESS-EDLUPC-ERROR             07040000
070500                        UNTIL PS-NEW-UPC OR                       07050000
070600                              PS-END-OF-BOOKINGS                  07060000
070700                    SET PS-NEW-UPC-NO   TO TRUE                   07070000
070800                END-IF                                            07080000
070900            ELSE                                                  07090000
071000                IF PS-GOOD-EDD-EDL-WRITE-NO                       07100000
071100                    PERFORM 4200-EDD-EDL-DATA-MISSING-ERR         07110000
071200                    SET PS-EDI-RECORD-NO TO TRUE                  07120000
071300                    PERFORM 4000-MOVE-TO-EDD-HOLD                 07130000
071400                    PERFORM 3017-PROCESS-EDD-EDL-ERROR            07140000
071500                        UNTIL PS-NEW-BOOKING   OR                 07150000
071600                              PS-END-OF-BOOKINGS                  07160000
071700                    SET PS-NEW-BOOKING-NO TO TRUE                 07170000
071800                ELSE                                              07180000
071900                    IF PS-GOOD-EDLVS-WRITE-NO                     07190000
072000                        PERFORM 4210-EDLVS-DATA-MISSING-ERR       07200000
072100                        SET PS-EDI-RECORD-NO TO TRUE              07210000
072200                        PERFORM 4010-MOVE-TO-EDLVS-HOLD           07220000
072300                        PERFORM 3217-PROCESS-EDLVS-ERROR          07230000
072400                            UNTIL PS-NEW-VS       OR              07240000
072500                                  PS-END-OF-BOOKINGS              07250000
072600                        SET PS-NEW-VS-NO TO TRUE                  07260000
072700                    END-IF                                        07270000
072800                END-IF                                            07280000
072900            END-IF                                                07290000
073000     END-EVALUATE.                                                07300000
073100                                                                  07310000
073200******************************************************************07320000
073300* PROCESS THE EDD, EDDRSN, AND EDL RECORDS.                      *07330000
073400* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *07340000
073500******************************************************************07350000
073600 3000-PROCESS-EDD-EDL-REC.                                        07360000
073700                                                                  07370000
073800     PERFORM 4000-MOVE-TO-EDD-HOLD.                               07380000
073900                                                                  07390000
074000     MOVE TR014-EDD-TRN-TYP           TO PV-EVAL-TRN-TYP-CDE.     07400000
074100                                                                  07410000
074200     EVALUATE TRUE                                                07420000
074300                                                                  07430000
074400         WHEN TRN-TYP-ADD                                         07440000
074500             PERFORM 3010-PROCESS-EDD-ADD-CHG                     07450000
074600                                                                  07460000
074700         WHEN TRN-TYP-CHG                                         07470000
074800             PERFORM 3010-PROCESS-EDD-ADD-CHG                     07480000
074900                                                                  07490000
075000         WHEN TRN-TYP-DEL                                         07500000
075100             PERFORM 3100-PROCESS-EDL-DEL                         07510000
075200             PERFORM 3125-CHECK-SPIN-FIELDS                       07520000
075300                                                                  07530000
075400         WHEN OTHER                                               07540000
075500             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            07550000
075600             MOVE TR014-EDD-PO-NBR               TO               07560000
075700                   PV-HOLD-TR201-PO-NBR                           07570000
075800             MOVE TR014-EDD-EXTL-REF-NBR         TO               07580000
075900                   PV-HOLD-TR201-EXTL-REF-NBR                     07590000
076000             MOVE TR014-EDD-PO-BKG-DELY-DTE      TO               07600000
076100                   PV-HOLD-TR201-PO-BKG-DELY-DTE                  07610000
076200             MOVE TR014-EDD-PO-BKG-DELY-TM       TO               07620000
076300                   PV-HOLD-TR201-PO-BKG-DELY-TM                   07630000
076400             MOVE TR014-EDD-ORGN-SHPD-FR-CDE     TO               07640000
076500                   PV-HOLD-TR201-ORGN-SHPD-FR-CDE                 07650000
076600             MOVE TR014-EDD-TRN-TYP              TO               07660000
076700                   PV-HOLD-TR201-DATA-VALUE                       07670000
076800                   PV-HOLD-TR201-TRN-TYP                          07680000
076900             MOVE 'TRAN TYPE EDD '               TO               07690000
077000                   PV-HOLD-TR201-DATA-IN-ERROR                    07700000
077100             MOVE 'INVALID TRAN TYPE'            TO               07710000
077200                   PV-HOLD-TR201-ERROR-MSG                        07720000
077300             SET PS-EDI-RECORD-NO     TO TRUE                     07730000
077400             PERFORM 3017-PROCESS-EDD-EDL-ERROR                   07740000
077500                 UNTIL PS-NEW-BOOKING    OR                       07750000
077600                       PS-END-OF-BOOKINGS                         07760000
077700             SET PS-NEW-BOOKING-NO  TO TRUE                       07770000
077800                                                                  07780000
077900     END-EVALUATE.                                                07790000
078000******************************************************************07800000
078100* PROCESS EDD, EDDRSN, & EDL RECORD ADD AND CHANGE TRANSACTIONS. *07810000
078200* PARAGRAPH PERFORMS PARA 3015- WHICH SETS SWITCHES DEPENDING    *07820000
078300* ON WHICH EDD, EDDRSN, EDL RECORDS WERE SENT TO US.  THESE      *07830000
078400* SWITCHES ARE CHECKED HERE TO DETERMINE IF WE NEED TO WRITE AN  *07840000
078500* ERROR OR A WARNING TO THE ERROR FILE, OR IF WE NEED TO WRITE   *07850000
078600* AN EDITED UPDATE RECORD TO THE UPDATE FILE.                    *07860000
078700******************************************************************07870000
078800 3010-PROCESS-EDD-ADD-CHG.                                        07880000
078900                                                                  07890000
079000     SET PS-NEW-GROUP-NO TO TRUE.                                 07900000
079100                                                                  07910000
079200     PERFORM 3018-RESET-EDD-SWITCHES.                             07920000
079300                                                                  07930000
079400     IF TR014-EDD-TRN-TYP = PC-A                                  07940000
079500         SET PS-TRN-TYP-ADD TO TRUE                               07950000
079600         PERFORM 3015-PROCESS-EDD-ADD-EDD                         07960000
079700             UNTIL (TR014-EDD-TRN-TYP           NOT = PC-A) OR    07970000
079800                   (TR014-EDD-PO-NBR-X          NOT =             07980000
079900                    PV-HOLD-PO-NBR-X)                       OR    07990000
080000                   (TR014-EDD-EXTL-REF-NBR      NOT =             08000000
080100                    PV-HOLD-EXTL-REF-NBR)                   OR    08010000
080200                   (TR014-EDD-PO-BKG-DELY-DTE   NOT =             08020000
080300                    PV-HOLD-PO-BKG-DELY-DTE)                OR    08030000
080400                   (TR014-EDD-ORGN-SHPD-FR-CDE  NOT =             08040000
080500                    PV-HOLD-ORGN-SHPD-FR-CDE)               OR    08050000
080600                   (TR014-EDD-REC-TYP-CDE       NOT =             08060000
080700                    PC-EDD AND PC-EDDRSN AND PC-EDL)              08070000
080800                   OR PS-NEW-GROUP                                08080000
080900                   OR PS-END-OF-BOOKINGS                          08090000
081000     ELSE                                                         08100000
081100     IF TR014-EDD-TRN-TYP = PC-C                                  08110000
081200         PERFORM 3015-PROCESS-EDD-ADD-EDD                         08120000
081300             UNTIL (TR014-EDD-TRN-TYP           NOT = PC-C) OR    08130000
081400                   (TR014-EDD-PO-NBR-X          NOT =             08140000
081500                    PV-HOLD-PO-NBR-X)                       OR    08150000
081600                   (TR014-EDD-EXTL-REF-NBR      NOT =             08160000
081700                    PV-HOLD-EXTL-REF-NBR)                   OR    08170000
081800                   (TR014-EDD-PO-BKG-DELY-DTE   NOT =             08180000
081900                    PV-HOLD-PO-BKG-DELY-DTE)                OR    08190000
082000                   (TR014-EDD-ORGN-SHPD-FR-CDE  NOT =             08200000
082100                    PV-HOLD-ORGN-SHPD-FR-CDE)               OR    08210000
082200                   (TR014-EDD-REC-TYP-CDE       NOT =             08220000
082300                    PC-EDD AND PC-EDDRSN AND PC-EDL)              08230000
082400                   OR PS-NEW-GROUP                                08240000
082500                   OR PS-END-OF-BOOKINGS                          08250000
082600     END-IF.                                                      08260000
082700                                                                  08270000
082800     IF PS-TRN-TYP-ADD                                            08280000
082900         MOVE PC-A            TO PV-HOLD-TR201-TRN-TYP            08290000
083000     ELSE                                                         08300000
083100         MOVE PC-C            TO PV-HOLD-TR201-TRN-TYP            08310000
083200     END-IF.                                                      08320000
083300     SET PS-TRN-TYP-ADD-NO    TO TRUE.                            08330000
083400                                                                  08340000
083500     IF  PS-EDD-SENT AND PS-EDL-SENT                              08350000
083600          SET PS-GOOD-EDD-EDL-WRITE TO TRUE                       08360000
083700          PERFORM 5300-LOAD-EDD-FIELDS-UPDATE                     08370000
083800          IF PS-EDIT-ERROR                                        08380000
083900              PERFORM 3017-PROCESS-EDD-EDL-ERROR                  08390000
084000                  UNTIL PS-NEW-BOOKING  OR                        08400000
084100                        PS-END-OF-BOOKINGS                        08410000
084200              SET PS-EDIT-ERROR-NO  TO TRUE                       08420000
084300              SET PS-NEW-BOOKING-NO TO TRUE                       08430000
084400          ELSE                                                    08440000
084500              EVALUATE PV-TR014-EDD-TRN-TYP                       08450000
084600                  WHEN PC-C                                       08460000
084700                      ADD +1 TO PA-TOT-BKPO-RECS-CHANGE           08470000
084800                  WHEN PC-A                                       08480000
084900                      ADD +1 TO PA-TOT-BKPO-RECS-ADD              08490000
085000              END-EVALUATE                                        08500000
085100          END-IF                                                  08510000
085200          IF PS-EDDRSN-SENT                                       08520000
085300              PERFORM 5310-LOAD-EDDRSN-FIELDS-UPDATE              08530000
085400              IF PS-EDIT-ERROR                                    08540000
085500                  PERFORM 3017-PROCESS-EDD-EDL-ERROR              08550000
085600                      UNTIL PS-NEW-BOOKING  OR                    08560000
085700                            PS-END-OF-BOOKINGS                    08570000
085800                  SET PS-EDIT-ERROR-NO  TO TRUE                   08580000
085900                  SET PS-NEW-BOOKING-NO TO TRUE                   08590000
086000              ELSE                                                08600000
086100                  EVALUATE PV-TR014-EDDRSN-TRN-TYP                08610000
086200                      WHEN PC-C                                   08620000
086300                          ADD +1 TO PA-TOT-BKPO-RECS-CHANGE       08630000
086400                      WHEN PC-A                                   08640000
086500                          ADD +1 TO PA-TOT-BKPO-RECS-ADD          08650000
086600                  END-EVALUATE                                    08660000
086700              END-IF                                              08670000
086800          END-IF                                                  08680000
086900          PERFORM 5320-LOAD-EDL-FIELDS-UPDATE                     08690000
087000          IF PS-EDIT-ERROR                                        08700000
087100              PERFORM 3017-PROCESS-EDD-EDL-ERROR                  08710000
087200                  UNTIL PS-NEW-BOOKING  OR                        08720000
087300                        PS-END-OF-BOOKINGS                        08730000
087400              SET PS-EDIT-ERROR-NO  TO TRUE                       08740000
087500              SET PS-NEW-BOOKING-NO TO TRUE                       08750000
087600          ELSE                                                    08760000
087700              EVALUATE PV-TR014-EDL-TRN-TYP                       08770000
087800                  WHEN PC-C                                       08780000
087900                      ADD +1 TO PA-TOT-BKPO-RECS-CHANGE           08790000
088000                  WHEN PC-A                                       08800000
088100                      ADD +1 TO PA-TOT-BKPO-RECS-ADD              08810000
088200              END-EVALUATE                                        08820000
088300          END-IF                                                  08830000
088400     END-IF.                                                      08840000
088500                                                                  08850000
088600     EVALUATE TRUE                                                08860000
088700        WHEN PS-EDD-NOT-SENT AND PS-EDL-NOT-SENT                  08870000
088800           MOVE PC-ERROR          TO PV-HOLD-TR201-ERROR-TYPE     08880000
088900           MOVE TR014-EDD-PO-NBR  TO PV-HOLD-TR201-DATA-VALUE     08890000
089000           MOVE 'PO LEVEL       ' TO PV-HOLD-TR201-DATA-IN-ERROR  08900000
089100           MOVE 'EDD & EDL DATA MISSING' TO                       08910000
089200                                     PV-HOLD-TR201-ERROR-MSG      08920000
089300           IF PS-EDDRSN-SENT                                      08930000
089400               PERFORM 5510-LOAD-EDDRSN-TO-REPORT                 08940000
089500           END-IF                                                 08950000
089600                                                                  08960000
089700           IF (TR014-EDD-TRN-TYP          NOT =                   08970000
089800                PV-HOLD-LAST-TRN-TYP)                  OR         08980000
089900              (TR014-EDD-PO-NBR-X         NOT =                   08990000
090000               PV-HOLD-PO-NBR-X)                       OR         09000000
090100              (TR014-EDD-EXTL-REF-NBR     NOT =                   09010000
090200               PV-HOLD-EXTL-REF-NBR)                   OR         09020000
090300              (TR014-EDD-PO-BKG-DELY-DTE  NOT =                   09030000
090400               PV-HOLD-PO-BKG-DELY-DTE)                OR         09040000
090500              (TR014-EDD-ORGN-SHPD-FR-CDE NOT =                   09050000
090600               PV-HOLD-ORGN-SHPD-FR-CDE)                          09060000
090700               CONTINUE                                           09070000
090800           ELSE                                                   09080000
090900               SET PS-EDI-RECORD-NO TO TRUE                       09090000
091000               PERFORM 3017-PROCESS-EDD-EDL-ERROR                 09100000
091100                   UNTIL PS-NEW-BOOKING   OR                      09110000
091200                         PS-END-OF-BOOKINGS                       09120000
091300               SET PS-NEW-BOOKING-NO TO TRUE                      09130000
091400           END-IF                                                 09140000
091500                                                                  09150000
091600        WHEN PS-EDD-NOT-SENT                                      09160000
091700           MOVE PC-ERROR          TO PV-HOLD-TR201-ERROR-TYPE     09170000
091800           MOVE PV-TR014-EDL-PO-NBR  TO PV-HOLD-TR201-DATA-VALUE  09180000
091900           MOVE 'PO LEVEL       ' TO PV-HOLD-TR201-DATA-IN-ERROR  09190000
092000           MOVE 'EDD DATA MISSING' TO PV-HOLD-TR201-ERROR-MSG     09200000
092100                                                                  09210000
092200           IF PS-EDDRSN-SENT                                      09220000
092300               PERFORM 5510-LOAD-EDDRSN-TO-REPORT                 09230000
092400           END-IF                                                 09240000
092500                                                                  09250000
092600           IF PS-EDL-SENT                                         09260000
092700               PERFORM 5520-LOAD-EDL-TO-REPORT                    09270000
092800           END-IF                                                 09280000
092900                                                                  09290000
093000           IF (TR014-EDD-TRN-TYP          NOT =                   09300000
093100                PV-HOLD-LAST-TRN-TYP)                  OR         09310000
093200              (TR014-EDD-PO-NBR-X         NOT =                   09320000
093300               PV-HOLD-PO-NBR-X)                       OR         09330000
093400              (TR014-EDD-EXTL-REF-NBR     NOT =                   09340000
093500               PV-HOLD-EXTL-REF-NBR)                   OR         09350000
093600              (TR014-EDD-PO-BKG-DELY-DTE  NOT =                   09360000
093700               PV-HOLD-PO-BKG-DELY-DTE)                OR         09370000
093800              (TR014-EDD-ORGN-SHPD-FR-CDE NOT =                   09380000
093900               PV-HOLD-ORGN-SHPD-FR-CDE)                          09390000
094000               CONTINUE                                           09400000
094100           ELSE                                                   09410000
094200               SET PS-EDI-RECORD-NO TO TRUE                       09420000
094300               PERFORM 3017-PROCESS-EDD-EDL-ERROR                 09430000
094400                   UNTIL PS-NEW-BOOKING   OR                      09440000
094500                         PS-END-OF-BOOKINGS                       09450000
094600               SET PS-NEW-BOOKING-NO TO TRUE                      09460000
094700           END-IF                                                 09470000
094800                                                                  09480000
094900        WHEN PS-EDL-NOT-SENT                                      09490000
095000           MOVE PC-ERROR          TO PV-HOLD-TR201-ERROR-TYPE     09500000
095100           MOVE PV-TR014-EDD-PO-NBR  TO PV-HOLD-TR201-DATA-VALUE  09510000
095200           MOVE 'PO LEVEL       ' TO PV-HOLD-TR201-DATA-IN-ERROR  09520000
095300           MOVE 'EDL DATA MISSING'   TO                           09530000
095400                                     PV-HOLD-TR201-ERROR-MSG      09540000
095500           IF PS-EDD-SENT                                         09550000
095600               PERFORM 5500-LOAD-EDD-TO-REPORT                    09560000
095700           END-IF                                                 09570000
095800           IF PS-EDDRSN-SENT                                      09580000
095900               PERFORM 5510-LOAD-EDDRSN-TO-REPORT                 09590000
096000           END-IF                                                 09600000
096100                                                                  09610000
096200           IF (TR014-EDD-TRN-TYP          NOT =                   09620000
096300                PV-HOLD-LAST-TRN-TYP)                  OR         09630000
096400              (TR014-EDD-PO-NBR-X         NOT =                   09640000
096500               PV-HOLD-PO-NBR-X)                       OR         09650000
096600              (TR014-EDD-EXTL-REF-NBR     NOT =                   09660000
096700               PV-HOLD-EXTL-REF-NBR)                   OR         09670000
096800              (TR014-EDD-PO-BKG-DELY-DTE  NOT =                   09680000
096900               PV-HOLD-PO-BKG-DELY-DTE)                OR         09690000
097000              (TR014-EDD-ORGN-SHPD-FR-CDE NOT =                   09700000
097100               PV-HOLD-ORGN-SHPD-FR-CDE)                          09710000
097200               CONTINUE                                           09720000
097300           ELSE                                                   09730000
097400               SET PS-EDI-RECORD-NO TO TRUE                       09740000
097500               PERFORM 3017-PROCESS-EDD-EDL-ERROR                 09750000
097600                   UNTIL PS-NEW-BOOKING   OR                      09760000
097700                         PS-END-OF-BOOKINGS                       09770000
097800               SET PS-NEW-BOOKING-NO TO TRUE                      09780000
097900           END-IF                                                 09790000
098000                                                                  09800000
098100     END-EVALUATE.                                                09810000
098200                                                                  09820000
098300******************************************************************09830000
098400* MOVE INPUT FIELDS TO WORKING STORAGE HOLD FIELDS.  DEPENDING ON*09840000
098500* WHAT RECORDS WERE SENT, SET THE APPROPRIATE SWITCHES SO THAT   *09850000
098600* PARA 3010- CAN DETERMINE IF AN ERROR OR WARNING NEEDS TO BE    *09860000
098700* WRITTEN TO THE ERROR FILE OR IF AN EDITED UPDATE RECORD NEEDS  *09870000
098800* TO BE WRITTEN TO THE EDITED UPDATE FILE.                       *09880000
098900******************************************************************09890000
099000 3015-PROCESS-EDD-ADD-EDD.                                        09900000
099100                                                                  09910000
099200     MOVE TR014-EDD-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    09920000
099300                                                                  09930000
099400     EVALUATE TRUE                                                09940000
099500                                                                  09950000
099600        WHEN REC-TYP-EDD                                          09960000
099700            PERFORM 5000-MOVE-TR014-EDD-TO-HOLD                   09970000
099800            SET PS-EDD-SENT TO TRUE                               09980000
099900                                                                  09990000
100000        WHEN REC-TYP-EDDRSN                                       10000000
100100            PERFORM 5010-MOVE-TR014-EDDRSN-TO-HOLD                10010000
100200            SET PS-EDDRSN-SENT TO TRUE                            10020000
100300                                                                  10030000
100400        WHEN REC-TYP-EDL                                          10040000
100500            PERFORM 5020-MOVE-TR014-EDL-TO-HOLD                   10050000
100600            SET PS-EDL-SENT TO TRUE                               10060000
100700                                                                  10070000
100800     END-EVALUATE.                                                10080000
100900                                                                  10090000
101000     PERFORM 6000-READ-BOOKING-FILE                               10100000
101100         UNTIL PS-GOOD-RECORD OR                                  10110000
101200               PS-END-OF-BOOKINGS.                                10120000
101300     SET PS-GOOD-RECORD-NO TO TRUE.                               10130000
101400                                                                  10140000
101500******************************************************************10150000
101600* THERE WAS AN EDD, EDDRSN, OR EDL RECORD ERROR.  BYPASS ALL THE *10160000
101700* RECORDS THAT ARE RELATED TO THIS BOOKING.                      *10170000
101800******************************************************************10180000
101900 3017-PROCESS-EDD-EDL-ERROR.                                      10190000
102000                                                                  10200000
102100     IF PS-EDI-RECORD-NO                                          10210000
102200         PERFORM 3500-CHECK-MOVE-TO-REPORT                        10220000
102300     END-IF.                                                      10230000
102400                                                                  10240000
102500     READ TR014-BOOKING-FILE                                      10250000
102600         INTO TR014-REC-TYP-EDD                                   10260000
102700         AT END                                                   10270000
102800           SET PS-END-OF-BOOKINGS TO TRUE.                        10280000
102900                                                                  10290000
103000     MOVE TR014-BOOKING-RECORD (1:3) TO PV-EDI-RECORDS.           10300000
103100     IF EDI-RECORD                                                10310000
103200         SET PS-EDI-RECORD TO TRUE                                10320000
103300         PERFORM 6030-PROCESS-EDI-RECORD                          10330000
103400     ELSE                                                         10340000
103500         SET PS-EDI-RECORD-NO TO TRUE                             10350000
103600         ADD +1 TO PV-PROCESS-SEQ-NBR                             10360000
103700         IF (TR014-EDD-PO-NBR-X         NOT EQUAL                 10370000
103800             PV-HOLD-PO-NBR-X)                     OR             10380000
103900            (TR014-EDD-EXTL-REF-NBR     NOT EQUAL                 10390000
104000             PV-HOLD-EXTL-REF-NBR)                 OR             10400000
104100            (TR014-EDD-PO-BKG-DELY-DTE  NOT EQUAL                 10410000
104200             PV-HOLD-PO-BKG-DELY-DTE)              OR             10420000
104300            (TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL                 10430000
104400             PV-HOLD-ORGN-SHPD-FR-CDE)             OR             10440000
104500            (TR014-EDD-TRN-TYP          NOT EQUAL                 10450000
104600             PV-HOLD-LAST-TRN-TYP)                                10460000
104700            SET PS-NEW-BOOKING   TO TRUE                          10470000
104800            PERFORM 4900-RESET-WRITE-SWITCHES                     10480000
104900         END-IF                                                   10490000
105000     END-IF.                                                      10500000
105100                                                                  10510000
105200     IF (TR014-EDD-REC-TYP-CDE = PC-EDD  AND                      10520000
105300         TR014-EDD-TRN-TYP NOT = PC-D)         OR                 10530000
105400        (TR014-EDD-REC-TYP-CDE = PC-EDL  AND                      10540000
105500         TR014-EDD-TRN-TYP     = PC-D)                            10550000
105600         SET PS-NEW-GROUP TO TRUE                                 10560000
105700     END-IF.                                                      10570000
105800                                                                  10580000
105900     IF PS-END-OF-BOOKINGS-NO                                     10590000
106000         ADD +1 TO PA-BKG-INPUT-COUNT                             10600000
106100         MOVE TR014-REC-TYP-EDD (1:3) TO PV-HOLD-LAST-REC-TYP     10610000
106200     END-IF.                                                      10620000
106300                                                                  10630000
106400******************************************************************10640000
106500* RESET THE EDD LEVEL SWITCHES.                                  *10650000
106600******************************************************************10660000
106700 3018-RESET-EDD-SWITCHES.                                         10670000
106800                                                                  10680000
106900     SET PS-EDD-NOT-SENT         TO TRUE.                         10690000
107000     SET PS-EDDRSN-NOT-SENT      TO TRUE.                         10700000
107100     SET PS-EDL-NOT-SENT         TO TRUE.                         10710000
107200                                                                  10720000
107300******************************************************************10730000
107400* ALL DELETE EDITING PROCESSING IS PERFORMED FROM THE PO LEVEL.  *10740000
107500* ONLY AN EDL RECORD TYPE WILL BE SENT FOR DELETES.              *10750000
107600******************************************************************10760000
107700 3100-PROCESS-EDL-DEL.                                            10770000
107800                                                                  10780000
107900     MOVE TR014-EDL-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    10790000
108000                                                                  10800000
108100     EVALUATE TRUE                                                10810000
108200                                                                  10820000
108300        WHEN REC-TYP-EDL                                          10830000
108400            PERFORM 5020-MOVE-TR014-EDL-TO-HOLD                   10840000
108500            PERFORM 3120-PROCESS-DELETE                           10850000
108600                                                                  10860000
108700        WHEN OTHER                                                10870000
108800            PERFORM 3105-PROCESS-EDL-DEL-EDL                      10880000
108900                                                                  10890000
109000     END-EVALUATE.                                                10900000
109100                                                                  10910000
109200******************************************************************10920000
109300* ALL DELETE EDITING PROCESSING IS PERFORMED FROM THE PO LEVEL.  *10930000
109400* ONLY AN EDL RECORD TYPE WILL BE SENT FOR DELETES.              *10940000
109500******************************************************************10950000
109600 3105-PROCESS-EDL-DEL-EDL.                                        10960000
109700                                                                  10970000
109800     SET PS-NEW-GROUP-NO        TO TRUE.                          10980000
109900     SET PS-EDL-DELETE-NOT-SENT TO TRUE.                          10990000
110000                                                                  11000000
110100     IF TR014-EDL-TRN-TYP = PC-D                                  11010000
110200         PERFORM 3110-PROCESS-EDL-DEL-CHK                         11020000
110300             UNTIL (TR014-EDL-TRN-TYP         NOT = PC-D)   OR    11030000
110400                   (TR014-EDL-PO-NBR-X        NOT =               11040000
110500                    PV-HOLD-PO-NBR-X)                       OR    11050000
110600                   (TR014-EDL-EXTL-REF-NBR    NOT =               11060000
110700                    PV-HOLD-EXTL-REF-NBR)                   OR    11070000
110800                   (TR014-EDL-PO-BKG-DELY-DTE NOT =               11080000
110900                    PV-HOLD-PO-BKG-DELY-DTE)                OR    11090000
111000                   (TR014-EDL-ORGN-SHPD-FR-CDE NOT =              11100000
111100                    PV-HOLD-ORGN-SHPD-FR-CDE)               OR    11110000
111200                   (TR014-EDL-REC-TYP-CDE     NOT =               11120000
111300                    PC-EDD AND PC-EDDRSN AND PC-EDL)              11130000
111400                   OR PS-END-OF-BOOKINGS                          11140000
111500                   OR PS-NEW-GROUP                                11150000
111600     END-IF.                                                      11160000
111700                                                                  11170000
111800     IF (TR014-EDL-REC-TYP-CDE          = PC-EDL)           AND   11180000
111900        (TR014-EDL-TRN-TYP              = PC-D)             AND   11190000
112000        (TR014-EDL-PO-NBR-X             =                         11200000
112100          PV-HOLD-PO-NBR-X)                                 AND   11210000
112200        (TR014-EDL-EXTL-REF-NBR         =                         11220000
112300          PV-HOLD-EXTL-REF-NBR)                             AND   11230000
112400        (TR014-EDL-PO-BKG-DELY-DTE      =                         11240000
112500          PV-HOLD-PO-BKG-DELY-DTE)                          AND   11250000
112600        (TR014-EDL-ORGN-SHPD-FR-CDE     =                         11260000
112700          PV-HOLD-ORGN-SHPD-FR-CDE)                         AND   11270000
112800        PS-NEW-GROUP                                              11280000
112900                                                                  11290000
113000         PERFORM 3110-PROCESS-EDL-DEL-CHK                         11300000
113100     END-IF.                                                      11310000
113200                                                                  11320000
113300     IF PS-EDL-DELETE-SENT                                        11330000
113400         PERFORM 3120-PROCESS-DELETE                              11340000
113500         IF (TR014-EDL-REC-TYP-CDE          = PC-EDL)       AND   11350000
113600            (TR014-EDL-TRN-TYP              = PC-D)         AND   11360000
113700            (TR014-EDL-PO-NBR-X             =                     11370000
113800              PV-HOLD-PO-NBR-X)                             AND   11380000
113900            (TR014-EDL-EXTL-REF-NBR         =                     11390000
114000              PV-HOLD-EXTL-REF-NBR)                         AND   11400000
114100            (TR014-EDL-PO-BKG-DELY-DTE      =                     11410000
114200              PV-HOLD-PO-BKG-DELY-DTE)                      AND   11420000
114300            (TR014-EDL-ORGN-SHPD-FR-CDE     =                     11430000
114400              PV-HOLD-ORGN-SHPD-FR-CDE)                     AND   11440000
114500             PS-NEW-GROUP                                         11450000
114600                                                                  11460000
114700             PERFORM 3110-PROCESS-EDL-DEL-CHK                     11470000
114800             PERFORM 3120-PROCESS-DELETE                          11480000
114900         END-IF                                                   11490000
115000     ELSE                                                         11500000
115100         MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE                11510000
115200         MOVE 'PO LEVEL'            TO                            11520000
115300               PV-HOLD-TR201-DATA-IN-ERROR                        11530000
115400         MOVE 'EDL DATA MISSING'    TO                            11540000
115500               PV-HOLD-TR201-ERROR-MSG                            11550000
115600         EVALUATE TRUE                                            11560000
115700             WHEN REC-TYP-EDD                                     11570000
115800                 MOVE PC-EDD TO PV-HOLD-TR201-DATA-VALUE          11580000
115900                 PERFORM 5500-LOAD-EDD-TO-REPORT                  11590000
116000             WHEN REC-TYP-EDDRSN                                  11600000
116100                 MOVE PC-EDDRSN TO PV-HOLD-TR201-DATA-VALUE       11610000
116200                 PERFORM 5510-LOAD-EDDRSN-TO-REPORT               11620000
116300         END-EVALUATE                                             11630000
116400     END-IF.                                                      11640000
116500                                                                  11650000
116600******************************************************************11660000
116700* MOVE INPUT FIELDS TO WORKING STORAGE HOLD FIELDS.  DEPENDING ON*11670000
116800* WHAT RECORDS WERE SENT, SET THE APPROPRIATE SWITCHES SO THAT   *11680000
116900* PARA 3105- CAN DETERMINE IF AN ERROR OR WARNING NEEDS TO BE    *11690000
117000* WRITTEN TO THE ERROR FILE OR IF AN EDITED UPDATE RECORD NEEDS  *11700000
117100* TO BE WRITTEN TO THE UPDATE FILE.                              *11710000
117200******************************************************************11720000
117300 3110-PROCESS-EDL-DEL-CHK.                                        11730000
117400                                                                  11740000
117500     MOVE TR014-EDL-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    11750000
117600                                                                  11760000
117700     EVALUATE TRUE                                                11770000
117800                                                                  11780000
117900        WHEN REC-TYP-EDL                                          11790000
118000            PERFORM 5020-MOVE-TR014-EDL-TO-HOLD                   11800000
118100            SET PS-EDL-DELETE-SENT    TO TRUE                     11810000
118200                                                                  11820000
118300        WHEN REC-TYP-EDD                                          11830000
118400            PERFORM 5000-MOVE-TR014-EDD-TO-HOLD                   11840000
118500                                                                  11850000
118600        WHEN REC-TYP-EDDRSN                                       11860000
118700            PERFORM 5010-MOVE-TR014-EDDRSN-TO-HOLD                11870000
118800                                                                  11880000
118900     END-EVALUATE.                                                11890000
119000                                                                  11900000
119100     SET PS-EDI-RECORD-NO TO TRUE.                                11910000
119200     PERFORM 6000-READ-BOOKING-FILE                               11920000
119300         UNTIL PS-GOOD-RECORD OR                                  11930000
119400               PS-END-OF-BOOKINGS.                                11940000
119500     SET PS-GOOD-RECORD-NO TO TRUE.                               11950000
119600                                                                  11960000
119700******************************************************************11970000
119800* PROCESS THE EDL DELETE.                                        *11980000
119900******************************************************************11990000
120000 3120-PROCESS-DELETE.                                             12000000
120100                                                                  12010000
120200     PERFORM 5420-INITIAL-EDL-FIELDS-UPD.                         12020000
120300                                                                  12030000
120400     MOVE PV-TR014-EDL-TRN-TYP        TO TR024-EDL-TRN-TYP.       12040000
120500     MOVE PC-EDL                      TO TR024-EDL-REC-TYP-CDE.   12050000
120600     MOVE PC-20                       TO TR024-EDL-SEQ-NBR.       12060000
120700     MOVE PV-TR014-EDL-3RD-PARTY-CDE  TO TR024-EDL-3RD-PARTY-CDE. 12070000
120800                                                                  12080000
120900     IF PV-TR014-EDL-PO-BKG-DELY-DTE EQUAL SPACES                 12090000
121000         MOVE PC-DEFAULT-DATE TO TR024-EDL-PO-BKG-DELY-DTE        12100000
121100     END-IF.                                                      12110000
121200                                                                  12120000
121300     IF PV-TR014-EDL-PO-BKG-DELY-TM EQUAL SPACES                  12130000
121400         MOVE PC-DEFAULT-TIME TO TR024-EDL-PO-BKG-DELY-TM         12140000
121500     END-IF.                                                      12150000
121600                                                                  12160000
121700     EVALUATE TRUE                                                12170000
121800                                                                  12180000
121900         WHEN PV-TR014-EDL-PO-NBR NOT NUMERIC OR                  12190000
122000              PV-TR014-EDL-PO-NBR  = ZERO                         12200000
122100               SET PS-EDIT-ERROR TO TRUE                          12210000
122200               MOVE PC-ERROR    TO PV-HOLD-TR201-ERROR-TYPE       12220000
122300               MOVE 'PO NUMBER' TO PV-HOLD-TR201-DATA-IN-ERROR    12230000
122400               MOVE PV-TR014-EDL-PO-NBR TO                        12240000
122500                     PV-HOLD-TR201-DATA-VALUE                     12250000
122600               MOVE 'INVALID PO NUMBER'    TO                     12260000
122700                     PV-HOLD-TR201-ERROR-MSG                      12270000
122800               PERFORM 5520-LOAD-EDL-TO-REPORT                    12280000
122900                                                                  12290000
123000         WHEN PV-TR014-EDL-EXTL-REF-NBR EQUAL SPACES              12300000
123100               SET PS-EDIT-ERROR TO TRUE                          12310000
123200               MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE          12320000
123300               MOVE 'EXTL REF NBR'                 TO             12330000
123400                     PV-HOLD-TR201-DATA-IN-ERROR                  12340000
123500               MOVE PV-TR014-EDL-EXTL-REF-NBR   TO                12350000
123600                     PV-HOLD-TR201-DATA-VALUE                     12360000
123700               MOVE 'DATA NOT SENT'                TO             12370000
123800                     PV-HOLD-TR201-ERROR-MSG                      12380000
123900               PERFORM 5520-LOAD-EDL-TO-REPORT                    12390000
124000                                                                  12400000
124100         WHEN PV-TR014-EDL-ORGN-SHPD-FR-CDE EQUAL SPACES OR       12410000
124200             (PV-TR014-EDL-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS      12420000
124300              AND PC-CY)                                          12430000
124400             SET PS-EDIT-ERROR TO TRUE                            12440000
124500             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            12450000
124600             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR201-DATA-IN-ERROR 12460000
124700             MOVE PV-TR014-EDL-ORGN-SHPD-FR-CDE  TO               12470000
124800                   PV-HOLD-TR201-DATA-VALUE                       12480000
124900             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               12490000
125000                   PV-HOLD-TR201-ERROR-MSG                        12500000
125100             PERFORM 5520-LOAD-EDL-TO-REPORT                      12510000
125200                                                                  12520000
125300         WHEN PV-TR014-EDL-PO-BKG-DELY-DTE NOT EQUAL SPACES       12530000
125400                AND                                               12540000
125500              PV-TR014-EDL-PO-BKG-DELY-DTE NOT EQUAL              12550000
125600               PC-DEFAULT-DATE                                    12560000
125700             MOVE PV-TR014-EDL-PO-BKG-DELY-DTE   TO               12570000
125800                   PV-BKG-DELY-DTE                                12580000
125900             MOVE PV-TR014-EDL-PO-BKG-DELY-TM    TO               12590000
126000                   PV-BKG-DELY-TM                                 12600000
126100             PERFORM 5715-FORMAT-BKG-DELY-TMST                    12610000
126200             IF PS-WARNING-DATE                                   12620000
126300                 SET PS-EDIT-ERROR TO TRUE                        12630000
126400                 MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE        12640000
126500                 MOVE PV-TR014-EDL-PO-BKG-DELY-DTE TO             12650000
126600                       PV-HOLD-TR201-DATA-VALUE                   12660000
126700                 MOVE 'DELY DTE' TO PV-HOLD-TR201-DATA-IN-ERROR   12670000
126800                 MOVE 'INVALID DELIVERY DATE'      TO             12680000
126900                       PV-HOLD-TR201-ERROR-MSG                    12690000
127000                 PERFORM 5520-LOAD-EDL-TO-REPORT                  12700000
127100             ELSE                                                 12710000
127200                 IF PS-WARNING-TIME                               12720000
127300                     SET PS-EDIT-ERROR TO TRUE                    12730000
127400                     MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE    12740000
127500                     MOVE PV-TR014-EDL-PO-BKG-DELY-TM TO          12750000
127600                           PV-HOLD-TR201-DATA-VALUE               12760000
127700                     MOVE 'DELY TM' TO PV-HOLD-TR201-DATA-IN-ERROR12770000
127800                     MOVE 'INVALID DELIVERY TIME'     TO          12780000
127900                           PV-HOLD-TR201-ERROR-MSG                12790000
128000                     PERFORM 5520-LOAD-EDL-TO-REPORT              12800000
128100                 ELSE                                             12810000
128200                     MOVE PV-TR014-EDL-PO-BKG-DELY-DTE TO         12820000
128300                           TR024-EDL-PO-BKG-DELY-DTE              12830000
128400                     MOVE PV-TR014-EDL-PO-BKG-DELY-TM TO          12840000
128500                           TR024-EDL-PO-BKG-DELY-TM               12850000
128600                 END-IF                                           12860000
128700             END-IF                                               12870000
128800             SET PS-WARNING-DATE-NO TO TRUE                       12880000
128900             SET PS-WARNING-TIME-NO TO TRUE                       12890000
129000     END-EVALUATE.                                                12900000
129100                                                                  12910000
129200     IF PS-EDIT-ERROR-NO                                          12920000
129300         ADD +1 TO PA-TOT-EDL-RECS-DELETE                         12930000
129400         MOVE PV-TR014-EDL-PO-NBR TO                              12940000
129500               TR024-EDL-PO-NBR                                   12950000
129600         MOVE PV-TR014-EDL-EXTL-REF-NBR TO                        12960000
129700               TR024-EDL-EXTL-REF-NBR                             12970000
129800         MOVE PV-TR014-EDL-PO-BKG-DELY-DTE TO                     12980000
129900               TR024-EDL-PO-BKG-DELY-DTE                          12990000
130000         MOVE PV-TR014-EDL-PO-BKG-DELY-TM TO                      13000000
130100               TR024-EDL-PO-BKG-DELY-TM                           13010000
130200         MOVE PV-TR014-EDL-ORGN-SHPD-FR-CDE TO                    13020000
130300               TR024-EDL-ORGN-SHPD-FR-CDE                         13030000
130400         MOVE PV-TR014-EDL-PROC-SEQ-NBR TO                        13040000
130500               TR024-EDL-PROCESS-SEQ-NBR                          13050000
130510         MOVE PV-TR014-EDL-FILE-ID TO                             13053000
130520               TR024-EDL-FILE-ID                                  13054000
130530         MOVE PV-TR014-EDL-ENT-ID  TO                             13055000
130540               TR024-EDL-ENT-ID                                   13056000
130550         PERFORM 6400-WRITE-UPDATE-RECORD                         13060000
130560     END-IF.                                                      13070000
130570                                                                  13080000
130580******************************************************************13090000
130590* ON A DELETE CHECK INPUT FIELDS TO SEE IF RECORDS NEED TO       *13100000
130600* BE BYPASSED ON READ.  THE DELETE EDITING PROCESS ONLY EDITS THE*13110000
130700* EDL RECORD FOR THE DELETE.  ONCE IT IS FINISHED EDITING THE    *13120000
130800* EDL RECORD, WE NEED TO SPIN PAST THE REST OF THE RECORDS FOR   *13130000
130900* THIS PO TO GET TO THE NEXT PO.                                 *13140000
131000******************************************************************13150000
131100 3125-CHECK-SPIN-FIELDS.                                          13160000
131200                                                                  13170000
131300     SET PS-NEW-GROUP-NO TO TRUE.                                 13180000
131400                                                                  13190000
131500     IF TR014-EDL-PO-NBR-X         =  PV-HOLD-PO-NBR-X        AND 13200000
131600        TR014-EDL-EXTL-REF-NBR     =  PV-HOLD-EXTL-REF-NBR    AND 13210000
131700        TR014-EDL-PO-BKG-DELY-DTE  = PV-HOLD-PO-BKG-DELY-DTE  AND 13220000
131800        TR014-EDL-ORGN-SHPD-FR-CDE = PV-HOLD-ORGN-SHPD-FR-CDE AND 13230000
131900        PV-HOLD-LAST-TRN-TYP       =  PC-D                        13240000
132000         SET PS-EDI-RECORD-NO TO TRUE                             13250000
132100         PERFORM 6000-READ-BOOKING-FILE                           13260000
132200             UNTIL (TR014-EDD-PO-NBR-X         NOT EQUAL          13270000
132300                     PV-HOLD-PO-NBR-X)                      OR    13280000
132400                   (TR014-EDD-EXTL-REF-NBR     NOT EQUAL          13290000
132500                     PV-HOLD-EXTL-REF-NBR)                  OR    13300000
132600                   (TR014-EDD-PO-BKG-DELY-DTE  NOT EQUAL          13310000
132700                     PV-HOLD-PO-BKG-DELY-DTE)               OR    13320000
132800                   (TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL          13330000
132900                     PV-HOLD-ORGN-SHPD-FR-CDE)              OR    13340000
133000                   PS-EDI-RECORD                            OR    13350000
133100                   PS-END-OF-BOOKINGS                       OR    13360000
133200                   PS-NEW-GROUP                                   13370000
133300         SET PS-GOOD-RECORD-NO TO TRUE                            13380000
133400     END-IF.                                                      13390000
133500                                                                  13400000
133600     IF PS-EDI-RECORD AND PS-END-OF-BOOKINGS-NO                   13410000
133700         PERFORM 6000-READ-BOOKING-FILE                           13420000
133800             UNTIL PS-GOOD-RECORD OR PS-END-OF-BOOKINGS           13430000
133900         SET PS-GOOD-RECORD-NO TO TRUE                            13440000
134000     END-IF.                                                      13450000
134100                                                                  13460000
134200******************************************************************13470000
134300* PROCESS THE VENDOR STYLE LEVEL RECORD  (EDLVS).                *13480000
134400* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *13490000
134500******************************************************************13500000
134600 3200-PROCESS-EDLVS-REC.                                          13510000
134700                                                                  13520000
134800     PERFORM 4010-MOVE-TO-EDLVS-HOLD.                             13530000
134900                                                                  13540000
135000     MOVE TR014-EDLVS-TRN-TYP         TO PV-EVAL-TRN-TYP-CDE.     13550000
135100                                                                  13560000
135200     EVALUATE TRUE                                                13570000
135300         WHEN TRN-TYP-ADD                                         13580000
135400             PERFORM 3210-PROCESS-EDLVS-ADD-CHG                   13590000
135500                                                                  13600000
135600         WHEN TRN-TYP-CHG                                         13610000
135700             PERFORM 3210-PROCESS-EDLVS-ADD-CHG                   13620000
135800                                                                  13630000
135900         WHEN OTHER                                               13640000
136000             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            13650000
136100             MOVE TR014-EDLVS-PO-NBR              TO              13660000
136200                   PV-HOLD-TR201-PO-NBR                           13670000
136300             MOVE TR014-EDLVS-EXTL-REF-NBR        TO              13680000
136400                   PV-HOLD-TR201-EXTL-REF-NBR                     13690000
136500             MOVE TR014-EDLVS-PO-BKG-DELY-DTE     TO              13700000
136600                   PV-HOLD-TR201-PO-BKG-DELY-DTE                  13710000
136700             MOVE TR014-EDLVS-PO-BKG-DELY-TM      TO              13720000
136800                   PV-HOLD-TR201-PO-BKG-DELY-TM                   13730000
136900             MOVE TR014-EDLVS-ORGN-SHPD-FR-CDE    TO              13740000
137000                   PV-HOLD-TR201-ORGN-SHPD-FR-CDE                 13750000
137100             MOVE TR014-EDLVS-TRN-TYP             TO              13760000
137200                   PV-HOLD-TR201-DATA-VALUE                       13770000
137300                   PV-HOLD-TR201-TRN-TYP                          13780000
137400             MOVE 'TRAN TYPE-VS'                  TO              13790000
137500                   PV-HOLD-TR201-DATA-IN-ERROR                    13800000
137600             MOVE 'INVALID TRAN TYPE'             TO              13810000
137700                   PV-HOLD-TR201-ERROR-MSG                        13820000
137800             SET PS-EDI-RECORD-NO     TO TRUE                     13830000
137900             PERFORM 3217-PROCESS-EDLVS-ERROR                     13840000
138000                 UNTIL PS-NEW-VS  OR                              13850000
138100                       PS-END-OF-BOOKINGS                         13860000
138200             SET PS-NEW-VS-NO         TO TRUE                     13870000
138300                                                                  13880000
138400     END-EVALUATE.                                                13890000
138500                                                                  13900000
138600******************************************************************13910000
138700* PROCESS VENDOR STYLE RECORD ADD AND CHANGE TRANSACTIONS.       *13920000
138800******************************************************************13930000
138900 3210-PROCESS-EDLVS-ADD-CHG.                                      13940000
139000                                                                  13950000
139100     SET PS-EDLVS-NOT-SENT TO TRUE.                               13960000
139200                                                                  13970000
139300     IF TR014-EDLVS-TRN-TYP = PC-A                                13980000
139400         MOVE PC-A                 TO PV-HOLD-TR201-TRN-TYP       13990000
139500     ELSE                                                         14000000
139600         MOVE PC-C                 TO PV-HOLD-TR201-TRN-TYP       14010000
139700     END-IF.                                                      14020000
139800                                                                  14030000
139900     IF TR014-EDLVS-PO-NBR-X = PV-HOLD-PO-NBR-X                   14040000
140000         PERFORM 5030-MOVE-TR014-EDLVS-TO-HOLD                    14050000
140100         PERFORM 5330-LOAD-EDLVS-FIELDS-UPDATE                    14060000
140200         SET PS-GOOD-EDLVS-WRITE TO TRUE                          14070000
140300         EVALUATE PV-TR014-EDLVS-TRN-TYP                          14080000
140400             WHEN PC-C                                            14090000
140500                 ADD +1 TO PA-TOT-BKVS-RECS-CHANGE                14100000
140600             WHEN PC-A                                            14110000
140700                 ADD +1 TO PA-TOT-BKVS-RECS-ADD                   14120000
140800         END-EVALUATE                                             14130000
140900         SET PS-EDLVS-SENT TO TRUE                                14140000
141000         PERFORM 6000-READ-BOOKING-FILE                           14150000
141100             UNTIL PS-GOOD-RECORD  OR                             14160000
141200                   PS-END-OF-BOOKINGS                             14170000
141300         SET PS-GOOD-RECORD-NO TO TRUE                            14180000
141400     ELSE                                                         14190000
141500         MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE                14200000
141600         MOVE TR014-EDLVS-VS-NBR  TO PV-HOLD-TR201-DATA-VALUE     14210000
141700         MOVE 'VENDOR STYLE'      TO PV-HOLD-TR201-DATA-IN-ERROR  14220000
141800         MOVE 'PO NBR MISSING' TO PV-HOLD-TR201-ERROR-MSG         14230000
141900         SET PS-EDI-RECORD-NO TO TRUE                             14240000
142000         PERFORM 3217-PROCESS-EDLVS-ERROR                         14250000
142100             UNTIL PS-NEW-VS      OR                              14260000
142200                   PS-END-OF-BOOKINGS                             14270000
142300         SET PS-NEW-VS-NO    TO TRUE                              14280000
142400     END-IF.                                                      14290000
142500                                                                  14300000
142600******************************************************************14310000
142700* THERE WAS A VS LEVEL ERROR -- BYPASS THE UPC RECORDS THAT ARE  *14320000
142800* RELATED TO THIS VENDOR STYLE.                                  *14330000
142900******************************************************************14340000
143000 3217-PROCESS-EDLVS-ERROR.                                        14350000
143100                                                                  14360000
143200     IF PS-EDI-RECORD-NO                                          14370000
143300         PERFORM 3500-CHECK-MOVE-TO-REPORT                        14380000
143400     END-IF.                                                      14390000
143500                                                                  14400000
143600     READ TR014-BOOKING-FILE                                      14410000
143700         INTO TR014-REC-TYP-EDD                                   14420000
143800         AT END                                                   14430000
143900           SET PS-END-OF-BOOKINGS TO TRUE.                        14440000
144000                                                                  14450000
144100     MOVE TR014-BOOKING-RECORD (1:3) TO PV-EDI-RECORDS.           14460000
144200     IF EDI-RECORD                                                14470000
144300         SET PS-EDI-RECORD   TO TRUE                              14480000
144400         PERFORM 6030-PROCESS-EDI-RECORD                          14490000
144500     ELSE                                                         14500000
144600         SET PS-EDI-RECORD-NO         TO TRUE                     14510000
144700         ADD +1 TO PV-PROCESS-SEQ-NBR                             14520000
144800         IF (TR014-EDLVS-PO-NBR-X         NOT EQUAL               14530000
144900             PV-HOLD-PO-NBR-X)                        OR          14540000
145000            (TR014-EDLVS-EXTL-REF-NBR     NOT EQUAL               14550000
145100             PV-HOLD-EXTL-REF-NBR)                    OR          14560000
145200            (TR014-EDLVS-PO-BKG-DELY-DTE  NOT EQUAL               14570000
145300             PV-HOLD-PO-BKG-DELY-DTE)                 OR          14580000
145400            (TR014-EDLVS-ORGN-SHPD-FR-CDE NOT EQUAL               14590000
145500             PV-HOLD-ORGN-SHPD-FR-CDE)                OR          14600000
145600            (TR014-EDLVS-TRN-TYP          NOT EQUAL               14610000
145700             PV-HOLD-LAST-TRN-TYP)                    OR          14620000
145800            (TR014-EDLVS-VS-NBR           NOT EQUAL               14630000
145900             PV-HOLD-VS-NBR)                                      14640000
146000            SET PS-NEW-VS         TO TRUE                         14650000
146100            PERFORM 4900-RESET-WRITE-SWITCHES                     14660000
146200         END-IF                                                   14670000
146300     END-IF.                                                      14680000
146400                                                                  14690000
146500     IF (TR014-EDD-REC-TYP-CDE = PC-EDD  AND                      14700000
146600         TR014-EDD-TRN-TYP NOT = PC-D)         OR                 14710000
146700        (TR014-EDD-REC-TYP-CDE = PC-EDL  AND                      14720000
146800         TR014-EDD-TRN-TYP     = PC-D)                            14730000
146900         SET PS-NEW-GROUP TO TRUE                                 14740000
147000     END-IF.                                                      14750000
147100                                                                  14760000
147200     IF PS-END-OF-BOOKINGS-NO                                     14770000
147300         ADD +1 TO PA-BKG-INPUT-COUNT                             14780000
147400         MOVE TR014-REC-TYP-EDD (1:3) TO PV-HOLD-LAST-REC-TYP     14790000
147500     END-IF.                                                      14800000
147600                                                                  14810000
147700******************************************************************14820000
147800* PROCESS THE EDLUPC LEVEL RECORDS.                              *14830000
147900* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *14840000
148000******************************************************************14850000
148100 3400-PROCESS-EDLUPC-REC.                                         14860000
148200                                                                  14870000
148300     MOVE TR014-EDLUPC-TRN-TYP        TO PV-EVAL-TRN-TYP-CDE.     14880000
148400                                                                  14890000
148500     EVALUATE TRUE                                                14900000
148600         WHEN TRN-TYP-ADD                                         14910000
148700             PERFORM 3410-PROCESS-EDLUPC-ADD-CHG                  14920000
148800                                                                  14930000
148900         WHEN TRN-TYP-CHG                                         14940000
149000             PERFORM 3410-PROCESS-EDLUPC-ADD-CHG                  14950000
149100                                                                  14960000
149200         WHEN OTHER                                               14970000
149300             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            14980000
149400             MOVE TR014-EDLUPC-PO-NBR              TO             14990000
149500                   PV-HOLD-TR201-PO-NBR                           15000000
149600             MOVE TR014-EDLUPC-EXTL-REF-NBR        TO             15010000
149700                   PV-HOLD-TR201-EXTL-REF-NBR                     15020000
149800             MOVE TR014-EDLUPC-PO-BKG-DELY-DTE     TO             15030000
149900                   PV-HOLD-TR201-PO-BKG-DELY-DTE                  15040000
150000             MOVE TR014-EDLUPC-PO-BKG-DELY-TM      TO             15050000
150100                   PV-HOLD-TR201-PO-BKG-DELY-TM                   15060000
150200             MOVE TR014-EDLUPC-ORGN-SHPD-FR-CDE      TO           15070000
150300                   PV-HOLD-TR201-ORGN-SHPD-FR-CDE                 15080000
150400             MOVE TR014-EDLUPC-TRN-TYP             TO             15090000
150500                   PV-HOLD-TR201-DATA-VALUE                       15100000
150600                   PV-HOLD-TR201-TRN-TYP                          15110000
150700             MOVE 'TRAN TYPE-UPC'                  TO             15120000
150800                   PV-HOLD-TR201-DATA-IN-ERROR                    15130000
150900             MOVE 'INVALID TRAN TYPE'              TO             15140000
151000                   PV-HOLD-TR201-ERROR-MSG                        15150000
151100             SET PS-EDI-RECORD-NO TO TRUE                         15160000
151200             PERFORM 3417-PROCESS-EDLUPC-ERROR                    15170000
151300                 UNTIL PS-NEW-UPC OR                              15180000
151400                       PS-END-OF-BOOKINGS                         15190000
151500             SET PS-NEW-UPC-NO    TO TRUE                         15200000
151600                                                                  15210000
151700     END-EVALUATE.                                                15220000
151800                                                                  15230000
151900******************************************************************15240000
152000* PROCESS UPC RECORD ADD AND CHANGE TRANSACTIONS.                *15250000
152100******************************************************************15260000
152200 3410-PROCESS-EDLUPC-ADD-CHG.                                     15270000
152300                                                                  15280000
152400     IF TR014-EDLUPC-TRN-TYP = PC-A                               15290000
152500         MOVE PC-A                 TO PV-HOLD-TR201-TRN-TYP       15300000
152600     ELSE                                                         15310000
152700         MOVE PC-C                 TO PV-HOLD-TR201-TRN-TYP       15320000
152800     END-IF.                                                      15330000
152900                                                                  15340000
153000     IF TR014-EDLUPC-PO-NBR-X = PV-HOLD-PO-NBR-X                  15350000
153100       IF TR014-EDLUPC-VS-NBR = PV-HOLD-VS-NBR                    15360000
153200           PERFORM 5040-MOVE-TR014-EDLUPC-TO-HOLD                 15370000
153300           PERFORM 5340-LOAD-EDLUPC-FIELDS-UPDATE                 15380000
153400           EVALUATE PV-TR014-EDLVS-TRN-TYP                        15390000
153500               WHEN PC-C                                          15400000
153600                   ADD +1 TO PA-TOT-BKUP-RECS-CHANGE              15410000
153700               WHEN PC-A                                          15420000
153800                   ADD +1 TO PA-TOT-BKUP-RECS-ADD                 15430000
153900           END-EVALUATE                                           15440000
154000           PERFORM 6000-READ-BOOKING-FILE                         15450000
154100               UNTIL PS-GOOD-RECORD  OR                           15460000
154200                     PS-END-OF-BOOKINGS                           15470000
154300           SET PS-GOOD-RECORD-NO TO TRUE                          15480000
154400       ELSE                                                       15490000
154500           MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE              15500000
154600           MOVE TR014-EDLUPC-VS-NBR TO PV-HOLD-TR201-DATA-VALUE   15510000
154700           MOVE 'VENDOR STYLE'              TO                    15520000
154800                 PV-HOLD-TR201-DATA-IN-ERROR                      15530000
154900           MOVE 'UPC VENDOR STYLE MISSING'  TO                    15540000
155000                 PV-HOLD-TR201-ERROR-MSG                          15550000
155100           SET PS-EDI-RECORD-NO TO TRUE                           15560000
155200           PERFORM 3417-PROCESS-EDLUPC-ERROR                      15570000
155300               UNTIL PS-NEW-UPC     OR                            15580000
155400                     PS-END-OF-BOOKINGS                           15590000
155500           SET PS-NEW-UPC-NO   TO TRUE                            15600000
155600       END-IF                                                     15610000
155700     ELSE                                                         15620000
155800         MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE                15630000
155900         MOVE TR014-EDLUPC-PO-NBR TO PV-HOLD-TR201-DATA-VALUE     15640000
156000         MOVE 'PO NUMBER'         TO PV-HOLD-TR201-DATA-IN-ERROR  15650000
156100         MOVE 'UPC PO NBR MISSING' TO PV-HOLD-TR201-ERROR-MSG     15660000
156200         SET PS-EDI-RECORD-NO TO TRUE                             15670000
156300         PERFORM 3417-PROCESS-EDLUPC-ERROR                        15680000
156400             UNTIL PS-NEW-UPC     OR                              15690000
156500                   PS-END-OF-BOOKINGS                             15700000
156600         SET PS-NEW-UPC-NO   TO TRUE                              15710000
156700     END-IF.                                                      15720000
156800                                                                  15730000
156900******************************************************************15740000
157000* THERE WAS A UPC LEVEL ERROR - BYPASS THE UPC RECORDS THAT ARE  *15750000
157100* RELATED TO THIS UPC.                                           *15760000
157200******************************************************************15770000
157300 3417-PROCESS-EDLUPC-ERROR.                                       15780000
157400                                                                  15790000
157500     IF PS-EDI-RECORD-NO                                          15800000
157600         PERFORM 3500-CHECK-MOVE-TO-REPORT                        15810000
157700     END-IF.                                                      15820000
157800                                                                  15830000
157900     READ TR014-BOOKING-FILE                                      15840000
158000         INTO TR014-REC-TYP-EDD                                   15850000
158100         AT END                                                   15860000
158200           SET PS-END-OF-BOOKINGS TO TRUE.                        15870000
158300                                                                  15880000
158400     MOVE TR014-BOOKING-RECORD (1:3) TO PV-EDI-RECORDS.           15890000
158500     IF EDI-RECORD                                                15900000
158600         SET PS-EDI-RECORD TO TRUE                                15910000
158700         PERFORM 6030-PROCESS-EDI-RECORD                          15920000
158800     ELSE                                                         15930000
158900         SET PS-EDI-RECORD-NO          TO TRUE                    15940000
159000         ADD +1 TO PV-PROCESS-SEQ-NBR                             15950000
159100         IF (TR014-EDLUPC-PO-NBR-X         NOT EQUAL              15960000
159200             PV-HOLD-PO-NBR-X)                        OR          15970000
159300            (TR014-EDLUPC-UPC-NBR          NOT EQUAL              15980000
159400             PV-HOLD-UPC-NBR)                         OR          15990000
159500            (TR014-EDLUPC-VS-NBR           NOT EQUAL              16000000
159600             PV-HOLD-VS-NBR)                          OR          16010000
159700            (TR014-EDLUPC-EXTL-REF-NBR     NOT EQUAL              16020000
159800             PV-HOLD-EXTL-REF-NBR)                    OR          16030000
159900            (TR014-EDLUPC-PO-BKG-DELY-DTE  NOT EQUAL              16040000
160000             PV-HOLD-PO-BKG-DELY-DTE)                 OR          16050000
160100            (TR014-EDLUPC-ORGN-SHPD-FR-CDE NOT EQUAL              16060000
160200             PV-HOLD-ORGN-SHPD-FR-CDE)                OR          16070000
160300            (TR014-EDLUPC-TRN-TYP          NOT EQUAL              16080000
160400             PV-HOLD-LAST-TRN-TYP)                                16090000
160500            SET PS-NEW-UPC        TO TRUE                         16100000
160600            PERFORM 4900-RESET-WRITE-SWITCHES                     16110000
160700         END-IF                                                   16120000
160800     END-IF.                                                      16130000
160900                                                                  16140000
161000     IF (TR014-EDD-REC-TYP-CDE = PC-EDD  AND                      16150000
161100         TR014-EDD-TRN-TYP NOT = PC-D)         OR                 16160000
161200        (TR014-EDD-REC-TYP-CDE = PC-EDL  AND                      16170000
161300         TR014-EDD-TRN-TYP     = PC-D)                            16180000
161400         SET PS-NEW-GROUP TO TRUE                                 16190000
161500     END-IF.                                                      16200000
161600                                                                  16210000
161700     IF PS-END-OF-BOOKINGS-NO                                     16220000
161800         ADD +1 TO PA-BKG-INPUT-COUNT                             16230000
161900         MOVE TR014-REC-TYP-EDD (1:3) TO PV-HOLD-LAST-REC-TYP     16240000
162000     END-IF.                                                      16250000
162100                                                                  16260000
162200******************************************************************16270000
162300* WRITE RECORDS OUT TO THE ERROR REPORT FILE  DEPENDING ON THE   *16280000
162400* RECORD TYPE CODE.                                              *16290000
162500******************************************************************16300000
162600 3500-CHECK-MOVE-TO-REPORT.                                       16310000
162700                                                                  16320000
162800     MOVE TR014-EDD-REC-TYP-CDE TO PV-HOLD-REC-TYP-CDE.           16330000
162900                                                                  16340000
163000     EVALUATE TRUE                                                16350000
163100         WHEN REC-TYP-EDD                                         16360000
163200             PERFORM 5000-MOVE-TR014-EDD-TO-HOLD                  16370000
163300             PERFORM 5500-LOAD-EDD-TO-REPORT                      16380000
163400         WHEN REC-TYP-EDDRSN                                      16390000
163500             PERFORM 5010-MOVE-TR014-EDDRSN-TO-HOLD               16400000
163600             PERFORM 5510-LOAD-EDDRSN-TO-REPORT                   16410000
163700         WHEN REC-TYP-EDL                                         16420000
163800             PERFORM 5020-MOVE-TR014-EDL-TO-HOLD                  16430000
163900             PERFORM 5520-LOAD-EDL-TO-REPORT                      16440000
164000         WHEN REC-TYP-EDLVS                                       16450000
164100             PERFORM 5030-MOVE-TR014-EDLVS-TO-HOLD                16460000
164200             PERFORM 5530-LOAD-EDLVS-TO-REPORT                    16470000
164300         WHEN REC-TYP-EDLUPC                                      16480000
164400             PERFORM 5040-MOVE-TR014-EDLUPC-TO-HOLD               16490000
164500             PERFORM 5540-LOAD-EDLUPC-TO-REPORT                   16500000
164600     END-EVALUATE.                                                16510000
164700                                                                  16520000
164800******************************************************************16530000
164900* MOVE EDD RECORD KEY FIELDS TO HOLD AREA.                       *16540000
165000******************************************************************16550000
165100 4000-MOVE-TO-EDD-HOLD.                                           16560000
165200                                                                  16570000
165300     MOVE TR014-EDD-PO-NBR-X        TO PV-HOLD-PO-NBR-X.          16580000
165400     MOVE TR014-EDD-EXTL-REF-NBR    TO PV-HOLD-EXTL-REF-NBR.      16590000
165500     MOVE TR014-EDD-PO-BKG-DELY-DTE TO PV-HOLD-PO-BKG-DELY-DTE.   16600000
165600     MOVE TR014-EDD-PO-BKG-DELY-TM  TO PV-HOLD-PO-BKG-DELY-TM.    16610000
165700     MOVE TR014-EDD-ORGN-SHPD-FR-CDE TO PV-HOLD-ORGN-SHPD-FR-CDE. 16620000
165800     MOVE TR014-EDD-TRN-TYP         TO PV-HOLD-LAST-TRN-TYP.      16630000
165900                                                                  16640000
166000******************************************************************16650000
166100* MOVE EDLVS RECORD KEY FIELDS TO HOLD AREA.                     *16660000
166200******************************************************************16670000
166300 4010-MOVE-TO-EDLVS-HOLD.                                         16680000
166400                                                                  16690000
166500     MOVE TR014-EDLVS-PO-NBR-X        TO PV-HOLD-PO-NBR-X.        16700000
166600     MOVE TR014-EDLVS-EXTL-REF-NBR    TO PV-HOLD-EXTL-REF-NBR.    16710000
166700     MOVE TR014-EDLVS-PO-BKG-DELY-DTE TO PV-HOLD-PO-BKG-DELY-DTE. 16720000
166800     MOVE TR014-EDLVS-PO-BKG-DELY-TM  TO PV-HOLD-PO-BKG-DELY-TM.  16730000
166900     MOVE TR014-EDLVS-ORGN-SHPD-FR-CDE TO                         16740000
167000                                      PV-HOLD-ORGN-SHPD-FR-CDE.   16750000
167100     MOVE TR014-EDLVS-VS-NBR          TO PV-HOLD-VS-NBR.          16760000
167200     MOVE TR014-EDLVS-TRN-TYP         TO PV-HOLD-LAST-TRN-TYP.    16770000
167300                                                                  16780000
167400******************************************************************16790000
167500* MOVE EDLUPC RECORD KEY FIELDS TO HOLD AREA.                    *16800000
167600******************************************************************16810000
167700 4020-MOVE-TO-EDLUPC-HOLD.                                        16820000
167800                                                                  16830000
167900     MOVE TR014-EDLUPC-PO-NBR-X        TO PV-HOLD-PO-NBR-X.       16840000
168000     MOVE TR014-EDLUPC-EXTL-REF-NBR    TO PV-HOLD-EXTL-REF-NBR.   16850000
168100     MOVE TR014-EDLUPC-PO-BKG-DELY-DTE TO PV-HOLD-PO-BKG-DELY-DTE.16860000
168200     MOVE TR014-EDLUPC-PO-BKG-DELY-TM  TO PV-HOLD-PO-BKG-DELY-TM. 16870000
168300     MOVE TR014-EDLUPC-ORGN-SHPD-FR-CDE TO                        16880000
168400                                      PV-HOLD-ORGN-SHPD-FR-CDE.   16890000
168500     MOVE TR014-EDLUPC-VS-NBR          TO PV-HOLD-VS-NBR.         16900000
168600     MOVE TR014-EDLUPC-UPC-NBR         TO PV-HOLD-UPC-NBR.        16910000
168700     MOVE TR014-EDLUPC-TRN-TYP         TO PV-HOLD-LAST-TRN-TYP.   16920000
168800                                                                  16930000
168900******************************************************************16940000
169000* EDIT KEY FIELDS ON EDD, EDDRSN, AND EDL RECORDS.               *16950000
169100* CHECK FOR NUMERIC AND NOT BLANK ON PO NUMBER.                  *16960000
169200* CHECK FOR SPACES ON EXTERNAL REFERENCE NUMBER.                 *16970000
169300* CHECK FOR SPACES ON PO BOOKING DELIVERY DATE AND TIME.         *16980000
169400* CHECK FOR SPACES AND EQUAL TO CFS OR CY ON ORGN SHPD FROM CODE.*16990000
169500******************************************************************17000000
169600 4100-EDIT-EDD-EDL-KEY-FIELDS.                                    17010000
169700                                                                  17020000
169800     SET PS-FIELDS-OK TO TRUE.                                    17030000
169900                                                                  17040000
170000     MOVE PC-DEFAULT-TIME      TO PV-TR014-EDD-PO-BKG-DELY-TM.    17050000
170100                                                                  17060000
170200     EVALUATE TRUE                                                17070000
170300                                                                  17080000
170400        WHEN TR014-EDD-PO-BKG-DELY-DTE EQUAL SPACES               17090000
170500            SET PS-FIELDS-NOT-OK TO TRUE                          17100000
170600            MOVE TR014-EDD-PO-NBR TO PV-HOLD-TR201-DATA-VALUE     17110000
170700            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17120000
170800            MOVE 'BKG DELY DTE'                                   17130000
170900               TO PV-HOLD-TR201-DATA-IN-ERROR                     17140000
171000            MOVE 'BOOKING DELIVERY DATE NOT SENT'                 17150000
171100               TO PV-HOLD-TR201-ERROR-MSG                         17160000
171200                                                                  17170000
171300        WHEN (TR014-EDD-PO-NBR          EQUAL ZEROES  OR          17180000
171400              TR014-EDD-PO-NBR          NOT NUMERIC)  AND         17190000
171500             TR014-EDD-EXTL-REF-NBR    EQUAL SPACES   AND         17200000
171600             (TR014-EDD-ORGN-SHPD-FR-CDE EQUAL SPACES     OR      17210000
171700              (TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17220000
171800               TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17230000
171900            SET PS-FIELDS-NOT-OK TO TRUE                          17240000
172000            MOVE TR014-EDD-PO-NBR TO PV-HOLD-TR201-DATA-VALUE     17250000
172100            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17260000
172200            MOVE 'PO/EXT REF/SHPD' TO PV-HOLD-TR201-DATA-IN-ERROR 17270000
172300            MOVE 'PO NBR, EXT REF NBR, & ORG SHP FR DATA NOT SENT'17280000
172400                  TO PV-HOLD-TR201-ERROR-MSG                      17290000
172500                                                                  17300000
172600        WHEN (TR014-EDD-PO-NBR          EQUAL ZEROES  OR          17310000
172700              TR014-EDD-PO-NBR          NOT NUMERIC)  AND         17320000
172800             TR014-EDD-EXTL-REF-NBR    EQUAL SPACES               17330000
172900            SET PS-FIELDS-NOT-OK TO TRUE                          17340000
173000            MOVE TR014-EDD-PO-NBR TO PV-HOLD-TR201-DATA-VALUE     17350000
173100            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17360000
173200            MOVE 'PO NBR/EXTL REF' TO PV-HOLD-TR201-DATA-IN-ERROR 17370000
173300            MOVE 'PO NUMBER AND EXTERNAL REF NUMBER NOT SENT'     17380000
173400                  TO PV-HOLD-TR201-ERROR-MSG                      17390000
173500                                                                  17400000
173600        WHEN (TR014-EDD-PO-NBR          EQUAL ZEROES  OR          17410000
173700              TR014-EDD-PO-NBR          NOT NUMERIC)  AND         17420000
173800             (TR014-EDD-ORGN-SHPD-FR-CDE EQUAL SPACES     OR      17430000
173900              (TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17440000
174000               TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17450000
174100            SET PS-FIELDS-NOT-OK TO TRUE                          17460000
174200            MOVE TR014-EDD-PO-NBR TO PV-HOLD-TR201-DATA-VALUE     17470000
174300            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17480000
174400            MOVE 'PO NBR/ORG SHPD' TO PV-HOLD-TR201-DATA-IN-ERROR 17490000
174500            MOVE 'PO NUMBER AND ORG SHPD FROM DATA NOT SENT'      17500000
174600                  TO PV-HOLD-TR201-ERROR-MSG                      17510000
174700                                                                  17520000
174800        WHEN TR014-EDD-EXTL-REF-NBR    EQUAL SPACES   AND         17530000
174900             (TR014-EDD-ORGN-SHPD-FR-CDE EQUAL SPACES     OR      17540000
175000              (TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17550000
175100               TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17560000
175200            SET PS-FIELDS-NOT-OK TO TRUE                          17570000
175300            MOVE TR014-EDD-EXTL-REF-NBR    TO                     17580000
175400                  PV-HOLD-TR201-DATA-VALUE                        17590000
175500            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17600000
175600            MOVE 'EXT REF/ORG SHP' TO PV-HOLD-TR201-DATA-IN-ERROR 17610000
175700            MOVE 'EXT REF NBR AND ORG SHPD FROM DATA NOT SENT'    17620000
175800                  TO PV-HOLD-TR201-ERROR-MSG                      17630000
175900                                                                  17640000
176000        WHEN TR014-EDD-PO-NBR-X EQUAL SPACES OR ZEROES            17650000
176100            SET PS-FIELDS-NOT-OK TO TRUE                          17660000
176200            MOVE TR014-EDD-PO-NBR TO PV-HOLD-TR201-DATA-VALUE     17670000
176300            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17680000
176400            MOVE 'PO NBR' TO PV-HOLD-TR201-DATA-IN-ERROR          17690000
176500            MOVE 'PO NUMBER NOT SENT' TO PV-HOLD-TR201-ERROR-MSG  17700000
176600                                                                  17710000
176700        WHEN TR014-EDD-PO-NBR-X NOT NUMERIC                       17720000
176800            SET PS-FIELDS-NOT-OK TO TRUE                          17730000
176900            MOVE TR014-EDD-PO-NBR TO PV-HOLD-TR201-DATA-VALUE     17740000
177000            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17750000
177100            MOVE 'PO NBR' TO PV-HOLD-TR201-DATA-IN-ERROR          17760000
177200            MOVE 'INVALID PO NUMBER' TO PV-HOLD-TR201-ERROR-MSG   17770000
177300                                                                  17780000
177400                                                                  17790000
177500        WHEN TR014-EDD-EXTL-REF-NBR EQUAL SPACES                  17800000
177600            SET PS-FIELDS-NOT-OK TO TRUE                          17810000
177700            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17820000
177800            MOVE TR014-EDD-EXTL-REF-NBR TO                        17830000
177900                  PV-HOLD-TR201-DATA-VALUE                        17840000
178000            MOVE 'EXTL REF NBR ' TO PV-HOLD-TR201-DATA-IN-ERROR   17850000
178100            MOVE 'EXTERNAL REFERENCE NBR NOT SENT' TO             17860000
178200                  PV-HOLD-TR201-ERROR-MSG                         17870000
178300                                                                  17880000
178400        WHEN  TR014-EDD-ORGN-SHPD-FR-CDE EQUAL SPACES             17890000
178500        WHEN (TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND     17900000
178600               TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY)        17910000
178700            SET PS-FIELDS-NOT-OK TO TRUE                          17920000
178800            MOVE TR014-EDD-ORGN-SHPD-FR-CDE  TO                   17930000
178900                  PV-HOLD-TR201-DATA-VALUE                        17940000
179000            MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE             17950000
179100            MOVE 'ORGN SHPD FR CD' TO PV-HOLD-TR201-DATA-IN-ERROR 17960000
179200            MOVE 'ORGN SHPD FROM DATA NOT SENT'                   17970000
179300                  TO PV-HOLD-TR201-ERROR-MSG                      17980000
179400                                                                  17990000
179500        WHEN TR014-EDD-PO-BKG-DELY-DTE NOT EQUAL SPACES           18000000
179600            MOVE TR014-EDD-PO-BKG-DELY-DTE    TO PV-BKG-DELY-DTE  18010000
179700            MOVE PV-TR014-EDD-PO-BKG-DELY-TM  TO PV-BKG-DELY-TM   18020000
179800            PERFORM 5715-FORMAT-BKG-DELY-TMST                     18030000
179900            EVALUATE TRUE                                         18040000
180000                WHEN PS-WARNING-DATE                              18050000
180100                    SET PS-FIELDS-NOT-OK TO TRUE                  18060000
180200                    MOVE TR014-EDD-PO-BKG-DELY-DTE TO             18070000
180300                          PV-HOLD-TR201-DATA-VALUE                18080000
180400                    MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE     18090000
180500                    MOVE 'DELY DTE'                TO             18100000
180600                          PV-HOLD-TR201-DATA-IN-ERROR             18110000
180700                    MOVE 'INVALID DELIVERY DATE'   TO             18120000
180800                          PV-HOLD-TR201-ERROR-MSG                 18130000
180900                                                                  18140000
181000                WHEN PS-WARNING-TIME                              18150000
181100                    SET PS-FIELDS-NOT-OK TO TRUE                  18160000
181200                    MOVE TR014-EDD-PO-BKG-DELY-TM TO              18170000
181300                          PV-HOLD-TR201-DATA-VALUE                18180000
181400                    MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE     18190000
181500                    MOVE 'DELY TM' TO PV-HOLD-TR201-DATA-IN-ERROR 18200000
181600                    MOVE 'INVALID DELIVERY TIME'  TO              18210000
181700                          PV-HOLD-TR201-ERROR-MSG                 18220000
181800            END-EVALUATE                                          18230000
181900     END-EVALUATE.                                                18240000
182000                                                                  18250000
182100     SET PS-WARNING-DATE-NO TO TRUE.                              18260000
182200     SET PS-WARNING-TIME-NO TO TRUE.                              18270000
182300                                                                  18280000
182400******************************************************************18290000
182500* EDIT KEY FIELDS ON EDLVS RECORDS.                              *18300000
182600* CHECK FOR NUMERIC AND NOT BLANK PO NUMBER.                     *18310000
182700* CHECK FOR SPACES ON EXTERNAL REFERENCE NUMBER.                 *18320000
182800* CHECK FOR SPACES ON PO BOOKING DELIVERY DATE AND TIME.         *18330000
182900* CHECK FOR SPACES AND EQUAL TO CFS OR CY ON ORGN SHPD FROM CODE.*18340000
183000* CHECK FOR SPACES ON VENDOR STYLE NUMBER.                       *18350000
183100******************************************************************18360000
183200 4110-EDIT-EDLVS-KEY-FIELDS.                                      18370000
183300                                                                  18380000
183400     PERFORM 4100-EDIT-EDD-EDL-KEY-FIELDS.                        18390000
183500                                                                  18400000
183600     IF TR014-EDLVS-VS-NBR  = SPACES                              18410000
183700         MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE                18420000
183800         MOVE TR014-EDLVS-VS-NBR  TO                              18430000
183900               PV-HOLD-TR201-DATA-VALUE                           18440000
184000         MOVE 'VS NUMBER     '    TO                              18450000
184100               PV-HOLD-TR201-DATA-IN-ERROR                        18460000
184200         MOVE 'INVALID VS NUMBER' TO                              18470000
184300               PV-HOLD-TR201-ERROR-MSG                            18480000
184400         SET PS-FIELDS-NOT-OK    TO TRUE                          18490000
184500     END-IF.                                                      18500000
184600                                                                  18510000
184700******************************************************************18520000
184800* EDIT KEY FIELDS ON EDLUPC RECORDS.                             *18530000
184900* CHECK FOR NUMERIC AND NOT BLANK PO NUMBER.                     *18540000
185000* CHECK FOR NUMERIC UPC NUMBER.                                  *18550000
185100* CHECK FOR SPACES ON EXTERNAL REFERENCE NUMBER.                 *18560000
185200* CHECK FOR SPACES ON PO BOOKING DELIVERY DATE AND TIME.         *18570000
185300* CHECK FOR SPACES AND EQUAL TO CFS OR CY ON ORGN SHPD FROM CODE.*18580000
185400* CHECK FOR SPACES ON VENDOR STYLE NUMBER.                       *18590000
185500******************************************************************18600000
185600 4120-EDIT-EDLUPC-KEY-FIELDS.                                     18610000
185700                                                                  18620000
185800     PERFORM 4110-EDIT-EDLVS-KEY-FIELDS.                          18630000
185900                                                                  18640000
186000     IF TR014-EDLUPC-UPC-NBR NUMERIC AND                          18650000
186100        TR014-EDLUPC-UPC-NBR NOT = ZEROS                          18660000
186200         CONTINUE                                                 18670000
186300     ELSE                                                         18680000
186400         MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE                18690000
186500         MOVE TR014-EDLUPC-UPC-NBR  TO                            18700000
186600               PV-HOLD-TR201-DATA-VALUE                           18710000
186700         MOVE 'UPC NUMBER'          TO                            18720000
186800               PV-HOLD-TR201-DATA-IN-ERROR                        18730000
186900         MOVE 'INVALID UPC NUMBER'  TO                            18740000
187000               PV-HOLD-TR201-ERROR-MSG                            18750000
187100         SET PS-FIELDS-NOT-OK    TO TRUE                          18760000
187200     END-IF.                                                      18770000
187300                                                                  18780000
187400******************************************************************18790000
187500* PROCESS ERROR FOR EDD AND/OR EDL DATA MISSING.                 *18800000
187600******************************************************************18810000
187700 4200-EDD-EDL-DATA-MISSING-ERR.                                   18820000
187800                                                                  18830000
187900     PERFORM 4100-EDIT-EDD-EDL-KEY-FIELDS.                        18840000
188000                                                                  18850000
188100     IF PS-FIELDS-OK                                              18860000
188200         MOVE PC-ERROR           TO PV-HOLD-TR201-ERROR-TYPE      18870000
188300         MOVE TR014-EDLVS-PO-NBR TO PV-HOLD-TR201-DATA-VALUE      18880000
188400         MOVE 'PO LEVEL'         TO PV-HOLD-TR201-DATA-IN-ERROR   18890000
188500         MOVE 'EDD AND/OR EDL DATA MISSING' TO                    18900000
188600               PV-HOLD-TR201-ERROR-MSG                            18910000
188700     END-IF.                                                      18920000
188800                                                                  18930000
188900******************************************************************18940000
189000* PROCESS ERROR FOR EDLVS DATA MISSING.                          *18950000
189100******************************************************************18960000
189200 4210-EDLVS-DATA-MISSING-ERR.                                     18970000
189300                                                                  18980000
189400     PERFORM 4110-EDIT-EDLVS-KEY-FIELDS.                          18990000
189500                                                                  19000000
189600     IF PS-FIELDS-OK                                              19010000
189700         MOVE PC-ERROR             TO PV-HOLD-TR201-ERROR-TYPE    19020000
189800         MOVE TR014-EDLVS-VS-NBR   TO PV-HOLD-TR201-DATA-VALUE    19030000
189900         MOVE 'VS LEVEL'           TO PV-HOLD-TR201-DATA-IN-ERROR 19040000
190000         MOVE 'EDLVS DATA MISSING' TO PV-HOLD-TR201-ERROR-MSG     19050000
190100     END-IF.                                                      19060000
190200                                                                  19070000
190300******************************************************************19080000
190400* CHECK EDD AND EDL HOLD FIELDS WHEN READING THE BOOKING FILE.   *19090000
190500******************************************************************19100000
190600 4250-CHECK-EDD-EDL-HOLD-FIELDS.                                  19110000
190700                                                                  19120000
190800     IF TR014-EDD-PO-NBR-X         = PV-HOLD-PO-NBR-X         AND 19130000
190900        TR014-EDD-EXTL-REF-NBR     = PV-HOLD-EXTL-REF-NBR     AND 19140000
191000        TR014-EDD-PO-BKG-DELY-DTE  = PV-HOLD-PO-BKG-DELY-DTE  AND 19150000
191100        TR014-EDD-PO-BKG-DELY-TM   = PV-HOLD-PO-BKG-DELY-TM   AND 19160000
191200        TR014-EDD-ORGN-SHPD-FR-CDE = PV-HOLD-ORGN-SHPD-FR-CDE AND 19170000
191300        TR014-EDD-TRN-TYP          = PV-HOLD-LAST-TRN-TYP         19180000
191400         SET PS-SAME-INPUT-FIELDS TO TRUE                         19190000
191500     ELSE                                                         19200000
191600         SET PS-NOT-SAME-INPUT-FIELDS TO TRUE                     19210000
191700     END-IF.                                                      19220000
191800                                                                  19230000
191900******************************************************************19240000
192000* CHECK UPC HOLD FIELDS WHEN READING THE BOOKING FILE.           *19250000
192100******************************************************************19260000
192200 4260-CHECK-EDLVS-HOLD-FIELDS.                                    19270000
192300                                                                  19280000
192400     IF TR014-EDLUPC-PO-NBR-X        = PV-HOLD-PO-NBR-X     AND   19290000
192500        TR014-EDLUPC-EXTL-REF-NBR    = PV-HOLD-EXTL-REF-NBR AND   19300000
192600        TR014-EDLUPC-PO-BKG-DELY-DTE =                            19310000
192700                            PV-HOLD-PO-BKG-DELY-DTE         AND   19320000
192800        TR014-EDLUPC-ORGN-SHPD-FR-CDE =                           19330000
192900                            PV-HOLD-ORGN-SHPD-FR-CDE        AND   19340000
193000        TR014-EDLUPC-VS-NBR          = PV-HOLD-VS-NBR       AND   19350000
193100        TR014-EDLUPC-TRN-TYP         = PV-HOLD-LAST-TRN-TYP       19360000
193200         SET PS-SAME-INPUT-FIELDS TO TRUE                         19370000
193300     ELSE                                                         19380000
193400         SET PS-NOT-SAME-INPUT-FIELDS TO TRUE                     19390000
193500     END-IF.                                                      19400000
193600                                                                  19410000
193700******************************************************************19420000
193800* PROCESS PROPER ERROR WHEN THE HOLD FIELDS DO NOT EQUAL THE     *19430000
193900* CURRENT INPUT FIELDS.                                          *19440000
194000******************************************************************19450000
194100 4300-DIFFERENT-INPUT-FIELDS.                                     19460000
194200                                                                  19470000
194300     MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE.                   19480000
194400                                                                  19490000
194500     IF REC-TYP-EDLVS                                             19500000
194600         EVALUATE TRUE                                            19510000
194700             WHEN TR014-EDLVS-PO-NBR-X        NOT EQUAL           19520000
194800                   PV-HOLD-PO-NBR-X                               19530000
194900                 MOVE TR014-EDLVS-PO-NBR                      TO  19540000
195000                       PV-HOLD-TR201-DATA-VALUE                   19550000
195100                 MOVE 'PO NUMBER'                             TO  19560000
195200                       PV-HOLD-TR201-DATA-IN-ERROR                19570000
195300                 MOVE 'EDD AND/OR EDL DATA MISSING'           TO  19580000
195400                       PV-HOLD-TR201-ERROR-MSG                    19590000
195500                                                                  19600000
195600             WHEN TR014-EDLVS-EXTL-REF-NBR    NOT EQUAL           19610000
195700                   PV-HOLD-EXTL-REF-NBR                           19620000
195800                 MOVE TR014-EDLVS-EXTL-REF-NBR                TO  19630000
195900                       PV-HOLD-TR201-DATA-VALUE                   19640000
196000                 MOVE 'EXTL REF NBR'                          TO  19650000
196100                       PV-HOLD-TR201-DATA-IN-ERROR                19660000
196200                 MOVE 'EDD AND/OR EDL DATA MISSING'           TO  19670000
196300                       PV-HOLD-TR201-ERROR-MSG                    19680000
196400                                                                  19690000
196500             WHEN TR014-EDLVS-PO-BKG-DELY-DTE NOT EQUAL           19700000
196600                   PV-HOLD-PO-BKG-DELY-DTE                        19710000
196700                 MOVE TR014-EDLVS-PO-BKG-DELY-DTE             TO  19720000
196800                       PV-HOLD-TR201-DATA-VALUE                   19730000
196900                 MOVE 'BKG DELY DTE'                          TO  19740000
197000                       PV-HOLD-TR201-DATA-IN-ERROR                19750000
197100                 MOVE 'EDD AND/OR EDL DATA MISSING'           TO  19760000
197200                       PV-HOLD-TR201-ERROR-MSG                    19770000
197300                                                                  19780000
197400             WHEN TR014-EDLVS-ORGN-SHPD-FR-CDE NOT EQUAL          19790000
197500                   PV-HOLD-ORGN-SHPD-FR-CDE                       19800000
197600                 MOVE TR014-EDLVS-ORGN-SHPD-FR-CDE            TO  19810000
197700                       PV-HOLD-TR201-DATA-VALUE                   19820000
197800                 MOVE 'ORGN SHP FR CDE'                       TO  19830000
197900                       PV-HOLD-TR201-DATA-IN-ERROR                19840000
198000                 MOVE 'EDD AND/OR EDL DATA MISSING'           TO  19850000
198100                       PV-HOLD-TR201-ERROR-MSG                    19860000
198200                                                                  19870000
198300             WHEN TR014-EDLVS-TRN-TYP         NOT EQUAL           19880000
198400                   PV-HOLD-LAST-TRN-TYP                           19890000
198500                 MOVE TR014-EDLVS-TRN-TYP                     TO  19900000
198600                       PV-HOLD-TR201-DATA-VALUE                   19910000
198700                 MOVE 'TRAN TYPE'                             TO  19920000
198800                       PV-HOLD-TR201-DATA-IN-ERROR                19930000
198900                 MOVE 'EDD AND/OR EDL DATA MISSING'           TO  19940000
199000                       PV-HOLD-TR201-ERROR-MSG                    19950000
199100         END-EVALUATE                                             19960000
199200     END-IF.                                                      19970000
199300                                                                  19980000
199400     IF REC-TYP-EDLUPC                                            19990000
199500         EVALUATE TRUE                                            20000000
199600             WHEN TR014-EDLUPC-PO-NBR-X       NOT EQUAL           20010000
199700                   PV-HOLD-PO-NBR-X                               20020000
199800                 MOVE TR014-EDLUPC-PO-NBR                     TO  20030000
199900                       PV-HOLD-TR201-DATA-VALUE                   20040000
200000                 MOVE 'PO NUMBER'                             TO  20050000
200100                       PV-HOLD-TR201-DATA-IN-ERROR                20060000
200200                 MOVE 'EDD AND/OR EDL AND/OR VS DATA MISSING' TO  20070000
200300                       PV-HOLD-TR201-ERROR-MSG                    20080000
200400                                                                  20090000
200500             WHEN TR014-EDLUPC-EXTL-REF-NBR   NOT EQUAL           20100000
200600                   PV-HOLD-EXTL-REF-NBR                           20110000
200700                 MOVE TR014-EDLUPC-EXTL-REF-NBR               TO  20120000
200800                       PV-HOLD-TR201-DATA-VALUE                   20130000
200900                 MOVE 'EXTL REF NBR'                          TO  20140000
201000                       PV-HOLD-TR201-DATA-IN-ERROR                20150000
201100                 MOVE 'EDD AND/OR EDL AND/OR VS DATA MISSING' TO  20160000
201200                       PV-HOLD-TR201-ERROR-MSG                    20170000
201300                                                                  20180000
201400             WHEN TR014-EDLUPC-PO-BKG-DELY-DTE NOT EQUAL          20190000
201500                   PV-HOLD-PO-BKG-DELY-DTE                        20200000
201600                 MOVE TR014-EDLUPC-PO-BKG-DELY-DTE            TO  20210000
201700                       PV-HOLD-TR201-DATA-VALUE                   20220000
201800                 MOVE 'BKG DELY DTE'                          TO  20230000
201900                       PV-HOLD-TR201-DATA-IN-ERROR                20240000
202000                 MOVE 'EDD AND/OR EDL AND/OR VS DATA MISSING' TO  20250000
202100                       PV-HOLD-TR201-ERROR-MSG                    20260000
202200                                                                  20270000
202300             WHEN TR014-EDLUPC-ORGN-SHPD-FR-CDE NOT EQUAL         20280000
202400                   PV-HOLD-ORGN-SHPD-FR-CDE                       20290000
202500                 MOVE TR014-EDLUPC-ORGN-SHPD-FR-CDE           TO  20300000
202600                       PV-HOLD-TR201-DATA-VALUE                   20310000
202700                 MOVE 'ORGN SHP FR CDE'                       TO  20320000
202800                       PV-HOLD-TR201-DATA-IN-ERROR                20330000
202900                 MOVE 'EDD AND/OR EDL AND/OR VS DATA MISSING' TO  20340000
203000                       PV-HOLD-TR201-ERROR-MSG                    20350000
203100                                                                  20360000
203200             WHEN TR014-EDLUPC-VS-NBR         NOT EQUAL           20370000
203300                   PV-HOLD-VS-NBR                                 20380000
203400                 MOVE TR014-EDLUPC-VS-NBR                     TO  20390000
203500                       PV-HOLD-TR201-DATA-VALUE                   20400000
203600                 MOVE 'VS NUMBER'                             TO  20410000
203700                       PV-HOLD-TR201-DATA-IN-ERROR                20420000
203800                 MOVE 'EDD AND/OR EDL AND/OR VS DATA MISSING' TO  20430000
203900                       PV-HOLD-TR201-ERROR-MSG                    20440000
204000                                                                  20450000
204100             WHEN TR014-EDLUPC-TRN-TYP        NOT EQUAL           20460000
204200                   PV-HOLD-LAST-TRN-TYP                           20470000
204300                 MOVE TR014-EDLUPC-TRN-TYP                    TO  20480000
204400                       PV-HOLD-TR201-DATA-VALUE                   20490000
204500                 MOVE 'TRAN TYPE'                             TO  20500000
204600                       PV-HOLD-TR201-DATA-IN-ERROR                20510000
204700                 MOVE 'EDD AND/OR EDL AND/OR VS DATA MISSING' TO  20520000
204800                       PV-HOLD-TR201-ERROR-MSG                    20530000
204900         END-EVALUATE                                             20540000
205000     END-IF.                                                      20550000
205100                                                                  20560000
205200***************************************************************** 20570000
205300* RESET WRITE SWITCHES FOR EDITED EXTRACT FILE.                 * 20580000
205400***************************************************************** 20590000
205500 4900-RESET-WRITE-SWITCHES.                                       20600000
205600                                                                  20610000
205700     EVALUATE TRUE                                                20620000
205800        WHEN                                                      20630000
205900            (TR014-EDD-PO-NBR-X         NOT EQUAL                 20640000
206000             PV-HOLD-PO-NBR-X)                       OR           20650000
206100            (TR014-EDD-EXTL-REF-NBR     NOT EQUAL                 20660000
206200             PV-HOLD-EXTL-REF-NBR)                   OR           20670000
206300            (TR014-EDD-PO-BKG-DELY-DTE  NOT EQUAL                 20680000
206400             PV-HOLD-PO-BKG-DELY-DTE)                OR           20690000
206500            (TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL                 20700000
206600             PV-HOLD-ORGN-SHPD-FR-CDE)               OR           20710000
206700            (TR014-EDD-TRN-TYP          NOT EQUAL                 20720000
206800             PV-HOLD-LAST-TRN-TYP)                                20730000
206900                SET PS-GOOD-EDD-EDL-WRITE-NO   TO TRUE            20740000
207000                SET PS-GOOD-EDLVS-WRITE-NO     TO TRUE            20750000
207100                                                                  20760000
207200        WHEN REC-TYP-EDLVS                           OR           20770000
207300             REC-TYP-EDLUPC                                       20780000
207400             EVALUATE TRUE                                        20790000
207500                 WHEN                                             20800000
207600                     (TR014-EDLVS-PO-NBR-X     NOT EQUAL          20810000
207700                         PV-HOLD-PO-NBR-X)           AND          20820000
207800                     (TR014-EDLVS-VS-NBR       NOT EQUAL          20830000
207900                         PV-HOLD-VS-NBR)                          20840000
208000                        SET PS-GOOD-EDLVS-WRITE-NO     TO TRUE    20850000
208100                                                                  20860000
208200                 WHEN                                             20870000
208300                     (TR014-EDLVS-VS-NBR       NOT EQUAL          20880000
208400                         PV-HOLD-VS-NBR)                          20890000
208500                        SET PS-GOOD-EDLVS-WRITE-NO     TO TRUE    20900000
208600             END-EVALUATE                                         20910000
208700     END-EVALUATE.                                                20920000
208800                                                                  20930000
208900******************************************************************20940000
209000*  MOVE EDD INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO BE  *20950000
209100*  USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.      *20960000
209200******************************************************************20970000
209300 5000-MOVE-TR014-EDD-TO-HOLD.                                     20980000
209400                                                                  20990000
209500     INITIALIZE PV-TR014-REC-TYP-EDD.                             21000000
209600                                                                  21010000
209700     MOVE TR014-EDD-TRN-TYP        TO PV-TR014-EDD-TRN-TYP.       21020000
209800     MOVE PC-EDD                   TO PV-TR014-EDD-REC-TYP-CDE.   21030000
209900     MOVE PC-10                    TO PV-TR014-EDD-SEQ-NBR.       21040000
210000     MOVE TR014-EDD-3RD-PARTY-CDE  TO PV-TR014-EDD-3RD-PARTY-CDE. 21050000
210100                                                                  21060000
210200     IF TR014-EDD-PO-NBR NUMERIC                                  21070000
210300         MOVE TR014-EDD-PO-NBR          TO PV-TR014-EDD-PO-NBR    21080000
210400     ELSE                                                         21090000
210500         MOVE TR014-EDD-PO-NBR-X        TO PV-TR014-EDD-PO-NBR-X  21100000
210600     END-IF.                                                      21110000
210700                                                                  21120000
210800     MOVE TR014-EDD-EXTL-REF-NBR    TO                            21130000
210900                                PV-TR014-EDD-EXTL-REF-NBR.        21140000
211000                                                                  21150000
211100     IF TR014-EDD-PO-BKG-DELY-DTE EQUAL SPACES                    21160000
211200         MOVE PC-DEFAULT-DATE      TO                             21170000
211300                                PV-TR014-EDD-PO-BKG-DELY-DTE      21180000
211400     ELSE                                                         21190000
211500         MOVE TR014-EDD-PO-BKG-DELY-DTE TO                        21200000
211600                                PV-TR014-EDD-PO-BKG-DELY-DTE      21210000
211700     END-IF.                                                      21220000
211800                                                                  21230000
211900     MOVE PC-DEFAULT-TIME      TO PV-TR014-EDD-PO-BKG-DELY-TM.    21240000
212000                                                                  21250000
212100     MOVE TR014-EDD-ORGN-SHPD-FR-CDE TO                           21260000
212200                                   PV-TR014-EDD-ORGN-SHPD-FR-CDE. 21270000
212300     MOVE TR014-EDD-IMPRT-TRIP-ID  TO PV-TR014-EDD-IMPRT-TRIP-ID. 21280000
212400     MOVE TR014-EDD-CARR-SCAC-ID   TO PV-TR014-EDD-CARR-SCAC-ID.  21290000
212500     MOVE TR014-EDD-IMPRT-VEH-NM   TO PV-TR014-EDD-IMPRT-VEH-NM.  21300000
212600                                                                  21310000
212700     MOVE TR014-EDD-POE-DELY-DTE   TO PV-TR014-EDD-POE-DELY-DTE.  21320000
212800     MOVE TR014-EDD-POE-DELY-TM    TO PV-TR014-EDD-POE-DELY-TM.   21330000
212900     MOVE TR014-EDD-DPRTR-DTE      TO PV-TR014-EDD-DPRTR-DTE.     21340000
213000     MOVE TR014-EDD-DPRTR-TM       TO PV-TR014-EDD-DPRTR-TM.      21350000
213100     MOVE TR014-EDD-FOB-CDE        TO PV-TR014-EDD-FOB-CDE.       21360000
213200     MOVE TR014-EDD-DEST-POE-CDE   TO PV-TR014-EDD-DEST-POE-CDE.  21370000
213300     MOVE TR014-EDD-TRIP-TYP-CDE   TO PV-TR014-EDD-TRIP-TYP-CDE.  21371000
213400     MOVE TR014-EDD-EST-LBD-NM     TO PV-TR014-EDD-EST-LBD-NM.    21380000
213500     MOVE TR014-EDD-FILE-ID        TO PV-TR014-EDD-FILE-ID.       21390000
213600     MOVE TR014-EDD-ENT-ID         TO PV-TR014-EDD-ENT-ID.        21391000
213700     MOVE PV-PROCESS-SEQ-NBR       TO PV-TR014-EDD-PROC-SEQ-NBR.  21400000
213800                                                                  21410000
213900******************************************************************21420000
214000*  MOVE EDDRSN INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO  *21430000
214100*  BE USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.   *21440000
214200******************************************************************21450000
214300 5010-MOVE-TR014-EDDRSN-TO-HOLD.                                  21460000
214400                                                                  21470000
214500     INITIALIZE PV-TR014-REC-TYP-EDDRSN.                          21480000
214600                                                                  21490000
214700     MOVE TR014-EDDRSN-TRN-TYP     TO PV-TR014-EDDRSN-TRN-TYP.    21500000
214800     MOVE PC-EDDRSN                TO PV-TR014-EDDRSN-REC-TYP-CDE.21510000
214900     MOVE PC-11                    TO PV-TR014-EDDRSN-SEQ-NBR.    21520000
215000     MOVE TR014-EDDRSN-3RD-PARTY-CDE TO                           21530000
215100                                   PV-TR014-EDDRSN-3RD-PARTY-CDE. 21540000
215200                                                                  21550000
215300     IF TR014-EDDRSN-PO-NBR NUMERIC                               21560000
215400         MOVE TR014-EDDRSN-PO-NBR    TO PV-TR014-EDDRSN-PO-NBR    21570000
215500     ELSE                                                         21580000
215600         MOVE TR014-EDDRSN-PO-NBR-X  TO PV-TR014-EDDRSN-PO-NBR-X  21590000
215700     END-IF.                                                      21600000
215800                                                                  21610000
215900     MOVE TR014-EDDRSN-EXTL-REF-NBR    TO                         21620000
216000                                  PV-TR014-EDDRSN-EXTL-REF-NBR.   21630000
216100                                                                  21640000
216200     IF TR014-EDDRSN-PO-BKG-DELY-DTE EQUAL SPACES                 21650000
216300         MOVE PC-DEFAULT-DATE      TO                             21660000
216400                                PV-TR014-EDDRSN-PO-BKG-DELY-DT    21670000
216500     ELSE                                                         21680000
216600         MOVE TR014-EDDRSN-PO-BKG-DELY-DTE TO                     21690000
216700                                PV-TR014-EDDRSN-PO-BKG-DELY-DT    21700000
216800     END-IF.                                                      21710000
216900                                                                  21720000
217000     MOVE PC-DEFAULT-TIME  TO PV-TR014-EDDRSN-PO-BKG-DELY-TM.     21730000
217100                                                                  21740000
217200     MOVE TR014-EDDRSN-ORGN-SHPD-FR-CDE TO                        21750000
217300                              PV-TR014-EDDRSN-ORG-SHP-FR-CDE.     21760000
217400     MOVE TR014-EDDRSN-IMPRT-TRIP-ID   TO                         21770000
217500                                  PV-TR014-EDDRSN-IMPRT-TRIP-ID.  21780000
217600     MOVE TR014-EDDRSN-CARR-SCAC-ID    TO                         21790000
217700                                  PV-TR014-EDDRSN-CARR-SCAC-ID.   21800000
217800                                                                  21810000
217900     MOVE TR014-EDDRSN-POE-DELY-DTE    TO                         21820000
218000                                PV-TR014-EDDRSN-POE-DELY-DTE.     21830000
218100     MOVE TR014-EDDRSN-POE-DELY-TM     TO                         21840000
218200                                PV-TR014-EDDRSN-POE-DELY-TM.      21850000
218300     MOVE TR014-EDDRSN-DPRTR-DTE      TO PV-TR014-EDDRSN-DPRTR-DTE21860000
218400     MOVE TR014-EDDRSN-DPRTR-TM       TO PV-TR014-EDDRSN-DPRTR-TM.21870000
218500     MOVE TR014-EDDRSN-VOY-CHG-RSN-DESC TO                        21880000
218600                                PV-TR014-EDDRSN-VOY-CHG-RSN-DS.   21890000
218700     MOVE TR014-EDDRSN-FILE-ID     TO PV-TR014-EDDRSN-FILE-ID.    21891000
218800     MOVE TR014-EDDRSN-ENT-ID      TO PV-TR014-EDDRSN-ENT-ID.     21892000
218900     MOVE PV-PROCESS-SEQ-NBR     TO PV-TR014-EDDRSN-PROC-SEQ-NBR. 21900000
219000                                                                  21910000
219100******************************************************************21920000
219200*  MOVE EDL INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO BE  *21930000
219300*  USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.      *21940000
219400******************************************************************21950000
219500 5020-MOVE-TR014-EDL-TO-HOLD.                                     21960000
219600                                                                  21970000
219700     INITIALIZE PV-TR014-REC-TYP-EDL.                             21980000
219800                                                                  21990000
219900     MOVE TR014-EDL-TRN-TYP        TO PV-TR014-EDL-TRN-TYP.       22000000
220000     MOVE PC-EDL                   TO PV-TR014-EDL-REC-TYP-CDE.   22010000
220100     MOVE PC-20                    TO PV-TR014-EDL-SEQ-NBR.       22020000
220200     MOVE TR014-EDL-3RD-PARTY-CDE  TO PV-TR014-EDL-3RD-PARTY-CDE. 22030000
220300                                                                  22040000
220400     IF TR014-EDL-PO-NBR NUMERIC                                  22050000
220500         MOVE TR014-EDL-PO-NBR    TO PV-TR014-EDL-PO-NBR          22060000
220600     ELSE                                                         22070000
220700         MOVE TR014-EDL-PO-NBR-X  TO PV-TR014-EDL-PO-NBR-X        22080000
220800     END-IF.                                                      22090000
220900                                                                  22100000
221000     MOVE TR014-EDL-EXTL-REF-NBR    TO PV-TR014-EDL-EXTL-REF-NBR. 22110000
221100                                                                  22120000
221200     IF TR014-EDL-PO-BKG-DELY-DTE EQUAL SPACES                    22130000
221300         MOVE PC-DEFAULT-DATE      TO                             22140000
221400                                PV-TR014-EDL-PO-BKG-DELY-DTE      22150000
221500     ELSE                                                         22160000
221600         MOVE TR014-EDL-PO-BKG-DELY-DTE TO                        22170000
221700                                PV-TR014-EDL-PO-BKG-DELY-DTE      22180000
221800     END-IF.                                                      22190000
221900                                                                  22200000
222000     MOVE PC-DEFAULT-TIME  TO PV-TR014-EDL-PO-BKG-DELY-TM.        22210000
222100                                                                  22220000
222200     MOVE TR014-EDL-ORGN-SHPD-FR-CDE TO                           22230000
222300                                   PV-TR014-EDL-ORGN-SHPD-FR-CDE. 22240000
222400                                                                  22250000
222500     IF TR014-EDL-PO-CART-CNT NUMERIC                             22260000
222600         MOVE TR014-EDL-PO-CART-CNT     TO                        22270000
222700                                    PV-TR014-EDL-PO-CART-CNT      22280000
222800     ELSE                                                         22290000
222900         MOVE TR014-EDL-PO-CART-CNT-X   TO                        22300000
223000                                    PV-TR014-EDL-PO-CART-CNT-X    22310000
223100     END-IF.                                                      22320000
223200                                                                  22330000
223300     IF TR014-EDL-PO-UNT-QTY NUMERIC                              22340000
223400         MOVE TR014-EDL-PO-UNT-QTY      TO                        22350000
223500                                    PV-TR014-EDL-PO-UNT-QTY       22360000
223600     ELSE                                                         22370000
223700         MOVE TR014-EDL-PO-UNT-QTY-X    TO                        22380000
223800                                    PV-TR014-EDL-PO-UNT-QTY-X     22390000
223900     END-IF.                                                      22400000
224000                                                                  22410000
224100     IF TR014-EDL-PO-CBMT-QTY NUMERIC                             22420000
224200         MOVE TR014-EDL-PO-CBMT-QTY     TO                        22430000
224300                                    PV-TR014-EDL-PO-CBMT-QTY      22440000
224400     ELSE                                                         22450000
224500         MOVE TR014-EDL-PO-CBMT-QTY-X    TO                       22460000
224600                                    PV-TR014-EDL-PO-CBMT-QTY-X    22470000
224700     END-IF.                                                      22480000
224800                                                                  22490000
224900     IF TR014-EDL-PO-WT-KGRM-QTY NUMERIC                          22500000
225000         MOVE TR014-EDL-PO-WT-KGRM-QTY  TO                        22510000
225100                                    PV-TR014-EDL-PO-WT-KGRM-QTY   22520000
225200     ELSE                                                         22530000
225300         MOVE TR014-EDL-PO-WT-KGRM-QTY-X TO                       22540000
225400                                    PV-TR014-EDL-PO-WT-KGRM-QTY-X 22550000
225500     END-IF.                                                      22560000
225600                                                                  22570000
225700     MOVE TR014-EDL-PROD-FCTRY-NM   TO                            22580000
225800                                   PV-TR014-EDL-PROD-FCTRY-NM.    22590000
225900     MOVE TR014-EDL-C-O-PROD-CDE    TO PV-TR014-EDL-C-O-PROD-CDE. 22600000
226000     MOVE TR014-EDL-CONSOL-SCAC-ID  TO                            22610000
226100                                   PV-TR014-EDL-CONSOL-SCAC-ID.   22620000
226200     MOVE TR014-EDL-FILE-ID        TO PV-TR014-EDL-FILE-ID.       22621000
226300     MOVE TR014-EDL-ENT-ID         TO PV-TR014-EDL-ENT-ID.        22622000
226400     MOVE PV-PROCESS-SEQ-NBR       TO PV-TR014-EDL-PROC-SEQ-NBR.  22640000
226500                                                                  22650000
226600******************************************************************22660000
226700*  MOVE EDLVS INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO BE*22670000
226800*  USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.      *22680000
226900******************************************************************22690000
227000 5030-MOVE-TR014-EDLVS-TO-HOLD.                                   22700000
227100                                                                  22710000
227200     INITIALIZE PV-TR014-REC-TYP-EDLVS.                           22720000
227300                                                                  22730000
227400     MOVE TR014-EDLVS-TRN-TYP       TO PV-TR014-EDLVS-TRN-TYP.    22740000
227500     MOVE PC-EDLVS                  TO PV-TR014-EDLVS-REC-TYP-CDE.22750000
227600     MOVE PC-21                     TO PV-TR014-EDLVS-SEQ-NBR.    22760000
227700     MOVE TR014-EDLVS-3RD-PARTY-CDE TO                            22770000
227800                                PV-TR014-EDLVS-3RD-PARTY-CDE.     22780000
227900                                                                  22790000
228000     IF TR014-EDLVS-PO-NBR NUMERIC                                22800000
228100         MOVE TR014-EDLVS-PO-NBR    TO PV-TR014-EDLVS-PO-NBR      22810000
228200     ELSE                                                         22820000
228300         MOVE TR014-EDLVS-PO-NBR-X  TO PV-TR014-EDLVS-PO-NBR-X    22830000
228400     END-IF.                                                      22840000
228500                                                                  22850000
228600     MOVE TR014-EDLVS-EXTL-REF-NBR TO PV-TR014-EDLVS-EXTL-REF-NBR.22860000
228700                                                                  22870000
228800     IF TR014-EDLVS-PO-BKG-DELY-DTE EQUAL SPACES                  22880000
228900         MOVE PC-DEFAULT-DATE      TO                             22890000
229000                                PV-TR014-EDLVS-PO-BKG-DELY-DTE    22900000
229100     ELSE                                                         22910000
229200         MOVE TR014-EDLVS-PO-BKG-DELY-DTE TO                      22920000
229300                                PV-TR014-EDLVS-PO-BKG-DELY-DTE    22930000
229400     END-IF.                                                      22940000
229500                                                                  22950000
229600     MOVE PC-DEFAULT-TIME  TO PV-TR014-EDLVS-PO-BKG-DELY-TM.      22960000
229700                                                                  22970000
229800     MOVE TR014-EDLVS-ORGN-SHPD-FR-CDE TO                         22980000
229900                                   PV-TR014-EDLVS-ORG-SHP-FR-CDE. 22990000
230000                                                                  23000000
230100     MOVE TR014-EDLVS-VS-NBR          TO PV-TR014-EDLVS-VS-NBR.   23010000
230200                                                                  23020000
230300     IF TR014-EDLVS-VS-CART-CNT NUMERIC                           23030000
230400         MOVE TR014-EDLVS-VS-CART-CNT    TO                       23040000
230500                                   PV-TR014-EDLVS-CART-CNT        23050000
230600     ELSE                                                         23060000
230700         MOVE TR014-EDLVS-VS-CART-CNT-X  TO                       23070000
230800                                   PV-TR014-EDLVS-CART-CNT-X      23080000
230900     END-IF.                                                      23090000
231000                                                                  23100000
231100     IF TR014-EDLVS-VS-UNT-QTY NUMERIC                            23110000
231200         MOVE TR014-EDLVS-VS-UNT-QTY     TO                       23120000
231300                                   PV-TR014-EDLVS-UNT-QTY         23130000
231400     ELSE                                                         23140000
231500         MOVE TR014-EDLVS-VS-UNT-QTY-X   TO                       23150000
231600                                   PV-TR014-EDLVS-UNT-QTY-X       23160000
231700     END-IF.                                                      23170000
231800                                                                  23180000
231900     IF TR014-EDLVS-VS-CBMT-QTY NUMERIC                           23190000
232000         MOVE TR014-EDLVS-VS-CBMT-QTY    TO                       23200000
232100                                   PV-TR014-EDLVS-CBMT-QTY        23210000
232200     ELSE                                                         23220000
232300         MOVE TR014-EDLVS-VS-CBMT-QTY-X  TO                       23230000
232400                                   PV-TR014-EDLVS-CBMT-QTY-X      23240000
232500     END-IF.                                                      23250000
232600                                                                  23260000
232700     IF TR014-EDLVS-VS-WT-KGRM-QTY NUMERIC                        23270000
232800         MOVE TR014-EDLVS-VS-WT-KGRM-QTY   TO                     23280000
232900                                   PV-TR014-EDLVS-WT-KGRM-QTY     23290000
233000     ELSE                                                         23300000
233100         MOVE TR014-EDLVS-VS-WT-KGRM-QTY-X TO                     23310000
233200                                   PV-TR014-EDLVS-WT-KGRM-QTY-X   23320000
233300     END-IF.                                                      23330000
233310     MOVE TR014-EDLVS-FILE-ID      TO PV-TR014-EDLVS-FILE-ID.     23331000
233320     MOVE TR014-EDLVS-ENT-ID       TO PV-TR014-EDLVS-ENT-ID.      23332000
233330     MOVE PV-PROCESS-SEQ-NBR      TO PV-TR014-EDLVS-PROC-SEQ-NBR. 23350000
233340                                                                  23360000
233350******************************************************************23370000
233360*  MOVE EDLUPC INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO  *23380000
233370*  BE USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.   *23390000
233380******************************************************************23400000
233390 5040-MOVE-TR014-EDLUPC-TO-HOLD.                                  23410000
233400                                                                  23420000
233500     INITIALIZE PV-TR014-REC-TYP-EDLUPC.                          23430000
233600                                                                  23440000
233700     MOVE TR014-EDLUPC-TRN-TYP       TO PV-TR014-EDLUPC-TRN-TYP.  23450000
233800     MOVE PC-EDLUPC                  TO                           23460000
233900                                PV-TR014-EDLUPC-REC-TYP-CDE.      23470000
234000     MOVE PC-22                      TO PV-TR014-EDLUPC-SEQ-NBR.  23480000
234100     MOVE TR014-EDLUPC-3RD-PARTY-CDE TO                           23490000
234200                                PV-TR014-EDLUPC-3RD-PARTY-CDE.    23500000
234300                                                                  23510000
234400     IF TR014-EDLUPC-PO-NBR NUMERIC                               23520000
234500         MOVE TR014-EDLUPC-PO-NBR   TO PV-TR014-EDLUPC-PO-NBR     23530000
234600     ELSE                                                         23540000
234700         MOVE TR014-EDLUPC-PO-NBR-X TO PV-TR014-EDLUPC-PO-NBR-X   23550000
234800     END-IF.                                                      23560000
234900                                                                  23570000
235000     MOVE TR014-EDLUPC-EXTL-REF-NBR TO                            23580000
235100                                PV-TR014-EDLUPC-EXTL-REF-NBR.     23590000
235200                                                                  23600000
235300     IF TR014-EDLUPC-PO-BKG-DELY-DTE EQUAL SPACES                 23610000
235400         MOVE PC-DEFAULT-DATE      TO                             23620000
235500                                PV-TR014-EDLUPC-PO-BKG-DELY-DT    23630000
235600     ELSE                                                         23640000
235700         MOVE TR014-EDLUPC-PO-BKG-DELY-DTE TO                     23650000
235800                                PV-TR014-EDLUPC-PO-BKG-DELY-DT    23660000
235900     END-IF.                                                      23670000
236000                                                                  23680000
236100     MOVE PC-DEFAULT-TIME  TO PV-TR014-EDLUPC-PO-BKG-DELY-TM.     23690000
236200                                                                  23700000
236300     MOVE TR014-EDLUPC-ORGN-SHPD-FR-CDE TO                        23710000
236400                                 PV-TR014-EDLUPC-ORG-SHP-FR-CDE.  23720000
236500                                                                  23730000
236600     MOVE TR014-EDLUPC-VS-NBR       TO PV-TR014-EDLUPC-VS-NBR.    23740000
236700                                                                  23750000
236800     IF TR014-EDLUPC-UPC-NBR NUMERIC                              23760000
236900         MOVE TR014-EDLUPC-UPC-NBR    TO                          23770000
237000                                PV-TR014-EDLUPC-UPC-NBR           23780000
237100     ELSE                                                         23790000
237200         MOVE TR014-EDLUPC-UPC-NBR-X  TO                          23800000
237300                                PV-TR014-EDLUPC-UPC-NBR-X         23810000
237400     END-IF.                                                      23820000
237500                                                                  23830000
237600     IF TR014-EDLUPC-UPC-CART-CNT NUMERIC                         23840000
237700         MOVE TR014-EDLUPC-UPC-CART-CNT   TO                      23850000
237800                                PV-TR014-EDLUPC-CART-CNT          23860000
237900     ELSE                                                         23870000
238000         MOVE TR014-EDLUPC-UPC-CART-CNT-X TO                      23880000
238100                                PV-TR014-EDLUPC-CART-CNT-X        23890000
238200     END-IF.                                                      23900000
238300                                                                  23910000
238400     IF TR014-EDLUPC-UPC-UNT-QTY NUMERIC                          23920000
238500         MOVE TR014-EDLUPC-UPC-UNT-QTY    TO                      23930000
238600                                PV-TR014-EDLUPC-UNT-QTY           23940000
238700     ELSE                                                         23950000
238800         MOVE TR014-EDLUPC-UPC-UNT-QTY-X  TO                      23960000
238900                                PV-TR014-EDLUPC-UNT-QTY-X         23970000
239000     END-IF.                                                      23980000
239100                                                                  23990000
239200     IF TR014-EDLUPC-UPC-CBMT-QTY NUMERIC                         24000000
239300         MOVE TR014-EDLUPC-UPC-CBMT-QTY    TO                     24010000
239400                                PV-TR014-EDLUPC-CBMT-QTY          24020000
239500     ELSE                                                         24030000
239600         MOVE TR014-EDLUPC-UPC-CBMT-QTY-X  TO                     24040000
239700                                PV-TR014-EDLUPC-CBMT-QTY-X        24050000
239800     END-IF.                                                      24060000
239900                                                                  24070000
240000     IF TR014-EDLUPC-UPC-WT-KGRM-QTY NUMERIC                      24080000
240100         MOVE TR014-EDLUPC-UPC-WT-KGRM-QTY    TO                  24090000
240200                                PV-TR014-EDLUPC-WT-KGRM-QTY       24100000
240300     ELSE                                                         24110000
240400         MOVE TR014-EDLUPC-UPC-WT-KGRM-QTY-X  TO                  24120000
240500                                PV-TR014-EDLUPC-WT-KGRM-QTY-X     24130000
240600     END-IF.                                                      24140000
240700                                                                  24140100
240800     MOVE TR014-EDLUPC-FILE-ID     TO PV-TR014-EDLUPC-FILE-ID.    24141000
240900     MOVE TR014-EDLUPC-ENT-ID      TO PV-TR014-EDLUPC-ENT-ID.     24142000
241000     MOVE PV-PROCESS-SEQ-NBR   TO PV-TR014-EDLUPC-PROC-SEQ-NBR.   24160000
241100                                                                  24170000
241200******************************************************************24180000
241300*  MOVE WORKING STORAGE EDD RECORD FIELDS TO THE EDITED UPDATE   *24190000
241400*  EXTRACT FILE.  THIS FILE WILL BE PASSED TO THE UPDATE PROGRAM.*24200000
241500******************************************************************24210000
241600 5300-LOAD-EDD-FIELDS-UPDATE.                                     24220000
241700                                                                  24230000
241800     PERFORM 5400-INITIAL-EDD-FIELDS-UPD.                         24240000
241900                                                                  24250000
242000     MOVE PV-TR014-EDD-TRN-TYP        TO TR024-EDD-TRN-TYP.       24260000
242100     MOVE PC-EDD                      TO TR024-EDD-REC-TYP-CDE.   24270000
242200     MOVE PC-10                       TO TR024-EDD-SEQ-NBR.       24280000
242300     MOVE PV-TR014-EDD-3RD-PARTY-CDE  TO TR024-EDD-3RD-PARTY-CDE. 24290000
242400                                                                  24300000
242500     EVALUATE TRUE                                                24310000
242600                                                                  24320000
242700         WHEN PV-TR014-EDD-PO-NBR NOT NUMERIC OR                  24330000
242800              PV-TR014-EDD-PO-NBR  = ZERO                         24340000
242900             SET PS-EDIT-ERROR TO TRUE                            24350000
243000             MOVE PC-ERROR    TO PV-HOLD-TR201-ERROR-TYPE         24360000
243100             MOVE 'PO NUMBER' TO PV-HOLD-TR201-DATA-IN-ERROR      24370000
243200             MOVE PV-TR014-EDD-PO-NBR TO PV-HOLD-TR201-DATA-VALUE 24380000
243300             MOVE 'INVALID PO NUMBER' TO                          24390000
243400                   PV-HOLD-TR201-ERROR-MSG                        24400000
243500             PERFORM 5500-LOAD-EDD-TO-REPORT                      24410000
243600                                                                  24420000
243700         WHEN PV-TR014-EDD-EXTL-REF-NBR EQUAL SPACES              24430000
243800             SET PS-EDIT-ERROR TO TRUE                            24440000
243900             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            24450000
244000             MOVE 'EXTL REF NBR'   TO PV-HOLD-TR201-DATA-IN-ERROR 24460000
244100             MOVE PV-TR014-EDD-EXTL-REF-NBR   TO                  24470000
244200                   PV-HOLD-TR201-DATA-VALUE                       24480000
244300             MOVE 'EXTERNAL REF NBR NOT SENT' TO                  24490000
244400                   PV-HOLD-TR201-ERROR-MSG                        24500000
244500             PERFORM 5500-LOAD-EDD-TO-REPORT                      24510000
244600                                                                  24520000
244700         WHEN PV-TR014-EDD-ORGN-SHPD-FR-CDE EQUAL SPACES OR       24530000
244800             (PV-TR014-EDD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS      24540000
244900              AND PC-CY)                                          24550000
245000             SET PS-EDIT-ERROR TO TRUE                            24560000
245100             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            24570000
245200             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR201-DATA-IN-ERROR 24580000
245300             MOVE PV-TR014-EDD-ORGN-SHPD-FR-CDE  TO               24590000
245400                   PV-HOLD-TR201-DATA-VALUE                       24600000
245500             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               24610000
245600                   PV-HOLD-TR201-ERROR-MSG                        24620000
245700             PERFORM 5500-LOAD-EDD-TO-REPORT                      24630000
245800                                                                  24640000
245900         WHEN PV-TR014-EDD-PO-BKG-DELY-DTE NOT EQUAL SPACES AND   24650000
246000              PV-TR014-EDD-PO-BKG-DELY-DTE NOT EQUAL              24660000
246100               PC-DEFAULT-DATE                                    24670000
246200             MOVE PV-TR014-EDD-PO-BKG-DELY-DTE TO PV-BKG-DELY-DTE 24680000
246300             MOVE PV-TR014-EDD-PO-BKG-DELY-TM  TO PV-BKG-DELY-TM  24690000
246400             PERFORM 5715-FORMAT-BKG-DELY-TMST                    24700000
246500             IF PS-WARNING-DATE                                   24710000
246600                 SET PS-EDIT-ERROR TO TRUE                        24720000
246700                 MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE        24730000
246800                 MOVE PV-TR014-EDD-PO-BKG-DELY-DTE TO             24740000
246900                       PV-HOLD-TR201-DATA-VALUE                   24750000
247000                 MOVE 'DELY DTE' TO PV-HOLD-TR201-DATA-IN-ERROR   24760000
247100                 MOVE 'INVALID DELIVERY DATE'      TO             24770000
247200                       PV-HOLD-TR201-ERROR-MSG                    24780000
247300                 PERFORM 5500-LOAD-EDD-TO-REPORT                  24790000
247400             ELSE                                                 24800000
247500                 IF PS-WARNING-TIME                               24810000
247600                     SET PS-EDIT-ERROR TO TRUE                    24820000
247700                     MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE    24830000
247800                     MOVE PV-TR014-EDD-PO-BKG-DELY-TM TO          24840000
247900                           PV-HOLD-TR201-DATA-VALUE               24850000
248000                     MOVE 'DELY TM' TO PV-HOLD-TR201-DATA-IN-ERROR24860000
248100                     MOVE 'INVALID DELIVERY TIME'     TO          24870000
248200                           PV-HOLD-TR201-ERROR-MSG                24880000
248300                     PERFORM 5500-LOAD-EDD-TO-REPORT              24890000
248400                 ELSE                                             24900000
248500                     MOVE PV-TR014-EDD-PO-BKG-DELY-DTE TO         24910000
248600                                       TR024-EDD-PO-BKG-DELY-DTE  24920000
248700                     MOVE PV-TR014-EDD-PO-BKG-DELY-TM TO          24930000
248800                                       TR024-EDD-PO-BKG-DELY-TM   24940000
248900                 END-IF                                           24950000
249000             END-IF                                               24960000
249100             SET PS-WARNING-DATE-NO TO TRUE                       24970000
249200             SET PS-WARNING-TIME-NO TO TRUE                       24980000
249300     END-EVALUATE.                                                24990000
249400                                                                  25000000
249500     IF PS-EDIT-ERROR-NO                                          25010000
249600         MOVE PV-TR014-EDD-PO-NBR          TO TR024-EDD-PO-NBR    25020000
249700         MOVE PV-TR014-EDD-EXTL-REF-NBR TO TR024-EDD-EXTL-REF-NBR 25030000
249800         MOVE PV-TR014-EDD-ORGN-SHPD-FR-CDE TO                    25040000
249900               TR024-EDD-ORGN-SHPD-FR-CDE                         25050000
250000         PERFORM 5305-LOAD-EDD-FIELDS-UPDATE-2                    25060000
250100     ELSE                                                         25070000
250200         IF PS-EDDRSN-SENT                                        25080000
250300             PERFORM 5510-LOAD-EDDRSN-TO-REPORT                   25090000
250400         END-IF                                                   25100000
250500         PERFORM 5520-LOAD-EDL-TO-REPORT                          25110000
250600     END-IF.                                                      25120000
250700                                                                  25130000
250800******************************************************************25140000
250900*  MOVE WORKING STORAGE EDD RECORD FIELDS TO THE EDITED UPDATE   *25150000
251000*  EXTRACT FILE.  THIS FILE WILL BE PASSED TO THE UPDATE PROGRAM.*25160000
251100******************************************************************25170000
251200 5305-LOAD-EDD-FIELDS-UPDATE-2.                                   25180000
251300                                                                  25190000
251400     IF PV-TR014-EDD-PO-BKG-DELY-DTE EQUAL SPACES                 25200000
251500         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              25210000
251600         MOVE PV-TR014-EDD-PO-BKG-DELY-DTE        TO              25220000
251700               PV-HOLD-TR201-DATA-VALUE                           25230000
251800         MOVE 'BKG DELY DTE'                   TO                 25240000
251900               PV-HOLD-TR201-DATA-IN-ERROR                        25250000
252000         MOVE 'BOOKING DELIVERY DATE NOT SENT' TO                 25260000
252100               PV-HOLD-TR201-ERROR-MSG                            25270000
252200         MOVE PC-DEFAULT-DATE TO PV-TR014-EDD-PO-BKG-DELY-DTE     25280000
252300         PERFORM 5500-LOAD-EDD-TO-REPORT                          25290000
252400     END-IF.                                                      25300000
252500     MOVE PV-TR014-EDD-PO-BKG-DELY-DTE TO                         25310000
252600           TR024-EDD-PO-BKG-DELY-DTE.                             25320000
252700                                                                  25330000
252800     MOVE PV-TR014-EDD-PO-BKG-DELY-TM  TO                         25340000
252900           TR024-EDD-PO-BKG-DELY-TM.                              25350000
253000                                                                  25360000
253100     MOVE PV-TR014-EDD-IMPRT-TRIP-ID  TO TR024-EDD-IMPRT-TRIP-ID. 25370000
253200     IF PV-TR014-EDD-IMPRT-TRIP-ID  EQUAL SPACES                  25380000
253300         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              25390000
253400         MOVE 'VOYAGE NBR'    TO PV-HOLD-TR201-DATA-IN-ERROR      25400000
253500         MOVE PV-TR014-EDD-IMPRT-TRIP-ID    TO                    25410000
253600               PV-HOLD-TR201-DATA-VALUE                           25420000
253700         MOVE 'DATA NOT SENT'             TO                      25430000
253800               PV-HOLD-TR201-ERROR-MSG                            25440000
253900         PERFORM 5500-LOAD-EDD-TO-REPORT                          25450000
254000     END-IF.                                                      25460000
254100                                                                  25470000
254200     MOVE PV-TR014-EDD-CARR-SCAC-ID   TO TR024-EDD-CARR-SCAC-ID.  25480000
254300                                                                  25490000
254400     MOVE PV-TR014-EDD-IMPRT-VEH-NM  TO TR024-EDD-IMPRT-VEH-NM.   25500000
254500     IF PV-TR014-EDD-IMPRT-VEH-NM   EQUAL SPACES                  25510000
254600         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              25520000
254700         MOVE 'IMP VEH NM'     TO PV-HOLD-TR201-DATA-IN-ERROR     25530000
254800         MOVE PV-TR014-EDD-IMPRT-VEH-NM     TO                    25540000
254900               PV-HOLD-TR201-DATA-VALUE                           25550000
255000         MOVE 'DATA NOT SENT'             TO                      25560000
255100               PV-HOLD-TR201-ERROR-MSG                            25570000
255200         PERFORM 5500-LOAD-EDD-TO-REPORT                          25580000
255300     END-IF.                                                      25590000
255400                                                                  25600000
255500     IF PV-TR014-EDD-POE-DELY-DTE EQUAL SPACES                    25610000
255600         MOVE PC-DEFAULT-DATE           TO TR024-EDD-POE-DELY-DTE 25620000
255700                                           PV-HOLD-POE-DELY-DTE   25630000
255800     ELSE                                                         25640000
255900         MOVE PV-TR014-EDD-POE-DELY-DTE TO TR024-EDD-POE-DELY-DTE 25650000
256000                                           PV-HOLD-POE-DELY-DTE   25660000
256100     END-IF.                                                      25670000
256200                                                                  25680000
256300     IF PV-TR014-EDD-POE-DELY-TM EQUAL SPACES                     25690000
256400         MOVE PC-DEFAULT-TIME           TO TR024-EDD-POE-DELY-TM  25700000
256500                                           PV-HOLD-POE-DELY-TM    25710000
256600     ELSE                                                         25720000
256700         MOVE PV-TR014-EDD-POE-DELY-TM  TO TR024-EDD-POE-DELY-TM  25730000
256800                                           PV-HOLD-POE-DELY-TM    25740000
256900     END-IF.                                                      25750000
257000                                                                  25760000
257100     PERFORM 5705-FORMAT-POE-DELY-TMST.                           25770000
257200     IF PS-WARNING-DATE                                           25780000
257300         EVALUATE PV-TR014-EDD-ENT-ID                             25781000
257400             WHEN PC-OCS                                          25782000
257500                 MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE      25790000
257600                 MOVE 'POE DELY DTE'             TO               25800000
257700                      PV-HOLD-TR201-DATA-IN-ERROR                 25801000
257800                 MOVE PV-TR014-EDD-POE-DELY-DTE  TO               25810000
257900                      PV-HOLD-TR201-DATA-VALUE                    25820000
258000                 MOVE 'INVALID DATE'             TO               25830000
258100                      PV-HOLD-TR201-ERROR-MSG                     25840000
258200                 PERFORM 5500-LOAD-EDD-TO-REPORT                  25850000
258300                 MOVE PC-DEFAULT-DATE            TO               25860000
258400                      TR024-EDD-POE-DELY-DTE                      25870000
258500             WHEN OTHER                                           25871000
258600                 MOVE PC-DEFAULT-DATE            TO               25871100
258700                      TR024-EDD-POE-DELY-DTE                      25871200
258710         END-EVALUATE                                             25871300
258720     ELSE                                                         25880000
258730         IF PS-WARNING-TIME                                       25890000
258740             EVALUATE PV-TR014-EDD-ENT-ID                         25891000
258750                 WHEN PC-OCS                                      25892000
258760                     MOVE PC-WARNING                TO            25893000
258770                          PV-HOLD-TR201-ERROR-TYPE                25893100
258780                     MOVE 'POE DELY TM'             TO            25894000
258790                          PV-HOLD-TR201-DATA-IN-ERROR             25894100
258800                     MOVE PV-TR014-EDD-POE-DELY-TM  TO            25895000
258900                          PV-HOLD-TR201-DATA-VALUE                25896000
258910                     MOVE 'INVALID TIME'            TO            25897000
258920                          PV-HOLD-TR201-ERROR-MSG                 25898000
258930                     PERFORM 5500-LOAD-EDD-TO-REPORT              25899000
258940                     MOVE PC-DEFAULT-TIME           TO            25899100
258950                          TR024-EDD-POE-DELY-TM                   25899200
258960                 WHEN OTHER                                       25899400
258970                     MOVE PC-DEFAULT-TIME           TO            25899500
258980                          TR024-EDD-POE-DELY-TM                   25899600
258990             END-EVALUATE                                         25899700
259000         END-IF                                                   25990000
259100     END-IF.                                                      26000000
259200     SET PS-WARNING-DATE-NO     TO TRUE.                          26010000
259300     SET PS-WARNING-TIME-NO     TO TRUE.                          26020000
259400                                                                  26030000
259500     IF PV-TR014-EDD-DPRTR-DTE EQUAL SPACES                       26070000
259600         MOVE PC-DEFAULT-DATE         TO TR024-EDD-DPRTR-DTE      26080000
259700                                         PV-HOLD-DPRTR-DTE        26090000
259800     ELSE                                                         26100000
259900         MOVE PV-TR014-EDD-DPRTR-DTE  TO TR024-EDD-DPRTR-DTE      26110000
260000                                         PV-HOLD-DPRTR-DTE        26120000
260100     END-IF.                                                      26130000
260200                                                                  26140000
260300     IF PV-TR014-EDD-DPRTR-TM EQUAL SPACES                        26150000
260400         MOVE PC-DEFAULT-TIME         TO TR024-EDD-DPRTR-TM       26160000
260500                                         PV-HOLD-DPRTR-TM         26170000
260600     ELSE                                                         26180000
260700         MOVE PV-TR014-EDD-DPRTR-TM   TO TR024-EDD-DPRTR-TM       26190000
260800                                         PV-HOLD-DPRTR-TM         26200000
260900     END-IF.                                                      26210000
261000                                                                  26220000
261100     PERFORM 5700-FORMAT-DPRTR-TMST.                              26230000
261200     IF PS-WARNING-DATE                                           26240000
261300         MOVE PC-WARNING        TO PV-HOLD-TR201-ERROR-TYPE       26250000
261400         MOVE 'DPRTR DTE'       TO PV-HOLD-TR201-DATA-IN-ERROR    26260000
261500         MOVE PV-TR014-EDD-DPRTR-DTE        TO                    26270000
261600               PV-HOLD-TR201-DATA-VALUE                           26280000
261700         MOVE 'INVALID DATE'                TO                    26290000
261800               PV-HOLD-TR201-ERROR-MSG                            26300000
261900         PERFORM 5500-LOAD-EDD-TO-REPORT                          26310000
262000         MOVE PC-DEFAULT-DATE         TO TR024-EDD-DPRTR-DTE      26320000
262100     ELSE                                                         26330000
262200         IF PS-WARNING-TIME                                       26340000
262300             MOVE PC-WARNING   TO PV-HOLD-TR201-ERROR-TYPE        26350000
262400             MOVE 'DPRTR TM'   TO PV-HOLD-TR201-DATA-IN-ERROR     26360000
262500             MOVE PV-TR014-EDD-DPRTR-TM        TO                 26370000
262600                   PV-HOLD-TR201-DATA-VALUE                       26380000
262700             MOVE 'INVALID TIME'               TO                 26390000
262800                   PV-HOLD-TR201-ERROR-MSG                        26400000
262900             PERFORM 5500-LOAD-EDD-TO-REPORT                      26410000
263000             MOVE PC-DEFAULT-TIME    TO TR024-EDD-DPRTR-TM        26420000
263100         END-IF                                                   26430000
263200     END-IF.                                                      26440000
263300     SET PS-WARNING-DATE-NO     TO TRUE.                          26450000
263400     SET PS-WARNING-TIME-NO     TO TRUE.                          26460000
263500                                                                  26470000
263600     MOVE PV-TR014-EDD-FOB-CDE        TO TR024-EDD-FOB-CDE.       26480000
263700     IF PV-TR014-EDD-FOB-CDE EQUAL SPACES                         26490000
263800         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              26500000
263900         MOVE 'FOB CDE'  TO PV-HOLD-TR201-DATA-IN-ERROR           26510000
264000         MOVE PV-TR014-EDD-FOB-CDE    TO                          26520000
264100               PV-HOLD-TR201-DATA-VALUE                           26530000
264200         MOVE 'DATA NOT SENT'         TO                          26540000
264300               PV-HOLD-TR201-ERROR-MSG                            26550000
264400         PERFORM 5500-LOAD-EDD-TO-REPORT                          26560000
264500     END-IF.                                                      26570000
264600                                                                  26580000
264700     MOVE PV-TR014-EDD-DEST-POE-CDE   TO TR024-EDD-DEST-POE-CDE.  26590000
264800                                                                  26600000
264900     MOVE PV-TR014-EDD-TRIP-TYP-CDE   TO TR024-EDD-TRIP-TYP-CDE.  26610000
265000     IF PV-TR014-EDD-TRIP-TYP-CDE EQUAL PC-A OR PC-O OR PC-M      26620000
265100         CONTINUE                                                 26630000
265200     ELSE                                                         26640000
265300         IF PV-TR014-EDD-TRIP-TYP-CDE EQUAL SPACES                26650000
265400             MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE          26660000
265500             MOVE 'TRIP TYP CDE'   TO PV-HOLD-TR201-DATA-IN-ERROR 26670000
265600             MOVE PV-TR014-EDD-TRIP-TYP-CDE   TO                  26680000
265700                   PV-HOLD-TR201-DATA-VALUE                       26690000
265800             MOVE 'DATA NOT SENT'             TO                  26700000
265900                   PV-HOLD-TR201-ERROR-MSG                        26710000
266000             PERFORM 5500-LOAD-EDD-TO-REPORT                      26720000
266100         ELSE                                                     26730000
266200             MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE          26740000
266300             MOVE 'TRIP TYP CDE'   TO PV-HOLD-TR201-DATA-IN-ERROR 26750000
266400             MOVE PV-TR014-EDD-TRIP-TYP-CDE   TO                  26760000
266500                   PV-HOLD-TR201-DATA-VALUE                       26770000
266600             MOVE 'INVALID TRIP TYPE'         TO                  26780000
266700                   PV-HOLD-TR201-ERROR-MSG                        26790000
266800             PERFORM 5500-LOAD-EDD-TO-REPORT                      26800000
266900         END-IF                                                   26810000
267000     END-IF.                                                      26820000
267100                                                                  26830000
267200     MOVE PV-TR014-EDD-EST-LBD-NM TO TR024-EDD-EST-LBD-NM.        26840000
267300                                                                  26850000
267400     MOVE PV-TR014-EDD-FILE-ID    TO TR024-EDD-FILE-ID.           26861000
267500     MOVE PV-TR014-EDD-ENT-ID     TO TR024-EDD-ENT-ID.            26862000
267600                                                                  26870000
267700     MOVE PV-TR014-EDD-PROC-SEQ-NBR  TO                           26880000
267800                                TR024-EDD-PROCESS-SEQ-NBR.        26890000
267900     PERFORM 6400-WRITE-UPDATE-RECORD.                            26900000
268000                                                                  26910000
268100******************************************************************26920000
268200*  MOVE WORKING STORAGE EDDRSN RECORD FIELDS TO THE EDITED       *26930000
268300*  UPDATE EXTRACT FILE.                                          *26940000
268400******************************************************************26950000
268500 5310-LOAD-EDDRSN-FIELDS-UPDATE.                                  26960000
268600                                                                  26970000
268700     PERFORM 5410-INITIAL-EDDRSN-FIELDS-UPD.                      26980000
268800                                                                  26990000
268900     MOVE PV-TR014-EDDRSN-TRN-TYP  TO TR024-EDDRSN-TRN-TYP.       27000000
269000     MOVE PC-EDDRSN                TO TR024-EDDRSN-REC-TYP-CDE.   27010000
269100     MOVE PC-11                    TO TR024-EDDRSN-SEQ-NBR.       27020000
269200     MOVE PV-TR014-EDDRSN-3RD-PARTY-CDE TO                        27030000
269300                                   TR024-EDDRSN-3RD-PARTY-CDE.    27040000
269400                                                                  27050000
269500     EVALUATE TRUE                                                27060000
269600                                                                  27070000
269700         WHEN PV-TR014-EDDRSN-PO-NBR NOT NUMERIC OR               27080000
269800              PV-TR014-EDDRSN-PO-NBR  = ZERO                      27090000
269900               SET PS-EDIT-ERROR TO TRUE                          27100000
270000               MOVE PC-ERROR    TO PV-HOLD-TR201-ERROR-TYPE       27110000
270100               MOVE 'PO NUMBER' TO PV-HOLD-TR201-DATA-IN-ERROR    27120000
270200               MOVE PV-TR014-EDDRSN-PO-NBR TO                     27130000
270300                     PV-HOLD-TR201-DATA-VALUE                     27140000
270400               MOVE 'INVALID PO NUMBER'    TO                     27150000
270500                     PV-HOLD-TR201-ERROR-MSG                      27160000
270600               PERFORM 5510-LOAD-EDDRSN-TO-REPORT                 27170000
270700                                                                  27180000
270800         WHEN PV-TR014-EDDRSN-EXTL-REF-NBR EQUAL SPACES           27190000
270900               SET PS-EDIT-ERROR TO TRUE                          27200000
271000               MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE          27210000
271100               MOVE 'EXTL REF NBR'                 TO             27220000
271200                     PV-HOLD-TR201-DATA-IN-ERROR                  27230000
271300               MOVE PV-TR014-EDDRSN-EXTL-REF-NBR   TO             27240000
271400                     PV-HOLD-TR201-DATA-VALUE                     27250000
271500               MOVE 'DATA NOT SENT'                TO             27260000
271600                     PV-HOLD-TR201-ERROR-MSG                      27270000
271700               PERFORM 5510-LOAD-EDDRSN-TO-REPORT                 27280000
271800                                                                  27290000
271900         WHEN PV-TR014-EDDRSN-ORG-SHP-FR-CDE EQUAL SPACES OR      27300000
272000             (PV-TR014-EDDRSN-ORG-SHP-FR-CDE NOT EQUAL PC-CFS     27310000
272100              AND PC-CY)                                          27320000
272200             SET PS-EDIT-ERROR TO TRUE                            27330000
272300             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            27340000
272400             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR201-DATA-IN-ERROR 27350000
272500             MOVE PV-TR014-EDDRSN-ORG-SHP-FR-CDE  TO              27360000
272600                   PV-HOLD-TR201-DATA-VALUE                       27370000
272700             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               27380000
272800                   PV-HOLD-TR201-ERROR-MSG                        27390000
272900             PERFORM 5510-LOAD-EDDRSN-TO-REPORT                   27400000
273000                                                                  27410000
273100         WHEN PV-TR014-EDDRSN-PO-BKG-DELY-DT NOT EQUAL SPACES     27420000
273200                AND                                               27430000
273300              PV-TR014-EDDRSN-PO-BKG-DELY-DT NOT EQUAL            27440000
273400               PC-DEFAULT-DATE                                    27450000
273500             MOVE PV-TR014-EDDRSN-PO-BKG-DELY-DT   TO             27460000
273600                   PV-BKG-DELY-DTE                                27470000
273700             MOVE PV-TR014-EDDRSN-PO-BKG-DELY-TM   TO             27480000
273800                   PV-BKG-DELY-TM                                 27490000
273900             PERFORM 5715-FORMAT-BKG-DELY-TMST                    27500000
274000             IF PS-WARNING-DATE                                   27510000
274100                 SET PS-EDIT-ERROR TO TRUE                        27520000
274200                 MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE        27530000
274300                 MOVE PV-TR014-EDDRSN-PO-BKG-DELY-DT TO           27540000
274400                       PV-HOLD-TR201-DATA-VALUE                   27550000
274500                 MOVE 'DELY DTE' TO PV-HOLD-TR201-DATA-IN-ERROR   27560000
274600                 MOVE 'INVALID DELIVERY DATE'        TO           27570000
274700                       PV-HOLD-TR201-ERROR-MSG                    27580000
274800                 PERFORM 5510-LOAD-EDDRSN-TO-REPORT               27590000
274900             ELSE                                                 27600000
275000                 IF PS-WARNING-TIME                               27610000
275100                     SET PS-EDIT-ERROR TO TRUE                    27620000
275200                     MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE    27630000
275300                     MOVE PV-TR014-EDDRSN-PO-BKG-DELY-TM TO       27640000
275400                           PV-HOLD-TR201-DATA-VALUE               27650000
275500                     MOVE 'DELY TM' TO PV-HOLD-TR201-DATA-IN-ERROR27660000
275600                     MOVE 'INVALID DELIVERY TIME'     TO          27670000
275700                           PV-HOLD-TR201-ERROR-MSG                27680000
275800                     PERFORM 5510-LOAD-EDDRSN-TO-REPORT           27690000
275900                 ELSE                                             27700000
276000                     MOVE PV-TR014-EDDRSN-PO-BKG-DELY-DT TO       27710000
276100                           TR024-EDDRSN-PO-BKG-DELY-DTE           27720000
276200                     MOVE PV-TR014-EDDRSN-PO-BKG-DELY-TM TO       27730000
276300                           TR024-EDDRSN-PO-BKG-DELY-TM            27740000
276400                 END-IF                                           27750000
276500             END-IF                                               27760000
276600             SET PS-WARNING-DATE-NO TO TRUE                       27770000
276700             SET PS-WARNING-TIME-NO TO TRUE                       27780000
276800     END-EVALUATE.                                                27790000
276900                                                                  27800000
277000     IF PS-EDIT-ERROR-NO                                          27810000
277100         MOVE PV-TR014-EDDRSN-PO-NBR       TO TR024-EDDRSN-PO-NBR 27820000
277200         MOVE PV-TR014-EDDRSN-EXTL-REF-NBR TO                     27830000
277300               TR024-EDDRSN-EXTL-REF-NBR                          27840000
277400         MOVE PV-TR014-EDDRSN-ORG-SHP-FR-CDE TO                   27850000
277500               TR024-EDDRSN-ORGN-SHPD-FR-CDE                      27860000
277600         PERFORM 5315-LOAD-EDDRSN-FIELDS-UPD-2                    27870000
277700     ELSE                                                         27880000
277800         IF PS-EDL-SENT                                           27890000
277900             PERFORM 5520-LOAD-EDL-TO-REPORT                      27900000
278000         END-IF                                                   27910000
278100     END-IF.                                                      27920000
278200                                                                  27930000
278300******************************************************************27940000
278400*  MOVE WORKING STORAGE EDDRSN RECORD FIELDS TO THE EDITED       *27950000
278500*  UPDATE EXTRACT FILE.                                          *27960000
278600******************************************************************27970000
278700 5315-LOAD-EDDRSN-FIELDS-UPD-2.                                   27980000
278800                                                                  27990000
278900     IF PV-TR014-EDDRSN-PO-BKG-DELY-DT EQUAL SPACES               28000000
279000         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              28010000
279100         MOVE PV-TR014-EDDRSN-PO-BKG-DELY-DT   TO                 28020000
279200               PV-HOLD-TR201-DATA-VALUE                           28030000
279300         MOVE 'BKG DELY DTE'                   TO                 28040000
279400               PV-HOLD-TR201-DATA-IN-ERROR                        28050000
279500         MOVE 'BOOKING DELIVERY DATE NOT SENT' TO                 28060000
279600               PV-HOLD-TR201-ERROR-MSG                            28070000
279700         MOVE PC-DEFAULT-DATE TO PV-TR014-EDDRSN-PO-BKG-DELY-DT   28080000
279800         PERFORM 5510-LOAD-EDDRSN-TO-REPORT                       28090000
279900     END-IF.                                                      28100000
280000     MOVE PV-TR014-EDDRSN-PO-BKG-DELY-DT TO                       28110000
280100           TR024-EDDRSN-PO-BKG-DELY-DTE.                          28120000
280200                                                                  28130000
280300     MOVE PV-TR014-EDDRSN-PO-BKG-DELY-TM TO                       28140000
280400           TR024-EDDRSN-PO-BKG-DELY-TM.                           28150000
280500                                                                  28160000
280600     MOVE PV-TR014-EDDRSN-IMPRT-TRIP-ID     TO                    28170000
280700                                   TR024-EDDRSN-IMPRT-TRIP-ID.    28180000
280800     IF PV-TR014-EDDRSN-IMPRT-TRIP-ID  EQUAL SPACES               28190000
280900         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              28200000
281000         MOVE 'VOYAGE NBR'    TO PV-HOLD-TR201-DATA-IN-ERROR      28210000
281100         MOVE PV-TR014-EDDRSN-IMPRT-TRIP-ID    TO                 28220000
281200               PV-HOLD-TR201-DATA-VALUE                           28230000
281300         MOVE 'DATA NOT SENT'             TO                      28240000
281400               PV-HOLD-TR201-ERROR-MSG                            28250000
281500         PERFORM 5510-LOAD-EDDRSN-TO-REPORT                       28260000
281600     END-IF.                                                      28270000
281700                                                                  28280000
281800     MOVE PV-TR014-EDDRSN-CARR-SCAC-ID    TO                      28290000
281900                                   TR024-EDDRSN-CARR-SCAC-ID.     28300000
282000                                                                  28310000
282100     IF PV-TR014-EDDRSN-POE-DELY-DTE EQUAL SPACES                 28320000
282200         MOVE PC-DEFAULT-DATE        TO TR024-EDDRSN-POE-DELY-DTE 28330000
282300                                        PV-HOLD-POE-DELY-DTE      28340000
282400     ELSE                                                         28350000
282500         MOVE PV-TR014-EDDRSN-POE-DELY-DTE TO                     28360000
282600                                     TR024-EDDRSN-POE-DELY-DTE    28370000
282700                                     PV-HOLD-POE-DELY-DTE         28380000
282800     END-IF.                                                      28390000
282900                                                                  28400000
283000     IF PV-TR014-EDDRSN-POE-DELY-TM EQUAL SPACES                  28410000
283100         MOVE PC-DEFAULT-TIME       TO TR024-EDDRSN-POE-DELY-TM   28420000
283200                                       PV-HOLD-POE-DELY-TM        28430000
283300     ELSE                                                         28440000
283400         MOVE PV-TR014-EDDRSN-POE-DELY-TM  TO                     28450000
283500                                       TR024-EDDRSN-POE-DELY-TM   28460000
283600                                       PV-HOLD-POE-DELY-TM        28470000
283700     END-IF.                                                      28480000
283800                                                                  28490000
283900     PERFORM 5705-FORMAT-POE-DELY-TMST.                           28500000
284000     IF PS-WARNING-DATE                                           28510000
284100         EVALUATE PV-TR014-EDDRSN-ENT-ID                          28511000
284200             WHEN PC-OCS                                          28512000
284300                 MOVE PC-WARNING  TO PV-HOLD-TR201-ERROR-TYPE     28520000
284400                 MOVE 'POE DELY DTE' TO                           28530000
284500                      PV-HOLD-TR201-DATA-IN-ERROR                 28531000
284600                 MOVE PV-TR014-EDDRSN-POE-DELY-DTE     TO         28540000
284700                      PV-HOLD-TR201-DATA-VALUE                    28550000
284800                 MOVE 'INVALID DATE'                   TO         28560000
284900                      PV-HOLD-TR201-ERROR-MSG                     28570000
285000                 PERFORM 5510-LOAD-EDDRSN-TO-REPORT               28580000
285100                 MOVE PC-DEFAULT-DATE   TO                        28590000
285200                      TR024-EDDRSN-POE-DELY-DTE                   28591000
285300             WHEN OTHER                                           28592000
285400                 MOVE PC-DEFAULT-DATE   TO                        28593000
285500                      TR024-EDDRSN-POE-DELY-DTE                   28594000
285600         END-EVALUATE                                             28595000
285700     ELSE                                                         28600000
285800         IF PS-WARNING-TIME                                       28610000
285900             EVALUATE PV-TR014-EDDRSN-ENT-ID                      28610100
286000                 WHEN PC-OCS                                      28611000
286100                     MOVE PC-WARNING      TO                      28620000
286200                          PV-HOLD-TR201-ERROR-TYPE                28621000
286300                     MOVE 'POE DELY TM'   TO                      28630000
286310                          PV-HOLD-TR201-DATA-IN-ERROR             28631000
286320                     MOVE PV-TR014-EDDRSN-POE-DELY-TM TO          28640000
286330                          PV-HOLD-TR201-DATA-VALUE                28650000
286340                     MOVE 'INVALID TIME'  TO                      28660000
286350                          PV-HOLD-TR201-ERROR-MSG                 28670000
286360                     PERFORM 5510-LOAD-EDDRSN-TO-REPORT           28680000
286370                     MOVE PC-DEFAULT-TIME TO                      28690000
286380                          TR024-EDDRSN-POE-DELY-TM                28691000
286390                 WHEN OTHER                                       28692000
286400                     MOVE PC-DEFAULT-TIME TO                      28693000
286500                          TR024-EDDRSN-POE-DELY-TM                28694000
286600             END-EVALUATE                                         28695000
286700         END-IF                                                   28700000
286800     END-IF.                                                      28710000
286900     SET PS-WARNING-DATE-NO     TO TRUE.                          28720000
287000     SET PS-WARNING-TIME-NO     TO TRUE.                          28730000
287100                                                                  28740000
287200     IF PV-TR014-EDDRSN-DPRTR-DTE EQUAL SPACES                    28780000
287300         MOVE PC-DEFAULT-DATE         TO TR024-EDDRSN-DPRTR-DTE   28790000
287400                                         PV-HOLD-DPRTR-DTE        28800000
287500     ELSE                                                         28810000
287600         MOVE PV-TR014-EDDRSN-DPRTR-DTE  TO                       28820000
287700                                      TR024-EDDRSN-DPRTR-DTE      28830000
287800                                      PV-HOLD-DPRTR-DTE           28840000
287900     END-IF.                                                      28850000
288000                                                                  28860000
288100     IF PV-TR014-EDDRSN-DPRTR-TM EQUAL SPACES                     28870000
288200         MOVE PC-DEFAULT-TIME         TO TR024-EDDRSN-DPRTR-TM    28880000
288300                                         PV-HOLD-DPRTR-TM         28890000
288400     ELSE                                                         28900000
288500         MOVE PV-TR014-EDDRSN-DPRTR-TM   TO TR024-EDDRSN-DPRTR-TM 28910000
288600                                         PV-HOLD-DPRTR-TM         28920000
288700     END-IF.                                                      28930000
288800                                                                  28940000
288900     PERFORM 5700-FORMAT-DPRTR-TMST.                              28950000
289000     IF PS-WARNING-DATE                                           28960000
289100         MOVE PC-WARNING        TO PV-HOLD-TR201-ERROR-TYPE       28970000
289200         MOVE 'DPRTR DTE'       TO PV-HOLD-TR201-DATA-IN-ERROR    28980000
289300         MOVE PV-TR014-EDDRSN-DPRTR-DTE        TO                 28990000
289400               PV-HOLD-TR201-DATA-VALUE                           29000000
289500         MOVE 'INVALID DATE'                   TO                 29010000
289600               PV-HOLD-TR201-ERROR-MSG                            29020000
289700         PERFORM 5510-LOAD-EDDRSN-TO-REPORT                       29030000
289800         MOVE PC-DEFAULT-DATE      TO TR024-EDDRSN-DPRTR-DTE      29040000
289900     ELSE                                                         29050000
290000         IF PS-WARNING-TIME                                       29060000
290100             MOVE PC-WARNING   TO PV-HOLD-TR201-ERROR-TYPE        29070000
290200             MOVE 'DPRTR TM'   TO PV-HOLD-TR201-DATA-IN-ERROR     29080000
290300             MOVE PV-TR014-EDDRSN-DPRTR-TM        TO              29090000
290400                   PV-HOLD-TR201-DATA-VALUE                       29100000
290500             MOVE 'INVALID TIME'                  TO              29110000
290600                   PV-HOLD-TR201-ERROR-MSG                        29120000
290700             PERFORM 5510-LOAD-EDDRSN-TO-REPORT                   29130000
290800             MOVE PC-DEFAULT-TIME  TO TR024-EDDRSN-DPRTR-TM       29140000
290900         END-IF                                                   29150000
291000     END-IF.                                                      29160000
291100     SET PS-WARNING-DATE-NO     TO TRUE.                          29170000
291200     SET PS-WARNING-TIME-NO     TO TRUE.                          29180000
291300                                                                  29190000
291400     MOVE PV-TR014-EDDRSN-VOY-CHG-RSN-DS   TO                     29200000
291500                                TR024-EDDRSN-VOY-CHG-RSN-DESC.    29210000
291600     IF PV-TR014-EDDRSN-VOY-CHG-RSN-DS   EQUAL SPACES             29220000
291700         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              29230000
291800         MOVE 'VOY CHG RSN'    TO PV-HOLD-TR201-DATA-IN-ERROR     29240000
291900         MOVE PV-TR014-EDDRSN-VOY-CHG-RSN-DS    TO                29250000
292000               PV-HOLD-TR201-DATA-VALUE                           29260000
292100         MOVE 'DATA NOT SENT'                   TO                29270000
292200               PV-HOLD-TR201-ERROR-MSG                            29280000
292300         PERFORM 5510-LOAD-EDDRSN-TO-REPORT                       29290000
292400     END-IF.                                                      29300000
292500                                                                  29310000
292600     MOVE PV-TR014-EDDRSN-FILE-ID    TO TR024-EDDRSN-FILE-ID.     29313000
292700     MOVE PV-TR014-EDDRSN-ENT-ID     TO TR024-EDDRSN-ENT-ID.      29314000
292800                                                                  29315000
292900     MOVE PV-TR014-EDDRSN-PROC-SEQ-NBR   TO                       29320000
293000           TR024-EDDRSN-PROCESS-SEQ-NBR                           29330000
293100     PERFORM 6400-WRITE-UPDATE-RECORD.                            29340000
293200                                                                  29350000
293300******************************************************************29360000
293400*  MOVE WORKING STORAGE EDL RECORD FIELDS TO THE EDITED UPDATE   *29370000
293500*  EXTRACT FILE.                                                 *29380000
293600******************************************************************29390000
293700 5320-LOAD-EDL-FIELDS-UPDATE.                                     29400000
293800                                                                  29410000
293900     PERFORM 5420-INITIAL-EDL-FIELDS-UPD.                         29420000
294000                                                                  29430000
294100     MOVE PV-TR014-EDL-TRN-TYP        TO TR024-EDL-TRN-TYP.       29440000
294200     MOVE PC-EDL                      TO TR024-EDL-REC-TYP-CDE.   29450000
294300     MOVE PC-20                       TO TR024-EDL-SEQ-NBR.       29460000
294400     MOVE PV-TR014-EDL-3RD-PARTY-CDE  TO TR024-EDL-3RD-PARTY-CDE. 29470000
294500                                                                  29480000
294600     EVALUATE TRUE                                                29490000
294700                                                                  29500000
294800         WHEN PV-TR014-EDL-PO-NBR NOT NUMERIC OR                  29510000
294900              PV-TR014-EDL-PO-NBR  = ZERO                         29520000
295000               SET PS-EDIT-ERROR TO TRUE                          29530000
295100               MOVE PC-ERROR    TO PV-HOLD-TR201-ERROR-TYPE       29540000
295200               MOVE 'PO NUMBER' TO PV-HOLD-TR201-DATA-IN-ERROR    29550000
295300               MOVE PV-TR014-EDL-PO-NBR TO                        29560000
295400                     PV-HOLD-TR201-DATA-VALUE                     29570000
295500               MOVE 'INVALID PO NUMBER'    TO                     29580000
295600                     PV-HOLD-TR201-ERROR-MSG                      29590000
295700               PERFORM 5520-LOAD-EDL-TO-REPORT                    29600000
295800                                                                  29610000
295900         WHEN PV-TR014-EDL-EXTL-REF-NBR EQUAL SPACES              29620000
296000               SET PS-EDIT-ERROR TO TRUE                          29630000
296100               MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE          29640000
296200               MOVE 'EXTL REF NBR'                 TO             29650000
296300                     PV-HOLD-TR201-DATA-IN-ERROR                  29660000
296400               MOVE PV-TR014-EDL-EXTL-REF-NBR   TO                29670000
296500                     PV-HOLD-TR201-DATA-VALUE                     29680000
296600               MOVE 'DATA NOT SENT'                TO             29690000
296700                     PV-HOLD-TR201-ERROR-MSG                      29700000
296800               PERFORM 5520-LOAD-EDL-TO-REPORT                    29710000
296900                                                                  29720000
297000         WHEN PV-TR014-EDL-ORGN-SHPD-FR-CDE EQUAL SPACES OR       29730000
297100             (PV-TR014-EDL-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS      29740000
297200              AND PC-CY)                                          29750000
297300             SET PS-EDIT-ERROR TO TRUE                            29760000
297400             MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE            29770000
297500             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR201-DATA-IN-ERROR 29780000
297600             MOVE PV-TR014-EDL-ORGN-SHPD-FR-CDE  TO               29790000
297700                   PV-HOLD-TR201-DATA-VALUE                       29800000
297800             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               29810000
297900                   PV-HOLD-TR201-ERROR-MSG                        29820000
298000             PERFORM 5520-LOAD-EDL-TO-REPORT                      29830000
298100                                                                  29840000
298200         WHEN PV-TR014-EDL-PO-BKG-DELY-DTE NOT EQUAL SPACES       29850000
298300                AND                                               29860000
298400              PV-TR014-EDL-PO-BKG-DELY-DTE NOT EQUAL              29870000
298500               PC-DEFAULT-DATE                                    29880000
298600             MOVE PV-TR014-EDL-PO-BKG-DELY-DTE   TO               29890000
298700                   PV-BKG-DELY-DTE                                29900000
298800             MOVE PV-TR014-EDL-PO-BKG-DELY-TM    TO               29910000
298900                   PV-BKG-DELY-TM                                 29920000
299000             PERFORM 5715-FORMAT-BKG-DELY-TMST                    29930000
299100             IF PS-WARNING-DATE                                   29940000
299200                 SET PS-EDIT-ERROR TO TRUE                        29950000
299300                 MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE        29960000
299400                 MOVE PV-TR014-EDL-PO-BKG-DELY-DTE TO             29970000
299500                       PV-HOLD-TR201-DATA-VALUE                   29980000
299600                 MOVE 'DELY DTE' TO PV-HOLD-TR201-DATA-IN-ERROR   29990000
299700                 MOVE 'INVALID DELIVERY DATE'      TO             30000000
299800                       PV-HOLD-TR201-ERROR-MSG                    30010000
299900                 PERFORM 5520-LOAD-EDL-TO-REPORT                  30020000
300000             ELSE                                                 30030000
300100                 IF PS-WARNING-TIME                               30040000
300200                     SET PS-EDIT-ERROR TO TRUE                    30050000
300300                     MOVE PC-ERROR TO PV-HOLD-TR201-ERROR-TYPE    30060000
300400                     MOVE PV-TR014-EDL-PO-BKG-DELY-TM TO          30070000
300500                           PV-HOLD-TR201-DATA-VALUE               30080000
300600                     MOVE 'DELY TM' TO PV-HOLD-TR201-DATA-IN-ERROR30090000
300700                     MOVE 'INVALID DELIVERY TIME'     TO          30100000
300800                           PV-HOLD-TR201-ERROR-MSG                30110000
300900                     PERFORM 5520-LOAD-EDL-TO-REPORT              30120000
301000                 ELSE                                             30130000
301100                     MOVE PV-TR014-EDL-PO-BKG-DELY-DTE TO         30140000
301200                           TR024-EDL-PO-BKG-DELY-DTE              30150000
301300                     MOVE PV-TR014-EDL-PO-BKG-DELY-TM TO          30160000
301400                           TR024-EDL-PO-BKG-DELY-TM               30170000
301500                 END-IF                                           30180000
301600             END-IF                                               30190000
301700             SET PS-WARNING-DATE-NO TO TRUE                       30200000
301800             SET PS-WARNING-TIME-NO TO TRUE                       30210000
301900     END-EVALUATE.                                                30220000
302000                                                                  30230000
302100     IF PS-EDIT-ERROR-NO                                          30240000
302200         MOVE PV-TR014-EDL-PO-NBR       TO TR024-EDL-PO-NBR       30250000
302300         MOVE PV-TR014-EDL-EXTL-REF-NBR TO                        30260000
302400               TR024-EDL-EXTL-REF-NBR                             30270000
302500         MOVE PV-TR014-EDL-ORGN-SHPD-FR-CDE TO                    30280000
302600               TR024-EDL-ORGN-SHPD-FR-CDE                         30290000
302700         PERFORM 5325-LOAD-EDL-FIELDS-UPDATE-2                    30300000
302800     END-IF.                                                      30310000
302900                                                                  30320000
303000******************************************************************30330000
303100*  MOVE WORKING STORAGE EDL RECORD FIELDS TO THE EDITED          *30340000
303200*  UPDATE EXTRACT FILE.                                          *30350000
303300******************************************************************30360000
303400 5325-LOAD-EDL-FIELDS-UPDATE-2.                                   30370000
303500                                                                  30380000
303600     IF PV-TR014-EDL-PO-BKG-DELY-DTE EQUAL SPACES                 30390000
303700         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              30400000
303800         MOVE PV-TR014-EDL-PO-BKG-DELY-DTE        TO              30410000
303900               PV-HOLD-TR201-DATA-VALUE                           30420000
304000         MOVE 'BKG DELY DTE'                   TO                 30430000
304100               PV-HOLD-TR201-DATA-IN-ERROR                        30440000
304200         MOVE 'BOOKING DELIVERY DATE NOT SENT' TO                 30450000
304300               PV-HOLD-TR201-ERROR-MSG                            30460000
304400         MOVE PC-DEFAULT-DATE TO PV-TR014-EDL-PO-BKG-DELY-DTE     30470000
304500         PERFORM 5520-LOAD-EDL-TO-REPORT                          30480000
304600     END-IF.                                                      30490000
304700                                                                  30500000
304800     MOVE PV-TR014-EDL-PO-BKG-DELY-DTE TO                         30510000
304900           TR024-EDL-PO-BKG-DELY-DTE.                             30520000
305000                                                                  30530000
305100     MOVE PV-TR014-EDL-PO-BKG-DELY-TM  TO                         30540000
305200           TR024-EDL-PO-BKG-DELY-TM.                              30550000
305300                                                                  30560000
305400     IF PV-TR014-EDL-PO-CART-CNT NOT NUMERIC                      30570000
305500         MOVE PV-TR014-EDL-PO-CART-CNT-X  TO                      30580000
305600               TR024-EDL-PO-CART-CNT-X                            30590000
305700         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              30600000
305800         MOVE 'PO CARTON COUNT' TO PV-HOLD-TR201-DATA-IN-ERROR    30610000
305900         MOVE PV-TR014-EDL-PO-CART-CNT-X  TO                      30620000
306000               PV-HOLD-TR201-DATA-VALUE                           30630000
306100         MOVE 'INVALID CARTON COUNT'      TO                      30640000
306200               PV-HOLD-TR201-ERROR-MSG                            30650000
306300         PERFORM 5520-LOAD-EDL-TO-REPORT                          30660000
306400         MOVE ZEROES TO TR024-EDL-PO-CART-CNT                     30670000
306500     ELSE                                                         30680000
306600         MOVE PV-TR014-EDL-PO-CART-CNT TO TR024-EDL-PO-CART-CNT   30690000
306700     END-IF.                                                      30700000
306800                                                                  30710000
306900     IF PV-TR014-EDL-PO-UNT-QTY NOT NUMERIC                       30720000
307000         MOVE PV-TR014-EDL-PO-UNT-QTY-X TO                        30730000
307100               TR024-EDL-PO-UNT-QTY-X                             30740000
307200         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              30750000
307300         MOVE 'PO UNIT QTY' TO PV-HOLD-TR201-DATA-IN-ERROR        30760000
307400         MOVE PV-TR014-EDL-PO-UNT-QTY-X TO                        30770000
307500               PV-HOLD-TR201-DATA-VALUE                           30780000
307600         MOVE 'INVALID UNIT QTY'        TO                        30790000
307700               PV-HOLD-TR201-ERROR-MSG                            30800000
307800         PERFORM 5520-LOAD-EDL-TO-REPORT                          30810000
307900         MOVE ZEROES TO TR024-EDL-PO-UNT-QTY                      30820000
308000     ELSE                                                         30830000
308100         MOVE PV-TR014-EDL-PO-UNT-QTY TO TR024-EDL-PO-UNT-QTY     30840000
308200     END-IF.                                                      30850000
308300                                                                  30860000
308400     IF PV-TR014-EDL-PO-CBMT-QTY NOT NUMERIC                      30870000
308500         MOVE PV-TR014-EDL-PO-CBMT-QTY-X TO                       30880000
308600               TR024-EDL-PO-CBMT-QTY-X                            30890000
308700         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              30900000
308800         MOVE 'PO CBMT QTY' TO PV-HOLD-TR201-DATA-IN-ERROR        30910000
308900         MOVE PV-TR014-EDL-PO-CBMT-QTY-X TO                       30920000
309000                        PV-HOLD-TR201-DATA-VALUE-NUM              30930000
309100         MOVE 'INVALID CBM QTY'          TO                       30940000
309200               PV-HOLD-TR201-ERROR-MSG                            30950000
309300         PERFORM 5520-LOAD-EDL-TO-REPORT                          30960000
309400         MOVE ZEROES TO TR024-EDL-PO-CBMT-QTY                     30970000
309500     ELSE                                                         30980000
309600         MOVE PV-TR014-EDL-PO-CBMT-QTY TO TR024-EDL-PO-CBMT-QTY   30990000
309700     END-IF.                                                      31000000
309800                                                                  31010000
309900     IF PV-TR014-EDL-PO-WT-KGRM-QTY NOT NUMERIC                   31020000
310000         MOVE PV-TR014-EDL-PO-WT-KGRM-QTY-X TO                    31030000
310100               TR024-EDL-PO-WT-KGRM-QTY-X                         31040000
310200         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              31050000
310300         MOVE 'PO WT KGRM QTY' TO PV-HOLD-TR201-DATA-IN-ERROR     31060000
310400         MOVE PV-TR014-EDL-PO-WT-KGRM-QTY-X TO                    31070000
310500               PV-HOLD-TR201-DATA-VALUE                           31080000
310600         MOVE 'INVALID KGRM QTY   '         TO                    31090000
310700               PV-HOLD-TR201-ERROR-MSG                            31100000
310800         PERFORM 5520-LOAD-EDL-TO-REPORT                          31110000
310900         MOVE ZEROES TO TR024-EDL-PO-WT-KGRM-QTY                  31120000
311000     ELSE                                                         31130000
311100         MOVE PV-TR014-EDL-PO-WT-KGRM-QTY   TO                    31140000
311200               TR024-EDL-PO-WT-KGRM-QTY                           31150000
311300     END-IF.                                                      31160000
311400                                                                  31170000
311500     MOVE PV-TR014-EDL-PROD-FCTRY-NM  TO TR024-EDL-PROD-FCTRY-NM. 31180000
311600*    IF PV-TR014-EDL-PROD-FCTRY-NM    EQUAL SPACES                31190000
311700*        MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              31200000
311800*        MOVE 'PROD FCTRY NM'   TO PV-HOLD-TR201-DATA-IN-ERROR    31210000
311900*        MOVE PV-TR014-EDL-PROD-FCTRY-NM     TO                   31220000
312000*              PV-HOLD-TR201-DATA-VALUE                           31230000
312100*        MOVE 'DATA NOT SENT'                TO                   31240000
312200*              PV-HOLD-TR201-ERROR-MSG                            31250000
312300*        PERFORM 5520-LOAD-EDL-TO-REPORT                          31260000
312400*    END-IF.                                                      31270000
312500                                                                  31280000
312600     MOVE PV-TR014-EDL-C-O-PROD-CDE   TO TR024-EDL-C-O-PROD-CDE.  31290000
312700                                                                  31300000
312800     MOVE PV-TR014-EDL-CONSOL-SCAC-ID TO TR024-EDL-CONSOL-SCAC-ID.31310000
312900     IF PV-TR014-EDL-CONSOL-SCAC-ID EQUAL SPACES                  31320000
313000         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              31330000
313100         MOVE 'CONSOL SCAC ID' TO PV-HOLD-TR201-DATA-IN-ERROR     31340000
313200         MOVE PV-TR014-EDL-CONSOL-SCAC-ID TO                      31350000
313300               PV-HOLD-TR201-DATA-VALUE                           31360000
313400         MOVE 'DATA NOT SENT'             TO                      31370000
313500               PV-HOLD-TR201-ERROR-MSG                            31380000
313600         PERFORM 5520-LOAD-EDL-TO-REPORT                          31390000
313700     END-IF.                                                      31400000
313800                                                                  31410000
313900     MOVE PV-TR014-EDL-FILE-ID       TO TR024-EDL-FILE-ID.        31413000
314000     MOVE PV-TR014-EDL-ENT-ID        TO TR024-EDL-ENT-ID.         31414000
314100     MOVE PV-TR014-EDL-PROC-SEQ-NBR  TO                           31420000
314200           TR024-EDL-PROCESS-SEQ-NBR.                             31430000
314300     PERFORM 6400-WRITE-UPDATE-RECORD.                            31440000
314400                                                                  31450000
314500******************************************************************31460000
314600*  MOVE WORKING STORAGE EDLVS RECORD FIELDS TO THE EDITED UPDATE *31470000
314700*  EXTRACT FILE.                                                 *31480000
314800******************************************************************31490000
314900 5330-LOAD-EDLVS-FIELDS-UPDATE.                                   31500000
315000                                                                  31510000
315100     PERFORM 5430-INITIAL-EDLVS-FIELDS-UPD.                       31520000
315200                                                                  31530000
315300     MOVE PV-TR014-EDLVS-TRN-TYP    TO TR024-EDLVS-TRN-TYP.       31540000
315400     MOVE PC-EDLVS                  TO TR024-EDLVS-REC-TYP-CDE.   31550000
315500     MOVE PC-21                     TO TR024-EDLVS-SEQ-NBR.       31560000
315600     MOVE PV-TR014-EDLVS-3RD-PARTY-CDE TO                         31570000
315700                                    TR024-EDLVS-3RD-PARTY-CDE.    31580000
315800                                                                  31590000
315900     IF PV-TR014-EDLVS-PO-NBR NOT NUMERIC                         31600000
316000         MOVE PV-TR014-EDLVS-PO-NBR-X TO TR024-EDLVS-PO-NBR-X     31610000
316100     ELSE                                                         31620000
316200         MOVE PV-TR014-EDLVS-PO-NBR   TO TR024-EDLVS-PO-NBR       31630000
316300     END-IF.                                                      31640000
316400                                                                  31650000
316500     MOVE PV-TR014-EDLVS-EXTL-REF-NBR TO TR024-EDLVS-EXTL-REF-NBR.31660000
316600                                                                  31670000
316700     MOVE PV-TR014-EDLVS-PO-BKG-DELY-DTE TO                       31680000
316800                                   TR024-EDLVS-PO-BKG-DELY-DTE.   31690000
316900     MOVE PV-TR014-EDLVS-PO-BKG-DELY-TM  TO                       31700000
317000                                   TR024-EDLVS-PO-BKG-DELY-TM.    31710000
317100     MOVE PV-TR014-EDLVS-ORG-SHP-FR-CDE  TO                       31720000
317200                                   TR024-EDLVS-ORGN-SHPD-FR-CDE.  31730000
317300                                                                  31740000
317400     MOVE PV-TR014-EDLVS-VS-NBR          TO TR024-EDLVS-VS-NBR.   31750000
317500                                                                  31760000
317600     IF PV-TR014-EDLVS-CART-CNT NOT NUMERIC                       31770000
317700         MOVE PV-TR014-EDLVS-CART-CNT-X  TO                       31780000
317800               TR024-EDLVS-VS-CART-CNT-X                          31790000
317900         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              31800000
318000         MOVE 'VS CARTON COUNT' TO PV-HOLD-TR201-DATA-IN-ERROR    31810000
318100         MOVE PV-TR014-EDLVS-CART-CNT-X  TO                       31820000
318200               PV-HOLD-TR201-DATA-VALUE                           31830000
318300         MOVE 'INVALID CARTON COUNT'     TO                       31840000
318400               PV-HOLD-TR201-ERROR-MSG                            31850000
318500         PERFORM 5530-LOAD-EDLVS-TO-REPORT                        31860000
318600         MOVE ZEROES TO TR024-EDLVS-VS-CART-CNT                   31870000
318700     ELSE                                                         31880000
318800         MOVE PV-TR014-EDLVS-CART-CNT TO TR024-EDLVS-VS-CART-CNT  31890000
318900     END-IF.                                                      31900000
319000                                                                  31910000
319100     IF PV-TR014-EDLVS-UNT-QTY NOT NUMERIC                        31920000
319200         MOVE PV-TR014-EDLVS-UNT-QTY-X  TO                        31930000
319300               TR024-EDLVS-VS-UNT-QTY-X                           31940000
319400         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              31950000
319500         MOVE 'VS UNIT QTY' TO PV-HOLD-TR201-DATA-IN-ERROR        31960000
319600         MOVE PV-TR014-EDLVS-UNT-QTY-X  TO                        31970000
319700               PV-HOLD-TR201-DATA-VALUE                           31980000
319800         MOVE 'INVALID UNIT QTY'        TO                        31990000
319900               PV-HOLD-TR201-ERROR-MSG                            32000000
320000         PERFORM 5530-LOAD-EDLVS-TO-REPORT                        32010000
320100         MOVE ZEROES TO TR024-EDLVS-VS-UNT-QTY                    32020000
320200     ELSE                                                         32030000
320300         MOVE PV-TR014-EDLVS-UNT-QTY TO TR024-EDLVS-VS-UNT-QTY    32040000
320400     END-IF.                                                      32050000
320500                                                                  32060000
320600     IF PV-TR014-EDLVS-CBMT-QTY NOT NUMERIC                       32070000
320700         MOVE PV-TR014-EDLVS-CBMT-QTY-X  TO                       32080000
320800               TR024-EDLVS-VS-CBMT-QTY-X                          32090000
320900         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              32100000
321000         MOVE 'VS CBMT QTY' TO PV-HOLD-TR201-DATA-IN-ERROR        32110000
321100         MOVE PV-TR014-EDLVS-CBMT-QTY-X  TO                       32120000
321200               PV-HOLD-TR201-DATA-VALUE-NUM                       32130000
321300         MOVE 'INVALID CBM QTY'          TO                       32140000
321400               PV-HOLD-TR201-ERROR-MSG                            32150000
321500         PERFORM 5530-LOAD-EDLVS-TO-REPORT                        32160000
321600         MOVE ZEROES TO TR024-EDLVS-VS-CBMT-QTY                   32170000
321700     ELSE                                                         32180000
321800         MOVE PV-TR014-EDLVS-CBMT-QTY    TO                       32190000
321900               TR024-EDLVS-VS-CBMT-QTY                            32200000
322000     END-IF.                                                      32210000
322100                                                                  32220000
322200     IF PV-TR014-EDLVS-WT-KGRM-QTY NOT NUMERIC                    32230000
322300         MOVE PV-TR014-EDLVS-WT-KGRM-QTY-X  TO                    32240000
322400               TR024-EDLVS-VS-WT-KGRM-QTY-X                       32250000
322500         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              32260000
322600         MOVE 'VS WT KGRM QTY' TO PV-HOLD-TR201-DATA-IN-ERROR     32270000
322700         MOVE PV-TR014-EDLVS-WT-KGRM-QTY-X  TO                    32280000
322800               PV-HOLD-TR201-DATA-VALUE                           32290000
322900         MOVE 'INVALID KGRM QTY'            TO                    32300000
323000               PV-HOLD-TR201-ERROR-MSG                            32310000
323100         PERFORM 5530-LOAD-EDLVS-TO-REPORT                        32320000
323200         MOVE ZEROES TO TR024-EDLVS-VS-WT-KGRM-QTY                32330000
323300     ELSE                                                         32340000
323400         MOVE PV-TR014-EDLVS-WT-KGRM-QTY    TO                    32350000
323500               TR024-EDLVS-VS-WT-KGRM-QTY                         32360000
323600     END-IF.                                                      32370000
323700                                                                  32380000
323800     MOVE PV-TR014-EDLVS-FILE-ID     TO TR024-EDLVS-FILE-ID.      32383000
323810     MOVE PV-TR014-EDLVS-ENT-ID      TO TR024-EDLVS-ENT-ID.       32384000
323820     MOVE PV-TR014-EDLVS-PROC-SEQ-NBR   TO                        32390000
323830           TR024-EDLVS-PROCESS-SEQ-NBR.                           32400000
323840     PERFORM 6400-WRITE-UPDATE-RECORD.                            32410000
323850                                                                  32420000
323860******************************************************************32430000
323870*  MOVE WORKING STORAGE EDLUPC RECORD FIELDS TO THE EDITED       *32440000
323880*  UPDATE EXTRACT FILE.                                          *32450000
323890******************************************************************32460000
323900 5340-LOAD-EDLUPC-FIELDS-UPDATE.                                  32470000
324000                                                                  32480000
324100     PERFORM 5440-INITIAL-EDLUPC-FIELDS-UPD.                      32490000
324200                                                                  32500000
324300     MOVE PV-TR014-EDLUPC-TRN-TYP   TO TR024-EDLUPC-TRN-TYP.      32510000
324400     MOVE PC-EDLUPC                 TO TR024-EDLUPC-REC-TYP-CDE.  32520000
324500     MOVE PC-22                     TO TR024-EDLUPC-SEQ-NBR.      32530000
324600     MOVE PV-TR014-EDLUPC-3RD-PARTY-CDE TO                        32540000
324700                                TR024-EDLUPC-3RD-PARTY-CDE.       32550000
324800                                                                  32560000
324900     IF PV-TR014-EDLUPC-PO-NBR NOT NUMERIC                        32570000
325000         MOVE PV-TR014-EDLUPC-PO-NBR-X TO TR024-EDLUPC-PO-NBR-X   32580000
325100     ELSE                                                         32590000
325200         MOVE PV-TR014-EDLUPC-PO-NBR TO TR024-EDLUPC-PO-NBR       32600000
325300     END-IF.                                                      32610000
325400                                                                  32620000
325500     MOVE PV-TR014-EDLUPC-EXTL-REF-NBR       TO                   32630000
325600                                   TR024-EDLUPC-EXTL-REF-NBR.     32640000
325700                                                                  32650000
325800     MOVE PV-TR014-EDLUPC-PO-BKG-DELY-DT  TO                      32660000
325900                                    TR024-EDLUPC-PO-BKG-DELY-DTE. 32670000
326000     MOVE PV-TR014-EDLUPC-PO-BKG-DELY-TM  TO                      32680000
326100                                    TR024-EDLUPC-PO-BKG-DELY-TM.  32690000
326200     MOVE PV-TR014-EDLUPC-ORG-SHP-FR-CDE  TO                      32700000
326300                                   TR024-EDLUPC-ORGN-SHPD-FR-CDE. 32710000
326400                                                                  32720000
326500     MOVE PV-TR014-EDLUPC-VS-NBR       TO TR024-EDLUPC-VS-NBR.    32730000
326600                                                                  32740000
326700     IF PV-TR014-EDLUPC-UPC-NBR NOT NUMERIC                       32750000
326800         MOVE PV-TR014-EDLUPC-UPC-NBR-X TO TR024-EDLUPC-UPC-NBR-X 32760000
326900     ELSE                                                         32770000
327000         MOVE PV-TR014-EDLUPC-UPC-NBR TO TR024-EDLUPC-UPC-NBR     32780000
327100     END-IF.                                                      32790000
327200                                                                  32800000
327300                                                                  32810000
327400     IF PV-TR014-EDLUPC-CART-CNT NOT NUMERIC                      32820000
327500         MOVE PV-TR014-EDLUPC-CART-CNT-X TO                       32830000
327600               TR024-EDLUPC-UPC-CART-CNT-X                        32840000
327700         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              32850000
327800         MOVE 'UPC CARTON COUNT' TO PV-HOLD-TR201-DATA-IN-ERROR   32860000
327900         MOVE PV-TR014-EDLUPC-CART-CNT-X   TO                     32870000
328000               PV-HOLD-TR201-DATA-VALUE                           32880000
328100         MOVE 'INVALID CARTON COUNT'       TO                     32890000
328200               PV-HOLD-TR201-ERROR-MSG                            32900000
328300         PERFORM 5540-LOAD-EDLUPC-TO-REPORT                       32910000
328400         MOVE ZEROES TO TR024-EDLUPC-UPC-CART-CNT                 32920000
328500     ELSE                                                         32930000
328600         MOVE PV-TR014-EDLUPC-CART-CNT TO                         32940000
328700                                   TR024-EDLUPC-UPC-CART-CNT      32950000
328800     END-IF.                                                      32960000
328900                                                                  32970000
329000     IF PV-TR014-EDLUPC-UNT-QTY NOT NUMERIC                       32980000
329100         MOVE PV-TR014-EDLUPC-UNT-QTY-X     TO                    32990000
329200               TR024-EDLUPC-UPC-UNT-QTY-X                         33000000
329300         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              33010000
329400         MOVE 'UPC UNIT QTY' TO PV-HOLD-TR201-DATA-IN-ERROR       33020000
329500         MOVE PV-TR014-EDLUPC-UNT-QTY-X     TO                    33030000
329600               PV-HOLD-TR201-DATA-VALUE                           33040000
329700         MOVE 'INVALID UNIT QTY'            TO                    33050000
329800               PV-HOLD-TR201-ERROR-MSG                            33060000
329900         PERFORM 5540-LOAD-EDLUPC-TO-REPORT                       33070000
330000         MOVE ZEROES TO TR024-EDLUPC-UPC-UNT-QTY                  33080000
330100     ELSE                                                         33090000
330200         MOVE PV-TR014-EDLUPC-UNT-QTY       TO                    33100000
330300               TR024-EDLUPC-UPC-UNT-QTY                           33110000
330400     END-IF.                                                      33120000
330500                                                                  33130000
330600     IF PV-TR014-EDLUPC-CBMT-QTY NOT NUMERIC                      33140000
330700         MOVE PV-TR014-EDLUPC-CBMT-QTY-X     TO                   33150000
330800               TR024-EDLUPC-UPC-CBMT-QTY-X                        33160000
330900         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              33170000
331000         MOVE 'UPC CBMT QTY' TO PV-HOLD-TR201-DATA-IN-ERROR       33180000
331100         MOVE PV-TR014-EDLUPC-CBMT-QTY-X     TO                   33190000
331200               PV-HOLD-TR201-DATA-VALUE-NUM                       33200000
331300         MOVE 'INVALID CBM QTY'              TO                   33210000
331400               PV-HOLD-TR201-ERROR-MSG                            33220000
331500         PERFORM 5540-LOAD-EDLUPC-TO-REPORT                       33230000
331600         MOVE ZEROES TO TR024-EDLUPC-UPC-CBMT-QTY                 33240000
331700     ELSE                                                         33250000
331800         MOVE PV-TR014-EDLUPC-CBMT-QTY       TO                   33260000
331900               TR024-EDLUPC-UPC-CBMT-QTY                          33270000
332000     END-IF.                                                      33280000
332100                                                                  33290000
332200     IF PV-TR014-EDLUPC-WT-KGRM-QTY NOT NUMERIC                   33300000
332300         MOVE PV-TR014-EDLUPC-WT-KGRM-QTY-X   TO                  33310000
332400               TR024-EDLUPC-UPC-WT-KGRM-QTY-X                     33320000
332500         MOVE PC-WARNING TO PV-HOLD-TR201-ERROR-TYPE              33330000
332600         MOVE 'UPC WT KGRM QTY' TO PV-HOLD-TR201-DATA-IN-ERROR    33340000
332700         MOVE PV-TR014-EDLUPC-WT-KGRM-QTY-X   TO                  33350000
332800               PV-HOLD-TR201-DATA-VALUE                           33360000
332900         MOVE 'INVALID KGRM QTY'              TO                  33370000
333000               PV-HOLD-TR201-ERROR-MSG                            33380000
333100         PERFORM 5540-LOAD-EDLUPC-TO-REPORT                       33390000
333200         MOVE ZEROES TO TR024-EDLUPC-UPC-WT-KGRM-QTY              33400000
333300     ELSE                                                         33410000
333400         MOVE PV-TR014-EDLUPC-WT-KGRM-QTY     TO                  33420000
333500               TR024-EDLUPC-UPC-WT-KGRM-QTY                       33430000
333600     END-IF.                                                      33440000
333700                                                                  33450000
333800     MOVE PV-TR014-EDLUPC-FILE-ID     TO TR024-EDLUPC-FILE-ID.    33453000
333900     MOVE PV-TR014-EDLUPC-ENT-ID      TO TR024-EDLUPC-ENT-ID.     33454000
334000     MOVE PV-TR014-EDLUPC-PROC-SEQ-NBR   TO                       33460000
334100           TR024-EDLUPC-PROCESS-SEQ-NBR.                          33470000
334200     PERFORM 6400-WRITE-UPDATE-RECORD.                            33480000
334300                                                                  33490000
334400******************************************************************33500000
334500* INITIALIZE EDD UPDATE RECORD FIELDS.                           *33510000
334600******************************************************************33520000
334700 5400-INITIAL-EDD-FIELDS-UPD.                                     33530000
334800                                                                  33540000
334900     MOVE ZEROES             TO  TR024-EDD-PO-NBR                 33550000
335000                                 TR024-EDD-ENT-ID.                33560000
335100                                                                  33570000
335200     MOVE SPACES             TO  TR024-EDD-TRN-TYP                33580000
335300                                 TR024-EDD-REC-TYP-CDE            33590000
335400                                 TR024-EDD-SEQ-NBR                33600000
335500                                 TR024-EDD-3RD-PARTY-CDE          33610000
335600                                 TR024-EDD-EXTL-REF-NBR           33620000
335700                                 TR024-EDD-PO-BKG-DELY-DTE        33630000
335800                                 TR024-EDD-PO-BKG-DELY-TM         33640000
335900                                 TR024-EDD-ORGN-SHPD-FR-CDE       33650000
336000                                 TR024-EDD-IMPRT-TRIP-ID          33660000
336100                                 TR024-EDD-CARR-SCAC-ID           33670000
336200                                 TR024-EDD-IMPRT-VEH-NM           33680000
336300                                 TR024-EDD-POE-DELY-DTE           33690000
336400                                 TR024-EDD-POE-DELY-TM            33700000
336500                                 TR024-EDD-DPRTR-DTE              33710000
336600                                 TR024-EDD-DPRTR-TM               33720000
336700                                 TR024-EDD-FOB-CDE                33730000
336800                                 TR024-EDD-DEST-POE-CDE           33740000
336900                                 TR024-EDD-EST-LBD-NM             33750000
337000                                 TR024-EDD-TRIP-TYP-CDE           33760000
337100                                 TR024-EDD-FILLER                 33770000
337200                                 TR024-EDD-FILE-ID.               33771000
337300                                                                  33780000
337400******************************************************************33790000
337500* INITIALIZE EDDRSN UPDATE RECORD FIELDS.                        *33800000
337600******************************************************************33810000
337700 5410-INITIAL-EDDRSN-FIELDS-UPD.                                  33820000
337800                                                                  33830000
337900     MOVE ZEROES             TO  TR024-EDDRSN-PO-NBR.             33840000
338000                                                                  33850000
338100     MOVE SPACES             TO  TR024-EDDRSN-TRN-TYP             33860000
338200                                 TR024-EDDRSN-REC-TYP-CDE         33870000
338300                                 TR024-EDDRSN-SEQ-NBR             33880000
338400                                 TR024-EDDRSN-3RD-PARTY-CDE       33890000
338500                                 TR024-EDDRSN-EXTL-REF-NBR        33900000
338600                                 TR024-EDDRSN-PO-BKG-DELY-DTE     33910000
338700                                 TR024-EDDRSN-PO-BKG-DELY-TM      33920000
338800                                 TR024-EDDRSN-ORGN-SHPD-FR-CDE    33930000
338900                                 TR024-EDDRSN-IMPRT-TRIP-ID       33940000
339000                                 TR024-EDDRSN-CARR-SCAC-ID        33950000
339100                                 TR024-EDDRSN-POE-DELY-DTE        33960000
339200                                 TR024-EDDRSN-POE-DELY-TM         33970000
339300                                 TR024-EDDRSN-DPRTR-DTE           33980000
339400                                 TR024-EDDRSN-DPRTR-TM            33990000
339500                                 TR024-EDDRSN-VOY-CHG-RSN-DESC    34000000
339600                                 TR024-EDDRSN-FILLER.             34010000
339700                                                                  34020000
339800******************************************************************34030000
339900* INITIALIZE EDL REPORT RECORD FIELDS.                           *34040000
340000******************************************************************34050000
340100 5420-INITIAL-EDL-FIELDS-UPD.                                     34060000
340200                                                                  34070000
340300     MOVE SPACES             TO  TR024-EDL-TRN-TYP                34080000
340400                                 TR024-EDL-REC-TYP-CDE            34090000
340500                                 TR024-EDL-SEQ-NBR                34100000
340600                                 TR024-EDL-3RD-PARTY-CDE          34110000
340700                                 TR024-EDL-EXTL-REF-NBR           34120000
340800                                 TR024-EDL-PO-BKG-DELY-DTE        34130000
340900                                 TR024-EDL-PO-BKG-DELY-TM         34140000
341000                                 TR024-EDL-PROD-FCTRY-NM          34150000
341100                                 TR024-EDL-C-O-PROD-CDE           34160000
341200                                 TR024-EDL-ORGN-SHPD-FR-CDE       34170000
341300                                 TR024-EDL-CONSOL-SCAC-ID         34180000
341400                                 TR024-EDL-FILLER.                34190000
341500                                                                  34200000
341600     MOVE ZEROES             TO  TR024-EDL-PO-NBR                 34210000
341700                                 TR024-EDL-PO-CART-CNT            34220000
341800                                 TR024-EDL-PO-UNT-QTY             34230000
341900                                 TR024-EDL-PO-CBMT-QTY            34240000
342000                                 TR024-EDL-PO-WT-KGRM-QTY.        34250000
342100                                                                  34260000
342200******************************************************************34270000
342300* INITIALIZE EDLVS REPORT RECORD FIELDS.                         *34280000
342400******************************************************************34290000
342500 5430-INITIAL-EDLVS-FIELDS-UPD.                                   34300000
342600                                                                  34310000
342700     MOVE SPACES             TO  TR024-EDLVS-TRN-TYP              34320000
342800                                 TR024-EDLVS-REC-TYP-CDE          34330000
342900                                 TR024-EDLVS-SEQ-NBR              34340000
343000                                 TR024-EDLVS-3RD-PARTY-CDE        34350000
343100                                 TR024-EDLVS-EXTL-REF-NBR         34360000
343200                                 TR024-EDLVS-PO-BKG-DELY-DTE      34370000
343300                                 TR024-EDLVS-PO-BKG-DELY-TM       34380000
343400                                 TR024-EDLVS-ORGN-SHPD-FR-CDE     34390000
343500                                 TR024-EDLVS-VS-NBR               34400000
343600                                 TR024-EDLVS-FILLER.              34410000
343700                                                                  34420000
343800     MOVE ZEROES             TO  TR024-EDLVS-PO-NBR               34430000
343900                                 TR024-EDLVS-VS-CART-CNT          34440000
344000                                 TR024-EDLVS-VS-UNT-QTY           34450000
344100                                 TR024-EDLVS-VS-CBMT-QTY          34460000
344200                                 TR024-EDLVS-VS-WT-KGRM-QTY.      34470000
344300                                                                  34480000
344400******************************************************************34490000
344500* INITIALIZE EDLUPC REPORT RECORD FIELDS.                        *34500000
344600******************************************************************34510000
344700 5440-INITIAL-EDLUPC-FIELDS-UPD.                                  34520000
344800                                                                  34530000
344900     MOVE SPACES             TO  TR024-EDLUPC-TRN-TYP             34540000
345000                                 TR024-EDLUPC-REC-TYP-CDE         34550000
345100                                 TR024-EDLUPC-SEQ-NBR             34560000
345200                                 TR024-EDLUPC-3RD-PARTY-CDE       34570000
345300                                 TR024-EDLUPC-EXTL-REF-NBR        34580000
345400                                 TR024-EDLUPC-PO-BKG-DELY-DTE     34590000
345500                                 TR024-EDLUPC-PO-BKG-DELY-TM      34600000
345600                                 TR024-EDLUPC-ORGN-SHPD-FR-CDE    34610000
345700                                 TR024-EDLUPC-VS-NBR              34620000
345800                                 TR024-EDLUPC-FILLER.             34630000
345900                                                                  34640000
346000     MOVE ZEROES             TO  TR024-EDLUPC-PO-NBR              34650000
346100                                 TR024-EDLUPC-UPC-NBR             34660000
346200                                 TR024-EDLUPC-UPC-CART-CNT        34670000
346300                                 TR024-EDLUPC-UPC-UNT-QTY         34680000
346400                                 TR024-EDLUPC-UPC-CBMT-QTY        34690000
346500                                 TR024-EDLUPC-UPC-WT-KGRM-QTY.    34700000
346600                                                                  34710000
346700******************************************************************34720000
346800* LOAD EDD RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR    *34730000
346900* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *34740000
347000******************************************************************34750000
347100 5500-LOAD-EDD-TO-REPORT.                                         34760000
347200                                                                  34770000
347300     PERFORM 5600-INITIAL-EDD-FIELDS.                             34780000
347400                                                                  34790000
347500     MOVE PV-TR014-EDD-TRN-TYP       TO PV-HOLD-TR201-TRN-TYP.    34800000
347600     MOVE PC-EDD                     TO TR201-REC-TYP-EDD-CDE     34810000
347700                                        PV-HOLD-TR201-REC-TYP.    34820000
347800     MOVE PC-10                      TO TR201-EDD-SEQ-NBR.        34830000
347900     MOVE PV-TR014-EDD-3RD-PARTY-CDE TO TR201-EDD-3RD-PARTY-CDE.  34840000
348000                                                                  34850000
348100     IF PV-TR014-EDD-PO-NBR NUMERIC                               34860000
348200         MOVE PV-TR014-EDD-PO-NBR    TO PV-HOLD-TR201-PO-NBR      34870000
348300     ELSE                                                         34880000
348400         MOVE PV-TR014-EDD-PO-NBR-X  TO PV-HOLD-TR201-PO-NBR-X    34890000
348500     END-IF.                                                      34900000
348600                                                                  34910000
348700     MOVE PV-TR014-EDD-EXTL-REF-NBR    TO                         34920000
348800                                PV-HOLD-TR201-EXTL-REF-NBR.       34930000
348900     MOVE PV-TR014-EDD-PO-BKG-DELY-DTE TO                         34940000
349000                                PV-HOLD-TR201-PO-BKG-DELY-DTE.    34950000
349100     MOVE PV-TR014-EDD-PO-BKG-DELY-TM  TO                         34960000
349200                                PV-HOLD-TR201-PO-BKG-DELY-TM.     34970000
349300     MOVE PV-TR014-EDD-ORGN-SHPD-FR-CDE TO                        34980000
349400                                PV-HOLD-TR201-ORGN-SHPD-FR-CDE.   34990000
349500                                                                  35000000
349600     MOVE PV-TR014-EDD-IMPRT-TRIP-ID  TO TR201-EDD-IMPRT-TRIP-ID. 35010000
349700     MOVE PV-TR014-EDD-CARR-SCAC-ID   TO TR201-EDD-CARR-SCAC-ID.  35020000
349800     MOVE PV-TR014-EDD-IMPRT-VEH-NM   TO TR201-EDD-IMPRT-VEH-NM.  35030000
349900     MOVE PV-TR014-EDD-POE-DELY-DTE   TO TR201-EDD-POE-DELY-DTE.  35040000
350000     MOVE PV-TR014-EDD-POE-DELY-TM    TO TR201-EDD-POE-DELY-TM.   35050000
350100                                                                  35070000
350200     MOVE PV-TR014-EDD-DPRTR-DTE      TO TR201-EDD-DPRTR-DTE.     35080000
350300     MOVE PV-TR014-EDD-DPRTR-TM       TO TR201-EDD-DPRTR-TM.      35090000
350400     MOVE PV-TR014-EDD-FOB-CDE        TO TR201-EDD-FOB-CDE.       35100000
350500     MOVE PV-TR014-EDD-DEST-POE-CDE   TO TR201-EDD-DEST-POE-CDE.  35110000
350600     MOVE PV-TR014-EDD-EST-LBD-NM     TO TR201-EDD-EST-LBD-NM.    35120000
350700     MOVE PV-TR014-EDD-TRIP-TYP-CDE   TO TR201-EDD-TRIP-TYP-CDE.  35130000
350800     MOVE PV-TR014-EDD-ENT-ID         TO TR201-DAT-SRC-ENT-ID.    35131000
350900     MOVE PV-TR014-EDD-PROC-SEQ-NBR   TO TR201-PROCESS-SEQ-NBR.   35140000
351000                                                                  35150000
351100     PERFORM 6200-WRITE-LOAD-REPORT.                              35160000
351200                                                                  35170000
351300******************************************************************35180000
351400* LOAD EDDRSN RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR *35190000
351500* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *35200000
351600******************************************************************35210000
351700 5510-LOAD-EDDRSN-TO-REPORT.                                      35220000
351800                                                                  35230000
351900     PERFORM 5610-INITIAL-EDDRSN-FIELDS.                          35240000
352000                                                                  35250000
352100     MOVE PV-TR014-EDDRSN-TRN-TYP    TO PV-HOLD-TR201-TRN-TYP.    35260000
352200     MOVE PC-EDDRSN                  TO TR201-REC-TYP-EDDRSN-CDE  35270000
352300                                        PV-HOLD-TR201-REC-TYP.    35280000
352400     MOVE PC-11                      TO TR201-EDDRSN-SEQ-NBR.     35290000
352500     MOVE PV-TR014-EDDRSN-3RD-PARTY-CDE TO                        35300000
352600                                   TR201-EDDRSN-3RD-PARTY-CDE.    35310000
352700                                                                  35320000
352800     IF PV-TR014-EDDRSN-PO-NBR NUMERIC                            35330000
352900         MOVE PV-TR014-EDDRSN-PO-NBR  TO PV-HOLD-TR201-PO-NBR     35340000
353000     ELSE                                                         35350000
353100         MOVE PV-TR014-EDDRSN-PO-NBR-X TO PV-HOLD-TR201-PO-NBR-X  35360000
353200     END-IF.                                                      35370000
353300                                                                  35380000
353400     MOVE PV-TR014-EDDRSN-EXTL-REF-NBR    TO                      35390000
353500                                PV-HOLD-TR201-EXTL-REF-NBR.       35400000
353600     MOVE PV-TR014-EDDRSN-PO-BKG-DELY-DT  TO                      35410000
353700                                PV-HOLD-TR201-PO-BKG-DELY-DTE.    35420000
353800     MOVE PV-TR014-EDDRSN-PO-BKG-DELY-TM  TO                      35430000
353900                                PV-HOLD-TR201-PO-BKG-DELY-TM.     35440000
354000     MOVE PV-TR014-EDDRSN-ORG-SHP-FR-CDE TO                       35450000
354100                                PV-HOLD-TR201-ORGN-SHPD-FR-CDE.   35460000
354200     MOVE PV-TR014-EDDRSN-IMPRT-TRIP-ID   TO                      35480000
354300                                TR201-EDDRSN-IMPRT-TRIP-ID.       35490000
354400     MOVE PV-TR014-EDDRSN-CARR-SCAC-ID    TO                      35500000
354500                                TR201-EDDRSN-CARR-SCAC-ID.        35510000
354600     MOVE PV-TR014-EDDRSN-POE-DELY-DTE    TO                      35520000
354700                                TR201-EDDRSN-POE-DELY-DTE.        35530000
354800     MOVE PV-TR014-EDDRSN-POE-DELY-TM     TO                      35540000
354900                                TR201-EDDRSN-POE-DELY-TM.         35550000
355000     MOVE PV-TR014-EDDRSN-DPRTR-DTE       TO                      35560000
355100                                TR201-EDDRSN-DPRTR-DTE.           35570000
355200     MOVE PV-TR014-EDDRSN-DPRTR-TM        TO                      35580000
355300                                TR201-EDDRSN-DPRTR-TM.            35590000
355400     MOVE PV-TR014-EDDRSN-VOY-CHG-RSN-DS  TO                      35600000
355500                                TR201-EDDRSN-VOY-CHG-RSN-DESC.    35610000
355600     MOVE PV-TR014-EDDRSN-ENT-ID        TO TR201-DAT-SRC-ENT-ID.  35611000
355700     MOVE PV-TR014-EDDRSN-PROC-SEQ-NBR  TO TR201-PROCESS-SEQ-NBR. 35620000
355800                                                                  35630000
355900     PERFORM 6200-WRITE-LOAD-REPORT.                              35640000
356000                                                                  35650000
356100******************************************************************35660000
356200* LOAD EDL RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR    *35670000
356300* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *35680000
356400******************************************************************35690000
356500 5520-LOAD-EDL-TO-REPORT.                                         35700000
356600                                                                  35710000
356700     PERFORM 5620-INITIAL-EDL-FIELDS.                             35720000
356800                                                                  35730000
356900     MOVE PV-TR014-EDL-TRN-TYP       TO PV-HOLD-TR201-TRN-TYP.    35740000
357000     MOVE PC-EDL                     TO TR201-REC-TYP-EDL-CDE     35750000
357100                                        PV-HOLD-TR201-REC-TYP.    35760000
357200     MOVE PC-20                      TO TR201-EDL-SEQ-NBR.        35770000
357300     MOVE PV-TR014-EDL-3RD-PARTY-CDE TO TR201-EDL-3RD-PARTY-CDE.  35780000
357400                                                                  35790000
357500     IF PV-TR014-EDL-PO-NBR NUMERIC                               35800000
357600         MOVE PV-TR014-EDL-PO-NBR      TO PV-HOLD-TR201-PO-NBR    35810000
357700     ELSE                                                         35820000
357800         MOVE PV-TR014-EDL-PO-NBR-X    TO PV-HOLD-TR201-PO-NBR-X  35830000
357900     END-IF.                                                      35840000
358000                                                                  35850000
358100     MOVE PV-TR014-EDL-EXTL-REF-NBR    TO                         35860000
358200                                PV-HOLD-TR201-EXTL-REF-NBR.       35870000
358300     MOVE PV-TR014-EDL-PO-BKG-DELY-DTE TO                         35880000
358400                                PV-HOLD-TR201-PO-BKG-DELY-DTE.    35890000
358500     MOVE PV-TR014-EDL-PO-BKG-DELY-TM  TO                         35900000
358600                                PV-HOLD-TR201-PO-BKG-DELY-TM.     35910000
358700     MOVE PV-TR014-EDL-ORGN-SHPD-FR-CDE TO                        35920000
358800                                PV-HOLD-TR201-ORGN-SHPD-FR-CDE.   35930000
358900                                                                  35940000
359000     MOVE PV-TR014-EDL-C-O-PROD-CDE   TO TR201-EDL-C-O-PROD-CDE.  35950000
359100     MOVE PV-TR014-EDL-PROD-FCTRY-NM  TO TR201-EDL-PROD-FCTRY-NM. 35960000
359200                                                                  35970000
359300     IF PV-TR014-EDL-PO-CART-CNT NUMERIC                          35980000
359400         MOVE PV-TR014-EDL-PO-CART-CNT TO TR201-EDL-PO-CART-CNT   35990000
359500     ELSE                                                         36000000
359600         MOVE PV-TR014-EDL-PO-CART-CNT TO TR201-EDL-PO-CART-CNT-X 36010000
359700     END-IF.                                                      36020000
359800                                                                  36030000
359900     IF PV-TR014-EDL-PO-UNT-QTY NUMERIC                           36040000
360000         MOVE PV-TR014-EDL-PO-UNT-QTY TO TR201-EDL-PO-UNT-QTY     36050000
360100     ELSE                                                         36060000
360200         MOVE PV-TR014-EDL-PO-UNT-QTY-X TO TR201-EDL-PO-UNT-QTY-X 36070000
360300     END-IF.                                                      36080000
360400                                                                  36090000
360500     IF PV-TR014-EDL-PO-CBMT-QTY NUMERIC                          36100000
360600         MOVE PV-TR014-EDL-PO-CBMT-QTY TO TR201-EDL-PO-CBMT-QTY   36110000
360700     ELSE                                                         36120000
360800         MOVE PV-TR014-EDL-PO-CBMT-QTY-X TO                       36130000
360900                                   TR201-EDL-PO-CBMT-QTY-X        36140000
361000     END-IF.                                                      36150000
361100                                                                  36160000
361200     IF PV-TR014-EDL-PO-WT-KGRM-QTY NUMERIC                       36170000
361300         MOVE PV-TR014-EDL-PO-WT-KGRM-QTY        TO               36180000
361400                                      TR201-EDL-PO-WT-KGRM-QTY    36190000
361500     ELSE                                                         36200000
361600         MOVE PV-TR014-EDL-PO-WT-KGRM-QTY-X      TO               36210000
361700                                      TR201-EDL-PO-WT-KGRM-QTY-X  36220000
361800     END-IF.                                                      36230000
361900                                                                  36240000
362000     MOVE PV-TR014-EDL-CONSOL-SCAC-ID TO TR201-EDL-CONSOL-SCAC-ID.36250000
362100     MOVE PV-TR014-EDL-ENT-ID         TO TR201-DAT-SRC-ENT-ID.    36251000
362200     MOVE PV-TR014-EDL-PROC-SEQ-NBR   TO TR201-PROCESS-SEQ-NBR.   36260000
362300                                                                  36270000
362400     PERFORM 6200-WRITE-LOAD-REPORT.                              36280000
362500                                                                  36290000
362600******************************************************************36300000
362700* LOAD EDLVS RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR  *36310000
362800* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *36320000
362900******************************************************************36330000
363000 5530-LOAD-EDLVS-TO-REPORT.                                       36340000
363100                                                                  36350000
363200     PERFORM 5630-INITIAL-EDLVS-FIELDS.                           36360000
363300                                                                  36370000
363400     MOVE PV-TR014-EDLVS-TRN-TYP     TO PV-HOLD-TR201-TRN-TYP.    36380000
363500     MOVE PC-EDLVS                   TO TR201-REC-TYP-EDLVS-CDE   36390000
363600                                        PV-HOLD-TR201-REC-TYP.    36400000
363700     MOVE PC-21                      TO TR201-EDLVS-SEQ-NBR.      36410000
363800     MOVE PV-TR014-EDLVS-3RD-PARTY-CDE   TO                       36420000
363900                                TR201-EDLVS-3RD-PARTY-CDE.        36430000
364000                                                                  36440000
364100     IF PV-TR014-EDLVS-PO-NBR NUMERIC                             36450000
364200         MOVE PV-TR014-EDLVS-PO-NBR    TO PV-HOLD-TR201-PO-NBR    36460000
364300     ELSE                                                         36470000
364400         MOVE PV-TR014-EDLVS-PO-NBR-X  TO PV-HOLD-TR201-PO-NBR-X  36480000
364500     END-IF.                                                      36490000
364600                                                                  36500000
364700     MOVE PV-TR014-EDLVS-EXTL-REF-NBR    TO                       36510000
364800                                PV-HOLD-TR201-EXTL-REF-NBR.       36520000
364900     MOVE PV-TR014-EDLVS-PO-BKG-DELY-DTE TO                       36530000
365000                                PV-HOLD-TR201-PO-BKG-DELY-DTE.    36540000
365100     MOVE PV-TR014-EDLVS-PO-BKG-DELY-TM  TO                       36550000
365200                                PV-HOLD-TR201-PO-BKG-DELY-TM.     36560000
365300     MOVE PV-TR014-EDLVS-ORG-SHP-FR-CDE TO                        36570000
365400                                PV-HOLD-TR201-ORGN-SHPD-FR-CDE.   36580000
365500                                                                  36590000
365600     MOVE PV-TR014-EDLVS-VS-NBR          TO TR201-EDLVS-VS-NBR.   36600000
365700                                                                  36610000
365800     IF PV-TR014-EDLVS-CART-CNT NUMERIC                           36620000
365900         MOVE PV-TR014-EDLVS-CART-CNT    TO                       36630000
366000                                    TR201-EDLVS-VS-CART-CNT       36640000
366100     ELSE                                                         36650000
366200         MOVE PV-TR014-EDLVS-CART-CNT-X  TO                       36660000
366300                                    TR201-EDLVS-VS-CART-CNT-X     36670000
366400     END-IF.                                                      36680000
366500                                                                  36690000
366600     IF PV-TR014-EDLVS-UNT-QTY NUMERIC                            36700000
366700         MOVE PV-TR014-EDLVS-UNT-QTY      TO                      36710000
366800                                    TR201-EDLVS-VS-UNT-QTY        36720000
366900     ELSE                                                         36730000
367000         MOVE PV-TR014-EDLVS-UNT-QTY-X    TO                      36740000
367100                                    TR201-EDLVS-VS-UNT-QTY-X      36750000
367200     END-IF.                                                      36760000
367300                                                                  36770000
367400     IF PV-TR014-EDLVS-CBMT-QTY NUMERIC                           36780000
367500         MOVE PV-TR014-EDLVS-CBMT-QTY     TO                      36790000
367600                                    TR201-EDLVS-VS-CBMT-QTY       36800000
367700     ELSE                                                         36810000
367800         MOVE PV-TR014-EDLVS-CBMT-QTY-X   TO                      36820000
367900                                    TR201-EDLVS-VS-CBMT-QTY-X     36830000
368000     END-IF.                                                      36840000
368100                                                                  36850000
368200     IF PV-TR014-EDLVS-WT-KGRM-QTY NUMERIC                        36860000
368300         MOVE PV-TR014-EDLVS-WT-KGRM-QTY     TO                   36870000
368400                                   TR201-EDLVS-VS-WT-KGRM-QTY     36880000
368500     ELSE                                                         36890000
368600         MOVE PV-TR014-EDLVS-WT-KGRM-QTY-X   TO                   36900000
368700                                   TR201-EDLVS-VS-WT-KGRM-QTY-X   36910000
368800     END-IF.                                                      36920000
368900                                                                  36930000
369000     MOVE PV-TR014-EDLVS-ENT-ID       TO TR201-DAT-SRC-ENT-ID.    36931000
369100     MOVE PV-TR014-EDLVS-PROC-SEQ-NBR TO                          36940000
369200                                TR201-PROCESS-SEQ-NBR.            36950000
369300                                                                  36960000
369400     PERFORM 6200-WRITE-LOAD-REPORT.                              36970000
369500                                                                  36980000
369600******************************************************************36990000
369700* LOAD EDLUPC RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR *37000000
369800* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *37010000
369900******************************************************************37020000
370000 5540-LOAD-EDLUPC-TO-REPORT.                                      37030000
370100                                                                  37040000
370200     PERFORM 5640-INITIAL-EDLUPC-FIELDS.                          37050000
370300                                                                  37060000
370400     MOVE PV-TR014-EDLUPC-TRN-TYP    TO PV-HOLD-TR201-TRN-TYP.    37070000
370500     MOVE PC-EDLUPC                  TO TR201-REC-TYP-EDLUPC-CDE  37080000
370600                                        PV-HOLD-TR201-REC-TYP.    37090000
370700     MOVE PC-22                      TO TR201-EDLUPC-SEQ-NBR.     37100000
370800     MOVE PV-TR014-EDLUPC-3RD-PARTY-CDE TO                        37110000
370900                                TR201-EDLUPC-3RD-PARTY-CDE.       37120000
371000                                                                  37130000
371100     IF PV-TR014-EDLUPC-PO-NBR NUMERIC                            37140000
371200         MOVE PV-TR014-EDLUPC-PO-NBR   TO PV-HOLD-TR201-PO-NBR    37150000
371300     ELSE                                                         37160000
371400         MOVE PV-TR014-EDLUPC-PO-NBR-X TO PV-HOLD-TR201-PO-NBR-X  37170000
371500     END-IF.                                                      37180000
371600                                                                  37190000
371700     MOVE PV-TR014-EDLUPC-EXTL-REF-NBR    TO                      37200000
371800                                PV-HOLD-TR201-EXTL-REF-NBR.       37210000
371900     MOVE PV-TR014-EDLUPC-PO-BKG-DELY-DT  TO                      37220000
372000                                PV-HOLD-TR201-PO-BKG-DELY-DTE.    37230000
372100     MOVE PV-TR014-EDLUPC-PO-BKG-DELY-TM  TO                      37240000
372200                                PV-HOLD-TR201-PO-BKG-DELY-TM.     37250000
372300     MOVE PV-TR014-EDLUPC-ORG-SHP-FR-CDE TO                       37260000
372400                                PV-HOLD-TR201-ORGN-SHPD-FR-CDE.   37270000
372500                                                                  37280000
372600     MOVE PV-TR014-EDLUPC-VS-NBR       TO TR201-EDLUPC-VS-NBR.    37290000
372700                                                                  37300000
372800     IF PV-TR014-EDLUPC-UPC-NBR NUMERIC                           37310000
372900         MOVE PV-TR014-EDLUPC-UPC-NBR   TO TR201-EDLUPC-UPC-NBR   37320000
373000     ELSE                                                         37330000
373100         MOVE PV-TR014-EDLUPC-UPC-NBR-X TO TR201-EDLUPC-UPC-NBR-X 37340000
373200     END-IF.                                                      37350000
373300                                                                  37360000
373400     IF PV-TR014-EDLUPC-CART-CNT NUMERIC                          37370000
373500         MOVE PV-TR014-EDLUPC-CART-CNT     TO                     37380000
373600                                   TR201-EDLUPC-UPC-CART-CNT      37390000
373700     ELSE                                                         37400000
373800         MOVE PV-TR014-EDLUPC-CART-CNT-X   TO                     37410000
373900                                   TR201-EDLUPC-UPC-CART-CNT-X    37420000
374000     END-IF.                                                      37430000
374100                                                                  37440000
374200     IF PV-TR014-EDLUPC-UNT-QTY NUMERIC                           37450000
374300         MOVE PV-TR014-EDLUPC-UNT-QTY     TO                      37460000
374400                                   TR201-EDLUPC-UPC-UNT-QTY       37470000
374500     ELSE                                                         37480000
374600         MOVE PV-TR014-EDLUPC-UNT-QTY-X   TO                      37490000
374700                                   TR201-EDLUPC-UPC-UNT-QTY-X     37500000
374800     END-IF.                                                      37510000
374900                                                                  37520000
375000     IF PV-TR014-EDLUPC-CBMT-QTY NUMERIC                          37530000
375100         MOVE PV-TR014-EDLUPC-CBMT-QTY   TO                       37540000
375200                                   TR201-EDLUPC-UPC-CBMT-QTY      37550000
375300     ELSE                                                         37560000
375400         MOVE PV-TR014-EDLUPC-CBMT-QTY-X TO                       37570000
375500                                   TR201-EDLUPC-UPC-CBMT-QTY-X    37580000
375600     END-IF.                                                      37590000
375700                                                                  37600000
375800     IF PV-TR014-EDLUPC-WT-KGRM-QTY NUMERIC                       37610000
375900         MOVE PV-TR014-EDLUPC-WT-KGRM-QTY     TO                  37620000
376000                                   TR201-EDLUPC-UPC-WT-KGRM-QTY   37630000
376100     ELSE                                                         37640000
376200         MOVE PV-TR014-EDLUPC-WT-KGRM-QTY-X   TO                  37650000
376300                                   TR201-EDLUPC-UPC-WT-KGRM-QTY-X 37660000
376400     END-IF.                                                      37670000
376500                                                                  37680000
376600     MOVE PV-TR014-EDLUPC-ENT-ID      TO TR201-DAT-SRC-ENT-ID.    37681000
376700     MOVE PV-TR014-EDLUPC-PROC-SEQ-NBR TO                         37690000
376800                                   TR201-PROCESS-SEQ-NBR.         37700000
376900                                                                  37710000
377000     PERFORM 6200-WRITE-LOAD-REPORT.                              37720000
377100                                                                  37730000
377200******************************************************************37740000
377300* INITIALIZE EDD REPORT RECORD FIELDS.                           *37750000
377400******************************************************************37760000
377500 5600-INITIAL-EDD-FIELDS.                                         37770000
377600                                                                  37780000
377700     MOVE SPACES             TO  TR201-REC-TYP-EDD-CDE            37790000
377800                                 TR201-EDD-SEQ-NBR                37800000
377900                                 TR201-EDD-3RD-PARTY-CDE          37810000
378000                                 TR201-EDD-IMPRT-TRIP-ID          37820000
378100                                 TR201-EDD-CARR-SCAC-ID           37830000
378200                                 TR201-EDD-IMPRT-VEH-NM           37840000
378300                                 TR201-EDD-POE-DELY-DTE           37850000
378400                                 TR201-EDD-POE-DELY-TM            37860000
378500                                 TR201-EDD-DPRTR-DTE              37870000
378600                                 TR201-EDD-DPRTR-TM               37880000
378700                                 TR201-EDD-FOB-CDE                37890000
378800                                 TR201-EDD-DEST-POE-CDE           37900000
378900                                 TR201-EDD-EST-LBD-NM             37910000
379000                                 TR201-EDD-TRIP-TYP-CDE           37920000
379100                                 TR201-EDD-FILLER.                37930000
379200                                                                  37940000
379300******************************************************************37950000
379400* INITIALIZE EDDRSN REPORT RECORD FIELDS.                        *37960000
379500******************************************************************37970000
379600 5610-INITIAL-EDDRSN-FIELDS.                                      37980000
379700                                                                  37990000
379800     MOVE SPACES             TO  TR201-REC-TYP-EDDRSN-CDE         38000000
379900                                 TR201-EDDRSN-SEQ-NBR             38010000
380000                                 TR201-EDDRSN-3RD-PARTY-CDE       38020000
380100                                 TR201-EDDRSN-IMPRT-TRIP-ID       38030000
380200                                 TR201-EDDRSN-CARR-SCAC-ID        38040000
380300                                 TR201-EDDRSN-POE-DELY-DTE        38050000
380400                                 TR201-EDDRSN-POE-DELY-TM         38060000
380500                                 TR201-EDDRSN-DPRTR-DTE           38070000
380600                                 TR201-EDDRSN-DPRTR-TM            38080000
380700                                 TR201-EDDRSN-VOY-CHG-RSN-DESC    38090000
380800                                 TR201-EDDRSN-FILLER.             38100000
380900                                                                  38110000
381000******************************************************************38120000
381100* INITIALIZE EDL REPORT RECORD FIELDS.                           *38130000
381200******************************************************************38140000
381300 5620-INITIAL-EDL-FIELDS.                                         38150000
381400                                                                  38160000
381500     MOVE SPACES             TO  TR201-REC-TYP-EDL-CDE            38170000
381600                                 TR201-EDL-SEQ-NBR                38180000
381700                                 TR201-EDL-3RD-PARTY-CDE          38190000
381800                                 TR201-EDL-PROD-FCTRY-NM          38200000
381900                                 TR201-EDL-C-O-PROD-CDE           38210000
382000                                 TR201-EDL-CONSOL-SCAC-ID         38220000
382100                                 TR201-EDL-FILLER.                38230000
382200                                                                  38240000
382300     MOVE ZEROES             TO  TR201-EDL-PO-CART-CNT            38250000
382400                                 TR201-EDL-PO-UNT-QTY             38260000
382500                                 TR201-EDL-PO-CBMT-QTY            38270000
382600                                 TR201-EDL-PO-WT-KGRM-QTY.        38280000
382700                                                                  38290000
382800******************************************************************38300000
382900* INITIALIZE EDLVS REPORT RECORD FIELDS.                         *38310000
383000******************************************************************38320000
383100 5630-INITIAL-EDLVS-FIELDS.                                       38330000
383200                                                                  38340000
383300     MOVE SPACES             TO  TR201-REC-TYP-EDLVS-CDE          38350000
383400                                 TR201-EDLVS-SEQ-NBR              38360000
383500                                 TR201-EDLVS-3RD-PARTY-CDE        38370000
383600                                 TR201-EDLVS-VS-NBR               38380000
383700                                 TR201-EDLVS-FILLER.              38390000
383800                                                                  38400000
383900     MOVE ZEROES             TO  TR201-EDLVS-VS-CART-CNT          38410000
384000                                 TR201-EDLVS-VS-UNT-QTY           38420000
384100                                 TR201-EDLVS-VS-CBMT-QTY          38430000
384200                                 TR201-EDLVS-VS-WT-KGRM-QTY.      38440000
384300                                                                  38450000
384400******************************************************************38460000
384500* INITIALIZE EDLUPC REPORT RECORD FIELDS.                        *38470000
384600******************************************************************38480000
384700 5640-INITIAL-EDLUPC-FIELDS.                                      38490000
384800                                                                  38500000
384900     MOVE SPACES             TO  TR201-REC-TYP-EDLUPC-CDE         38510000
385000                                 TR201-EDLUPC-SEQ-NBR             38520000
385100                                 TR201-EDLUPC-3RD-PARTY-CDE       38530000
385200                                 TR201-EDLUPC-VS-NBR              38540000
385300                                 TR201-EDLUPC-FILLER.             38550000
385400                                                                  38560000
385500     MOVE ZEROES             TO  TR201-EDLUPC-UPC-CART-CNT        38570000
385600                                 TR201-EDLUPC-UPC-NBR             38580000
385700                                 TR201-EDLUPC-UPC-UNT-QTY         38590000
385800                                 TR201-EDLUPC-UPC-CBMT-QTY        38600000
385900                                 TR201-EDLUPC-UPC-WT-KGRM-QTY.    38610000
386000                                                                  38620000
386100******************************************************************38630000
386200* INITIALIZE ERROR RECORD KEY FIELDS.                            *38640000
386300******************************************************************38650000
386400 5650-INITIAL-ERROR-KEY-FIELDS.                                   38660000
386500                                                                  38670000
386600     MOVE SPACES             TO  TR201-RPT-TYP                    38680000
386700                                 TR201-PO-NBR-X                   38690000
386800                                 TR201-TRN-TYP                    38700000
386900                                 TR201-EXTL-REF-NBR               38710000
387000                                 TR201-PO-BKG-DELY-DTE            38720000
387100                                 TR201-PO-BKG-DELY-TM             38730000
387200                                 TR201-ORGN-SHPD-FR-CDE           38740000
387300                                 TR201-DATA-IN-ERROR              38750000
387400                                 TR201-DATA-VALUE                 38760000
387500                                 TR201-ERROR-TYPE                 38770000
387600                                 TR201-ERROR-MSG.                 38780000
387700                                                                  38790000
387800     MOVE ZEROES             TO  TR201-PROCESS-SEQ-NBR.           38800000
387900                                                                  38810000
388000******************************************************************38820000
388100* INITIALIZE HEADER REPORT RECORD FIELDS.                        *38830000
388200******************************************************************38840000
388300 5660-INITIAL-HDR-FIELDS.                                         38850000
388400                                                                  38860000
388500     MOVE SPACES             TO  TR201-REC-TYP-HDR-CDE            38870000
388600                                 TR201-HDR-SEQ-NBR                38880000
388700                                 TR201-HDR-3RD-PARTY-CDE          38890000
388800                                 TR201-HDR-CONSOL-ENTNME          38900000
388900                                 TR201-HDR-CONSOL-TRNS-DTE        38910000
389000                                 TR201-HDR-CONSOL-TRNS-TM         38920000
389100                                 TR201-HDR-CONSOL-FIL-ID          38930000
389200                                 TR201-HDR-LOAD-DTE               38940000
389300                                 TR201-HDR-LOAD-TM                38950000
389400                                 TR201-HDR-FILLER.                38960000
389500                                                                  38970000
389600******************************************************************38980000
389700* FORMAT THE ACTUAL DEPARTURE TIMESTAMP.                         *38990000
389800******************************************************************39000000
389900 5700-FORMAT-DPRTR-TMST.                                          39010000
390000                                                                  39020000
390100     MOVE PV-HOLD-DPRTR-DTE (1:4)  TO  PV-FORMAT-TMST-DTE-CY.     39030000
390200     MOVE PV-HOLD-DPRTR-DTE (5:2)  TO  PV-FORMAT-TMST-DTE-MM.     39040000
390300     MOVE PV-HOLD-DPRTR-DTE (7:2)  TO  PV-FORMAT-TMST-DTE-DD.     39050000
390400                                                                  39060000
390500     IF PV-HOLD-DPRTR-TM EQUAL SPACES                             39070000
390600         MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH                39080000
390700                              PV-FORMAT-TMST-TM-MM                39090000
390800         PERFORM 6500-CALENDAR-ROUTINE-SETUP                      39100000
390900     ELSE                                                         39101000
391000         IF PV-HOLD-DPRTR-TM (1:1) = SPACES OR                    39102000
391010            PV-HOLD-DPRTR-TM (2:1) = SPACES OR                    39103000
391020            PV-HOLD-DPRTR-TM (3:1) = SPACES OR                    39104000
391030            PV-HOLD-DPRTR-TM (4:1) = SPACES                       39105000
391040             SET PS-WARNING-TIME TO TRUE                          39105100
391050             MOVE ZEROS TO PV-FORMAT-TMST-TM-HH                   39106000
391060                           PV-FORMAT-TMST-TM-MM                   39107000
391070             PERFORM 6500-CALENDAR-ROUTINE-SETUP                  39108000
391080         ELSE                                                     39110000
391090             IF ((PV-HOLD-DPRTR-TM (1:2) > '0' AND                39120000
391100                  PV-HOLD-DPRTR-TM (1:2) < '24')     AND          39130000
391200                 (PV-HOLD-DPRTR-TM (3:2) > '0' AND                39131000
391300                  PV-HOLD-DPRTR-TM (3:2) < '60'))                 39132000
391400                   MOVE PV-HOLD-DPRTR-TM (1:2)   TO               39170000
391500                        PV-FORMAT-TMST-TM-HH                      39180000
391600                   MOVE PV-HOLD-DPRTR-TM (3:2)   TO               39190000
391700                        PV-FORMAT-TMST-TM-MM                      39200000
391800                   PERFORM 6500-CALENDAR-ROUTINE-SETUP            39210000
391900             ELSE                                                 39220000
392000                 SET PS-WARNING-TIME TO TRUE                      39230000
392100                 MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH        39240000
392200                                      PV-FORMAT-TMST-TM-MM        39250000
392300                 PERFORM 6500-CALENDAR-ROUTINE-SETUP              39260000
392400             END-IF                                               39270000
392500         END-IF                                                   39271000
392600     END-IF.                                                      39280000
392700                                                                  39290000
392800******************************************************************39300000
392900* FORMAT THE ESTIMATED ARRIVAL TIMESTAMP.                        *39310000
393000******************************************************************39320000
393100 5705-FORMAT-POE-DELY-TMST.                                       39330000
393200                                                                  39340000
393300     MOVE PV-HOLD-POE-DELY-DTE (1:4) TO PV-FORMAT-TMST-DTE-CY.    39350000
393400     MOVE PV-HOLD-POE-DELY-DTE (5:2) TO PV-FORMAT-TMST-DTE-MM.    39360000
393500     MOVE PV-HOLD-POE-DELY-DTE (7:2) TO PV-FORMAT-TMST-DTE-DD.    39370000
393600                                                                  39380000
393700     IF PV-HOLD-POE-DELY-TM EQUAL SPACES                          39421000
393800         MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH                39422000
393900                              PV-FORMAT-TMST-TM-MM                39423000
394000         PERFORM 6500-CALENDAR-ROUTINE-SETUP                      39424000
394100     ELSE                                                         39425000
394200         IF PV-HOLD-POE-DELY-TM (1:1) = SPACES OR                 39426000
394210            PV-HOLD-POE-DELY-TM (2:1) = SPACES OR                 39427000
394220            PV-HOLD-POE-DELY-TM (3:1) = SPACES OR                 39428000
394230            PV-HOLD-POE-DELY-TM (4:1) = SPACES                    39429000
394240             SET PS-WARNING-TIME TO TRUE                          39429100
394250             MOVE ZEROS TO PV-FORMAT-TMST-TM-HH                   39429200
394260                           PV-FORMAT-TMST-TM-MM                   39429300
394270             PERFORM 6500-CALENDAR-ROUTINE-SETUP                  39429400
394280         ELSE                                                     39429500
394290             IF ((PV-HOLD-POE-DELY-TM (1:2) > '0' AND             39429600
394291                  PV-HOLD-POE-DELY-TM (1:2) < '24')     AND       39429700
394292                 (PV-HOLD-POE-DELY-TM (3:2) > '0' AND             39429800
394293                  PV-HOLD-POE-DELY-TM (3:2) < '60'))              39429900
394294                   MOVE PV-HOLD-POE-DELY-TM (1:2)   TO            39430000
394295                        PV-FORMAT-TMST-TM-HH                      39430100
394296                   MOVE PV-HOLD-POE-DELY-TM (3:2)   TO            39430200
394297                        PV-FORMAT-TMST-TM-MM                      39430300
394298                   PERFORM 6500-CALENDAR-ROUTINE-SETUP            39430400
394299             ELSE                                                 39430500
394300                 SET PS-WARNING-TIME TO TRUE                      39430600
394301                 MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH        39430700
394302                                      PV-FORMAT-TMST-TM-MM        39430800
394303                 PERFORM 6500-CALENDAR-ROUTINE-SETUP              39430900
394304             END-IF                                               39431000
394305         END-IF                                                   39431100
394306     END-IF.                                                      39431200
394307                                                                  39610000
394308******************************************************************39620000
394309* FORMAT THE PO BOOKING DELIVERY TIMESTAMP.                      *39630000
394310******************************************************************39640000
394320 5715-FORMAT-BKG-DELY-TMST.                                       39650000
394330                                                                  39660000
394340     MOVE PV-BKG-DELY-DTE  (1:4)  TO                              39670000
394350                 PV-FORMAT-BKDT-DTE-CY.                           39680000
394360     MOVE PV-BKG-DELY-DTE  (5:2)  TO                              39690000
394370                 PV-FORMAT-BKDT-DTE-MM.                           39700000
394380     MOVE PV-BKG-DELY-DTE  (7:2)  TO                              39710000
394390                 PV-FORMAT-BKDT-DTE-DD.                           39720000
394400                                                                  39730000
394500     IF PV-BKG-DELY-TM EQUAL SPACES                               39771000
394600         MOVE ZEROS TO        PV-FORMAT-BKDT-TM-HH                39772000
394700                              PV-FORMAT-BKDT-TM-MM                39773000
394800         PERFORM 6505-CALENDAR-ROUTINE-SETUP                      39774000
394900     ELSE                                                         39775000
395000         IF PV-BKG-DELY-TM (1:1) = SPACES OR                      39776000
395100            PV-BKG-DELY-TM (2:1) = SPACES OR                      39777000
395200            PV-BKG-DELY-TM (3:1) = SPACES OR                      39778000
395300            PV-BKG-DELY-TM (4:1) = SPACES                         39779000
395400             SET PS-WARNING-TIME TO TRUE                          39779100
395500             MOVE ZEROS TO PV-FORMAT-BKDT-TM-HH                   39779200
395600                           PV-FORMAT-BKDT-TM-MM                   39779300
395700             PERFORM 6505-CALENDAR-ROUTINE-SETUP                  39779400
395800         ELSE                                                     39779500
395900             IF ((PV-BKG-DELY-TM (1:2) > '0' AND                  39779600
396000                  PV-BKG-DELY-TM (1:2) < '24')     AND            39779700
396100                 (PV-BKG-DELY-TM (3:2) > '0' AND                  39779800
396200                  PV-BKG-DELY-TM (3:2) < '60'))                   39779900
396300                   MOVE PV-BKG-DELY-TM (1:2)   TO                 39780000
396400                        PV-FORMAT-BKDT-TM-HH                      39780100
396500                   MOVE PV-BKG-DELY-TM (3:2)   TO                 39780200
396600                        PV-FORMAT-BKDT-TM-MM                      39780300
396700                   PERFORM 6505-CALENDAR-ROUTINE-SETUP            39780400
396800             ELSE                                                 39780500
396900                 SET PS-WARNING-TIME TO TRUE                      39780600
397000                 MOVE ZEROS TO        PV-FORMAT-BKDT-TM-HH        39780700
397100                                      PV-FORMAT-BKDT-TM-MM        39780800
397200                 PERFORM 6505-CALENDAR-ROUTINE-SETUP              39780900
397300             END-IF                                               39781000
397400         END-IF                                                   39781100
397500     END-IF.                                                      39781200
397600                                                                  39960000
397700******************************************************************39970000
397800* REFORMAT CURRENT TIMESTAMP.                                    *39980000
397900******************************************************************39990000
398000 5730-REFORMAT-CURRENT-TMST.                                      40000000
398100                                                                  40010000
398200     MOVE PV-CURRENT-TMST (1:4) TO                                40020000
398300                      PV-REFORMAT-TMST-DTE-CY.                    40030000
398400     MOVE PV-CURRENT-TMST (6:2) TO                                40040000
398500                      PV-REFORMAT-TMST-DTE-MM.                    40050000
398600     MOVE PV-CURRENT-TMST (9:2) TO                                40060000
398700                      PV-REFORMAT-TMST-DTE-DD.                    40070000
398800     MOVE PV-CURRENT-TMST (12:2) TO                               40080000
398900                      PV-REFORMAT-TMST-TM-HH.                     40090000
399000     MOVE PV-CURRENT-TMST (15:2) TO                               40100000
399100                      PV-REFORMAT-TMST-TM-MM.                     40110000
399200                                                                  40120000
399300******************************************************************40130000
399400* READ A RECORD FROM THE ORIGIN BOOKING FILE.                    *40140000
399500******************************************************************40150000
399600 6000-READ-BOOKING-FILE.                                          40160000
399700                                                                  40170000
399800     READ TR014-BOOKING-FILE                                      40180000
399900         INTO TR014-REC-TYP-EDD                                   40190000
400000         AT END                                                   40200000
400100           SET PS-END-OF-BOOKINGS TO TRUE.                        40210000
400200                                                                  40220000
400300     IF PS-END-OF-BOOKINGS                                        40230000
400400         CONTINUE                                                 40240000
400500     ELSE                                                         40250000
400600         MOVE TR014-BOOKING-RECORD (1:3) TO PV-EDI-RECORDS        40260000
400700         IF EDI-RECORD                                            40270000
400800             SET PS-EDI-RECORD TO TRUE                            40280000
400900             PERFORM 6030-PROCESS-EDI-RECORD                      40290000
401000         ELSE                                                     40300000
401100             SET PS-GOOD-RECORD TO TRUE                           40310000
401200             ADD +1 TO PV-PROCESS-SEQ-NBR                         40320000
401300             IF (TR014-EDD-PO-NBR-X          NOT EQUAL            40330000
401400                 PV-HOLD-PO-NBR-X)                      OR        40340000
401500                (TR014-EDD-EXTL-REF-NBR      NOT EQUAL            40350000
401600                 PV-HOLD-EXTL-REF-NBR)                  OR        40360000
401700                (TR014-EDD-PO-BKG-DELY-DTE   NOT EQUAL            40370000
401800                 PV-HOLD-PO-BKG-DELY-DTE)               OR        40380000
401900                (TR014-EDD-ORGN-SHPD-FR-CDE  NOT EQUAL            40390000
402000                 PV-HOLD-ORGN-SHPD-FR-CDE)              OR        40400000
402100                (TR014-EDD-TRN-TYP           NOT EQUAL            40410000
402200                 PV-HOLD-LAST-TRN-TYP)                            40420000
402300                PERFORM 4900-RESET-WRITE-SWITCHES                 40430000
402400             END-IF                                               40440000
402500         END-IF                                                   40450000
402600     END-IF.                                                      40460000
402700                                                                  40470000
402800     IF (TR014-EDD-REC-TYP-CDE = PC-EDD  AND                      40480000
402900         TR014-EDD-TRN-TYP NOT = PC-D)         OR                 40490000
403000        (TR014-EDD-REC-TYP-CDE = PC-EDL  AND                      40500000
403100         TR014-EDD-TRN-TYP     = PC-D)                            40510000
403200         SET PS-NEW-GROUP TO TRUE                                 40520000
403300     END-IF.                                                      40530000
403400                                                                  40540000
403500     IF PS-END-OF-BOOKINGS-NO                                     40550000
403600         ADD +1 TO PA-BKG-INPUT-COUNT                             40560000
403700         MOVE TR014-REC-TYP-EDD (1:3) TO PV-HOLD-LAST-REC-TYP     40570000
403800     END-IF.                                                      40580000
403900                                                                  40590000
404000***************************************************************** 40600000
404100* CHECK EDI RECORDS FOR AN ISA RECORD TO DETERMINE THE          * 40610000
404200* CONSOLIDATOR NAME.                                            * 40620000
404300***************************************************************** 40630000
404400 6030-PROCESS-EDI-RECORD.                                         40640000
404500                                                                  40650000
404600     IF TR014-BOOKING-RECORD (1:3) EQUAL PC-ISA                   40660000
404700         PERFORM 6040-CHECK-IEA-RECORD                            40670000
404800         ADD +1 TO PV-PROCESS-SEQ-NBR                             40680000
404900         MOVE TR014-BOOKING-RECORD TO PV-HOLD-EDI-RECORD          40690000
405000         MOVE PV-EDI-VEND-ID-QUAL     TO PV-VEND-ID-QUAL          40700000
405100         MOVE PV-EDI-VEND-ID          TO PV-VEND-ID               40710000
405200         PERFORM 6035-PROCESS-ISA-RECORD                          40720000
405300     END-IF.                                                      40730000
405400                                                                  40740000
405500***************************************************************** 40750000
405600* PROCESS THE ISA RECORD TO OBTAIN HEADER RECORD FIELDS.        * 40760000
405700***************************************************************** 40770000
405800 6035-PROCESS-ISA-RECORD.                                         40780000
405900                                                                  40790000
406000     PERFORM 5660-INITIAL-HDR-FIELDS.                             40800000
406100     MOVE PC-HEADER1           TO PV-HOLD-TR201-ERROR-TYPE.       40810000
406200     MOVE PC-HDR               TO TR201-REC-TYP-HDR-CDE.          40820000
406300     MOVE PC-01                TO TR201-HDR-SEQ-NBR.              40830000
406400     MOVE PV-INPUT-ENT-ID      TO TR201-DAT-SRC-ENT-ID.           40831000
406500     MOVE PV-PROCESS-SEQ-NBR   TO TR201-PROCESS-SEQ-NBR.          40840000
406600                                                                  40850000
406700     MOVE SPACES               TO PV-HOLD-TR201-DATA-IN-ERROR     40860000
406800                                  PV-HOLD-TR201-PO-NBR-X          40870000
406900                                  PV-HOLD-TR201-DATA-VALUE        40880000
407000                                  PV-HOLD-TR201-TRN-TYP           40890000
407100                                  PV-HOLD-TR201-EXTL-REF-NBR      40900000
407200                                  PV-HOLD-TR201-ORGN-SHPD-FR-CDE  40910000
407300                                  PV-HOLD-TR201-ERROR-MSG         40920000
407400                                  PV-HOLD-TR201-PO-BKG-DELY-DTE   40930000
407500                                  PV-HOLD-TR201-PO-BKG-DELY-TM.   40940000
407600                                                                  40950000
407700     PERFORM 7292-SELECT-TENTNME.                                 40960000
407800     IF PS-VALID-ENTNME                                           40970000
407900         MOVE ENTNME-ENT-NAME-DESC TO TR201-HDR-CONSOL-ENTNME     40980000
408000     ELSE                                                         41000000
408100         MOVE 'UNKNOWN ENT ID - EI USED'                          41010000
408200                                   TO TR201-HDR-CONSOL-ENTNME     41011000
408300         MOVE '10594'              TO TR201-DAT-SRC-ENT-ID        41012100
408400     END-IF.                                                      41013000
408500                                                                  41014000
408600     MOVE PV-EDI-CONSOL-TRNS-DTE   TO PV-HDR-CONSOL-TRNS-DTE-REST.41015000
408700     IF PV-EDI-CONSOL-TRNS-DTE (1:2) EQUAL PC-98 OR PC-99         41016000
408800         MOVE PC-19 TO PV-HDR-CONSOL-TRNS-DTE-CC                  41017000
408900     ELSE                                                         41018000
409000         MOVE PC-20 TO PV-HDR-CONSOL-TRNS-DTE-CC                  41019000
409100     END-IF.                                                      41020000
409200     MOVE PV-HDR-CONSOL-TRNS-DTE   TO TR201-HDR-CONSOL-TRNS-DTE.  41030000
409300                                                                  41040000
409400     MOVE PV-EDI-CONSOL-TRNS-TM    TO TR201-HDR-CONSOL-TRNS-TM.   41050000
409500     MOVE PV-EDI-CONSOL-FIL-ID     TO TR201-HDR-CONSOL-FIL-ID.    41060000
409600                                                                  41070000
409700     PERFORM 7100-SET-CURRENT-TMST.                               41080000
409800     PERFORM 5730-REFORMAT-CURRENT-TMST.                          41090000
409900     MOVE PV-REFORMAT-TMST-DTE     TO TR201-HDR-LOAD-DTE.         41100000
410000     MOVE PV-REFORMAT-TMST-TM      TO TR201-HDR-LOAD-TM.          41110000
410100     PERFORM 6200-WRITE-LOAD-REPORT.                              41120000
410200                                                                  41130000
410300     MOVE PC-HEADER2               TO PV-HOLD-TR201-ERROR-TYPE.   41140000
410400     MOVE PC-D                     TO TR201-RPT-TYP.              41150000
410500     MOVE PV-PROCESS-SEQ-NBR       TO TR201-PROCESS-SEQ-NBR.      41160000
410600     PERFORM 6210-WRITE-LOAD-REPORT-2.                            41170000
410700     ADD +1 TO PA-TOTAL-DETAIL-COUNT.                             41180000
410800                                                                  41190000
410900     PERFORM 5400-INITIAL-EDD-FIELDS-UPD.                         41200000
411000     MOVE TR014-REC-TYP-EDD        TO TR024-REC-TYP-EDD.          41210000
411100     MOVE PV-PROCESS-SEQ-NBR       TO TR024-EDD-PROCESS-SEQ-NBR.  41220000
411200     PERFORM 6400-WRITE-UPDATE-RECORD.                            41230000
411300                                                                  41240000
411400***************************************************************** 41250000
411500* CHECK TO SEE IF PREVIOUS RECORD WAS AN IEA RECORD.            * 41260000
411600***************************************************************** 41270000
411700 6040-CHECK-IEA-RECORD.                                           41280000
411800                                                                  41290000
411900     IF PV-HOLD-LAST-REC-TYP EQUAL PC-IEA                         41300000
412000         CONTINUE                                                 41310000
412100     ELSE                                                         41320000
412200         PERFORM 5650-INITIAL-ERROR-KEY-FIELDS                    41330000
412300         MOVE PC-EDI         TO PV-HOLD-TR201-ERROR-TYPE          41340000
412400         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  41350000
412500                             TO PV-HOLD-TR201-ERROR-MSG           41360000
412600         MOVE SPACES         TO TR201-REC-TYP-EDD                 41370000
412700                                PV-HOLD-TR201-DATA-IN-ERROR       41380000
412800                                PV-HOLD-TR201-PO-NBR-X            41390000
412900                                PV-HOLD-TR201-DATA-VALUE          41400000
413000                                PV-HOLD-TR201-TRN-TYP             41410000
413100                                PV-HOLD-TR201-EXTL-REF-NBR        41420000
413200                                PV-HOLD-TR201-PO-BKG-DELY-DTE     41430000
413300                                PV-HOLD-TR201-PO-BKG-DELY-TM      41440000
413400                                PV-HOLD-TR201-ORGN-SHPD-FR-CDE    41450000
413500         ADD +1 TO PV-PROCESS-SEQ-NBR                             41460000
413600         MOVE PV-PROCESS-SEQ-NBR TO TR201-PROCESS-SEQ-NBR         41470000
413700         PERFORM 6200-WRITE-LOAD-REPORT                           41480000
413800     END-IF.                                                      41490000
413900                                                                  41500000
414000***************************************************************** 41510000
414100* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 41520000
414200***************************************************************** 41530000
414300                                                                  41540000
414400 6200-WRITE-LOAD-REPORT.                                          41550000
414500                                                                  41560000
414600     MOVE PC-E TO TR201-RPT-TYP                                   41570000
414700     PERFORM 6210-WRITE-LOAD-REPORT-2.                            41580000
414800     ADD +1 TO PA-TOTAL-ERROR-COUNT.                              41590000
414900                                                                  41600000
415000***************************************************************** 41610000
415100* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 41620000
415200***************************************************************** 41630000
415300 6210-WRITE-LOAD-REPORT-2.                                        41640000
415400                                                                  41650000
415500     MOVE PV-HOLD-TR201-TRN-TYP       TO TR201-TRN-TYP.           41660000
415600                                                                  41670000
415700     IF PV-HOLD-TR201-PO-NBR NUMERIC                              41680000
415800         MOVE PV-HOLD-TR201-PO-NBR        TO TR201-PO-NBR         41690000
415900     ELSE                                                         41700000
416000         MOVE PV-HOLD-TR201-PO-NBR-X      TO TR201-PO-NBR-X       41710000
416100     END-IF.                                                      41720000
416200                                                                  41730000
416300     MOVE PV-HOLD-TR201-EXTL-REF-NBR  TO TR201-EXTL-REF-NBR.      41740000
416400     MOVE PV-HOLD-TR201-PO-BKG-DELY-DTE TO                        41750000
416500                                  TR201-PO-BKG-DELY-DTE.          41760000
416600     MOVE PV-HOLD-TR201-PO-BKG-DELY-TM  TO                        41770000
416700                                  TR201-PO-BKG-DELY-TM.           41780000
416800     MOVE PV-HOLD-TR201-ORGN-SHPD-FR-CDE TO                       41790000
416900                                  TR201-ORGN-SHPD-FR-CDE.         41800000
417000     MOVE PV-HOLD-TR201-DATA-IN-ERROR TO TR201-DATA-IN-ERROR.     41810000
417100     MOVE PV-HOLD-TR201-DATA-VALUE    TO TR201-DATA-VALUE.        41820000
417200     MOVE PV-HOLD-TR201-ERROR-TYPE    TO TR201-ERROR-TYPE.        41830000
417300     MOVE PV-HOLD-TR201-ERROR-MSG     TO TR201-ERROR-MSG.         41840000
417400                                                                  41840100
417500     IF TR201-REC-TYP-HDR-CDE = PC-HDR                            41841000
417600       MOVE PV-INPUT-ENT-ID             TO TR201-DAT-SRC-ENT-ID   41850100
417700     END-IF.                                                      41850200
417800                                                                  41860000
417900     WRITE TR201-BOOKING-ERROR-RECORD FROM                        41870000
418000           TR201-RECORD.                                          41880000
418100                                                                  41890000
418200***************************************************************** 41900000
418300* SETUP THE EDITED UPDATE RECORD PRIOR TO WRITING TO THE UPDATE * 41910000
418400* FILE THAT WILL BE PASSED TO PROGRAM TRKUP205.                 * 41920000
418500***************************************************************** 41930000
418600 6400-WRITE-UPDATE-RECORD.                                        41940000
418700                                                                  41950000
418800     WRITE TR024-UPDATE-BOOKING-RECORD FROM                       41960000
418900           TR024-REC-TYP-EDD.                                     41970000
419000                                                                  41980000
419100     ADD +1 TO PA-TOTAL-UPDATE-COUNT.                             41990000
419200                                                                  42000000
419300***************************************************************** 42010000
419400* SETUP FIELDS FOR CALENDAR ROUTINE TO CHECK TIMESTAMPS.        * 42020000
419500***************************************************************** 42030000
419600 6500-CALENDAR-ROUTINE-SETUP.                                     42040000
419700                                                                  42050000
419800     INITIALIZE  DPG51 DPG52 DPG53                                42060000
419900                 DPG54 DPG55 DPG56.                               42070000
420000                                                                  42080000
420100     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            42090000
420200     MOVE PV-FORMAT-TMST-DTE (1:10) TO DPG52-LK-DATE-INPUT.       42100000
420300     MOVE PC-A0                TO DPG51-CALENDAR-TYPE.            42110000
420400     PERFORM 6510-CALENDAR-ROUTINE.                               42120000
420500                                                                  42130000
420600***************************************************************** 42140000
420700* SETUP FIELDS FOR CALENDAR ROUTINE TO CHECK TIMESTAMPS.        * 42150000
420800***************************************************************** 42160000
420900 6505-CALENDAR-ROUTINE-SETUP.                                     42170000
421000                                                                  42180000
421100     INITIALIZE  DPG51 DPG52 DPG53                                42190000
421200                 DPG54 DPG55 DPG56.                               42200000
421300                                                                  42210000
421400     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            42220000
421500     MOVE PV-FORMAT-BKDT (1:10) TO DPG52-LK-DATE-INPUT.           42230000
421600     MOVE PC-A0                TO DPG51-CALENDAR-TYPE.            42240000
421700     PERFORM 6510-CALENDAR-ROUTINE.                               42250000
421800                                                                  42260000
421900***************************************************************** 42270000
422000* CALENDAR ROUTINE CALL TO CHECK TIMESTAMPS.                    * 42280000
422100***************************************************************** 42290000
422200 6510-CALENDAR-ROUTINE.                                           42300000
422300                                                                  42310000
422400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          42320000
422500                                             DPG53 DPG54          42330000
422600                                             DPG55 DPG56.         42340000
422700                                                                  42350000
422800     EVALUATE TRUE                                                42360000
422900         WHEN DPG54-SEVERE-ERROR                                  42370000
423000         WHEN DPG54-WARNING-ERROR                                 42380000
423100             SET PS-WARNING-DATE TO TRUE                          42390000
423200     END-EVALUATE.                                                42400000
423300                                                                  42410000
423400******************************************************************42420000
423500* SET THE CURRENT TIMESTAMP.                                     *42430000
423600******************************************************************42440000
423700 7100-SET-CURRENT-TMST.                                           42450000
423800                                                                  42460000
423900          EXEC SQL                                                42470000
424000              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            42480000
424100          END-EXEC                                                42490000
424200                                                                  42500000
424300         EVALUATE TRUE                                            42510000
424400             WHEN SQLCODE = ZERO                                  42520000
424500                 CONTINUE                                         42530000
424600                                                                  42540000
424700             WHEN SQLWARN0 NOT EQUAL SPACE                        42550000
424800             WHEN SQLCODE NOT EQUAL ZERO                          42560000
424900                 DISPLAY '**************************************' 42570000
425000                 DISPLAY '** ABEND                            **' 42580000
425100                 DISPLAY '** PROGRAM = TRKUT200               **' 42590000
425200                 DISPLAY '** PARAGRAPH = 7100-SET-CURRENT-TMST**' 42600000
425300                 DISPLAY '** SET CURRENT TIMESTAMP            **' 42610000
425400                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   42620000
425500                 DISPLAY '**************************************' 42630000
425600                 PERFORM 9100-SQL-ABEND                           42640000
425700         END-EVALUATE.                                            42650000
425800                                                                  42660000
425900******************************************************************42670000
426000* SELECT THE CONSOLIDATOR ENTERPRISE NAME FOR HEADER RECORD.     *42680000
426100******************************************************************42690000
426200 7292-SELECT-TENTNME.                                             42700000
426300                                                                  42710000
426400     MOVE PV-INPUT-ENT-ID-9      TO PV-ENT-ID-SIGNED.             42712000
426500                                                                  42713000
426600     PERFORM                                                      42720000
426700         WITH TEST AFTER                                          42730000
426800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     42740000
426900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            42750000
427000                 SQLCODE = ZERO                     OR            42760000
427100                 SQLCODE = +100                                   42770000
427200                                                                  42780000
427300         EXEC SQL                                                 42790000
427400             SELECT DISTINCT                                      42800000
427500                    ENT_NAME_DESC                                 42810000
427600              INTO :ENTNME-ENT-NAME-DESC                          42830000
427700              FROM  TENTNME                                       42850000
427800              WHERE ENT_ID    = :PV-ENT-ID-SIGNED                 42870000
427900              AND   TYPE_CDE  = '01'                              42880000
428000         END-EXEC                                                 42920000
428100                                                                  42930000
428200         EVALUATE TRUE                                            42940000
428300             WHEN SQLCODE = ZERO                                  42950000
428400             WHEN SQLCODE = -811                                  42960000
428500                 SET PS-VALID-ENTNME   TO TRUE                    42970000
428600                                                                  42980000
428700             WHEN SQLCODE = +100                                  42990000
428800                 SET PS-INVALID-ENTNME TO TRUE                    43000000
428900                                                                  43010000
429000             WHEN SQLWARN0 NOT EQUAL SPACE                        43020000
429100             WHEN SQLCODE NOT EQUAL ZERO                          43030000
429200                 DISPLAY '**************************************' 43040000
429300                 DISPLAY '** ABEND                            **' 43050000
429400                 DISPLAY '** PROGRAM = TRKUT200               **' 43060000
429500                 DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME  **' 43070000
429600                 DISPLAY '** SELECT CONSOLIDATOR NAME         **' 43080000
429700                 DISPLAY '** FROM ISA RECORD.                 **' 43090000
429800                 DISPLAY '** VEND ID      = ' PV-VEND-ID          43100000
429900                 DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL     43110000
430000                 DISPLAY '**************************************' 43120000
430100                 PERFORM 9100-SQL-ABEND                           43130000
430200         END-EVALUATE                                             43140000
430300     END-PERFORM.                                                 43150000
430400                                                                  43160000
430500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43170000
430600         (SQLCODE NOT = ZERO    AND                               43180000
430700             SQLCODE NOT = +100 AND                               43190000
430800             SQLCODE NOT = -811)                                  43200000
430900         DISPLAY '****************************************'       43210000
431000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       43220000
431100         DISPLAY '** SELECT FROM TENTNME                **'       43230000
431200         DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME    **'       43240000
431300         DISPLAY '** VEND ID      = ' PV-VEND-ID                  43250000
431400         DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL             43260000
431500         DISPLAY '****************************************'       43270000
431600         PERFORM 9100-SQL-ABEND                                   43280000
431700     END-IF.                                                      43290000
431800                                                                  43300000
431900 EJECT                                                            43310000
432000                                                                  43320000
432100******************************************************************43330000
432200* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *43340000
432300* JOB SUMMARY INFORMATION.                                       *43350000
432400* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *43360000
432500* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *43370000
432600* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TO LONG, THE EDI   *43380000
432700* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*43390000
432800* NO RETURN CODE OR MESSAGE IS SENT.                             *43400000
432900******************************************************************43410000
433000 8000-EOJ-ROUTINE.                                                43420000
433100                                                                  43430000
433200     IF EDI-IEA-RECORD OR                                         43440000
433300        PV-HOLD-TR201-ERROR-TYPE = PC-EMPTY                       43450000
433400         CONTINUE                                                 43460000
433500     ELSE                                                         43470000
433600         PERFORM 5650-INITIAL-ERROR-KEY-FIELDS                    43480000
433700         MOVE PC-EDI         TO PV-HOLD-TR201-ERROR-TYPE          43490000
433800         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  43500000
433900                             TO PV-HOLD-TR201-ERROR-MSG           43510000
434000         MOVE SPACES         TO TR201-REC-TYP-EDD                 43520000
434100                                PV-HOLD-TR201-DATA-IN-ERROR       43530000
434200                                PV-HOLD-TR201-PO-NBR-X            43540000
434300                                PV-HOLD-TR201-DATA-VALUE          43550000
434400                                PV-HOLD-TR201-TRN-TYP             43560000
434500                                PV-HOLD-TR201-EXTL-REF-NBR        43570000
434600                                PV-HOLD-TR201-PO-BKG-DELY-DTE     43580000
434700                                PV-HOLD-TR201-PO-BKG-DELY-TM      43590000
434800                                PV-HOLD-TR201-ORGN-SHPD-FR-CDE    43600000
434900         ADD +1 TO PV-PROCESS-SEQ-NBR                             43610000
435000         MOVE PV-PROCESS-SEQ-NBR TO TR201-PROCESS-SEQ-NBR         43620000
435100         PERFORM 6200-WRITE-LOAD-REPORT                           43630000
435200     END-IF.                                                      43640000
435300                                                                  43650000
435400     CLOSE TR014-BOOKING-FILE                                     43660000
435500           TR024-UPDATE-BOOKING-FILE                              43670000
435600           TR201-BOOKING-ERROR-FILE.                              43680000
435700                                                                  43690000
435800     DISPLAY '**********************************'.                43700000
435900     DISPLAY '** TRKUT200 SUMMARY **'.                            43710000
436000     DISPLAY 'BOOKING INPUT COUNT    = ' PA-BKG-INPUT-COUNT.      43720000
436100     DISPLAY 'BKPO RECS ADD    COUNT = ' PA-TOT-BKPO-RECS-ADD.    43730000
436200     DISPLAY 'BKVS RECS ADD    COUNT = ' PA-TOT-BKVS-RECS-ADD.    43740000
436300     DISPLAY 'BKUP RECS ADD    COUNT = ' PA-TOT-BKUP-RECS-ADD.    43750000
436400     DISPLAY 'BKPO RECS CHANGE COUNT = ' PA-TOT-BKPO-RECS-CHANGE. 43760000
436500     DISPLAY 'BKVS RECS CHANGE COUNT = ' PA-TOT-BKVS-RECS-CHANGE. 43770000
436600     DISPLAY 'BKUP RECS CHANGE COUNT = ' PA-TOT-BKUP-RECS-CHANGE. 43780000
436700     DISPLAY 'EDL RECS  DELETE COUNT = ' PA-TOT-EDL-RECS-DELETE.  43790000
436800     DISPLAY 'TOTAL UPDATE COUNT     = ' PA-TOTAL-UPDATE-COUNT.   43800000
436900     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.    43810000
437000     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.   43820000
437100     DISPLAY '**********************************'.                43830000
437200                                                                  43840000
437300 EJECT                                                            43850000
437400                                                                  43860000
437500******************************************************************43870000
437600* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *43880000
437700* ERROR OR WARNING CODE OCCURS.                                  *43890000
437800******************************************************************43900000
437900 9100-SQL-ABEND.                                                  43910000
438000******************************************************************43920000
438100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *43930000
438200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *43940000
438300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *43950000
438400* FORMAT.                                                        *43960000
438500******************************************************************43970000
438600                                                                  43980000
438700     COPY DPPD004.                                                43990000
438800                                                                  44000000
438900     DISPLAY 'PO NBR ABEND     '  TR014-EDD-PO-NBR.               44010000
439000     DISPLAY 'EXTRL REF ABEND  '  TR014-EDD-EXTL-REF-NBR.         44020000
439100     DISPLAY 'BKG DELY DTE ABND'  TR014-EDD-PO-BKG-DELY-DTE.      44030000
439200     DISPLAY 'HOLD PO   ABEND  '  PV-HOLD-PO-NBR.                 44040000
439300     DISPLAY 'HOLD X REF ABEND '  PV-HOLD-EXTL-REF-NBR.           44050000
439400     DISPLAY 'HOLD BKG DTE ABND'  PV-HOLD-PO-BKG-DELY-DTE.        44060000
439500     DISPLAY 'HOLD ORG SHP FR  '  PV-HOLD-ORGN-SHPD-FR-CDE.       44070000
439600     MOVE +4013 TO ABEND-CODE.                                    44080000
439700     CALL 'ILBOABN0' USING ABEND-CODE.                            44090000
