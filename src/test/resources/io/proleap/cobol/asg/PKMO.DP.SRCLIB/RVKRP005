00001 ******************************************************************01/03/96
00002  IDENTIFICATION DIVISION.                                         RVKRP005
00003 ******************************************************************   LV001
00004                                                                   RVKRP005
00005  PROGRAM-ID.             RVKRP005.                                RVKRP005
00006  AUTHOR.                 MICHAEL WALTERS.                         RVKRP005
00007  INSTALLATION.           KOHLS.                                   RVKRP005
00008  DATE-WRITTEN            AUGUST, 1995.                            RVKRP005
00009  DATE-COMPILED.                                                   RVKRP005
00010                                                                   RVKRP005
00011 ******************************************************************RVKRP005
00012 *  THIS PROGRAM WILL SUMMARIZE ALL THE "SHIPPED" DEFECTIVE ITEMS  RVKRP005
00013 *  BY FACILITY AND DEPARTMENT.                                    RVKRP005
00014 ******************************************************************RVKRP005
00015                                                                   RVKRP005
00016 ******************************************************************RVKRP005
00017  ENVIRONMENT DIVISION.                                            RVKRP005
00018 ******************************************************************RVKRP005
00019                                                                   RVKRP005
00020  CONFIGURATION SECTION.                                           RVKRP005
00021                                                                   RVKRP005
00022  SOURCE-COMPUTER.        IBM-3090.                                RVKRP005
00023  OBJECT-COMPUTER.        IBM-3090.                                RVKRP005
00024                                                                   RVKRP005
00025  INPUT-OUTPUT SECTION.                                            RVKRP005
00026                                                                   RVKRP005
00027  FILE-CONTROL.                                                    RVKRP005
00028                                                                   RVKRP005
00029      SELECT RTV-REPORT-EXTRACT                                    RVKRP005
00030          ASSIGN TO IN01.                                          RVKRP005
00031                                                                   RVKRP005
00032      SELECT DI-DEFECT-ITEM-REPORT-COST                            RVKRP005
00033          ASSIGN TO RPT01.                                         RVKRP005
00034                                                                   RVKRP005
00032      SELECT DI-DEFECT-ITEM-REPORT-RETAIL                          RVKRP005
00033          ASSIGN TO RPT02.                                         RVKRP005
00034                                                                   RVKRP005
00035 ******************************************************************RVKRP005
00036  DATA DIVISION.                                                   RVKRP005
00037 ******************************************************************RVKRP005
00038                                                                   RVKRP005
00039  FILE SECTION.                                                    RVKRP005
00040                                                                   RVKRP005
00041  FD  RTV-REPORT-EXTRACT                                           RVKRP005
00042      RECORDING MODE IS F                                          RVKRP005
00043      LABEL RECORDS ARE STANDARD                                   RVKRP005
00044      BLOCK CONTAINS 0 RECORDS.                                    RVKRP005
00045                                                                   RVKRP005
00046  01  RTV-REPORT-EXTRACT-RECORD       PIC  X(200).                 RVKRP005
00047                                                                   RVKRP005
00048  FD  DI-DEFECT-ITEM-REPORT-COST                                   RVKRP005
00049      RECORDING MODE IS F                                          RVKRP005
00050      LABEL RECORDS ARE STANDARD                                   RVKRP005
00051      BLOCK CONTAINS 0 RECORDS.                                    RVKRP005
00052                                                                   RVKRP005
00053  01  DI-DEFECT-ITEM-LINE-COST        PIC  X(132).                 RVKRP005
00047                                                                   RVKRP005
00048  FD  DI-DEFECT-ITEM-REPORT-RETAIL                                 RVKRP005
00049      RECORDING MODE IS F                                          RVKRP005
00050      LABEL RECORDS ARE STANDARD                                   RVKRP005
00051      BLOCK CONTAINS 0 RECORDS.                                    RVKRP005
00052                                                                   RVKRP005
00053  01  DI-DEFECT-ITEM-LINE-RETAIL      PIC  X(132).                 RVKRP005
00054                                                                   RVKRP005
00055 ******************************************************************RVKRP005
00056  WORKING-STORAGE SECTION.                                         RVKRP005
00057 ******************************************************************RVKRP005
00058                                                                   RVKRP005
00059 *                                                                 RVKRP005
00060 *  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                RVKRP005
00061 *                                                                 RVKRP005
00062      COPY DPWS132O.                                               RVKRP005
00063 *                                                                 RVKRP005
00064 *  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      RVKRP005
00065 *                                                                 RVKRP005
00066      COPY DPWS004.                                                RVKRP005
00067                                                                   RVKRP005
00068 *                                                                 RVKRP005
00069 *  RECORD LAYOUT OF THE RTV EXTRACT FILE.                         RVKRP005
00070 *                                                                 RVKRP005
00071      COPY RVWS010.                                                RVKRP005
00072                                                                   RVKRP005
00073                                                                   RVKRP005
00074  01  ABEND-CODE                          PIC S9(04) VALUE +0      RVKRP005
00075                                                      COMP SYNC.   RVKRP005
00076  01  PH2-PAGE-HEADING-MONTH-COST.                                 RVKRP005
00077      05  FILLER                          PIC  X(38)  VALUE SPACE. RVKRP005
00078      05  FILLER                          PIC  X(48)  VALUE        RVKRP005
00079          'RETURN-TO-VENDOR FACILITY MONTHLY SUMMARY REPORT'.      RVKRP005
00078      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00079          ' (COST)'.                                               RVKRP005
00076  01  PH2-PAGE-HEADING-MONTH-RETAIL.                               RVKRP005
00077      05  FILLER                          PIC  X(37)  VALUE SPACE. RVKRP005
00078      05  FILLER                          PIC  X(48)  VALUE        RVKRP005
00079          'RETURN-TO-VENDOR FACILITY MONTHLY SUMMARY REPORT'.      RVKRP005
00078      05  FILLER                          PIC  X(09)  VALUE        RVKRP005
00079          ' (RETAIL)'.                                             RVKRP005
00081                                                                   RVKRP005
00082  01  PH2-PAGE-HEADING-YTD-COST.                                   RVKRP005
00083      05  FILLER                          PIC  X(36)  VALUE SPACE. RVKRP005
00084      05  FILLER                          PIC  X(53)  VALUE        RVKRP005
00085          'RETURN-TO-VENDOR FACILITY YEAR TO DATE SUMMARY REPORT'. RVKRP005
00078      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00079          ' (COST)'.                                               RVKRP005
00082  01  PH2-PAGE-HEADING-YTD-RETAIL.                                 RVKRP005
00083      05  FILLER                          PIC  X(35)  VALUE SPACE. RVKRP005
00084      05  FILLER                          PIC  X(53)  VALUE        RVKRP005
00085          'RETURN-TO-VENDOR FACILITY YEAR TO DATE SUMMARY REPORT'. RVKRP005
00078      05  FILLER                          PIC  X(09)  VALUE        RVKRP005
00079          ' (RETAIL)'.                                             RVKRP005
00087                                                                   RVKRP005
00076  01  PH2-PAGE-HEADING-WEEKLY-COST.                                RVKRP005
00077      05  FILLER                          PIC  X(38)  VALUE SPACE. RVKRP005
00078      05  FILLER                          PIC  X(48)  VALUE        RVKRP005
00079          'RETURN-TO-VENDOR FACILITY WEEKLY SUMMARY REPORT'.       RVKRP005
00078      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00079          ' (COST)'.                                               RVKRP005
00076  01  PH2-PAGE-HEADING-WEEKLY-RETAIL.                              RVKRP005
00077      05  FILLER                          PIC  X(37)  VALUE SPACE. RVKRP005
00078      05  FILLER                          PIC  X(48)  VALUE        RVKRP005
00079          'RETURN-TO-VENDOR FACILITY WEEKLY SUMMARY REPORT'.       RVKRP005
00078      05  FILLER                          PIC  X(09)  VALUE        RVKRP005
00079          ' (RETAIL)'.                                             RVKRP005
00081                                                                   RVKRP005
00088  01  PH3-PAGE-HEADING-3.                                          RVKRP005
00089      05  FILLER                          PIC  X(44)  VALUE SPACE. RVKRP005
00090      05  FILLER                          PIC  X(12)  VALUE        RVKRP005
00091          'BEGIN DATE: '.                                          RVKRP005
00092      05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. RVKRP005
00093      05  FILLER                          PIC  X(13)  VALUE        RVKRP005
00094          ' - END DATE: '.                                         RVKRP005
00095      05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. RVKRP005
00096      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP005
00097                                                                   RVKRP005
00098  01  PH4-PAGE-HEADING-4.                                          RVKRP005
00099      05  FILLER                          PIC  X(48)  VALUE SPACES.RVKRP005
00100      05  FILLER                          PIC  X(19)  VALUE        RVKRP005
00101          'ITEMS SHIPPED FROM '.                                   RVKRP005
00102      05  PH4-FCLTY-NAME                  PIC  X(25)  VALUE SPACES.RVKRP005
00103      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP005
00104                                                                   RVKRP005
00105  01  DH1-DETAIL-HEADING-1.                                        RVKRP005
00106      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00107      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP005
00108      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00109      05  FILLER                          PIC  X(03)  VALUE        RVKRP005
00110          'DPT'.                                                   RVKRP005
00111      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00112      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP005
00113      05  FILLER                          PIC  X(04)  VALUE SPACE. RVKRP005
00114      05  FILLER                          PIC  X(21)  VALUE        RVKRP005
00115          '   DEBITED & RETURNED'.                                 RVKRP005
00116      05  FILLER                          PIC  X(04)  VALUE SPACE. RVKRP005
00117      05  FILLER                          PIC  X(21)  VALUE        RVKRP005
00118          '  DEBITED & DESTROYED'.                                 RVKRP005
00119      05  FILLER                          PIC  X(04)  VALUE SPACE. RVKRP005
00120      05  FILLER                          PIC  X(21)  VALUE        RVKRP005
00121          '  MARKED OUT OF STOCK'.                                 RVKRP005
00122                                                                   RVKRP005
00123  01  DH2-DETAIL-HEADING-2-COST.                                   RVKRP005
00124      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00125      05  FILLER                          PIC  X(20)  VALUE        RVKRP005
00126          'DMM NAME            '.                                  RVKRP005
00127      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00128      05  FILLER                          PIC  X(03)  VALUE        RVKRP005
00129          'NUM'.                                                   RVKRP005
00130      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00131      05  FILLER                          PIC  X(20)  VALUE        RVKRP005
00132          'DEPT DESCRIPTION    '.                                  RVKRP005
00133      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00134      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00135          '    QTY'.                                               RVKRP005
00136      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00137      05  FILLER                          PIC  X(12)  VALUE        RVKRP005
00138          '       COST '.                                          RVKRP005
00139      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00140      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00141          '    QTY'.                                               RVKRP005
00142      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00143      05  FILLER                          PIC  X(12)  VALUE        RVKRP005
00144          '       COST '.                                          RVKRP005
00145      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00146      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00147          '    QTY'.                                               RVKRP005
00148      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00149      05  FILLER                          PIC  X(12)  VALUE        RVKRP005
00150          '       COST '.                                          RVKRP005
00151                                                                   RVKRP005
00123  01  DH2-DETAIL-HEADING-2-RETAIL.                                 RVKRP005
00124      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00125      05  FILLER                          PIC  X(20)  VALUE        RVKRP005
00126          'DMM NAME            '.                                  RVKRP005
00127      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00128      05  FILLER                          PIC  X(03)  VALUE        RVKRP005
00129          'NUM'.                                                   RVKRP005
00130      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00131      05  FILLER                          PIC  X(20)  VALUE        RVKRP005
00132          'DEPT DESCRIPTION    '.                                  RVKRP005
00133      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00134      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00135          '    QTY'.                                               RVKRP005
00136      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00137      05  FILLER                          PIC  X(12)  VALUE        RVKRP005
00138          '     RETAIL '.                                          RVKRP005
00139      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00140      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00141          '    QTY'.                                               RVKRP005
00142      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00143      05  FILLER                          PIC  X(12)  VALUE        RVKRP005
00144          '     RETAIL '.                                          RVKRP005
00145      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00146      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00147          '    QTY'.                                               RVKRP005
00148      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00149      05  FILLER                          PIC  X(12)  VALUE        RVKRP005
00150          '     RETAIL '.                                          RVKRP005
00151                                                                   RVKRP005
00152  01  DHD-DETAIL-HEADING-DASHES.                                   RVKRP005
00153      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00154      05  FILLER                          PIC  X(20)  VALUE        RVKRP005
00155          '____________________'.                                  RVKRP005
00156      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00157      05  FILLER                          PIC  X(03)  VALUE        RVKRP005
00158          '___'.                                                   RVKRP005
00159      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00160      05  FILLER                          PIC  X(20)  VALUE        RVKRP005
00161          '____________________'.                                  RVKRP005
00162      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00163      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00164          '_______'.                                               RVKRP005
00165      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00166      05  FILLER                          PIC  X(13)  VALUE        RVKRP005
00167          '_____________'.                                         RVKRP005
00168      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00169      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00170          '_______'.                                               RVKRP005
00171      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00172      05  FILLER                          PIC  X(13)  VALUE        RVKRP005
00173          '_____________'.                                         RVKRP005
00174      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00175      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00176          '_______'.                                               RVKRP005
00177      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00178      05  FILLER                          PIC  X(13)  VALUE        RVKRP005
00179          '_____________'.                                         RVKRP005
00180      05  FILLER                          PIC  X(09)  VALUE SPACE. RVKRP005
00181                                                                   RVKRP005
00182  01  DL-DETAIL-LINE.                                              RVKRP005
00183      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00184      05  DL-DMM-NAME                     PIC  X(20).              RVKRP005
00185      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00186      05  DL-DPT-NBR                      PIC  X(03).              RVKRP005
00187      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00188      05  DL-DPT-DESC                     PIC  X(20).              RVKRP005
00189      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00190      05  DL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP005
00191      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00192      05  DL-DR-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.      RVKRP005
00193      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00194      05  DL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP005
00195      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00196      05  DL-DD-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.      RVKRP005
00197      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00198      05  DL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP005
00199      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00200      05  DL-MO-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.      RVKRP005
00201                                                                   RVKRP005
00202  01  TL-TOTAL-LINE-DASHES.                                        RVKRP005
00203      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00204      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP005
00205      05  FILLER                          PIC  X(29)  VALUE SPACES.RVKRP005
00206      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00207      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00208          '_______'.                                               RVKRP005
00209      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00210      05  FILLER                          PIC  X(13)  VALUE        RVKRP005
00211          '_____________'.                                         RVKRP005
00212      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00213      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00214          '_______'.                                               RVKRP005
00215      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00216      05  FILLER                          PIC  X(13)  VALUE        RVKRP005
00217          '_____________'.                                         RVKRP005
00218      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00219      05  FILLER                          PIC  X(07)  VALUE        RVKRP005
00220          '_______'.                                               RVKRP005
00221      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00222      05  FILLER                          PIC  X(13)  VALUE        RVKRP005
00223          '_____________'.                                         RVKRP005
00224      05  FILLER                          PIC  X(09)  VALUE SPACE. RVKRP005
00225                                                                   RVKRP005
00226  01  TL-TOTAL-LINE.                                               RVKRP005
00227      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00228      05  FILLER                          PIC  X(19)  VALUE SPACES.RVKRP005
00229      05  TL-TOTAL-DESCRIPTION            PIC  X(22)  VALUE SPACES.RVKRP005
00230      05  FILLER                          PIC  X(08)  VALUE        RVKRP005
00231          ' TOTAL: '.                                              RVKRP005
00232      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP005
00233      05  TL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP005
00234      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00235      05  TL-DR-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.      RVKRP005
00236      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00237      05  TL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP005
00238      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00239      05  TL-DD-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.      RVKRP005
00240      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP005
00241      05  TL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP005
00242      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP005
00243      05  TL-MO-COST-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.      RVKRP005
00244                                                                   RVKRP005
00245                                                                   RVKRP005
00246  01  BLANK-LINE.                                                  RVKRP005
00247      05  FILLER                          PIC  X(132) VALUE SPACE. RVKRP005
00248                                                                   RVKRP005
00249  01  END-OF-REPORT-LINE.                                          RVKRP005
00250      05  FILLER                          PIC  X(88)  VALUE SPACE. RVKRP005
00251      05  FILLER                          PIC  X(25)  VALUE        RVKRP005
00252          '***** END OF REPORT *****'.                             RVKRP005
00253      05  FILLER                          PIC  X(87)  VALUE SPACE. RVKRP005
00254                                                                   RVKRP005
00255  01  ER-EMPTY-REPORT-LINE.                                        RVKRP005
00256      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP005
00257      05  FILLER                          PIC  X(48)  VALUE        RVKRP005
00258          '*** NO DATA SATISFIES THE SELECTION CRITERIA ***'.      RVKRP005
00259      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP005
00260                                                                   RVKRP005
00261  01  PA-PROGRAM-ACCUMULATORS.                                     RVKRP005
00262      05  PA-DPT-TOTALS.                                           RVKRP005
00263          10 PA-DR-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP005
00264                                                      COMP-3.      RVKRP005
00265          10 PA-DR-DPT-COST               PIC S9(08)V99            RVKRP005
00266                                                      VALUE +0     RVKRP005
00267                                                      COMP-3.      RVKRP005
00265          10 PA-DR-DPT-RETAIL             PIC S9(08)V99            RVKRP005
00266                                                      VALUE +0     RVKRP005
00267                                                      COMP-3.      RVKRP005
00268          10 PA-DD-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP005
00269                                                      COMP-3.      RVKRP005
00270          10 PA-DD-DPT-COST               PIC S9(08)V99            RVKRP005
00271                                                      VALUE +0     RVKRP005
00272                                                      COMP-3.      RVKRP005
00270          10 PA-DD-DPT-RETAIL             PIC S9(08)V99            RVKRP005
00271                                                      VALUE +0     RVKRP005
00272                                                      COMP-3.      RVKRP005
00273          10 PA-MO-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP005
00274                                                      COMP-3.      RVKRP005
00275          10 PA-MO-DPT-COST               PIC S9(08)V99            RVKRP005
00276                                                      VALUE +0     RVKRP005
00277                                                      COMP-3.      RVKRP005
00275          10 PA-MO-DPT-RETAIL             PIC S9(08)V99            RVKRP005
00276                                                      VALUE +0     RVKRP005
00277                                                      COMP-3.      RVKRP005
00278      05  PA-DMM-TOTALS.                                           RVKRP005
00279          10 PA-DR-DMM-QTY                PIC S9(06)  VALUE +0     RVKRP005
00280                                                      COMP-3.      RVKRP005
00281          10 PA-DR-DMM-COST               PIC S9(08)V99            RVKRP005
00282                                                      VALUE +0     RVKRP005
00283                                                      COMP-3.      RVKRP005
00281          10 PA-DR-DMM-RETAIL             PIC S9(08)V99            RVKRP005
00282                                                      VALUE +0     RVKRP005
00283                                                      COMP-3.      RVKRP005
00284          10 PA-DD-DMM-QTY                PIC S9(06)  VALUE +0     RVKRP005
00285                                                      COMP-3.      RVKRP005
00286          10 PA-DD-DMM-COST               PIC S9(08)V99            RVKRP005
00287                                                      VALUE +0     RVKRP005
00288                                                      COMP-3.      RVKRP005
00286          10 PA-DD-DMM-RETAIL             PIC S9(08)V99            RVKRP005
00287                                                      VALUE +0     RVKRP005
00288                                                      COMP-3.      RVKRP005
00289          10 PA-MO-DMM-QTY                PIC S9(06)  VALUE +0     RVKRP005
00290                                                      COMP-3.      RVKRP005
00291          10 PA-MO-DMM-COST               PIC S9(08)V99            RVKRP005
00292                                                      VALUE +0     RVKRP005
00293                                                      COMP-3.      RVKRP005
00291          10 PA-MO-DMM-RETAIL             PIC S9(08)V99            RVKRP005
00292                                                      VALUE +0     RVKRP005
00293                                                      COMP-3.      RVKRP005
00294      05  PA-FCLTY-TOTALS.                                         RVKRP005
00295          10 PA-DR-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP005
00296                                                      COMP-3.      RVKRP005
00297          10 PA-DR-FCLTY-COST             PIC S9(08)V99            RVKRP005
00298                                                      VALUE +0     RVKRP005
00299                                                      COMP-3.      RVKRP005
00297          10 PA-DR-FCLTY-RETAIL           PIC S9(08)V99            RVKRP005
00298                                                      VALUE +0     RVKRP005
00299                                                      COMP-3.      RVKRP005
00300          10 PA-DD-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP005
00301                                                      COMP-3.      RVKRP005
00302          10 PA-DD-FCLTY-COST             PIC S9(08)V99            RVKRP005
00303                                                      VALUE +0     RVKRP005
00304                                                      COMP-3.      RVKRP005
00302          10 PA-DD-FCLTY-RETAIL           PIC S9(08)V99            RVKRP005
00303                                                      VALUE +0     RVKRP005
00304                                                      COMP-3.      RVKRP005
00305          10 PA-MO-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP005
00306                                                      COMP-3.      RVKRP005
00307          10 PA-MO-FCLTY-COST             PIC S9(08)V99            RVKRP005
00308                                                      VALUE +0     RVKRP005
00309                                                      COMP-3.      RVKRP005
00307          10 PA-MO-FCLTY-RETAIL           PIC S9(08)V99            RVKRP005
00308                                                      VALUE +0     RVKRP005
00309                                                      COMP-3.      RVKRP005
00310      05  PA-GRAND-TOTALS.                                         RVKRP005
00311          10 PA-DR-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP005
00312                                                      COMP-3.      RVKRP005
00313          10 PA-DR-GRAND-COST             PIC S9(08)V99            RVKRP005
00314                                                      VALUE +0     RVKRP005
00315                                                      COMP-3.      RVKRP005
00313          10 PA-DR-GRAND-RETAIL           PIC S9(08)V99            RVKRP005
00314                                                      VALUE +0     RVKRP005
00315                                                      COMP-3.      RVKRP005
00316          10 PA-DD-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP005
00317                                                      COMP-3.      RVKRP005
00318          10 PA-DD-GRAND-COST             PIC S9(08)V99            RVKRP005
00319                                                      VALUE +0     RVKRP005
00320                                                      COMP-3.      RVKRP005
00318          10 PA-DD-GRAND-RETAIL           PIC S9(08)V99            RVKRP005
00319                                                      VALUE +0     RVKRP005
00320                                                      COMP-3.      RVKRP005
00321          10 PA-MO-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP005
00322                                                      COMP-3.      RVKRP005
00323          10 PA-MO-GRAND-COST             PIC S9(08)V99            RVKRP005
00324                                                      VALUE +0     RVKRP005
00325                                                      COMP-3.      RVKRP005
00323          10 PA-MO-GRAND-RETAIL           PIC S9(08)V99            RVKRP005
00324                                                      VALUE +0     RVKRP005
00325                                                      COMP-3.      RVKRP005
00326                                                                   RVKRP005
00327  01  PC-CONSTANTS.                                                RVKRP005
00328      05  PC-COMMIT-INTERVAL              PIC  9(02)  VALUE 10.    RVKRP005
00329      05  PC-MAX-REFERRAL-CODES           PIC S9(04)  VALUE +7     RVKRP005
00330                                                      COMP SYNC.   RVKRP005
00331 * 6 LPI -- 14 X 8.5 PAPER (6 * 8.5 = 51)                          RVKRP005
00332      05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +55    RVKRP005
00333                                                      COMP SYNC.   RVKRP005
00334      05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   RVKRP005
00335                                                      COMP SYNC.   RVKRP005
00336      05  PC-ZERO                         PIC  9(01)  VALUE 0.     RVKRP005
00337      05  PC-ONE                          PIC  9(01)  VALUE 1.     RVKRP005
00338      05  PC-TWO                          PIC  9(01)  VALUE 2.     RVKRP005
00339      05  PC-THREE                        PIC  9(01)  VALUE 3.     RVKRP005
00340      05  PC-FOUR                         PIC  9(01)  VALUE 4.     RVKRP005
00341      05  PC-EIGHT                        PIC  9(01)  VALUE 8.     RVKRP005
00342      05  PC-NINE                         PIC  9(01)  VALUE 9.     RVKRP005
00343      05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  RVKRP005
00344      05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        RVKRP005
00345          'RVKRP005'.                                              RVKRP005
00346      05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        RVKRP005
00347          'RVK050  '.                                              RVKRP005
00348      05  PC-SKU-DESC-ZERO                PIC  X(15)  VALUE        RVKRP005
00349          'V E N D O R    '.                                       RVKRP005
00352      05  PC-MBS-SYSTEM-CODE-RV           PIC  X(02)  VALUE 'RV'.  RVKRP005
00353      05  PC-MBS-OP-CO-03                 PIC  X(02)  VALUE '03'.  RVKRP005
00354      05  PC-PGM-DPKUT039                 PIC  X(08)               RVKRP005
00355                                          VALUE 'DPKUT039'.        RVKRP005
00356                                                                   RVKRP005
00357  01  PS-PROGRAM-SWITCHES.                                         RVKRP005
00358      05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.   RVKRP005
00359          88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   RVKRP005
00360          88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   RVKRP005
00361                                                                   RVKRP005
00362      05  PS-NEW-LINE-IND                 PIC  X(01)  VALUE 'N'.   RVKRP005
00363          88  PS-NEW-LINE                             VALUE 'Y'.   RVKRP005
00364          88  PS-NO-NEW-LINE                          VALUE 'N'.   RVKRP005
00365                                                                   RVKRP005
00366      05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   RVKRP005
00367          88  PS-NO-DATA                              VALUE 'N'.   RVKRP005
00368          88  PS-DATA                                 VALUE 'Y'.   RVKRP005
00369                                                                   RVKRP005
00370      05  PS-TOTAL-TYPE-IND               PIC  X(01)  VALUE ' '.   RVKRP005
00371          88  PS-DMM-TOTAL                            VALUE '1'.   RVKRP005
00372          88  PS-FCLTY-TOTAL                          VALUE '2'.   RVKRP005
00373          88  PS-GRAND-TOTAL                          VALUE '3'.   RVKRP005
00374                                                                   RVKRP005
00375  01  PV-PROGRAM-VARIABLES.                                        RVKRP005
00376      05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     RVKRP005
00377                                                      COMP SYNC.   RVKRP005
00378      05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     RVKRP005
00379                                                      COMP SYNC.   RVKRP005
00380      05  PV-RECORDS-READ                 PIC  9(04)  VALUE ZERO.  RVKRP005
00381      05  PV-HOLD-DPT-NBR                 PIC  X(03).              RVKRP005
00382      05  PV-HOLD-DPT-DESC                PIC  X(25).              RVKRP005
00409      05  PV-HOLD-DMM-NMBR                PIC  X(03).              RVKRP008
00383      05  PV-HOLD-DMM-NAME                PIC  X(32).              RVKRP005
00384      05  PV-HOLD-OPER-UNT-ID             PIC S9(04) COMP.         RVKRP005
00385      05  PV-HOLD-FCLTY-NAME              PIC  X(25).              RVKRP005
00386      05  PV-RPT-TYPE                     PIC  X(1).               RVKRP005
00387          88  PV-MONTHLY-REPORT           VALUE 'M'.               RVKRP005
00388          88  PV-YTD-REPORT               VALUE 'Y'.               RVKRP005
00387          88  PV-WEEKLY-REPORT            VALUE 'W'.               RVKRP005
00389 *                                                                 RVKRP005
00390      05  PV-START-DATE.                                           RVKRP005
00391          10  PV-START-MONTH              PIC  9(02).              RVKRP005
00392          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP005
00393          10  PV-START-DAY                PIC  9(02).              RVKRP005
00394          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP005
00395          10  PV-START-CENTURY            PIC  9(02).              RVKRP005
00396          10  PV-START-YEAR               PIC  9(02).              RVKRP005
00397      05  PV-END-DATE.                                             RVKRP005
00398          10  PV-END-MONTH                PIC  9(02).              RVKRP005
00399          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP005
00400          10  PV-END-DAY                  PIC  9(02).              RVKRP005
00401          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP005
00402          10  PV-END-CENTURY              PIC  9(02).              RVKRP005
00403          10  PV-END-YEAR                 PIC  9(02).              RVKRP005
00404      05  PV-REPORT-LINE                 PIC X(132).               RVKRP005
00405                                                                   RVKRP005
00406      05  PV-CHAR-COUNT                   PIC S9(02)  VALUE +0     RVKRP005
00407                                                      COMP SYNC.   RVKRP005
00408      05  PV-TOTAL-DESCRIPTION           PIC X(22) VALUE SPACES    RVKRP005
00409                                                   JUST RIGHT.     RVKRP005
00410      05  PV-TEMP-TOTAL-DESC.                                      RVKRP005
00411          10 FILLER                       PIC  X(01)               RVKRP005
00412             OCCURS 32 TIMES DEPENDING ON PV-CHAR-COUNT.           RVKRP005
00413                                                                   RVKRP005
00414                                                                   RVKRP005
00415  01  ST-SYSTEM-TIME.                                              RVKRP005
00416      05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. RVKRP005
00417      05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. RVKRP005
00418                                                                   RVKRP005
00419 *                                                                 RVKRP005
00420 ******************************************************************RVKRP005
00421 *  WORK FIELDS FOR THE MBS SUBROUTINE                             RVKRP005
00422 ******************************************************************RVKRP005
00423      COPY DPWS003.                                                RVKRP005
00424                                                                   RVKRP005
00425 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP005
00426  PROCEDURE DIVISION.                                              RVKRP005
00427 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP005
00428                                                                   RVKRP005
00429 ******************************************************************RVKRP005
00430 *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    RVKRP005
00431 ******************************************************************RVKRP005
00432  0000-PROGRAM-MAINLINE.                                           RVKRP005
00433                                                                   RVKRP005
00434      PERFORM 1000-INITIALIZE.                                     RVKRP005
00435                                                                   RVKRP005
00436      PERFORM 2000-CREATE-REPORT.                                  RVKRP005
00437                                                                   RVKRP005
00438      PERFORM 9000-EOJ-ROUTINE.                                    RVKRP005
00439      STOP RUN.                                                    RVKRP005
00440 *0000-EXIT.                                                       RVKRP005
00441                                                                   RVKRP005
00442 ******************************************************************RVKRP005
00443 *  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  RVKRP005
00444 *  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST RVKRP005
00445 *  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT RVKRP005
00446 *  FILE.                                                          RVKRP005
00447 ******************************************************************RVKRP005
00448  1000-INITIALIZE.                                                 RVKRP005
00449                                                                   RVKRP005
00450      OPEN OUTPUT DI-DEFECT-ITEM-REPORT-COST                       RVKRP005
                OUTPUT DI-DEFECT-ITEM-REPORT-RETAIL                     RVKRP005
00451           INPUT  RTV-REPORT-EXTRACT.                              RVKRP005
00452                                                                   RVKRP005
00453      SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                      RVKRP005
00454                                                                   RVKRP005
00455      PERFORM 7000-READ-EXTRACT-FILE.                              RVKRP005
00456                                                                   RVKRP005
00457      IF PS-END-OF-EXTRACT-FILE                                    RVKRP005
00458          SET PS-NO-DATA          TO TRUE                          RVKRP005
00459      ELSE                                                         RVKRP005
00460          IF RV010-DETAIL-REC                                      RVKRP005
00461              DISPLAY '** ABEND **'                                RVKRP005
00462              DISPLAY '** PROGRAM = RVKRP005 **'                   RVKRP005
00463              DISPLAY '** PARAGRAPH = 1000-INITIALIZE.     **'     RVKRP005
00464              DISPLAY '** FIRST RECORD NOT THE DATE RECORD **'     RVKRP005
00465              MOVE +4003 TO ABEND-CODE                             RVKRP005
00466              CALL 'ILBOABN0' USING ABEND-CODE                     RVKRP005
00467          ELSE                                                     RVKRP005
00468              SET PS-DATA           TO TRUE                        RVKRP005
00469                                                                   RVKRP005
00470              MOVE RV010-RPT-TYPE   TO PV-RPT-TYPE                 RVKRP005
00471                                                                   RVKRP005
00472              MOVE RV010-END-MM     TO PV-END-MONTH                RVKRP005
00473              MOVE RV010-END-DD     TO PV-END-DAY                  RVKRP005
00474              MOVE RV010-END-CC     TO PV-END-CENTURY              RVKRP005
00475              MOVE RV010-END-YY     TO PV-END-YEAR                 RVKRP005
00476                                                                   RVKRP005
00477              MOVE RV010-BEGIN-MM   TO PV-START-MONTH              RVKRP005
00478              MOVE RV010-BEGIN-DD   TO PV-START-DAY                RVKRP005
00479              MOVE RV010-BEGIN-CC   TO PV-START-CENTURY            RVKRP005
00480              MOVE RV010-BEGIN-YY   TO PV-START-YEAR               RVKRP005
00481                                                                   RVKRP005
00482              MOVE PV-START-DATE    TO PH3-START-DATE              RVKRP005
00483              MOVE PV-END-DATE      TO PH3-END-DATE                RVKRP005
00484                                                                   RVKRP005
00485              MOVE RV010-CURR-YY    TO DP132O-RUN-YEAR             RVKRP005
00486              MOVE RV010-CURR-MM    TO DP132O-RUN-MONTH            RVKRP005
00487              MOVE RV010-CURR-DD    TO DP132O-RUN-DAY              RVKRP005
00488                                                                   RVKRP005
00489              ACCEPT ST-SYSTEM-TIME FROM TIME                      RVKRP005
00490              MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR             RVKRP005
00491              MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE           RVKRP005
00492                                                                   RVKRP005
00493              MOVE 'RVKRP005'       TO DP132O-PROGRAM-NAME         RVKRP005
00494                                                                   RVKRP005
                   EVALUATE TRUE                                                
00495                WHEN PV-MONTHLY-REPORT                             RVKRP005
00496                  MOVE 1            TO DP132O-REPORT-NUMBER        RVKRP005
00495                WHEN PV-YTD-REPORT                                 RVKRP005
00498                  MOVE 2            TO DP132O-REPORT-NUMBER        RVKRP005
00495                WHEN PV-WEEKLY-REPORT                              RVKRP005
00498                  MOVE 5            TO DP132O-REPORT-NUMBER        RVKRP005
                   END-EVALUATE                                                 
00500                                                                   RVKRP005
00501              MOVE PC-MAX-REPORT-LINES                             RVKRP005
00502                                    TO PV-LINE-COUNT               RVKRP005
00503              MOVE +0               TO PV-PAGE-COUNT               RVKRP005
00504                                                                   RVKRP005
00505              INITIALIZE DL-DETAIL-LINE                            RVKRP005
00506                         PA-PROGRAM-ACCUMULATORS                   RVKRP005
00507              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP005
00508          END-IF                                                   RVKRP005
00509      END-IF.                                                      RVKRP005
00510                                                                   RVKRP005
00511                                                                   RVKRP005
00512 *1000-EXIT.                                                       RVKRP005
00513                                                                   RVKRP005
00514 ******************************************************************RVKRP005
00515 * 2000-CREATE-REPORT                                              RVKRP005
00516 * PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNARVKRP005
00517 * SORT FILE.                                                      RVKRP005
00518 ******************************************************************RVKRP005
00519  2000-CREATE-REPORT.                                              RVKRP005
00520                                                                   RVKRP005
00521      IF PS-END-OF-EXTRACT-FILE                                    RVKRP005
00522          MOVE ER-EMPTY-REPORT-LINE  TO PV-REPORT-LINE             RVKRP005
00523          PERFORM 8000-PRINT-REPORT-LINE                           RVKRP005
00524      ELSE                                                         RVKRP005
00525          MOVE RV010-DPT-NBR       TO PV-HOLD-DPT-NBR              RVKRP005
00526          MOVE RV010-DPT-DESC      TO PV-HOLD-DPT-DESC             RVKRP005
00527          MOVE RV010-DMM-NBR       TO PV-HOLD-DMM-NMBR             RVKRP005
00527          MOVE RV010-DMM-NAME      TO PV-HOLD-DMM-NAME             RVKRP005
00528          MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID          RVKRP005
00529          MOVE RV010-FCLTY-NAME    TO PV-HOLD-FCLTY-NAME           RVKRP005
00530 *                                                                 RVKRP005
00531          PERFORM UNTIL PS-END-OF-EXTRACT-FILE                     RVKRP005
00532              IF RV010-OPER-UNT-ID = PV-HOLD-OPER-UNT-ID           RVKRP005
00533                  IF RV010-DMM-NBR  = PV-HOLD-DMM-NMBR             RVKRP005
00534                      IF RV010-DPT-NBR = PV-HOLD-DPT-NBR           RVKRP005
00535                          PERFORM 2100-ACCUMULATE-TOTALS           RVKRP005
00536                      ELSE                                         RVKRP005
00537                          PERFORM 2200-DPT-BREAK                   RVKRP005
00538                      END-IF                                       RVKRP005
00539                  ELSE                                             RVKRP005
00540                      PERFORM 2300-DMM-BREAK                       RVKRP005
00541                  END-IF                                           RVKRP005
00542              ELSE                                                 RVKRP005
00543                  PERFORM 2400-FCLTY-BREAK                         RVKRP005
00544              END-IF                                               RVKRP005
00545                                                                   RVKRP005
00546              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP005
00547                                                                   RVKRP005
00548          END-PERFORM                                              RVKRP005
00549      END-IF.                                                      RVKRP005
00550                                                                   RVKRP005
00551 ******************************************************************RVKRP005
00552 * 2100-ACCUMULATE-TOTALS                                          RVKRP005
00553 * PROCESS:  THIS PARAGRAPH WILL ACCUMULATE TOTALS AT THE DEPARTMENRVKRP005
00554 *  LEVEL.                                                         RVKRP005
00555 ******************************************************************RVKRP005
00556  2100-ACCUMULATE-TOTALS.                                          RVKRP005
00557                                                                   RVKRP005
00558      EVALUATE TRUE                                                RVKRP005
00559          WHEN RV010-RTV-TYPE                                      RVKRP005
00560              ADD RV010-UNIT-COST-AMT TO PA-DR-DPT-COST            RVKRP005
00560              ADD RV010-RTL-COST-AMT  TO PA-DR-DPT-RETAIL          RVKRP005
00561              ADD +1                  TO PA-DR-DPT-QTY             RVKRP005
00562                                                                   RVKRP005
00563          WHEN RV010-DD-TYPE                                       RVKRP005
00564              ADD RV010-UNIT-COST-AMT TO PA-DD-DPT-COST            RVKRP005
00564              ADD RV010-RTL-COST-AMT  TO PA-DD-DPT-RETAIL          RVKRP005
00565              ADD +1                  TO PA-DD-DPT-QTY             RVKRP005
00566                                                                   RVKRP005
00567          WHEN RV010-MO-TYPE                                       RVKRP005
00568              ADD RV010-UNIT-COST-AMT TO PA-MO-DPT-COST            RVKRP005
00568              ADD RV010-RTL-COST-AMT  TO PA-MO-DPT-RETAIL          RVKRP005
00569              ADD +1                  TO PA-MO-DPT-QTY             RVKRP005
00570      END-EVALUATE.                                                RVKRP005
00571                                                                   RVKRP005
00572                                                                   RVKRP005
00573 ******************************************************************RVKRP005
00574 * 2200-DPT-BREAK.                                                 RVKRP005
00575 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP005
00576 *  THE DEPARTMENT NUMBER:                                         RVKRP005
00577 *     1) PRINT LINE OF OLD DEPT TO REPORT                         RVKRP005
00578 *     2) RESET THE "HOLD" VARIABLES                               RVKRP005
00579 *     3) ADD "OLD" DEPT TOTALS TO DMM TOTALS                      RVKRP005
00580 *     4) INITIALIZE DEPT TOTALS FOR NEW DEPT                      RVKRP005
00581 *     5) ADD CURRENT VALUES TO NEW DEPT TOTALS                    RVKRP005
00582 ******************************************************************RVKRP005
00583  2200-DPT-BREAK.                                                  RVKRP005
00584                                                                   RVKRP005
00585      PERFORM 8000-PRINT-REPORT-LINE.                              RVKRP005
00586                                                                   RVKRP005
00587      MOVE RV010-DPT-NBR       TO PV-HOLD-DPT-NBR.                 RVKRP005
00588      MOVE RV010-DPT-DESC      TO PV-HOLD-DPT-DESC.                RVKRP005
00589                                                                   RVKRP005
00590      ADD PA-DR-DPT-QTY        TO PA-DR-DMM-QTY.                   RVKRP005
00591      ADD PA-DR-DPT-COST       TO PA-DR-DMM-COST.                  RVKRP005
00591      ADD PA-DR-DPT-RETAIL     TO PA-DR-DMM-RETAIL.                RVKRP005
00592 *                                                                 RVKRP005
00593      ADD PA-DD-DPT-QTY        TO PA-DD-DMM-QTY.                   RVKRP005
00594      ADD PA-DD-DPT-COST       TO PA-DD-DMM-COST.                  RVKRP005
00594      ADD PA-DD-DPT-RETAIL     TO PA-DD-DMM-RETAIL.                RVKRP005
00595 *                                                                 RVKRP005
00596      ADD PA-MO-DPT-QTY        TO PA-MO-DMM-QTY.                   RVKRP005
00597      ADD PA-MO-DPT-COST       TO PA-MO-DMM-COST.                  RVKRP005
00597      ADD PA-MO-DPT-RETAIL     TO PA-MO-DMM-RETAIL.                RVKRP005
00598 *                                                                 RVKRP005
00599      INITIALIZE PA-DPT-TOTALS.                                    RVKRP005
00600 *                                                                 RVKRP005
00601      PERFORM 2100-ACCUMULATE-TOTALS.                              RVKRP005
00602                                                                   RVKRP005
00603 ******************************************************************RVKRP005
00604 * 2300-DMM-BREAK                                                  RVKRP005
00605 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP005
00606 *  THE DMM:                                                       RVKRP005
00607 *     1) PERFORM DEPT BREAK LOGIC                                 RVKRP005
00608 *     2) PRINT DMM TOTAL LINE                                     RVKRP005
00609 *     3) RESET THE "HOLD" DMM VALUE                               RVKRP005
00610 *     4) ADD "OLD" DMM TOTALS TO FACILITY TOTALS                  RVKRP005
00611 *     5) INITIALIZE DMM TOTALS FOR NEW DMM                        RVKRP005
00612 ******************************************************************RVKRP005
00613  2300-DMM-BREAK.                                                  RVKRP005
00614                                                                   RVKRP005
00615      PERFORM 2200-DPT-BREAK.                                      RVKRP005
00616 *                                                                 RVKRP005
00617      SET PS-DMM-TOTAL         TO TRUE.                            RVKRP005
00618      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP005
00619 *                                                                 RVKRP005
00620      MOVE RV010-DMM-NBR       TO PV-HOLD-DMM-NMBR.                RVKRP005
00620      MOVE RV010-DMM-NAME      TO PV-HOLD-DMM-NAME.                RVKRP005
00621 *                                                                 RVKRP005
00622      ADD PA-DR-DMM-QTY        TO PA-DR-FCLTY-QTY.                 RVKRP005
00623      ADD PA-DR-DMM-COST       TO PA-DR-FCLTY-COST.                RVKRP005
00623      ADD PA-DR-DMM-RETAIL     TO PA-DR-FCLTY-RETAIL.              RVKRP005
00624                                                                   RVKRP005
00625      ADD PA-DD-DMM-QTY        TO PA-DD-FCLTY-QTY.                 RVKRP005
00626      ADD PA-DD-DMM-COST       TO PA-DD-FCLTY-COST.                RVKRP005
00626      ADD PA-DD-DMM-RETAIL     TO PA-DD-FCLTY-RETAIL.              RVKRP005
00627                                                                   RVKRP005
00628      ADD PA-MO-DMM-QTY        TO PA-MO-FCLTY-QTY.                 RVKRP005
00629      ADD PA-MO-DMM-COST       TO PA-MO-FCLTY-COST.                RVKRP005
00629      ADD PA-MO-DMM-RETAIL     TO PA-MO-FCLTY-RETAIL.              RVKRP005
00630 *                                                                 RVKRP005
00631      INITIALIZE PA-DMM-TOTALS.                                    RVKRP005
00632                                                                   RVKRP005
00633 *                                                                 RVKRP005
00634 ******************************************************************RVKRP005
00635 * 2400-FCLTY-BREAK                                                RVKRP005
00636 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP005
00637 *  THE FACILITY (OPERATING UNIT ID)                               RVKRP005
00638 *     1) PERFORM DMM BREAK LOGIC                                  RVKRP005
00639 *     2) PRINT FACILITY TOTAL LINE (SET COUNT FOR A PAGE BREAK)   RVKRP005
00640 *     3) RESET THE "HOLD" FACILITY ID                             RVKRP005
00641 *     4) ADD "OLD" FACIITY TOTALS TO THE GRAND TOTALS             RVKRP005
00642 *     5) INITIALIZE FACILITY TOTALS FOR NEW FACILITY              RVKRP005
00643 ******************************************************************RVKRP005
00644  2400-FCLTY-BREAK.                                                RVKRP005
00645                                                                   RVKRP005
00646      PERFORM 2300-DMM-BREAK.                                      RVKRP005
00647 *                                                                 RVKRP005
00648      SET PS-FCLTY-TOTAL       TO TRUE.                            RVKRP005
00649      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP005
00650                                                                   RVKRP005
00651      MOVE PC-MAX-REPORT-LINES      TO PV-LINE-COUNT               RVKRP005
00652 *                                                                 RVKRP005
00653      MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID.             RVKRP005
00654      MOVE RV010-FCLTY-NAME    TO PV-HOLD-FCLTY-NAME.              RVKRP005
00655 *                                                                 RVKRP005
00656      ADD PA-DR-FCLTY-QTY      TO PA-DR-GRAND-QTY.                 RVKRP005
00657      ADD PA-DR-FCLTY-COST     TO PA-DR-GRAND-COST.                RVKRP005
00657      ADD PA-DR-FCLTY-RETAIL   TO PA-DR-GRAND-RETAIL.              RVKRP005
00658                                                                   RVKRP005
00659      ADD PA-DD-FCLTY-QTY      TO PA-DD-GRAND-QTY.                 RVKRP005
00660      ADD PA-DD-FCLTY-COST     TO PA-DD-GRAND-COST.                RVKRP005
00660      ADD PA-DD-FCLTY-RETAIL   TO PA-DD-GRAND-RETAIL.              RVKRP005
00661                                                                   RVKRP005
00662      ADD PA-MO-FCLTY-QTY      TO PA-MO-GRAND-QTY.                 RVKRP005
00663      ADD PA-MO-FCLTY-COST     TO PA-MO-GRAND-COST.                RVKRP005
00663      ADD PA-MO-FCLTY-RETAIL   TO PA-MO-GRAND-RETAIL.              RVKRP005
00664 *                                                                 RVKRP005
00665      INITIALIZE PA-FCLTY-TOTALS.                                  RVKRP005
00666 *                                                                 RVKRP005
00667 *                                                                 RVKRP005
00668 ******************************************************************RVKRP005
00669 * 2500-GRAND-TOTAL                                                RVKRP005
00670 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR THE GRAND   RVKRP005
00671 *  TOTAL:                                                         RVKRP005
00672 *     1) PERFORM DMM BREAK LOGIC                                  RVKRP005
00673 *     2) PRINT FACILITY TOTAL LINE                                RVKRP005
00674 *     3) RESET THE "HOLD" FACILITY ID                             RVKRP005
00675 *     4) ADD "OLD" FACIITY TOTALS TO THE GRAND TOTALS             RVKRP005
00676 *     5) INITIALIZE FACILITY TOTALS FOR NEW FACILITY              RVKRP005
00677 ******************************************************************RVKRP005
00678  2500-GRAND-TOTAL.                                                RVKRP005
00679                                                                   RVKRP005
00680      PERFORM 2400-FCLTY-BREAK.                                    RVKRP005
00681 *                                                                 RVKRP005
00682      SET PS-GRAND-TOTAL       TO TRUE.                            RVKRP005
00683      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP005
00684 *                                                                 RVKRP005
00685 *                                                                 RVKRP005
00686 ******************************************************************RVKRP005
00687 * 7000-READ-EXTRACT-FILE.                                        *RVKRP005
00688 *  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *RVKRP005
00689 *  FLAT FILE.                                                    *RVKRP005
00690 ******************************************************************RVKRP005
00691  7000-READ-EXTRACT-FILE.                                          RVKRP005
00692 *                                                                 RVKRP005
00693      READ RTV-REPORT-EXTRACT                                      RVKRP005
00694          INTO RV010-EXTRACT-RECORD                                RVKRP005
00695          AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               RVKRP005
00696       ADD 1 TO PV-RECORDS-READ.                                   RVKRP005
00696                                                                   RVKRP005
00697 ******************************************************************RVKRP005
00698 * 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   RVKRP005
00699 * CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNTRVKRP005
00700 * INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  RVKRP005
00701 ******************************************************************RVKRP005
00702  8000-PRINT-REPORT-LINE.                                          RVKRP005
00703                                                                   RVKRP005
00704      ADD +1 TO PV-LINE-COUNT.                                     RVKRP005
00705                                                                   RVKRP005
00706      IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      RVKRP005
00707          PERFORM 8300-WRITE-PAGE-HEADING                          RVKRP005
00708          PERFORM 8400-WRITE-COLUMN-HEADING                        RVKRP005
00709      END-IF.                                                      RVKRP005
00710                                                                   RVKRP005
00711      IF PS-NEW-LINE                                               RVKRP005
00712          MOVE PV-HOLD-DMM-NAME     TO DL-DMM-NAME                 RVKRP005
00713          SET PS-NO-NEW-LINE        TO TRUE                        RVKRP005
00714      ELSE                                                         RVKRP005
00715          MOVE SPACES               TO DL-DMM-NAME                 RVKRP005
00716      END-IF.                                                      RVKRP005
00717                                                                   RVKRP005
00718      MOVE PV-HOLD-DPT-NBR          TO DL-DPT-NBR.                 RVKRP005
00719      MOVE PV-HOLD-DPT-DESC         TO DL-DPT-DESC.                RVKRP005
00720      MOVE PA-DR-DPT-QTY            TO DL-DR-QTY.                  RVKRP005
00721      MOVE PA-DR-DPT-COST           TO DL-DR-COST-RETAIL.          RVKRP005
00722      MOVE PA-DD-DPT-QTY            TO DL-DD-QTY.                  RVKRP005
00723      MOVE PA-DD-DPT-COST           TO DL-DD-COST-RETAIL.          RVKRP005
00724      MOVE PA-MO-DPT-QTY            TO DL-MO-QTY.                  RVKRP005
00725      MOVE PA-MO-DPT-COST           TO DL-MO-COST-RETAIL.          RVKRP005
00726                                                                   RVKRP005
00727      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00728          FROM DL-DETAIL-LINE                                      RVKRP005
00729          AFTER ADVANCING 1 LINES.                                 RVKRP005
00726                                                                   RVKRP005
00726                                                                   RVKRP005
00721      MOVE PA-DR-DPT-RETAIL         TO DL-DR-COST-RETAIL.          RVKRP005
00723      MOVE PA-DD-DPT-RETAIL         TO DL-DD-COST-RETAIL.          RVKRP005
00725      MOVE PA-MO-DPT-RETAIL         TO DL-MO-COST-RETAIL.          RVKRP005
00727      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00728          FROM DL-DETAIL-LINE                                      RVKRP005
00729          AFTER ADVANCING 1 LINES.                                 RVKRP005
00730                                                                   RVKRP005
00731 *8000-EXIT.                                                       RVKRP005
00732                                                                   RVKRP005
00733 ******************************************************************RVKRP005
00734 * 8100-PRINT-TOTAL-LINE - WRITE THE CONTROL BREAK TOTAL LINES     RVKRP005
00735 ******************************************************************RVKRP005
00736  8100-PRINT-TOTAL-LINE.                                           RVKRP005
00737                                                                   RVKRP005
00738      EVALUATE TRUE                                                RVKRP005
00739          WHEN PS-DMM-TOTAL                                        RVKRP005
00740              SET  PS-NEW-LINE         TO TRUE                     RVKRP005
00741              MOVE +0 TO PV-CHAR-COUNT                             RVKRP005
00742                                                                   RVKRP005
00743              INSPECT PV-HOLD-DMM-NAME TALLYING PV-CHAR-COUNT      RVKRP005
00744                  FOR CHARACTERS BEFORE '  '                       RVKRP005
00745                                                                   RVKRP005
00746              MOVE PV-HOLD-DMM-NAME    TO PV-TEMP-TOTAL-DESC       RVKRP005
00747                                                                   RVKRP005
00748              MOVE PV-TEMP-TOTAL-DESC  TO PV-TOTAL-DESCRIPTION     RVKRP005
00749              MOVE PV-TOTAL-DESCRIPTION                            RVKRP005
00750                                       TO TL-TOTAL-DESCRIPTION     RVKRP005
00751                                                                   RVKRP005
00752              MOVE PA-DR-DMM-QTY       TO TL-DR-QTY                RVKRP005
00753              MOVE PA-DR-DMM-COST      TO TL-DR-COST-RETAIL        RVKRP005
00754              MOVE PA-DD-DMM-QTY       TO TL-DD-QTY                RVKRP005
00755              MOVE PA-DD-DMM-COST      TO TL-DD-COST-RETAIL        RVKRP005
00756              MOVE PA-MO-DMM-QTY       TO TL-MO-QTY                RVKRP005
00757              MOVE PA-MO-DMM-COST      TO TL-MO-COST-RETAIL        RVKRP005
00758                                                                   RVKRP005
00759          WHEN PS-FCLTY-TOTAL                                      RVKRP005
00760              MOVE +0 TO PV-CHAR-COUNT                             RVKRP005
00761                                                                   RVKRP005
00762              INSPECT PV-HOLD-FCLTY-NAME TALLYING PV-CHAR-COUNT    RVKRP005
00763                  FOR CHARACTERS BEFORE '  '                       RVKRP005
00764                                                                   RVKRP005
00765              MOVE PV-HOLD-FCLTY-NAME  TO PV-TEMP-TOTAL-DESC       RVKRP005
00766                                                                   RVKRP005
00767              MOVE PV-TEMP-TOTAL-DESC  TO PV-TOTAL-DESCRIPTION     RVKRP005
00768              MOVE PV-TOTAL-DESCRIPTION                            RVKRP005
00769                                       TO TL-TOTAL-DESCRIPTION     RVKRP005
00770                                                                   RVKRP005
00771              MOVE PA-DR-FCLTY-QTY     TO TL-DR-QTY                RVKRP005
00772              MOVE PA-DR-FCLTY-COST    TO TL-DR-COST-RETAIL        RVKRP005
00773              MOVE PA-DD-FCLTY-QTY     TO TL-DD-QTY                RVKRP005
00774              MOVE PA-DD-FCLTY-COST    TO TL-DD-COST-RETAIL        RVKRP005
00775              MOVE PA-MO-FCLTY-QTY     TO TL-MO-QTY                RVKRP005
00776              MOVE PA-MO-FCLTY-COST    TO TL-MO-COST-RETAIL        RVKRP005
00777                                                                   RVKRP005
00778          WHEN PS-GRAND-TOTAL                                      RVKRP005
00779              MOVE '                GRAND '                        RVKRP005
00780                                       TO TL-TOTAL-DESCRIPTION     RVKRP005
00781              MOVE PA-DR-GRAND-QTY     TO TL-DR-QTY                RVKRP005
00782              MOVE PA-DR-GRAND-COST    TO TL-DR-COST-RETAIL        RVKRP005
00783              MOVE PA-DD-GRAND-QTY     TO TL-DD-QTY                RVKRP005
00784              MOVE PA-DD-GRAND-COST    TO TL-DD-COST-RETAIL        RVKRP005
00785              MOVE PA-MO-GRAND-QTY     TO TL-MO-QTY                RVKRP005
00786              MOVE PA-MO-GRAND-COST    TO TL-MO-COST-RETAIL        RVKRP005
00787      END-EVALUATE.                                                RVKRP005
00788                                                                   RVKRP005
00789      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00790          FROM TL-TOTAL-LINE-DASHES                                RVKRP005
00791          AFTER ADVANCING 0 LINES.                                 RVKRP005
00792                                                                   RVKRP005
00793      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00794          FROM TL-TOTAL-LINE                                       RVKRP005
00795          AFTER ADVANCING 1 LINES.                                 RVKRP005
                                                                                
00738      EVALUATE TRUE                                                RVKRP005
00739          WHEN PS-DMM-TOTAL                                        RVKRP005
00753              MOVE PA-DR-DMM-RETAIL    TO TL-DR-COST-RETAIL        RVKRP005
00755              MOVE PA-DD-DMM-RETAIL    TO TL-DD-COST-RETAIL        RVKRP005
00757              MOVE PA-MO-DMM-RETAIL    TO TL-MO-COST-RETAIL        RVKRP005
00758                                                                   RVKRP005
00759          WHEN PS-FCLTY-TOTAL                                      RVKRP005
00772              MOVE PA-DR-FCLTY-RETAIL  TO TL-DR-COST-RETAIL        RVKRP005
00774              MOVE PA-DD-FCLTY-RETAIL  TO TL-DD-COST-RETAIL        RVKRP005
00776              MOVE PA-MO-FCLTY-RETAIL  TO TL-MO-COST-RETAIL        RVKRP005
00777                                                                   RVKRP005
00778          WHEN PS-GRAND-TOTAL                                      RVKRP005
00782              MOVE PA-DR-GRAND-RETAIL  TO TL-DR-COST-RETAIL        RVKRP005
00784              MOVE PA-DD-GRAND-RETAIL  TO TL-DD-COST-RETAIL        RVKRP005
00786              MOVE PA-MO-GRAND-RETAIL  TO TL-MO-COST-RETAIL        RVKRP005
00787      END-EVALUATE.                                                RVKRP005
00788                                                                   RVKRP005
00789      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00790          FROM TL-TOTAL-LINE-DASHES                                RVKRP005
00791          AFTER ADVANCING 0 LINES.                                 RVKRP005
00792                                                                   RVKRP005
00793      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00794          FROM TL-TOTAL-LINE                                       RVKRP005
00795          AFTER ADVANCING 1 LINES.                                 RVKRP005
00796                                                                   RVKRP005
00797      ADD +1                        TO PV-LINE-COUNT.              RVKRP005
00798                                                                   RVKRP005
00799      PERFORM 8200-WRITE-BLANK-LINE.                               RVKRP005
00800                                                                   RVKRP005
00801                                                                   RVKRP005
00802 *8100-EXIT.                                                       RVKRP005
00803                                                                   RVKRP005
00804 ******************************************************************RVKRP005
00805 * 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      RVKRP005
00806 ******************************************************************RVKRP005
00807  8200-WRITE-BLANK-LINE.                                           RVKRP005
00808                                                                   RVKRP005
00809      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00810          FROM BLANK-LINE                                          RVKRP005
00811          AFTER ADVANCING 1 LINES.                                 RVKRP005
00812                                                                   RVKRP005
00809      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00810          FROM BLANK-LINE                                          RVKRP005
00811          AFTER ADVANCING 1 LINES.                                 RVKRP005
00812                                                                   RVKRP005
00813      ADD +1                        TO PV-LINE-COUNT.              RVKRP005
00814                                                                   RVKRP005
00815                                                                   RVKRP005
00816 *8200-EXIT.                                                       RVKRP005
00817 ******************************************************************RVKRP005
00818 * 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FORRVKRP005
00819 * THE DEFECTIVE ITEM REPORT.                                      RVKRP005
00820 ******************************************************************RVKRP005
00821  8300-WRITE-PAGE-HEADING.                                         RVKRP005
00822                                                                   RVKRP005
00823      ADD +1 TO PV-PAGE-COUNT.                                     RVKRP005
00824      MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    RVKRP005
00825      EVALUATE TRUE                                                RVKRP005
00495        WHEN  PV-MONTHLY-REPORT                                    RVKRP005
00496          MOVE 1            TO DP132O-REPORT-NUMBER                RVKRP005
00495        WHEN  PV-YTD-REPORT                                        RVKRP005
00498          MOVE 2            TO DP132O-REPORT-NUMBER                RVKRP005
00495        WHEN  PV-WEEKLY-REPORT                                     RVKRP005
00498          MOVE 5            TO DP132O-REPORT-NUMBER                RVKRP005
00825      END-EVALUATE                                                 RVKRP005
00499                                                                   RVKRP005
00826      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00827          FROM DP132O-STANDRD-HEADER-132-COLS                      RVKRP005
00828          AFTER ADVANCING PAGE.                                    RVKRP005
                                                                                
           EVALUATE TRUE                                                RVKRP005
00495        WHEN  PV-MONTHLY-REPORT                                    RVKRP005
00496          MOVE 3            TO DP132O-REPORT-NUMBER                RVKRP005
00495        WHEN  PV-YTD-REPORT                                        RVKRP005
00498          MOVE 4            TO DP132O-REPORT-NUMBER                RVKRP005
00495        WHEN  PV-WEEKLY-REPORT                                     RVKRP005
00498          MOVE 6            TO DP132O-REPORT-NUMBER                RVKRP005
00825      END-EVALUATE                                                 RVKRP005
00500                                                                   RVKRP005
00826      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00827          FROM DP132O-STANDRD-HEADER-132-COLS                      RVKRP005
00828          AFTER ADVANCING PAGE.                                    RVKRP005
00829                                                                   RVKRP005
           EVALUATE TRUE                                                        
00830        WHEN PV-MONTHLY-REPORT                                     RVKRP005
00831          WRITE DI-DEFECT-ITEM-LINE-COST                           RVKRP0  
00832              FROM PH2-PAGE-HEADING-MONTH-COST                     RVKRP0  
00833              AFTER ADVANCING 1 LINES                              RVKRP0  
00831          WRITE DI-DEFECT-ITEM-LINE-RETAIL                         RVKRP0  
00832              FROM PH2-PAGE-HEADING-MONTH-RETAIL                   RVKRP0  
00833              AFTER ADVANCING 1 LINES                              RVKRP0  
00830        WHEN PV-YTD-REPORT                                         RVKRP0  
00835          WRITE DI-DEFECT-ITEM-LINE-COST                           RVKRP0  
00836              FROM PH2-PAGE-HEADING-YTD-COST                       RVKRP0  
00837              AFTER ADVANCING 1 LINES                              RVKRP0  
00835          WRITE DI-DEFECT-ITEM-LINE-RETAIL                         RVKRP0  
00836              FROM PH2-PAGE-HEADING-YTD-RETAIL                     RVKRP0  
00837              AFTER ADVANCING 1 LINES                              RVKRP0  
UPD          WHEN PV-WEEKLY-REPORT                                      RVKRP0  
UPD            WRITE DI-DEFECT-ITEM-LINE-COST                           RVKRP0  
UPD                FROM PH2-PAGE-HEADING-WEEKLY-COST                    RVKRP0  
UPD                AFTER ADVANCING 1 LINES                              RVKRP0  
UPD            WRITE DI-DEFECT-ITEM-LINE-RETAIL                         RVKRP0  
UPD                FROM PH2-PAGE-HEADING-WEEKLY-RETAIL                  RVKRP0  
UPC                AFTER ADVANCING 1 LINES                              RVKRP0  
           END-EVALUATE.                                                        
00839                                                                   RVKRP005
00840      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00841          FROM PH3-PAGE-HEADING-3                                  RVKRP005
00842          AFTER ADVANCING 1 LINES.                                 RVKRP005
00840      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00841          FROM PH3-PAGE-HEADING-3                                  RVKRP005
00842          AFTER ADVANCING 1 LINES.                                 RVKRP005
00843                                                                   RVKRP005
00844      MOVE PV-HOLD-FCLTY-NAME     TO PH4-FCLTY-NAME.               RVKRP005
00845                                                                   RVKRP005
00846      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00847          FROM PH4-PAGE-HEADING-4                                  RVKRP005
00848          AFTER ADVANCING 1 LINES.                                 RVKRP005
00846      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00847          FROM PH4-PAGE-HEADING-4                                  RVKRP005
00848          AFTER ADVANCING 1 LINES.                                 RVKRP005
00849                                                                   RVKRP005
00850      MOVE +4     TO PV-LINE-COUNT.                                RVKRP005
00851                                                                   RVKRP005
00852      SET PS-NEW-LINE             TO TRUE.                         RVKRP005
00853                                                                   RVKRP005
00854 *8300-EXIT.                                                       RVKRP005
00855                                                                   RVKRP005
00856 ******************************************************************RVKRP005
00857 * 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       RVKRP005
00858 * THE DEFECTIVE ITEM REPORT.                                      RVKRP005
00859 ******************************************************************RVKRP005
00860  8400-WRITE-COLUMN-HEADING.                                       RVKRP005
00861                                                                   RVKRP005
00862      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00863          FROM DH1-DETAIL-HEADING-1                                RVKRP005
00864          AFTER ADVANCING 2 LINES.                                 RVKRP005
00862      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00863          FROM DH1-DETAIL-HEADING-1                                RVKRP005
00864          AFTER ADVANCING 2 LINES.                                 RVKRP005
00865                                                                   RVKRP005
00866      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00867          FROM DH2-DETAIL-HEADING-2-COST                           RVKRP005
00868          AFTER ADVANCING 1 LINES.                                 RVKRP005
00866      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00867          FROM DH2-DETAIL-HEADING-2-RETAIL                         RVKRP005
00868          AFTER ADVANCING 1 LINES.                                 RVKRP005
00869                                                                   RVKRP005
00870      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00871          FROM DHD-DETAIL-HEADING-DASHES                           RVKRP005
00872          AFTER ADVANCING 0 LINES.                                 RVKRP005
00870      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00871          FROM DHD-DETAIL-HEADING-DASHES                           RVKRP005
00872          AFTER ADVANCING 0 LINES.                                 RVKRP005
00873                                                                   RVKRP005
00874      ADD +4       TO PV-LINE-COUNT.                               RVKRP005
00875 *8400-EXIT.                                                       RVKRP005
00876                                                                   RVKRP005
00877 ******************************************************************RVKRP005
00878 * 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  RVKRP005
00879 * CURSOR AND THE REPORT FILE.                                     RVKRP005
00880 ******************************************************************RVKRP005
00881  9000-EOJ-ROUTINE.                                                RVKRP005
00882                                                                   RVKRP005
00883      IF PS-NO-DATA                                                RVKRP005
00884          CONTINUE                                                 RVKRP005
00885      ELSE                                                         RVKRP005
00886          PERFORM 2500-GRAND-TOTAL                                 RVKRP005
00887      END-IF.                                                      RVKRP005
00888                                                                   RVKRP005
00889      WRITE DI-DEFECT-ITEM-LINE-COST                               RVKRP005
00890          FROM END-OF-REPORT-LINE                                  RVKRP005
00891          AFTER ADVANCING 1 LINES.                                 RVKRP005
00889      WRITE DI-DEFECT-ITEM-LINE-RETAIL                             RVKRP005
00890          FROM END-OF-REPORT-LINE                                  RVKRP005
00891          AFTER ADVANCING 1 LINES.                                 RVKRP005
00892                                                                   RVKRP005
00893      CLOSE DI-DEFECT-ITEM-REPORT-COST                             RVKRP005
                 DI-DEFECT-ITEM-REPORT-RETAIL                           RVKRP005
00894            RTV-REPORT-EXTRACT.                                    RVKRP005
00895                                                                   RVKRP005
00895      DISPLAY 'RECS READ ==>  ' PV-RECORDS-READ.                   RVKRP005
00895                                                                   RVKRP005
00896 ******************************************************************RVKRP005
00897 **************************** END OF RVKRP005 *********************RVKRP005
00898 ******************************************************************RVKRP005
