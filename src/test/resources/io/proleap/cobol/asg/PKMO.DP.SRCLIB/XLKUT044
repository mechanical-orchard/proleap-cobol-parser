000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT044.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   APRIL, 2003.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900****************************************************************  00090000
001000*    THIS PROGRAM WILL COMPARE RMS PO / LEGACY PO              *  00100000
001100* PO DOMAIN TEMPLATE.........:  XXT_PO_SKU                     *  00110000
001200* PO DOMAIN TEMPLATE COPYBOOK:  XLRD018                        *  00120000
001300*                                                              *  00130000
001400*        INPUT COMES TO THIS PROGRAM FROM XLKUT039 AND MUST    *  00140000
001500*    BE SORTED BY THE COMPLETE RECORD. THAT WAY, IF YOU HAVE   *  00150000
001600*    DUPLICATE KEY FIELDS THAT YOU ARE MATCHING ON, BUT THE    *  00160000
001700*    DATA IS DIFFERENT, THEY WILL MATCH.  IF YOU DON'T SORT    *  00170000
001800*    BY THE COMPLETE RECORD, RECORDS WITH DUPLICATE KEY        *  00180000
001900*    FIELDS COULD POSSIBLY CREATE MISLEADING DATA MISMATCHING  *  00190000
002000*    RECORDS WHEN NONE REALLY EXIST.                           *  00200000
002100*                                                              *  00210000
002200*        THIS PROGRAM MATCHES THE LEGACY AND RMS FILES BY      *  00220000
002300*    PO NUMBER AND SKU NUMBER.  IT                             *  00230000
002400*    WRITES ERROR RECORDS OUT FOR ANY UNMATCHED RECORDS. IT    *  00240000
002500*    ALSO CHECKS TO SEE IF THERE ARE ANY DATA DIFFERENCES FOR  *  00250000
002600*    THOSE RECORDS WHOSE PO NUMBERS MATCH. IF THERE ARE ANY,   *  00260000
002700*    AN ERROR RECORD IS WRITTEN INDICATING THE FIELDS THAT     *  00270000
002800*    ARE DIFFERENT.                                            *  00280000
002900*        THERE ARE SOME MOVES OF FIELDS COMMENTED OUT. THIS    *  00290000
003000*    HAS BEEN DONE BECAUSE SOME OF THESE FIELDS AREN'T AVAIL-  *  00300000
003100*    ABLE ON ONE OF THE SYSTEMS.  YOU MAY FIND THESE BY DOING  *  00310000
003200*    A F '**??'.                                               *  00320000
003300***************************************************************** 00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500 INPUT-OUTPUT SECTION.                                            00350000
003600                                                                  00360000
003700 FILE-CONTROL.                                                    00370000
003800                                                                  00380000
003900     SELECT RMS-PO-FILE                                           00390000
004000         ASSIGN TO INP01.                                         00400000
004100                                                                  00410000
004200     SELECT LEGACY-FILE                                           00420000
004300         ASSIGN TO INP02.                                         00430000
004400                                                                  00440000
004500     SELECT ERROR-FILE                                            00450000
004600         ASSIGN TO OUT01.                                         00460000
004700                                                                  00470000
004800***************************************************************** 00480000
004900 DATA DIVISION.                                                   00490000
005000***************************************************************** 00500000
005100 FILE SECTION.                                                    00510000
005200                                                                  00520000
005300 FD  RMS-PO-FILE                                                  00530000
005400     RECORDING MODE IS F                                          00540000
005500     BLOCK CONTAINS 0 RECORDS                                     00550000
005600     LABEL RECORDS ARE STANDARD.                                  00560000
005700                                                                  00570000
005800 01  RMS-PO-RECORD                PIC X(215).                     00580001
005900                                                                  00590000
006000 FD  LEGACY-FILE                                                  00600000
006100     RECORDING MODE IS F                                          00610000
006200     BLOCK CONTAINS 0 RECORDS                                     00620000
006300     LABEL RECORDS ARE STANDARD.                                  00630000
006400                                                                  00640000
006500 01  LEGACY-RECORD                PIC X(215).                     00650001
006600                                                                  00660000
006700                                                                  00670000
006800 FD  ERROR-FILE                                                   00680000
006900     RECORDING MODE IS F                                          00690000
007000     BLOCK CONTAINS 0 RECORDS                                     00700000
007100     LABEL RECORDS ARE STANDARD.                                  00710000
007200                                                                  00720000
007300 01  ERROR-RECORD                 PIC X(830).                     00730000
007400                                                                  00740000
007500                                                                  00750000
007600***************************************************************** 00760000
007700 WORKING-STORAGE SECTION.                                         00770000
007800                                                                  00780000
007900 01  PS-PROGRAM-SWITCHES.                                         00790000
008000     05  PS-EOF-INPUT1-SW             PIC X(01)  VALUE 'N'.       00800000
008100         88  PS-EOF-INPUT1-YES                   VALUE 'Y'.       00810000
008200         88  PS-EOF-INPUT1-NO                    VALUE 'N'.       00820000
008300     05  PS-EOF-INPUT2-SW             PIC X(01)  VALUE 'N'.       00830000
008400         88  PS-EOF-INPUT2-YES                   VALUE 'Y'.       00840000
008500         88  PS-EOF-INPUT2-NO                    VALUE 'N'.       00850000
008600     05  PS-EMAIL-SW                  PIC X(01)  VALUE 'N'.       00860000
008700         88  PS-EMAIL-YES                        VALUE 'Y'.       00870000
008800         88  PS-EMAIL-NO                         VALUE 'N'.       00880000
008900                                                                  00890000
009000 01  PC-PROGRAM-CONSTANTS.                                        00900000
009100     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT044'.00910000
009200     05  PC-FIVE-BLANKS               PIC  X(05) VALUE SPACES.    00920000
009300     05  PC-TWENTY-BLANKS             PIC  X(20) VALUE SPACES.    00930000
009400                                                                  00940000
009500 01  PC-SORT-KEY.                                                 00950000
009600     05  PC-SKU-NBR                   PIC  9(08) VALUE ZEROES.    00960000
009700                                                                  00970000
009800 01  PC-TOT-QTY.                                                  00980000
009900     05  PC-ORD-QTY-AMT-RMS           PIC  9(08)V9(4) VALUE ZEROS.00990000
010000     05  PC-CNCLD-QTY-AMT-RMS         PIC  9(08)V9(4) VALUE ZEROS.01000000
010100     05  PC-ORD-CNCLD-QTY-RMS         PIC  9(11)V9(4) VALUE ZEROS.01010000
010200     05  PC-ORD-QTY-AMT-LGCY          PIC  9(08)V9(4) VALUE ZEROS.01020000
010300     05  PC-CNCLD-QTY-AMT-LGCY        PIC  9(08)V9(4) VALUE ZEROS.01030000
010400     05  PC-ORD-CNCLD-QTY-LGCY        PIC  9(11)V9(4) VALUE ZEROS.01040000
010500     05  PV-WORK-QTY                  PIC  X(13) JUST RIGHT.      01050000
010600                                                                  01060000
010700 01  PV-PROGRAM-VARIABLES.                                        01070000
010800     05  PV-RECORDS-READ-1            PIC  9(09) VALUE  0.        01080000
010900     05  PV-RECORDS-READ-2            PIC  9(09) VALUE  0.        01090000
011000     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        01100000
011100     05  PV-RECORDS-ON-BOTH           PIC  9(09) VALUE  0.        01110000
011200     05  PV-RECORDS-ON-RMS-ONLY       PIC  9(09) VALUE  0.        01120000
011300     05  PV-RECORDS-ON-LEGACY-ONLY    PIC  9(09) VALUE  0.        01130000
011400     05  PV-RECORDS-DATA-MISMATCH     PIC  9(09) VALUE  0.        01140000
011500     05  PV-ALL-NINES                 PIC  9(09) VALUE  99999999. 01150000
011600                                                                  01160000
011700 01  PV-ABEND-FIELDS.                                             01170000
011800     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         01180000
011900                                                 COMP SYNC.       01190000
012000     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT044'.01200000
012100     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01210000
012200     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01220000
012300     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    01230000
012400                                                                  01240000
012500****NUMERIC EDITING ROUTINE                                       01250000
012600     COPY DPWS010I.                                               01260000
012700                                                                  01270000
012800 01  PV-RMS-INPUT.                                                01280000
012900     COPY XLRD018.                                                01290000
013000                                                                  01300000
013100 01  PV-LEGACY-INPUT.                                             01310000
013200     COPY XLRD018.                                                01320000
013300                                                                  01330000
013400 01  PV-ERROR-OUTPUT.                                             01340000
013500     COPY XLRD023.                                                01350000
013600                                                                  01360000
013700***************************************************************** 01370000
013800 PROCEDURE DIVISION.                                              01380000
013900***************************************************************** 01390000
014000     DISPLAY ' '.                                                 01400000
014100     DISPLAY '**** BEGINNING XLKUT044 ****'.                      01410000
014200     DISPLAY ' '.                                                 01420000
014300                                                                  01430000
014400     OPEN INPUT  RMS-PO-FILE                                      01440000
014500                 LEGACY-FILE                                      01450000
014600          OUTPUT ERROR-FILE.                                      01460000
014700     SET PS-EMAIL-NO       TO TRUE.                               01470000
014800                                                                  01480000
014900     PERFORM 1000-READ-RMS-INPUT.                                 01490000
015000     PERFORM 1100-READ-LEGACY-INPUT.                              01500000
015100                                                                  01510000
015200     PERFORM 2000-PROCESS-INPUT-FILE                              01520000
015300       UNTIL PS-EOF-INPUT1-YES AND                                01530000
015400             PS-EOF-INPUT2-YES.                                   01540000
015500                                                                  01550000
015600     CLOSE RMS-PO-FILE                                            01560000
015700           LEGACY-FILE                                            01570000
015800           ERROR-FILE.                                            01580000
015900                                                                  01590000
016000     DISPLAY ' '.                                                 01600000
016100     DISPLAY '  INPUT RMS PO REC = ' PV-RECORDS-READ-1.           01610000
016200     DISPLAY '  INPUT LEGACY REC = ' PV-RECORDS-READ-2.           01620000
016300     DISPLAY ' '.                                                 01630000
016400     DISPLAY '          XLRD018'.                                 01640000
016500     DISPLAY 'FILES ARE MATCHED BY PO NUMBER - 8 POSITIONS'.      01650000
016600     DISPLAY '                     SKU-NBR   - 8 POSITIONS'.      01660000
016700     DISPLAY ' '.                                                 01670000
016800     DISPLAY PC-FIVE-BLANKS                                       01680000
016900             'RECORDS ON BOTH FILES ---------> '                  01690000
017000              PV-RECORDS-ON-BOTH.                                 01700000
017100     DISPLAY ' '.                                                 01710000
017200     DISPLAY '  OUTPUT RECORDS WRITTEN ------> '                  01720000
017300              PV-RECORDS-WRITTEN.                                 01730000
017400     DISPLAY PC-FIVE-BLANKS                                       01740000
017500             'RECORDS ON RMS ONLY -----------> '                  01750000
017600              PV-RECORDS-ON-RMS-ONLY                              01760000
017700             ' - "A" RECORD CODE'.                                01770000
017800     DISPLAY PC-FIVE-BLANKS                                       01780000
017900             'RECORDS ON LEGACY ONLY --------> '                  01790000
018000              PV-RECORDS-ON-LEGACY-ONLY                           01800000
018100             ' - "B" RECORD CODE'.                                01810000
018200     DISPLAY PC-FIVE-BLANKS                                       01820000
018300             'RECORDS WITH DATA MISMATCH ----> '                  01830000
018400              PV-RECORDS-DATA-MISMATCH                            01840000
018500             ' - "C" RECORD CODE'.                                01850000
018600     DISPLAY ' '.                                                 01860000
018700     DISPLAY '****  END OF  XLKUT044  ****'.                      01870000
018800     DISPLAY ' '.                                                 01880000
018900                                                                  01890000
019000*    SET RETURN CODE IF E-MAIL SWITCH IS TRUE.                    01900000
019100     IF PS-EMAIL-YES                                              01910000
019200         MOVE 4095 TO RETURN-CODE                                 01920000
019300     END-IF.                                                      01930000
019400     GOBACK.                                                      01940000
019500                                                                  01950000
019600                                                                  01960000
019700***************************************************************** 01970000
019800*  READ A RMS PO RECORD                                           01980000
019900***************************************************************** 01990000
020000 1000-READ-RMS-INPUT.                                             02000000
020100                                                                  02010000
020200     MOVE '1000-READ-RMS-INPUT    ' TO PV-ABEND-PARAGRAPH.        02020000
020300                                                                  02030000
020400     INITIALIZE PV-RMS-INPUT.                                     02040000
020500                                                                  02050000
020600     READ RMS-PO-FILE                                             02060000
020700          INTO PV-RMS-INPUT                                       02070000
020800            AT END                                                02080000
020900               SET PS-EOF-INPUT1-YES TO TRUE                      02090000
021000     END-READ.                                                    02100000
021100                                                                  02110000
021200     IF PS-EOF-INPUT1-YES                                         02120000
021300        MOVE PV-ALL-NINES TO XL018-PO-NBR  OF PV-RMS-INPUT        02130000
021400                             XL018-SKU-NBR OF PV-RMS-INPUT        02140000
021500     ELSE                                                         02150000
021600        ADD +1 TO PV-RECORDS-READ-1                               02160000
021700     END-IF.                                                      02170000
021800                                                                  02180000
021900***************************************************************** 02190000
022000*  READ A LEGACY RECORD                                           02200000
022100***************************************************************** 02210000
022200 1100-READ-LEGACY-INPUT.                                          02220000
022300                                                                  02230000
022400     MOVE '1100-READ-LEGACY-INPUT' TO PV-ABEND-PARAGRAPH.         02240000
022500                                                                  02250000
022600     INITIALIZE PV-LEGACY-INPUT.                                  02260000
022700                                                                  02270000
022800     READ LEGACY-FILE                                             02280000
022900          INTO PV-LEGACY-INPUT                                    02290000
023000            AT END                                                02300000
023100               SET PS-EOF-INPUT2-YES TO TRUE                      02310000
023200     END-READ.                                                    02320000
023300                                                                  02330000
023400     IF PS-EOF-INPUT2-YES                                         02340000
023500        MOVE PV-ALL-NINES TO XL018-PO-NBR OF PV-LEGACY-INPUT      02350000
023600                             XL018-SKU-NBR OF PV-LEGACY-INPUT     02360000
023700     ELSE                                                         02370000
023800        ADD +1 TO PV-RECORDS-READ-2                               02380000
023900     END-IF.                                                      02390000
024000                                                                  02400000
024100***************************************************************** 02410000
024200*  REFORMAT THE RMS PO EXTRACT FILE                               02420000
024300***************************************************************** 02430000
024400 2000-PROCESS-INPUT-FILE.                                         02440000
024500                                                                  02450000
024600     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       02460000
024700                                                                  02470000
024800     IF XL018-PO-NBR OF PV-RMS-INPUT  <                           02480000
024900        XL018-PO-NBR OF PV-LEGACY-INPUT                           02490000
025000*****************************                                     02500000
025100***  ON RMS NOT ON LEGACY                                         02510000
025200*****************************                                     02520000
025300          IF XL018-ORD-QTY   OF PV-RMS-INPUT  =                   02530000
025400                                             '00000000.0000' AND  02540000
025500             XL018-CNCLD-QTY OF PV-RMS-INPUT = '00000000.0000'    02550000
025600                PERFORM 1000-READ-RMS-INPUT                       02560000
025700          ELSE                                                    02570000
025800              ADD 1 TO PV-RECORDS-ON-RMS-ONLY                     02580000
025900              SET XL023-ON-RMS-ONLY TO TRUE                       02590000
026000              PERFORM 3400-WRITE-RMS-ERROR                        02600000
026100              PERFORM 1000-READ-RMS-INPUT                         02610000
026200          END-IF                                                  02620000
026300     ELSE                                                         02630000
026400         IF XL018-PO-NBR OF PV-RMS-INPUT  >                       02640000
026500            XL018-PO-NBR OF PV-LEGACY-INPUT                       02650000
026600*****************************                                     02660000
026700***   ON LEGACY NOT ON RMS                                        02670000
026800*****************************                                     02680000
026900             ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                   02690000
027000             SET XL023-ON-LEGACY-ONLY TO TRUE                     02700000
027100             PERFORM 4000-WRITE-LEGACY-ERROR                      02710000
027200             PERFORM 1100-READ-LEGACY-INPUT                       02720000
027300         ELSE                                                     02730000
027400*****************************                                     02740000
027500***  ON RMS AND ON LEGACY                                         02750000
027600*****************************                                     02760000
027700             PERFORM 2400-CHECK-KEY-VALUES                        02770000
027800         END-IF                                                   02780000
027900     END-IF.                                                      02790000
028000                                                                  02800000
028100****************************************************************  02810000
028200*    CHECK ALL THE KEY VALUES FOR MISMATCHES.                  *  02820000
028300*                                                              *  02830000
028400*                                                              *  02840000
028500****************************************************************  02850000
028600 2400-CHECK-KEY-VALUES.                                           02860000
028700                                                                  02870000
028800     MOVE '2400-CHECK-KEY-VALUES ' TO PV-ABEND-PARAGRAPH.         02880000
028900                                                                  02890000
029000     EVALUATE TRUE                                                02900000
029100         WHEN XL018-SKU-NBR OF PV-RMS-INPUT <                     02910000
029200              XL018-SKU-NBR OF PV-LEGACY-INPUT                    02920000
029300              IF XL018-ORD-QTY   OF PV-RMS-INPUT  =               02930000
029400                                              '00000000.0000' AND 02940000
029500                 XL018-CNCLD-QTY OF PV-RMS-INPUT = '00000000.0000'02950000
029600                  CONTINUE                                        02960000
029700              ELSE                                                02970000
029800                  ADD 1 TO PV-RECORDS-ON-RMS-ONLY                 02980000
029900                  SET XL023-ON-RMS-ONLY TO TRUE                   02990000
030000                  PERFORM 3400-WRITE-RMS-ERROR                    03000000
030100              END-IF                                              03010000
030200              PERFORM 1000-READ-RMS-INPUT                         03020000
030300                                                                  03030000
030400         WHEN XL018-SKU-NBR OF PV-RMS-INPUT >                     03040000
030500              XL018-SKU-NBR OF PV-LEGACY-INPUT                    03050000
030600              ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                  03060000
030700              SET XL023-ON-LEGACY-ONLY TO TRUE                    03070000
030800              PERFORM 4000-WRITE-LEGACY-ERROR                     03080000
030900              PERFORM 1100-READ-LEGACY-INPUT                      03090000
031000                                                                  03100000
031100         WHEN OTHER                                               03110000
031200              ADD 1 TO PV-RECORDS-ON-BOTH                         03120000
031300              IF XL018-DATA-AREA OF PV-RMS-INPUT    =             03130000
031400                 XL018-DATA-AREA OF PV-LEGACY-INPUT               03140000
031500                 PERFORM 1000-READ-RMS-INPUT                      03150000
031600                 PERFORM 1100-READ-LEGACY-INPUT                   03160000
031700              ELSE                                                03170000
031800*                ADD 1 TO PV-RECORDS-DATA-MISMATCH                03180000
031900                 SET XL023-ON-BOTH-RMS-LEGACY TO TRUE             03190000
032000                 PERFORM 3400-WRITE-RMS-ERROR                     03200000
032100                 PERFORM 4000-WRITE-LEGACY-ERROR                  03210000
032200                 PERFORM 1000-READ-RMS-INPUT                      03220000
032300                 PERFORM 1100-READ-LEGACY-INPUT                   03230000
032400              END-IF                                              03240000
032500                                                                  03250000
032600     END-EVALUATE.                                                03260000
032700                                                                  03270000
032800                                                                  03280000
032900***************************************************************** 03290000
033000*  WRITE A RMS RECORD TO THE ERROR FILE                           03300000
033100***************************************************************** 03310000
033200 3400-WRITE-RMS-ERROR.                                            03320000
033300                                                                  03330000
033400     SET XL023-XXT-PO-SKU   TO TRUE.                              03340000
033500     MOVE XL018-PO-NBR OF PV-RMS-INPUT   TO XL023-PO-SORT-KEY-PO. 03350000
033600     STRING XL018-SKU-NBR OF PV-RMS-INPUT                         03360000
033700            PC-TWENTY-BLANKS                                      03370000
033800            DELIMITED BY SIZE                                     03380000
033900            INTO XL023-PO-SORT-KEY-DATA.                          03390000
034000                                                                  03400000
034100     INITIALIZE XL023-PO-SKU.                                     03410000
034200                                                                  03420000
034300     MOVE XL018-PO-NBR OF PV-RMS-INPUT                            03430000
034400       TO XL023-SK-PO-NBR-RMS.                                    03440000
034500     MOVE XL018-SKU-NBR OF PV-RMS-INPUT                           03450000
034600       TO XL023-SK-SKU-NBR-RMS.                                   03460000
034700     MOVE XL018-UNT-COST-AMT OF PV-RMS-INPUT                      03470000
034800       TO XL023-SK-UNT-COST-AMT-RMS.                              03480000
034900     MOVE XL018-FRST-COST-AMT OF PV-RMS-INPUT                     03490000
035000       TO XL023-SK-FRST-COST-AMT-RMS.                             03500000
035001**?? MOVE XL018-VND-QTY OF PV-RMS-INPUT                           03500100
035002**??   TO XL023-SK-VND-QTY-RMS.                                   03500200
035003**GB 3/20/12                                                      03500300
035005     MOVE XL018-INPK-QTY OF PV-RMS-INPUT                          03500500
035006       TO XL023-SK-INPK-QTY-RMS.                                  03500600
035008     MOVE XL018-OTPK-QTY OF PV-RMS-INPUT                          03500800
035009       TO XL023-SK-OTPK-QTY-RMS.                                  03500900
035010     DISPLAY 'XL023-SK-INPK-QTY-RMS '  XL023-SK-INPK-QTY-RMS      03501003
035011     DISPLAY 'XL023-SK-OTPK-QTY-RMS '  XL023-SK-OTPK-QTY-RMS      03501103
035012**GB 3/20/12                                                      03501200
035013     MOVE XL018-PROMO-STRT-DTE OF PV-LEGACY-INPUT                 03501300
035014       TO XL023-SK-PROMO-STRT-DTE-RMS.                            03501400
035015**GB 05/9/14 PIC SKU BEG                                          03501507
035016***  COMMENT OUT AS PIC-SKU-IND DOES NOT EXIST IN RMS13           03501607
035020***  MOVE XL018-PIC-SKU-IND OF PV-RMS-INPUT                       03502007
035030***    TO XL023-SK-PIC-SKU-IND-RMS.                               03503007
035031**GB 05/9/14 PIC SKU END                                          03503107
035040     MOVE XL018-UNT-RTL-AMT   OF PV-RMS-INPUT TO                  03504000
035050                       XL023-SK-UNT-RTL-AMT-RMS.                  03505000
035060     IF XL018-GP-RTL-QTY  OF PV-RMS-INPUT NUMERIC                 03506000
035070         MOVE  XL018-GP-RTL-QTY OF PV-RMS-INPUT  TO               03507000
035080                         XL023-SK-GP-RTL-QTY-RMS                  03508000
035090     ELSE                                                         03509000
035100         MOVE ZEROES TO  XL023-SK-GP-RTL-QTY-RMS                  03510000
035200     END-IF.                                                      03520000
035300**?? MOVE XL018-ORIG-ORD-QTY OF PV-RMS-INPUT                      03530000
035400**??   TO XL023-SK-ORIG-ORD-QTY-RMS.                              03540000
035500     IF XL018-GP-RTL-AMT  OF PV-RMS-INPUT(1:7) NUMERIC AND        03550000
035600        XL018-GP-RTL-AMT  OF PV-RMS-INPUT(9:2) NUMERIC            03560000
035700         MOVE XL018-GP-RTL-AMT    OF PV-RMS-INPUT TO              03570000
035800                               XL023-SK-GP-RTL-AMT-RMS            03580000
035900     ELSE                                                         03590000
036000         MOVE ZEROES TO        XL023-SK-GP-RTL-AMT-RMS            03600000
036100     END-IF.                                                      03610000
036200     IF XL018-ORD-QTY OF PV-RMS-INPUT(01:8) NUMERIC AND           03620000
036300        XL018-ORD-QTY OF PV-RMS-INPUT(10:4) NUMERIC               03630000
036400         MOVE XL018-ORD-QTY OF PV-RMS-INPUT                       03640000
036500                     TO XL023-SK-ORD-QTY-RMS                      03650000
036600     ELSE                                                         03660000
036700         MOVE ZEROES TO XL023-SK-ORD-QTY-RMS                      03670000
036800     END-IF.                                                      03680000
036900     IF XL018-CNCLD-QTY OF PV-RMS-INPUT(01:8) NUMERIC AND         03690000
037000        XL018-CNCLD-QTY OF PV-RMS-INPUT(10:4) NUMERIC             03700000
037100         MOVE XL018-CNCLD-QTY OF PV-RMS-INPUT                     03710000
037200                      TO XL023-SK-CNCLD-QTY-RMS                   03720000
037300     ELSE                                                         03730000
037400         MOVE ZEROES  TO XL023-SK-CNCLD-QTY-RMS                   03740000
037500     END-IF.                                                      03750000
037600     MOVE XL018-PK-SKU-IND OF PV-RMS-INPUT                        03760000
037700       TO XL023-SK-PK-SKU-IND-RMS.                                03770000
037800     MOVE FUNCTION UPPER-CASE (XL018-PK-SKU-DESC OF PV-RMS-INPUT) 03780000
037900       TO XL023-SK-PK-SKU-DESC-RMS.                               03790000
038000                                                                  03800000
038100     IF XL023-ON-BOTH-RMS-LEGACY                                  03810000
038200         CONTINUE                                                 03820000
038300     ELSE                                                         03830000
038400         WRITE ERROR-RECORD FROM  PV-ERROR-OUTPUT                 03840000
038500         ADD +1              TO   PV-RECORDS-WRITTEN              03850000
038600     END-IF.                                                      03860000
038700                                                                  03870000
038800***************************************************************** 03880000
038900*  WRITE A LEGACY RECORD TO THE ERROR FILE                        03890000
039000***************************************************************** 03900000
039100 4000-WRITE-LEGACY-ERROR.                                         03910000
039200                                                                  03920000
039300     IF XL023-ON-BOTH-RMS-LEGACY                                  03930000
039400         CONTINUE                                                 03940000
039500     ELSE                                                         03950000
039600         SET XL023-XXT-PO-SKU   TO TRUE                           03960000
039700         MOVE XL018-PO-NBR OF PV-LEGACY-INPUT   TO                03970000
039800                              XL023-PO-SORT-KEY-PO                03980000
039900         STRING XL018-SKU-NBR OF PV-LEGACY-INPUT                  03990000
040000                PC-TWENTY-BLANKS                                  04000000
040100                DELIMITED BY SIZE                                 04010000
040200                INTO XL023-PO-SORT-KEY-DATA                       04020000
040300                                                                  04030000
040400****     INITIALIZE XL023-COMPARE-DATA-AREA                       04040000
040500         INITIALIZE XL023-PO-SKU                                  04050000
040600     END-IF.                                                      04060000
040700                                                                  04070000
040800     MOVE XL018-PO-NBR OF PV-LEGACY-INPUT                         04080000
040900       TO XL023-SK-PO-NBR-LGCY.                                   04090000
041000     MOVE XL018-SKU-NBR OF PV-LEGACY-INPUT                        04100000
041100       TO XL023-SK-SKU-NBR-LGCY.                                  04110000
041200     MOVE XL018-UNT-COST-AMT OF PV-LEGACY-INPUT                   04120000
041300       TO XL023-SK-UNT-COST-AMT-LGCY.                             04130000
041400     MOVE XL018-FRST-COST-AMT OF PV-LEGACY-INPUT                  04140000
041500       TO XL023-SK-FRST-COST-AMT-LGCY.                            04150000
041600     MOVE XL018-GP-RTL-AMT    OF PV-LEGACY-INPUT                  04160000
041700       TO XL023-SK-GP-RTL-AMT-LGCY.                               04170000
041800     MOVE XL018-GP-RTL-QTY    OF PV-LEGACY-INPUT                  04180000
041900       TO XL023-SK-GP-RTL-QTY-LGCY.                               04190000
042000**?? MOVE XL018-VND-QTY OF PV-LEGACY-INPUT                        04200000
042100**??   TO XL023-SK-VND-QTY-LGCY.                                  04210000
042200** GB 3/20/12                                                     04220000
042300     MOVE XL018-INPK-QTY OF PV-LEGACY-INPUT                       04230000
042400       TO XL023-SK-INPK-QTY-LGCY.                                 04240000
042500     MOVE XL018-OTPK-QTY OF PV-LEGACY-INPUT                       04250000
042600       TO XL023-SK-OTPK-QTY-LGCY.                                 04260000
042610     DISPLAY 'XL023-SK-INPK-QTY-LGCY'  XL023-SK-INPK-QTY-LGCY     04261003
042620     DISPLAY 'XL023-SK-OTPK-QTY-LGCY'  XL023-SK-OTPK-QTY-LGCY     04262003
042700** GB 3/20/12                                                     04270000
042800     MOVE XL018-PROMO-STRT-DTE OF PV-LEGACY-INPUT                 04280000
042900       TO XL023-SK-PROMO-STRT-DTE-LGCY.                           04290000
043000*GB  MOVE XL018-PIC-SKU-IND OF PV-LEGACY-INPUT                    04300008
043100*GB    TO XL023-SK-PIC-SKU-IND-LGCY.                              04310008
043200     MOVE XL018-UNT-RTL-AMT OF PV-LEGACY-INPUT                    04320000
043300       TO XL023-SK-UNT-RTL-AMT-LGCY.                              04330000
043400**?? MOVE XL018-ORIG-ORD-QTY OF PV-LEGACY-INPUT                   04340000
043500**??   TO XL023-SK-ORIG-ORD-QTY-LGCY.                             04350000
043600     MOVE XL018-ORD-QTY OF PV-LEGACY-INPUT                        04360000
043700       TO XL023-SK-ORD-QTY-LGCY.                                  04370000
043800     MOVE XL018-CNCLD-QTY OF PV-LEGACY-INPUT                      04380000
043900       TO XL023-SK-CNCLD-QTY-LGCY.                                04390000
044000     MOVE XL018-PK-SKU-IND OF PV-LEGACY-INPUT                     04400000
044100       TO XL023-SK-PK-SKU-IND-LGCY.                               04410000
044200     MOVE FUNCTION UPPER-CASE (XL018-PK-SKU-DESC OF               04420000
044300                                                  PV-LEGACY-INPUT)04430000
044400       TO XL023-SK-PK-SKU-DESC-LGCY.                              04440000
044500                                                                  04450000
044600     IF XL023-ON-BOTH-RMS-LEGACY                                  04460000
044700         PERFORM 4300-COMPARE                                     04470000
044800     ELSE                                                         04480000
044900         WRITE ERROR-RECORD FROM  PV-ERROR-OUTPUT                 04490000
045000         ADD +1              TO   PV-RECORDS-WRITTEN              04500000
045100     END-IF.                                                      04510000
045200                                                                  04520000
045300***************************************************************** 04530000
045400*  COMPARE FIELDS TO FIND DISCREPANCIES.                          04540000
045500***************************************************************** 04550000
045600 4300-COMPARE.                                                    04560000
045700                                                                  04570000
045800     IF XL023-SK-PO-NBR-RMS  NOT = XL023-SK-PO-NBR-LGCY           04580000
045900         MOVE '*'  TO  XL023-SK-PO-NBR-DIFF                       04590000
046000     END-IF.                                                      04600000
046100     IF XL023-SK-SKU-NBR-RMS NOT = XL023-SK-SKU-NBR-LGCY          04610000
046200         MOVE '*'  TO XL023-SK-SKU-NBR-DIFF                       04620000
046300     END-IF.                                                      04630000
046400                                                                  04640000
046500     IF XL023-SK-UNT-RTL-AMT-LGCY = '0000000.00'                  04650000
046600         MOVE ' '  TO  XL023-SK-UNT-RTL-AMT-DIFF                  04660000
046700     ELSE                                                         04670000
046800         IF XL023-SK-UNT-RTL-AMT-RMS      NOT =                   04680000
046900            XL023-SK-UNT-RTL-AMT-LGCY                             04690000
047000               MOVE '*'  TO  XL023-SK-UNT-RTL-AMT-DIFF            04700000
047100         END-IF                                                   04710000
047200     END-IF.                                                      04720000
047300                                                                  04730000
047400     IF XL023-SK-GP-RTL-AMT-LGCY  = '0000000.00'                  04740000
047500         MOVE ' '  TO  XL023-SK-GP-RTL-AMT-DIFF                   04750000
047600     ELSE                                                         04760000
047700         IF XL023-SK-GP-RTL-AMT-RMS       NOT =                   04770000
047800            XL023-SK-GP-RTL-AMT-LGCY                              04780000
047900               MOVE '*'  TO  XL023-SK-GP-RTL-AMT-DIFF             04790000
048000         END-IF                                                   04800000
048100     END-IF.                                                      04810000
048200                                                                  04820000
048300     IF XL023-SK-GP-RTL-QTY-LGCY = '0000000.00'                   04830000
048400         MOVE ' '  TO  XL023-SK-GP-RTL-QTY-DIFF                   04840000
048500     ELSE                                                         04850000
048600         IF XL023-SK-GP-RTL-QTY-RMS       NOT =                   04860000
048700            XL023-SK-GP-RTL-QTY-LGCY                              04870000
048800               MOVE '*'  TO  XL023-SK-GP-RTL-QTY-DIFF             04880000
048900         END-IF                                                   04890000
049000     END-IF.                                                      04900000
049100                                                                  04910000
049200     IF XL023-SK-UNT-COST-AMT-LGCY = '0000000000000000.0000'      04920000
049300         MOVE ' '  TO XL023-SK-UNT-COST-AMT-DIFF                  04930000
049400     ELSE                                                         04940000
049500         IF XL023-SK-UNT-COST-AMT-RMS NOT =                       04950000
049600                                 XL023-SK-UNT-COST-AMT-LGCY       04960000
049700             MOVE '*'  TO XL023-SK-UNT-COST-AMT-DIFF              04970000
049800         END-IF                                                   04980000
049900     END-IF.                                                      04990000
050000     IF XL023-SK-FRST-COST-AMT-LGCY = '0000000000000000.0000'     05000000
050100         MOVE ' '  TO XL023-SK-FRST-COST-AMT-DIFF                 05010000
050200     ELSE                                                         05020000
050300         IF XL023-SK-FRST-COST-AMT-RMS  NOT =                     05030000
050400                                XL023-SK-FRST-COST-AMT-LGCY       05040000
050500             MOVE '*'  TO XL023-SK-FRST-COST-AMT-DIFF             05050000
050600         END-IF                                                   05060000
050700     END-IF.                                                      05070000
050800**GB 3/20                                                         05080000
050900**?? IF XL023-SK-VND-QTY-RMS  NOT = XL023-SK-VND-QTY-LGCY         05090002
051000**??     MOVE '*'  TO XL023-SK-VND-QTY-DIFF                       05100002
051100**?? END-IF.                                                      05110002
051200     IF XL023-SK-INPK-QTY-RMS NOT = XL023-SK-INPK-QTY-LGCY        05120000
051300         MOVE '*'  TO XL023-SK-INPK-QTY-DIFF                      05130000
051400     END-IF.                                                      05140000
051410     IF XL023-SK-OTPK-QTY-RMS NOT = XL023-SK-OTPK-QTY-LGCY        05141002
051420         MOVE '*'  TO XL023-SK-OTPK-QTY-DIFF                      05142002
051430     END-IF.                                                      05143002
051500**GB 3/20                                                         05150000
051600     IF XL023-SK-PROMO-STRT-DTE-RMS  NOT =                        05160000
051700                               XL023-SK-PROMO-STRT-DTE-LGCY       05170000
051800         MOVE '*'  TO XL023-SK-PROMO-STRT-DTE-DIFF                05180000
051900     END-IF.                                                      05190000
051910**GB 05/9/14 PIC SKU BEG                                          05191007
051920***  COMMENT OUT AS PIC-SKU-IND DOES NOT EXIST IN RMS13           05192007
052000*    IF XL023-SK-PIC-SKU-IND-RMS = 'N' AND                        05200007
052100*                           XL023-SK-PIC-SKU-IND-LGCY = ' '       05210007
052200         MOVE ' '  TO XL023-SK-PIC-SKU-IND-DIFF                   05220007
052300*    ELSE                                                         05230007
052400*        IF XL023-SK-PIC-SKU-IND-RMS  NOT =                       05240007
052500*                                 XL023-SK-PIC-SKU-IND-LGCY       05250007
052600*            MOVE '*'  TO XL023-SK-PIC-SKU-IND-DIFF               05260007
052700*        END-IF                                                   05270007
052800*    END-IF.                                                      05280007
052810***  COMMENT OUT AS PIC-SKU-IND DOES NOT EXIST IN RMS13           05281007
052820**GB 05/9/14 PIC SKU END                                          05282007
052900**?? IF XL023-SK-ORIG-ORD-QTY-RMS  NOT =                          05290000
053000**??                         XL023-SK-ORIG-ORD-QTY-LGCY           05300000
053100**??     MOVE '*'  TO XL023-SK-ORIG-ORD-QTY-DIFF                  05310000
053200**?? END-IF.                                                      05320000
053300*                                                                 05330000
053400*THIS IS A SHORT TERM SOLUTION TO TRY AND CLEAN UP THE DATA       05340000
053500*INTEGRITY REPORT OF NON-ISSUES.  8/5 DEANNA BRANTNER             05350000
053600*                                                                 05360000
053700*DMB IF XL023-SK-ORD-QTY-RMS  NOT =   XL023-SK-ORD-QTY-LGCY       05370000
053800*DMB     MOVE '*'  TO XL023-SK-ORD-QTY-DIFF                       05380000
053900*DMB END-IF.                                                      05390000
054000*DMB IF XL023-SK-CNCLD-QTY-RMS  NOT =                             05400000
054100*DMB                                XL023-SK-CNCLD-QTY-LGCY       05410000
054200*DMB     MOVE '*'  TO XL023-SK-CNCLD-QTY-DIFF                     05420000
054300*DMB END-IF.                                                      05430000
054400     MOVE 8                           TO DP010I-MAXIMUM-DIGITS.   05440000
054500     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS. 05450000
054600     MOVE XL023-SK-ORD-QTY-RMS        TO PV-WORK-QTY.             05460000
054700     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD.   05470000
054800     PERFORM 5000-NUMERIC-EDIT                                    05480000
054900     MOVE DP010I-NUMERIC-FIELD        TO PC-ORD-QTY-AMT-RMS.      05490000
055000     MOVE 8                           TO DP010I-MAXIMUM-DIGITS.   05500000
055100     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS. 05510000
055200     MOVE XL023-SK-CNCLD-QTY-RMS      TO PV-WORK-QTY.             05520000
055300     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD.   05530000
055400     PERFORM 5000-NUMERIC-EDIT                                    05540000
055500     MOVE DP010I-NUMERIC-FIELD        TO PC-CNCLD-QTY-AMT-RMS.    05550000
055600     MOVE 8                           TO DP010I-MAXIMUM-DIGITS.   05560000
055700     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS. 05570000
055800     MOVE XL023-SK-ORD-QTY-LGCY       TO PV-WORK-QTY.             05580000
055900     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD.   05590000
056000     PERFORM 5000-NUMERIC-EDIT                                    05600000
056100     MOVE DP010I-NUMERIC-FIELD        TO PC-ORD-QTY-AMT-LGCY.     05610000
056200     MOVE 8                           TO DP010I-MAXIMUM-DIGITS.   05620000
056300     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS. 05630000
056400     MOVE XL023-SK-CNCLD-QTY-LGCY     TO PV-WORK-QTY.             05640000
056500     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD.   05650000
056600     PERFORM 5000-NUMERIC-EDIT                                    05660000
056700     MOVE DP010I-NUMERIC-FIELD        TO PC-CNCLD-QTY-AMT-LGCY.   05670000
056800     COMPUTE PC-ORD-CNCLD-QTY-RMS  = PC-ORD-QTY-AMT-RMS +         05680000
056900                                     PC-CNCLD-QTY-AMT-RMS         05690000
057000     COMPUTE PC-ORD-CNCLD-QTY-LGCY = PC-ORD-QTY-AMT-LGCY +        05700000
057100                                     PC-CNCLD-QTY-AMT-LGCY        05710000
057200     IF PC-ORD-CNCLD-QTY-RMS  NOT =  PC-ORD-CNCLD-QTY-LGCY        05720000
057300         MOVE '*'  TO XL023-SK-ORD-QTY-DIFF                       05730000
057400         MOVE '*'  TO XL023-SK-CNCLD-QTY-DIFF                     05740000
057500     END-IF.                                                      05750000
057600     INITIALIZE PC-TOT-QTY.                                       05760000
057700*DMB-END                                                          05770000
057800     IF XL023-SK-PK-SKU-IND-RMS  NOT =                            05780000
057900                                   XL023-SK-PK-SKU-IND-LGCY       05790000
058000         MOVE '*'  TO XL023-SK-PK-SKU-IND-DIFF                    05800000
058100     END-IF.                                                      05810000
058200     IF XL023-SK-PK-SKU-DESC-RMS(1:3) = '   '                     05820000
058300         MOVE XL023-SK-PK-SKU-DESC-RMS (4:37) TO                  05830000
058400                             XL023-SK-PK-SKU-DESC-RMS(1:40)       05840000
058500     END-IF.                                                      05850000
058600     IF XL023-SK-PK-SKU-DESC-RMS(1:2) = '  '                      05860000
058700         MOVE XL023-SK-PK-SKU-DESC-RMS (3:38) TO                  05870000
058800                             XL023-SK-PK-SKU-DESC-RMS(1:40)       05880000
058900     END-IF.                                                      05890000
059000     IF XL023-SK-PK-SKU-DESC-RMS(1:1) = ' '                       05900000
059100         MOVE XL023-SK-PK-SKU-DESC-RMS (2:39) TO                  05910000
059200                             XL023-SK-PK-SKU-DESC-RMS(1:40)       05920000
059300     END-IF.                                                      05930000
059400     IF XL023-SK-PK-SKU-DESC-LGCY(1:3) = '   '                    05940000
059500         MOVE XL023-SK-PK-SKU-DESC-LGCY (4:37) TO                 05950000
059600                             XL023-SK-PK-SKU-DESC-LGCY(1:40)      05960000
059700     END-IF.                                                      05970000
059800     IF XL023-SK-PK-SKU-DESC-LGCY(1:2) = '  '                     05980000
059900         MOVE XL023-SK-PK-SKU-DESC-LGCY (3:38) TO                 05990000
060000                             XL023-SK-PK-SKU-DESC-LGCY(1:40)      06000000
060100     END-IF.                                                      06010000
060200     IF XL023-SK-PK-SKU-DESC-LGCY(1:1) = ' '                      06020000
060300         MOVE XL023-SK-PK-SKU-DESC-LGCY (2:39) TO                 06030000
060400                             XL023-SK-PK-SKU-DESC-LGCY(1:40)      06040000
060500     END-IF.                                                      06050000
060600     IF XL023-SK-PK-SKU-DESC-RMS  NOT =                           06060000
060700                                   XL023-SK-PK-SKU-DESC-LGCY      06070000
060800         MOVE '*'  TO XL023-SK-PK-SKU-DESC-DIFF                   06080000
060900     END-IF.                                                      06090000
061000**?? IF XL023-SK-DC-ORD-MULT-QTY-RMS  NOT =                       06100000
061100**??                           XL023-SK-DC-ORD-MULT-QTY-LGCY      06110000
061200**??     MOVE '*'  TO XL023-SK-DC-ORD-MULT-QTY-DIFF               06120000
061300**?? END-IF.                                                      06130000
061400         IF  XL023-SK-PO-NBR-DIFF         = '*' OR                06140000
061500             XL023-SK-SKU-NBR-DIFF        = '*' OR                06150000
061600             XL023-SK-UNT-RTL-AMT-DIFF    = '*' OR                06160000
061700             XL023-SK-GP-RTL-AMT-DIFF     = '*' OR                06170000
061800             XL023-SK-GP-RTL-QTY-DIFF     = '*' OR                06180000
061900             XL023-SK-UNT-COST-AMT-DIFF   = '*' OR                06190000
062000             XL023-SK-FRST-COST-AMT-DIFF  = '*' OR                06200000
062100             XL023-SK-PROMO-STRT-DTE-DIFF = '*' OR                06210000
062200**           XL023-SK-PIC-SKU-IND-DIFF    = '*' OR                06220009
062300             XL023-SK-ORD-QTY-DIFF        = '*' OR                06230000
062400             XL023-SK-CNCLD-QTY-DIFF      = '*' OR                06240000
062500             XL023-SK-PK-SKU-IND-DIFF     = '*' OR                06250000
062600             XL023-SK-PK-SKU-DESC-DIFF    = '*' OR                06260005
062610             XL023-SK-INPK-QTY-DIFF       = '*' OR                06261005
062620             XL023-SK-OTPK-QTY-DIFF       = '*'                   06262005
062700                ADD 1 TO PV-RECORDS-DATA-MISMATCH                 06270000
062800                WRITE ERROR-RECORD FROM PV-ERROR-OUTPUT           06280000
062900                ADD +1 TO PV-RECORDS-WRITTEN                      06290000
063000*               SET SWITCH FOR E-MAIL NOTIFICATION OF LEGACY ERROR06300000
063100*               SET PS-EMAIL-YES       TO TRUE                    06310000
063200     END-IF.                                                      06320000
063300*************************************                             06330000
063400* NUMERIC EDIT ROUTINE.                                           06340000
063500*************************************                             06350000
063600 5000-NUMERIC-EDIT.                                               06360000
063700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      06370000
063800     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06380000
063900          USING DP010I-NUMERIC-EDIT-AREA                          06390000
064000     IF  DP010I-ERROR-DETECTED                                    06400000
064100         MOVE ZEROES    TO PV-WORK-QTY                            06410000
064200     END-IF.                                                      06420000
064300                                                                  06430000
