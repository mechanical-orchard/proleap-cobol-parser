000100 IDENTIFICATION DIVISION.                                                 
000200 TITLE 'DETAIL RECORD REPORT FOR IMPORT ORDERS'.                          
000300 PROGRAM-ID.             TRKRP009.                                        
000400 AUTHOR.                 MARGARET MORRISON                                
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000600 DATE-WRITTEN            OCTOBER, 1997.                                   
000700 DATE-COMPILED.                                                           
000900*****************************************************************         
001100*  THIS PROGRAM CREATES A DETAIL REPORT FROM AN EXTRACT SHOWING *         
001200*  RECORDS THAT HAVE BEEN TRANSMITTED OR RETRANSMITTED TO       *         
001300*  DECONSOLIDATOR.  THE EXTRACT TABLE IS CREATED IN TRKUP005 AND*         
001400*  TRKUP006.                                                    *         
001600*****************************************************************         
001700 ENVIRONMENT DIVISION.                                                    
001800                                                                          
001900 CONFIGURATION SECTION.                                                   
002000                                                                          
002100 SOURCE-COMPUTER.        IBM-3090.                                        
002200 OBJECT-COMPUTER.        IBM-3090.                                        
002300                                                                          
002400 INPUT-OUTPUT SECTION.                                                    
002500                                                                          
002600 FILE-CONTROL.                                                            
002700                                                                          
002800     SELECT TR020-REPORT-EXTRACT-FILE                                     
002900         ASSIGN TO INP01.                                                 
003000                                                                          
003100     SELECT REPORT-FILE                                                   
003200         ASSIGN TO RPT01.                                                 
003300                                                                          
003500******************************************************************        
003600 DATA DIVISION.                                                           
003700******************************************************************        
003800                                                                          
003900 FILE SECTION.                                                            
004000                                                                          
004100 FD  TR020-REPORT-EXTRACT-FILE                                            
004200     RECORDING MODE IS F                                                  
004300     LABEL RECORDS ARE STANDARD                                           
004400     BLOCK CONTAINS 0 RECORDS.                                            
004500                                                                          
004610 01  TR020-REPORT-EXTRACT-RECORD         PIC  X(508).                     
004700                                                                          
004800 FD  REPORT-FILE                                                          
004900     RECORDING MODE IS F                                                  
005000     BLOCK CONTAINS 0  RECORDS.                                           
005100 01  REPORT-RECORD                       PIC  X(132).                     
005200                                                                          
005300 WORKING-STORAGE SECTION.                                                 
005400                                                                          
005500 01  FILLER.                                                              
005600     05  FILLER                          PIC  X(36)  VALUE                
005700         ' ***** WORKING STORAGE PGM=TRKRP009 '.                          
005800     05  PGM-COMPILED                    PIC  X(20)  VALUE SPACES.        
005900     05  FILLER                          PIC  X(10)  VALUE                
006000         ' LOCATION='.                                                    
006100     05  PGM-LOCATION                    PIC  X(04)  VALUE SPACES.        
006200     05  FILLER                          PIC  X(06)  VALUE                
006300         ' *****'.                                                        
006400 EJECT                                                                    
006500 01  PROGRAM-SWITCHES.                                                    
006600     05  PS-EOF-IND                      PIC  X(01)  VALUE 'Y'.           
006700         88  PS-EOF                                  VALUE 'N'.           
006800     05  PS-TR020-REPORT-TYPE            PIC  X(01)  VALUE SPACE.         
006900         88  PS-TR020-XMIT-RPT                       VALUE 'T'.           
007000         88  PS-TR020-REXMIT-RPT                     VALUE 'R'.           
007100     05  PS-SPEC-INSTR-1-IND             PIC  X(01)  VALUE 'Y'.           
007200         88  PS-SPEC-INSTR-1                         VALUE 'Y'.           
007300         88  PS-SPEC-INSTR-1-NO                      VALUE 'N'.           
007400     05  PS-SPEC-INSTR-L2-IND            PIC  X(01)  VALUE 'N'.           
007500         88  PS-SPEC-INSTR-L2                        VALUE 'Y'.           
007600         88  PS-SPEC-INSTR-L2-NO                     VALUE 'N'.           
007700     05  PS-PO-REC-DONE-IND              PIC  X(01)  VALUE 'N'.           
007800         88  PS-PO-REC-DONE                          VALUE 'Y'.           
007900         88  PS-PO-REC-NOT-DONE                      VALUE 'N'.           
008000     05  PS-NEED-BLANK-LINE-SW           PIC  X(01)  VALUE 'N'.           
008100         88  PS-NEED-BLANK-LINE                      VALUE 'Y'.           
008200         88  PS-NEED-BLANK-LINE-NO                   VALUE 'N'.           
008210     05  PS-THIS-IS-A-CMN-SW             PIC  X(01)  VALUE 'N'.           
008220         88 PS-THIS-IS-A-CMN                         VALUE 'Y'.           
008230         88 PS-THIS-IS-A-CMN-NO                      VALUE 'N'.           
008240     05  PS-THIS-IS-A-CON-SW             PIC  X(01)  VALUE 'N'.           
008250         88 PS-THIS-IS-A-CON                         VALUE 'Y'.           
008260         88 PS-THIS-IS-A-CON-NO                      VALUE 'N'.           
008270     05  PS-THIS-IS-A-PACK-SW            PIC  X(01)  VALUE 'N'.           
008280         88 PS-THIS-IS-A-PACK                        VALUE 'Y'.           
008290         88 PS-THIS-IS-A-PACK-NO                     VALUE 'N'.           
008291     05  PS-THIS-IS-FIRST-SEAL-SW        PIC  X(01)  VALUE 'N'.           
008292         88 PS-THIS-IS-FIRST-SEAL                    VALUE 'Y'.           
008293         88 PS-THIS-IS-FIRST-SEAL-NO                 VALUE 'N'.           
008294     05  PS-THIS-IS-FIRST-CART-SW        PIC  X(01)  VALUE 'N'.           
008295         88 PS-THIS-IS-FIRST-CART                    VALUE 'Y'.           
008296         88 PS-THIS-IS-FIRST-CART-NO                 VALUE 'N'.           
008300                                                                          
008400 01  PC-CONSTANTS.                                                        
008500     05  PC-CURRENT-PROGRAM-NAME       PIC  X(08)  VALUE                  
008600                                                   'TRKRP009'.            
008700     05  PC-REPORT-NBR-1               PIC  9(01)  VALUE 1.               
008800     05  PC-REPORT-NBR-2               PIC  9(01)  VALUE 2.               
008900     05  PC-PO                         PIC  X(06)  VALUE '10PO 0'.        
009000     05  PC-INS                        PIC  X(06)  VALUE '20INS0'.        
009100     05  PC-CON                        PIC  X(06)  VALUE '30CON0'.        
009110     05  PC-CMN                        PIC  X(06)  VALUE '30CMN0'.        
009200     05  PC-PCK                        PIC  X(06)  VALUE '40PCK0'.        
009300     05  PC-PDC                        PIC  X(06)  VALUE '50PDC0'.        
009301     05  PC-PCT                        PIC  X(06)  VALUE '50PDC1'.        
009310     05  PC-UPC                        PIC  X(06)  VALUE '60UPC0'.        
009320     05  PC-DC                         PIC  X(06)  VALUE '70DC 0'.        
009322     05  PC-DCT                        PIC  X(06)  VALUE '70DC 1'.        
009323     05  PC-SEA                        PIC  X(06)  VALUE '80SEA0'.        
009330     05  PC-CON-DETAIL                 PIC  X(03)  VALUE 'CON'.           
009340     05  PC-CMN-DETAIL                 PIC  X(03)  VALUE 'CMN'.           
009341     05  PC-CON-QTY-HDR                PIC  X(11)  VALUE                  
009342                                                   'ORDER QTY: '.         
009343     05  PC-CMN-QTY-HDR                PIC  X(11)  VALUE                  
009344                                                   'SHPT QTY:  '.         
009345     05  PC-CON-CARTONS-HDR            PIC  X(12)  VALUE                  
009346         '     CARTONS'.                                                  
009348     05  PC-CMN-CARTONS-HDR            PIC  X(12)  VALUE                  
009350         'SHPT CARTONS'.                                                  
009351     05  PC-CON-UNITS-HDR              PIC  X(23)  VALUE                  
009352         '             UNITS     '.                                       
009354     05  PC-CMN-UNITS-HDR              PIC  X(23)  VALUE                  
009355         'SHPT CTNS X UNTS IN CTN'.                                       
009356     05  PC-ORDERED                    PIC  X(09)  VALUE                  
009360                                                   '(ORDERED)'.           
009370     05  PC-SHIPPED                    PIC  X(09)  VALUE                  
009380                                                   '(SHIPPED)'.           
009400     05  PC-N                          PIC  X(01)  VALUE 'N'.             
009500     05  PC-R                          PIC  X(01)  VALUE 'R'.             
009600     05  PC-S                          PIC  X(01)  VALUE 'S'.             
009700     05  PC-Y                          PIC  X(01)  VALUE 'Y'.             
009710     05  PC-NA                         PIC  X(02)  VALUE 'NA'.            
009800     05  PC-MAX-RETRIES                PIC S9(04)  VALUE +3               
009900                                                   COMP.                  
009910     05  PC-ZZZZZZ9                    PIC  ZZZZZZ9                       
009920                                                VALUE ZEROES.             
010000 EJECT                                                                    
010100                                                                          
010200 01  PV-VARIABLES.                                                        
010300     05  PV-PAGE-CNT-REXMIT              PIC S9(04)  VALUE ZEROS          
010400                                                     COMP-3.              
010500     05  PV-PAGE-CNT-XMIT                PIC S9(04)  VALUE ZEROS          
010600                                                     COMP-3.              
010700     05  PV-LINE-CNT                     PIC S9(04)  VALUE ZEROS          
010800                                                     COMP SYNC.           
010810     05  PV-SSCC-CNT                     PIC S9(04)  VALUE ZEROS          
010820                                                     COMP SYNC.           
010900     05  PV-SQL-CODE                     PIC  9(04)  VALUE ZEROS.         
011000     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE +0             
011100                                                     COMP SYNC.           
011110     05  PV-COMPARE-REC-TYP              PIC  X(03).                      
011130         88  PV-CMN-REC                              VALUE 'CMN'.         
011140         88  PV-CON-REC                              VALUE 'CON'.         
011141     05  PV-HOLD-PO-NBR-PCK              PIC  9(09)  VALUE ZEROES.        
011142     05  PV-HOLD-PACK-ID-PCK             PIC  9(08)  VALUE ZEROES.        
011200 EJECT                                                                    
011300                                                                          
011400 01  SAVE-FIELDS.                                                         
011500     05  SAVE-REPORT-TYPE                PIC  X(01)  VALUE SPACES.        
011600     05  SAVE-PROCESS-DATE               PIC  X(08)  VALUE SPACES.        
011710     05  SAVE-UPC-NBR                    PIC  9(15)  VALUE ZEROES.        
011711     05  SAVE-UPC-NBR-DC                 PIC  9(15)  VALUE ZEROES.        
011720     05  SAVE-PACK-ID                    PIC  9(08)  VALUE ZEROES.        
011730     05  SAVE-UPC-PACK-ID                PIC  9(08)  VALUE ZEROES.        
011800     05  SAVE-TR020-REC-TYPE.                                             
011900         10  SAVE-TR020-REC-TYPE-CDE.                                     
011910          15 FILLER                      PIC  X(05)  VALUE SPACES.        
011920          15 SAVE-TR020-SEC-REC-TYP      PIC  9(01)  VALUE ZERO.          
012000         10  SAVE-TR020-REPORT-TYPE      PIC  X(01)  VALUE SPACES.        
012100         10  SAVE-TR020-PROCESS-DTE      PIC  X(08)  VALUE SPACES.        
012200         10  FILLER                      PIC  X(494) VALUE SPACES.        
012300     05  SAVE-PO-CON-ONLY                PIC S9(09)  VALUE ZEROES         
012400                                                     COMP.                
012500                                                                          
012600 01  PV-MISC-FIELDS.                                                      
012700     05  PV-ABEND-CODE                   PIC S9(04)  VALUE ZEROES         
012800                                                     COMP SYNC.           
012900     05  PV-ABEND-PO-NBR                 PIC S9(09)  VALUE ZEROES         
013000                                                     COMP.                
013100     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACES.        
013200     05  PV-ERROR-MESSAGE-1              PIC  X(60)  VALUE SPACES.        
013300     05  PV-ERROR-MESSAGE-2              PIC  X(60)  VALUE SPACES.        
013400     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE.         
013500                                                                          
013600     05  PV-SPEC-INSTR-FORMAT.                                            
013700         10  PV-SPEC-INSTR-FORMAT-1      PIC  X(102) VALUE SPACES.        
013800         10  PV-SPEC-INSTR-FORMAT-2      PIC  X(48)  VALUE SPACES.        
013900                                                                          
014000     05  PV-CURR-DATE-YYMMDD.                                             
014100         10  PV-CURR-DATE-YY             PIC  9(02)  VALUE ZERO.          
014200         10  PV-CURR-DATE-MM             PIC  9(02)  VALUE ZERO.          
014300         10  PV-CURR-DATE-DD             PIC  9(02)  VALUE ZERO.          
014400                                                                          
014500     05  PV-CURR-TIME.                                                    
014600         10  PV-CURR-TIME-HH             PIC  9(02)  VALUE ZERO.          
014700         10  PV-CURR-TIME-MM             PIC  9(02)  VALUE ZERO.          
014800         10  PV-CURR-TIME-SSHH           PIC  9(04)  VALUE ZERO.          
014900                                                                          
015000 EJECT                                                                    
015100     COPY TRRD020.                                                        
015200 EJECT                                                                    
015300******************************************************************        
015400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.                       
015500******************************************************************        
015600     COPY DPWS132O.                                                       
015700                                                                          
015800 01  HEADING-LINES.                                                       
015900     05  HL1-HEADING-LINE1.                                               
016000         10  FILLER                      PIC  X(39)  VALUE SPACES.        
016100         10  FILLER                      PIC  X(54)  VALUE                
016200         'DECONSOLIDATOR RETRANSMISSION DETAIL FOR IMPORT ORDERS'.        
016300         10  FILLER                      PIC  X(39)  VALUE SPACES.        
016400                                                                          
016500     05 HL1-HEADING-LINE1A.                                               
016700         10 FILLER                       PIC  X(40)  VALUE SPACES.        
016800         10 FILLER                       PIC  X(52)  VALUE                
016900         'DECONSOLIDATOR TRANSMISSION DETAIL FOR IMPORT ORDERS'.          
017000         10 FILLER                       PIC  X(40)  VALUE SPACES.        
017100                                                                          
017200     05  HL2-HEADING-LINE2.                                               
017300         10 FILLER                       PIC  X(01)  VALUE SPACES.        
017400         10 FILLER                       PIC  X(52)  VALUE SPACES.        
017500         10 FILLER                       PIC  X(18)  VALUE                
017600             'PROCESSING DATE: '.                                         
017700         10 HL2-PROCESSING-MONTH         PIC  X(02)  VALUE SPACES.        
017800         10 HL2-PROCESSING-SLASH1        PIC  X(01)  VALUE '/'.           
017900         10 HL2-PROCESSING-DAY           PIC  X(02)  VALUE SPACES.        
018000         10 HL2-PROCESSING-SLASH2        PIC  X(01)  VALUE '/'.           
018100         10 HL2-PROCESSING-YEAR          PIC  X(02)  VALUE SPACES.        
018200         10 FILLER                       PIC  X(54)  VALUE SPACES.        
018300                                                                          
018400 01  DL1-DETAIL-LINE1.                                                    
018500     05  FILLER                          PIC  X(03)  VALUE SPACES.        
018600     05  FILLER                          PIC  X(16)  VALUE                
018700         'PURCHASE ORDER: '.                                              
018910     05  DL1-PO-NBR                      PIC  X(08)  VALUE SPACES.        
018911     05  FILLER                          PIC  X(11)  VALUE SPACES.        
018912     05  FILLER                          PIC  X(09)  VALUE                
018913         'PO TYPE: '.                                                     
018914     05  DL1-PO-TYPE                     PIC  X(02)  VALUE SPACES.        
018920     05  FILLER                          PIC  X(07)  VALUE SPACES.        
019000     05  FILLER                          PIC  X(08)  VALUE                
019100         'VENDOR: '.                                                      
019310     05  DL1-VENDOR                      PIC  X(32)  VALUE SPACES.        
019312     05  FILLER                          PIC  X(02)  VALUE SPACES.        
019313     05  FILLER                          PIC  X(09)  VALUE                
019314         'AD DATE: '.                                                     
019316     05  DL1-AD-DATE.                                                     
019317         10 DL1-AD-DATE-MM               PIC  X(02)  VALUE SPACES.        
019318         10 DL1-AD-DATE-SL1              PIC  X(01)  VALUE '/'.           
019319         10 DL1-AD-DATE-DD               PIC  X(02)  VALUE SPACES.        
019320         10 DL1-AD-DATE-SL2              PIC  X(01)  VALUE '/'.           
019321         10 DL1-AD-DATE-YY               PIC  X(02)  VALUE SPACES.        
019330     05  FILLER                          PIC  X(17)  VALUE SPACES.        
019400                                                                          
019500 01  DL1A-DETAIL-LINE1A.                                                  
019600     05  FILLER                          PIC  X(03)  VALUE SPACES.        
019700     05  FILLER                          PIC  X(16)  VALUE                
019800         'PURCHASE ORDER: '.                                              
019900     05  DL1A-PO-NBR                     PIC  X(08)  VALUE SPACES.        
020000     05  FILLER                          PIC  X(04)  VALUE SPACES.        
020100     05  FILLER                          PIC  X(11)  VALUE                
020200         '(CONTINUED)'.                                                   
020300     05  FILLER                          PIC  X(90)  VALUE SPACES.        
020400                                                                          
020500 01  DL1B-DETAIL-LINE1B.                                                  
020600     05  FILLER                          PIC  X(03)  VALUE SPACES.        
020700     05  FILLER                          PIC  X(16)  VALUE                
020800         'PURCHASE ORDER: '.                                              
020900     05  DL1B-PO-NBR                     PIC  X(08)  VALUE SPACES.        
021000     05  FILLER                          PIC  X(105) VALUE SPACES.        
021100                                                                          
021200 01  DL2-DETAIL-LINE2.                                                    
021300     05  FILLER                          PIC  X(08)  VALUE SPACES.        
021400     05  FILLER                          PIC  X(20)  VALUE                
021500         'DO NOT SHIP BEFORE: '.                                          
021600     05  DL2-DONT-SHIP-BEF-DTE.                                           
021700         10 DL2-DONT-SHIP-BEF-DTE-MM     PIC  X(02)  VALUE SPACES.        
021800         10 DL2-DONT-SHIP-BEF-DTE-SL1    PIC  X(01)  VALUE '/'.           
021900         10 DL2-DONT-SHIP-BEF-DTE-DD     PIC  X(02)  VALUE SPACES.        
022000         10 DL2-DONT-SHIP-BEF-DTE-SL2    PIC  X(01)  VALUE '/'.           
022100         10 DL2-DONT-SHIP-BEF-DTE-YY     PIC  X(02)  VALUE SPACES.        
022200     05  FILLER                          PIC  X(02)  VALUE SPACES.        
022300     05  FILLER                          PIC  X(08)  VALUE                
022400         'CANCEL: '.                                                      
022500     05  DL2-CANCEL-DTE.                                                  
022600         10 DL2-CANCEL-DTE-MM            PIC  X(02)  VALUE SPACES.        
022700         10 DL2-CANCEL-DTE-SL1           PIC  X(01)  VALUE '/'.           
022800         10 DL2-CANCEL-DTE-DD            PIC  X(02)  VALUE SPACES.        
022900         10 DL2-CANCEL-DTE-SL2           PIC  X(01)  VALUE '/'.           
023000         10 DL2-CANCEL-DTE-YY            PIC  X(02)  VALUE SPACES.        
023100     05  FILLER                          PIC  X(02)  VALUE SPACES.        
023200     05  FILLER                          PIC  X(13)  VALUE                
023300         'OPEN TO BUY: '.                                                 
023400     05  DL2-OTB.                                                         
023500         10  DL2-OTB-MM                  PIC  X(02)  VALUE SPACES.        
023600         10  DL2-OTB-SL1                 PIC  X(01)  VALUE '/'.           
023700         10  DL2-OTB-CC                  PIC  X(02)  VALUE SPACES.        
023800         10  DL2-OTB-YY                  PIC  X(02)  VALUE SPACES.        
023801     05  FILLER                          PIC  X(22)  VALUE SPACES.        
023810     05  FILLER                          PIC  X(19)  VALUE                
023820         'PO PACKAGING CODE: '.                                           
023830     05  DL2-PKGNG-CDE                   PIC  X(01)  VALUE SPACES.        
023900     05  FILLER                          PIC  X(14)  VALUE SPACES.        
024000                                                                          
024100 01  DL3-DETAIL-LINE3.                                                    
024200     05  FILLER                          PIC  X(08)  VALUE SPACES.        
024300     05  FILLER                          PIC  X(22)  VALUE                
024400         'SPECIAL INSTRUCTIONS: '.                                        
024500     05  DL3-SPECIAL-INSTR               PIC  X(102) VALUE SPACES.        
024600                                                                          
024700 01  DL3-DETAIL-LINE3A.                                                   
024800     05  FILLER                          PIC  X(08)  VALUE SPACES.        
024900     05         U                        PIC  X(22)  VALUE SPACES.        
025000     05  DL3-SPECIAL-INSTR-LONG          PIC  X(102) VALUE SPACES.        
025100                                                                          
025200 01  DL4-DETAIL-LINE4.                                                    
025300     05  FILLER                          PIC  X(08)  VALUE SPACES.        
025310     05  DL4-CONT-REC-TYP                PIC  X(03)  VALUE SPACES.        
025400     05  FILLER                          PIC  X(11)  VALUE                
025500         '-CONTAINER '.                                                   
025510     05  DL4-CONT-STATUS                 PIC  X(09)  VALUE SPACES.        
025530     05  FILLER                          PIC  X(02)  VALUE                
025540         ': '.                                                            
025600     05  DL4-CONT-ID                     PIC  X(22)  VALUE SPACES.        
025700     05  FILLER                          PIC  X(01)  VALUE SPACES.        
025800     05  FILLER                          PIC  X(08)  VALUE                
025900         'VESSEL: '.                                                      
026000     05  DL4-VESSEL                      PIC  X(10)  VALUE SPACES.        
026100     05  FILLER                          PIC  X(02)  VALUE SPACES.        
026200     05  FILLER                          PIC  X(08)  VALUE                
026300         'VOYAGE: '.                                                      
026400     05  DL4-VOYAGE                      PIC  X(10)  VALUE SPACES.        
026500     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026600     05  FILLER                          PIC  X(11)  VALUE                
026700         'CONT SIZE: '.                                                   
026800     05  DL4-CONT-SIZE                   PIC  X(05)  VALUE SPACES.        
026801     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026802     05  FILLER                          PIC  X(05)  VALUE                
026803         'REF: '.                                                         
026804     05  DL4-EXTL-REF-NBR                PIC  X(15)  VALUE SPACES.        
026805                                                                          
026806 01  DL5-DETAIL-LINE5.                                                    
026807     05  FILLER                          PIC  X(08)  VALUE SPACES.        
026808     05  FILLER                          PIC  X(05)  VALUE                
026809         'ETA: '.                                                         
026810     05  DL5-ETA-DATE.                                                    
026811         10 DL5-ETA-MM                   PIC  X(02)  VALUE SPACES.        
026812         10 DL5-ETA-SL1                  PIC  X(01)  VALUE '/'.           
026813         10 DL5-ETA-DD                   PIC  X(02)  VALUE SPACES.        
026814         10 DL5-ETA-SL2                  PIC  X(01)  VALUE '/'.           
026815         10 DL5-ETA-YY                   PIC  X(02)  VALUE SPACES.        
026816     05  FILLER                          PIC  X(03)  VALUE SPACES.        
026817     05  FILLER                          PIC  X(09)  VALUE                
026818         'CARTONS: '.                                                     
026819     05  DL5-CARTONS                     PIC  ZZZZZZZZZZZ9                
026820                                                     VALUE ZEROES.        
026821     05  FILLER                          PIC  X(11)  VALUE SPACES.        
026822     05  FILLER                          PIC  X(07)  VALUE                
026823         'UNITS: '.                                                       
026824     05  DL5-UNITS                       PIC  ZZZZZZZZZZZ9                
026825                                                     VALUE ZEROES.        
026826     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026827     05  FILLER                          PIC  X(11)  VALUE                
026828         'TRIP TYPE: '.                                                   
026829     05  DL5-TRIP-TYPE                   PIC  X(02)  VALUE SPACES.        
026830     05  FILLER                          PIC  X(06)  VALUE SPACES.        
026831     05  FILLER                          PIC  X(11)  VALUE                
026832         'POE CODE : '.                                                   
026833     05  DL5-POE-CDE                     PIC  X(04)  VALUE SPACES.        
026834     05  FILLER                          PIC  X(02)  VALUE SPACES.        
026835     05  FILLER                          PIC  X(11)  VALUE                
026836         'CARR SCAC: '.                                                   
026837     05  DL5-CARR-SCAC                   PIC  X(04)  VALUE SPACES.        
026838     05  FILLER                          PIC  X(05)  VALUE SPACES.        
026839                                                                          
026840 01  DL6-DETAIL-LINE6.                                                    
026841     05  FILLER                          PIC  X(08)  VALUE SPACES.        
026842     05  FILLER                          PIC  X(12)  VALUE                
026843         'PACK ID :   '.                                                  
026844     05  DL6-PACK-ID                     PIC  ZZZZZZZ9                    
026845                                                     VALUE ZEROES.        
026846     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026847     05  FILLER                          PIC  X(06)  VALUE                
026848         'DESC: '.                                                        
026849     05  DL6-PACK-DESC                   PIC  X(30)  VALUE SPACES.        
026850     05  FILLER                          PIC  X(02)  VALUE SPACES.        
026851     05  FILLER                          PIC  X(05)  VALUE                
026852         'UPC: '.                                                         
026853     05  DL6-UPC-NBR                     PIC  X(15)  VALUE SPACES.        
026854     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026855     05  FILLER                          PIC  X(06)  VALUE                
026856         'SKU:  '.                                                        
026857     05  DL6-SKU-NBR                     PIC  X(08)  VALUE SPACES.        
026858     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026859     05  FILLER                          PIC  X(08)  VALUE                
026860         'PKG CD: '.                                                      
026861     05  DL6-CONT-PKG-CDE                PIC  X(03)  VALUE SPACES.        
026862     05  FILLER                          PIC  X(02)  VALUE SPACES.        
026863     05  FILLER                          PIC  X(06)  VALUE                
026864         'CBMT: '.                                                        
026865     05  DL6-CBMT-QTY-PCK                PIC  ZZZZZZ9.99.                 
026866                                                                          
026867 01  DL7-DETAIL-LINE7.                                                    
026868     05  FILLER                          PIC  X(08)  VALUE SPACES.        
026869     05  DL7-ORDER-QTY-TYP               PIC  X(11)  VALUE SPACES.        
026870     05  DL7-UNIT-QTY                    PIC  ZZZZZZZZ9                   
026871                                                     VALUE ZEROES.        
026872     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026873     05  FILLER                          PIC  X(06)  VALUE                
026874         'CTNS: '.                                                        
026875     05  DL7-CART-CT                     PIC  ZZZZZZZZZZZ9                
026876                                                     VALUE ZEROES.        
026877     05  FILLER                          PIC  X(02)  VALUE SPACES.        
026878     05  FILLER                          PIC  X(14)  VALUE                
026879         'UNITS IN CTN: '.                                                
026880     05  DL7-UNITS-PER-CTN               PIC  ZZZZZZZZZZZ9                
026881                                                     VALUE ZEROES.        
026882     05  FILLER                          PIC  X(04)  VALUE SPACES.        
026883     05  FILLER                          PIC  X(14)  VALUE                
026884         'PCKS PER CTN: '.                                                
026885     05  DL7-PACKS-PER-CTN               PIC  ZZZZZZZZ9                   
026886                                                     VALUE ZEROES.        
026887     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026888     05  FILLER                          PIC  X(09)  VALUE SPACES.        
026891     05  FILLER                          PIC  X(04)  VALUE SPACES.        
026892     05  FILLER                          PIC  X(07)  VALUE                
026893         'KGRM:  '.                                                       
026894     05  DL7-WT-KGRM-QTY-PCK             PIC  ZZZZZZZZ9                   
026895                                                     VALUE ZEROES.        
026896                                                                          
026897 01  DL7A-DETAIL-LINE7A.                                                  
026898     05  FILLER                          PIC  X(19)  VALUE SPACES.        
026903     05  FILLER                          PIC  X(16)  VALUE                
026904         'UNLABELED CTNS: '.                                              
026905     05  DL7A-UNL-CARTS                  PIC  ZZZZZZZZZZZ9                
026906                                                     VALUE ZEROES.        
026907 01  DL8-DETAIL-LINE8.                                                    
026908     05  FILLER                          PIC  X(10)  VALUE SPACES.        
026909     05  FILLER                          PIC  X(02)  VALUE                
026910         'DC'.                                                            
026911     05  FILLER                          PIC  X(17)  VALUE SPACES.        
026912     05  DL8-CARTONS-HDR                 PIC  X(12)  VALUE SPACES.        
026913     05  FILLER                          PIC  X(13)  VALUE SPACES.        
026914     05  FILLER                          PIC  X(17)  VALUE                
026915         'UNLABELED CARTONS'.                                             
026916     05  FILLER                          PIC  X(10)  VALUE SPACES.        
026917     05  DL8-UNITS-HDR                   PIC  X(23)  VALUE SPACES.        
026918     05  FILLER                          PIC  X(06)  VALUE SPACES.        
026919     05  FILLER                          PIC  X(10)  VALUE                
026920         'DC PERCENT'.                                                    
026921     05  FILLER                          PIC  X(10)  VALUE SPACES.        
026922                                                                          
026923 01  DL9-DETAIL-LINE9.                                                    
026924     05  FILLER                          PIC  X(08)  VALUE SPACES.        
026925     05  DL9-DIST-CNTR                   PIC  ZZZ9   VALUE SPACES.        
026926     05  FILLER                          PIC  X(17)  VALUE SPACES.        
026927     05  DL9-CART-CT                     PIC  ZZZZZZZZZZZ9 VALUE          
026928                                                           ZEROES.        
026929     05  FILLER                          PIC  X(18)  VALUE SPACES.        
026930     05  DL9-UNL-CART-CT                 PIC  ZZZZZZZZZZZ9 VALUE          
026931                                                           ZEROES.        
026932     05  FILLER                          PIC  X(21)  VALUE SPACES.        
026933     05  DL9-UNIT-QTY                    PIC  ZZZZZZZZZZZ9 VALUE          
026934                                                           ZEROES.        
026935     05  FILLER                          PIC  X(07)  VALUE SPACES.        
026936     05  DL9-ORDER-PERCNT                PIC  ZZZZZZZZ9    VALUE          
026937                                                           ZEROES.        
026938     05  FILLER                          PIC  X(09)  VALUE SPACES.        
026939                                                                          
026940 01  DL10-DETAIL-LINE10.                                                  
026941     05  FILLER                          PIC  X(08)  VALUE SPACES.        
026942     05  FILLER                          PIC  X(07)  VALUE                
026943         'UPC  : '.                                                       
026944     05  DL10-UPC-NBR                    PIC  X(15)  VALUE SPACES.        
026945     05  FILLER                          PIC  X(03)  VALUE SPACES.        
026946     05  FILLER                          PIC  X(07)  VALUE                
026947         'SKU  : '.                                                       
026948     05  DL10-SKU                        PIC  9(08)  VALUE ZEROES.        
026949     05  FILLER                          PIC  X(04)  VALUE SPACES.        
026950     05  FILLER                          PIC  X(10)  VALUE                
026951         'SKU DESC: '.                                                    
026952     05  DL10-SKU-DESC                   PIC  X(25)  VALUE SPACES.        
026953     05  FILLER                          PIC  X(04)  VALUE SPACES.        
026954     05  FILLER                          PIC  X(12)  VALUE                
026955         'OUTER PACK: '.                                                  
026956     05  DL10-OUTR-PK-QTY                PIC  ZZZZZZZZZZZ9                
026957                                                     VALUE ZEROES.        
026958     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026959     05  FILLER                          PIC  X(06)  VALUE                
026960         'CBMT: '.                                                        
026961     05  DL10-CBMT-QTY-UPC               PIC  ZZZZZZ9.99.                 
026962                                                                          
026963 01  DL11-DETAIL-LINE11.                                                  
026964     05  FILLER                          PIC  X(08)  VALUE SPACES.        
026965     05  FILLER                          PIC  X(07)  VALUE                
026966         'STYLE: '.                                                       
026967     05  DL11-VEND-STYL-NAME             PIC  X(27)  VALUE SPACES.        
026968     05  FILLER                          PIC  X(03)  VALUE SPACES.        
026969     05  FILLER                          PIC  X(11)  VALUE                
026970         'COLOR CD : '.                                                   
026971     05  DL11-COLOR-CDE                  PIC  X(06)  VALUE SPACES.        
026972     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026973     05  FILLER                          PIC  X(08)  VALUE                
026974         ' COLOR: '.                                                      
026975     05  DL11-COLOR-DESC                 PIC  X(25)  VALUE SPACES.        
026976     05  FILLER                          PIC  X(07)  VALUE                
026977         'SIZE : '.                                                       
026978     05  DL11-SIZE-DESC                  PIC  X(25)  VALUE SPACES.        
026979     05  FILLER                          PIC  X(02)  VALUE SPACES.        
026980                                                                          
026981 01  DL12-DETAIL-LINE12.                                                  
026982     05  FILLER                          PIC  X(08)  VALUE SPACES.        
026983     05  FILLER                          PIC  X(07)  VALUE                
026984         'DEPT : '.                                                       
026985     05  DL12-DEPT                       PIC  ZZZ9.                       
026986     05  FILLER                          PIC  X(04)  VALUE SPACES.        
026987     05  FILLER                          PIC  X(07)  VALUE                
026988         'CLASS: '.                                                       
026989     05  DL12-CLASS                      PIC  ZZZ9.                       
026990     05  FILLER                          PIC  X(04)  VALUE SPACES.        
026991     05  FILLER                          PIC  X(11)  VALUE                
026992         'SUB CLASS: '.                                                   
026993     05  DL12-SUB-CLASS                  PIC  ZZZ9.                       
026994     05  FILLER                          PIC  X(06)  VALUE SPACES.        
026995     05  FILLER                          PIC  X(12)  VALUE                
026996         'PACK RATIO: '.                                                  
026997     05  DL12-PACK-RATIO                 PIC  ZZZZZZZ9                    
026998                                                     VALUE ZEROES.        
026999     05  FILLER                          PIC  X(05)  VALUE SPACES.        
027000     05  FILLER                          PIC  X(07)  VALUE                
027001         'UNITS: '.                                                       
027002     05  DL12-UNITS                      PIC  ZZZZZZZZZZZ9 VALUE          
027003                                                           ZEROES.        
027004     05  FILLER                          PIC  X(13)  VALUE SPACES.        
027005     05  FILLER                          PIC  X(07)  VALUE                
027006         'KGRM:  '.                                                       
027007     05  DL12-WT-KGRM-QTY-UPC            PIC  ZZZZZZZZ9                   
027008                                                     VALUE ZEROES.        
027009 01  DL12A-DETAIL-LINE12A.                                                
027010     05  FILLER                          PIC  X(08)  VALUE SPACES.        
027011     05  FILLER                          PIC  X(21)  VALUE                
027012         'UNLABELED CARTONS   :'.                                         
027013     05  DL12A-UNL-CARTS                 PIC  ZZZZZZ9.                    
027020                                                                          
035902 01  DL13-DETAIL-LINE13.                                                  
035903     05  FILLER                          PIC  X(08)  VALUE SPACES.        
035904     05  DL13-DIST-CNTR                  PIC  ZZZ9   VALUE SPACES.        
035905     05  FILLER                          PIC  X(17)  VALUE SPACES.        
035906     05  DL13-CART-CT                    PIC  ZZZZZZZZZZZ9 VALUE          
035907                                                           ZEROES.        
035908     05  FILLER                          PIC  X(17)  VALUE SPACES.        
035909     05  DL13-UNL-CART-CT                PIC  ZZZZZZZZZZZ9 VALUE          
035910                                                           ZEROES.        
035911     05  FILLER                          PIC  X(22)  VALUE SPACES.        
035912     05  DL13-UNIT-QTY                   PIC  ZZZZZZZZZZZ9 VALUE          
035913                                                           ZEROES.        
035914     05  FILLER                          PIC  X(07)  VALUE SPACES.        
035915     05  DL13-ORDER-PERCNT               PIC  ZZZZZZZZ9    VALUE          
035916                                                           ZEROES.        
035917     05  FILLER                          PIC  X(09)  VALUE SPACES.        
035918                                                                          
035919 01  DL14-DETAIL-LINE14-SEAL.                                             
035920     05  FILLER                          PIC  X(08)  VALUE SPACES.        
035921     05  FILLER                          PIC  X(13)  VALUE                
035922         'SEAL NUMBER: '.                                                 
035923     05  DL14-SEAL-NBR                   PIC  X(15)  VALUE SPACES.        
035924                                                                          
035925 01  DL15-DETAIL-LINE15-CART.                                             
035926     05  FILLER                          PIC  X(10)  VALUE SPACES.        
035927     05  DL15-CART-ELEMENT                                                
035928          OCCURS 4 TIMES.                                                 
035929         10 FILLER                       PIC  X(03)  VALUE SPACES.        
035930         10 DL15-SSCC-ID                 PIC  X(18)  VALUE SPACES.        
035931         10 FILLER                       PIC  X(02)  VALUE SPACES.        
035932         10 DL15-CART-QTY                PIC  X(07)  VALUE SPACES.        
035933                                                                          
035934 01  DL15H-CART-HEADER.                                                   
035935     05  FILLER    PIC  X(10) VALUE SPACES.                               
035938     05  FILLER    PIC  X(03) VALUE SPACES.                               
035939     05  FILLER    PIC  X(18) VALUE 'SSCC ID           '.                 
035940     05  FILLER    PIC  X(02) VALUE SPACES.                               
035941     05  FILLER    PIC  X(07) VALUE '    QTY'.                            
035942     05  FILLER    PIC  X(03) VALUE SPACES.                               
035943     05  FILLER    PIC  X(18) VALUE 'SSCC ID           '.                 
035944     05  FILLER    PIC  X(02) VALUE SPACES.                               
035945     05  FILLER    PIC  X(07) VALUE '    QTY'.                            
035946     05  FILLER    PIC  X(03) VALUE SPACES.                               
035947     05  FILLER    PIC  X(18) VALUE 'SSCC ID           '.                 
035948     05  FILLER    PIC  X(02) VALUE SPACES.                               
035949     05  FILLER    PIC  X(07) VALUE '    QTY'.                            
035950     05  FILLER    PIC  X(03) VALUE SPACES.                               
035951     05  FILLER    PIC  X(18) VALUE 'SSCC ID           '.                 
035952     05  FILLER    PIC  X(02) VALUE SPACES.                               
035953     05  FILLER    PIC  X(07) VALUE '    QTY'.                            
035954                                                                          
035960 01  DL-END-OF-REPORT.                                                    
036000     05  FILLER                          PIC  X(43)  VALUE SPACES.        
036100     05  DL-END-OF-RPT                   PIC  X(58)  VALUE                
036200         '*************** E N D  O F  R E P O R T *************'.         
036300     05  FILLER                          PIC  X(31)  VALUE SPACES.        
036400                                                                          
036500 01  DL-NO-INPUT.                                                         
036600     05  FILLER                          PIC  X(49)  VALUE SPACES.        
036700     05  FILLER                          PIC  X(55)  VALUE                
036800         '***  THERE IS NO DATA TO REPORT  ***                 '.         
036900     05  FILLER                          PIC  X(28) VALUE SPACES.         
037000                                                                          
037100 01  DL-CONT-MESSAGE-1.                                                   
037200     05  FILLER                          PIC  X(19) VALUE SPACES.         
037300     05  FILLER                          PIC  X(55) VALUE                 
037400         '***  PO ALREADY TRANSMITTED  ***                     '.         
037500     05  FILLER                          PIC  X(58) VALUE SPACES.         
037600                                                                          
037700 01  DL-CONT-MESSAGE-2.                                                   
037800     05  FILLER                          PIC  X(19) VALUE SPACES.         
037900     05  FILLER                          PIC  X(55) VALUE                 
038000         '***  PO WAITING FOR SPLITS   ***                     '.         
038100     05  FILLER                          PIC  X(58) VALUE SPACES.         
038200                                                                          
038300 01  DL-CONT-MESSAGE-3.                                                   
038400     05  FILLER                          PIC  X(19) VALUE SPACES.         
038500     05  FILLER                          PIC  X(55) VALUE                 
038600         '***  CHECK ERROR REPORT      ***                     '.         
038700     05  FILLER                          PIC  X(58) VALUE SPACES.         
038800                                                                          
038810 01  DL-PACK-ASTERICKS-LINE.                                              
038820     05  FILLER                          PIC  X(08) VALUE SPACES.         
038830     05  FILLER                          PIC  X(124)                      
038840                                                    VALUE ALL '*'.        
038860                                                                          
038900*****************************************************************         
039000*    DB2 AREA FOR THE IMPORT PO RELEASE TABLE.                            
039100*****************************************************************         
039200     EXEC SQL                                                             
039300          INCLUDE TIMPORL                                                 
039400     END-EXEC.                                                            
039500                                                                          
039600*****************************************************************         
039700*  DB2 FORMATTED MESSAGE AREA                                             
039800******************************************************************        
039900     COPY DPWS004.                                                        
040000                                                                          
040100******************************************************************        
040200*  DB2 COMMUNICATION AREA.                                                
040300******************************************************************        
040400     EXEC SQL                                                             
040500          INCLUDE SQLCA                                                   
040600     END-EXEC.                                                            
040700 EJECT                                                                    
040800 PROCEDURE DIVISION.                                                      
040900                                                                          
041000     PERFORM 1000-INITIALIZATION.                                         
041100                                                                          
041200     PERFORM 2000-PROCESS-DETAIL-RPT-RECS                                 
041300       UNTIL PS-EOF.                                                      
041400                                                                          
041410*    ****************************************************                 
041430*    * CHECK IF THERE ARE ANY UNWRITTEN CARTON RECORDS. *                 
041440*    ****************************************************                 
041491     IF PS-THIS-IS-A-CMN                                                  
041492       IF PV-SSCC-CNT > ZERO                                              
041493         PERFORM 3082-WRITE-CARTS                                         
041494       END-IF                                                             
041495     END-IF.                                                              
041497                                                                          
041500     WRITE REPORT-RECORD                                                  
041600       FROM DL-END-OF-REPORT                                              
041700         AFTER ADVANCING 2 LINES.                                         
041800                                                                          
041900     IF PS-TR020-REXMIT-RPT                                               
042000         SET PS-TR020-XMIT-RPT TO TRUE                                    
042100         PERFORM 8000-PRINT-HEADINGS                                      
042200         WRITE REPORT-RECORD                                              
042300            FROM DL-NO-INPUT                                              
042400            AFTER ADVANCING 2 LINES                                       
042500     END-IF.                                                              
042600                                                                          
042700     CLOSE TR020-REPORT-EXTRACT-FILE                                      
042800           REPORT-FILE.                                                   
042900                                                                          
043000     STOP RUN.                                                            
043010                                                                          
043100*---------------------------------------------------------------          
043200 1000-INITIALIZATION.                                                     
043300                                                                          
043400     OPEN INPUT  TR020-REPORT-EXTRACT-FILE                                
043500          OUTPUT REPORT-FILE.                                             
043600                                                                          
043700     ACCEPT PV-CURR-DATE-YYMMDD FROM DATE.                                
043800                                                                          
043900     ACCEPT PV-CURR-TIME FROM TIME.                                       
044000                                                                          
044100     MOVE PV-CURR-DATE-MM        TO DP132O-RUN-MONTH.                     
044200     MOVE PV-CURR-DATE-DD        TO DP132O-RUN-DAY.                       
044300     MOVE PV-CURR-DATE-YY        TO DP132O-RUN-YEAR.                      
044400                                                                          
044500     MOVE PV-CURR-TIME-HH        TO DP132O-RUN-HOUR.                      
044600     MOVE PV-CURR-TIME-MM        TO DP132O-RUN-MINUTE.                    
044700     MOVE PC-CURRENT-PROGRAM-NAME                                         
044800                                 TO DP132O-PROGRAM-NAME.                  
044900     PERFORM 7000-READ-INPUT.                                             
045000                                                                          
045100     IF PS-EOF                                                            
045200         SET PS-TR020-REXMIT-RPT TO TRUE                                  
045300         PERFORM 8000-PRINT-HEADINGS                                      
045400         WRITE REPORT-RECORD                                              
045500           FROM DL-NO-INPUT                                               
045600           AFTER ADVANCING 2 LINES                                        
045700         SET PS-TR020-XMIT-RPT   TO TRUE                                  
045800         PERFORM 8000-PRINT-HEADINGS                                      
045900         WRITE REPORT-RECORD                                              
046000           FROM DL-NO-INPUT                                               
046100           AFTER ADVANCING 2 LINES                                        
046200     ELSE                                                                 
046300         PERFORM 1100-FORMAT-PROCESS-DATE                                 
046400         IF PS-TR020-XMIT-RPT                                             
046500             SET PS-TR020-REXMIT-RPT   TO TRUE                            
046600             PERFORM 8000-PRINT-HEADINGS                                  
046700             WRITE REPORT-RECORD                                          
046800               FROM DL-NO-INPUT                                           
046900               AFTER ADVANCING 2 LINES                                    
047000             MOVE 65 TO PV-LINE-CNT                                       
047100             SET PS-TR020-XMIT-RPT     TO TRUE                            
047200         END-IF                                                           
047300     END-IF.                                                              
047400                                                                          
047500 1100-FORMAT-PROCESS-DATE.                                                
047600                                                                          
047700     MOVE SAVE-TR020-PROCESS-DTE      TO SAVE-PROCESS-DATE.               
047800     MOVE SAVE-TR020-PROCESS-DTE(5:2) TO HL2-PROCESSING-MONTH.            
047900     MOVE SAVE-TR020-PROCESS-DTE(7:2) TO HL2-PROCESSING-DAY.              
048000     MOVE SAVE-TR020-PROCESS-DTE(3:2) TO HL2-PROCESSING-YEAR.             
048100     MOVE '/'                         TO HL2-PROCESSING-SLASH1            
048200                                         HL2-PROCESSING-SLASH2.           
048300 EJECT                                                                    
048400 2000-PROCESS-DETAIL-RPT-RECS.                                            
048500                                                                          
048600******************************************************************        
048700* THE INPUT FILE WILL NORMALLY CONSIST OF RE-TRANSMISSION                 
048800* RECORDS FOLLOWED BY TRANSMISSION RECORDS.  WE NEED TO FORCE A PA        
048900* BREAK ON REPORT TYPE TO GET THE SECOND PART (TRANSMISSION DATA)         
049000* OF THE REPORT.  IF THE PROCESS DATE CHANGES, A PAGE BREAK WILL          
049100* OCCUR WITH THE NEW PROCESS DATE.  IF THE PO NUMBER CHANGES, A PA        
049200* BREAK WILL ALSO OCCUR.                                                  
049300******************************************************************        
049400                                                                          
049500     IF PS-TR020-REPORT-TYPE NOT = SAVE-REPORT-TYPE  OR                   
049600         SAVE-TR020-PROCESS-DTE NOT = SAVE-PROCESS-DATE                   
049700         PERFORM 1100-FORMAT-PROCESS-DATE                                 
049800         MOVE TR020-REPORT-TYPE-PO TO SAVE-REPORT-TYPE                    
049900         MOVE SAVE-TR020-PROCESS-DTE TO SAVE-PROCESS-DATE                 
050000     END-IF.                                                              
050001                                                                          
050002*    ******************************************************               
050003*    * IF YOU ARE DONE READING PCT AND DCT (CARTONS) THEN *               
050004*    * CHECK IF THERE ARE ANY UNWRITTEN OUTPUT CART RECS. *               
050005*    ******************************************************               
050010     EVALUATE SAVE-TR020-REC-TYPE-CDE                                     
050011         WHEN PC-PCT                                                      
050012         WHEN PC-DCT                                                      
050013           CONTINUE                                                       
050016         WHEN OTHER                                                       
050017           IF PS-THIS-IS-A-CMN                                            
050018             IF PV-SSCC-CNT > ZERO                                        
050019               PERFORM 3082-WRITE-CARTS                                   
050020             END-IF                                                       
050021           END-IF                                                         
050030     END-EVALUATE.                                                        
050100                                                                          
050200     EVALUATE SAVE-TR020-REC-TYPE-CDE                                     
050300         WHEN PC-PO                                                       
050310             SET PS-THIS-IS-A-PACK-NO TO TRUE                             
050400             PERFORM 3000-PROCESS-PO-BREAK                                
050500             PERFORM 3010-PROCESS-DATES                                   
050600         WHEN PC-INS                                                      
050700             PERFORM 3020-PROCESS-SPEC-INSTR                              
050800         WHEN PC-CMN                                                      
050801             SET PS-THIS-IS-A-CMN      TO TRUE                            
050802             SET PS-THIS-IS-A-CON-NO   TO TRUE                            
050803             SET PS-THIS-IS-FIRST-SEAL TO TRUE                            
050804             PERFORM 3030-PROCESS-CONTNR                                  
050810         WHEN PC-CON                                                      
050820             SET PS-THIS-IS-A-CON      TO TRUE                            
050821             SET PS-THIS-IS-A-CMN-NO   TO TRUE                            
050830             SET PS-THIS-IS-FIRST-SEAL TO TRUE                            
050900             PERFORM 3030-PROCESS-CONTNR                                  
051000         WHEN PC-PCK                                                      
051002             SET PS-THIS-IS-A-PACK TO TRUE                                
051004             PERFORM 3040-PROCESS-PACK                                    
051005         WHEN PC-PDC                                                      
051006             SET PS-THIS-IS-FIRST-CART TO TRUE                            
051007             PERFORM 3050-PROCESS-PACK-DC                                 
051010         WHEN PC-UPC                                                      
051100             PERFORM 3060-PROCESS-UPC                                     
051200         WHEN PC-DC                                                       
051210             SET PS-THIS-IS-FIRST-CART TO TRUE                            
051300             PERFORM 3070-PROCESS-DC                                      
051310         WHEN PC-SEA                                                      
051311           IF PS-THIS-IS-A-CMN                                            
051320             PERFORM 3075-PROCESS-SEAL                                    
051330           END-IF                                                         
051340         WHEN PC-PCT                                                      
051341         WHEN PC-DCT                                                      
051350           IF PS-THIS-IS-A-CMN                                            
051360             PERFORM 3080-PROCESS-CARTS                                   
051370           END-IF                                                         
051400         WHEN OTHER                                                       
051500             MOVE '2000-PROCESS-DETAIL-RPT-RECS  '  TO                    
051600                  PV-PARAGRAPH-NAME                                       
051700              MOVE 'INVALID RECORD TYPE CODE '       TO                   
051800                  PV-ERROR-MESSAGE-1                                      
051900              PERFORM 9200-ABEND                                          
052000     END-EVALUATE.                                                        
052100                                                                          
052200     PERFORM 7000-READ-INPUT.                                             
052300                                                                          
052400/                                                                         
052500 3000-PROCESS-PO-BREAK.                                                   
052600                                                                          
052700     PERFORM 8000-PRINT-HEADINGS.                                         
052800                                                                          
052900     MOVE SAVE-TR020-REC-TYPE  TO TR020-REC-TYPE-PO.                      
053000     MOVE TR020-PO-NBR-PO      TO DL1-PO-NBR.                             
053010     MOVE TR020-PO-TYP-CDE-PO  TO DL1-PO-TYPE.                            
053100     MOVE TR020-VENDOR-NAME-PO TO DL1-VENDOR.                             
053101                                                                          
053102     IF TR020-AD-DATE-PO = SPACES                                         
053103         MOVE SPACES TO DL1-AD-DATE                                       
053123     ELSE                                                                 
053124         MOVE TR020-AD-DATE-PO (5:2)                                      
053125                               TO DL1-AD-DATE-MM                          
053126         MOVE TR020-AD-DATE-PO (7:2)                                      
053127                               TO DL1-AD-DATE-DD                          
053128         MOVE TR020-AD-DATE-PO (3:2)                                      
053129                               TO DL1-AD-DATE-YY                          
053130         MOVE '/'              TO DL1-AD-DATE-SL1                         
053131                                  DL1-AD-DATE-SL2                         
053132     END-IF.                                                              
053140                                                                          
053200     WRITE REPORT-RECORD                                                  
053300       FROM DL1-DETAIL-LINE1                                              
053400         AFTER ADVANCING 2 LINES.                                         
053500     MOVE SPACES TO REPORT-RECORD.                                        
053600     WRITE REPORT-RECORD                                                  
053700         AFTER ADVANCING 1 LINE.                                          
053800     MOVE ZEROES TO SAVE-UPC-NBR.                                         
053810     MOVE ZEROES TO SAVE-PACK-ID.                                         
053811     MOVE ZEROES TO SAVE-UPC-PACK-ID.                                     
053820     MOVE ZEROES TO SAVE-UPC-NBR-DC.                                      
053900                                                                          
054000     ADD +3                TO PV-LINE-CNT.                                
054100                                                                          
054200     SET PS-SPEC-INSTR-1   TO TRUE.                                       
054300     SET PS-PO-REC-DONE    TO TRUE.                                       
054400                                                                          
054500 3010-PROCESS-DATES.                                                      
054600                                                                          
055100     PERFORM 4000-FORMAT-SHIP-DATE.                                       
055200     PERFORM 4010-FORMAT-CANCEL-DATE.                                     
055300     PERFORM 4020-FORMAT-OTB.                                             
055310     MOVE TR020-PKGNG-CDE-PO TO DL2-PKGNG-CDE.                            
055400     WRITE REPORT-RECORD                                                  
055500       FROM DL2-DETAIL-LINE2                                              
055600         AFTER ADVANCING 2 LINES.                                         
055700     MOVE SPACES TO REPORT-RECORD.                                        
055800     WRITE REPORT-RECORD                                                  
055900         AFTER ADVANCING 1 LINE.                                          
056000                                                                          
056100     ADD +3                TO PV-LINE-CNT.                                
056200                                                                          
056300 3020-PROCESS-SPEC-INSTR.                                                 
056400                                                                          
056500     IF PV-LINE-CNT > 62                                                  
056600         PERFORM 8000-PRINT-HEADINGS                                      
056700     END-IF.                                                              
056800                                                                          
056900     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-INS.                      
057000                                                                          
057100     MOVE TR020-SPEC-INSTR-INS TO PV-SPEC-INSTR-FORMAT.                   
057200                                                                          
057300     IF PV-SPEC-INSTR-FORMAT-2 NOT EQUAL SPACES                           
057400         SET PS-SPEC-INSTR-L2 TO TRUE                                     
057500     END-IF.                                                              
057600                                                                          
057700     IF PS-SPEC-INSTR-1                                                   
057800         MOVE PV-SPEC-INSTR-FORMAT-1 TO DL3-SPECIAL-INSTR                 
057900         WRITE REPORT-RECORD                                              
058000           FROM DL3-DETAIL-LINE3                                          
058100             AFTER ADVANCING 1 LINE                                       
058200         ADD +1                      TO PV-LINE-CNT                       
058300       IF PS-SPEC-INSTR-L2                                                
058400           MOVE PV-SPEC-INSTR-FORMAT-2 TO DL3-SPECIAL-INSTR-LONG          
058500           WRITE REPORT-RECORD                                            
058600             FROM DL3-DETAIL-LINE3A                                       
058700               AFTER ADVANCING 1 LINE                                     
058800           MOVE SPACES TO REPORT-RECORD                                   
058900           WRITE REPORT-RECORD                                            
059000               AFTER ADVANCING 1 LINE                                     
059100           ADD +2                    TO PV-LINE-CNT                       
059200       ELSE                                                               
059300           MOVE SPACES TO REPORT-RECORD                                   
059400           WRITE REPORT-RECORD                                            
059500               AFTER ADVANCING 1 LINE                                     
059600           ADD +1                    TO PV-LINE-CNT                       
059700       END-IF                                                             
059800     ELSE                                                                 
059900         MOVE PV-SPEC-INSTR-FORMAT-1 TO DL3-SPECIAL-INSTR-LONG            
060000         WRITE REPORT-RECORD                                              
060100           FROM DL3-DETAIL-LINE3A                                         
060110             AFTER ADVANCING 1 LINE                                       
060120         ADD +1         TO PV-LINE-CNT                                    
060200         IF PS-SPEC-INSTR-L2                                              
060300             MOVE PV-SPEC-INSTR-FORMAT-2 TO DL3-SPECIAL-INSTR-LONG        
060400             WRITE REPORT-RECORD                                          
060500               FROM DL3-DETAIL-LINE3A                                     
060600                 AFTER ADVANCING 1 LINE                                   
060700             ADD +1         TO  PV-LINE-CNT                               
060800             MOVE SPACES TO REPORT-RECORD                                 
060900             WRITE REPORT-RECORD                                          
061000                 AFTER ADVANCING 1 LINE                                   
061100             ADD +1         TO  PV-LINE-CNT                               
061110         ELSE                                                             
061120             MOVE SPACES TO REPORT-RECORD                                 
061130             WRITE REPORT-RECORD                                          
061140                 AFTER ADVANCING 1 LINE                                   
061150             ADD +1         TO  PV-LINE-CNT                               
061200         END-IF                                                           
061300     END-IF.                                                              
061400                                                                          
061500     SET PS-SPEC-INSTR-1-NO  TO TRUE.                                     
061600     SET PS-SPEC-INSTR-L2-NO TO TRUE.                                     
061700                                                                          
061800 3030-PROCESS-CONTNR.                                                     
061900                                                                          
062000     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-CONTNR.                   
062010     MOVE SAVE-TR020-REC-TYPE-CDE (3:3) TO PV-COMPARE-REC-TYP.            
062100                                                                          
062110     EVALUATE TRUE                                                        
062120         WHEN PV-CON-REC                                                  
062122             MOVE PC-CON-DETAIL      TO DL4-CONT-REC-TYP                  
062123             MOVE PC-ORDERED         TO DL4-CONT-STATUS                   
062124             MOVE PC-CON-QTY-HDR     TO DL7-ORDER-QTY-TYP                 
062126             MOVE PC-CON-CARTONS-HDR TO DL8-CARTONS-HDR                   
062127             MOVE PC-CON-UNITS-HDR   TO DL8-UNITS-HDR                     
062128         WHEN PV-CMN-REC                                                  
062129             MOVE PC-CMN-DETAIL      TO DL4-CONT-REC-TYP                  
062130             MOVE PC-SHIPPED         TO DL4-CONT-STATUS                   
062131             MOVE PC-CMN-QTY-HDR     TO DL7-ORDER-QTY-TYP                 
062132             MOVE PC-CMN-CARTONS-HDR TO DL8-CARTONS-HDR                   
062133             MOVE PC-CMN-UNITS-HDR   TO DL8-UNITS-HDR                     
062134     END-EVALUATE.                                                        
062140                                                                          
062200     MOVE TR020-CONTNR-ID-CONTNR       TO DL4-CONT-ID.                    
062300     MOVE TR020-VESSEL-NAME-CONTNR     TO DL4-VESSEL.                     
062400     MOVE TR020-VOYAGE-ID-NBR-CONTNR   TO DL4-VOYAGE.                     
062401     MOVE TR020-CONTNR-SIZE-CDE-CONTNR TO DL4-CONT-SIZE.                  
062402     MOVE TR020-EXTL-REF-CONTNR        TO DL4-EXTL-REF-NBR.               
062403     PERFORM 4030-FORMAT-ETA-DATE.                                        
062600     MOVE TR020-EXP-CART-CT-CONTNR     TO DL5-CARTONS.                    
062601     MOVE TR020-UNIT-QTY-CONTNR        TO DL5-UNITS.                      
062610     MOVE TR020-TRIP-TYP-CDE-CONTNR    TO DL5-TRIP-TYPE.                  
062620     MOVE TR020-POE-CDE-CONTNR         TO DL5-POE-CDE.                    
062630     MOVE TR020-CARR-SCAC-ID-CONTNR    TO DL5-CARR-SCAC.                  
062700                                                                          
062800     IF PS-PO-REC-NOT-DONE                                                
062900         PERFORM 3035-PROCESS-CONT-ONLY                                   
063000     ELSE                                                                 
063100         IF PV-LINE-CNT > 62                                              
063200             PERFORM 8000-PRINT-HEADINGS                                  
063300             MOVE TR020-PO-NBR-CONTNR TO DL1A-PO-NBR                      
063400             WRITE REPORT-RECORD                                          
063500               FROM DL1A-DETAIL-LINE1A                                    
063600                 AFTER ADVANCING 2 LINES                                  
063700             MOVE SPACES TO REPORT-RECORD                                 
063800             WRITE REPORT-RECORD                                          
063900                 AFTER ADVANCING 1 LINE                                   
064000             ADD +3 TO PV-LINE-CNT                                        
064100         ELSE                                                             
064200             WRITE REPORT-RECORD                                          
064300               FROM DL4-DETAIL-LINE4                                      
064400                 AFTER ADVANCING 1 LINE                                   
064500             ADD +1                TO PV-LINE-CNT                         
064510             WRITE REPORT-RECORD                                          
064520               FROM DL5-DETAIL-LINE5                                      
064530                 AFTER ADVANCING 1 LINE                                   
064540             ADD +1                TO PV-LINE-CNT                         
064600         END-IF                                                           
064700     END-IF.                                                              
064800                                                                          
064810******************************************************************        
064811*  THIS PARAGRAPH IS PERFORMED WHEN THE PO HAS ALREADY BEEN      *        
064812*  PROCESSED ON ONE SHIPMENT BUT IS NOW PROCESSING A DIFFERENT   *        
064813*  SHIPMENT FOR THE SAME PO.  PARAGRAPH 5000-SELECT-DCONSLR-     *        
064814*  RLSE-CDE IS PERFORMED FROM HERE TO DETERMINE WHICH ONE OF 3   *        
064815*  INFORMATIONAL MESSAGES SHOULD BE PRINTED DEPENDING ON THE     *        
064816*  DCONSLR-RLSE-CDE.                                             *        
064820******************************************************************        
064900 3035-PROCESS-CONT-ONLY.                                                  
065000                                                                          
065100     IF TR020-PO-NBR-CONTNR EQUAL SAVE-PO-CON-ONLY                        
065200       IF PV-LINE-CNT > 62                                                
065300           PERFORM 8000-PRINT-HEADINGS                                    
065400           MOVE TR020-PO-NBR-CONTNR TO DL1A-PO-NBR                        
065500           WRITE REPORT-RECORD                                            
065600             FROM DL1A-DETAIL-LINE1A                                      
065700               AFTER ADVANCING 2 LINES                                    
065800           ADD +2 TO PV-LINE-CNT                                          
065900           WRITE REPORT-RECORD                                            
066000             FROM DL4-DETAIL-LINE4                                        
066100               AFTER ADVANCING 2 LINES                                    
066200           ADD +2 TO PV-LINE-CNT                                          
066210           WRITE REPORT-RECORD                                            
066220             FROM DL5-DETAIL-LINE5                                        
066230               AFTER ADVANCING 1 LINE                                     
066240           ADD +1 TO PV-LINE-CNT                                          
066300       ELSE                                                               
066400           WRITE REPORT-RECORD                                            
066500             FROM DL4-DETAIL-LINE4                                        
066600               AFTER ADVANCING 1 LINE                                     
066700           ADD +1                   TO PV-LINE-CNT                        
066710           WRITE REPORT-RECORD                                            
066720             FROM DL5-DETAIL-LINE5                                        
066730               AFTER ADVANCING 1 LINE                                     
066740           ADD +1 TO PV-LINE-CNT                                          
066800       END-IF                                                             
066900     ELSE                                                                 
067000         PERFORM 8000-PRINT-HEADINGS                                      
067100         MOVE TR020-PO-NBR-CONTNR TO DL1B-PO-NBR                          
067200         WRITE REPORT-RECORD                                              
067300           FROM DL1B-DETAIL-LINE1B                                        
067400             AFTER ADVANCING 2 LINES                                      
067500         ADD +2 TO PV-LINE-CNT                                            
067600         WRITE REPORT-RECORD                                              
067700           FROM DL4-DETAIL-LINE4                                          
067800             AFTER ADVANCING 2 LINES                                      
067900         ADD +2                   TO PV-LINE-CNT                          
067910         WRITE REPORT-RECORD                                              
067920           FROM DL5-DETAIL-LINE5                                          
067930             AFTER ADVANCING 1 LINES                                      
067940         ADD +1                   TO PV-LINE-CNT                          
068000     END-IF.                                                              
068100                                                                          
068200     MOVE TR020-PO-NBR-CONTNR TO SAVE-PO-CON-ONLY.                        
068300                                                                          
068310     IF TR020-REC-TYPE-CONTNR (3:3) = PC-CON-DETAIL                       
068400         PERFORM 5000-SELECT-DCONSLR-RLSE-CDE                             
068600         IF IMPORL-DCONSLR-RLSE-CDE = PC-R OR PC-Y                        
068700             WRITE REPORT-RECORD                                          
068800               FROM DL-CONT-MESSAGE-1                                     
068900                 AFTER ADVANCING 1 LINE                                   
069000             ADD +1                    TO PV-LINE-CNT                     
069100         ELSE                                                             
069200             IF IMPORL-DCONSLR-RLSE-CDE = PC-S                            
069300                 WRITE REPORT-RECORD                                      
069400                   FROM DL-CONT-MESSAGE-2                                 
069500                     AFTER ADVANCING 1 LINE                               
069600                 ADD +1                TO PV-LINE-CNT                     
069700             ELSE                                                         
069800                IF IMPORL-DCONSLR-RLSE-CDE = PC-N                         
069900                    WRITE REPORT-RECORD                                   
070000                      FROM DL-CONT-MESSAGE-3                              
070100                        AFTER ADVANCING 1 LINE                            
070200                    ADD +1             TO PV-LINE-CNT                     
070300                END-IF                                                    
070400             END-IF                                                       
070410         END-IF                                                           
070500     END-IF.                                                              
070600                                                                          
070610 3040-PROCESS-PACK.                                                       
070620                                                                          
070630     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-PCK.                      
070640                                                                          
070650     IF PV-LINE-CNT > 59                                                  
070660         PERFORM 8000-PRINT-HEADINGS                                      
070670         MOVE TR020-PO-NBR-PCK TO DL1A-PO-NBR                             
070680         WRITE REPORT-RECORD                                              
070690           FROM DL1A-DETAIL-LINE1A                                        
070691             AFTER ADVANCING 2 LINES                                      
070692         MOVE SPACES TO REPORT-RECORD                                     
070693         WRITE REPORT-RECORD                                              
070694             AFTER ADVANCING 1 LINE                                       
070695         ADD +3 TO PV-LINE-CNT                                            
070696     END-IF.                                                              
070697                                                                          
070699     MOVE TR020-PACK-ID-PCK        TO DL6-PACK-ID.                        
070700     MOVE TR020-DESC-PCK           TO DL6-PACK-DESC.                      
070701     MOVE TR020-UPC-NBR-PCK        TO DL6-UPC-NBR.                        
070702     MOVE TR020-SKU-PCK            TO DL6-SKU-NBR.                        
070703     MOVE TR020-CBMT-QTY-PCK       TO DL6-CBMT-QTY-PCK.                   
070704     MOVE TR020-UNIT-QTY-PCK       TO DL7-UNIT-QTY.                       
070705     MOVE TR020-CART-CT-PCK        TO DL7-CART-CT.                        
070706     MOVE TR020-UNITS-PER-CTN-PCK  TO DL7-UNITS-PER-CTN.                  
070707     MOVE TR020-PACKS-PER-CART-PCK TO DL7-PACKS-PER-CTN.                  
070709     MOVE TR020-WT-KGRM-QTY-PCK    TO DL7-WT-KGRM-QTY-PCK.                
070710                                                                          
070720     IF TR020-ASN-PKGNG-CDE-PCK = PC-NA                                   
070730       MOVE 'N/A' TO DL6-CONT-PKG-CDE                                     
070740     ELSE                                                                 
070750       MOVE TR020-ASN-PKGNG-CDE-PCK TO DL6-CONT-PKG-CDE                   
070751     END-IF.                                                              
070752                                                                          
070753     IF (TR020-PO-NBR-PCK = PV-HOLD-PO-NBR-PCK)  AND                      
070754        (TR020-PACK-ID-PCK = PV-HOLD-PACK-ID-PCK)                         
070755         CONTINUE                                                         
070756     ELSE                                                                 
070757         MOVE SPACES TO REPORT-RECORD                                     
070758         WRITE REPORT-RECORD                                              
070759             AFTER ADVANCING 1 LINE                                       
070760         WRITE REPORT-RECORD                                              
070761             FROM DL-PACK-ASTERICKS-LINE                                  
070762             AFTER ADVANCING 1 LINE                                       
070763         ADD +2                    TO PV-LINE-CNT                         
070764         MOVE TR020-PO-NBR-PCK TO PV-HOLD-PO-NBR-PCK                      
070765         MOVE TR020-PACK-ID-PCK TO PV-HOLD-PACK-ID-PCK                    
070766     END-IF.                                                              
070767                                                                          
070768     WRITE REPORT-RECORD                                                  
070769          FROM DL6-DETAIL-LINE6                                           
070770          AFTER ADVANCING 1 LINE.                                         
070771     ADD +1       TO PV-LINE-CNT.                                         
070772                                                                          
070781     WRITE REPORT-RECORD                                                  
070782          FROM DL7-DETAIL-LINE7                                           
070783          AFTER ADVANCING 1 LINE.                                         
070784     ADD +1       TO PV-LINE-CNT.                                         
070785                                                                          
070786     IF PS-THIS-IS-A-CMN                                                  
070787      MOVE TR020-NO-LBL-CART-CT-PCK TO DL7A-UNL-CARTS                     
070788       WRITE REPORT-RECORD                                                
070789        FROM DL7A-DETAIL-LINE7A                                           
070790          AFTER ADVANCING 1 LINE                                          
070791      ADD +1                  TO PV-LINE-CNT                              
070792     END-IF.                                                              
070793                                                                          
070794                                                                          
070795 3050-PROCESS-PACK-DC.                                                    
070796                                                                          
070797     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-PDC.                      
070798                                                                          
070799     IF (TR020-PACK-ID-PDC NOT = SAVE-PACK-ID) AND                        
070800         (PV-LINE-CNT > 62)                                               
070801         PERFORM 8000-PRINT-HEADINGS                                      
070802         MOVE TR020-PO-NBR-PDC TO DL1A-PO-NBR                             
070803         WRITE REPORT-RECORD                                              
070804           FROM DL1A-DETAIL-LINE1A                                        
070805             AFTER ADVANCING 2 LINES                                      
070806         MOVE SPACES TO REPORT-RECORD                                     
070807         WRITE REPORT-RECORD                                              
070808             AFTER ADVANCING 1 LINE                                       
070809         ADD +3 TO PV-LINE-CNT                                            
070810     END-IF.                                                              
070811                                                                          
070812     IF TR020-PACK-ID-PDC NOT = SAVE-PACK-ID                              
070813         MOVE SPACES TO REPORT-RECORD                                     
070814         WRITE REPORT-RECORD                                              
070815             AFTER ADVANCING 1 LINE                                       
070816         WRITE REPORT-RECORD                                              
070817           FROM DL8-DETAIL-LINE8                                          
070818             AFTER ADVANCING 1 LINES                                      
070819         MOVE TR020-PACK-ID-PDC     TO SAVE-PACK-ID                       
070820         ADD +2                     TO PV-LINE-CNT                        
070821     END-IF.                                                              
070822                                                                          
070823     IF PV-LINE-CNT > 62                                                  
070824         PERFORM 8000-PRINT-HEADINGS                                      
070825         MOVE TR020-PO-NBR-PDC TO DL1A-PO-NBR                             
070826         WRITE REPORT-RECORD                                              
070827           FROM DL1A-DETAIL-LINE1A                                        
070828             AFTER ADVANCING 2 LINES                                      
070829         MOVE SPACES TO REPORT-RECORD                                     
070830         WRITE REPORT-RECORD                                              
070831             AFTER ADVANCING 1 LINE                                       
070832         ADD +3 TO PV-LINE-CNT                                            
070833     END-IF.                                                              
070834                                                                          
070835     MOVE TR020-DIST-CNTR-PDC       TO DL9-DIST-CNTR.                     
070836     MOVE TR020-UNIT-QTY-PDC        TO DL9-UNIT-QTY.                      
070837     MOVE TR020-PERCNT-PDC          TO DL9-ORDER-PERCNT.                  
070838     MOVE TR020-CART-CT-PDC         TO DL9-CART-CT.                       
070839     MOVE TR020-NO-LBL-CART-CT-PDC  TO DL9-UNL-CART-CT.                   
070840     WRITE REPORT-RECORD                                                  
070841       FROM DL9-DETAIL-LINE9                                              
070842         AFTER ADVANCING 1 LINE.                                          
070843                                                                          
070844     ADD +1                         TO PV-LINE-CNT.                       
070845     SET PS-PO-REC-NOT-DONE         TO TRUE.                              
070846                                                                          
070847 3060-PROCESS-UPC.                                                        
070848                                                                          
070849     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-UPC.                      
070850                                                                          
070851     IF (PV-LINE-CNT > 62)                                                
070860         PERFORM 8000-PRINT-HEADINGS                                      
070870         MOVE TR020-PO-NBR-UPC TO DL1A-PO-NBR                             
070880         WRITE REPORT-RECORD                                              
070890           FROM DL1A-DETAIL-LINE1A                                        
070900             AFTER ADVANCING 2 LINES                                      
071000         MOVE SPACES TO REPORT-RECORD                                     
071100         WRITE REPORT-RECORD                                              
071200             AFTER ADVANCING 1 LINE                                       
071300         ADD +3 TO PV-LINE-CNT                                            
071400     END-IF.                                                              
071500                                                                          
071700     MOVE TR020-UPC-NBR-UPC      TO DL10-UPC-NBR                          
071800     MOVE TR020-SKU-UPC          TO DL10-SKU                              
071900     MOVE TR020-SKU-DESC-UPC     TO DL10-SKU-DESC                         
072000     MOVE TR020-OUTR-PK-QTY-UPC  TO DL10-OUTR-PK-QTY                      
072100     MOVE TR020-CBMT-QTY-UPC     TO DL10-CBMT-QTY-UPC                     
072200     MOVE SPACES TO REPORT-RECORD                                         
072300     WRITE REPORT-RECORD                                                  
072400         AFTER ADVANCING 1 LINE                                           
072500     WRITE REPORT-RECORD                                                  
072600       FROM DL10-DETAIL-LINE10                                            
072700         AFTER ADVANCING 2 LINES                                          
072800     MOVE TR020-VEND-STYL-NAME-UPC TO DL11-VEND-STYL-NAME                 
072900     MOVE TR020-COLOR-CDE-UPC      TO DL11-COLOR-CDE                      
073000     MOVE TR020-COLOR-DESC-UPC     TO DL11-COLOR-DESC                     
073100     MOVE TR020-SIZE-DESC-UPC      TO DL11-SIZE-DESC                      
073200     WRITE REPORT-RECORD                                                  
073300       FROM DL11-DETAIL-LINE11                                            
073400         AFTER ADVANCING 1 LINE                                           
073500     MOVE TR020-DEPT-NBR-UPC       TO DL12-DEPT                           
073600     MOVE TR020-CLASS-UPC          TO DL12-CLASS                          
073700     MOVE TR020-SUB-CLASS-UPC      TO DL12-SUB-CLASS                      
073800     MOVE TR020-PACK-RATIO-QTY-UPC TO DL12-PACK-RATIO                     
073900     MOVE TR020-UNIT-QTY-UPC       TO DL12-UNITS                          
074100     MOVE TR020-WT-KGRM-QTY-UPC    TO DL12-WT-KGRM-QTY-UPC                
074200     WRITE REPORT-RECORD                                                  
074300       FROM DL12-DETAIL-LINE12                                            
074400         AFTER ADVANCING 1 LINE                                           
074500     MOVE TR020-UPC-NBR-UPC     TO SAVE-UPC-NBR                           
074501     ADD +5                     TO PV-LINE-CNT                            
074502*    **** UNLABELED/LABELED CARTS FOR CMN NON PACK UPCS ****              
074503     IF PS-THIS-IS-A-PACK                                                 
074504       CONTINUE                                                           
074505     ELSE                                                                 
074508       IF PS-THIS-IS-A-CMN                                                
074510        MOVE TR020-NO-LBL-CART-CT-UPC TO DL12A-UNL-CARTS                  
074511         WRITE REPORT-RECORD                                              
074512          FROM DL12A-DETAIL-LINE12A                                       
074513            AFTER ADVANCING 1 LINE                                        
074514        ADD +1                  TO PV-LINE-CNT                            
074515       END-IF                                                             
074516     END-IF                                                               
074517*    *******************************************************              
074519                                                                          
074520     IF PV-LINE-CNT > 62                                                  
074530         PERFORM 8000-PRINT-HEADINGS                                      
074600         MOVE TR020-PO-NBR-UPC TO DL1A-PO-NBR                             
074700         WRITE REPORT-RECORD                                              
074800           FROM DL1A-DETAIL-LINE1A                                        
074900             AFTER ADVANCING 2 LINES                                      
075000         MOVE SPACES TO REPORT-RECORD                                     
075100         WRITE REPORT-RECORD                                              
075200             AFTER ADVANCING 1 LINE                                       
075300         ADD +3 TO PV-LINE-CNT                                            
075400     END-IF.                                                              
076400     ADD +1                  TO PV-LINE-CNT.                              
076800     SET PS-PO-REC-NOT-DONE  TO TRUE.                                     
076900                                                                          
077000 3070-PROCESS-DC.                                                         
077100                                                                          
077200     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-DC.                       
077300                                                                          
077410     IF (TR020-UPC-NBR-UPC NOT = SAVE-UPC-NBR-DC) AND                     
077500         (PV-LINE-CNT > 61)                                               
077600         PERFORM 8000-PRINT-HEADINGS                                      
077700         MOVE TR020-PO-NBR-DC TO DL1A-PO-NBR                              
077800         WRITE REPORT-RECORD                                              
077900           FROM DL1A-DETAIL-LINE1A                                        
078000             AFTER ADVANCING 2 LINES                                      
078100         MOVE SPACES TO REPORT-RECORD                                     
078200         WRITE REPORT-RECORD                                              
078300             AFTER ADVANCING 1 LINE                                       
078400         ADD +3 TO PV-LINE-CNT                                            
078500     END-IF.                                                              
078600                                                                          
078710     IF TR020-UPC-NBR-UPC NOT = SAVE-UPC-NBR-DC                           
078800         MOVE SPACES TO REPORT-RECORD                                     
078900         WRITE REPORT-RECORD                                              
079000             AFTER ADVANCING 1 LINE                                       
079100         WRITE REPORT-RECORD                                              
079200           FROM DL8-DETAIL-LINE8                                          
079300             AFTER ADVANCING 1 LINES                                      
079410         MOVE TR020-UPC-NBR-UPC     TO SAVE-UPC-NBR-DC                    
079500         ADD +2                     TO PV-LINE-CNT                        
079600     END-IF.                                                              
079700                                                                          
079800     IF PV-LINE-CNT > 62                                                  
079900         PERFORM 8000-PRINT-HEADINGS                                      
080000         MOVE TR020-PO-NBR-DC TO DL1A-PO-NBR                              
080100         WRITE REPORT-RECORD                                              
080200           FROM DL1A-DETAIL-LINE1A                                        
080300             AFTER ADVANCING 2 LINES                                      
080400         MOVE SPACES TO REPORT-RECORD                                     
080500         WRITE REPORT-RECORD                                              
080600             AFTER ADVANCING 1 LINE                                       
080700         ADD +3 TO PV-LINE-CNT                                            
080800     END-IF.                                                              
080900                                                                          
081000     MOVE TR020-DIST-CNTR-DC        TO DL13-DIST-CNTR.                    
081100     MOVE TR020-UNIT-QTY-DC         TO DL13-UNIT-QTY.                     
081200     MOVE TR020-PERCNT-DC           TO DL13-ORDER-PERCNT.                 
081300     MOVE TR020-CART-CT-DC          TO DL13-CART-CT.                      
081310     MOVE TR020-NO-LBL-CART-CT-DC   TO DL13-UNL-CART-CT.                  
081400     WRITE REPORT-RECORD                                                  
081500       FROM DL13-DETAIL-LINE13                                            
081600         AFTER ADVANCING 1 LINE.                                          
081700                                                                          
081800     ADD +1                         TO PV-LINE-CNT.                       
082000     SET PS-PO-REC-NOT-DONE         TO TRUE.                              
082210                                                                          
082211*------------------------------------------------------                   
082220 3075-PROCESS-SEAL.                                                       
082230                                                                          
082231     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-CONTAINER-SEAL.           
082232                                                                          
082240     IF (PV-LINE-CNT > 64)                                                
082250         PERFORM 8000-PRINT-HEADINGS                                      
082260         MOVE TR020-PO-NBR-SEAL TO DL1A-PO-NBR                            
082270         WRITE REPORT-RECORD                                              
082280           FROM DL1A-DETAIL-LINE1A                                        
082290             AFTER ADVANCING 2 LINES                                      
082291         MOVE SPACES TO REPORT-RECORD                                     
082292         WRITE REPORT-RECORD                                              
082293             AFTER ADVANCING 1 LINE                                       
082294         ADD +3 TO PV-LINE-CNT                                            
082295     END-IF.                                                              
082296                                                                          
082500     MOVE  TR020-CONTNR-SEAL          TO DL14-SEAL-NBR.                   
082510     IF PS-THIS-IS-FIRST-SEAL                                             
082600        WRITE REPORT-RECORD                                               
082700             FROM DL14-DETAIL-LINE14-SEAL                                 
082800                 AFTER ADVANCING 2 LINE                                   
082900        ADD +2                  TO PV-LINE-CNT                            
082901        SET PS-THIS-IS-FIRST-SEAL-NO TO TRUE                              
082910     ELSE                                                                 
082920        WRITE REPORT-RECORD                                               
082930             FROM DL14-DETAIL-LINE14-SEAL                                 
082940                 AFTER ADVANCING 1 LINES                                  
082950        ADD +1                  TO PV-LINE-CNT                            
082960     END-IF.                                                              
082970                                                                          
082971*-----------------------------------------------------*                   
082972* DCT (DC CARTONS) AND PCT (PACK DC CARTONS) RECORDS  *                   
082973* ARE IDENTICAL SO ONLY DC AREA OF COPYBOOK IS USED.  *                   
082974* CARTONS PRINT 4 ACCROSS A PAGE.  THEY HAVE THEIR    *                   
082975* OWN DETAIL HEADER WHICH PRINTS AT THE TOP OF EACH   *                   
082976* PAGE.  ONLY THE FIST 18 CHAR OF SSCC ARE PRINTED.   *                   
082977*-----------------------------------------------------*                   
082978 3080-PROCESS-CARTS.                                                      
082979                                                                          
082980     MOVE SAVE-TR020-REC-TYPE TO TR020-REC-TYPE-DC-CARTON.                
082981     ADD +1 TO PV-SSCC-CNT.                                               
082982     MOVE TR020-SSCC-ID-DCT (3:18)                                        
082983                               TO DL15-SSCC-ID (PV-SSCC-CNT).             
082984     MOVE TR020-UNT-QTY-DCT    TO PC-ZZZZZZ9.                             
082985     MOVE PC-ZZZZZZ9           TO DL15-CART-QTY (PV-SSCC-CNT).            
082986     IF PV-SSCC-CNT = 4                                                   
082987       PERFORM 3082-WRITE-CARTS                                           
082988     END-IF.                                                              
082990                                                                          
082991*------------------------------------------------------                   
082992 3082-WRITE-CARTS.                                                        
082993                                                                          
082994     IF (PV-LINE-CNT > 63)                                                
082995         PERFORM 8000-PRINT-HEADINGS                                      
082996         MOVE TR020-PO-NBR-DCT  TO DL1A-PO-NBR                            
082997         WRITE REPORT-RECORD                                              
082998           FROM DL1A-DETAIL-LINE1A                                        
082999             AFTER ADVANCING 2 LINES                                      
083000         MOVE SPACES TO REPORT-RECORD                                     
083001         WRITE REPORT-RECORD                                              
083002             AFTER ADVANCING 1 LINE                                       
083003         ADD +2 TO PV-LINE-CNT                                            
083004         SET PS-THIS-IS-FIRST-CART TO TRUE                                
083005     END-IF.                                                              
083006                                                                          
083007     IF PS-THIS-IS-FIRST-CART                                             
083008         WRITE REPORT-RECORD                                              
083009           FROM DL15H-CART-HEADER                                         
083010             AFTER ADVANCING 1 LINES                                      
083011         ADD +1 TO PV-LINE-CNT                                            
083012         SET PS-THIS-IS-FIRST-CART-NO TO TRUE                             
083013     END-IF.                                                              
083014                                                                          
083015     WRITE REPORT-RECORD                                                  
083016       FROM DL15-DETAIL-LINE15-CART                                       
083017         AFTER ADVANCING 1 LINES.                                         
083018     ADD +1 TO PV-LINE-CNT.                                               
083019     MOVE ZERO TO PV-SSCC-CNT.                                            
083020     INITIALIZE DL15-DETAIL-LINE15-CART.                                  
083030                                                                          
083100*------------------------------------------------------                   
084900                                                                          
085000 4000-FORMAT-SHIP-DATE.                                                   
085100                                                                          
085200     IF TR020-DO-NOT-SHIP-BEF-DTE-PO  = SPACES                            
085300        MOVE SPACES              TO DL2-DONT-SHIP-BEF-DTE                 
085400     ELSE                                                                 
085500         MOVE TR020-DO-NOT-SHIP-BEF-DTE-PO (1:2)                          
085600                                 TO DL2-DONT-SHIP-BEF-DTE-MM              
085700         MOVE TR020-DO-NOT-SHIP-BEF-DTE-PO (3:2)                          
085800                                 TO DL2-DONT-SHIP-BEF-DTE-DD              
085900         MOVE TR020-DO-NOT-SHIP-BEF-DTE-PO (5:2)                          
086000                                 TO DL2-DONT-SHIP-BEF-DTE-YY              
086100         MOVE '/'                TO DL2-DONT-SHIP-BEF-DTE-SL1             
086200                                    DL2-DONT-SHIP-BEF-DTE-SL2             
086300     END-IF.                                                              
086400                                                                          
086500 4010-FORMAT-CANCEL-DATE.                                                 
086600                                                                          
086700     IF TR020-CANCEL-DATE-PO = SPACES                                     
086800        MOVE SPACES              TO DL2-CANCEL-DTE                        
086900     ELSE                                                                 
087000         MOVE TR020-CANCEL-DATE-PO (5:2)                                  
087100                                 TO DL2-CANCEL-DTE-MM                     
087200         MOVE TR020-CANCEL-DATE-PO (7:2)                                  
087300                                 TO DL2-CANCEL-DTE-DD                     
087400         MOVE TR020-CANCEL-DATE-PO (3:2)                                  
087500                                 TO DL2-CANCEL-DTE-YY                     
087600         MOVE '/'                TO DL2-CANCEL-DTE-SL1                    
087700                                    DL2-CANCEL-DTE-SL2                    
087800     END-IF.                                                              
087900                                                                          
088000 4020-FORMAT-OTB.                                                         
088100                                                                          
088200     IF TR020-OPEN-TO-BUY-PERIOD-PO = SPACES                              
088300         MOVE SPACES            TO DL2-OTB                                
088400     ELSE                                                                 
088500         MOVE TR020-OPEN-TO-BUY-PERIOD-PO (1:2) TO DL2-OTB-CC             
088600         MOVE TR020-OPEN-TO-BUY-PERIOD-PO (3:2) TO DL2-OTB-YY             
088700         MOVE TR020-OPEN-TO-BUY-PERIOD-PO (5:2) TO DL2-OTB-MM             
088800         MOVE '/'               TO DL2-OTB-SL1                            
088900     END-IF.                                                              
089000                                                                          
089100 4030-FORMAT-ETA-DATE.                                                    
089200     IF TR020-VESSEL-ETA-DATE-CONTNR = SPACES                             
089300         MOVE SPACES             TO DL5-ETA-DATE                          
089400     ELSE                                                                 
089500         MOVE TR020-VESSEL-ETA-DATE-CONTNR(5:2) TO DL5-ETA-MM             
089600         MOVE TR020-VESSEL-ETA-DATE-CONTNR(7:2) TO DL5-ETA-DD             
089700         MOVE TR020-VESSEL-ETA-DATE-CONTNR(3:2) TO DL5-ETA-YY             
089800         MOVE '/'                        TO DL5-ETA-SL1                   
089900                                            DL5-ETA-SL2                   
090000     END-IF.                                                              
090100                                                                          
090200 EJECT                                                                    
090300                                                                          
090400 5000-SELECT-DCONSLR-RLSE-CDE.                                            
090500                                                                          
090600     PERFORM                                                              
090700         WITH TEST AFTER                                                  
090800         VARYING PV-RETRY-COUNTER                                         
090900         FROM 1 BY 1                                                      
091000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
091100                   OR (SQLCODE = +0)                                      
091200                   OR (SQLCODE = +100))                                   
091300                                                                          
091400         EXEC SQL                                                         
091500            SELECT  IM.PO_NBR                                             
091600                   ,IM.DCONSLR_RLSE_CDE                                   
091700              INTO :IMPORL-PO-NBR                                         
091800                  ,:IMPORL-DCONSLR-RLSE-CDE                               
091900              FROM  TIMPORL  IM                                           
092000              WHERE IM.PO_NBR = :SAVE-PO-CON-ONLY                         
092100                AND IM.VER_STATUS_CDE   = 'A'                             
092200         END-EXEC                                                         
092300                                                                          
092400         EVALUATE TRUE                                                    
092500             WHEN SQLCODE = +0                                            
092600                 CONTINUE                                                 
092700             WHEN SQLCODE = +100                                          
092800                 MOVE SPACES TO IMPORL-DCONSLR-RLSE-CDE                   
092900             WHEN SQLWARN0 NOT EQUAL SPACE                                
093000             WHEN SQLCODE NOT EQUAL ZERO                                  
093100                 MOVE '5000-SELECT-DCONSLR-RLSE-CDE'  TO                  
093200                         PV-PARAGRAPH-NAME                                
093300                 MOVE 'SELECT ON TIMPORL '            TO                  
093400                         PV-DB2-OPERATION-ATTEMPTED                       
093500                 MOVE SAVE-PO-CON-ONLY TO PV-ABEND-PO-NBR                 
093600                 PERFORM 9100-SQL-ABEND                                   
093700         END-EVALUATE                                                     
093800     END-PERFORM.                                                         
093900                                                                          
094000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
094100         SQLCODE NOT = +0                                                 
094200         MOVE '5000-SELECT-DCONSLR-RLSE-CDE'  TO                          
094300                 PV-PARAGRAPH-NAME                                        
094400         MOVE 'MAX RETRY COUNT EXCEEDED'      TO                          
094500                 PV-DB2-OPERATION-ATTEMPTED                               
094600         MOVE SAVE-PO-CON-ONLY TO PV-ABEND-PO-NBR                         
094700         PERFORM 9100-SQL-ABEND                                           
094800     END-IF.                                                              
094900                                                                          
095000/                                                                         
095100 7000-READ-INPUT.                                                         
095200                                                                          
095300     MOVE '7000'                  TO PGM-LOCATION.                        
095400     MOVE '7000-READ-INPUT           '                                    
095500                                  TO PV-PARAGRAPH-NAME.                   
095600                                                                          
095700     READ TR020-REPORT-EXTRACT-FILE                                       
095800         INTO SAVE-TR020-REC-TYPE                                         
095900         AT END                                                           
096000           SET PS-EOF TO TRUE.                                            
096100                                                                          
096200     IF SAVE-TR020-REPORT-TYPE EQUAL 'R'                                  
096300         SET PS-TR020-REXMIT-RPT TO TRUE                                  
096400     ELSE                                                                 
096500         SET PS-TR020-XMIT-RPT   TO TRUE                                  
096600     END-IF.                                                              
096700                                                                          
096800 EJECT                                                                    
096900 8000-PRINT-HEADINGS.                                                     
097000                                                                          
097100     IF PS-TR020-REXMIT-RPT                                               
097200         ADD 1                     TO PV-PAGE-CNT-REXMIT                  
097300         MOVE PV-PAGE-CNT-REXMIT   TO DP132O-PAGE-NUMBER                  
097400         MOVE PC-REPORT-NBR-1      TO DP132O-REPORT-NUMBER                
097500     ELSE                                                                 
097600         ADD 1                     TO PV-PAGE-CNT-XMIT                    
097700         MOVE PV-PAGE-CNT-XMIT     TO DP132O-PAGE-NUMBER                  
097800         MOVE PC-REPORT-NBR-2      TO DP132O-REPORT-NUMBER                
097900     END-IF.                                                              
098000                                                                          
098100     WRITE REPORT-RECORD                                                  
098200       FROM DP132O-STANDRD-HEADER-132-COLS                                
098300         AFTER ADVANCING PAGE.                                            
098400                                                                          
098500     IF PS-TR020-REXMIT-RPT                                               
098600         WRITE REPORT-RECORD                                              
098700         FROM HL1-HEADING-LINE1                                           
098800         AFTER ADVANCING 2 LINE                                           
098900     ELSE                                                                 
099000         WRITE REPORT-RECORD                                              
099100         FROM HL1-HEADING-LINE1A                                          
099200         AFTER ADVANCING 2 LINE                                           
099300     END-IF.                                                              
099400                                                                          
099500     MOVE 3                       TO PV-LINE-CNT.                         
099600                                                                          
099700     WRITE REPORT-RECORD                                                  
099800       FROM HL2-HEADING-LINE2                                             
099900         AFTER ADVANCING 1 LINES.                                         
100000                                                                          
100100     ADD +1                       TO PV-LINE-CNT.                         
100200/                                                                         
100300******************************************************************        
100400* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE              
100500* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                         
100600******************************************************************        
100700 9100-SQL-ABEND.                                                          
100800******************************************************************        
100900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
101000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
101100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
101200* FORMAT.                                                                 
101300******************************************************************        
101400     COPY DPPD004.                                                        
101500                                                                          
101600     DISPLAY '9100-SQL-ABEND'.                                            
101700     DISPLAY '** ABEND     **'.                                           
101800     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.                
101900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
102000     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
102100     DISPLAY '** PO-NBR    ** = ' PV-ABEND-PO-NBR.                        
102200     MOVE SQLCODE TO PV-SQL-CODE.                                         
102300     DISPLAY '** SQL CODE  ** = ' PV-SQL-CODE.                            
102400     MOVE +4013 TO PV-ABEND-CODE.                                         
102500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
102600                                                                          
102700 9200-ABEND.                                                              
102800******************************************************************        
102900*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                               
103000******************************************************************        
103100     DISPLAY '***************************'.                               
103200     DISPLAY '**       ABEND           **'.                               
103300     DISPLAY '**  IN PROGRAM TRKRP009  **'.                               
103400     DISPLAY '***************************'.                               
103500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.                
103600     DISPLAY '** ERROR           ** = ' PV-ERROR-MESSAGE-1.               
103700     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.               
103800                                                                          
103900     MOVE +4014                  TO PV-ABEND-CODE.                        
104000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
