       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.              INKRP305.                                       
       AUTHOR.                  JAN BLAZICH.                                    
       INSTALLATION.            KOHLS DEPARTMENT STORES.                        
       DATE-WRITTEN.            02/19/2006.                                     
       DATE-COMPILED.                                                           
      ******************************************************************        
      *                                                                         
      *  CREATE REPORT OF FINANCIAL TRANSACTIONS FOR STORES DOING               
      *  INVENTORY.                                                             
      *                                                                         
      *  BREAKS ARE ON STORE AND DEPT FOR DETAIL AND SUMMARY REPORTS            
      *                                                                         
      *  THE INPUT FILE CONTAINS THE EXTRACTED STORE DATA TO BE                 
      *  PROCESSED.                                                             
      *                                                                         
      ******************** HISTORY OF CHANGES **************************        
      * CHG ID/                                                        *        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
      *                                                                         
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT SELECT-RECLASS-XTR-FILE                                       
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT RECLS-DETAIL-RPT-FILE                                         
               ASSIGN TO RPT01.                                                 
                                                                                
           SELECT RECLS-SUMMARY-RPT-FILE                                        
               ASSIGN TO RPT02.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  SELECT-RECLASS-XTR-FILE                                              
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  SELECT-RECLASS-XTR-REC          PIC X(137).                          
                                                                                
       FD  RECLS-DETAIL-RPT-FILE                                                
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  RECLS-DETAIL-RPT-REC            PIC X(150).                          
                                                                                
       FD  RECLS-SUMMARY-RPT-FILE                                               
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  RECLS-SUMMARY-RPT-REC           PIC X(150).                          
                                                                                
       EJECT                                                                    
      ******************************************************************00830099
       WORKING-STORAGE SECTION.                                         00840099
      ******************************************************************00850099
                                                                        00950099
      *** CYCLE INVENTORY RECLASS OUTPUT                                        
      *** CONTAINS THE REPORT LINE (SL-D-SKU-LINE)                              
      *01  IN052-SKU-DETAIL.                                            00740099
           COPY INRD052.                                                00940099
       EJECT                                                            00990099
                                                                        01000099
       01  PC-PROGRAM-COUNTERS                     COMP-3.              01010099
           05  PC-ITEM-RECS-READ                                        01020099
                                       PIC S9(9)   VALUE ZERO.          01030099
                                                                        01150099
           05  PC-TRNS-EXTR-RECS-WRITTEN                                01160099
                                       PIC S9(9)   VALUE ZERO.          01170099
           05  PC-RPT-EXTR-RECS-WRITTEN                                 01180099
                                       PIC S9(9)   VALUE ZERO.          01190099
           05  PC-EXTRACT-OUT-COUNT    PIC S9(11)  VALUE ZERO.                  
                                                                        01200099
       01  PV-PROGRAM-VARIABLES.                                        01210099
           05  PV-PREV-STORE-NMBR      PIC 9(5).                                
           05  PV-PREV-FROM.                                                    
               10  PV-PREV-FROM-DEPT   PIC X(3).                                
               10  FILLER              PIC X.                                   
               10  PV-PREV-FROM-MCL    PIC X(2).                                
               10  FILLER              PIC X.                                   
               10  PV-PREV-FROM-SCL    PIC X(2).                                
           05  PV-CURR-FROM.                                                    
               10  PV-CURR-FROM-DEPT   PIC X(3).                                
               10  FILLER              PIC X.                                   
               10  PV-CURR-FROM-MCL    PIC X(2).                                
               10  FILLER              PIC X.                                   
               10  PV-CURR-FROM-SCL    PIC X(2).                                
                                                                        01230099
           05  PV-CR-BATCH-NBR         PIC 9(3).                        01290099
           05  PV-DR-BATCH-NBR         PIC 9(3).                        01291099
                                                                        01292099
           05  PV-DATE-YYMMDD.                                          01293099
               10  PV-DATE-YYMMDD-YY   PIC XX.                          01294099
               10  PV-DATE-YYMMDD-MM   PIC XX.                          01295099
               10  PV-DATE-YYMMDD-DD   PIC XX.                          01296099
           05  PV-TIME-HHMMSS.                                          01297099
               10  PV-TIME-HHMMSS-HH   PIC XX.                          01298099
               10  PV-TIME-HHMMSS-MM   PIC XX.                          01299099
               10  PV-TIME-HHMMSS-SS   PIC XX.                          01300099
           05  PV-REPORT-DATA.                                          01820099
               10  PV-DTL-LINE-COUNT   PIC S9(3)  COMP-3  VALUE 0.      01830099
               10  PV-DTL-PAGE-COUNT   PIC S9(7)  COMP-3  VALUE 0.      01840099
               10  PV-SUM-LINE-COUNT   PIC S9(3)  COMP-3  VALUE 0.      01830099
               10  PV-SUM-PAGE-COUNT   PIC S9(7)  COMP-3  VALUE 0.      01840099
                                                                        01850099
           05  PV-L1-TOTALS.                                            01860099
               10  PV-L1-ONHAND-QTY    PIC S9(7)V      COMP-3.          01880099
               10  PV-L1-UNT-RTL-AMT   PIC S9(11)V9(2) COMP-3.          01890099
               10  PV-L1-EXT-RETAIL    PIC S9(11)V9(2) COMP-3.          01910099
               10  PV-L1-UNT-COST-AMT  PIC S9(11)V99   COMP-3.          01940099
               10  PV-L1-EXT-COST      PIC S9(11)V99   COMP-3.          01960099
                                                                        01980099
                                                                        01980099
           05  PV-L2-TOTALS.                                            01860099
               10  PV-L2-ONHAND-QTY    PIC S9(7)V      COMP-3.          01880099
               10  PV-L2-UNT-RTL-AMT   PIC S9(11)V9(2) COMP-3.          01890099
               10  PV-L2-EXT-RETAIL    PIC S9(11)V9(2) COMP-3.          01910099
               10  PV-L2-UNT-COST-AMT  PIC S9(11)V99   COMP-3.          01940099
               10  PV-L2-EXT-COST      PIC S9(11)V99   COMP-3.          01960099
                                                                        01980099
                                                                        02680099
           05  PV-L3-TOTALS.                                            02690099
               10  PV-L3-ONHAND-QTY    PIC S9(13)      COMP-3.          02700099
               10  PV-L3-UNT-RTL-AMT   PIC S9(13)V99   COMP-3.          02710099
               10  PV-L3-EXT-RETAIL    PIC S9(13)V99   COMP-3.          02710099
               10  PV-L3-UNT-COST-AMT  PIC S9(13)V99   COMP-3.          02710099
               10  PV-L3-EXT-COST      PIC S9(13)V99   COMP-3.          02710099
                                                                        02790099
       01  PC-PROGRAM-CONSTANTS.                                        03140099
           05  PC-LINE-COUNT-MAX       PIC S9(3)   VALUE +64.           03150099
                                                                        03160099
           05  PC-INKRP305             PIC X(8)    VALUE 'INKRP305'.    03170099
                                                                        03190099
       01  PS-PROGRAM-SWITCHES.                                         03460099
           05  PS-RECLASS-FILE-EOF-SW  PIC X       VALUE 'N'.           03470099
               88  PS-RECLASS-FILE-EOF             VALUE 'Y'.           03480099
               88  PS-RECLASS-FILE-NOT-EOF         VALUE 'N'.           03490099
                                                                        03750099
       EJECT                                                            03760099
                                                                        03770099
       01 ABEND-AREAS.                                                  03780099
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO           03790099
                                                   COMP SYNC.           03800099
               88  AC-BAD-DATA                     VALUE +4003.         03810099
           05  AA-ABEND-LIT            PIC X(40)   VALUE                03830099
                 '*****       ABEND'.                                   03840099
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                03850099
                   '*****   PROGRAM: INKRP305'.                         03860099
           05  AA-PARAGRAPH-LIT.                                        03870099
               10  FILLER              PIC X(17)   VALUE                03880099
                   '***** PARAGRAPH: '.                                 03890099
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        03900099
           05  AA-MESSAGE-LINE.                                         03910099
               10  FILLER              PIC X(06)   VALUE '*****'.       03920099
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        03930099
       EJECT                                                            04070099
                                                                        04080099
      ******************************************************************04090099
      *  STANDARD KOHL'S HEADING LINE FOR A 150 COLUMN REPORT           04100099
      ******************************************************************04110099
           COPY DPWS150O.                                               04120099
      *                                                                 04130099
       01  H2-D-HEADING2.                                               04140099
           05  FILLER                  PIC X(53)   VALUE SPACE.         04150099
           05  FILLER                  PIC X(45)   VALUE                04160099
               ' SKU RECLASS FINANCIAL REPORT - STORE DETAIL '.         04170099
           05  FILLER                  PIC X(52)   VALUE SPACE.         04180099
      *                                                                 04190099
       01  H3-D-HEADING3.                                               04200099
           05  FILLER                  PIC X(57)   VALUE SPACE.         04210099
           05  FILLER                  PIC X(04)   VALUE 'FOR '.        04220099
           05  H3-D-FROM-DATE          PIC X(8).                        04230099
           05  H3-D-FROM-DATE-R        REDEFINES H3-D-FROM-DATE.        04230099
               10  HD-D-FROM-MONTH     PIC 9(02).                       04240099
               10  H3-D-FROM-SLS1      PIC X(01).                       04250099
               10  H3-D-FROM-DAY       PIC 9(02).                       04260099
               10  H3-D-FROM-SLS2      PIC X(01).                       04270099
               10  H3-D-FROM-YR        PIC 9(02).                       04280099
           05  FILLER                  PIC X(16)                        04290099
                                       VALUE ' - BATCH NUMBER '.        04300099
           05  H3-D-CR-BATCH-NBR       PIC X(3).                        04310099
           05  FILLER                  PIC X(3)    VALUE ' - '.         04320099
           05  H3-D-DR-BATCH-NBR       PIC X(3).                        04330099
           05  FILLER                  PIC X(56)   VALUE SPACE.         04340099
      *                                                                 04350099
       01  H4-D-HEADING4.                                               04360099
           05  FILLER                  PIC X(18)   VALUE                04370099
               '    FROM        TO'.                                    04380099
      *                                                                 04670099
       01  H5-D-HEADING5.                                               04360099
           05  FILLER                  PIC X(15)   VALUE                04370099
               'DPT-CLASSES    '.                                               
           05  FILLER                  PIC X(15)   VALUE                04400099
               'DPT-CLASSES    '.                                               
           05  FILLER                  PIC X(08)   VALUE                04390099
               '  SKU   '.                                                      
           05  FILLER                  PIC X(01)   VALUE SPACES.        04420099
           05  FILLER                  PIC X(12)   VALUE                04430099
               'RECLASS DATE'.                                          04440099
           05  FILLER                  PIC X(01)   VALUE SPACES.        04450099
           05  FILLER                  PIC X(20)   VALUE                04460099
               'SKU DESC'.                                              04470099
           05  FILLER                  PIC X(01)   VALUE SPACES.        04480099
           05  FILLER                  PIC X(5)    VALUE                04490099
               'STORE'.                                                 04500099
           05  FILLER                  PIC X(02)   VALUE SPACES.        04510099
           05  FILLER                  PIC X(11)   VALUE                04520099
               ' ONHAND QTY'.                                           04530099
           05  FILLER                  PIC X(01)   VALUE SPACES.        04540099
           05  FILLER                  PIC X(11)   VALUE                04550099
               '     RETAIL'.                                           04560099
           05  FILLER                  PIC X(02)   VALUE SPACES.        04570099
           05  FILLER                  PIC X(15)   VALUE                04580099
               '     EXT RETAIL'.                                       04590099
           05  FILLER                  PIC X(02)   VALUE SPACES.        04600099
           05  FILLER                  PIC X(11)   VALUE                04610099
               '       COST'.                                           04620099
           05  FILLER                  PIC X(01)   VALUE SPACES.        04630099
           05  FILLER                  PIC X(15)   VALUE                04640099
               '       EXT COST'.                                       04650099
           05  FILLER                  PIC X(01)   VALUE SPACES.        04660099
                                                                        04670099
       01  SL-D-SKU-LINE.                                               04800099
           05  SL-D-SKU-LINE-PART-1.                                            
               10  SL-D-FROM-DEPT      PIC X(03)   VALUE SPACES.                
               10  FILLER              PIC X(01)   VALUE '-'.                   
               10  SL-D-FROM-MAJ-CLASS PIC X(02)   VALUE SPACES.                
               10  FILLER              PIC X(01)   VALUE '/'.                   
               10  SL-D-FROM-SUB-CLASS PIC X(02)   VALUE SPACES.                
               10  FILLER              PIC X(06)   VALUE SPACES.                
               10  SL-D-TO-DEPT        PIC X(03)   VALUE SPACES.                
               10  FILLER              PIC X(01)   VALUE '-'.                   
               10  SL-D-TO-MAJ-CLASS   PIC X(02)   VALUE SPACES.                
               10  FILLER              PIC X(01)   VALUE '/'.                   
               10  SL-D-TO-SUB-CLASS   PIC X(02)   VALUE SPACES.                
               10  FILLER              PIC X(06)   VALUE SPACES.                
               10  SL-D-TO-SKU         PIC X(08)   VALUE SPACES.        04830099
               10  FILLER              PIC X(02)   VALUE SPACES.        04840099
               10  SL-D-DATE-MMDDCCYY  PIC X(10)   VALUE SPACES.        04850099
               10  FILLER              PIC X(02)   VALUE SPACES.        04860099
      *TRUNCATED SKU DESC FROM 25 TO 20                                 04870099
               10  SL-D-SKU-DESC       PIC X(20)   VALUE SPACES.        04880099
               10  FILLER              PIC X(01)   VALUE SPACES.        04890099
           05  SL-D-SKU-LINE-PART-2.                                            
               10  SL-D-STORE-NMBR     PIC Z9999   VALUE ZEROES.        04900099
               10  FILLER              PIC X(02)   VALUE SPACES.        04910099
               10  SL-D-ONHAND-QTY     PIC ZZZ,ZZZ,ZZ9-.                04920099
               10  SL-D-UNT-RTL-AMT    PIC ZZZZ,ZZZ.99-.                04940099
               10  FILLER              PIC X(01)   VALUE SPACES.        04950099
               10  SL-D-EXT-RETAIL     PIC ZZZZ,ZZZ,ZZZ.99-.            04960099
               10  FILLER              PIC X(01)   VALUE SPACES.        04970099
               10  SL-D-UNT-COST-AMT   PIC ZZZZ,ZZZ.99-.                04980099
               10  SL-D-EXT-COST       PIC ZZZZ,ZZZ,ZZZ.99-.            05000099
      *                                                                 05010099
       01  TL-D1-TOTAL-LINE.                                            05020099
           05  TL-D1-TOTAL-LABEL       PIC X(22).                       05030099
           05  FILLER                  PIC X(05)   VALUE SPACES.        05040099
           05  TL-D1-SUBJECT           PIC X(10).                       05040099
           05  FILLER                  PIC X(40)   VALUE SPACES.        05040099
           05  TL-D1-ONHAND-QTY        PIC ZZ,ZZZ,ZZZ,ZZ9-.             05050099
           05  FILLER                  PIC X(11)   VALUE SPACES.        05060099
           05  TL-D1-EXT-RETAIL        PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05070099
           05  FILLER                  PIC X(11)   VALUE SPACES.        05080099
           05  TL-D1-EXT-COST          PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05090099
      *                                                                 05100099
       EJECT                                                            05160099
                                                                        05170099
       01  H2-S-HEADING2.                                               05230099
           05  FILLER                  PIC X(53)   VALUE SPACE.         05240099
           05  FILLER                  PIC X(49)   VALUE                05250099
               ' SKU RECLASS FINANCIAL REPORT - STORE SUMMARY'.         04170099
           05  FILLER                  PIC X(48)   VALUE SPACE.         05270099
      *                                                                 05280099
       01  H3-S-HEADING3.                                               05290099
           05  FILLER                  PIC X(57)   VALUE SPACE.         05300099
           05  FILLER                  PIC X(04)   VALUE 'FOR '.        05310099
           05  H3-S-FROM-DATE          PIC X(8).                        04230099
           05  H3-S-FROM-DATE-R        REDEFINES H3-S-FROM-DATE.        04230099
               10  HD-S-FROM-MONTH     PIC 9(02).                       04240099
               10  H3-S-FROM-SLS1      PIC X(01).                       04250099
               10  H3-S-FROM-DAY       PIC 9(02).                       04260099
               10  H3-S-FROM-SLS2      PIC X(01).                       04270099
               10  H3-S-FROM-YR        PIC 9(02).                       04280099
           05  FILLER                  PIC X(16)                        05380099
                                       VALUE ' - BATCH NUMBER '.        05390099
           05  H3-S-CR-BATCH-NBR       PIC X(3).                        05400099
           05  FILLER                  PIC X(3)    VALUE ' - '.         05410099
           05  H3-S-DR-BATCH-NBR       PIC X(3).                        05420099
           05  FILLER                  PIC X(38)   VALUE SPACE.         05430099
      *                                                                 05440099
       01  H4-S-HEADING4.                                               05450099
           05  FILLER                  PIC X(82)  VALUE '    FROM'.     05460099
      *                                                                 05510099
       01  H5-S-HEADING5.                                               04360099
           05  FILLER                  PIC X(82)   VALUE                04370099
               'DPT-CLASSES    '.                                               
           05  FILLER                  PIC X(10)  VALUE 'ONHAND QTY'.   05470099
           05  FILLER                  PIC X(22)  VALUE SPACE.          05480099
           05  FILLER                  PIC X(06)  VALUE 'RETAIL'.       05470099
           05  FILLER                  PIC X(25)  VALUE SPACE.          05480099
           05  FILLER                  PIC X(04)  VALUE 'COST'.         05490099
           05  FILLER                  PIC X(01)  VALUE SPACE.          05500099
      *                                                                 05510099
       01  TL-S1-TOTAL-LINE.                                            05520099
           05  TL-S1-TOTAL-LABEL       PIC X(22).                       05030099
           05  FILLER                  PIC X(05)   VALUE SPACES.        05040099
           05  TL-S1-SUBJECT           PIC X(10).                       05040099
           05  FILLER                  PIC X(40)   VALUE SPACES.        05040099
           05  TL-S1-ONHAND-QTY        PIC ZZ,ZZZ,ZZZ,ZZ9-.             05050099
           05  FILLER                  PIC X(11)   VALUE SPACES.        05060099
           05  TL-S1-EXT-RETAIL        PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05070099
           05  FILLER                  PIC X(11)   VALUE SPACES.        05080099
           05  TL-S1-EXT-COST          PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          05090099
      *                                                                 05580099
       01  TL-S1-FROM-LINE             REDEFINES TL-S1-TOTAL-LINE.      05520099
           05  TL-S1-FROM              PIC X(77).                       05030099
           05  FILLER                  PIC X(73).                       05040099
      *                                                                 05580099
       01  ER-END-OF-REPORT-LINE.                                       05590099
           05  FILLER                  PIC X(21)   VALUE                05600099
                                          '*** END OF REPORT ***'.      05610099
                                                                        05620099
       EJECT                                                            05630099
                                                                        05640099
      ******************************************************************06880099
       PROCEDURE DIVISION.                                              06890099
      ******************************************************************06900099
                                                                        06910099
      ******************************************************************06920099
       0000-MAINLINE-INKRP305.                                          06930099
      ******************************************************************06940099
      *                                                                 06950099
           PERFORM 1000-INITIALIZATION.                                 06960099
                                                                        06970099
           PERFORM 2000-MAIN-PROCESS                                    06980099
             UNTIL PS-RECLASS-FILE-EOF                                  06990099
                                                                                
           PERFORM 8000-EOJ.                                            07000099
                                                                        07010099
           STOP RUN.                                                    07020099
                                                                        07030099
       EJECT                                                            07040099
                                                                        07050099
      ******************************************************************07060099
       1000-INITIALIZATION.                                             07070099
      ******************************************************************07080099
      *                                                                 07090099
           OPEN INPUT  SELECT-RECLASS-XTR-FILE                          07100099
                                                                                
           OPEN OUTPUT RECLS-DETAIL-RPT-FILE                            07110099
                       RECLS-SUMMARY-RPT-FILE                           07110099
                                                                             071
           PERFORM 2100-READ-RECLASS-XTR                                07220099
           MOVE IN052-STORE-NMBR     TO PV-PREV-STORE-NMBR                      
           MOVE IN052-FROM-DEPT      TO PV-CURR-FROM-DEPT                       
           MOVE IN052-FROM-MAJ-CLASS TO PV-CURR-FROM-MCL                        
           MOVE IN052-FROM-SUB-CLASS TO PV-CURR-FROM-SCL                     072
           MOVE PV-CURR-FROM         TO PV-PREV-FROM                            
                                                                                
           PERFORM 3000-BUILD-RPT-DETAIL-TITLE.                         07240099
           PERFORM 3050-WRITE-RPT-DETAIL-TITLE.                                 
                                                                        07270099
           PERFORM 3500-BUILD-RPT-SUM-TITLE.                                    
           PERFORM 3550-WRITE-RPT-SUM-TITLE.                                    
                                                                                
           INITIALIZE PV-L1-TOTALS.                                     07280099
           INITIALIZE PV-L2-TOTALS.                                     07280099
           INITIALIZE PV-L3-TOTALS.                                     07280099
                                                                        07300099
       EJECT                                                            07310099
                                                                        07550099
                                                                        07980099
      ******************************************************************07990099
       2000-MAIN-PROCESS.                                               08000099
      ******************************************************************08010099
      *                                                                 08020099
           IF IN052-STORE-NMBR GREATER THAN PV-PREV-STORE-NMBR                  
               PERFORM 2500-L1-PROCESSING                                       
               PERFORM 2600-L2-PROCESSING                                       
           END-IF.                                                              
                                                                                
           IF PV-CURR-FROM   > PV-PREV-FROM                                     
               PERFORM 2500-L1-PROCESSING                                       
           END-IF.                                                              
                                                                                
           IF PV-DTL-LINE-COUNT > PC-LINE-COUNT-MAX                             
               DISPLAY 'LINE COUNT BREAK = ' PV-DTL-LINE-COUNT                  
               PERFORM 3050-WRITE-RPT-DETAIL-TITLE                              
           END-IF.                                                              
                                                                                
           IF PV-SUM-LINE-COUNT > PC-LINE-COUNT-MAX                             
               DISPLAY 'LINE COUNT BREAK = ' PV-SUM-LINE-COUNT                  
               PERFORM 3550-WRITE-RPT-SUM-TITLE                                 
           END-IF.                                                              
                                                                                
           PERFORM 2200-PROCESS-DETAIL.                                         
                                                                                
           PERFORM 2100-READ-RECLASS-XTR.                               07220099
       EJECT                                                            08330099
                                                                        08340099
      ******************************************************************07560099
       2100-READ-RECLASS-XTR.                                           07320099
      ******************************************************************07560099
           READ SELECT-RECLASS-XTR-FILE  INTO IN052-SKU-DETAIL                  
               AT END                                                           
                   SET PS-RECLASS-FILE-EOF TO TRUE                              
               NOT AT END                                                       
                   MOVE IN052-FROM-DEPT      TO PV-CURR-FROM-DEPT               
                   MOVE IN052-FROM-MAJ-CLASS TO PV-CURR-FROM-MCL                
                   MOVE IN052-FROM-SUB-CLASS TO PV-CURR-FROM-SCL                
                   ADD +1              TO PC-ITEM-RECS-READ.            18070099
                                                                        18180099
       EJECT                                                            18190099
      ******************************************************************08830099
       2200-PROCESS-DETAIL.                                                     
      ******************************************************************08830099
           PERFORM 3400-BUILD-REPORT-DETAIL.                                    
           PERFORM 4000-ACCUM-L1-TOTALS.                                        
           WRITE RECLS-DETAIL-RPT-REC  FROM SL-D-SKU-LINE               08300099
               AFTER ADVANCING 1 LINE.                                  08320099
           ADD 1                         TO PV-DTL-LINE-COUNT.                  
                                                                                
      ******************************************************************08830099
       2500-L1-PROCESSING.                                                      
      ******************************************************************08830099
                                                                                
           PERFORM 3100-PRINT-L1-TOTALS                                         
           PERFORM 3600-PRINT-L1-SUM-TOTALS.                                    
           MOVE PV-CURR-FROM         TO PV-PREV-FROM.                           
           PERFORM 4200-ACCUM-L2-TOTALS.                                        
                                                                                
      ******************************************************************08830099
       2600-L2-PROCESSING.                                                      
      ******************************************************************08830099
                                                                                
           PERFORM 3200-PRINT-L2-TOTALS                                         
           PERFORM 3700-PRINT-L2-SUM-TOTALS                                     
           PERFORM 4300-ACCUM-L3-TOTALS                                         
           MOVE IN052-STORE-NMBR     TO PV-PREV-STORE-NMBR                      
           DISPLAY 'NEW STORE NUMBER = ' PV-PREV-STORE-NMBR                     
           PERFORM 3050-WRITE-RPT-DETAIL-TITLE.                                 
                                                                                
      ******************************************************************07560099
       3000-BUILD-RPT-DETAIL-TITLE.                                     07570099
      ******************************************************************07580099
      *                                                                 07590099
           ACCEPT PV-DATE-YYMMDD FROM DATE.                             07600099
           MOVE PV-DATE-YYMMDD-YY      TO DP150O-RUN-YEAR.              07610099
           MOVE PV-DATE-YYMMDD-MM      TO DP150O-RUN-MONTH.             07620099
           MOVE PV-DATE-YYMMDD-DD      TO DP150O-RUN-DAY.               07630099
           ACCEPT PV-TIME-HHMMSS FROM TIME.                             07640099
           MOVE PV-TIME-HHMMSS-HH      TO DP150O-RUN-HOUR.              07650099
           MOVE PV-TIME-HHMMSS-MM      TO DP150O-RUN-MINUTE.            07660099
           MOVE PC-INKRP305            TO DP150O-PROGRAM-NAME.          07670099
                                                                        07690099
           MOVE IN052-DATE-MMDDCCYY    TO H3-D-FROM-DATE.               07700099
           MOVE IN052-DATE-MMDDCCYY (9:2)                                       
                                       TO H3-D-FROM-YR.                         
                                                                        07750099
           MOVE IN052-CR-BATCH-NBR     TO PV-CR-BATCH-NBR               07760099
                                          H3-D-CR-BATCH-NBR.                    
           MOVE IN052-DR-BATCH-NBR     TO PV-DR-BATCH-NBR               07760099
                                          H3-D-DR-BATCH-NBR.                    
                                                                        07780099
           DISPLAY ' '.                                                 07811099
           DISPLAY '*** BATCH NUMBER FOR INKRP305 FOLLOWS ***'.         07812099
           DISPLAY PV-DR-BATCH-NBR.                                     07813099
           DISPLAY PV-CR-BATCH-NBR.                                     07814099
       EJECT                                                            07815099
                                                                        07816099
      ******************************************************************14890099
       3050-WRITE-RPT-DETAIL-TITLE.                                     14900099
      ******************************************************************14910099
      *                                                                 14920099
           MOVE 1                      TO DP150O-REPORT-NUMBER.         07680099
           ADD 1                       TO PV-DTL-PAGE-COUNT.            14930099
           MOVE PV-DTL-PAGE-COUNT      TO DP150O-PAGE-NUMBER.           14940099
           WRITE RECLS-DETAIL-RPT-REC                                   14950099
             FROM DP150O-STANDRD-HEADER-150-COLS                        14960099
               AFTER ADVANCING PAGE.                                    14970099
                                                                        14980099
           WRITE RECLS-DETAIL-RPT-REC FROM H2-D-HEADING2                14990099
               AFTER ADVANCING 1 LINE.                                  15000099
                                                                        15010099
           WRITE RECLS-DETAIL-RPT-REC FROM H3-D-HEADING3                15020099
               AFTER ADVANCING 1 LINE.                                  15030099
                                                                        15040099
           WRITE RECLS-DETAIL-RPT-REC FROM H4-D-HEADING4                15050099
               AFTER ADVANCING 2 LINES.                                 15060099
                                                                        15070099
           WRITE RECLS-DETAIL-RPT-REC FROM H5-D-HEADING5                15050099
               AFTER ADVANCING 1 LINES.                                 15060099
                                                                        15070099
           MOVE SPACES                 TO RECLS-DETAIL-RPT-REC.         15080099
           WRITE RECLS-DETAIL-RPT-REC                                   15090099
               AFTER ADVANCING 1 LINE.                                  15100099
                                                                        15110099
           MOVE +7                     TO PV-DTL-LINE-COUNT.            15120099
                                                                        15130099
       EJECT                                                            15140099
      ******************************************************************21564099
       3100-PRINT-L1-TOTALS.                                                    
      ******************************************************************21564099
                                                                                
           MOVE '***FROM DEPT TOTAL***'                                         
                                     TO TL-D1-TOTAL-LABEL                       
           MOVE PV-PREV-FROM         TO TL-D1-SUBJECT                           
           MOVE PV-L1-ONHAND-QTY     TO TL-D1-ONHAND-QTY                        
           MOVE PV-L1-EXT-RETAIL     TO TL-D1-EXT-RETAIL                        
           MOVE PV-L1-EXT-COST       TO TL-D1-EXT-COST.                         
           WRITE RECLS-DETAIL-RPT-REC FROM TL-D1-TOTAL-LINE                     
               AFTER ADVANCING 2 LINES.                                 15150099
           MOVE SPACES               TO RECLS-DETAIL-RPT-REC                    
           WRITE RECLS-DETAIL-RPT-REC                                           
               AFTER ADVANCING 1 LINES.                                 15150099
           ADD +3                      TO PV-DTL-LINE-COUNT.                    
                                                                                
      ******************************************************************21564099
       3200-PRINT-L2-TOTALS.                                                    
      ******************************************************************21564099
                                                                                
           MOVE '***  STORE TOTAL  ***'                                         
                                     TO TL-D1-TOTAL-LABEL                       
           MOVE PV-PREV-STORE-NMBR   TO TL-D1-SUBJECT                           
           MOVE PV-L2-ONHAND-QTY     TO TL-D1-ONHAND-QTY                        
           MOVE PV-L2-EXT-RETAIL     TO TL-D1-EXT-RETAIL                        
           MOVE PV-L2-EXT-COST       TO TL-D1-EXT-COST.                         
           WRITE RECLS-DETAIL-RPT-REC FROM TL-D1-TOTAL-LINE                     
               AFTER ADVANCING 2 LINES.                                 15150099
           ADD +2                      TO PV-DTL-LINE-COUNT.                    
                                                                                
      ******************************************************************21564099
       3300-PRINT-L3-TOTALS.                                                    
      ******************************************************************21564099
                                                                                
           MOVE '*** RECLASS TOTAL ***'                                         
                                     TO TL-D1-TOTAL-LABEL                       
           MOVE SPACES               TO TL-D1-SUBJECT                           
           MOVE PV-L3-ONHAND-QTY     TO TL-D1-ONHAND-QTY                        
           MOVE PV-L3-EXT-RETAIL     TO TL-D1-EXT-RETAIL                        
           MOVE PV-L3-EXT-COST       TO TL-D1-EXT-COST.                         
           WRITE RECLS-DETAIL-RPT-REC FROM TL-D1-TOTAL-LINE                     
               AFTER ADVANCING 2 LINES.                                 15150099
           ADD +2                      TO PV-DTL-LINE-COUNT.                    
                                                                                
      ******************************************************************08830099
       3400-BUILD-REPORT-DETAIL.                                                
      ******************************************************************08830099
           MOVE IN052-SKU-LINE-PART-1    TO SL-D-SKU-LINE-PART-1.               
           MOVE IN052-STORE-NMBR         TO SL-D-STORE-NMBR.                    
           MOVE IN052-ONHAND-QTY         TO SL-D-ONHAND-QTY                     
           MOVE IN052-UNT-RTL-AMT        TO SL-D-UNT-RTL-AMT                    
           MOVE IN052-EXT-RETAIL         TO SL-D-EXT-RETAIL                     
           MOVE IN052-UNT-COST-AMT       TO SL-D-UNT-COST-AMT                   
           MOVE IN052-EXT-COST           TO SL-D-EXT-COST.                      
                                                                                
      ******************************************************************07560099
       3500-BUILD-RPT-SUM-TITLE.                                        07570099
      ******************************************************************07580099
      *                                                                 07590099
           MOVE IN052-DATE-MMDDCCYY    TO H3-S-FROM-DATE.               07700099
           MOVE IN052-DATE-MMDDCCYY (9:2)                                       
                                       TO H3-S-FROM-YR.                         
                                                                        07750099
           MOVE IN052-CR-BATCH-NBR     TO PV-CR-BATCH-NBR               07760099
                                          H3-S-CR-BATCH-NBR.                    
           MOVE IN052-DR-BATCH-NBR     TO PV-DR-BATCH-NBR               07760099
                                          H3-S-DR-BATCH-NBR.                    
                                                                        07780099
       EJECT                                                            07815099
                                                                        07816099
      ******************************************************************14890099
       3550-WRITE-RPT-SUM-TITLE.                                        14900099
      ******************************************************************14910099
      *                                                                 14920099
           MOVE 2                      TO DP150O-REPORT-NUMBER.         07680099
           ADD 1                       TO PV-SUM-PAGE-COUNT.            14930099
           MOVE PV-SUM-PAGE-COUNT      TO DP150O-PAGE-NUMBER.           14940099
           WRITE RECLS-SUMMARY-RPT-REC                                  14950099
             FROM DP150O-STANDRD-HEADER-150-COLS                        14960099
               AFTER ADVANCING PAGE.                                    14970099
                                                                        14980099
           WRITE RECLS-SUMMARY-RPT-REC FROM H2-S-HEADING2               14990099
               AFTER ADVANCING 1 LINE.                                  15000099
                                                                        15010099
           WRITE RECLS-SUMMARY-RPT-REC FROM H3-S-HEADING3               15020099
               AFTER ADVANCING 1 LINE.                                  15030099
                                                                        15040099
           WRITE RECLS-SUMMARY-RPT-REC FROM H4-S-HEADING4               15050099
               AFTER ADVANCING 2 LINES.                                 15060099
                                                                        15070099
           WRITE RECLS-SUMMARY-RPT-REC FROM H5-S-HEADING5               15050099
               AFTER ADVANCING 1 LINES.                                 15060099
                                                                        15070099
           MOVE SPACES                 TO RECLS-SUMMARY-RPT-REC.        15080099
           WRITE RECLS-SUMMARY-RPT-REC                                  15090099
               AFTER ADVANCING 1 LINE.                                  15100099
                                                                        15110099
           MOVE +7                     TO PV-SUM-LINE-COUNT.            15120099
                                                                        15130099
       EJECT                                                            15140099
      ******************************************************************21564099
       3600-PRINT-L1-SUM-TOTALS.                                                
      ******************************************************************21564099
                                                                                
           MOVE PV-PREV-FROM         TO TL-S1-FROM                              
           MOVE PV-L1-ONHAND-QTY     TO TL-S1-ONHAND-QTY                        
           MOVE PV-L1-EXT-RETAIL     TO TL-S1-EXT-RETAIL                        
           MOVE PV-L1-EXT-COST       TO TL-S1-EXT-COST.                         
           WRITE RECLS-SUMMARY-RPT-REC FROM TL-S1-TOTAL-LINE                    
               AFTER ADVANCING 2 LINES.                                 15150099
           ADD +2                      TO PV-SUM-LINE-COUNT.                    
                                                                                
      ******************************************************************21564099
       3700-PRINT-L2-SUM-TOTALS.                                                
      ******************************************************************21564099
                                                                                
           MOVE '***  STORE TOTAL  ***'                                         
                                     TO TL-S1-TOTAL-LABEL                       
           MOVE PV-PREV-STORE-NMBR   TO TL-S1-SUBJECT                           
           MOVE PV-L2-ONHAND-QTY     TO TL-S1-ONHAND-QTY                        
           MOVE PV-L2-EXT-RETAIL     TO TL-S1-EXT-RETAIL                        
           MOVE PV-L2-EXT-COST       TO TL-S1-EXT-COST.                         
           WRITE RECLS-SUMMARY-RPT-REC FROM TL-S1-TOTAL-LINE                    
               AFTER ADVANCING 2 LINES.                                 15150099
           ADD +2                      TO PV-SUM-LINE-COUNT.                    
                                                                                
      ******************************************************************21564099
       3800-PRINT-L3-SUM-TOTALS.                                                
      ******************************************************************21564099
                                                                                
           MOVE '*** RECLASS TOTAL ***'                                         
                                     TO TL-S1-TOTAL-LABEL                       
           MOVE SPACES               TO TL-S1-SUBJECT                           
           MOVE PV-L3-ONHAND-QTY     TO TL-S1-ONHAND-QTY                        
           MOVE PV-L3-EXT-RETAIL     TO TL-S1-EXT-RETAIL                        
           MOVE PV-L3-EXT-COST       TO TL-S1-EXT-COST.                         
           WRITE RECLS-SUMMARY-RPT-REC FROM TL-S1-TOTAL-LINE                    
               AFTER ADVANCING 2 LINES.                                 15150099
           ADD +2                      TO PV-SUM-LINE-COUNT.                    
                                                                                
      ******************************************************************08830099
       4000-ACCUM-L1-TOTALS.                                                    
      ******************************************************************08830099
                                                                                
           ADD IN052-ONHAND-QTY          TO PV-L1-ONHAND-QTY                    
           ADD IN052-EXT-RETAIL          TO PV-L1-EXT-RETAIL                    
           ADD IN052-EXT-COST            TO PV-L1-EXT-COST.                     
                                                                                
      ******************************************************************08830099
       4200-ACCUM-L2-TOTALS.                                                    
      ******************************************************************08830099
                                                                                
           ADD PV-L1-ONHAND-QTY          TO PV-L2-ONHAND-QTY                    
           ADD PV-L1-EXT-RETAIL          TO PV-L2-EXT-RETAIL                    
           ADD PV-L1-EXT-COST            TO PV-L2-EXT-COST.                     
                                                                                
           MOVE ZEROS                    TO PV-L1-ONHAND-QTY                    
                                            PV-L1-EXT-RETAIL                    
                                            PV-L1-EXT-COST.                     
                                                                                
      ******************************************************************08830099
       4300-ACCUM-L3-TOTALS.                                                    
      ******************************************************************08830099
                                                                                
           ADD PV-L2-ONHAND-QTY          TO PV-L3-ONHAND-QTY                    
           ADD PV-L2-EXT-RETAIL          TO PV-L3-EXT-RETAIL                    
           ADD PV-L2-EXT-COST            TO PV-L3-EXT-COST.                     
                                                                                
           MOVE ZEROS                    TO PV-L2-ONHAND-QTY                    
                                            PV-L2-EXT-RETAIL                    
                                            PV-L2-EXT-COST.                     
                                                                                
      ******************************************************************21564099
       8000-EOJ.                                                        21570099
      ******************************************************************21580099
      *                                                                 21590099
           PERFORM 3100-PRINT-L1-TOTALS.                                21600099
           PERFORM 3600-PRINT-L1-SUM-TOTALS.                                    
           PERFORM 4200-ACCUM-L2-TOTALS.                                        
                                                                                
           PERFORM 3200-PRINT-L2-TOTALS.                                21600099
           PERFORM 3700-PRINT-L2-SUM-TOTALS                                     
           PERFORM 4300-ACCUM-L3-TOTALS                                         
                                                                                
           PERFORM 3300-PRINT-L3-TOTALS.                                21600099
           PERFORM 3800-PRINT-L3-SUM-TOTALS                                     
                                                                                
           WRITE RECLS-DETAIL-RPT-REC FROM ER-END-OF-REPORT-LINE                
               AFTER ADVANCING 2 LINES.                                 15150099
                                                                                
           WRITE RECLS-SUMMARY-RPT-REC FROM ER-END-OF-REPORT-LINE               
               AFTER ADVANCING 2 LINES.                                 15150099
                                                                                
           CLOSE SELECT-RECLASS-XTR-FILE                                21660099
                 RECLS-DETAIL-RPT-FILE                                  21670099
                 RECLS-SUMMARY-RPT-FILE.                                21670099
                                                                        21710099
       EJECT                                                            21720099
                                                                        21730099
      ******************************************************************23100099
       9900-COMMON-ABEND-ROUTINE.                                       23110099
      ******************************************************************23120099
      *                                                                 23130099
           DISPLAY AA-ABEND-LIT.                                        23140099
           DISPLAY AA-PROGRAM-LIT.                                      23150099
           DISPLAY AA-PARAGRAPH-LIT.                                    23160099
           DISPLAY AA-MESSAGE-LINE.                                     23170099
           DISPLAY ABEND-CODE.                                          23180099
                                                                        23190099
           PERFORM 9999-ABEND.                                          23200099
                                                                        23210099
       EJECT                                                            23220099
                                                                        23230099
       9999-ABEND.                                                              
                                                                                
           CALL 'ILBOABN0' USING ABEND-CODE.                            23440099
                                                                        23450099
