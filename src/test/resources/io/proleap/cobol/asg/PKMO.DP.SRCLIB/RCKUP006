000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKUP006.                                00050000
000600 AUTHOR.                 LARRY SCHLEICHER.                        00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            08-17-94.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*     ASN TRANSCRIPTION                                         * 00120000
001300*                                                               * 00130000
001400*  THIS PROGRAM WILL READ AN ASN EXTRACT FILE AND USE THE DATA  * 00140000
001500*  TO CREATE RECORDS IN THE TPKSLIP AND TPKITEM TABLES.         * 00150000
001600*                                                               * 00160000
001700***************************************************************** 00170000
001800*                                                               * 00180000
001900*  CHANGED 08/26/02 BY VINOD B                                  * 00190000
002000*   WR# 230ZZ IN THE COPYBOOK RCRD001, ADDED A NEW FIELD        * 00200000
002100*   RC001-SKU-NBR. CHANGED THE SIZE OF DL1-SEQ FROM X(03) TO    * 00210000
002200*   X(08). IN 4400-FORMAT-DETAIL-LINES PARAGRAPH, REPLACED THE  * 00220000
002300*   CODE TO MOVE VALUE OF RC001-SKU-SEQ-NBR TO DL1-SEQ WITH     * 00230000
002400*   MOVE VALUE OF RC001-SKU-NBR TO DL1-SEQ. DELETED THE CODE TO * 00240000
002500*   INSERT THE DEPARTMENT NUMBER VALUE TO THE TABLES 'TSHPTPO'  * 00250000
002600*   AND 'TAUSHPO'.                                              * 00260000
002700*                                                               * 00270000
002800***************************************************************** 00280000
003000*                                                               * 00300000
003100*  CHANGED 07/11/00 BY MIKE MACHNIK                             * 00310000
003200*   WR# 20868 MOVED CONTAINER FROM RCRD001 TO TPKSLIP           * 00320000
003300*                                                               * 00330000
003310*  CHANGED 12/01/11 BY CHRISTINE TWIEHAUS WR# 40574             * 00331007
003320*          POPULATE CARR-AUTH-ID ON TSHIPMT                     * 00332001
003400*                                                               * 00340000
003410*  CHG0260107  08-19-21  JIM HUNTER                             * 00341024
003420*              ADDED COPYBOOK DPWS991 TO MAKE THE CALL TO       * 00342024
003430*              DPKUT901 DYNAMIC.                                * 00343024
003440*              PARAGRAPH 4022-DELETE-RETRY-TSHPUNT HAS BEEN     * 00344024
003450*              COMMENTED OUT DUE TO SOME WARNINGS THAT IT WAS   * 00345024
003460*              GENERATING.  THE PERFORM OF THIS PARA HAD BEEN   * 00346024
003470*              COMMENTED OUT PREVIOUSLY.                        * 00347024
003480*        NOTE: DPWS991 FIELDS ARE USED IN DPPD000 & DPPD001     * 00348025
003500***************************************************************** 00350000
003600 ENVIRONMENT DIVISION.                                            00360000
003700***************************************************************** 00370000
003800                                                                  00380000
003900 CONFIGURATION SECTION.                                           00390000
004000                                                                  00400000
004100 SOURCE-COMPUTER.        IBM-3090.                                00410000
004200 OBJECT-COMPUTER.        IBM-3090.                                00420000
004300                                                                  00430000
004400 INPUT-OUTPUT SECTION.                                            00440000
004500                                                                  00450000
004600 FILE-CONTROL.                                                    00460000
004700                                                                  00470000
004800     SELECT ASN-TRANSCRIPT-EXTRACT-FILE                           00480000
004900         ASSIGN TO INP01                                          00490000
005000     FILE STATUS IS F-STAT.                                       00500000
005100     SELECT ASN-REPORT-FILE                                       00510000
005200         ASSIGN TO RPT01.                                         00520000
005300                                                                  00530000
005400     SELECT PO-REPORT-FILE                                        00540000
005500         ASSIGN TO RPT02.                                         00550000
005600                                                                  00560000
006900                                                                  00690000
007000******************************************************************00700000
007100 DATA DIVISION.                                                   00710000
007200******************************************************************00720000
007300                                                                  00730000
007400 FILE SECTION.                                                    00740000
007500                                                                  00750000
007600 FD  ASN-TRANSCRIPT-EXTRACT-FILE                                  00760000
007700     RECORDING MODE IS F                                          00770000
007800     LABEL RECORDS ARE STANDARD                                   00780000
007900     BLOCK CONTAINS 0 RECORDS.                                    00790000
008000                                                                  00800000
008100 01  ASN-TRANSCRIPT-EXTRACT-RECORD    PIC  X(600).                00810017
008200                                                                  00820000
008300 FD  ASN-REPORT-FILE                                              00830000
008400     RECORDING MODE IS F                                          00840000
008500     BLOCK CONTAINS 0  RECORDS.                                   00850000
008600 01  ASN-REPORT-RECORD               PIC  X(132).                 00860000
008700                                                                  00870000
008800 FD  PO-REPORT-FILE                                               00880000
008900     RECORDING MODE IS F                                          00890000
009000     BLOCK CONTAINS 0  RECORDS.                                   00900000
009100 01  PO-REPORT-RECORD                PIC  X(132).                 00910000
009200                                                                  00920030
012300                                                                  01230000
012400 WORKING-STORAGE SECTION.                                         01240000
012500                                                                  01250000
012600 01 F-STAT PIC 99.                                                01260000
012700 01  FILLER.                                                      01270000
012800     05  FILLER                      PIC  X(36)    VALUE          01280000
012900         ' ***** WORKING STORAGE PGM=RCKUP006 '.                  01290000
013000     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   01300000
013100     05  FILLER                      PIC  X(10)    VALUE          01310000
013200         ' LOCATION='.                                            01320000
013300     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   01330000
013400     05  FILLER                      PIC  X(06)    VALUE          01340000
013500         ' *****'.                                                01350000
013600 EJECT                                                            01360000
013700 01  PROGRAM-SWITCHES.                                            01370000
013800     05  PS-TVHTRIP-VALID-TIMESTMP-SW PIC X(01)      VALUE 'N'.   01380000
013900         88  PS-TVHTRIP-VALID-TIMESTMP               VALUE 'Y'.   01390000
014000         88  PS-TVHTRIP-NO-TIMESTMP                  VALUE 'N'.   01400000
014100     05  PS-VHTRIP-VEH-CHANGED-SW     PIC X(01)      VALUE 'N'.   01410000
014200         88  PS-VHTRIP-VEH-CHANGED                   VALUE 'Y'.   01420000
014300         88  PS-VHTRIP-VEH-DIDNT-CHANGE              VALUE 'N'.   01430000
014400     05  PS-VHTRIP-SCAC-CHANGED-SW    PIC X(01)      VALUE 'N'.   01440000
014500         88  PS-VHTRIP-SCAC-CHANGED                  VALUE 'Y'.   01450000
014600         88  PS-VHTRIP-SCAC-DIDNT-CHANGE             VALUE 'N'.   01460000
014700     05  PS-SHIPMENT-FOUND-SW         PIC X(01)      VALUE 'N'.   01470000
014800         88  PS-SHIPMENT-FOUND                       VALUE 'Y'.   01480000
014900         88  PS-SHIPMENT-NOT-FOUND                   VALUE 'N'.   01490000
015000     05  PS-VALID-VENDOR-SW           PIC X(01)      VALUE 'N'.   01500000
015100         88  PS-VALID-VENDOR                         VALUE 'Y'.   01510000
015200         88  PS-INVALID-VENDOR                       VALUE 'N'.   01520000
015300     05  PS-UPDATE-SHIPMT-SW          PIC X(01)      VALUE 'X'.   01530000
015400         88  PS-UPDATE-SHIPMT                        VALUE 'Y'.   01540000
015500         88  PS-INSERT-SHIPMT                        VALUE 'N'.   01550000
015600         88  PS-BYPASS-SHIPMT                        VALUE 'B'.   01560000
015700         88  PS-DONT-UPDATE-SHIPMT                   VALUE 'D'.   01570000
015800     05  PS-UPDATE-SHIPST-SW          PIC X(01)      VALUE 'X'.   01580000
015900         88  PS-UPDATE-SHIPST                        VALUE 'Y'.   01590000
016000         88  PS-INSERT-SHIPST                        VALUE 'N'.   01600000
016100         88  PS-BYPASS-SHIPST                        VALUE 'B'.   01610000
016200     05  PS-UPDATE-VEHICL-SW          PIC X(01)      VALUE 'X'.   01620000
016300         88  PS-UPDATE-VEHICL                        VALUE 'Y'.   01630000
016400         88  PS-INSERT-VEHICL                        VALUE 'N'.   01640000
016500         88  PS-BYPASS-VEHICL                        VALUE 'B'.   01650000
016600         88  PS-DONT-UPDATE-VEHICL                   VALUE 'D'.   01660000
016700     05  PS-UPDATE-VHTRIP-SW          PIC X(01)      VALUE 'X'.   01670000
016800         88  PS-UPDATE-VHTRIP                        VALUE 'Y'.   01680000
016900         88  PS-INSERT-VHTRIP                        VALUE 'N'.   01690000
017000         88  PS-ADD-NEXT-VHTRIP                      VALUE 'A'.   01700000
017100         88  PS-DONT-UPDATE-VHTRIP                   VALUE 'D'.   01710000
017200     05  PS-UPDATE-TRIPST-SW          PIC X(01)      VALUE 'X'.   01720000
017300         88  PS-UPDATE-TRIPST                        VALUE 'Y'.   01730000
017400         88  PS-INSERT-TRIPST                        VALUE 'N'.   01740000
017500         88  PS-BYPASS-TRIPST                        VALUE 'B'.   01750000
017600     05  PS-FORECAST-SHIP-SW          PIC X(01)    VALUE 'N'.     01760000
017700         88  PS-FORECAST-SHIP-MODE                 VALUE 'Y'.     01770000
017800         88  PS-NOT-FORECAST-SHIP-MODE             VALUES         01780000
017900                                                   ' ' 'N'.       01790000
018000         88  PS-FORECAST-SHIP-MODE-OFF             VALUE 'N'.     01800000
018100     05  PS-VALID-DC-SW               PIC X(01)    VALUE 'N'.     01810000
018200         88  PS-VALID-DC                           VALUE 'Y'.     01820000
018300         88  PS-INVALID-DC                         VALUE 'N'.     01830000
018400     05  PS-VALID-STORE-SW            PIC X(01)    VALUE 'N'.     01840000
018500         88  PS-VALID-STORE                        VALUE 'Y'.     01850000
018600         88  PS-INVALID-STORE                      VALUE 'N'.     01860000
018700     05  PS-DUPLICATE-SHIPMT-SW      PIC  X(01)    VALUE 'N'.     01870000
018800         88  PS-DUPLICATE-SHIPMT                   VALUE 'Y'.     01880000
018900         88  PS-NO-DUPLICATE-SHIPMT                VALUE 'N'.     01890000
019000     05  PS-HEADER-PRINTED-IND       PIC  X(01)    VALUE 'N'.     01900000
019100         88  PS-HEADER-PRINTED                     VALUE 'Y'.     01910000
019200         88  PS-HEADER-NOT-PRINTED                 VALUE 'N'.     01920000
019300     05  PS-CREATE-PKSLIP-IND        PIC  X(01)    VALUE 'Y'.     01930000
019400         88  PS-CREATE-PKSLIP                      VALUE 'Y'.     01940000
019500         88  PS-DO-NOT-CREATE-PKSLIP               VALUE 'N'.     01950000
019600     05  PS-END-OF-ITM-QTY-CSR-IND   PIC  X(01)    VALUE 'N'.     01960000
019700         88  PS-END-OF-ITM-QTY-CSR                 VALUE 'Y'.     01970000
019800     05  PS-FIRST-ASN-HEADER-IND     PIC  X(01)    VALUE 'Y'.     01980000
019900         88  PS-FIRST-ASN-HEADER                   VALUE 'Y'.     01990000
020000         88  PS-NOT-FIRST-ASN-HEADER               VALUE 'N'.     02000000
020100     05  PS-MORE-ANS-RECS-IND        PIC  X(01)    VALUE 'Y'.     02010000
020200         88  PS-MORE-ASN-RECS                      VALUE 'Y'.     02020000
020300         88  PS-NO-MORE-ASN-RECS                   VALUE 'N'.     02030000
020400     05  PS-NO-TRECITM-RECS-IND      PIC  X(01)    VALUE 'Y'.     02040000
020500         88  PS-NO-TRECITM-RECS                    VALUE 'N'.     02050000
020600         88  PS-TRECITM-RECS                       VALUE 'Y'.     02060000
020700     05  PS-PLAN-SW                  PIC  X        VALUE 'M'.     02070000
020800         88  PS-MASTER-PLAN                        VALUE 'M'.     02080000
020900         88  PS-SPECIFIC-PLAN                      VALUE 'S'.     02090000
021000     05  PS-MORE-RECEIPT-SW          PIC  X        VALUE 'Y'.     02100000
021100         88  PS-NO-MORE-RECEIPT                    VALUE 'N'.     02110000
021200         88  PS-MORE-RECEIPT                       VALUE 'Y'.     02120000
021300     05  PS-DISTRO-EXISTS-SW         PIC  X        VALUE 'N'.     02130000
021400         88  PS-DISTRO-EXISTS                      VALUE 'N'.     02140000
021500         88  PS-NO-DISTRO-EXISTS                   VALUE 'Y'.     02150000
021600     05  PS-DONE-SW                  PIC  X        VALUE 'N'.     02160000
021700         88  PS-NOT-DONE                           VALUE 'N'.     02170000
021800         88  PS-DONE                               VALUE 'Y'.     02180000
021900     05  PS-END-OF-ASN-HEADERS-IND   PIC  X(01)    VALUE 'N'.     02190000
022000         88  PS-END-OF-ASN-HEADERS                 VALUE 'Y'.     02200000
022100         88  PS-NOT-END-OF-ASN-HEADERS             VALUE 'N'.     02210000
022200     05  PS-END-OF-ASN-DETAIL-IND    PIC  X(01)    VALUE 'N'.     02220000
022300         88  PS-END-OF-ASN-DETAIL                  VALUE 'Y'.     02230000
022400         88  PS-NOT-END-OF-ASN-DETAIL              VALUE 'N'.     02240000
022500     05  PS-ASN-RECS-PROCESSED-IND   PIC  X(01)    VALUE 'N'.     02250000
022600         88  PS-ASN-RECS-PROCESSED                 VALUE 'Y'.     02260000
022700         88  PS-NO-ASN-RECS-PROCESSED              VALUE 'N'.     02270000
022800     05  PS-FIRST-HEADER-IND         PIC  X(01)    VALUE 'Y'.     02280000
022900         88  PS-FIRST-HEADER                       VALUE 'Y'.     02290000
023000         88  PS-NOT-FIRST-HEADER                   VALUE 'N'.     02300000
023100     05  PS-PROCESS-ASN-IND          PIC  X(01)    VALUE 'Y'.     02310000
023200         88  PS-PROCESS-ASN                        VALUE 'Y'.     02320000
023300         88  PS-SKIP-ASN                           VALUE 'N'.     02330000
023400     05  PS-NO-MORE-INST-SW          PIC  X(01)    VALUE 'N'.     02340000
023500         88  PS-NO-MORE-INST                       VALUE 'Y'.     02350000
023600         88  PS-MORE-INST                          VALUE 'N'.     02360000
023700     05  PS-BYPASS-UPDATES-SW        PIC  X(01)    VALUE 'N'.     02370000
023800         88  PS-BYPASS-UPDATES                     VALUE 'Y'.     02380000
023900         88  PS-DO-NOT-BYPASS-UPDATES              VALUE 'N'.     02390000
024000     05  PS-ZERO-LINE-FOUND-SW       PIC  X(01)    VALUE 'N'.     02400000
024100         88  ZERO-LINE-NOTFOUND                    VALUE 'Y'.     02410000
024200         88  ZERO-LINE-FOUND                       VALUE 'N'.     02420000
024300     05  PS-CARTON-FOUND-SW          PIC  X(01)    VALUE 'N'.     02430000
024400         88  CARTON-NOTFOUND                       VALUE 'Y'.     02440000
024500         88  CARTON-FOUND                          VALUE 'N'.     02450000
024600     05  PS-WRITE-CTN-REC-SW         PIC  X(01)    VALUE 'N'.     02460000
024700         88  PS-WRITE-CTN-REC-YES                  VALUE 'Y'.     02470000
024800         88  PS-WRITE-CTN-REC-NO                   VALUE 'N'.     02480000
024900     05  PS-FALLOUT-REC-WRITTEN-SW   PIC  X(01)    VALUE 'N'.     02490000
025000         88  PS-FALLOUT-REC-WRITTEN-YES            VALUE 'Y'.     02500000
025100         88  PS-FALLOUT-REC-WRITTEN-NO             VALUE 'N'.     02510000
025110     05  PS-ADD-TSHPUNT-TRY-SW       PIC  X(01)    VALUE '1'.     02511000
025120         88  PS-ADD-TSHPUNT-1ST-TRY                VALUE '1'.     02512001
025130         88  PS-ADD-TSHPUNT-2ND-TRY                VALUE '2'.     02513001
025140     05  PS-DUPE-TSHPUNT-SW          PIC  X(01)    VALUE 'N'.     02514001
025150         88  PS-DUPE-TSHPUNT-YES                   VALUE 'Y'.     02515001
025160         88  PS-DUPE-TSHPUNT-NO                    VALUE 'N'.     02516001
025170                                                                  02517001
025180 01  DK-DB2-KEYS.                                                 02518001
025190     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   02519001
025200     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    02520001
025300     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   02530001
025700     05  DK-ORD-LNE-NBR               PIC S9(09) COMP VALUE +0.   02570000
025800     05  DK-OPER-UNT-ID               PIC S9(04) COMP VALUE +0.   02580000
025900     05  DK-FCLTY-ID                  PIC S9(04) COMP VALUE +0.   02590000
026000     05  DK-RCVR-SEQ-NBR              PIC S9(09) COMP VALUE +0.   02600000
026100     05  DK-STR-NBR                   PIC S9(04) COMP VALUE +0.   02610000
026200     05  DK-PRO-SCAC-ID               PIC  X(04)  VALUE SPACES.   02620000
026300     05  DK-PRO-NBR                   PIC  X(22)  VALUE SPACES.   02630000
026400     05  DK-BOL-NBR                   PIC  X(30)  VALUE SPACES.   02640000
026500     05  DK-DUN-NBR                   PIC  X(09)  VALUE SPACES.   02650000
026600                                                                  02660000
026700***************************************************************** 02670000
026800* REMOVED FIELD DEFINITION OF PC-DASH.** WR # 230ZZ.            * 02680000
026900***************************************************************** 02690000
027000 01  PC-CONSTANTS.                                                02700000
027100     05  PC-NEG-1                     PIC S9(03)     VALUE -1     02710000
027200                                                     COMP-3.      02720000
027300     05  PC-POS-1                     PIC S9(03)     VALUE +1     02730000
027400                                                     COMP-3.      02740000
027500     05  PC-1                        PIC  9(01)    VALUE 1.       02750000
027600     05  PC-0                        PIC  9(01)    VALUE 0.       02760000
027700     05  PC-0-COMP-3                 PIC S9(15)    VALUE 0        02770000
027800                                                   COMP-3.        02780000
027900     05  PC-2                        PIC S9(03)    VALUE +2       02790000
028000                                                   COMP-3.        02800000
028100     05  PC-3                        PIC S9(03)    VALUE +3       02810000
028200                                                   COMP-3.        02820000
028300     05  PC-4                        PIC S9(03)    VALUE +4       02830000
028400                                                   COMP-3.        02840000
028500     05  PC-5                        PIC S9(03)    VALUE +5       02850000
028600                                                   COMP-3.        02860000
028700     05  PC-12                       PIC S9(03)    VALUE +12      02870000
028800                                                   COMP-3.        02880000
028900     05  PC-58                       PIC S9(03)    VALUE +58      02890000
029000                                                   COMP-3.        02900000
029100     05  PC-60                       PIC S9(03)    VALUE +60      02910000
029200                                                   COMP-3.        02920000
029300     05  PC-61                       PIC S9(03)    VALUE +61      02930000
029400                                                   COMP-3.        02940000
029500     05  PC-99                       PIC S9(03)    VALUE +99      02950000
029600                                                   COMP-3.        02960000
029700     05  PC-ONE                      PIC  X(01)    VALUE '1'.     02970000
029800     05  PC-SPACE                    PIC  X(01)    VALUE SPACE.   02980000
029900     05  PC-ZERO                     PIC  X(01)    VALUE '0'.     02990000
030000     05  PC-00                       PIC  X(02)    VALUE '00'.    03000000
030100     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     03010000
030200     05  PC-01                       PIC  X(02)    VALUE '01'.    03020000
030300     05  PC-03                       PIC  X(02)    VALUE '03'.    03030000
030400     05  PC-05                       PIC  X(02)    VALUE '05'.    03040000
030500     05  PC-06                       PIC  X(02)    VALUE '06'.    03050000
030600     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   03060000
030700     05  PC-TR                       PIC  X(02)    VALUE 'TR'.    03070000
030800     05  PC-PO                       PIC  X(02)    VALUE 'PO'.    03080000
030900     05  PC-EN                       PIC  X(02)    VALUE 'EN'.    03090000
031000     05  PC-ASN                      PIC  X(04)    VALUE 'ASN '.  03100000
031100     05  PC-ASN-3                    PIC  X(03)    VALUE 'ASN'.   03110000
031200     05  PC-C                        PIC  X(01)    VALUE 'C'.     03120000
031300     05  PC-A                        PIC  X(01)    VALUE 'A'.     03130000
031400     05  PC-AC                       PIC  X(02)    VALUE 'AC'.    03140000
031500     05  PC-CA                       PIC  X(02)    VALUE 'CA'.    03150000
031600     05  PC-CB                       PIC  X(02)    VALUE 'CB'.    03160000
031700     05  PC-CM                       PIC  X(02)    VALUE 'CM'.    03170000
031800     05  PC-IN                       PIC  X(02)    VALUE 'IN'.    03180000
031900     05  PC-IP                       PIC  X(02)    VALUE 'IP'.    03190000
032000     05  PC-VE                       PIC  X(02)    VALUE 'VE'.    03200000
032100     05  PC-D1                       PIC  X(02)    VALUE 'D1'.    03210000
032200     05  PC-CE                       PIC  X(02)    VALUE 'CE'.    03220000
032300     05  PC-30                       PIC  X(02)    VALUE '30'.    03230000
032400     05  PC-49                       PIC  X(02)    VALUE '49'.    03240000
032500     05  PC-95                       PIC  X(02)    VALUE '95'.    03250000
032600     05  PC-INT-ZERO                 PIC S9(9)     VALUE +0       03260000
032700                                                   COMP.          03270000
032800     05  PC-SML-ZERO                 PIC S9(4)     VALUE +0       03280000
032900                                                   COMP.          03290000
033000     05  PC-DUMMY-RECVD-DATE-122593  PIC  9(06)    VALUE 122593.  03300000
033100     05  PC-DUMMY-RECVD-DATE-DB2-122593                           03310000
033200                                     PIC  X(10)    VALUE          03320000
033300                                                   '1993-12-25'.  03330000
033400     05  PC-N                        PIC  X(01)    VALUE 'N'.     03340000
033500     05  PC-XX                       PIC  X(02)    VALUE 'XX'.    03350000
033600     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          03360000
033700                                                   'RCKUP006'.    03370000
033800     05  PC-RCKUP006                 PIC  X(08)    VALUE          03380000
033900                                                   'RCKUP006'.    03390000
034000     05  PC-TRKUP004                 PIC  X(08)    VALUE          03400000
034100                                                   'TRKUP004'.    03410000
034200     05  PC-RANDNBR-PGM               PIC X(08)    VALUE          03420000
034300                                                   'DPKUT902'.    03430000
034400     05  PC-OPEN-FUNC                PIC X(05)     VALUE 'OPEN '. 03440000
034500     05  PC-TRANS-FUNC               PIC X(05)     VALUE 'TRANS'. 03450000
034600     05  PC-CLOSE-FUNC               PIC X(05)     VALUE 'CLOSE'. 03460000
034700     05  PC-RSTRT-FUNC               PIC X(05)     VALUE 'RSTRT'. 03470000
034800     05  PV-CKPT-JOB-NAME            PIC X(08)   VALUE SPACES.    03480000
034820         88  PV-JOB-RCK010                       VALUE 'RCK010  '.03482001
034830     05  PC-CKPT-PLAN-NAME           PIC X(08)   VALUE 'RCKUP006'.03483001
035000     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       03500000
035100     05  PC-REPORT-NBR-2             PIC  9(01)    VALUE 2.       03510000
035200     05  PC-ILBOABN0                 PIC  X(08)    VALUE          03520000
035300                                                   'ILBOABN0'.    03530000
035400     05  PC-MAX-RETRIES              PIC S9(04)    VALUE  +3      03540000
035500                                                   COMP.          03550000
035600     05  PC-UNKNOWN                  PIC  X(07)    VALUE          03560000
035700                                                   'UNKNOWN'.     03570000
035800     05  PC-DEFAULT-PKG-CTN          PIC  X(03)    VALUE 'CTN'.   03580000
035900     05  PC-DEFAULT-SHIPT-STAT-AF    PIC  X(02)    VALUE 'AF'.    03590000
036000     05  PC-DEFAULT-SHIPT-STAT-EN    PIC  X(02)    VALUE 'EN'.    03600000
036100     05  PC-DEFAULT-SHIPT-TYP-CDE    PIC S9(04)    VALUE +1       03610000
036200                                                   COMP.          03620000
036300     05  PC-DEFAULT-DATE             PIC  X(10)    VALUE          03630000
036400                                     '0001-01-01'.                03640000
036500     05  PC-DEFAULT-TIME             PIC  X(08)    VALUE          03650000
036600                                     '00.00.00'.                  03660000
036700     05  PC-BOL-SPACES               PIC  X(30)    VALUE SPACES.  03670000
036800     05  PC-PRO-SPACES               PIC  X(22)    VALUE SPACES.  03680000
036900     05  PC-HL0-TITLE-REALTIME       PIC  X(20)    VALUE          03690000
037000         '  REALTIME FALLOUT: '.                                  03700000
037100***************************************************************** 03710000
037200* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        * 03720000
037300***************************************************************** 03730000
037400                                                                  03740000
037500                                                                  03750000
037600 01  PC-GENERAL-ERROR-MESSAGES.                                   03760000
037700     05  PC-GEN-ERR-MSG-1            PIC  X(25)    VALUE          03770000
037800         'SHIPPED EARLY            '.                             03780000
037900     05  PC-GEN-ERR-MSG-2            PIC  X(25)    VALUE          03790000
038000         'SHIPPED LATE             '.                             03800000
038100     05  PC-GEN-ERR-MSG-3            PIC  X(25)    VALUE          03810000
038200         'UNMATCHED PURCHASE ORDER '.                             03820000
038300     05  PC-GEN-ERR-MSG-4            PIC  X(25)    VALUE          03830000
038400         'PO CANCELLED OR COMPLETE '.                             03840000
038500     05  PC-GEN-ERR-MSG-5            PIC  X(25)    VALUE          03850000
038600         'STORE INVALID            '.                             03860000
038700                                                                  03870000
038800 01  PC-DETAIL-ERROR-MESSAGES.                                    03880000
038900     05  PC-DTL-ERR-MSG-1            PIC  X(17)    VALUE          03890000
039000         'PO LINE ------ NT'.                                     03900000
039100     05  PC-DTL-ERR-MSG-2            PIC  X(17)    VALUE          03910000
039200         'PRICE DISCR -- NT'.                                     03920000
039300     05  PC-DTL-ERR-MSG-3            PIC  X(17)    VALUE          03930000
039400         '085 DISTRO --- NT'.                                     03940000
039500     05  PC-DTL-ERR-MSG-4.                                        03950000
039600         10  FILLER                  PIC  X(04)    VALUE 'CHG '.  03960000
039700         10  PC-DEM4-DAYS            PIC  9(02).                  03970000
039800         10  FILLER                  PIC  X(11)    VALUE          03980000
039900             ' DAYS -- NT'.                                       03990000
040000     05  PC-DTL-ERR-MSG-5.                                        04000000
040100         10  FILLER                  PIC  X(10)    VALUE          04010000
040200             'PRICE CHG '.                                        04020000
040300         10  PC-DEM5-DAYS            PIC  9(02).                  04030000
040400         10  FILLER                  PIC  X(05)    VALUE ' DAYS'. 04040000
040500     05  PC-DTL-ERR-MSG-6.                                        04050000
040600         10  FILLER                  PIC  X(05)    VALUE 'OVER '. 04060000
040700         10  PC-DEM6-PCT             PIC  Z(03).                  04070000
040800         10  FILLER                  PIC  X(09)    VALUE          04080000
040900             '% ---- NT'.                                         04090000
041000     05  PC-DTL-ERR-MSG-7.                                        04100000
041100         10  FILLER                  PIC  X(05)    VALUE 'OVER '. 04110000
041200         10  PC-DEM7-PCT             PIC  Z(03).                  04120000
041300         10  FILLER                  PIC  X(09)    VALUE          04130000
041400             '%        '.                                         04140000
041500     05  PC-DTL-ERR-MSG-8.                                        04150000
041600         10  FILLER                  PIC  X(06)    VALUE 'SHORT '.04160000
041700         10  PC-DEM8-PCT             PIC  Z(03).                  04170000
041800         10  FILLER                  PIC  X(08)    VALUE          04180000
041900             '% --- NT'.                                          04190000
042000     05  PC-DTL-ERR-MSG-9.                                        04200000
042100         10  FILLER                  PIC  X(06)    VALUE 'SHORT '.04210000
042200         10  PC-DEM9-PCT             PIC  Z(03).                  04220000
042300         10  FILLER                  PIC  X(08)    VALUE          04230000
042400             '%       '.                                          04240000
042500     05  PC-DTL-ERR-MSG-10           PIC  X(17)    VALUE          04250000
042600         'LESS THAN CASEPCK'.                                     04260000
042700     05  PC-CANCELLED                PIC  X(17)    VALUE          04270000
042800             'CANCELLED PO     '.                                 04280000
042900     05  PC-CANCELLED-BAL            PIC  X(17)    VALUE          04290000
043000             'CANCELLED BALANCE'.                                 04300000
043100     05  PC-COMPLETE                 PIC  X(17)    VALUE          04310000
043200             'COMPLETE         '.                                 04320000
043300     05  PC-DTL-ERR-MSG-13           PIC  X(17)    VALUE          04330000
043400         'ZERO SHIP QTY--NT'.                                     04340000
043500     05  PC-DTL-ERR-MSG-14           PIC  X(17)    VALUE          04350000
043600         'INVALID STORE--NT'.                                     04360000
043700 EJECT                                                            04370000
043800                                                                  04380000
043900 01  PV-NULL-INDICATORS.                                          04390000
044000     05  PV-VEHICL-CURR-TRIP-ID-NULL PIC S9(04)    COMP.          04400000
044100     05  PV-VHTRIP-VEH-NBR-NULL       PIC S9(04)     VALUE +0     04410000
044200                                                     COMP SYNC.   04420000
044300     05  PV-VHTRIP-EST-AR-NULL        PIC S9(4)      VALUE +0     04430000
044400                                                     COMP SYNC.   04440000
044500     05  PV-SHIPMT-EST-AR-NULL        PIC S9(4)      VALUE +0     04450000
044600                                                     COMP SYNC.   04460000
044700     05  PV-AUTRIP-VEH-NBR-NULL       PIC S9(04)     VALUE +0     04470000
044800                                                     COMP SYNC.   04480000
044900     05  PV-SHIPMT-TRIP-ID-NULL       PIC S9(04)     VALUE +0     04490000
045000                                                     COMP SYNC.   04500000
045100     05  PV-AUSHIP-TRIP-ID-NULL       PIC S9(04)     VALUE +0     04510000
045200                                                     COMP SYNC.   04520000
045300                                                                  04530000
045400 01  PV-PKSLIP-RECORD.                                            04540000
045500     05  PV-PKSLIP-SHIPT-ID           PIC S9(09)     VALUE +0     04550000
045600                                                     COMP.        04560000
045700                                                                  04570000
045800 01  PV-SHIPMT-RECORD.                                            04580000
045900     05  PV-SHIPMT-TRIP-ID            PIC S9(09)     VALUE +0     04590000
046000                                                     COMP.        04600000
046100     05  PV-SHIPT-ID                  PIC S9(09)     VALUE ZEROS  04610000
046200                                                     COMP.        04620000
046300     05  PV-TRIP-ID                   PIC S9(09)     VALUE ZEROS  04630000
046400                                                     COMP.        04640000
046500     05  PV-SAVE-SHIPMT-TRIP-ID       PIC S9(09)     VALUE +0     04650000
046600                                                     COMP.        04660000
046700     05  PV-SHIPMT-SHIPT-ID           PIC S9(09)     VALUE +0     04670000
046800                                                     COMP.        04680000
046900     05  PV-SAVE-OWNER-SCAC-ID        PIC X(04)      VALUE SPACE. 04690000
047000     05  PV-SAVE-LSD-CARR-ID          PIC X(04)      VALUE SPACE. 04700000
047100     05  PV-SAVE-VHTRIP-VEH-NBR       PIC X(10)      VALUE SPACE. 04710000
047200     05  PV-SAVE-CARR-SCAC            PIC X(04)      VALUE SPACE. 04720000
047300     05  PV-SAVE-VEH-NBR              PIC X(10)      VALUE SPACE. 04730000
047400     05  PV-SHIPMT-CRT-SRC-CDE        PIC X(02)      VALUE SPACE. 04740000
047500     05  PV-SHIPMT-LAST-UPD-DTE       PIC X(10)      VALUE SPACE. 04750000
047600     05  PV-SHIPMT-LAST-UPD-TME       PIC X(08)      VALUE SPACE. 04760000
047700     05  PV-SHIPMT-LAST-UPD-UID       PIC X(08)      VALUE SPACE. 04770000
047800     05  PV-SHIPMT-ORIGIN-SCAC-ID     PIC X(04)      VALUE SPACE. 04780000
047900     05  PV-SHIPMT-PRO-SCAC-ID        PIC X(04)      VALUE SPACE. 04790000
048000     05  PV-SHIPMT-PRO-NBR            PIC X(22)      VALUE SPACE. 04800000
048020     05  PV-SHIPMT-CARR-AUTH-ID       PIC X(30)      VALUE SPACE. 04802002
048100     05  PV-SHIPMT-BOL-NBR            PIC X(30)      VALUE SPACE. 04810000
048200     05  PV-SHIPMT-COMP-PRO           PIC X(22)      VALUE SPACE. 04820000
048300     05  PV-SHIPMT-COMP-BOL           PIC X(30)      VALUE SPACE. 04830000
048400     05  PV-SHIPMT-SHIPPER-NME        PIC X(20)      VALUE SPACE. 04840000
048500     05  PV-SHIPMT-SHIPT-TYP-CDE      PIC S9(04)     VALUE +0     04850000
048600                                                     COMP.        04860000
048700     05  PV-SHIPMT-EXPTED-GRO-WGHT    PIC S9(09)     VALUE +0     04870000
048800                                                     COMP.        04880000
048900     05  PV-SHIPMT-PKG-TYP-CDE        PIC X(03)      VALUE SPACE. 04890000
049000     05  PV-SHIPMT-EXPTED-PKG-QTY     PIC S9(09)     VALUE +0     04900000
049100                                                     COMP.        04910000
049200     05  PV-SHIPMT-FRGT-CHG-AMT       PIC S9(05)V99  VALUE +0     04920000
049300                                                     COMP-3.      04930000
049400     05  PV-SHIPMT-FRGT-TERMS-CDE     PIC X(01)      VALUE SPACE. 04940000
049500     05  PV-SHIPMT-VEND-SHIP-DTE      PIC X(10)      VALUE SPACES.04950000
049600     05  PV-SHIPMT-EXPTED-PLT-QTY     PIC S9(9)      VALUE +0     04960000
049700                                                     COMP.        04970000
049800     05  PV-SHIPMT-EST-AR-TMST        PIC X(26)      VALUE SPACES.04980000
049900     05  PV-SHIPMT-CARR-CARTON-CNT    PIC S9(09)     VALUE +0     04990000
050000                                                     COMP-3.      05000000
050100     05  PV-SHIPMT-VEND-CARTON-CNT    PIC S9(09)     VALUE +0     05010000
050200                                                     COMP-3.      05020000
050300     05  PV-SHIPMT-VEH-NBR            PIC X(10)      VALUE SPACES.05030000
050400                                                                  05040000
050500 01  PV-VEHICL-RECORD.                                            05050000
050600     05  PV-VEHICL-OWNER-SCAC-ID      PIC X(04)      VALUE SPACE. 05060000
050700     05  PV-VEHICL-VEH-NBR            PIC X(10)      VALUE SPACE. 05070000
050800     05  PV-VEHICL-CURR-TRIP-ID       PIC S9(09)     VALUE +0     05080000
050900                                                     COMP.        05090000
051000     05  PV-VEHICL-CRT-SRC-CDE        PIC X(02)      VALUE SPACE. 05100000
051100     05  PV-VEHICL-CURR-STATUS-CDE                                05110000
051200                                      PIC X(02)      VALUE SPACE. 05120000
051300     05  PV-VEHICL-CURR-PRTY-CDE      PIC X(02)      VALUE SPACE. 05130000
051400     05  PV-VEHICL-CURR-OPER-UNT-ID                               05140000
051500                                      PIC S9(04)     VALUE +0     05150000
051600                                                     COMP.        05160000
051700     05  PV-VEHICL-CURR-FCLTY-ID      PIC S9(04)     VALUE +0     05170000
051800                                                     COMP.        05180000
051900     05  PV-VEHICL-CURR-FAC-AREA-ID                               05190000
052000                                      PIC X(06)      VALUE SPACE. 05200000
052100     05  PV-VEHICL-CARR-SCAC-ID       PIC X(04)      VALUE SPACE. 05210000
052200                                                                  05220000
052300 01  PV-VHTRIP-RECORD.                                            05230000
052400     05  PV-VHTRIP-OWNER-SCAC-ID      PIC X(04)      VALUE SPACES.05240000
052500     05  PV-VHTRIP-VEH-NBR            PIC X(10)      VALUE SPACES.05250000
052600     05  PV-VHTRIP-TRIP-ID            PIC S9(09)     VALUE +0     05260000
052700                                                     COMP.        05270000
052800     05  PV-VHTRIP-REF-TRIP-ID        PIC S9(09)     VALUE +0     05280000
052900                                                     COMP.        05290000
053000     05  PV-VHTRIP-TRIP-BEG-DTE       PIC X(10)      VALUE SPACE. 05300000
053100     05  PV-VHTRIP-TRIP-BEG-TME       PIC X(08)      VALUE SPACE. 05310000
053200     05  PV-VHTRIP-CRT-SRC-CDE        PIC X(02)      VALUE SPACE. 05320000
053300     05  PV-VHTRIP-LAST-UPD-DTE       PIC X(10)      VALUE SPACE. 05330000
053400     05  PV-VHTRIP-LAST-UPD-TME       PIC X(08)      VALUE SPACE. 05340000
053500     05  PV-VHTRIP-LAST-UPD-UID       PIC X(08)      VALUE SPACE. 05350000
053600     05  PV-VHTRIP-MANIFEST-NBR       PIC X(15)      VALUE SPACE. 05360000
053700     05  PV-VHTRIP-PLND-TRIP-SEQ      PIC S9(04)     VALUE ZERO   05370000
053800                                                     COMP.        05380000
053900     05  PV-VHTRIP-CARR-SCAC-ID       PIC X(04)      VALUE SPACE. 05390000
054000     05  PV-VHTRIP-EST-AR-TMST.                                   05400000
054100         10  PV-VHTRIP-STATUS-DTE     PIC X(10)      VALUE SPACES.05410000
054200         10  PV-VHTRIP-D-T-DASH       PIC X(01)      VALUE SPACES.05420000
054300         10  PV-VHTRIP-STATUS-TME     PIC X(08)      VALUE SPACES.05430000
054400         10  PV-VHTRIP-D-T-MSEC       PIC X(07)      VALUE SPACES.05440000
054500                                                                  05450000
054600                                                                  05460000
054700 01  PV-TRIPST-RECORD.                                            05470000
054800     05  PV-TRIPST-TRIP-ID            PIC S9(09)     VALUE +0     05480000
054900                                                     COMP.        05490000
055000     05  PV-TRIPST-OPER-UNT-ID        PIC S9(04)     VALUE +0     05500000
055100                                                     COMP.        05510000
055200     05  PV-TRIPST-FCLTY-ID           PIC S9(04)     VALUE +0     05520000
055300                                                     COMP.        05530000
055400     05  PV-TRIPST-FCLTY-AREA-ID      PIC X(06)      VALUE SPACE. 05540000
055500     05  PV-TRIPST-TRIP-STATUS-CDE    PIC X(02)      VALUE SPACE. 05550000
055600     05  PV-TRIPST-STATUS-DTE         PIC X(10)      VALUE SPACE. 05560000
055700     05  PV-TRIPST-STATUS-TME         PIC X(10)      VALUE SPACE. 05570000
055800     05  PV-TRIPST-PRTY-CDE           PIC X(02)      VALUE SPACE. 05580000
055900                                                                  05590000
056000 01  PV-SHIPST-RECORD.                                            05600000
056100     05  PV-SHIPST-SHIPT-ID           PIC S9(09)     VALUE +0     05610000
056200                                                     COMP.        05620000
056300     05  PV-SHIPST-SHIPT-STATUS-CDE                               05630000
056400                                      PIC X(02)      VALUE SPACE. 05640000
056500     05  PV-SHIPST-STATUS-DTE         PIC X(10)      VALUE SPACE. 05650000
056600     05  PV-SHIPST-STATUS-TME         PIC X(08)      VALUE SPACE. 05660000
056700     05  PV-SHIPST-DELAY-RSN-CDE      PIC X(03)      VALUE SPACE. 05670000
056800     05  PV-SHIPST-CARR-STATUS-CDE    PIC X(02)      VALUE SPACE. 05680000
056900     05  PV-SHIPST-TIME-ZONE          PIC X(02)      VALUE SPACES.05690000
057000     05  PV-SHIPST-CITY               PIC X(19)      VALUE SPACES.05700000
057100     05  PV-SHIPST-STATE              PIC X(02)      VALUE SPACES.05710000
057200     05  PV-SHIPST-LSD-CARR           PIC X(04)      VALUE SPACES.05720000
057300     05  PV-SHIPST-VEH-NBR            PIC X(10)      VALUE SPACES.05730000
057400                                                                  05740000
057500 01  PV-SHPTPO-RECORD.                                            05750000
057600     05 PV-SHPTPO-SHIPT-ID            PIC S9(09)     VALUE +0     05760000
057700                                                     COMP.        05770000
057800     05 PV-SHPTPO-PO-NBR.                                         05780000
057900         10 PV-SHPTPO-PO-NBR-N        PIC 9(09)      VALUE ZERO.  05790014
058000                                                                  05800000
058100     05 PV-SAVE-PO-NBR                PIC X(09)      VALUE SPACES.05810014
058200     05 PV-SHPTPO-VEND-CART-CNT       PIC S9(04)     VALUE ZEROES 05820000
058300                                                     COMP.        05830000
058400 01  PV-SAVE-SHPUNT-SHUUPC.                                       05840000
058500     05  PV-SHPUNT-DEST-OPER-UNT-ID  PIC S9(04)    COMP.          05850000
058600     05  PV-SHPUNT-SHIPT-UNT-SRC-ID  PIC  X(03).                  05860000
058700     05  PV-SHPUNT-CRE-DTE           PIC  X(10).                  05870000
058800     05  PV-SHPUNT-CRE-TM            PIC  X(08).                  05880000
058900     05  PV-SHUUPC-TRN-NBR           PIC S9(09)    COMP.          05890000
059000                                                                  05900000
059100 01  PV-ACCUMULATOR-FIELDS.                                       05910000
059200     05  PV-RANDOM-NBR               PIC S9(09)    COMP.          05920000
059300     05  PV-CALC-CARTONS             PIC  9(05)    VALUE ZEROES.  05930000
059400     05  PV-ASN-CARTONS              PIC  9(05)    VALUE ZEROES.  05940000
059500     05  PV-TOT-QTY-SHIPPED          PIC  9(06)    VALUE ZEROES.  05950000
059600     05  PV-SAVE-PKITEM-PO-NBR       PIC  9(09)    VALUE ZERO.    05960014
059700     05  PV-SAVE-SEQ-NBR             PIC S9(04)    COMP.          05970000
059800     05  PV-COMMIT-COUNTER           PIC S9(09)    COMP           05980000
059900                                                   VALUE ZERO.    05990000
060000     05  PV-MAN-SEGMENT-COUNT        PIC S9(09)    VALUE ZERO     06000000
060100                                                   COMP-3.        06010000
060200     05  PV-SUM-STR-PLAN-QTY         PIC S9(09)    COMP.          06020000
060300     05  PV-SUM-VERIFIED-QTY         PIC S9(9)     VALUE ZERO     06030000
060400                                                   COMP SYNC.     06040000
060500     05  PV-SUM-ITM-QTY              PIC S9(9)     VALUE ZERO     06050000
060600                                                   COMP SYNC.     06060000
060700     05  PV-STR-REC-QTY              PIC S9(09)    COMP.          06070000
060800     05  PV-NULL-IND                 PIC S9(4)     VALUE ZERO     06080000
060900                                                   COMP SYNC.     06090000
061000     05  PV-VER-NULL-IND             PIC S9(4)     VALUE ZERO     06100000
061100                                                   COMP SYNC.     06110000
061200     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     06120000
061300                                                   COMP-3.        06130000
061400     05  PV-OTR                      PIC S9(09)    VALUE ZEROS    06140000
061500                                                   COMP-3.        06150000
061600     05  PV-OTR-ALL                  PIC S9(09)    VALUE ZEROS    06160000
061700                                                   COMP-3.        06170000
061800     05  PV-PO-PAGE-CNT              PIC S9(04)    VALUE ZERO     06180000
061900                                                   COMP-3.        06190000
062000     05  PV-DIFF-LINES               PIC S9(04)    VALUE ZERO     06200000
062100                                                   COMP-3.        06210000
062200     05  PV-CARTON-CNT-DISPLAY       PIC  ZZZ9     VALUE ZERO.    06220000
062300     05  PV-DB2-COUNT                PIC S9(09)    VALUE +0       06230000
062400                                                   COMP-3.        06240000
062500     05  PV-MAX-SEQ-NBR              PIC S9(04)    VALUE +0       06250000
062600                                                   COMP.          06260000
062700     05  PV-NEXT-SEQ-NBR             PIC S9(04)    VALUE +0       06270000
062800                                                   COMP.          06280000
062900     05  PV-LINE-CNT                 PIC S9(03)    VALUE +61      06290000
063000                                                   COMP-3.        06300000
063100     05  PV-PO-LINE-CNT              PIC S9(03)    VALUE +99      06310000
063200                                                   COMP-3.        06320000
063300     05  PV-SQL-CODE                 PIC  9(04)    VALUE ZERO.    06330000
063310     05  PV-DISP-SQL-CODE            PIC -9(04)    VALUE ZERO.    06331040
063320     05  PV-DISP-SHIPT-ID            PIC  Z(09)    VALUE ZERO.    06332042
063400     05  PV-ASN-CARTONS-SAVE         PIC  9(05)    VALUE ZERO.    06340000
063500     05  PV-SUM-FIELDS                             COMP-3.        06350000
063600         10  PV-SUM-QTY-ORDERED      PIC S9(07)    VALUE ZERO.    06360000
063700         10  PV-SUM-QTY-SHIPPED      PIC S9(07)    VALUE ZERO.    06370000
063800         10  PV-SUM-ASN-CARTONS      PIC S9(07)    VALUE ZERO.    06380000
063900     05  PV-SHIP-DATE.                                            06390000
064000         10  PV-SHIP-DATE-MM         PIC  9(02).                  06400000
064100         10  PV-SHIP-DATE-DD         PIC  9(02).                  06410000
064200         10  PV-SHIP-DATE-YY         PIC  9(02).                  06420000
064300     05  PV-DB2-DATE.                                             06430000
064400         10  PV-DB2-DATE-CCYY        PIC  9(04).                  06440000
064500         10  FILLER                  PIC  X(01)   VALUE '-'.      06450000
064600         10  PV-DB2-DATE-MM          PIC  9(02).                  06460000
064700         10  FILLER                  PIC  X(01)   VALUE '-'.      06470000
064800         10  PV-DB2-DATE-DD          PIC  9(02).                  06480000
064900     05  PV-DC-9                     PIC  9(4).                   06490000
065000 EJECT                                                            06500000
065100                                                                  06510000
065200 01  PV-PREV-FIELDS.                                              06520000
065300     05  PV-PREV-OPERATING-COMPANY   PIC  X(02)    VALUE SPACES.  06530000
065400     05  PV-PREV-DIST-CNTR           PIC  9(04)    VALUE 0.       06540000
065500     05  PV-PREV-EDI-VEND-ID         PIC  X(09)    VALUE SPACES.  06550000
065600     05  PV-PREV-CARRIER-SCAC-CODE   PIC  X(04)    VALUE SPACES.  06560000
065700     05  PV-PREV-BOL-NBR             PIC  X(30)    VALUE SPACES.  06570000
065800     05  PV-PREV-ASNHDR-NBR          PIC  X(30)    VALUE SPACES.  06580000
065900     05  PV-PREV-PO-NBR              PIC  X(09)    VALUE SPACES.  06590014
066000                                                                  06600000
066100 01  PV-MISC-FIELDS.                                              06610000
066200     05  PV-ORD-LNE-NBR              PIC S9(09)    VALUE ZERO     06620000
066300                                                   COMP SYNC.     06630000
066400     05  PV-BOL-RIGHT-JUST           PIC  X(11)    JUST.          06640000
066500     05  PV-STRING-COUNT             PIC S9(04)    VALUE ZERO     06650000
066600                                                   COMP SYNC.     06660000
066700     05  PV-HOLD-ASN-DIST-CNTR       PIC  9(04)    VALUE 0.       06670000
066800     05  PV-SUB-1                    PIC S9(04)    VALUE ZERO     06680000
066900                                                   COMP SYNC.     06690000
067000     05  PV-SUB                      PIC S9(04)    VALUE ZERO     06700000
067100                                                   COMP SYNC.     06710000
067200     05  PV-ASN-CARTON-NBR.                                       06720000
067300         10  PV-ASN-CARTON-NBR-2     PIC  X(02).                  06730000
067400         10  PV-ASN-CARTON-NBR-18    PIC  X(18).                  06740000
067500     05  PV-TRIP-SUB                 PIC S9(04)    VALUE ZERO     06750000
067600                                                   COMP SYNC.     06760000
067700     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     06770000
067800                                                   COMP SYNC.     06780000
067900     05  PV-SAVE-STR-DEST-NBR        PIC  9(04)    VALUE 0.       06790000
068000     05  PV-SAVE-DIST-CNTR           PIC  9(04)    VALUE 0.       06800000
068100     05  PV-SAVE-VEND-ID             PIC  9(09)    VALUE ZEROES.  06810000
068200     05  PV-SAVE-BOL-NBR             PIC  X(30)    VALUE SPACES.  06820000
068300     05  PV-OVER-SHORT-PCT           PIC  9(03)V99 COMP-3.        06830000
068400     05  PV-SEQ-NBR-IND              PIC S9(04)    VALUE +0       06840000
068500                                                   COMP.          06850000
068600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  06860000
068700                                                                  06870000
068800     05  PV-OPER-UNT-ID              PIC  9(04).                  06880000
068900                                                                  06890000
069000     05  PV-BL-BILL-OF-LADING-NBR.                                06900000
069100         10  FILLER                  PIC  X(02)    VALUE 'BL'.    06910000
069200         10  PV-BILL-OF-LADING-NBR   PIC  X(28)    VALUE SPACES.  06920000
069300                                                                  06930000
069400     05  PV-PO-LINE-NBR-X            PIC  X(04).                  06940000
069500     05  FILLER REDEFINES PV-PO-LINE-NBR-X.                       06950000
069600         10  PV-PO-LINE-NBR          PIC  9(04).                  06960000
069700                                                                  06970000
069800     05  PV-PO-NBR-MAN               PIC X(09)     VALUE SPACES.  06980014
069900                                                                  06990000
070000     05  PV-CURR-DATE-YYMMDD.                                     07000000
070100         10  PV-CURR-DATE-YY         PIC  9(02)    VALUE ZERO.    07010000
070200         10  PV-CURR-DATE-MM         PIC  9(02)    VALUE ZERO.    07020000
070300         10  PV-CURR-DATE-DD         PIC  9(02)    VALUE ZERO.    07030000
070400                                                                  07040000
070500     05  PV-CURR-TIME.                                            07050000
070600         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    07060000
070700         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    07070000
070800         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    07080000
070900                                                                  07090000
071000*    05  PV-COMMIT-CURR-TIME         PIC  X(08)    VALUE SPACES.  07100000
071100     05  PV-PREP-TIMESTAMP.                                       07110000
071200         10  PV-PREP-DATE            PIC  X(10).                  07120000
071300         10  FILLER                  PIC  X(01).                  07130000
071400         10  PV-PREP-TIME            PIC  X(08).                  07140000
071500         10  FILLER                  PIC  X(07).                  07150000
071600                                                                  07160000
071700     05  PV-NEW-CURR-TIME            PIC  X(08)    VALUE SPACES.  07170000
071800     05  PV-DATE-SHIPPED.                                         07180000
071900         10  PV-DATE-SHIPPED-MM      PIC  9(02).                  07190000
072000         10  PV-DATE-SHIPPED-DD      PIC  9(02).                  07200000
072100         10  PV-DATE-SHIPPED-CCYY    PIC  9(04).                  07210000
072200         10  FILLER REDEFINES PV-DATE-SHIPPED-CCYY.               07220000
072300             15  PV-DATE-SHIPPED-CC      PIC  9(02).              07230000
072400             15  PV-DATE-SHIPPED-YY      PIC  9(02).              07240000
072500                                                                  07250000
072600     05  PV-HOLD-CURR-DATE-MMDDYY    PIC  9(06)    VALUE ZERO.    07260000
072700     05  PV-HOLD-CURR-DATE-MMDDYY-X  REDEFINES                    07270000
072800         PV-HOLD-CURR-DATE-MMDDYY.                                07280000
072900         10  PV-HOLD-CURR-DATE-MM    PIC  9(02).                  07290000
073000         10  PV-HOLD-CURR-DATE-DD    PIC  9(02).                  07300000
073100         10  PV-HOLD-CURR-DATE-YY    PIC  9(02).                  07310000
073200                                                                  07320000
073300     05  PV-HOLD-DATE                PIC  9(06)    VALUE ZERO.    07330000
073400     05  PV-HOLD-DATE-X              REDEFINES                    07340000
073500         PV-HOLD-DATE.                                            07350000
073600         10  PV-HOLD-DATE-MM         PIC  9(02).                  07360000
073700         10  PV-HOLD-DATE-DD         PIC  9(02).                  07370000
073800         10  PV-HOLD-DATE-YY         PIC  9(02).                  07380000
073900                                                                  07390000
074000     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(60)    VALUE SPACE.   07400000
074100     05  PV-DB2-OPERATION-ATTEMPT-2  PIC  X(60)    VALUE SPACE.   07410000
074200     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    07420000
074300     05  PV-INVOICE-NBR              PIC  X(10)    VALUE SPACES.  07430000
074400     05  PV-RECEIVER-NBR-X           PIC  X(08)    VALUE ZEROS.   07440000
074500     05  PV-RECEIVER-NBR             REDEFINES                    07450000
074600         PV-RECEIVER-NBR-X           PIC  9(08).                  07460000
074700     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       07470000
074800                                                   COMP SYNC.     07480000
074803     05  PV-RECS-READ                PIC S9(09) VALUE +0          07480301
074804                                                COMP-3.           07480401
074805     05  PV-HDR-RECS-READ            PIC S9(09) VALUE +0          07480501
074806                                                COMP-3.           07480601
074807     05  PV-DET-RECS-READ            PIC S9(09) VALUE +0          07480701
074808                                                COMP-3.           07480801
074809     05  PV-CRTN-RECS-READ           PIC S9(09) VALUE +0          07480901
074810                                                COMP-3.           07481001
074820     05  PV-RCVR-RECS-OUT            PIC S9(09) VALUE +0          07482001
074828                                                COMP-3.           07482800
074829     05  PV-CRTN-ERROR-RECS-OUT      PIC S9(09) VALUE +0          07482900
074830                                                COMP-3.           07483000
074831     05  PV-PREV-SENT-ERRS           PIC S9(09) VALUE +0          07483100
074832                                                COMP-3.           07483200
074833     05  PV-STR-PO-MISMATCH-ERRS     PIC S9(09) VALUE +0          07483300
074835                                                COMP-3.           07483500
074836     05  PV-CRTN-UPD-RECS-OUT        PIC S9(09) VALUE +0          07483600
074837                                                COMP-3.           07483700
074838     05  PV-CRTN-EXT-RECS-OUT        PIC S9(09) VALUE +0          07483800
074839                                                COMP-3.           07483900
074840     05  PV-ADD-TSHPUNT-1ST-TRY      PIC S9(09) VALUE +0          07484000
074841                                                COMP-3.           07484100
074842     05  PV-ADD-TSHPUNT-2ND-TRY      PIC S9(09) VALUE +0          07484200
074843                                                COMP-3.           07484300
074844     05  PV-ADD-TSHPUNT-FAIL-DUPE    PIC S9(09) VALUE +0          07484400
074845                                                COMP-3.           07484500
074846     05  PV-DELETE-TSHPUNT           PIC S9(09) VALUE +0          07484600
074847                                                COMP-3.           07484700
074848     05  PV-DELETE-TSHPUNT-FAIL      PIC S9(09) VALUE +0          07484800
074849                                                COMP-3.           07484900
074850     05  PV-UPDATE-TSHPUNT           PIC S9(09) VALUE +0          07485000
074851                                                COMP-3.           07485100
074852     05  PV-ADD-TSHUUPC              PIC S9(09) VALUE +0          07485200
074853                                                COMP-3.           07485300
074854     05  PV-ADD-TSHUUPC-LNE-NBR-0    PIC S9(09) VALUE +0          07485400
074855                                                COMP-3.           07485500
074856     05  PV-ADD-TSHUUPC-FAIL-DUPE    PIC S9(09) VALUE +0          07485600
074857                                                COMP-3.           07485700
074858     05  PV-DELETE-TSHUUPC           PIC S9(09) VALUE +0          07485800
074859                                                COMP-3.           07485900
074860     05  PV-ADD-TINPKSU              PIC S9(09) VALUE +0          07486000
074861                                                COMP-3.           07486100
074862     05  PV-ADD-TINPKSU-FAIL-DUPE    PIC S9(09) VALUE +0          07486200
074863                                                COMP-3.           07486300
074864     05  PV-ADD-TSHIPMT              PIC S9(09) VALUE +0          07486400
074865                                                COMP-3.           07486500
074866     05  PV-ADD-TSHIPMT-FAIL-DUPE    PIC S9(09) VALUE +0          07486600
074867                                                COMP-3.           07486700
074868     05  PV-UPDATE-TSHIPMT           PIC S9(09) VALUE +0          07486800
074869                                                COMP-3.           07486900
074870     05  PV-ADD-TTRIPST              PIC S9(09) VALUE +0          07487000
074871                                                COMP-3.           07487100
074872     05  PV-UPDATE-TTRIPST           PIC S9(09) VALUE +0          07487200
074873                                                COMP-3.           07487300
074874     05  PV-ADD-TPKSLIP              PIC S9(09) VALUE +0          07487400
074875                                                COMP-3.           07487500
074876     05  PV-ADD-TPKSLIP-FAIL-DUPE    PIC S9(09) VALUE +0          07487600
074877                                                COMP-3.           07487700
074878     05  PV-ADD-TPKITEM              PIC S9(09) VALUE +0          07487800
074879                                                COMP-3.           07487900
074880     05  PV-UPDATE-TPKITEM           PIC S9(09) VALUE +0          07488000
074881                                                COMP-3.           07488100
074882     05  PV-ADD-TVEHICL              PIC S9(09) VALUE +0          07488200
074883                                                COMP-3.           07488300
074884     05  PV-UPDATE-TVEHICL           PIC S9(09) VALUE +0          07488400
074885                                                COMP-3.           07488500
074886     05  PV-DELETE-TVEHICL           PIC S9(09) VALUE +0          07488600
074887                                                COMP-3.           07488700
074888     05  PV-ADD-TVHTRIP              PIC S9(09) VALUE +0          07488800
074889                                                COMP-3.           07488900
074890     05  PV-UPDATE-TVHTRIP           PIC S9(09) VALUE +0          07489000
074891                                                COMP-3.           07489100
074892     05  PV-DELETE-TVHTRIP           PIC S9(09) VALUE +0          07489200
074893                                                COMP-3.           07489300
074894     05  PV-ADD-TSHPTPO              PIC S9(09) VALUE +0          07489400
074895                                                COMP-3.           07489500
074896     05  PV-ADD-TSHPTPO-FAIL-DUPE    PIC S9(09) VALUE +0          07489600
074897                                                COMP-3.           07489700
074898     05  PV-ADD-TSHIPST              PIC S9(09) VALUE +0          07489800
074899                                                COMP-3.           07489900
074900     05  PV-UPDATE-TSHIPST           PIC S9(09) VALUE +0          07490000
074901                                                COMP-3.           07490100
074902     05  PV-DISPLAY-NBR              PIC 9(9)   VALUE ZERO.       07490200
074903     05  PV-DISPLAY-LOC-NBR          PIC 9(4)   VALUE ZERO.       07490321
074910     05  PV-STORE-085-ALLOC-IND      PIC  X(01)    VALUE 'N'.     07491000
075000     05  PV-TRANSCRIBE-IND           PIC  X(01)    VALUE 'N'.     07500000
075100     05  PV-STORE-NBR                PIC S9(04)    VALUE 0 COMP.  07510000
075200     05  PV-DIST-CNTR                PIC  9(04).                  07520000
075300     05  PV-PACK-BY-ST-IND           PIC  X(01)    VALUE SPACES.  07530000
075400     05  PV-ERROR-MSG-TABLE.                                      07540000
075500         10  PEMT-MSG-TBL OCCURS 6 TIMES                          07550000
075600                          INDEXED BY PEMT-INDX.                   07560000
075700             15  PEMT-MSG            PIC  X(17).                  07570000
075800     05  PV-PO-ERROR-MSG-TABLE.                                   07580000
075900         10  FILLER                  PIC  X(04)  VALUE 'POLN'.    07590000
076000         10  FILLER                  PIC  X(01).                  07600000
076100         10  FILLER                  PIC  X(04)  VALUE 'PRIC'.    07610000
076200         10  FILLER                  PIC  X(01).                  07620000
076300         10  FILLER                  PIC  X(04)  VALUE 'CSPK'.    07630000
076400         10  FILLER                  PIC  X(01).                  07640000
076500         10  FILLER                  PIC  X(04)  VALUE 'CHGD'.    07650000
076600         10  FILLER                  PIC  X(01).                  07660000
076700         10  FILLER                  PIC  X(04)  VALUE 'PCHG'.    07670000
076800         10  FILLER                  PIC  X(01).                  07680000
076900         10  FILLER                  PIC  X(04)  VALUE 'OVRN'.    07690000
077000         10  FILLER                  PIC  X(01).                  07700000
077100         10  FILLER                  PIC  X(04)  VALUE 'OVRY'.    07710000
077200         10  FILLER                  PIC  X(01).                  07720000
077300         10  FILLER                  PIC  X(04)  VALUE 'SHTN'.    07730000
077400         10  FILLER                  PIC  X(01).                  07740000
077500         10  FILLER                  PIC  X(04)  VALUE 'SHTY'.    07750000
077600         10  FILLER                  PIC  X(01).                  07760000
077700         10  FILLER                  PIC  X(04)  VALUE 'CANC'.    07770000
077800         10  FILLER                  PIC  X(01).                  07780000
077900         10  FILLER                  PIC  X(04)  VALUE 'CBAL'.    07790000
078000         10  FILLER                  PIC  X(01).                  07800000
078100         10  FILLER                  PIC  X(04)  VALUE 'COMP'.    07810000
078200         10  FILLER                  PIC  X(01).                  07820000
078300         10  FILLER                  PIC  X(04)  VALUE 'ZQTY'.    07830000
078400         10  FILLER                  PIC  X(01).                  07840000
078500         10  FILLER                  PIC  X(04)  VALUE 'ISTR'.    07850000
078600         10  FILLER                  PIC  X(01).                  07860000
078700     05  FILLER REDEFINES PV-PO-ERROR-MSG-TABLE.                  07870000
078800         10  PPEMT-MSG-TBL OCCURS 14 TIMES                        07880000
078900                          INDEXED BY PPEMT-INDX.                  07890000
079000             15  PPEMT-MSG           PIC  X(04).                  07900000
079100             15  PPEMT-IND           PIC  X(01).                  07910000
079200 EJECT                                                            07920000
079300 01  WS-HOLD-ASN-HEADER.                                          07930000
079400     05  WS-HOLD-ASN-TRANSCRIPTION-KEY.                           07940000
079500         10  WS-HOLD-OPERATING-COMPANY                            07950000
079600                                     PIC  X(02).                  07960000
079700         10  WS-HOLD-DIST-CNTR       PIC  9(04).                  07970000
079800         10  WS-HOLD-EDI-VEND-ID     PIC  9(09)  VALUE ZEROES.    07980000
079900         10  WS-HOLD-CARRIER-SCAC-CODE                            07990000
080000                                     PIC  X(04).                  08000000
080100         10  WS-HOLD-BILL-OF-LADING-NBR                           08010000
080200                                     PIC  X(30).                  08020000
080300         10  WS-HOLD-PO-NBR          PIC  9(09).                  08030014
080400         10  WS-HOLD-STORE-NBR       PIC  9(04).                  08040000
080500         10  WS-HOLD-PO-LINE-NBR     PIC  X(04).                  08050000
080600         10  WS-HOLD-SEQUENCE-NBR    PIC  9(07).                  08060000
080700     05  WS-CARTON-IND               PIC  X(01).                  08070000
080800     05  WS-HOLD-ASNHDR-NBR          PIC  X(30).                  08080000
080900     05  WS-HOLD-EDI-VEND-NAME       PIC  X(25).                  08090000
081000     05  WS-HOLD-ORIG-BOL-NBR        PIC  X(30).                  08100000
081100     05  WS-HOLD-SEQ-NBR-IND         PIC  X(01).                  08110000
081200         88  WS-HOLD-SEQ-NBR-SEQ                   VALUE 'Y'.     08120000
081300         88  WS-HOLD-SEQ-NBR-STR                   VALUE 'N'.     08130000
081310     05  FILLER                      PIC  X(40).                  08131017
081400     05  WS-HOLD-DEPT-NBR            PIC  9(03).                  08140000
081500     05  WS-HOLD-DEPT-DESC           PIC  X(25).                  08150000
081600     05  WS-HOLD-BUYER-NBR           PIC  9(03).                  08160000
081700     05  WS-HOLD-BUYER-NAME          PIC  X(32).                  08170000
081800     05  WS-HOLD-ANALYST-NAME        PIC  X(32).                  08180000
081900     05  WS-HOLD-DATE-SHIPPED        PIC  9(08).                  08190000
082000     05  WS-HOLD-PO-DATE             PIC  9(06).                  08200000
082100     05  WS-HOLD-REQ-SHIP-DATE       PIC  9(06).                  08210000
082200     05  WS-HOLD-CANCEL-DATE         PIC  9(06).                  08220000
082300     05  WS-HOLD-CANCEL-EXT-DATE     PIC  9(06).                  08230000
082400     05  WS-HOLD-AD-DATE             PIC  9(06).                  08240000
082500     05  WS-HOLD-CARR-VEND-ID        PIC S9(09)    COMP-3.        08250000
082600     05  WS-HOLD-CARRIER-NAME        PIC  X(35).                  08260000
082700     05  WS-HOLD-PRO-NBR             PIC  X(30).                  08270000
082800     05  WS-HOLD-TRAILER-NBR.                                     08280000
082900         10  WS-HOLD-EQUIP-INIT      PIC  X(04).                  08290000
083000         10  FILLER                  PIC  X(01).                  08300000
083100         10  WS-HOLD-EQUIP-NBR       PIC  X(10).                  08310000
083200     05  WS-HOLD-SHIPMENT-WEIGHT     PIC S9(09)    COMP-3.        08320000
083300     05  WS-HOLD-SHIP-WEIGHT-UM      PIC  X(02).                  08330000
083400     05  WS-HOLD-CARTON-CNT-STORE    PIC S9(09)    COMP-3.        08340000
083500     05  WS-HOLD-CARTON-CNT-PO       PIC S9(09)    COMP-3.        08350000
083600     05  WS-HOLD-CARTON-CNT-SHPMT    PIC S9(09)    COMP-3.        08360000
083700     05  WS-HOLD-SPECIAL-INSTR-TABLE.                             08370000
083800         10  WS-HOLD-SPECIAL-TBLE OCCURS 3 TIMES                  08380000
083900                          INDEXED BY SPEC-INST-IDX.               08390000
084000             15  WS-HOLD-SPECIAL-INSTR                            08400000
084100                                     PIC  X(25).                  08410000
084200     05  WS-HOLD-CONSOLIDATION-IND   PIC  X(01).                  08420000
084300     05  WS-HOLD-PO-ROLLUP-IND       PIC  X(01).                  08430000
084400     05  WS-HOLD-ASNORD-EARLY-LTE-CDE PIC X(01).                  08440000
084500         88  WS-HOLD-PO-SHIPPED-EARLY              VALUE 'E'.     08450000
084600         88  WS-HOLD-PO-SHIPPED-LATE               VALUE 'L'.     08460000
084700     05  WS-HOLD-ASNORD-MTCH-PO-CDE  PIC  X(01).                  08470000
084800         88  WS-HOLD-PO-UNMATCHED                  VALUE 'U'.     08480000
084900         88  WS-HOLD-PO-CANCELLED-COMPLETE         VALUE 'C'.     08490000
085000     05  WS-HOLD-VENDOR-TRSCP-IND    PIC  X(01).                  08500000
085100         88  WS-HOLD-VENDOR-TRSCP-YES              VALUE 'Y'.     08510000
085200         88  WS-HOLD-VENDOR-TRSCP-NO               VALUE 'N'.     08520000
085300     05  WS-HOLD-LINE-ERROR-IND      PIC  X(01).                  08530000
085400     05  WS-HOLD-CONT-NBR            PIC  X(12).                  08540000
085500     05  FILLER                      PIC  X(67).                  08550000
085600                                                                  08560000
085700 EJECT                                                            08570000
085800                                                                  08580000
085900******************************************************************08590000
086000*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               08600000
086100******************************************************************08610000
086200     COPY DPWS132O.                                               08620000
086300                                                                  08630000
086400 01  HEADING-LINES.                                               08640000
086500     05  HEADING-LINE-0.                                          08650000
086600         10  HL0-TITLE.                                           08660000
086700             15 FILLER               PIC  X(17)    VALUE SPACES.  08670000
086800             15 FILLER               PIC  X(13)    VALUE          08680000
086900             'ASN FALLOUT: '.                                     08690000
087000         10  HL0-ASN-NBR             PIC  X(30)    VALUE SPACES.  08700000
087100         10  FILLER                  PIC  X(16)    VALUE          08710000
087200             '  DATE SHIPPED: '.                                  08720000
087300         10  HL0-DATE-SHIPPED.                                    08730000
087400             15  HL0-DATE-SHIPPED-MM PIC  X(02)    VALUE SPACES.  08740000
087500             15  FILLER              PIC  X(01)    VALUE '/'.     08750000
087600             15  HL0-DATE-SHIPPED-DD PIC  X(02)    VALUE SPACES.  08760000
087700             15  FILLER              PIC  X(01)    VALUE '/'.     08770000
087800             15  HL0-DATE-SHIPPED-CCYY                            08780000
087900                                     PIC  X(04)    VALUE SPACES.  08790000
088000         10  FILLER                  PIC  X(46)    VALUE SPACES.  08800000
088100                                                                  08810000
088200     05  HEADING-LINE-1.                                          08820000
088300         10  FILLER                  PIC  X(12)    VALUE          08830000
088400             'DEPARTMENT: '.                                      08840000
088500         10  HL1-DEPT                PIC  X(03)    VALUE SPACES.  08850000
088600         10  FILLER                  PIC  X(01)    VALUE SPACE.   08860000
088700         10  HL1-DEPT-DESC           PIC  X(25)    VALUE SPACES.  08870000
088800         10  FILLER                  PIC  X(05)    VALUE SPACES.  08880000
088900         10  FILLER                  PIC  X(15)    VALUE          08890000
089000             'PO NUMBER:     '.                                   08900000
089100         10  HL1-PO-NBR              PIC  X(09)    VALUE SPACES.  08910014
089200         10  FILLER                  PIC  X(10)    VALUE SPACES.  08920014
089300         10  FILLER                  PIC  X(16)    VALUE          08930000
089400             'BILL OF LADING: '.                                  08940000
089500         10  HL1-BILL-OF-LADING      PIC  X(30)    VALUE SPACES.  08950000
089600         10  FILLER                  PIC  X(06)    VALUE SPACES.  08960000
089700                                                                  08970000
089800     05  HEADING-LINE-2.                                          08980000
089900         10  FILLER                  PIC  X(07)    VALUE          08990000
090000             'BUYER: '.                                           09000000
090100         10  HL2-BUYER-ID-X.                                      09010000
090200             15  HL2-BUYER-ID        PIC  9(03)    VALUE ZERO.    09020000
090300         10  FILLER                  PIC  X(02)    VALUE SPACES.  09030000
090400         10  HL2-BUYER               PIC  X(32)    VALUE SPACES.  09040000
090500         10  FILLER                  PIC  X(02)    VALUE SPACES.  09050000
090600         10  FILLER                  PIC  X(15)    VALUE          09060000
090700             'PO DATE:       '.                                   09070000
090800         10  HL2-PO-DATE.                                         09080000
090900             15  HL2-PO-DATE-MM      PIC  X(02)    VALUE SPACES.  09090000
091000             15  FILLER              PIC  X(01)    VALUE '/'.     09100000
091100             15  HL2-PO-DATE-DD      PIC  X(02)    VALUE SPACES.  09110000
091200             15  FILLER              PIC  X(01)    VALUE '/'.     09120000
091300             15  HL2-PO-DATE-YY      PIC  X(02)    VALUE SPACES.  09130000
091400         10  FILLER                  PIC  X(11)    VALUE SPACES.  09140000
091500         10  FILLER                  PIC  X(16)    VALUE          09150000
091600             'CARRIER NAME:   '.                                  09160000
091700         10  HL2-CARRIER-NAME        PIC  X(35)    VALUE SPACES.  09170000
091800         10  FILLER                  PIC  X(01)    VALUE SPACE.   09180000
091900                                                                  09190000
092000     05  HEADING-LINE-3.                                          09200000
092100         10  FILLER                  PIC  X(12)    VALUE          09210000
092200             'ANALYST:'.                                          09220000
092300         10  HL3-ANALYST             PIC  X(32)    VALUE SPACES.  09230000
092400         10  FILLER                  PIC  X(02)    VALUE SPACES.  09240000
092500         10  FILLER                  PIC  X(15)    VALUE          09250000
092600             'REQ SHIP DATE: '.                                   09260000
092700         10  HL3-REQ-SHIP-DATE.                                   09270000
092800             15  HL3-REQ-SHIP-DATE-MM                             09280000
092900                                     PIC X(02)     VALUE SPACES.  09290000
093000             15  FILLER              PIC  X(01)    VALUE '/'.     09300000
093100             15  HL3-REQ-SHIP-DATE-DD                             09310000
093200                                     PIC X(02)     VALUE SPACES.  09320000
093300             15  FILLER              PIC  X(01)    VALUE '/'.     09330000
093400             15  HL3-REQ-SHIP-DATE-YY                             09340000
093500                                     PIC X(02)     VALUE SPACES.  09350000
093600         10  FILLER                  PIC  X(11)    VALUE SPACES.  09360000
093700         10  FILLER                  PIC  X(16)    VALUE          09370000
093800             'PRO NUMBER:     '.                                  09380000
093900         10  HL3-PRO-NUMBER          PIC  X(30)    VALUE SPACES.  09390000
094000         10  FILLER                  PIC  X(06)    VALUE SPACES.  09400000
094100                                                                  09410000
094200     05  HEADING-LINE-4.                                          09420000
094300         10  FILLER                  PIC  X(12)    VALUE          09430000
094400             'VENDOR:'.                                           09440000
094500         10  HL4-VENDOR-NAME         PIC  X(25)    VALUE SPACES.  09450000
094600         10  FILLER                  PIC  X(09)    VALUE SPACES.  09460000
094700         10  FILLER                  PIC  X(15)    VALUE          09470000
094800             'CANCEL DATE:   '.                                   09480000
094900         10  HL4-CANCEL-DATE.                                     09490000
095000             15  HL4-CANCEL-DATE-MM  PIC  X(02)    VALUE SPACES.  09500000
095100             15  FILLER              PIC  X(01)    VALUE '/'.     09510000
095200             15  HL4-CANCEL-DATE-DD  PIC  X(02)    VALUE SPACES.  09520000
095300             15  FILLER              PIC  X(01)    VALUE '/'.     09530000
095400             15  HL4-CANCEL-DATE-YY  PIC  X(02)    VALUE SPACES.  09540000
095500         10  FILLER                  PIC  X(11)    VALUE SPACES.  09550000
095600         10  FILLER                  PIC  X(18)    VALUE          09560000
095700             'TRAILER NUMBER:   '.                                09570000
095800         10  HL4-TRAILER-NUMBER      PIC  X(15)    VALUE SPACES.  09580000
095900         10  FILLER                  PIC  X(19)    VALUE SPACES.  09590000
096000                                                                  09600000
096100     05  HEADING-LINE-5.                                          09610000
096200         10  FILLER                  PIC  X(46)    VALUE SPACES.  09620000
096300         10  FILLER                  PIC  X(15)    VALUE          09630000
096400             'AD DATE:       '.                                   09640000
096500         10  HL5-AD-DATE.                                         09650000
096600             15  HL5-AD-DATE-MM      PIC  X(02)    VALUE SPACES.  09660000
096700             15  FILLER              PIC  X(01)    VALUE '/'.     09670000
096800             15  HL5-AD-DATE-DD      PIC  X(02)    VALUE SPACES.  09680000
096900             15  FILLER              PIC  X(01)    VALUE '/'.     09690000
097000             15  HL5-AD-DATE-YY      PIC  X(02)    VALUE SPACES.  09700000
097100         10  FILLER                  PIC  X(11)    VALUE SPACES.  09710000
097200         10  FILLER                  PIC  X(17)    VALUE          09720000
097300             'SHIPMENT WEIGHT: '.                                 09730000
097400         10  HL5-SHIP-WEIGHT         PIC  ZZZ,ZZZ,ZZ9.99          09740000
097500                                                   VALUE ZERO.    09750000
097600         10  FILLER                  PIC  X(01)    VALUE SPACE.   09760000
097700         10  HL5-UNIT-MEASURE        PIC  X(02)    VALUE SPACES.  09770000
097800         10  FILLER                  PIC  X(18)    VALUE SPACES.  09780000
097900                                                                  09790000
098000     05  HEADING-LINE-6.                                          09800000
098100         10  FILLER                  PIC X(14)     VALUE          09810000
098200             'DIST CENTER:  '.                                    09820000
098300         10  HL6-DC-UNKN.                                         09830000
098400             15  HL6-DC-UNKNOWN      PIC X(07).                   09840000
098500             15  FILLER              PIC X(13).                   09850000
098600         10  HL6-DC-ID REDEFINES HL6-DC-UNKN.                     09860000
098700             15  HL6-DC-NBR          PIC 9(4).                    09870000
098800             15  FILLER              PIC X.                       09880000
098900             15  HL6-DC-NAME         PIC X(15).                   09890000
099000         10  FILLER                  PIC X(97)   VALUE SPACES.    09900000
099100                                                                  09910000
099200     05  HEADING-LINE-7.                                          09920000
099300         10  FILLER                  PIC  X(14)    VALUE          09930000
099400             'STORE ID:     '.                                    09940000
099500         10  HL7-STORE-NBR           PIC  9(04)    VALUE 0.       09950000
099600         10  FILLER                  PIC  X(01)    VALUE SPACES.  09960000
099700         10  HL7-STORE-NAME          PIC  X(25)    VALUE SPACES.  09970000
099800         10  FILLER                  PIC  X(88)    VALUE SPACES.  09980000
099900                                                                  09990000
100000     05  HEADING-LINE-8.                                          10000000
100100         10  FILLER                  PIC  X(26)    VALUE          10010000
100200             'TOTAL CARTONS FOR STORE:  '.                        10020000
100300         10  HL8-TOT-CARTONS-STORE   PIC  ZZZ,ZZ9                 10030000
100400                                                   VALUE ZERO.    10040000
100500         10  FILLER                  PIC  X(13)    VALUE SPACES.  10050000
100600         10  FILLER                  PIC  X(23)    VALUE          10060000
100700             'TOTAL CARTONS FOR PO:  '.                           10070000
100800         10  HL8-TOT-CARTONS-PO      PIC  ZZZ,ZZ9                 10080000
100900                                                   VALUE ZERO.    10090000
101000         10  FILLER                  PIC  X(04)    VALUE SPACES.  10100000
101100         10  FILLER                  PIC  X(29)    VALUE          10110000
101200             'TOTAL CARTONS FOR SHIPMENT:  '.                     10120000
101300         10  HL8-TOT-CARTONS-SHPMT   PIC  ZZZ,ZZ9                 10130000
101400                                                   VALUE ZERO.    10140000
101500         10  FILLER                  PIC  X(16)    VALUE SPACES.  10150000
101600                                                                  10160000
101700     05  HEADING-LINE-9.                                          10170000
101800         10  FILLER                  PIC  X(22)    VALUE          10180000
101900             'SPECIAL INSTRUCTIONS: '.                            10190000
102000         10  HL9-SI-1                PIC  X(25)    VALUE SPACES.  10200000
102100         10  FILLER                  PIC  X(01)    VALUE SPACE.   10210000
102200         10  HL9-SI-2                PIC  X(25)    VALUE SPACES.  10220000
102300         10  FILLER                  PIC  X(01)    VALUE SPACE.   10230000
102400         10  HL9-SI-3                PIC  X(25)    VALUE SPACES.  10240000
102500         10  FILLER                  PIC  X(33)    VALUE SPACES.  10250000
102600                                                                  10260000
102700     05  HEADING-LINE-10.                                         10270000
102800         10  FILLER                  PIC  X(15)    VALUE          10280000
102900             'GENERAL ERRORS:'.                                   10290000
103000         10  HL10-GEN-ERR-TABLE      PIC  X(78)    VALUE SPACES.  10300000
103100         10  HL10-GEN-ERR-TABLE-RDF REDEFINES HL10-GEN-ERR-TABLE. 10310000
103200             15  HL10-GEN-ERR-OCC OCCURS 3 TIMES                  10320000
103300                                 INDEXED BY HL10-INDX.            10330000
103400                 20  FILLER          PIC  X(01).                  10340000
103500                 20  HL10-GEN-ERR    PIC  X(25).                  10350000
103600         10  FILLER                  PIC  X(39)    VALUE SPACES.  10360000
103700                                                                  10370000
103800     05  HEADING-LINE-P-1.                                        10380000
103900         10  FILLER                  PIC  X(61)    VALUE SPACE.   10390000
104000         10  FILLER                  PIC  X(20)    VALUE          10400000
104100             'EDI PACKSLIP SUMMARY'.                              10410000
104200         10  FILLER                  PIC  X(51)    VALUE SPACE.   10420000
104300                                                                  10430000
104400     05  HEADING-LINE-P-1-IMPORT.                                 10440000
104500         10  FILLER                  PIC  X(60)    VALUE SPACE.   10450000
104600         10  FILLER                  PIC  X(23)    VALUE          10460000
104700             'IMPORT PACKSLIP SUMMARY'.                           10470000
104800         10  FILLER                  PIC  X(49)    VALUE SPACE.   10480000
104900                                                                  10490000
104910     05  HEADING-LINE-P-1-REALTIME.                               10491000
104920         10  FILLER                  PIC  X(60)    VALUE SPACE.   10492000
104930         10  FILLER                  PIC  X(25)    VALUE          10493000
104940             'REALTIME PACKSLIP SUMMARY'.                         10494000
104950         10  FILLER                  PIC  X(47)    VALUE SPACE.   10495000
104960                                                                  10496000
105000     05  HEADING-LINE-P-2.                                        10500000
105100         10  FILLER                  PIC X(14)     VALUE          10510000
105200             'DIST CENTER:  '.                                    10520000
105300         10  HLP2-DC-UNKN.                                        10530000
105400             15  HLP2-DC-UNKNOWN     PIC X(07).                   10540000
105500             15  FILLER              PIC X(22).                   10550000
105600         10  HLP2-DC-ID REDEFINES HLP2-DC-UNKN.                   10560000
105700             15  HLP2-DC-NBR         PIC 9(4).                    10570000
105800             15  FILLER              PIC X.                       10580000
105900             15  HLP2-DC-NAME        PIC X(24).                   10590000
106000         10  FILLER                  PIC X(89)   VALUE SPACES.    10600000
106100                                                                  10610000
106200     05  HEADING-LINE-P-3.                                        10620000
106300         10  FILLER                  PIC  X(23)    VALUE SPACES.  10630000
106400         10  FILLER                  PIC  X(02)    VALUE          10640000
106500             'PO'.                                                10650000
106600         10  FILLER                  PIC  X(73)    VALUE SPACES.  10660000
106700         10  FILLER                  PIC  X(04)    VALUE          10670000
106800             'DATE'.                                              10680000
106900         10  FILLER                  PIC  X(04)    VALUE SPACES.  10690000
107000         10  FILLER                  PIC  X(03)    VALUE          10700000
107100             'MAN'.                                               10710000
107200         10  FILLER                  PIC  X(03)    VALUE SPACES.  10720000
107300         10  FILLER                  PIC  X(07)    VALUE          10730000
107400             'CARTONS'.                                           10740000
107500         10  FILLER                  PIC  X(13)    VALUE SPACES.  10750000
107600                                                                  10760000
107700     05  HEADING-LINE-P-4.                                        10770000
107800         10  FILLER                  PIC  X(04)    VALUE SPACES.  10780000
107900         10  FILLER                  PIC  X(11)    VALUE          10790000
108000             'VENDOR NAME'.                                       10800000
108100         10  FILLER                  PIC  X(06)    VALUE SPACES.  10810000
108200         10  FILLER                  PIC  X(06)    VALUE          10820000
108300             'NUMBER'.                                            10830000
108400         10  FILLER                  PIC  X(04)    VALUE SPACES.  10840000
108500         10  FILLER                  PIC  X(03)    VALUE          10850000
108600             'BOL'.                                               10860000
108700         10  FILLER                  PIC  X(14)    VALUE SPACES.  10870000
108800         10  FILLER                  PIC  X(04)    VALUE          10880000
108900             'SCAC'.                                              10890000
109000         10  FILLER                  PIC  X(2)     VALUE SPACES.  10900000
109100         10  FILLER                  PIC  X(16)    VALUE          10910000
109200             'ISA NUMBER'.                                        10920000
109300         10  FILLER                  PIC  X(4)     VALUE SPACES.  10930000
109400         10  FILLER                  PIC  X(11)    VALUE          10940000
109500             'ASN NUMBER'.                                        10950000
109600         10  FILLER                  PIC  X(12)    VALUE SPACES.  10960000
109700         10  FILLER                  PIC  X(07)    VALUE          10970000
109800             'SHIPPED'.                                           10980000
109900         10  FILLER                  PIC  X(02)    VALUE SPACES.  10990000
110000         10  FILLER                  PIC  X(03)    VALUE          11000000
110100             'NBR'.                                               11010000
110200         10  FILLER                  PIC  X(02)    VALUE SPACES.  11020000
110300         10  FILLER                  PIC  X(03)    VALUE          11030000
110400             'ASN'.                                               11040000
110500         10  FILLER                  PIC  X(03)    VALUE SPACES.  11050000
110600         10  FILLER                  PIC  X(04)    VALUE          11060000
110700             'CALC'.                                              11070000
110800         10  FILLER                  PIC  X(03)    VALUE SPACES.  11080000
110900         10  FILLER                  PIC  X(05)    VALUE          11090000
111000             'UNITS'.                                             11100000
111100         10  FILLER                  PIC  X(03)    VALUE SPACES.  11110000
111200                                                                  11120000
111300 01  MISCELLANEOUS-LINES.                                         11130000
111400     05  END-OF-REPORT-LINE.                                      11140000
111500         10  FILLER                  PIC  X(44)    VALUE SPACES.  11150000
111600         10  FILLER                  PIC  X(45)    VALUE          11160000
111700             '*******   E N D   O F   R E P O R T   *******'.     11170000
111800         10  FILLER                  PIC  X(43)    VALUE SPACES.  11180000
111900                                                                  11190000
112000     05  NO-DETAIL-LINE.                                          11200000
112100         10  FILLER                  PIC  X(29)    VALUE          11210000
112200             'NO DETAIL FOR THIS ASN NUMBER'.                     11220000
112300         10  FILLER                  PIC  X(103)   VALUE SPACES.  11230000
112400                                                                  11240000
112500     05  NO-INPUT-LINE.                                           11250000
112600         10  FILLER                  PIC  X(33)    VALUE          11260000
112700             'THERE WAS NO INPUT DATA TO REPORT'.                 11270000
112800         10  FILLER                  PIC  X(99)    VALUE SPACES.  11280000
112900                                                                  11290000
113000     05  NO-ASN-ERRORS-LINE.                                      11300000
113100         10  FILLER                  PIC  X(47)    VALUE          11310000
113200             'NONE OF THE INPUT DATA HAD ANY ERRORS TO REPORT'.   11320000
113300         10  FILLER                  PIC  X(85)    VALUE SPACES.  11330000
113400                                                                  11340000
113500 01  DETAIL-HEADING-LINES.                                        11350000
113600     05  DETAIL-HEADING-LINE-1.                                   11360000
113700         10  FILLER                  PIC  X(44)    VALUE          11370000
113800             ' PO        SKU          UPC NUMBER          '.      11380000
113900         10  FILLER                  PIC  X(44)    VALUE          11390000
114000             '          SIZE        UNIT COST      TOT OTR'.      11400013
114100         10  FILLER                  PIC  X(44)    VALUE          11410000
114200             '      QTY         QTY                       '.      11420000
114300                                                                  11430000
114400     05  DETAIL-HEADING-LINE-2.                                   11440000
114500         10  FILLER                  PIC  X(44)    VALUE          11450000
114600             'LINE      ISA #         DESCRIPTION     VEND'.      11460000
114700         10  FILLER                  PIC  X(44)    VALUE          11470000
114800             'OR STYLE  COLOR       UNIT RETAIL     DC OTR'.      11480013
114900         10  FILLER                  PIC  X(44)    VALUE          11490000
115000             '   ORDERED UM  SHIPPED UM  ---ERROR CODES---'.      11500000
115100                                                                  11510000
115200 01  DETAIL-LINES.                                                11520000
115300     05  DETAIL-LINE1.                                            11530000
115400         10  DL1-PO-LINE             PIC  X(04)    VALUE SPACES.  11540000
115500         10  FILLER                  PIC  X(01)    VALUE SPACES.  11550000
115600***************************************************************** 11560000
115700*                                             ** WR # 230ZZ     * 11570000
115800* INCREASED THE SIZE OF FIELD DL1-SEQ FROM X(03) TO X(08).      * 11580000
115900* REPLACED THE DASHES IN BETWEEN DL1-DEPT AND DL1-CLASS,        * 11590000
116000* DL1-CLASS AND DL1-SEQ WITH SPACES.                            * 11600000
116100***************************************************************** 11610000
116200         10  DL1-SKU.                                             11620000
116300             15  DL1-DEPT            PIC  X(03)    VALUE SPACES.  11630000
116400             15  DL1-SKU-SPACE-1     PIC  X(01)    VALUE SPACE.   11640000
116500             15  DL1-CLASS           PIC  X(02)    VALUE SPACES.  11650000
116600             15  DL1-SKU-SPACE-2     PIC  X(01)    VALUE SPACE.   11660000
116700             15  DL1-SEQ             PIC  X(08)    VALUE SPACES.  11670000
116800***************************************************************** 11680000
116900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        * 11690000
117000***************************************************************** 11700000
117100         10  FILLER                  PIC  X(01)    VALUE SPACES.  11710000
117200         10  DL1-UPC-NBR.                                         11720000
117300             15  DL1-UPC-NBR-1       PIC  X(01)    VALUE SPACES.  11730000
117400             15  FILLER              PIC  X(01)    VALUE '-'.     11740000
117500             15  DL1-UPC-NBR-2-9     PIC  X(08)    VALUE SPACES.  11750000
117600             15  FILLER              PIC  X(01)    VALUE '-'.     11760000
117700             15  DL1-UPC-NBR-10-14   PIC  X(05)    VALUE SPACES.  11770000
117800             15  FILLER              PIC  X(01)    VALUE '-'.     11780000
117900             15  DL1-UPC-NBR-15      PIC  X(01)    VALUE SPACE.   11790000
118000         10  FILLER                  PIC  X(01)    VALUE SPACES.  11800000
118100         10  DL1-VENDOR-STYLE        PIC  X(12)    VALUE SPACES.  11810000
118200         10  FILLER                  PIC  X(02)    VALUE SPACES.  11820000
118300         10  DL1-SIZE                PIC  X(10)    VALUE SPACES.  11830000
118600         10  FILLER                  PIC  X(04)    VALUE SPACES.  11860012
118700         10  DL1-UNIT-COST           PIC ZZZZZZ.99 VALUE ZERO.    11870013
118800         10  FILLER                  PIC  X(04)    VALUE SPACE.   11880012
118900         10  DL1-TOTAL-OTR           PIC  ZZZZ,ZZ9                11890013
119000                                                   VALUE ZERO.    11900000
119100         10  FILLER                  PIC  X(01)    VALUE SPACE.   11910000
119200         10  DL1-QTY-ORDERED         PIC  ZZZZ,ZZ9                11920000
119300                                                   VALUE ZERO.    11930000
119400         10  FILLER                  PIC  X(01)    VALUE SPACE.   11940000
119500         10  DL1-QTY-ORDERED-UM      PIC  X(02)    VALUE SPACES.  11950000
119600         10  FILLER                  PIC  X(01)    VALUE SPACE.   11960000
119700         10  DL1-QTY-SHIPPED         PIC  ZZZZ,ZZ9                11970000
119800                                                   VALUE ZERO.    11980000
119900         10  FILLER                  PIC  X(01)    VALUE SPACE.   11990000
120000         10  DL1-QTY-SHIPPED-UM      PIC  X(02)    VALUE SPACES.  12000000
120100         10  FILLER                  PIC  X(02)    VALUE SPACES.  12010000
120200         10  DL1-ERROR-MSG           PIC  X(17)    VALUE SPACES.  12020000
120300                                                                  12030000
120400     05  DETAIL-LINE2.                                            12040000
120500         10  FILLER                  PIC  X(5)     VALUE SPACES.  12050000
120600         10  DL2-ISA                 PIC  X(9)     VALUE SPACES.  12060000
120700         10  FILLER                  PIC  X(7)     VALUE SPACES.  12070000
120800         10  DL2-UPC-DESCRIPTION     PIC  X(25)    VALUE SPACES.  12080000
120900         10  FILLER                  PIC  X(08)    VALUE SPACES.  12090000
121000         10  DL2-COLOR               PIC  X(10)    VALUE SPACES.  12100000
121001         10  FILLER                  PIC  X(04)    VALUE SPACES.  12100108
121010         10  DL1-UNIT-RETAIL         PIC ZZZZZZ.99 VALUE ZERO.    12101013
121100         10  FILLER                  PIC  X(04)    VALUE SPACES.  12110008
121200         10  DL2-DC-OTR              PIC  ZZZZ,ZZ9                12120013
121300                                                   VALUE ZERO.    12130000
121400         10  FILLER                  PIC  X(26)    VALUE SPACES.  12140000
121500         10  DL2-ERROR-MSG           PIC  X(17)    VALUE SPACES.  12150000
121600                                                                  12160000
121700     05  DETAIL-LINE3.                                            12170000
121800         10  FILLER                  PIC  X(114)   VALUE SPACES.  12180000
121900         10  DL3-ERROR-MSG           PIC  X(17)    VALUE SPACES.  12190000
122000         10  FILLER                  PIC  X(01)    VALUE SPACE.   12200000
122100                                                                  12210000
122200     05  DETAIL-LINEP1.                                           12220000
122300         10  DLP1-VENDOR-NAME        PIC  X(20)    VALUE SPACES.  12230000
122400         10  FILLER                  PIC  X(01)    VALUE SPACES.  12240000
122500         10  DLP1-PO-NUMBER          PIC  9(08)    VALUE ZEROES.  12250014
122600         10  FILLER                  PIC  X(01)    VALUE SPACES.  12260014
122700         10  DLP1-BOL                PIC  X(16)    VALUE SPACES.  12270000
122800         10  FILLER                  PIC  X(02)    VALUE SPACES.  12280000
122900         10  DLP1-CARRIER-SCAC-CODE  PIC  X(04)    VALUE SPACES.  12290000
123000         10  FILLER                  PIC  X(02)    VALUE SPACES.  12300000
123100         10  DLP1-ISA-NBR            PIC  X(9)     VALUE SPACES.  12310000
123200         10  FILLER                  PIC  X(02)    VALUE SPACES.  12320000
123300         10  DLP1-ASN-NBR            PIC  X(30)    VALUE ZEROES.  12330000
123400                                                                  12340000
123500         10  FILLER                  PIC  X(02)    VALUE SPACES.  12350000
123600         10  DLP1-SHIP-DATE.                                      12360000
123700             15  DLP1-SHIP-DATE-MM   PIC  X(02)    VALUE SPACES.  12370000
123800             15  FILLER              PIC  X(01)    VALUE '/'.     12380000
123900             15  DLP1-SHIP-DATE-DD   PIC  X(02)    VALUE SPACES.  12390000
124000             15  FILLER              PIC  X(01)    VALUE '/'.     12400000
124100             15  DLP1-SHIP-DATE-YY   PIC  X(02)    VALUE SPACES.  12410000
124200         10  FILLER                  PIC  X(02)    VALUE SPACES.  12420000
124300         10  DLP1-MAN-NBR            PIC  X(01)    VALUE SPACES.  12430000
124400         10  FILLER                  PIC  X(02)    VALUE SPACES.  12440000
124500         10  DLP1-ASN-CARTONS        PIC  Z(05)    VALUE ZEROES.  12450000
124600         10  FILLER                  PIC  X(02)    VALUE SPACES.  12460000
124700         10  DLP1-CALC-CARTONS       PIC  Z(05)    VALUE ZEROES.  12470000
124800         10  FILLER                  PIC  X(02)    VALUE SPACES.  12480000
124900         10  DLP1-TOTAL-UNITS        PIC  Z(05)    VALUE ZEROES.  12490000
125000         10  FILLER                  PIC  X(03)    VALUE SPACES.  12500000
125100                                                                  12510000
125200     05  DETAIL-LINEP2.                                           12520000
125300         10  FILLER                  PIC  X(23)    VALUE          12530000
125400             ' *** ERRORS/EXCEPTIONS:'.                           12540000
125500         10  DLP2-ERROR-MSG-TBL  OCCURS 12 TIMES                  12550000
125600                                 INDEXED BY ERR-INDX.             12560000
125700             15  FILLER              PIC  X(02)    VALUE SPACES.  12570000
125800             15  DLP2-ERROR-MSG      PIC  X(04)    VALUE SPACES.  12580000
125900         10  FILLER                  PIC  X(37)    VALUE SPACES.  12590000
126000                                                                  12600000
126100******************************************************************12610000
126200*   PRINT LINES FOR FOOTINGS                                      12620000
126300******************************************************************12630000
126400 01  FOOTING-LINES.                                               12640000
126500     05  FOOTING-LINE1.                                           12650000
126600         10  FILLER                  PIC  X(03)    VALUE SPACES.  12660000
126700         10  FILLER                  PIC  X(18)    VALUE          12670000
126800             'POLN-NO PO LINE   '.                                12680000
126900         10  FILLER                  PIC  X(18)    VALUE          12690000
127000             'PRIC-PRICE DISCR  '.                                12700000
127100         10  FILLER                  PIC  X(18)    VALUE          12710000
127200             'CSPK-LSS THN CSPK '.                                12720000
127300         10  FILLER                  PIC  X(18)    VALUE          12730000
127400             'CHGD-CHG DAYS     '.                                12740000
127500         10  FILLER                  PIC  X(18)    VALUE          12750000
127600             'PCHG-PRICE CHG    '.                                12760000
127700         10  FILLER                  PIC  X(18)    VALUE          12770000
127800             'OVRN-OVER NT      '.                                12780000
127900         10  FILLER                  PIC  X(18)    VALUE          12790000
128000             'ISTR-INVALID STORE'.                                12800000
128100         10  FILLER                  PIC  X(03)    VALUE SPACES.  12810000
128200                                                                  12820000
128300     05  FOOTING-LINE2.                                           12830000
128400         10  FILLER                  PIC  X(03)    VALUE SPACES.  12840000
128500         10  FILLER                  PIC  X(18)    VALUE          12850000
128600             'OVRY-OVER         '.                                12860000
128700         10  FILLER                  PIC  X(18)    VALUE          12870000
128800             'SHTN-SHORT NT     '.                                12880000
128900         10  FILLER                  PIC  X(18)    VALUE          12890000
129000             'SHTY-SHORT        '.                                12900000
129100         10  FILLER                  PIC  X(18)    VALUE          12910000
129200             'CANC-CANCELLED    '.                                12920000
129300         10  FILLER                  PIC  X(18)    VALUE          12930000
129400             'CBAL-CANCLD BAL   '.                                12940000
129500         10  FILLER                  PIC  X(18)    VALUE          12950000
129600             'COMP-COMPLETE     '.                                12960000
129700         10  FILLER                  PIC  X(18)    VALUE          12970000
129800             'ZQTY-ZERO SHIP QTY'.                                12980000
129900         10  FILLER                  PIC  X(03)    VALUE SPACES.  12990000
130000                                                                  13000000
130100 01  SUMMARY-DETAIL-LINES.                                        13010000
130200     05  SUMMARY-DETAIL-LINE1.                                    13020000
130300         10  FILLER                  PIC  X(79)    VALUE SPACES.  13030000
130400         10  SDL1-TOTAL-OTR          PIC  ZZZZZ,ZZ9               13040000
130500                                                   VALUE ZERO.    13050000
130600         10  FILLER                  PIC  X(02)    VALUE SPACE.   13060000
130700         10  SDL1-QTY-ORDERED        PIC  ZZZZ,ZZ9                13070000
130800                                                   VALUE ZERO.    13080000
130900         10  FILLER                  PIC  X(04)    VALUE SPACE.   13090000
131000         10  SDL1-QTY-SHIPPED        PIC  ZZZZ,ZZ9                13100000
131100                                                   VALUE ZERO.    13110000
131200         10  FILLER                  PIC  X(22)    VALUE SPACES.  13120000
131300                                                                  13130000
131400     05  SUMMARY-DETAIL-LINE2.                                    13140000
131500         10  FILLER                  PIC  X(79)    VALUE SPACES.  13150000
131600         10  SDL2-DC-OTR             PIC  ZZZZZ,ZZ9               13160000
131700                                                   VALUE ZERO.    13170000
131800         10  FILLER                  PIC  X(44)    VALUE SPACES.  13180000
131900                                                                  13190000
132000     05  SUMMARY-DETAIL-LINEP1.                                   13200000
132100         10  FILLER                  PIC  X(115)   VALUE SPACES.  13210000
132200         10  FILLER                  PIC  X(08)  VALUE 'TOTALS: '.13220000
132300         10  SDL1-TOTAL-UNITS        PIC  ZZZZZ9   VALUE ZERO.    13230000
132400         10  FILLER                  PIC  X(60)    VALUE SPACE.   13240000
132500                                                                  13250000
132600 01  ABEND-CODE                       PIC S9(04)     VALUE +0     13260000
132700                                                     COMP SYNC.   13270000
132800     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 13280000
132900     88  ABEND-4002-READ-ERROR                       VALUE +4002. 13290000
133000     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 13300000
133100     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 13310000
133200     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 13320000
133300     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 13330000
133400     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 13340000
133500     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 13350000
133600     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 13360000
133700     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 13370000
133800                                                                  13380000
133900******************************************************************13390000
134000*  WORK AREA FOR THE RANDOM NUMBER SUBROUTINE.                    13400000
134100******************************************************************13410000
134200     COPY DPWS902.                                                13420000
134300                                                                  13430000
134400                                                                  13440000
134500******************************************************************13450000
134600*  WORK AREA PASSED IN CALL TO RCKUT023 - FORMAT PRO, BOL, VEHICL 13460000
134700******************************************************************13470000
134800     COPY RCWS023.                                                13480000
134900 EJECT                                                            13490000
135000                                                                  13500000
135100     COPY RCRD016.                                                13510000
135200 EJECT                                                            13520000
135300******************************************************************13530000
135400*    ASN RECEIVING REPORT LAYOUT                                  13540000
135500******************************************************************13550000
135600     COPY RCRD004.                                                13560000
135700 EJECT                                                            13570000
135800*!!!                                                              13580000
135900******************************************************************13590000
136000*    UPDATE CARTON FILE LAYOUT                                    13600000
136100******************************************************************13610000
136200     COPY RCRD017.                                                13620000
136300 EJECT                                                            13630000
136400*!!!                                                              13640000
136500******************************************************************13650000
136600*    EXTRACT CARTON FILE LAYOUT                                   13660000
136700******************************************************************13670000
136800     COPY RCRD052.                                                13680000
136900 EJECT                                                            13690000
137000*!!!                                                              13700000
137100******************************************************************13710000
137200*    NUMERIC EDIT LAYOUT                                          13720000
137300******************************************************************13730000
137400     COPY DPWS010I.                                               13740000
137410                                                                  13741024
137420*---------------------------------------------------------------- 13742024
137430* CHECKPOINT RESTART MODULE COPYBOOK                            - 13743024
137440*---------------------------------------------------------------- 13744024
137450     COPY DPWS991.                                                13745024
137460                                                                  13746024
137500******************************************************************13750000
137600* TRANSACTION PRESENTATION MODULE PARAMETERS                      13760000
137700******************************************************************13770000
137800     COPY DPLS001.                                                13780000
137900         05  WORK-STRG-AREA          PIC X(600).                  13790017
138000                                                                  13800000
138100******************************************************************13810000
138200*    ASN TRANSACTION EXTRACT RECORD LAYOUT                        13820000
138300******************************************************************13830000
138400     COPY RCRD001.                                                13840000
138401******************************************************************13840100
138410*  PROGRAM STATISTICS RECORD LAYOUT                               13841000
138420******************************************************************13842000
138440     COPY RCRD082.                                                13844000
138500                                                                  13850000
138600 EJECT                                                            13860000
138700*                                                                 13870000
138800*  CHECK POINT RESTART CONTROL                                    13880000
138900*                                                                 13890000
139000     EXEC SQL                                                     13900000
139100         INCLUDE TCKRSTCN                                         13910000
139200     END-EXEC.                                                    13920000
139300                                                                  13930000
139400*                                                                 13940000
139500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PACK SLIP TABLE    13950000
139600*                                                                 13960000
139700     EXEC SQL                                                     13970000
139800         INCLUDE TPKSLIP                                          13980000
139900     END-EXEC.                                                    13990000
140000                                                                  14000000
140100*                                                                 14010000
140200*  LOCATION TABLE LAYOUT                                          14020000
140300                                                                  14030000
140400     EXEC SQL                                                     14040000
140500         INCLUDE XLT00010                                         14050000
140600     END-EXEC.                                                    14060000
140700                                                                  14070000
140800*                                                                 14080000
140900*  EXTERNAL ENTERPRISE TABLE LAYOUT                               14090000
141000                                                                  14100000
141100     EXEC SQL                                                     14110000
141200         INCLUDE TEXTENT                                          14120000
141300     END-EXEC.                                                    14130000
141400                                                                  14140000
141500*                                                                 14150000
141600*  EXTERNAL ENTERPRISE NAME TABLE LAYOUT                          14160000
141700*                                                                 14170000
141800     EXEC SQL                                                     14180000
141900         INCLUDE TENTNME                                          14190000
142000     END-EXEC.                                                    14200000
142100                                                                  14210000
142200 EJECT                                                            14220000
142300*                                                                 14230000
142400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PACK SLIP ITEM TABL14240000
142500*                                                                 14250000
142600     EXEC SQL                                                     14260000
142700         INCLUDE TPKITEM                                          14270000
142800     END-EXEC.                                                    14280000
142900*                                                                 14290000
143000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     14300000
143100*  INSTRUCTIONS TABLE                                             14310000
143200*                                                                 14320000
143300     EXEC SQL                                                     14330000
143400          INCLUDE TPOINST                                         14340000
143500     END-EXEC.                                                    14350000
143600*                                                                 14360000
143700*  SHIPMENT TABLE LAYOUT                                          14370000
143800*                                                                 14380000
143900     EXEC SQL                                                     14390000
144000         INCLUDE TSHIPMT                                          14400000
144100     END-EXEC.                                                    14410000
144200                                                                  14420000
144300 EJECT                                                            14430000
144400*                                                                 14440000
144500*  SHIPMENT STATUS TABLE LAYOUT                                   14450000
144600*                                                                 14460000
144700     EXEC SQL                                                     14470000
144800         INCLUDE TSHIPST                                          14480000
144900     END-EXEC.                                                    14490000
145000                                                                  14500000
145100*                                                                 14510000
145200*  SHIPMENT STATUS TYPE TABLE LAYOUT                              14520000
145300*                                                                 14530000
145400     EXEC SQL                                                     14540000
145500         INCLUDE TSHSTYP                                          14550000
145600     END-EXEC.                                                    14560000
145700                                                                  14570000
145800 EJECT                                                            14580000
145900*                                                                 14590000
146000*  SHIPMENT/PO ASSOCIATION TABLE LAYOUT                           14600000
146100*                                                                 14610000
146200     EXEC SQL                                                     14620000
146300         INCLUDE TSHPTPO                                          14630000
146400     END-EXEC.                                                    14640000
146500                                                                  14650000
146600*                                                                 14660000
146700*  SHIPMENT/PO ASSOCIATION AUDIT TABLE LAYOUT                     14670000
146800*                                                                 14680000
146900     EXEC SQL                                                     14690000
147000         INCLUDE TAUSHPO                                          14700000
147100     END-EXEC.                                                    14710000
147200                                                                  14720000
147300 EJECT                                                            14730000
147400*                                                                 14740000
147500*  SHIPMENT VEHICLE TABLE LAYOUT                                  14750000
147600*                                                                 14760000
147700     EXEC SQL                                                     14770000
147800         INCLUDE TVEHICL                                          14780000
147900     END-EXEC.                                                    14790000
148000                                                                  14800000
148100 EJECT                                                            14810000
148200*                                                                 14820000
148300*  SHIPMENT VEHICLE TRIP TABLE LAYOUT                             14830000
148400*                                                                 14840000
148500     EXEC SQL                                                     14850000
148600         INCLUDE TVHTRIP                                          14860000
148700     END-EXEC.                                                    14870000
148800                                                                  14880000
148900*                                                                 14890000
149000*  TRIP STATUS TYPE TABLE LAYOUT                                  14900000
149100*                                                                 14910000
149200     EXEC SQL                                                     14920000
149300         INCLUDE TTRSTYP                                          14930000
149400     END-EXEC.                                                    14940000
149500                                                                  14950000
149600*                                                                 14960000
149700*  VEHICLE AUDIT TRAIL TABLE LAYOUT                               14970000
149800*                                                                 14980000
149900     EXEC SQL                                                     14990000
150000         INCLUDE TAUVHCL                                          15000000
150100     END-EXEC.                                                    15010000
150200                                                                  15020000
150300 EJECT                                                            15030000
150400*                                                                 15040000
150500*  TRIP AUDIT TRAIL TABLE LAYOUT                                  15050000
150600*                                                                 15060000
150700     EXEC SQL                                                     15070000
150800         INCLUDE TAUTRIP                                          15080000
150900     END-EXEC.                                                    15090000
151000                                                                  15100000
151100 EJECT                                                            15110000
151200*                                                                 15120000
151300*  SHIPMENT AUDIT TRAIL TABLE LAYOUT                              15130000
151400*                                                                 15140000
151500     EXEC SQL                                                     15150000
151600         INCLUDE TAUSHIP                                          15160000
151700     END-EXEC.                                                    15170000
151800                                                                  15180000
151900 EJECT                                                            15190000
152000*                                                                 15200000
152100*  SHIPMENT VEHICLE TRIP STATUS TABLE LAYOUT                      15210000
152200*                                                                 15220000
152300     EXEC SQL                                                     15230000
152400         INCLUDE TTRIPST                                          15240000
152500     END-EXEC.                                                    15250000
152600                                                                  15260000
152700*                                                                 15270000
152800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     15280000
152900*  INSTRUCTIONS CODE TABLE                                        15290000
153000*                                                                 15300000
153100     EXEC SQL                                                     15310000
153200          INCLUDE TINSTCD                                         15320000
153300     END-EXEC.                                                    15330000
153400*                                                                 15340000
153500*    DB2 DCLGEN FOR PURCHASE ORDER LINE ITEM TABLE                15350000
153600*                                                                 15360000
153700     EXEC SQL                                                     15370000
153800          INCLUDE TPURITM                                         15380000
153900     END-EXEC.                                                    15390000
154000                                                                  15400000
154100*                                                                 15410000
154200*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          15420000
154300*                                                                 15430000
154400     EXEC SQL                                                     15440000
154500          INCLUDE TPURCHS                                         15450000
154600     END-EXEC.                                                    15460000
154700                                                                  15470000
154800                                                                  15480000
154900*                                                                 15490000
155000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ALLOCATION         15500000
155100*  PLAN TABLE                                                     15510000
155200*                                                                 15520000
155300     EXEC SQL                                                     15530000
155400          INCLUDE TALLPLN                                         15540000
155500     END-EXEC.                                                    15550000
155600                                                                  15560000
155700*                                                                 15570000
155800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       15580000
155900*  TABLE                                                          15590000
156000*                                                                 15600000
156100     EXEC SQL                                                     15610000
156200         INCLUDE TRECITM                                          15620000
156300     END-EXEC.                                                    15630000
156400                                                                  15640000
156500*                                                                 15650000
156600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER           15660000
156700*  TABLE                                                          15670000
156800*                                                                 15680000
156900     EXEC SQL                                                     15690000
157000         INCLUDE TRECDIS                                          15700000
157100     END-EXEC.                                                    15710000
157200                                                                  15720000
157300*                                                                 15730000
157400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER           15740000
157500*  TABLE                                                          15750000
157600*                                                                 15760000
157700     EXEC SQL                                                     15770000
157800         INCLUDE TMESTDS                                          15780000
157900     END-EXEC.                                                    15790000
158000                                                                  15800000
158100*                                                                 15810000
158200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      15820000
158300*  TABLE                                                          15830000
158400*                                                                 15840000
158500     EXEC SQL                                                     15850000
158600         INCLUDE TSHPUNT                                          15860000
158700     END-EXEC.                                                    15870000
158800                                                                  15880000
158900*                                                                 15890000
159000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT/     15900000
159100*  UPC ASSOCIATION TABLE                                          15910000
159200*                                                                 15920000
159300     EXEC SQL                                                     15930000
159400         INCLUDE TSHUUPC                                          15940000
159500     END-EXEC.                                                    15950000
159600                                                                  15960000
159700*                                                                 15970000
159800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI        15980000
159900*  PACKSLIP / VENDOR SHIPMENT UNIT ASSOCIATION TABLE              15990000
160000*                                                                 16000000
160100     EXEC SQL                                                     16010000
160200         INCLUDE TINPKSU                                          16020000
160300     END-EXEC.                                                    16030000
160400                                                                  16040000
160500*                                                                 16050000
160600*  ASN HEADER TABLE LAYOUT                                        16060000
160700*                                                                 16070000
160800     EXEC SQL                                                     16080000
160900         INCLUDE TASNHDR                                          16090000
161000     END-EXEC.                                                    16100000
161100                                                                  16110000
161200*                                                                 16120000
161300*  ASN CARTON  TABLE LAYOUT                                       16130000
161400*                                                                 16140000
161500     EXEC SQL                                                     16150000
161600         INCLUDE TASNCAR                                          16160000
161700     END-EXEC.                                                    16170000
161780*                                                                 16178000
161790***RC - RECEIVING WORK TABLE15 USING RCRD004                      16179000
161791***     RCTW_OUT15                                                16179100
161792     EXEC SQL                                                     16179200
161793          INCLUDE RCT00035                                        16179300
161794     END-EXEC.                                                    16179400
161796*                                                                 16179600
161797***RC - RECEIVING WORK TABLE16 USING RCRD016                      16179700
161798***     RCTW_OUT16                                                16179800
161799     EXEC SQL                                                     16179900
161800          INCLUDE RCT00036                                        16180000
161801     END-EXEC.                                                    16180100
161803*                                                                 16180300
161804***RC - RECEIVING WORK TABLE17 USING RCRD017                      16180400
161805***     RCTW_OUT17                                                16180500
161806     EXEC SQL                                                     16180600
161807          INCLUDE RCT00037                                        16180700
161808     END-EXEC.                                                    16180800
161810*                                                                 16181000
161811***RC - RECEIVING WORK TABLE18 USING RCRD052                      16181100
161812***     RCTW_OUT18                                                16181200
161813     EXEC SQL                                                     16181300
161814          INCLUDE RCT00038                                        16181400
161815     END-EXEC.                                                    16181500
161816*                                                                 16181600
161817***RC - RECEIVING WORK TABLE19 USING RCRD082                      16181700
161818***     RCTW_OUT19                                                16181800
161819     EXEC SQL                                                     16181900
161820          INCLUDE RCT00039                                        16182000
161821     END-EXEC.                                                    16182100
161830                                                                  16183000
161900*                                                                 16190000
162000*  COMMUNICATIONS AREA FOR DB2                                    16200000
162100*                                                                 16210000
162200     EXEC SQL                                                     16220000
162300         INCLUDE SQLCA                                            16230000
162400     END-EXEC.                                                    16240000
162500                                                                  16250000
162600*                                                                 16260000
162700* DB2 COMMUNICATION AREA 2                                        16270000
162800*                                                                 16280000
162900     COPY SQLCA2.                                                 16290000
163000                                                                  16300000
163100*                                                                 16310000
163200*  SQL DB2 SPECIAL INSTRUCTION CURSOR DECLARATION                 16320000
163300*                                                                 16330000
163400     EXEC SQL                                                     16340000
163500          DECLARE SP_INSTR_CSR CURSOR FOR                         16350000
163600             SELECT  B.INSTR_DESC                                 16360000
163700               FROM  TPOINST A,                                   16370000
163800                     TINSTCD B                                    16380000
163900              WHERE  (A.PO_NBR     =  :DK-PO-NBR                  16390000
164000                AND   A.RECIP_CDE  =  'DC'                        16400000
164100                AND   A.INSTR_NBR  =  B.INSTR_NBR)                16410000
164200     END-EXEC.                                                    16420000
164300                                                                  16430000
164400******************************************************************16440000
164500*    DECLARE RE-DISTRO CURSOR                                     16450000
164600******************************************************************16460000
164700     EXEC SQL                                                     16470000
164800          DECLARE REDISTRO-CSR CURSOR FOR                         16480000
164900          SELECT DISTINCT REC_SEQ_NBR                             16490000
165000            FROM TRECITM                                          16500000
165100           WHERE ORD_NBR         = :DK-PO-NBR                     16510000
165200             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                16520000
165300             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                16530000
165400             AND (CRE_TMST       < :RECITM-CRE-TMST OR            16540000
165500                  STATUS_CDE     = :PC-VE)                        16550000
165600           ORDER BY REC_SEQ_NBR                                   16560000
165700     END-EXEC.                                                    16570000
165800                                                                  16580000
165900******************************************************************16590000
166000*    DECLARE RE-DISTRO ALL CURSOR                                 16600000
166100******************************************************************16610000
166200     EXEC SQL                                                     16620000
166300          DECLARE REDISTRO-ALL-CSR CURSOR FOR                     16630000
166400          SELECT DISTINCT REC_SEQ_NBR                             16640000
166500            FROM TRECITM                                          16650000
166600           WHERE ORD_NBR         = :DK-PO-NBR                     16660000
166700             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                16670000
166800             AND (CRE_TMST       < :RECITM-CRE-TMST OR            16680000
166900                  STATUS_CDE     = :PC-VE)                        16690000
167000           ORDER BY REC_SEQ_NBR                                   16700000
167100     END-EXEC.                                                    16710000
167200                                                                  16720000
167300     EXEC SQL                                                     16730000
167400         DECLARE ITM_QTY_CSR CURSOR FOR                           16740000
167500             SELECT  B.PKSL_ITM_QTY,                              16750000
167600                     B.DTL_CK_ITM_QTY                             16760000
167700               FROM  TPURITM A,                                   16770000
167800                     TRECITM B                                    16780000
167900              WHERE  (A.PO_NBR            =  :DK-PO-NBR           16790000
168000                AND   A.PO_NBR            =  B.ORD_NBR            16800000
168100**************************************************************    16810000
168200*               AND   B.REC_SEQ_NBR      ^=  :DK-REC-SEQ-NBR      16820000
168300**************************************************************    16830000
168400                AND   (B.STATUS_CDE       =  :PC-IP               16840000
168500                 OR    B.STATUS_CDE       =  :PC-CM)              16850000
168600                AND   B.OPER_UNT_ID       =  :DK-OPER-UNT-ID      16860000
168700                AND   A.APP_PO_LNE_NBR    =  :DK-ORD-LNE-NBR      16870000
168800                AND   A.APP_PO_LNE_NBR    =  B.ORD_LNE_NBR        16880000
168900                AND   A.VER_STATUS_CDE    =  :PC-A                16890000
169000                AND   B.VER_STATUS_CDE    =  :PC-A)               16900000
169100     END-EXEC.                                                    16910000
169200                                                                  16920000
169300 EJECT                                                            16930000
169400***************************************************************** 16940000
169500* PROCEDURE DIVISION.                                           * 16950000
169600***************************************************************** 16960000
169700 PROCEDURE DIVISION.                                              16970000
169800                                                                  16980000
169900 0000-MAINLINE-PROCESSING.                                        16990000
170000                                                                  17000000
170100     PERFORM 1000-INITIALIZATION.                                 17010000
170200                                                                  17020000
170300     PERFORM 2000-PROCESS-ASN-EXTRACT-RECS                        17030000
170400       UNTIL PS-NO-MORE-ASN-RECS.                                 17040000
170500                                                                  17050000
170600     IF PS-HEADER-NOT-PRINTED                                     17060000
170700          PERFORM 8000-WRITE-REPORT-HEADERS                       17070000
170800     END-IF.                                                      17080000
170900     WRITE ASN-REPORT-RECORD                                      17090000
171000       FROM END-OF-REPORT-LINE                                    17100000
171100         AFTER ADVANCING 2 LINES.                                 17110000
171200                                                                  17120000
171300     MOVE PV-TOT-QTY-SHIPPED      TO SDL1-TOTAL-UNITS.            17130000
171400     WRITE PO-REPORT-RECORD                                       17140000
171500       FROM SUMMARY-DETAIL-LINEP1                                 17150000
171600         AFTER ADVANCING 1 LINE.                                  17160000
171700     WRITE PO-REPORT-RECORD                                       17170000
171800       FROM END-OF-REPORT-LINE                                    17180000
171900         AFTER ADVANCING 2 LINES.                                 17190000
172000     PERFORM 8550-WRITE-FOOTER-LINES.                             17200000
172100                                                                  17210000
172400     CLOSE ASN-REPORT-FILE                                        17240030
172600           PO-REPORT-FILE.                                        17260030
172900                                                                  17290000
173000     MOVE PC-CLOSE-FUNC          TO DP001-FUNC-CODE.              17300000
173100     PERFORM 7000-READ-ASN-EXTRACT.                               17310000
173200                                                                  17320000
173210     PERFORM 9900-GENERATE-STATISTICS.                            17321000
173400     STOP RUN.                                                    17340000
173500                                                                  17350000
173600 EJECT                                                            17360000
173700******************************************************************17370000
173800** READ THE DB2 CONTROL TABLE AND READ THE FIRST ASN EXTRACT REC *17380000
173900******************************************************************17390000
174000 1000-INITIALIZATION.                                             17400000
174100     PERFORM 1200-GET-CURRENT-TIMESTAMP                           17410000
174110     MOVE 'RCKUP006'             TO RC082-PGM-NM                  17411000
174120     MOVE 'LOAD PACKSLIP/CARTON DATA FOR RECEIVING'               17412000
174130                                 TO RC082-PGM-DESC                17413000
174140     MOVE '030'                  TO RC082-PGM-IN-JOB-SEQ-NBR      17414000
174150     SET RC082-ASN-PRE-RECV-NTERFACE                              17415000
174160         RC082-PGM-END-SUCCESS                                    17416000
174170         RC082-COMPANY-OPER-UNT-ID                                17417000
174180         RC082-ASN-TO-RECV-GROUP TO TRUE                          17418000
174190                                                                  17419030
174300     OPEN OUTPUT ASN-REPORT-FILE                                  17430000
174400                 PO-REPORT-FILE.                                  17440030
174500                                                                  17450030
174900     ACCEPT PV-CKPT-JOB-NAME FROM SYSIN.                          17490000
175000                                                                  17500000
175100     MOVE PC-OPEN-FUNC           TO DP001-FUNC-CODE.              17510000
175200     PERFORM 7000-READ-ASN-EXTRACT.                               17520000
175300                                                                  17530000
175400     INITIALIZE PS-TVHTRIP-VALID-TIMESTMP-SW                      17540000
175500                PS-VHTRIP-VEH-CHANGED-SW                          17550000
175600                PS-VHTRIP-SCAC-CHANGED-SW                         17560000
175700                PS-SHIPMENT-FOUND-SW                              17570000
175800                PS-VALID-VENDOR-SW                                17580000
175900                PS-UPDATE-SHIPMT-SW                               17590000
176000                PS-UPDATE-SHIPST-SW                               17600000
176100                PS-UPDATE-VEHICL-SW                               17610000
176200                PS-UPDATE-VHTRIP-SW                               17620000
176300                PS-UPDATE-TRIPST-SW                               17630000
176400                PS-FORECAST-SHIP-SW                               17640000
176500                PS-VALID-DC-SW                                    17650000
176600                PS-DUPLICATE-SHIPMT-SW                            17660000
176700                PS-HEADER-PRINTED-IND                             17670000
176800                PS-CREATE-PKSLIP-IND                              17680000
176900                PS-END-OF-ITM-QTY-CSR-IND                         17690000
177000                PS-FIRST-ASN-HEADER-IND                           17700000
177100                PS-MORE-ANS-RECS-IND                              17710000
177200                PS-NO-TRECITM-RECS-IND                            17720000
177300                PS-PLAN-SW                                        17730000
177400                PS-MORE-RECEIPT-SW                                17740000
177500                PS-DISTRO-EXISTS-SW                               17750000
177600                PS-DONE-SW                                        17760000
177700                PS-END-OF-ASN-HEADERS-IND                         17770000
177800                PS-END-OF-ASN-DETAIL-IND                          17780000
177900                PS-ASN-RECS-PROCESSED-IND                         17790000
178000                PS-FIRST-HEADER-IND                               17800000
178100                PS-PROCESS-ASN-IND                                17810000
178200                PS-NO-MORE-INST-SW.                               17820000
178300                                                                  17830000
178400     SET PS-DO-NOT-BYPASS-UPDATES TO TRUE.                        17840000
178500     ACCEPT PV-CURR-DATE-YYMMDD FROM DATE.                        17850000
178600     MOVE PV-CURR-DATE-YY TO PV-HOLD-CURR-DATE-YY.                17860000
178700     MOVE PV-CURR-DATE-MM TO PV-HOLD-CURR-DATE-MM.                17870000
178800     MOVE PV-CURR-DATE-DD TO PV-HOLD-CURR-DATE-DD.                17880000
178900                                                                  17890000
179000     ACCEPT PV-CURR-TIME FROM TIME.                               17900000
179100                                                                  17910000
179200     MOVE PV-CURR-DATE-MM        TO DP132O-RUN-MONTH.             17920000
179300     MOVE PV-CURR-DATE-DD        TO DP132O-RUN-DAY.               17930000
179400     MOVE PV-CURR-DATE-YY        TO DP132O-RUN-YEAR.              17940000
179500                                                                  17950000
179600     MOVE PV-CURR-TIME-HH        TO DP132O-RUN-HOUR.              17960000
179700     MOVE PV-CURR-TIME-MM        TO DP132O-RUN-MINUTE.            17970000
179800     MOVE PC-CURRENT-PROGRAM-NAME                                 17980000
179900                                 TO DP132O-PROGRAM-NAME.          17990000
180300                                                                  18030000
180400     PERFORM 1100-SELECT-CKRSTCNTL.                               18040000
180500     MOVE TCKRSTCNTL-PREP-TMESTP TO PV-PREP-TIMESTAMP.            18050000
180600*                                                                 18060029
180700     MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE.              18070000
180800*                                                                 18080029
180900                                                                  18090000
181000     MOVE RC001-ASN-TRANSCRIPTION-RECORD                          18100000
181100                                 TO WS-HOLD-ASN-HEADER.           18110000
181200     PERFORM                                                      18120000
181300       VARYING PPEMT-INDX FROM 1 BY 1                             18130000
181400         UNTIL PPEMT-INDX > 14                                    18140000
181500           MOVE PC-N              TO PPEMT-IND (PPEMT-INDX)       18150000
181600     END-PERFORM.                                                 18160000
181700                                                                  18170000
181800 EJECT                                                            18180000
181900 1100-SELECT-CKRSTCNTL.                                           18190000
182000                                                                  18200000
182100     EXEC SQL                                                     18210000
182200         SELECT PREP_TMESTP                                       18220000
182300           INTO :TCKRSTCNTL-PREP-TMESTP                           18230000
182400           FROM TCKRSTCNTL                                        18240000
182500          WHERE JOB_NAME = :PV-CKPT-JOB-NAME                      18250000
182600            AND PLAN_NAME = :PC-CKPT-PLAN-NAME                    18260000
182700     END-EXEC.                                                    18270000
182800                                                                  18280000
182900     EVALUATE TRUE                                                18290000
183000         WHEN SQLCODE = ZERO                                      18300000
183100             CONTINUE                                             18310000
183200                                                                  18320000
183300                                                                  18330000
183400         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  18340000
183500             DISPLAY '**********************************'         18350000
183600             DISPLAY 'WARNING ISSUED ON SELECT          '         18360000
183700             DISPLAY '**********************************'         18370000
183800             PERFORM 9700-SQL-WARNING                             18380000
183900                                                                  18390000
184000         WHEN SQLCODE < ZERO                                      18400000
184100             DISPLAY '**********************************'         18410000
184200             DISPLAY 'ERROR ISSUED ON SELECT            '         18420000
184300             DISPLAY '**********************************'         18430000
184400             PERFORM 9800-SQL-ERROR                               18440000
184500                                                                  18450000
184600     END-EVALUATE.                                                18460000
184700                                                                  18470000
184710 1200-GET-CURRENT-TIMESTAMP.                                      18471000
184720     EXEC SQL                                                     18472000
184730         SET :RC082-PGM-START-TMST = CURRENT TIMESTAMP            18473000
184740     END-EXEC.                                                    18474000
184750     IF SQLCODE NOT = ZERO                                        18475000
184760         MOVE '1200-GET-CURRENT-TIMESTAMP' TO PV-ABEND-PARAGRAPH  18476000
184761         DISPLAY '**********************************'             18476100
184770         DISPLAY 'ERROR ISSUED ON GET CURREMT TMSP  '             18477000
184780         DISPLAY '**********************************'             18478000
184790         PERFORM 9800-SQL-ERROR                                   18479000
184791     END-IF.                                                      18479100
184800                                                                  18480000
184900******************************************************************18490000
185000*  PROCESS THE ASN TRANSCRIPTION EXTRACT FILE.                   *18500000
185100*                                                                *18510000
185200******************************************************************18520000
185300 2000-PROCESS-ASN-EXTRACT-RECS.                                   18530000
185400                                                                  18540000
185500     INITIALIZE PS-TVHTRIP-VALID-TIMESTMP-SW                      18550000
185600                PS-VHTRIP-VEH-CHANGED-SW                          18560000
185700                PS-VHTRIP-SCAC-CHANGED-SW                         18570000
185800                PS-SHIPMENT-FOUND-SW                              18580000
185900                PS-VALID-VENDOR-SW                                18590000
186000                PS-UPDATE-SHIPMT-SW                               18600000
186100                PS-UPDATE-SHIPST-SW                               18610000
186200                PS-UPDATE-VEHICL-SW                               18620000
186300                PS-UPDATE-VHTRIP-SW                               18630000
186400                PS-UPDATE-TRIPST-SW                               18640000
186500                PS-FORECAST-SHIP-SW                               18650000
186600                PS-VALID-DC-SW                                    18660000
186700                PS-DUPLICATE-SHIPMT-SW                            18670000
186800                PS-HEADER-PRINTED-IND                             18680000
186900                PS-CREATE-PKSLIP-IND                              18690000
187000                PS-END-OF-ITM-QTY-CSR-IND                         18700000
187100                PS-FIRST-ASN-HEADER-IND                           18710000
187200                PS-MORE-ANS-RECS-IND                              18720000
187300                PS-NO-TRECITM-RECS-IND                            18730000
187400                PS-PLAN-SW                                        18740000
187500                PS-MORE-RECEIPT-SW                                18750000
187600                PS-DISTRO-EXISTS-SW                               18760000
187700                PS-DONE-SW                                        18770000
187800                PS-END-OF-ASN-HEADERS-IND                         18780000
187900                PS-END-OF-ASN-DETAIL-IND                          18790000
188000                PS-ASN-RECS-PROCESSED-IND                         18800000
188100                PS-FIRST-HEADER-IND                               18810000
188200                PS-PROCESS-ASN-IND                                18820000
188300                PS-NO-MORE-INST-SW.                               18830000
188400                                                                  18840000
188500     SET PS-DO-NOT-BYPASS-UPDATES TO TRUE.                        18850000
188600     SET PS-NOT-END-OF-ASN-HEADERS TO TRUE.                       18860000
188700     SET PS-NOT-END-OF-ASN-DETAIL  TO TRUE.                       18870000
188800     SET PS-FIRST-HEADER           TO TRUE.                       18880000
188900     SET PS-PROCESS-ASN            TO TRUE.                       18890000
189000     SET PS-ASN-RECS-PROCESSED     TO TRUE.                       18900000
189100                                                                  18910000
189200     PERFORM 3000-PROCESS-ASN-HEADERS                             18920000
189300       UNTIL (PS-END-OF-ASN-HEADERS OR                            18930000
189400              PS-NO-MORE-ASN-RECS).                               18940000
189500                                                                  18950000
189600******************************************************************18960000
189700* PLACE CODE HERE TO HANDLE SITUATION WHERE WE READ A HEADER     *18970000
189800* RECORD AND THEN HIT EOF WHICH MEANS THAT YOU DON'T HAVE ANY    *18980000
189900* DETAIL RECORDS FOR THIS HEADER RECORD.                         *18990000
190000******************************************************************19000000
190100                                                                  19010000
190200     IF PS-NO-MORE-ASN-RECS                                       19020000
190300         DISPLAY '** HEADER WITHOUT DETAIL'                       19030000
190400     ELSE                                                         19040000
190500         IF PS-CREATE-PKSLIP                                      19050000
190600           IF RC001-DETAIL-RECORD                                 19060000
190700             PERFORM 4000-PROCESS-ASN-DETAILS                     19070000
190800                 UNTIL (PS-END-OF-ASN-DETAIL OR                   19080000
190900                        PS-NO-MORE-ASN-RECS)                      19090000
191000             IF WS-HOLD-EDI-VEND-ID NOT = RC001-EDI-VEND-ID OR    19100000
191100                WS-HOLD-DIST-CNTR NOT = RC001-DIST-CNTR OR        19110000
191200                WS-HOLD-BILL-OF-LADING-NBR NOT =                  19120000
191300                             RC001-BILL-OF-LADING-NBR             19130000
191400                         OR                                       19140000
191500                WS-HOLD-PO-NBR NOT = RC001-PO-NBR OR              19150000
191600                PS-NO-MORE-ASN-RECS                               19160000
191700                 PERFORM 7900-WRITE-RECEIVER-FILE                 19170000
191800                 PERFORM 8450-WRITE-PO-DETAIL-LINES               19180000
191900                 IF PS-FORECAST-SHIP-MODE AND                     19190000
192000                    PS-NO-DUPLICATE-SHIPMT AND                    19200000
192100                    PS-DO-NOT-BYPASS-UPDATES                      19210000
192200                     PERFORM 7010-PROCESS-SHIPMENT                19220000
192300                 END-IF                                           19230000
192400             END-IF                                               19240000
192500           ELSE                                                   19250000
192600               DISPLAY '** CARTONS WITHOUT DETAIL'                19260000
192700           END-IF                                                 19270000
192800         ELSE                                                     19280000
192900             MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE       19290000
193000             PERFORM 7000-READ-ASN-EXTRACT                        19300000
193100                 UNTIL (RC001-PO-LINE-NBR-HDR OR                  19310000
193200                        PS-NO-MORE-ASN-RECS)                      19320000
193300         END-IF                                                   19330000
193400     END-IF.                                                      19340000
193500                                                                  19350000
193600     EXEC SQL                                                     19360000
193700         SET :PV-NEW-CURR-TIME = CURRENT TIME                     19370000
193800     END-EXEC.                                                    19380000
193900                                                                  19390000
194000                                                                  19400000
194100 EJECT                                                            19410000
194200******************************************************************19420000
194300** PROCESS THE ASN TRANSCRIPTION EXTRACT FILE.                   *19430000
194400******************************************************************19440000
194500 3000-PROCESS-ASN-HEADERS.                                        19450000
194600                                                                  19460000
194700     IF PS-FIRST-HEADER                                           19470000
194800         IF RC001-CREATE-PACKSLIP                                 19480000
194900             SET PS-CREATE-PKSLIP TO TRUE                         19490000
195000             SET PS-NOT-FIRST-HEADER      TO TRUE                 19500000
195100             MOVE SPACES                  TO HLP2-DC-ID           19510000
195200             IF RC001-DIST-CNTR = 0                               19520000
195300                 MOVE PC-UNKNOWN          TO HLP2-DC-UNKNOWN      19530000
195400             ELSE                                                 19540000
195500                 MOVE RC001-DIST-CNTR     TO HLP2-DC-NBR          19550000
195600                 MOVE RC001-DIST-CNTR TO PV-DC-9                  19560000
195700                 MOVE PV-DC-9 TO DK-OPER-UNT-ID                   19570000
195800                                 PV-TRIPST-OPER-UNT-ID            19580000
195900                 MOVE PC-1 TO DK-FCLTY-ID                         19590000
196000                                 PV-TRIPST-FCLTY-ID               19600000
196100                 PERFORM 3200-CHECK-IF-DC                         19610000
196200                 IF PS-VALID-DC                                   19620000
196300                     PERFORM 3100-SELECT-LOCATION                 19630000
196400                     MOVE XLT00010-LOC-NM     TO HLP2-DC-NAME     19640000
196500                 ELSE                                             19650000
196600                     MOVE SPACES              TO HLP2-DC-NAME     19660000
196700                 END-IF                                           19670000
196800             END-IF                                               19680000
196900             MOVE LOW-VALUES              TO WS-HOLD-PO-LINE-NBR  19690000
197000             IF RC001-DIST-CNTR NOT = PV-SAVE-DIST-CNTR           19700000
197100                 IF PV-SAVE-DIST-CNTR NOT = 0 AND                 19710000
197200                    PS-HEADER-NOT-PRINTED                         19720000
197300                      PERFORM 8000-WRITE-REPORT-HEADERS           19730000
197400                      WRITE ASN-REPORT-RECORD                     19740000
197500                        FROM END-OF-REPORT-LINE                   19750000
197600                          AFTER ADVANCING 2 LINES                 19760000
197700                 END-IF                                           19770000
197800                 SET PS-HEADER-NOT-PRINTED TO TRUE                19780000
197900             END-IF                                               19790000
198000             PERFORM 4100-PROCESS-HEADER                          19800000
198100             MOVE RC001-ASN-TRANSCRIPTION-RECORD                  19810000
198200                                          TO WS-HOLD-ASN-HEADER   19820000
198300             MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE       19830000
198400             PERFORM 7000-READ-ASN-EXTRACT                        19840000
198500         ELSE                                                     19850000
198600             SET PS-DO-NOT-CREATE-PKSLIP TO TRUE                  19860000
198700             MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE       19870000
198800             PERFORM 7000-READ-ASN-EXTRACT                        19880000
198900         END-IF                                                   19890000
199000     ELSE                                                         19900000
199100         IF RC001-PO-LINE-NBR-HDR                                 19910000
199200             IF PS-CREATE-PKSLIP                                  19920000
199300                 IF RC001-PO-NBR = DLP1-PO-NUMBER AND             19930000
199301                    RC001-STORE-NBR = PV-STORE-NBR AND            19930121
199500                    RC001-DIST-CNTR = PV-DIST-CNTR                19950000
199600                     ADD RC001-CARTON-CNT-STORE TO                19960000
199700                                        WS-HOLD-CARTON-CNT-STORE  19970000
199800                     ADD RC001-CARTON-CNT-PO TO                   19980000
199900                                        PV-ASN-CARTONS            19990000
200000                     MOVE PV-ASN-CARTONS   TO PV-ASN-CARTONS-SAVE 20000000
200100                     PERFORM 4100-PROCESS-HEADER                  20010000
200200                     MOVE PV-ASN-CARTONS-SAVE TO PV-ASN-CARTONS   20020000
200300                                            PV-CARTON-CNT-DISPLAY 20030000
200400                                            RC004-ASN-CARTONS     20040000
200500                     MOVE PV-SHIPMT-BOL-NBR TO                    20050000
200600                                        HL1-BILL-OF-LADING        20060000
200700                                        DLP1-BOL                  20070000
200800                                        RC004-BILL-OF-LADING-NBR  20080000
200900                 END-IF                                           20090000
201000                 MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE   20100000
201100                 PERFORM 7000-READ-ASN-EXTRACT                    20110000
201200             ELSE                                                 20120000
201300                 MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE   20130000
201400                 PERFORM 7000-READ-ASN-EXTRACT                    20140000
201500             END-IF                                               20150000
201600         ELSE                                                     20160000
201700             SET PS-END-OF-ASN-HEADERS                            20170000
201800                                      TO TRUE                     20180000
201900         END-IF                                                   20190000
202000     END-IF.                                                      20200000
202100                                                                  20210000
202200 EJECT                                                            20220000
202300/                                                                 20230000
202400*----------------------------------------------------------------*20240000
202500*    GET LOCATION NAME                                           *20250000
202600*----------------------------------------------------------------*20260000
202700                                                                  20270000
202800 3100-SELECT-LOCATION.                                            20280000
202900                                                                  20290000
203000     MOVE '3100-SELECT-TFACLTY'  TO PV-ABEND-PARAGRAPH.           20300000
203100                                                                  20310000
203200     PERFORM                                                      20320000
203300         WITH TEST AFTER                                          20330000
203400         VARYING PV-RETRY-COUNTER                                 20340000
203500         FROM 1 BY 1                                              20350000
203600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20360000
203700            OR  (SQLCODE = +100)                                  20370000
203800            OR  (SQLCODE = +0))                                   20380000
203900                                                                  20390000
204000         EXEC SQL                                                 20400000
204100             SELECT  LOC_NM                                       20410000
204200               INTO :XLT00010-LOC-NM                              20420000
204300              FROM  XLT_LOC                                       20430000
204400             WHERE  LOC_NBR = :DK-OPER-UNT-ID                     20440000
204500         END-EXEC                                                 20450000
204600                                                                  20460000
204700         EVALUATE TRUE                                            20470000
204800             WHEN SQLCODE = +0                                    20480000
204900             WHEN SQLCODE = +100                                  20490000
205000             WHEN SQLCODE = -911                                  20500000
205100                  CONTINUE                                        20510000
205200                                                                  20520000
205300                                                                  20530000
205400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              20540000
205500                 DISPLAY '**************************************' 20550000
205600                 DISPLAY 'WARNING ISSUED ON SELECT OF XLT_LOC   ' 20560000
205700                 DISPLAY 'LOC_NBR: ' DK-OPER-UNT-ID               20570000
205800                 DISPLAY '**************************************' 20580000
205900                 PERFORM 9700-SQL-WARNING                         20590000
206000                                                                  20600000
206100             WHEN SQLCODE < ZERO                                  20610000
206200                 DISPLAY '**************************************' 20620000
206300                 DISPLAY 'ERROR ISSUED ON SELECT OF XLT_LOC     ' 20630000
206400                 DISPLAY 'LOC_NBR: ' DK-OPER-UNT-ID               20640000
206500                 DISPLAY '**************************************' 20650000
206600                 PERFORM 9800-SQL-ERROR                           20660000
206700                                                                  20670000
206800         END-EVALUATE                                             20680000
206900     END-PERFORM.                                                 20690000
207000                                                                  20700000
207100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    20710000
207200         SQLCODE NOT = +0                                         20720000
207300         DISPLAY '**************************************'         20730000
207400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         20740000
207500         DISPLAY 'SELECT XLT_LOC                        '         20750000
207600         DISPLAY 'LOC_NBR: ' DK-OPER-UNT-ID                       20760000
207700         DISPLAY '**************************************'         20770000
207800         PERFORM 9800-SQL-ERROR                                   20780000
207900     END-IF.                                                      20790000
208000                                                                  20800000
208100                                                                  20810000
208200 3200-CHECK-IF-DC.                                                20820000
208300                                                                  20830000
208400     MOVE '3200-CHECK-IF-DC'     TO PV-ABEND-PARAGRAPH.           20840000
208500                                                                  20850000
208600     MOVE PV-DC-9                  TO XLT00010-LOC-NBR.           20860000
208700                                                                  20870000
208800     PERFORM                                                      20880000
208900         WITH TEST AFTER                                          20890000
209000         VARYING PV-RETRY-COUNTER                                 20900000
209100         FROM 1 BY 1                                              20910000
209200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20920000
209300                   OR (SQLCODE = +0)                              20930000
209400                   OR (SQLCODE = +100))                           20940000
209500                                                                  20950000
209600         EXEC SQL                                                 20960000
209700            SELECT  LOC_TYP_CDE                                   20970000
209800              INTO :XLT00010-LOC-TYP-CDE                          20980000
209900              FROM  XLT_LOC                                       20990000
210000             WHERE     LOC_NBR = :XLT00010-LOC-NBR                21000000
210100                  AND  LOC_TYP_CDE = 'DC'                         21010000
210200         END-EXEC                                                 21020000
210300                                                                  21030000
210400         EVALUATE TRUE                                            21040000
210500             WHEN SQLCODE = +0                                    21050000
210600             WHEN SQLCODE = -911                                  21060000
210700                 CONTINUE                                         21070000
210800                                                                  21080000
210900             WHEN SQLCODE = +100                                  21090000
211000                 SET PS-INVALID-DC TO TRUE                        21100000
211100                                                                  21110000
211200             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              21120000
211300                 DISPLAY '**************************************' 21130000
211400                 DISPLAY 'WARNING ISSUED ON SELECT OF XLT_LOC   ' 21140000
211500                 DISPLAY 'STORE-NMBR: ' XLT00010-LOC-NBR          21150000
211600                 DISPLAY '**************************************' 21160000
211700                 PERFORM 9700-SQL-WARNING                         21170000
211800                                                                  21180000
211900             WHEN SQLCODE < ZERO                                  21190000
212000                 DISPLAY '**************************************' 21200000
212100                 DISPLAY 'ERROR ISSUED ON SELECT OF XLT_LOC     ' 21210000
212200                 DISPLAY 'STORE-NMBR: ' XLT00010-LOC-NBR          21220000
212300                 DISPLAY '**************************************' 21230000
212400                 PERFORM 9800-SQL-ERROR                           21240000
212500         END-EVALUATE                                             21250000
212600     END-PERFORM.                                                 21260000
212700                                                                  21270000
212800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    21280000
212900         SQLCODE NOT = +0                                         21290000
213000         DISPLAY '**************************************'         21300000
213100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         21310000
213200         DISPLAY 'SELECT XLT_LOC                        '         21320000
213300         DISPLAY 'STORE-NMBR: ' XLT00010-LOC-NBR                  21330000
213400         DISPLAY '**************************************'         21340000
213500         PERFORM 9800-SQL-ERROR                                   21350000
213600     END-IF.                                                      21360000
213700                                                                  21370000
213800     IF SQLCODE = +0                                              21380000
213900         SET PS-VALID-DC TO TRUE                                  21390000
214000     END-IF.                                                      21400000
214100                                                                  21410000
214200******************************************************************21420000
214300** PROCESS THE ASN DETAIL RECORDS.                               *21430000
214400******************************************************************21440000
214500 4000-PROCESS-ASN-DETAILS.                                        21450000
214600                                                                  21460000
214700     IF RC001-DIST-CNTR = 0                                       21470000
214800         MOVE PC-0                  TO PV-OPER-UNT-ID             21480000
214900     ELSE                                                         21490000
215000         MOVE RC001-DIST-CNTR       TO PV-OPER-UNT-ID             21500000
215100     END-IF.                                                      21510000
215200     MOVE PV-OPER-UNT-ID            TO DK-OPER-UNT-ID.            21520000
215300                                                                  21530000
215400     IF RC001-PO-LINE-NBR-HDR                                     21540000
215500         SET PS-END-OF-ASN-DETAIL TO TRUE                         21550000
215600     ELSE                                                         21560000
215700       IF RC001-DETAIL-RECORD                                     21570000
215800         SET PS-DO-NOT-BYPASS-UPDATES TO TRUE                     21580000
215900         PERFORM 4800-SET-UP-OUTPUT-DETAIL-REC                    21590000
216000         IF RC001-PO-NBR NOT = PV-SAVE-PO-NBR OR                  21600000
216100            RC001-STORE-NBR NOT = PV-SAVE-STR-DEST-NBR OR         21610000
216200            RC001-DIST-CNTR NOT = PV-SAVE-DIST-CNTR OR            21620000
216300            RC001-BILL-OF-LADING-NBR NOT = PV-SAVE-BOL-NBR        21630000
216400             MOVE RC001-PO-NBR TO PV-SAVE-PO-NBR                  21640000
216500                                  PV-SHPTPO-PO-NBR-N              21650000
216600             MOVE RC001-STORE-NBR TO PV-SAVE-STR-DEST-NBR         21660000
216700             MOVE RC001-DIST-CNTR TO PV-SAVE-DIST-CNTR            21670000
216800             MOVE RC001-BILL-OF-LADING-NBR TO PV-SAVE-BOL-NBR     21680000
216900             PERFORM 7400-GET-NEXT-SEQ-NBR                        21690000
217000             MOVE PV-NEXT-SEQ-NBR   TO PKSLIP-SEQ-NBR             21700000
217100                                       PKITEM-SEQ-NBR             21710000
217200             PERFORM 7500-GET-PO-VER-NBR                          21720000
217300             MOVE PURCHS-VER-NBR    TO PKSLIP-PO-VER-NBR          21730000
217400             IF PS-FORECAST-SHIP-MODE AND                         21740000
217500                PS-NO-DUPLICATE-SHIPMT AND                        21750000
217600                PS-DO-NOT-BYPASS-UPDATES                          21760000
217700                 MOVE PV-PKSLIP-SHIPT-ID TO PKSLIP-SHIPT-ID       21770000
217800             ELSE                                                 21780000
217900                 MOVE PC-0               TO PKSLIP-SHIPT-ID       21790000
218000             END-IF                                               21800000
218100             PERFORM 7100-INSERT-TPKSLIP                          21810000
218200         END-IF                                                   21820000
218300         IF RC001-PO-LINE-NBR = HIGH-VALUES OR                    21830000
218400            PS-BYPASS-UPDATES                                     21840000
218500             IF  RC001-PO-LINE-NBR = HIGH-VALUES                  21850000
218600                 MOVE ZERO               TO PV-ORD-LNE-NBR        21860000
218700             ELSE                                                 21870000
218800                 MOVE RC001-PO-LINE-NBR  TO PV-ORD-LNE-NBR        21880000
218900             END-IF                                               21890000
219000             PERFORM 4400-FORMAT-DETAIL-LINES                     21900000
219100             PERFORM 4500-CHECK-DETAIL-ERRORS                     21910000
219200                                                                  21920000
219300             MOVE PEMT-MSG (1)       TO DL1-ERROR-MSG             21930000
219400             MOVE PEMT-MSG (2)       TO DL2-ERROR-MSG             21940000
219500             IF  PV-LINE-CNT > PC-60                              21950000
219600                  PERFORM 8000-WRITE-REPORT-HEADERS               21960000
219700             END-IF                                               21970000
219800             PERFORM 8400-WRITE-DETAIL-LINES                      21980000
219900             MOVE PC-N TO PV-TRANSCRIBE-IND                       21990000
220000         ELSE                                                     22000000
220100             IF  RC001-PO-LINE-NBR = HIGH-VALUES                  22010000
220200                 MOVE ZERO               TO PV-ORD-LNE-NBR        22020000
220300             ELSE                                                 22030000
220400                 MOVE RC001-PO-LINE-NBR  TO PV-ORD-LNE-NBR        22040000
220500             END-IF                                               22050000
220600             MOVE PC-Y TO PV-TRANSCRIBE-IND                       22060000
220700             IF RC001-PO-NBR = PV-SAVE-PKITEM-PO-NBR AND          22070000
220800                RC001-PO-LINE-NBR = PV-PO-LINE-NBR-X AND          22080000
220900                PKITEM-SEQ-NBR = PV-SAVE-SEQ-NBR AND              22090000
221000                RC001-PO-LINE-NBR < 8000                          22100000
221100                 PERFORM 4900-SET-UP-OUTPUT-PKITEM-REC            22110000
221200                 PERFORM 8600-READ-UPDATE-PKITEM                  22120000
221300             ELSE                                                 22130000
221400                 PERFORM 4900-SET-UP-OUTPUT-PKITEM-REC            22140000
221500               IF RC001-PO-LINE-NBR >= 8000 AND                   22150000
221600                  RC001-PO-LINE-NBR <= 9999                       22160000
221700                 CONTINUE                                         22170000
221800               ELSE                                               22180000
221900                 PERFORM 7200-INSERT-TPKITEM                      22190000
222000               END-IF                                             22200000
222100             END-IF                                               22210000
222200             PERFORM 4500-CHECK-DETAIL-ERRORS                     22220000
222300             IF PURITM-STATUS-CDE = PC-CA OR PC-CB OR PC-CM OR    22230000
222400                PURCHS-STATUS-CDE = PC-CA OR PC-CB OR PC-CM       22240000
222500                 PERFORM 4700-SET-STATUS-ERROR                    22250000
222600             END-IF                                               22260000
222700             IF PEMT-MSG (1) > SPACES                             22270000
222800                 PERFORM 4400-FORMAT-DETAIL-LINES                 22280000
222900                 MOVE PEMT-MSG (1)       TO DL1-ERROR-MSG         22290000
223000                 MOVE PEMT-MSG (2)       TO DL2-ERROR-MSG         22300000
223100                 IF  PV-LINE-CNT > PC-60                          22310000
223200                      PERFORM 8000-WRITE-REPORT-HEADERS           22320000
223300                 END-IF                                           22330000
223400                 PERFORM 8400-WRITE-DETAIL-LINES                  22340000
223500             END-IF                                               22350000
223600         END-IF                                                   22360000
223700         IF PS-WRITE-CTN-REC-YES                                  22370000
223800            SET PS-WRITE-CTN-REC-NO TO TRUE                       22380000
223900            PERFORM 4045-WRITE-CRTN-EXT-FILE                      22390000
224000         END-IF                                                   22400000
224100       ELSE                                                       22410000
224200           PERFORM 4010-PROCESS-ASN-CARTONS VARYING PV-SUB        22420000
224300                 FROM 1 BY 1 UNTIL                                22430000
224400                 PV-SUB > 10 OR                                   22440000
224500                 RC001-CARTON-NBR(PV-SUB) = 0                     22450000
224600       END-IF                                                     22460000
224700       MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE             22470000
224800       PERFORM 7000-READ-ASN-EXTRACT                              22480000
224900     END-IF.                                                      22490000
225000                                                                  22500000
225100 EJECT                                                            22510000
225200******************************************************************22520000
225300*  PROCESS THE ASN CARTON RECORDS                                *22530000
225400******************************************************************22540000
225500 4010-PROCESS-ASN-CARTONS.                                        22550000
225600     MOVE RC001-CARTON-NBR(PV-SUB)  TO SHPUNT-SHIPT-UNT-ID        22560000
225700                                       SHPUNT-NEXT-SHIPT-UNT-ID   22570000
225800                                       SHUUPC-SHIPT-UNT-ID        22580000
225900                                       INPKSU-SHIPT-UNT-ID.       22590000
226000     MOVE RC001-CTN-UPC(PV-SUB)     TO SHUUPC-UPC-NBR.            22600000
226100     MOVE DK-OPER-UNT-ID            TO SHPUNT-ORGN-OPER-UNT-ID.   22610000
226200     MOVE 1                         TO SHPUNT-ORGN-FCLTY-ID.      22620000
226210*                                                                 22621021
226220* DMH - 7/15/2021 BEGIN                                           22622026
226230*                                                                 22623021
226300     IF  RC001-STORE-NBR NOT = RC001-DIST-CNTR                    22630021
226310     AND RC001-STORE-NBR NOT = 9999                               22631021
226400         MOVE RC001-STORE-NBR           TO SHPUNT-DEST-OPER-UNT-ID22640000
226500     ELSE                                                         22650000
226600         MOVE DK-OPER-UNT-ID            TO SHPUNT-DEST-OPER-UNT-ID22660000
226700     END-IF.                                                      22670000
226710*                                                                 22671021
226720* DMH - 7/15/2021 END                                             22672021
226730*                                                                 22673021
226800     MOVE 1                         TO SHPUNT-DEST-FCLTY-ID.      22680000
226900     MOVE PC-ASN-3                  TO SHPUNT-SHIPT-UNT-SRC-ID.   22690000
227000     MOVE PC-ZERO                   TO SHPUNT-HIER-LVL-CDE.       22700000
227100     MOVE PC-0                      TO SHPUNT-ORIG-SHIPT-UNT-ID.  22710000
227200     MOVE PC-A                      TO SHPUNT-ACTV-IND.           22720000
227300     MOVE PV-PREP-DATE              TO SHPUNT-CRE-DTE.            22730000
227400     MOVE PV-PREP-TIME              TO SHPUNT-CRE-TM.             22740000
227500     MOVE SPACES                    TO SHPUNT-CRE-USR-ID.         22750000
227600     MOVE PC-RCKUP006               TO SHPUNT-CRE-PGM-NM.         22760000
227700     MOVE DK-PO-NBR                 TO SHUUPC-TRN-NBR             22770000
227800                                       INPKSU-PO-NBR.             22780000
227900     MOVE PV-ORD-LNE-NBR            TO SHUUPC-TRN-LNE-NBR.        22790000
228000     MOVE PC-PO                     TO SHUUPC-TRN-TYP-CDE.        22800000
228100     MOVE RC001-CARTON-QTY (PV-SUB) TO SHUUPC-SHPD-QTY.           22810000
228200     MOVE PKSLIP-SEQ-NBR            TO INPKSU-SEQ-NBR.            22820000
228300     IF PV-ORD-LNE-NBR >= 8000 AND                                22830000
228400       PV-ORD-LNE-NBR <= 9999                                     22840000
228500        CONTINUE                                                  22850000
228600     ELSE                                                         22860000
228610          SET PS-ADD-TSHPUNT-1ST-TRY                              22861000
228620              PS-DUPE-TSHPUNT-NO      TO TRUE                     22862000
228700          PERFORM 4020-INSERT-SHPUNT                              22870000
228710                                                                  22871029
228800          IF SQLCODE = -803                                       22880000
228900              PERFORM 4050-SELECT-SHPUNT                          22890000
229000              IF PV-PREP-DATE = PV-SHPUNT-CRE-DTE AND             22900000
229100                 PV-PREP-TIME = PV-SHPUNT-CRE-TM                  22910000
229200                  PERFORM 4030-INSERT-SHUUPC                      22920000
229300                  PERFORM 4040-INSERT-INPKSU                      22930000
229400              ELSE                                                22940000
229500                  IF PV-SHPUNT-SHIPT-UNT-SRC-ID = PC-RCV          22950000
229600                      SET ZERO-LINE-FOUND                         22960000
229700                          CARTON-FOUND TO TRUE                    22970000
229800                      PERFORM 4060-SELECT-SHUUPC                  22980000
229900                      IF ZERO-LINE-FOUND                          22990000
230000                         IF PV-SHUUPC-TRN-NBR =                   23000000
230100                                  SHUUPC-TRN-NBR AND              23010000
230200                            PV-SHPUNT-DEST-OPER-UNT-ID =          23020000
230300                                      SHPUNT-DEST-OPER-UNT-ID     23030000
230400                             MOVE PV-PREP-DATE TO SHPUNT-CRE-DTE  23040000
230500                             MOVE PV-PREP-TIME TO SHPUNT-CRE-TM   23050000
230600                             PERFORM 4070-UPDATE-SHPUNT           23060000
230700                             PERFORM 4080-DELETE-SHUUPC           23070000
230800                             PERFORM 4030-INSERT-SHUUPC           23080000
230900                             PERFORM 4040-INSERT-INPKSU           23090000
231000                         ELSE                                     23100000
231500                             MOVE PC-06 TO RC016-ASN-CARTON-ERR   23150000
231600                             PERFORM 8100-WRITE-ERROR-FILE        23160000
231700                         END-IF                                   23170000
231800                      ELSE                                        23180000
231900                         IF CARTON-FOUND                          23190000
232400                            MOVE PC-06 TO RC016-ASN-CARTON-ERR    23240000
232500                            PERFORM 8100-WRITE-ERROR-FILE         23250000
232600                         ELSE                                     23260000
232700                            MOVE PV-PREP-DATE TO SHPUNT-CRE-DTE   23270000
232800                            MOVE PV-PREP-TIME TO SHPUNT-CRE-TM    23280000
232900                            PERFORM 4070-UPDATE-SHPUNT            23290000
233000                            PERFORM 4030-INSERT-SHUUPC            23300000
233100                            PERFORM 4040-INSERT-INPKSU            23310000
233200                         END-IF                                   23320000
233300                      END-IF                                      23330000
233400                  ELSE                                            23340000
233500                      MOVE PC-05 TO RC016-ASN-CARTON-ERR          23350000
233600                      PERFORM 8100-WRITE-ERROR-FILE               23360000
233700                  END-IF                                          23370000
233800              END-IF                                              23380000
233900          ELSE                                                    23390000
234000              PERFORM 4030-INSERT-SHUUPC                          23400000
234100              PERFORM 4040-INSERT-INPKSU                          23410000
234200          END-IF                                                  23420000
234300     END-IF.                                                      23430000
234400                                                                  23440000
234500***************************************************************** 23450000
234600*     SQL INSERT SHPUNT                                         * 23460000
234700*                                                               * 23470000
234800***************************************************************** 23480000
234900                                                                  23490000
235000 4020-INSERT-SHPUNT.                                              23500000
235100                                                                  23510000
235200     MOVE '4020-INSERT-SHPUNT'   TO PV-ABEND-PARAGRAPH.           23520000
235300                                                                  23530000
235400     PERFORM                                                      23540000
235500         WITH TEST AFTER                                          23550000
235600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     23560000
235700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            23570000
235810                (SQLCODE = ZERO) OR (SQLCODE = -803))             23581000
235900                                                                  23590000
236000         EXEC SQL                                                 23600000
236100             INSERT INTO TSHPUNT                                  23610000
236200                   (SHIPT_UNT_ID,                                 23620000
236300                    ORGN_OPER_UNT_ID,                             23630000
236400                    ORGN_FCLTY_ID,                                23640000
236500                    DEST_OPER_UNT_ID,                             23650000
236600                    DEST_FCLTY_ID,                                23660000
236700                    SHIPT_UNT_SRC_ID,                             23670000
236800                    HIER_LVL_CDE,                                 23680000
236900                    NEXT_SHIPT_UNT_ID,                            23690000
237000                    ORIG_SHIPT_UNT_ID,                            23700000
237100                    ACTV_IND,                                     23710000
237200                    CRE_DTE,                                      23720000
237300                    CRE_TM,                                       23730000
237400                    CRE_USR_ID,                                   23740000
237500                    CRE_PGM_NM)                                   23750000
237600             VALUES                                               23760000
237700                   (:SHPUNT-SHIPT-UNT-ID,                         23770000
237800                    :SHPUNT-ORGN-OPER-UNT-ID,                     23780000
237900                    :SHPUNT-ORGN-FCLTY-ID,                        23790000
238000                    :SHPUNT-DEST-OPER-UNT-ID,                     23800000
238100                    :SHPUNT-DEST-FCLTY-ID,                        23810000
238200                    :SHPUNT-SHIPT-UNT-SRC-ID,                     23820000
238300                    :SHPUNT-HIER-LVL-CDE,                         23830000
238400                    :SHPUNT-NEXT-SHIPT-UNT-ID,                    23840000
238500                    :SHPUNT-ORIG-SHIPT-UNT-ID,                    23850000
238600                    :SHPUNT-ACTV-IND,                             23860000
238700                    :SHPUNT-CRE-DTE,                              23870000
238800                    :SHPUNT-CRE-TM,                               23880000
238900                    :SHPUNT-CRE-USR-ID,                           23890000
239000                    :SHPUNT-CRE-PGM-NM)                           23900000
239100         END-EXEC                                                 23910000
239200                                                                  23920000
239300         EVALUATE TRUE                                            23930000
239400             WHEN SQLCODE = ZERO                                  23940000
239410                  ADD +1 TO PV-ADD-TSHPUNT-1ST-TRY                23941023
239500             WHEN SQLCODE = -803                                  23950000
239510                  ADD +1 TO PV-ADD-TSHPUNT-FAIL-DUPE              23951023
239600             WHEN SQLCODE = -911                                  23960000
239700                 CONTINUE                                         23970000
239800                                                                  23980000
239900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              23990000
240000                 DISPLAY '**************************************' 24000000
240100                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHPUNT   ' 24010000
240200                 DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                24020000
240300                          SHPUNT-SHIPT-UNT-ID                     24030000
240400                 DISPLAY '**********************************'     24040000
240500                 PERFORM 9700-SQL-WARNING                         24050000
240600                                                                  24060000
240700             WHEN SQLCODE < ZERO                                  24070000
240800                 DISPLAY '**************************************' 24080000
240900                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHPUNT   '   24090000
241000                 DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                24100000
241100                          SHPUNT-SHIPT-UNT-ID                     24110000
241200                 DISPLAY '**************************************' 24120000
241300                 PERFORM 9800-SQL-ERROR                           24130000
241400                                                                  24140000
241500         END-EVALUATE                                             24150000
241600     END-PERFORM.                                                 24160000
241700                                                                  24170000
241800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    24180000
241900         SQLCODE NOT = +0                                         24190000
242000         DISPLAY '**************************************'         24200000
242100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         24210000
242200         DISPLAY 'INSERT TO TSHPUNT                     '         24220000
242300         DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                        24230000
242400                  SHPUNT-SHIPT-UNT-ID                             24240000
242500         DISPLAY '**************************************'         24250000
242600         PERFORM 9800-SQL-ERROR                                   24260000
242700     END-IF.                                                      24270000
242800                                                                  24280023
242900***************************************************************** 24290000
243000*     SQL INSERT SHUUPC                                         * 24300000
243100*                                                               * 24310000
243200***************************************************************** 24320000
243300                                                                  24330000
243400 4030-INSERT-SHUUPC.                                              24340000
243500                                                                  24350000
243600     MOVE '4030-INSERT-SHUUPC'   TO PV-ABEND-PARAGRAPH.           24360000
243700                                                                  24370000
243800     PERFORM                                                      24380000
243900         WITH TEST AFTER                                          24390000
244000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     24400000
244100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            24410000
244200                (SQLCODE = ZERO) OR (SQLCODE = -803))             24420000
244300                                                                  24430000
244400         EXEC SQL                                                 24440000
244500             INSERT INTO TSHUUPC                                  24450000
244600                   (SHIPT_UNT_ID,                                 24460000
244700                    TRN_NBR,                                      24470000
244800                    TRN_LNE_NBR,                                  24480000
244900                    TRN_TYP_CDE,                                  24490000
245000                    UPC_NBR,                                      24500000
245100                    SHPD_QTY)                                     24510000
245200             VALUES                                               24520000
245300                   (:SHUUPC-SHIPT-UNT-ID,                         24530000
245400                    :SHUUPC-TRN-NBR,                              24540000
245500                    :SHUUPC-TRN-LNE-NBR,                          24550000
245600                    :SHUUPC-TRN-TYP-CDE,                          24560000
245700                    :SHUUPC-UPC-NBR,                              24570000
245800                    :SHUUPC-SHPD-QTY)                             24580000
245900         END-EXEC                                                 24590000
246000                                                                  24600000
246100         EVALUATE TRUE                                            24610000
246200             WHEN SQLCODE = ZERO                                  24620000
246210                 ADD +1     TO PV-ADD-TSHUUPC                     24621000
246300*!!!                                                              24630000
246400                 IF RC001-PO-LINE-NBR = HIGH-VALUES OR            24640000
246500                    SHUUPC-TRN-LNE-NBR = 0                        24650000
246600                     PERFORM 4035-WRITE-CRTN-UPD-FILE             24660000
246610                     ADD +1 TO PV-ADD-TSHUUPC-LNE-NBR-0           24661000
246700                 END-IF                                           24670000
246800*!!!                                                              24680000
246900             WHEN SQLCODE = -803                                  24690000
246910                 ADD +1     TO PV-ADD-TSHUUPC-FAIL-DUPE           24691000
247000             WHEN SQLCODE = -911                                  24700000
247100                 CONTINUE                                         24710000
247200                                                                  24720000
247300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              24730000
247400                 DISPLAY '**************************************' 24740000
247500                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHUUPC   ' 24750000
247600                 DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                24760000
247700                          SHUUPC-SHIPT-UNT-ID                     24770000
247800                 DISPLAY '**********************************'     24780000
247900                 PERFORM 9700-SQL-WARNING                         24790000
248000                                                                  24800000
248100             WHEN SQLCODE < ZERO                                  24810000
248200                 DISPLAY '**************************************' 24820000
248300                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHUUPC   '   24830000
248400                 DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                24840000
248500                          SHUUPC-SHIPT-UNT-ID                     24850000
248600                 DISPLAY '**************************************' 24860000
248700                 PERFORM 9800-SQL-ERROR                           24870000
248800                                                                  24880000
248900         END-EVALUATE                                             24890000
249000     END-PERFORM.                                                 24900000
249100                                                                  24910000
249200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    24920000
249300         SQLCODE NOT = +0                                         24930000
249400         DISPLAY '**************************************'         24940000
249500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         24950000
249600         DISPLAY 'INSERT TO TSHUUPC                     '         24960000
249700         DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                        24970000
249800                  SHUUPC-SHIPT-UNT-ID                             24980000
249900         DISPLAY '**************************************'         24990000
250000         PERFORM 9800-SQL-ERROR                                   25000000
250100     END-IF.                                                      25010000
250200*!!!                                                              25020000
250300 4035-WRITE-CRTN-UPD-FILE.                                        25030000
250400******************************************************************25040000
250500*    COPY MEMBER:  RCRD017                       LRECL = 100     *25050000
250600*                                                                *25060000
250700******************************************************************25070000
250800     INITIALIZE RC017-CARTON-UPD-RECORD.                          25080000
250900     MOVE SHUUPC-TRN-NBR        TO RC017-PO-NBR.                  25090000
251000     MOVE SHUUPC-TRN-LNE-NBR    TO RC017-PO-LNE-NBR.              25100000
251100     MOVE SHUUPC-UPC-NBR        TO RC017-UPC-NBR.                 25110000
251200     MOVE SHUUPC-SHIPT-UNT-ID   TO RC017-CARTON-NBR.              25120000
251300                                                                  25130030
251406         MOVE RC017-CARTON-UPD-RECORD                             25140600
251407                                 TO RCT00037-RCVG-RCRD017-ODR.    25140700
251408         PERFORM 4037-INSERT-RCTW-OUT17.                          25140800
251410     ADD +1                     TO  PV-CRTN-UPD-RECS-OUT.         25141000
251500*!!!+++                                                           25150000
251618                                                                  25161800
251619 4037-INSERT-RCTW-OUT17.                                          25161900
251627     MOVE '4037-INSERT-RCTW-OUT17' TO PV-ABEND-PARAGRAPH.         25162700
251628                                                                  25162800
251629     PERFORM                                                      25162900
251630         WITH TEST AFTER                                          25163000
251631         VARYING PV-RETRY-COUNTER                                 25163100
251632         FROM 1 BY 1                                              25163200
251633         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25163300
251634             OR (SQLCODE = +0))                                   25163400
251635                                                                  25163500
251636         EXEC SQL                                                 25163600
251637              INSERT INTO RCTW_OUT17                              25163700
251638                     (RCVG_RCRD017_ODR)                           25163800
251639              VALUES (:RCT00037-RCVG-RCRD017-ODR)                 25163900
251640         END-EXEC                                                 25164000
251641                                                                  25164100
251642         EVALUATE TRUE                                            25164200
251643             WHEN SQLCODE = +0                                    25164300
251644             WHEN SQLCODE = -911                                  25164400
251645                  CONTINUE                                        25164500
251646                                                                  25164600
251647             WHEN SQLWARN0 NOT = SPACES                           25164700
251648             WHEN SQLCODE < +0                                    25164800
251649             WHEN SQLCODE > +0                                    25164900
251650                  MOVE 'UNSUCCESSFUL INSERT TO RCTW_OUT17'        25165000
251651                         TO PV-DB2-OPERATION-ATTEMPTED            25165100
251652                  PERFORM 9800-SQL-ERROR                          25165200
251653         END-EVALUATE                                             25165300
251654     END-PERFORM.                                                 25165400
251655                                                                  25165500
251656     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25165600
251657         SQLCODE NOT = +0                                         25165700
251658         MOVE 'MAX RETRIES EXCEEDED FOR INSERT RCTW_OUT17'        25165800
251659                TO PV-DB2-OPERATION-ATTEMPTED                     25165900
251660         PERFORM 9800-SQL-ERROR                                   25166000
251661     END-IF.                                                      25166100
251670                                                                  25167000
251700***************************************************************** 25170000
251800*     SQL INSERT INPKSU                                         * 25180000
251900*                                                               * 25190000
252000***************************************************************** 25200000
252100                                                                  25210000
252200 4040-INSERT-INPKSU.                                              25220000
252300                                                                  25230000
252400     MOVE '4040-INSERT-INPKSU'   TO PV-ABEND-PARAGRAPH.           25240000
252500                                                                  25250000
252600     PERFORM                                                      25260000
252700         WITH TEST AFTER                                          25270000
252800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     25280000
252900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            25290000
253000                (SQLCODE = ZERO) OR (SQLCODE = -803))             25300000
253100                                                                  25310000
253200         EXEC SQL                                                 25320000
253300             INSERT INTO TINPKSU                                  25330000
253400                   (SHIPT_UNT_ID,                                 25340000
253500                    PO_NBR,                                       25350000
253600                    SEQ_NBR)                                      25360000
253700             VALUES                                               25370000
253800                   (:INPKSU-SHIPT-UNT-ID,                         25380000
253900                    :INPKSU-PO-NBR,                               25390000
254000                    :INPKSU-SEQ-NBR)                              25400000
254100         END-EXEC                                                 25410000
254200                                                                  25420000
254300         EVALUATE TRUE                                            25430000
254400             WHEN SQLCODE = ZERO                                  25440000
254410                 ADD +1 TO PV-ADD-TINPKSU                         25441000
254500             WHEN SQLCODE = -803                                  25450000
254510                 ADD +1 TO PV-ADD-TINPKSU-FAIL-DUPE               25451000
254600             WHEN SQLCODE = -911                                  25460000
254700                 CONTINUE                                         25470000
254800                                                                  25480000
254900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              25490000
255000                 DISPLAY '**************************************' 25500000
255100                 DISPLAY 'WARNING ISSUED ON INSERT OF TINPKSU   ' 25510000
255200                 DISPLAY 'INPKSU-SHIPT-UNT-ID =  '                25520000
255300                          INPKSU-SHIPT-UNT-ID                     25530000
255400                 DISPLAY '**********************************'     25540000
255500                 PERFORM 9700-SQL-WARNING                         25550000
255600                                                                  25560000
255700             WHEN SQLCODE < ZERO                                  25570000
255800                 DISPLAY '**************************************' 25580000
255900                 DISPLAY 'ERROR ISSUED ON INSERT OF TINPKSU   '   25590000
256000                 DISPLAY 'INPKSU-SHIPT-UNT-ID =  '                25600000
256100                          INPKSU-SHIPT-UNT-ID                     25610000
256200                 DISPLAY '**************************************' 25620000
256300                 PERFORM 9800-SQL-ERROR                           25630000
256400                                                                  25640000
256500         END-EVALUATE                                             25650000
256600     END-PERFORM.                                                 25660000
256700                                                                  25670000
256800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25680000
256900         SQLCODE NOT = +0                                         25690000
257000         DISPLAY '**************************************'         25700000
257100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         25710000
257200         DISPLAY 'INSERT TO TINPKSU                     '         25720000
257300         DISPLAY 'INPKSU-SHIPT-UNT-ID =  '                        25730000
257400                  INPKSU-SHIPT-UNT-ID                             25740000
257500         DISPLAY '**************************************'         25750000
257600         PERFORM 9800-SQL-ERROR                                   25760000
257700     END-IF.                                                      25770000
257800                                                                  25780000
257900******************************************************************25790000
258000*    COPY MEMBER:  RCRD052                       LRECL = 150     *25800000
258100*                                                                *25810000
258200******************************************************************25820000
258300 4045-WRITE-CRTN-EXT-FILE.                                        25830000
258400                                                                  25840000
258500     INITIALIZE RC052-ASN-RECVR-PKSLIP-RECORD.                    25850000
258600                                                                  25860000
258700     MOVE RC001-PO-NBR             TO RC052-PO-NBR.               25870000
258800     MOVE PKSLIP-SEQ-NBR           TO RC052-SEQ-NBR.              25880000
258900     MOVE RC001-EDI-VEND-NAME      TO RC052-EDI-VEND-NAME.        25890000
259000     MOVE RC001-CARRIER-SCAC-CODE  TO RC052-CARRIER-SCAC-CODE.    25900000
259100     MOVE RC001-BILL-OF-LADING-NBR TO RC052-BILL-OF-LADING-NBR.   25910000
259200     MOVE RC001-EDI-VEND-ID        TO RC052-EDI-VEND-ID.          25920000
259300     MOVE PURCHS-PO-TYP-CDE        TO RC052-PO-TYPE.              25930000
259400     MOVE PKSLIP-PRO-NBR           TO RC052-PRO-NBR.              25940000
259500     MOVE PKSLIP-OPER-UNT-ID       TO RC052-OPER-UNT-ID.          25950000
259600     MOVE PKSLIP-EXPTED-PKG-QTY    TO RC052-EXPTED-PKG-QTY.       25960000
259700                                                                  25970000
259800     IF PS-FALLOUT-REC-WRITTEN-YES                                25980000
259900        SET RC052-PACKSLIP-IS-FALLOUT TO TRUE                     25990000
260000        INITIALIZE PS-FALLOUT-REC-WRITTEN-SW                      26000000
260100     END-IF                                                       26010000
260200                                                                  26020000
260451         MOVE RC052-ASN-RECVR-PKSLIP-RECORD                       26045100
260470                                 TO RCT00038-RCVG-RCRD052-ODR.    26047000
260480         PERFORM 4047-INSERT-RCTW-OUT18.                          26048000
260500                                                                  26050000
260510     ADD +1                     TO  PV-CRTN-EXT-RECS-OUT.         26051000
260520                                                                  26052000
260620                                                                  26062000
260621 4047-INSERT-RCTW-OUT18.                                          26062100
260629     MOVE '4047-INSERT-RCTW-OUT18' TO PV-ABEND-PARAGRAPH.         26062900
260630                                                                  26063000
260631     PERFORM                                                      26063100
260632         WITH TEST AFTER                                          26063200
260633         VARYING PV-RETRY-COUNTER                                 26063300
260634         FROM 1 BY 1                                              26063400
260635         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26063500
260636             OR (SQLCODE = +0))                                   26063600
260637                                                                  26063700
260638         EXEC SQL                                                 26063800
260639              INSERT INTO RCTW_OUT18                              26063900
260640                     (RCVG_RCRD052_ODR)                           26064000
260641              VALUES (:RCT00038-RCVG-RCRD052-ODR)                 26064100
260642         END-EXEC                                                 26064200
260643                                                                  26064300
260644         EVALUATE TRUE                                            26064400
260645             WHEN SQLCODE = +0                                    26064500
260646             WHEN SQLCODE = -911                                  26064600
260647                  CONTINUE                                        26064700
260648                                                                  26064800
260649             WHEN SQLWARN0 NOT = SPACES                           26064900
260650             WHEN SQLCODE < +0                                    26065000
260651             WHEN SQLCODE > +0                                    26065100
260652                  MOVE 'UNSUCCESSFUL INSERT TO RCTW_OUT18'        26065200
260653                         TO PV-DB2-OPERATION-ATTEMPTED            26065300
260654                  PERFORM 9800-SQL-ERROR                          26065400
260655         END-EVALUATE                                             26065500
260656     END-PERFORM.                                                 26065600
260657                                                                  26065700
260658     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26065800
260659         SQLCODE NOT = +0                                         26065900
260660         MOVE 'MAX RETRIES EXCEEDED FOR INSERT RCTW_OUT18'        26066000
260661                TO PV-DB2-OPERATION-ATTEMPTED                     26066100
260662         PERFORM 9800-SQL-ERROR                                   26066200
260663     END-IF.                                                      26066300
260664                                                                  26066400
260670***************************************************************** 26067000
260700*     SQL SELECT SHPUNT                                         * 26070000
260800*                                                               * 26080000
260900***************************************************************** 26090000
261000                                                                  26100000
261100 4050-SELECT-SHPUNT.                                              26110000
261200                                                                  26120000
261300     MOVE '4050-SELECT-SHPUNT'   TO PV-ABEND-PARAGRAPH.           26130000
261400                                                                  26140000
261500     PERFORM                                                      26150000
261600         WITH TEST AFTER                                          26160000
261700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     26170000
261800         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            26180000
261900                (SQLCODE = ZERO)                                  26190000
262000                                                                  26200000
262100         EXEC SQL                                                 26210000
262200             SELECT A.DEST_OPER_UNT_ID,                           26220000
262300                    A.SHIPT_UNT_SRC_ID,                           26230000
262400                    A.CRE_DTE,                                    26240000
262500                    A.CRE_TM                                      26250000
262600             INTO   :PV-SHPUNT-DEST-OPER-UNT-ID,                  26260000
262700                    :PV-SHPUNT-SHIPT-UNT-SRC-ID,                  26270000
262800                    :PV-SHPUNT-CRE-DTE,                           26280000
262900                    :PV-SHPUNT-CRE-TM                             26290000
263000             FROM   TSHPUNT A                                     26300000
263100             WHERE  A.SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID       26310000
263200         END-EXEC                                                 26320000
263300                                                                  26330000
263400         EVALUATE TRUE                                            26340000
263500             WHEN SQLCODE = ZERO                                  26350000
263600             WHEN SQLCODE = -911                                  26360000
263700                 CONTINUE                                         26370000
263800                                                                  26380000
263900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              26390000
264000                 DISPLAY '**************************************' 26400000
264100                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHPUNT   ' 26410000
264200                 DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                26420000
264300                          SHPUNT-SHIPT-UNT-ID                     26430000
264400                 DISPLAY '**********************************'     26440000
264500                 PERFORM 9700-SQL-WARNING                         26450000
264600                                                                  26460000
264700             WHEN SQLCODE < ZERO                                  26470000
264800                 DISPLAY '**************************************' 26480000
264900                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHPUNT   '   26490000
265000                 DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                26500000
265100                          SHPUNT-SHIPT-UNT-ID                     26510000
265200                 DISPLAY '**************************************' 26520000
265300                 PERFORM 9800-SQL-ERROR                           26530000
265400                                                                  26540000
265500         END-EVALUATE                                             26550000
265600     END-PERFORM.                                                 26560000
265700                                                                  26570000
265800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26580000
265900         SQLCODE NOT = +0                                         26590000
266000         DISPLAY '**************************************'         26600000
266100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         26610000
266200         DISPLAY 'SELECT TO TSHPUNT                     '         26620000
266300         DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                        26630000
266400                  SHPUNT-SHIPT-UNT-ID                             26640000
266500         DISPLAY '**************************************'         26650000
266600         PERFORM 9800-SQL-ERROR                                   26660000
266700     END-IF.                                                      26670000
266800                                                                  26680000
266900                                                                  26690000
267000 4060-SELECT-SHUUPC.                                              26700000
267100                                                                  26710000
267200     MOVE '4060-SELECT-SHPUNT'   TO PV-ABEND-PARAGRAPH.           26720000
267300                                                                  26730000
267400     PERFORM                                                      26740000
267500         WITH TEST AFTER                                          26750000
267600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     26760000
267700         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            26770000
267800                (SQLCODE = ZERO OR SQLCODE = +100 OR              26780000
267900                 SQLCODE = -811)                                  26790000
268000                                                                  26800000
268100         EXEC SQL                                                 26810000
268200             SELECT A.TRN_NBR                                     26820000
268300             INTO   :PV-SHUUPC-TRN-NBR                            26830000
268400             FROM   TSHUUPC A                                     26840000
268500             WHERE  A.SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID       26850000
268600               AND  A.UPC_NBR        = :PC-0-COMP-3               26860000
268700         END-EXEC                                                 26870000
268800                                                                  26880000
268900         EVALUATE TRUE                                            26890000
269000             WHEN SQLCODE = ZERO                                  26900000
269100             WHEN SQLCODE = -811                                  26910000
269200             WHEN SQLCODE = -911                                  26920000
269300                 CONTINUE                                         26930000
269400             WHEN SQLCODE = +100                                  26940000
269500                 SET ZERO-LINE-NOTFOUND TO TRUE                   26950000
269600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              26960000
269700                 DISPLAY                                          26970000
269800                 '*******************************'                26980000
269900                 DISPLAY                                          26990000
270000                 'WARNING ON SELECT OF TSHPUNT   '                27000000
270100                 DISPLAY                                          27010000
270200                 'SHUUPC-SHIPT-UNT-ID =  '                        27020000
270300                          SHUUPC-SHIPT-UNT-ID                     27030000
270400                 DISPLAY                                          27040000
270500                 '******************************'                 27050000
270600                 PERFORM 9700-SQL-WARNING                         27060000
270700                                                                  27070000
270800             WHEN SQLCODE < ZERO                                  27080000
270900                 DISPLAY '**************************************' 27090000
271000                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHPUNT   '   27100000
271100                 DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                27110000
271200                          SHUUPC-SHIPT-UNT-ID                     27120000
271300                 DISPLAY '**************************************' 27130000
271400                 PERFORM 9800-SQL-ERROR                           27140000
271500                                                                  27150000
271600         END-EVALUATE                                             27160000
271700     END-PERFORM.                                                 27170000
271800                                                                  27180000
271900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27190000
272000         SQLCODE NOT = +0                                         27200000
272100         DISPLAY '**************************************'         27210000
272200         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         27220000
272300         DISPLAY 'SELECT TO TSHPUNT                     '         27230000
272400         DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                        27240000
272500                  SHUUPC-SHIPT-UNT-ID                             27250000
272600         DISPLAY '**************************************'         27260000
272700         PERFORM 9800-SQL-ERROR                                   27270000
272800     END-IF.                                                      27280000
272900                                                                  27290000
273000     IF ZERO-LINE-NOTFOUND                                        27300000
273100        PERFORM                                                   27310000
273200            WITH TEST AFTER                                       27320000
273300            VARYING PV-RETRY-COUNTER FROM 1 BY 1                  27330000
273400            UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR         27340000
273500                   (SQLCODE = ZERO OR SQLCODE = +100 OR           27350000
273600                    SQLCODE = -811)                               27360000
273700            EXEC SQL                                              27370000
273800                SELECT A.TRN_NBR                                  27380000
273900                INTO   :PV-SHUUPC-TRN-NBR                         27390000
274000                FROM   TSHUUPC A                                  27400000
274100                WHERE  A.SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID    27410000
274200            END-EXEC                                              27420000
274300            EVALUATE TRUE                                         27430000
274400                WHEN SQLCODE = ZERO                               27440000
274500                WHEN SQLCODE = -811                               27450000
274600                WHEN SQLCODE = -911                               27460000
274700                    CONTINUE                                      27470000
274800                WHEN SQLCODE = +100                               27480000
274900                    SET CARTON-NOTFOUND TO TRUE                   27490000
275000                WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')           27500000
275100                    DISPLAY                                       27510000
275200                    '*******************************'             27520000
275300                    DISPLAY                                       27530000
275400                    'WARNING ON SELECT OF TSHPUNT -2'             27540000
275500                    DISPLAY                                       27550000
275600                    'SHUUPC-SHIPT-UNT-ID =  '                     27560000
275700                             SHUUPC-SHIPT-UNT-ID                  27570000
275800                    DISPLAY                                       27580000
275900                    '******************************'              27590000
276000                    PERFORM 9700-SQL-WARNING                      27600000
276100                                                                  27610000
276200                WHEN SQLCODE < ZERO                               27620000
276300                    DISPLAY                                       27630000
276400                    '**************************************'      27640000
276500                    DISPLAY 'ERROR ISSUED ON SELECT OF TSHPUNT -2'27650000
276600                    DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '             27660000
276700                             SHUUPC-SHIPT-UNT-ID                  27670000
276800                    DISPLAY                                       27680000
276900                    '**************************************'      27690000
277000                    PERFORM 9800-SQL-ERROR                        27700000
277100            END-EVALUATE                                          27710000
277200        END-PERFORM                                               27720000
277300        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                 27730000
277400            SQLCODE NOT = +0                                      27740000
277500            DISPLAY '**************************************'      27750000
277600            DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '      27760000
277700            DISPLAY 'SELECT TO TSHPUNT                     '      27770000
277800            DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                     27780000
277900                     SHUUPC-SHIPT-UNT-ID                          27790000
278000            DISPLAY '**************************************'      27800000
278100            PERFORM 9800-SQL-ERROR                                27810000
278200        END-IF                                                    27820000
278300     END-IF.                                                      27830000
278400                                                                  27840000
278500 4070-UPDATE-SHPUNT.                                              27850000
278600     MOVE '4070-UPDATE-SHPUNT'   TO PV-ABEND-PARAGRAPH.           27860000
278700                                                                  27870000
278800     PERFORM                                                      27880000
278900         WITH TEST AFTER                                          27890000
279000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27900000
279100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            27910000
279200                (SQLCODE = ZERO))                                 27920000
279300                                                                  27930000
279400         EXEC SQL                                                 27940000
279500             UPDATE TSHPUNT                                       27950000
279600                SET CRE_DTE       = :SHPUNT-CRE-DTE,              27960000
279700                    CRE_TM        = :SHPUNT-CRE-TM                27970000
279800              WHERE SHIPT_UNT_ID  = :SHPUNT-SHIPT-UNT-ID          27980000
279900         END-EXEC                                                 27990000
280000                                                                  28000000
280100         EVALUATE TRUE                                            28010000
280200             WHEN SQLCODE = ZERO                                  28020000
280210                 ADD +1 TO PV-UPDATE-TSHPUNT                      28021000
280300             WHEN SQLCODE = -911                                  28030000
280400                 CONTINUE                                         28040000
280500                                                                  28050000
280600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              28060000
280700                 DISPLAY '**************************************' 28070000
280800                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHUUPC   ' 28080000
280900                 DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                28090000
281000                          SHPUNT-SHIPT-UNT-ID                     28100000
281100                 DISPLAY '**********************************'     28110000
281200                 PERFORM 9700-SQL-WARNING                         28120000
281300                                                                  28130000
281400             WHEN SQLCODE < ZERO                                  28140000
281500                 DISPLAY '**************************************' 28150000
281600                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHUUPC   '   28160000
281700                 DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                28170000
281800                          SHPUNT-SHIPT-UNT-ID                     28180000
281900                 DISPLAY '**************************************' 28190000
282000                 PERFORM 9800-SQL-ERROR                           28200000
282100                                                                  28210000
282200         END-EVALUATE                                             28220000
282300     END-PERFORM.                                                 28230000
282400                                                                  28240000
282500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28250000
282600         SQLCODE NOT = +0                                         28260000
282700         DISPLAY '**************************************'         28270000
282800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         28280000
282900         DISPLAY 'INSERT TO TSHUUPC                     '         28290000
283000         DISPLAY 'SHPUNT-SHIPT-UNT-ID =  '                        28300000
283100                  SHPUNT-SHIPT-UNT-ID                             28310000
283200         DISPLAY '**************************************'         28320000
283300         PERFORM 9800-SQL-ERROR                                   28330000
283400     END-IF.                                                      28340000
283500                                                                  28350000
283600 4080-DELETE-SHUUPC.                                              28360000
283700                                                                  28370000
283800     MOVE '4080-DELETE-SHUUPC'   TO PV-ABEND-PARAGRAPH.           28380000
283900                                                                  28390000
284000     PERFORM                                                      28400000
284100         WITH TEST AFTER                                          28410000
284200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28420000
284300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            28430000
284400                 SQLCODE = ZERO                                   28440000
284500                                                                  28450000
284600         EXEC SQL                                                 28460000
284700             DELETE FROM TSHUUPC                                  28470000
284800              WHERE SHIPT_UNT_ID    = :SHUUPC-SHIPT-UNT-ID        28480000
284900                AND UPC_NBR         = :PC-0-COMP-3                28490000
285000         END-EXEC                                                 28500000
285100                                                                  28510000
285200         EVALUATE TRUE                                            28520000
285300             WHEN SQLCODE = ZERO                                  28530000
285310                 ADD +1 TO PV-DELETE-TSHUUPC                      28531000
285400             WHEN SQLCODE = -911                                  28540000
285500                 CONTINUE                                         28550000
285600                                                                  28560000
285700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              28570000
285800                 DISPLAY '**************************************' 28580000
285900                 DISPLAY 'WARNING ISSUED ON DELETE OF TSHUUPC   ' 28590000
286000                 DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                28600000
286100                          SHUUPC-SHIPT-UNT-ID                     28610000
286200                 DISPLAY '**********************************'     28620000
286300                 PERFORM 9700-SQL-WARNING                         28630000
286400                                                                  28640000
286500             WHEN SQLCODE < ZERO                                  28650000
286600                 DISPLAY '**************************************' 28660000
286700                 DISPLAY 'ERROR ISSUED ON DELETE OF TSHUUPC     ' 28670000
286800                 DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                28680000
286900                          SHUUPC-SHIPT-UNT-ID                     28690000
287000                 DISPLAY '**************************************' 28700000
287100                 PERFORM 9800-SQL-ERROR                           28710000
287200                                                                  28720000
287300         END-EVALUATE                                             28730000
287400                                                                  28740000
287500     END-PERFORM.                                                 28750000
287600                                                                  28760000
287700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28770000
287800         SQLCODE NOT = +0                                         28780000
287900         DISPLAY '**************************************'         28790000
288000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         28800000
288100         DISPLAY 'DELETE TSHUUPC                        '         28810000
288200         DISPLAY 'SHUUPC-SHIPT-UNT-ID =  '                        28820000
288300                  SHUUPC-SHIPT-UNT-ID                             28830000
288400         DISPLAY '**************************************'         28840000
288500         PERFORM 9800-SQL-ERROR                                   28850000
288600     END-IF.                                                      28860000
288700                                                                  28870000
288800 EJECT                                                            28880000
288900 4100-PROCESS-HEADER.                                             28890000
289000******************************************************************28900000
289100*  THIS PARAGRAPH FORMATS THE HEADER LINES AND PRINTS THEM.      *28910000
289200******************************************************************28920000
289300     IF PV-CKPT-JOB-NAME = 'RCK090  '                             28930000
289400         MOVE PC-HL0-TITLE-REALTIME  TO HL0-TITLE                 28940000
289500     END-IF.                                                      28950000
289600     MOVE RC001-ASNHDR-NBR           TO HL0-ASN-NBR               28960000
289700                                        DLP1-ASN-NBR.             28970000
289800                                                                  28980000
289900     MOVE RC001-EDI-VEND-ID          TO DK-DUN-NBR.               28990000
289910     IF PV-CKPT-JOB-NAME = 'RCK010  '                             28991000
290000         PERFORM 4195-RETRIEVE-ISA-NBR                            29000000
290010     END-IF                                                       29001000
290100     MOVE ASNHDR-EDIISA-CNTL-NBR     TO DLP1-ISA-NBR              29010000
290200                                        DL2-ISA.                  29020000
290300                                                                  29030000
290400     MOVE RC001-DATE-SHIPPED         TO PV-DATE-SHIPPED           29040000
290500                                        RC004-DATE-SHIPPED.       29050000
290600     MOVE PV-DATE-SHIPPED-MM         TO HL0-DATE-SHIPPED-MM       29060000
290700                                        PV-SHIP-DATE-MM           29070000
290800                                        PV-DB2-DATE-MM            29080000
290900                                        DLP1-SHIP-DATE-MM.        29090000
291000     MOVE PV-DATE-SHIPPED-DD         TO HL0-DATE-SHIPPED-DD       29100000
291100                                        PV-SHIP-DATE-DD           29110000
291200                                        PV-DB2-DATE-DD            29120000
291300                                        DLP1-SHIP-DATE-DD.        29130000
291400     MOVE PV-DATE-SHIPPED-CCYY       TO HL0-DATE-SHIPPED-CCYY     29140000
291500                                        PV-DB2-DATE-CCYY.         29150000
291600     MOVE PV-DATE-SHIPPED-YY         TO DLP1-SHIP-DATE-YY         29160000
291700                                        PV-SHIP-DATE-YY.          29170000
291800     MOVE PV-DB2-DATE                TO PV-SHIPMT-VEND-SHIP-DTE   29180000
291900                                        PV-SHIPST-STATUS-DTE.     29190000
292000                                                                  29200000
292100     MOVE RC001-DEPT-NBR             TO HL1-DEPT                  29210000
292200     MOVE RC001-DEPT-DESC            TO HL1-DEPT-DESC.            29220000
292300     MOVE RC001-PO-NBR               TO HL1-PO-NBR                29230000
292400                                        DLP1-PO-NUMBER            29240000
292500                                        RC004-PO-NBR.             29250000
292600     MOVE RC001-PO-NBR               TO PURCHS-PO-NBR             29260000
292700                                        PV-PO-NBR-MAN.            29270000
292800     PERFORM 4180-VERIFY-PO.                                      29280000
292900     MOVE RC001-CARTON-CNT-PO        TO PV-CARTON-CNT-DISPLAY     29290000
293000                                        RC004-ASN-CARTONS         29300000
293100                                        PV-SHPTPO-VEND-CART-CNT.  29310000
293200     MOVE RC001-BUYER-NBR            TO HL2-BUYER-ID.             29320000
293300     MOVE RC001-BUYER-NAME           TO HL2-BUYER.                29330000
293400     MOVE RC001-PO-DATE              TO PV-HOLD-CURR-DATE-MMDDYY. 29340000
293500     MOVE PV-HOLD-CURR-DATE-MM       TO HL2-PO-DATE-MM.           29350000
293600     MOVE PV-HOLD-CURR-DATE-DD       TO HL2-PO-DATE-DD.           29360000
293700     MOVE PV-HOLD-CURR-DATE-YY       TO HL2-PO-DATE-YY.           29370000
293800     MOVE RC001-CARRIER-NAME         TO HL2-CARRIER-NAME.         29380000
293900                                                                  29390000
294000     MOVE RC001-ANALYST-NAME         TO HL3-ANALYST.              29400000
294100     MOVE RC001-REQ-SHIP-DATE        TO PV-HOLD-CURR-DATE-MMDDYY. 29410000
294200     MOVE PV-HOLD-CURR-DATE-MM       TO HL3-REQ-SHIP-DATE-MM.     29420000
294300     MOVE PV-HOLD-CURR-DATE-DD       TO HL3-REQ-SHIP-DATE-DD.     29430000
294400     MOVE PV-HOLD-CURR-DATE-YY       TO HL3-REQ-SHIP-DATE-YY.     29440000
294500                                                                  29450000
294600     MOVE RC001-EDI-VEND-NAME        TO HL4-VENDOR-NAME           29460000
294700                                        DLP1-VENDOR-NAME          29470000
294800                                        RC004-EDI-VEND-NAME.      29480000
294900     MOVE RC001-CANCEL-DATE          TO PV-HOLD-CURR-DATE-MMDDYY. 29490000
295000     MOVE PV-HOLD-CURR-DATE-MM       TO HL4-CANCEL-DATE-MM.       29500000
295100     MOVE PV-HOLD-CURR-DATE-DD       TO HL4-CANCEL-DATE-DD.       29510000
295200     MOVE PV-HOLD-CURR-DATE-YY       TO HL4-CANCEL-DATE-YY.       29520000
295300     MOVE RC001-TRAILER-NBR          TO HL4-TRAILER-NUMBER        29530000
295400                                        RC004-TRAILER-NBR.        29540000
295500                                                                  29550000
295600     MOVE RC001-AD-DATE              TO PV-HOLD-CURR-DATE-MMDDYY. 29560000
295700     MOVE PV-HOLD-CURR-DATE-MM       TO HL5-AD-DATE-MM.           29570000
295800     MOVE PV-HOLD-CURR-DATE-DD       TO HL5-AD-DATE-DD.           29580000
295900     MOVE PV-HOLD-CURR-DATE-YY       TO HL5-AD-DATE-YY.           29590000
296000     SET PS-FORECAST-SHIP-MODE-OFF TO TRUE.                       29600000
296100     PERFORM 7955-VERIFY-CARRIER.                                 29610000
296200                                                                  29620000
296300     MOVE RC001-CARRIER-SCAC-CODE    TO RC004-CARRIER-SCAC-CODE   29630000
296400                                        DLP1-CARRIER-SCAC-CODE.   29640000
296500     IF RC001-CARRIER-SCAC-CODE > SPACES                          29650000
296600         MOVE RC001-CARRIER-SCAC-CODE                             29660000
296700                                     TO DK-PRO-SCAC-ID            29670000
296800         PERFORM 7950-VERIFY-LSD-CARR-SCAC                        29680000
296900         MOVE RC001-CARRIER-SCAC-CODE                             29690000
297000                                     TO PV-SAVE-LSD-CARR-ID       29700000
297100     ELSE                                                         29710000
297200         MOVE SPACES                 TO DK-PRO-SCAC-ID            29720000
297300                                        PV-SAVE-LSD-CARR-ID       29730000
297400                                        PV-SHIPMT-PRO-SCAC-ID     29740000
297500                                        PV-SHIPMT-ORIGIN-SCAC-ID  29750000
297600     END-IF.                                                      29760000
297700     MOVE RC001-PRO-NBR              TO RC023-FREIGHT-BILL        29770000
297800                                        PV-SHIPMT-COMP-PRO.       29780000
297900     MOVE RC001-BILL-OF-LADING-NBR   TO RC023-BILL-OF-LADING      29790000
298000                                        PV-SHIPMT-COMP-BOL.       29800000
298100     CALL RC023-FB-BOL-VEH-FORMAT USING RC023-FORMAT-DATA-AREA.   29810000
298200     MOVE RC023-FREIGHT-BILL         TO PV-SHIPMT-PRO-NBR         29820000
298300                                        DK-PRO-NBR.               29830000
298400     MOVE PV-SHIPMT-PRO-NBR          TO HL3-PRO-NUMBER            29840000
298500                                        RC004-PRO-NBR.            29850000
298600     MOVE RC023-BILL-OF-LADING       TO PV-SHIPMT-BOL-NBR         29860000
298700                                        DK-BOL-NBR.               29870000
298800     MOVE PV-SHIPMT-BOL-NBR          TO HL1-BILL-OF-LADING        29880000
298900                                        DLP1-BOL                  29890000
299000                                        RC004-BILL-OF-LADING-NBR. 29900003
299011     MOVE RC001-CARR-AUTH-ID         TO PV-SHIPMT-CARR-AUTH-ID.   29901102
299030                                                                  29903003
299100     IF RC001-PO-NBR = ZERO                                       29910000
299200         SET PS-BYPASS-UPDATES     TO TRUE                        29920000
299300     END-IF.                                                      29930000
299400     IF  DK-PRO-SCAC-ID = SPACES                                  29940000
299500         SET PS-SHIPMENT-NOT-FOUND                                29950000
299600             PS-BYPASS-SHIPMT                                     29960000
299700             PS-BYPASS-UPDATES     TO TRUE                        29970000
299800         MOVE PC-0                 TO PV-PKSLIP-SHIPT-ID          29980000
299900     ELSE                                                         29990000
300000         PERFORM 4130-CHECK-IF-SHIPMT-EXISTS                      30000000
300100         IF PS-SHIPMENT-FOUND                                     30010000
300200             ADD RC001-CARTON-CNT-PO, SHIPMT-VEND-CART-CT         30020000
300300                               GIVING   PV-SHIPMT-VEND-CARTON-CNT 30030000
300400         ELSE                                                     30040000
300500             MOVE RC001-CARTON-CNT-PO TO PV-SHIPMT-VEND-CARTON-CNT30050000
300600         END-IF                                                   30060000
300700     END-IF.                                                      30070000
300800     MOVE RC001-SHIPMENT-WEIGHT      TO HL5-SHIP-WEIGHT           30080000
300900                                        PV-SHIPMT-EXPTED-GRO-WGHT.30090000
301000     MOVE RC001-SHIP-WEIGHT-UM       TO HL5-UNIT-MEASURE.         30100000
301100                                                                  30110000
301200     MOVE SPACES                     TO HL6-DC-ID.                30120000
301300     MOVE RC001-DIST-CNTR            TO PV-DIST-CNTR.             30130000
301400     IF RC001-DIST-CNTR = 0                                       30140000
301500         MOVE PC-UNKNOWN             TO HL6-DC-UNKNOWN            30150000
301600     ELSE                                                         30160000
301700         MOVE RC001-DIST-CNTR        TO HL6-DC-NBR.               30170000
301800                                                                  30180000
301900     MOVE HLP2-DC-NAME               TO HL6-DC-NAME.              30190000
302000                                                                  30200000
302100     MOVE RC001-STORE-NBR            TO HL7-STORE-NBR             30210000
302200                                        PV-STORE-NBR.             30220000
302201*                                                                 30220121
302202* DMH - 7/15/2021 BEGIN                                           30220221
302203*                                                                 30220321
302210     IF RC001-STORE-NBR   = 9999                                  30221021
302220        MOVE RC001-DIST-CNTR TO HL7-STORE-NBR                     30222021
302230     END-IF.                                                      30223021
302240*                                                                 30224021
302250* DMH - 7/15/2021 END                                             30225021
302260*                                                                 30226021
302300     PERFORM 4300-OBTAIN-STORE-NAME.                              30230000
302400                                                                  30240000
302500     MOVE RC001-CARTON-CNT-STORE     TO HL8-TOT-CARTONS-STORE.    30250000
302600     MOVE RC001-CARTON-CNT-PO        TO HL8-TOT-CARTONS-PO        30260000
302700                                        PV-ASN-CARTONS.           30270000
302800     ADD PV-ASN-CARTONS              TO PV-SUM-ASN-CARTONS.       30280000
302900     ADD RC001-CARTON-CNT-STORE      TO PV-CALC-CARTONS           30290000
303000     ADD  RC001-CARTON-CNT-STORE     TO RC004-CALC-CARTONS.       30300000
303100     MOVE RC001-CARTON-CNT-SHPMT     TO HL8-TOT-CARTONS-SHPMT.    30310000
303200                                                                  30320000
303300     MOVE RC001-PO-NBR               TO DK-PO-NBR.                30330000
303400     PERFORM 4150-GET-SPECIAL-INSTRUCTIONS.                       30340000
303500     MOVE WS-HOLD-SPECIAL-INSTR (1)  TO HL9-SI-1.                 30350000
303600     MOVE WS-HOLD-SPECIAL-INSTR (2)  TO HL9-SI-2.                 30360000
303700     MOVE WS-HOLD-SPECIAL-INSTR (3)  TO HL9-SI-3.                 30370000
303800                                                                  30380000
303900     PERFORM 4200-CHECK-FOR-GENERAL-ERRORS.                       30390000
304000     MOVE PC-61 TO PV-LINE-CNT.                                   30400000
304100     IF RC001-TRAILER-NBR > SPACES                                30410000
304200         MOVE RC001-TRAILER-NBR      TO RC023-VEHICLE             30420000
304300         CALL RC023-FB-BOL-VEH-FORMAT USING                       30430000
304400                                    RC023-FORMAT-DATA-AREA        30440000
304500         MOVE RC023-VEHICLE          TO PV-VEHICL-VEH-NBR         30450000
304600                                        PV-VHTRIP-VEH-NBR         30460000
304700                                        PV-SAVE-VEH-NBR           30470000
304800                                        PV-SHIPMT-VEH-NBR         30480000
304900     ELSE                                                         30490000
305000         MOVE SPACES                 TO PV-VEHICL-VEH-NBR         30500000
305100                                        PV-VHTRIP-VEH-NBR         30510000
305200                                        PV-SAVE-VEH-NBR           30520000
305300                                        PV-SHIPMT-VEH-NBR         30530000
305400     END-IF.                                                      30540000
305500                                                                  30550000
305600     IF PV-VEHICL-VEH-NBR > SPACES                                30560000
305700         MOVE PV-VEHICL-VEH-NBR      TO VEHICL-VEH-NBR            30570000
305800         MOVE RC001-CARRIER-SCAC-CODE                             30580000
305900                                     TO VEHICL-OWNER-SCAC-ID      30590000
306000         PERFORM 7960-SELECT-VEHICL                               30600000
306100         PERFORM 7970-CHECK-VEHICL-SQLCODE                        30610000
306200     ELSE                                                         30620000
306300         SET PS-BYPASS-VEHICL    TO TRUE                          30630000
306400     END-IF.                                                      30640000
306500                                                                  30650000
306600     MOVE PC-EN     TO PV-SHIPST-SHIPT-STATUS-CDE.                30660000
306700     IF PS-UPDATE-VEHICL                                          30670000
306800         IF PS-SHIPMENT-NOT-FOUND                                 30680000
306900             MOVE PC-EN          TO PV-SHIPST-SHIPT-STATUS-CDE    30690000
307000             IF PV-VEHICL-CURR-TRIP-ID-NULL = PC-NEG-1            30700000
307100                 SET PS-INSERT-VHTRIP                             30710000
307200                                 TO TRUE                          30720000
307300                 MOVE SPACES         TO PV-VHTRIP-EST-AR-TMST     30730000
307400             ELSE                                                 30740000
307500                 MOVE PV-VEHICL-CURR-TRIP-ID                      30750000
307600                                 TO VHTRIP-TRIP-ID                30760000
307700                                    PV-SHIPMT-TRIP-ID             30770000
307800                 SET PS-DONT-UPDATE-VHTRIP                        30780000
307900                                     TO TRUE                      30790000
308000             END-IF                                               30800000
308100         ELSE                                                     30810000
308200             IF PV-SHIPMT-TRIP-ID > 0                             30820000
308300                 MOVE PV-SHIPMT-TRIP-ID                           30830000
308400                                     TO VHTRIP-TRIP-ID            30840000
308500                 PERFORM 7980-SELECT-VHTRIP                       30850000
308600                 PERFORM 7990-CHECK-VHTRIP-SQLCODE                30860000
308700             ELSE                                                 30870000
308800                 IF PV-VEHICL-CURR-TRIP-ID-NULL = PC-NEG-1        30880000
308900                   SET PS-INSERT-VHTRIP                           30890000
309000                                 TO TRUE                          30900000
309100                   MOVE SPACES         TO PV-VHTRIP-EST-AR-TMST   30910000
309200                 ELSE                                             30920000
309300                     MOVE PV-VEHICL-CURR-TRIP-ID                  30930000
309400                                 TO VHTRIP-TRIP-ID                30940000
309500                     PERFORM 7980-SELECT-VHTRIP                   30950000
309600                     PERFORM 7990-CHECK-VHTRIP-SQLCODE            30960000
309700                 END-IF                                           30970000
309800             END-IF                                               30980000
309900         END-IF                                                   30990000
310000     ELSE                                                         31000000
310100*  ASSUME PS-INSERT-VEHICL OR                                     31010000
310200*         PS-BYPASS-VEHICL                                        31020000
310300         IF PV-SHIPMT-TRIP-ID > 0                                 31030000
310400             MOVE PV-SHIPMT-TRIP-ID                               31040000
310500                                 TO VHTRIP-TRIP-ID                31050000
310600             PERFORM 7980-SELECT-VHTRIP                           31060000
310700             PERFORM 7990-CHECK-VHTRIP-SQLCODE                    31070000
310800         ELSE                                                     31080000
310900             MOVE SPACES         TO PV-VHTRIP-EST-AR-TMST         31090000
311000             SET PS-INSERT-VHTRIP                                 31100000
311100                             TO TRUE                              31110000
311200         END-IF                                                   31120000
311300     END-IF.                                                      31130000
311400                                                                  31140000
311700     IF PV-CKPT-JOB-NAME = 'RCK090  '                             31170000
311800         MOVE RC001-MAN-SEG-IND      TO DLP1-MAN-NBR              31180000
311900     ELSE                                                         31190000
312000         PERFORM 4190-RETRIEVE-MAN-NBR.                           31200000
312100                                                                  31210000
312200     MOVE RC001-DIST-CNTR            TO RC004-DIST-CNTR.          31220000
312300     MOVE SPACES                     TO RC004-CONSOLIDATION-IND.  31230000
312400                                                                  31240000
312500*--------------------------------------------------------------*  31250000
312600*  IF  BOTH -PRO- & -BOL- ARE KNOWN                            *  31260000
312700*      - MATCH ON -PRO- -BOL- -SCAC-                           *  31270000
312800*        IF NO MATCH                                           *  31280000
312900*        - MATCH = -PRO(SPACES)- -BOL- -SCAC-                  *  31290000
313000*          IF NO MATCH                                         *  31300000
313100*             -MATCH = -PRO- -BOL(SPACES)- -SCAC-              *  31310000
313200*              IF NO MATCH - INSERT SHIPMENT                   *  31320000
313300*                                                              *  31330000
313400*  IF -PRO- KNOWN & -BOL- NOT FILLED IN                        *  31340000
313500*      -MATCH = -PRO- -BOL(SPACES)- -SCAC-                     *  31350000
313600*       IF NO MATCH - INSERT SHIPMENT                          *  31360000
313700*                                                              *  31370000
313800*  IF -PRO- NOT KNOWN & -BOL- FILLED IN                        *  31380000
313900*      -MATCH = -PRO(SPACES)- -BOL- -SCAC-                     *  31390000
314000*       IF NO MATCH - INSERT SHIPMENT                          *  31400000
314100*                                                              *  31410000
314200*--------------------------------------------------------------*  31420000
314300 4130-CHECK-IF-SHIPMT-EXISTS.                                     31430000
314400     SET PS-SHIPMENT-FOUND                                        31440000
314500         PS-NO-DUPLICATE-SHIPMT TO TRUE.                          31450000
314600                                                                  31460000
314700     IF  PV-SHIPMT-PRO-NBR  >  SPACES                             31470000
314800         IF  PV-SHIPMT-BOL-NBR  >  SPACES                         31480000
314900***          * BOTH -PRO- & -BOL- FILLED IN *                     31490000
315000***            MATCH = -PRO- -BOL- -SCAC-                         31500000
315100             PERFORM 7030-SELECT-SHIPMT                           31510000
315200             IF  SQLCODE = ZERO OR                                31520000
315300                 PS-DUPLICATE-SHIPMT                              31530000
315400                 PERFORM 7060-CHECK-SHIPMT-SQLCODE                31540000
315500                 MOVE SHIPMT-PRO-SCAC-ID                          31550000
315600                                     TO PV-SHIPMT-PRO-SCAC-ID     31560000
315700                 MOVE SHIPMT-PRO-NBR TO PV-SHIPMT-PRO-NBR         31570000
315800             ELSE                                                 31580000
315900***               MATCH = -PRO(SPACES)- -BOL- -SCAC-              31590000
316000                 PERFORM 7033-SELECT-SHIPMT                       31600000
316100                 IF  SQLCODE = ZERO OR                            31610000
316200                     PS-DUPLICATE-SHIPMT                          31620000
316300                     PERFORM 7060-CHECK-SHIPMT-SQLCODE            31630000
316400                     MOVE RC023-FREIGHT-BILL                      31640000
316500                                         TO PV-SHIPMT-PRO-NBR     31650000
316600                     MOVE SHIPMT-BOL-NBR TO PV-SHIPMT-BOL-NBR     31660000
316700                 ELSE                                             31670000
316800***                   MATCH = -PRO- -BOL(SPACES)- -SCAC-          31680000
316900                     PERFORM 7036-SELECT-SHIPMT                   31690000
317000                     IF  SQLCODE = ZERO OR                        31700000
317100                         PS-DUPLICATE-SHIPMT                      31710000
317200                         PERFORM 7060-CHECK-SHIPMT-SQLCODE        31720000
317300                         MOVE SHIPMT-PRO-NBR TO PV-SHIPMT-PRO-NBR 31730000
317400                         MOVE RC023-BILL-OF-LADING                31740000
317500                                             TO PV-SHIPMT-BOL-NBR 31750000
317600                     ELSE                                         31760000
317700                         SET  PS-SHIPMENT-NOT-FOUND               31770000
317800                              PS-INSERT-SHIPMT      TO TRUE       31780000
317900                         MOVE ZEROS      TO PV-SHIPMT-TRIP-ID     31790000
318000                     END-IF                                       31800000
318100                 END-IF                                           31810000
318200             END-IF                                               31820000
318300         ELSE                                                     31830000
318400***          *  JUST -PRO- FILLED IN, -BOL- NOT FILLED IN *       31840000
318500***                   MATCH = -PRO- -BOL(SPACES)- -SCAC-          31850000
318600             PERFORM 7036-SELECT-SHIPMT                           31860000
318700             IF  SQLCODE = ZERO OR                                31870000
318800                 PS-DUPLICATE-SHIPMT                              31880000
318900                 PERFORM 7060-CHECK-SHIPMT-SQLCODE                31890000
319000                 MOVE SHIPMT-PRO-NBR        TO PV-SHIPMT-PRO-NBR  31900000
319100                 MOVE RC023-BILL-OF-LADING  TO PV-SHIPMT-BOL-NBR  31910000
319200             ELSE                                                 31920000
319300***                   MATCH = -PRO- -SCAC-                        31930000
319400                 PERFORM 7037-SELECT-SHIPMT                       31940000
319500                 IF  SQLCODE = ZERO                               31950000
319600                     PERFORM 7060-CHECK-SHIPMT-SQLCODE            31960000
319700                     MOVE SHIPMT-PRO-NBR    TO PV-SHIPMT-PRO-NBR  31970000
319800                     MOVE SHIPMT-BOL-NBR    TO PV-SHIPMT-BOL-NBR  31980000
319900                 ELSE                                             31990000
320000                     SET  PS-SHIPMENT-NOT-FOUND                   32000000
320100                          PS-INSERT-SHIPMT      TO TRUE           32010000
320200                     MOVE ZEROS      TO PV-SHIPMT-TRIP-ID         32020000
320300                 END-IF                                           32030000
320400             END-IF                                               32040000
320500         END-IF                                                   32050000
320600     ELSE                                                         32060000
320700***          *  -PRO- NOT FILLED IN *                             32070000
320800***          *  -BOL- FILLED IN *                                 32080000
320900         IF  PV-SHIPMT-BOL-NBR  >  SPACES                         32090000
321000***                   MATCH = -PRO(SPACES)- -BOL- -SCAC-          32100000
321100             PERFORM 7033-SELECT-SHIPMT                           32110000
321200             IF  SQLCODE = ZERO OR                                32120000
321300                 PS-DUPLICATE-SHIPMT                              32130000
321400                 PERFORM 7060-CHECK-SHIPMT-SQLCODE                32140000
321500                 MOVE RC023-FREIGHT-BILL TO PV-SHIPMT-PRO-NBR     32150000
321600                 MOVE SHIPMT-BOL-NBR     TO PV-SHIPMT-BOL-NBR     32160000
321700             ELSE                                                 32170000
321800***                   MATCH = -BOL- -SCAC-                        32180000
321900                 PERFORM 7038-SELECT-SHIPMT                       32190000
322000                 IF  SQLCODE = ZERO                               32200000
322100                     PERFORM 7060-CHECK-SHIPMT-SQLCODE            32210000
322200                     MOVE SHIPMT-PRO-NBR     TO PV-SHIPMT-PRO-NBR 32220000
322300                     MOVE SHIPMT-BOL-NBR     TO PV-SHIPMT-BOL-NBR 32230000
322400                 ELSE                                             32240000
322500                     SET  PS-SHIPMENT-NOT-FOUND                   32250000
322600                          PS-INSERT-SHIPMT      TO TRUE           32260000
322700                     MOVE ZEROS      TO PV-SHIPMT-TRIP-ID         32270000
322800                 END-IF                                           32280000
322900             END-IF                                               32290000
323000         ELSE                                                     32300000
323100             SET  PS-SHIPMENT-NOT-FOUND  TO TRUE                  32310000
323200             MOVE ZEROS      TO PV-SHIPMT-TRIP-ID                 32320000
323300         END-IF                                                   32330000
323400     END-IF.                                                      32340000
323500                                                                  32350000
323600                                                                  32360000
323700     IF PS-SHIPMENT-NOT-FOUND                                     32370000
323800         PERFORM WITH TEST AFTER                                  32380000
323900             UNTIL SQLCODE = +100                                 32390000
324000             PERFORM 7020-GET-RANDOM-NUMBER                       32400000
324100             PERFORM 7025-CHECK-IF-SHIPT-ID-USED                  32410000
324200         END-PERFORM                                              32420000
324300         MOVE PV-RANDOM-NBR      TO PV-SHIPMT-SHIPT-ID            32430000
324400                                    PV-SHIPST-SHIPT-ID            32440000
324500                                    PV-SHPTPO-SHIPT-ID            32450000
324600                                    PV-PKSLIP-SHIPT-ID            32460000
324700     ELSE                                                         32470000
324800         MOVE SHIPMT-SHIPT-ID      TO PV-PKSLIP-SHIPT-ID          32480000
324900     END-IF.                                                      32490000
325000                                                                  32500000
325100 4150-GET-SPECIAL-INSTRUCTIONS.                                   32510000
325200     SET PS-MORE-INST TO TRUE.                                    32520000
325300     PERFORM 7600-OPEN-INST-CURSOR.                               32530000
325400     PERFORM 7700-FETCH-INST-CURSOR                               32540000
325500         VARYING SPEC-INST-IDX FROM 1 BY 1                        32550000
325600         UNTIL SPEC-INST-IDX > 3                                  32560000
325700         OR PS-NO-MORE-INST.                                      32570000
325800     PERFORM 7800-CLOSE-INST-CURSOR.                              32580000
325900                                                                  32590000
326000***************************************************************** 32600000
326100*     VERIFY THE PURCHASE ORDER EXISTS                          * 32610000
326200***************************************************************** 32620000
326300                                                                  32630000
326400 4180-VERIFY-PO.                                                  32640000
326500                                                                  32650000
326600     MOVE '4180-VERIFY-PO'       TO PV-ABEND-PARAGRAPH.           32660000
326700                                                                  32670000
326800     PERFORM                                                      32680000
326900         WITH TEST AFTER                                          32690000
327000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     32700000
327100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            32710000
327200                 SQLCODE = ZERO OR                                32720000
327300                 SQLCODE = +100                                   32730000
327400                                                                  32740000
327500         EXEC SQL                                                 32750000
327600             SELECT DEPT_NBR,                                     32760000
327700                    ENT_ID,                                       32770000
327800                    PO_TYP_CDE                                    32780000
327900               INTO :PURCHS-DEPT-NBR,                             32790000
328000                    :PURCHS-ENT-ID,                               32800000
328100                    :PURCHS-PO-TYP-CDE                            32810000
328200               FROM TPURCHS                                       32820000
328300              WHERE PO_NBR         = :PURCHS-PO-NBR               32830000
328400                AND VER_STATUS_CDE = :PC-A                        32840000
328500         END-EXEC                                                 32850000
328600                                                                  32860000
328700         EVALUATE TRUE                                            32870000
328800             WHEN SQLCODE = ZERO                                  32880000
328900             WHEN SQLCODE = +100                                  32890000
329000             WHEN SQLCODE = -911                                  32900000
329100                 CONTINUE                                         32910000
329200                                                                  32920000
329300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              32930000
329400                 DISPLAY '**************************************' 32940000
329500                 DISPLAY 'WARNING ISSUED ON SELECT OF TPURCHS   ' 32950000
329600                 DISPLAY 'PURCHS-PO-NBR: ' PURCHS-PO-NBR          32960000
329700                 DISPLAY '**************************************' 32970000
329800                 PERFORM 9700-SQL-WARNING                         32980000
329900                                                                  32990000
330000             WHEN SQLCODE < ZERO                                  33000000
330100                 DISPLAY '**************************************' 33010000
330200                 DISPLAY 'ERROR ISSUED ON SELECT OF TPURCHS     ' 33020000
330300                 DISPLAY 'PURCHS-PO-NBR: ' PURCHS-PO-NBR          33030000
330400                 DISPLAY '**************************************' 33040000
330500                 PERFORM 9800-SQL-ERROR                           33050000
330600                                                                  33060000
330700         END-EVALUATE                                             33070000
330800                                                                  33080000
330900     END-PERFORM.                                                 33090000
331000                                                                  33100000
331100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    33110000
331200         SQLCODE NOT = +0                                         33120000
331300         DISPLAY '**************************************'         33130000
331400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         33140000
331500         DISPLAY 'SELECT TPURCHS                        '         33150000
331600         DISPLAY 'PURCHS-PO-NBR:          '                       33160000
331700                  PURCHS-PO-NBR                                   33170000
331800         DISPLAY 'PV-SHIPMT-PRO-NBR:      '                       33180000
331900                  PV-SHIPMT-PRO-NBR                               33190000
332000         DISPLAY 'PV-SHIPMT-BOL-NBR:      '                       33200000
332100                  PV-SHIPMT-BOL-NBR                               33210000
332200         DISPLAY '**************************************'         33220000
332300         PERFORM 9800-SQL-ERROR                                   33230000
332400     END-IF.                                                      33240000
332500                                                                  33250000
332600     EVALUATE TRUE                                                33260000
332700         WHEN SQLCODE = ZERO                                      33270000
332800             CONTINUE                                             33280000
332900                                                                  33290000
333000         WHEN SQLCODE = +100                                      33300000
333100             MOVE ZEROS          TO PURCHS-PO-NBR                 33310000
333200                                    PURCHS-ENT-ID                 33320000
333300             MOVE SPACES         TO PURCHS-DEPT-NBR               33330000
333400     END-EVALUATE.                                                33340000
333500                                                                  33350000
333600 4190-RETRIEVE-MAN-NBR.                                           33360000
333700                                                                  33370000
333800     MOVE '4190'                    TO PGM-LOCATION.              33380000
333900     MOVE '4190-RETRIEVE-MAN-NBR'   TO PV-ABEND-PARAGRAPH.        33390000
334000                                                                  33400000
334100     EXEC SQL                                                     33410000
334200         SELECT COUNT(*)                                          33420000
334300           INTO :PV-MAN-SEGMENT-COUNT                             33430000
334400           FROM  TASNHDR  A                                       33440000
334500                ,TASNCAR  B                                       33450000
334600          WHERE  A.ASNHDR_NBR  = :RC001-ASNHDR-NBR                33460000
334700            AND  A.EDI_VEND_ID = :DK-DUN-NBR                      33470000
334800            AND  A.ASNHDR_ID = B.ASNHDR_ID                        33480000
334900            AND  A.OPERCO_NBR = :PC-03                            33490000
335000            AND  B.PO_NBR    = :PV-PO-NBR-MAN                     33500000
335100            AND  SUBSTR(ASNCAR_NBR,1,15) > '000000000000000'      33510000
335200     END-EXEC.                                                    33520000
335300                                                                  33530000
335400     EVALUATE TRUE                                                33540000
335500       WHEN SQLCODE = ZEROS                                       33550000
335600         IF PV-MAN-SEGMENT-COUNT > 0                              33560000
335700             MOVE 'Y' TO DLP1-MAN-NBR                             33570000
335800         ELSE                                                     33580000
335900             MOVE 'N' TO DLP1-MAN-NBR                             33590000
336000         END-IF                                                   33600000
336100       WHEN SQLCODE = +100                                        33610000
336200         MOVE SPACE TO DLP1-MAN-NBR                               33620000
336300       WHEN OTHER                                                 33630000
336400         DISPLAY PV-ABEND-PARAGRAPH                               33640000
336500         DISPLAY 'ASNHDR-NBR: '                                   33650000
336600                  RC001-ASNHDR-NBR                                33660000
336700         DISPLAY 'CURR-PO-NBR: '                                  33670000
336800                  PV-PO-NBR-MAN                                   33680000
336900         DISPLAY 'EDI-VEND-ID: '                                  33690000
337000                  DK-DUN-NBR                                      33700000
337100         PERFORM 9800-SQL-ERROR                                   33710000
337200     END-EVALUATE.                                                33720000
337300                                                                  33730000
337400 4195-RETRIEVE-ISA-NBR.                                           33740000
337500                                                                  33750000
337600     MOVE '4195'                    TO PGM-LOCATION.              33760000
337700     MOVE '4195-RETRIEVE-ISA-NBR'   TO PV-ABEND-PARAGRAPH.        33770000
337800                                                                  33780000
337900     EXEC SQL                                                     33790000
338000         SELECT EDIISA_CNTL_NBR                                   33800000
338100           INTO :ASNHDR-EDIISA-CNTL-NBR                           33810000
338200           FROM  TASNHDR                                          33820000
338300          WHERE  ASNHDR_NBR  = :RC001-ASNHDR-NBR                  33830000
338400            AND  EDI_VEND_ID = :DK-DUN-NBR                        33840000
338500            AND  OPERCO_NBR  = :RC001-OPERATING-COMPANY           33850000
338600     END-EXEC.                                                    33860000
338700                                                                  33870000
338800     EVALUATE TRUE                                                33880000
338900       WHEN SQLCODE = ZEROS                                       33890000
339000         CONTINUE                                                 33900000
339100       WHEN SQLCODE = +100                                        33910000
339200         MOVE SPACE TO DLP1-ISA-NBR                               33920000
339300         MOVE SPACE TO DLP1-ISA-NBR                               33930000
339400       WHEN OTHER                                                 33940000
339500         DISPLAY PV-ABEND-PARAGRAPH                               33950000
339600         DISPLAY 'ASNHDR-NBR: '                                   33960000
339700                  RC001-ASNHDR-NBR                                33970000
339800         DISPLAY 'EDI-VEND-ID: '                                  33980000
339900                  DK-DUN-NBR                                      33990000
340000         PERFORM 9800-SQL-ERROR                                   34000000
340100     END-EVALUATE.                                                34010000
340200                                                                  34020000
340300 4200-CHECK-FOR-GENERAL-ERRORS.                                   34030000
340400******************************************************************34040000
340500*  THIS PARAGRAPH PRINTS THE GENERAL ERRORS FOR THE HEADERS.     *34050000
340600*                                                                *34060000
340700*                                                                *34070000
340800******************************************************************34080000
340900     INITIALIZE HL10-GEN-ERR-TABLE.                               34090000
341000                                                                  34100000
341100     SET HL10-INDX                   TO 1.                        34110000
341200                                                                  34120000
341300     EVALUATE TRUE                                                34130000
341400         WHEN RC001-PO-SHIPPED-EARLY                              34140000
341500              MOVE PC-GEN-ERR-MSG-1  TO HL10-GEN-ERR (HL10-INDX)  34150000
341600              SET HL10-INDX UP BY 1                               34160000
341700         WHEN RC001-PO-SHIPPED-LATE                               34170000
341800              MOVE PC-GEN-ERR-MSG-2  TO HL10-GEN-ERR (HL10-INDX)  34180000
341900              SET HL10-INDX UP BY 1                               34190000
342000     END-EVALUATE.                                                34200000
342100                                                                  34210000
342200     EVALUATE TRUE                                                34220000
342300         WHEN RC001-PO-UNMATCHED                                  34230000
342400              MOVE PC-GEN-ERR-MSG-3  TO HL10-GEN-ERR (HL10-INDX)  34240000
342500              SET HL10-INDX UP BY 1                               34250000
342600         WHEN RC001-PO-CANCELLED-OR-COMPLETE                      34260000
342700              MOVE PC-GEN-ERR-MSG-4  TO HL10-GEN-ERR (HL10-INDX)  34270000
342800              SET HL10-INDX UP BY 1                               34280000
342900     END-EVALUATE.                                                34290000
343000                                                                  34300000
343100     IF  RC001-SEQ-NBR-SEQ                                        34310000
343200         MOVE PC-GEN-ERR-MSG-5       TO HL10-GEN-ERR (HL10-INDX)  34320000
343300     END-IF.                                                      34330000
343400                                                                  34340000
343500******************************************************************34350000
343600* OBTAINS STORE NAME FROM RF STORE TABLE                          34360000
343700******************************************************************34370000
343800 4300-OBTAIN-STORE-NAME.                                          34380000
343900     MOVE '4300-OBTAIN-STORE-NAME    '                            34390000
344000                                 TO PV-ABEND-PARAGRAPH.           34400000
344100                                                                  34410000
344200     EXEC SQL                                                     34420000
344300         SELECT LOC_NM                                            34430000
344400           INTO :XLT00010-LOC-NM                                  34440000
344500           FROM XLT_LOC                                           34450000
344600          WHERE LOC_NBR = :PV-STORE-NBR                           34460000
344700     END-EXEC.                                                    34470000
344800     EVALUATE TRUE                                                34480000
344900       WHEN SQLCODE = ZEROS                                       34490000
345000         MOVE XLT00010-LOC-NM TO HL7-STORE-NAME                   34500000
345100       WHEN SQLCODE = +100                                        34510000
345200         MOVE PC-UNKNOWN  TO HL7-STORE-NAME                       34520000
345300       WHEN OTHER                                                 34530000
345400         DISPLAY PV-ABEND-PARAGRAPH                               34540000
345500         PERFORM 9100-SQL-ABEND                                   34550000
345600     END-EVALUATE.                                                34560000
345700                                                                  34570000
345800 4400-FORMAT-DETAIL-LINES.                                        34580000
345900******************************************************************34590000
346000*  THIS PARAGRAPH FORMATS THE DETAIL LINES FOR AN ASN NUMBER.    *34600000
346100******************************************************************34610000
346200     IF  RC001-PO-LINE-NBR = HIGH-VALUES                          34620000
346300         MOVE SPACES                 TO DL1-PO-LINE               34630000
346400     ELSE                                                         34640000
346500         MOVE RC001-PO-LINE-NBR      TO DL1-PO-LINE               34650000
346600     END-IF.                                                      34660000
346700                                                                  34670000
346800***************************************************************** 34680000
346900*                                        ** WR # 230ZZ          * 34690000
347000* REPLACED CODE TO MOVE VALUE OF RC001-SKU-SEQ-NBR TO DL1-SEQ   * 34700000
347100* WITH MOVE VALUE OF RC001-SKU-NBR TO DL1-SEQ.                  * 34710000
347200* DELETED CODE TO MOVE PC-DASH TO DL1-SKU-DASH-1,DL1-SKU-DASH-2 * 34720000
347300***************************************************************** 34730000
347400     IF  RC001-SKU-DEPT-NBR  = SPACES AND                         34740000
347500         RC001-SKU-CLASS-NBR = SPACES AND                         34750000
347600         RC001-SKU-SEQ-NBR   = SPACES OR                          34760000
347700        (RC001-SKU-DEPT-NBR = SPACES)                             34770000
347800         MOVE SPACES                 TO DL1-SKU                   34780000
347900     ELSE                                                         34790000
348000         MOVE RC001-SKU-DEPT-NBR     TO DL1-DEPT                  34800000
348100         MOVE RC001-SKU-CLASS-NBR    TO DL1-CLASS                 34810000
348200         MOVE RC001-SKU-NBR          TO DL1-SEQ                   34820000
348300     END-IF.                                                      34830000
348400***************************************************************** 34840000
348500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        * 34850000
348600***************************************************************** 34860000
348700                                                                  34870000
348800     MOVE RC001-UPC-NBR              TO PV-UPC-NBR.               34880000
348900     MOVE PV-UPC-NBR (1:1)           TO DL1-UPC-NBR-1.            34890000
349000     MOVE PV-UPC-NBR (2:8)           TO DL1-UPC-NBR-2-9.          34900000
349100     MOVE PV-UPC-NBR (10:5)          TO DL1-UPC-NBR-10-14.        34910000
349200     MOVE PV-UPC-NBR (15:1)          TO DL1-UPC-NBR-15.           34920000
349300                                                                  34930000
349400     MOVE RC001-VENDOR-STYLE         TO DL1-VENDOR-STYLE.         34940000
349500     MOVE RC001-SIZE                 TO DL1-SIZE.                 34950000
349600     MOVE RC001-COLOR                TO DL2-COLOR.                34960000
349700     MOVE RC001-UNIT-COST            TO DL1-UNIT-COST.            34970000
349800     MOVE RC001-UNIT-RETAIL          TO DL1-UNIT-RETAIL.          34980000
349900     IF  RC001-PO-LINE-NBR = HIGH-VALUES                          34990000
350000         MOVE ZERO                       TO DL1-TOTAL-OTR         35000000
350100         MOVE ZERO                       TO DL2-DC-OTR            35010000
350200     ELSE                                                         35020000
350300         MOVE RC001-PO-LINE-NBR          TO DK-ORD-LNE-NBR        35030000
350400         PERFORM 5000-CALCULATE-OTR                               35040000
350500         MOVE PV-OTR-ALL                 TO DL1-TOTAL-OTR         35050000
350600         MOVE PV-OTR                     TO DL2-DC-OTR            35060000
350700     END-IF.                                                      35070000
350800     MOVE RC001-QTY-ORDERED          TO DL1-QTY-ORDERED.          35080000
350900     MOVE RC001-QTY-ORDERED-UM       TO DL1-QTY-ORDERED-UM.       35090000
351000     MOVE RC001-QTY-SHIPPED          TO DL1-QTY-SHIPPED.          35100000
351100     MOVE RC001-QTY-SHIPPED-UM       TO DL1-QTY-SHIPPED-UM.       35110000
351200                                                                  35120000
351300     MOVE RC001-UPC-DESC             TO DL2-UPC-DESCRIPTION.      35130000
351400                                                                  35140000
351500                                                                  35150000
351600 4500-CHECK-DETAIL-ERRORS.                                        35160000
351700******************************************************************35170000
351800*  CHECKS FOR OVER OR UNDER SHIPMENTS AND VENDOR SUBSTITUTIONS   *35180000
351900*                                                                *35190000
352000*                                                                *35200000
352100*  THESE ARE THE ERROR MESSAGES FOR THE DETAIL LINES.            *35210000
352200*                                                                *35220000
352300*    1   'PO LINE ------ NT'                                     *35230000
352400*    2   'PRICE DISCR -- NT'                                     *35240000
352500*    3   '085 DISTRO --- NT'                                     *35250000
352600*                                                                *35260000
352700*    4   'CHG 99 DAYS -- NT'  | THESE TWO MESSAGES ARE MUTUALLY  *35270000
352800*    5   'PRICE CHG 99 DAYS'  | EXCLUSIVE.                       *35280000
352900*                                                                *35290000
353000*    6   'OVER 99% ----- NT'  | THESE FOUR MESSAGES ARE MUTUALLY *35300000
353100*    7   'OVER 99%         '  | EXCLUSIVE.  THAT MEANS THAT ONLY *35310000
353200*    8   'SHORT 99% ---- NT'  | ONE OF THESE FOUR MESSAGES MAY   *35320000
353300*    9   'SHORT 99%        '  | OCCUR FOR A DETAIL LINE.         *35330000
353400*                                                                *35340000
353500*                                                                *35350000
353600*  THE FOLLOWING IS AN ATTEMPT TO SHOW THE GROUPING THAT MAY     *35360000
353700*  OCCUR WITH THE ERROR MESSAGES.  EACH CHECK REPRESENTS A       *35370000
353800*  SEPARATE PARAGRAPH, IT IS NOT FALL-THROUGH CODE.              *35380000
353900*                                                                *35390000
354000*                                                                *35400000
354100*    IF CHECK FOR THE FIRST ERROR ENCOUNTERED   MAX # OF ERRORS  *35410000
354200*    ----------------------------------------   ---------------  *35420000
354300*                                                                *35430000
354400*    IF  ERROR-MSG-1                                  1          *35440000
354500*        MARK IT                                                 *35450000
354600*        DO NOT CHECK ANY OTHER ERRORS                           *35460000
354700*    ELSE                                                        *35470000
354800*        CHECK ERROR-MSG-2.                                      *35480000
354900*                                                                *35490000
355000*    IF  ERROR-MSG-2                                  3          *35500000
355100*        CHECK ERROR-MSG-4 AND -5    (1 OF 2)                    *35510000
355200*        CHECK ERROR-MSG-6 THRU -9   (1 OF 4)                    *35520000
355300*    ELSE                                                        *35530000
355400*        CHECK ERROR-MSG-3.                                      *35540000
355500*                                                                *35550000
355600*    IF  ERROR-MSG-3                                  2          *35560000
355700*        CHECK ERROR-MSG-4 AND -5    (1 OF 2)                    *35570000
355800*        DO NOT CHECK ERROR-MSG-6 THRU -9 IF THE                 *35580000
355900*        LINE HAS AN ERROR-MSG-3 CONDITION.                      *35590000
356000*    ELSE                                                        *35600000
356100*        CHECK ERROR-MSG-4 AND -5                                *35610000
356200*        CHECK ERROR-MSG-6 THRU -9.                              *35620000
356300*                                                                *35630000
356400*    IF  ERROR-MSG-4 OR -5           (1 OF 2)         2          *35640000
356500*        MARK IT                                                 *35650000
356600*        ERROR-MSG-6 THRU -9 ARE CHECKED IF THE LINE             *35660000
356700*        DOES NOT HAVE AN ERROR-MSG-3 CONDITION.                 *35670000
356800*                                                                *35680000
356900*    IF  ERROR-MSG-6 THRU -9         (1 OF 4)         1          *35690000
357000*        MARK IT.                                                *35700000
357100*                                                                *35710000
357200******************************************************************35720000
357300     INITIALIZE PV-ERROR-MSG-TABLE.                               35730000
357400     SET PEMT-INDX                TO 1.                           35740000
357500                                                                  35750000
357600     PERFORM 4600-CHECK-ERROR-PO-LINE.                            35760000
357700                                                                  35770000
357800 4600-CHECK-ERROR-PO-LINE.                                        35780000
357900******************************************************************35790000
358000*  CHECKS FOR PO LINE ERROR.                                     *35800000
358100******************************************************************35810000
358200     IF (RC001-LINE-NOT-MATCHED                                   35820000
358300     AND RC001-PO-LINE-NBR = HIGH-VALUES)                         35830000
358400      OR RC001-PO-LINE-NBR >= 8000                                35840000
358500                                                                  35850000
358600        IF RC001-PO-LINE-NBR >= 8000                              35860000
358700         AND RC001-PO-LINE-NBR <= 8999                            35870000
358800****  8000 LINE NUMBER SERIES FOR ODD CASE PACKS *****************35880000
358900            MOVE PC-DTL-ERR-MSG-10   TO PEMT-MSG (PEMT-INDX)      35890000
359000            MOVE PC-Y                TO PPEMT-IND (3)             35900000
359100        END-IF                                                    35910000
359200                                                                  35920000
359300        IF RC001-PO-LINE-NBR >= 9000                              35930000
359400         AND RC001-PO-LINE-NBR <= 9999                            35940000
359500****  9000 LINE NUMBER SERIES FOR COLOR, SIZE, STYLE CHANGE ******35950000
359600            MOVE PC-DTL-ERR-MSG-1    TO PEMT-MSG (PEMT-INDX)      35960000
359700            MOVE PC-Y                TO PPEMT-IND (1)             35970000
359800        END-IF                                                    35980000
359900                                                                  35990000
360000        IF RC001-PO-LINE-NBR = HIGH-VALUES                        36000000
360100****  ALL OTHER LINE NUMBERS WHERE THE STYLE IS NOT FOUND ********36010000
360200            MOVE PC-DTL-ERR-MSG-1    TO PEMT-MSG (PEMT-INDX)      36020000
360300            MOVE PC-Y                TO PPEMT-IND (1)             36030000
360400        END-IF                                                    36040000
360500                                                                  36050000
360600         SET PEMT-INDX UP BY 1                                    36060000
360700     ELSE                                                         36070000
360800         PERFORM 4620-CHECK-ERROR-PRICE-DISCR                     36080000
360900     END-IF.                                                      36090000
360910                                                                  36091026
361000 4620-CHECK-ERROR-PRICE-DISCR.                                    36100000
361100******************************************************************36110000
361200*  CHECKS FOR PRICE DISCREPANCY ERROR.                           *36120000
361300******************************************************************36130000
361400     IF  RC001-PRICE-DISCREPANCY                                  36140000
361500         MOVE PC-DTL-ERR-MSG-2    TO PEMT-MSG (PEMT-INDX)         36150000
361600         MOVE PC-Y                TO PPEMT-IND (2)                36160000
361700         SET PEMT-INDX UP BY 1                                    36170000
361800         PERFORM 4660-CHECK-ERROR-PRICE-CHG                       36180000
361900         PERFORM 4680-CHECK-ERROR-OVER-SHORT                      36190000
362000         PERFORM 4690-CHECK-ZERO-QTY-SHIPPED                      36200000
362100     ELSE                                                         36210000
362200         PERFORM 4640-CHECK-ERROR-DC-DISTRO                       36220000
362300     END-IF.                                                      36230000
362400                                                                  36240000
362500 4640-CHECK-ERROR-DC-DISTRO.                                      36250000
362600******************************************************************36260000
362700*  CHECKS FOR STORE 085 DISTRBIUTION ERROR.                      *36270000
362800******************************************************************36280000
363400         PERFORM 4660-CHECK-ERROR-PRICE-CHG                       36340000
363500         PERFORM 4680-CHECK-ERROR-OVER-SHORT                      36350000
363600         PERFORM 4690-CHECK-ZERO-QTY-SHIPPED                      36360000
363700         .                                                        36370000
363900                                                                  36390000
364000 4660-CHECK-ERROR-PRICE-CHG.                                      36400000
364100******************************************************************36410000
364200*  CHECKS FOR PRICE CHANGE ERRORS.                               *36420000
364300******************************************************************36430000
364400     IF  RC001-PRICE-VARIANCE                                     36440000
364500         IF RC001-PO-LINE-NBR = HIGH-VALUES                       36450000
364600             MOVE RC001-PR-CHG-EFF-DAYS                           36460000
364700                                  TO PC-DEM4-DAYS                 36470000
364800             MOVE PC-DTL-ERR-MSG-4                                36480000
364900                                  TO PEMT-MSG (PEMT-INDX)         36490000
365000             MOVE PC-Y            TO PPEMT-IND (4)                36500000
365100             SET PEMT-INDX UP BY 1                                36510000
365200         ELSE                                                     36520000
365300             MOVE RC001-PR-CHG-EFF-DAYS                           36530000
365400                                  TO PC-DEM5-DAYS                 36540000
365500             MOVE PC-DTL-ERR-MSG-5                                36550000
365600                                  TO PEMT-MSG (PEMT-INDX)         36560000
365700             MOVE PC-Y            TO PPEMT-IND (5)                36570000
365800             SET PEMT-INDX UP BY 1                                36580000
365900         END-IF                                                   36590000
366000     END-IF.                                                      36600000
366100                                                                  36610000
366200 4680-CHECK-ERROR-OVER-SHORT.                                     36620000
366300******************************************************************36630000
366400*  CHECKS FOR OVER SHIPMENTS AND SHORT SHIPMENT ERRORS.          *36640000
366500******************************************************************36650000
366600     EVALUATE TRUE                                                36660000
366700         WHEN (RC001-PO-LINE-NBR = HIGH-VALUES                    36670000
366800               AND                                                36680000
366900               RC001-QTY-SHIPPED-VAR < ZERO)                      36690000
367000              COMPUTE PV-OVER-SHORT-PCT ROUNDED =                 36700000
367100                (RC001-QTY-SHIPPED-VAR / RC001-QTY-ORDERED)       36710000
367200              COMPUTE PC-DEM6-PCT =                               36720000
367300                       (PV-OVER-SHORT-PCT * 100)                  36730000
367400              MOVE PC-DTL-ERR-MSG-6                               36740000
367500                                  TO PEMT-MSG (PEMT-INDX)         36750000
367600              MOVE PC-Y           TO PPEMT-IND (6)                36760000
367700              SET PEMT-INDX UP BY 1                               36770000
367800         WHEN (RC001-PO-LINE-NBR NOT = HIGH-VALUES                36780000
367900               AND                                                36790000
368000               RC001-QTY-SHIPPED-VAR < ZERO)                      36800000
368100              COMPUTE PV-OVER-SHORT-PCT ROUNDED  =                36810000
368200                (RC001-QTY-SHIPPED-VAR / RC001-QTY-ORDERED)       36820000
368300              COMPUTE PC-DEM7-PCT =                               36830000
368400                       (PV-OVER-SHORT-PCT * 100)                  36840000
368500              MOVE PC-DTL-ERR-MSG-7                               36850000
368600                                  TO PEMT-MSG (PEMT-INDX)         36860000
368700              MOVE PC-Y           TO PPEMT-IND (7)                36870000
368800              SET PEMT-INDX UP BY 1                               36880000
368900         WHEN (RC001-PO-LINE-NBR = HIGH-VALUES                    36890000
369000               AND                                                36900000
369100               RC001-QTY-SHIPPED-VAR > ZERO)                      36910000
369200              COMPUTE PV-OVER-SHORT-PCT ROUNDED =                 36920000
369300                (RC001-QTY-SHIPPED-VAR / RC001-QTY-ORDERED)       36930000
369400              COMPUTE PC-DEM8-PCT =                               36940000
369500                       (PV-OVER-SHORT-PCT * 100)                  36950000
369600              MOVE PC-DTL-ERR-MSG-8                               36960000
369700                                  TO PEMT-MSG (PEMT-INDX)         36970000
369800              MOVE PC-Y           TO PPEMT-IND (8)                36980000
369900              SET PEMT-INDX UP BY 1                               36990000
370000         WHEN (RC001-PO-LINE-NBR NOT = HIGH-VALUES                37000000
370100               AND                                                37010000
370200               RC001-QTY-SHIPPED-VAR > ZERO)                      37020000
370300              COMPUTE PV-OVER-SHORT-PCT ROUNDED =                 37030000
370400                (RC001-QTY-SHIPPED-VAR / RC001-QTY-ORDERED)       37040000
370500              COMPUTE PC-DEM9-PCT =                               37050000
370600                       (PV-OVER-SHORT-PCT * 100)                  37060000
370700              MOVE PC-DTL-ERR-MSG-9                               37070000
370800                                  TO PEMT-MSG (PEMT-INDX)         37080000
370900              MOVE PC-Y           TO PPEMT-IND (9)                37090000
371000              SET PEMT-INDX UP BY 1                               37100000
371100     END-EVALUATE.                                                37110000
371200                                                                  37120000
371300 4690-CHECK-ZERO-QTY-SHIPPED.                                     37130000
371400     IF RC001-QTY-SHIPPED = ZERO                                  37140000
371500         MOVE PC-DTL-ERR-MSG-13   TO PEMT-MSG (PEMT-INDX)         37150000
371600         MOVE PC-Y                TO PPEMT-IND (13)               37160000
371700         SET PEMT-INDX UP BY 1                                    37170000
371800     END-IF.                                                      37180000
371900                                                                  37190000
372000     IF PS-INVALID-STORE                                          37200000
372100         MOVE PC-DTL-ERR-MSG-14   TO PEMT-MSG (PEMT-INDX)         37210000
372200         MOVE PC-Y                TO PPEMT-IND (14)               37220000
372300         SET PEMT-INDX UP BY 1                                    37230000
372400     END-IF.                                                      37240000
372500                                                                  37250000
372600 4695-CHECK-FOR-VALID-STORE.                                      37260000
372700     MOVE '4695-CHECK-FOR-VALID-STORE'                            37270000
372800                                 TO PV-ABEND-PARAGRAPH.           37280000
372900                                                                  37290000
372901*                                                                 37290121
372902* DMH - 7/15/2021 BEGIN                                           37290221
372903*                                                                 37290321
372910     IF  RC001-STORE-NBR = 9999                                   37291021
372920         MOVE RC001-DIST-CNTR      TO XLT00010-LOC-NBR            37292021
372930     ELSE                                                         37293021
373000         MOVE RC001-STORE-NBR      TO XLT00010-LOC-NBR            37300021
373010     END-IF.                                                      37301021
373020*                                                                 37302021
373030* DMH - 7/15/2021 END                                             37303021
373040*                                                                 37304021
373100                                                                  37310000
373200     EXEC SQL                                                     37320000
373300        SELECT  LOC_TYP_CDE                                       37330000
373400          INTO :XLT00010-LOC-TYP-CDE                              37340000
373500          FROM  XLT_LOC                                           37350000
373600         WHERE  LOC_NBR = :XLT00010-LOC-NBR                       37360000
373700     END-EXEC.                                                    37370000
373800                                                                  37380000
373900     EVALUATE TRUE                                                37390000
374000         WHEN SQLCODE = +0                                        37400000
374100             CONTINUE                                             37410000
374200                                                                  37420000
374300         WHEN SQLCODE = +100                                      37430000
374400             SET PS-INVALID-STORE TO TRUE                         37440000
374500                                                                  37450000
374600         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  37460000
374610             MOVE XLT00010-LOC-NBR TO PV-DISPLAY-LOC-NBR          37461021
374700             DISPLAY '**************************************'     37470000
374800             DISPLAY 'WARNING ISSUED ON SELECT OF XLT_LOC   '     37480000
374900             DISPLAY 'STORE-NMBR: ' PV-DISPLAY-LOC-NBR            37490021
375000             DISPLAY '**************************************'     37500000
375100             PERFORM 9700-SQL-WARNING                             37510000
375200                                                                  37520000
375300         WHEN SQLCODE < ZERO                                      37530000
375310             MOVE XLT00010-LOC-NBR TO PV-DISPLAY-LOC-NBR          37531021
375400             DISPLAY '**************************************'     37540000
375500             DISPLAY 'ERROR ISSUED ON SELECT OF XLT_LOC     '     37550000
375600             DISPLAY 'STORE-NMBR: ' PV-DISPLAY-LOC-NBR            37560021
375700             DISPLAY '**************************************'     37570000
375800             PERFORM 9800-SQL-ERROR                               37580000
375900     END-EVALUATE.                                                37590000
376000                                                                  37600000
376100 4700-SET-STATUS-ERROR.                                           37610000
376200     IF PURITM-STATUS-CDE = PC-CA OR                              37620000
376300        PURCHS-STATUS-CDE = PC-CA                                 37630000
376400         MOVE PC-CANCELLED            TO PEMT-MSG (PEMT-INDX)     37640000
376500         MOVE PC-Y                    TO PPEMT-IND (10)           37650000
376600     ELSE                                                         37660000
376700         IF PURITM-STATUS-CDE = PC-CB OR                          37670000
376800            PURCHS-STATUS-CDE = PC-CB                             37680000
376900             MOVE PC-CANCELLED-BAL    TO PEMT-MSG (PEMT-INDX)     37690000
377000             MOVE PC-Y                TO PPEMT-IND (11)           37700000
377100         ELSE                                                     37710000
377200             IF PURITM-STATUS-CDE = PC-CM OR                      37720000
377300                PURCHS-STATUS-CDE = PC-CM                         37730000
377400                 MOVE PC-COMPLETE     TO PEMT-MSG (PEMT-INDX)     37740000
377500                 MOVE PC-Y            TO PPEMT-IND (12)           37750000
377600             END-IF                                               37760000
377700         END-IF                                                   37770000
377800     END-IF.                                                      37780000
377900******************************************************************37790000
378000** SET UP THE FIELDS FOR THE OUTPUT DETAIL RECORD.               *37800000
378100******************************************************************37810000
378200 4800-SET-UP-OUTPUT-DETAIL-REC.                                   37820000
378300     MOVE RC001-PO-NBR              TO PKSLIP-PO-NBR.             37830000
378400     MOVE PC-A                      TO PKSLIP-VER-STAT-CDE.       37840000
378500     MOVE PV-OPER-UNT-ID            TO PKSLIP-OPER-UNT-ID.        37850000
378600     MOVE PC-1                      TO PKSLIP-FCLTY-ID.           37860000
378700     MOVE RC001-PO-NBR              TO PKSLIP-PKSL-NBR.           37870000
378800     MOVE RC001-STORE-NBR            TO PV-STORE-NBR.             37880000
378900     MOVE SPACES TO XLT00010-LOC-TYP-CDE.                         37890000
378901*                                                                 37890121
378902* DMH - 7/15/2021 BEGIN                                           37890221
378903*                                                                 37890321
378910     IF RC001-STORE-NBR = 9999                                    37891021
378920        MOVE PC-0                   TO PKSLIP-STR-DEST-NBR        37892021
378930     ELSE                                                         37893021
379000        PERFORM 4850-CHECK-STORE-FOR-DC                           37900021
379100        IF XLT00010-LOC-TYP-CDE = 'DC'                            37910021
379200            MOVE PC-0               TO PKSLIP-STR-DEST-NBR        37920021
379300        ELSE                                                      37930021
379400            MOVE RC001-STORE-NBR    TO PKSLIP-STR-DEST-NBR        37940021
379500        END-IF                                                    37950021
379510     END-IF.                                                      37951021
379520*                                                                 37952021
379530* DMH - 7/15/2021 END                                             37953021
379540*                                                                 37954021
379600     MOVE PC-0                      TO PKSLIP-REC-SEQ-NBR.        37960000
379700     MOVE PV-SHIPMT-BOL-NBR         TO PKSLIP-BOL-NBR.            37970000
379800     MOVE PV-SHIPMT-PRO-NBR         TO PKSLIP-PRO-NBR.            37980000
379900     MOVE PC-IN                     TO PKSLIP-PKSL-STAT-CDE.      37990000
380000     MOVE PC-CURRENT-PROGRAM-NAME   TO PKSLIP-CRE-UID.            38000000
380100     MOVE PC-ASN                    TO PKSLIP-CRE-SRC-CDE.        38010000
380200     MOVE WS-HOLD-CARTON-CNT-STORE  TO PKSLIP-EXPTED-PKG-QTY.     38020000
380300     MOVE RC001-CARRIER-SCAC-CODE   TO PKSLIP-OWNER-SCAC-ID.      38030000
380400     MOVE WS-HOLD-CONT-NBR          TO PKSLIP-CONTNR-ID.          38040000
380500     MOVE RC001-ASNHDR-NBR          TO PKSLIP-ASN-NBR.            38050000
380600     MOVE PV-DB2-DATE               TO PKSLIP-VEND-SHIP-DTE.      38060000
380700                                                                  38070000
380800     ADD RC001-QTY-ORDERED          TO PV-SUM-QTY-ORDERED.        38080000
380900     ADD RC001-QTY-SHIPPED          TO PV-SUM-QTY-SHIPPED.        38090000
381000     IF RC001-QTY-SHIPPED = ZERO                                  38100000
381100         SET PS-BYPASS-UPDATES     TO TRUE                        38110000
381200     END-IF.                                                      38120000
381300     SET PS-VALID-STORE TO TRUE.                                  38130000
381400     PERFORM 4695-CHECK-FOR-VALID-STORE.                          38140000
381500     IF PS-INVALID-STORE                                          38150000
381600         SET PS-BYPASS-UPDATES     TO TRUE                        38160000
381700     END-IF.                                                      38170000
381800                                                                  38180000
381900******************************************************************38190000
382000* CHECK IF STORE IS A DC                                          38200000
382100******************************************************************38210000
382200 4850-CHECK-STORE-FOR-DC.                                         38220000
382300     MOVE '4850-CHECK-STORE-FOR-DC'                               38230000
382400                                 TO PV-ABEND-PARAGRAPH.           38240000
382500                                                                  38250000
382600     EXEC SQL                                                     38260000
382700         SELECT LOC_TYP_CDE                                       38270000
382800           INTO :XLT00010-LOC-TYP-CDE                             38280000
382900           FROM XLT_LOC                                           38290000
383000          WHERE LOC_NBR = :PV-STORE-NBR                           38300000
383100     END-EXEC.                                                    38310000
383200     EVALUATE TRUE                                                38320000
383300       WHEN SQLCODE = ZEROS                                       38330000
383400       WHEN SQLCODE = +100                                        38340000
383500         CONTINUE                                                 38350000
383600       WHEN OTHER                                                 38360000
383700         DISPLAY PV-ABEND-PARAGRAPH                               38370000
383800         PERFORM 9100-SQL-ABEND                                   38380000
383900     END-EVALUATE.                                                38390000
384000                                                                  38400000
384100 4900-SET-UP-OUTPUT-PKITEM-REC.                                   38410000
384200     MOVE RC001-PO-NBR              TO PKITEM-PO-NBR              38420000
384300                                       PV-SAVE-PKITEM-PO-NBR.     38430000
384400     MOVE RC001-PO-LINE-NBR         TO PV-PO-LINE-NBR-X.          38440000
384500     MOVE PV-PO-LINE-NBR            TO PKITEM-PKSL-LNE-NBR.       38450000
384600     MOVE PC-A                      TO PKITEM-VER-STAT-CDE.       38460000
384700     MOVE RC001-QTY-SHIPPED         TO PKITEM-PKSL-ITM-QTY.       38470000
384800     MOVE PC-CURRENT-PROGRAM-NAME   TO PKITEM-CRE-UID.            38480000
384900     MOVE PC-1                      TO PKITEM-PURITM-VER-NBR.     38490000
385000     PERFORM 7300-SELECT-TPURITM-DATA.                            38500000
385100     MOVE PURITM-VER-NBR            TO PKITEM-PURITM-VER-NBR.     38510000
385200     MOVE PKITEM-SEQ-NBR            TO PV-SAVE-SEQ-NBR.           38520000
385300                                                                  38530000
385400 5000-CALCULATE-OTR.                                              38540000
385500     SET PS-DISTRO-EXISTS TO TRUE.                                38550000
385600     PERFORM 5100-GET-TALLPLN-RECORD.                             38560000
385700     PERFORM 5200-GET-TMESTDS-RECORD.                             38570000
385800     IF ALLPLN-CURR-SPLIT-QTY = PV-SUM-STR-PLAN-QTY               38580000
385900         SET PS-MASTER-PLAN   TO TRUE                             38590000
386000     ELSE                                                         38600000
386100         SET PS-SPECIFIC-PLAN TO TRUE                             38610000
386200     END-IF.                                                      38620000
386210*                                                                 38621022
386220* DMH - 7/15/2021 BEGIN                                           38622022
386230*                                                                 38623022
386300     IF  RC001-STORE-NBR NOT = RC001-DIST-CNTR                    38630021
386310     AND RC001-STORE-NBR NOT = 9999                               38631021
386320*                                                                 38632022
386330* DMH - 7/15/2021 END                                             38633022
386340*                                                                 38634022
386400         MOVE RC001-STORE-NBR           TO DK-STR-NBR             38640000
386500         PERFORM 5300-CHECK-FOR-ALLOC-PLAN                        38650000
386600         IF PS-NO-DISTRO-EXISTS                                   38660000
386700             MOVE ZERO TO PV-OTR                                  38670000
386800         ELSE                                                     38680000
386900             IF PS-SPECIFIC-PLAN                                  38690000
387000                 MOVE MESTDS-STR-DISTRO-QTY TO PV-OTR             38700000
387100             ELSE                                                 38710000
387200                 PERFORM 5400-GET-PRIOR-RECEIPTS                  38720000
387300                                                                  38730000
387400                 COMPUTE PV-OTR =                                 38740000
387500                     MESTDS-STR-DISTRO-QTY -  PV-STR-REC-QTY      38750000
387600             END-IF                                               38760000
387700         END-IF                                                   38770000
387800     ELSE                                                         38780000
387900         PERFORM 5010-CALC-DC-OTR                                 38790000
388000     END-IF.                                                      38800000
388100     IF DK-ORD-LNE-NBR < 8000                                     38810000
388200       PERFORM 6200-SELECT-TPURITM-QTY                            38820000
388300     ELSE                                                         38830000
388400       MOVE ZEROES TO PURITM-UNT-QTY                              38840000
388500     END-IF                                                       38850000
388600                                                                  38860000
388700     PERFORM 6300-GET-PRIOR-RECEIPTS-ALL.                         38870000
388800     COMPUTE PV-OTR-ALL =                                         38880000
388900             PURITM-UNT-QTY - PV-STR-REC-QTY.                     38890000
389000                                                                  38900000
389100 5010-CALC-DC-OTR.                                                38910000
389200     PERFORM 5020-SUM-VERIFIED-UNITS.                             38920000
389300     PERFORM 5030-SUM-IP-CM-UNITS.                                38930000
389400                                                                  38940000
389500     COMPUTE PV-OTR =                                             38950000
389600       (ALLPLN-CURR-SPLIT-QTY -                                   38960000
389700                 (PV-SUM-VERIFIED-QTY + PV-SUM-ITM-QTY)).         38970000
389800                                                                  38980000
389900 5020-SUM-VERIFIED-UNITS.                                         38990000
390000     MOVE ZERO  TO  PV-SUM-VERIFIED-QTY.                          39000000
390100                                                                  39010000
390200     EXEC SQL                                                     39020000
390300         SELECT  SUM(AP_VERIFY_ITM_QTY)                           39030000
390400           INTO  :PV-SUM-VERIFIED-QTY :PV-VER-NULL-IND            39040000
390500           FROM TPURITM A,                                        39050000
390600                TRECITM B,                                        39060000
390700                TRECDIS C                                         39070000
390800          WHERE  (A.PO_NBR           =  :DK-PO-NBR                39080000
390900            AND   A.PO_NBR           =  B.ORD_NBR                 39090000
391000            AND   B.ORD_NBR          =  C.ORD_NBR                 39100000
391100            AND   B.REC_SEQ_NBR      =  C.REC_SEQ_NBR             39110000
391200            AND   B.STATUS_CDE       =  :PC-VE                    39120000
391300            AND   B.OPER_UNT_ID      =  :DK-OPER-UNT-ID           39130000
391400            AND   B.OPER_UNT_ID      =  C.OPER_UNT_ID             39140000
391500            AND   A.APP_PO_LNE_NBR   =  :DK-ORD-LNE-NBR           39150000
391600            AND   A.APP_PO_LNE_NBR   =  B.ORD_LNE_NBR             39160000
391700            AND   B.ORD_LNE_NBR      =  C.ORD_LNE_NBR             39170000
391800            AND   A.VER_STATUS_CDE   =  :PC-A                     39180000
391900            AND   B.VER_STATUS_CDE   =  :PC-A)                    39190051
392100     END-EXEC.                                                    39210000
392200                                                                  39220000
392300     EVALUATE TRUE                                                39230000
392400         WHEN SQLWARN0 NOT = SPACES                               39240000
392500         WHEN SQLCODE < +0                                        39250000
392600         WHEN SQLCODE > +0                                        39260000
392700             MOVE '5020-SUM-VERIFIED-UNITS'                       39270000
392800                              TO PV-ABEND-PARAGRAPH               39280000
392900             MOVE 'UNSUCCESSFUL SUM OF TRECDIS'                   39290000
393000                              TO PV-DB2-OPERATION-ATTEMPTED       39300000
393100             PERFORM 9100-SQL-ABEND                               39310000
393200         WHEN SQLCODE = +0                                        39320000
393300             CONTINUE                                             39330000
393400     END-EVALUATE.                                                39340000
393500                                                                  39350000
393600 5030-SUM-IP-CM-UNITS.                                            39360000
393700     MOVE ZERO  TO  PV-SUM-ITM-QTY.                               39370000
393800                                                                  39380000
393900     PERFORM 5040-OPEN-ITM-QTY-CSR.                               39390000
394000     PERFORM 5060-FETCH-ITM-QTY-CSR.                              39400000
394100     PERFORM 5050-SUM-ITM-QTY                                     39410000
394200         UNTIL  PS-END-OF-ITM-QTY-CSR.                            39420000
394300     PERFORM 5070-CLOSE-ITM-QTY-CSR.                              39430000
394400                                                                  39440000
394500 5040-OPEN-ITM-QTY-CSR.                                           39450000
394600     EXEC SQL                                                     39460000
394700         OPEN ITM_QTY_CSR                                         39470000
394800     END-EXEC.                                                    39480000
394900                                                                  39490000
395000     EVALUATE TRUE                                                39500000
395100         WHEN SQLWARN0 NOT = SPACE                                39510000
395200         WHEN SQLCODE < ZERO                                      39520000
395300         WHEN SQLCODE > ZERO                                      39530000
395400             MOVE '5040-OPEN-ITM-QTY-CSR'                         39540000
395500                              TO PV-ABEND-PARAGRAPH               39550000
395600             MOVE 'OPEN THE ITM_QTY_CSR'                          39560000
395700                              TO PV-DB2-OPERATION-ATTEMPTED       39570000
395800             PERFORM 9100-SQL-ABEND                               39580000
395900         WHEN SQLCODE = ZERO                                      39590000
396000             CONTINUE                                             39600000
396100     END-EVALUATE.                                                39610000
396200                                                                  39620000
396300 5050-SUM-ITM-QTY.                                                39630000
396400     IF  RECITM-DTL-CK-ITM-QTY  >  ZERO                           39640000
396500         COMPUTE  PV-SUM-ITM-QTY  =                               39650000
396600             PV-SUM-ITM-QTY  +  RECITM-DTL-CK-ITM-QTY             39660000
396700     ELSE                                                         39670000
396800         COMPUTE  PV-SUM-ITM-QTY  =                               39680000
396900             PV-SUM-ITM-QTY  +  RECITM-PKSL-ITM-QTY               39690000
397000     END-IF.                                                      39700000
397100                                                                  39710000
397200     PERFORM 5060-FETCH-ITM-QTY-CSR.                              39720000
397300                                                                  39730000
397400 5060-FETCH-ITM-QTY-CSR.                                          39740000
397500     INITIALIZE DCLTRECITM.                                       39750000
397600                                                                  39760000
397700     EXEC SQL                                                     39770000
397800         FETCH  ITM_QTY_CSR                                       39780000
397900          INTO  :RECITM-PKSL-ITM-QTY,                             39790000
398000                :RECITM-DTL-CK-ITM-QTY                            39800000
398100     END-EXEC.                                                    39810000
398200                                                                  39820000
398300     EVALUATE TRUE                                                39830000
398400         WHEN SQLCODE = +100                                      39840000
398500             SET PS-END-OF-ITM-QTY-CSR  TO  TRUE                  39850000
398600         WHEN SQLWARN0 NOT = SPACE                                39860000
398700         WHEN SQLCODE < ZERO                                      39870000
398800         WHEN SQLCODE > ZERO                                      39880000
398900             MOVE '5060-FETCH-ITM-QTY-CSR'                        39890000
399000                              TO PV-ABEND-PARAGRAPH               39900000
399100             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 39910000
399200-                 'FROM THE ITM_QTY_CSR'                          39920000
399300                              TO PV-DB2-OPERATION-ATTEMPTED       39930000
399400             PERFORM 9100-SQL-ABEND                               39940000
399500         WHEN SQLCODE = ZERO                                      39950000
399600             CONTINUE                                             39960000
399700     END-EVALUATE.                                                39970000
399800                                                                  39980000
399900 5070-CLOSE-ITM-QTY-CSR.                                          39990000
400000     EXEC SQL                                                     40000000
400100         CLOSE ITM_QTY_CSR                                        40010000
400200     END-EXEC.                                                    40020000
400300                                                                  40030000
400400     EVALUATE TRUE                                                40040000
400500         WHEN SQLWARN0 NOT = SPACE                                40050000
400600         WHEN SQLCODE < ZERO                                      40060000
400700         WHEN SQLCODE > ZERO                                      40070000
400800             MOVE '5070-CLOSE-ITM-QTY-CSR'                        40080000
400900                              TO PV-ABEND-PARAGRAPH               40090000
401000             MOVE 'CLOSE THE ITM_QTY_CSR'                         40100000
401100                              TO PV-DB2-OPERATION-ATTEMPTED       40110000
401200             PERFORM 9100-SQL-ABEND                               40120000
401300         WHEN SQLCODE = ZERO                                      40130000
401400             CONTINUE                                             40140000
401500     END-EVALUATE.                                                40150000
401600                                                                  40160000
401700                                                                  40170000
401800                                                                  40180000
401900******************************************************************40190000
402000*    THIS PARAGRAPH RETRIEVES THE PLAN NUMBER AND THE             40200000
402100*    CURR-SPLIT-QTY FROM TABLE TALLPLN.                           40210000
402200******************************************************************40220000
402300 5100-GET-TALLPLN-RECORD.                                         40230000
402370                                                                  40237026
402500     PERFORM WITH TEST AFTER                                      40250000
402600         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    40260000
402700         UNTIL   SQLCODE = +0 OR                                  40270000
402800                 SQLCODE = +100 OR                                40280000
402900                 PS-DONE OR                                       40290000
403000                 PV-RETRY-COUNTER > PC-MAX-RETRIES                40300000
403100                                                                  40310000
403200         EXEC SQL                                                 40320000
403300              SELECT PLAN_NBR                                     40330000
403400                   , CURR_SPLIT_QTY                               40340000
403500                INTO :ALLPLN-PLAN-NBR                             40350000
403600                   , :ALLPLN-CURR-SPLIT-QTY                       40360000
403700                FROM TALLPLN                                      40370000
403800               WHERE PO_NBR     = :DK-PO-NBR                      40380000
403900                 AND PO_LNE_NBR = :DK-ORD-LNE-NBR                 40390000
404000                 AND DEST_NBR   = :DK-OPER-UNT-ID                 40400000
404100                 AND STATUS_CDE = :PC-AC                          40410000
404200         END-EXEC                                                 40420000
404300                                                                  40430000
404400         EVALUATE TRUE                                            40440000
404500             WHEN SQLCODE = +0                                    40450000
404600                  CONTINUE                                        40460000
404700                                                                  40470000
404800             WHEN SQLCODE = +100                                  40480000
404900                 MOVE ZERO TO  ALLPLN-CURR-SPLIT-QTY              40490000
405000                 SET PS-NO-DISTRO-EXISTS TO TRUE                  40500000
405100                                                                  40510000
405200             WHEN SQLCODE = -911                                  40520000
405300                  CONTINUE                                        40530000
405400                                                                  40540000
405500             WHEN OTHER                                           40550000
405600                  MOVE '5100-GET-TALLPLN-RECORD'                  40560000
405700                                TO PV-ABEND-PARAGRAPH             40570000
405800                  MOVE 'UNSUCCESSFUL SELECT OF TALLPLN'           40580000
405900                                 TO PV-DB2-OPERATION-ATTEMPTED    40590000
406000                  PERFORM 9100-SQL-ABEND                          40600000
406100         END-EVALUATE                                             40610000
406200     END-PERFORM.                                                 40620000
406300                                                                  40630000
406400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     40640000
406500         SQLCODE NOT = +0                                         40650000
406600          MOVE '5100-GET-TALLPLN-RECORD'                          40660000
406700                                TO PV-ABEND-PARAGRAPH             40670000
406800          MOVE 'MAX RETRY COUNT EXCEEDED'                         40680000
406900                                 TO PV-DB2-OPERATION-ATTEMPTED    40690000
407000          PERFORM 9100-SQL-ABEND                                  40700000
407100     END-IF.                                                      40710000
407200                                                                  40720000
407300                                                                  40730000
407400 5200-GET-TMESTDS-RECORD.                                         40740000
407500******************************************************************40750000
407600*    THIS PARAGRAPH RETRIEVES THE SUM OF ALL THE STORE PLAN       40760000
407700*    QTY FROM TABLE TMESTDS.                                      40770000
407800******************************************************************40780000
407900                                                                  40790000
408000     PERFORM WITH TEST AFTER                                      40800000
408100         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    40810000
408200         UNTIL   SQLCODE = +0 OR                                  40820000
408300                 SQLCODE = -305 OR                                40830000
408400                 PS-DONE OR                                       40840000
408500                 PV-RETRY-COUNTER > PC-MAX-RETRIES                40850000
408600                                                                  40860000
408700         EXEC SQL                                                 40870000
408800              SELECT SUM(STR_DISTRO_QTY)                          40880000
408900                INTO :PV-SUM-STR-PLAN-QTY                         40890000
409000                FROM TMESTDS                                      40900000
409100               WHERE PO_NBR     = :DK-PO-NBR                      40910000
409200                 AND PO_LNE_NBR = :DK-ORD-LNE-NBR                 40920000
409300                 AND PLAN_NBR   = :ALLPLN-PLAN-NBR                40930000
409400         END-EXEC                                                 40940000
409500                                                                  40950000
409600         EVALUATE TRUE                                            40960000
409700             WHEN SQLCODE = +0                                    40970000
409800                  IF PV-SUM-STR-PLAN-QTY < 0                      40980000
409900                      MOVE 0 TO PV-SUM-STR-PLAN-QTY               40990000
410000                  END-IF                                          41000000
410100                                                                  41010000
410200             WHEN SQLCODE = -305                                  41020000
410300                  MOVE 0 TO PV-SUM-STR-PLAN-QTY                   41030000
410400                                                                  41040000
410500             WHEN SQLCODE = -911                                  41050000
410600                  CONTINUE                                        41060000
410700                                                                  41070000
410800             WHEN OTHER                                           41080000
410900                  MOVE '5200-GET-TMESTDS-RECORD'                  41090000
411000                                TO PV-ABEND-PARAGRAPH             41100000
411100                  MOVE 'UNSUCCESSFUL SUM OF TMESTDS'              41110000
411200                                 TO PV-DB2-OPERATION-ATTEMPTED    41120000
411300                  PERFORM 9100-SQL-ABEND                          41130000
411400         END-EVALUATE                                             41140000
411500     END-PERFORM.                                                 41150000
411600                                                                  41160000
411700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     41170000
411800         SQLCODE NOT = +0                                         41180000
411900          MOVE '5200-GET-TMESTDS-RECORD'                          41190000
412000                                TO PV-ABEND-PARAGRAPH             41200000
412100          MOVE 'MAX RETRY COUNT EXCEEDED'                         41210000
412200                                 TO PV-DB2-OPERATION-ATTEMPTED    41220000
412300          PERFORM 9100-SQL-ABEND                                  41230000
412400     END-IF.                                                      41240000
412500                                                                  41250000
412600 5300-CHECK-FOR-ALLOC-PLAN.                                       41260000
412700     MOVE '5300-CHECK-FOR-ALLOC-PLAN'                             41270000
412800                                TO PV-ABEND-PARAGRAPH.            41280000
412900     INITIALIZE  DCLTMESTDS.                                      41290000
413000                                                                  41300000
413100     EXEC SQL                                                     41310000
413200         SELECT  B.STR_DISTRO_QTY                                 41320000
413300           INTO  :MESTDS-STR-DISTRO-QTY                           41330000
413400           FROM  TALLPLN A,                                       41340000
413500                 TMESTDS B                                        41350000
413600          WHERE  (A.PO_NBR       =  :DK-PO-NBR                    41360000
413700            AND   A.PO_NBR       =  B.PO_NBR                      41370000
413800            AND   A.PO_LNE_NBR   =  :PURITM-PO-LNE-NBR            41380000
413900            AND   A.PO_LNE_NBR   =  B.PO_LNE_NBR                  41390000
414000            AND   A.PLAN_NBR     =  B.PLAN_NBR                    41400000
414100            AND   B.STR_NBR      =  :DK-STR-NBR                   41410000
414200            AND   A.DEST_NBR     =  :DK-OPER-UNT-ID)              41420000
414300     END-EXEC.                                                    41430000
414400                                                                  41440000
414500     EVALUATE TRUE                                                41450000
414600         WHEN SQLCODE = +100                                      41460000
414700             CONTINUE                                             41470000
414800         WHEN SQLWARN0 NOT = SPACES                               41480000
414900         WHEN SQLCODE < +0                                        41490000
415000         WHEN SQLCODE > +0                                        41500000
415100             MOVE 'UNSUCCESSFUL SELECT OF TALLPLN'                41510000
415200                                 TO PV-DB2-OPERATION-ATTEMPTED    41520000
415300             PERFORM 9100-SQL-ABEND                               41530000
415400         WHEN SQLCODE = +0                                        41540000
415500             CONTINUE                                             41550000
415600     END-EVALUATE.                                                41560000
415700                                                                  41570000
415800 5400-GET-PRIOR-RECEIPTS.                                         41580000
415900******************************************************************41590000
416000                                                                  41600000
416100     SET PS-TRECITM-RECS TO TRUE.                                 41610000
416200     MOVE 0 TO PV-STR-REC-QTY.                                    41620000
416300     PERFORM 5500-GET-TMST.                                       41630000
416400     IF PS-NO-TRECITM-RECS                                        41640000
416500         CONTINUE                                                 41650000
416600     ELSE                                                         41660000
416700         SET PS-MORE-RECEIPT TO TRUE                              41670000
416800                                                                  41680000
416900         PERFORM 5600-OPEN-REDISTRO-CSR                           41690000
417000                                                                  41700000
417100         IF PS-NOT-DONE                                           41710000
417200             PERFORM 5700-FETCH-REDISTRO-CSR                      41720000
417300         END-IF                                                   41730000
417400                                                                  41740000
417500         PERFORM 5900-PROCESS-RECEIPT                             41750000
417600           UNTIL PS-NO-MORE-RECEIPT OR PS-DONE                    41760000
417700                                                                  41770000
417800         PERFORM 5800-CLOSE-REDISTRO-CSR                          41780000
417900     END-IF.                                                      41790000
418000                                                                  41800000
418100 5500-GET-TMST.                                                   41810000
418200******************************************************************41820000
418300                                                                  41830000
418400     PERFORM WITH TEST AFTER                                      41840000
418500         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    41850000
418600         UNTIL   SQLCODE = +0 OR                                  41860000
418700                 SQLCODE = +100 OR                                41870000
418800                 PS-DONE OR                                       41880000
418900                 PV-RETRY-COUNTER > PC-MAX-RETRIES                41890000
419000                                                                  41900000
419100         EXEC SQL                                                 41910000
419200              SELECT CRE_TMST                                     41920000
419300                INTO :RECITM-CRE-TMST :PV-NULL-IND                41930000
419400                FROM TRECITM                                      41940000
419500               WHERE ORD_NBR        = :DK-PO-NBR                  41950000
419600                 AND ORD_LNE_NBR    = :DK-ORD-LNE-NBR             41960000
419700                 AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR            41970000
419800                 AND OPER_UNT_ID    = :DK-OPER-UNT-ID             41980000
419900         END-EXEC                                                 41990000
420000                                                                  42000000
420100         EVALUATE TRUE                                            42010000
420200             WHEN SQLCODE = +0                                    42020000
420300                  IF PV-NULL-IND = -1                             42030000
420400                      SET PS-NO-TRECITM-RECS TO TRUE              42040000
420500                  END-IF                                          42050000
420600                  CONTINUE                                        42060000
420700                                                                  42070000
420800             WHEN SQLCODE = +100                                  42080000
420900                  SET PS-NO-TRECITM-RECS TO TRUE                  42090000
421000                                                                  42100000
421100             WHEN SQLCODE = -911                                  42110000
421200                  CONTINUE                                        42120000
421300                                                                  42130000
421400             WHEN OTHER                                           42140000
421500                  MOVE '5500-GET-MIN-TMST'                        42150000
421600                                TO PV-ABEND-PARAGRAPH             42160000
421700                  MOVE 'UNSUCCESSFUL SUM OF TMESTDS'              42170000
421800                                 TO PV-DB2-OPERATION-ATTEMPTED    42180000
421900                  PERFORM 9100-SQL-ABEND                          42190000
422000         END-EVALUATE                                             42200000
422100     END-PERFORM.                                                 42210000
422200                                                                  42220000
422300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     42230000
422400         SQLCODE NOT = +0 AND                                     42240000
422500         SQLCODE NOT = +100                                       42250000
422600         MOVE '5500-GET-MIN-TMST'                                 42260000
422700                                TO PV-ABEND-PARAGRAPH             42270000
422800          MOVE 'MAX RETRY COUNT EXCEEDED'                         42280000
422900                                 TO PV-DB2-OPERATION-ATTEMPTED    42290000
423000          PERFORM 9100-SQL-ABEND                                  42300000
423100     END-IF.                                                      42310000
423200                                                                  42320000
423300                                                                  42330000
423400                                                                  42340000
423500 5600-OPEN-REDISTRO-CSR.                                          42350000
423600******************************************************************42360000
423700                                                                  42370000
423800     EXEC SQL                                                     42380000
423900          OPEN REDISTRO-CSR                                       42390000
424000     END-EXEC.                                                    42400000
424100                                                                  42410000
424200     IF SQLCODE NOT = +0                                          42420000
424300          MOVE '5600-OPEN-REDISTRO-CSR'                           42430000
424400                                TO PV-ABEND-PARAGRAPH             42440000
424500          MOVE 'UNSUCCESSFUL OPEN OF REDISTRO CURSOR'             42450000
424600                                 TO PV-DB2-OPERATION-ATTEMPTED    42460000
424700          PERFORM 9100-SQL-ABEND                                  42470000
424800     END-IF.                                                      42480000
424900                                                                  42490000
425000                                                                  42500000
425100 5700-FETCH-REDISTRO-CSR.                                         42510000
425200******************************************************************42520000
425300                                                                  42530000
425400     EXEC SQL                                                     42540000
425500          FETCH REDISTRO-CSR                                      42550000
425600           INTO :RECITM-REC-SEQ-NBR                               42560000
425700     END-EXEC.                                                    42570000
425800                                                                  42580000
425900     EVALUATE TRUE                                                42590000
426000         WHEN SQLCODE = +0                                        42600000
426100              CONTINUE                                            42610000
426200                                                                  42620000
426300         WHEN SQLCODE = +100                                      42630000
426400              SET PS-NO-MORE-RECEIPT TO TRUE                      42640000
426500                                                                  42650000
426600         WHEN OTHER                                               42660000
426700             MOVE '5700-FETCH-REDISTRO-CSR'                       42670000
426800                                TO PV-ABEND-PARAGRAPH             42680000
426900             MOVE 'UNSUCCESSFUL FETCH OF REDISTRO CURSOR'         42690000
427000                                 TO PV-DB2-OPERATION-ATTEMPTED    42700000
427100             PERFORM 9100-SQL-ABEND                               42710000
427200     END-EVALUATE.                                                42720000
427300                                                                  42730000
427400                                                                  42740000
427500 5800-CLOSE-REDISTRO-CSR.                                         42750000
427600******************************************************************42760000
427700                                                                  42770000
427800     EXEC SQL                                                     42780000
427900          CLOSE REDISTRO-CSR                                      42790000
428000     END-EXEC.                                                    42800000
428100                                                                  42810000
428200     IF SQLCODE NOT = +0                                          42820000
428300          MOVE '5800-CLOSE-REDISTRO-CSR'                          42830000
428400                                TO PV-ABEND-PARAGRAPH             42840000
428500          MOVE 'UNSUCCESSFUL CLOSE OF REDISTRO CURSOR'            42850000
428600                                 TO PV-DB2-OPERATION-ATTEMPTED    42860000
428700             PERFORM 9100-SQL-ABEND                               42870000
428800     END-IF.                                                      42880000
428900                                                                  42890000
429000                                                                  42900000
429100                                                                  42910000
429200 5900-PROCESS-RECEIPT.                                            42920000
429300******************************************************************42930000
429400*    THIS PARAGRAPH GETS A RECDIS RECORD FOR EVERY RECITM RECORD. 42940000
429500******************************************************************42950000
429600                                                                  42960000
429700     PERFORM 6000-GET-STATUS-CDE.                                 42970000
429800                                                                  42980000
429900     IF SQLCODE = +100                                            42990000
430000         NEXT SENTENCE                                            43000000
430100     ELSE                                                         43010000
430200         MOVE 1 TO PV-SUB-1                                       43020000
430300                                                                  43030000
430400         PERFORM 6100-GET-RECDIS-RECORD.                          43040000
430500                                                                  43050000
430600     PERFORM 5700-FETCH-REDISTRO-CSR.                             43060000
430700                                                                  43070000
430800 6000-GET-STATUS-CDE.                                             43080000
430900******************************************************************43090000
431000                                                                  43100000
431100     PERFORM WITH TEST AFTER                                      43110000
431200         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    43120000
431300         UNTIL   SQLCODE = +0 OR                                  43130000
431400                 SQLCODE = +100 OR                                43140000
431500                 PS-DONE OR                                       43150000
431600                 PV-RETRY-COUNTER > PC-MAX-RETRIES                43160000
431700                                                                  43170000
431800         EXEC SQL                                                 43180000
431900              SELECT STATUS_CDE                                   43190000
432000                INTO :RECITM-STATUS-CDE                           43200000
432100                FROM TRECITM                                      43210000
432200               WHERE ORD_NBR        = :DK-PO-NBR                  43220000
432300                 AND ORD_LNE_NBR    = :DK-ORD-LNE-NBR             43230000
432400                 AND REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR         43240000
432500                 AND OPER_UNT_ID    = :DK-OPER-UNT-ID             43250000
432600                 AND VER_STATUS_CDE = :PC-A                       43260000
432700                 AND STATUS_CDE    IN (:PC-IP, :PC-CM, :PC-VE)    43270000
432800         END-EXEC                                                 43280000
432900                                                                  43290000
433000         EVALUATE TRUE                                            43300000
433100             WHEN SQLCODE = +0                                    43310000
433200             WHEN SQLCODE = +100                                  43320000
433300                  CONTINUE                                        43330000
433400                                                                  43340000
433500             WHEN SQLCODE = -911                                  43350000
433600                  CONTINUE                                        43360000
433700                                                                  43370000
433800             WHEN OTHER                                           43380000
433900                 MOVE '6000-GET-STATUS-CDE'                       43390000
434000                                TO PV-ABEND-PARAGRAPH             43400000
434100                 MOVE 'UNSUCCESSFUL SELECT OF TRECITM'            43410000
434200                                 TO PV-DB2-OPERATION-ATTEMPTED    43420000
434300                 PERFORM 9100-SQL-ABEND                           43430000
434400         END-EVALUATE                                             43440000
434500     END-PERFORM.                                                 43450000
434600                                                                  43460000
434700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     43470000
434800         SQLCODE NOT = +0                                         43480000
434900          MOVE '6000-GET-STATUS-CDE'                              43490000
435000                                TO PV-ABEND-PARAGRAPH             43500000
435100          MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                  43510000
435200                                 TO PV-DB2-OPERATION-ATTEMPTED    43520000
435300          PERFORM 9100-SQL-ABEND                                  43530000
435400     END-IF.                                                      43540000
435500                                                                  43550000
435600                                                                  43560000
435700 6100-GET-RECDIS-RECORD.                                          43570000
435800******************************************************************43580000
435900*    THIS PARAGRAPH RETRIEVES THE RECDIS RECORD FOR A GIVEN STORE.43590000
436000*    IT THEN ADDS INTO THE STORE ARRAY THE CORRECT STORE RECEIPTS 43600000
436100*    DEPENDING UPON THE STATUS CODE OF THE RECITM.  AND FINALLY,  43610000
436200*    IT ACCUMULATES THESE RECEIPTS INTO PV-SUM-STR-REC-QTY.       43620000
436300******************************************************************43630000
436400                                                                  43640000
436500                                                                  43650000
436600     PERFORM WITH TEST AFTER                                      43660000
436700         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    43670000
436800         UNTIL   SQLCODE = +0 OR                                  43680000
436900                 SQLCODE = +100 OR                                43690000
437000                 PS-DONE OR                                       43700000
437100                 PV-RETRY-COUNTER > PC-MAX-RETRIES                43710000
437200                                                                  43720000
437300         EXEC SQL                                                 43730000
437400              SELECT EXPTED_ITM_QTY                               43740000
437500                   , AP_VERIFY_ITM_QTY                            43750000
437600                INTO :RECDIS-EXPTED-ITM-QTY                       43760000
437700                   , :RECDIS-AP-VERIFY-ITM-QTY                    43770000
437800                FROM TRECDIS                                      43780000
437900               WHERE ORD_NBR        = :DK-PO-NBR                  43790000
438000                 AND ORD_LNE_NBR    = :DK-ORD-LNE-NBR             43800000
438100                 AND REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR         43810000
438200                 AND OPER_UNT_ID    = :DK-OPER-UNT-ID             43820000
438400                 AND STR_NBR        = :DK-STR-NBR                 43840000
438500                 AND STR_FCLTY_ID   = 1                           43850000
438600         END-EXEC                                                 43860000
438700                                                                  43870000
438800         EVALUATE TRUE                                            43880000
438900             WHEN SQLCODE = +0                                    43890000
439000                  IF RECITM-STATUS-CDE = PC-VE                    43900000
439100                      ADD RECDIS-AP-VERIFY-ITM-QTY                43910000
439200                       TO PV-STR-REC-QTY                          43920000
439300                  ELSE                                            43930000
439400                      ADD RECDIS-EXPTED-ITM-QTY                   43940000
439500                       TO PV-STR-REC-QTY                          43950000
439600                  END-IF                                          43960000
439700                                                                  43970000
439800             WHEN SQLCODE = +100                                  43980000
439900                  CONTINUE                                        43990000
440000                                                                  44000000
440100             WHEN SQLCODE = -911                                  44010000
440200                  CONTINUE                                        44020000
440300                                                                  44030000
440400             WHEN OTHER                                           44040000
440500                 MOVE '6100-GET-RECDIS-RECORD'                    44050000
440600                                TO PV-ABEND-PARAGRAPH             44060000
440700                 MOVE 'UNSUCCESSFUL SELECT OF TRECITM'            44070000
440800                                 TO PV-DB2-OPERATION-ATTEMPTED    44080000
440900                 PERFORM 9100-SQL-ABEND                           44090000
441000         END-EVALUATE                                             44100000
441100     END-PERFORM.                                                 44110000
441200                                                                  44120000
441300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     44130000
441400         SQLCODE NOT = +0                                         44140000
441500          MOVE '6100-GET-RECDIS-RECORD'                           44150000
441600                                TO PV-ABEND-PARAGRAPH             44160000
441700          MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                  44170000
441800                                 TO PV-DB2-OPERATION-ATTEMPTED    44180000
441900          PERFORM 9100-SQL-ABEND                                  44190000
442000     END-IF.                                                      44200000
442100                                                                  44210000
442200     ADD 1 TO PV-SUB-1.                                           44220000
442300                                                                  44230000
442400 6200-SELECT-TPURITM-QTY.                                         44240000
442500     MOVE '6200-SELECT-TPURITM-QTY'  TO PV-ABEND-PARAGRAPH.       44250000
442600                                                                  44260000
442700     PERFORM WITH TEST AFTER                                      44270000
442800         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    44280000
442900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             44290000
443000                 SQLCODE = ZERO OR                                44300000
443100                 SQLCODE = +100 OR                                44310000
443200                 SQLCODE = -811                                   44320000
443300                                                                  44330000
443400         EXEC SQL                                                 44340000
443500               SELECT UNT_QTY                                     44350000
443600                 INTO :PURITM-UNT-QTY                             44360000
443700                 FROM TPURITM                                     44370000
443800                WHERE PO_NBR         = :DK-PO-NBR                 44380000
443900                  AND APP_PO_LNE_NBR = :PKITEM-PKSL-LNE-NBR       44390000
444000                  AND VER_STATUS_CDE = :PC-A                      44400000
444100         END-EXEC                                                 44410000
444200                                                                  44420000
444300         EVALUATE TRUE                                            44430000
444400             WHEN SQLCODE = ZERO                                  44440000
444500                  CONTINUE                                        44450000
444600                                                                  44460000
444700             WHEN SQLCODE = +100                                  44470000
444800                  MOVE ZEROES TO PURITM-UNT-QTY                   44480000
444900                                                                  44490000
445000             WHEN SQLCODE = -811                                  44500000
445100             WHEN SQLCODE = -911                                  44510000
445200                  CONTINUE                                        44520000
445300                                                                  44530000
445400             WHEN SQLWARN0 NOT = SPACES                           44540000
445500             WHEN SQLCODE  NOT = ZERO                             44550000
445600                  MOVE 'UNSUCCESSFUL SELECT OF TPURITM DATA'      44560000
445700                                 TO PV-DB2-OPERATION-ATTEMPTED    44570000
445800                  PERFORM 9100-SQL-ABEND                          44580000
445900         END-EVALUATE                                             44590000
446000     END-PERFORM.                                                 44600000
446100                                                                  44610000
446200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     44620000
446300         SQLCODE NOT = +0                                         44630000
446400         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO STATUS'          44640000
446500                                 TO PV-DB2-OPERATION-ATTEMPTED    44650000
446600         PERFORM 9100-SQL-ABEND                                   44660000
446700     END-IF.                                                      44670000
446800                                                                  44680000
446900 6300-GET-PRIOR-RECEIPTS-ALL.                                     44690000
447000******************************************************************44700000
447100                                                                  44710000
447200     SET PS-TRECITM-RECS TO TRUE.                                 44720000
447300     MOVE 0 TO PV-STR-REC-QTY.                                    44730000
447400     PERFORM 6400-GET-TMST.                                       44740000
447500                                                                  44750000
447600     IF PS-NO-TRECITM-RECS                                        44760000
447700         CONTINUE                                                 44770000
447800     ELSE                                                         44780000
447900         SET PS-MORE-RECEIPT                                      44790000
448000             PS-NOT-DONE     TO TRUE                              44800000
448100                                                                  44810000
448200         PERFORM 6500-OPEN-REDISTRO-ALL-CSR                       44820000
448300                                                                  44830000
448400         IF PS-NOT-DONE                                           44840000
448500             PERFORM 6600-FETCH-REDISTRO-CSR                      44850000
448600         END-IF                                                   44860000
448700                                                                  44870000
448800         PERFORM 6800-PROCESS-RECEIPT-ALL                         44880000
448900           UNTIL PS-NO-MORE-RECEIPT OR PS-DONE                    44890000
449000                                                                  44900000
449100         PERFORM 6700-CLOSE-REDISTRO-ALL-CSR                      44910000
449200     END-IF.                                                      44920000
449300                                                                  44930000
449400 6400-GET-TMST.                                                   44940000
449500******************************************************************44950000
449600                                                                  44960000
449700     PERFORM WITH TEST AFTER                                      44970000
449800         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    44980000
449900         UNTIL   SQLCODE = +0 OR                                  44990000
450000                 SQLCODE = +100 OR                                45000000
450100                 PS-DONE OR                                       45010000
450200                 PV-RETRY-COUNTER > PC-MAX-RETRIES                45020000
450300                                                                  45030000
450400         EXEC SQL                                                 45040000
450500              SELECT CRE_TMST                                     45050000
450600                INTO :RECITM-CRE-TMST :PV-NULL-IND                45060000
450700                FROM TRECITM                                      45070000
450800               WHERE ORD_NBR        = :DK-PO-NBR                  45080000
450900                 AND ORD_LNE_NBR    = :DK-ORD-LNE-NBR             45090000
451000                 AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR            45100000
451100         END-EXEC                                                 45110000
451200                                                                  45120000
451300         EVALUATE TRUE                                            45130000
451400             WHEN SQLCODE = +0                                    45140000
451500                  IF PV-NULL-IND = -1                             45150000
451600                      SET PS-NO-TRECITM-RECS TO TRUE              45160000
451700                  END-IF                                          45170000
451800                  CONTINUE                                        45180000
451900                                                                  45190000
452000             WHEN SQLCODE = +100                                  45200000
452100                  SET PS-NO-TRECITM-RECS TO TRUE                  45210000
452200                                                                  45220000
452300             WHEN SQLCODE = -911                                  45230000
452400                  CONTINUE                                        45240000
452500                                                                  45250000
452600             WHEN OTHER                                           45260000
452700                  MOVE '6400-GET-MIN-TMST'                        45270000
452800                                TO PV-ABEND-PARAGRAPH             45280000
452900                  MOVE 'UNSUCCESSFUL SUM OF TMESTDS'              45290000
453000                                 TO PV-DB2-OPERATION-ATTEMPTED    45300000
453100                  PERFORM 9100-SQL-ABEND                          45310000
453200         END-EVALUATE                                             45320000
453300     END-PERFORM.                                                 45330000
453400                                                                  45340000
453500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     45350000
453600         SQLCODE NOT = +0 AND                                     45360000
453700         SQLCODE NOT = +100                                       45370000
453800         MOVE '6400-GET-MIN-TMST'                                 45380000
453900                                TO PV-ABEND-PARAGRAPH             45390000
454000          MOVE 'MAX RETRY COUNT EXCEEDED'                         45400000
454100                                 TO PV-DB2-OPERATION-ATTEMPTED    45410000
454200          PERFORM 9100-SQL-ABEND                                  45420000
454300     END-IF.                                                      45430000
454400                                                                  45440000
454500                                                                  45450000
454600                                                                  45460000
454700 6500-OPEN-REDISTRO-ALL-CSR.                                      45470000
454800******************************************************************45480000
454900                                                                  45490000
455000     EXEC SQL                                                     45500000
455100          OPEN REDISTRO-ALL-CSR                                   45510000
455200     END-EXEC.                                                    45520000
455300                                                                  45530000
455400     IF SQLCODE NOT = +0                                          45540000
455500          MOVE '6500-OPEN-REDISTRO-CSR'                           45550000
455600                                TO PV-ABEND-PARAGRAPH             45560000
455700          MOVE 'UNSUCCESSFUL OPEN OF REDISTRO CURSOR'             45570000
455800                                 TO PV-DB2-OPERATION-ATTEMPTED    45580000
455900          PERFORM 9100-SQL-ABEND                                  45590000
456000     END-IF.                                                      45600000
456100                                                                  45610000
456200                                                                  45620000
456300 6600-FETCH-REDISTRO-CSR.                                         45630000
456400******************************************************************45640000
456500                                                                  45650000
456600     EXEC SQL                                                     45660000
456700          FETCH REDISTRO-ALL-CSR                                  45670000
456800           INTO :RECITM-REC-SEQ-NBR                               45680000
456900     END-EXEC.                                                    45690000
457000                                                                  45700000
457100     EVALUATE TRUE                                                45710000
457200         WHEN SQLCODE = +0                                        45720000
457300              CONTINUE                                            45730000
457400                                                                  45740000
457500         WHEN SQLCODE = +100                                      45750000
457600              SET PS-NO-MORE-RECEIPT TO TRUE                      45760000
457700                                                                  45770000
457800         WHEN OTHER                                               45780000
457900             MOVE '6600-FETCH-REDISTRO-CSR'                       45790000
458000                                TO PV-ABEND-PARAGRAPH             45800000
458100             MOVE 'UNSUCCESSFUL FETCH OF REDISTRO CURSOR'         45810000
458200                                 TO PV-DB2-OPERATION-ATTEMPTED    45820000
458300             PERFORM 9100-SQL-ABEND                               45830000
458400     END-EVALUATE.                                                45840000
458500                                                                  45850000
458600                                                                  45860000
458700 6700-CLOSE-REDISTRO-ALL-CSR.                                     45870000
458800******************************************************************45880000
458900                                                                  45890000
459000     EXEC SQL                                                     45900000
459100          CLOSE REDISTRO-ALL-CSR                                  45910000
459200     END-EXEC.                                                    45920000
459300                                                                  45930000
459400     IF SQLCODE NOT = +0                                          45940000
459500          MOVE '6700-CLOSE-REDISTRO-CSR'                          45950000
459600                                TO PV-ABEND-PARAGRAPH             45960000
459700          MOVE 'UNSUCCESSFUL CLOSE OF REDISTRO CURSOR'            45970000
459800                                 TO PV-DB2-OPERATION-ATTEMPTED    45980000
459900             PERFORM 9100-SQL-ABEND                               45990000
460000     END-IF.                                                      46000000
460100                                                                  46010000
460200                                                                  46020000
460300                                                                  46030000
460400 6800-PROCESS-RECEIPT-ALL.                                        46040000
460500******************************************************************46050000
460600*    THIS PARAGRAPH GETS A RECDIS RECORD FOR EVERY RECITM RECORD. 46060000
460700******************************************************************46070000
460800                                                                  46080000
460900     PERFORM 6900-GET-STATUS-CDE.                                 46090000
461000                                                                  46100000
461100     IF SQLCODE = +100                                            46110000
461200         NEXT SENTENCE                                            46120000
461300     ELSE                                                         46130000
461400         MOVE 1 TO PV-SUB-1                                       46140000
461500                                                                  46150000
461600         PERFORM 6950-GET-RECDIS-RECORD.                          46160000
461700                                                                  46170000
461800     PERFORM 6600-FETCH-REDISTRO-CSR.                             46180000
461900                                                                  46190000
462000 6900-GET-STATUS-CDE.                                             46200000
462100******************************************************************46210000
462200                                                                  46220000
462300     PERFORM WITH TEST AFTER                                      46230000
462400         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    46240000
462500         UNTIL   SQLCODE = +0 OR                                  46250000
462600                 SQLCODE = +100 OR                                46260000
462700                 PS-DONE OR                                       46270000
462800                 PV-RETRY-COUNTER > PC-MAX-RETRIES                46280000
462900                                                                  46290000
463000         EXEC SQL                                                 46300000
463100              SELECT STATUS_CDE                                   46310000
463200                INTO :RECITM-STATUS-CDE                           46320000
463300                FROM TRECITM                                      46330000
463400               WHERE ORD_NBR        = :DK-PO-NBR                  46340000
463500                 AND ORD_LNE_NBR    = :DK-ORD-LNE-NBR             46350000
463600                 AND REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR         46360000
463700                 AND VER_STATUS_CDE = :PC-A                       46370000
463800                 AND STATUS_CDE    IN (:PC-IP, :PC-CM, :PC-VE)    46380000
463900         END-EXEC                                                 46390000
464000                                                                  46400000
464100         EVALUATE TRUE                                            46410000
464200             WHEN SQLCODE = +0                                    46420000
464300             WHEN SQLCODE = +100                                  46430000
464400                  CONTINUE                                        46440000
464500                                                                  46450000
464600             WHEN SQLCODE = -911                                  46460000
464700                  CONTINUE                                        46470000
464800                                                                  46480000
464900             WHEN OTHER                                           46490000
465000                 MOVE '6900-GET-STATUS-CDE'                       46500000
465100                                TO PV-ABEND-PARAGRAPH             46510000
465200                 MOVE 'UNSUCCESSFUL SELECT OF TRECITM'            46520000
465300                                 TO PV-DB2-OPERATION-ATTEMPTED    46530000
465400                 PERFORM 9100-SQL-ABEND                           46540000
465500         END-EVALUATE                                             46550000
465600     END-PERFORM.                                                 46560000
465700                                                                  46570000
465800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     46580000
465900         SQLCODE NOT = +0                                         46590000
466000          MOVE '6900-GET-STATUS-CDE'                              46600000
466100                                TO PV-ABEND-PARAGRAPH             46610000
466200          MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                  46620000
466300                                 TO PV-DB2-OPERATION-ATTEMPTED    46630000
466400          PERFORM 9100-SQL-ABEND                                  46640000
466500     END-IF.                                                      46650000
466600                                                                  46660000
466700                                                                  46670000
466800 6950-GET-RECDIS-RECORD.                                          46680000
466900******************************************************************46690000
467000*    THIS PARAGRAPH RETRIEVES THE RECDIS RECORD FOR A GIVEN STORE.46700000
467100*    IT THEN ADDS INTO THE STORE ARRAY THE CORRECT STORE RECEIPTS 46710000
467200*    DEPENDING UPON THE STATUS CODE OF THE RECITM.  AND FINALLY,  46720000
467300*    IT ACCUMULATES THESE RECEIPTS INTO PV-SUM-STR-REC-QTY.       46730000
467400******************************************************************46740000
467500                                                                  46750000
467600                                                                  46760000
467700     PERFORM WITH TEST AFTER                                      46770000
467800         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    46780000
467900         UNTIL   SQLCODE = +0 OR                                  46790000
468000                 SQLCODE = +100 OR                                46800000
468100                 PS-DONE OR                                       46810000
468200                 PV-RETRY-COUNTER > PC-MAX-RETRIES                46820000
468300                                                                  46830000
468400         EXEC SQL                                                 46840000
468500              SELECT EXPTED_ITM_QTY                               46850000
468600                   , AP_VERIFY_ITM_QTY                            46860000
468700                INTO :RECDIS-EXPTED-ITM-QTY                       46870000
468800                   , :RECDIS-AP-VERIFY-ITM-QTY                    46880000
468900                FROM TRECDIS                                      46890000
469000               WHERE ORD_NBR        = :DK-PO-NBR                  46900000
469100                 AND ORD_LNE_NBR    = :DK-ORD-LNE-NBR             46910000
469200                 AND REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR         46920000
469400                 AND STR_NBR        = :DK-STR-NBR                 46940000
469500                 AND STR_FCLTY_ID   = 1                           46950000
469600         END-EXEC                                                 46960000
469700                                                                  46970000
469800         EVALUATE TRUE                                            46980000
469900             WHEN SQLCODE = +0                                    46990000
470000                  IF RECITM-STATUS-CDE = PC-VE                    47000000
470100                      ADD RECDIS-AP-VERIFY-ITM-QTY                47010000
470200                       TO PV-STR-REC-QTY                          47020000
470300                  ELSE                                            47030000
470400                      ADD RECDIS-EXPTED-ITM-QTY                   47040000
470500                       TO PV-STR-REC-QTY                          47050000
470600                  END-IF                                          47060000
470700                                                                  47070000
470800             WHEN SQLCODE = +100                                  47080000
470900                  CONTINUE                                        47090000
471000                                                                  47100000
471100             WHEN SQLCODE = -911                                  47110000
471200                  CONTINUE                                        47120000
471300                                                                  47130000
471400             WHEN OTHER                                           47140000
471500                 MOVE '6950-GET-RECDIS-RECORD'                    47150000
471600                                TO PV-ABEND-PARAGRAPH             47160000
471700                 MOVE 'UNSUCCESSFUL SELECT OF TRECITM'            47170000
471800                                 TO PV-DB2-OPERATION-ATTEMPTED    47180000
471900                 PERFORM 9100-SQL-ABEND                           47190000
472000         END-EVALUATE                                             47200000
472100     END-PERFORM.                                                 47210000
472200                                                                  47220000
472300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     47230000
472400         SQLCODE NOT = +0                                         47240000
472500          MOVE '6950-GET-RECDIS-RECORD'                           47250000
472600                                TO PV-ABEND-PARAGRAPH             47260000
472700          MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                  47270000
472800                                 TO PV-DB2-OPERATION-ATTEMPTED    47280000
472900          PERFORM 9100-SQL-ABEND                                  47290000
473000     END-IF.                                                      47300000
473100                                                                  47310000
473200     ADD 1 TO PV-SUB-1.                                           47320000
473300 EJECT                                                            47330000
473400******************************************************************47340000
473500*  READ THE ASN EXTRACT RECORDS.                                 *47350000
473600******************************************************************47360000
473700 7000-READ-ASN-EXTRACT.                                           47370000
473800                                                                  47380000
473900     MOVE '7000'                  TO PGM-LOCATION.                47390000
474000     MOVE '7000-READ-ASN-EXTRACT     '                            47400000
474100                                  TO PV-ABEND-PARAGRAPH.          47410000
474200*                                                                 47420000
474300*Z000-BUILD-COMM-AREA-TRAN-PRES.                                  47430000
474400******************************************************************47440000
474500*  THIS MODULE BUILDS THE COMMUNICATION AREA NECESSARY TO INVOKE *47450000
474600*  THE TRANSACTION PRESENTATION MODULE AND SETS PROGRAM CONTROLS *47460000
474700*  BASED ON THE RETURN CODE RETURNED FROM THE PRESENTATION MOD-  *47470000
474800*  ULE.                                                          *47480000
474900******************************************************************47490000
475000     MOVE LENGTH OF RC001-ASN-TRANSCRIPTION-RECORD                47500000
475100                                     TO DP001-WORK-STRG-LENGTH.   47510000
475200     MOVE RC001-ASN-TRANSCRIPTION-RECORD                          47520000
475300                                     TO WORK-STRG-AREA.           47530000
475400     MOVE PV-CKPT-JOB-NAME           TO DP001-JOB-NAME.           47540000
475500     MOVE PC-CKPT-PLAN-NAME          TO DP001-PLAN-NAME.          47550000
475600                                                                  47560000
475700     PERFORM Z900-CALL-TRANS-PRES-MODULE.                         47570000
475800                                                                  47580000
475900     MOVE DP001-TRANS-RECORD  TO RC001-ASN-TRANSCRIPTION-RECORD.  47590000
477400                                                                  47740000
477500     IF DP001-PREP-TRANS-EOF                                      47750000
477600         SET PS-NO-MORE-ASN-RECS TO TRUE                          47760000
477710     ELSE                                                         47771000
477711         PERFORM 7002-RECORD-COUNTS                               47771100
477800     END-IF.                                                      47780000
477900                                                                  47790000
478000                                                                  47800000
478500                                                                  47850000
478501 7002-RECORD-COUNTS.                                              47850100
478510     ADD +1      TO PV-RECS-READ                                  47851000
478520     IF RC001-PO-LINE-NBR-HDR                                     47852000
478530         ADD +1  TO PV-HDR-RECS-READ                              47853000
478540     END-IF                                                       47854000
478550     IF RC001-DETAIL-RECORD                                       47855000
478560         ADD +1  TO PV-DET-RECS-READ                              47856000
478570     END-IF                                                       47857000
478580     IF RC001-CARTON-RECORD                                       47858000
478590         ADD +1  TO PV-CRTN-RECS-READ                             47859000
478591     END-IF.                                                      47859100
478600 EJECT                                                            47860000
478700 7010-PROCESS-SHIPMENT.                                           47870000
478800                                                                  47880000
478900     IF PS-INSERT-VHTRIP OR                                       47890000
479000        PS-ADD-NEXT-VHTRIP                                        47900000
479100         PERFORM WITH TEST AFTER                                  47910000
479200             UNTIL SQLCODE = +100                                 47920000
479300             PERFORM 7020-GET-RANDOM-NUMBER                       47930000
479400             PERFORM 7017-CHECK-IF-TRIP-ID-USED                   47940000
479500         END-PERFORM                                              47950000
479600         MOVE PV-RANDOM-NBR      TO PV-VEHICL-CURR-TRIP-ID        47960000
479700                                    PV-VHTRIP-TRIP-ID             47970000
479800                                    PV-TRIPST-TRIP-ID             47980000
479900                                    PV-SHIPMT-TRIP-ID             47990000
480000     END-IF.                                                      48000000
480100                                                                  48010000
480200                                                                  48020000
480300     IF PS-INSERT-VEHICL                                          48030000
480400         IF PS-INVALID-DC                                         48040000
480500             CONTINUE                                             48050000
480600         ELSE                                                     48060000
480700             PERFORM 7995-INSERT-VEHICL                           48070000
480800             PERFORM 7960-SELECT-VEHICL                           48080000
480900             IF SQLCODE = +0                                      48090000
481000                 PERFORM 7996-CREATE-VEH-AUDIT-TRAIL              48100000
481100             END-IF                                               48110000
481200         END-IF                                                   48120000
481300     END-IF.                                                      48130000
481400                                                                  48140000
481500     IF PS-INSERT-VHTRIP                                          48150000
481600         MOVE PV-VHTRIP-TRIP-ID TO PV-VHTRIP-REF-TRIP-ID          48160000
481700         PERFORM 7015-SET-NULLS-VHTRIP                            48170000
481800         PERFORM 7997-INSERT-VHTRIP                               48180000
481900         MOVE PV-VHTRIP-TRIP-ID  TO VHTRIP-TRIP-ID                48190000
482000         PERFORM 7980-SELECT-VHTRIP                               48200000
482100         IF SQLCODE = 0                                           48210000
482200             PERFORM 7998-CREATE-TRIP-AUDIT-TRAIL                 48220000
482300         END-IF                                                   48230000
482400     END-IF.                                                      48240000
482500                                                                  48250000
482600*   ADD ANOTHER TRIP TO THIS VEHICL                               48260000
482700     IF PS-ADD-NEXT-VHTRIP                                        48270000
482800         MOVE VHTRIP-REF-TRIP-ID TO PV-VHTRIP-REF-TRIP-ID         48280000
482900         PERFORM 7015-SET-NULLS-VHTRIP                            48290000
483000         PERFORM 7997-INSERT-VHTRIP                               48300000
483100         MOVE PV-VHTRIP-TRIP-ID  TO VHTRIP-TRIP-ID                48310000
483200         PERFORM 7980-SELECT-VHTRIP                               48320000
483300         IF SQLCODE = 0                                           48330000
483400             PERFORM 7998-CREATE-TRIP-AUDIT-TRAIL                 48340000
483500         END-IF                                                   48350000
483600     END-IF.                                                      48360000
483700                                                                  48370000
483800     IF PS-UPDATE-VEHICL                                          48380000
483900         PERFORM 7999-UPDATE-VEHICL                               48390000
484000         PERFORM 7960-SELECT-VEHICL                               48400000
484100         IF SQLCODE = +0                                          48410000
484200             PERFORM 7996-CREATE-VEH-AUDIT-TRAIL                  48420000
484300         END-IF                                                   48430000
484400         MOVE VEHICL-CURR-TRIP-ID TO PV-TRIPST-TRIP-ID            48440000
484500     END-IF.                                                      48450000
484600                                                                  48460000
484700     IF PS-UPDATE-VHTRIP                                          48470000
484800         PERFORM 7015-SET-NULLS-VHTRIP                            48480000
484900         PERFORM 799A-UPDATE-VHTRIP                               48490000
485000         PERFORM 7980-SELECT-VHTRIP                               48500000
485100         IF SQLCODE = 0                                           48510000
485200             PERFORM 7998-CREATE-TRIP-AUDIT-TRAIL                 48520000
485300         END-IF                                                   48530000
485400         MOVE PV-VHTRIP-TRIP-ID  TO PV-TRIPST-TRIP-ID             48540000
485500     END-IF.                                                      48550000
485600                                                                  48560000
485700     IF PS-INVALID-DC OR                                          48570000
485800        PS-DONT-UPDATE-VHTRIP                                     48580000
485900         CONTINUE                                                 48590000
486000     ELSE                                                         48600000
486100         PERFORM 7070-PROCESS-TRIPST                              48610000
486200     END-IF.                                                      48620000
486300                                                                  48630000
486400     IF PS-INSERT-SHIPMT AND                                      48640000
486500        PS-VALID-DC                                               48650000
486600         PERFORM 7013-PROCESS-SHIPMENTS                           48660000
486700     END-IF.                                                      48670000
486800                                                                  48680000
486900     IF PS-UPDATE-SHIPMT                                          48690000
487000         IF PV-SHPTPO-PO-NBR > SPACES                             48700000
487100             PERFORM 799B-SELECT-VENDOR-NAME                      48710000
487200         END-IF                                                   48720000
487300         PERFORM 7014-SET-NULLS-SHIPMT                            48730000
487400         IF PV-SHIPMT-EST-AR-TMST = SPACES OR LOW-VALUES          48740000
487500             IF PV-VHTRIP-EST-AR-TMST = SPACES                    48750000
487600                 MOVE PC-NEG-1 TO PV-SHIPMT-EST-AR-NULL           48760000
487700                 MOVE SPACES         TO PV-SHIPMT-EST-AR-TMST     48770000
487800             ELSE                                                 48780000
487900                 MOVE PV-VHTRIP-EST-AR-TMST                       48790000
488000                                     TO PV-SHIPMT-EST-AR-TMST     48800000
488100                 MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL           48810000
488200             END-IF                                               48820000
488300         ELSE                                                     48830000
488400             IF PV-VHTRIP-EST-AR-TMST > PV-SHIPMT-EST-AR-TMST     48840000
488500                 MOVE PV-VHTRIP-EST-AR-TMST                       48850000
488600                                 TO PV-SHIPMT-EST-AR-TMST         48860000
488700                 MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL           48870000
488800             ELSE                                                 48880000
488900                 MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL           48890000
489000             END-IF                                               48900000
489100         END-IF                                                   48910000
489200         PERFORM 7040-UPDATE-SHIPMT                               48920000
489300         PERFORM 7030-SELECT-SHIPMT                               48930000
489400         IF SQLCODE = +0                                          48940000
489500             PERFORM 799C-CREATE-SHIPMT-AUDIT-TRAIL               48950000
489600         END-IF                                                   48960000
489700         IF PV-SAVE-SHIPMT-TRIP-ID NOT = PV-SHIPMT-TRIP-ID        48970000
489800             PERFORM 799J-DELETE-VHTRIP                           48980000
489900         END-IF                                                   48990000
490000                                                                  49000000
490100         PERFORM 799D-INSERT-SHPTPO                               49010000
490200                                                                  49020000
490300         PERFORM 799E-PROCESS-SHIPST                              49030000
490400                                                                  49040000
490500     END-IF.                                                      49050000
490600                                                                  49060000
490700     IF PS-DONT-UPDATE-SHIPMT                                     49070000
490800         PERFORM 799D-INSERT-SHPTPO                               49080000
490900                                                                  49090000
491000         PERFORM 799E-PROCESS-SHIPST                              49100000
491100     END-IF.                                                      49110000
491200                                                                  49120000
491300     IF PS-VHTRIP-SCAC-CHANGED OR                                 49130000
491400        PS-VHTRIP-VEH-CHANGED                                     49140000
491500         IF PV-SAVE-VHTRIP-VEH-NBR > SPACES                       49150000
491600             PERFORM 799L-DELETE-VEHICL                           49160000
491700         END-IF                                                   49170000
491800     END-IF.                                                      49180000
491900                                                                  49190000
492000                                                                  49200000
492100 7013-PROCESS-SHIPMENTS.                                          49210000
492200                                                                  49220000
492300     MOVE '7013-PROCESS-SHIPMENTS   '                             49230000
492400                                 TO PV-ABEND-PARAGRAPH.           49240000
492500                                                                  49250000
492600     MOVE PC-DEFAULT-PKG-CTN TO PV-SHIPMT-PKG-TYP-CDE.            49260000
492700                                                                  49270000
492800     PERFORM 799B-SELECT-VENDOR-NAME.                             49280000
492900     PERFORM 7014-SET-NULLS-SHIPMT.                               49290000
493000     IF PV-VHTRIP-EST-AR-TMST = SPACES                            49300000
493100         MOVE PC-NEG-1 TO PV-SHIPMT-EST-AR-NULL                   49310000
493200         MOVE SPACES         TO PV-SHIPMT-EST-AR-TMST             49320000
493300     ELSE                                                         49330000
493400         MOVE PV-VHTRIP-EST-AR-TMST                               49340000
493500                             TO PV-SHIPMT-EST-AR-TMST             49350000
493600         MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL                   49360000
493700     END-IF.                                                      49370000
493800                                                                  49380000
493900     PERFORM 7050-INSERT-SHIPMT.                                  49390000
494000     PERFORM 7030-SELECT-SHIPMT.                                  49400000
494100     IF SQLCODE = +0                                              49410000
494200         PERFORM 799C-CREATE-SHIPMT-AUDIT-TRAIL                   49420000
494300     END-IF.                                                      49430000
494400                                                                  49440000
494500     PERFORM 799D-INSERT-SHPTPO.                                  49450000
494600                                                                  49460000
494700     PERFORM 799E-PROCESS-SHIPST.                                 49470000
494800***????                                                           49480000
494900                                                                  49490000
495000***************************************************************** 49500000
495100*     SET NULLS SHIPMT                                          * 49510000
495200*                                                               * 49520000
495300*     -  SET ALL SHIPMT RECORD NULL INDICATORS                  * 49530000
495400***************************************************************** 49540000
495500                                                                  49550000
495600 7014-SET-NULLS-SHIPMT.                                           49560000
495700                                                                  49570000
495800     MOVE '7014-SET-NULLS-SHIPMT             '                    49580000
495900                                 TO PV-ABEND-PARAGRAPH.           49590000
496000                                                                  49600000
496100     IF PV-SHIPMT-TRIP-ID = ZEROES                                49610000
496200         MOVE PC-NEG-1           TO PV-SHIPMT-TRIP-ID-NULL        49620000
496300     ELSE                                                         49630000
496400         MOVE PC-POS-1           TO PV-SHIPMT-TRIP-ID-NULL        49640000
496500     END-IF.                                                      49650000
496600                                                                  49660000
496700***************************************************************** 49670000
496800*     SET NULLS VHTRIP                                          * 49680000
496900*                                                               * 49690000
497000*     -  SET ALL VHTRIP RECORD NULL INDICATORS                  * 49700000
497100***************************************************************** 49710000
497200                                                                  49720000
497300 7015-SET-NULLS-VHTRIP.                                           49730000
497400                                                                  49740000
497500     MOVE '7015-SET-NULLS-VHTRIP             '                    49750000
497600                                 TO PV-ABEND-PARAGRAPH.           49760000
497700                                                                  49770000
497800     IF PV-VHTRIP-VEH-NBR = SPACES                                49780000
497900         MOVE PC-NEG-1           TO PV-VHTRIP-VEH-NBR-NULL        49790000
498000     ELSE                                                         49800000
498100         MOVE PC-POS-1           TO PV-VHTRIP-VEH-NBR-NULL        49810000
498200     END-IF.                                                      49820000
498300                                                                  49830000
498400***************************************************************** 49840000
498500*     DO A SELECT ON VHTRIP USING THE TRIP-ID TO SEE IF THIS    * 49850000
498600*     TRIP NUMBER HAS ALREADY BEEN PRODUCED BY THE RANDOM NUMBER* 49860000
498700*     GENERATOR.                                                * 49870000
498800***************************************************************** 49880000
498900                                                                  49890000
499000 7017-CHECK-IF-TRIP-ID-USED.                                      49900000
499100                                                                  49910000
499200     MOVE '7017-CHECK-IF-TRIP-ID-USED'                            49920000
499300                                 TO PV-ABEND-PARAGRAPH.           49930000
499400                                                                  49940000
499500     PERFORM                                                      49950000
499600         WITH TEST AFTER                                          49960000
499700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     49970000
499800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            49980000
499900                 SQLCODE = ZERO    OR                             49990000
500000                 SQLCODE = +100                                   50000000
500100                                                                  50010000
500200         EXEC SQL                                                 50020000
500300             SELECT TRIP_ID                                       50030000
500400               INTO :PV-TRIP-ID                                   50040000
500500               FROM TVHTRIP                                       50050000
500600              WHERE TRIP_ID = :PV-RANDOM-NBR                      50060000
500700         END-EXEC                                                 50070000
500800                                                                  50080000
500900         EVALUATE TRUE                                            50090000
501000             WHEN SQLCODE = ZERO                                  50100000
501100             WHEN SQLCODE = +100                                  50110000
501200             WHEN SQLCODE = -911                                  50120000
501300                 CONTINUE                                         50130000
501400                                                                  50140000
501500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              50150000
501600                 DISPLAY '**************************************' 50160000
501700                 DISPLAY 'WARNING ISSUED ON SELECT OF TVHTRIP   ' 50170000
501800                 DISPLAY 'PV-RANDOM-NBR: ' PV-RANDOM-NBR          50180000
501900                 DISPLAY '**********************************'     50190000
502000                 PERFORM 9700-SQL-WARNING                         50200000
502100                                                                  50210000
502200             WHEN SQLCODE < ZERO                                  50220000
502300                 DISPLAY '**************************************' 50230000
502400                 DISPLAY 'ERROR ISSUED ON SELECT OF TVHTRIP     ' 50240000
502500                 DISPLAY 'PV-RANDOM-NBR: ' PV-RANDOM-NBR          50250000
502600                 DISPLAY '**************************************' 50260000
502700                 PERFORM 9800-SQL-ERROR                           50270000
502800                                                                  50280000
502900         END-EVALUATE                                             50290000
503000     END-PERFORM.                                                 50300000
503100                                                                  50310000
503200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    50320000
503300         SQLCODE NOT = +0                                         50330000
503400         DISPLAY '**************************************'         50340000
503500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            50350000
503600                 'SELECT TVHTRIP                        '         50360000
503700                 DISPLAY 'PV-RANDOM-NBR: ' PV-RANDOM-NBR          50370000
503800         DISPLAY '**************************************'         50380000
503900         PERFORM 9800-SQL-ERROR                                   50390000
504000     END-IF.                                                      50400000
504100                                                                  50410000
504200***************************************************************** 50420000
504300*     USING THE CURRENT DATE AND TIME, CALL THE RANDOM NUMBER   * 50430000
504400*     GENERATOR ROUTINE TO CALCULATE A NUMBER TO BE USED AS THE * 50440000
504500*     NEXT SHIPT ID ON INSERTS.  THE TRAILER KEY IS ALSO FIGURED* 50450000
504600*     IN THE SAME WAY.                                          * 50460000
504700***************************************************************** 50470000
504800                                                                  50480000
504900 7020-GET-RANDOM-NUMBER.                                          50490000
505000                                                                  50500000
505100     MOVE '7020-GET-RANDOM-NUMBER         '                       50510000
505200                                 TO PV-ABEND-PARAGRAPH.           50520000
505300                                                                  50530000
505310     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     50531000
505600                                                                  50560000
505700     CALL PC-RANDNBR-PGM USING DP902-RANDNBR-ROUTINE-FIELDS.      50570000
505800                                                                  50580000
505900     IF DP902-SUCCESSFUL                                          50590000
506000         MOVE DP902-RANDOM-NUMBER                                 50600000
506100                                 TO PV-RANDOM-NBR                 50610000
506200     ELSE                                                         50620000
506300         DISPLAY 'RANDOM-NUMBER ERROR'                            50630000
506400         DISPLAY 'DP902-RETURN-CODE = ' DP902-RETURN-CODE         50640000
506410         SET RC082-PGM-END-FAILURE TO TRUE                        50641000
506420         PERFORM 9900-GENERATE-STATISTICS                         50642000
506500         MOVE +4013 TO PV-ABEND-CODE                              50650000
506600         CALL 'ILBOABN0' USING PV-ABEND-CODE                      50660000
506700     END-IF.                                                      50670000
506800                                                                  50680000
506840                                                                  50684046
506900 EJECT                                                            50690000
507000***************************************************************** 50700000
507100*     DO A SELECT ON SHIPMT USING THE SHIPT-ID NUMBER TO SEE IF * 50710000
507200*     THE RANDOM NUMBER GENERATOR HAS ALREADY PRODUCED THIS NBR.* 50720000
507300***************************************************************** 50730000
507400                                                                  50740000
507500 7025-CHECK-IF-SHIPT-ID-USED.                                     50750000
507600                                                                  50760000
507700     MOVE '7025-CHECK-IF-SHIPT-ID-USED'                           50770000
507800                                 TO PV-ABEND-PARAGRAPH.           50780000
507900                                                                  50790000
508000     PERFORM                                                      50800000
508100         WITH TEST AFTER                                          50810000
508200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     50820000
508300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            50830000
508400                 SQLCODE = ZERO    OR                             50840000
508500                 SQLCODE = +100                                   50850000
508600                                                                  50860000
508700         EXEC SQL                                                 50870000
508800             SELECT SHIPT_ID                                      50880000
508900               INTO :PV-SHIPT-ID                                  50890000
509000               FROM TSHIPMT                                       50900000
509100              WHERE SHIPT_ID = :PV-RANDOM-NBR                     50910000
509200         END-EXEC                                                 50920000
509300                                                                  50930000
509400         EVALUATE TRUE                                            50940000
509500             WHEN SQLCODE = ZERO                                  50950000
509600             WHEN SQLCODE = +100                                  50960000
509700             WHEN SQLCODE = -911                                  50970000
509800                 CONTINUE                                         50980000
509900                                                                  50990000
510000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              51000000
510100                 DISPLAY '**************************************' 51010000
510200                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 51020000
510300                 DISPLAY 'PV-RANDOM-NBR: '  PV-RANDOM-NBR         51030000
510400                 DISPLAY '**********************************'     51040000
510500                 PERFORM 9700-SQL-WARNING                         51050000
510600                                                                  51060000
510700             WHEN SQLCODE < ZERO                                  51070000
510800                 DISPLAY '**************************************' 51080000
510900                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 51090000
511000                 DISPLAY 'PV-RANDOM-NBR: '  PV-RANDOM-NBR         51100000
511100                 DISPLAY '**************************************' 51110000
511200                 PERFORM 9800-SQL-ERROR                           51120000
511300                                                                  51130000
511400         END-EVALUATE                                             51140000
511500                                                                  51150000
511600     END-PERFORM.                                                 51160000
511700                                                                  51170000
511800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    51180000
511900         SQLCODE NOT = +0                                         51190000
512000         DISPLAY '**************************************'         51200000
512100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         51210000
512200         DISPLAY 'SELECT TSHIPMT                        '         51220000
512300         DISPLAY 'PV-RANDOM-NBR: '  PV-RANDOM-NBR                 51230000
512400         DISPLAY '**************************************'         51240000
512500         PERFORM 9800-SQL-ERROR                                   51250000
512600     END-IF.                                                      51260000
512700                                                                  51270000
512800 EJECT                                                            51280000
512900***************************************************************** 51290000
513000*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 51300000
513100*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 51310000
513200*--- MATCH= -PRO- -BOL- -SCAC-                                  * 51320000
513300***************************************************************** 51330000
513400                                                                  51340000
513500 7030-SELECT-SHIPMT.                                              51350000
513600                                                                  51360000
513700     MOVE '7030-SELECT-SHIPMT'   TO PV-ABEND-PARAGRAPH.           51370000
513701                                                                  51370102
513900     PERFORM                                                      51390000
514000         WITH TEST AFTER                                          51400000
514100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     51410000
514200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            51420000
514300                 SQLCODE = ZERO    OR                             51430000
514400                 SQLCODE = +100    OR                             51440000
514500                 SQLCODE = -811                                   51450000
514600                                                                  51460000
514700         EXEC SQL                                                 51470000
514800             SELECT TRIP_ID,                                      51480000
514900                    SHIPT_ID,                                     51490000
515000                    CRT_SRC_CDE,                                  51500000
515100                    LAST_UPD_DTE,                                 51510000
515200                    LAST_UPD_TME,                                 51520000
515300                    LAST_UPD_UID,                                 51530000
515400                    PRO_SCAC_ID,                                  51540000
515500                    PRO_NBR,                                      51550000
515600                    BOL_NBR,                                      51560000
515700                    SHIPPER_NME,                                  51570000
515800                    SHIPT_TYP_CDE,                                51580000
515900                    EXPTED_GRO_WGHT,                              51590000
516000                    PKG_TYP_CDE,                                  51600000
516100                    EXPTED_PKG_QTY,                               51610000
516200                    FRGT_CHG_AMT,                                 51620000
516300                    FRGT_TERMS_CDE,                               51630000
516400                    EXPTED_PLT_QTY,                               51640000
516500                    EST_AR_TMST,                                  51650000
516600                    VEND_SHIP_DTE,                                51660000
516700                    ORIG_SCAC_ID,                                 51670000
516800                    LAST_UPD_PGM_ID,                              51680000
516900                    CRE_USER_ID,                                  51690000
517000                    CARR_CART_CT,                                 51700000
517100                    CARR_LAST_UPD_DTE,                            51710000
517200                    CARR_LAST_UPD_TIME,                           51720000
517300                    VEND_CART_CT,                                 51730000
517400                    VEND_LAST_UPD_DTE,                            51740000
517500                    VEND_LAST_UPD_TIME,                           51750000
517600                    VEH_NBR,                                      51760000
517700                    AUTH_NBR,                                     51770000
517800                    AUTH_DTE,                                     51780000
517900                    CONFIRM_DTE,                                  51790000
518000                    CONFIRM_TIME,                                 51800000
518100                    COMPLETE_PRO_NBR,                             51810000
518200                    COMPLETE_BOL_NBR,                             51820000
518300                    PROCESSED_DTE,                                51830000
518400                    INVC_NBR,                                     51840002
518410                    CARR_AUTH_ID                                  51841002
518500               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    51850000
518600                    :SHIPMT-SHIPT-ID,                             51860000
518700                    :SHIPMT-CRT-SRC-CDE,                          51870000
518800                    :SHIPMT-LAST-UPD-DTE,                         51880000
518900                    :SHIPMT-LAST-UPD-TME,                         51890000
519000                    :SHIPMT-LAST-UPD-UID,                         51900000
519100                    :SHIPMT-PRO-SCAC-ID,                          51910000
519200                    :SHIPMT-PRO-NBR,                              51920000
519300                    :SHIPMT-BOL-NBR,                              51930000
519400                    :SHIPMT-SHIPPER-NME,                          51940000
519500                    :SHIPMT-SHIPT-TYP-CDE,                        51950000
519600                    :SHIPMT-EXPTED-GRO-WGHT,                      51960000
519700                    :SHIPMT-PKG-TYP-CDE,                          51970000
519800                    :SHIPMT-EXPTED-PKG-QTY,                       51980000
519900                    :SHIPMT-FRGT-CHG-AMT,                         51990000
520000                    :SHIPMT-FRGT-TERMS-CDE,                       52000000
520100                    :SHIPMT-EXPTED-PLT-QTY,                       52010000
520200                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 52020000
520300                    :SHIPMT-VEND-SHIP-DTE,                        52030000
520400                    :SHIPMT-ORIG-SCAC-ID,                         52040000
520500                    :SHIPMT-LAST-UPD-PGM-ID,                      52050000
520600                    :SHIPMT-CRE-USER-ID,                          52060000
520700                    :SHIPMT-CARR-CART-CT,                         52070000
520800                    :SHIPMT-CARR-LAST-UPD-DTE,                    52080000
520900                    :SHIPMT-CARR-LAST-UPD-TIME,                   52090000
521000                    :SHIPMT-VEND-CART-CT,                         52100000
521100                    :SHIPMT-VEND-LAST-UPD-DTE,                    52110000
521200                    :SHIPMT-VEND-LAST-UPD-TIME,                   52120000
521300                    :SHIPMT-VEH-NBR,                              52130000
521400                    :SHIPMT-AUTH-NBR,                             52140000
521500                    :SHIPMT-AUTH-DTE,                             52150000
521600                    :SHIPMT-CONFIRM-DTE,                          52160000
521700                    :SHIPMT-CONFIRM-TIME,                         52170000
521800                    :SHIPMT-COMPLETE-PRO-NBR,                     52180000
521900                    :SHIPMT-COMPLETE-BOL-NBR,                     52190000
522000                    :SHIPMT-PROCESSED-DTE,                        52200000
522100                    :SHIPMT-INVC-NBR,                             52210002
522110                    :SHIPMT-CARR-AUTH-ID                          52211002
522200               FROM TSHIPMT                                       52220000
522300              WHERE PRO_SCAC_ID = :DK-PRO-SCAC-ID                 52230000
522400                AND PRO_NBR     = :DK-PRO-NBR                     52240000
522500                AND BOL_NBR     = :DK-BOL-NBR                     52250000
522600         END-EXEC                                                 52260000
522700                                                                  52270000
522800         EVALUATE TRUE                                            52280000
522900             WHEN SQLCODE = ZERO                                  52290000
523000             WHEN SQLCODE = +100                                  52300000
523100             WHEN SQLCODE = -911                                  52310000
523200                 CONTINUE                                         52320000
523300                                                                  52330000
523400             WHEN SQLCODE = -811                                  52340000
523500                 SET PS-DUPLICATE-SHIPMT TO TRUE                  52350000
523600                                                                  52360000
523700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              52370000
523800                 DISPLAY '**************************************' 52380000
523900                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 52390000
524000                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               52400000
524100                          PV-SHIPMT-PRO-NBR                       52410000
524200                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               52420000
524300                          PV-SHIPMT-BOL-NBR                       52430000
524400                 DISPLAY '**********************************'     52440000
524500                 PERFORM 9700-SQL-WARNING                         52450000
524600                                                                  52460000
524700             WHEN SQLCODE < ZERO                                  52470000
524800                 DISPLAY '**************************************' 52480000
524900                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 52490000
525000                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               52500000
525100                          PV-SHIPMT-PRO-NBR                       52510000
525200                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               52520000
525300                          PV-SHIPMT-BOL-NBR                       52530000
525400                 DISPLAY '**************************************' 52540000
525500                 PERFORM 9800-SQL-ERROR                           52550000
525600                                                                  52560000
525700         END-EVALUATE                                             52570000
525800                                                                  52580000
525900     END-PERFORM.                                                 52590000
526000                                                                  52600000
526100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    52610000
526200         SQLCODE NOT = +0                                         52620000
526300         DISPLAY '**************************************'         52630000
526400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         52640000
526500         DISPLAY 'SELECT TSHIPMT                        '         52650000
526600         DISPLAY 'PV-SHIPMT-PRO-NBR:      '                       52660000
526700                  PV-SHIPMT-PRO-NBR                               52670000
526800         DISPLAY 'PV-SHIPMT-BOL-NBR:      '                       52680000
526900                  PV-SHIPMT-BOL-NBR                               52690000
527000         DISPLAY '**************************************'         52700000
527100         PERFORM 9800-SQL-ERROR                                   52710000
527200     END-IF.                                                      52720000
527300                                                                  52730000
527400***************************************************************** 52740000
527500*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 52750000
527600*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 52760000
527700*--- MATCH= -PRO(SPACES)- -BOL- -SCAC-                          * 52770000
527800***************************************************************** 52780000
527900                                                                  52790000
528000 7033-SELECT-SHIPMT.                                              52800000
528100                                                                  52810000
528200     MOVE '7033-SELECT-SHIPMT'   TO PV-ABEND-PARAGRAPH.           52820000
528300                                                                  52830000
528400     PERFORM                                                      52840000
528500         WITH TEST AFTER                                          52850000
528600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     52860000
528700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            52870000
528800                 SQLCODE = ZERO    OR                             52880000
528900                 SQLCODE = +100    OR                             52890000
529000                 SQLCODE = -811                                   52900000
529100                                                                  52910000
529200         EXEC SQL                                                 52920000
529300             SELECT TRIP_ID,                                      52930000
529400                    SHIPT_ID,                                     52940000
529500                    CRT_SRC_CDE,                                  52950000
529600                    LAST_UPD_DTE,                                 52960000
529700                    LAST_UPD_TME,                                 52970000
529800                    LAST_UPD_UID,                                 52980000
529900                    PRO_SCAC_ID,                                  52990000
530000                    PRO_NBR,                                      53000000
530100                    BOL_NBR,                                      53010000
530200                    SHIPPER_NME,                                  53020000
530300                    SHIPT_TYP_CDE,                                53030000
530400                    EXPTED_GRO_WGHT,                              53040000
530500                    PKG_TYP_CDE,                                  53050000
530600                    EXPTED_PKG_QTY,                               53060000
530700                    FRGT_CHG_AMT,                                 53070000
530800                    FRGT_TERMS_CDE,                               53080000
530900                    EXPTED_PLT_QTY,                               53090000
531000                    EST_AR_TMST,                                  53100000
531100                    VEND_SHIP_DTE,                                53110000
531200                    ORIG_SCAC_ID,                                 53120000
531300                    LAST_UPD_PGM_ID,                              53130000
531400                    CRE_USER_ID,                                  53140000
531500                    CARR_CART_CT,                                 53150000
531600                    CARR_LAST_UPD_DTE,                            53160000
531700                    CARR_LAST_UPD_TIME,                           53170000
531800                    VEND_CART_CT,                                 53180000
531900                    VEND_LAST_UPD_DTE,                            53190000
532000                    VEND_LAST_UPD_TIME,                           53200000
532100                    VEH_NBR,                                      53210000
532200                    AUTH_NBR,                                     53220000
532300                    AUTH_DTE,                                     53230000
532400                    CONFIRM_DTE,                                  53240000
532500                    CONFIRM_TIME,                                 53250000
532600                    COMPLETE_PRO_NBR,                             53260000
532700                    COMPLETE_BOL_NBR,                             53270000
532800                    PROCESSED_DTE,                                53280000
532900                    INVC_NBR,                                     53290002
532910                    CARR_AUTH_ID                                  53291002
533000               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    53300000
533100                    :SHIPMT-SHIPT-ID,                             53310000
533200                    :SHIPMT-CRT-SRC-CDE,                          53320000
533300                    :SHIPMT-LAST-UPD-DTE,                         53330000
533400                    :SHIPMT-LAST-UPD-TME,                         53340000
533500                    :SHIPMT-LAST-UPD-UID,                         53350000
533600                    :SHIPMT-PRO-SCAC-ID,                          53360000
533700                    :SHIPMT-PRO-NBR,                              53370000
533800                    :SHIPMT-BOL-NBR,                              53380000
533900                    :SHIPMT-SHIPPER-NME,                          53390000
534000                    :SHIPMT-SHIPT-TYP-CDE,                        53400000
534100                    :SHIPMT-EXPTED-GRO-WGHT,                      53410000
534200                    :SHIPMT-PKG-TYP-CDE,                          53420000
534300                    :SHIPMT-EXPTED-PKG-QTY,                       53430000
534400                    :SHIPMT-FRGT-CHG-AMT,                         53440000
534500                    :SHIPMT-FRGT-TERMS-CDE,                       53450000
534600                    :SHIPMT-EXPTED-PLT-QTY,                       53460000
534700                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 53470000
534800                    :SHIPMT-VEND-SHIP-DTE,                        53480000
534900                    :SHIPMT-ORIG-SCAC-ID,                         53490000
535000                    :SHIPMT-LAST-UPD-PGM-ID,                      53500000
535100                    :SHIPMT-CRE-USER-ID,                          53510000
535200                    :SHIPMT-CARR-CART-CT,                         53520000
535300                    :SHIPMT-CARR-LAST-UPD-DTE,                    53530000
535400                    :SHIPMT-CARR-LAST-UPD-TIME,                   53540000
535500                    :SHIPMT-VEND-CART-CT,                         53550000
535600                    :SHIPMT-VEND-LAST-UPD-DTE,                    53560000
535700                    :SHIPMT-VEND-LAST-UPD-TIME,                   53570000
535800                    :SHIPMT-VEH-NBR,                              53580000
535900                    :SHIPMT-AUTH-NBR,                             53590000
536000                    :SHIPMT-AUTH-DTE,                             53600000
536100                    :SHIPMT-CONFIRM-DTE,                          53610000
536200                    :SHIPMT-CONFIRM-TIME,                         53620000
536300                    :SHIPMT-COMPLETE-PRO-NBR,                     53630000
536400                    :SHIPMT-COMPLETE-BOL-NBR,                     53640000
536500                    :SHIPMT-PROCESSED-DTE,                        53650000
536600                    :SHIPMT-INVC-NBR,                             53660002
536610                    :SHIPMT-CARR-AUTH-ID                          53661002
536700               FROM TSHIPMT                                       53670000
536800              WHERE PRO_SCAC_ID = :DK-PRO-SCAC-ID                 53680000
536900                AND BOL_NBR     = :DK-BOL-NBR                     53690000
537000                AND PRO_NBR     = :PC-PRO-SPACES                  53700000
537100         END-EXEC                                                 53710000
537200                                                                  53720000
537300         EVALUATE TRUE                                            53730000
537400             WHEN SQLCODE = ZERO                                  53740000
537500             WHEN SQLCODE = +100                                  53750000
537600             WHEN SQLCODE = -911                                  53760000
537700                 CONTINUE                                         53770000
537800                                                                  53780000
537900             WHEN SQLCODE = -811                                  53790000
538000                 SET PS-DUPLICATE-SHIPMT TO TRUE                  53800000
538100                                                                  53810000
538200             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              53820000
538300                 DISPLAY '**************************************' 53830000
538400                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 53840000
538500                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               53850000
538600                          PV-SHIPMT-PRO-NBR                       53860000
538700                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               53870000
538800                          PV-SHIPMT-BOL-NBR                       53880000
538900                 DISPLAY '**********************************'     53890000
539000                 PERFORM 9700-SQL-WARNING                         53900000
539100                                                                  53910000
539200             WHEN SQLCODE < ZERO                                  53920000
539300                 DISPLAY '**************************************' 53930000
539400                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 53940000
539500                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               53950000
539600                          PV-SHIPMT-PRO-NBR                       53960000
539700                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               53970000
539800                          PV-SHIPMT-BOL-NBR                       53980000
539900                 DISPLAY '**************************************' 53990000
540000                 PERFORM 9800-SQL-ERROR                           54000000
540100                                                                  54010000
540200         END-EVALUATE                                             54020000
540300                                                                  54030000
540400     END-PERFORM.                                                 54040000
540500                                                                  54050000
540600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    54060000
540700         SQLCODE NOT = +0                                         54070000
540800         DISPLAY '**************************************'         54080000
540900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         54090000
541000         DISPLAY 'SELECT TSHIPMT                        '         54100000
541100         DISPLAY 'PV-SHIPMT-PRO-NBR:      '                       54110000
541200                  PV-SHIPMT-PRO-NBR                               54120000
541300         DISPLAY 'PV-SHIPMT-BOL-NBR:      '                       54130000
541400                  PV-SHIPMT-BOL-NBR                               54140000
541500         DISPLAY '**************************************'         54150000
541600         PERFORM 9800-SQL-ERROR                                   54160000
541700     END-IF.                                                      54170000
541800                                                                  54180000
541900***************************************************************** 54190000
542000*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 54200000
542100*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 54210000
542200*--- MATCH= -PRO- -BOL(SPACES)- -SCAC-                          * 54220000
542300***************************************************************** 54230000
542400                                                                  54240000
542500 7036-SELECT-SHIPMT.                                              54250000
542600                                                                  54260000
542700     MOVE '7036-SELECT-SHIPMT'   TO PV-ABEND-PARAGRAPH.           54270000
542800                                                                  54280000
542900     PERFORM                                                      54290000
543000         WITH TEST AFTER                                          54300000
543100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     54310000
543200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            54320000
543300                 SQLCODE = ZERO    OR                             54330000
543400                 SQLCODE = +100    OR                             54340000
543500                 SQLCODE = -811                                   54350000
543600                                                                  54360000
543700         EXEC SQL                                                 54370000
543800             SELECT TRIP_ID,                                      54380000
543900                    SHIPT_ID,                                     54390000
544000                    CRT_SRC_CDE,                                  54400000
544100                    LAST_UPD_DTE,                                 54410000
544200                    LAST_UPD_TME,                                 54420000
544300                    LAST_UPD_UID,                                 54430000
544400                    PRO_SCAC_ID,                                  54440000
544500                    PRO_NBR,                                      54450000
544600                    BOL_NBR,                                      54460000
544700                    SHIPPER_NME,                                  54470000
544800                    SHIPT_TYP_CDE,                                54480000
544900                    EXPTED_GRO_WGHT,                              54490000
545000                    PKG_TYP_CDE,                                  54500000
545100                    EXPTED_PKG_QTY,                               54510000
545200                    FRGT_CHG_AMT,                                 54520000
545300                    FRGT_TERMS_CDE,                               54530000
545400                    EXPTED_PLT_QTY,                               54540000
545500                    EST_AR_TMST,                                  54550000
545600                    VEND_SHIP_DTE,                                54560000
545700                    ORIG_SCAC_ID,                                 54570000
545800                    LAST_UPD_PGM_ID,                              54580000
545900                    CRE_USER_ID,                                  54590000
546000                    CARR_CART_CT,                                 54600000
546100                    CARR_LAST_UPD_DTE,                            54610000
546200                    CARR_LAST_UPD_TIME,                           54620000
546300                    VEND_CART_CT,                                 54630000
546400                    VEND_LAST_UPD_DTE,                            54640000
546500                    VEND_LAST_UPD_TIME,                           54650000
546600                    VEH_NBR,                                      54660000
546700                    AUTH_NBR,                                     54670000
546800                    AUTH_DTE,                                     54680000
546900                    CONFIRM_DTE,                                  54690000
547000                    CONFIRM_TIME,                                 54700000
547100                    COMPLETE_PRO_NBR,                             54710000
547200                    COMPLETE_BOL_NBR,                             54720000
547300                    PROCESSED_DTE,                                54730000
547400                    INVC_NBR,                                     54740002
547410                    CARR_AUTH_ID                                  54741002
547500               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    54750000
547600                    :SHIPMT-SHIPT-ID,                             54760000
547700                    :SHIPMT-CRT-SRC-CDE,                          54770000
547800                    :SHIPMT-LAST-UPD-DTE,                         54780000
547900                    :SHIPMT-LAST-UPD-TME,                         54790000
548000                    :SHIPMT-LAST-UPD-UID,                         54800000
548100                    :SHIPMT-PRO-SCAC-ID,                          54810000
548200                    :SHIPMT-PRO-NBR,                              54820000
548300                    :SHIPMT-BOL-NBR,                              54830000
548400                    :SHIPMT-SHIPPER-NME,                          54840000
548500                    :SHIPMT-SHIPT-TYP-CDE,                        54850000
548600                    :SHIPMT-EXPTED-GRO-WGHT,                      54860000
548700                    :SHIPMT-PKG-TYP-CDE,                          54870000
548800                    :SHIPMT-EXPTED-PKG-QTY,                       54880000
548900                    :SHIPMT-FRGT-CHG-AMT,                         54890000
549000                    :SHIPMT-FRGT-TERMS-CDE,                       54900000
549100                    :SHIPMT-EXPTED-PLT-QTY,                       54910000
549200                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 54920000
549300                    :SHIPMT-VEND-SHIP-DTE,                        54930000
549400                    :SHIPMT-ORIG-SCAC-ID,                         54940000
549500                    :SHIPMT-LAST-UPD-PGM-ID,                      54950000
549600                    :SHIPMT-CRE-USER-ID,                          54960000
549700                    :SHIPMT-CARR-CART-CT,                         54970000
549800                    :SHIPMT-CARR-LAST-UPD-DTE,                    54980000
549900                    :SHIPMT-CARR-LAST-UPD-TIME,                   54990000
550000                    :SHIPMT-VEND-CART-CT,                         55000000
550100                    :SHIPMT-VEND-LAST-UPD-DTE,                    55010000
550200                    :SHIPMT-VEND-LAST-UPD-TIME,                   55020000
550300                    :SHIPMT-VEH-NBR,                              55030000
550400                    :SHIPMT-AUTH-NBR,                             55040000
550500                    :SHIPMT-AUTH-DTE,                             55050000
550600                    :SHIPMT-CONFIRM-DTE,                          55060000
550700                    :SHIPMT-CONFIRM-TIME,                         55070000
550800                    :SHIPMT-COMPLETE-PRO-NBR,                     55080000
550900                    :SHIPMT-COMPLETE-BOL-NBR,                     55090000
551000                    :SHIPMT-PROCESSED-DTE,                        55100000
551100                    :SHIPMT-INVC-NBR,                             55110004
551110                    :SHIPMT-CARR-AUTH-ID                          55111002
551200               FROM TSHIPMT                                       55120000
551300              WHERE PRO_SCAC_ID = :DK-PRO-SCAC-ID                 55130000
551400                AND PRO_NBR     = :DK-PRO-NBR                     55140000
551500                AND BOL_NBR     = :PC-BOL-SPACES                  55150000
551600         END-EXEC                                                 55160000
551700                                                                  55170000
551800         EVALUATE TRUE                                            55180000
551900             WHEN SQLCODE = ZERO                                  55190000
552000             WHEN SQLCODE = +100                                  55200000
552100             WHEN SQLCODE = -911                                  55210000
552200                 CONTINUE                                         55220000
552300                                                                  55230000
552400             WHEN SQLCODE = -811                                  55240000
552500                 SET PS-DUPLICATE-SHIPMT TO TRUE                  55250000
552600                                                                  55260000
552700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              55270000
552800                 DISPLAY '**************************************' 55280000
552900                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 55290000
553000                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               55300000
553100                          PV-SHIPMT-PRO-NBR                       55310000
553200                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               55320000
553300                          PV-SHIPMT-BOL-NBR                       55330000
553400                 DISPLAY '**********************************'     55340000
553500                 PERFORM 9700-SQL-WARNING                         55350000
553600                                                                  55360000
553700             WHEN SQLCODE < ZERO                                  55370000
553800                 DISPLAY '**************************************' 55380000
553900                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 55390000
554000                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               55400000
554100                          PV-SHIPMT-PRO-NBR                       55410000
554200                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               55420000
554300                          PV-SHIPMT-BOL-NBR                       55430000
554400                 DISPLAY '**************************************' 55440000
554500                 PERFORM 9800-SQL-ERROR                           55450000
554600                                                                  55460000
554700         END-EVALUATE                                             55470000
554800                                                                  55480000
554900     END-PERFORM.                                                 55490000
555000                                                                  55500000
555100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    55510000
555200         SQLCODE NOT = +0                                         55520000
555300         DISPLAY '**************************************'         55530000
555400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         55540000
555500         DISPLAY 'SELECT TSHIPMT                        '         55550000
555600         DISPLAY 'PV-SHIPMT-PRO-NBR:      '                       55560000
555700                  PV-SHIPMT-PRO-NBR                               55570000
555800         DISPLAY 'PV-SHIPMT-BOL-NBR:      '                       55580000
555900                  PV-SHIPMT-BOL-NBR                               55590000
556000         DISPLAY '**************************************'         55600000
556100         PERFORM 9800-SQL-ERROR                                   55610000
556200     END-IF.                                                      55620000
556300                                                                  55630000
556400                                                                  55640000
556500***************************************************************** 55650000
556600*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 55660000
556700*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 55670000
556800*--- MATCH= -PRO- -SCAC-                                        * 55680000
556900***************************************************************** 55690000
557000 7037-SELECT-SHIPMT.                                              55700000
557100                                                                  55710000
557200     MOVE '7037-SELECT-SHIPMT'   TO PV-ABEND-PARAGRAPH.           55720000
557300                                                                  55730000
557400     PERFORM                                                      55740000
557500         WITH TEST AFTER                                          55750000
557600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     55760000
557700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            55770000
557800                 SQLCODE = ZERO    OR                             55780000
557900                 SQLCODE = +100    OR                             55790000
558000                 SQLCODE = -811                                   55800000
558100                                                                  55810000
558200         EXEC SQL                                                 55820000
558300             SELECT TRIP_ID,                                      55830000
558400                    SHIPT_ID,                                     55840000
558500                    CRT_SRC_CDE,                                  55850000
558600                    LAST_UPD_DTE,                                 55860000
558700                    LAST_UPD_TME,                                 55870000
558800                    LAST_UPD_UID,                                 55880000
558900                    PRO_SCAC_ID,                                  55890000
559000                    PRO_NBR,                                      55900000
559100                    BOL_NBR,                                      55910000
559200                    SHIPPER_NME,                                  55920000
559300                    SHIPT_TYP_CDE,                                55930000
559400                    EXPTED_GRO_WGHT,                              55940000
559500                    PKG_TYP_CDE,                                  55950000
559600                    EXPTED_PKG_QTY,                               55960000
559700                    FRGT_CHG_AMT,                                 55970000
559800                    FRGT_TERMS_CDE,                               55980000
559900                    EXPTED_PLT_QTY,                               55990000
560000                    EST_AR_TMST,                                  56000000
560100                    VEND_SHIP_DTE,                                56010000
560200                    ORIG_SCAC_ID,                                 56020000
560300                    LAST_UPD_PGM_ID,                              56030000
560400                    CRE_USER_ID,                                  56040000
560500                    CARR_CART_CT,                                 56050000
560600                    CARR_LAST_UPD_DTE,                            56060000
560700                    CARR_LAST_UPD_TIME,                           56070000
560800                    VEND_CART_CT,                                 56080000
560900                    VEND_LAST_UPD_DTE,                            56090000
561000                    VEND_LAST_UPD_TIME,                           56100000
561100                    VEH_NBR,                                      56110000
561200                    AUTH_NBR,                                     56120000
561300                    AUTH_DTE,                                     56130000
561400                    CONFIRM_DTE,                                  56140000
561500                    CONFIRM_TIME,                                 56150000
561600                    COMPLETE_PRO_NBR,                             56160000
561700                    COMPLETE_BOL_NBR,                             56170000
561800                    PROCESSED_DTE,                                56180000
561900                    INVC_NBR,                                     56190002
561910                    CARR_AUTH_ID                                  56191002
562000               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    56200000
562100                    :SHIPMT-SHIPT-ID,                             56210000
562200                    :SHIPMT-CRT-SRC-CDE,                          56220000
562300                    :SHIPMT-LAST-UPD-DTE,                         56230000
562400                    :SHIPMT-LAST-UPD-TME,                         56240000
562500                    :SHIPMT-LAST-UPD-UID,                         56250000
562600                    :SHIPMT-PRO-SCAC-ID,                          56260000
562700                    :SHIPMT-PRO-NBR,                              56270000
562800                    :SHIPMT-BOL-NBR,                              56280000
562900                    :SHIPMT-SHIPPER-NME,                          56290000
563000                    :SHIPMT-SHIPT-TYP-CDE,                        56300000
563100                    :SHIPMT-EXPTED-GRO-WGHT,                      56310000
563200                    :SHIPMT-PKG-TYP-CDE,                          56320000
563300                    :SHIPMT-EXPTED-PKG-QTY,                       56330000
563400                    :SHIPMT-FRGT-CHG-AMT,                         56340000
563500                    :SHIPMT-FRGT-TERMS-CDE,                       56350000
563600                    :SHIPMT-EXPTED-PLT-QTY,                       56360000
563700                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 56370000
563800                    :SHIPMT-VEND-SHIP-DTE,                        56380000
563900                    :SHIPMT-ORIG-SCAC-ID,                         56390000
564000                    :SHIPMT-LAST-UPD-PGM-ID,                      56400000
564100                    :SHIPMT-CRE-USER-ID,                          56410000
564200                    :SHIPMT-CARR-CART-CT,                         56420000
564300                    :SHIPMT-CARR-LAST-UPD-DTE,                    56430000
564400                    :SHIPMT-CARR-LAST-UPD-TIME,                   56440000
564500                    :SHIPMT-VEND-CART-CT,                         56450000
564600                    :SHIPMT-VEND-LAST-UPD-DTE,                    56460000
564700                    :SHIPMT-VEND-LAST-UPD-TIME,                   56470000
564800                    :SHIPMT-VEH-NBR,                              56480000
564900                    :SHIPMT-AUTH-NBR,                             56490000
565000                    :SHIPMT-AUTH-DTE,                             56500000
565100                    :SHIPMT-CONFIRM-DTE,                          56510000
565200                    :SHIPMT-CONFIRM-TIME,                         56520000
565300                    :SHIPMT-COMPLETE-PRO-NBR,                     56530000
565400                    :SHIPMT-COMPLETE-BOL-NBR,                     56540000
565500                    :SHIPMT-PROCESSED-DTE,                        56550000
565600                    :SHIPMT-INVC-NBR,                             56560002
565610                    :SHIPMT-CARR-AUTH-ID                          56561002
565700               FROM TSHIPMT                                       56570000
565800              WHERE PRO_SCAC_ID = :DK-PRO-SCAC-ID                 56580000
565900                AND PRO_NBR     = :DK-PRO-NBR                     56590000
566000         END-EXEC                                                 56600000
566100                                                                  56610000
566200         EVALUATE TRUE                                            56620000
566300             WHEN SQLCODE = ZERO                                  56630000
566400             WHEN SQLCODE = +100                                  56640000
566500             WHEN SQLCODE = -911                                  56650000
566600                 CONTINUE                                         56660000
566700                                                                  56670000
566800             WHEN SQLCODE = -811                                  56680000
566900                 SET PS-DUPLICATE-SHIPMT TO TRUE                  56690000
567000                                                                  56700000
567100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              56710000
567200                 DISPLAY '**************************************' 56720000
567300                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 56730000
567400                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               56740000
567500                          PV-SHIPMT-PRO-NBR                       56750000
567600                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               56760000
567700                          PV-SHIPMT-BOL-NBR                       56770000
567800                 DISPLAY '**********************************'     56780000
567900                 PERFORM 9700-SQL-WARNING                         56790000
568000                                                                  56800000
568100             WHEN SQLCODE < ZERO                                  56810000
568200                 DISPLAY '**************************************' 56820000
568300                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 56830000
568400                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               56840000
568500                          PV-SHIPMT-PRO-NBR                       56850000
568600                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               56860000
568700                          PV-SHIPMT-BOL-NBR                       56870000
568800                 DISPLAY '**************************************' 56880000
568900                 PERFORM 9800-SQL-ERROR                           56890000
569000                                                                  56900000
569100         END-EVALUATE                                             56910000
569200                                                                  56920000
569300     END-PERFORM.                                                 56930000
569400                                                                  56940000
569500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    56950000
569600         SQLCODE NOT = +0                                         56960000
569700         DISPLAY '**************************************'         56970000
569800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         56980000
569900         DISPLAY 'SELECT TSHIPMT                        '         56990000
570000         DISPLAY 'PV-SHIPMT-PRO-NBR:      '                       57000000
570100                  PV-SHIPMT-PRO-NBR                               57010000
570200         DISPLAY 'PV-SHIPMT-BOL-NBR:      '                       57020000
570300                  PV-SHIPMT-BOL-NBR                               57030000
570400         DISPLAY '**************************************'         57040000
570500         PERFORM 9800-SQL-ERROR                                   57050000
570600     END-IF.                                                      57060000
570700                                                                  57070000
570800                                                                  57080000
570900***************************************************************** 57090000
571000*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 57100000
571100*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 57110000
571200*--- MATCH= -BOL- -SCAC-                                        * 57120000
571300***************************************************************** 57130000
571400 7038-SELECT-SHIPMT.                                              57140000
571500     MOVE '7038-SELECT-SHIPMT'   TO PV-ABEND-PARAGRAPH.           57150000
571600                                                                  57160000
571700     PERFORM                                                      57170000
571800         WITH TEST AFTER                                          57180000
571900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     57190000
572000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            57200000
572100                 SQLCODE = ZERO    OR                             57210000
572200                 SQLCODE = +100    OR                             57220000
572300                 SQLCODE = -811                                   57230000
572400                                                                  57240000
572500         EXEC SQL                                                 57250045
572600             SELECT TRIP_ID,                                      57260045
572700                    SHIPT_ID,                                     57270045
572800                    CRT_SRC_CDE,                                  57280045
572900                    LAST_UPD_DTE,                                 57290045
573000                    LAST_UPD_TME,                                 57300045
573100                    LAST_UPD_UID,                                 57310045
573200                    PRO_SCAC_ID,                                  57320045
573300                    PRO_NBR,                                      57330045
573400                    BOL_NBR,                                      57340045
573500                    SHIPPER_NME,                                  57350045
573600                    SHIPT_TYP_CDE,                                57360045
573700                    EXPTED_GRO_WGHT,                              57370045
573800                    PKG_TYP_CDE,                                  57380045
573900                    EXPTED_PKG_QTY,                               57390045
574000                    FRGT_CHG_AMT,                                 57400045
574100                    FRGT_TERMS_CDE,                               57410045
574200                    EXPTED_PLT_QTY,                               57420045
574300                    EST_AR_TMST,                                  57430045
574400                    VEND_SHIP_DTE,                                57440045
574500                    ORIG_SCAC_ID,                                 57450045
574600                    LAST_UPD_PGM_ID,                              57460045
574700                    CRE_USER_ID,                                  57470045
574800                    CARR_CART_CT,                                 57480045
574900                    CARR_LAST_UPD_DTE,                            57490045
575000                    CARR_LAST_UPD_TIME,                           57500045
575100                    VEND_CART_CT,                                 57510045
575200                    VEND_LAST_UPD_DTE,                            57520045
575300                    VEND_LAST_UPD_TIME,                           57530045
575400                    VEH_NBR,                                      57540045
575500                    AUTH_NBR,                                     57550045
575600                    AUTH_DTE,                                     57560045
575700                    CONFIRM_DTE,                                  57570045
575800                    CONFIRM_TIME,                                 57580045
575900                    COMPLETE_PRO_NBR,                             57590045
576000                    COMPLETE_BOL_NBR,                             57600045
576100                    PROCESSED_DTE,                                57610045
576200                    INVC_NBR,                                     57620045
576300                    CARR_AUTH_ID                                  57630045
576400               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    57640045
576500                    :SHIPMT-SHIPT-ID,                             57650045
576600                    :SHIPMT-CRT-SRC-CDE,                          57660045
576700                    :SHIPMT-LAST-UPD-DTE,                         57670045
576800                    :SHIPMT-LAST-UPD-TME,                         57680045
576900                    :SHIPMT-LAST-UPD-UID,                         57690045
577000                    :SHIPMT-PRO-SCAC-ID,                          57700045
577100                    :SHIPMT-PRO-NBR,                              57710045
577200                    :SHIPMT-BOL-NBR,                              57720045
577300                    :SHIPMT-SHIPPER-NME,                          57730045
577400                    :SHIPMT-SHIPT-TYP-CDE,                        57740045
577500                    :SHIPMT-EXPTED-GRO-WGHT,                      57750045
577600                    :SHIPMT-PKG-TYP-CDE,                          57760045
577700                    :SHIPMT-EXPTED-PKG-QTY,                       57770045
577800                    :SHIPMT-FRGT-CHG-AMT,                         57780045
577900                    :SHIPMT-FRGT-TERMS-CDE,                       57790045
578000                    :SHIPMT-EXPTED-PLT-QTY,                       57800045
578100                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 57810045
578200                    :SHIPMT-VEND-SHIP-DTE,                        57820045
578300                    :SHIPMT-ORIG-SCAC-ID,                         57830045
578400                    :SHIPMT-LAST-UPD-PGM-ID,                      57840045
578500                    :SHIPMT-CRE-USER-ID,                          57850045
578600                    :SHIPMT-CARR-CART-CT,                         57860045
578700                    :SHIPMT-CARR-LAST-UPD-DTE,                    57870045
578800                    :SHIPMT-CARR-LAST-UPD-TIME,                   57880045
578900                    :SHIPMT-VEND-CART-CT,                         57890045
579000                    :SHIPMT-VEND-LAST-UPD-DTE,                    57900045
579100                    :SHIPMT-VEND-LAST-UPD-TIME,                   57910045
579200                    :SHIPMT-VEH-NBR,                              57920045
579300                    :SHIPMT-AUTH-NBR,                             57930045
579400                    :SHIPMT-AUTH-DTE,                             57940045
579500                    :SHIPMT-CONFIRM-DTE,                          57950045
579600                    :SHIPMT-CONFIRM-TIME,                         57960045
579700                    :SHIPMT-COMPLETE-PRO-NBR,                     57970045
579800                    :SHIPMT-COMPLETE-BOL-NBR,                     57980045
579900                    :SHIPMT-PROCESSED-DTE,                        57990045
580000                    :SHIPMT-INVC-NBR,                             58000045
580100                    :SHIPMT-CARR-AUTH-ID                          58010045
580200               FROM TSHIPMT                                       58020045
580300              WHERE PRO_SCAC_ID = :DK-PRO-SCAC-ID                 58030045
580400                AND BOL_NBR     = :DK-BOL-NBR                     58040045
580464***             AND NOT PRO_NBR > :PC-PRO-SPACES                  58046445
580465                AND NOT PRO_NBR = 'MIXEDSKU'                      58046545
580466         END-EXEC                                                 58046645
580470                                                                  58047000
580500         EVALUATE TRUE                                            58050000
580600             WHEN SQLCODE = ZERO                                  58060000
580700             WHEN SQLCODE = +100                                  58070000
580800             WHEN SQLCODE = -911                                  58080000
580900                 CONTINUE                                         58090000
581000                                                                  58100000
581100             WHEN SQLCODE = -811                                  58110000
581200                 SET PS-DUPLICATE-SHIPMT TO TRUE                  58120000
581300                                                                  58130000
581400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              58140000
581500                 DISPLAY '**************************************' 58150000
581600                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 58160000
581700                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               58170000
581800                          PV-SHIPMT-PRO-NBR                       58180000
581900                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               58190000
582000                          PV-SHIPMT-BOL-NBR                       58200000
582100                 DISPLAY '**********************************'     58210000
582200                 PERFORM 9700-SQL-WARNING                         58220000
582300                                                                  58230000
582400             WHEN SQLCODE < ZERO                                  58240000
582500                 DISPLAY '**************************************' 58250000
582600                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 58260000
582700                 DISPLAY 'PV-SHIPMT-PRO-NBR:      '               58270000
582800                          PV-SHIPMT-PRO-NBR                       58280000
582900                 DISPLAY 'PV-SHIPMT-BOL-NBR:      '               58290000
583000                          PV-SHIPMT-BOL-NBR                       58300000
583100                 DISPLAY '**************************************' 58310000
583200                 PERFORM 9800-SQL-ERROR                           58320000
583300                                                                  58330000
583400         END-EVALUATE                                             58340000
583500                                                                  58350000
583600     END-PERFORM.                                                 58360000
583700                                                                  58370000
583800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58380000
583900         SQLCODE NOT = +0                                         58390000
584000         DISPLAY '**************************************'         58400000
584100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         58410000
584200         DISPLAY 'SELECT TSHIPMT                        '         58420000
584300         DISPLAY 'PV-SHIPMT-PRO-NBR:      '                       58430000
584400                  PV-SHIPMT-PRO-NBR                               58440000
584500         DISPLAY 'PV-SHIPMT-BOL-NBR:      '                       58450000
584600                  PV-SHIPMT-BOL-NBR                               58460000
584700         DISPLAY '**************************************'         58470000
584800         PERFORM 9800-SQL-ERROR                                   58480000
584900     END-IF.                                                      58490000
585000                                                                  58500000
585100***************************************************************** 58510000
585200*     SQL UPDATE SHIPMT                                         * 58520000
585300*                                                               * 58530000
585400***************************************************************** 58540000
585500                                                                  58550000
585600 7040-UPDATE-SHIPMT.                                              58560000
585700                                                                  58570000
585800     MOVE '7040-UPDATE-SHIPMT'   TO PV-ABEND-PARAGRAPH.           58580000
585820                                                                  58582002
586000     PERFORM                                                      58600000
586100         WITH TEST AFTER                                          58610000
586200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     58620000
586300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            58630000
586400                 SQLCODE = ZERO                                   58640000
586500                                                                  58650000
586600         EXEC SQL                                                 58660000
586700             UPDATE TSHIPMT                                       58670000
586800                SET LAST_UPD_DTE  =  CURRENT DATE,                58680002
586900                    LAST_UPD_TME  =  CURRENT TIME,                58690002
587000                    LAST_UPD_UID  = :PC-RCKUP006,                 58700002
587100                    PRO_NBR       = :PV-SHIPMT-PRO-NBR,           58710002
587200                    BOL_NBR       = :PV-SHIPMT-BOL-NBR,           58720002
587300                    EXPTED_GRO_WGHT = :PV-SHIPMT-EXPTED-GRO-WGHT, 58730000
587400                    VEH_NBR       = :PV-SHIPMT-VEH-NBR,           58740002
587500                    VEND_LAST_UPD_DTE  = CURRENT DATE,            58750000
587600                    VEND_LAST_UPD_TIME = CURRENT TIME,            58760000
587700                    VEND_CART_CT  = :PV-SHIPMT-VEND-CARTON-CNT,   58770002
587710                    CARR_AUTH_ID  = :PV-SHIPMT-CARR-AUTH-ID       58771005
587800              WHERE SHIPT_ID      = :SHIPMT-SHIPT-ID              58780002
587900         END-EXEC                                                 58790000
588000                                                                  58800000
588100         EVALUATE TRUE                                            58810000
588200             WHEN SQLCODE = ZERO                                  58820000
588210                 ADD +1 TO PV-UPDATE-TSHIPMT                      58821000
588300             WHEN SQLCODE = -911                                  58830000
588400                 CONTINUE                                         58840000
588500                                                                  58850000
588600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              58860000
588700                 DISPLAY '**************************************' 58870000
588800                 DISPLAY 'WARNING ISSUED ON UPDATE OF TSHIPMT   ' 58880000
588900                 DISPLAY 'PV-SHIPMT-SHIPT-ID:      '              58890000
589000                          PV-SHIPMT-SHIPT-ID                      58900000
589100                 DISPLAY '**********************************'     58910000
589200                 PERFORM 9700-SQL-WARNING                         58920000
589300                                                                  58930000
589400             WHEN SQLCODE < ZERO                                  58940000
589500                 DISPLAY '**************************************' 58950000
589600                 DISPLAY 'ERROR ISSUED ON UPDATE OF TSHIPMT     ' 58960000
589700                 DISPLAY 'PV-SHIPMT-SHIPT-ID:      '              58970000
589800                          PV-SHIPMT-SHIPT-ID                      58980000
589900                 DISPLAY '**************************************' 58990000
590000                 PERFORM 9800-SQL-ERROR                           59000000
590100                                                                  59010000
590200         END-EVALUATE                                             59020000
590300                                                                  59030000
590400     END-PERFORM.                                                 59040000
590500                                                                  59050000
590600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    59060000
590700         SQLCODE NOT = +0                                         59070000
590800         DISPLAY '**************************************'         59080000
590900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         59090000
591000         DISPLAY 'UPDATE TSHIPMT                        '         59100000
591100         DISPLAY 'PV-SHIPMT-SHIPT-ID:      '                      59110000
591200                  PV-SHIPMT-SHIPT-ID                              59120000
591300         DISPLAY 'PV-SHIPMT-PRO-NBR:       '                      59130000
591400                  PV-SHIPMT-PRO-NBR                               59140000
591500         DISPLAY 'PV-SHIPMT-BOL-NBR:       '                      59150000
591600                  PV-SHIPMT-BOL-NBR                               59160000
591700         DISPLAY '**************************************'         59170000
591800         PERFORM 9800-SQL-ERROR                                   59180000
591900     END-IF.                                                      59190000
592000                                                                  59200000
592100                                                                  59210000
592200 EJECT                                                            59220000
592300***************************************************************** 59230000
592400*     SQL INSERT SHIPMT                                         * 59240000
592500*                                                               * 59250000
592600***************************************************************** 59260000
592700                                                                  59270000
592800 7050-INSERT-SHIPMT.                                              59280000
592900                                                                  59290000
593000     MOVE '7050-INSERT-SHIPMT'   TO PV-ABEND-PARAGRAPH.           59300000
593100                                                                  59310000
593200     PERFORM                                                      59320000
593300         WITH TEST AFTER                                          59330000
593400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     59340000
593500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            59350000
593600                (SQLCODE = ZERO) OR (SQLCODE = -803))             59360000
593700                                                                  59370000
593800         EXEC SQL                                                 59380000
593900             INSERT INTO TSHIPMT                                  59390000
594000                   (TRIP_ID,                                      59400000
594100                    SHIPT_ID,                                     59410000
594200                    CRT_SRC_CDE,                                  59420000
594300                    LAST_UPD_DTE,                                 59430000
594400                    LAST_UPD_TME,                                 59440000
594500                    LAST_UPD_UID,                                 59450000
594600                    PRO_SCAC_ID,                                  59460000
594700                    PRO_NBR,                                      59470000
594800                    BOL_NBR,                                      59480000
594900                    SHIPPER_NME,                                  59490000
595000                    SHIPT_TYP_CDE,                                59500000
595100                    EXPTED_GRO_WGHT,                              59510000
595200                    PKG_TYP_CDE,                                  59520000
595300                    EXPTED_PKG_QTY,                               59530000
595400                    FRGT_CHG_AMT,                                 59540000
595500                    FRGT_TERMS_CDE,                               59550000
595600                    EXPTED_PLT_QTY,                               59560000
595700                    VEND_SHIP_DTE,                                59570000
595800                    EST_AR_TMST,                                  59580000
595900                    ORIG_SCAC_ID,                                 59590000
596000                    LAST_UPD_PGM_ID,                              59600000
596100                    CRE_USER_ID,                                  59610000
596200                    CARR_LAST_UPD_DTE,                            59620000
596300                    CARR_LAST_UPD_TIME,                           59630000
596400                    VEND_CART_CT,                                 59640000
596500                    VEND_LAST_UPD_DTE,                            59650000
596600                    VEND_LAST_UPD_TIME,                           59660000
596700                    VEH_NBR,                                      59670000
596800                    AUTH_DTE,                                     59680000
596900                    CONFIRM_DTE,                                  59690000
597000                    CONFIRM_TIME,                                 59700000
597100                    COMPLETE_PRO_NBR,                             59710000
597200                    COMPLETE_BOL_NBR,                             59720000
597300                    PROCESSED_DTE,                                59730002
597310                    CARR_AUTH_ID)                                 59731002
597400             VALUES                                               59740000
597500                  (:PV-SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,  59750000
597600                   :PV-SHIPMT-SHIPT-ID,                           59760000
597700                   :PC-CE,                                        59770000
597800                   CURRENT DATE,                                  59780000
597900                   CURRENT TIME,                                  59790000
598000                   :PC-RCKUP006,                                  59800000
598100                   :PV-SHIPMT-PRO-SCAC-ID,                        59810000
598200                   :PV-SHIPMT-PRO-NBR,                            59820000
598300                   :PV-SHIPMT-BOL-NBR,                            59830000
598400                   :PV-SHIPMT-SHIPPER-NME,                        59840000
598500                   :PC-DEFAULT-SHIPT-TYP-CDE,                     59850000
598600                   :PV-SHIPMT-EXPTED-GRO-WGHT,                    59860000
598700                   :PV-SHIPMT-PKG-TYP-CDE,                        59870000
598800                   :PC-INT-ZERO,                                  59880000
598900                   :PV-SHIPMT-FRGT-CHG-AMT,                       59890000
599000                   :PV-SHIPMT-FRGT-TERMS-CDE,                     59900000
599100                   :PV-SHIPMT-EXPTED-PLT-QTY,                     59910000
599200                   :PV-SHIPMT-VEND-SHIP-DTE,                      59920000
599300                   :PV-SHIPMT-EST-AR-TMST :PV-SHIPMT-EST-AR-NULL, 59930000
599400                   :PV-SHIPMT-ORIGIN-SCAC-ID,                     59940000
599500                   :PC-RCKUP006,                                  59950000
599600                   :PC-RCKUP006,                                  59960000
599700                   :PC-DEFAULT-DATE,                              59970000
599800                   :PC-DEFAULT-TIME,                              59980000
599900                   :PV-SHIPMT-VEND-CARTON-CNT,                    59990000
600000                    CURRENT DATE,                                 60000000
600100                    CURRENT TIME,                                 60010000
600200                   :PV-SHIPMT-VEH-NBR,                            60020000
600300                   :PC-DEFAULT-DATE,                              60030000
600400                   :PC-DEFAULT-DATE,                              60040000
600500                   :PC-DEFAULT-TIME,                              60050000
600600                   :PV-SHIPMT-COMP-PRO,                           60060000
600700                   :PV-SHIPMT-COMP-BOL,                           60070000
600800                   :PC-DEFAULT-DATE,                              60080002
600810                   :PV-SHIPMT-CARR-AUTH-ID)                       60081002
600900         END-EXEC                                                 60090000
601000                                                                  60100000
601100         EVALUATE TRUE                                            60110000
601200             WHEN SQLCODE = ZERO                                  60120000
601210                 ADD +1 TO PV-ADD-TSHIPMT                         60121000
601300             WHEN SQLCODE = -803                                  60130000
601310                 ADD +1 TO PV-ADD-TSHIPMT-FAIL-DUPE               60131000
601400             WHEN SQLCODE = -911                                  60140000
601500                 CONTINUE                                         60150000
601600                                                                  60160000
601700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              60170000
601800                 DISPLAY '**************************************' 60180000
601900                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHIPMT   ' 60190000
602000                 DISPLAY 'PV-SHIPMT-SHIPT-ID:    '                60200000
602100                          PV-SHIPMT-SHIPT-ID                      60210000
602200                 DISPLAY 'PV-SHIPMT-BOL-NBR:     '                60220000
602300                          PV-SHIPMT-BOL-NBR                       60230000
602400                 DISPLAY 'PV-SHIPMT-PRO-NBR:   '                  60240000
602500                          PV-SHIPMT-PRO-NBR                       60250000
602600                 DISPLAY '**********************************'     60260000
602700                 PERFORM 9700-SQL-WARNING                         60270000
602800                                                                  60280000
602900             WHEN SQLCODE < ZERO                                  60290000
603000                 DISPLAY '**************************************' 60300000
603100                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHIPMT     ' 60310000
603200                 DISPLAY 'PV-SHIPMT-SHIPT-ID:    '                60320000
603300                          PV-SHIPMT-SHIPT-ID                      60330000
603400                 DISPLAY 'PV-SHIPMT-BOL-NBR:     '                60340000
603500                          PV-SHIPMT-BOL-NBR                       60350000
603600                 DISPLAY 'PV-SHIPMT-PRO-NBR:   '                  60360000
603700                          PV-SHIPMT-PRO-NBR                       60370000
603800                 DISPLAY '**************************************' 60380000
603900                 PERFORM 9800-SQL-ERROR                           60390000
604000                                                                  60400000
604100         END-EVALUATE                                             60410000
604200     END-PERFORM.                                                 60420000
604300                                                                  60430000
604400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60440000
604500         SQLCODE NOT = +0                                         60450000
604600         DISPLAY '**************************************'         60460000
604700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         60470000
604800         DISPLAY 'INSERT TO TSHIPMT                     '         60480000
604900         DISPLAY 'PV-SHIPMT-SHIPT-ID:      '                      60490000
605000                  PV-SHIPMT-SHIPT-ID                              60500000
605100         DISPLAY 'PV-SHIPMT-PRO-NBR:       '                      60510000
605200                  PV-SHIPMT-PRO-NBR                               60520000
605300         DISPLAY 'PV-SHIPMT-BOL-NBR:       '                      60530000
605400                  PV-SHIPMT-BOL-NBR                               60540000
605500         DISPLAY '**************************************'         60550000
605600         PERFORM 9800-SQL-ERROR                                   60560000
605700     END-IF.                                                      60570000
605800                                                                  60580000
605900     EVALUATE TRUE                                                60590000
606000         WHEN SQLCODE = -803                                      60600000
606100             PERFORM 7040-UPDATE-SHIPMT                           60610000
606200     END-EVALUATE.                                                60620000
606300                                                                  60630000
606400 EJECT                                                            60640000
606500***************************************************************** 60650000
606600*     CHECK THE SQLCODE FROM THE SELECT OF THE TSHIPMT.  MOVE   * 60660000
606700*     FIELDS AS APPROPRIATE.                                    * 60670000
606800***************************************************************** 60680000
606900                                                                  60690000
607000 7060-CHECK-SHIPMT-SQLCODE.                                       60700000
607100                                                                  60710000
607200     MOVE '7060-CHECK-SHIPMT-SQLCODE'                             60720000
607300                                 TO PV-ABEND-PARAGRAPH.           60730000
607400                                                                  60740000
607500     EVALUATE TRUE                                                60750000
607600         WHEN SQLCODE = ZERO                                      60760000
607700             IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                 60770000
607800                 MOVE ZEROS      TO PV-SHIPMT-TRIP-ID             60780000
607900             ELSE                                                 60790000
608000                 MOVE SHIPMT-TRIP-ID                              60800000
608100                                 TO PV-SHIPMT-TRIP-ID             60810000
608200             END-IF                                               60820000
608300             MOVE PV-SHIPMT-TRIP-ID                               60830000
608400                                 TO PV-SAVE-SHIPMT-TRIP-ID        60840000
608500             MOVE SHIPMT-SHIPT-ID                                 60850000
608600                                 TO PV-SHIPMT-SHIPT-ID            60860000
608700                                    PV-SHIPST-SHIPT-ID            60870000
608800                                    PV-SHPTPO-SHIPT-ID            60880000
608900                                    PV-PKSLIP-SHIPT-ID            60890000
609000             MOVE SHIPMT-CRT-SRC-CDE                              60900000
609100                                 TO PV-SHIPMT-CRT-SRC-CDE         60910000
609200             MOVE SHIPMT-LAST-UPD-DTE                             60920000
609300                                 TO PV-SHIPMT-LAST-UPD-DTE        60930000
609400             MOVE SHIPMT-LAST-UPD-TME                             60940000
609500                                 TO PV-SHIPMT-LAST-UPD-TME        60950000
609600             MOVE SHIPMT-LAST-UPD-UID                             60960000
609700                                 TO PV-SHIPMT-LAST-UPD-UID        60970000
609800             MOVE SHIPMT-PRO-SCAC-ID                              60980000
609900                                 TO PV-SHIPMT-PRO-SCAC-ID         60990000
610000             MOVE SHIPMT-SHIPPER-NME                              61000000
610100                                 TO PV-SHIPMT-SHIPPER-NME         61010000
610200             MOVE SHIPMT-SHIPT-TYP-CDE                            61020000
610300                                 TO PV-SHIPMT-SHIPT-TYP-CDE       61030000
610400             MOVE SHIPMT-EXPTED-GRO-WGHT                          61040000
610500                                 TO PV-SHIPMT-EXPTED-GRO-WGHT     61050000
610600             MOVE SHIPMT-PKG-TYP-CDE                              61060000
610700                                 TO PV-SHIPMT-PKG-TYP-CDE         61070000
610800             MOVE SHIPMT-EXPTED-PKG-QTY                           61080000
610900                                 TO PV-SHIPMT-EXPTED-PKG-QTY      61090000
611000             MOVE SHIPMT-FRGT-CHG-AMT                             61100000
611100                                 TO PV-SHIPMT-FRGT-CHG-AMT        61110000
611200             MOVE SHIPMT-FRGT-TERMS-CDE                           61120000
611300                                 TO PV-SHIPMT-FRGT-TERMS-CDE      61130000
611400             MOVE SHIPMT-EXPTED-PLT-QTY                           61140000
611500                                 TO PV-SHIPMT-EXPTED-PLT-QTY      61150000
611600             MOVE SHIPMT-EST-AR-TMST                              61160000
611700                                 TO PV-SHIPMT-EST-AR-TMST         61170000
611800             MOVE SHIPMT-CARR-CART-CT                             61180000
611900                                 TO PV-SHIPMT-CARR-CARTON-CNT     61190000
612000             MOVE SHIPMT-ORIG-SCAC-ID                             61200000
612100                                 TO PV-SHIPMT-ORIGIN-SCAC-ID      61210000
612200             MOVE SHIPMT-VEH-NBR TO PV-SHIPMT-VEH-NBR             61220000
612220             MOVE SHIPMT-CARR-AUTH-ID TO PV-SHIPMT-CARR-AUTH-ID   61222002
612300             PERFORM 7080-SELECT-SHIP-STATUS                      61230000
612400         WHEN SQLCODE = +100                                      61240000
612500         WHEN SQLCODE = -811                                      61250000
612600             MOVE ZERO TO PV-SHIPMT-TRIP-ID                       61260000
612700             SET PS-INSERT-SHIPMT                                 61270000
612800                                 TO TRUE                          61280000
612900     END-EVALUATE.                                                61290000
613000                                                                  61300000
613100***************************************************************** 61310000
613200*     CHECK IF THE TRIP STATUS RECORD ALREADY EXIST.  ALSO      * 61320000
613300*     NEED TO DETERMINE WHAT PROGRAM PUT IT INTO THAT STATUS.   * 61330000
613400***************************************************************** 61340000
613500                                                                  61350000
613600 7070-PROCESS-TRIPST.                                             61360000
613700                                                                  61370000
613800     MOVE '7070-PROCESS-TRIPST'  TO PV-ABEND-PARAGRAPH.           61380000
613900     MOVE PV-TRIPST-TRIP-STATUS-CDE                               61390000
614000                                 TO SHIPST-SHIPT-STATUS-CDE.      61400000
614100                                                                  61410000
614200     PERFORM 7071-SELECT-TRIPST.                                  61420000
614300                                                                  61430000
614400     IF PS-INSERT-TRIPST                                          61440000
614500         PERFORM 7072-FORMAT-TRIPST                               61450000
614600         PERFORM 7074-INSERT-TRIPST                               61460000
614700     ELSE                                                         61470000
614800         IF PS-UPDATE-TRIPST                                      61480000
614900             PERFORM 7072-FORMAT-TRIPST                           61490000
615000             PERFORM 7073-UPDATE-TRIPST                           61500000
615100         END-IF                                                   61510000
615200     END-IF.                                                      61520000
615300                                                                  61530000
615400 EJECT                                                            61540000
615500***************************************************************** 61550000
615600*     DETERMINE WHETHER A TRIP STATUS RECORD SHOULD BE INSERTED * 61560000
615700*     OR UPDATED.                                               * 61570000
615800***************************************************************** 61580000
615900                                                                  61590000
616000 7071-SELECT-TRIPST.                                              61600000
616100                                                                  61610000
616200     MOVE '7071-SELECT-TRIPST'   TO PV-ABEND-PARAGRAPH.           61620000
616300                                                                  61630000
616400     MOVE PC-EN                  TO TRIPST-TRIP-STATUS-CDE.       61640000
616500                                                                  61650000
616600     PERFORM                                                      61660000
616700         WITH TEST AFTER                                          61670000
616800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     61680000
616900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            61690000
617000                (SQLCODE = ZERO)   OR                             61700000
617100                (SQLCODE = +100)                                  61710000
617200                                                                  61720000
617300         EXEC SQL                                                 61730000
617400             SELECT TRIP_ID,                                      61740000
617500                    TRIP_STATUS_CDE,                              61750000
617600                    STATUS_DTE,                                   61760000
617700                    STATUS_TME,                                   61770000
617800                    STATUS_UID,                                   61780000
617900                    OPER_UNT_ID,                                  61790000
618000                    FCLTY_ID,                                     61800000
618100                    FCLTY_AREA_ID                                 61810000
618200               INTO :TRIPST-TRIP-ID,                              61820000
618300                    :TRIPST-TRIP-STATUS-CDE,                      61830000
618400                    :TRIPST-STATUS-DTE,                           61840000
618500                    :TRIPST-STATUS-TME,                           61850000
618600                    :TRIPST-STATUS-UID,                           61860000
618700                    :TRIPST-OPER-UNT-ID,                          61870000
618800                    :TRIPST-FCLTY-ID,                             61880000
618900                    :TRIPST-FCLTY-AREA-ID                         61890000
619000               FROM TTRIPST                                       61900000
619100              WHERE TRIP_ID         = :PV-TRIPST-TRIP-ID          61910000
619200                AND TRIP_STATUS_CDE = :TRIPST-TRIP-STATUS-CDE     61920000
619300         END-EXEC                                                 61930000
619400                                                                  61940000
619500         EVALUATE TRUE                                            61950000
619600             WHEN SQLCODE = ZERO                                  61960000
619700             WHEN SQLCODE = +100                                  61970000
619800             WHEN SQLCODE = -911                                  61980000
619900                 CONTINUE                                         61990000
620000                                                                  62000000
620100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              62010000
620200                 DISPLAY '**************************************' 62020000
620300                 DISPLAY 'WARNING ISSUED ON SELECT OF TTRIPST   ' 62030000
620400                 DISPLAY 'PV-TRIPST-TRIP-ID: '                    62040000
620500                          PV-TRIPST-TRIP-ID                       62050000
620600                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               62060000
620700                          TRIPST-TRIP-STATUS-CDE                  62070000
620800                 DISPLAY '**********************************'     62080000
620900                 PERFORM 9700-SQL-WARNING                         62090000
621000                                                                  62100000
621100             WHEN  SQLCODE < ZERO                                 62110000
621200                 DISPLAY '**************************************' 62120000
621300                 DISPLAY 'ERROR ISSUED ON SELECT OF TTRIPST     ' 62130000
621400                 DISPLAY 'PV-TRIPST-TRIP-ID: '                    62140000
621500                          PV-TRIPST-TRIP-ID                       62150000
621600                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               62160000
621700                          TRIPST-TRIP-STATUS-CDE                  62170000
621800                 DISPLAY '**************************************' 62180000
621900                 PERFORM 9800-SQL-ERROR                           62190000
622000                                                                  62200000
622100         END-EVALUATE                                             62210000
622200                                                                  62220000
622300     END-PERFORM.                                                 62230000
622400                                                                  62240000
622500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    62250000
622600         SQLCODE NOT = +0                                         62260000
622700         DISPLAY '**************************************'         62270000
622800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         62280000
622900         DISPLAY 'SELECT TTRIPST                        '         62290000
623000         DISPLAY 'PV-TRIPST-TRIP-ID: '                            62300000
623100                  PV-TRIPST-TRIP-ID                               62310000
623200         DISPLAY 'TRIPST-TRIP-STATUS-CDE: '                       62320000
623300                  TRIPST-TRIP-STATUS-CDE                          62330000
623400         DISPLAY '**************************************'         62340000
623500         PERFORM 9800-SQL-ERROR                                   62350000
623600     END-IF.                                                      62360000
623700                                                                  62370000
623800     EVALUATE TRUE                                                62380000
623900         WHEN SQLCODE = ZERO                                      62390000
624000             IF TRIPST-STATUS-UID = PC-TRKUP004 OR                62400000
624100                TRIPST-STATUS-UID = PC-RCKUP006                   62410000
624200                 SET PS-UPDATE-TRIPST                             62420000
624300                                 TO TRUE                          62430000
624400             ELSE                                                 62440000
624500                 SET PS-BYPASS-TRIPST                             62450000
624600                                 TO TRUE                          62460000
624700             END-IF                                               62470000
624800         WHEN SQLCODE = +100                                      62480000
624900             SET PS-INSERT-TRIPST                                 62490000
625000                                 TO TRUE                          62500000
625100     END-EVALUATE.                                                62510000
625200 EJECT                                                            62520000
625300***************************************************************** 62530000
625400*    MOVE FIELDS FROM HOLD AREA TO DATABASE                     * 62540000
625500***************************************************************** 62550000
625600                                                                  62560000
625700 7072-FORMAT-TRIPST.                                              62570000
625800                                                                  62580000
625900     MOVE '7072-FORMAT-TRIPST'   TO PV-ABEND-PARAGRAPH.           62590000
626000                                                                  62600000
626100     MOVE PV-TRIPST-STATUS-DTE                                    62610000
626200                                 TO TRIPST-STATUS-DTE.            62620000
626300     MOVE PV-TRIPST-STATUS-TME                                    62630000
626400                                 TO TRIPST-STATUS-TME.            62640000
626500                                                                  62650000
626600     MOVE PV-TRIPST-TRIP-ID      TO TRIPST-TRIP-ID.               62660000
626700     MOVE PV-TRIPST-OPER-UNT-ID  TO TRIPST-OPER-UNT-ID.           62670000
626800     MOVE PV-TRIPST-FCLTY-ID     TO TRIPST-FCLTY-ID.              62680000
626900     MOVE PV-TRIPST-FCLTY-AREA-ID                                 62690000
627000                                 TO TRIPST-FCLTY-AREA-ID.         62700000
627100                                                                  62710000
627200 EJECT                                                            62720000
627300***************************************************************** 62730000
627400*     SQL UPDATE TRIP STATUS                                    * 62740000
627500***************************************************************** 62750000
627600                                                                  62760000
627700 7073-UPDATE-TRIPST.                                              62770000
627800                                                                  62780000
627900     MOVE '7073-UPDATE-TRIPST'   TO PV-ABEND-PARAGRAPH.           62790000
628000                                                                  62800000
628100     PERFORM                                                      62810000
628200         WITH TEST AFTER                                          62820000
628300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     62830000
628400         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            62840000
628500                (SQLCODE = ZERO OR +100)                          62850000
628600                                                                  62860000
628700         EXEC SQL                                                 62870000
628800             UPDATE TTRIPST                                       62880000
628900                SET STATUS_DTE      = CURRENT DATE,               62890000
629000                    STATUS_TME      = CURRENT TIME,               62900000
629100                    STATUS_UID      = :PC-RCKUP006,               62910000
629200                    OPER_UNT_ID     = :TRIPST-OPER-UNT-ID,        62920000
629300                    FCLTY_ID        = :TRIPST-FCLTY-ID,           62930000
629400                    FCLTY_AREA_ID   = :TRIPST-FCLTY-AREA-ID       62940000
629500              WHERE TRIP_ID         = :TRIPST-TRIP-ID             62950000
629600                AND TRIP_STATUS_CDE = :TRIPST-TRIP-STATUS-CDE     62960000
629700         END-EXEC                                                 62970000
629800                                                                  62980000
629900         EVALUATE TRUE                                            62990000
630000             WHEN SQLCODE = ZERO                                  63000000
630010                 ADD +1 TO PV-UPDATE-TTRIPST                      63001000
630100             WHEN SQLCODE = +100                                  63010000
630200             WHEN SQLCODE = -911                                  63020000
630300                 CONTINUE                                         63030000
630400                                                                  63040000
630500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              63050000
630600                 DISPLAY '**************************************' 63060000
630700                 DISPLAY 'WARNING ISSUED ON UPDATE OF TTRIPST   ' 63070000
630800                 DISPLAY 'TRIPST-TRIP-ID:         '               63080000
630900                          TRIPST-TRIP-ID                          63090000
631000                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               63100000
631100                          TRIPST-TRIP-STATUS-CDE                  63110000
631200                 DISPLAY '**********************************'     63120000
631300                 PERFORM 9700-SQL-WARNING                         63130000
631400                                                                  63140000
631500             WHEN SQLCODE < ZERO                                  63150000
631600                 DISPLAY '**************************************' 63160000
631700                 DISPLAY 'ERROR ISSUED ON UPDATE OF TTRIPST     ' 63170000
631800                 DISPLAY 'TRIPST-TRIP-ID:         '               63180000
631900                          TRIPST-TRIP-ID                          63190000
632000                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               63200000
632100                          TRIPST-TRIP-STATUS-CDE                  63210000
632200                 DISPLAY 'TRIPST-OPER-UNT-ID: '                   63220000
632300                          TRIPST-OPER-UNT-ID                      63230000
632400                 DISPLAY 'TRIPST-FCLTY-ID: '                      63240000
632500                          TRIPST-FCLTY-ID                         63250000
632600                 DISPLAY 'TRIPST-FCLTY-AREA-ID: '                 63260000
632700                          TRIPST-FCLTY-AREA-ID                    63270000
632800                 DISPLAY '**************************************' 63280000
632900                 PERFORM 9800-SQL-ERROR                           63290000
633000                                                                  63300000
633100         END-EVALUATE                                             63310000
633200     END-PERFORM.                                                 63320000
633300                                                                  63330000
633400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    63340000
633500         SQLCODE NOT = +0                                         63350000
633600         DISPLAY '**************************************'         63360000
633700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         63370000
633800         DISPLAY 'UPDATE TO TTRIPST                     '         63380000
633900         DISPLAY 'TRIPST-TRIP-ID:         '                       63390000
634000                  TRIPST-TRIP-ID                                  63400000
634100         DISPLAY 'TRIPST-TRIP-STATUS-CDE: '                       63410000
634200                  TRIPST-TRIP-STATUS-CDE                          63420000
634300         DISPLAY 'PV-SHIPMT-PRO-NBR:      '                       63430000
634400                  PV-SHIPMT-PRO-NBR                               63440000
634500         DISPLAY 'PV-SHIPMT-BOL-NBR:      '                       63450000
634600                  PV-SHIPMT-BOL-NBR                               63460000
634700         DISPLAY '**************************************'         63470000
634800         PERFORM 9800-SQL-ERROR                                   63480000
634900     END-IF.                                                      63490000
635000                                                                  63500000
635100***************************************************************** 63510000
635200*     SQL INSERT TRIP STATUS                                    * 63520000
635300***************************************************************** 63530000
635400                                                                  63540000
635500 7074-INSERT-TRIPST.                                              63550000
635600                                                                  63560000
635700     MOVE '7074-INSERT-TRIPST'   TO PV-ABEND-PARAGRAPH.           63570000
635800                                                                  63580000
635900     PERFORM                                                      63590000
636000         WITH TEST AFTER                                          63600000
636100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     63610000
636200         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            63620000
636300                (SQLCODE = ZERO)                                  63630000
636400                                                                  63640000
636500         EXEC SQL                                                 63650000
636600             INSERT INTO TTRIPST                                  63660000
636700                   (TRIP_ID,                                      63670000
636800                    TRIP_STATUS_CDE,                              63680000
636900                    STATUS_DTE,                                   63690000
637000                    STATUS_TME,                                   63700000
637100                    STATUS_UID,                                   63710000
637200                    OPER_UNT_ID,                                  63720000
637300                    FCLTY_ID,                                     63730000
637400                    FCLTY_AREA_ID)                                63740000
637500             VALUES                                               63750000
637600                  (:TRIPST-TRIP-ID,                               63760000
637700                   :TRIPST-TRIP-STATUS-CDE,                       63770000
637800                    CURRENT DATE,                                 63780000
637900                    CURRENT TIME,                                 63790000
638000                   :PC-RCKUP006,                                  63800000
638100                   :TRIPST-OPER-UNT-ID,                           63810000
638200                   :TRIPST-FCLTY-ID,                              63820000
638300                   :TRIPST-FCLTY-AREA-ID)                         63830000
638400         END-EXEC                                                 63840000
638500                                                                  63850000
638600         EVALUATE TRUE                                            63860000
638700             WHEN SQLCODE = ZERO                                  63870000
638710                 ADD +1 TO PV-ADD-TTRIPST                         63871000
638800             WHEN SQLCODE = +100                                  63880000
638900             WHEN SQLCODE = -911                                  63890000
639000                 CONTINUE                                         63900000
639100                                                                  63910000
639200             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              63920000
639300                 DISPLAY '**************************************' 63930000
639400                 DISPLAY 'WARNING ISSUED ON INSERT OF TTRIPST   ' 63940000
639500                 DISPLAY 'TRIPST-TRIP-ID:       '                 63950000
639600                          TRIPST-TRIP-ID                          63960000
639700                 DISPLAY '**********************************'     63970000
639800                 PERFORM 9700-SQL-WARNING                         63980000
639900                                                                  63990000
640000             WHEN SQLCODE < ZERO                                  64000000
640100                 DISPLAY '**************************************' 64010000
640200                 DISPLAY 'ERROR ISSUED ON INSERT OF TTRIPST     ' 64020000
640300                 DISPLAY 'TRIPST-TRIP-ID:       '                 64030000
640400                          TRIPST-TRIP-ID                          64040000
640500                 DISPLAY 'TRIPST-OPER-UNT-ID: '                   64050000
640600                          TRIPST-OPER-UNT-ID                      64060000
640700                 DISPLAY 'TRIPST-FCLTY-ID: '                      64070000
640800                          TRIPST-FCLTY-ID                         64080000
640900                 DISPLAY 'TRIPST-FCLTY-AREA-ID: '                 64090000
641000                          TRIPST-FCLTY-AREA-ID                    64100000
641100                 DISPLAY '**************************************' 64110000
641200                 PERFORM 9800-SQL-ERROR                           64120000
641300                                                                  64130000
641400         END-EVALUATE                                             64140000
641500     END-PERFORM.                                                 64150000
641600                                                                  64160000
641700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    64170000
641800         SQLCODE NOT = +0                                         64180000
641900         DISPLAY '**************************************'         64190000
642000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         64200000
642100         DISPLAY 'INSERT TO TTRIPST                     '         64210000
642200         DISPLAY 'TRIPST-TRIP-ID:       '                         64220000
642300                  TRIPST-TRIP-ID                                  64230000
642400         DISPLAY 'PV-SHIPMT-PRO-NBR:    '                         64240000
642500                  PV-SHIPMT-PRO-NBR                               64250000
642600         DISPLAY 'PV-SHIPMT-BOL-NBR:    '                         64260000
642700                  PV-SHIPMT-BOL-NBR                               64270000
642800         DISPLAY '**************************************'         64280000
642900         PERFORM 9800-SQL-ERROR                                   64290000
643000     END-IF.                                                      64300000
643100                                                                  64310000
643200 7080-SELECT-SHIP-STATUS.                                         64320000
643300                                                                  64330000
643400     MOVE '7080-SELECT-SHIP-STATUS'                               64340000
643500                                 TO PV-ABEND-PARAGRAPH.           64350000
643600                                                                  64360000
643700     PERFORM                                                      64370000
643800         WITH TEST AFTER                                          64380000
643900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     64390000
644000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            64400000
644100                 SQLCODE = ZERO OR                                64410000
644200                 SQLCODE = +100                                   64420000
644300                                                                  64430000
644400         EXEC SQL                                                 64440000
644500           SELECT B.PRTY_CDE                                      64450000
644600           INTO  :SHSTYP-PRTY-CDE                                 64460000
644700           FROM   TSHIPST A                                       64470000
644800                 ,TSHSTYP B                                       64480000
644900           WHERE  A.SHIPT_ID         = :PV-SHIPMT-SHIPT-ID        64490000
645000             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         64500000
645100             AND  B.PRTY_CDE =                                    64510000
645200                  (SELECT MAX(D.PRTY_CDE)                         64520000
645300                     FROM TSHIPST C                               64530000
645400                         ,TSHSTYP D                               64540000
645500                    WHERE C.SHIPT_ID        = A.SHIPT_ID          64550000
645600                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)64560000
645700         END-EXEC                                                 64570000
645800                                                                  64580000
645900         EVALUATE TRUE                                            64590000
646000             WHEN SQLCODE = ZERO                                  64600000
646100             WHEN SQLCODE = +100                                  64610000
646200             WHEN SQLCODE = -911                                  64620000
646300                 CONTINUE                                         64630000
646400                                                                  64640000
646500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              64650000
646600                 DISPLAY '**************************************' 64660000
646700                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHSTYP   ' 64670000
646800                 DISPLAY 'PV-SHIPMT-SHIPT-ID: '                   64680000
646900                          PV-SHIPMT-SHIPT-ID                      64690000
647000                 DISPLAY '**********************************'     64700000
647100                 PERFORM 9700-SQL-WARNING                         64710000
647200                                                                  64720000
647300             WHEN SQLCODE < ZERO                                  64730000
647400                 DISPLAY '**************************************' 64740000
647500                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHSTYP     ' 64750000
647600                 DISPLAY 'PV-SHIPMT-SHIPT-ID: '                   64760000
647700                          PV-SHIPMT-SHIPT-ID                      64770000
647800                 DISPLAY '**************************************' 64780000
647900                 PERFORM 9800-SQL-ERROR                           64790000
648000                                                                  64800000
648100         END-EVALUATE                                             64810000
648200                                                                  64820000
648300     END-PERFORM.                                                 64830000
648400                                                                  64840000
648500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    64850000
648600         SQLCODE NOT = +0                                         64860000
648700         DISPLAY '**************************************'         64870000
648800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         64880000
648900         DISPLAY 'SELECT TSHSTYP                        '         64890000
649000         DISPLAY 'PV-SHIPMT-SHIPT-ID: '                           64900000
649100                  PV-SHIPMT-SHIPT-ID                              64910000
649200         DISPLAY '**************************************'         64920000
649300         PERFORM 9800-SQL-ERROR                                   64930000
649400     END-IF.                                                      64940000
649500                                                                  64950000
649600     IF SQLCODE = ZERO                                            64960000
649700         IF SHSTYP-PRTY-CDE > PC-49                               64970000
649800             SET PS-DONT-UPDATE-SHIPMT                            64980000
649900                 PS-BYPASS-UPDATES                                64990000
650000                                 TO TRUE                          65000000
650100         ELSE                                                     65010000
650200             SET PS-UPDATE-SHIPMT                                 65020000
650300                                 TO TRUE                          65030000
650400         END-IF                                                   65040000
650500     ELSE                                                         65050000
650600         SET PS-UPDATE-SHIPMT                                     65060000
650700                             TO TRUE                              65070000
650800     END-IF.                                                      65080000
650900                                                                  65090000
651000                                                                  65100000
651100 EJECT                                                            65110000
651200*----------------------------------------------------------------*65120000
651300*    INSERT A PACK SLIP HEADER ROW                               *65130000
651400*----------------------------------------------------------------*65140000
651500                                                                  65150000
651600 7100-INSERT-TPKSLIP.                                             65160000
651700                                                                  65170000
651800     MOVE '7100-INSERT-TPKSLIP' TO PV-ABEND-PARAGRAPH.            65180000
651900                                                                  65190000
652000     PERFORM                                                      65200000
652100         WITH TEST AFTER                                          65210000
652200         VARYING PV-RETRY-COUNTER                                 65220000
652300         FROM 1 BY 1                                              65230000
652400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65240000
652500             OR (SQLCODE = +0)                                    65250000
652600             OR (SQLCODE = -803))                                 65260000
652700                                                                  65270000
652800         EXEC SQL                                                 65280000
652900              INSERT INTO TPKSLIP                                 65290000
653000                     (PO_NBR,                                     65300000
653100                      SEQ_NBR,                                    65310000
653200                      CRE_TMST,                                   65320000
653300                      VER_STAT_CDE,                               65330000
653400                      OPER_UNT_ID,                                65340000
653500                      FCLTY_ID,                                   65350000
653600                      PKSL_NBR,                                   65360000
653700                      STR_DEST_NBR,                               65370000
653800                      REC_SEQ_NBR,                                65380000
653900                      SHIPT_ID,                                   65390000
654000                      BOL_NBR,                                    65400000
654100                      PRO_NBR,                                    65410000
654200                      PKSL_STAT_CDE,                              65420000
654300                      CRE_UID,                                    65430000
654400                      PO_VER_NBR,                                 65440000
654500                      CRE_SRC_CDE,                                65450000
654600                      EXPTED_PKG_QTY,                             65460000
654700                      OWNER_SCAC_ID,                              65470000
654800                      ASN_NBR,                                    65480000
654900                      VEND_SHIP_DTE,                              65490000
655000                      CONTNR_ID)                                  65500000
655100              VALUES (:PKSLIP-PO-NBR,                             65510000
655200                      :PKSLIP-SEQ-NBR,                            65520000
655300                       CURRENT TIMESTAMP,                         65530000
655400                      :PKSLIP-VER-STAT-CDE,                       65540000
655500                      :PKSLIP-OPER-UNT-ID,                        65550000
655600                      :PKSLIP-FCLTY-ID,                           65560000
655700                      :PKSLIP-PKSL-NBR,                           65570000
655800                      :PKSLIP-STR-DEST-NBR,                       65580000
655900                      :PKSLIP-REC-SEQ-NBR,                        65590000
656000                      :PKSLIP-SHIPT-ID,                           65600000
656100                      :PKSLIP-BOL-NBR,                            65610000
656200                      :PKSLIP-PRO-NBR,                            65620000
656300                      :PKSLIP-PKSL-STAT-CDE,                      65630000
656400                      :PKSLIP-CRE-UID,                            65640000
656500                      :PKSLIP-PO-VER-NBR,                         65650000
656600                      :PKSLIP-CRE-SRC-CDE,                        65660000
656700                      :PKSLIP-EXPTED-PKG-QTY,                     65670000
656800                      :PKSLIP-OWNER-SCAC-ID,                      65680000
656900                      :PKSLIP-ASN-NBR,                            65690000
657000                      :PKSLIP-VEND-SHIP-DTE,                      65700000
657100                      :PKSLIP-CONTNR-ID)                          65710000
657200         END-EXEC                                                 65720000
657300                                                                  65730000
657400         EVALUATE TRUE                                            65740000
657500             WHEN SQLCODE = +0                                    65750000
657510                 ADD +1 TO PV-ADD-TPKSLIP                         65751000
657600             WHEN SQLCODE = -803                                  65760000
657610                 ADD +1 TO PV-ADD-TPKSLIP-FAIL-DUPE               65761000
657700             WHEN SQLCODE = -911                                  65770000
657800                  CONTINUE                                        65780000
657900                                                                  65790000
658000             WHEN SQLWARN0 NOT = SPACES                           65800000
658100             WHEN SQLCODE < +0                                    65810000
658200             WHEN SQLCODE > +0                                    65820000
658300                  MOVE 'UNSUCCESSFUL INSERT FOR TPKSLIP'          65830000
658400                                 TO PV-DB2-OPERATION-ATTEMPTED    65840000
658500                 PERFORM 9100-SQL-ABEND                           65850000
658600         END-EVALUATE                                             65860000
658700     END-PERFORM.                                                 65870000
658800                                                                  65880000
658900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         65890000
659000       AND SQLCODE NOT = +0                                       65900000
659100         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TPKSLIP'        65910000
659200                                 TO PV-DB2-OPERATION-ATTEMPTED    65920000
659300         PERFORM 9100-SQL-ABEND                                   65930000
659400     ELSE                                                         65940000
659600         SET PS-WRITE-CTN-REC-YES TO TRUE                         65960000
659700     END-IF.                                                      65970000
659800                                                                  65980000
659900*----------------------------------------------------------------*65990000
660000*    INSERT A PACK SLIP ITEM ROW                                 *66000000
660100*----------------------------------------------------------------*66010000
660200                                                                  66020000
660300 7200-INSERT-TPKITEM.                                             66030000
660400     MOVE '7200-INSERT-TPKITEM' TO PV-ABEND-PARAGRAPH.            66040000
660500                                                                  66050000
660600     PERFORM                                                      66060000
660700         WITH TEST AFTER                                          66070000
660800         VARYING PV-RETRY-COUNTER                                 66080000
660900         FROM 1 BY 1                                              66090000
661000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               66100000
661100             OR (SQLCODE = +0))                                   66110000
661200                                                                  66120000
661300         EXEC SQL                                                 66130000
661400              INSERT INTO TPKITEM                                 66140000
661500                     (PO_NBR,                                     66150000
661600                      SEQ_NBR,                                    66160000
661700                      PKSL_LNE_NBR,                               66170000
661800                      CRE_TMST,                                   66180000
661900                      VER_STAT_CDE,                               66190000
662000                      PKSL_ITM_QTY,                               66200000
662100                      CRE_UID,                                    66210000
662200                      PURITM_VER_NBR,                             66220000
662300                      ORIG_PKSL_ITM_QTY)                          66230000
662400              VALUES (:PKITEM-PO-NBR,                             66240000
662500                      :PKITEM-SEQ-NBR,                            66250000
662600                      :PKITEM-PKSL-LNE-NBR,                       66260000
662700                       CURRENT TIMESTAMP,                         66270000
662800                      :PKITEM-VER-STAT-CDE,                       66280000
662900                      :PKITEM-PKSL-ITM-QTY,                       66290000
663000                      :PKITEM-CRE-UID,                            66300000
663100                      :PKITEM-PURITM-VER-NBR,                     66310000
663200                      :PKITEM-PKSL-ITM-QTY)                       66320000
663300         END-EXEC                                                 66330000
663400                                                                  66340000
663500         EVALUATE TRUE                                            66350000
663600             WHEN SQLCODE = +0                                    66360000
663610                 ADD +1 TO PV-ADD-TPKITEM                         66361000
663700             WHEN SQLCODE = -911                                  66370000
663800                  CONTINUE                                        66380000
663900                                                                  66390000
664000             WHEN SQLWARN0 NOT = SPACES                           66400000
664100             WHEN SQLCODE < +0                                    66410000
664200             WHEN SQLCODE > +0                                    66420000
664300                  MOVE 'UNSUCCESSFUL INSERT FOR TPKITEM'          66430000
664400                         TO PV-DB2-OPERATION-ATTEMPTED            66440000
664500                  PERFORM 9100-SQL-ABEND                          66450000
664600         END-EVALUATE                                             66460000
664700     END-PERFORM.                                                 66470000
664800                                                                  66480000
664900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    66490000
665000         SQLCODE NOT = +0                                         66500000
665100         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TPKITEM'        66510000
665200                TO PV-DB2-OPERATION-ATTEMPTED                     66520000
665300         PERFORM 9100-SQL-ABEND                                   66530000
665400     END-IF.                                                      66540000
665500                                                                  66550000
665600 7300-SELECT-TPURITM-DATA.                                        66560000
665700     MOVE '7300-SELECT-TPURITM-DATA' TO PV-ABEND-PARAGRAPH.       66570000
665800                                                                  66580000
665900     PERFORM WITH TEST AFTER                                      66590000
666000         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    66600000
666100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             66610000
666200                 SQLCODE = ZERO OR                                66620000
666300                 SQLCODE = +100 OR                                66630000
666400                 SQLCODE = -811                                   66640000
666500                                                                  66650000
666600         EXEC SQL                                                 66660000
666700               SELECT VER_NBR,                                    66670000
666800                      STATUS_CDE                                  66680000
666900                 INTO :PURITM-VER-NBR,                            66690000
667000                      :PURITM-STATUS-CDE                          66700000
667100                 FROM TPURITM                                     66710000
667200                WHERE PO_NBR         = :DK-PO-NBR                 66720000
667300                  AND APP_PO_LNE_NBR = :PKITEM-PKSL-LNE-NBR       66730000
667400                  AND VER_STATUS_CDE = :PC-A                      66740000
667500         END-EXEC                                                 66750000
667600                                                                  66760000
667700         EVALUATE TRUE                                            66770000
667800             WHEN SQLCODE = ZERO                                  66780000
667900             WHEN SQLCODE = +100                                  66790000
668000             WHEN SQLCODE = -811                                  66800000
668100             WHEN SQLCODE = -911                                  66810000
668200                  CONTINUE                                        66820000
668300                                                                  66830000
668400             WHEN SQLWARN0 NOT = SPACES                           66840000
668500             WHEN SQLCODE  NOT = ZERO                             66850000
668600                  MOVE 'UNSUCCESSFUL SELECT OF TPURITM DATA'      66860000
668700                                 TO PV-DB2-OPERATION-ATTEMPTED    66870000
668800                  PERFORM 9100-SQL-ABEND                          66880000
668900         END-EVALUATE                                             66890000
669000     END-PERFORM.                                                 66900000
669100                                                                  66910000
669200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     66920000
669300         SQLCODE NOT = +0                                         66930000
669400         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO STATUS'          66940000
669500                                 TO PV-DB2-OPERATION-ATTEMPTED    66950000
669600         PERFORM 9100-SQL-ABEND                                   66960000
669700     END-IF.                                                      66970000
669800                                                                  66980000
669900/                                                                 66990000
670000*----------------------------------------------------------------*67000000
670100*    FIND THE ROW WITH THE HIGHEST SEQUENCE NUMBER               *67010000
670200*----------------------------------------------------------------*67020000
670300                                                                  67030000
670400 7400-GET-NEXT-SEQ-NBR.                                           67040000
670500     MOVE '7400-GET-NEXT-SEQ-NBR' TO PV-ABEND-PARAGRAPH.          67050000
670600                                                                  67060000
670700     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             67070000
670800                                                                  67080000
670900     PERFORM                                                      67090000
671000         WITH TEST AFTER                                          67100000
671100         VARYING PV-RETRY-COUNTER                                 67110000
671200         FROM 1 BY 1                                              67120000
671300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67130000
671400             OR (SQLCODE = +0)                                    67140000
671500             OR (SQLCODE = +100))                                 67150000
671600                                                                  67160000
671700         EXEC SQL                                                 67170000
671800               SELECT MAX(SEQ_NBR)                                67180000
671900                INTO :PV-MAX-SEQ-NBR :PV-SEQ-NBR-IND              67190000
672000                FROM TPKSLIP                                      67200000
672100               WHERE PO_NBR = :PKSLIP-PO-NBR                      67210000
672200         END-EXEC                                                 67220000
672300                                                                  67230000
672400         EVALUATE TRUE                                            67240000
672500             WHEN SQLCODE = +0                                    67250000
672600                  COMPUTE PV-NEXT-SEQ-NBR =                       67260000
672700                          PV-MAX-SEQ-NBR + 1                      67270000
672800                                                                  67280000
672900             WHEN SQLCODE = +100                                  67290000
673000                  MOVE +1          TO PV-NEXT-SEQ-NBR             67300000
673100                                                                  67310000
673200             WHEN SQLCODE = -911                                  67320000
673300                  CONTINUE                                        67330000
673400                                                                  67340000
673500             WHEN SQLWARN0 NOT = SPACES                           67350000
673600             WHEN SQLCODE < +0                                    67360000
673700             WHEN SQLCODE > +0                                    67370000
673800                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          67380000
673900                                 TO PV-DB2-OPERATION-ATTEMPTED    67390000
674000                  PERFORM 9100-SQL-ABEND                          67400000
674100         END-EVALUATE                                             67410000
674200     END-PERFORM.                                                 67420000
674300                                                                  67430000
674400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    67440000
674500         SQLCODE NOT = +0                                         67450000
674600         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        67460000
674700                        TO PV-DB2-OPERATION-ATTEMPTED             67470000
674800         PERFORM 9100-SQL-ABEND                                   67480000
674900     END-IF.                                                      67490000
675000                                                                  67500000
675100*----------------------------------------------------------------*67510000
675200*    RETRIEVE THE VERSION NUMBER OF THE PURCHASE ORDER           *67520000
675300*----------------------------------------------------------------*67530000
675400 7500-GET-PO-VER-NBR.                                             67540000
675500     MOVE '7500-GET-PO-VER-NBR' TO PV-ABEND-PARAGRAPH.            67550000
675600                                                                  67560000
675700     PERFORM                                                      67570000
675800         WITH TEST AFTER                                          67580000
675900         VARYING PV-RETRY-COUNTER                                 67590000
676000         FROM 1 BY 1                                              67600000
676100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67610000
676200             OR (SQLCODE = +0)                                    67620000
676300             OR (SQLCODE = +100))                                 67630000
676400                                                                  67640000
676500         EXEC SQL                                                 67650000
676600              SELECT VER_NBR                                      67660000
676700                    ,STATUS_CDE                                   67670000
676800                INTO :PURCHS-VER-NBR                              67680000
676900                    ,:PURCHS-STATUS-CDE                           67690000
677000                FROM TPURCHS                                      67700000
677100               WHERE PO_NBR         = :PKSLIP-PO-NBR              67710000
677200                 AND VER_STATUS_CDE = :PC-A                       67720000
677300         END-EXEC                                                 67730000
677400                                                                  67740000
677500         EVALUATE TRUE                                            67750000
677600             WHEN SQLCODE = +0                                    67760000
677700             WHEN SQLCODE = -911                                  67770000
677800                  CONTINUE                                        67780000
677900                                                                  67790000
678000             WHEN SQLCODE = +100                                  67800000
678100                  MOVE ZEROS       TO PURCHS-VER-NBR              67810000
678200                  MOVE SPACES      TO PURCHS-STATUS-CDE           67820000
678300                                                                  67830000
678400             WHEN SQLWARN0 NOT = SPACES                           67840000
678500             WHEN SQLCODE < +0                                    67850000
678600             WHEN SQLCODE > +0                                    67860000
678700                  MOVE 'UNSUCCESSFUL SELECT ON PO HEADER'         67870000
678800                                TO PV-DB2-OPERATION-ATTEMPTED     67880000
678900                  PERFORM 9100-SQL-ABEND                          67890000
679000         END-EVALUATE                                             67900000
679100     END-PERFORM.                                                 67910000
679200                                                                  67920000
679300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    67930000
679400         SQLCODE NOT = +0                                         67940000
679500         MOVE 'MAX RETRIES EXCEEDED ON SELECT FOR PO VER NBR'     67950000
679600                                TO PV-DB2-OPERATION-ATTEMPTED     67960000
679700         PERFORM 9100-SQL-ABEND                                   67970000
679800     END-IF.                                                      67980000
679900                                                                  67990000
680000 7600-OPEN-INST-CURSOR.                                           68000000
680100     INITIALIZE DCLTPOINST                                        68010000
680200                DCLTINSTCD.                                       68020000
680300     EXEC SQL                                                     68030000
680400         OPEN SP_INSTR_CSR                                        68040000
680500     END-EXEC.                                                    68050000
680600                                                                  68060000
680700     EVALUATE TRUE                                                68070000
680800         WHEN SQLCODE = ZERO                                      68080000
680900             CONTINUE                                             68090000
681000         WHEN SQLWARN0 NOT = SPACE                                68100000
681100         WHEN SQLCODE < ZERO                                      68110000
681200         WHEN SQLCODE > ZERO                                      68120000
681300             MOVE '7600-OPEN-INST-CURSOR'                         68130000
681400                 TO PV-ABEND-PARAGRAPH                            68140000
681500             MOVE 'OPEN THE STR_NBR_CSR'                          68150000
681600                 TO PV-DB2-OPERATION-ATTEMPTED                    68160000
681700             PERFORM 9100-SQL-ABEND                               68170000
681800     END-EVALUATE.                                                68180000
681900                                                                  68190000
682000 7700-FETCH-INST-CURSOR.                                          68200000
682070                                                                  68207026
682200     EXEC SQL                                                     68220000
682300         FETCH  SP_INSTR_CSR                                      68230000
682400          INTO  :INSTCD-INSTR-DESC                                68240000
682500     END-EXEC.                                                    68250000
682600                                                                  68260000
682700     EVALUATE TRUE                                                68270000
682800         WHEN SQLCODE = +100                                      68280000
682900             SET PS-NO-MORE-INST TO TRUE                          68290000
683000         WHEN SQLCODE = ZERO                                      68300000
683100             MOVE INSTCD-INSTR-DESC TO                            68310000
683200                      WS-HOLD-SPECIAL-INSTR (SPEC-INST-IDX)       68320000
683300         WHEN SQLWARN0 NOT = SPACE                                68330000
683400         WHEN SQLCODE < ZERO                                      68340000
683500         WHEN SQLCODE > ZERO                                      68350000
683600             MOVE '7700-FETCH-INST-CURSOR'                        68360000
683700                 TO PV-ABEND-PARAGRAPH                            68370000
683800             MOVE 'ATTEMPTING TO FETCH A ROW FROM SP_INSTR_CSR'   68380000
683900                 TO PV-DB2-OPERATION-ATTEMPTED                    68390000
684000             PERFORM 9100-SQL-ABEND                               68400000
684100     END-EVALUATE.                                                68410000
684200                                                                  68420000
684300 7800-CLOSE-INST-CURSOR.                                          68430000
684400     EXEC SQL                                                     68440000
684500         CLOSE SP_INSTR_CSR                                       68450000
684600     END-EXEC.                                                    68460000
684700                                                                  68470000
684800     EVALUATE TRUE                                                68480000
684900         WHEN SQLCODE = ZERO                                      68490000
685000             CONTINUE                                             68500000
685100         WHEN SQLWARN0 NOT = SPACE                                68510000
685200         WHEN SQLCODE < ZERO                                      68520000
685300         WHEN SQLCODE > ZERO                                      68530000
685400             MOVE '7800-CLOSE-INST-CURSOR'                        68540000
685500                 TO PV-ABEND-PARAGRAPH                            68550000
685600             MOVE 'CLOSE THE STR_NBR_CSR'                         68560000
685700                 TO PV-DB2-OPERATION-ATTEMPTED                    68570000
685800             PERFORM 9100-SQL-ABEND                               68580000
685900     END-EVALUATE.                                                68590000
686000                                                                  68600000
686100 7900-WRITE-RECEIVER-FILE.                                        68610000
686306                                                                  68630600
686321         MOVE RC004-ASN-RECEIVING-RECORD                          68632100
686322                                 TO RCT00035-RCVG-RCRD004-ODR.    68632200
686330         PERFORM 7920-INSERT-RCTW-OUT15.                          68633000
686400                                                                  68640000
686500     MOVE ZERO TO RC004-CALC-CARTONS.                             68650000
686600                                                                  68660000
686610     ADD +1    TO PV-RCVR-RECS-OUT.                               68661000
686621                                                                  68662100
686720                                                                  68672000
686721 7920-INSERT-RCTW-OUT15.                                          68672100
686729     MOVE '7920-INSERT-RCTW-OUT15' TO PV-ABEND-PARAGRAPH.         68672900
686730                                                                  68673000
686731     PERFORM                                                      68673100
686732         WITH TEST AFTER                                          68673200
686733         VARYING PV-RETRY-COUNTER                                 68673300
686734         FROM 1 BY 1                                              68673400
686735         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               68673500
686736             OR (SQLCODE = +0))                                   68673600
686737                                                                  68673700
686738         EXEC SQL                                                 68673800
686739              INSERT INTO RCTW_OUT15                              68673900
686740                     (RCVG_RCRD004_ODR)                           68674000
686741              VALUES (:RCT00035-RCVG-RCRD004-ODR)                 68674100
686742         END-EXEC                                                 68674200
686743                                                                  68674300
686744         EVALUATE TRUE                                            68674400
686745             WHEN SQLCODE = +0                                    68674500
686746             WHEN SQLCODE = -911                                  68674600
686747                  CONTINUE                                        68674700
686748                                                                  68674800
686749             WHEN SQLWARN0 NOT = SPACES                           68674900
686750             WHEN SQLCODE < +0                                    68675000
686751             WHEN SQLCODE > +0                                    68675100
686752                  MOVE 'UNSUCCESSFUL INSERT TO RCTW_OUT15'        68675200
686753                         TO PV-DB2-OPERATION-ATTEMPTED            68675300
686754                  PERFORM 9800-SQL-ERROR                          68675400
686755         END-EVALUATE                                             68675500
686756     END-PERFORM.                                                 68675600
686757                                                                  68675700
686758     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    68675800
686759         SQLCODE NOT = +0                                         68675900
686760         MOVE 'MAX RETRIES EXCEEDED FOR INSERT RCTW_OUT15'        68676000
686761                TO PV-DB2-OPERATION-ATTEMPTED                     68676100
686762         PERFORM 9800-SQL-ERROR                                   68676200
686763     END-IF.                                                      68676300
686770                                                                  68677000
686800 7950-VERIFY-LSD-CARR-SCAC.                                       68680000
686900                                                                  68690000
687000     MOVE '7950-VERIFY-LSD-CARR-SCAC'                             68700000
687100                                 TO PV-ABEND-PARAGRAPH.           68710000
687200                                                                  68720000
687300     PERFORM                                                      68730000
687400         WITH TEST AFTER                                          68740000
687500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     68750000
687600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            68760000
687700                 SQLCODE = ZERO OR                                68770000
687800                 SQLCODE = +100                                   68780000
687900                                                                  68790000
688000         EXEC SQL                                                 68800000
688100             SELECT ENT_ID                                        68810000
688200               INTO :EXTENT-ENT-ID                                68820000
688300               FROM TEXTENT                                       68830000
688400              WHERE SCAC_CDE    = :DK-PRO-SCAC-ID                 68840000
688500                AND CARRIER_IND = :PC-Y                           68850000
688600         END-EXEC                                                 68860000
688700                                                                  68870000
688800         EVALUATE TRUE                                            68880000
688900             WHEN SQLCODE = ZERO                                  68890000
689000             WHEN SQLCODE = +100                                  68900000
689100             WHEN SQLCODE = -911                                  68910000
689200                 CONTINUE                                         68920000
689300                                                                  68930000
689400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              68940000
689500                 DISPLAY '**************************************' 68950000
689600                 DISPLAY 'WARNING ISSUED ON SELECT OF TEXTENT   ' 68960000
689700                 DISPLAY 'DK-PRO-SCAC-ID         '                68970000
689800                          DK-PRO-SCAC-ID                          68980000
689900                 DISPLAY '**********************************'     68990000
690000                 PERFORM 9700-SQL-WARNING                         69000000
690100                                                                  69010000
690200             WHEN SQLCODE < ZERO                                  69020000
690300                 DISPLAY '**************************************' 69030000
690400                 DISPLAY 'ERROR ISSUED ON SELECT OF TEXTENT     ' 69040000
690500                 DISPLAY 'DK-PRO-SCAC-ID         '                69050000
690600                          DK-PRO-SCAC-ID                          69060000
690700                 DISPLAY '**************************************' 69070000
690800                 PERFORM 9800-SQL-ERROR                           69080000
690900                                                                  69090000
691000         END-EVALUATE                                             69100000
691100     END-PERFORM.                                                 69110000
691200                                                                  69120000
691300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    69130000
691400         SQLCODE NOT = +0                                         69140000
691500         DISPLAY '**************************************'         69150000
691600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         69160000
691700         DISPLAY 'SELECT TEXTENT                        '         69170000
691800         DISPLAY 'DK-PRO-SCAC-ID         '                        69180000
691900                  DK-PRO-SCAC-ID                                  69190000
692000         DISPLAY '**************************************'         69200000
692100         PERFORM 9800-SQL-ERROR                                   69210000
692200     END-IF.                                                      69220000
692300                                                                  69230000
692400     IF SQLCODE = ZERO                                            69240000
692500         MOVE RC001-CARRIER-SCAC-CODE                             69250000
692600                             TO PV-VEHICL-CARR-SCAC-ID            69260000
692700                                PV-VHTRIP-CARR-SCAC-ID            69270000
692800                                PV-SHIPMT-PRO-SCAC-ID             69280000
692900                                PV-SHIPMT-ORIGIN-SCAC-ID          69290000
693000                                                                  69300000
693100     ELSE                                                         69310000
693200         MOVE SPACES         TO PV-VEHICL-CARR-SCAC-ID            69320000
693300                                PV-VHTRIP-CARR-SCAC-ID            69330000
693400                                PV-SHIPMT-PRO-SCAC-ID             69340000
693500                                PV-SHIPMT-ORIGIN-SCAC-ID          69350000
693600                                DK-PRO-SCAC-ID                    69360000
693700     END-IF.                                                      69370000
693800                                                                  69380000
693900                                                                  69390000
694000 7955-VERIFY-CARRIER.                                             69400000
694100                                                                  69410000
694200     MOVE '7950-VERIFY-LSD-CARR-SCAC'                             69420000
694300                                 TO PV-ABEND-PARAGRAPH.           69430000
694400                                                                  69440000
694500     PERFORM                                                      69450000
694600         WITH TEST AFTER                                          69460000
694700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     69470000
694800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            69480000
694900                 SQLCODE = ZERO OR                                69490000
695000                 SQLCODE = +100                                   69500000
695100                                                                  69510000
695200         EXEC SQL                                                 69520000
695300             SELECT CRE_ASN_FCST_IND                              69530000
695400               INTO :EXTENT-CRE-ASN-FCST-IND                      69540000
695500               FROM TEXTENT                                       69550000
695600              WHERE DUN_NBR     = :DK-DUN-NBR                     69560000
695700         END-EXEC                                                 69570000
695800                                                                  69580000
695900         EVALUATE TRUE                                            69590000
696000             WHEN SQLCODE = ZERO                                  69600000
696100             WHEN SQLCODE = +100                                  69610000
696200             WHEN SQLCODE = -811                                  69620000
696300             WHEN SQLCODE = -911                                  69630000
696400                 CONTINUE                                         69640000
696500                                                                  69650000
696600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              69660000
696700                 DISPLAY '**************************************' 69670000
696800                 DISPLAY 'WARNING ISSUED ON SELECT OF TEXTENT   ' 69680000
696900                 DISPLAY 'DK-DUN-NBR             '                69690000
697000                          DK-DUN-NBR                              69700000
697100                 DISPLAY '**********************************'     69710000
697200                 PERFORM 9700-SQL-WARNING                         69720000
697300                                                                  69730000
697400             WHEN SQLCODE < ZERO                                  69740000
697500                 DISPLAY '**************************************' 69750000
697600                 DISPLAY 'ERROR ISSUED ON SELECT OF TEXTENT     ' 69760000
697700                 DISPLAY 'DK-DUN-NBR             '                69770000
697800                          DK-DUN-NBR                              69780000
697900                 DISPLAY '**************************************' 69790000
698000                 PERFORM 9800-SQL-ERROR                           69800000
698100                                                                  69810000
698200         END-EVALUATE                                             69820000
698300     END-PERFORM.                                                 69830000
698400                                                                  69840000
698500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    69850000
698600         SQLCODE NOT = +0                                         69860000
698700         DISPLAY '**************************************'         69870000
698800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         69880000
698900         DISPLAY 'SELECT TEXTENT                        '         69890000
699000         DISPLAY 'DK-DUN-NBR             '                        69900000
699100                  DK-DUN-NBR                                      69910000
699200         DISPLAY '**************************************'         69920000
699300         PERFORM 9800-SQL-ERROR                                   69930000
699400     END-IF.                                                      69940000
699500                                                                  69950000
699600     EVALUATE TRUE                                                69960000
699700         WHEN SQLCODE = ZERO                                      69970000
699800         WHEN SQLCODE = -811                                      69980000
699900             MOVE EXTENT-CRE-ASN-FCST-IND                         69990000
700000                                 TO PS-FORECAST-SHIP-SW           70000000
700100                                                                  70010000
700200         WHEN SQLCODE = +100                                      70020000
700300             SET PS-INVALID-VENDOR                                70030000
700400                                 TO TRUE                          70040000
700500             SET PS-NOT-FORECAST-SHIP-MODE                        70050000
700600                                 TO TRUE                          70060000
700700                                                                  70070000
700800     END-EVALUATE.                                                70080000
700900                                                                  70090000
701000***************************************************************** 70100000
701100*     DO A SELECT ON VEHICL USING THE SCAC-ID AND VEH-NBR.      * 70110000
701200*     THIS WILL DETERMINE WHETHER THE RECORD SHOULD BE AN       * 70120000
701300*     INSERT OR AN UPDATE.                                      * 70130000
701400***************************************************************** 70140000
701500                                                                  70150000
701600 7960-SELECT-VEHICL.                                              70160000
701700                                                                  70170000
701800     MOVE '7960-SELECT-VEHICL'   TO PV-ABEND-PARAGRAPH.           70180000
701900                                                                  70190000
702000     PERFORM                                                      70200000
702100         WITH TEST AFTER                                          70210000
702200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     70220000
702300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            70230000
702400                 SQLCODE = ZERO    OR                             70240000
702500                 SQLCODE = +100                                   70250000
702600                                                                  70260000
702700         EXEC SQL                                                 70270000
702800             SELECT OWNER_SCAC_ID,                                70280000
702900                    VEH_NBR,                                      70290000
703000                    CRT_SRC_CDE,                                  70300000
703100                    LAST_UPD_DTE,                                 70310000
703200                    LAST_UPD_TME,                                 70320000
703300                    LAST_UPD_UID,                                 70330000
703400                    USAGE_CDE,                                    70340000
703500                    VEH_TYP_CDE,                                  70350000
703600                    CURR_STATUS_CDE,                              70360000
703700                    CURR_STATUS_DTE,                              70370000
703800                    CURR_STATUS_TME,                              70380000
703900                    CURR_OPER_UNT_ID,                             70390000
704000                    CURR_FCLTY_ID,                                70400000
704100                    CURR_FAC_AREA_ID,                             70410000
704200                    CURR_LOC_DTE,                                 70420000
704300                    CURR_LOC_TME,                                 70430000
704400                    CURR_TRIP_ID,                                 70440000
704500                    VEH_SIZE_CDE                                  70450000
704600               INTO :VEHICL-OWNER-SCAC-ID,                        70460000
704700                    :VEHICL-VEH-NBR,                              70470000
704800                    :VEHICL-CRT-SRC-CDE,                          70480000
704900                    :VEHICL-LAST-UPD-DTE,                         70490000
705000                    :VEHICL-LAST-UPD-TME,                         70500000
705100                    :VEHICL-LAST-UPD-UID,                         70510000
705200                    :VEHICL-USAGE-CDE,                            70520000
705300                    :VEHICL-VEH-TYP-CDE,                          70530000
705400                    :VEHICL-CURR-STATUS-CDE,                      70540000
705500                    :VEHICL-CURR-STATUS-DTE,                      70550000
705600                    :VEHICL-CURR-STATUS-TME,                      70560000
705700                    :VEHICL-CURR-OPER-UNT-ID,                     70570000
705800                    :VEHICL-CURR-FCLTY-ID,                        70580000
705900                    :VEHICL-CURR-FAC-AREA-ID,                     70590000
706000                    :VEHICL-CURR-LOC-DTE,                         70600000
706100                    :VEHICL-CURR-LOC-TME,                         70610000
706200                    :VEHICL-CURR-TRIP-ID                          70620000
706300                                :PV-VEHICL-CURR-TRIP-ID-NULL,     70630000
706400                    :VEHICL-VEH-SIZE-CDE                          70640000
706500               FROM TVEHICL                                       70650000
706600              WHERE OWNER_SCAC_ID  = :VEHICL-OWNER-SCAC-ID        70660000
706700                AND VEH_NBR        = :VEHICL-VEH-NBR              70670000
706800         END-EXEC                                                 70680000
706900                                                                  70690000
707000         EVALUATE TRUE                                            70700000
707100             WHEN SQLCODE = ZERO                                  70710000
707200             WHEN SQLCODE = +100                                  70720000
707300             WHEN SQLCODE = -911                                  70730000
707400                 CONTINUE                                         70740000
707500                                                                  70750000
707600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              70760000
707700                 DISPLAY '**************************************' 70770000
707800                 DISPLAY 'WARNING ISSUED ON SELECT OF TVEHICL   ' 70780000
707900                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 70790000
708000                          VEHICL-OWNER-SCAC-ID                    70800000
708100                         'VEHICL-VEH-NBR:    '                    70810000
708200                          VEHICL-VEH-NBR                          70820000
708300                 DISPLAY '**********************************'     70830000
708400                 PERFORM 9700-SQL-WARNING                         70840000
708500                                                                  70850000
708600             WHEN SQLCODE < ZERO                                  70860000
708700                 DISPLAY '**************************************' 70870000
708800                 DISPLAY 'ERROR ISSUED ON SELECT OF TVEHICL     ' 70880000
708900                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 70890000
709000                          VEHICL-OWNER-SCAC-ID                    70900000
709100                         'VEHICL-VEH-NBR:    '                    70910000
709200                          VEHICL-VEH-NBR                          70920000
709300                 DISPLAY '**************************************' 70930000
709400                 PERFORM 9800-SQL-ERROR                           70940000
709500                                                                  70950000
709600         END-EVALUATE                                             70960000
709700     END-PERFORM.                                                 70970000
709800                                                                  70980000
709900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    70990000
710000         SQLCODE NOT = +0                                         71000000
710100         DISPLAY '**************************************'         71010000
710200         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         71020000
710300         DISPLAY 'SELECT TVEHICL                        '         71030000
710400         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         71040000
710500                  VEHICL-OWNER-SCAC-ID                            71050000
710600                 'VEHICL-VEH-NBR:    '                            71060000
710700                  VEHICL-VEH-NBR                                  71070000
710800         DISPLAY '**************************************'         71080000
710900         PERFORM 9800-SQL-ERROR                                   71090000
711000     END-IF.                                                      71100000
711100                                                                  71110000
711200***************************************************************** 71120000
711300*     CHECK THE SQLCODE OF THE VEHICLE SELECT AND SET FIELDS    * 71130000
711400*     AS APPROPRIATE.                                           * 71140000
711500***************************************************************** 71150000
711600                                                                  71160000
711700 7970-CHECK-VEHICL-SQLCODE.                                       71170000
711800                                                                  71180000
711900     MOVE '7970-CHECK-VEHICL-SQLCODE'                             71190000
712000                                 TO PV-ABEND-PARAGRAPH.           71200000
712100                                                                  71210000
712200     EVALUATE TRUE                                                71220000
712300         WHEN SQLCODE = ZERO                                      71230000
712400             MOVE VEHICL-OWNER-SCAC-ID                            71240000
712500                                 TO PV-VEHICL-OWNER-SCAC-ID       71250000
712600             MOVE VEHICL-CRT-SRC-CDE                              71260000
712700                                 TO PV-VEHICL-CRT-SRC-CDE         71270000
712800             MOVE VEHICL-CURR-STATUS-CDE                          71280000
712900                                 TO PV-VEHICL-CURR-STATUS-CDE     71290000
713000             MOVE VEHICL-CURR-OPER-UNT-ID                         71300000
713100                                 TO PV-VEHICL-CURR-OPER-UNT-ID    71310000
713200             MOVE VEHICL-CURR-FCLTY-ID                            71320000
713300                                 TO PV-VEHICL-CURR-FCLTY-ID       71330000
713400             MOVE VEHICL-CURR-FAC-AREA-ID                         71340000
713500                                 TO PV-VEHICL-CURR-FAC-AREA-ID    71350000
713600             IF PV-VEHICL-CURR-TRIP-ID-NULL = PC-NEG-1            71360000
713700                 MOVE ZERO       TO PV-VEHICL-CURR-TRIP-ID        71370000
713800                                    PV-TRIPST-TRIP-ID             71380000
713900             ELSE                                                 71390000
714000                 MOVE VEHICL-CURR-TRIP-ID                         71400000
714100                                 TO PV-VEHICL-CURR-TRIP-ID        71410000
714200                                    PV-TRIPST-TRIP-ID             71420000
714300             END-IF                                               71430000
714400             MOVE PV-VEHICL-CURR-STATUS-CDE                       71440000
714500                                 TO TRSTYP-TRIP-STATUS-CDE        71450000
714600             PERFORM 7975-SELECT-PRIORITY                         71460000
714700                                                                  71470000
714800         WHEN SQLCODE = +100                                      71480000
714900             SET PS-INSERT-VEHICL                                 71490000
715000                                 TO TRUE                          71500000
715100     END-EVALUATE.                                                71510000
715200                                                                  71520000
715300                                                                  71530000
715400 7975-SELECT-PRIORITY.                                            71540000
715500                                                                  71550000
715600     MOVE '7975-SELECT-PRIORITY'                                  71560000
715700                                 TO PV-ABEND-PARAGRAPH.           71570000
715800                                                                  71580000
715900     PERFORM                                                      71590000
716000         WITH TEST AFTER                                          71600000
716100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     71610000
716200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            71620000
716300                 SQLCODE = ZERO OR                                71630000
716400                 SQLCODE = +100                                   71640000
716500                                                                  71650000
716600         EXEC SQL                                                 71660000
716700           SELECT A.PRTY_CDE                                      71670000
716800           INTO  :TRSTYP-PRTY-CDE                                 71680000
716900           FROM   TTRSTYP A                                       71690000
717000           WHERE  A.TRIP_STATUS_CDE  = :TRSTYP-TRIP-STATUS-CDE    71700000
717100         END-EXEC                                                 71710000
717200                                                                  71720000
717300         EVALUATE TRUE                                            71730000
717400             WHEN SQLCODE = ZERO                                  71740000
717500             WHEN SQLCODE = +100                                  71750000
717600             WHEN SQLCODE = -911                                  71760000
717700                 CONTINUE                                         71770000
717800                                                                  71780000
717900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              71790000
718000                 DISPLAY '**************************************' 71800000
718100                 DISPLAY 'WARNING ISSUED ON SELECT OF TTRSTYP   ' 71810000
718200                 DISPLAY 'PV-VEHICL-CURR-TRIP-ID: '               71820000
718300                          PV-VEHICL-CURR-TRIP-ID                  71830000
718400                 DISPLAY '**********************************'     71840000
718500                 PERFORM 9700-SQL-WARNING                         71850000
718600                                                                  71860000
718700             WHEN SQLCODE < ZERO                                  71870000
718800                 DISPLAY '**************************************' 71880000
718900                 DISPLAY 'ERROR ISSUED ON SELECT OF TTRSTYP     ' 71890000
719000                 DISPLAY 'PV-VEHICL-CURR-TRIP-ID: '               71900000
719100                          PV-VEHICL-CURR-TRIP-ID                  71910000
719200                 DISPLAY '**************************************' 71920000
719300                 PERFORM 9800-SQL-ERROR                           71930000
719400                                                                  71940000
719500         END-EVALUATE                                             71950000
719600                                                                  71960000
719700     END-PERFORM.                                                 71970000
719800                                                                  71980000
719900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    71990000
720000         SQLCODE NOT = +0                                         72000000
720100         DISPLAY '**************************************'         72010000
720200         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         72020000
720300         DISPLAY 'SELECT TTRSTYP                        '         72030000
720400         DISPLAY 'PV-VEHICL-CURR-TRIP-ID: '                       72040000
720500                  PV-VEHICL-CURR-TRIP-ID                          72050000
720600         DISPLAY '**************************************'         72060000
720700         PERFORM 9800-SQL-ERROR                                   72070000
720800     END-IF.                                                      72080000
720900                                                                  72090000
721000     IF SQLCODE = ZERO                                            72100000
721100         IF TRSTYP-PRTY-CDE = PC-95                               72110000
721200             SET PS-UPDATE-VEHICL                                 72120000
721300                                 TO TRUE                          72130000
721400         ELSE                                                     72140000
721500             IF TRSTYP-PRTY-CDE > PC-30                           72150000
721600                 SET PS-DONT-UPDATE-VEHICL                        72160000
721700                     PS-BYPASS-UPDATES                            72170000
721800                                     TO TRUE                      72180000
721900             ELSE                                                 72190000
722000                 SET PS-UPDATE-VEHICL                             72200000
722100                                     TO TRUE                      72210000
722200             END-IF                                               72220000
722300         END-IF                                                   72230000
722400     ELSE                                                         72240000
722500         SET PS-UPDATE-VEHICL                                     72250000
722600                             TO TRUE                              72260000
722700     END-IF.                                                      72270000
722800                                                                  72280000
722900 EJECT                                                            72290000
723000***************************************************************** 72300000
723100*     DO A SELECT ON VHTRIP USING THE SCAC-ID, VEH-NBR AND TRIP.* 72310000
723200*     THIS WILL DETERMINE WHETHER THE RECORD SHOULD BE AN       * 72320000
723300*     INSERT OR AN UPDATE.                                      * 72330000
723400***************************************************************** 72340000
723500                                                                  72350000
723600 7980-SELECT-VHTRIP.                                              72360000
723700                                                                  72370000
723800     MOVE '7980-SELECT-VHTRIP'   TO PV-ABEND-PARAGRAPH.           72380000
723900                                                                  72390000
724000     PERFORM                                                      72400000
724100         WITH TEST AFTER                                          72410000
724200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     72420000
724300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            72430000
724400                 SQLCODE = ZERO    OR                             72440000
724500                 SQLCODE = +100                                   72450000
724600                                                                  72460000
724700         EXEC SQL                                                 72470000
724800             SELECT OWNER_SCAC_ID,                                72480000
724900                    VEH_NBR,                                      72490000
725000                    TRIP_ID,                                      72500000
725100                    TRIP_BEG_DTE,                                 72510000
725200                    TRIP_BEG_TME,                                 72520000
725300                    CRT_SRC_CDE,                                  72530000
725400                    LAST_UPD_DTE,                                 72540000
725500                    LAST_UPD_TME,                                 72550000
725600                    LAST_UPD_UID,                                 72560000
725700                    MANIFEST_NBR,                                 72570000
725800                    PLND_TRIP_SEQ,                                72580000
725900                    PLND_ACTVY_CDE,                               72590000
726000                    OWNR_SCAC_SHIP_DTE,                           72600000
726100                    REF_TRIP_ID,                                  72610000
726200                    EST_AR_TMST                                   72620000
726300                  , SPLT_XMIT_IND                                 72630000
726400                  , SPLT_XMIT_DTE                                 72640000
726500                  , SPLT_XMIT_TM                                  72650000
726600               INTO :VHTRIP-OWNER-SCAC-ID,                        72660000
726700                    :VHTRIP-VEH-NBR  :PV-VHTRIP-VEH-NBR-NULL,     72670000
726800                    :VHTRIP-TRIP-ID,                              72680000
726900                    :VHTRIP-TRIP-BEG-DTE,                         72690000
727000                    :VHTRIP-TRIP-BEG-TME,                         72700000
727100                    :VHTRIP-CRT-SRC-CDE,                          72710000
727200                    :VHTRIP-LAST-UPD-DTE,                         72720000
727300                    :VHTRIP-LAST-UPD-TME,                         72730000
727400                    :VHTRIP-LAST-UPD-UID,                         72740000
727500                    :VHTRIP-MANIFEST-NBR,                         72750000
727600                    :VHTRIP-PLND-TRIP-SEQ,                        72760000
727700                    :VHTRIP-PLND-ACTVY-CDE,                       72770000
727800                    :VHTRIP-OWNR-SCAC-SHIP-DTE,                   72780000
727900                    :VHTRIP-REF-TRIP-ID,                          72790000
728000                    :VHTRIP-EST-AR-TMST   :PV-VHTRIP-EST-AR-NULL  72800000
728100                  , :VHTRIP-SPLT-XMIT-IND                         72810000
728200                  , :VHTRIP-SPLT-XMIT-DTE                         72820000
728300                  , :VHTRIP-SPLT-XMIT-TM                          72830000
728400               FROM TVHTRIP                                       72840000
728500              WHERE TRIP_ID = :VHTRIP-TRIP-ID                     72850000
728600         END-EXEC                                                 72860000
728700                                                                  72870000
728800         EVALUATE TRUE                                            72880000
728900             WHEN SQLCODE = ZERO                                  72890000
729000             WHEN SQLCODE = +100                                  72900000
729100             WHEN SQLCODE = -911                                  72910000
729200                 CONTINUE                                         72920000
729300                                                                  72930000
729400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              72940000
729500                 DISPLAY '**************************************' 72950000
729600                 DISPLAY 'WARNING ISSUED ON SELECT OF TVHTRIP   ' 72960000
729700                 DISPLAY 'VEHICL-CURR-TRIP-ID: '                  72970000
729800                          VEHICL-CURR-TRIP-ID                     72980000
729900                 DISPLAY '**********************************'     72990000
730000                 PERFORM 9700-SQL-WARNING                         73000000
730100                                                                  73010000
730200             WHEN SQLCODE < ZERO                                  73020000
730300                 DISPLAY '**************************************' 73030000
730400                 DISPLAY 'ERROR ISSUED ON SELECT OF TVHTRIP     ' 73040000
730500                 DISPLAY 'VEHICL-CURR-TRIP-ID: '                  73050000
730600                          VEHICL-CURR-TRIP-ID                     73060000
730700                 DISPLAY '**************************************' 73070000
730800                 PERFORM 9800-SQL-ERROR                           73080000
730900                                                                  73090000
731000         END-EVALUATE                                             73100000
731100     END-PERFORM.                                                 73110000
731200                                                                  73120000
731300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    73130000
731400         SQLCODE NOT = +0                                         73140000
731500         DISPLAY '**************************************'         73150000
731600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            73160000
731700                 'SELECT TVHTRIP                        '         73170000
731800         DISPLAY 'VEHICL-CURR-TRIP-ID: '                          73180000
731900                  VEHICL-CURR-TRIP-ID                             73190000
732000         DISPLAY '**************************************'         73200000
732100         PERFORM 9800-SQL-ERROR                                   73210000
732200     END-IF.                                                      73220000
732300                                                                  73230000
732400***************************************************************** 73240000
732500*     CHECK THE SQLCODE ON THE VHTRIP SELECT AND SET FIELD      * 73250000
732600*     VALUES APPROPRIATELY.                                     * 73260000
732700***************************************************************** 73270000
732800                                                                  73280000
732900 7990-CHECK-VHTRIP-SQLCODE.                                       73290000
733000                                                                  73300000
733100     MOVE '7990-CHECK-VHTRIP-SQLCODE'                             73310000
733200                                 TO PV-ABEND-PARAGRAPH.           73320000
733300                                                                  73330000
733400     EVALUATE TRUE                                                73340000
733500         WHEN SQLCODE = ZERO                                      73350000
733600             PERFORM 7991-CHECK-IF-SCAC-VEH-CHNGD                 73360000
733700             IF PS-VHTRIP-SCAC-DIDNT-CHANGE                       73370000
733800                 MOVE VHTRIP-OWNER-SCAC-ID                        73380000
733900                                 TO PV-VHTRIP-OWNER-SCAC-ID       73390000
734000                                    PV-SAVE-OWNER-SCAC-ID         73400000
734100             ELSE                                                 73410000
734200                 MOVE VHTRIP-OWNER-SCAC-ID                        73420000
734300                                 TO PV-SAVE-OWNER-SCAC-ID         73430000
734400                 MOVE VHTRIP-VEH-NBR                              73440000
734500                                 TO PV-SAVE-VHTRIP-VEH-NBR        73450000
734600             END-IF                                               73460000
734700             IF PS-VHTRIP-VEH-DIDNT-CHANGE                        73470000
734800                 IF PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1             73480000
734900                     MOVE SPACES     TO VHTRIP-VEH-NBR            73490000
735000                     IF PV-VEHICL-VEH-NBR > SPACES                73500000
735100                         MOVE PV-VEHICL-VEH-NBR                   73510000
735200                                     TO PV-VHTRIP-VEH-NBR         73520000
735300                     ELSE                                         73530000
735400                         MOVE SPACES TO PV-VHTRIP-VEH-NBR         73540000
735500                     END-IF                                       73550000
735600                 ELSE                                             73560000
735700                     MOVE VHTRIP-VEH-NBR                          73570000
735800                                     TO PV-VHTRIP-VEH-NBR         73580000
735900                 END-IF                                           73590000
736000             ELSE                                                 73600000
736100                 MOVE VHTRIP-VEH-NBR                              73610000
736200                                 TO PV-SAVE-VHTRIP-VEH-NBR        73620000
736300                 MOVE VHTRIP-OWNER-SCAC-ID                        73630000
736400                                 TO PV-SAVE-OWNER-SCAC-ID         73640000
736500             END-IF                                               73650000
736600             MOVE VHTRIP-TRIP-ID TO PV-VHTRIP-TRIP-ID             73660000
736700                                    PV-VEHICL-CURR-TRIP-ID        73670000
736800             IF PV-VHTRIP-MANIFEST-NBR = SPACES                   73680000
736900                 MOVE VHTRIP-MANIFEST-NBR                         73690000
737000                                 TO PV-VHTRIP-MANIFEST-NBR        73700000
737100             END-IF                                               73710000
737200             IF PV-VHTRIP-EST-AR-NULL = PC-NEG-1                  73720000
737300                 MOVE SPACES TO PV-VHTRIP-EST-AR-TMST             73730000
737400             ELSE                                                 73740000
737500                 MOVE VHTRIP-EST-AR-TMST                          73750000
737600                             TO PV-VHTRIP-EST-AR-TMST             73760000
737700             END-IF                                               73770000
737800             IF PS-UPDATE-SHIPMT OR                               73780000
737900                PS-DONT-UPDATE-SHIPMT                             73790000
738000                 MOVE PV-VHTRIP-TRIP-ID TO TRIPST-TRIP-ID         73800000
738100                 PERFORM 7992-SELECT-TRIP-STATUS                  73810000
738200             ELSE                                                 73820000
738300                 SET PS-ADD-NEXT-VHTRIP                           73830000
738400                                     TO TRUE                      73840000
738500             END-IF                                               73850000
738600                                                                  73860000
738700         WHEN SQLCODE = +100                                      73870000
738800             SET PS-INSERT-VHTRIP                                 73880000
738900                                 TO TRUE                          73890000
739000             MOVE SPACES         TO PV-VHTRIP-EST-AR-TMST         73900000
739100     END-EVALUATE.                                                73910000
739200                                                                  73920000
739300***************************************************************** 73930000
739400*     DETERMINE IF THE SCAC AND VEHICLE NUMBER ON THE VHTRIP    * 73940000
739500*     TABLE MATCH THE SCAC AND VEHICLE FIELDS FROM EDI DATA.    * 73950000
739600***************************************************************** 73960000
739700                                                                  73970000
739800 7991-CHECK-IF-SCAC-VEH-CHNGD.                                    73980000
739900                                                                  73990000
740000     MOVE '7991-CHECK-IF-SCAC-VEH-CHNGD'                          74000000
740100                                 TO PV-ABEND-PARAGRAPH.           74010000
740200                                                                  74020000
740300     SET PS-VHTRIP-VEH-DIDNT-CHANGE                               74030000
740400         PS-VHTRIP-SCAC-DIDNT-CHANGE TO TRUE.                     74040000
740500     IF PV-SAVE-LSD-CARR-ID > SPACES                              74050000
740600         IF PV-SAVE-LSD-CARR-ID = VHTRIP-OWNER-SCAC-ID            74060000
740700             IF PV-SAVE-VEH-NBR > SPACES                          74070000
740800                 IF PV-SAVE-VEH-NBR = VHTRIP-VEH-NBR OR           74080000
740900                    PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1             74090000
741000                     CONTINUE                                     74100000
741100                 ELSE                                             74110000
741200                     SET PS-VHTRIP-VEH-CHANGED                    74120000
741300                               TO TRUE                            74130000
741400                 END-IF                                           74140000
741500             END-IF                                               74150000
741600         ELSE                                                     74160000
741700             SET PS-VHTRIP-SCAC-CHANGED                           74170000
741800                               TO TRUE                            74180000
741900         END-IF                                                   74190000
742000     ELSE                                                         74200000
742100         IF PV-SAVE-CARR-SCAC = VHTRIP-OWNER-SCAC-ID              74210000
742200             IF PV-SAVE-VEH-NBR > SPACES                          74220000
742300                 IF PV-SAVE-VEH-NBR = VHTRIP-VEH-NBR OR           74230000
742400                    PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1             74240000
742500                     CONTINUE                                     74250000
742600                 ELSE                                             74260000
742700                     SET PS-VHTRIP-VEH-CHANGED                    74270000
742800                               TO TRUE                            74280000
742900                 END-IF                                           74290000
743000             END-IF                                               74300000
743100         ELSE                                                     74310000
743200             SET PS-VHTRIP-SCAC-CHANGED                           74320000
743300                               TO TRUE                            74330000
743400         END-IF                                                   74340000
743500     END-IF.                                                      74350000
743600 EJECT                                                            74360000
743700                                                                  74370000
743800                                                                  74380000
743900 7992-SELECT-TRIP-STATUS.                                         74390000
744000                                                                  74400000
744100     MOVE '7992-SELECT-TRIP-STATUS'                               74410000
744200                                 TO PV-ABEND-PARAGRAPH.           74420000
744300                                                                  74430000
744400     PERFORM                                                      74440000
744500         WITH TEST AFTER                                          74450000
744600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     74460000
744700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            74470000
744800                 SQLCODE = ZERO OR                                74480000
744900                 SQLCODE = +100                                   74490000
745000                                                                  74500000
745100         EXEC SQL                                                 74510000
745200           SELECT B.PRTY_CDE                                      74520000
745300           INTO  :TRSTYP-PRTY-CDE                                 74530000
745400           FROM   TTRIPST A                                       74540000
745500                 ,TTRSTYP B                                       74550000
745600           WHERE  A.TRIP_ID          = :TRIPST-TRIP-ID            74560000
745700             AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE           74570000
745800             AND  B.PRTY_CDE =                                    74580000
745900                  (SELECT MAX(D.PRTY_CDE)                         74590000
746000                     FROM TTRIPST C                               74600000
746100                         ,TTRSTYP D                               74610000
746200                    WHERE C.TRIP_ID         = A.TRIP_ID           74620000
746300                      AND C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  74630000
746400         END-EXEC                                                 74640000
746500                                                                  74650000
746600         EVALUATE TRUE                                            74660000
746700             WHEN SQLCODE = ZERO                                  74670000
746800             WHEN SQLCODE = +100                                  74680000
746900             WHEN SQLCODE = -911                                  74690000
747000                 CONTINUE                                         74700000
747100                                                                  74710000
747200             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              74720000
747300                 DISPLAY '**************************************' 74730000
747400                 DISPLAY 'WARNING ISSUED ON SELECT OF TTRSTYP   ' 74740000
747500                 DISPLAY 'PV-VEHICL-CURR-TRIP-ID: '               74750000
747600                          PV-VEHICL-CURR-TRIP-ID                  74760000
747700                 DISPLAY '**********************************'     74770000
747800                 PERFORM 9700-SQL-WARNING                         74780000
747900                                                                  74790000
748000             WHEN SQLCODE < ZERO                                  74800000
748100                 DISPLAY '**************************************' 74810000
748200                 DISPLAY 'ERROR ISSUED ON SELECT OF TTRSTYP     ' 74820000
748300                 DISPLAY 'PV-VEHICL-CURR-TRIP-ID: '               74830000
748400                          PV-VEHICL-CURR-TRIP-ID                  74840000
748500                 DISPLAY '**************************************' 74850000
748600                 PERFORM 9800-SQL-ERROR                           74860000
748700                                                                  74870000
748800         END-EVALUATE                                             74880000
748900                                                                  74890000
749000     END-PERFORM.                                                 74900000
749100                                                                  74910000
749200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES  AND                   74920000
749300         SQLCODE NOT = +0                                         74930000
749400         DISPLAY '**************************************'         74940000
749500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         74950000
749600         DISPLAY 'SELECT TTRSTYP                        '         74960000
749700         DISPLAY 'PV-VEHICL-CURR-TRIP-ID: '                       74970000
749800                  PV-VEHICL-CURR-TRIP-ID                          74980000
749900         DISPLAY '**************************************'         74990000
750000         PERFORM 9800-SQL-ERROR                                   75000000
750100     END-IF.                                                      75010000
750200                                                                  75020000
750300     IF SQLCODE = ZERO                                            75030000
750400         IF TRSTYP-PRTY-CDE = PC-95                               75040000
750500             SET PS-UPDATE-VHTRIP                                 75050000
750600                                 TO TRUE                          75060000
750700         ELSE                                                     75070000
750800             IF TRSTYP-PRTY-CDE > PC-30                           75080000
750900                 SET PS-DONT-UPDATE-VHTRIP                        75090000
751000                     PS-BYPASS-UPDATES                            75100000
751100                                     TO TRUE                      75110000
751200             ELSE                                                 75120000
751300                 SET PS-UPDATE-VHTRIP                             75130000
751400                                     TO TRUE                      75140000
751500             END-IF                                               75150000
751600         END-IF                                                   75160000
751700     ELSE                                                         75170000
751800         SET PS-UPDATE-VHTRIP                                     75180000
751900                             TO TRUE                              75190000
752000     END-IF.                                                      75200000
752100                                                                  75210000
752200 EJECT                                                            75220000
752300***************************************************************** 75230000
752400*     SQL INSERT VEHICLE                                        * 75240000
752500***************************************************************** 75250000
752600                                                                  75260000
752700 7995-INSERT-VEHICL.                                              75270000
752800                                                                  75280000
752900     MOVE '7995-INSERT-VEHICL'   TO PV-ABEND-PARAGRAPH.           75290000
753000                                                                  75300000
753100     MOVE PV-SAVE-LSD-CARR-ID    TO VEHICL-OWNER-SCAC-ID.         75310000
753200                                                                  75320000
753300     MOVE PC-EN                  TO VEHICL-CURR-STATUS-CDE        75330000
753400                                                                  75340000
753500     MOVE PV-VEHICL-VEH-NBR      TO VEHICL-VEH-NBR                75350000
753600     MOVE DK-OPER-UNT-ID         TO VEHICL-CURR-OPER-UNT-ID.      75360000
753700     MOVE DK-FCLTY-ID            TO VEHICL-CURR-FCLTY-ID.         75370000
753800     MOVE PV-VEHICL-CURR-TRIP-ID TO VEHICL-CURR-TRIP-ID.          75380000
753900                                                                  75390000
754000     PERFORM                                                      75400000
754100         WITH TEST AFTER                                          75410000
754200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     75420000
754300         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            75430000
754400                 SQLCODE = ZERO                                   75440000
754500                                                                  75450000
754600         EXEC SQL                                                 75460000
754700             INSERT INTO TVEHICL                                  75470000
754800                   (OWNER_SCAC_ID,                                75480000
754900                    VEH_NBR,                                      75490000
755000                    CRT_SRC_CDE,                                  75500000
755100                    LAST_UPD_UID,                                 75510000
755200                    USAGE_CDE,                                    75520000
755300                    VEH_TYP_CDE,                                  75530000
755400                    CURR_STATUS_CDE,                              75540000
755500                    CURR_STATUS_DTE,                              75550000
755600                    CURR_STATUS_TME,                              75560000
755700                    CURR_OPER_UNT_ID,                             75570000
755800                    CURR_FCLTY_ID,                                75580000
755900                    CURR_TRIP_ID)                                 75590000
756000             VALUES                                               75600000
756100                  (:VEHICL-OWNER-SCAC-ID,                         75610000
756200                   :VEHICL-VEH-NBR,                               75620000
756300                   :PC-CE,                                        75630000
756400                   :PC-RCKUP006,                                  75640000
756500                   :PC-RCV,                                       75650000
756600                   :PC-TR,                                        75660000
756700                   :VEHICL-CURR-STATUS-CDE,                       75670000
756800                    CURRENT DATE,                                 75680000
756900                    CURRENT TIME,                                 75690000
757000                   :VEHICL-CURR-OPER-UNT-ID,                      75700000
757100                   :VEHICL-CURR-FCLTY-ID,                         75710000
757200                   :VEHICL-CURR-TRIP-ID)                          75720000
757300         END-EXEC                                                 75730000
757400                                                                  75740000
757500         EVALUATE TRUE                                            75750000
757600             WHEN SQLCODE = ZERO                                  75760000
757610                 ADD +1 TO PV-ADD-TVEHICL                         75761000
757700             WHEN SQLCODE = -911                                  75770000
757800                 CONTINUE                                         75780000
757900                                                                  75790000
758000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              75800000
758100                 DISPLAY '**************************************' 75810000
758200                 DISPLAY 'WARNING ISSUED ON INSERT OF TVEHICL   ' 75820000
758300                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 75830000
758400                          VEHICL-OWNER-SCAC-ID                    75840000
758500                 DISPLAY 'VEHICL-VEH-NBR:       '                 75850000
758600                          VEHICL-VEH-NBR                          75860000
758700                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 75870000
758800                          VEHICL-CURR-TRIP-ID                     75880000
758900                 DISPLAY '**********************************'     75890000
759000                 PERFORM 9700-SQL-WARNING                         75900000
759100                                                                  75910000
759200             WHEN SQLCODE < ZERO                                  75920000
759300                 DISPLAY '**************************************' 75930000
759400                 DISPLAY 'ERROR ISSUED ON INSERT OF TVEHICL     ' 75940000
759500                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 75950000
759600                          VEHICL-OWNER-SCAC-ID                    75960000
759700                 DISPLAY 'VEHICL-VEH-NBR:       '                 75970000
759800                          VEHICL-VEH-NBR                          75980000
759900                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 75990000
760000                          VEHICL-CURR-TRIP-ID                     76000000
760100                 DISPLAY '**************************************' 76010000
760200                 PERFORM 9800-SQL-ERROR                           76020000
760300                                                                  76030000
760400         END-EVALUATE                                             76040000
760500     END-PERFORM.                                                 76050000
760600                                                                  76060000
760700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    76070000
760800         SQLCODE NOT = +0                                         76080000
760900         DISPLAY '**************************************'         76090000
761000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         76100000
761100         DISPLAY 'INSERT TO TVEHICL                     '         76110000
761200         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         76120000
761300                  VEHICL-OWNER-SCAC-ID                            76130000
761400         DISPLAY 'VEHICL-VEH-NBR:       '                         76140000
761500                  VEHICL-VEH-NBR                                  76150000
761600         DISPLAY 'VEHICL-CURR-TRIP-ID:  '                         76160000
761700                  VEHICL-CURR-TRIP-ID                             76170000
761800         DISPLAY 'PV-SHIPMT-PRO-NBR:    '                         76180000
761900                  PV-SHIPMT-PRO-NBR                               76190000
762000         DISPLAY 'PV-SHIPMT-BOL-NBR:    '                         76200000
762100                  PV-SHIPMT-BOL-NBR                               76210000
762200         DISPLAY '**************************************'         76220000
762300         PERFORM 9800-SQL-ERROR                                   76230000
762400     END-IF.                                                      76240000
762500                                                                  76250000
762600***************************************************************** 76260000
762700*     INSERT A COPY OF THE VEHICLE ROW TO THE AUDIT TRAIL TABLE * 76270000
762800*     BEFORE UPDATING THE VEHICLE TABLE.                        * 76280000
762900***************************************************************** 76290000
763000                                                                  76300000
763100 7996-CREATE-VEH-AUDIT-TRAIL.                                     76310000
763200                                                                  76320000
763300     MOVE '7996-CREATE-VEH-AUDIT-TRAIL'                           76330000
763400                                 TO PV-ABEND-PARAGRAPH.           76340000
763500                                                                  76350000
763600     PERFORM                                                      76360000
763700         WITH TEST AFTER                                          76370000
763800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     76380000
763900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            76390000
764000                 SQLCODE = ZERO                                   76400000
764100                                                                  76410000
764200         EXEC SQL                                                 76420000
764300             INSERT INTO TAUVHCL                                  76430000
764400                   (OWNER_SCAC_ID,                                76440000
764500                    VEH_NBR,                                      76450000
764600                    CRT_SRC_CDE,                                  76460000
764700                    LAST_UPD_DTE,                                 76470000
764800                    LAST_UPD_TME,                                 76480000
764900                    LAST_UPD_UID,                                 76490000
765000                    USAGE_CDE,                                    76500000
765100                    VEH_TYP_CDE,                                  76510000
765200                    CURR_STATUS_CDE,                              76520000
765300                    CURR_STATUS_DTE,                              76530000
765400                    CURR_STATUS_TME,                              76540000
765500                    CURR_OPER_UNT_ID,                             76550000
765600                    CURR_FCLTY_ID,                                76560000
765700                    CURR_FAC_AREA_ID,                             76570000
765800                    CURR_LOC_DTE,                                 76580000
765900                    CURR_LOC_TME,                                 76590000
766000                    CURR_TRIP_ID,                                 76600000
766100                    VEH_SIZE_CDE)                                 76610000
766200             VALUES                                               76620000
766300                  (:VEHICL-OWNER-SCAC-ID,                         76630000
766400                   :VEHICL-VEH-NBR,                               76640000
766500                   :VEHICL-CRT-SRC-CDE,                           76650000
766600                   :VEHICL-LAST-UPD-DTE,                          76660000
766700                   :VEHICL-LAST-UPD-TME,                          76670000
766800                   :VEHICL-LAST-UPD-UID,                          76680000
766900                   :VEHICL-USAGE-CDE,                             76690000
767000                   :VEHICL-VEH-TYP-CDE,                           76700000
767100                   :VEHICL-CURR-STATUS-CDE,                       76710000
767200                   :VEHICL-CURR-STATUS-DTE,                       76720000
767300                   :VEHICL-CURR-STATUS-TME,                       76730000
767400                   :VEHICL-CURR-OPER-UNT-ID,                      76740000
767500                   :VEHICL-CURR-FCLTY-ID,                         76750000
767600                   :VEHICL-CURR-FAC-AREA-ID,                      76760000
767700                   :VEHICL-CURR-LOC-DTE,                          76770000
767800                   :VEHICL-CURR-LOC-TME,                          76780000
767900                   :VEHICL-CURR-TRIP-ID,                          76790000
768000                   :VEHICL-VEH-SIZE-CDE)                          76800000
768100         END-EXEC                                                 76810000
768200                                                                  76820000
768300         EVALUATE TRUE                                            76830000
768400             WHEN SQLCODE = ZERO                                  76840000
768500             WHEN SQLCODE = -911                                  76850000
768600                 CONTINUE                                         76860000
768700                                                                  76870000
768800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              76880000
768900                 DISPLAY '**************************************' 76890000
769000                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUVHCL   ' 76900000
769100                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 76910000
769200                          VEHICL-OWNER-SCAC-ID                    76920000
769300                 DISPLAY 'VEHICL-VEH-NBR:       '                 76930000
769400                          VEHICL-VEH-NBR                          76940000
769500                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 76950000
769600                          VEHICL-CURR-TRIP-ID                     76960000
769700                 DISPLAY '**********************************'     76970000
769800                 PERFORM 9700-SQL-WARNING                         76980000
769900                                                                  76990000
770000             WHEN SQLCODE < ZERO                                  77000000
770100                 DISPLAY '**************************************' 77010000
770200                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUVHCL     ' 77020000
770300                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 77030000
770400                          VEHICL-OWNER-SCAC-ID                    77040000
770500                 DISPLAY 'VEHICL-VEH-NBR:       '                 77050000
770600                          VEHICL-VEH-NBR                          77060000
770700                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 77070000
770800                          VEHICL-CURR-TRIP-ID                     77080000
770900                 DISPLAY '**************************************' 77090000
771000                 PERFORM 9800-SQL-ERROR                           77100000
771100                                                                  77110000
771200         END-EVALUATE                                             77120000
771300     END-PERFORM.                                                 77130000
771400                                                                  77140000
771500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    77150000
771600         SQLCODE NOT = +0                                         77160000
771700         DISPLAY '**************************************'         77170000
771800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         77180000
771900         DISPLAY 'INSERT TO TAUVHCL                     '         77190000
772000         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         77200000
772100                  VEHICL-OWNER-SCAC-ID                            77210000
772200         DISPLAY 'VEHICL-VEH-NBR:       '                         77220000
772300                  VEHICL-VEH-NBR                                  77230000
772400         DISPLAY 'VEHICL-CURR-TRIP-ID:  '                         77240000
772500                  VEHICL-CURR-TRIP-ID                             77250000
772600         DISPLAY '**************************************'         77260000
772700         PERFORM 9800-SQL-ERROR                                   77270000
772800     END-IF.                                                      77280000
772900                                                                  77290000
773000***************************************************************** 77300000
773100*     SQL INSERT VHTRIP                                         * 77310000
773200***************************************************************** 77320000
773300                                                                  77330000
773400 7997-INSERT-VHTRIP.                                              77340000
773500                                                                  77350000
773600     MOVE '7997-INSERT-VHTRIP'   TO PV-ABEND-PARAGRAPH.           77360000
773700                                                                  77370000
773800     MOVE PV-SAVE-LSD-CARR-ID    TO VHTRIP-OWNER-SCAC-ID          77380000
773900     MOVE PC-NEG-1               TO PV-VHTRIP-EST-AR-NULL.        77390000
774000                                                                  77400000
774100     MOVE SPACES                 TO VHTRIP-EST-AR-TMST.           77410000
774200                                                                  77420000
774300     PERFORM                                                      77430000
774400         WITH TEST AFTER                                          77440000
774500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     77450000
774600         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            77460000
774700                 SQLCODE = ZERO                                   77470000
774800                                                                  77480000
774900         EXEC SQL                                                 77490000
775000             INSERT INTO TVHTRIP                                  77500000
775100                   (OWNER_SCAC_ID,                                77510000
775200                    VEH_NBR,                                      77520000
775300                    TRIP_ID,                                      77530000
775400                    CRT_SRC_CDE,                                  77540000
775500                    LAST_UPD_UID,                                 77550000
775600                    REF_TRIP_ID,                                  77560000
775700                    EST_AR_TMST                                   77570000
775800                  , SPLT_XMIT_IND                                 77580000
775900                  , SPLT_XMIT_DTE                                 77590000
776000                  , SPLT_XMIT_TM )                                77600000
776100             VALUES                                               77610000
776200                  (:VHTRIP-OWNER-SCAC-ID,                         77620000
776300                   :PV-VHTRIP-VEH-NBR   :PV-VHTRIP-VEH-NBR-NULL,  77630000
776400                   :PV-VHTRIP-TRIP-ID,                            77640000
776500                   :PC-CE,                                        77650000
776600                   :PC-RCKUP006,                                  77660000
776700                   :PV-VHTRIP-REF-TRIP-ID,                        77670000
776800                   :VHTRIP-EST-AR-TMST  :PV-VHTRIP-EST-AR-NULL    77680000
776900                 , :PC-SPACE                                      77690000
777000                 , :PC-DEFAULT-DATE                               77700000
777100                 , :PC-DEFAULT-TIME )                             77710000
777200         END-EXEC                                                 77720000
777300                                                                  77730000
777400         EVALUATE TRUE                                            77740000
777500             WHEN SQLCODE = ZERO                                  77750000
777510                 ADD +1 TO PV-ADD-TVHTRIP                         77751000
777600             WHEN SQLCODE = -911                                  77760000
777700                 CONTINUE                                         77770000
777800                                                                  77780000
777900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              77790000
778000                 DISPLAY '**************************************' 77800000
778100                 DISPLAY 'WARNING ISSUED ON INSERT OF TVHTRIP   ' 77810000
778200                 DISPLAY 'PV-VHTRIP-TRIP-ID:    '                 77820000
778300                          PV-VHTRIP-TRIP-ID                       77830000
778400                 DISPLAY '**********************************'     77840000
778500                 PERFORM 9700-SQL-WARNING                         77850000
778600                                                                  77860000
778700             WHEN SQLCODE < ZERO                                  77870000
778800                 DISPLAY '**************************************' 77880000
778900                 DISPLAY 'ERROR ISSUED ON INSERT OF TVHTRIP     ' 77890000
779000                 DISPLAY 'PV-VHTRIP-TRIP-ID:    '                 77900000
779100                          PV-VHTRIP-TRIP-ID                       77910000
779200                 DISPLAY '**************************************' 77920000
779300                 PERFORM 9800-SQL-ERROR                           77930000
779400                                                                  77940000
779500         END-EVALUATE                                             77950000
779600     END-PERFORM.                                                 77960000
779700                                                                  77970000
779800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    77980000
779900         SQLCODE NOT = +0                                         77990000
780000         DISPLAY '**************************************'         78000000
780100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         78010000
780200         DISPLAY 'INSERT TO TVHTRIP                     '         78020000
780300         DISPLAY 'PV-VHTRIP-TRIP-ID:    '                         78030000
780400                  PV-VHTRIP-TRIP-ID                               78040000
780500         DISPLAY 'PV-SHIPMT-PRO-NBR:    '                         78050000
780600                  PV-SHIPMT-PRO-NBR                               78060000
780700         DISPLAY 'PV-SHIPMT-BOL-NBR:    '                         78070000
780800                  PV-SHIPMT-BOL-NBR                               78080000
780900         DISPLAY '**************************************'         78090000
781000         PERFORM 9800-SQL-ERROR                                   78100000
781100     END-IF.                                                      78110000
781200                                                                  78120000
781300***************************************************************** 78130000
781400*     INSERT A COPY OF THE TRIP ROW TO THE AUDIT TRAIL TABLE    * 78140000
781500*     BEFORE UPDATING THE TRIP TABLE.                           * 78150000
781600***************************************************************** 78160000
781700                                                                  78170000
781800 7998-CREATE-TRIP-AUDIT-TRAIL.                                    78180000
781900                                                                  78190000
782000     MOVE '7998-CREATE-TRIP-AUDIT-TRAIL'                          78200000
782100                                 TO PV-ABEND-PARAGRAPH.           78210000
782200                                                                  78220000
782300     PERFORM                                                      78230000
782400         WITH TEST AFTER                                          78240000
782500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     78250000
782600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            78260000
782700                 SQLCODE = ZERO                                   78270000
782800                                                                  78280000
782900         EXEC SQL                                                 78290000
783000             INSERT INTO TAUTRIP                                  78300000
783100                   (OWNER_SCAC_ID,                                78310000
783200                    VEH_NBR,                                      78320000
783300                    TRIP_ID,                                      78330000
783400                    TRIP_BEG_DTE,                                 78340000
783500                    TRIP_BEG_TME,                                 78350000
783600                    CRT_SRC_CDE,                                  78360000
783700                    LAST_UPD_DTE,                                 78370000
783800                    LAST_UPD_TME,                                 78380000
783900                    LAST_UPD_UID,                                 78390000
784000                    MANIFEST_NBR,                                 78400000
784100                    PLND_TRIP_SEQ,                                78410000
784200                    PLND_ACTVY_CDE,                               78420000
784300                    OWNR_SCAC_SHIP_DTE,                           78430000
784400                    REF_TRIP_ID,                                  78440000
784500                    EST_AR_TMST,                                  78450000
784600                    AUD_STATUS_CDE                                78460000
784700                  , SPLT_XMIT_IND                                 78470000
784800                  , SPLT_XMIT_DTE                                 78480000
784900                  , SPLT_XMIT_TM )                                78490000
785000             VALUES                                               78500000
785100                  (:VHTRIP-OWNER-SCAC-ID,                         78510000
785200                   :VHTRIP-VEH-NBR  :PV-VHTRIP-VEH-NBR-NULL,      78520000
785300                   :VHTRIP-TRIP-ID,                               78530000
785400                   :VHTRIP-TRIP-BEG-DTE,                          78540000
785500                   :VHTRIP-TRIP-BEG-TME,                          78550000
785600                   :VHTRIP-CRT-SRC-CDE,                           78560000
785700                   :VHTRIP-LAST-UPD-DTE,                          78570000
785800                   :VHTRIP-LAST-UPD-TME,                          78580000
785900                   :VHTRIP-LAST-UPD-UID,                          78590000
786000                   :VHTRIP-MANIFEST-NBR,                          78600000
786100                   :VHTRIP-PLND-TRIP-SEQ,                         78610000
786200                   :VHTRIP-PLND-ACTVY-CDE,                        78620000
786300                   :VHTRIP-OWNR-SCAC-SHIP-DTE,                    78630000
786400                   :VHTRIP-REF-TRIP-ID,                           78640000
786500                   :VHTRIP-EST-AR-TMST   :PV-VHTRIP-EST-AR-NULL,  78650000
786600                   :PC-EN                                         78660000
786700                  , :VHTRIP-SPLT-XMIT-IND                         78670000
786800                  , :VHTRIP-SPLT-XMIT-DTE                         78680000
786900                  , :VHTRIP-SPLT-XMIT-TM )                        78690000
787000         END-EXEC                                                 78700000
787100                                                                  78710000
787200         EVALUATE TRUE                                            78720000
787300             WHEN SQLCODE = ZERO                                  78730000
787400             WHEN SQLCODE = -911                                  78740000
787500                 CONTINUE                                         78750000
787600                                                                  78760000
787700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              78770000
787800                 DISPLAY '**************************************' 78780000
787900                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUTRIP   ' 78790000
788000                 DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                 78800000
788100                          VHTRIP-OWNER-SCAC-ID                    78810000
788200                 DISPLAY 'VHTRIP-VEH-NBR:       '                 78820000
788300                          VHTRIP-VEH-NBR                          78830000
788400                 DISPLAY 'VHTRIP-TRIP-ID:       '                 78840000
788500                          VHTRIP-TRIP-ID                          78850000
788600                 DISPLAY '**********************************'     78860000
788700                 PERFORM 9700-SQL-WARNING                         78870000
788800                                                                  78880000
788900             WHEN SQLCODE < ZERO                                  78890000
789000                 DISPLAY '**************************************' 78900000
789100                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUTRIP     ' 78910000
789200                 DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                 78920000
789300                          VHTRIP-OWNER-SCAC-ID                    78930000
789400                 DISPLAY 'VHTRIP-VEH-NBR:       '                 78940000
789500                          VHTRIP-VEH-NBR                          78950000
789600                 DISPLAY 'VHTRIP-TRIP-ID:       '                 78960000
789700                          VHTRIP-TRIP-ID                          78970000
789800                 DISPLAY '**************************************' 78980000
789900                 PERFORM 9800-SQL-ERROR                           78990000
790000                                                                  79000000
790100         END-EVALUATE                                             79010000
790200     END-PERFORM.                                                 79020000
790300                                                                  79030000
790400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    79040000
790500         SQLCODE NOT = +0                                         79050000
790600         DISPLAY '**************************************'         79060000
790700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         79070000
790800         DISPLAY 'INSERT TO TAUSHIP                     '         79080000
790900         DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                         79090000
791000                  VHTRIP-OWNER-SCAC-ID                            79100000
791100         DISPLAY 'VHTRIP-VEH-NBR:       '                         79110000
791200                  VHTRIP-VEH-NBR                                  79120000
791300         DISPLAY 'VHTRIP-TRIP-ID:       '                         79130000
791400                  VHTRIP-TRIP-ID                                  79140000
791500         DISPLAY '**************************************'         79150000
791600         PERFORM 9800-SQL-ERROR                                   79160000
791700     END-IF.                                                      79170000
791800                                                                  79180000
791900***************************************************************** 79190000
792000*     SQL UPDATE VEHICLE                                        * 79200000
792100***************************************************************** 79210000
792200                                                                  79220000
792300 7999-UPDATE-VEHICL.                                              79230000
792400                                                                  79240000
792500     MOVE '7999-UPDATE-VEHICL'   TO PV-ABEND-PARAGRAPH.           79250000
792600                                                                  79260000
792700     MOVE PC-EN                  TO VEHICL-CURR-STATUS-CDE.       79270000
792800                                                                  79280000
792900     MOVE PV-VEHICL-CURR-OPER-UNT-ID                              79290000
793000                                 TO VEHICL-CURR-OPER-UNT-ID.      79300000
793100     MOVE PV-VEHICL-CURR-FCLTY-ID                                 79310000
793200                                 TO VEHICL-CURR-FCLTY-ID.         79320000
793300     MOVE PV-VEHICL-CURR-TRIP-ID TO VEHICL-CURR-TRIP-ID           79330000
793400                                    PV-SHIPMT-TRIP-ID.            79340000
793500     MOVE PC-POS-1 TO               PV-VEHICL-CURR-TRIP-ID-NULL.  79350000
793600                                                                  79360000
793700     PERFORM                                                      79370000
793800         WITH TEST AFTER                                          79380000
793900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     79390000
794000         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            79400000
794100                 SQLCODE = ZERO                                   79410000
794200                                                                  79420000
794300         EXEC SQL                                                 79430000
794400             UPDATE TVEHICL                                       79440000
794500                SET LAST_UPD_DTE    = CURRENT DATE,               79450000
794600                    LAST_UPD_TME    = CURRENT TIME,               79460000
794700                    LAST_UPD_UID    = :PC-RCKUP006,               79470000
794800                    CURR_STATUS_CDE = :VEHICL-CURR-STATUS-CDE,    79480000
794900                    CURR_STATUS_DTE = CURRENT DATE,               79490000
795000                    CURR_STATUS_TME = CURRENT TIME,               79500000
795100                    CURR_OPER_UNT_ID= :VEHICL-CURR-OPER-UNT-ID,   79510000
795200                    CURR_FCLTY_ID   = :VEHICL-CURR-FCLTY-ID,      79520000
795300                    CURR_TRIP_ID    = :VEHICL-CURR-TRIP-ID        79530000
795400                                      :PV-VEHICL-CURR-TRIP-ID-NULL79540000
795500              WHERE OWNER_SCAC_ID   = :VEHICL-OWNER-SCAC-ID       79550000
795600                AND VEH_NBR         = :VEHICL-VEH-NBR             79560000
795700         END-EXEC                                                 79570000
795800                                                                  79580000
795900         EVALUATE TRUE                                            79590000
796000             WHEN SQLCODE = ZERO                                  79600000
796010                 ADD +1 TO PV-UPDATE-TVEHICL                      79601000
796100             WHEN SQLCODE = -911                                  79610000
796200                 CONTINUE                                         79620000
796300                                                                  79630000
796400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              79640000
796500                 DISPLAY '**************************************' 79650000
796600                 DISPLAY 'WARNING ISSUED ON UPDATE OF TVEHICL   ' 79660000
796700                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 79670000
796800                          VEHICL-OWNER-SCAC-ID                    79680000
796900                 DISPLAY 'VEHICL-VEH-NBR:       '                 79690000
797000                          VEHICL-VEH-NBR                          79700000
797100                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 79710000
797200                          VEHICL-CURR-TRIP-ID                     79720000
797300                 DISPLAY '**********************************'     79730000
797400                 PERFORM 9700-SQL-WARNING                         79740000
797500                                                                  79750000
797600             WHEN SQLCODE < ZERO                                  79760000
797700                 DISPLAY '**************************************' 79770000
797800                 DISPLAY 'ERROR ISSUED ON UPDATE OF TVEHICL     ' 79780000
797900                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 79790000
798000                          VEHICL-OWNER-SCAC-ID                    79800000
798100                 DISPLAY 'VEHICL-VEH-NBR:       '                 79810000
798200                          VEHICL-VEH-NBR                          79820000
798300                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 79830000
798400                          VEHICL-CURR-TRIP-ID                     79840000
798500                 DISPLAY '**************************************' 79850000
798600                 PERFORM 9800-SQL-ERROR                           79860000
798700                                                                  79870000
798800         END-EVALUATE                                             79880000
798900     END-PERFORM.                                                 79890000
799000                                                                  79900000
799100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    79910000
799200         SQLCODE NOT = +0                                         79920000
799300         DISPLAY '**************************************'         79930000
799400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         79940000
799500         DISPLAY 'UPDATE TO TVEHICL                     '         79950000
799600         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         79960000
799700                  VEHICL-OWNER-SCAC-ID                            79970000
799800         DISPLAY 'VEHICL-VEH-NBR:       '                         79980000
799900                  VEHICL-VEH-NBR                                  79990000
800000         DISPLAY 'VEHICL-CURR-TRIP-ID:  '                         80000000
800100                  VEHICL-CURR-TRIP-ID                             80010000
800200         DISPLAY 'PV-SHIPMT-PRO-NBR:    '                         80020000
800300                  PV-SHIPMT-PRO-NBR                               80030000
800400         DISPLAY 'PV-SHIPMT-BOL-NBR:    '                         80040000
800500                  PV-SHIPMT-BOL-NBR                               80050000
800600         DISPLAY '**************************************'         80060000
800700         PERFORM 9800-SQL-ERROR                                   80070000
800800     END-IF.                                                      80080000
800900                                                                  80090000
801000***************************************************************** 80100000
801100*     SQL UPDATE VEHICLE TRIP                                   * 80110000
801200***************************************************************** 80120000
801300                                                                  80130000
801400 799A-UPDATE-VHTRIP.                                              80140000
801500                                                                  80150000
801600     MOVE '799A-UPDATE-VHTRIP'   TO PV-ABEND-PARAGRAPH.           80160000
801700                                                                  80170000
801800     IF PV-VHTRIP-CARR-SCAC-ID = SPACES                           80180000
801900         MOVE PV-VHTRIP-OWNER-SCAC-ID                             80190000
802000                                 TO VHTRIP-OWNER-SCAC-ID          80200000
802100     ELSE                                                         80210000
802200         MOVE PV-VHTRIP-CARR-SCAC-ID                              80220000
802300                                     TO VHTRIP-OWNER-SCAC-ID      80230000
802400     END-IF.                                                      80240000
802500     IF PV-VHTRIP-EST-AR-TMST = SPACES                            80250000
802600         MOVE PC-NEG-1 TO PV-VHTRIP-EST-AR-NULL                   80260000
802700     ELSE                                                         80270000
802800         MOVE PC-POS-1 TO PV-VHTRIP-EST-AR-NULL                   80280000
802900     END-IF.                                                      80290000
803000                                                                  80300000
803100     MOVE PV-VHTRIP-EST-AR-TMST  TO VHTRIP-EST-AR-TMST.           80310000
803200                                                                  80320000
803300     PERFORM                                                      80330000
803400         WITH TEST AFTER                                          80340000
803500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     80350000
803600         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            80360000
803700                 SQLCODE = ZERO                                   80370000
803800                                                                  80380000
803900         EXEC SQL                                                 80390000
804000             UPDATE TVHTRIP                                       80400000
804100                SET OWNER_SCAC_ID   = :VHTRIP-OWNER-SCAC-ID,      80410000
804200                    VEH_NBR         = :PV-VHTRIP-VEH-NBR          80420000
804300                                      :PV-VHTRIP-VEH-NBR-NULL,    80430000
804400                    LAST_UPD_DTE    = CURRENT DATE,               80440000
804500                    LAST_UPD_TME    = CURRENT TIME,               80450000
804600                    LAST_UPD_UID    = :PC-RCKUP006,               80460000
804700                    MANIFEST_NBR    = :PV-VHTRIP-MANIFEST-NBR,    80470000
804800                    EST_AR_TMST     = :VHTRIP-EST-AR-TMST         80480000
804900                                      :PV-VHTRIP-EST-AR-NULL      80490000
805000              WHERE TRIP_ID         = :PV-VHTRIP-TRIP-ID          80500000
805100         END-EXEC                                                 80510000
805200                                                                  80520000
805300         EVALUATE TRUE                                            80530000
805400             WHEN SQLCODE = ZERO                                  80540000
805410                 ADD +1 TO PV-UPDATE-TVHTRIP                      80541000
805500             WHEN SQLCODE = -911                                  80550000
805600                 CONTINUE                                         80560000
805700                                                                  80570000
805800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              80580000
805900                 DISPLAY '**************************************' 80590000
806000                 DISPLAY 'WARNING ISSUED ON UPDATE OF TVHTRIP   ' 80600000
806100                 DISPLAY 'PV-VHTRIP-TRIP-ID:    '                 80610000
806200                          PV-VHTRIP-TRIP-ID                       80620000
806300                 DISPLAY '**********************************'     80630000
806400                 PERFORM 9700-SQL-WARNING                         80640000
806500                                                                  80650000
806600             WHEN SQLCODE < ZERO                                  80660000
806700                 DISPLAY '**************************************' 80670000
806800                 DISPLAY 'ERROR ISSUED ON UPDATE OF TVHTRIP     ' 80680000
806900                 DISPLAY 'PV-VHTRIP-TRIP-ID:    '                 80690000
807000                          PV-VHTRIP-TRIP-ID                       80700000
807100                 DISPLAY '**************************************' 80710000
807200                 PERFORM 9800-SQL-ERROR                           80720000
807300                                                                  80730000
807400         END-EVALUATE                                             80740000
807500     END-PERFORM.                                                 80750000
807600                                                                  80760000
807700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    80770000
807800         SQLCODE NOT = +0                                         80780000
807900         DISPLAY '**************************************'         80790000
808000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         80800000
808100         DISPLAY 'UPDATE TO TVHTRIP                     '         80810000
808200         DISPLAY 'PV-VHTRIP-TRIP-ID:    '                         80820000
808300                  PV-VHTRIP-TRIP-ID                               80830000
808400         DISPLAY 'PV-SHIPMT-PRO-NBR:    '                         80840000
808500                  PV-SHIPMT-PRO-NBR                               80850000
808600         DISPLAY 'PV-SHIPMT-BOL-NBR:    '                         80860000
808700                  PV-SHIPMT-BOL-NBR                               80870000
808800         DISPLAY '**************************************'         80880000
808900         PERFORM 9800-SQL-ERROR                                   80890000
809000     END-IF.                                                      80900000
809100                                                                  80910000
809200***************************************************************** 80920000
809300*     GET THE PRIMARY VENDOR NAME FROM THE EXTERNAL ENTERPRISE  * 80930000
809400*     NAME TABLE.                                               * 80940000
809500***************************************************************** 80950000
809600                                                                  80960000
809700 799B-SELECT-VENDOR-NAME.                                         80970000
809800                                                                  80980000
809900     MOVE '799B-SELECT-VENDOR-NAME'                               80990000
810000                                 TO PV-ABEND-PARAGRAPH.           81000000
810100                                                                  81010000
810200     PERFORM                                                      81020000
810300         WITH TEST AFTER                                          81030000
810400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     81040000
810500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            81050000
810600                (SQLCODE = ZERO)   OR                             81060000
810700                (SQLCODE = +100) OR                               81070000
810800                (SQLCODE = -803)                                  81080000
810900                                                                  81090000
811000         EXEC SQL                                                 81100000
811100             SELECT ENT_NAME_DESC                                 81110000
811200               INTO :ENTNME-ENT-NAME-DESC                         81120000
811300               FROM TENTNME                                       81130000
811400              WHERE ENT_ID    = :PURCHS-ENT-ID                    81140000
811500                AND TYPE_CDE  = :PC-01                            81150000
811600         END-EXEC                                                 81160000
811700                                                                  81170000
811800         EVALUATE TRUE                                            81180000
811900             WHEN SQLCODE = ZERO                                  81190000
812000             WHEN SQLCODE = +100                                  81200000
812100             WHEN SQLCODE = -803                                  81210000
812200             WHEN SQLCODE = -911                                  81220000
812300                 CONTINUE                                         81230000
812400                                                                  81240000
812500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              81250000
812600                 DISPLAY '**************************************' 81260000
812700                 DISPLAY 'WARNING ISSUED ON SELECT OF TENTNME   ' 81270000
812800                 DISPLAY 'PV-VEHICL-OWNER-SCAC-ID: '              81280000
812900                          PV-VEHICL-OWNER-SCAC-ID                 81290000
813000                 DISPLAY '**********************************'     81300000
813100                 PERFORM 9700-SQL-WARNING                         81310000
813200                                                                  81320000
813300             WHEN  SQLCODE < ZERO                                 81330000
813400                 DISPLAY '**************************************' 81340000
813500                 DISPLAY 'ERROR ISSUED ON SELECT OF TENTNME     ' 81350000
813600                 DISPLAY 'PV-VEHICL-OWNER-SCAC-ID: '              81360000
813700                          PV-VEHICL-OWNER-SCAC-ID                 81370000
813800                 DISPLAY '**************************************' 81380000
813900                 PERFORM 9800-SQL-ERROR                           81390000
814000                                                                  81400000
814100         END-EVALUATE                                             81410000
814200                                                                  81420000
814300     END-PERFORM.                                                 81430000
814400                                                                  81440000
814500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    81450000
814600         SQLCODE NOT = +0                                         81460000
814700         DISPLAY '**************************************'         81470000
814800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         81480000
814900         DISPLAY 'SELECT TEXTENT/TENTNME                '         81490000
815000         DISPLAY 'PV-VEHICL-OWNER-SCAC-ID: '                      81500000
815100                  PV-VEHICL-OWNER-SCAC-ID                         81510000
815200         DISPLAY '**************************************'         81520000
815300         PERFORM 9800-SQL-ERROR                                   81530000
815400     END-IF.                                                      81540000
815500                                                                  81550000
815600     EVALUATE TRUE                                                81560000
815700         WHEN SQLCODE = ZERO                                      81570000
815800             MOVE ENTNME-ENT-NAME-DESC                            81580000
815900                                 TO PV-SHIPMT-SHIPPER-NME         81590000
816000     END-EVALUATE.                                                81600000
816100                                                                  81610000
816200***************************************************************** 81620000
816300*     INSERT A COPY OF THE SHIPMT ROW TO THE AUDIT TRAIL TABLE  * 81630000
816400*     BEFORE UPDATING THE SHIPMT TABLE.                         * 81640000
816500***************************************************************** 81650000
816600                                                                  81660000
816700 799C-CREATE-SHIPMT-AUDIT-TRAIL.                                  81670000
816800                                                                  81680000
816900     MOVE '799C-CREATE-SHIPMT-AUDIT-TRAIL'                        81690000
817000                                 TO PV-ABEND-PARAGRAPH.           81700000
817001                                                                  81700106
817200     PERFORM                                                      81720000
817300         WITH TEST AFTER                                          81730000
817400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     81740000
817500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            81750000
817600                 SQLCODE = ZERO                                   81760000
817700                                                                  81770000
817800         EXEC SQL                                                 81780000
817900             INSERT INTO TAUSHIP                                  81790000
818000                   (TRIP_ID,                                      81800000
818100                    SHIPT_ID,                                     81810000
818200                    CRT_SRC_CDE,                                  81820000
818300                    LAST_UPD_DTE,                                 81830000
818400                    LAST_UPD_TME,                                 81840000
818500                    LAST_UPD_UID,                                 81850000
818600                    PRO_SCAC_ID,                                  81860000
818700                    PRO_NBR,                                      81870000
818800                    BOL_NBR,                                      81880000
818900                    SHIPPER_NME,                                  81890000
819000                    SHIPT_TYP_CDE,                                81900000
819100                    EXPTED_GRO_WGHT,                              81910000
819200                    PKG_TYP_CDE,                                  81920000
819300                    EXPTED_PKG_QTY,                               81930000
819400                    FRGT_CHG_AMT,                                 81940000
819500                    FRGT_TERMS_CDE,                               81950000
819600                    EST_AR_TMST,                                  81960000
819700                    VEND_SHIP_DTE,                                81970000
819800                    EXPTED_PLT_QTY,                               81980000
819900                    ORIG_SCAC_ID,                                 81990000
820000                    LAST_UPD_PGM_ID,                              82000000
820100                    CRE_USER_ID,                                  82010000
820200                    CARR_CART_CT,                                 82020000
820300                    CARR_LAST_UPD_DTE,                            82030000
820400                    CARR_LAST_UPD_TIME,                           82040000
820500                    VEND_CART_CT,                                 82050000
820600                    VEND_LAST_UPD_DTE,                            82060000
820700                    VEND_LAST_UPD_TIME,                           82070000
820800                    VEH_NBR,                                      82080000
820900                    AUTH_NBR,                                     82090000
821000                    AUTH_DTE,                                     82100000
821100                    CONFIRM_DTE,                                  82110000
821200                    CONFIRM_TIME,                                 82120000
821300                    PROCESSED_DTE,                                82130000
821400                    INVC_NBR,                                     82140000
821500                    AUD_STATUS_CDE,                               82150006
821510                    CARR_AUTH_ID  )                               82151006
821600             VALUES                                               82160000
821700                  (:SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,     82170000
821800                   :SHIPMT-SHIPT-ID,                              82180000
821900                   :SHIPMT-CRT-SRC-CDE,                           82190000
822000                   :SHIPMT-LAST-UPD-DTE,                          82200000
822100                   :SHIPMT-LAST-UPD-TME,                          82210000
822200                   :SHIPMT-LAST-UPD-UID,                          82220000
822300                   :SHIPMT-PRO-SCAC-ID,                           82230000
822400                   :SHIPMT-COMPLETE-PRO-NBR,                      82240000
822500                   :SHIPMT-COMPLETE-BOL-NBR,                      82250000
822600                   :SHIPMT-SHIPPER-NME,                           82260000
822700                   :SHIPMT-SHIPT-TYP-CDE,                         82270000
822800                   :SHIPMT-EXPTED-GRO-WGHT,                       82280000
822900                   :SHIPMT-PKG-TYP-CDE,                           82290000
823000                   :SHIPMT-EXPTED-PKG-QTY,                        82300000
823100                   :SHIPMT-FRGT-CHG-AMT,                          82310000
823200                   :SHIPMT-FRGT-TERMS-CDE,                        82320000
823300                   :SHIPMT-EST-AR-TMST :PV-SHIPMT-EST-AR-NULL,    82330000
823400                   :SHIPMT-VEND-SHIP-DTE,                         82340000
823500                   :SHIPMT-EXPTED-PLT-QTY,                        82350000
823600                   :SHIPMT-ORIG-SCAC-ID,                          82360000
823700                   :SHIPMT-LAST-UPD-PGM-ID,                       82370000
823800                   :SHIPMT-CRE-USER-ID,                           82380000
823900                   :SHIPMT-CARR-CART-CT,                          82390000
824000                   :SHIPMT-CARR-LAST-UPD-DTE,                     82400000
824100                   :SHIPMT-CARR-LAST-UPD-TIME,                    82410000
824200                   :SHIPMT-VEND-CART-CT,                          82420000
824300                   :SHIPMT-VEND-LAST-UPD-DTE,                     82430000
824400                   :SHIPMT-VEND-LAST-UPD-TIME,                    82440000
824500                   :SHIPMT-VEH-NBR,                               82450000
824600                   :SHIPMT-AUTH-NBR,                              82460000
824700                   :SHIPMT-AUTH-DTE,                              82470000
824800                   :SHIPMT-CONFIRM-DTE,                           82480000
824900                   :SHIPMT-CONFIRM-TIME,                          82490000
825000                   :SHIPMT-PROCESSED-DTE,                         82500000
825100                   :SHIPMT-INVC-NBR,                              82510000
825200                   :PC-EN,                                        82520006
825210                   :SHIPMT-CARR-AUTH-ID)                          82521006
825300         END-EXEC                                                 82530000
825400                                                                  82540000
825500         EVALUATE TRUE                                            82550000
825600             WHEN SQLCODE = ZERO                                  82560000
825700             WHEN SQLCODE = -911                                  82570000
825800                 CONTINUE                                         82580000
825900                                                                  82590000
826000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              82600000
826100                 DISPLAY '**************************************' 82610000
826200                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUSHIP   ' 82620000
826300                 DISPLAY 'SHIPMT-SHIPT-ID:    '                   82630000
826400                          SHIPMT-SHIPT-ID                         82640000
826500                 DISPLAY 'SHIPMT-BOL-NBR:     '                   82650000
826600                          SHIPMT-BOL-NBR                          82660000
826700                 DISPLAY 'SHIPMT-PRO-NBR:     '                   82670000
826800                          SHIPMT-PRO-NBR                          82680000
826900                 DISPLAY '**********************************'     82690000
827000                 PERFORM 9700-SQL-WARNING                         82700000
827100                                                                  82710000
827200             WHEN SQLCODE < ZERO                                  82720000
827300                 DISPLAY '**************************************' 82730000
827400                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUSHIP     ' 82740000
827500                 DISPLAY 'SHIPMT-SHIPT-ID:    '                   82750000
827600                          SHIPMT-SHIPT-ID                         82760000
827700                 DISPLAY 'SHIPMT-BOL-NBR:     '                   82770000
827800                          SHIPMT-BOL-NBR                          82780000
827900                 DISPLAY 'SHIPMT-PRO-NBR:     '                   82790000
828000                          SHIPMT-PRO-NBR                          82800000
828100                 DISPLAY '**************************************' 82810000
828200                 PERFORM 9800-SQL-ERROR                           82820000
828300                                                                  82830000
828400         END-EVALUATE                                             82840000
828500     END-PERFORM.                                                 82850000
828600                                                                  82860000
828700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    82870000
828800         SQLCODE NOT = +0                                         82880000
828900         DISPLAY '**************************************'         82890000
829000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         82900000
829100         DISPLAY 'INSERT TO TAUSHIP                     '         82910000
829200         DISPLAY 'SHIPMT-SHIPT-ID: '                              82920000
829300                  SHIPMT-SHIPT-ID                                 82930000
829400         DISPLAY 'SHIPMT-BOL-NBR:  '                              82940000
829500                  SHIPMT-BOL-NBR                                  82950000
829600         DISPLAY 'SHIPMT-PRO-NBR:  '                              82960000
829700                  SHIPMT-PRO-NBR                                  82970000
829800         DISPLAY '**************************************'         82980000
829900         PERFORM 9800-SQL-ERROR                                   82990000
830000     END-IF.                                                      83000000
830100                                                                  83010000
830200***************************************************************** 83020000
830300*     SQL INSERT SHPTPO                                         * 83030000
830400***************************************************************** 83040000
830500                                                                  83050000
830600 799D-INSERT-SHPTPO.                                              83060000
830700                                                                  83070000
830800     MOVE '799D-INSERT-SHPTPO'   TO PV-ABEND-PARAGRAPH.           83080000
830900                                                                  83090000
831000     MOVE PV-SHPTPO-SHIPT-ID     TO SHPTPO-SHIPT-ID.              83100000
831100     MOVE PV-SHPTPO-PO-NBR-N     TO SHPTPO-PO-NBR.                83110000
831200                                                                  83120000
831300     PERFORM                                                      83130000
831400         WITH TEST AFTER                                          83140000
831500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     83150000
831600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            83160000
831700                (SQLCODE = ZERO) OR (SQLCODE = -803)              83170000
831800                                                                  83180000
831900         EXEC SQL                                                 83190000
832000             INSERT INTO TSHPTPO                                  83200000
832100                   (SHIPT_ID,                                     83210000
832200                    PO_NBR,                                       83220000
832300                    REC_SEQ_NBR,                                  83230000
832400                    EXPTED_CART_CNT,                              83240000
832500                    ACTL_CART_CNT,                                83250000
832600                    DMG_CART_CNT,                                 83260000
832700                    LAST_UPD_PGM_ID,                              83270000
832800                    CRE_USER_ID,                                  83280000
832900                    CARR_LAST_UPD_DTE,                            83290000
833000                    CARR_LAST_UPD_TIME,                           83300000
833100                    VEND_CART_CT,                                 83310000
833200                    VEND_LAST_UPD_DTE,                            83320000
833300                    VEND_LAST_UPD_TIME,                           83330000
833400                    CRE_TMST,                                     83340000
833500                    LAST_UPD_USER_ID,                             83350000
833600                    PRIM_SHIPT_IND                                83360000
833700                 ,  SPLT_XMIT_IND                                 83370000
833800                 ,  SPLT_XMIT_DTE                                 83380000
833900                 ,  SPLT_XMIT_TM  )                               83390000
834000             VALUES                                               83400000
834100                  (:SHPTPO-SHIPT-ID,                              83410000
834200                   :SHPTPO-PO-NBR,                                83420000
834300                   :PC-INT-ZERO,                                  83430000
834400                   :PC-SML-ZERO,                                  83440000
834500                   :PC-SML-ZERO,                                  83450000
834600                   :PC-SML-ZERO,                                  83460000
834700                   :PC-RCKUP006,                                  83470000
834800                   :PC-RCKUP006,                                  83480000
834900                   :PC-DEFAULT-DATE,                              83490000
835000                   :PC-DEFAULT-TIME,                              83500000
835100                   :PV-SHPTPO-VEND-CART-CNT,                      83510000
835200                    CURRENT DATE,                                 83520000
835300                    CURRENT TIME,                                 83530000
835400                    CURRENT TIMESTAMP,                            83540000
835500                   :PC-RCKUP006,                                  83550000
835600                   :PC-Y                                          83560000
835700                 , :PC-SPACE                                      83570000
835800                 , :PC-DEFAULT-DATE                               83580000
835900                 , :PC-DEFAULT-TIME )                             83590000
836000         END-EXEC                                                 83600000
836100                                                                  83610000
836200         EVALUATE TRUE                                            83620000
836300             WHEN SQLCODE = ZERO                                  83630000
836310                 ADD +1 TO PV-ADD-TSHPTPO                         83631000
836400             WHEN SQLCODE = -803                                  83640000
836410                 ADD +1 TO PV-ADD-TSHPTPO-FAIL-DUPE               83641000
836500             WHEN SQLCODE = -911                                  83650000
836600                 CONTINUE                                         83660000
836700                                                                  83670000
836800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              83680000
836900                 DISPLAY '**************************************' 83690000
837000                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHPTPO   ' 83700000
837100                 DISPLAY 'SHPTPO-SHIPT-ID:    '                   83710000
837200                          SHPTPO-SHIPT-ID                         83720000
837300                 DISPLAY 'SHPTPO-PO-NBR:      '                   83730000
837400                          SHPTPO-PO-NBR                           83740000
837500                 DISPLAY '**********************************'     83750000
837600                 PERFORM 9700-SQL-WARNING                         83760000
837700                                                                  83770000
837800             WHEN  SQLCODE < ZERO                                 83780000
837900                 DISPLAY '**************************************' 83790000
838000                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHPTPO     ' 83800000
838100                 DISPLAY 'SHPTPO-SHIPT-ID:    '                   83810000
838200                          SHPTPO-SHIPT-ID                         83820000
838300                 DISPLAY 'SHPTPO-PO-NBR:      '                   83830000
838400                          SHPTPO-PO-NBR                           83840000
838500                 DISPLAY '**************************************' 83850000
838600                 PERFORM 9800-SQL-ERROR                           83860000
838700                                                                  83870000
838800         END-EVALUATE                                             83880000
838900                                                                  83890000
839000     END-PERFORM.                                                 83900000
839100                                                                  83910000
839200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    83920000
839300         SQLCODE NOT = +0                                         83930000
839400         DISPLAY '**************************************'         83940000
839500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         83950000
839600         DISPLAY 'INSERT TO TSHPTPO                     '         83960000
839700         DISPLAY 'SHPTPO-SHIPT-ID:    '                           83970000
839800                  SHPTPO-SHIPT-ID                                 83980000
839900         DISPLAY 'SHPTPO-PO-NBR:      '                           83990000
840000                  SHPTPO-PO-NBR                                   84000000
840100         DISPLAY '**************************************'         84010000
840200         PERFORM 9800-SQL-ERROR                                   84020000
840300     END-IF.                                                      84030000
840400                                                                  84040000
840500     EVALUATE TRUE                                                84050000
840600         WHEN SQLCODE = ZERO                                      84060000
840700             MOVE PC-A          TO AUSHPO-TRN-CDE                 84070000
840800             PERFORM 799K-CREATE-SHPTPO-AUDIT-TRAIL               84080000
840900                                                                  84090000
841000         WHEN SQLCODE = -803                                      84100000
841100             CONTINUE                                             84110000
841200     END-EVALUATE.                                                84120000
841300                                                                  84130000
841400***************************************************************** 84140000
841500*     CHECK IF THE SHIPMENT STATUS RECORD ALREADY EXIST.  ALSO  * 84150000
841600*     NEED TO DETERMINE WHAT PROGRAM PUT IT INTO THAT STATUS.   * 84160000
841700***************************************************************** 84170000
841800                                                                  84180000
841900 799E-PROCESS-SHIPST.                                             84190000
842000                                                                  84200000
842100     MOVE '799E-PROCESS-SHIPST'  TO PV-ABEND-PARAGRAPH.           84210000
842200     MOVE PC-EN                  TO SHIPST-SHIPT-STATUS-CDE.      84220000
842300                                                                  84230000
842400     PERFORM 799F-SELECT-SHIPST.                                  84240000
842500                                                                  84250000
842600     IF PS-INSERT-SHIPST                                          84260000
842700         PERFORM 799G-FORMAT-SHIPST                               84270000
842800         PERFORM 799I-INSERT-SHIPST                               84280000
842900     ELSE                                                         84290000
843000         IF PS-UPDATE-SHIPST                                      84300000
843100             PERFORM 799G-FORMAT-SHIPST                           84310000
843200             PERFORM 799H-UPDATE-SHIPST                           84320000
843300         END-IF                                                   84330000
843400     END-IF.                                                      84340000
843500                                                                  84350000
843600***************************************************************** 84360000
843700*     SELECT SHIPMENT STATUS RECORD                             * 84370000
843800***************************************************************** 84380000
843900                                                                  84390000
844000 799F-SELECT-SHIPST.                                              84400000
844100                                                                  84410000
844200     MOVE '799F-SELECT-SHIPST'   TO PV-ABEND-PARAGRAPH.           84420000
844300                                                                  84430000
844400     PERFORM                                                      84440000
844500         WITH TEST AFTER                                          84450000
844600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     84460000
844700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            84470000
844800                (SQLCODE = ZERO)   OR                             84480000
844900                (SQLCODE = +100)                                  84490000
845000                                                                  84500000
845100         EXEC SQL                                                 84510000
845200             SELECT SHIPT_ID,                                     84520000
845300                    SHIPT_STATUS_CDE,                             84530000
845400                    STATUS_DTE,                                   84540000
845500                    STATUS_TME,                                   84550000
845600                    STATUS_UID,                                   84560000
845700                    DELAY_RSN_CDE,                                84570000
845800                    CARR_STATUS_CDE,                              84580000
845900                    TIME_ZONE_CDE,                                84590000
846000                    CITY_NAME,                                    84600000
846100                    STATE_CDE                                     84610000
846200               INTO :SHIPST-SHIPT-ID,                             84620000
846300                    :SHIPST-SHIPT-STATUS-CDE,                     84630000
846400                    :SHIPST-STATUS-DTE,                           84640000
846500                    :SHIPST-STATUS-TME,                           84650000
846600                    :SHIPST-STATUS-UID,                           84660000
846700                    :SHIPST-DELAY-RSN-CDE,                        84670000
846800                    :SHIPST-CARR-STATUS-CDE,                      84680000
846900                    :SHIPST-TIME-ZONE-CDE,                        84690000
847000                    :SHIPST-CITY-NAME,                            84700000
847100                    :SHIPST-STATE-CDE                             84710000
847200               FROM TSHIPST                                       84720000
847300              WHERE SHIPT_ID         = :PV-SHIPMT-SHIPT-ID        84730000
847400                AND SHIPT_STATUS_CDE = :SHIPST-SHIPT-STATUS-CDE   84740000
847500         END-EXEC                                                 84750000
847600                                                                  84760000
847700         EVALUATE TRUE                                            84770000
847800             WHEN SQLCODE = ZERO                                  84780000
847900             WHEN SQLCODE = +100                                  84790000
848000             WHEN SQLCODE = -911                                  84800000
848100                 CONTINUE                                         84810000
848200                                                                  84820000
848300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              84830000
848400                 DISPLAY '**************************************' 84840000
848500                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPST   ' 84850000
848600                 DISPLAY 'PV-SHIPST-SHIPT-ID:         '           84860000
848700                          PV-SHIPST-SHIPT-ID                      84870000
848800                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE: '              84880000
848900                          SHIPST-SHIPT-STATUS-CDE                 84890000
849000                 DISPLAY '**********************************'     84900000
849100                 PERFORM 9700-SQL-WARNING                         84910000
849200                                                                  84920000
849300             WHEN  SQLCODE < ZERO                                 84930000
849400                 DISPLAY '**************************************' 84940000
849500                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPST     ' 84950000
849600                 DISPLAY 'PV-SHIPST-SHIPT-ID:         '           84960000
849700                          PV-SHIPST-SHIPT-ID                      84970000
849800                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE: '              84980000
849900                          SHIPST-SHIPT-STATUS-CDE                 84990000
850000                 DISPLAY '**************************************' 85000000
850100                 PERFORM 9800-SQL-ERROR                           85010000
850200                                                                  85020000
850300         END-EVALUATE                                             85030000
850400                                                                  85040000
850500     END-PERFORM.                                                 85050000
850600                                                                  85060000
850700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    85070000
850800         SQLCODE NOT = +0                                         85080000
850900         DISPLAY '**************************************'         85090000
851000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         85100000
851100         DISPLAY 'SELECT TSHIPST                        '         85110000
851200         DISPLAY 'PV-SHIPST-SHIPT-ID:         '                   85120000
851300                  PV-SHIPST-SHIPT-ID                              85130000
851400         DISPLAY 'SHIPST-SHIPT-STATUS-CDE: '                      85140000
851500                  SHIPST-SHIPT-STATUS-CDE                         85150000
851600         DISPLAY '**************************************'         85160000
851700         PERFORM 9800-SQL-ERROR                                   85170000
851800     END-IF.                                                      85180000
851900                                                                  85190000
852000     EVALUATE TRUE                                                85200000
852100         WHEN SQLCODE = ZERO                                      85210000
852200             IF SHIPST-STATUS-UID = PC-TRKUP004 OR                85220000
852300                SHIPST-STATUS-UID = PC-RCKUP006                   85230000
852400                 SET PS-UPDATE-SHIPST                             85240000
852500                                 TO TRUE                          85250000
852600             ELSE                                                 85260000
852700                 SET PS-BYPASS-SHIPST                             85270000
852800                                 TO TRUE                          85280000
852900             END-IF                                               85290000
853000                                                                  85300000
853100         WHEN SQLCODE = +100                                      85310000
853200             SET PS-INSERT-SHIPST                                 85320000
853300                                 TO TRUE                          85330000
853400     END-EVALUATE.                                                85340000
853500                                                                  85350000
853600 EJECT                                                            85360000
853700***************************************************************** 85370000
853800*     FORMAT THE SHIPMENT STATUS INFORMATION FOR EITHER INSERT  * 85380000
853900*     OR UPDATE                                                 * 85390000
854000***************************************************************** 85400000
854100                                                                  85410000
854200 799G-FORMAT-SHIPST.                                              85420000
854300                                                                  85430000
854400     MOVE '799G-FORMAT-SHIPST'   TO PV-ABEND-PARAGRAPH.           85440000
854500                                                                  85450000
854600     MOVE PV-SHIPMT-SHIPT-ID     TO SHIPST-SHIPT-ID.              85460000
854700     MOVE PV-SHIPST-STATUS-DTE   TO SHIPST-STATUS-DTE.            85470000
854800     MOVE PV-SHIPST-STATUS-TME   TO SHIPST-STATUS-TME.            85480000
854900     MOVE PV-SHIPST-SHIPT-STATUS-CDE                              85490000
855000                                 TO SHIPST-SHIPT-STATUS-CDE.      85500000
855100     MOVE PV-SHIPST-DELAY-RSN-CDE                                 85510000
855200                                 TO SHIPST-DELAY-RSN-CDE.         85520000
855300     MOVE PC-RCKUP006            TO SHIPST-STATUS-UID.            85530000
855400     MOVE PV-SHIPST-TIME-ZONE    TO SHIPST-TIME-ZONE-CDE.         85540000
855500     MOVE PV-SHIPST-CITY         TO SHIPST-CITY-NAME.             85550000
855600     MOVE PV-SHIPST-STATE        TO SHIPST-STATE-CDE.             85560000
855700     MOVE PV-SHIPST-CARR-STATUS-CDE                               85570000
855800                                 TO SHIPST-CARR-STATUS-CDE.       85580000
855900                                                                  85590000
856000 EJECT                                                            85600000
856100***************************************************************** 85610000
856200*     SQL UPDATE SHIPST                                         * 85620000
856300*     IF THE RECORD IS NOT FOUND, A SWITCH WILL BE SET AND AN   * 85630000
856400*     INSERT ATTEMPTED.                                         * 85640000
856500***************************************************************** 85650000
856600                                                                  85660000
856700 799H-UPDATE-SHIPST.                                              85670000
856800                                                                  85680000
856900     MOVE '799H-UPDATE-SHIPST'   TO PV-ABEND-PARAGRAPH.           85690000
857000                                                                  85700000
857100     PERFORM                                                      85710000
857200         WITH TEST AFTER                                          85720000
857300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     85730000
857400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            85740000
857500                 SQLCODE = ZERO OR                                85750000
857600                 SQLCODE = +100                                   85760000
857700                                                                  85770000
857800         EXEC SQL                                                 85780000
857900             UPDATE TSHIPST                                       85790000
858000                SET STATUS_DTE       = :SHIPST-STATUS-DTE,        85800000
858100                    STATUS_TME       = :PC-DEFAULT-TIME,          85810000
858200                    STATUS_UID       = :SHIPST-STATUS-UID,        85820000
858300                    DELAY_RSN_CDE    = :SHIPST-DELAY-RSN-CDE,     85830000
858400                    CARR_STATUS_CDE  = :SHIPST-CARR-STATUS-CDE,   85840000
858500                    TIME_ZONE_CDE    = :SHIPST-TIME-ZONE-CDE,     85850000
858600                    CITY_NAME        = :SHIPST-CITY-NAME,         85860000
858700                    STATE_CDE        = :SHIPST-STATE-CDE          85870000
858800              WHERE SHIPT_ID         = :SHIPST-SHIPT-ID           85880000
858900                AND SHIPT_STATUS_CDE = :SHIPST-SHIPT-STATUS-CDE   85890000
859000         END-EXEC                                                 85900000
859100                                                                  85910000
859200         EVALUATE TRUE                                            85920000
859300             WHEN SQLCODE = ZERO                                  85930000
859310                 ADD +1 TO PV-UPDATE-TSHIPST                      85931000
859400             WHEN SQLCODE = +100                                  85940000
859500             WHEN SQLCODE = -911                                  85950000
859600                 CONTINUE                                         85960000
859700                                                                  85970000
859800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              85980000
859900                 DISPLAY '**************************************' 85990000
860000                 DISPLAY 'WARNING ISSUED ON UPDATE OF TSHIPST   ' 86000000
860100                 DISPLAY 'SHIPST-SHIPT-ID:      '                 86010000
860200                          SHIPST-SHIPT-ID                         86020000
860300                 DISPLAY '**********************************'     86030000
860400                 PERFORM 9700-SQL-WARNING                         86040000
860500                                                                  86050000
860600             WHEN SQLCODE < ZERO                                  86060000
860700                 DISPLAY '**************************************' 86070000
860800                 DISPLAY 'ERROR ISSUED ON UPDATE OF TSHIPST     ' 86080000
860900                 DISPLAY 'SHIPST-SHIPT-ID:      '                 86090000
861000                          SHIPST-SHIPT-ID                         86100000
861100                 DISPLAY '**************************************' 86110000
861200                 PERFORM 9800-SQL-ERROR                           86120000
861300                                                                  86130000
861400         END-EVALUATE                                             86140000
861500                                                                  86150000
861600     END-PERFORM.                                                 86160000
861700                                                                  86170000
861800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    86180000
861900         SQLCODE NOT = +0                                         86190000
862000         DISPLAY '**************************************'         86200000
862100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         86210000
862200         DISPLAY 'UPDATE TSHIPST                        '         86220000
862300         DISPLAY 'SHIPST-SHIPT-ID:    '                           86230000
862400                  SHIPST-SHIPT-ID                                 86240000
862500         DISPLAY '**************************************'         86250000
862600         PERFORM 9800-SQL-ERROR                                   86260000
862700     END-IF.                                                      86270000
862800                                                                  86280000
862900 EJECT                                                            86290000
863000***************************************************************** 86300000
863100*     SQL INSERT SHIPST                                         * 86310000
863200***************************************************************** 86320000
863300                                                                  86330000
863400 799I-INSERT-SHIPST.                                              86340000
863500                                                                  86350000
863600     MOVE '799I-INSERT-SHIPST'   TO PV-ABEND-PARAGRAPH.           86360000
863700                                                                  86370000
863800     PERFORM                                                      86380000
863900         WITH TEST AFTER                                          86390000
864000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     86400000
864100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            86410000
864200                (SQLCODE = ZERO)                                  86420000
864300                                                                  86430000
864400         EXEC SQL                                                 86440000
864500             INSERT INTO TSHIPST                                  86450000
864600                   (SHIPT_ID,                                     86460000
864700                    SHIPT_STATUS_CDE,                             86470000
864800                    STATUS_DTE,                                   86480000
864900                    STATUS_TME,                                   86490000
865000                    STATUS_UID,                                   86500000
865100                    DELAY_RSN_CDE,                                86510000
865200                    CARR_STATUS_CDE,                              86520000
865300                    TIME_ZONE_CDE,                                86530000
865400                    CITY_NAME,                                    86540000
865500                    STATE_CDE)                                    86550000
865600             VALUES                                               86560000
865700                  (:SHIPST-SHIPT-ID,                              86570000
865800                   :SHIPST-SHIPT-STATUS-CDE,                      86580000
865900                   :SHIPST-STATUS-DTE,                            86590000
866000                   :PC-DEFAULT-TIME,                              86600000
866100                   :PC-RCKUP006,                                  86610000
866200                   :SHIPST-DELAY-RSN-CDE,                         86620000
866300                   :SHIPST-CARR-STATUS-CDE,                       86630000
866400                   :SHIPST-TIME-ZONE-CDE,                         86640000
866500                   :SHIPST-CITY-NAME,                             86650000
866600                   :SHIPST-STATE-CDE)                             86660000
866700         END-EXEC                                                 86670000
866800                                                                  86680000
866900         EVALUATE TRUE                                            86690000
867000             WHEN SQLCODE = ZERO                                  86700000
867010                 ADD +1 TO PV-ADD-TSHIPST                         86701000
867100             WHEN SQLCODE = -911                                  86710000
867200                 CONTINUE                                         86720000
867300                                                                  86730000
867400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              86740000
867500                 DISPLAY '**************************************' 86750000
867600                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHIPST   ' 86760000
867700                 DISPLAY 'SHIPST-SHIPT-ID:    '                   86770000
867800                          SHIPST-SHIPT-ID                         86780000
867900                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE:  '             86790000
868000                          SHIPST-SHIPT-STATUS-CDE                 86800000
868100                 DISPLAY '**********************************'     86810000
868200                 PERFORM 9700-SQL-WARNING                         86820000
868300                                                                  86830000
868400             WHEN SQLCODE < ZERO                                  86840000
868500                 DISPLAY '**************************************' 86850000
868600                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHIPST     ' 86860000
868700                 DISPLAY 'SHIPST-SHIPT-ID:    '                   86870000
868800                          SHIPST-SHIPT-ID                         86880000
868900                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE:  '             86890000
869000                          SHIPST-SHIPT-STATUS-CDE                 86900000
869100                 DISPLAY '**************************************' 86910000
869200                 PERFORM 9800-SQL-ERROR                           86920000
869300                                                                  86930000
869400         END-EVALUATE                                             86940000
869500     END-PERFORM.                                                 86950000
869600                                                                  86960000
869700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    86970000
869800         SQLCODE NOT = +0                                         86980000
869900         DISPLAY '**************************************'         86990000
870000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         87000000
870100         DISPLAY 'INSERT TO TSHIPST                     '         87010000
870200         DISPLAY 'SHIPST-SHIPT-ID:    '                           87020000
870300                  SHIPST-SHIPT-ID                                 87030000
870400         DISPLAY 'SHIPST-SHIPT-STATUS-CDE:  '                     87040000
870500                  SHIPST-SHIPT-STATUS-CDE                         87050000
870600         DISPLAY '**************************************'         87060000
870700         PERFORM 9800-SQL-ERROR                                   87070000
870800     END-IF.                                                      87080000
870900                                                                  87090000
871000***************************************************************** 87100000
871100*     DELETE UNUSED TRIPS                                       * 87110000
871200***************************************************************** 87120000
871300                                                                  87130000
871400 799J-DELETE-VHTRIP.                                              87140000
871500                                                                  87150000
871600     MOVE '799J-DELETE-VHTRIP'   TO PV-ABEND-PARAGRAPH.           87160000
871700                                                                  87170000
871800     PERFORM                                                      87180000
871900         WITH TEST AFTER                                          87190000
872000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     87200000
872100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            87210000
872200                 SQLCODE = ZERO                                   87220000
872300                                                                  87230000
872400         EXEC SQL                                                 87240000
872500             DELETE FROM TVHTRIP                                  87250000
872600              WHERE TRIP_ID         = :PV-SAVE-SHIPMT-TRIP-ID     87260000
872700         END-EXEC                                                 87270000
872800                                                                  87280000
872900         EVALUATE TRUE                                            87290000
873000             WHEN SQLCODE = ZERO                                  87300000
873010                 ADD +1 TO PV-DELETE-TVHTRIP                      87301000
873100             WHEN SQLCODE = -911                                  87310000
873200                 CONTINUE                                         87320000
873300                                                                  87330000
873400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              87340000
873500                 DISPLAY '**************************************' 87350000
873600                 DISPLAY 'WARNING ISSUED ON DELETE OF TVHTRIP   ' 87360000
873700                 DISPLAY 'PV-SAVE-SHIPMT-TRIP-ID: '               87370000
873800                          PV-SAVE-SHIPMT-TRIP-ID                  87380000
873900                 DISPLAY '**********************************'     87390000
874000                 PERFORM 9700-SQL-WARNING                         87400000
874100                                                                  87410000
874200             WHEN SQLCODE < ZERO                                  87420000
874300                 DISPLAY '**************************************' 87430000
874400                 DISPLAY 'ERROR ISSUED ON DELETE OF TVHTRIP     ' 87440000
874500                 DISPLAY 'PV-SAVE-SHIPMT-TRIP-ID: '               87450000
874600                          PV-SAVE-SHIPMT-TRIP-ID                  87460000
874700                 DISPLAY '**************************************' 87470000
874800                 PERFORM 9800-SQL-ERROR                           87480000
874900                                                                  87490000
875000         END-EVALUATE                                             87500000
875100                                                                  87510000
875200     END-PERFORM.                                                 87520000
875300                                                                  87530000
875400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    87540000
875500         SQLCODE NOT = +0                                         87550000
875600         DISPLAY '**************************************'         87560000
875700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         87570000
875800         DISPLAY 'DELETE TVHTRIP                        '         87580000
875900         DISPLAY 'PV-SAVE-SHIPMT-TRIP-ID: '                       87590000
876000                  PV-SAVE-SHIPMT-TRIP-ID                          87600000
876100         DISPLAY '**************************************'         87610000
876200         PERFORM 9800-SQL-ERROR                                   87620000
876300     END-IF.                                                      87630000
876400                                                                  87640000
876500***************************************************************** 87650000
876600*     INSERT A COPY OF THE SHPTPO ROW TO THE AUDIT TRAIL TABLE  * 87660000
876700*     AFTER INSERTING THE SHPTPO TABLE.                        *  87670000
876800***************************************************************** 87680000
876900                                                                  87690000
877000 799K-CREATE-SHPTPO-AUDIT-TRAIL.                                  87700000
877100                                                                  87710000
877200     MOVE '799K-CREATE-SHPTPO-AUDIT-TRAIL'                        87720000
877300                                 TO PV-ABEND-PARAGRAPH.           87730000
877400                                                                  87740000
877500     PERFORM                                                      87750000
877600         WITH TEST AFTER                                          87760000
877700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     87770000
877800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            87780000
877900                (SQLCODE = ZERO)   OR                             87790000
878000                (SQLCODE = +100)                                  87800000
878100                                                                  87810000
878200         EXEC SQL                                                 87820000
878300             SELECT SHIPT_ID,                                     87830000
878400                    PO_NBR,                                       87840000
878500                    REC_SEQ_NBR,                                  87850000
878600                    EXPTED_CART_CNT,                              87860000
878700                    ACTL_CART_CNT,                                87870000
878800                    DMG_CART_CNT,                                 87880000
878900                    PKSL_IND,                                     87890000
879000                    VEND_NAME,                                    87900000
879100                    FRGT_CHG_AMT,                                 87910000
879200                    LAST_UPD_PGM_ID,                              87920000
879300                    CRE_USER_ID,                                  87930000
879400                    CARR_CART_CT,                                 87940000
879500                    CARR_LAST_UPD_DTE,                            87950000
879600                    CARR_LAST_UPD_TIME,                           87960000
879700                    VEND_CART_CT,                                 87970000
879800                    VEND_LAST_UPD_DTE,                            87980000
879900                    VEND_LAST_UPD_TIME,                           87990000
880000                    CRE_TMST,                                     88000000
880100                    LAST_UPD_DTE,                                 88010000
880200                    LAST_UPD_TIME,                                88020000
880300                    LAST_UPD_USER_ID,                             88030000
880400                    PRIM_SHIPT_IND                                88040000
880500                  , SPLT_XMIT_IND                                 88050000
880600                  , SPLT_XMIT_DTE                                 88060000
880700                  , SPLT_XMIT_TM                                  88070000
880800               INTO :SHPTPO-SHIPT-ID,                             88080000
880900                    :SHPTPO-PO-NBR,                               88090000
881000                    :SHPTPO-REC-SEQ-NBR,                          88100000
881100                    :SHPTPO-EXPTED-CART-CNT,                      88110000
881200                    :SHPTPO-ACTL-CART-CNT,                        88120000
881300                    :SHPTPO-DMG-CART-CNT,                         88130000
881400                    :SHPTPO-PKSL-IND,                             88140000
881500                    :SHPTPO-VEND-NAME,                            88150000
881600                    :SHPTPO-FRGT-CHG-AMT,                         88160000
881700                    :SHPTPO-LAST-UPD-PGM-ID,                      88170000
881800                    :SHPTPO-CRE-USER-ID,                          88180000
881900                    :SHPTPO-CARR-CART-CT,                         88190000
882000                    :SHPTPO-CARR-LAST-UPD-DTE,                    88200000
882100                    :SHPTPO-CARR-LAST-UPD-TIME,                   88210000
882200                    :SHPTPO-VEND-CART-CT,                         88220000
882300                    :SHPTPO-VEND-LAST-UPD-DTE,                    88230000
882400                    :SHPTPO-VEND-LAST-UPD-TIME,                   88240000
882500                    :SHPTPO-CRE-TMST,                             88250000
882600                    :SHPTPO-LAST-UPD-DTE,                         88260000
882700                    :SHPTPO-LAST-UPD-TIME,                        88270000
882800                    :SHPTPO-LAST-UPD-USER-ID,                     88280000
882900                    :SHPTPO-PRIM-SHIPT-IND                        88290000
883000                 ,  :SHPTPO-SPLT-XMIT-IND                         88300000
883100                 ,  :SHPTPO-SPLT-XMIT-DTE                         88310000
883200                 ,  :SHPTPO-SPLT-XMIT-TM                          88320000
883300               FROM TSHPTPO                                       88330000
883400              WHERE SHIPT_ID        = :SHPTPO-SHIPT-ID            88340000
883500                AND PO_NBR          = :SHPTPO-PO-NBR              88350000
883600         END-EXEC                                                 88360000
883700                                                                  88370000
883800         EVALUATE TRUE                                            88380000
883900             WHEN SQLCODE = ZERO                                  88390000
884000             WHEN SQLCODE = +100                                  88400000
884100             WHEN SQLCODE = -911                                  88410000
884200                 CONTINUE                                         88420000
884300                                                                  88430000
884400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              88440000
884500                 DISPLAY '**************************************' 88450000
884600                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHPTPO   ' 88460000
884700                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      88470000
884800                 DISPLAY 'SHPTPO-PO-NBR    ' SHPTPO-PO-NBR        88480000
884900                 DISPLAY '**********************************'     88490000
885000                 PERFORM 9700-SQL-WARNING                         88500000
885100                                                                  88510000
885200             WHEN  SQLCODE < ZERO                                 88520000
885300                 DISPLAY '**************************************' 88530000
885400                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHPTPO     ' 88540000
885500                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      88550000
885600                 DISPLAY 'SHPTPO-PO-NBR    ' SHPTPO-PO-NBR        88560000
885700                 DISPLAY '**************************************' 88570000
885800                 PERFORM 9800-SQL-ERROR                           88580000
885900                                                                  88590000
886000         END-EVALUATE                                             88600000
886100                                                                  88610000
886200     END-PERFORM.                                                 88620000
886300                                                                  88630000
886400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    88640000
886500         SQLCODE NOT = +0                                         88650000
886600         DISPLAY '**************************************'         88660000
886700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         88670000
886800         DISPLAY 'SELECT TSHPTPO                        '         88680000
886900         DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID              88690000
887000         DISPLAY 'SHPTPO-PO-NBR    ' SHPTPO-PO-NBR                88700000
887100         DISPLAY '**************************************'         88710000
887200         PERFORM 9800-SQL-ERROR                                   88720000
887300     END-IF.                                                      88730000
887400                                                                  88740000
887500     PERFORM                                                      88750000
887600         WITH TEST AFTER                                          88760000
887700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     88770000
887800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            88780000
887900                 SQLCODE = ZERO                                   88790000
888000                                                                  88800000
888100         EXEC SQL                                                 88810000
888200             INSERT INTO TAUSHPO                                  88820000
888300                   (SHIPT_ID,                                     88830000
888400                    PO_NBR,                                       88840000
888500                    REC_SEQ_NBR,                                  88850000
888600                    EXPTED_CART_CNT,                              88860000
888700                    ACTL_CART_CNT,                                88870000
888800                    DMG_CART_CNT,                                 88880000
888900                    PKSL_IND,                                     88890000
889000                    VEND_NAME,                                    88900000
889100                    FRGT_CHG_AMT,                                 88910000
889200                    LAST_UPD_PGM_ID,                              88920000
889300                    CRE_USER_ID,                                  88930000
889400                    CARR_CART_CT,                                 88940000
889500                    CARR_LAST_UPD_DTE,                            88950000
889600                    CARR_LAST_UPD_TIME,                           88960000
889700                    VEND_CART_CT,                                 88970000
889800                    VEND_LAST_UPD_DTE,                            88980000
889900                    VEND_LAST_UPD_TIME,                           88990000
890000                    CRE_TMST,                                     89000000
890100                    LAST_UPD_DTE,                                 89010000
890200                    LAST_UPD_TIME,                                89020000
890300                    LAST_UPD_USER_ID,                             89030000
890400                    PRIM_SHIPT_IND                                89040000
890500                  , SPLT_XMIT_IND                                 89050000
890600                  , SPLT_XMIT_DTE                                 89060000
890700                  , SPLT_XMIT_TM                                  89070000
890800                  , TRN_CDE )                                     89080000
890900             VALUES                                               89090000
891000                  (:SHPTPO-SHIPT-ID,                              89100000
891100                   :SHPTPO-PO-NBR,                                89110000
891200                   :SHPTPO-REC-SEQ-NBR,                           89120000
891300                   :SHPTPO-EXPTED-CART-CNT,                       89130000
891400                   :SHPTPO-ACTL-CART-CNT,                         89140000
891500                   :SHPTPO-DMG-CART-CNT,                          89150000
891600                   :SHPTPO-PKSL-IND,                              89160000
891700                   :SHPTPO-VEND-NAME,                             89170000
891800                   :SHPTPO-FRGT-CHG-AMT,                          89180000
891900                   :SHPTPO-LAST-UPD-PGM-ID,                       89190000
892000                   :SHPTPO-CRE-USER-ID,                           89200000
892100                   :SHPTPO-CARR-CART-CT,                          89210000
892200                   :SHPTPO-CARR-LAST-UPD-DTE,                     89220000
892300                   :SHPTPO-CARR-LAST-UPD-TIME,                    89230000
892400                   :SHPTPO-VEND-CART-CT,                          89240000
892500                   :SHPTPO-VEND-LAST-UPD-DTE,                     89250000
892600                   :SHPTPO-VEND-LAST-UPD-TIME,                    89260000
892700                   :SHPTPO-CRE-TMST,                              89270000
892800                   :SHPTPO-LAST-UPD-DTE,                          89280000
892900                   :SHPTPO-LAST-UPD-TIME,                         89290000
893000                   :SHPTPO-LAST-UPD-USER-ID,                      89300000
893100                   :SHPTPO-PRIM-SHIPT-IND                         89310000
893200                 , :SHPTPO-SPLT-XMIT-IND                          89320000
893300                 , :SHPTPO-SPLT-XMIT-DTE                          89330000
893400                 , :SHPTPO-SPLT-XMIT-TM                           89340000
893500                 , :AUSHPO-TRN-CDE )                              89350000
893600         END-EXEC                                                 89360000
893700                                                                  89370000
893800         EVALUATE TRUE                                            89380000
893900             WHEN SQLCODE = ZERO                                  89390000
894000             WHEN SQLCODE = -911                                  89400000
894100                 CONTINUE                                         89410000
894200                                                                  89420000
894300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              89430000
894400                 DISPLAY '**************************************' 89440000
894500                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUSHPO   ' 89450000
894600                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      89460000
894700                 DISPLAY 'SHPTPO-PO-NBR: '  SHPTPO-PO-NBR         89470000
894800                 DISPLAY '**********************************'     89480000
894900                 PERFORM 9700-SQL-WARNING                         89490000
895000                                                                  89500000
895100             WHEN SQLCODE < ZERO                                  89510000
895200                 DISPLAY '**************************************' 89520000
895300                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUSHPO     ' 89530000
895400                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      89540000
895500                 DISPLAY 'SHPTPO-PO-NBR: '  SHPTPO-PO-NBR         89550000
895600                 DISPLAY '**************************************' 89560000
895700                 PERFORM 9800-SQL-ERROR                           89570000
895800                                                                  89580000
895900         END-EVALUATE                                             89590000
896000     END-PERFORM.                                                 89600000
896100                                                                  89610000
896200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    89620000
896300         SQLCODE NOT = +0                                         89630000
896400         DISPLAY '**************************************'         89640000
896500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         89650000
896600         DISPLAY 'INSERT TO TAUSHPO                     '         89660000
896700         DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID              89670000
896800         DISPLAY 'SHPTPO-PO-NBR: '  SHPTPO-PO-NBR                 89680000
896900         DISPLAY '**************************************'         89690000
897000         PERFORM 9800-SQL-ERROR                                   89700000
897100     END-IF.                                                      89710000
897200                                                                  89720000
897300                                                                  89730000
897400 799L-DELETE-VEHICL.                                              89740000
897500                                                                  89750000
897600     MOVE '799L-DELETE-VEHICL'   TO PV-ABEND-PARAGRAPH.           89760000
897700                                                                  89770000
897800     PERFORM                                                      89780000
897900         WITH TEST AFTER                                          89790000
898000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     89800000
898100         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            89810000
898200                 SQLCODE = ZERO OR SQLCODE = +100                 89820000
898300                                                                  89830000
898400         EXEC SQL                                                 89840000
898500             DELETE FROM TVEHICL                                  89850000
898600              WHERE OWNER_SCAC_ID   = :PV-SAVE-OWNER-SCAC-ID      89860000
898700                AND VEH_NBR         = :PV-SAVE-VHTRIP-VEH-NBR     89870000
898800         END-EXEC                                                 89880000
898900                                                                  89890000
899000         EVALUATE TRUE                                            89900000
899100             WHEN SQLCODE = ZERO                                  89910000
899110                 ADD +1 TO PV-DELETE-TVEHICL                      89911000
899200             WHEN SQLCODE = +100                                  89920000
899300             WHEN SQLCODE = -911                                  89930000
899400                 CONTINUE                                         89940000
899500                                                                  89950000
899600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              89960000
899700                 DISPLAY '**************************************' 89970000
899800                 DISPLAY 'WARNING ISSUED ON DELETE OF TVEHICL   ' 89980000
899900                 DISPLAY 'PV-SAVE-OWNER-SCAC-ID  '                89990000
900000                          PV-SAVE-OWNER-SCAC-ID                   90000000
900100                 DISPLAY 'PV-SAVE-VHTRIP-VEH-NBR  '               90010000
900200                          PV-SAVE-VHTRIP-VEH-NBR                  90020000
900300                 DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                 90030000
900400                          VHTRIP-OWNER-SCAC-ID                    90040000
900500                 DISPLAY 'VHTRIP-VEH-NBR:       '                 90050000
900600                          VHTRIP-VEH-NBR                          90060000
900700                 DISPLAY '**********************************'     90070000
900800                 PERFORM 9700-SQL-WARNING                         90080000
900900                                                                  90090000
901000             WHEN SQLCODE < ZERO                                  90100000
901100                 DISPLAY '**************************************' 90110000
901200                 DISPLAY 'ERROR ISSUED ON DELETE OF TVEHICL     ' 90120000
901300                 DISPLAY 'PV-SAVE-OWNER-SCAC-ID  '                90130000
901400                          PV-SAVE-OWNER-SCAC-ID                   90140000
901500                 DISPLAY 'PV-SAVE-VHTRIP-VEH-NBR  '               90150000
901600                          PV-SAVE-VHTRIP-VEH-NBR                  90160000
901700                 DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                 90170000
901800                          VHTRIP-OWNER-SCAC-ID                    90180000
901900                 DISPLAY 'VHTRIP-VEH-NBR:       '                 90190000
902000                          VHTRIP-VEH-NBR                          90200000
902100                 DISPLAY '**************************************' 90210000
902200                 PERFORM 9800-SQL-ERROR                           90220000
902300                                                                  90230000
902400         END-EVALUATE                                             90240000
902500     END-PERFORM.                                                 90250000
902600                                                                  90260000
902700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    90270000
902800         SQLCODE NOT = +0                                         90280000
902900         DISPLAY '**************************************'         90290000
903000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         90300000
903100         DISPLAY 'DELETE TO TVEHICL                     '         90310000
903200         DISPLAY 'PV-SAVE-OWNER-SCAC-ID  '                        90320000
903300                  PV-SAVE-OWNER-SCAC-ID                           90330000
903400         DISPLAY 'PV-SAVE-VHTRIP-VEH-NBR  '                       90340000
903500                  PV-SAVE-VHTRIP-VEH-NBR                          90350000
903600         DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                         90360000
903700                  VHTRIP-OWNER-SCAC-ID                            90370000
903800         DISPLAY 'VHTRIP-VEH-NBR:       '                         90380000
903900                  VHTRIP-VEH-NBR                                  90390000
904000         DISPLAY '**************************************'         90400000
904100         PERFORM 9800-SQL-ERROR                                   90410000
904200     END-IF.                                                      90420000
904300                                                                  90430000
904400                                                                  90440000
904500 8000-WRITE-REPORT-HEADERS.                                       90450000
904600******************************************************************90460000
904700     SET PS-HEADER-PRINTED TO TRUE.                               90470000
904800     IF PS-NOT-FIRST-ASN-HEADER                                   90480000
904900         IF RC001-DIST-CNTR NOT = PV-HOLD-ASN-DIST-CNTR           90490000
905000             WRITE ASN-REPORT-RECORD                              90500000
905100               FROM END-OF-REPORT-LINE                            90510000
905200                 AFTER ADVANCING 2 LINES                          90520000
905300             MOVE 0               TO PV-PAGE-CNT                  90530000
905400             MOVE RC001-DIST-CNTR TO PV-HOLD-ASN-DIST-CNTR        90540000
905500         END-IF                                                   90550000
905600     ELSE                                                         90560000
905700         SET PS-NOT-FIRST-ASN-HEADER TO TRUE                      90570000
905800         MOVE RC001-DIST-CNTR TO PV-HOLD-ASN-DIST-CNTR            90580000
905900     END-IF.                                                      90590000
906000                                                                  90600000
906100     PERFORM 8200-WRITE-TOP-LINE.                                 90610000
906200                                                                  90620000
906300     WRITE ASN-REPORT-RECORD                                      90630000
906400       FROM HEADING-LINE-0                                        90640000
906500         AFTER ADVANCING 1 LINE.                                  90650000
906600                                                                  90660000
906700     WRITE ASN-REPORT-RECORD                                      90670000
906800       FROM HEADING-LINE-1                                        90680000
906900         AFTER ADVANCING 2 LINES.                                 90690000
907000                                                                  90700000
907100     WRITE ASN-REPORT-RECORD                                      90710000
907200       FROM HEADING-LINE-2                                        90720000
907300         AFTER ADVANCING 1 LINE.                                  90730000
907400                                                                  90740000
907500     WRITE ASN-REPORT-RECORD                                      90750000
907600       FROM HEADING-LINE-3                                        90760000
907700         AFTER ADVANCING 1 LINE.                                  90770000
907800                                                                  90780000
907900     WRITE ASN-REPORT-RECORD                                      90790000
908000       FROM HEADING-LINE-4                                        90800000
908100         AFTER ADVANCING 1 LINE.                                  90810000
908200                                                                  90820000
908300     WRITE ASN-REPORT-RECORD                                      90830000
908400       FROM HEADING-LINE-5                                        90840000
908500         AFTER ADVANCING 1 LINE.                                  90850000
908600                                                                  90860000
908700     WRITE ASN-REPORT-RECORD                                      90870000
908800       FROM HEADING-LINE-6                                        90880000
908900         AFTER ADVANCING 1 LINE.                                  90890000
909000                                                                  90900000
909100     WRITE ASN-REPORT-RECORD                                      90910000
909200       FROM HEADING-LINE-7                                        90920000
909300         AFTER ADVANCING 1 LINE.                                  90930000
909400                                                                  90940000
909500     WRITE ASN-REPORT-RECORD                                      90950000
909600       FROM HEADING-LINE-8                                        90960000
909700         AFTER ADVANCING 1 LINE.                                  90970000
909800                                                                  90980000
909900     WRITE ASN-REPORT-RECORD                                      90990000
910000       FROM HEADING-LINE-9                                        91000000
910100         AFTER ADVANCING 1 LINE.                                  91010000
910200                                                                  91020000
910300     WRITE ASN-REPORT-RECORD                                      91030000
910400       FROM HEADING-LINE-10                                       91040000
910500         AFTER ADVANCING 1 LINE.                                  91050000
910600                                                                  91060000
910700     MOVE PC-12                   TO PV-LINE-CNT.                 91070000
910800                                                                  91080000
910900     PERFORM 8300-WRITE-DETAIL-HEADERS.                           91090000
911000                                                                  91100000
911100 8050-WRITE-PO-REPORT-HEADERS.                                    91110000
911200******************************************************************91120000
911300*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.               *91130000
911400******************************************************************91140000
911500                                                                  91150000
911600     IF PV-PO-LINE-CNT < PC-99                                    91160000
911700         PERFORM 8550-WRITE-FOOTER-LINES                          91170000
911800     END-IF.                                                      91180000
911900                                                                  91190000
912000     PERFORM 8250-WRITE-TOP-LINE-PO.                              91200000
912100     IF PV-CKPT-JOB-NAME = 'RCK090  '                             91210000
912200         WRITE PO-REPORT-RECORD                                   91220000
912300           FROM HEADING-LINE-P-1-REALTIME                         91230000
912400             AFTER ADVANCING 1 LINE                               91240000
912500     ELSE                                                         91250000
912600         WRITE PO-REPORT-RECORD                                   91260000
912700           FROM HEADING-LINE-P-1                                  91270000
912800             AFTER ADVANCING 1 LINE                               91280000
912900     END-IF.                                                      91290000
913000                                                                  91300000
913100     WRITE PO-REPORT-RECORD                                       91310000
913200       FROM HEADING-LINE-P-2                                      91320000
913300         AFTER ADVANCING 1 LINE.                                  91330000
913400                                                                  91340000
913500     WRITE PO-REPORT-RECORD                                       91350000
913600       FROM HEADING-LINE-P-3                                      91360000
913700         AFTER ADVANCING 2 LINES.                                 91370000
913800                                                                  91380000
913900     WRITE PO-REPORT-RECORD                                       91390000
914000       FROM HEADING-LINE-P-4                                      91400000
914100         AFTER ADVANCING 1 LINE.                                  91410000
914200                                                                  91420000
914300     MOVE PC-5                    TO PV-PO-LINE-CNT.              91430000
914400                                                                  91440000
914500     MOVE WS-HOLD-OPERATING-COMPANY  TO PV-PREV-OPERATING-COMPANY.91450000
914600     MOVE WS-HOLD-DIST-CNTR          TO PV-PREV-DIST-CNTR.        91460000
914700     MOVE WS-HOLD-EDI-VEND-ID        TO PV-PREV-EDI-VEND-ID.      91470000
914800     MOVE WS-HOLD-CARRIER-SCAC-CODE  TO PV-PREV-CARRIER-SCAC-CODE 91480000
914900     MOVE WS-HOLD-BILL-OF-LADING-NBR TO PV-PREV-BOL-NBR.          91490000
915000     MOVE WS-HOLD-ASNHDR-NBR         TO PV-PREV-ASNHDR-NBR.       91500000
915100     MOVE WS-HOLD-PO-NBR             TO PV-PREV-PO-NBR.           91510000
915200                                                                  91520000
915300 8100-WRITE-ERROR-FILE.                                           91530000
915400                                                                  91540000
915500     MOVE RC001-CARTON-NBR (PV-SUB)                               91550000
915600                              TO PV-ASN-CARTON-NBR-18.            91560000
915700     MOVE PC-00               TO PV-ASN-CARTON-NBR-2.             91570000
915800     MOVE PV-ASN-CARTON-NBR   TO RC016-ASN-CARTON-NBR.            91580000
915900     MOVE RC001-PO-NBR        TO RC016-ASN-CARTON-PO.             91590000
916000     MOVE RC001-ASNHDR-NBR    TO RC016-ASN-ASNHDR-NBR.            91600000
916100     MOVE PV-DATE-SHIPPED     TO RC016-ASN-DATE-SHIPPED.          91610000
916200     MOVE RC001-PO-LINE-NBR   TO RC016-ASN-PO-LINE-NBR.           91620000
916201*                                                                 91620122
916202* DMH - 7/15/2021 BEGIN                                           91620222
916203*                                                                 91620322
916210     IF   RC001-STORE-NBR = 9999                                  91621022
916220          MOVE RC001-DIST-CNTR TO RC016-ASN-STORE-NBR             91622022
916230     ELSE                                                         91623022
916300          MOVE RC001-STORE-NBR TO RC016-ASN-STORE-NBR             91630022
916310     END-IF.                                                      91631022
916320*                                                                 91632022
916330* DMH - 7/15/2021 END                                             91633022
916340*                                                                 91634022
916400     MOVE RC001-EDI-VEND-ID   TO RC016-ASN-VENDOR-NBR.            91640000
916500     MOVE RC001-DIST-CNTR     TO RC016-ASN-OPER-UNIT.             91650000
916600                                                                  91660000
916860         MOVE RC016-ASN-CARTON-ERRORS                             91686000
916870                                 TO RCT00036-RCVG-RCRD016-ODR.    91687000
916880         PERFORM 8120-INSERT-RCTW-OUT16.                          91688000
916900                                                                  91690000
916910     ADD +1                   TO PV-CRTN-ERROR-RECS-OUT.          91691000
916920     EVALUATE TRUE                                                91692000
916930         WHEN RC016-PREVIOUSLY-SENT                               91693000
916940              ADD +1          TO PV-PREV-SENT-ERRS                91694000
916950         WHEN RC016-STR-PO-NOT-EQUAL                              91695000
916960              ADD +1          TO PV-STR-PO-MISMATCH-ERRS          91696000
916970     END-EVALUATE.                                                91697000
916971                                                                  91697100
917025                                                                  91702500
917026 8120-INSERT-RCTW-OUT16.                                          91702600
917034     MOVE '8120-INSERT-RCTW-OUT16' TO PV-ABEND-PARAGRAPH.         91703400
917035                                                                  91703500
917036     PERFORM                                                      91703600
917037         WITH TEST AFTER                                          91703700
917038         VARYING PV-RETRY-COUNTER                                 91703800
917039         FROM 1 BY 1                                              91703900
917040         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               91704000
917041             OR (SQLCODE = +0))                                   91704100
917042                                                                  91704200
917043         EXEC SQL                                                 91704300
917044              INSERT INTO RCTW_OUT16                              91704400
917045                     (RCVG_RCRD016_ODR)                           91704500
917046              VALUES (:RCT00036-RCVG-RCRD016-ODR)                 91704600
917047         END-EXEC                                                 91704700
917048                                                                  91704800
917049         EVALUATE TRUE                                            91704900
917050             WHEN SQLCODE = +0                                    91705000
917051             WHEN SQLCODE = -911                                  91705100
917052                  CONTINUE                                        91705200
917053                                                                  91705300
917054             WHEN SQLWARN0 NOT = SPACES                           91705400
917055             WHEN SQLCODE < +0                                    91705500
917056             WHEN SQLCODE > +0                                    91705600
917057                  MOVE 'UNSUCCESSFUL INSERT TO RCTW_OUT16'        91705700
917058                         TO PV-DB2-OPERATION-ATTEMPTED            91705800
917059                  PERFORM 9800-SQL-ERROR                          91705900
917060         END-EVALUATE                                             91706000
917061     END-PERFORM.                                                 91706100
917062                                                                  91706200
917063     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    91706300
917064         SQLCODE NOT = +0                                         91706400
917065         MOVE 'MAX RETRIES EXCEEDED FOR INSERT RCTW_OUT16'        91706500
917066                TO PV-DB2-OPERATION-ATTEMPTED                     91706600
917067         PERFORM 9800-SQL-ERROR                                   91706700
917068     END-IF.                                                      91706800
917070                                                                  91707000
917100 8200-WRITE-TOP-LINE.                                             91710000
917200******************************************************************91720000
917300*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *91730000
917400*     NEEDED FOR AN ASN NUMBER.                                  *91740000
917500******************************************************************91750000
917600     ADD 1                        TO PV-PAGE-CNT.                 91760000
917700                                                                  91770000
917800     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          91780000
917900                                                                  91790000
918000     MOVE PC-REPORT-NBR-1        TO DP132O-REPORT-NUMBER.         91800000
918100     WRITE ASN-REPORT-RECORD                                      91810000
918200       FROM DP132O-STANDRD-HEADER-132-COLS                        91820000
918300         AFTER ADVANCING PAGE.                                    91830000
918400                                                                  91840000
918500 8250-WRITE-TOP-LINE-PO.                                          91850000
918600     ADD 1                        TO PV-PO-PAGE-CNT.              91860000
918700                                                                  91870000
918800     MOVE PV-PO-PAGE-CNT          TO DP132O-PAGE-NUMBER.          91880000
918900                                                                  91890000
919000     MOVE PC-REPORT-NBR-2        TO DP132O-REPORT-NUMBER.         91900000
919100     WRITE PO-REPORT-RECORD                                       91910000
919200       FROM DP132O-STANDRD-HEADER-132-COLS                        91920000
919300         AFTER ADVANCING PAGE.                                    91930000
919400                                                                  91940000
919500 8300-WRITE-DETAIL-HEADERS.                                       91950000
919600******************************************************************91960000
919700*     WRITES THE DETAIL LINE HEADERS                             *91970000
919800******************************************************************91980000
919900     WRITE ASN-REPORT-RECORD                                      91990000
920000       FROM DETAIL-HEADING-LINE-1                                 92000000
920100         AFTER ADVANCING 2 LINES.                                 92010000
920200                                                                  92020000
920300     WRITE ASN-REPORT-RECORD                                      92030000
920400       FROM DETAIL-HEADING-LINE-2                                 92040000
920500         AFTER ADVANCING 1 LINE.                                  92050000
920600                                                                  92060000
920700     ADD PC-3                     TO PV-LINE-CNT.                 92070000
920800                                                                  92080000
920900 8400-WRITE-DETAIL-LINES.                                         92090000
921000******************************************************************92100000
921100*     WRITES THE DETAIL LINE INFORMATION.                        *92110000
921200******************************************************************92120000
921300                                                                  92130000
921400     SET PS-FALLOUT-REC-WRITTEN-YES TO TRUE                       92140000
921500                                                                  92150000
921600     WRITE ASN-REPORT-RECORD                                      92160000
921700       FROM DETAIL-LINE1                                          92170000
921800         AFTER ADVANCING 1 LINE.                                  92180000
921900                                                                  92190000
922000     WRITE ASN-REPORT-RECORD                                      92200000
922100       FROM DETAIL-LINE2                                          92210000
922200         AFTER ADVANCING 1 LINE.                                  92220000
922300                                                                  92230000
922400     ADD PC-2                        TO PV-LINE-CNT.              92240000
922500                                                                  92250000
922600     PERFORM                                                      92260000
922700       VARYING PEMT-INDX FROM 3 BY 1                              92270000
922800         UNTIL PEMT-INDX > 6                                      92280000
922900            OR PEMT-MSG (PEMT-INDX) = SPACES                      92290000
923000               MOVE PEMT-MSG (PEMT-INDX)                          92300000
923100                                  TO DL3-ERROR-MSG                92310000
923200               WRITE ASN-REPORT-RECORD                            92320000
923300                 FROM DETAIL-LINE3                                92330000
923400                   AFTER ADVANCING 1 LINE                         92340000
923500               ADD PC-1              TO PV-LINE-CNT               92350000
923600     END-PERFORM.                                                 92360000
923700                                                                  92370000
923800 8450-WRITE-PO-DETAIL-LINES.                                      92380000
923900******************************************************************92390000
924000*     WRITES THE PO DETAIL LINE INFORMATION.                     *92400000
924100******************************************************************92410000
924200     MOVE PV-SUM-QTY-SHIPPED      TO DLP1-TOTAL-UNITS.            92420000
924300     MOVE PV-CALC-CARTONS         TO DLP1-CALC-CARTONS.           92430000
924400     MOVE PV-ASN-CARTONS          TO DLP1-ASN-CARTONS.            92440000
924500     IF  PV-PO-LINE-CNT > PC-58                                   92450000
924600          PERFORM 8050-WRITE-PO-REPORT-HEADERS                    92460000
924700     ELSE                                                         92470000
924800         IF WS-HOLD-DIST-CNTR NOT = PV-PREV-DIST-CNTR             92480000
924900             PERFORM 8050-WRITE-PO-REPORT-HEADERS                 92490000
925000         END-IF                                                   92500000
925100     END-IF.                                                      92510000
925200     ADD  PV-SUM-QTY-SHIPPED      TO PV-TOT-QTY-SHIPPED.          92520000
925300                                                                  92530000
925400     WRITE PO-REPORT-RECORD                                       92540000
925500       FROM DETAIL-LINEP1                                         92550000
925600         AFTER ADVANCING 2 LINE.                                  92560000
925700                                                                  92570000
925800     MOVE ZERO                       TO PV-CALC-CARTONS           92580000
925900                                        PV-SUM-QTY-SHIPPED.       92590000
926000     ADD PC-2                        TO PV-PO-LINE-CNT.           92600000
926100                                                                  92610000
926200     SET ERR-INDX TO 1.                                           92620000
926300     PERFORM                                                      92630000
926400       VARYING ERR-INDX FROM 1 BY 1                               92640000
926500         UNTIL ERR-INDX = 12                                      92650000
926600           MOVE SPACES            TO DLP2-ERROR-MSG (ERR-INDX)    92660000
926700     END-PERFORM.                                                 92670000
926800                                                                  92680000
926900     SET ERR-INDX TO 1.                                           92690000
927000     PERFORM                                                      92700000
927100       VARYING PPEMT-INDX FROM 1 BY 1                             92710000
927200         UNTIL PPEMT-INDX > 14                                    92720000
927300             IF PPEMT-IND (PPEMT-INDX) = 'Y'                      92730000
927400               MOVE PPEMT-MSG (PPEMT-INDX)                        92740000
927500                                  TO DLP2-ERROR-MSG (ERR-INDX)    92750000
927600               MOVE PC-N          TO PPEMT-IND (PPEMT-INDX)       92760000
927700               SET ERR-INDX UP BY 1                               92770000
927800             END-IF                                               92780000
927900     END-PERFORM.                                                 92790000
928000                                                                  92800000
928100     SET ERR-INDX TO 1.                                           92810000
928200     IF DLP2-ERROR-MSG (ERR-INDX) EQUAL SPACES                    92820000
928300         CONTINUE                                                 92830000
928400     ELSE                                                         92840000
928500         WRITE PO-REPORT-RECORD                                   92850000
928600           FROM DETAIL-LINEP2                                     92860000
928700             AFTER ADVANCING 1 LINE                               92870000
928800         ADD PC-1  TO PV-PO-LINE-CNT                              92880000
928900     END-IF.                                                      92890000
929000                                                                  92900000
929100 8550-WRITE-FOOTER-LINES.                                         92910000
929200******************************************************************92920000
929300*  WRITES THE SUMMARY LINES AND TRAILER LINE                     *92930000
929400******************************************************************92940000
929500                                                                  92950000
929600     IF WS-HOLD-DIST-CNTR NOT = PV-PREV-DIST-CNTR                 92960000
929700         MOVE PV-TOT-QTY-SHIPPED      TO SDL1-TOTAL-UNITS         92970000
929800         MOVE ZERO                    TO PV-TOT-QTY-SHIPPED       92980000
929900         WRITE PO-REPORT-RECORD                                   92990000
930000           FROM SUMMARY-DETAIL-LINEP1                             93000000
930100             AFTER ADVANCING 1 LINE                               93010000
930200         WRITE PO-REPORT-RECORD                                   93020000
930300           FROM END-OF-REPORT-LINE                                93030000
930400             AFTER ADVANCING 2 LINES                              93040000
930500         MOVE 0                   TO PV-PO-PAGE-CNT               93050000
930600     END-IF.                                                      93060000
930700                                                                  93070000
930800     COMPUTE PV-DIFF-LINES = PC-58 - PV-PO-LINE-CNT.              93080000
930900                                                                  93090000
931000     WRITE PO-REPORT-RECORD                                       93100000
931100       FROM FOOTING-LINE1                                         93110000
931200         AFTER ADVANCING PV-DIFF-LINES LINES.                     93120000
931300                                                                  93130000
931400     WRITE PO-REPORT-RECORD                                       93140000
931500       FROM FOOTING-LINE2                                         93150000
931600         AFTER ADVANCING 1 LINE.                                  93160000
931700                                                                  93170000
931800 8600-READ-UPDATE-PKITEM.                                         93180000
931900     PERFORM 8700-READ-PKITEM.                                    93190000
932000     ADD  RC001-QTY-SHIPPED         TO PKITEM-PKSL-ITM-QTY.       93200000
932100     PERFORM 8800-UPDATE-PKITEM.                                  93210000
932200                                                                  93220000
932300 8700-READ-PKITEM.                                                93230000
932400     MOVE '8700-READ-PKITEM' TO PV-ABEND-PARAGRAPH.               93240000
932500                                                                  93250000
932600     PERFORM                                                      93260000
932700         WITH TEST AFTER                                          93270000
932800         VARYING PV-RETRY-COUNTER                                 93280000
932900         FROM 1 BY 1                                              93290000
933000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               93300000
933100             OR (SQLCODE = +0))                                   93310000
933200                                                                  93320000
933300         EXEC SQL                                                 93330000
933400              SELECT  PKSL_ITM_QTY                                93340000
933500              INTO    :PKITEM-PKSL-ITM-QTY                        93350000
933600               FROM   TPKITEM                                     93360000
933700              WHERE   PO_NBR       = :PKITEM-PO-NBR               93370000
933800                AND   SEQ_NBR      = :PKITEM-SEQ-NBR              93380000
933900                AND   PKSL_LNE_NBR = :PKITEM-PKSL-LNE-NBR         93390000
934000         END-EXEC                                                 93400000
934100                                                                  93410000
934200         EVALUATE TRUE                                            93420000
934300             WHEN SQLCODE = +0                                    93430000
934400             WHEN SQLCODE = -911                                  93440000
934500                  CONTINUE                                        93450000
934600                                                                  93460000
934700             WHEN SQLWARN0 NOT = SPACES                           93470000
934800             WHEN SQLCODE < +0                                    93480000
934900             WHEN SQLCODE > +0                                    93490000
935000                  MOVE 'UNSUCCESSFUL SELECT OF TPKITEM'           93500000
935100                         TO PV-DB2-OPERATION-ATTEMPTED            93510000
935200                  PERFORM 9100-SQL-ABEND                          93520000
935300         END-EVALUATE                                             93530000
935400     END-PERFORM.                                                 93540000
935500                                                                  93550000
935600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    93560000
935700         SQLCODE NOT = +0                                         93570000
935800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TPKITEM'        93580000
935900                TO PV-DB2-OPERATION-ATTEMPTED                     93590000
936000         PERFORM 9100-SQL-ABEND                                   93600000
936100     END-IF.                                                      93610000
936200     IF SQLCODE NOT = 0                                           93620000
936300        DISPLAY 'PO ' PKITEM-PO-NBR ' SEQ  ' PKITEM-SEQ-NBR       93630000
936400                ' LINE ' PKITEM-PKSL-LNE-NBR                      93640000
936500        DISPLAY 'SQLCODE ' SQLCODE                                93650000
936600     END-IF.                                                      93660000
936700 8800-UPDATE-PKITEM.                                              93670000
936800                                                                  93680000
936900     MOVE '8800-UPDATE-PKITEM' TO PV-ABEND-PARAGRAPH.             93690000
937000     PERFORM                                                      93700000
937100         WITH TEST AFTER                                          93710000
937200         VARYING PV-RETRY-COUNTER                                 93720000
937300         FROM 1 BY 1                                              93730000
937400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               93740000
937500             OR (SQLCODE = +0))                                   93750000
937600                                                                  93760000
937700         EXEC SQL                                                 93770000
937800              UPDATE  TPKITEM                                     93780000
937900                 SET  PKSL_ITM_QTY      = :PKITEM-PKSL-ITM-QTY    93790000
938000                     ,ORIG_PKSL_ITM_QTY = :PKITEM-PKSL-ITM-QTY    93800000
938100              WHERE   PO_NBR       = :PKITEM-PO-NBR               93810000
938200                AND   SEQ_NBR      = :PKITEM-SEQ-NBR              93820000
938300                AND   PKSL_LNE_NBR = :PKITEM-PKSL-LNE-NBR         93830000
938400         END-EXEC                                                 93840000
938500                                                                  93850000
938600         EVALUATE TRUE                                            93860000
938700             WHEN SQLCODE = +0                                    93870000
938710                 ADD +1 TO PV-UPDATE-TPKITEM                      93871000
938800             WHEN SQLCODE = -911                                  93880000
938900                  CONTINUE                                        93890000
939000                                                                  93900000
939100             WHEN SQLWARN0 NOT = SPACES                           93910000
939200             WHEN SQLCODE < +0                                    93920000
939300             WHEN SQLCODE > +0                                    93930000
939400                  MOVE 'UNSUCCESSFUL UPDATE OF TPKITEM'           93940000
939500                         TO PV-DB2-OPERATION-ATTEMPTED            93950000
939600                  PERFORM 9100-SQL-ABEND                          93960000
939700         END-EVALUATE                                             93970000
939800     END-PERFORM.                                                 93980000
939900                                                                  93990000
940000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    94000000
940100         SQLCODE NOT = +0                                         94010000
940200         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TPKITEM'        94020000
940300                TO PV-DB2-OPERATION-ATTEMPTED                     94030000
940400         PERFORM 9100-SQL-ABEND                                   94040000
940500     END-IF.                                                      94050000
940600 9100-SQL-ABEND.                                                  94060000
940700******************************************************************94070000
940800*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    94080000
940900*  ERROR OR WARNING CODE OCCURS.                                  94090000
941000******************************************************************94100000
941100     DISPLAY '9100-SQL-ABEND'.                                    94110000
941200     DISPLAY '** ABEND     **'.                                   94120000
941300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        94130000
941400     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             94140000
941500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     94150000
941600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPT-2.     94160000
941700     DISPLAY '** PO-NBR    ** = ' DK-PO-NBR.                      94170000
941800     DISPLAY '** OPER-UNT-ID  ** = ' DK-OPER-UNT-ID               94180000
941900     DISPLAY '** LINE NBR     ** = ' DK-ORD-LNE-NBR.              94190000
942000     DISPLAY '** REC SEQ NBR  ** = ' DK-RCVR-SEQ-NBR.             94200000
942100     DISPLAY '** STORE CHAR   ** = ' PV-STORE-NBR.                94210000
942200     DISPLAY '** PLAN_NBR     ** = ' ALLPLN-PLAN-NBR.             94220000
942300     DISPLAY '** STORE NBR    ** = ' DK-STR-NBR.                  94230000
942400     DISPLAY 'TOTAL COMMITS TAKEN = ' PV-COMMIT-COUNTER.          94240000
942500     DISPLAY '**              ** = '                              94250000
942600     DISPLAY PKITEM-PO-NBR.                                       94260000
942700     DISPLAY PKITEM-SEQ-NBR.                                      94270000
942800     DISPLAY PKITEM-PKSL-LNE-NBR.                                 94280000
942900     MOVE SQLCODE TO PV-SQL-CODE.                                 94290000
943000     DISPLAY '** SQL CODE  ** = ' PV-SQL-CODE.                    94300000
943010     SET RC082-PGM-END-FAILURE TO TRUE                            94301000
943020     PERFORM 9900-GENERATE-STATISTICS                             94302000
943100     MOVE +4013 TO PV-ABEND-CODE.                                 94310000
943200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         94320000
943300                                                                  94330000
943400******************************************************************94340000
943500*  THIS MODULE PERFORMS THE SQL WARNING.                         *94350000
943600******************************************************************94360000
943700                                                                  94370000
943800 9700-SQL-WARNING.                                                94380000
943900                                                                  94390000
944000      MOVE SQLCODE               TO SQLCODE2.                     94400000
944100      MOVE SQLERRD(3)            TO SQLERRD3.                     94410000
944200      DISPLAY '** ABEND **       ** = SQLWARNING'.                94420000
944300      DISPLAY '** PROGRAM        ** = RCKUP006'.                  94430000
944400      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       94440000
944500      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 94450000
944600      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 94460000
944700      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 94470000
944800      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 94480000
944900      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 94490000
945000      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 94500000
945100      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 94510000
945200      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 94520000
945300      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 94530000
945400      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 94540000
945410      SET RC082-PGM-END-FAILURE  TO TRUE                          94541000
945420      PERFORM 9900-GENERATE-STATISTICS                            94542000
945500                                                                  94550000
945600      SET ABEND-4013-DB2-ERROR   TO TRUE                          94560000
945700      CALL 'ILBOABN0' USING ABEND-CODE.                           94570000
945800                                                                  94580000
945900 EJECT                                                            94590000
946000******************************************************************94600000
946100* THIS MODULE PERFORMS THE SQL ERROR.                            *94610000
946200******************************************************************94620000
946300                                                                  94630000
946400 9800-SQL-ERROR.                                                  94640000
946500                                                                  94650000
946600      MOVE SQLCODE               TO SQLCODE2.                     94660000
946700      MOVE SQLERRD(3)            TO SQLERRD3.                     94670000
946800      DISPLAY '** ABEND **       ** = SQLERROR'.                  94680000
946900      DISPLAY '** PROGRAM        ** = RCKUP006'.                  94690000
947000      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       94700000
947010      DISPLAY '** OPERATION ATTEMPTED = '                         94701000
947020                                      PV-DB2-OPERATION-ATTEMPTED  94702000
947100      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 94710000
947200      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 94720000
947300      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  94730000
947400      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 94740000
947410      SET RC082-PGM-END-FAILURE  TO TRUE                          94741000
947420      PERFORM 9900-GENERATE-STATISTICS                            94742000
947500                                                                  94750000
947600      SET ABEND-4013-DB2-ERROR   TO TRUE                          94760000
947700      CALL 'ILBOABN0' USING ABEND-CODE.                           94770000
947710                                                                  94771000
947720 9900-GENERATE-STATISTICS.                                        94772000
947728     DISPLAY '*************************************'.             94772800
947729     DISPLAY '**      RCKUP006 STATISTICS COUNTS **'.             94772900
947730     DISPLAY '*************************************'.             94773000
947731     MOVE '01'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94773100
947732     MOVE 'NUMBER OF INPUT RECORDS READ'                          94773200
947733                                   TO RC082-STAT-DATA-DESC        94773300
947734     MOVE PV-RECS-READ             TO RC082-STAT-DATA-QTY         94773400
947735                                      PV-DISPLAY-NBR              94773500
947736     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94773600
947737     PERFORM 9910-INSERT-STATISTICS                               94773700
947738     MOVE '02'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94773800
947739     MOVE 'NUMBER OF HEADER RECORDS READ'                         94773900
947740                                   TO RC082-STAT-DATA-DESC        94774000
947741     MOVE PV-HDR-RECS-READ         TO RC082-STAT-DATA-QTY         94774100
947742                                      PV-DISPLAY-NBR              94774200
947743     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94774300
947744     PERFORM 9910-INSERT-STATISTICS                               94774400
947745     MOVE '03'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94774500
947746     MOVE 'NUMBER OF DETAIL RECORDS READ'                         94774600
947747                                   TO RC082-STAT-DATA-DESC        94774700
947748     MOVE PV-DET-RECS-READ         TO RC082-STAT-DATA-QTY         94774800
947749                                      PV-DISPLAY-NBR              94774900
947750     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94775000
947751     PERFORM 9910-INSERT-STATISTICS                               94775100
947752     MOVE '04'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94775200
947753     MOVE 'NUMBER OF CARTON RECORDS READ'                         94775300
947754                                   TO RC082-STAT-DATA-DESC        94775400
947755     MOVE PV-CRTN-RECS-READ        TO RC082-STAT-DATA-QTY         94775500
947756                                      PV-DISPLAY-NBR              94775600
947757     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94775700
947758     PERFORM 9910-INSERT-STATISTICS                               94775800
947759     MOVE '05'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94775900
947760     MOVE 'NUMBER OF RECORDS WRITTEN TO RECEIVER TABLE'           94776000
947761                                   TO RC082-STAT-DATA-DESC        94776100
947762     MOVE PV-RCVR-RECS-OUT         TO RC082-STAT-DATA-QTY         94776200
947763                                      PV-DISPLAY-NBR              94776300
947764     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94776400
947765     PERFORM 9910-INSERT-STATISTICS                               94776500
947766     MOVE '06'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94776600
947767     MOVE 'NUMBER OF RECORDS WRITTEN TO CARTON ERROR TABLE'       94776700
947768                                   TO RC082-STAT-DATA-DESC        94776800
947769     MOVE PV-CRTN-ERROR-RECS-OUT   TO RC082-STAT-DATA-QTY         94776900
947770                                      PV-DISPLAY-NBR              94777000
947771     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94777100
947772     PERFORM 9910-INSERT-STATISTICS                               94777200
947773     MOVE '07'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94777300
947774     MOVE 'NUMBER OF CARTON ERRORS - PREV-SENT'                   94777400
947775                                   TO RC082-STAT-DATA-DESC        94777500
947776     MOVE PV-PREV-SENT-ERRS        TO RC082-STAT-DATA-QTY         94777600
947777                                      PV-DISPLAY-NBR              94777700
947778     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94777800
947779     PERFORM 9910-INSERT-STATISTICS                               94777900
947780     MOVE '08'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94778000
947781     MOVE 'NUMBER OF CARTON ERRORS - STR PO MISMATCH'             94778100
947782                                   TO RC082-STAT-DATA-DESC        94778200
947783     MOVE PV-STR-PO-MISMATCH-ERRS  TO RC082-STAT-DATA-QTY         94778300
947784                                      PV-DISPLAY-NBR              94778400
947785     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94778500
947786     PERFORM 9910-INSERT-STATISTICS                               94778600
947787     MOVE '09'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94778700
947788     MOVE 'NUMBER OF RECORDS WRITTEN TO CARTON UPDATE TABLE'      94778800
947789                                   TO RC082-STAT-DATA-DESC        94778900
947790     MOVE PV-CRTN-UPD-RECS-OUT     TO RC082-STAT-DATA-QTY         94779000
947791                                      PV-DISPLAY-NBR              94779100
947792     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94779200
947793     PERFORM 9910-INSERT-STATISTICS                               94779300
947794     MOVE '10'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94779400
947795     MOVE 'NUMBER OF RECORDS WRITTEN TO CARTON EXTRACT TABLE'     94779500
947796                                   TO RC082-STAT-DATA-DESC        94779600
947797     MOVE PV-CRTN-EXT-RECS-OUT     TO RC082-STAT-DATA-QTY         94779700
947798                                      PV-DISPLAY-NBR              94779800
947799     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94779900
947800     PERFORM 9910-INSERT-STATISTICS                               94780000
947801     MOVE '11'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94780100
947802     MOVE 'NUMBER OF INSERTS TO TSHPUNT - FIRST TRY'              94780200
947803                                   TO RC082-STAT-DATA-DESC        94780300
947804     MOVE PV-ADD-TSHPUNT-1ST-TRY   TO RC082-STAT-DATA-QTY         94780400
947805                                      PV-DISPLAY-NBR              94780500
947806     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94780600
947807     PERFORM 9910-INSERT-STATISTICS                               94780700
947808     MOVE '12'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94780800
947809     MOVE 'NUMBER OF INSERTS TO TSHPUNT - AFTER DELETE'           94780900
947810                                   TO RC082-STAT-DATA-DESC        94781000
947811     MOVE PV-ADD-TSHPUNT-2ND-TRY   TO RC082-STAT-DATA-QTY         94781100
947812                                      PV-DISPLAY-NBR              94781200
947813     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94781300
947814     PERFORM 9910-INSERT-STATISTICS                               94781400
947815     MOVE '13'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94781500
947816     MOVE 'NUMBER OF INSERTS TO TSHPUNT FAILED - DUPS'            94781600
947817                                   TO RC082-STAT-DATA-DESC        94781700
947818     MOVE PV-ADD-TSHPUNT-FAIL-DUPE TO RC082-STAT-DATA-QTY         94781800
947819                                      PV-DISPLAY-NBR              94781900
947820     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94782000
947821     PERFORM 9910-INSERT-STATISTICS                               94782100
947822     MOVE '14'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94782200
947823     MOVE 'NUMBER OF DELETES FROM TSHPUNT - NEW ASN'              94782300
947824                                   TO RC082-STAT-DATA-DESC        94782400
947825     MOVE PV-DELETE-TSHPUNT        TO RC082-STAT-DATA-QTY         94782500
947826                                      PV-DISPLAY-NBR              94782600
947827     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94782700
947828     PERFORM 9910-INSERT-STATISTICS                               94782800
947829     MOVE '15'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94782900
947830     MOVE 'NUMBER OF DELETES FROM TSHPUNT FAILED'                 94783000
947831                                   TO RC082-STAT-DATA-DESC        94783100
947832     MOVE PV-DELETE-TSHPUNT-FAIL   TO RC082-STAT-DATA-QTY         94783200
947833                                      PV-DISPLAY-NBR              94783300
947834     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94783400
947835     PERFORM 9910-INSERT-STATISTICS                               94783500
947836     MOVE '16'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94783600
947837     MOVE 'NUMBER OF INSERTS TO TSHUUPC'                          94783700
947838                                   TO RC082-STAT-DATA-DESC        94783800
947839     MOVE PV-ADD-TSHUUPC           TO RC082-STAT-DATA-QTY         94783900
947840                                      PV-DISPLAY-NBR              94784000
947841     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94784100
947842     PERFORM 9910-INSERT-STATISTICS                               94784200
947843     MOVE '17'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94784300
947844     MOVE 'NUMBER OF INSERTS TO TSHUUPC FAILED - DUPS'            94784400
947845                                   TO RC082-STAT-DATA-DESC        94784500
947846     MOVE PV-ADD-TSHUUPC-FAIL-DUPE TO RC082-STAT-DATA-QTY         94784600
947847                                      PV-DISPLAY-NBR              94784700
947848     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94784800
947849     PERFORM 9910-INSERT-STATISTICS                               94784900
947850     MOVE '18'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94785000
947851     MOVE 'NUMBER OF INSERTS TO TSHUUPC WITH ZERO LINE NUMBER'    94785100
947852                                   TO RC082-STAT-DATA-DESC        94785200
947853     MOVE PV-ADD-TSHUUPC-LNE-NBR-0 TO RC082-STAT-DATA-QTY         94785300
947854                                      PV-DISPLAY-NBR              94785400
947855     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94785500
947856     PERFORM 9910-INSERT-STATISTICS                               94785600
947857     MOVE '19'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94785700
947858     MOVE 'NUMBER OF INSERTS TO TINPKSU'                          94785800
947859                                   TO RC082-STAT-DATA-DESC        94785900
947860     MOVE PV-ADD-TINPKSU           TO RC082-STAT-DATA-QTY         94786000
947861                                      PV-DISPLAY-NBR              94786100
947862     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94786200
947863     PERFORM 9910-INSERT-STATISTICS                               94786300
947864     MOVE '20'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94786400
947865     MOVE 'NUMBER OF INSERTS TO TINPKSU FAILED - DUPS'            94786500
947866                                   TO RC082-STAT-DATA-DESC        94786600
947867     MOVE PV-ADD-TINPKSU-FAIL-DUPE TO RC082-STAT-DATA-QTY         94786700
947868                                      PV-DISPLAY-NBR              94786800
947869     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94786900
947870     PERFORM 9910-INSERT-STATISTICS                               94787000
947871     MOVE '21'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94787100
947872     MOVE 'NUMBER OF INSERTS TO TSHIPMT'                          94787200
947873                                   TO RC082-STAT-DATA-DESC        94787300
947874     MOVE PV-ADD-TSHIPMT           TO RC082-STAT-DATA-QTY         94787400
947875                                      PV-DISPLAY-NBR              94787500
947876     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94787600
947877     PERFORM 9910-INSERT-STATISTICS                               94787700
947878     MOVE '22'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94787800
947879     MOVE 'NUMBER OF INSERTS TO TSHIPMT FAILED - DUPS'            94787900
947880                                   TO RC082-STAT-DATA-DESC        94788000
947881     MOVE PV-ADD-TSHIPMT-FAIL-DUPE TO RC082-STAT-DATA-QTY         94788100
947882                                      PV-DISPLAY-NBR              94788200
947883     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94788300
947884     PERFORM 9910-INSERT-STATISTICS                               94788400
947885     MOVE '23'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94788500
947886     MOVE 'NUMBER OF INSERTS TO TTRIPST'                          94788600
947887                                   TO RC082-STAT-DATA-DESC        94788700
947888     MOVE PV-ADD-TTRIPST           TO RC082-STAT-DATA-QTY         94788800
947889                                      PV-DISPLAY-NBR              94788900
947890     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94789000
947891     PERFORM 9910-INSERT-STATISTICS                               94789100
947892     MOVE '24'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94789200
947893     MOVE 'NUMBER OF INSERTS TO TPKSLIP'                          94789300
947894                                   TO RC082-STAT-DATA-DESC        94789400
947895     MOVE PV-ADD-TPKSLIP           TO RC082-STAT-DATA-QTY         94789500
947896                                      PV-DISPLAY-NBR              94789600
947897     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94789700
947898     PERFORM 9910-INSERT-STATISTICS                               94789800
947899     MOVE '25'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94789900
947900     MOVE 'NUMBER OF INSERTS TO TPKSLIP FAILED - DUPS'            94790000
947901                                   TO RC082-STAT-DATA-DESC        94790100
947902     MOVE PV-ADD-TPKSLIP-FAIL-DUPE TO RC082-STAT-DATA-QTY         94790200
947903                                      PV-DISPLAY-NBR              94790300
947904     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94790400
947905     PERFORM 9910-INSERT-STATISTICS                               94790500
947906     MOVE '26'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94790600
947907     MOVE 'NUMBER OF INSERTS TO TPKITEM'                          94790700
947908                                   TO RC082-STAT-DATA-DESC        94790800
947909     MOVE PV-ADD-TPKITEM           TO RC082-STAT-DATA-QTY         94790900
947910                                      PV-DISPLAY-NBR              94791000
947911     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94791100
947912     PERFORM 9910-INSERT-STATISTICS                               94791200
947913     MOVE '27'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94791300
947914     MOVE 'NUMBER OF INSERTS TO TVEHICL'                          94791400
947915                                   TO RC082-STAT-DATA-DESC        94791500
947916     MOVE PV-ADD-TVEHICL           TO RC082-STAT-DATA-QTY         94791600
947917                                      PV-DISPLAY-NBR              94791700
947918     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94791800
947919     PERFORM 9910-INSERT-STATISTICS                               94791900
947920     MOVE '28'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94792000
947921     MOVE 'NUMBER OF INSERTS TO TVHTRIP'                          94792100
947922                                   TO RC082-STAT-DATA-DESC        94792200
947923     MOVE PV-ADD-TVHTRIP           TO RC082-STAT-DATA-QTY         94792300
947924                                      PV-DISPLAY-NBR              94792400
947925     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94792500
947926     PERFORM 9910-INSERT-STATISTICS                               94792600
947927     MOVE '29'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94792700
947928     MOVE 'NUMBER OF INSERTS TO TSHPTPO'                          94792800
947929                                   TO RC082-STAT-DATA-DESC        94792900
947930     MOVE PV-ADD-TSHPTPO           TO RC082-STAT-DATA-QTY         94793000
947931                                      PV-DISPLAY-NBR              94793100
947932     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94793200
947933     PERFORM 9910-INSERT-STATISTICS                               94793300
947934     MOVE '30'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94793400
947935     MOVE 'NUMBER OF INSERTS TO TSHPTPO FAILED - DUPS'            94793500
947936                                   TO RC082-STAT-DATA-DESC        94793600
947937     MOVE PV-ADD-TSHPTPO-FAIL-DUPE TO RC082-STAT-DATA-QTY         94793700
947938                                      PV-DISPLAY-NBR              94793800
947939     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94793900
947940     PERFORM 9910-INSERT-STATISTICS                               94794000
947941     MOVE '31'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94794100
947942     MOVE 'NUMBER OF INSERTS TO TSHIPST'                          94794200
947943                                   TO RC082-STAT-DATA-DESC        94794300
947944     MOVE PV-ADD-TSHIPST           TO RC082-STAT-DATA-QTY         94794400
947945                                      PV-DISPLAY-NBR              94794500
947946     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94794600
947947     PERFORM 9910-INSERT-STATISTICS                               94794700
947948     MOVE '32'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94794800
947949     MOVE 'NUMBER OF DELETES FROM TVHTRIP'                        94794900
947950                                   TO RC082-STAT-DATA-DESC        94795000
947951     MOVE PV-DELETE-TVHTRIP        TO RC082-STAT-DATA-QTY         94795100
947952                                      PV-DISPLAY-NBR              94795200
947953     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94795300
947954     PERFORM 9910-INSERT-STATISTICS                               94795400
947955     MOVE '33'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94795500
947956     MOVE 'NUMBER OF DELETES FROM TVEHICL'                        94795600
947957                                   TO RC082-STAT-DATA-DESC        94795700
947958     MOVE PV-DELETE-TVEHICL        TO RC082-STAT-DATA-QTY         94795800
947959                                      PV-DISPLAY-NBR              94795900
947960     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94796000
947961     PERFORM 9910-INSERT-STATISTICS                               94796100
947962     MOVE '34'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94796200
947963     MOVE 'NUMBER OF DELETES FROM TSHUUPC'                        94796300
947964                                   TO RC082-STAT-DATA-DESC        94796400
947965     MOVE PV-DELETE-TSHUUPC        TO RC082-STAT-DATA-QTY         94796500
947966                                      PV-DISPLAY-NBR              94796600
947967     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94796700
947968     PERFORM 9910-INSERT-STATISTICS                               94796800
947969     MOVE '35'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94796900
947970     MOVE 'NUMBER OF UPDATES TO TSHPUNT'                          94797000
947971                                   TO RC082-STAT-DATA-DESC        94797100
947972     MOVE PV-UPDATE-TSHPUNT        TO RC082-STAT-DATA-QTY         94797200
947973                                      PV-DISPLAY-NBR              94797300
947974     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94797400
947975     PERFORM 9910-INSERT-STATISTICS                               94797500
947976     MOVE '36'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94797600
947977     MOVE 'NUMBER OF UPDATES TO TSHIPMT'                          94797700
947978                                   TO RC082-STAT-DATA-DESC        94797800
947979     MOVE PV-UPDATE-TSHIPMT        TO RC082-STAT-DATA-QTY         94797900
947980                                      PV-DISPLAY-NBR              94798000
947981     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94798100
947982     PERFORM 9910-INSERT-STATISTICS                               94798200
947983     MOVE '37'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94798300
947984     MOVE 'NUMBER OF UPDATES TO TTRIPST'                          94798400
947985                                   TO RC082-STAT-DATA-DESC        94798500
947986     MOVE PV-UPDATE-TTRIPST        TO RC082-STAT-DATA-QTY         94798600
947987                                      PV-DISPLAY-NBR              94798700
947988     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94798800
947989     PERFORM 9910-INSERT-STATISTICS                               94798900
947990     MOVE '38'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94799000
947991     MOVE 'NUMBER OF UPDATES TO TVEHICL'                          94799100
947992                                   TO RC082-STAT-DATA-DESC        94799200
947993     MOVE PV-UPDATE-TVEHICL        TO RC082-STAT-DATA-QTY         94799300
947994                                      PV-DISPLAY-NBR              94799400
947995     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94799500
947996     PERFORM 9910-INSERT-STATISTICS                               94799600
947997     MOVE '39'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94799700
947998     MOVE 'NUMBER OF UPDATES TO TVHTRIP'                          94799800
947999                                   TO RC082-STAT-DATA-DESC        94799900
948000     MOVE PV-UPDATE-TVHTRIP        TO RC082-STAT-DATA-QTY         94800000
948001                                      PV-DISPLAY-NBR              94800100
948002     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94800200
948003     PERFORM 9910-INSERT-STATISTICS                               94800300
948004     MOVE '40'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94800400
948005     MOVE 'NUMBER OF UPDATES TO TSHIPST'                          94800500
948006                                   TO RC082-STAT-DATA-DESC        94800600
948007     MOVE PV-UPDATE-TSHIPST        TO RC082-STAT-DATA-QTY         94800700
948008                                      PV-DISPLAY-NBR              94800800
948009     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94800900
948010     PERFORM 9910-INSERT-STATISTICS                               94801000
948011     MOVE '41'                     TO RC082-DISP-FROM-PGM-SEQ-NBR 94801100
948012     MOVE 'NUMBER OF UPDATES TO TPKITEM'                          94801200
948013                                   TO RC082-STAT-DATA-DESC        94801300
948014     MOVE PV-UPDATE-TPKITEM        TO RC082-STAT-DATA-QTY         94801400
948015                                      PV-DISPLAY-NBR              94801500
948016     DISPLAY RC082-STAT-DATA-DESC ' : ' PV-DISPLAY-NBR            94801600
948017     PERFORM 9910-INSERT-STATISTICS.                              94801700
948018 9910-INSERT-STATISTICS.                                          94801800
948026         MOVE RC082-STAT-DATA-RECORD                              94802600
948027                                 TO RCT00039-RCVG-RCRD082-ODR.    94802700
948028         PERFORM 9912-INSERT-RCTW-OUT19.                          94802800
948060                                                                  94806029
948061 9912-INSERT-RCTW-OUT19.                                          94806100
948069     MOVE '9912-INSERT-RCTW-OUT19' TO PV-ABEND-PARAGRAPH.         94806900
948070                                                                  94807000
948071     PERFORM                                                      94807100
948072         WITH TEST AFTER                                          94807200
948073         VARYING PV-RETRY-COUNTER                                 94807300
948074         FROM 1 BY 1                                              94807400
948075         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               94807500
948076             OR (SQLCODE = +0))                                   94807600
948077                                                                  94807700
948078         EXEC SQL                                                 94807800
948079              INSERT INTO RCTW_OUT19                              94807900
948080                     (RCVG_RCRD082_ODR)                           94808000
948081              VALUES (:RCT00039-RCVG-RCRD082-ODR)                 94808100
948082         END-EXEC                                                 94808200
948083                                                                  94808300
948084         EVALUATE TRUE                                            94808400
948085             WHEN SQLCODE = +0                                    94808500
948086             WHEN SQLCODE = -911                                  94808600
948087                  CONTINUE                                        94808700
948088                                                                  94808800
948089             WHEN SQLWARN0 NOT = SPACES                           94808900
948090             WHEN SQLCODE < +0                                    94809000
948091             WHEN SQLCODE > +0                                    94809100
948092                  MOVE 'UNSUCCESSFUL INSERT TO RCTW_OUT19'        94809200
948093                         TO PV-DB2-OPERATION-ATTEMPTED            94809300
948094                  PERFORM 9920-SQL-ABEND                          94809400
948095         END-EVALUATE                                             94809500
948096     END-PERFORM.                                                 94809600
948097                                                                  94809700
948098     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    94809800
948099         SQLCODE NOT = +0                                         94809900
948100         MOVE 'MAX RETRIES EXCEEDED FOR INSERT RCTW_OUT19'        94810000
948101                TO PV-DB2-OPERATION-ATTEMPTED                     94810100
948102         PERFORM 9920-SQL-ABEND                                   94810200
948103     END-IF.                                                      94810300
948104 9920-SQL-ABEND.                                                  94810400
948112      SET RC082-PGM-END-FAILURE  TO TRUE                          94811200
948113      MOVE SQLCODE               TO SQLCODE2.                     94811300
948114      MOVE SQLERRD(3)            TO SQLERRD3.                     94811400
948115      DISPLAY '** ABEND **       ** = SQLERROR'.                  94811500
948116      DISPLAY '** PROGRAM        ** = RCKUP006'.                  94811600
948117      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       94811700
948118      DISPLAY '** OPERATION ATTEMPTED = '                         94811800
948119                                      PV-DB2-OPERATION-ATTEMPTED  94811900
948120      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 94812000
948121      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 94812100
948122      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  94812200
948123      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 94812300
948124      SET ABEND-4013-DB2-ERROR   TO TRUE                          94812400
948125      CALL 'ILBOABN0' USING ABEND-CODE.                           94812500
948130/                                                                 94813000
948200     COPY DPPD001.                                                94820000
