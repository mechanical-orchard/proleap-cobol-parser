000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.    APKUP164.                                         00020001
000300 AUTHOR.        ANIL BEDEKAR                                      00030001
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040001
000500 DATE-WRITTEN.  JULY 2011.                                        00050001
000600                                                                  00060001
000700***************************************************************** 00070001
000800*  RELOAD THE FINANCIAL DOMAIN LOCATION TABLES.                 * 00080001
000900*                                                               * 00090001
001000*  THIS IS A DAILY PROGRAM THAT RELOADS THE XFT_LOC AND         * 00100001
001100*  XFT_LOC_ATTR TABLES FROM A FLAT FILE. THE FLAT FILE IS       * 00110001
001200*  AN EXTRACT OF THE ORACLE STORE TABLE, "STORE", PROVIDED BY   * 00120001
001300*  RETEK (RMS).                                                 * 00130001
001400*                                                               * 00140001
001500*  PROGRAM COPIED FROM XFKUP001, THEN COPIED FROM XFKUP132.     * 00150001
001500*  IF THIS PROGRAM CHANGES, THE ORIGINAL PROGRAM MAY ALSO NEED  * 00151001
001600*  TO CHANGE.                                                   * 00160001
001700***************************************************************** 00170001
001800*  CHANGE LOG:                                                  * 00180001
001900*                                                               * 00190001
002000*  DATE  07/26/2011                                             * 00200001
002100*      CHANGE MADE: INITIAL PROGRAM                             * 00210001
002200*      MADE BY: ANIL BEDEKAR            WR/IR  #: WR37038       * 00220001
002300*                                                               * 00230001
002400***************************************************************** 00240001
002500 ENVIRONMENT DIVISION.                                            00250001
002600                                                                  00260001
002700 CONFIGURATION SECTION.                                           00270001
002800 SOURCE-COMPUTER.       IBM-3090.                                 00280001
002900 OBJECT-COMPUTER.       IBM-3090.                                 00290001
003000                                                                  00300001
003100 INPUT-OUTPUT SECTION.                                            00310001
003200                                                                  00320001
003300 FILE-CONTROL.                                                    00330001
003400     SELECT STORE-FILE                ASSIGN TO INP01.            00340001
003500                                                                  00350001
003600 DATA DIVISION.                                                   00360001
003700                                                                  00370001
003800 FILE SECTION.                                                    00380001
003900                                                                  00390001
004000 FD  STORE-FILE                                                   00400001
004100     RECORDING MODE IS F                                          00410001
004200     BLOCK CONTAINS 0 RECORDS                                     00420001
004300     LABEL RECORDS ARE STANDARD.                                  00430001
004400                                                                  00440001
004500 01  STORE-RECORD                     PIC X(668).                 00450001
004600                                                                  00460001
004700                                                                  00470001
004800 WORKING-STORAGE SECTION.                                         00480001
004900                                                                  00490001
005000 01  PC-PROGRAM-CONSTANTS.                                        00500001
005100     05  PC-PGM-NAME           PIC X(08)  VALUE 'APKUP164'.       00510001
005200     05  PC-DEFAULT-DATE       PIC X(10)  VALUE '9999-09-09'.     00520001
005300                                                                  00530001
005400 01  PS-PROGRAM-SWITCHES.                                         00540001
005500     05  PS-END-OF-STORE-FILE-SW      PIC X(01)      VALUE 'N'.   00550001
005600         88  PS-NOT-END-OF-STORE-FILE                VALUE 'N'.   00560001
005700         88  PS-END-OF-STORE-FILE                    VALUE 'Y'.   00570001
005800                                                                  00580001
005900 01  WS-WORKING-STORAGE.                                          00590001
006000     05  WS-CURRENT-DATE              PIC  X(10)  VALUE SPACES.   00600001
006100     05  WS-CURRENT-TIME              PIC  X(08)  VALUE SPACES.   00610001
006200     05  WS-LOC-CHAR                  PIC  X(10)  VALUE SPACES.   00620001
006300                                                                  00630001
006400 01  WS-PROGRAM-COUNTERS.                                         00640001
006500     05  WS-IN-STORE-COUNT            PIC  9(05)  VALUE ZEROS.    00650001
006600     05  WS-INSERT-XFT-LOC            PIC  9(05)  VALUE ZEROS.    00660001
006700     05  WS-INSERT-LOC-ATTR           PIC  9(05)  VALUE ZEROS.    00670001
006800     05  WS-SKIPPED-LOCATION          PIC  9(05)  VALUE ZEROS.    00680001
006900                                                                  00690001
007000*---------------------------------------------------------------* 00700001
007100* RECORD LAYOUT FOR INPUT LOCATION FILE                         * 00710001
007200*---------------------------------------------------------------* 00720001
007300     COPY HORD007.                                                00730001
007400                                                                  00740001
007500*---------------------------------------------------------------* 00750001
007600*    STANDARD DB2 ERROR HANDLING AREA                           * 00760001
007700*---------------------------------------------------------------* 00770001
007800     COPY DPWS004.                                                00780001
007900                                                                  00790001
008000*---------------------------------------------------------------* 00800001
008100*    DCLGEN FOR THE STORE LOCATION TABLE, XFT_LOC               * 00810001
008200*---------------------------------------------------------------* 00820001
008300     EXEC SQL                                                     00830001
008400         INCLUDE XFT00017                                         00840001
008500     END-EXEC.                                                    00850001
008600                                                                  00860001
008700*---------------------------------------------------------------* 00870001
008800*    DCLGEN FOR THE LOCATION ATTRIBUTE TABLE, XFT_LOC_ATTR   *    00880001
008900*---------------------------------------------------------------* 00890001
009000     EXEC SQL                                                     00900001
009100         INCLUDE XFT00019                                         00910001
009200     END-EXEC.                                                    00920001
009300                                                                  00930001
009400*----------------------------------------------------------------*00940001
009500*    STANDARD DB2 COMMUNICATIONS AREA                            *00950001
009600*----------------------------------------------------------------*00960001
009700     EXEC SQL                                                     00970001
009800         INCLUDE SQLCA                                            00980001
009900     END-EXEC.                                                    00990001
010000                                                                  01000001
010100****************************************************************  01010001
010200* WORKING STORAGE FOR ABEND PROCESSING                            01020001
010300****************************************************************  01030001
010400                                                                  01040001
010500 01  ABEND-CODE                PIC S9(04)  VALUE ZEROS COMP SYNC. 01050001
010600     88  AC-DB2-ERROR                        VALUE +4013.         01060001
010700                                                                  01070001
010800 01  ABEND-AREAS.                                                 01080001
010900     05  AA-ABEND-LIT          PIC  X(40)  VALUE                  01090001
011000             '*****       ABEND'.                                 01100001
011100     05  AA-PROGRAM-LIT        PIC  X(40)  VALUE                  01110001
011200             '*****   PROGRAM: APKUP164'.                         01120001
011300     05  AA-PARAGRAPH-LIT.                                        01130001
011400         10  FILLER            PIC  X(17)  VALUE                  01140001
011500             '***** PARAGRAPH: '.                                 01150001
011600         10  AA-PARAGRAPH-NAME PIC  X(35)  VALUE SPACES.          01160001
011700     05  AA-MESSAGE-LINE.                                         01170001
011800         10  FILLER            PIC  X(06)  VALUE '*****'.         01180001
011900         10  AA-MESSAGE        PIC  X(127) VALUE SPACES.          01190001
012000         10  FILLER REDEFINES AA-MESSAGE.                         01200001
012100             15 AA-MESSAGE-1   PIC  X(45).                        01210001
012200             15 AA-MESSAGE-2   PIC  X(45).                        01220001
012300             15 AA-MESSAGE-3   PIC  X(37).                        01230001
012400     05  AA-DB2-ERROR-LIT      PIC  X(40)  VALUE                  01240001
012500             '*****    DB2 ERROR'.                                01250001
012600     05  AA-DB2-OPERATION-LIT.                                    01260001
012700         10  FILLER            PIC  X(17)  VALUE                  01270001
012800             '***** OPERATION: '.                                 01280001
012900         10  AA-DB2-OPERATION.                                    01290001
013000             15  AA-DB2-OP-1   PIC  X(25)  VALUE SPACES.          01300001
013100             15  AA-DB2-OP-2   PIC  X(25)  VALUE SPACES.          01310001
013200     05  AA-DB2-TABLE-LIT.                                        01320001
013300         10  FILLER            PIC  X(14)  VALUE                  01330001
013400             '***** TABLES: '.                                    01340001
013500         10  AA-DB2-TABLE-1    PIC  X(18)  VALUE SPACES.          01350001
013600         10  AA-DB2-TABLE-2    PIC  X(18)  VALUE SPACES.          01360001
013700         10  AA-DB2-TABLE-3    PIC  X(18)  VALUE SPACES.          01370001
013800                                                                  01380001
013900 PROCEDURE DIVISION.                                              01390001
014000                                                                  01400001
014100 A100-MAINLINE-ROUTINE.                                           01410001
014200                                                                  01420001
014300     PERFORM B100-INITIALIZATION.                                 01430001
014400                                                                  01440001
014500     PERFORM B200-PROCESS-LOCATIONS                               01450001
014600       UNTIL PS-END-OF-STORE-FILE.                                01460001
014700                                                                  01470001
014800     PERFORM Z900-END-OF-JOB.                                     01480001
014900                                                                  01490001
015000     GOBACK.                                                      01500001
015100                                                                  01510001
015200*************************************************************     01520001
015300** INITIALIZATION ROUTINE                                         01530001
015400*************************************************************     01540001
015500 B100-INITIALIZATION.                                             01550001
015600                                                                  01560001
015700     DISPLAY '***** BEGIN PROGRAM: ' PC-PGM-NAME ' *****'.        01570001
015800     EXEC SQL                                                     01580001
015900          SELECT CURRENT DATE                                     01590001
016000                ,CURRENT TIME                                     01600001
016100            INTO :WS-CURRENT-DATE                                 01610001
016200                ,:WS-CURRENT-TIME                                 01620001
016300            FROM SYSIBM.SYSDUMMY1                                 01630001
016400     END-EXEC.                                                    01640001
016500                                                                  01650001
016600     EVALUATE TRUE                                                01660001
016700       WHEN SQLCODE NOT = ZERO                                    01670001
016800         MOVE 'B100-INITIALIZATION  '    TO AA-PARAGRAPH-NAME     01680001
016900         MOVE 'SELECT'                   TO AA-DB2-OPERATION      01690001
017000         MOVE 'SYSDUMMY1  '              TO AA-DB2-TABLE-1        01700001
017100         PERFORM Z999-DB2-ABEND                                   01710001
017200     END-EVALUATE.                                                01720001
017300                                                                  01730001
017400     DISPLAY 'DATE: ' WS-CURRENT-DATE '    '                      01740001
017500             'TIME: ' WS-CURRENT-TIME.                            01750001
017600                                                                  01760001
017700     OPEN INPUT  STORE-FILE.                                      01770001
017800                                                                  01780001
017900     PERFORM R100-READ-STORE-FILE.                                01790001
018000                                                                  01800001
018100*************************************************************     01810001
018200** THIS ROUTINE PROCESS EACH LOCATION WITH TYPE CODE 'DS'         01820001
018300*************************************************************     01830001
018400 B200-PROCESS-LOCATIONS.                                          01840001
018500                                                                  01850001
018600     IF HO007-LOC-TYP-CDE = 'DS'                                  01860001
018700        PERFORM C100-DOMAIN-LOCATIONS                             01870001
018800     ELSE                                                         01880001
018900        DISPLAY '*********** SKIPPED LOC = ' HO007-LOC-NBR        01890001
019000        DISPLAY '***** HO007-LOC-TYP-CDE = ' HO007-LOC-TYP-CDE    01900001
019100        ADD 1 TO WS-SKIPPED-LOCATION                              01910001
019200     END-IF.                                                      01920001
019300                                                                  01930001
019400     PERFORM R100-READ-STORE-FILE.                                01940001
019500                                                                  01950001
019600*************************************************************     01960001
019700** THIS ROUTINE POPULATES THE FIELDS FOR THE LOCATION             01970001
019800** DOMAIN TABLES.                                                 01980001
019900*************************************************************     01990001
020000 C100-DOMAIN-LOCATIONS.                                           02000001
020100                                                                  02010001
020200     INITIALIZE DCLXFT00017.                                      02020001
020300     INITIALIZE DCLXFT00019.                                      02030001
020400                                                                  02040001
020500     MOVE HO007-LOC-NBR              TO XFT00017-LOC-NBR          02050001
020600                                        XFT00019-LOC-NBR          02060001
020700                                        WS-LOC-CHAR.              02070001
020800     MOVE HO007-LOC-REPLT-STR-NBR    TO XFT00017-REPLT-STR-NBR    02080001
020900     MOVE HO007-LOC-DIST-NBR         TO XFT00017-DIST-NBR.        02090001
021000     MOVE HO007-LOC-TYP-CDE          TO XFT00017-LOC-TYP-CDE.     02100001
021100     MOVE HO007-LOC-NM               TO XFT00017-LOC-NM.          02110001
021200     MOVE HO007-LOC-5-ABBR-NM        TO XFT00017-LOC-5-ABBR-NM.   02120001
021300     MOVE HO007-LOC-LNE-1-ADDR       TO XFT00017-LNE-1-ADDR.      02130001
021400     MOVE HO007-LOC-LNE-2-ADDR       TO XFT00017-LNE-2-ADDR.      02140001
021500     MOVE HO007-LOC-CITY             TO XFT00017-CTY-NM.          02150001
021600     MOVE HO007-LOC-ST-CDE           TO XFT00017-ST-CDE.          02160001
021700     MOVE HO007-LOC-LOC-10-ABBR-NM   TO XFT00017-LOC-10-ABBR-NM.  02170001
021800     MOVE HO007-LOC-E-BUS-IND        TO XFT00017-E-BUS-IND.       02180001
021900                                                                  02190001
022000     MOVE 'SHARE'                    TO XFT00019-SETID.           02200001
022100     MOVE '1'                        TO XFT00019-DEPTID(1:1).     02210001
022200     MOVE WS-LOC-CHAR                TO XFT00019-DEPTID(2:4).     02220001
022300     MOVE WS-LOC-CHAR                TO XFT00019-LOCATION.        02230001
022400     MOVE '1'                        TO XFT00019-KC-ACCT-TYP-CDE. 02240001
022500                                                                  02250001
022600*    FORMAT ZIP CODE                                              02260001
022700     IF HO007-LOC-ZIP-10-CDE(1:5) NUMERIC                         02270001
022800        MOVE HO007-LOC-ZIP-10-CDE(1:5)                            02280001
022900                                  TO XFT00017-ZIP-10-CDE(1:5)     02290001
023000        IF HO007-LOC-ZIP-10-CDE(6:4) NUMERIC                      02300001
023100           IF HO007-LOC-ZIP-10-CDE(6:4) = '0000'                  02310001
023200              MOVE SPACES         TO XFT00017-ZIP-10-CDE(6:5)     02320001
023300           ELSE                                                   02330001
023400              MOVE '-'            TO XFT00017-ZIP-10-CDE(6:1)     02340001
023500              MOVE HO007-LOC-ZIP-10-CDE(6:4)                      02350001
023600                                  TO XFT00017-ZIP-10-CDE(7:4)     02360001
023700           END-IF                                                 02370001
023800        ELSE                                                      02380001
023900           MOVE HO007-LOC-ZIP-10-CDE                              02390001
024000                                  TO XFT00017-ZIP-10-CDE          02400001
024100        END-IF                                                    02410001
024200     ELSE                                                         02420001
024300        MOVE HO007-LOC-ZIP-10-CDE TO XFT00017-ZIP-10-CDE          02430001
024400     END-IF.                                                      02440001
024500                                                                  02450001
024600     IF HO007-LOC-OPEN-DATE = SPACES                              02460001
024700        MOVE WS-CURRENT-DATE         TO XFT00017-OPN-DTE          02470001
024800        DISPLAY '*********** LOC-NBR = ' HO007-LOC-NBR            02480001
024900        DISPLAY '***** HO007-LOC-OPEN-DATE = SPACES'              02490001
025000        DISPLAY '***** DEFAULTING OPEN DATE TO '                  02500001
025100                 WS-CURRENT-DATE                                  02510001
025200     ELSE                                                         02520001
025300        MOVE HO007-LOC-OPEN-DATE     TO XFT00017-OPN-DTE          02530001
025400     END-IF.                                                      02540001
025500                                                                  02550001
025600     IF HO007-LOC-CLOSE-DATE = SPACES                             02560001
025700        MOVE PC-DEFAULT-DATE         TO XFT00017-CLO-DTE          02570001
025800     ELSE                                                         02580001
025900        MOVE HO007-LOC-CLOSE-DATE    TO XFT00017-CLO-DTE          02590001
026000     END-IF.                                                      02600001
026100                                                                  02610001
026200     IF HO007-LOC-FINCL-CLO-DTE = SPACES                          02620001
026300        MOVE PC-DEFAULT-DATE         TO XFT00017-FINCL-CLO-DTE    02630001
026400     ELSE                                                         02640001
026500        MOVE HO007-LOC-CLOSE-DATE    TO XFT00017-FINCL-CLO-DTE    02650001
026600     END-IF.                                                      02660001
026700                                                                  02670001
026800     IF HO007-LOC-GRND-OPN-DTE = SPACES                           02680001
026900        IF HO007-LOC-OPEN-DATE = SPACES                           02690001
027000           MOVE WS-CURRENT-DATE     TO XFT00017-GRND-OPN-DTE      02700001
027100           DISPLAY '*********** LOC-NBR = ' HO007-LOC-NBR         02710001
027200           DISPLAY '***** HO007-LOC-GRND-OPN-DTE = SPACES'        02720001
027300           DISPLAY '***** DEFAULTING GRAND OPEN DATE TO '         02730001
027400                    WS-CURRENT-DATE                               02740001
027500        ELSE                                                      02750001
027600            MOVE HO007-LOC-OPEN-DATE TO XFT00017-GRND-OPN-DTE     02760001
027700     ELSE                                                         02770001
027800        MOVE HO007-LOC-GRND-OPN-DTE  TO XFT00017-GRND-OPN-DTE     02780001
027900     END-IF.                                                      02790001
028000                                                                  02800001
028100     IF HO007-LOC-SEA-SLS-INCL-DTE = SPACES                       02810001
028200        MOVE PC-DEFAULT-DATE         TO XFT00017-SEA-SLS-INCL-DTE 02820001
028300     ELSE                                                         02830001
028400        MOVE HO007-LOC-SEA-SLS-INCL-DTE                           02840001
028500                                     TO XFT00017-SEA-SLS-INCL-DTE 02850001
028600     END-IF.                                                      02860001
028700                                                                  02870001
028800     MOVE HO007-LOC-TOT-SLG-SQ-FTG-QTY                            02880001
028900                                TO  XFT00017-TOT-SLG-SQ-FTG-QTY.  02890001
029000     MOVE HO007-LOC-TOT-SQ-FTG-QTY  TO  XFT00017-TOT-SQ-FTG-QTY.  02900001
029100                                                                  02910001
029200     PERFORM I100-INSERT-XFT-LOC.                                 02920001
029300     PERFORM I200-INSERT-XFT-LOC-ATTR.                            02930001
029400                                                                  02940001
029500**************************************************************    02950001
029600** THIS ROUTINE INSERTS A ROW INTO THE XFT_LOC TABLE              02960001
029700**************************************************************    02970001
029800 I100-INSERT-XFT-LOC.                                             02980001
029900                                                                  02990001
030000     EXEC SQL                                                     03000001
030100        INSERT INTO XFT_LOC                                       03010001
030200            (LOC_NBR                                              03020001
030300            ,REPLT_STR_NBR                                        03030001
030400            ,DIST_NBR                                             03040001
030500            ,LOC_TYP_CDE                                          03050001
030600            ,LOC_NM                                               03060001
030700            ,LOC_5_ABBR_NM                                        03070001
030800            ,LNE_1_ADDR                                           03080001
030900            ,LNE_2_ADDR                                           03090001
031000            ,CTY_NM                                               03100001
031100            ,ST_CDE                                               03110001
031200            ,ZIP_10_CDE                                           03120001
031300            ,OPN_DTE                                              03130001
031400            ,CLO_DTE                                              03140001
031500            ,LOC_10_ABBR_NM                                       03150001
031600            ,FINCL_CLO_DTE                                        03160001
031700            ,E_BUS_IND                                            03170001
031800            ,GRND_OPN_DTE                                         03180001
031900            ,SEA_SLS_INCL_DTE                                     03190001
032000            ,TOT_SLG_SQ_FTG_QTY                                   03200001
032100            ,TOT_SQ_FTG_QTY                                       03210001
032200            )                                                     03220001
032300        VALUES                                                    03230001
032400           (:XFT00017-LOC-NBR                                     03240001
032500           ,:XFT00017-REPLT-STR-NBR                               03250001
032600           ,:XFT00017-DIST-NBR                                    03260001
032700           ,:XFT00017-LOC-TYP-CDE                                 03270001
032800           ,:XFT00017-LOC-NM                                      03280001
032900           ,:XFT00017-LOC-5-ABBR-NM                               03290001
033000           ,:XFT00017-LNE-1-ADDR                                  03300001
033100           ,:XFT00017-LNE-2-ADDR                                  03310001
033200           ,:XFT00017-CTY-NM                                      03320001
033300           ,:XFT00017-ST-CDE                                      03330001
033400           ,:XFT00017-ZIP-10-CDE                                  03340001
033500           ,:XFT00017-OPN-DTE                                     03350001
033600           ,:XFT00017-CLO-DTE                                     03360001
033700           ,:XFT00017-LOC-10-ABBR-NM                              03370001
033800           ,:XFT00017-FINCL-CLO-DTE                               03380001
033900           ,:XFT00017-E-BUS-IND                                   03390001
034000           ,:XFT00017-GRND-OPN-DTE                                03400001
034100           ,:XFT00017-SEA-SLS-INCL-DTE                            03410001
034200           ,:XFT00017-TOT-SLG-SQ-FTG-QTY                          03420001
034300           ,:XFT00017-TOT-SQ-FTG-QTY                              03430001
034400           )                                                      03440001
034500     END-EXEC.                                                    03450001
034600                                                                  03460001
034700     EVALUATE TRUE                                                03470001
034800       WHEN SQLCODE = ZERO                                        03480001
034900         ADD 1 TO WS-INSERT-XFT-LOC                               03490001
035000       WHEN SQLCODE NOT = ZERO                                    03500001
035100         DISPLAY 'LOCATION NUMBER: '      XFT00017-LOC-NBR        03510001
035200         MOVE 'I100-INSERT-XFT-LOC '      TO AA-PARAGRAPH-NAME    03520001
035300         MOVE 'INSERT'                    TO AA-DB2-OPERATION     03530001
035400         MOVE 'XFT_LOC '                  TO AA-DB2-TABLE-1       03540001
035500         PERFORM Z999-DB2-ABEND                                   03550001
035600     END-EVALUATE.                                                03560001
035700                                                                  03570001
035800                                                                  03580001
035900**************************************************************    03590001
036000** THIS ROUTINE INSERTS A ROW INTO THE XFT_LOC_ATTR TABLE         03600001
036100**************************************************************    03610001
036200 I200-INSERT-XFT-LOC-ATTR.                                        03620001
036300                                                                  03630001
036400     EXEC SQL                                                     03640001
036500        INSERT INTO XFT_LOC_ATTR                                  03650001
036600              (LOC_NBR                                            03660001
036700              ,SETID                                              03670001
036800              ,DEPTID                                             03680001
036900              ,LOCATION                                           03690001
037000              ,KC_ACCT_TYP_CDE                                    03700001
037100              )                                                   03710001
037200        VALUES                                                    03720001
037300              (:XFT00019-LOC-NBR                                  03730001
037400              ,:XFT00019-SETID                                    03740001
037500              ,:XFT00019-DEPTID                                   03750001
037600              ,:XFT00019-LOCATION                                 03760001
037700              ,:XFT00019-KC-ACCT-TYP-CDE                          03770001
037800              )                                                   03780001
037900     END-EXEC.                                                    03790001
038000                                                                  03800001
038100     EVALUATE TRUE                                                03810001
038200       WHEN SQLCODE = ZERO                                        03820001
038300         ADD 1 TO WS-INSERT-LOC-ATTR                              03830001
038400       WHEN SQLCODE NOT = ZERO                                    03840001
038500         DISPLAY 'LOCATION NUMBER: '      XFT00019-LOC-NBR        03850001
038600         MOVE 'I200-INSERT-XFT-LOC-ATTR'  TO AA-PARAGRAPH-NAME    03860001
038700         MOVE 'INSERT'                    TO AA-DB2-OPERATION     03870001
038800         MOVE 'XFT_LOC_ATTR'           TO AA-DB2-TABLE-1          03880001
038900         PERFORM Z999-DB2-ABEND                                   03890001
039000     END-EVALUATE.                                                03900001
039100                                                                  03910001
039200                                                                  03920001
039300*************************************************************     03930001
039400** THIS ROUTINE READS THE STORE LOCATION                          03940001
039500*************************************************************     03950001
039600 R100-READ-STORE-FILE.                                            03960001
039700                                                                  03970001
039800     READ STORE-FILE INTO HORD007-RECORD                          03980001
039900        AT END                                                    03990001
040000           SET PS-END-OF-STORE-FILE TO TRUE                       04000001
040100        NOT AT END                                                04010001
040200           ADD 1 TO WS-IN-STORE-COUNT                             04020001
040300     END-READ.                                                    04030001
040400                                                                  04040001
040500*************************************************************     04050001
040600** END OF PROGRAM PROCESSING                                      04060001
040700*************************************************************     04070001
040800 Z900-END-OF-JOB.                                                 04080001
040900                                                                  04090001
041000     CLOSE STORE-FILE.                                            04100001
041100                                                                  04110001
041200     DISPLAY ' '.                                                 04120001
041300     DISPLAY '******** PROGRAM COUNTERS: ********'.               04130001
041400     DISPLAY 'IN STORE FILE   :  ' WS-IN-STORE-COUNT              04140001
041500     DISPLAY ' '.                                                 04150001
041600     DISPLAY 'INSERTS XFT LOC:      ' WS-INSERT-XFT-LOC           04160001
041700     DISPLAY 'INSERTS LOC ATTR:     ' WS-INSERT-LOC-ATTR          04170001
041800     DISPLAY ' '.                                                 04180001
041900     DISPLAY 'SKIPPED LOCATIONS: ' WS-SKIPPED-LOCATION            04190001
042000     DISPLAY '****** END PROGRAM ' PC-PGM-NAME ' *******'.        04200001
042100                                                                  04210001
042200*************************************************************     04220001
042300*     DB2 ABEND ROUTINE                                           04230001
042400*************************************************************     04240001
042500 Z999-DB2-ABEND.                                                  04250001
042600                                                                  04260001
042700     DISPLAY AA-ABEND-LIT.                                        04270001
042800     DISPLAY AA-DB2-ERROR-LIT.                                    04280001
042900     DISPLAY AA-PROGRAM-LIT.                                      04290001
043000     DISPLAY AA-PARAGRAPH-LIT.                                    04300001
043100     DISPLAY AA-DB2-OPERATION-LIT.                                04310001
043200     DISPLAY AA-DB2-TABLE-LIT.                                    04320001
043300     SET AC-DB2-ERROR TO TRUE.                                    04330001
043400                                                                  04340001
043500     COPY DPPD004.                                                04350001
043600                                                                  04360001
043700     CALL 'ILBOABN0' USING ABEND-CODE.                            04370001
043800                                                                  04380001
