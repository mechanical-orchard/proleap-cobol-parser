000100*-----------------------*                                         00010076
000200 IDENTIFICATION DIVISION.                                         00020076
000300*-----------------------*                                         00030076
000400 PROGRAM-ID.    APKCS360.                                         00040076
000500 AUTHOR.        MARK BURNSIDE.                                    00050076
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060076
000700 DATE-WRITTEN.  08-31-98.                                         00070076
000800 DATE-COMPILED.                                                   00080076
000900*----------------------------------------------------------------*00090076
001000*    A360 - ADJUSTMENT JOURNAL CRITERIA SPECIFICATION            *00100076
001100*                                                                *00110076
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120076
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00130076
001400*    DETAIL SCREEN OF ADJUSTMENT JOURNAL ENTRIES.  THE PURCHASE  *00140076
001500*    ORDER NUMBER ENTERED BY THE USER IS CHECKED FOR BEING       *00150076
001600*    NUMERIC AND THE START DATE AND END DATE ARE CHECKED TO BE   *00160076
001700*    VALID DATES (IF THEY ARE ENTERED).  ALL OTHER EDITS ARE     *00170076
001800*    DONE IN THE DESTINATION PROGRAMS WHEN THE 'GO-TO' TYPE      *00180076
001900*    FUNCTION IS USED (LOCAL-FUNC-01 THRU LOCAL-FUNC-12, WITH    *00190076
002000*    DISPOSITION 'G').                                           *00200076
002100*    BY USING THE PF17 KEY FROM THIS SCREEN THE ADJUSTMENT       *00210076
002200*    TRANSFER SCREEN IS INVOKED.                                 *00220076
002300*----------------------------------------------------------------*00230076
002400*                                                                *00240076
002500* CHANGE LOG:                                                    *00250076
002600*                                                                *00260076
002700* DATE  12/09/99                                                 *00270076
002800*    CHANGE MADE:  MODIFIED THE CHECK ON THE DATE ROUTINE TO     *00280076
002900*    COMPLY WITH Y2K STANDARDS.                                  *00290076
003000*    MADE BY: MARK BURNSIDE                   WR/IR #: 6041      *00300076
003100*                                                                *00310076
003200* DATE  12/12/2000                                               *00320076
003300*    CHANGE MADE:  MODIFIED THE LENGTH OF THE ASC-VENDOR-NUMBER  *00330076
003400*    FROM TEN CHARACTERS TO NINE CHARACTERS TO IMPROVE THE       *00340076
003500*    EFFICIENCY OF SQL CALLS TO THE ADJUSTMENT JOURNAL DB2       *00350076
003600*    TABLES IN LATER CICS PROGRAMS.                              *00360076
003700*    MADE BY: MARK BURNSIDE                   WR/IR #: 21699     *00370076
003800*                                                                *00380076
003900* DATE  09/01/2021                                                00390076
004000*            - CHANGE CALL OF  DPKUT100  TO                     * 00400076
004100*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00410076
004200*              MAKING THE CALL DYNAMIC VS STATIC                * 00420076
004300*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        00430076
004400*                                                                *00440076
004500* DATE 10/24/2022                                                 00450076
004600*     CHANGE MADE: ADD COPYBOOK DPWS930                           00460076
004700*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API  * 00470076
004800*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864      * 00480076
004900*----------------------------------------------------------------*00490076
005000                                                                  00500076
005100                                                                  00510076
005200                                                                  00520076
005300 ENVIRONMENT DIVISION.                                            00530076
005400                                                                  00540076
005500                                                                  00550076
005600                                                                  00560076
005700 DATA DIVISION.                                                   00570076
005800                                                                  00580076
005900                                                                  00590076
006000 WORKING-STORAGE SECTION.                                         00600076
006100*                                                                 00610076
006200 01  PC-PROGRAM-CONSTANTS.                                        00620076
006300     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'AP360A  '. 00630076
006400     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'APKM360 '. 00640076
006500     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'APKCS360'. 00650076
006600     05  PC-TSYMSG-NUMBERS.                                       00660076
006700         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00670076
006800         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00680076
006900         10  PC-TSYMSG-00095       PIC  9(05)  VALUE  00095.      00690076
007000         10  PC-TSYMSG-00224       PIC  9(05)  VALUE  00224.      00700076
007100     05  PC-LOW-DATE               PIC  X(10)  VALUE              00710076
007200                                               '1900-01-01'.      00720076
007300     05  PC-HIGH-DATE              PIC  X(10)  VALUE              00730076
007400                                               '9999-12-31'.      00740076
007500                                                                  00750076
007600 01  PV-PROGRAM-VARIABLES.                                        00760076
007700     05  PV-CCYYMMDD-DATE          PIC  X(10).                    00770076
007800     05  PV-CCYYMMDD-DATE-RDF REDEFINES                           00780076
007900         PV-CCYYMMDD-DATE.                                        00790076
008000         10  PV-CC                 PIC  X(02).                    00800076
008100         10  PV-CC-9 REDEFINES                                    00810076
008200             PV-CC                 PIC  9(02).                    00820076
008300         10  PV-YY                 PIC  X(02).                    00830076
008400         10  PV-YY-9 REDEFINES                                    00840076
008500             PV-YY                 PIC  9(02).                    00850076
008600         10  PV-DASH1              PIC  X(01).                    00860076
008700         10  PV-MM                 PIC  X(02).                    00870076
008800         10  PV-MM-9 REDEFINES                                    00880076
008900             PV-MM                 PIC  9(02).                    00890076
009000         10  PV-DASH2              PIC  X(01).                    00900076
009100         10  PV-DD                 PIC  X(02).                    00910076
009200         10  PV-DD-9 REDEFINES                                    00920076
009300             PV-DD                 PIC  9(02).                    00930076
009400*                                                                 00940076
009500 01  PS-PROGRAM-SWITCHES.                                         00950076
009600     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00960076
009700         88  PS-ERROR                          VALUE  'Y'.        00970076
009800         88  PS-NO-ERROR                       VALUE  'N'.        00980076
009900                                                                  00990076
010000 01  PM-PROGRAM-MESSAGES.                                         01000076
010100     05  PM-ABEND-INFO-A.                                         01010076
010200         10  FILLER                PIC X(15)   VALUE              01020076
010300                                   'DP020-SRC-AID: '.             01030076
010400         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01040076
010500         10  FILLER                PIC X(19)   VALUE              01050076
010600                                   '. DP020-FK-ACTION: '.         01060076
010700         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01070076
010800         10  FILLER                PIC X(22)   VALUE              01080076
010900                                   '. DP020-FK-DISPN-IND: '.      01090076
011000         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01100076
011100         10  FILLER                PIC X(01)   VALUE '.'.         01110076
011200         10  FILLER                PIC X(19)   VALUE SPACE.       01120076
011300                                                                  01130076
011400                                                                  01140076
011500*----------------------------------------------------------------*01150076
011600*    MAP LAYOUT                                                  *01160076
011700*----------------------------------------------------------------*01170076
011800                                                                  01180076
011900     COPY APKM360.                                                01190076
012000     EJECT                                                        01200076
012100*----------------------------------------------------------------*01210076
012200*    ATTRIBUTE SETTINGS COPYBOOK.                                *01220076
012300*----------------------------------------------------------------*01230076
012400                                                                  01240076
012500     COPY DPWS015.                                                01250076
012600                                                                  01260076
012700*----------------------------------------------------------------*01270076
012800*    FUNCTION KEYS COPYBOOK                                      *01280076
012900*----------------------------------------------------------------*01290076
013000                                                                  01300076
013100     COPY DPWS016.                                                01310076
013200 EJECT                                                            01320076
013300******************************************************************01330076
013400** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01340076
013500** SUB-ROUTINE (DPKUT100).                                      **01350076
013600******************************************************************01360076
013700     COPY DPWS010I.                                               01370076
013800 EJECT                                                            01380076
013900*---------------------------------------------------------------- 01390076
014000*  DATE VALIDATION CALLING PARAMETER LIST                         01400076
014100*---------------------------------------------------------------- 01410076
014200     COPY DPWS500.                                                01420076
014300 EJECT                                                            01430076
014400*---------------------------------------------------------------- 01440076
014500*    CURRENT DATE/TIME COPYBOOK                                   01450076
014600*---------------------------------------------------------------- 01460076
014700                                                                  01470076
014800     COPY DPWS017.                                                01480076
014900******************************************************************01490076
015000** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01500076
015100** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01510076
015200******************************************************************01520076
015300     COPY DPWS030.                                                01530076
015400     COPY DPWS930.                                                01540076
015500 EJECT                                                            01550076
015600***************************************************************** 01560076
015700*    STANDARD COMMAREA.                                           01570076
015800***************************************************************** 01580076
015900                                                                  01590076
016000     COPY DPWS020.                                                01600076
016100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01610076
016200                                                                  01620076
016300***************************************************************** 01630076
016400*    INTER-APPLICATION COMMAREA.                                  01640076
016500***************************************************************** 01650076
016600                                                                  01660076
016700         10  INTER-APPL-COMM-AREA PIC X(200).                     01670076
016800     COPY APWS361.                                                01680076
016900***************************************************************** 01690076
017000*    SPECIFIC COMMMAREA FOR APKCS360.                             01700076
017100***************************************************************** 01710076
017200         10  ASC-SPECIFIC-COMMAREA.                               01720076
017300             15  ASC-VENDOR-NUMBER           PIC  X(09).          01730076
017400             15  ASC-PO-NUMBER.                                   01740076
017500                 20  ASC-PO-NUMBER-N         PIC  9(09).          01750076
017600             15  ASC-VENDOR-NAME             PIC  X(25).          01760076
017700             15  ASC-DOCUMENT-NUMBER         PIC  X(16).          01770076
017800             15  ASC-DEPARTMENT              PIC  X(03).          01780076
017900             15  ASC-ACCT-NO                 PIC  X(06).          01790076
018000             15  ASC-TRAN-CDE                PIC  X(02).          01800076
018100             15  ASC-TRAN-TYP                PIC  X(02).          01810076
018200             15  ASC-START-DATE.                                  01820076
018300                 20  ASC-STR-MM              PIC  X(02).          01830076
018400                 20  ASC-STR-MM-N REDEFINES ASC-STR-MM            01840076
018500                                             PIC  9(02).          01850076
018600                 20  ASC-STR-DD              PIC  X(02).          01860076
018700                 20  ASC-STR-DD-N REDEFINES ASC-STR-DD            01870076
018800                                             PIC  9(02).          01880076
018900                 20  ASC-STR-YY              PIC  X(02).          01890076
019000                 20  ASC-STR-YY-N REDEFINES ASC-STR-YY            01900076
019100                                             PIC  9(02).          01910076
019200             15  ASC-END-DATE.                                    01920076
019300                 20  ASC-END-MM              PIC  X(02).          01930076
019400                 20  ASC-END-MM-N REDEFINES ASC-END-MM            01940076
019500                                             PIC  9(02).          01950076
019600                 20  ASC-END-DD              PIC  X(02).          01960076
019700                 20  ASC-END-DD-N REDEFINES ASC-END-DD            01970076
019800                                             PIC  9(02).          01980076
019900                 20  ASC-END-YY              PIC  X(02).          01990076
020000                 20  ASC-END-YY-N REDEFINES ASC-END-YY            02000076
020100                                             PIC  9(02).          02010076
020200             15  ASC-STR-DATE-DB2            PIC  X(10).          02020076
020300             15  ASC-END-DATE-DB2            PIC  X(10).          02030076
020400         10  FILLER                          PIC  X(2548).        02040076
020500     EJECT                                                        02050076
020600*----------------------------------------------------------------*02060076
020700*    ABEND PROCESSING COPYBOOK.                                  *02070076
020800*----------------------------------------------------------------*02080076
020900                                                                  02090076
021000     COPY DPWS013.                                                02100076
021100                                                                  02110076
021200                                                                  02120076
021300 EJECT                                                            02130076
021400 LINKAGE SECTION.                                                 02140076
021500                                                                  02150076
021600 01  DFHCOMMAREA.                                                 02160076
021700     05  FILLER                         OCCURS  1 TO 4072 TIMES   02170076
021800                                        DEPENDING ON EIBCALEN.    02180076
021900         10  FILLER                     PIC X.                    02190076
022000                                                                  02200076
022100                                                                  02210076
022200 PROCEDURE DIVISION.                                              02220076
022300***************************************************************** 02230076
022400** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02240076
022500** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02250076
022600** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02260076
022700**                                                             ** 02270076
022800** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02280076
022900** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02290076
023000***************************************************************** 02300076
023100 0000-MAIN-MODULE.                                                02310076
023200     INITIALIZE DP030-CICS-API-FIELDS.                            02320076
023300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02330076
023400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02340076
023500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02350076
023600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02360076
023700     MOVE LENGTH OF AP360AI        TO DP030-MAP-LENGTH (1).       02370076
023800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02380076
023900     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       02390076
024000     PERFORM 0001-CALL-CICS-ARCH-API.                             02400076
024100                                                                  02410076
024200     PERFORM 1000-CONTROL-PROCESSING                              02420076
024300                                                                  02430076
024400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02440076
024500     PERFORM 0001-CALL-CICS-ARCH-API.                             02450076
024600                                                                  02460076
024700 0001-CALL-CICS-ARCH-API.                                         02470076
024800     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     02480076
024900                                     DFHCOMMAREA                  02490076
025000                                     DP030-CICS-API-FIELDS        02500076
025100                                     DP020-STANDARD-COMMAREA      02510076
025200                                     AP360AI.                     02520076
025300                                                                  02530076
025400     IF  DP030-RC-CALL-SUCCESSFUL OR                              02540076
025500         DP030-RC-APPL-ERROR                                      02550076
025600         CONTINUE                                                 02560076
025700     ELSE                                                         02570076
025800         SET DP013-NO-ROLLBACK                                    02580076
025900             DP013-XCTL-DISPLAY-RESTART                           02590076
026000             DP013-CICS-ABEND      TO TRUE                        02600076
026100         MOVE 'BEFORE 0000-MAIN-MODULE'                           02610076
026200                                   TO DP013-PARAGRAPH             02620076
026300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02630076
026400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02640076
026500         MOVE DP030-RETURN-CODE                                   02650076
026600                                   TO DP013-MESSAGE-TEXT (3)      02660076
026700         PERFORM DP013-0000-PROCESS-ABEND                         02670076
026800     END-IF.                                                      02680076
026900 EJECT                                                            02690076
027000*----------------------------------------------------------------*02700076
027100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02710076
027200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02720076
027300*----------------------------------------------------------------*02730076
027400                                                                  02740076
027500 1000-CONTROL-PROCESSING.                                         02750076
027600                                                                  02760076
027700     EVALUATE TRUE                                                02770076
027800         WHEN DP030-RC-APPL-ERROR                                 02780076
027900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02790076
028000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02800076
028100                                                                  02810076
028200         WHEN DP020-NEXT-ACT-INITIAL                              02820076
028300             INITIALIZE ASC-SPECIFIC-COMMAREA                     02830076
028400             PERFORM 4000-BUILD-INITIAL-PANEL                     02840076
028500                                                                  02850076
028600         WHEN DP020-NEXT-ACT-READ-MAP                             02860076
028700             PERFORM 2000-FKEY-PROCESSING                         02870076
028800                                                                  02880076
028900         WHEN DP020-NEXT-ACT-RETURN                               02890076
029000             MOVE -1 TO AVENDNOL                                  02900076
029100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02910076
029200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02920076
029300                                                                  02930076
029400         WHEN OTHER                                               02940076
029500             SET DP013-LOGIC-ABEND                                02950076
029600                 DP013-NO-ROLLBACK TO TRUE                        02960076
029700             MOVE '1000-CONTROL-PROCESSING'                       02970076
029800                                   TO  DP013-PARAGRAPH            02980076
029900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02990076
030000                                   TO  DP013-MESSAGE-TEXT(1)      03000076
030100             MOVE DP020-NEXT-APPL-ACTIVITY                        03010076
030200                                   TO DP013-MESSAGE-TEXT(2)       03020076
030300             PERFORM DP013-0000-PROCESS-ABEND                     03030076
030400     END-EVALUATE.                                                03040076
030500                                                                  03050076
030600*----------------------------------------------------------------*03060076
030700* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03070076
030800* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03080076
030900* EDITS.                                                         *03090076
031000*----------------------------------------------------------------*03100076
031100                                                                  03110076
031200 2000-FKEY-PROCESSING.                                            03120076
031300                                                                  03130076
031400     EVALUATE TRUE                                                03140076
031500                                                                  03150076
031600         WHEN DP020-SRC-AID = DP016-CLEAR                         03160076
031700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03170076
031800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03180076
031900                                                                  03190076
032000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03200076
032100             INITIALIZE ASC-SPECIFIC-COMMAREA                     03210076
032200             PERFORM 4000-BUILD-INITIAL-PANEL                     03220076
032300             PERFORM 3200-RESET-ATTRIBUTES                        03230076
032400                                                                  03240076
032500         WHEN OTHER                                               03250076
032600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03260076
032700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03270076
032800             IF  PS-NO-ERROR                                      03280076
032900                 SET DP030-CONTINUE-GO TO TRUE                    03290076
033000                 PERFORM 2100-CHECK-FUNCTION-KEY                  03300076
033100             ELSE                                                 03310076
033200                 SET DP030-OVERRIDE-GO TO TRUE                    03320076
033300             END-IF                                               03330076
033400     END-EVALUATE.                                                03340076
033500******************************************************************03350076
033600** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03360076
033700** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03370076
033800** FROM THE CICS ARCHITECTURE API.                              **03380076
033900******************************************************************03390076
034000 2100-CHECK-FUNCTION-KEY.                                         03400076
034100     EVALUATE TRUE                                                03410076
034200         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   03420076
034300             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03430076
034400                                                                  03440076
034500         WHEN DP020-SRC-AID = DP016-ENTER                         03450076
034600             CONTINUE                                             03460076
034700                                                                  03470076
034800         WHEN OTHER                                               03480076
034900             SET DP013-NO-ROLLBACK                                03490076
035000                 DP013-XCTL-DISPLAY-RESTART                       03500076
035100                 DP013-CICS-ABEND  TO TRUE                        03510076
035200             MOVE '2100-CHECK-FUNCTION-KEY'                       03520076
035300                                   TO DP013-PARAGRAPH             03530076
035400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03540076
035500                                   TO DP013-MESSAGE-TEXT (1)      03550076
035600             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 03560076
035700                                   TO DP013-MESSAGE-TEXT (2)      03570076
035800             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                03580076
035900             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 03590076
036000                                   TO PM-A-FK-ACTION              03600076
036100             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              03610076
036200                                   TO PM-A-FK-DISPN               03620076
036300             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      03630076
036400             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        03640076
036500                                   TO DP013-MESSAGE-TEXT (4)      03650076
036600             PERFORM DP013-0000-PROCESS-ABEND                     03660076
036700     END-EVALUATE.                                                03670076
036800******************************************************************03680076
036900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03690076
037000** INTER-APPLICATION COMMAREA.                                  **03700076
037100******************************************************************03710076
037200 2110-PREPARE-INTER-APPL-COMM.                                    03720076
037300     INITIALIZE AP361-INTER-APPL-COMMAREA.                        03730076
037400     MOVE ASC-VENDOR-NUMBER        TO AP361-VND-NBR.              03740076
037500     MOVE ASC-PO-NUMBER-N          TO AP361-PO-NUMB.              03750076
037600     MOVE ASC-VENDOR-NAME          TO AP361-ENT-DESC.             03760076
037700     MOVE ASC-DOCUMENT-NUMBER      TO AP361-DOC-NO.               03770076
037800     MOVE ASC-DEPARTMENT           TO AP361-DEPT.                 03780076
037900     MOVE ASC-ACCT-NO              TO AP361-ACCT-NO.              03790076
038000     MOVE ASC-TRAN-CDE             TO AP361-TRN-CDE.              03800076
038100     MOVE ASC-TRAN-TYP             TO AP361-TRN-TYP.              03810076
038200     MOVE ASC-STR-DATE-DB2         TO AP361-STRT-DATE.            03820076
038300     MOVE ASC-END-DATE-DB2         TO AP361-END-DATE.             03830076
038400 EJECT                                                            03840076
038500*----------------------------------------------------------------*03850076
038600* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03860076
038700* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03870076
038800* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03880076
038900*----------------------------------------------------------------*03890076
039000                                                                  03900076
039100 2200-MOVE-SCREEN-TO-COMMAREA.                                    03910076
039200     IF  AVENDNOL > ZERO                                          03920076
039300         MOVE AVENDNOI             TO ASC-VENDOR-NUMBER           03930076
039400     ELSE                                                         03940076
039500         IF  AVENDNOF = DP015-ERASE-EOF                           03950076
039600             MOVE SPACE            TO ASC-VENDOR-NUMBER           03960076
039700         END-IF                                                   03970076
039800     END-IF.                                                      03980076
039900                                                                  03990076
040000     IF  APONUML > ZERO                                           04000076
040100         MOVE APONUMI              TO ASC-PO-NUMBER               04010076
040200     ELSE                                                         04020076
040300         IF  APONUMF = DP015-ERASE-EOF                            04030076
040400             MOVE SPACE            TO ASC-PO-NUMBER               04040076
040500         END-IF                                                   04050076
040600     END-IF.                                                      04060076
040700                                                                  04070076
040800     IF  AVENDNML > ZERO                                          04080076
040900         MOVE AVENDNMI             TO ASC-VENDOR-NAME             04090076
041000     ELSE                                                         04100076
041100         IF  AVENDNMF = DP015-ERASE-EOF                           04110076
041200             MOVE SPACE            TO ASC-VENDOR-NAME             04120076
041300         END-IF                                                   04130076
041400     END-IF.                                                      04140076
041500                                                                  04150076
041600     IF  ADOCNUML > ZERO                                          04160076
041700         MOVE ADOCNUMI             TO ASC-DOCUMENT-NUMBER         04170076
041800     ELSE                                                         04180076
041900         IF  ADOCNUMF = DP015-ERASE-EOF                           04190076
042000             MOVE SPACE            TO ASC-DOCUMENT-NUMBER         04200076
042100         END-IF                                                   04210076
042200     END-IF.                                                      04220076
042300                                                                  04230076
042400     IF  ADEPTL > ZERO                                            04240076
042500         MOVE ADEPTI             TO ASC-DEPARTMENT                04250076
042600     ELSE                                                         04260076
042700         IF  ADEPTF = DP015-ERASE-EOF                             04270076
042800             MOVE SPACE            TO ASC-DEPARTMENT              04280076
042900         END-IF                                                   04290076
043000     END-IF.                                                      04300076
043100                                                                  04310076
043200     IF  AACCTNOL > ZERO                                          04320076
043300         MOVE AACCTNOI             TO ASC-ACCT-NO                 04330076
043400     ELSE                                                         04340076
043500         IF  AACCTNOF = DP015-ERASE-EOF                           04350076
043600             MOVE SPACE            TO ASC-ACCT-NO                 04360076
043700         END-IF                                                   04370076
043800     END-IF.                                                      04380076
043900                                                                  04390076
044000     IF  ATRNCDL > ZERO                                           04400076
044100         MOVE ATRNCDI             TO ASC-TRAN-CDE                 04410076
044200     ELSE                                                         04420076
044300         IF  ATRNCDF = DP015-ERASE-EOF                            04430076
044400             MOVE SPACE            TO ASC-TRAN-CDE                04440076
044500         END-IF                                                   04450076
044600     END-IF.                                                      04460076
044700                                                                  04470076
044800     IF  ATRNTPL > ZERO                                           04480076
044900         MOVE ATRNTPI             TO ASC-TRAN-TYP                 04490076
045000     ELSE                                                         04500076
045100         IF  ATRNTPF = DP015-ERASE-EOF                            04510076
045200             MOVE SPACE            TO ASC-TRAN-TYP                04520076
045300         END-IF                                                   04530076
045400     END-IF.                                                      04540076
045500                                                                  04550076
045600     IF  ATRNCDL > ZERO                                           04560076
045700         MOVE ATRNCDI             TO ASC-TRAN-CDE                 04570076
045800     ELSE                                                         04580076
045900         IF  ATRNCDF = DP015-ERASE-EOF                            04590076
046000             MOVE SPACE            TO ASC-TRAN-CDE                04600076
046100         END-IF                                                   04610076
046200     END-IF.                                                      04620076
046300                                                                  04630076
046400     IF  ASTMML > ZERO                                            04640076
046500         MOVE ASTMMI             TO ASC-STR-MM                    04650076
046600     ELSE                                                         04660076
046700         IF  ASTMMF = DP015-ERASE-EOF                             04670076
046800             MOVE SPACE            TO ASC-STR-MM                  04680076
046900         END-IF                                                   04690076
047000     END-IF.                                                      04700076
047100                                                                  04710076
047200     IF  ASTDDL > ZERO                                            04720076
047300         MOVE ASTDDI             TO ASC-STR-DD                    04730076
047400     ELSE                                                         04740076
047500         IF  ASTDDF = DP015-ERASE-EOF                             04750076
047600             MOVE SPACE            TO ASC-STR-DD                  04760076
047700         END-IF                                                   04770076
047800     END-IF.                                                      04780076
047900                                                                  04790076
048000     IF  ASTYYL > ZERO                                            04800076
048100         MOVE ASTYYI             TO ASC-STR-YY                    04810076
048200     ELSE                                                         04820076
048300         IF  ASTYYF = DP015-ERASE-EOF                             04830076
048400             MOVE SPACE            TO ASC-STR-YY                  04840076
048500         END-IF                                                   04850076
048600     END-IF.                                                      04860076
048700                                                                  04870076
048800     IF    ASC-STR-MM = SPACES                                    04880076
048900       AND ASC-STR-DD = SPACES                                    04890076
049000       AND ASC-STR-YY = SPACES                                    04900076
049100         MOVE PC-LOW-DATE TO ASC-STR-DATE-DB2                     04910076
049200     END-IF.                                                      04920076
049300                                                                  04930076
049400     IF  AENMML > ZERO                                            04940076
049500         MOVE AENMMI             TO ASC-END-MM                    04950076
049600     ELSE                                                         04960076
049700         IF  AENMMF = DP015-ERASE-EOF                             04970076
049800             MOVE SPACE            TO ASC-END-MM                  04980076
049900         END-IF                                                   04990076
050000     END-IF.                                                      05000076
050100                                                                  05010076
050200     IF  AENDDL > ZERO                                            05020076
050300         MOVE AENDDI             TO ASC-END-DD                    05030076
050400     ELSE                                                         05040076
050500         IF  AENDDF = DP015-ERASE-EOF                             05050076
050600             MOVE SPACE            TO ASC-END-DD                  05060076
050700         END-IF                                                   05070076
050800     END-IF.                                                      05080076
050900                                                                  05090076
051000     IF  AENYYL > ZERO                                            05100076
051100         MOVE AENYYI             TO ASC-END-YY                    05110076
051200     ELSE                                                         05120076
051300         IF  AENYYF = DP015-ERASE-EOF                             05130076
051400             MOVE SPACE            TO ASC-END-YY                  05140076
051500         END-IF                                                   05150076
051600     END-IF.                                                      05160076
051700                                                                  05170076
051800     IF    ASC-END-MM = SPACES                                    05180076
051900       AND ASC-END-DD = SPACES                                    05190076
052000       AND ASC-END-YY = SPACES                                    05200076
052100         MOVE PC-HIGH-DATE TO ASC-END-DATE-DB2                    05210076
052200     END-IF.                                                      05220076
052300                                                                  05230076
052400*----------------------------------------------------------------*05240076
052500* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *05250076
052600* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *05260076
052700* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*05270076
052800* IN THE DESTINATION PROGRAM, NOT HERE.                          *05280076
052900*----------------------------------------------------------------*05290076
053000                                                                  05300076
053100 3000-EDIT-DATA-IN-COMMAREA.                                      05310076
053200     PERFORM 3200-RESET-ATTRIBUTES.                               05320076
053300     IF  ASC-PO-NUMBER > SPACE                                    05330076
053400         MOVE ASC-PO-NUMBER        TO DP010I-UNEDITED-FIELD       05340076
053500         MOVE LENGTH OF ASC-PO-NUMBER  TO DP010I-MAXIMUM-DIGITS   05350076
053600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     05360076
053700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  05370076
053800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05380076
053900                         USING DP010I-NUMERIC-EDIT-AREA           05390076
054000         IF  DP010I-ERROR-DETECTED                                05400076
054100             SET PS-ERROR                                         05410076
054200                 DP020-MSG-FATAL   TO TRUE                        05420076
054300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            05430076
054400             MOVE DP015-UNP-ALP-BRT-OFF                           05440076
054500                                   TO APONUMA                     05450076
054600             MOVE DP015-RED        TO APONUMC                     05460076
054700             MOVE DP015-REVERSE    TO APONUMH                     05470076
054800             MOVE -1               TO APONUML                     05480076
054900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05490076
055000         ELSE                                                     05500076
055100             MOVE DP010I-NUMERIC-FIELD                            05510076
055200                                   TO ASC-PO-NUMBER-N             05520076
055300                                      APONUMO                     05530076
055400         END-IF                                                   05540076
055500     END-IF.                                                      05550076
055600                                                                  05560076
055700     INITIALIZE PV-CCYYMMDD-DATE.                                 05570076
055800     MOVE '-' TO PV-DASH1                                         05580076
055900                 PV-DASH2.                                        05590076
056000                                                                  05600076
056100     IF ASC-START-DATE NOT = SPACES                               05610076
056200         MOVE ASC-STR-MM          TO DP010I-UNEDITED-FIELD        05620076
056300         MOVE 2                   TO DP010I-MAXIMUM-DIGITS        05630076
056400         MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS      05640076
056500         SET DP010I-NEGATIVE-NOT-ALLOWED                          05650076
056600                                 TO TRUE                          05660076
056700         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05670076
056800                         USING DP010I-NUMERIC-EDIT-AREA           05680076
056900        IF  DP010I-ERROR-DETECTED                                 05690076
057000            SET PS-ERROR         TO TRUE                          05700076
057100            SET DP020-MSG-FATAL  TO TRUE                          05710076
057200*            -- MUST BE NUMERIC --                                05720076
057300            MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER              05730076
057400            MOVE DP015-UNP-ALP-BRT-OFF                            05740076
057500                                TO ASTMMA                         05750076
057600            MOVE DP015-RED       TO ASTMMC                        05760076
057700            MOVE DP015-REVERSE   TO ASTMMH                        05770076
057800            MOVE -1              TO ASTMML                        05780076
057900            SET DP030-SET-CURSOR-APPL-1                           05790076
058000                                  TO TRUE                         05800076
058100         ELSE                                                     05810076
058200             MOVE DP010I-NUMERIC-FIELD                            05820076
058300                                  TO PV-MM-9                      05830076
058400         END-IF                                                   05840076
058500     END-IF.                                                      05850076
058600                                                                  05860076
058700     IF ASC-START-DATE NOT = SPACES                               05870076
058800        MOVE ASC-STR-DD           TO DP010I-UNEDITED-FIELD        05880076
058900        MOVE 2                    TO DP010I-MAXIMUM-DIGITS        05890076
059000        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       05900076
059100         SET DP010I-NEGATIVE-NOT-ALLOWED                          05910076
059200                                 TO TRUE                          05920076
059300         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05930076
059400                         USING DP010I-NUMERIC-EDIT-AREA           05940076
059500        IF  DP010I-ERROR-DETECTED                                 05950076
059600            SET PS-ERROR         TO TRUE                          05960076
059700            SET DP020-MSG-FATAL  TO TRUE                          05970076
059800*            -- MUST BE NUMERIC --                                05980076
059900            MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER              05990076
060000            MOVE DP015-UNP-ALP-BRT-OFF                            06000076
060100                                TO ASTDDA                         06010076
060200            MOVE DP015-RED       TO ASTDDC                        06020076
060300            MOVE DP015-REVERSE   TO ASTDDH                        06030076
060400            MOVE -1              TO ASTDDL                        06040076
060500            SET DP030-SET-CURSOR-APPL-1                           06050076
060600                                  TO TRUE                         06060076
060700         ELSE                                                     06070076
060800             MOVE DP010I-NUMERIC-FIELD                            06080076
060900                                  TO PV-DD-9                      06090076
061000         END-IF                                                   06100076
061100     END-IF.                                                      06110076
061200                                                                  06120076
061300     IF ASC-START-DATE NOT = SPACES                               06130076
061400         MOVE ASC-STR-YY          TO DP010I-UNEDITED-FIELD        06140076
061500        MOVE 2                    TO DP010I-MAXIMUM-DIGITS        06150076
061600        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       06160076
061700         SET DP010I-NEGATIVE-NOT-ALLOWED                          06170076
061800                                 TO TRUE                          06180076
061900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06190076
062000                         USING DP010I-NUMERIC-EDIT-AREA           06200076
062100        IF  DP010I-ERROR-DETECTED                                 06210076
062200            SET PS-ERROR         TO TRUE                          06220076
062300            SET DP020-MSG-FATAL  TO TRUE                          06230076
062400*            -- MUST BE NUMERIC --                                06240076
062500            MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER              06250076
062600            MOVE DP015-UNP-ALP-BRT-OFF                            06260076
062700                                TO ASTYYA                         06270076
062800            MOVE DP015-RED       TO ASTYYC                        06280076
062900            MOVE DP015-REVERSE   TO ASTYYH                        06290076
063000            MOVE -1              TO ASTYYL                        06300076
063100            SET DP030-SET-CURSOR-APPL-1                           06310076
063200                                  TO TRUE                         06320076
063300         ELSE                                                     06330076
063400             MOVE DP010I-NUMERIC-FIELD                            06340076
063500                                  TO PV-YY-9                      06350076
063600         END-IF                                                   06360076
063700     END-IF.                                                      06370076
063800                                                                  06380076
063900     IF PV-YY NUMERIC                                             06390076
064000        IF PV-YY-9 < 80                                           06400076
064100            MOVE 20               TO PV-CC-9                      06410076
064200        ELSE                                                      06420076
064300            MOVE 19               TO PV-CC-9                      06430076
064400        END-IF                                                    06440076
064500     END-IF.                                                      06450076
064600     IF ASC-START-DATE NOT EQUAL SPACES                           06460076
064700         MOVE PV-CCYYMMDD-DATE    TO ASC-STR-DATE-DB2             06470076
064800     END-IF.                                                      06480076
064900                                                                  06490076
065000     INITIALIZE PV-CCYYMMDD-DATE.                                 06500076
065100     MOVE '-' TO PV-DASH1                                         06510076
065200                 PV-DASH2.                                        06520076
065300     IF ASC-END-DATE NOT = SPACES                                 06530076
065400         MOVE ASC-END-MM          TO DP010I-UNEDITED-FIELD        06540076
065500        MOVE 2                    TO DP010I-MAXIMUM-DIGITS        06550076
065600        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       06560076
065700         SET DP010I-NEGATIVE-NOT-ALLOWED                          06570076
065800                                 TO TRUE                          06580076
065900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06590076
066000                         USING DP010I-NUMERIC-EDIT-AREA           06600076
066100        IF  DP010I-ERROR-DETECTED                                 06610076
066200            SET PS-ERROR         TO TRUE                          06620076
066300            SET DP020-MSG-FATAL  TO TRUE                          06630076
066400*            -- MUST BE NUMERIC --                                06640076
066500            MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER              06650076
066600            MOVE DP015-UNP-ALP-BRT-OFF                            06660076
066700                                TO AENMMA                         06670076
066800            MOVE DP015-RED       TO AENMMC                        06680076
066900            MOVE DP015-REVERSE   TO AENMMH                        06690076
067000            MOVE -1              TO AENMML                        06700076
067100            SET DP030-SET-CURSOR-APPL-1                           06710076
067200                                  TO TRUE                         06720076
067300         ELSE                                                     06730076
067400             MOVE DP010I-NUMERIC-FIELD                            06740076
067500                                  TO PV-MM-9                      06750076
067600         END-IF                                                   06760076
067700     END-IF.                                                      06770076
067800                                                                  06780076
067900     IF ASC-END-DATE NOT = SPACES                                 06790076
068000         MOVE ASC-END-DD          TO DP010I-UNEDITED-FIELD        06800076
068100        MOVE 2                    TO DP010I-MAXIMUM-DIGITS        06810076
068200        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       06820076
068300         SET DP010I-NEGATIVE-NOT-ALLOWED                          06830076
068400                                 TO TRUE                          06840076
068500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06850076
068600                         USING DP010I-NUMERIC-EDIT-AREA           06860076
068700        IF  DP010I-ERROR-DETECTED                                 06870076
068800            SET PS-ERROR         TO TRUE                          06880076
068900            SET DP020-MSG-FATAL  TO TRUE                          06890076
069000*            -- MUST BE NUMERIC --                                06900076
069100            MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER              06910076
069200            MOVE DP015-UNP-ALP-BRT-OFF                            06920076
069300                                TO AENDDA                         06930076
069400            MOVE DP015-RED       TO AENDDC                        06940076
069500            MOVE DP015-REVERSE   TO AENDDH                        06950076
069600            MOVE -1              TO AENDDL                        06960076
069700            SET DP030-SET-CURSOR-APPL-1                           06970076
069800                                  TO TRUE                         06980076
069900         ELSE                                                     06990076
070000             MOVE DP010I-NUMERIC-FIELD                            07000076
070100                                  TO PV-DD-9                      07010076
070200         END-IF                                                   07020076
070300     END-IF.                                                      07030076
070400                                                                  07040076
070500     IF ASC-END-DATE NOT = SPACES                                 07050076
070600         MOVE ASC-END-YY          TO DP010I-UNEDITED-FIELD        07060076
070700        MOVE 2                    TO DP010I-MAXIMUM-DIGITS        07070076
070800        MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS       07080076
070900         SET DP010I-NEGATIVE-NOT-ALLOWED                          07090076
071000                                 TO TRUE                          07100076
071100         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07110076
071200                         USING DP010I-NUMERIC-EDIT-AREA           07120076
071300        IF  DP010I-ERROR-DETECTED                                 07130076
071400            SET PS-ERROR         TO TRUE                          07140076
071500            SET DP020-MSG-FATAL  TO TRUE                          07150076
071600*            -- MUST BE NUMERIC --                                07160076
071700            MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER              07170076
071800            MOVE DP015-UNP-ALP-BRT-OFF                            07180076
071900                                TO AENYYA                         07190076
072000            MOVE DP015-RED       TO AENYYC                        07200076
072100            MOVE DP015-REVERSE   TO AENYYH                        07210076
072200            MOVE -1              TO AENYYL                        07220076
072300            SET DP030-SET-CURSOR-APPL-1                           07230076
072400                                  TO TRUE                         07240076
072500         ELSE                                                     07250076
072600             MOVE DP010I-NUMERIC-FIELD                            07260076
072700                                  TO PV-YY-9                      07270076
072800         END-IF                                                   07280076
072900     END-IF.                                                      07290076
073000                                                                  07300076
073100     IF PV-YY NUMERIC                                             07310076
073200        IF PV-YY-9 < 80                                           07320076
073300            MOVE 20               TO PV-CC-9                      07330076
073400        ELSE                                                      07340076
073500            MOVE 19               TO PV-CC-9                      07350076
073600        END-IF                                                    07360076
073700     END-IF.                                                      07370076
073800     IF ASC-END-DATE NOT EQUAL SPACES                             07380076
073900         MOVE PV-CCYYMMDD-DATE    TO ASC-END-DATE-DB2             07390076
074000     END-IF.                                                      07400076
074100                                                                  07410076
074200     INITIALIZE DPG51   DPG54                                     07420076
074300                DPG52   DPG55                                     07430076
074400                DPG53   DPG56.                                    07440076
074500                                                                  07450076
074600     IF (ASC-STR-MM NUMERIC AND                                   07460076
074700        ASC-STR-DD NUMERIC AND                                    07470076
074800        ASC-STR-YY NUMERIC) AND                                   07480076
074900        PS-NO-ERROR                                               07490076
075000                                                                  07500076
075100        MOVE ASC-STR-DATE-DB2   TO DPG52-LK-DATE-INPUT            07510076
075200         SET DPG52-LK-DTE-ISO-FMT TO TRUE                         07520076
075300        SET DPG51-ACTUAL-CALENDAR-ONLY                            07530076
075400                                 TO TRUE                          07540076
075500        SET DPG51-DO-NOT-INCR-DECR-DATE                           07550076
075600                                 TO TRUE                          07560076
075700        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   07570076
075800                                           DPG51 DPG52            07580076
075900                                           DPG53 DPG54            07590076
076000                                           DPG55 DPG56            07600076
076100        EVALUATE TRUE                                             07610076
076200            WHEN DPG54-SEVERE-ERROR                               07620076
076300            WHEN DPG54-WARNING-ERROR                              07630076
076400                SET PS-ERROR    TO TRUE                           07640076
076500                SET DP020-MSG-FATAL                               07650076
076600                                TO TRUE                           07660076
076700*               -- INVALID DATE --                                07670076
076800                MOVE PC-TSYMSG-00009                              07680076
076900                                TO DP020-MSG-NUMBER               07690076
077000                MOVE DP015-UNP-ALP-BRT-OFF                        07700076
077100                                TO ASTMMA                         07710076
077200                                   ASTDDA                         07720076
077300                                   ASTYYA                         07730076
077400                MOVE DP015-RED  TO ASTMMC                         07740076
077500                                   ASTDDC                         07750076
077600                                   ASTYYC                         07760076
077700                 MOVE DP015-REVERSE                               07770076
077800                                TO ASTMMH                         07780076
077900                                   ASTDDH                         07790076
078000                                   ASTYYH                         07800076
078100                 MOVE -1         TO ASTMML                        07810076
078200                SET DP030-SET-CURSOR-APPL-1                       07820076
078300                                 TO TRUE                          07830076
078400            WHEN OTHER                                            07840076
078500                 MOVE DPG55-DB2-ISO-DATE-FMT                      07850076
078600                                TO ASC-STR-DATE-DB2               07860076
078700         END-EVALUATE                                             07870076
078800     ELSE                                                         07880076
078900         IF PS-NO-ERROR AND                                       07890076
079000           (ASC-STR-MM > SPACES OR                                07900076
079100           ASC-STR-DD > SPACES OR                                 07910076
079200           ASC-STR-YY > SPACES)                                   07920076
079300            SET PS-ERROR TO TRUE                                  07930076
079400            SET DP020-MSG-FATAL TO TRUE                           07940076
079500            MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER              07950076
079600            MOVE DP015-UNP-ALP-BRT-OFF                            07960076
079700                                   TO ASTMMA                      07970076
079800                                      ASTDDA                      07980076
079900                                      ASTYYA                      07990076
080000            MOVE DP015-RED         TO ASTMMC                      08000076
080100                                      ASTDDC                      08010076
080200                                      ASTYYC                      08020076
080300            MOVE DP015-REVERSE     TO ASTMMH                      08030076
080400                                      ASTDDH                      08040076
080500                                      ASTYYH                      08050076
080600            MOVE -1                TO ASTMML                      08060076
080700            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   08070076
080800         END-IF                                                   08080076
080900     END-IF.                                                      08090076
081000                                                                  08100076
081100     INITIALIZE DPG51   DPG54                                     08110076
081200                DPG52   DPG55                                     08120076
081300                DPG53   DPG56.                                    08130076
081400                                                                  08140076
081500     IF (ASC-END-MM NUMERIC AND                                   08150076
081600        ASC-END-DD NUMERIC AND                                    08160076
081700        ASC-END-YY NUMERIC) AND                                   08170076
081800        PS-NO-ERROR                                               08180076
081900                                                                  08190076
082000        MOVE ASC-END-DATE-DB2   TO DPG52-LK-DATE-INPUT            08200076
082100         SET DPG52-LK-DTE-ISO-FMT TO TRUE                         08210076
082200        SET DPG51-ACTUAL-CALENDAR-ONLY                            08220076
082300                                 TO TRUE                          08230076
082400        SET DPG51-DO-NOT-INCR-DECR-DATE                           08240076
082500                                 TO TRUE                          08250076
082600        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   08260076
082700                                           DPG51 DPG52            08270076
082800                                           DPG53 DPG54            08280076
082900                                           DPG55 DPG56            08290076
083000        EVALUATE TRUE                                             08300076
083100            WHEN DPG54-SEVERE-ERROR                               08310076
083200            WHEN DPG54-WARNING-ERROR                              08320076
083300                SET PS-ERROR    TO TRUE                           08330076
083400                SET DP020-MSG-FATAL                               08340076
083500                                TO TRUE                           08350076
083600*               -- INVALID DATE --                                08360076
083700                MOVE PC-TSYMSG-00009                              08370076
083800                                TO DP020-MSG-NUMBER               08380076
083900                MOVE DP015-UNP-ALP-BRT-OFF                        08390076
084000                                TO AENMMA                         08400076
084100                                   AENDDA                         08410076
084200                                   AENYYA                         08420076
084300                MOVE DP015-RED  TO AENMMC                         08430076
084400                                   AENDDC                         08440076
084500                                   AENYYC                         08450076
084600                 MOVE DP015-REVERSE                               08460076
084700                                TO AENMMH                         08470076
084800                                   AENDDH                         08480076
084900                                   AENYYH                         08490076
085000                 MOVE -1         TO AENMML                        08500076
085100                SET DP030-SET-CURSOR-APPL-1                       08510076
085200                                 TO TRUE                          08520076
085300            WHEN OTHER                                            08530076
085400                 MOVE DPG55-DB2-ISO-DATE-FMT                      08540076
085500                                TO ASC-END-DATE-DB2               08550076
085600         END-EVALUATE                                             08560076
085700     ELSE                                                         08570076
085800         IF PS-NO-ERROR AND                                       08580076
085900           (ASC-END-MM > SPACES OR                                08590076
086000           ASC-END-DD > SPACES OR                                 08600076
086100           ASC-END-YY > SPACES)                                   08610076
086200            SET PS-ERROR TO TRUE                                  08620076
086300            SET DP020-MSG-FATAL TO TRUE                           08630076
086400            MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER              08640076
086500            MOVE DP015-UNP-ALP-BRT-OFF                            08650076
086600                                   TO AENMMA                      08660076
086700                                      AENDDA                      08670076
086800                                      AENYYA                      08680076
086900            MOVE DP015-RED         TO AENMMC                      08690076
087000                                      AENDDC                      08700076
087100                                      AENYYC                      08710076
087200            MOVE DP015-REVERSE     TO AENMMH                      08720076
087300                                      AENDDH                      08730076
087400                                      AENYYH                      08740076
087500            MOVE -1                TO AENMML                      08750076
087600            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   08760076
087700         END-IF                                                   08770076
087800     END-IF.                                                      08780076
087900                                                                  08790076
088000     IF  PS-NO-ERROR                                              08800076
088100         MOVE -1                   TO AVENDNOL                    08810076
088200         SET DP030-SET-CURSOR-APPL-1                              08820076
088300                                   TO TRUE                        08830076
088400     END-IF.                                                      08840076
088500                                                                  08850076
088600******************************************************************08860076
088700** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **08870076
088800** MAP.                                                         **08880076
088900******************************************************************08890076
089000 3200-RESET-ATTRIBUTES.                                           08900076
089100                                                                  08910076
089200     MOVE DP015-GREEN              TO AVENDNOC                    08920076
089300                                      APONUMC                     08930076
089400                                      AVENDNMC                    08940076
089500                                      ADOCNUMC                    08950076
089600                                      ADEPTC                      08960076
089700                                      AACCTNOC                    08970076
089800                                      ATRNCDC                     08980076
089900                                      ATRNTPC                     08990076
090000                                      ASTMMC                      09000076
090100                                      ASTDDC                      09010076
090200                                      ASTYYC                      09020076
090300                                      AENMMC                      09030076
090400                                      AENDDC                      09040076
090500                                      AENYYC.                     09050076
090600     MOVE DP015-UNDERLINE          TO AVENDNOH                    09060076
090700                                      APONUMH                     09070076
090800                                      AVENDNMH                    09080076
090900                                      ADOCNUMH                    09090076
091000                                      ADEPTH                      09100076
091100                                      AACCTNOH                    09110076
091200                                      ATRNCDH                     09120076
091300                                      ATRNTPH                     09130076
091400                                      ASTMMH                      09140076
091500                                      ASTDDH                      09150076
091600                                      ASTYYH                      09160076
091700                                      AENMMH                      09170076
091800                                      AENDDH                      09180076
091900                                      AENYYH.                     09190076
092000     MOVE DP015-UNP-ALP-NOR-OFF    TO AVENDNOA                    09200076
092100                                      APONUMA                     09210076
092200                                      AVENDNMA                    09220076
092300                                      ADOCNUMA                    09230076
092400                                      ADEPTA                      09240076
092500                                      AACCTNOA                    09250076
092600                                      ATRNCDA                     09260076
092700                                      ATRNTPA                     09270076
092800                                      ASTMMA                      09280076
092900                                      ASTDDA                      09290076
093000                                      ASTYYA                      09300076
093100                                      AENMMA                      09310076
093200                                      AENDDA                      09320076
093300                                      AENYYA.                     09330076
093400     MOVE DP015-GREEN              TO AVENDNOC                    09340076
093500                                      APONUMC                     09350076
093600                                      AVENDNMC                    09360076
093700                                      ADOCNUMC                    09370076
093800                                      ADEPTC                      09380076
093900                                      AACCTNOC                    09390076
094000                                      ATRNCDC                     09400076
094100                                      ATRNTPC                     09410076
094200                                      ASTMMC                      09420076
094300                                      ASTDDC                      09430076
094400                                      ASTYYC                      09440076
094500                                      AENMMC                      09450076
094600                                      AENDDC                      09460076
094700                                      AENYYC.                     09470076
094800                                                                  09480076
094900*----------------------------------------------------------------*09490076
095000*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *09500076
095100*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *09510076
095200*  IT HERE.                                                      *09520076
095300*----------------------------------------------------------------*09530076
095400 4000-BUILD-INITIAL-PANEL.                                        09540076
095500     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        09550076
095600     MOVE -1                       TO AVENDNOL.                   09560076
095700                                                                  09570076
095800*----------------------------------------------------------------*09580076
095900*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *09590076
096000*----------------------------------------------------------------*09600076
096100 4400-MOVE-COMMAREA-TO-SCREEN.                                    09610076
096200     MOVE ASC-VENDOR-NUMBER        TO AVENDNOO.                   09620076
096300     MOVE ASC-PO-NUMBER-N          TO APONUMO.                    09630076
096400     MOVE ASC-VENDOR-NAME          TO AVENDNMO.                   09640076
096500     MOVE ASC-DOCUMENT-NUMBER      TO ADOCNUMO.                   09650076
096600     MOVE ASC-DEPARTMENT           TO ADEPTO.                     09660076
096700     MOVE ASC-ACCT-NO              TO AACCTNOO.                   09670076
096800     MOVE ASC-TRAN-CDE             TO ATRNCDO.                    09680076
096900     MOVE ASC-TRAN-TYP             TO ATRNTPO.                    09690076
097000     MOVE ASC-STR-MM               TO ASTMMO.                     09700076
097100     MOVE ASC-STR-DD               TO ASTDDO.                     09710076
097200     MOVE ASC-STR-YY               TO ASTYYO.                     09720076
097300     MOVE ASC-END-MM               TO AENMMO.                     09730076
097400     MOVE ASC-END-DD               TO AENDDO.                     09740076
097500     MOVE ASC-END-YY               TO AENYYO.                     09750076
097600 EJECT                                                            09760076
097700*----------------------------------------------------------------*09770076
097800*    ABEND PROCESSOR MODULE                                      *09780076
097900*----------------------------------------------------------------*09790076
098000                                                                  09800076
098100     COPY DPPD013.                                                09810076
