000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKRP226.                                         00020000
000300 AUTHOR.        ALEXIS KEIKER / NANCY EILBES                      00030000
000400 DATE-WRITTEN.  SEPTEMBER 2001.                                   00040000
000500 DATE-COMPILED.                                                   00050000
000600*---------------------------------------------------------------* 00060000
000700*          REPORTS OF REJECTED EDI IMPORT INVOICES              * 00070000
000800*---------------------------------------------------------------* 00080000
000900*  PURPOSE:  TO CREATE REPORTS OF EDI IMPORT INVOICES THAT WERE * 00090000
001000*  REJECTED BECAUSE THEY FAILED ONE OR MORE OF THE EDITS BEING  * 00100000
001100*  PERFORMED IN PROGRAM APKUT220.  2 REPORTS WILL BE PRODUCED.  * 00110000
001200*  ONE REPORT WILL BE DIRECTED TO MIO SO THEY CAN REVIEW THE    * 00120000
001300*  ERRORS THAT FALL UNDER THEIR RESPONSIBILITY AND THE OTHER    * 00130000
001400*  WILL REPORT ERRORS THAT FALL UNDER THE AP APPLICATION AREA   * 00140000
001500*  OF RESPONSIBILITY.  SOME ERRORS CAN APPEAR ON BOTH REPORTS,  * 00150000
001600*  AND EACH REPORT WILL INDICATE IF THERE ARE ALSO ERRORS ON    * 00160000
001700*  THE OTHER REPORT SO THAT THE 2 AREAS CAN WORK TOGETHER TO    * 00170000
001800*  GET THE ERRORS RESOLVED.                                     * 00180000
001900*---------------------------------------------------------------* 00190000
002000*                                                               * 00200000
002100*  INPUT:  REJECTED EDI INVOICES  (APRD018)                     * 00210000
002200*  OUTPUT: AP REJECTION REPORT                                  * 00220000
002300*          MIO REJECTION REPORT                                 * 00230000
002400*---------------------------------------------------------------* 00240000
002500* CHANGES:                                                      * 00250000
002600*   10/30/2002                                                  * 00260000
002700*      RECOMPILED PROGRAM TO PICK UP NEW VERSION OF COPYBOOK    * 00270000
002800*      APWS010.                                                 * 00280000
002900*   MADE BY:  L SCHALLHORN                   IR# PM00503558     * 00290000
003000*                                                               * 00300000
003100*   01/02/2003                                                  * 00310000
003200*      CORRECTED HEADER-1 PRINT NOT TO PRINT ON EACH DETAIL     * 00320000
003300*      LINE. EXTERNAL SORT CHANGED TO SORT REPORT IN VENDOR,    * 00330000
003400*      INVOICE, AND THEN PO SEQUENCE.                           * 00340000
003500*   MADE BY:  ROLLIN KRING                   WR# 24399          * 00350000
003600*                                                               * 00360000
003700* DATE  05/22/2003                                              * 00370000
003800*     CHANGE MADE: ADDED A PO QUANTITY UOM DETAIL LINE AND A    * 00380000
003900*     SWITCH FOR UOM INFO.  ADDED CONDITION FOR UOM IN PARAGRAPH* 00390000
004000*     C300.  ADDED LOGIC IN PARAGRAPH C400 TO CREATE UOM LINE.  * 00400000
004100*     MADE BY: KEVIN CATLIN            WR/IR #: WR24632         * 00410000
004200*                                                               * 00420000
004300* DATE  07/31/2003                                              * 00430000
004400*     CHANGE MADE: CHANGES TO COPYBOOK APWS010.  ADDED NEW INFO * 00440000
004500*     LINE FOR PO/CONTAINER ID NOT FOUND ERROR THAT WILL PRINT  * 00450000
004600*     ON AP REPORT.  LOGIC CHANGED IN C300 AND C400.            * 00460000
004700*     MADE BY: KEVIN CATLIN            WR/IR #: WR24931         * 00470000
004800*                                                               * 00480000
004900* DATE  03/16/2009                                              * 00490000
005000*     CHANGE MADE:  ADD ERROR CODES 52 AND 53 IN PARAGRAPH C300 * 00500000
005100*     SO THE CONTAINER ID WILL PRINT ON REPORT FOR THESE ERRORS.* 00510000
005200*     MADE BY: KEVIN CATLIN            WR/IR #: WR33680         * 00520000
005300*                                                                 00530000
005400* DATE  10/20/2009                                              * 00540000
005500*     CHANGE MADE:  RECOMPILE FOR 310 EDI PROJECT.              * 00550000
005600*     COPYBOOK APRD018 WENT FROM 475 TO 750 BYTES.              * 00560000
005700*     MADE BY: PAUL STROEDE            WR/IR #: WR23145         * 00570000
005800*                                                               * 00580000
005900* DATE  05/25/2010                                              * 00590000
006000*     CHANGE MADE:  RECOMPILE FOR CHANGES TO APWS010 COPYBOOK   * 00600000
006100*     MADE BY: PAUL STROEDE            WR/IR #: PKE000000003991 * 00610000
006200*                                                               * 00620000
006300* DATE  08/24/2015                                              * 00630000
006400*     CHANGE MADE:  RECOMPILE FOR CHANGES TO APWS010 COPYBOOK   * 00640000
006500*     MADE BY: MEENAKSHI MITTAL        WR/IR #: CHG0112172      * 00650000
006600*                                                               * 00660000
006700* DATE  10/13/2015                                              * 00670000
006800*    CHANGE MADE: ADDED BROKER REFERENCE NUMBER AND ENTRY NUMBER* 00680000
006900*    TO THE REPORT. ALSO ADDED BOL FOR ERROR 77.                * 00690014
007000*    MADE BY: MEENAKSHI MITTAL        WR/IR #: CHG0126130       * 00700010
007010*                                                               * 00701015
007020* DATE  11/02/2020                                              * 00702015
007030*    CHANGE MADE: RECOMPILED TO INCLUDE CHANGES TO COPYBOOK     * 00703015
007040*    APWS010.                                                   * 00704015
007050*    MADE BY: NANCY EILBES            WR/IR #: CHG0250510       * 00705015
007010*                                                               * 00706016
007020* DATE  05/10/2023                                              * 00707017
007030*    CHANGE MADE: RECOMPILED FOR CHANGES TO COPYBOOK APWS010    * 00708016
007050*    MADE BY: JEAN KURK               WR/IR #: CHG0288104       * 00709117
007100*---------------------------------------------------------------* 00710000
007200 ENVIRONMENT DIVISION.                                            00720000
007300 CONFIGURATION SECTION.                                           00730000
007400 SOURCE-COMPUTER.        IBM-370.                                 00740000
007500 OBJECT-COMPUTER.        IBM-370.                                 00750000
007600                                                                  00760000
007700 INPUT-OUTPUT SECTION.                                            00770000
007800 FILE-CONTROL.                                                    00780000
007900     SELECT REJECT-EDI-FILE      ASSIGN TO INP01.                 00790000
008000     SELECT AP-REJECTION-REPORT  ASSIGN TO RPT01.                 00800000
008100     SELECT MIO-REJECTION-REPORT ASSIGN TO RPT02.                 00810000
008200                                                                  00820000
008300 DATA DIVISION.                                                   00830000
008400 FILE SECTION.                                                    00840000
008500                                                                  00850000
008600 FD  REJECT-EDI-FILE                                              00860000
008700     RECORDING MODE IS F                                          00870000
008800     LABEL RECORDS ARE STANDARD                                   00880000
008900     BLOCK CONTAINS 0 RECORDS                                     00890000
009000     DATA RECORD IS REJECT-EDI-RECORD.                            00900000
009100                                                                  00910000
009200 01  REJECT-EDI-RECORD                  PIC X(750).               00920000
009300                                                                  00930000
009400 FD  AP-REJECTION-REPORT                                          00940000
009500     RECORDING MODE IS F                                          00950000
009600     LABEL RECORDS ARE STANDARD                                   00960000
009700     BLOCK CONTAINS 0 RECORDS                                     00970000
009800     DATA RECORD IS AP-REJECT-RECORD.                             00980000
009900                                                                  00990000
010000 01  AP-REJECT-RECORD                   PIC X(150).               01000000
010100                                                                  01010000
010200 FD  MIO-REJECTION-REPORT                                         01020000
010300     RECORDING MODE IS F                                          01030000
010400     LABEL RECORDS ARE STANDARD                                   01040000
010500     BLOCK CONTAINS 0 RECORDS                                     01050000
010600     DATA RECORD IS MIO-REJECT-RECORD.                            01060000
010700                                                                  01070000
010800 01  MIO-REJECT-RECORD                  PIC X(150).               01080000
010900                                                                  01090000
011000                                                                  01100000
011100 WORKING-STORAGE SECTION.                                         01110000
011200                                                                  01120000
011300 01  END-OF-INPUT-SW                PIC X       VALUE 'N'.        01130000
011400     88  END-OF-INPUT                           VALUE 'Y'.        01140000
011500                                                                  01150000
011600 01  ERROR-SWITCHES.                                              01160000
011700     05  AP-ERRORS-SW               PIC X       VALUE ' '.        01170000
011800         88 AP-ERRORS                           VALUE 'Y'.        01180000
011900     05  MIO-ERRORS-SW              PIC X       VALUE ' '.        01190000
012000         88 MIO-ERRORS                          VALUE 'Y'.        01200000
012100     05  MIO-DETAIL-WRITTEN-SW      PIC X       VALUE ' '.        01210000
012200         88 MIO-DETAIL-WRITTEN                  VALUE 'Y'.        01220000
012300     05  AP-DETAIL-WRITTEN-SW       PIC X       VALUE ' '.        01230000
012400         88 AP-DETAIL-WRITTEN                   VALUE 'Y'.        01240000
012500                                                                  01250000
012600 01  INFO-SWITCHES.                                               01260000
012700     05  PS-RECD-TYP-CDE-SW         PIC X       VALUE 'N'.        01270000
012800         88 PS-RECORD-TYPE-CDE                  VALUE 'Y'.        01280000
012900     05  PS-PO-TYP-CDE-SW           PIC X       VALUE 'N'.        01290000
013000         88 PS-PO-TYP-CDE                       VALUE 'Y'.        01300000
013100     05  PS-INVC-DTE-SW             PIC X       VALUE 'N'.        01310000
013200         88 PS-INVC-DTE                         VALUE 'Y'.        01320000
013300     05  PS-SCAC-CDE-SW             PIC X       VALUE 'N'.        01330000
013400         88 PS-SCAC-CDE                         VALUE 'Y'.        01340000
013500     05  PS-REF-INFO-SW             PIC X       VALUE 'N'.        01350000
013600         88 PS-REF-INFO                         VALUE 'Y'.        01360000
013610     05  PS-BOL-INFO-SW             PIC X       VALUE 'N'.        01361014
013620         88 PS-BOL-INFO                         VALUE 'Y'.        01362012
013700     05  PS-CHARGE-INFO-SW          PIC X       VALUE 'N'.        01370000
013800         88 PS-CHARGE-INFO                      VALUE 'Y'.        01380000
013900     05  PS-CHARGE-COUNT-SW         PIC X       VALUE 'N'.        01390000
014000         88 PS-CHARGE-COUNT                     VALUE 'Y'.        01400000
014100     05  PS-NET-COST-SW             PIC X       VALUE 'N'.        01410000
014200         88 PS-NET-COST                         VALUE 'Y'.        01420000
014300     05  PS-QTY-UOM-SW              PIC X       VALUE 'N'.        01430000
014400         88 PS-QTY-UOM                          VALUE 'Y'.        01440000
014500     05  PS-CONTNR-ID-SW            PIC X       VALUE 'N'.        01450000
014600         88 PS-CONTNR-ID                        VALUE 'Y'.        01460000
014700     05  PS-BROKER-REF-SW           PIC X       VALUE 'N'.        01470008
014710         88 PS-BROKER-REF                       VALUE 'Y'.        01471000
014720     05  PS-ENTRY-NBR-SW            PIC X       VALUE 'N'.        01472000
014721         88 PS-ENTRY-NBR                        VALUE 'Y'.        01472100
014722*                                                                 01472200
014723 01  PROGRAM-VARIABLES.                                           01472300
014724     05  PV-COUNT-AP                    PIC 9(12)       VALUE 0.  01472400
014725     05  PV-COUNT-MIO                   PIC 9(12)       VALUE 0.  01472500
014726     05  PV-AP-RPT-OUT                  PIC 9(12)       VALUE 0.  01472600
014727     05  PV-MIO-RPT-OUT                 PIC 9(12)       VALUE 0.  01472700
014728     05  PV-INPUT-COUNT                 PIC 9(12)       VALUE 0.  01472800
014729     05  MAX-LINES                      PIC  S9(3)  COMP-3        01472900
014730                                                 VALUE +60.       01473000
014740     05  PAGE-COUNT-AP                 PIC S9(9) COMP-3 VALUE +0. 01474000
014750     05  PAGE-COUNT-MIO                PIC S9(9) COMP-3 VALUE +0. 01475000
014760     05  LINE-COUNT-AP                 PIC S9(3) COMP-3 VALUE +0. 01476000
014770     05  LINE-COUNT-MIO                PIC S9(3) COMP-3 VALUE +0. 01477000
014780     05  PV-SYSTEM-DATE                PIC  X(08)  VALUE ZERO.    01478000
014790     05  FILLER REDEFINES PV-SYSTEM-DATE.                         01479000
014800         10  PV-SYSTEM-CCYY.                                      01480000
014900             15  PV-SYSTEM-CENTURY      PIC X(02).                01490000
015000             15  PV-SYSTEM-YEAR         PIC X(02).                01500000
015100         10  PV-SYSTEM-MONTH            PIC X(02).                01510000
015200         10  PV-SYSTEM-DAY              PIC X(02).                01520000
015300     05  PV-SYSTEM-TIME.                                          01530000
015400         10  PV-SYSTEM-HOUR         PIC  9(02)  VALUE ZERO.       01540000
015500         10  PV-SYSTEM-MINUTE       PIC  9(02)  VALUE ZERO.       01550000
015600         10  PV-SYSTEM-SECOND       PIC  9(02)  VALUE ZERO.       01560000
015700         10  FILLER                 PIC  9(02)  VALUE ZERO.       01570000
015800     05  PV-PROGRAM-NAME            PIC  X(8)   VALUE 'APKRP226'. 01580000
015900                                                                  01590000
016000*----------------------------------------------------------------*01600000
016100*    ABEND DATA AREAS                                             01610000
016200*----------------------------------------------------------------*01620000
016300                                                                  01630000
016400 01  ABEND-AREAS.                                                 01640000
016500     05  AA-ABEND-LIT              PIC  X(40)   VALUE             01650000
016600             '*****       ABEND'.                                 01660000
016700     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             01670000
016800             '*****   PROGRAM: APKUT226'.                         01680000
016900     05  AA-PARAGRAPH-LIT.                                        01690000
017000         10  FILLER                PIC  X(17)   VALUE             01700000
017100             '***** PARAGRAPH: '.                                 01710000
017200         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     01720000
017300     05  AA-MESSAGE-LINE-1.                                       01730000
017400         10  FILLER                PIC  X(06)   VALUE '*****'.    01740000
017500         10  AA-MESSAGE-1          PIC  X(80)   VALUE SPACES.     01750000
017600     05  AA-MESSAGE-LINE-2.                                       01760000
017700         10  FILLER                PIC  X(06)   VALUE '*****'.    01770000
017800         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     01780000
017900                                                                  01790000
018000 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      01800000
018100                                   COMP         SYNC.             01810000
018200                                                                  01820000
018300     88  AC-ANY-ERROR                           VALUE  +4001      01830000
018400                                                THRU   +4019.     01840000
018500     88  AC-INVALID-KEY-WRITE                   VALUE  +4001.     01850000
018600     88  AC-INVALID-KEY-READ                    VALUE  +4002.     01860000
018700     88  AC-INVALID-CONTROL-CARD                VALUE  +4003.     01870000
018800     88  AC-OPEN-ERROR                          VALUE  +4005.     01880000
018900     88  AC-CLOSE-ERROR                         VALUE  +4006.     01890000
019000     88  AC-INVALID-DATA                        VALUE  +4008.     01900000
019100     88  AC-DB2-ERROR                           VALUE  +4013.     01910000
019200     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     01920000
019300     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     01930000
019400                                                                  01940000
019500*----------------------------------------------------------------*01950000
019600*           KOHLS STANDARD 150 CHARACTER REPORT HEADER           *01960000
019700*----------------------------------------------------------------*01970000
019800     COPY DPWS150O.                                               01980000
019900                                                                  01990000
020000 01  BLANK-LINE                PIC X(150) VALUE SPACES.           02000000
020100 01  SAVE-PRINT-LINE           PIC X(150) VALUE SPACES.           02010000
020200                                                                  02020000
020300 01  HDR-TITLE-1.                                                 02030000
020400     05  FILLER                  PIC  X(59)     VALUE SPACE.      02040000
020500     05  FILLER                  PIC  X(32)     VALUE             02050000
020600             'INVOICE REJECTION REPORT FOR MIO'.                  02060000
020700     05  FILLER                  PIC  X(59)     VALUE SPACE.      02070000
020800                                                                  02080000
020900 01  HDR-TITLE-2.                                                 02090000
021000     05  FILLER                  PIC  X(59)     VALUE SPACE.      02100000
021100     05  FILLER                  PIC  X(32)     VALUE             02110000
021200             'INVOICE REJECTION REPORT FOR AP '.                  02120000
021300     05  FILLER                  PIC  X(59)     VALUE SPACE.      02130000
021400                                                                  02140000
021500 01  HDR-TITLE-3.                                                 02150000
021600     05  FILLER                  PIC  X(60)     VALUE SPACE.      02160000
021700     05  FILLER                  PIC  X(20)     VALUE             02170000
021800             'EDI 210 INVOICES IN '.                              02180000
021900     05  HDR3-CC-HEADER          PIC  X(10)     VALUE SPACES.     02190000
022000     05  FILLER                  PIC  X(60)     VALUE SPACE.      02200000
022100                                                                  02210000
022200 01  HEADER-1.                                                    02220000
022300     05  FILLER                PIC X(09) VALUE 'VENDOR ID'.       02230000
022400     05  FILLER                PIC X(02) VALUE SPACES.            02240000
022500     05  FILLER                PIC X(11) VALUE 'VENDOR NAME'.     02250000
022600     05  FILLER                PIC X(21) VALUE SPACES.            02260000
022700     05  FILLER                PIC X(10) VALUE 'INVOICE ID'.      02270000
022800     05  FILLER                PIC X(15) VALUE SPACES.            02280000
022900     05  FILLER                PIC X(09) VALUE 'PO NUMBER'.       02290000
023000     05  FILLER                PIC X(02) VALUE SPACES.            02300000
023100     05  FILLER                PIC X(10) VALUE 'ISA NUMBER'.      02310000
023200     05  FILLER                PIC X(03) VALUE SPACES.            02320000
023300     05  FILLER                PIC X(26) VALUE                    02330000
023400             'ERROR CODE AND DESCRIPTION'.                        02340000
023500     05  FILLER                PIC X(20) VALUE SPACES.            02350000
023600                                                                  02360000
023700 01  NOTE-1.                                                      02370000
023800     05  FILLER                PIC X(92) VALUE SPACES.            02380000
023900     05  FILLER                PIC X(50) VALUE                    02390000
024000           'NOTE:  ERRORS ALSO REPORTED ON AP REJECTION REPORT'.  02400000
024100                                                                  02410000
024200 01  NOTE-2.                                                      02420000
024300     05  FILLER                PIC X(92) VALUE SPACES.            02430000
024400     05  FILLER                PIC X(51) VALUE                    02440000
024500           'NOTE:  ERRORS ALSO REPORTED ON MIO REJECTION REPORT'. 02450000
024600                                                                  02460000
024700 01  DETAIL-LINE.                                                 02470000
024800     05  DTL-VENDOR-ID         PIC X(09) VALUE SPACES.            02480000
024900     05  FILLER                PIC X(02) VALUE SPACES.            02490000
025000     05  DTL-VENDOR-NAME       PIC X(30) VALUE SPACES.            02500000
025100     05  FILLER                PIC X(02) VALUE SPACES.            02510000
025200     05  DTL-INVOICE-ID        PIC X(22) VALUE SPACES.            02520000
025300     05  FILLER                PIC X(03) VALUE SPACES.            02530000
025400     05  DTL-PO-NBR            PIC 9(09) VALUE ZEROES.            02540000
025500     05  FILLER                PIC X(03) VALUE SPACES.            02550000
025600     05  DTL-ISA-NBR           PIC 9(09) VALUE ZEROES.            02560000
025700     05  FILLER                PIC X(03) VALUE SPACES.            02570000
025800     05  DTL-ERROR-NBR         PIC X(02) VALUE SPACES.            02580000
025900     05  FILLER                PIC X(03) VALUE ' - '.             02590000
026000     05  DTL-ERROR-MSG         PIC X(45) VALUE SPACES.            02600000
026100                                                                  02610000
026200 01  ERROR-ONLY-LINE.                                             02620000
026300     05  ERROR-INFO            PIC X(92) VALUE SPACES.            02630000
026400     05  ERROR-NBR             PIC 9(02) VALUE ZEROES.            02640000
026500     05  FILLER                PIC X(03) VALUE ' - '.             02650000
026600     05  ERROR-MSG             PIC X(45) VALUE SPACES.            02660000
026700                                                                  02670000
026800 01  RECORD-TYP-INFO-LINE.                                        02680000
026900     05  FILLER                PIC X(19) VALUE                    02690000
027000                 'RECORD TYPE CODE = '.                           02700000
027100     05  RECORD-TYP-INFO       PIC X(02) VALUE SPACES.            02710000
027200     05  FILLER                PIC X(129) VALUE SPACES.           02720000
027300                                                                  02730000
027400 01  PO-TYPE-INFO-LINE.                                           02740000
027500     05  FILLER                PIC X(15) VALUE                    02750000
027600                 'PO TYPE CODE = '.                               02760000
027700     05  PO-TYP-CDE-INFO       PIC X(02) VALUE SPACES.            02770000
027800     05  FILLER                PIC X(133) VALUE SPACES.           02780000
027900                                                                  02790000
028000 01  PO-QTY-UOM-INFO-LINE.                                        02800000
028100     05  FILLER                PIC X(30) VALUE                    02810000
028200                 'PO QTY UNIT OF MEASURE CODE = '.                02820000
028300     05  PO-QTY-UOM-INFO       PIC X(02) VALUE SPACES.            02830000
028400     05  FILLER                PIC X(118) VALUE SPACES.           02840000
028500                                                                  02850000
028600 01  BOL-INFO-LINE.                                               02860012
028700     05  FILLER                PIC X(17) VALUE                    02870013
028800                 'BILL OF LADING = '.                             02880012
028900     05  BOL-ID-INFO           PIC X(30) VALUE SPACES.            02890012
029000     05  FILLER                PIC X(103) VALUE SPACES.           02900013
029010                                                                  02901012
029020 01  CONTNR-ID-INFO-LINE.                                         02902012
029030     05  FILLER                PIC X(15) VALUE                    02903012
029040                 'CONTAINER ID = '.                               02904012
029050     05  CONTNR-ID-INFO        PIC X(30) VALUE SPACES.            02905012
029060     05  FILLER                PIC X(105) VALUE SPACES.           02906012
029100                                                                  02910000
029200 01  BRK-REF-INFO-LINE.                                           02920000
029300     05  FILLER                PIC X(17) VALUE                    02930000
029400                 'BROKER REF NBR = '.                             02940000
029500     05  BRK-REF-NBR-INFO      PIC X(15) VALUE SPACES.            02950000
029600     05  FILLER                PIC X(60) VALUE SPACES.            02960000
029700                                                                  02970000
029800 01  ENTRY-NBR-INFO-LINE.                                         02980000
029900     05  FILLER                PIC X(17) VALUE                    02990000
030000                 'ENTRY NBR = '.                                  03000000
030100     05  ENTRY-NBR-INFO        PIC X(16) VALUE SPACES.            03010000
030200     05  FILLER                PIC X(59) VALUE SPACES.            03020000
030300                                                                  03030000
030400 01  INVC-DATE-INFO-LINE.                                         03040000
030500     05  FILLER                PIC X(15) VALUE                    03050000
030600                 'INVOICE DATE = '.                               03060000
030700     05  INVOICE-DTE-INFO      PIC X(08) VALUE SPACES.            03070000
030800     05  FILLER                PIC X(133) VALUE SPACES.           03080000
030900                                                                  03090000
031000 01  SCAC-CODE-INFO-LINE.                                         03100000
031100     05  FILLER                PIC X(12) VALUE                    03110000
031200                 'SCAC CODE = '.                                  03120000
031300     05  SCAC-CODE-INFO        PIC X(04) VALUE SPACES.            03130000
031400     05  FILLER                PIC X(134) VALUE SPACES.           03140000
031500                                                                  03150000
031600 01  REFERENCE-INFO-LINE.                                         03160000
031700     05  FILLER                PIC X(25) VALUE                    03170000
031800                 'REFERENCE ID QUALIFIER = '.                     03180000
031900     05  REF-ID-QUAL-INFO      PIC X(02) VALUE SPACES.            03190000
032000     05  FILLER                PIC X(17) VALUE                    03200000
032100                 '  REFERENCE ID = '.                             03210000
032200     05  REFERENCE-ID-INFO     PIC X(30) VALUE SPACES.            03220000
032300     05  FILLER                PIC X(76) VALUE SPACES.            03230000
032400                                                                  03240000
032500 01  CHARGE-INFO-LINE.                                            03250000
032600     05  FILLER                PIC X(14) VALUE                    03260000
032700                 'CHARGE CODE = '.                                03270000
032800     05  CHARGE-CDE-INFO       PIC X(03) VALUE SPACES.            03280000
032900     05  FILLER                PIC X(19) VALUE                    03290000
033000                 '  CHARGE AMOUNT = '.                            03300000
033100     05  CHARGE-AMT-INFO       PIC $$$$$$$$.99                    03310000
033200                               VALUE ZEROES.                      03320000
033300     05  FILLER                PIC X(103) VALUE SPACES.           03330000
033400                                                                  03340000
033500 01  CHG-COUNT-INFO-LINE.                                         03350000
033600     05  FILLER                PIC X(25) VALUE                    03360000
033700                 'NUMBER OF CHARGES SENT = '.                     03370000
033800     05  CHARGE-CNT-INFO       PIC 9(03) VALUE ZEROES.            03380000
033900     05  FILLER                PIC X(12) VALUE                    03390000
034000                 ' (MAX IS 20)'.                                  03400000
034100     05  FILLER                PIC X(110) VALUE SPACES.           03410000
034200                                                                  03420000
034300 01  NET-COST-INFO-LINE.                                          03430000
034400     05  FILLER                PIC X(17) VALUE                    03440000
034500                 'SUM OF CHARGES = '.                             03450000
034600     05  CHARGE-SUM-INFO       PIC $$$$$$$$$.99                   03460000
034700                               VALUE ZEROES.                      03470000
034800     05  FILLER                PIC X(21) VALUE                    03480000
034900                 '  INVOICE NET COST = '.                         03490000
035000     05  NET-COST-INFO         PIC $$$$$$$$$$.99                  03500000
035100                               VALUE ZEROES.                      03510000
035200     05  FILLER                PIC X(87) VALUE SPACES.            03520000
035300                                                                  03530000
035400 01  END-OF-REPORT.                                               03540000
035500     05  FILLER                PIC X(85) VALUE SPACES.            03550000
035600     05  FILLER                PIC X(29) VALUE                    03560000
035700        '- - - - END OF REPORT - - - -'.                          03570000
035800     05  FILLER                PIC X(45) VALUE SPACES.            03580000
035900                                                                  03590000
036000 01  NO-DATA-TO-REPORT.                                           03600000
036100     05  FILLER                PIC X(82) VALUE SPACES.            03610000
036200     05  FILLER                PIC X(36) VALUE                    03620000
036300        'NO DATA FOR INVOICE REJECTION REPORT'.                   03630000
036400     05  FILLER                PIC X(41) VALUE SPACES.            03640000
036500                                                                  03650000
036600*--------------------------------------------------------------*  03660000
036700*  APRD018 RECORD LAYOUT FOR EDI IMPORT INVOICE REJECTION FILE *  03670000
036800*--------------------------------------------------------------*  03680000
036900     COPY APRD018.                                                03690000
037000                                                                  03700000
037100*--------------------------------------------------------------*  03710000
037200*  APWS010 RECORD LAYOUT FOR ERROR MESSAGE REPORTING           *  03720000
037300*--------------------------------------------------------------*  03730000
037400 01  WS-EDIT-CODES.                                               03740000
037500     COPY APWS010.                                                03750000
037600                                                                  03760000
037700*--------------------------------------------------------------*  03770000
037800*  CONTROL CARD RECORD LAYOUT                                  *  03780000
037900*--------------------------------------------------------------*  03790000
038000 01  CONTROL-CARD-RECORD.                                         03800000
038100     05  CC-REPORT-HEADER        PIC  X(04).                      03810000
038200     05  FILLER                  PIC  X(76).                      03820000
038300                                                                  03830000
038400 LINKAGE SECTION.                                                 03840000
038500                                                                  03850000
038600 PROCEDURE DIVISION.                                              03860000
038700                                                                  03870000
038800 A100-MAINLINE-ROUTINE.                                           03880000
038900                                                                  03890000
039000     PERFORM B100-INITIALIZATION.                                 03900000
039100                                                                  03910000
039200     PERFORM B200-CREATE-REJECT-RPTS                              03920000
039300       UNTIL END-OF-INPUT.                                        03930000
039400                                                                  03940000
039500     PERFORM B300-TERMINATION.                                    03950000
039600                                                                  03960000
039700     GOBACK.                                                      03970000
039800                                                                  03980000
039900*--------------------------------------------------------------*  03990000
040000* B100-INITIALIZATION                                          *  04000000
040100*  INITIALIZATION PROCESSING.                                  *  04010000
040200*--------------------------------------------------------------*  04020000
040300 B100-INITIALIZATION.                                             04030000
040400                                                                  04040000
040500     DISPLAY ' '.                                                 04050000
040600     DISPLAY 'BEGINNING APKRP226 '.                               04060000
040700                                                                  04070000
040800     OPEN INPUT  REJECT-EDI-FILE                                  04080000
040900          OUTPUT AP-REJECTION-REPORT                              04090000
041000                 MIO-REJECTION-REPORT.                            04100000
041100                                                                  04110000
041200     ACCEPT CONTROL-CARD-RECORD.                                  04120000
041300     IF CC-REPORT-HEADER = 'PROD'                                 04130000
041400        MOVE 'PRODUCTION' TO HDR3-CC-HEADER                       04140000
041500     ELSE                                                         04150000
041600        IF CC-REPORT-HEADER = 'TEST'                              04160000
041700           MOVE 'TEST' TO HDR3-CC-HEADER                          04170000
041800     ELSE                                                         04180000
041900        MOVE 'B100-INITIALIZATION' TO AA-PARAGRAPH-NAME           04190000
042000        MOVE 'ERROR IN CONTROL CARD' TO AA-MESSAGE-1              04200000
042100        MOVE 'CONTROL CARD NOT SET UP CORRECTLY' TO               04210000
042200                               AA-MESSAGE-2                       04220000
042300        SET  AC-INVALID-CONTROL-CARD TO TRUE                      04230000
042400        PERFORM Z998-ABEND                                        04240000
042500        END-IF                                                    04250000
042600     END-IF.                                                      04260000
042700                                                                  04270000
042800     MOVE FUNCTION CURRENT-DATE TO PV-SYSTEM-DATE                 04280000
042900     MOVE PV-SYSTEM-MONTH        TO DP150O-RUN-MONTH.             04290000
043000     MOVE PV-SYSTEM-DAY          TO DP150O-RUN-DAY.               04300000
043100     MOVE PV-SYSTEM-YEAR         TO DP150O-RUN-YEAR.              04310000
043200     ACCEPT PV-SYSTEM-TIME FROM TIME.                             04320000
043300     MOVE PV-SYSTEM-HOUR         TO DP150O-RUN-HOUR.              04330000
043400     MOVE PV-SYSTEM-MINUTE       TO DP150O-RUN-MINUTE.            04340000
043500     MOVE PV-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          04350000
043600                                                                  04360000
043700     PERFORM W100-WRITE-MIO-HEADINGS.                             04370000
043800     PERFORM W200-WRITE-AP-HEADINGS.                              04380000
043900                                                                  04390000
044000     PERFORM R100-READ-INPUT.                                     04400000
044100                                                                  04410000
044200     IF END-OF-INPUT                                              04420000
044300         DISPLAY '!!!! NO RECORDS TO PROCESS !!!!'                04430000
044400         DISPLAY '!!!! NO RECORDS TO PROCESS !!!!'                04440000
044500         WRITE MIO-REJECT-RECORD FROM NO-DATA-TO-REPORT           04450000
044600             AFTER ADVANCING 1 LINE                               04460000
044700         WRITE AP-REJECT-RECORD FROM NO-DATA-TO-REPORT            04470000
044800             AFTER ADVANCING 1 LINE                               04480000
044900     END-IF.                                                      04490000
045000                                                                  04500000
045100*--------------------------------------------------------------*  04510000
045200*  B200-CREATE-REJECT-RPT                                      *  04520000
045300*   THIS ROUTINE HOLDS THE MAIN LOGIC FOR REJECTION REPORTING. *  04530000
045400*--------------------------------------------------------------*  04540000
045500 B200-CREATE-REJECT-RPTS.                                         04550000
045600                                                                  04560000
045700     INITIALIZE ERROR-SWITCHES.                                   04570000
045800     INITIALIZE INFO-SWITCHES.                                    04580000
045900     INITIALIZE DETAIL-LINE.                                      04590000
046000                                                                  04600000
046100     MOVE AP018-VENDOR-NBR        TO DTL-VENDOR-ID.               04610000
046200     MOVE AP018-VENDOR-NAME       TO DTL-VENDOR-NAME.             04620000
046300     MOVE AP018-INVOICE-NBR       TO DTL-INVOICE-ID.              04630000
046400     MOVE AP018-PO-NBR            TO DTL-PO-NBR.                  04640000
046500     MOVE AP018-INTRCHG-CNTL-NBR  TO DTL-ISA-NBR.                 04650000
046600                                                                  04660000
046700     PERFORM VARYING AP018-IDX FROM 1 BY 1                        04670000
046800       UNTIL AP018-IDX > 30                                       04680000
046900          OR AP018-ERR-CDE(AP018-IDX) = 0                         04690000
047000        MOVE AP018-ERR-CDE(AP018-IDX) TO WS010-TARGET-REPORT-CD   04700000
047100        PERFORM C300-SET-ERROR-INFO                               04710000
047200        EVALUATE TRUE                                             04720000
047300          WHEN AP-REJECT-REPORT                                   04730000
047400               PERFORM C100-PROCESS-AP-ERRORS                     04740000
047500          WHEN MIO-REJECT-REPORT                                  04750000
047600               PERFORM C200-PROCESS-MIO-ERRORS                    04760000
047700          WHEN OTHER                                              04770000
047800               MOVE 'B200-CREATE-REJECT-RPTS' TO AA-PARAGRAPH-NAME04780000
047900               MOVE 'CANNOT ASSIGN ERROR CODE TO TARGET REPORT'   04790000
048000                     TO AA-MESSAGE-1                              04800000
048100               MOVE 'CHECK COPYBOOK APWS010 TARGET CODE 88 LEVELS'04810000
048200                     TO AA-MESSAGE-2                              04820000
048300               DISPLAY 'VENDOR = ' AP018-VENDOR-NBR               04830000
048400               DISPLAY 'INVOICE = ' AP018-INVOICE-NBR             04840000
048500               DISPLAY 'PO NUMBER = ' AP018-PO-NBR                04850000
048600               DISPLAY 'WS010-TARGET-REPORT-CD = '                04860000
048700                        WS010-TARGET-REPORT-CD                    04870000
048800               SET  AC-INVALID-DATA TO TRUE                       04880000
048900               PERFORM Z998-ABEND                                 04890000
049000        END-EVALUATE                                              04900000
049100     END-PERFORM.                                                 04910000
049200                                                                  04920000
049300     IF AP-ERRORS AND MIO-ERRORS                                  04930000
049400        MOVE NOTE-1 TO SAVE-PRINT-LINE                            04940000
049500        PERFORM W300-WRITE-DETAIL-MIO                             04950000
049600        MOVE NOTE-2 TO SAVE-PRINT-LINE                            04960000
049700        PERFORM W400-WRITE-DETAIL-AP                              04970000
049800     END-IF.                                                      04980000
049900                                                                  04990000
050000     PERFORM C400-CREATE-INFO-LINES.                              05000000
050100                                                                  05010000
050200     PERFORM R100-READ-INPUT.                                     05020000
050300                                                                  05030000
050400*--------------------------------------------------------------*  05040000
050500* B300-TERMINATION                                             *  05050000
050600*  END OF PROGRAM PROCESSING.                                  *  05060000
050700*--------------------------------------------------------------*  05070000
050800 B300-TERMINATION.                                                05080000
050900                                                                  05090000
051000     DISPLAY '*** PROCESSING SUMMARY FOR APKRP226 ***'.           05100000
051100     DISPLAY 'INPUT RECORDS READ   = ' PV-INPUT-COUNT.            05110000
051200     DISPLAY 'AP ERRORS REPORTED   = ' PV-AP-RPT-OUT.             05120000
051300     DISPLAY 'MIO ERRORS REPORTED  = ' PV-MIO-RPT-OUT.            05130000
051400     DISPLAY '*************************************'.             05140000
051500                                                                  05150000
051600     CLOSE REJECT-EDI-FILE                                        05160000
051700           AP-REJECTION-REPORT                                    05170000
051800           MIO-REJECTION-REPORT.                                  05180000
051900                                                                  05190000
052000*----------------------------------------------------------------*05200000
052100* C100-PROCESS-AP-ERRORS                                         *05210000
052200*  PROCESSES THE ERROR THAT ARE TO BE REPORTED ON THE AP REPORT. *05220000
052210*  IF MSG 78 OR 80 GETS WRITTEN WITH ANOTHER ERROR MSG, THE      *05221005
052220*  ENTRY NBR OR BROKER NUMBER IS WRITTEN WITH THE MESSAGE ON THE *05222005
052230*  NEXT LINE.                                                    *05223005
052240*  EXAMPLE WITH MSG 78:                                          *05224005
052241*  ENTRY NBR = X09-2490591-0  78 - PO/ENTRY NUMBER COMBINATION   *05224105
052250*                                                  NOT FOUND     *05225005
052300*----------------------------------------------------------------*05230000
052400 C100-PROCESS-AP-ERRORS.                                          05240000
052500                                                                  05250000
052810     IF  AP-DETAIL-WRITTEN                                        05281001
052811         SET MSG-IDX TO AP018-ERR-CDE(AP018-IDX)                  05281101
052812         EVALUATE AP018-ERR-CDE(AP018-IDX)                        05281205
052813         WHEN '78'                                                05281305
052814            MOVE AP018-ENTRY-NUMBER TO ENTRY-NBR-INFO             05281405
052815            MOVE ENTRY-NBR-INFO-LINE TO ERROR-INFO                05281505
052816            MOVE AP018-ERR-CDE(AP018-IDX) TO ERROR-NBR            05281605
052817            MOVE WS010-ERROR-MSG(MSG-IDX) TO ERROR-MSG            05281705
052818            MOVE ERROR-ONLY-LINE TO SAVE-PRINT-LINE               05281805
052819            PERFORM W400-WRITE-DETAIL-AP                          05281905
052821         WHEN '80'                                                05282105
052822            MOVE AP018-BROKER-REF-NBR TO BRK-REF-NBR-INFO         05282205
052823            MOVE BRK-REF-INFO-LINE    TO ERROR-INFO               05282305
052824            MOVE AP018-ERR-CDE(AP018-IDX) TO ERROR-NBR            05282405
052825            MOVE WS010-ERROR-MSG(MSG-IDX) TO ERROR-MSG            05282505
052826            MOVE ERROR-ONLY-LINE TO SAVE-PRINT-LINE               05282605
052827            PERFORM W400-WRITE-DETAIL-AP                          05282705
052828         WHEN OTHER                                               05282805
052830            MOVE AP018-ERR-CDE(AP018-IDX) TO ERROR-NBR            05283003
052831            MOVE WS010-ERROR-MSG(MSG-IDX) TO ERROR-MSG            05283103
052832            MOVE ERROR-ONLY-LINE TO SAVE-PRINT-LINE               05283203
052840            PERFORM W400-WRITE-DETAIL-AP                          05284003
052850         END-EVALUATE                                             05285005
055000     ELSE                                                         05500002
055100         SET AP-ERRORS          TO TRUE                           05510002
055200         SET MSG-IDX TO AP018-ERR-CDE(AP018-IDX)                  05520002
055300         MOVE AP018-ERR-CDE(AP018-IDX) TO DTL-ERROR-NBR           05530002
055400         MOVE WS010-ERROR-MSG(MSG-IDX) TO DTL-ERROR-MSG           05540002
055500         PERFORM W400-WRITE-DETAIL-AP                             05550002
055600     END-IF.                                                      05560002
055700                                                                  05570000
055800*----------------------------------------------------------------*05580000
055900* C200-PROCESS-MIO-ERRORS                                        *05590000
056000*  PROCESSES THE ERROR THAT ARE TO BE REPORTED ON THE MIO REPORT.*05600000
056100*----------------------------------------------------------------*05610000
056200 C200-PROCESS-MIO-ERRORS.                                         05620000
056300                                                                  05630000
056400     IF  MIO-DETAIL-WRITTEN                                       05640000
056500         SET MSG-IDX TO AP018-ERR-CDE(AP018-IDX)                  05650000
056600         MOVE AP018-ERR-CDE(AP018-IDX) TO ERROR-NBR               05660000
056700         MOVE WS010-ERROR-MSG(MSG-IDX) TO ERROR-MSG               05670000
056800         MOVE ERROR-ONLY-LINE TO SAVE-PRINT-LINE                  05680000
056900         PERFORM W300-WRITE-DETAIL-MIO                            05690000
057000     ELSE                                                         05700000
057100         SET MIO-ERRORS          TO TRUE                          05710000
057200         SET MSG-IDX TO AP018-ERR-CDE(AP018-IDX)                  05720000
057300         MOVE AP018-ERR-CDE(AP018-IDX) TO DTL-ERROR-NBR           05730000
057400         MOVE WS010-ERROR-MSG(MSG-IDX) TO DTL-ERROR-MSG           05740000
057500         PERFORM W300-WRITE-DETAIL-MIO                            05750000
057600     END-IF.                                                      05760000
057700                                                                  05770000
057800                                                                  05780000
057900                                                                  05790000
058000*----------------------------------------------------------------*05800000
058100* C300-SET-ERROR-INFO                                            *05810000
058200*  SET ERROR CODE SWITCHES TO WRITE ADDITIONAL INFO TO REPORT.   *05820000
058300*----------------------------------------------------------------*05830000
058400 C300-SET-ERROR-INFO.                                             05840000
058500                                                                  05850000
058600      EVALUATE TRUE                                               05860000
058700      WHEN AP018-ERR-CDE(AP018-IDX) = 07                          05870000
058800           SET PS-RECORD-TYPE-CDE TO TRUE                         05880000
058900      WHEN AP018-ERR-CDE(AP018-IDX) = 10                          05890000
059000           SET PS-PO-TYP-CDE TO TRUE                              05900000
059100      WHEN AP018-ERR-CDE(AP018-IDX) = 15                          05910000
059200           SET PS-INVC-DTE TO TRUE                                05920000
059300      WHEN AP018-ERR-CDE(AP018-IDX) = 19                          05930000
059400           SET PS-SCAC-CDE TO TRUE                                05940000
059500      WHEN AP018-ERR-CDE(AP018-IDX) = 20                          05950011
059600           SET PS-REF-INFO TO TRUE                                05960000
059610      WHEN AP018-ERR-CDE(AP018-IDX) = 77                          05961011
059620           SET PS-BOL-INFO TO TRUE                                05962012
059700      WHEN AP018-ERR-CDE(AP018-IDX) = 25                          05970000
059800           SET PS-CHARGE-INFO TO TRUE                             05980000
059900      WHEN AP018-ERR-CDE(AP018-IDX) = 31                          05990000
060000           SET PS-CHARGE-COUNT TO TRUE                            06000000
060100      WHEN AP018-ERR-CDE(AP018-IDX) = 32 OR 33                    06010000
060200           SET PS-NET-COST TO TRUE                                06020000
060300      WHEN AP018-ERR-CDE(AP018-IDX) = 45                          06030000
060400           SET PS-QTY-UOM TO TRUE                                 06040000
060500      WHEN AP018-ERR-CDE(AP018-IDX) = 48 OR 52 OR 53              06050000
060600           SET PS-CONTNR-ID TO TRUE                               06060000
060610      WHEN AP018-ERR-CDE(AP018-IDX) = 78                          06061000
060620           SET PS-ENTRY-NBR TO TRUE                               06062000
060630      WHEN AP018-ERR-CDE(AP018-IDX) = 80                          06063000
060640           SET PS-BROKER-REF TO TRUE                              06064000
060700      END-EVALUATE.                                               06070000
060800                                                                  06080000
060900*----------------------------------------------------------------*06090000
061000* C400-CREATE-INFO-LINES                                         *06100000
061100*  WRITE ADDITIONAL INFORMATION ABOUT CERTAIN ERROR CODES.       *06110000
061200*----------------------------------------------------------------*06120000
061300 C400-CREATE-INFO-LINES.                                          06130000
061400                                                                  06140000
061500      IF PS-RECORD-TYPE-CDE                                       06150000
061600         MOVE AP018-INVALID-RECD-TYP-CDE TO RECORD-TYP-INFO       06160000
061700         MOVE RECORD-TYP-INFO-LINE TO SAVE-PRINT-LINE             06170000
061800         PERFORM W300-WRITE-DETAIL-MIO                            06180000
061900      END-IF.                                                     06190000
062000                                                                  06200000
062100      IF PS-PO-TYP-CDE                                            06210000
062200         MOVE AP018-PO-TYP-CDE TO PO-TYP-CDE-INFO                 06220000
062300         MOVE PO-TYPE-INFO-LINE TO SAVE-PRINT-LINE                06230000
062400         PERFORM W400-WRITE-DETAIL-AP                             06240000
062500      END-IF.                                                     06250000
062600                                                                  06260000
062700      IF PS-INVC-DTE                                              06270000
062800         MOVE AP018-INVC-DTE TO INVOICE-DTE-INFO                  06280000
062900         MOVE INVC-DATE-INFO-LINE TO SAVE-PRINT-LINE              06290000
063000         PERFORM W300-WRITE-DETAIL-MIO                            06300000
063100      END-IF.                                                     06310000
063200                                                                  06320000
063300      IF PS-SCAC-CDE                                              06330000
063400         MOVE AP018-SCAC-CDE TO SCAC-CODE-INFO                    06340000
063500         MOVE SCAC-CODE-INFO-LINE TO SAVE-PRINT-LINE              06350000
063600         PERFORM W400-WRITE-DETAIL-AP                             06360000
063700         INITIALIZE SCAC-CODE-INFO-LINE                           06370000
063800      END-IF.                                                     06380000
064000      IF PS-REF-INFO                                              06400000
064100         MOVE AP018-REF-ID-QUAL TO REF-ID-QUAL-INFO               06410000
064200         MOVE AP018-REFERENCE-ID-NBR TO REFERENCE-ID-INFO         06420000
064300         MOVE REFERENCE-INFO-LINE TO SAVE-PRINT-LINE              06430000
064400         PERFORM W300-WRITE-DETAIL-MIO                            06440000
064500      END-IF.                                                     06450000
064600                                                                  06460000
064700      IF PS-CHARGE-INFO                                           06470000
064800         PERFORM VARYING CHRG-IDX FROM 1 BY 1                     06480000
064900           UNTIL CHRG-IDX > 30                                    06490000
065000              OR AP018-CHARGE-CDE(CHRG-IDX) = SPACES              06500000
065100                MOVE AP018-CHARGE-CDE(CHRG-IDX) TO CHARGE-CDE-INFO06510000
065200                MOVE AP018-CHARGE-AMT(CHRG-IDX) TO CHARGE-AMT-INFO06520000
065300                MOVE CHARGE-INFO-LINE TO SAVE-PRINT-LINE          06530000
065400                PERFORM W300-WRITE-DETAIL-MIO                     06540000
065500         END-PERFORM                                              06550000
065600      END-IF.                                                     06560000
065700                                                                  06570000
065800      IF PS-CHARGE-COUNT                                          06580000
065900         MOVE AP018-CHRG-COUNT TO CHARGE-CNT-INFO                 06590000
066000         MOVE CHG-COUNT-INFO-LINE TO SAVE-PRINT-LINE              06600000
066100         PERFORM W300-WRITE-DETAIL-MIO                            06610000
066200      END-IF.                                                     06620000
066300                                                                  06630000
066400      IF PS-NET-COST                                              06640000
066500         MOVE AP018-TOTAL-CHRG-AMT TO CHARGE-SUM-INFO             06650000
066600         MOVE AP018-NET-INVC-AMT TO NET-COST-INFO                 06660000
066700         MOVE NET-COST-INFO-LINE  TO SAVE-PRINT-LINE              06670000
066800         PERFORM W300-WRITE-DETAIL-MIO                            06680000
066900      END-IF.                                                     06690000
067000                                                                  06700000
067100      IF PS-QTY-UOM                                               06710000
067200         MOVE AP018-PO-UOM-CDE TO PO-QTY-UOM-INFO                 06720000
067300         MOVE PO-QTY-UOM-INFO-LINE TO SAVE-PRINT-LINE             06730000
067400         PERFORM W300-WRITE-DETAIL-MIO                            06740000
067500      END-IF.                                                     06750000
067600                                                                  06760000
067720      IF PS-BOL-INFO                                              06772012
067800         MOVE AP018-REFERENCE-ID-NBR TO BOL-ID-INFO               06780012
067900         MOVE BOL-INFO-LINE TO SAVE-PRINT-LINE                    06790012
068000         PERFORM W400-WRITE-DETAIL-AP                             06800012
068100      END-IF.                                                     06810000
068110                                                                  06811012
068120      IF PS-CONTNR-ID                                             06812012
068130         MOVE AP018-REFERENCE-ID-NBR TO CONTNR-ID-INFO            06813012
068140         MOVE CONTNR-ID-INFO-LINE TO SAVE-PRINT-LINE              06814012
068150         PERFORM W400-WRITE-DETAIL-AP                             06815012
068160      END-IF.                                                     06816012
068200                                                                  06820000
068210      IF ENTRY-NBR-INFO = SPACES AND                              06821007
068211         PS-ENTRY-NBR                                             06821107
068220            MOVE AP018-ENTRY-NUMBER     TO ENTRY-NBR-INFO         06822006
068230            MOVE ENTRY-NBR-INFO-LINE TO SAVE-PRINT-LINE           06823006
068240            PERFORM W400-WRITE-DETAIL-AP                          06824006
068250      END-IF.                                                     06825006
068260                                                                  06826000
068261      IF BRK-REF-NBR-INFO = SPACES AND                            06826107
068262         PS-BROKER-REF                                            06826207
068263            MOVE AP018-BROKER-REF-NBR TO BRK-REF-NBR-INFO         06826306
068264            MOVE BRK-REF-INFO-LINE TO SAVE-PRINT-LINE             06826406
068265            PERFORM W400-WRITE-DETAIL-AP                          06826506
068266      END-IF.                                                     06826606
068267                                                                  06826700
068268      MOVE SPACES TO ENTRY-NBR-INFO                               06826807
068269                     ERROR-INFO                                   06826907
068270                     BRK-REF-NBR-INFO.                            06827007
068280                                                                  06828008
068300*--------------------------------------------------------------*  06830000
068400* R100-READ-INPUT                                              *  06840000
068500*  READS THE INPUT FILE.                                       *  06850000
068600*--------------------------------------------------------------*  06860000
068700 R100-READ-INPUT.                                                 06870000
068800                                                                  06880000
068900     READ REJECT-EDI-FILE INTO AP018-REJECT-IMPORT-INVOICE        06890000
069000       AT END SET END-OF-INPUT TO TRUE.                           06900000
069100                                                                  06910000
069200     IF END-OF-INPUT                                              06920000
069300        CONTINUE                                                  06930000
069400     ELSE                                                         06940000
069500        ADD 1 TO PV-INPUT-COUNT                                   06950000
069600     END-IF.                                                      06960000
069700                                                                  06970000
069800*----------------------------------------------------------------*06980000
069900* W100-WRITE-MIO-HEADINGS                                        *06990000
070000*  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                     *07000000
070100*----------------------------------------------------------------*07010000
070200 W100-WRITE-MIO-HEADINGS.                                         07020000
070300                                                                  07030000
070400     ADD 1 TO PAGE-COUNT-MIO.                                     07040000
070500     MOVE PAGE-COUNT-MIO TO DP150O-PAGE-NUMBER.                   07050000
070600     MOVE '1'    TO DP150O-REPORT-NUMBER.                         07060000
070700     WRITE MIO-REJECT-RECORD FROM DP150O-STANDRD-HEADER-150-COLS  07070000
070800         AFTER ADVANCING PAGE.                                    07080000
070900     WRITE MIO-REJECT-RECORD FROM HDR-TITLE-1                     07090000
071000         AFTER ADVANCING 1 LINE.                                  07100000
071100     WRITE MIO-REJECT-RECORD FROM HDR-TITLE-3                     07110000
071200         AFTER ADVANCING 1 LINE.                                  07120000
071300     WRITE MIO-REJECT-RECORD FROM BLANK-LINE.                     07130000
071400     WRITE MIO-REJECT-RECORD FROM HEADER-1                        07140000
071500         AFTER ADVANCING 2 LINES.                                 07150000
071600     MOVE +6            TO LINE-COUNT-MIO.                        07160000
071700                                                                  07170000
071800*----------------------------------------------------------------*07180000
071900* W200-WRITE-AP-HEADINGS                                         *07190000
072000*  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                     *07200000
072100*----------------------------------------------------------------*07210000
072200 W200-WRITE-AP-HEADINGS.                                          07220000
072300                                                                  07230000
072400     ADD 1 TO PAGE-COUNT-AP.                                      07240000
072500     MOVE PAGE-COUNT-AP TO DP150O-PAGE-NUMBER.                    07250000
072600     MOVE '2'    TO DP150O-REPORT-NUMBER.                         07260000
072700     WRITE AP-REJECT-RECORD FROM DP150O-STANDRD-HEADER-150-COLS   07270000
072800         AFTER ADVANCING PAGE.                                    07280000
072900     WRITE AP-REJECT-RECORD FROM HDR-TITLE-2                      07290000
073000         AFTER ADVANCING 1 LINE.                                  07300000
073100     WRITE AP-REJECT-RECORD FROM HDR-TITLE-3                      07310000
073200         AFTER ADVANCING 1 LINE.                                  07320000
073300     WRITE AP-REJECT-RECORD FROM BLANK-LINE.                      07330000
073400     WRITE AP-REJECT-RECORD FROM HEADER-1                         07340000
073500           AFTER ADVANCING 2 LINES.                               07350000
073600     MOVE +6            TO LINE-COUNT-AP.                         07360000
073700                                                                  07370000
073800*--------------------------------------------------------------*  07380000
073900* W300-WRITE-DETAIL-MIO                                        *  07390000
074000*  THIS ROUTINE WRITES THE DETAIL LINES TO THE MIO REPORT.     *  07400000
074100*--------------------------------------------------------------*  07410000
074200 W300-WRITE-DETAIL-MIO.                                           07420000
074300                                                                  07430000
074400     IF LINE-COUNT-MIO >= MAX-LINES                               07440000
074500        PERFORM W100-WRITE-MIO-HEADINGS                           07450000
074600        IF  MIO-DETAIL-WRITTEN                                    07460000
074700            MOVE SPACES TO DTL-ERROR-NBR                          07470000
074800                           DTL-ERROR-MSG                          07480000
074900            WRITE MIO-REJECT-RECORD FROM DETAIL-LINE              07490000
075000            ADD 2 TO LINE-COUNT-MIO                               07500000
075100            ADD 1 TO PV-MIO-RPT-OUT                               07510000
075200        END-IF                                                    07520000
075300     END-IF.                                                      07530000
075400                                                                  07540000
075500     IF  MIO-DETAIL-WRITTEN                                       07550000
075600         WRITE MIO-REJECT-RECORD FROM SAVE-PRINT-LINE             07560000
075700         ADD 1 TO LINE-COUNT-MIO                                  07570000
075800     ELSE                                                         07580000
075900         SET MIO-DETAIL-WRITTEN TO TRUE                           07590000
076000         WRITE MIO-REJECT-RECORD FROM BLANK-LINE                  07600000
076100         WRITE MIO-REJECT-RECORD FROM DETAIL-LINE                 07610000
076200         ADD 2 TO LINE-COUNT-MIO                                  07620000
076300         ADD 1 TO PV-MIO-RPT-OUT                                  07630000
076400     END-IF.                                                      07640000
076500                                                                  07650000
076600*--------------------------------------------------------------*  07660000
076700*  W400-WRITE-DETAIL-AP                                        *  07670000
076800*   THIS ROUTINE WRITES THE DETAIL LINES TO THE AP REPORT.     *  07680000
076900*--------------------------------------------------------------*  07690000
077000 W400-WRITE-DETAIL-AP.                                            07700000
077100                                                                  07710000
077200     IF LINE-COUNT-AP >= MAX-LINES                                07720000
077300        PERFORM W200-WRITE-AP-HEADINGS                            07730000
077400        IF  AP-DETAIL-WRITTEN                                     07740000
077500            MOVE SPACES TO DTL-ERROR-NBR                          07750000
077600                           DTL-ERROR-MSG                          07760000
077700            WRITE AP-REJECT-RECORD FROM DETAIL-LINE               07770000
077800            ADD 2 TO LINE-COUNT-AP                                07780000
077900            ADD 1 TO PV-AP-RPT-OUT                                07790000
078000        END-IF                                                    07800000
078100     END-IF.                                                      07810000
078200                                                                  07820000
078300     IF  AP-DETAIL-WRITTEN                                        07830000
078400         WRITE AP-REJECT-RECORD FROM SAVE-PRINT-LINE              07840000
078500         ADD 1 TO LINE-COUNT-AP                                   07850000
078600     ELSE                                                         07860000
078700         SET AP-DETAIL-WRITTEN TO TRUE                            07870000
078800         WRITE AP-REJECT-RECORD FROM BLANK-LINE                   07880000
078900         WRITE AP-REJECT-RECORD FROM DETAIL-LINE                  07890000
079000         ADD 2 TO LINE-COUNT-AP                                   07900000
079100         ADD 1 TO PV-AP-RPT-OUT                                   07910000
079200     END-IF.                                                      07920000
079300                                                                  07930000
079400                                                                  07940000
079500*----------------------------------------------------------------*07950000
079600* Z998-ABEND                                                     *07960000
079700*  ABEND ROUTINE.                                                *07970000
079800*----------------------------------------------------------------*07980000
079900 Z998-ABEND.                                                      07990000
080000                                                                  08000000
080100     DISPLAY AA-ABEND-LIT.                                        08010000
080200     DISPLAY AA-PROGRAM-LIT.                                      08020000
080300     DISPLAY AA-PARAGRAPH-LIT.                                    08030000
080400     DISPLAY AA-MESSAGE-LINE-1.                                   08040000
080500     DISPLAY AA-MESSAGE-LINE-2.                                   08050000
080600                                                                  08060000
080700     CALL 'ILBOABN0' USING ABEND-CODE.                            08070000
