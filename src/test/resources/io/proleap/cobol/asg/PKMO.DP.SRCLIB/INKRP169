       ID  DIVISION.                                                            
       PROGRAM-ID.         INKRP169.                                            
       AUTHOR.             SCOTT SWESSEL.                                       
       INSTALLATION.       KOHLS DEPARTMENT STORES.                             
       DATE-WRITTEN.       09/98.                                               
       DATE-COMPILED.                                                           
                                                                                
      *----------------------------------------------------------------*        
      *                                                                *        
      *    READ THE TIMESTAMP CUTOFF FILE CREATED IN INKUT169          *        
      *    AND CREATE THE INVENTORY SALES ADJUSTMENT REPORT.           *        
      *                                                                *        
      *CHANGE HISTORY:                                                 *        
      *                                                                *        
      * DATE: 06/26/2000   JULIE SEIDLER                               *        
      *          CHANGED PROGRAM TO HANDLE THE SLS-ADJ-PCT RECORD      *        
      *          AND TO PRINT IT ON THE OUTPUT REPORT                  *        
      *          THIS NEW REPORT LINE SHOWS THE PERCENT OF SALES       *        
      *          ADJUSTMENTS AS COMPARED TO TOTAL SALES                         
      *                                                                *        
      *          USING THE NEW SLS-ADJ-PCT RECORD, A NEW SUMMARIZED    *        
      *          SALES ADJUSTMENT REPORT WILL BE CREATED               *        
      *                                                                *        
      *          ALSO CHANGED PROGRAM TO HANDLE BEING EXECUTED AS A    *        
      *          .. REGULAR RPT                                        *        
      *          .. CUMULATIVE RPT                                     *        
      *          .. ERROR RPT                                          *        
21015 *                                                                *        
  |   * 01/19/2001  MADE BY: ROD JANSSEN         WR/PITS: 21015        *        
  |   *    SALES ADJUSTMENT VERBIAGE CHANGE FOR REPORT INKRP169....    *        
  |   *                                                                *        
  |   * 01/22/2001  MADE BY: ROD JANSSEN         WR/PITS: 21015        *        
  |   *    SUMARIZED REPORTS TO GET A TOTAL LINE. (RPT 4, 5, 6)        *        
21015 *                                                                *        
      *----------------------------------------------------------------*        
W21732* 11/19/2002        CHANGED BY SUKUMAR,IGSI    WR# W21732        *        
W21732* CHANGED CURRENT DEPT/CLASS/SEQ NUMBER TO NON-INTELLIGENT SKU.  *        
W21732*----------------------------------------------------------------*        
W26600* 06/17/2004        CHANGED BY D. THEEL        WR# W26600        *        
W26600* MODIFIED ALL STORE NUMBER FIELDS TO BE S9(4) COMP FOR          *        
W26600* PROCESSING AND 9(5) FOR REPORT.  CHANGED GETTING STORE NAME    *        
W26600* FROM TSTR000 TO XMT_LOC.                                       *        
W26600*----------------------------------------------------------------*        
W26006* 02/24/2005        CHANGED BY ERIN SEARL      WR# W26006        *        
W26006* REMOVE REFERENCES TO OBSOLETE STORE TABLE.                     *        
W26006*----------------------------------------------------------------*        
W33304* 12/22/2008        CHANGED BY THERESE RAMSEYER WR# W33304       *        
W33304* HILO - HOLD INVENTORY LEDGER OPEN ACROSS FINCL PERIODS         *        
W33304*                   --> EXPAND REC LENGTH OF TIME-CUTOFF-INPUT-REC        
W33304*                       FROM 90 TO 100 BYTES TO ACCOMMODATE THE  *        
W33304*                       SIMILAR EXPANSION OF INRD019.            *        
W33304*                   --> ADD NEW HEADING LINE TO DISPLAY THE CYCLE_        
W33304*                       ID, FINCL_STAT_CDE, INVENTORY NAME AND   *        
W33304*                       FINCL_STAT_CDE DESCRIPTION.              *        
W33304*                   --> ADD TINCNTL                              *        
W33304*                   --> ADD 5100-GET-CYCLE-NAME                  *        
W33304*                   --> ADD 5200-GET-FINCL-STAT-CDE-NAME         *        
W33304*                   --> ADD 2320-WRITE-SUMM-PCT-BRK              *        
W33304*                   --> ADD BREAKS BY CYCLE & FINCL STAT CDE ON  *        
W33304*                       CUM REPORTS ONLY                         *        
W33304*----------------------------------------------------------------*        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT TIME-CUTOFF-INPUT                                             
               ASSIGN TO INP01.                                                 
                                                                                
JS0600     SELECT RUN-TYPE-FILE                                                 
JS0600         ASSIGN TO INP02.                                                 
                                                                                
           SELECT INV-SLS-ADJ-REPORT                                            
               ASSIGN TO RPT01.                                                 
                                                                                
           SELECT SUMM-SLS-PCT-REPORT                                           
               ASSIGN TO RPT02.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  TIME-CUTOFF-INPUT                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
W33304 01  TIME-CUTOFF-INPUT-REC         PIC X(100).                            
                                                                                
JS0600 FD  RUN-TYPE-FILE                                                        
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  RUN-TYPE-REC                  PIC X(80).                             
                                                                                
       FD  INV-SLS-ADJ-REPORT                                                   
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  INV-SLS-ADJ-REPORT-REC        PIC X(132).                            
                                                                                
       FD  SUMM-SLS-PCT-REPORT                                                  
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  SUMM-SLS-PCT-REPORT-REC        PIC X(132).                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
JS0600 01  ABEND-4013                  PIC S9(04)  COMP SYNC                    
                                                   VALUE +4013.                 
       01  ABEND-4003                  PIC S9(04)  COMP SYNC                    
                                                   VALUE +4003.                 
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
031900     05  PV-RETRY-COUNTER           PIC S9(04) VALUE +0 COMP SYNC.        
W33304     05  PV-HOLD-INV-ID              PIC S9(09) COMP VALUE +0.            
W33304     05  PV-HOLD-FINCL-STAT-CDE      PIC  X(02) VALUE SPACE.              
W33304     05  PV-HOLD-FINCL-STAT-CDE-HLS  PIC  X(02) VALUE SPACE.              
W33304     05  PV-FINCL-STAT-NAME          PIC  X(15) VALUE SPACE.              
JS0600     05  PV-IN019-SALES-ADJ-QTY      PIC S9(07)      VALUE ZEROES.        
JS0600     05  PV-IN019-SALES-ADJ-RTL-AMT  PIC S9(10)V99   VALUE ZEROES.        
JS0600     05  PV-IN019-SALES-ADJ-QTY-P    PIC 9(07)-      VALUE ZEROES.        
JS0600     05  PV-IN019-SALES-ADJ-RTL-AMT-P PIC 9(10)V99-  VALUE ZEROES.        
           05  PV-IN019-TTL-SALES-QTY      PIC S9(07)      VALUE ZEROES         
                               COMP-3.                                          
           05  PV-IN019-TTL-RTL-SALES-AMT  PIC S9(09)V99   VALUE ZEROES         
                               COMP-3.                                          
           05  PV-IN019-RETURN-QTY         PIC S9(07)      VALUE ZEROES         
                               COMP-3.                                          
           05  PV-IN019-RETURN-RTL-AMT     PIC S9(09)V99   VALUE ZEROES         
                               COMP-3.                                          
JS0600     05  PV-TOT-SALES-ADJ-P          PIC 9(07)-    VALUE ZERO.            
JS0600     05  PV-TOT-EXTND-RETAIL-P       PIC 9(10)V99- VALUE ZERO.            
           05  PV-HOLD-CALC            PIC 9(06)V99 VALUE ZEROES.               
W26600     05  PV-DISPLAY-STR          PIC  9(05)   VALUE ZEROES.               
W26600*    05  PV-HOLD-STORE           PIC  X(03)   VALUE SPACES.               
W26600     05  PV-HOLD-STORE           PIC S9(4) COMP VALUE +0.                 
W21732     05  PV-PREV-DEPT-NBR        PIC X(04)    VALUE SPACE.                
W21732     05  PV-PREV-IN019-CL-NBR    PIC X(04)    VALUE SPACE.                
           05  PV-PREV-TIMESTMP-KEY.                                            
W26600*        10  PV-PREV-STR-NBR     PIC X(03) VALUE SPACE.                   
W26600         10  PV-PREV-STR-NBR     PIC S9(4) COMP VALUE +0.                 
W21732         10  PV-PREV-IN019-SKU   PIC X(08) VALUE SPACE.                   
           05  PV-HOLD-DATE            PIC X(04).                               
           05  PV-HOLD-DATEA REDEFINES PV-HOLD-DATE.                            
               07  PV-HOLD-MM          PIC X(02).                               
               07  PV-HOLD-DD          PIC X(02).                               
           05  PV-HOLD-TIME            PIC X(06).                               
           05  PV-HOLD-TIMEA REDEFINES PV-HOLD-TIME.                            
               07  PV-HH               PIC X(02).                               
               07  PV-MIN              PIC X(02).                               
               07  PV-SS               PIC X(02).                               
           05  PV-HOLD-DATE2           PIC X(06).                               
           05  PV-HOLD-DATEB REDEFINES PV-HOLD-DATE2.                           
               07  PV-YEAR             PIC X(02).                               
               07  PV-MONTH            PIC X(02).                               
               07  PV-DAY              PIC X(02).                               
           05  PV-PARAGRAPH-NAME       PIC  X(30).                              
           05  PV-END-OF-INPUT-SW      PIC  X(01)          VALUE 'N'.           
               88  PV-END-OF-INPUT                         VALUE 'Y'.           
               88  PV-NOT-END-OF-INPUT                     VALUE 'N'.           
JS0600     05  PV-END-OF-RUN-TYPE-SW   PIC  X(01)          VALUE 'N'.           
JS0600         88  PV-END-OF-RUN-TYPE-FILE                 VALUE 'Y'.           
JS0600         88  PV-NOT-END-OF-RUN-TYPE-FILE             VALUE 'N'.           
W33304     05  PV-FIRST-HDR-WRIT-SW    PIC  X(01)          VALUE 'N'.           
W33304         88  PV-FIRST-HDR-WRIT                       VALUE 'Y'.           
W33304         88  PV-FIRST-HDR-NOT-WRIT                   VALUE 'N'.           
                                                                                
JS0600     05  PV-OPER-ATTEMPTED       PIC X(25)           VALUE SPACES.        
           05  PV-PAGE-COUNT           PIC S9(05)   COMP-3 VALUE 0.             
           05  PV-LINE-COUNT           PIC S9(03)   COMP-3 VALUE 66.            
           05  PV2-PAGE-COUNT          PIC S9(05)   COMP-3 VALUE 0.             
           05  PV2-LINE-COUNT          PIC S9(03)   COMP-3 VALUE 66.            
           05  PV-STORE-LINE-COUNT     PIC S9(03)   COMP-3 VALUE 0.             
           05  PV-CURRENT-DATE.                                                 
               10  PV-CD-YY            PIC XX.                                  
               10  PV-CD-MM            PIC XX.                                  
               10  PV-CD-DD            PIC XX.                                  
           05  PV-CURRENT-TIME.                                                 
               10  PV-CT-HH            PIC XX.                                  
               10  PV-CT-MM            PIC XX.                                  
                                                                                
W33304 01  PS-SWITCHES.                                                         
W33304     05  PS-GRAND-ONLY-SW            PIC X       VALUE 'N'.               
W33304         88  PS-GRAND-ONLY                       VALUE 'Y'.               
W33304         88  PS-NOT-GRAND-ONLY                   VALUE 'N'.               
W33304                                                                          
       01  PA-PROGRAM-ACCUMULATORS     COMP-3.                                  
           05  PA-TOT-SCND-INV-CNT     PIC 9(07)    VALUE ZERO.                 
           05  PA-TOT-UNITS-SLD-AFTCNT PIC S9(07)   VALUE ZERO.                 
           05  PA-TOT-INVLD-STKRMW     PIC S9(07)   VALUE ZERO.                 
           05  PA-TOT-NEG-PHY-CNT-ADJ  PIC S9(07)   VALUE ZERO.                 
           05  PA-TOT-CALC-PHY-INV     PIC 9(07)    VALUE ZERO.                 
           05  PA-TOT-SALES-ADJ        PIC S9(07)   VALUE ZERO.                 
           05  PA-TOT-UNIT-RETAIL      PIC 9(07)V99 VALUE ZERO.                 
           05  PA-TOT-EXTND-RETAIL     PIC S9(10)V99 VALUE ZERO.                
           05  PA-GRD-SCND-INV-CNT     PIC 9(07)    VALUE ZERO.                 
           05  PA-GRD-UNITS-SLD-AFTCNT PIC S9(07)   VALUE ZERO.                 
           05  PA-GRD-INVLD-STKRMW     PIC S9(07)   VALUE ZERO.                 
           05  PA-GRD-NEG-PHY-CNT-ADJ  PIC S9(07)   VALUE ZERO.                 
           05  PA-GRD-CALC-PHY-INV     PIC 9(07)    VALUE ZERO.                 
           05  PA-GRD-UNIT-RETAIL      PIC 9(07)V99 VALUE ZERO.                 
           05  PA-GRD-EXTND-RETAIL     PIC S9(10)V99 VALUE ZERO.                
           05  PA-GRD-SALES-ADJ        PIC S9(07)   VALUE ZERO.                 
21015      05  PA-GRD-SLS-ADJ-RTL      PIC S9(10)V99 VALUE ZERO.                
21015      05  PA-GRD-RTL-SLS-AMT      PIC S9(10)V99 VALUE ZERO.                
W26600     05  PA-GRD-SALES-QTY        PIC S9(07)    VALUE ZERO.                
W26600     05  PA-GRD-RETURN-AMT       PIC S9(10)V99 VALUE ZERO.                
W26600     05  PA-GRD-RETURN-QTY       PIC S9(07)    VALUE ZERO.                
                                                                                
W33304*** VARIABLES USED FOR CYCLE BRK TOTALS                                   
W33304     05  PA-CYC-SALES-ADJ        PIC S9(07)   VALUE ZERO.                 
W33304     05  PA-CYC-SLS-ADJ-RTL      PIC S9(10)V99 VALUE ZERO.                
W33304     05  PA-CYC-RTL-SLS-AMT      PIC S9(10)V99 VALUE ZERO.                
W33304     05  PA-CYC-SALES-QTY        PIC S9(07)    VALUE ZERO.                
W33304     05  PA-CYC-RETURN-AMT       PIC S9(10)V99 VALUE ZERO.                
W33304     05  PA-CYC-RETURN-QTY       PIC S9(07)    VALUE ZERO.                
                                                                                
W33304*** VARIABLES USED FOR FIN STAT CODE BRK TOTALS                           
W33304     05  PA-FIN-SALES-ADJ        PIC S9(07)   VALUE ZERO.                 
W33304     05  PA-FIN-SLS-ADJ-RTL      PIC S9(10)V99 VALUE ZERO.                
W33304     05  PA-FIN-RTL-SLS-AMT      PIC S9(10)V99 VALUE ZERO.                
W33304     05  PA-FIN-SALES-QTY        PIC S9(07)    VALUE ZERO.                
W33304     05  PA-FIN-RETURN-AMT       PIC S9(10)V99 VALUE ZERO.                
W33304     05  PA-FIN-RETURN-QTY       PIC S9(07)    VALUE ZERO.                
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-MAX-RETRIES          PIC S9(4)    COMP   VALUE +3.            
           05  PC-LINE-MAX             PIC S9(3)    COMP-3 VALUE 60.            
           05  PC-STORE-LINE-MAX       PIC S9(3)    COMP-3 VALUE 40.            
           05  PC-1                    PIC X(01)    VALUE '1'.                  
           05  PC-2                    PIC X(01)    VALUE '2'.                  
           05  PC-3                    PIC X(01)    VALUE '3'.                  
           05  PC-4                    PIC X(01)    VALUE '4'.                  
           05  PC-5                    PIC X(01)    VALUE '5'.                  
           05  PC-6                    PIC X(01)    VALUE '6'.                  
           05  PC-ASTERISKS            PIC X(03)    VALUE '***'.                
           05  PC-PROGRAM-NAME         PIC X(08)    VALUE 'INKRP169'.           
W33304     05  PC-BK              PIC X(02) VALUE 'BK'.                         
W33304     05  PC-WILL-BOOK       PIC X(09) VALUE 'WILL BOOK'.                  
W33304     05  PC-BOOK-DELAYED    PIC X(15) VALUE 'BOOKING DELAYED'.            
W33304     05  PC-BD              PIC X(02) VALUE 'BD'.                         
      /                                                                         
                                                                                
      ******************************************************************        
      * INPUT SALES ADJUSTMENT DATA FILE                               *        
      ******************************************************************        
           COPY INRD019.                                                        
                                                                                
      ******************************************************************        
      * INPUT RUN TYPE CONTROL CARD                                    *        
      ******************************************************************        
       01  WS-RUN-TYPE-REC.                                                     
           05  WS-RUN-TYPE                   PIC X(07).                         
W26600         88  WS-RUN-TYPE-DAILY   VALUE 'DAY RPT'.                         
W26600         88  WS-RUN-TYPE-CUM     VALUE 'CUM RPT'.                         
W26600         88  WS-RUN-TYPE-ERROR   VALUE 'ERR RPT'.                         
           05  FILLER                        PIC X(73)    VALUE SPACES.         
                                                                                
                                                                                
       01  HL1-HEADER-LINE-1.                                                   
           05  FILLER                  PIC X(49)    VALUE SPACES.               
           05  FILLER                  PIC X(033)   VALUE                       
               'INVENTORY SALES ADJUSTMENT REPORT'.                             
           05  FILLER                  PIC X(50)    VALUE SPACES.               
                                                                                
JS0600 01  HL1-HEADER-LINE-1-CUMM.                                              
JS0600     05  FILLER                  PIC X(43)    VALUE SPACES.               
JS0600     05  FILLER                  PIC X(046)   VALUE                       
JS0600         'INVENTORY SALES ADJUSTMENT REPORT - CUMULATIVE'.                
JS0600     05  FILLER                  PIC X(50)    VALUE SPACES.               
                                                                                
JS0600 01  HL1-HEADER-LINE-1-ERROR.                                             
JS0600     05  FILLER                  PIC X(42)    VALUE SPACES.               
JS0600     05  FILLER                  PIC X(048)   VALUE                       
JS0600         'INVENTORY SALES ADJUSTMENT REPORT - ERROR REPORT'.              
JS0600     05  FILLER                  PIC X(50)    VALUE SPACES.               
                                                                                
W33304 01  HL1-HEADING-LINE-1-CYCLE.                                            
W33304     05  FILLER                  PIC X(01)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(08)    VALUE                       
W33304         'CYCLE:  '.                                                      
W33304     05  HL1-CYCLE               PIC 9(05)    VALUE ZEROES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  HL1-FINCL-STAT-CDE      PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(26)    VALUE SPACES.               
W33304     05  HL1-CYCLE-NAME          PIC X(22)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  HL1-CYCLE-STAT-NAME     PIC X(65)    VALUE SPACES.               
                                                                                
       01  HL2-HEADING-LINE-2.                                                  
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(08)    VALUE                       
               'STORE:  '.                                                      
W26600     05  HL2-STORE               PIC 9(05)    VALUE ZEROES.               
W26600*    05  HL2-STORE               PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  HL2-STORE-NAME          PIC X(10)    VALUE SPACES.               
           05  FILLER                  PIC X(107)   VALUE SPACES.               
                                                                                
       01  HL3-HEADING-LINE-3A.                                                 
           05  FILLER                  PIC X(35)    VALUE SPACES.               
           05  FILLER                  PIC X(10)    VALUE                       
               'FIRST SALE'.                                                    
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE                       
               'SCANNED'.                                                       
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'UNITS'.                                                         
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(08)    VALUE                       
               'INVALIDS'.                                                      
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(08)    VALUE                       
               'NEGATIVE'.                                                      
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE                       
               'CALC'.                                                          
           05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE                       
               'UNIT'.                                                          
           05  FILLER                  PIC X(08)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE                       
               'UNIT'.                                                          
           05  FILLER                  PIC X(12)    VALUE SPACES.               
           05  FILLER                  PIC X(08)    VALUE                       
               'EXTENDED'.                                                      
                                                                                
       01  HL3-HEADING-LINE-3B.                                                 
           05  FILLER                  PIC X(01)    VALUE SPACES.               
W21732     05  FILLER                  PIC X(03)    VALUE                       
W21732         'SKU'.                                                           
W21732     05  FILLER                  PIC X(08)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'AREA  '.                                                        
           05  FILLER                  PIC X(01)    VALUE SPACE.                
           05  FILLER                  PIC X(09)    VALUE                       
               'INVENTORY'.                                                     
           05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'AFTER'.                                                         
           05  FILLER                  PIC X(10)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE                       
               'PHY INV'.                                                       
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE                       
               'SOLD'.                                                          
           05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE                       
               '&'.                                                             
           05  FILLER                  PIC X(08)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE                       
               'PHY CNT'.                                                       
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'PHYSCL'.                                                        
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'SALES'.                                                         
           05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(10)    VALUE                       
               'RETAIL AMT'.                                                    
           05  FILLER                  PIC X(06)    VALUE SPACES.               
           05  FILLER                  PIC X(10)    VALUE                       
               'RETAIL AMT'.                                                    
                                                                                
       01  HL3-HEADING-LINE-3C.                                                 
           05  FILLER                  PIC X(12)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'NUMBER'.                                                        
           05  FILLER                  PIC X(01)    VALUE SPACE.                
           05  FILLER                  PIC X(09)    VALUE                       
               'TIMESTAMP'.                                                     
           05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(10)    VALUE                       
               'LAST COUNT'.                                                    
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'COUNT'.                                                         
           05  FILLER                  PIC X(04)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'AFTER'.                                                         
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'STKRMW'.                                                        
           05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'ADJUST'.                                                        
           05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(03)    VALUE                       
               'INV'.                                                           
           05  FILLER                  PIC X(04)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE                       
               'ADJUST'.                                                        
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(14)    VALUE                       
               '(SALES ADJUST)'.                                                
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(14)    VALUE                       
               '(SALES ADJUST)'.                                                
                                                                                
       01  HL3-HEADING-LINE-3D.                                                 
           05  FILLER                  PIC X(59)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE                       
               'COUNT'.                                                         
           05  FILLER                  PIC X(69)    VALUE SPACES.               
                                                                                
       01  TT1-TOTAL-LINE-1.                                                    
           05  FILLER                  PIC X(50)    VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE '------'.             
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE '-------'.            
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE '-------'.            
           05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE '------'.             
           05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  FILLER                  PIC X(06)    VALUE '------'.             
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE '-------'.            
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(09)    VALUE '---------'.          
           05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  FILLER                  PIC X(12) VALUE '------------'.          
           05  FILLER                  PIC X(03)    VALUE SPACES.               
                                                                                
W26600 01  TT1-TOTAL-ERR-LINE-1.                                                
W26600     05  FILLER                  PIC X(28)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(10)    VALUE '***  STORE'.         
W26600     05  FILLER                  PIC X(01)    VALUE SPACES.               
W26600     05  TT-ERR-STORE-NBR        PIC 9(05)    VALUE ZEROES.               
W26600     05  FILLER                  PIC X(01)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(60)    VALUE SPACES.               
W26600         88  TT-ERR-MISSING-INV-DATA          VALUE                       
W26600             'IS MISSING INVENTORY DATA  ***'.                            
W26600         88  TT-ERR-MISSING-TOTAL             VALUE                       
W26600             'IS MISSING SALES TOTAL  ***'.                               
W26600     05  FILLER                  PIC X(27)    VALUE SPACES.               
                                                                                
       01  TT1-TOTAL-LINE-2.                                                    
W26600*    05  FILLER                  PIC X(35)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(33)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE 'STORE'.              
           05  FILLER                  PIC X(1)     VALUE SPACE.                
W26600*    05  TT-STORE-NUM            PIC X(03)    VALUE SPACES.               
W26600     05  TT-STORE-NUM            PIC 9(05)    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACE.                
           05  FILLER                  PIC X(03)    VALUE 'TTL'.                
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TT-SCN-PHY-INV-CNT      PIC ZZZZZ9   VALUE SPACES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TT-UNIT-SLD-AFT-CNT     PIC ZZZZZ9-  VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  TT-INVLD-STKRMW         PIC ZZZZZ9-  VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  TT-NEG-PHY-CNT-ADJ      PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  TT-CALC-PHY-INV         PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  TT-SALES-ADJ            PIC ZZZ,ZZ9-  VALUE ZEROES.              
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  TT-UNIT-RETAIL          PIC $,$$$,$$9.99 VALUE ZEROES.           
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  TT-EXT-RETAIL       PIC $,$$$,$$$,$$9.99- VALUE ZEROES.          
                                                                                
       01  TT1-TOTAL-LINE-2B.                                                   
W26600*    05  FILLER                  PIC X(35)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(33)    VALUE SPACES.               
           05  FILLER                  PIC X(05)    VALUE 'STORE'.              
           05  FILLER                  PIC X(1)     VALUE SPACE.                
W26600*    05  TT-TTL-STR-NBR-2B       PIC X(03)    VALUE SPACES.               
W26600     05  TT-TTL-STR-NBR-2B       PIC 9(05)    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACE.                
           05  FILLER                  PIC X(24)    VALUE                       
               'TTL SALES AT FULL RETAIL'.                                      
           05  FILLER                  PIC X(22)    VALUE SPACES.               
W26600     05  TT-STR-TTL-SLS-QTY      PIC ZZZ,ZZ9-  VALUE ZEROES.              
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE SPACES.               
           05  FILLER                  PIC X(02)    VALUE SPACES.               
W26600     05  TT-STR-TTL-SLS-RTL    PIC $,$$$,$$$,$$9.99- VALUE ZEROES.        
                                                                                
W26600 01  TT1-TOTAL-LINE-2C.                                                   
W26600     05  FILLER                  PIC X(33)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(05)    VALUE 'STORE'.              
W26600     05  FILLER                  PIC X(1)     VALUE SPACE.                
W26600     05  TT-TTL-STR-NBR-2C       PIC 9(05)    VALUE ZEROES.               
W26600     05  FILLER                  PIC X(1)     VALUE SPACE.                
W26600     05  FILLER                  PIC X(24)    VALUE                       
W26600         'TTL RETURNS             '.                                      
W26600     05  FILLER                  PIC X(22)    VALUE SPACES.               
W26600     05  TT-STR-TTL-RETURN-QTY   PIC ZZZ,ZZ9-  VALUE ZEROES.              
W26600     05  FILLER                  PIC X(01)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(12)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(02)    VALUE SPACES.               
W26600     05  TT-STR-TTL-RETURN-AMT PIC $,$$$,$$$,$$9.99- VALUE ZEROES.        
                                                                                
W2660  01  TT1-TOTAL-LINE-2D.                                                   
W26600*    05  FILLER                  PIC X(29)    VALUE SPACES.               
W26600     05  FILLER                  PIC X(27)    VALUE SPACES.               
           05  FILLER                  PIC X(46)    VALUE                       
               '      * * * *    RETAIL SALES ADJUSTMENTS FOR'.                 
           05  FILLER                  PIC X(05)    VALUE 'STORE'.              
           05  FILLER                  PIC X(1)     VALUE SPACE.                
W26600*    05  TT-TTL-STR-NBR-2D       PIC X(03)    VALUE SPACES.               
W26600     05  TT-TTL-STR-NBR-2D       PIC 9(05)    VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACE.                
           05  FILLER                  PIC X(04)    VALUE                       
               'ARE '.                                                          
21015      05  TT-PERCENT              PIC ZZ9.99   VALUE ZEROES.               
           05  FILLER                  PIC X(36)    VALUE                       
               '% OF TOTAL RETAIL SALES     * * * * '.                          
                                                                                
       01  TT1-TOTAL-LINE-3.                                                    
           05  FILLER                  PIC X(35)    VALUE                       
               '                 SALES ADJUSTMENTS'.                            
           05  FILLER                  PIC X(11)    VALUE                       
               'GRAND TOTAL'.                                                   
           05  FILLER                  PIC X(4)     VALUE SPACES.               
           05  GT-SCN-PHY-INV-CNT      PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  GT-UNIT-SLD-AFT-CNT     PIC ZZZZZ9-  VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  GT-INVLD-STKRMW         PIC ZZZZZ9-  VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  GT-NEG-PHY-CNT-ADJ      PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  GT-CALC-PHY-INV         PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  GT-SALES-ADJ            PIC ZZZ,ZZ9-  VALUE ZEROES.              
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  GT-UNIT-RETAIL          PIC $,$$$,$$9.99 VALUE ZEROES.           
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  GT-EXT-RETAIL         PIC $,$$$,$$$,$$9.99- VALUE ZEROES.        
                                                                                
       01  DL-DETAIL-LINE.                                                      
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  DL-ITEM-NUM.                                                     
W21732         07  DL-SKU              PIC X(08)    VALUE SPACES.               
W21732     05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  DL-AREA-NUM             PIC X(06)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  DL-INV-TIMESTAMP.                                                
               07  DL-MM               PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE '/'.                  
               07  DL-DD               PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE SPACE.                
               07  DL-HH               PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE ':'.                  
               07  DL-MIN              PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE ':'.                  
               07  DL-SS               PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  DL-SALE-AFT-LST-CNT.                                             
               07  DL-MM-AFT           PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE '/'.                  
               07  DL-DD-AFT           PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE SPACE.                
               07  DL-HH-AFT           PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE ':'.                  
               07  DL-MIN-AFT          PIC X(02)    VALUE SPACES.               
               07  FILLER              PIC X(01)    VALUE ':'.                  
               07  DL-SS-AFT           PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  DL-SCN-PHY-INV-CNT      PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  DL-UNIT-SLD-AFT-CNT     PIC ZZZZZ9-  VALUE ZEROES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  DL-INVLD-STKRMW         PIC ZZZZZ9-  VALUE ZEROES.               
           05  FILLER                  PIC X(2)     VALUE SPACES.               
           05  DL-NEG-PHY-CNT-ADJ      PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(3)     VALUE SPACES.               
           05  DL-CALC-PHY-INV         PIC ZZZZZ9   VALUE ZEROES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  DL-SALES-ADJ            PIC ZZZ,ZZ9-  VALUE ZEROES.              
           05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  DL-UNIT-RETAIL          PIC ZZZ,ZZ9.99 VALUE ZEROES.             
           05  FILLER                  PIC X(04)    VALUE SPACES.               
           05  DL-EXT-RETAIL           PIC ZZZ,ZZZ,ZZ9.99- VALUE ZEROES.        
           05  FILLER                  PIC X(03)    VALUE SPACES.               
                                                                                
       01  HLS-HEADER-LINE-1.                                                   
           05  FILLER                  PIC X(49)    VALUE SPACES.               
           05  FILLER                  PIC X(034)   VALUE                       
               'SUMMARIZED SALES PERCENT REPORT   '.                            
           05  FILLER                  PIC X(50)    VALUE SPACES.               
                                                                                
JS0600 01  HLS-HEADER-LINE-1-CUMM.                                              
JS0600     05  FILLER                  PIC X(43)    VALUE SPACES.               
JS0600     05  FILLER                  PIC X(046)   VALUE                       
JS0600         'SUMMARIZED SALES PERCENT REPORT - CUMULATIVE  '.                
JS0600     05  FILLER                  PIC X(50)    VALUE SPACES.               
                                                                                
JS0600 01  HLS-HEADER-LINE-1-ERROR.                                             
JS0600     05  FILLER                  PIC X(43)    VALUE SPACES.               
JS0600     05  FILLER                  PIC X(046)   VALUE                       
JS0600         'SUMMARIZED SALES PERCENT REPORT - ERROR       '.                
JS0600     05  FILLER                  PIC X(50)    VALUE SPACES.               
                                                                                
W33304 01  HLS-HEADING-LINE-1-CYCLE.                                            
W33304     05  FILLER                  PIC X(01)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(08)    VALUE                       
W33304         'CYCLE:  '.                                                      
W33304     05  HLS-CYCLE               PIC 9(05)    VALUE ZEROES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  HLS-FINCL-STAT-CDE      PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(26)    VALUE SPACES.               
W33304     05  HLS-CYCLE-NAME          PIC X(22)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  HLS-CYCLE-STAT-NAME     PIC X(65)    VALUE SPACES.               
W33304                                                                          
W33304 01  HLS-FIN-STAT-BRK-LINE.                                               
W33304     05  FILLER                  PIC X(01)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(08)    VALUE                       
W33304         'CYCLE:  '.                                                      
W33304     05  HLS-FIN-CYCLE           PIC 9(05)    VALUE ZEROES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  HLS-FIN-FINCL-STAT-CDE  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(05) VALUE                          
W33304         'TOTAL'.                                                         
W33304     05  FILLER                  PIC X(19)    VALUE SPACES.               
W33304     05  HLS-FIN-CYCLE-NAME      PIC X(22)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  HLS-FIN-CYCLE-STAT-NAME PIC X(65)    VALUE SPACES.               
W33304                                                                          
W33304 01  HLS-CYCLE-BRK-LINE.                                                  
W33304     05  FILLER                  PIC X(01)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(08)    VALUE                       
W33304         'CYCLE:  '.                                                      
W33304     05  HLS-CYCLE-ID-BRK        PIC 9(05)    VALUE ZEROES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(05)    VALUE                       
W33304         'TOTAL'.                                                         
W33304     05  FILLER                  PIC X(19)    VALUE SPACES.               
W33304     05  HLS-CYCLE-NAME-BRK      PIC X(22)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(65)    VALUE SPACES.               
W33304                                                                          
       01  HLS-HEADING-LINE-2.                                                  
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(02)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(08)    VALUE                        
W26600         'ACTL INV'.                                                      
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(27)    VALUE                        
W26600         ' NET SALES AT FULL RETAIL  '.                                   
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(27)    VALUE                        
W26600         '       TOTAL RETURNS       '.                                   
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(29)    VALUE                        
W26600         '       SALES ADJUSTMENTS     '.                                 
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(06)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(04)    VALUE SPACES.                
                                                                                
W33304 01  HLS-HEADING-LINE-2-SUM.                                              
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(16)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(08)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(27)    VALUE                        
W33304         ' NET SALES AT FULL RETAIL  '.                                   
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(27)    VALUE                        
W33304         '       TOTAL RETURNS       '.                                   
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(29)    VALUE                        
W33304         '       SALES ADJUSTMENTS     '.                                 
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(06)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(04)    VALUE SPACES.                
                                                                                
       01  HLS-HEADING-LINE-3.                                                  
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE                        
W26600         'STORE'.                                                         
W26600     05  FILLER                 PIC X(02)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(08)    VALUE                        
W26600         '  DATE  '.                                                      
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(10)    VALUE                        
W26600         '    UNITS '.                                                    
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE                        
W26600         '         RETAIL '.                                              
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(10)    VALUE                        
W26600         '    UNITS '.                                                    
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE                        
W26600         '         RETAIL '.                                              
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(12)    VALUE                        
W26600         '      UNITS '.                                                  
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE                        
W26600         '         RETAIL '.                                              
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(06)    VALUE '  PCT '.              
W26600     05  FILLER                 PIC X(04)    VALUE SPACES.                
                                                                                
W33304 01  HLS-HEADING-LINE-3-SUM.                                              
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(16)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(08)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(10)    VALUE                        
W33304         '    UNITS '.                                                    
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(16)    VALUE                        
W33304         '         RETAIL '.                                              
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(10)    VALUE                        
W33304         '    UNITS '.                                                    
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(16)    VALUE                        
W33304         '         RETAIL '.                                              
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(12)    VALUE                        
W33304         '      UNITS '.                                                  
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(16)    VALUE                        
W33304         '         RETAIL '.                                              
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(06)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(04)    VALUE SPACES.                
                                                                                
       01  HLS-HEADING-LINE-DASHES.                                             
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(02)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(08)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(27)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(27)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(29)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(07)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
                                                                                
       01  DLS-DETAIL-LINE.                                                     
           05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600*    05  DLS-TTL-STR-NBR        PIC X(03)    VALUE SPACES.                
W26600     05  DLS-TTL-STR-NBR        PIC 9(05)    VALUE ZEROES.                
           05  FILLER                 PIC X(01)    VALUE SPACES.                
           05  DLS-STORE-NAME         PIC X(10)    VALUE SPACES.                
           05  FILLER                 PIC X(02)    VALUE SPACES.                
           05  DLS-ACTL-INV-MM        PIC X(02)    VALUE SPACES.                
           05  FILLER                 PIC X(01)    VALUE '/'.                   
           05  DLS-ACTL-INV-DD        PIC X(02)    VALUE SPACES.                
           05  FILLER                 PIC X(01)    VALUE '/'.                   
           05  DLS-ACTL-INV-YY        PIC X(02)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
           05  DLS-STR-TTL-UNT-SLS    PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
           05  DLS-STR-TTL-RTL-SLS-AMT                                          
                                      PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  DLS-STR-TTL-RETURN-QTY PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  DLS-STR-TTL-RETURN-AMT PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
           05  DLS-STR-SALES-ADJ-QTY  PIC ZZZ,ZZZ,ZZ9- VALUE ZEROES.            
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
           05  DLS-STR-SALES-ADJ-RTL-AMT                                        
                                      PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
           05  DLS-PERCENT            PIC ZZ9.99   VALUE ZEROES.                
W26600     05  FILLER                 PIC X(04)    VALUE '%'.                   
                                                                                
W33304 01  TLS-CYCLE-LINE.                                                      
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(05)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(10)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(01)    VALUE SPACE.                 
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(01)    VALUE SPACE.                 
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  TLS-CYC-TTL-UNT-SLS    PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  TLS-CYC-TTL-RTL-SLS-AMT                                          
W33304                                PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  TLS-CYC-TTL-RETURN-QTY PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  TLS-CYC-TTL-RETURN-AMT PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  TLS-CYC-SALES-ADJ-QTY  PIC ZZZ,ZZZ,ZZ9- VALUE ZEROES.            
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  TLS-CYC-SALES-ADJ-RTL-AMT                                        
W33304                                PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W33304     05  FILLER                 PIC X(13)    VALUE SPACES.                
W33304                                                                          
W33304 01  TLS-FIN-STAT-LINE.                                                   
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(05)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(10)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(01)    VALUE SPACE.                 
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(01)    VALUE SPACE.                 
W33304     05  FILLER                 PIC X(02)    VALUE SPACES.                
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  TLS-FIN-TTL-UNT-SLS    PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  TLS-FIN-TTL-RTL-SLS-AMT                                          
W33304                                PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  TLS-FIN-TTL-RETURN-QTY PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  TLS-FIN-TTL-RETURN-AMT PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W33304     05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304     05  TLS-FIN-SALES-ADJ-QTY  PIC ZZZ,ZZZ,ZZ9- VALUE ZEROES.            
W33304     05  FILLER                 PIC X(01)    VALUE SPACES.                
W33304     05  TLS-FIN-SALES-ADJ-RTL-AMT                                        
W33304                                PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W33304     05  FILLER                 PIC X(13)    VALUE SPACES.                
                                                                                
W33304 01  TLS-CYCLE-99999.                                                     
W33304     05  FILLER                  PIC X(01)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(08)    VALUE                       
W33304         'CYCLE:  '.                                                      
W33304     05  FILLER                  PIC 9(05)    VALUE 99999.                
W33304     05  FILLER                  PIC X(119)   VALUE SPACES.               
W33304                                                                          
21015  01  TLS-TOTAL-LINE-1.                                                    
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(02)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(08)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(10)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(10)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(12)    VALUE ALL '-'.               
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE ALL '-'.               
W33304*    05  FILLER                 PIC X(03)    VALUE SPACES.                
W33304*    05  FILLER                 PIC X(07)    VALUE ALL '-'.               
W33304*    05  FILLER                 PIC X(03)    VALUE SPACES.                
                                                                                
       01  TLS-TOTAL-LINE-2.                                                    
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(16)    VALUE                        
W26600         'REPORT SUMMARY'.                                                
W26600     05  FILLER                 PIC X(02)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(08)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  TLS-STR-TTL-UNT-SLS    PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  TLS-STR-TTL-RTL-SLS-AMT                                          
W26600                                PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  TLS-STR-TTL-RETURN-QTY PIC Z,ZZZ,ZZ9- VALUE ZEROES.              
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  TLS-STR-TTL-RETURN-AMT PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  TLS-STR-SALES-ADJ-QTY  PIC ZZZ,ZZZ,ZZ9- VALUE ZEROES.            
W26600     05  FILLER                 PIC X(01)    VALUE SPACES.                
W26600     05  TLS-STR-SALES-ADJ-RTL-AMT                                        
W26600                                PIC $$$$,$$$,$$9.99- VALUE ZEROES.        
W26600     05  FILLER                 PIC X(03)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(06)    VALUE SPACES.                
W26600     05  FILLER                 PIC X(04)    VALUE SPACES.                
                                                                                
W33304 01  TLS-GRAND-TOTAL-LINE.                                                
W33304     05  FILLER                  PIC X(01)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(08)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(05)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(26)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(11)    VALUE                       
W33304         'GRAND TOTAL'.                                                   
W33304     05  FILLER                  PIC X(02)    VALUE SPACES.               
W33304     05  FILLER                  PIC X(76)    VALUE SPACES.               
                                                                                
W33304 01  TLS-BLANK-LINE              PIC X(133)   VALUE SPACES.               
      *-----------------------------------------------------------------        
      * COPYBOOK FOR REMAINING REPORT HEADING LINES, DETAIL LINE                
      *-----------------------------------------------------------------        
                                                                                
           COPY DPWS132O.                                                       
                                                                                
      *****************************************************************         
      *  SQL ABEND ROUTINE WORKING STORAGE                                      
      *****************************************************************         
                                                                                
           COPY DPWS004.                                                        
                                                                                
      *****************************************************************         
      * DB2 STORE TABLE DCLGEN.                                                 
      *****************************************************************         
W33304******************************************************************        
W33304*  TINCNTL - INVENTORY CONTROL TABLE                                      
W33304******************************************************************        
W33304     EXEC SQL                                                             
W33304         INCLUDE TINCNTL                                                  
W33304     END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  XMT LOC TABLE DESCRIPTION                                              
      ******************************************************************        
W26600     EXEC SQL                                                             
W26600         INCLUDE XMT00001                                                 
W26600     END-EXEC.                                                            
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
           EJECT                                                                
                                                                                
       LINKAGE SECTION.                                                         
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       1000-MAIN-MODULE.                                                        
                                                                                
           PERFORM 1100-HOUSEKEEPING.                                           
                                                                                
JS0600     IF PV-END-OF-INPUT                                                   
JS0600         DISPLAY '**------------------------------*'                      
JS0600         DISPLAY '* INPUT SALE ADJUSTMENT FILE IS EMPTY'                  
JS0600         DISPLAY '**------------------------------*'                      
JS0600     ELSE                                                                 
               PERFORM 2310-WRITE-HEADER                                        
               PERFORM 2000-PROCESS-INPUT                                       
                   UNTIL PV-END-OF-INPUT                                        
               PERFORM 2250-PRINT-TOTAL                                         
               PERFORM 2400-GRAND-TOTALS                                        
           END-IF.                                                              
                                                                                
           PERFORM 1200-EOJ.                                                    
                                                                                
           GOBACK.                                                              
      /                                                                         
      *----------------------------------------------------------------*        
      *                                                                *        
      *    OPEN THE FILES, GET THE FIRST RECORD AND SAVE THE KEYS.     *        
      *                                                                *        
      *----------------------------------------------------------------*        
                                                                                
       1100-HOUSEKEEPING.                                                       
                                                                                
           OPEN  INPUT TIME-CUTOFF-INPUT                                        
                 INPUT RUN-TYPE-FILE                                            
                OUTPUT INV-SLS-ADJ-REPORT                                       
                OUTPUT SUMM-SLS-PCT-REPORT.                                     
                                                                                
           ACCEPT PV-CURRENT-DATE    FROM  DATE.                                
           ACCEPT PV-CURRENT-TIME    FROM  TIME.                                
                                                                                
           MOVE PV-CD-MM               TO  DP132O-RUN-MONTH.                    
           MOVE PV-CD-DD               TO  DP132O-RUN-DAY.                      
           MOVE PV-CD-YY               TO  DP132O-RUN-YEAR.                     
                                                                                
           MOVE PV-CT-HH               TO  DP132O-RUN-HOUR.                     
           MOVE PV-CT-MM               TO  DP132O-RUN-MINUTE.                   
           MOVE PC-PROGRAM-NAME        TO  DP132O-PROGRAM-NAME.                 
                                                                                
W33304     SET PV-FIRST-HDR-NOT-WRIT   TO TRUE.                                 
                                                                                
           PERFORM 2100-READ-INPUT.                                             
VLY        MOVE IN019-STR-NBR      TO PV-HOLD-STORE.                            
W33304     MOVE IN019-INV-ID             TO PV-HOLD-INV-ID.                     
W33304     MOVE IN019-FINCL-INV-STAT-CDE TO PV-HOLD-FINCL-STAT-CDE.             
                                                                                
VLY        PERFORM 5000-GET-STORE-NAME.                                         
W33304     PERFORM 5100-GET-CYCLE-NAME.                                         
                                                                                
           PERFORM 2110-READ-RUN-TYPE-FILE.                                     
           IF PV-END-OF-RUN-TYPE-FILE                                           
               DISPLAY '**************************************'                 
               DISPLAY '* INPUT RUN-TYPE-FILE IS EMPTY'                         
               DISPLAY '**************************************'                 
               PERFORM 9999-ABEND                                               
           ELSE                                                                 
               DISPLAY '**************************************'                 
               DISPLAY '* INPUT RUN-TYPE-FILE: ' WS-RUN-TYPE                    
               DISPLAY '**************************************'                 
W26600         IF WS-RUN-TYPE-DAILY OR                                          
W26600            WS-RUN-TYPE-CUM OR                                            
W26600            WS-RUN-TYPE-ERROR                                             
                   CONTINUE                                                     
               ELSE                                                             
                   DISPLAY '* INVALID RUN-TYPE-FILE'                            
                   DISPLAY '**************************************'             
                   PERFORM 9999-ABEND                                           
               END-IF                                                           
           END-IF.                                                              
W33304        MOVE ZEROES TO PA-CYC-SALES-QTY                                   
W33304                       PA-FIN-SALES-QTY                                   
W33304                       TLS-CYC-TTL-UNT-SLS                                
W33304                       TLS-FIN-TTL-UNT-SLS                                
W33304                       PA-CYC-RTL-SLS-AMT                                 
W33304                       PA-FIN-RTL-SLS-AMT                                 
W33304                       TLS-CYC-TTL-RTL-SLS-AMT                            
W33304                       TLS-FIN-TTL-RTL-SLS-AMT                            
W33304                       PA-CYC-RETURN-QTY                                  
W33304                       PA-FIN-RETURN-QTY                                  
W33304                       TLS-CYC-TTL-RETURN-QTY                             
W33304                       TLS-FIN-TTL-RETURN-QTY                             
W33304                       PA-CYC-RETURN-AMT                                  
W33304                       PA-FIN-RETURN-AMT                                  
W33304                       TLS-CYC-TTL-RETURN-AMT                             
W33304                       TLS-FIN-TTL-RETURN-AMT                             
W33304                       PA-CYC-SALES-ADJ                                   
W33304                       PA-FIN-SALES-ADJ                                   
W33304                       TLS-CYC-SALES-ADJ-QTY                              
W33304                       TLS-FIN-SALES-ADJ-QTY                              
W33304                       PA-CYC-SLS-ADJ-RTL                                 
W33304                       PA-FIN-SLS-ADJ-RTL                                 
W33304                       TLS-CYC-SALES-ADJ-RTL-AMT                          
W33304                       TLS-FIN-SALES-ADJ-RTL-AMT.                         
W33304                                                                          
      *----------------------------------------------------------------*        
      *                                                                *        
      *    HANDLE THE TOTAL LINE AND CLOSE THE FILES.                  *        
      *                                                                *        
      *----------------------------------------------------------------*        
                                                                                
       1200-EOJ.                                                                
                                                                                
                                                                                
           CLOSE TIME-CUTOFF-INPUT                                              
                 RUN-TYPE-FILE                                                  
                 INV-SLS-ADJ-REPORT                                             
                 SUMM-SLS-PCT-REPORT.                                           
      /                                                                         
      *----------------------------------------------------------------*        
      *                                                                *        
      *    FOR EACH STORE, PROCESS THE TIMESTAMP CUTOFF RECORD         *        
      *    INPUT FILE FOR EACH ITEM.                                   *        
      *                                                                *        
      *----------------------------------------------------------------*        
                                                                                
       2000-PROCESS-INPUT.                                                      
W33304* NOTE: ADDED THE IF LOGIC TO ONLY BREAK ON CYCLE/FINCL_STAT_CDE          
W33304* FOR THE CUMULATIVE REPORTS, DAILY PROCESSING STAYS THE SAME             
W33304* THOUGH THE NEW HL1-HEADING-LINE-1-CYCLE SHOULD DISPLAY FOR BOTH         
W33304* CUM AND NON CUM REPORTS                                                 
           IF WS-RUN-TYPE-CUM                                                   
W33304        EVALUATE TRUE                                                     
W33304*  NO BREAK PRINT SKU LINE                                                
W33304          WHEN IN019-INV-ID = PV-HOLD-INV-ID                              
W33304           AND IN019-STR-NBR = PV-HOLD-STORE                              
W33304           AND IN019-FINCL-INV-STAT-CDE = PV-HOLD-FINCL-STAT-CDE          
W33304                                                                          
W33304               PERFORM 2200-PRINT                                         
W33304                                                                          
W33304*  BREAK ON STORE WITHIN CYCLE-ID & WITHIN FINCL STAT CDE                 
W33304          WHEN IN019-INV-ID = PV-HOLD-INV-ID                              
W33304           AND IN019-STR-NBR NOT = PV-HOLD-STORE                          
W33304           AND IN019-FINCL-INV-STAT-CDE = PV-HOLD-FINCL-STAT-CDE          
W33304               PERFORM 2250-PRINT-TOTAL                                   
W33304               PERFORM 5000-GET-STORE-NAME                                
W33304                                                                          
W33304*BREAK ON FINCL STAT CDE  (IN A CYCLE)                                    
W33304               PERFORM 2330-WRITE-STAT-CDE-BRK                            
W33304               IF HLS-FINCL-STAT-CDE       NOT =                          
W33304                                 PV-HOLD-FINCL-STAT-CDE                   
W33304               PERFORM 2320-WRITE-SUMM-PCT-BRK                            
W33304                  MOVE SPACE TO HLS-FINCL-STAT-CDE                        
W33304               END-IF                                                     
W33304               PERFORM 2200-PRINT                                         
W33304                                                                          
W33304*BREAK ON STORE WITHIN CYCLE-ID & OUTSIDE FINCL STAT CDE                  
W33304          WHEN IN019-INV-ID = PV-HOLD-INV-ID                              
W33304           AND IN019-STR-NBR NOT = PV-HOLD-STORE                          
W33304           AND IN019-FINCL-INV-STAT-CDE NOT =                             
W33304                                          PV-HOLD-FINCL-STAT-CDE          
W33304               MOVE PV-HOLD-INV-ID     TO HLS-FIN-CYCLE                   
W33304               MOVE PV-HOLD-FINCL-STAT-CDE                                
W33304                                       TO HLS-FIN-FINCL-STAT-CDE          
W33304               MOVE INCNTL-INV-NM-TEXT TO HLS-FIN-CYCLE-NAME              
W33304               MOVE HLS-CYCLE-STAT-NAME TO HLS-FIN-CYCLE-STAT-NAME        
W33304                                                                          
W33304               PERFORM 2250-PRINT-TOTAL                                   
W33304               PERFORM 5000-GET-STORE-NAME                                
W33304               PERFORM 5200-GET-FINCL-STAT-CDE-NAME                       
W33304               PERFORM 2310-WRITE-HEADER                                  
W33304                                                                          
W33304*BREAK ON FINCL STAT CDE  (DIFF STAT CODE IN SAME CYCLE)                  
W33304               PERFORM 2330-WRITE-STAT-CDE-BRK                            
W33304               PERFORM 2320-WRITE-SUMM-PCT-BRK                            
W33304               PERFORM 2200-PRINT                                         
W33304                                                                          
W33304*  BREAK ON CYCLE-ID                                                      
W33304          WHEN IN019-INV-ID NOT = PV-HOLD-INV-ID                          
W33304                                                                          
W33304               MOVE PV-HOLD-INV-ID     TO HLS-CYCLE-ID-BRK                
W33304               MOVE INCNTL-INV-NM-TEXT TO HLS-CYCLE-NAME-BRK              
W33304                                                                          
W33304                                                                          
W33304               MOVE PV-HOLD-INV-ID     TO HLS-FIN-CYCLE                   
W33304               MOVE PV-HOLD-FINCL-STAT-CDE                                
W33304                                       TO HLS-FIN-FINCL-STAT-CDE          
W33304               MOVE INCNTL-INV-NM-TEXT TO HLS-FIN-CYCLE-NAME              
W33304               MOVE HL1-CYCLE-STAT-NAME TO HLS-FIN-CYCLE-STAT-NAME        
W33304                                                                          
W33304               PERFORM 2250-PRINT-TOTAL                                   
W33304               PERFORM 5000-GET-STORE-NAME                                
W33304               PERFORM 5100-GET-CYCLE-NAME                                
W33304               PERFORM 2310-WRITE-HEADER                                  
W33304                                                                          
W33304               PERFORM 2330-WRITE-STAT-CDE-BRK                            
W33304               PERFORM 2340-WRITE-CYCLE-BRK                               
W33304               PERFORM 2320-WRITE-SUMM-PCT-BRK                            
W33304               PERFORM 2200-PRINT                                         
W33304                                                                          
W33304        END-EVALUATE                                                      
W33304     ELSE                                                                 
W33304** THESE ARE THE DAILY REPORTS BELOW                                      
W33304        IF  IN019-STR-NBR = PV-HOLD-STORE                                 
                  PERFORM 2200-PRINT                                            
              ELSE                                                              
                  PERFORM 2250-PRINT-TOTAL                                      
VLY               PERFORM 5000-GET-STORE-NAME                                   
W33304            PERFORM 5100-GET-CYCLE-NAME                                   
W33304            PERFORM 5200-GET-FINCL-STAT-CDE-NAME                          
      *           PERFORM 2320-WRITE-STORE-BREAK                                
                  PERFORM 2310-WRITE-HEADER                                     
                  PERFORM 2200-PRINT                                            
              END-IF                                                            
W33304     END-IF.                                                              
                                                                                
           PERFORM 2100-READ-INPUT.                                             
      /                                                                         
      *----------------------------------------------------------------*        
      *                                                                *        
      *    READ THE INPUT FILE.                                        *        
      *                                                                *        
      *----------------------------------------------------------------*        
                                                                                
       2100-READ-INPUT.                                                         
                                                                                
W33304     INITIALIZE IN019-ITEM-REC.                                           
W33304                                                                          
           READ TIME-CUTOFF-INPUT INTO IN019-ITEM-REC                           
                AT END                                                          
                SET PV-END-OF-INPUT TO TRUE                                     
           END-READ.                                                            
      /                                                                         
      *----------------------------------------------------------------*        
      *                                                                *        
      *    READ THE INPUT FILE.                                        *        
      *                                                                *        
      *----------------------------------------------------------------*        
                                                                                
       2110-READ-RUN-TYPE-FILE.                                                 
                                                                                
           READ RUN-TYPE-FILE INTO WS-RUN-TYPE-REC                              
                AT END                                                          
                SET PV-END-OF-RUN-TYPE-FILE TO TRUE                             
           END-READ.                                                            
      /                                                                         
      *----------------------------------------------------------------*        
      *                                                                *        
      *    FORMAT THE PRINT RECORD, WRITE IT.                          *        
      *                                                                *        
      *----------------------------------------------------------------*        
                                                                                
       2200-PRINT.                                                              
                                                                                
      *    ***---------------------------------------------------------*        
      *    *** THE SALES TOTAL RECORD CONTAINS 9'S IN KEY FIELDS       *        
      *    ***---------------------------------------------------------*        
JS0600     IF (IN019-STR-NBR  = PV-HOLD-STORE                                   
W21732       AND IN019-SKU      = '99999999'                                    
JS0600       AND IN019-SCAN-AREA = 999999)                                      
W26600         MOVE IN019-STR-NBR           TO TT-TTL-STR-NBR-2B                
W26600                                         TT-TTL-STR-NBR-2C                
W26600                                         TT-TTL-STR-NBR-2D                
W26600                                         TT-ERR-STORE-NBR                 
W26600         MOVE IN019-TTL-SALES-QTY     TO TT-STR-TTL-SLS-QTY               
W26600         MOVE IN019-TTL-RTL-SALES-AMT TO TT-STR-TTL-SLS-RTL               
W26600         MOVE IN019-RETURN-QTY        TO TT-STR-TTL-RETURN-QTY            
W26600         MOVE IN019-RETURN-RTL-AMT    TO TT-STR-TTL-RETURN-AMT            
JS0600         MOVE IN019-SALES-ADJ-PCT     TO TT-PERCENT                       
JS0600         MOVE IN019-TTL-SALES-ADJ-QTY TO PV-IN019-SALES-ADJ-QTY           
JS0600         MOVE IN019-TTL-SALES-ADJ-RTL-AMT                                 
JS0600                                   TO PV-IN019-SALES-ADJ-RTL-AMT          
               MOVE IN019-TTL-SALES-QTY  TO PV-IN019-TTL-SALES-QTY              
               MOVE IN019-TTL-RTL-SALES-AMT                                     
                                         TO PV-IN019-TTL-RTL-SALES-AMT          
W26600         MOVE IN019-RETURN-QTY     TO PV-IN019-RETURN-QTY                 
W26600         MOVE IN019-RETURN-RTL-AMT TO PV-IN019-RETURN-RTL-AMT             
JS0600         PERFORM 2315-WRITE-SUMM-PCT-RPT                                  
           ELSE                                                                 
           MOVE IN019-STR-NBR          TO  PV-HOLD-STORE                        
W21732     MOVE IN019-SKU              TO  DL-SKU                               
           MOVE IN019-SCAN-AREA        TO  DL-AREA-NUM                          
           MOVE IN019-SCAN-DTE         TO  PV-HOLD-DATE                         
           MOVE PV-HOLD-MM             TO  DL-MM                                
           MOVE PV-HOLD-DD             TO  DL-DD                                
           MOVE IN019-SCAN-TIMESTAMP   TO  PV-HOLD-TIME                         
           MOVE PV-HH                  TO  DL-HH                                
           MOVE PV-MIN                 TO  DL-MIN                               
           MOVE PV-SS                  TO  DL-SS                                
           MOVE IN019-ACTL-INV-DTE     TO  PV-HOLD-DATE2                        
           MOVE PV-MONTH               TO  DL-MM-AFT                            
           MOVE PV-DAY                 TO  DL-DD-AFT                            
           MOVE IN019-FIRST-SLS-TIMESTAMP TO PV-HOLD-TIME                       
           MOVE PV-HH                  TO  DL-HH-AFT                            
           MOVE PV-MIN                 TO  DL-MIN-AFT                           
           MOVE PV-SS                  TO  DL-SS-AFT                            
                                                                                
           MOVE IN019-TTL-PHY-COUNT    TO  DL-SCN-PHY-INV-CNT                   
           COMPUTE PA-TOT-SCND-INV-CNT =                                        
                   PA-TOT-SCND-INV-CNT + IN019-TTL-PHY-COUNT                    
           COMPUTE PA-GRD-SCND-INV-CNT =                                        
                   PA-GRD-SCND-INV-CNT + IN019-TTL-PHY-COUNT                    
                                                                                
           COMPUTE IN019-UNITS-SLD-AFT-TIMESTAMP =                              
                   IN019-UNITS-SLD-AFT-TIMESTAMP * -1                           
           MOVE IN019-UNITS-SLD-AFT-TIMESTAMP TO DL-UNIT-SLD-AFT-CNT            
           COMPUTE PA-TOT-UNITS-SLD-AFTCNT =                                    
              PA-TOT-UNITS-SLD-AFTCNT + IN019-UNITS-SLD-AFT-TIMESTAMP           
           COMPUTE PA-GRD-UNITS-SLD-AFTCNT =                                    
              PA-GRD-UNITS-SLD-AFTCNT + IN019-UNITS-SLD-AFT-TIMESTAMP           
                                                                                
           MOVE IN019-INVLD-STKRMW  TO DL-INVLD-STKRMW                          
           COMPUTE PA-TOT-INVLD-STKRMW =                                        
                   PA-TOT-INVLD-STKRMW + IN019-INVLD-STKRMW                     
           COMPUTE PA-GRD-INVLD-STKRMW =                                        
                   PA-GRD-INVLD-STKRMW + IN019-INVLD-STKRMW                     
                                                                                
           MOVE IN019-NEG-INV-ADJUST TO DL-NEG-PHY-CNT-ADJ                      
           COMPUTE PA-TOT-NEG-PHY-CNT-ADJ =                                     
                   PA-TOT-NEG-PHY-CNT-ADJ + IN019-NEG-INV-ADJUST                
           COMPUTE PA-GRD-NEG-PHY-CNT-ADJ =                                     
                   PA-GRD-NEG-PHY-CNT-ADJ + IN019-NEG-INV-ADJUST                
                                                                                
           COMPUTE PV-HOLD-CALC    =                                            
                   IN019-UNITS-SLD-AFT-TIMESTAMP + IN019-TTL-PHY-COUNT          
                   + IN019-NEG-INV-ADJUST + IN019-INVLD-STKRMW                  
           MOVE    PV-HOLD-CALC TO DL-CALC-PHY-INV                              
           COMPUTE PA-TOT-CALC-PHY-INV =                                        
                   PA-TOT-CALC-PHY-INV + PV-HOLD-CALC                           
           COMPUTE PA-GRD-CALC-PHY-INV =                                        
                   PA-GRD-CALC-PHY-INV + PV-HOLD-CALC                           
                                                                                
           MOVE IN019-SALES-ADJ-QTY TO DL-SALES-ADJ                             
           COMPUTE PA-TOT-SALES-ADJ =                                           
                   PA-TOT-SALES-ADJ + IN019-SALES-ADJ-QTY                       
           COMPUTE PA-GRD-SALES-ADJ =                                           
                   PA-GRD-SALES-ADJ + IN019-SALES-ADJ-QTY                       
                                                                                
           MOVE IN019-UNIT-PRICE TO DL-UNIT-RETAIL                              
                                    PV-HOLD-CALC                                
           COMPUTE PA-TOT-UNIT-RETAIL =                                         
                   PA-TOT-UNIT-RETAIL + PV-HOLD-CALC                            
           COMPUTE PA-GRD-UNIT-RETAIL =                                         
                   PA-GRD-UNIT-RETAIL + PV-HOLD-CALC                            
                                                                                
           MOVE IN019-SALES-ADJ-EXT-RTL-AMT TO DL-EXT-RETAIL                    
           COMPUTE PA-TOT-EXTND-RETAIL =                                        
                   PA-TOT-EXTND-RETAIL + IN019-SALES-ADJ-EXT-RTL-AMT            
           COMPUTE PA-GRD-EXTND-RETAIL =                                        
                   PA-GRD-EXTND-RETAIL + IN019-SALES-ADJ-EXT-RTL-AMT            
                                                                                
           PERFORM 2300-WRITE-DETAIL                                            
           END-IF.                                                              
      /                                                                         
      *----------------------------------------------------------------*        
      *                                                                *        
      *    WRITE STORE TOTAL'S LINE.                                   *        
      *                                                                *        
      *----------------------------------------------------------------*        
                                                                                
       2250-PRINT-TOTAL.                                                        
                                                                                
W26600     ADD 8                      TO  PV-LINE-COUNT.                        
           IF  PV-LINE-COUNT GREATER THAN PC-LINE-MAX                           
               PERFORM 2310-WRITE-HEADER                                        
           END-IF.                                                              
                                                                                
           WRITE INV-SLS-ADJ-REPORT-REC FROM TT1-TOTAL-LINE-1.                  
                                                                                
      *----------------------------------------------------------------*        
      *    VERIFY THE INVENTORY DETAIL EXISTS FOR THE STORE            *        
      *----------------------------------------------------------------*        
W26600     IF  (PA-TOT-SCND-INV-CNT = ZEROES OR                                 
W26600             PA-TOT-UNIT-RETAIL = ZEROES)                                 
W26600         IF WS-RUN-TYPE-ERROR                                             
W26600             SET TT-ERR-MISSING-INV-DATA TO TRUE                          
W26600             WRITE INV-SLS-ADJ-REPORT-REC                                 
W26600                 FROM TT1-TOTAL-ERR-LINE-1                                
W26600         ELSE                                                             
                   MOVE PV-HOLD-STORE TO PV-DISPLAY-STR                         
                   DISPLAY '**************************************'             
                   DISPLAY ' INPUT FILE IS MISSING INVENTORY DATA'              
W26600                  ' FOR STORE ' PV-DISPLAY-STR                            
                   DISPLAY '* CURR INPUT KEY: ' IN019-TIMESTMP-KEY              
                   DISPLAY '**************************************'             
                   PERFORM 9999-ABEND                                           
W26600         END-IF                                                           
JS0600     END-IF.                                                              
                                                                                
                                                                                
      *----------------------------------------------------------------*        
      *    VERIFY 99999 TOTAL RECORD IS NOT MISSING                    *        
      *----------------------------------------------------------------*        
W26600     IF (PV-IN019-SALES-ADJ-RTL-AMT = ZEROES AND                          
W26600             PV-IN019-SALES-ADJ-QTY     = ZEROES AND                      
W26600             PV-IN019-TTL-SALES-QTY     = ZEROES AND                      
W26600             PV-IN019-TTL-RTL-SALES-AMT = ZEROES AND                      
W26600             PV-IN019-RETURN-QTY        = ZEROES AND                      
W26600             PV-IN019-RETURN-RTL-AMT    = ZEROES)                         
W26600         IF WS-RUN-TYPE-ERROR                                             
W26600             SET TT-ERR-MISSING-TOTAL TO TRUE                             
W26600             WRITE INV-SLS-ADJ-REPORT-REC                                 
W26600                 FROM TT1-TOTAL-ERR-LINE-1                                
W26600         ELSE                                                             
W26600             MOVE PV-HOLD-STORE TO PV-DISPLAY-STR                         
                   DISPLAY '**************************************'             
                   DISPLAY '* 99999999 TOTAL RECORD IS MISSING FOR STR'         
                           ': ' PV-DISPLAY-STR                                  
                   DISPLAY '**------------------------------------'             
W26600             PERFORM 9999-ABEND                                           
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *----------------------------------------------------------------*        
      *    MOVE TOTAL FIELDS TO TOTAL REPORT AREA                      *        
      *----------------------------------------------------------------*        
           MOVE PV-HOLD-STORE           TO  TT-STORE-NUM.                       
           MOVE PA-TOT-SCND-INV-CNT     TO  TT-SCN-PHY-INV-CNT.                 
           MOVE PA-TOT-UNITS-SLD-AFTCNT TO  TT-UNIT-SLD-AFT-CNT.                
           MOVE PA-TOT-INVLD-STKRMW     TO  TT-INVLD-STKRMW.                    
           MOVE PA-TOT-NEG-PHY-CNT-ADJ  TO  TT-NEG-PHY-CNT-ADJ.                 
           MOVE PA-TOT-CALC-PHY-INV     TO  TT-CALC-PHY-INV.                    
           MOVE PA-TOT-SALES-ADJ        TO  TT-SALES-ADJ.                       
           MOVE PA-TOT-UNIT-RETAIL      TO  TT-UNIT-RETAIL.                     
           MOVE PA-TOT-EXTND-RETAIL     TO  TT-EXT-RETAIL.                      
                                                                                
      *----------------------------------------------------------------*        
      *    VERIFY THE TOTAL RECORD MATCHES WHAT WAS CALCULATED BY THE  *        
      *    PROGRAM                                                     *        
      *----------------------------------------------------------------*        
JS0600     IF PV-IN019-SALES-ADJ-RTL-AMT = PA-TOT-EXTND-RETAIL                  
               AND  PV-IN019-SALES-ADJ-QTY = PA-TOT-SALES-ADJ                   
               CONTINUE                                                         
           ELSE                                                                 
               MOVE PA-TOT-SALES-ADJ                                            
                   TO PV-TOT-SALES-ADJ-P                                        
               MOVE PA-TOT-EXTND-RETAIL                                         
                   TO PV-TOT-EXTND-RETAIL-P                                     
JS0600         MOVE PV-IN019-SALES-ADJ-RTL-AMT                                  
JS0600             TO PV-IN019-SALES-ADJ-RTL-AMT-P                              
JS0600         MOVE PV-IN019-SALES-ADJ-QTY                                      
                   TO PV-IN019-SALES-ADJ-QTY-P                                  
W26600         MOVE PV-HOLD-STORE TO PV-DISPLAY-STR                             
               DISPLAY '**************************************'                 
               DISPLAY '* CALC SLS ADJ DO NOT MATCH TTL REC SLS ADJ'            
W26600*                 ': ' PV-HOLD-STORE                                      
W26600                  ': ' PV-DISPLAY-STR                                     
               DISPLAY '**------------------------------------'                 
               DISPLAY 'CALC UNIT SLS ADJ:                 '                    
                          PV-TOT-SALES-ADJ-P                                    
                       ' CALC SLS ADJ EXT RTL:           '                      
                          PV-TOT-EXTND-RETAIL-P                                 
               DISPLAY 'FILE TTL RECORD UNIT SLS ADJS:     '                    
                          PV-IN019-SALES-ADJ-QTY-P                              
                       ' FILE TTL RECORD SLS ADJ EXT RTL:  '                    
                          PV-IN019-SALES-ADJ-RTL-AMT-P                          
               DISPLAY '**------------------------------------'                 
               PERFORM 9999-ABEND                                               
JS0600     END-IF.                                                              
                                                                                
           WRITE INV-SLS-ADJ-REPORT-REC FROM TT1-TOTAL-LINE-2.                  
JS0600     WRITE INV-SLS-ADJ-REPORT-REC FROM TT1-TOTAL-LINE-2B.                 
W26600     WRITE INV-SLS-ADJ-REPORT-REC FROM TT1-TOTAL-LINE-2C.                 
W26600     WRITE INV-SLS-ADJ-REPORT-REC FROM TT1-TOTAL-LINE-2D                  
              AFTER ADVANCING 2.                                                
W33304                                                                          
W33304     ADD 50 TO PV-LINE-COUNT                                              
W33304                                                                          
W33304                                                                          
W33304     MOVE IN019-STR-NBR           TO PV-HOLD-STORE.                       
W33304     MOVE IN019-INV-ID            TO PV-HOLD-INV-ID.                      
W33304     MOVE IN019-FINCL-INV-STAT-CDE TO PV-HOLD-FINCL-STAT-CDE.             
           MOVE ZEROES                  TO PA-TOT-SCND-INV-CNT                  
                                           PA-TOT-UNITS-SLD-AFTCNT              
                                           PA-TOT-INVLD-STKRMW                  
                                           PA-TOT-NEG-PHY-CNT-ADJ               
                                           PA-TOT-CALC-PHY-INV                  
                                           PA-TOT-SALES-ADJ                     
                                           PA-TOT-UNIT-RETAIL                   
                                           PA-TOT-EXTND-RETAIL                  
JS0600                                     PV-IN019-SALES-ADJ-RTL-AMT           
JS0600                                     PV-IN019-SALES-ADJ-QTY               
JS0600                                     PV-IN019-TTL-SALES-QTY               
W26600                                     PV-IN019-TTL-RTL-SALES-AMT           
W26600                                     PV-IN019-RETURN-QTY                  
W26600                                     PV-IN019-RETURN-RTL-AMT.             
           MOVE SPACES TO INV-SLS-ADJ-REPORT-REC.                               
           WRITE INV-SLS-ADJ-REPORT-REC                                         
              AFTER ADVANCING 1.                                                
                                                                                
      *----------------------------------------------------------------*        
      *    WRITE THE DETAIL LINE.                                      *        
      *----------------------------------------------------------------*        
                                                                                
       2300-WRITE-DETAIL.                                                       
                                                                                
           ADD 1                      TO  PV-LINE-COUNT.                        
           IF  PV-LINE-COUNT GREATER THAN PC-LINE-MAX                           
               PERFORM 2310-WRITE-HEADER                                        
           END-IF.                                                              
                                                                                
           WRITE INV-SLS-ADJ-REPORT-REC FROM DL-DETAIL-LINE.                    
      /                                                                         
      *----------------------------------------------------------------*        
      *    WRITE THE HEADER LINE.                                      *        
      *----------------------------------------------------------------*        
       2310-WRITE-HEADER.                                                       
                                                                                
           ADD 1                   TO  PV-PAGE-COUNT                            
           MOVE PV-PAGE-COUNT      TO  DP132O-PAGE-NUMBER                       
           MOVE 10                 TO  PV-LINE-COUNT                            
                                                                                
JS0600     IF WS-RUN-TYPE-DAILY                                                 
JS0600         MOVE PC-1 TO DP132O-REPORT-NUMBER                                
JS0600     ELSE                                                                 
JS0600         IF WS-RUN-TYPE-CUM                                               
JS0600             MOVE PC-2 TO  DP132O-REPORT-NUMBER                           
JS0600         ELSE                                                             
JS0600             IF WS-RUN-TYPE-ERROR                                         
JS0600                 MOVE PC-3 TO  DP132O-REPORT-NUMBER                       
JS0600             END-IF                                                       
JS0600         END-IF                                                           
JS0600     END-IF.                                                              
                                                                                
           WRITE INV-SLS-ADJ-REPORT-REC                                         
              FROM DP132O-STANDRD-HEADER-132-COLS                               
              AFTER ADVANCING PAGE.                                             
                                                                                
JS0600     IF WS-RUN-TYPE-DAILY                                                 
JS0600        WRITE INV-SLS-ADJ-REPORT-REC                                      
JS0600          FROM HL1-HEADER-LINE-1                                          
JS0600     ELSE                                                                 
JS0600        IF WS-RUN-TYPE-CUM                                                
JS0600            WRITE INV-SLS-ADJ-REPORT-REC                                  
JS0600              FROM HL1-HEADER-LINE-1-CUMM                                 
JS0600        ELSE                                                              
JS0600            IF WS-RUN-TYPE-ERROR                                          
JS0600                WRITE INV-SLS-ADJ-REPORT-REC                              
JS0600                  FROM HL1-HEADER-LINE-1-ERROR                            
JS0600            END-IF                                                        
JS0600        END-IF                                                            
JS0600     END-IF.                                                              
                                                                                
W33304     IF (WS-RUN-TYPE-CUM OR WS-RUN-TYPE-DAILY)                            
W33304      AND PS-NOT-GRAND-ONLY                                               
W33304     WRITE INV-SLS-ADJ-REPORT-REC FROM HL1-HEADING-LINE-1-CYCLE           
W33304        AFTER ADVANCING 1                                                 
W33304     END-IF.                                                              
W33304                                                                          
W33304     IF PS-NOT-GRAND-ONLY                                                 
           MOVE PV-HOLD-STORE TO HL2-STORE                                      
           WRITE INV-SLS-ADJ-REPORT-REC FROM HL2-HEADING-LINE-2                 
              AFTER ADVANCING 2                                                 
W33304     END-IF.                                                              
W33304                                                                          
W33304     IF (DP132O-REPORT-NUMBER = PC-1 OR                                   
W33304         DP132O-REPORT-NUMBER = PC-2)  AND                                
W33304         PS-GRAND-ONLY                                                    
W33304                                                                          
W33304         WRITE INV-SLS-ADJ-REPORT-REC FROM TLS-GRAND-TOTAL-LINE           
W33304            AFTER ADVANCING 1                                             
W33304                                                                          
W33304         WRITE INV-SLS-ADJ-REPORT-REC FROM TLS-BLANK-LINE                 
W33304            AFTER ADVANCING 2                                             
W33304                                                                          
W33304     END-IF                                                               
W33304                                                                          
           WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3A                
              AFTER ADVANCING 1.                                                
                                                                                
           WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3B.               
                                                                                
           WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3C.               
                                                                                
           WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3D.               
                                                                                
           MOVE SPACES TO  INV-SLS-ADJ-REPORT-REC.                              
           WRITE INV-SLS-ADJ-REPORT-REC.                                        
                                                                                
W33304     SET PS-NOT-GRAND-ONLY TO TRUE.                                       
                                                                                
      /                                                                         
      *----------------------------------------------------------------*        
      *                                                                *        
      *----------------------------------------------------------------*        
JS0600 2315-WRITE-SUMM-PCT-RPT.                                                 
                                                                                
W33304     IF PV-FIRST-HDR-NOT-WRIT                                             
           ADD 1                        TO  PV2-LINE-COUNT                      
W33304     SET PV-FIRST-HDR-WRIT        TO TRUE                                 
           IF PV2-LINE-COUNT > PC-LINE-MAX                                      
              ADD 1                   TO  PV2-PAGE-COUNT                        
              MOVE PV2-PAGE-COUNT     TO  DP132O-PAGE-NUMBER                    
W33304        MOVE 12                 TO  PV2-LINE-COUNT                        
JS0600        IF WS-RUN-TYPE-DAILY                                              
JS0600            MOVE PC-4 TO DP132O-REPORT-NUMBER                             
JS0600        ELSE                                                              
JS0600            IF WS-RUN-TYPE-CUM                                            
JS0600                MOVE PC-5 TO  DP132O-REPORT-NUMBER                        
JS0600            ELSE                                                          
JS0600                IF WS-RUN-TYPE-ERROR                                      
JS0600                    MOVE PC-6 TO  DP132O-REPORT-NUMBER                    
JS0600                END-IF                                                    
JS0600            END-IF                                                        
JS0600        END-IF                                                            
              WRITE SUMM-SLS-PCT-REPORT-REC                                     
                 FROM DP132O-STANDRD-HEADER-132-COLS                            
                 AFTER ADVANCING PAGE                                           
              IF WS-RUN-TYPE-DAILY                                              
                  WRITE SUMM-SLS-PCT-REPORT-REC                                 
                    FROM HLS-HEADER-LINE-1                                      
              ELSE                                                              
                  IF WS-RUN-TYPE-CUM                                            
                      WRITE SUMM-SLS-PCT-REPORT-REC                             
                        FROM HLS-HEADER-LINE-1-CUMM                             
                  ELSE                                                          
                      IF WS-RUN-TYPE-ERROR                                      
                          WRITE SUMM-SLS-PCT-REPORT-REC                         
                            FROM HLS-HEADER-LINE-1-ERROR                        
                      END-IF                                                    
VLY               END-IF                                                        
              END-IF                                                            
W33304     END-IF                                                               
W33304***** SUMMARY REPORT BREAKING HERE !!                                     
W33304        IF WS-RUN-TYPE-CUM OR WS-RUN-TYPE-DAILY                           
W33304           MOVE IN019-INV-ID                                              
W33304             TO HLS-CYCLE                                                 
W33304                HLS-FIN-CYCLE                                             
W33304           MOVE IN019-FINCL-INV-STAT-CDE                                  
W33304             TO HLS-FINCL-STAT-CDE                                        
W33304           MOVE HL1-CYCLE-NAME                                            
W33304             TO HLS-CYCLE-NAME                                            
W33304           MOVE HL1-CYCLE-STAT-NAME                                       
W33304             TO HLS-CYCLE-STAT-NAME                                       
W33304                                                                          
W33304           IF DP132O-REPORT-NUMBER NOT = PC-4                             
W33304              WRITE SUMM-SLS-PCT-REPORT-REC                               
W33304              FROM HLS-HEADING-LINE-1-CYCLE                               
W33304              AFTER ADVANCING 2                                           
W33304              ADD 2          TO  PV2-LINE-COUNT                           
W33304           END-IF                                                         
W33304        END-IF                                                            
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-2                                        
W33304           AFTER ADVANCING 2                                              
W33304           ADD 2          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-3                                        
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-DASHES                                   
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
           END-IF                                                               
                                                                                
           MOVE IN019-STR-NBR           TO DLS-TTL-STR-NBR.                     
W26600     MOVE IN019-RETURN-QTY        TO DLS-STR-TTL-RETURN-QTY.              
W26600     MOVE IN019-RETURN-RTL-AMT    TO DLS-STR-TTL-RETURN-AMT.              
           MOVE IN019-TTL-SALES-QTY     TO DLS-STR-TTL-UNT-SLS.                 
           MOVE IN019-TTL-RTL-SALES-AMT TO DLS-STR-TTL-RTL-SLS-AMT.             
           MOVE IN019-TTL-SALES-ADJ-QTY TO DLS-STR-SALES-ADJ-QTY.               
           MOVE IN019-TTL-SALES-ADJ-RTL-AMT                                     
                                        TO DLS-STR-SALES-ADJ-RTL-AMT.           
           MOVE IN019-SALES-ADJ-PCT     TO DLS-PERCENT.                         
           MOVE IN019-TTL-ACTL-INV-MM   TO DLS-ACTL-INV-MM.                     
           MOVE IN019-TTL-ACTL-INV-DD   TO DLS-ACTL-INV-DD.                     
           MOVE IN019-TTL-ACTL-INV-YY   TO DLS-ACTL-INV-YY.                     
                                                                                
           WRITE SUMM-SLS-PCT-REPORT-REC                                        
               FROM DLS-DETAIL-LINE                                             
               AFTER ADVANCING 1.                                               
W33304         ADD 1          TO  PV2-LINE-COUNT.                               
W33304         ADD 1          TO  PV-STORE-LINE-COUNT.                          
W33304                                                                          
           IF PV-STORE-LINE-COUNT > PC-STORE-LINE-MAX                           
              PERFORM 6020-NEW-PAGE-WITHIN-STAT                                 
              MOVE 1          TO PV-STORE-LINE-COUNT                            
           END-IF.                                                              
                                                                                
W21732     IF IN019-DEPT-NBR     = PV-PREV-DEPT-NBR AND                         
W21732        IN019-CL-NBR       = PV-PREV-IN019-CL-NBR AND                     
W21732        IN019-TIMESTMP-KEY = PV-PREV-TIMESTMP-KEY                         
               DISPLAY '**************************************'                 
               DISPLAY '* INPUT FILE CONTAINS DUPLICATE DATA !!!!!!!!!'         
               DISPLAY '* CURR INPUT KEY: ' IN019-TIMESTMP-KEY                  
                       '  PREV INPUT KEY: ' PV-PREV-TIMESTMP-KEY                
               DISPLAY '**************************************'                 
               PERFORM 9999-ABEND                                               
JS0600     END-IF.                                                              
                                                                                
JS0600     MOVE IN019-TIMESTMP-KEY TO PV-PREV-TIMESTMP-KEY.                     
W21732     MOVE IN019-DEPT-NBR     TO PV-PREV-DEPT-NBR.                         
W21732     MOVE IN019-CL-NBR       TO PV-PREV-IN019-CL-NBR.                     
                                                                                
W26600     COMPUTE PA-GRD-RETURN-QTY   =                                        
W26600             PA-GRD-RETURN-QTY   + IN019-RETURN-QTY.                      
                                                                                
W26600     COMPUTE PA-GRD-RETURN-AMT   =                                        
W26600             PA-GRD-RETURN-AMT   + IN019-RETURN-RTL-AMT.                  
                                                                                
21015      COMPUTE PA-GRD-SALES-QTY    =                                        
  |                PA-GRD-SALES-QTY    + IN019-TTL-SALES-QTY.                   
  |                                                                             
  |        COMPUTE PA-GRD-SLS-ADJ-RTL  =                                        
  |                PA-GRD-SLS-ADJ-RTL  + IN019-TTL-SALES-ADJ-RTL-AMT.           
  |                                                                             
  |        COMPUTE PA-GRD-RTL-SLS-AMT  =                                        
  |                PA-GRD-RTL-SLS-AMT  + IN019-TTL-RTL-SALES-AMT.               
21015                                                                           
W33304                                                                          
W33304     IF IN019-INV-ID = PV-HOLD-INV-ID                                     
W33304        COMPUTE PA-CYC-SALES-QTY    =                                     
W33304                PA-CYC-SALES-QTY    + IN019-TTL-SALES-QTY                 
W33304                                                                          
W33304        COMPUTE PA-CYC-RTL-SLS-AMT  =                                     
W33304                PA-CYC-RTL-SLS-AMT  + IN019-TTL-RTL-SALES-AMT             
W33304                                                                          
W33304        COMPUTE PA-CYC-RETURN-QTY   =                                     
W33304                PA-CYC-RETURN-QTY   + IN019-RETURN-QTY                    
W33304                                                                          
W33304        COMPUTE PA-CYC-RETURN-AMT   =                                     
W33304                PA-CYC-RETURN-AMT   + IN019-RETURN-RTL-AMT                
W33304                                                                          
W33304        COMPUTE PA-CYC-SALES-ADJ    =                                     
W33304                PA-CYC-SALES-ADJ    + IN019-TTL-SALES-ADJ-QTY             
W33304                                                                          
W33304        COMPUTE PA-CYC-SLS-ADJ-RTL  =                                     
W33304                PA-CYC-SLS-ADJ-RTL  + IN019-TTL-SALES-ADJ-RTL-AMT         
W33304     END-IF.                                                              
W33304                                                                          
W33304                                                                          
W33304        COMPUTE PA-FIN-SALES-QTY    =                                     
W33304                PA-FIN-SALES-QTY    + IN019-TTL-SALES-QTY                 
W33304                                                                          
W33304        COMPUTE PA-FIN-RTL-SLS-AMT  =                                     
W33304                PA-FIN-RTL-SLS-AMT  + IN019-TTL-RTL-SALES-AMT             
W33304                                                                          
W33304        COMPUTE PA-FIN-RETURN-QTY   =                                     
W33304                PA-FIN-RETURN-QTY   + IN019-RETURN-QTY                    
W33304                                                                          
W33304        COMPUTE PA-FIN-RETURN-AMT   =                                     
W33304                PA-FIN-RETURN-AMT   + IN019-RETURN-RTL-AMT                
W33304                                                                          
W33304        COMPUTE PA-FIN-SALES-ADJ    =                                     
W33304                PA-FIN-SALES-ADJ    + IN019-TTL-SALES-ADJ-QTY             
W33304                                                                          
W33304        COMPUTE PA-FIN-SLS-ADJ-RTL  =                                     
W33304                PA-FIN-SLS-ADJ-RTL  + IN019-TTL-SALES-ADJ-RTL-AMT.        
W33304                                                                          
W33304*----------------------------------------------------------------*        
W33304*                                                                *        
W33304*----------------------------------------------------------------*        
W33304 2320-WRITE-SUMM-PCT-BRK.                                                 
W33304     ADD 1                        TO  PV2-LINE-COUNT.                     
W33304     IF PV2-LINE-COUNT > PC-LINE-MAX  AND                                 
W33304        (  HLS-FINCL-STAT-CDE       NOT =                                 
W33304                          PV-HOLD-FINCL-STAT-CDE                          
W33304                          OR                                              
W33304           HLS-FIN-CYCLE    NOT = PV-HOLD-INV-ID)                         
W33304        ADD 1                   TO  PV2-PAGE-COUNT                        
W33304        MOVE PV2-PAGE-COUNT     TO  DP132O-PAGE-NUMBER                    
W33304        MOVE 12                 TO  PV2-LINE-COUNT                        
W33304        IF WS-RUN-TYPE-DAILY                                              
W33304            MOVE PC-4 TO DP132O-REPORT-NUMBER                             
W33304        ELSE                                                              
W33304            IF WS-RUN-TYPE-CUM                                            
W33304                MOVE PC-5 TO  DP132O-REPORT-NUMBER                        
W33304            ELSE                                                          
W33304                IF WS-RUN-TYPE-ERROR                                      
W33304                    MOVE PC-6 TO  DP132O-REPORT-NUMBER                    
W33304                END-IF                                                    
W33304            END-IF                                                        
W33304        END-IF                                                            
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM DP132O-STANDRD-HEADER-132-COLS                            
W33304           AFTER ADVANCING PAGE                                           
W33304        IF WS-RUN-TYPE-DAILY                                              
W33304            WRITE SUMM-SLS-PCT-REPORT-REC                                 
W33304              FROM HLS-HEADER-LINE-1                                      
W33304        ELSE                                                              
W33304            IF WS-RUN-TYPE-CUM                                            
W33304                WRITE SUMM-SLS-PCT-REPORT-REC                             
W33304                  FROM HLS-HEADER-LINE-1-CUMM                             
W33304            ELSE                                                          
W33304                IF WS-RUN-TYPE-ERROR                                      
W33304                    WRITE SUMM-SLS-PCT-REPORT-REC                         
W33304                      FROM HLS-HEADER-LINE-1-ERROR                        
W33304                END-IF                                                    
W33304            END-IF                                                        
W33304        END-IF                                                            
W33304     END-IF.                                                              
W33304     IF WS-RUN-TYPE-CUM                                                   
W33304        MOVE IN019-INV-ID                                                 
W33304          TO HLS-CYCLE                                                    
W33304             HLS-FIN-CYCLE                                                
W33304        MOVE IN019-FINCL-INV-STAT-CDE                                     
W33304          TO HLS-FINCL-STAT-CDE                                           
W33304        MOVE HL1-CYCLE-NAME                                               
W33304          TO HLS-CYCLE-NAME                                               
W33304        MOVE HL1-CYCLE-STAT-NAME                                          
W33304          TO HLS-CYCLE-STAT-NAME                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304        FROM HLS-HEADING-LINE-1-CYCLE                                     
W33304        AFTER ADVANCING 2                                                 
W33304        ADD 50         TO  PV2-LINE-COUNT                                 
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-2                                        
W33304           AFTER ADVANCING 2                                              
W33304           ADD 2          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-3                                        
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-DASHES                                   
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
W33304                                                                          
W33304     END-IF.                                                              
W33304                                                                          
W33304*----------------------------------------------------------------*        
W33304*                                                                *        
W33304*----------------------------------------------------------------*        
W33304 2330-WRITE-STAT-CDE-BRK.                                                 
W33304                                                                          
W33304        MOVE PA-FIN-SALES-QTY                                             
W33304          TO TLS-FIN-TTL-UNT-SLS                                          
W33304        MOVE PA-FIN-RTL-SLS-AMT                                           
W33304          TO TLS-FIN-TTL-RTL-SLS-AMT                                      
W33304        MOVE PA-FIN-RETURN-QTY                                            
W33304          TO TLS-FIN-TTL-RETURN-QTY                                       
W33304        MOVE PA-FIN-RETURN-AMT                                            
W33304          TO TLS-FIN-TTL-RETURN-AMT                                       
W33304        MOVE PA-FIN-SALES-ADJ                                             
W33304          TO TLS-FIN-SALES-ADJ-QTY                                        
W33304        MOVE PA-FIN-SLS-ADJ-RTL                                           
W33304          TO TLS-FIN-SALES-ADJ-RTL-AMT                                    
W33304                                                                          
W33304        IF HLS-FINCL-STAT-CDE NOT = PV-HOLD-FINCL-STAT-CDE                
W33304           OR                                                             
W33304           HLS-FIN-CYCLE    NOT = PV-HOLD-INV-ID                          
W33304           ADD 50         TO  PV2-LINE-COUNT                              
W33304           PERFORM 6000-NEW-PAGE-FOR-STAT-CODE                            
W33304        END-IF                                                            
W33304                                                                          
W33304        IF HLS-FINCL-STAT-CDE NOT = PV-HOLD-FINCL-STAT-CDE                
W33304         OR                                                               
W33304           HLS-FIN-CYCLE      NOT = PV-HOLD-INV-ID                        
W33304           MOVE ZEROES TO PA-FIN-SALES-QTY                                
W33304                          TLS-FIN-TTL-UNT-SLS                             
W33304                          PA-FIN-RTL-SLS-AMT                              
W33304                          TLS-FIN-TTL-RTL-SLS-AMT                         
W33304                          PA-FIN-RETURN-QTY                               
W33304                          TLS-FIN-TTL-RETURN-QTY                          
W33304                          PA-FIN-RETURN-AMT                               
W33304                          TLS-FIN-TTL-RETURN-AMT                          
W33304                          PA-FIN-SALES-ADJ                                
W33304                          TLS-FIN-SALES-ADJ-QTY                           
W33304                          PA-FIN-SLS-ADJ-RTL                              
W33304                          TLS-FIN-SALES-ADJ-RTL-AMT                       
W33304        END-IF.                                                           
W33304                                                                          
W33304*----------------------------------------------------------------*        
W33304*                                                                *        
W33304*----------------------------------------------------------------*        
W33304 2340-WRITE-CYCLE-BRK.                                                    
W33304                                                                          
W33304        MOVE PA-CYC-SALES-QTY   TO TLS-CYC-TTL-UNT-SLS.                   
W33304        MOVE PA-CYC-RTL-SLS-AMT TO TLS-CYC-TTL-RTL-SLS-AMT.               
W33304        MOVE PA-CYC-RETURN-QTY  TO TLS-CYC-TTL-RETURN-QTY.                
W33304        MOVE PA-CYC-RETURN-AMT  TO TLS-CYC-TTL-RETURN-AMT.                
W33304        MOVE PA-CYC-SALES-ADJ   TO TLS-CYC-SALES-ADJ-QTY.                 
W33304        MOVE PA-CYC-SLS-ADJ-RTL TO TLS-CYC-SALES-ADJ-RTL-AMT.             
W33304                                                                          
W33304        PERFORM 6010-NEW-PAGE-FOR-CYCLE-BRK.                              
W33304                                                                          
W33304        MOVE ZEROES TO PA-CYC-SALES-QTY                                   
W33304                       TLS-CYC-TTL-UNT-SLS                                
W33304                       PA-CYC-RTL-SLS-AMT                                 
W33304                       TLS-CYC-TTL-RTL-SLS-AMT                            
W33304                       PA-CYC-RETURN-QTY                                  
W33304                       TLS-CYC-TTL-RETURN-QTY                             
W33304                       PA-CYC-RETURN-AMT                                  
W33304                       TLS-CYC-TTL-RETURN-AMT                             
W33304                       PA-CYC-SALES-ADJ                                   
W33304                       TLS-CYC-SALES-ADJ-QTY                              
W33304                       PA-CYC-SLS-ADJ-RTL                                 
W33304                       TLS-CYC-SALES-ADJ-RTL-AMT.                         
W33304                                                                          
      *----------------------------------------------------------------*        
      *                                                                *        
      *----------------------------------------------------------------*        
      /                                                                         
      *2320-WRITE-STORE-BREAK.                                                  
      *                                                                         
      *                                                                         
      *    ADD 1                   TO  PV-PAGE-COUNT.                           
      *    MOVE PV-PAGE-COUNT      TO  DP132O-PAGE-NUMBER.                      
      *    MOVE 10                 TO  PV-LINE-COUNT.                           
      *                                                                         
      *    WRITE INV-SLS-ADJ-REPORT-REC                                         
      *       FROM DP132O-STANDRD-HEADER-132-COLS                               
      *       AFTER ADVANCING PAGE.                                             
      *                                                                         
JS0600*    IF WS-RUN-TYPE-DAILY                                                 
JS0600*        WRITE INV-SLS-ADJ-REPORT-REC                                     
JS0600*          FROM HL1-HEADER-LINE-1                                         
JS0600*    ELSE                                                                 
JS0600*        IF WS-RUN-TYPE-CUM                                               
JS0600*            WRITE INV-SLS-ADJ-REPORT-REC                                 
JS0600*              FROM HL1-HEADER-LINE-1-CUMM                                
JS0600*        ELSE                                                             
JS0600*            IF WS-RUN-TYPE-ERROR                                         
JS0600*                WRITE INV-SLS-ADJ-REPORT-REC                             
JS0600*                  FROM HL1-HEADER-LINE-1-ERROR                           
JS0600*            END-IF                                                       
JS0600*        END-IF                                                           
JS0600*    END-IF.                                                              
      *                                                                         
      *    MOVE PV-HOLD-STORE TO HL2-STORE.                                     
      *    WRITE INV-SLS-ADJ-REPORT-REC FROM HL2-HEADING-LINE-2                 
      *       AFTER ADVANCING 2.                                                
      *                                                                         
      *    WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3A                
      *       AFTER ADVANCING 1.                                                
      *                                                                         
      *    WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3B.               
      *                                                                         
      *    WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3C.               
      *                                                                         
      *    WRITE INV-SLS-ADJ-REPORT-REC FROM HL3-HEADING-LINE-3D.               
      *                                                                         
      *    MOVE SPACES                TO  INV-SLS-ADJ-REPORT-REC.               
      *    WRITE INV-SLS-ADJ-REPORT-REC.                                        
                                                                                
      /                                                                         
       2400-GRAND-TOTALS.                                                       
W33304     IF WS-RUN-TYPE-CUM                                                   
W33304        SET PS-GRAND-ONLY  TO TRUE                                        
W33304        MOVE HLS-CYCLE          TO HLS-FIN-CYCLE                          
W33304        MOVE HLS-FINCL-STAT-CDE TO HLS-FIN-FINCL-STAT-CDE                 
W33304        MOVE INCNTL-INV-NM-TEXT TO HLS-FIN-CYCLE-NAME                     
W33304        MOVE HLS-CYCLE-STAT-NAME TO HLS-FIN-CYCLE-STAT-NAME               
W33304        PERFORM 2330-WRITE-STAT-CDE-BRK                                   
W33304        MOVE HLS-CYCLE          TO HLS-CYCLE-ID-BRK                       
W33304        MOVE HLS-CYCLE-NAME     TO HLS-CYCLE-NAME-BRK                     
W33304        PERFORM 2340-WRITE-CYCLE-BRK                                      
W33304     END-IF.                                                              
W33304                                                                          
           ADD 2                      TO  PV-LINE-COUNT.                        
           IF  PV-LINE-COUNT GREATER THAN PC-LINE-MAX                           
W33304          SET PS-GRAND-ONLY  TO TRUE                                      
               PERFORM 2310-WRITE-HEADER                                        
           END-IF.                                                              
                                                                                
           MOVE PA-GRD-SCND-INV-CNT     TO  GT-SCN-PHY-INV-CNT.                 
           MOVE PA-GRD-UNITS-SLD-AFTCNT TO  GT-UNIT-SLD-AFT-CNT.                
           MOVE PA-GRD-INVLD-STKRMW     TO  GT-INVLD-STKRMW.                    
           MOVE PA-GRD-NEG-PHY-CNT-ADJ  TO  GT-NEG-PHY-CNT-ADJ.                 
           MOVE PA-GRD-CALC-PHY-INV     TO  GT-CALC-PHY-INV.                    
           MOVE PA-GRD-SALES-ADJ        TO  GT-SALES-ADJ.                       
           MOVE PA-GRD-UNIT-RETAIL      TO  GT-UNIT-RETAIL.                     
           MOVE PA-GRD-EXTND-RETAIL     TO  GT-EXT-RETAIL.                      
           WRITE INV-SLS-ADJ-REPORT-REC FROM TT1-TOTAL-LINE-3                   
              AFTER ADVANCING 2.                                                
                                                                                
21015      PERFORM 3000-SUMM-REPORT-TOTALS.                                     
  |                                                                             
  |   /*****************************************************************        
  |   * 3000-SUMMARIZED REPORT(S) TOTAL LINES.....                              
  |   ******************************************************************        
  |                                                                             
  |    3000-SUMM-REPORT-TOTALS.                                                 
  |                                                                             
  |        ADD 4                        TO  PV2-LINE-COUNT.                     
  |        IF PV2-LINE-COUNT > PC-LINE-MAX                                      
  |           ADD 1                   TO  PV2-PAGE-COUNT                        
  |           MOVE PV2-PAGE-COUNT     TO  DP132O-PAGE-NUMBER                    
  |           MOVE 10                 TO  PV2-LINE-COUNT                        
  |           IF WS-RUN-TYPE-DAILY                                              
  |               MOVE PC-4 TO DP132O-REPORT-NUMBER                             
  |           ELSE                                                              
  |               IF WS-RUN-TYPE-CUM                                            
  |                   MOVE PC-5 TO  DP132O-REPORT-NUMBER                        
  |               ELSE                                                          
  |                   IF WS-RUN-TYPE-ERROR                                      
  |                       MOVE PC-6 TO  DP132O-REPORT-NUMBER                    
  |                   END-IF                                                    
  |               END-IF                                                        
  |           END-IF                                                            
  |           WRITE SUMM-SLS-PCT-REPORT-REC                                     
  |              FROM DP132O-STANDRD-HEADER-132-COLS                            
  |              AFTER ADVANCING PAGE                                           
  |           IF WS-RUN-TYPE-DAILY                                              
  |               WRITE SUMM-SLS-PCT-REPORT-REC                                 
  |                 FROM HLS-HEADER-LINE-1                                      
  |           ELSE                                                              
  |               IF WS-RUN-TYPE-CUM                                            
  |                   WRITE SUMM-SLS-PCT-REPORT-REC                             
  |                     FROM HLS-HEADER-LINE-1-CUMM                             
  |               ELSE                                                          
  |                   IF WS-RUN-TYPE-ERROR                                      
  |                       WRITE SUMM-SLS-PCT-REPORT-REC                         
  |                         FROM HLS-HEADER-LINE-1-ERROR                        
  |                   END-IF                                                    
  |               END-IF                                                        
  |           END-IF                                                            
  |        END-IF.                                                              
  |                                                                             
W33304     IF WS-RUN-TYPE-DAILY                                                 
               PERFORM 6030-NEW-PAGE-DLY-SUMM                                   
           ELSE                                                                 
W33304     WRITE SUMM-SLS-PCT-REPORT-REC                                        
W33304                   FROM TLS-CYCLE-99999                                   
W33304                                AFTER ADVANCING 2 LINES                   
W33304                                                                          
W33304     WRITE SUMM-SLS-PCT-REPORT-REC                                        
W33304                   FROM HLS-HEADING-LINE-2-SUM                            
W33304                                AFTER ADVANCING 2 LINES                   
W33304     WRITE SUMM-SLS-PCT-REPORT-REC                                        
W33304                   FROM HLS-HEADING-LINE-3-SUM                            
W33304                                AFTER ADVANCING 1 LINE                    
W33304                                                                          
  |        WRITE SUMM-SLS-PCT-REPORT-REC                                        
W33304                   FROM TLS-TOTAL-LINE-1 AFTER ADVANCING 1 LINE           
  |        END-IF                                                               
  |        MOVE PA-GRD-SALES-QTY        TO TLS-STR-TTL-UNT-SLS.                 
21015      MOVE PA-GRD-RTL-SLS-AMT      TO TLS-STR-TTL-RTL-SLS-AMT.             
W26600     MOVE PA-GRD-RETURN-QTY       TO TLS-STR-TTL-RETURN-QTY.              
W26600     MOVE PA-GRD-RETURN-AMT       TO TLS-STR-TTL-RETURN-AMT.              
21015      MOVE PA-GRD-SALES-ADJ        TO TLS-STR-SALES-ADJ-QTY.               
  |        MOVE PA-GRD-SLS-ADJ-RTL      TO TLS-STR-SALES-ADJ-RTL-AMT.           
  |                                                                             
  |        WRITE SUMM-SLS-PCT-REPORT-REC                                        
W33304                   FROM TLS-TOTAL-LINE-2 AFTER ADVANCING 1 LINE.          
21015                                                                           
      ******************************************************************00000100
      *                                                                 00000200
      ******************************************************************00000300
JS0600 5000-GET-STORE-NAME.                                                     
                                                                                
W26600     EXEC SQL                                                             
W26600       SELECT   LOC_NM                                                    
W26600         INTO  :XMT00001-LOC-NM                                           
W26600         FROM   XMT_LOC                                                   
W26600        WHERE   LOC_NBR  = :PV-HOLD-STORE                                 
W26600       WITH UR                                                            
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN +0                                                          
W26600             MOVE XMT00001-LOC-NM TO HL2-STORE-NAME                       
W26600                                     DLS-STORE-NAME                       
               WHEN +100                                                        
                   MOVE 'STR NOT FND'              TO HL2-STORE-NAME            
                   MOVE 'STR NOT FND'              TO DLS-STORE-NAME            
               WHEN OTHER                                                       
W26600             DISPLAY 'STORE NOT FOUND ON XMT_LOC'                         
W26600             MOVE IN019-STR-NBR TO PV-DISPLAY-STR                         
W26600             DISPLAY 'STORE = ' PV-DISPLAY-STR                            
W26600             MOVE 'SELECT XMT_LOC '                                       
                                      TO  PV-OPER-ATTEMPTED                     
                   PERFORM Z999-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
W33304******************************************************************00000100
W33304*                                                                 00000200
W33304******************************************************************00000300
W33304 5100-GET-CYCLE-NAME.                                                     
W33304                                                                          
W33304     MOVE IN019-INV-ID  TO INCNTL-INV-ID.                                 
W33304                                                                          
W33304     PERFORM WITH TEST AFTER                                              
W33304             VARYING PV-RETRY-COUNTER FROM 1 BY 1                         
W33304             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                 
W33304                     SQLCODE = ZERO OR                                    
W33304                     SQLCODE = +100                                       
W33304                                                                          
W33304        EXEC SQL                                                          
W33304          SELECT   INV_NM                                                 
W33304            INTO  :INCNTL-INV-NM                                          
W33304            FROM   TINCNTL                                                
W33304           WHERE   INV_ID = :INCNTL-INV-ID                                
W33304        END-EXEC                                                          
W33304                                                                          
W33304        EVALUATE TRUE                                                     
W33304            WHEN SQLCODE = +0                                             
W33304                MOVE IN019-INV-ID TO HL1-CYCLE                            
W33304                MOVE IN019-FINCL-INV-STAT-CDE                             
W33304                                        TO HL1-FINCL-STAT-CDE             
W33304                INSPECT INCNTL-INV-NM-TEXT REPLACING ALL                  
W33304                        LOW-VALUES BY SPACES                              
W33304                MOVE INCNTL-INV-NM-TEXT TO HL1-CYCLE-NAME                 
W33304                IF IN019-FINCL-INV-STAT-CDE = PC-BK                       
W33304                   MOVE PC-WILL-BOOK                                      
W33304                     TO HL1-CYCLE-STAT-NAME                               
W33304                ELSE                                                      
W33304                   IF IN019-FINCL-INV-STAT-CDE = PC-BD                    
W33304                      MOVE PC-BOOK-DELAYED                                
W33304                        TO HL1-CYCLE-STAT-NAME                            
W33304                   END-IF                                                 
W33304                END-IF                                                    
W33304                                                                          
W33304            WHEN SQLCODE = +100                                           
W33304                 MOVE 'MISSING DATA' TO HL1-CYCLE-STAT-NAME               
W33304            WHEN OTHER                                                    
W33304                DISPLAY ' '                                               
W33304                DISPLAY '!!!!!!!!!!!!!!!!!!!!!!!!!!'                      
W33304                DISPLAY 'CYCLE NOT FOUND ON TINCNTL'                      
W33304                DISPLAY '!!!!!!!!!!!!!!!!!!!!!!!!!!'                      
W33304                                                                          
W33304                MOVE IN019-STR-NBR TO PV-DISPLAY-STR                      
W33304                DISPLAY 'INPUT STORE = ' PV-DISPLAY-STR                   
W33304                MOVE 'SELECT TINCNTL '                                    
W33304                                   TO  PV-OPER-ATTEMPTED                  
W33304                PERFORM Z999-SQL-ABEND                                    
W33304        END-EVALUATE                                                      
W33304     END-PERFORM.                                                         
W33304                                                                          
W33304     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
W33304         SQLCODE NOT = ZERO AND                                           
W33304         SQLCODE NOT = +100                                               
W33304         DISPLAY '***********************************************'        
W33304         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO         *'        
W33304         DISPLAY '** SELECT TINCNTL                             *'        
W33304         DISPLAY '** PARAGRAPH = 5100-GET-CYCLE-NAME            *'        
W33304         MOVE IN019-STR-NBR TO PV-DISPLAY-STR                             
W33304         DISPLAY '** INPUT STORE = ' PV-DISPLAY-STR                       
W33304         DISPLAY '***********************************************'        
W33304         PERFORM Z999-SQL-ABEND                                           
W33304     END-IF.                                                              
W33304                                                                          
W33304******************************************************************00000100
W33304*                                                                 00000200
W33304******************************************************************00000300
W33304 5200-GET-FINCL-STAT-CDE-NAME.                                            
W33304                                                                          
W33304     IF IN019-FINCL-INV-STAT-CDE = PC-BK                                  
W33304        MOVE SPACE TO HL1-CYCLE-STAT-NAME                                 
W33304        MOVE PC-WILL-BOOK                                                 
W33304          TO HL1-CYCLE-STAT-NAME                                          
W33304        MOVE IN019-FINCL-INV-STAT-CDE                                     
W33304          TO HL1-FINCL-STAT-CDE                                           
W33304     ELSE                                                                 
W33304        IF IN019-FINCL-INV-STAT-CDE = PC-BD                               
W33304        MOVE SPACE TO HL1-CYCLE-STAT-NAME                                 
W33304           MOVE PC-BOOK-DELAYED                                           
W33304             TO HL1-CYCLE-STAT-NAME                                       
W33304           MOVE IN019-FINCL-INV-STAT-CDE                                  
W33304             TO HL1-FINCL-STAT-CDE                                        
W33304     END-IF.                                                              
W33304                                                                          
W33304*----------------------------------------------------------------*        
W33304*                                                                *        
W33304*----------------------------------------------------------------*        
W33304 6000-NEW-PAGE-FOR-STAT-CODE.                                             
W33304                                                                          
W33304     ADD 1                        TO  PV2-LINE-COUNT.                     
W33304     IF PV2-LINE-COUNT > PC-LINE-MAX                                      
W33304        ADD 1                   TO  PV2-PAGE-COUNT                        
W33304        MOVE PV2-PAGE-COUNT     TO  DP132O-PAGE-NUMBER                    
W33304        MOVE 12                 TO  PV2-LINE-COUNT                        
W33304        MOVE PC-5 TO  DP132O-REPORT-NUMBER                                
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM DP132O-STANDRD-HEADER-132-COLS                            
W33304           AFTER ADVANCING PAGE                                           
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADER-LINE-1-CUMM                                    
W33304      END-IF                                                              
W33304***  STAT CODE SUBTOTALS                                                  
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-FIN-STAT-BRK-LINE                                     
W33304           AFTER ADVANCING 2                                              
W33304***  'NET SALES AT FULL RETAIL'                                           
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-2-SUM                                    
W33304           AFTER ADVANCING 2                                              
W33304           ADD 2          TO  PV2-LINE-COUNT                              
W33304***  'UNITS     RETAIL      UNITS    RETAIL'                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-3-SUM                                    
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
W33304***  DASHES FOR THE SUBTOTAL LINE                                         
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM TLS-TOTAL-LINE-1                                          
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
W33304***  FIN STAT CODE SUBTOTAL BUCKETS                                       
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM TLS-FIN-STAT-LINE                                         
W33304           AFTER ADVANCING 1                                              
W33304           ADD 50         TO  PV2-LINE-COUNT.                             
W33304                                                                          
W33304*----------------------------------------------------------------*        
W33304*                                                                *        
W33304*----------------------------------------------------------------*        
W33304 6010-NEW-PAGE-FOR-CYCLE-BRK.                                             
W33304                                                                          
W33304     ADD 1                        TO  PV2-LINE-COUNT.                     
W33304        ADD 1                   TO  PV2-PAGE-COUNT                        
W33304        MOVE PV2-PAGE-COUNT     TO  DP132O-PAGE-NUMBER                    
W33304        MOVE 12                 TO  PV2-LINE-COUNT                        
W33304        MOVE PC-5 TO  DP132O-REPORT-NUMBER                                
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM DP132O-STANDRD-HEADER-132-COLS                            
W33304           AFTER ADVANCING PAGE                                           
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADER-LINE-1-CUMM                                    
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304        FROM HLS-CYCLE-BRK-LINE                                           
W33304        AFTER ADVANCING 2                                                 
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-2-SUM                                    
W33304           AFTER ADVANCING 2                                              
W33304           ADD 2          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-3-SUM                                    
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM TLS-TOTAL-LINE-1                                          
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT.                             
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM TLS-CYCLE-LINE                                            
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT.                             
W33304                                                                          
W33304        ADD 50         TO  PV2-LINE-COUNT.                                
W33304                                                                          
W33304*----------------------------------------------------------------*        
W33304*                                                                *        
W33304*----------------------------------------------------------------*        
W33304 6020-NEW-PAGE-WITHIN-STAT.                                               
W33304                                                                          
W33304     ADD 1                        TO  PV2-LINE-COUNT.                     
W33304        ADD 1                   TO  PV2-PAGE-COUNT                        
W33304        MOVE PV2-PAGE-COUNT     TO  DP132O-PAGE-NUMBER                    
W33304        MOVE 12                 TO  PV2-LINE-COUNT                        
W33304        IF WS-RUN-TYPE-DAILY                                              
W33304            MOVE PC-4 TO DP132O-REPORT-NUMBER                             
W33304        ELSE                                                              
W33304            IF WS-RUN-TYPE-CUM                                            
W33304                MOVE PC-5 TO  DP132O-REPORT-NUMBER                        
W33304            ELSE                                                          
W33304                IF WS-RUN-TYPE-ERROR                                      
W33304                    MOVE PC-6 TO  DP132O-REPORT-NUMBER                    
W33304                END-IF                                                    
W33304            END-IF                                                        
W33304        END-IF                                                            
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM DP132O-STANDRD-HEADER-132-COLS                            
W33304           AFTER ADVANCING PAGE                                           
W33304        IF WS-RUN-TYPE-DAILY                                              
W33304            WRITE SUMM-SLS-PCT-REPORT-REC                                 
W33304              FROM HLS-HEADER-LINE-1                                      
W33304        ELSE                                                              
W33304            IF WS-RUN-TYPE-CUM                                            
W33304                WRITE SUMM-SLS-PCT-REPORT-REC                             
W33304                  FROM HLS-HEADER-LINE-1-CUMM                             
W33304            ELSE                                                          
W33304                IF WS-RUN-TYPE-ERROR                                      
W33304                    WRITE SUMM-SLS-PCT-REPORT-REC                         
W33304                      FROM HLS-HEADER-LINE-1-ERROR                        
W33304                END-IF                                                    
W33304            END-IF                                                        
W33304        END-IF                                                            
W33304           IF DP132O-REPORT-NUMBER NOT = PC-4                             
W33304              WRITE SUMM-SLS-PCT-REPORT-REC                               
W33304              FROM HLS-HEADING-LINE-1-CYCLE                               
W33304              AFTER ADVANCING 2                                           
W33304              ADD 2          TO  PV2-LINE-COUNT                           
W33304           END-IF                                                         
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-2                                        
W33304           AFTER ADVANCING 2                                              
W33304           ADD 2          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-3                                        
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT                              
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM HLS-HEADING-LINE-DASHES                                   
W33304           AFTER ADVANCING 1                                              
W33304           ADD 1          TO  PV2-LINE-COUNT.                             
W33304                                                                          
W33304*----------------------------------------------------------------*        
W33304*                                                                *        
W33304*----------------------------------------------------------------*        
W33304 6030-NEW-PAGE-DLY-SUMM.                                                  
W33304                                                                          
W33304     ADD 1                        TO  PV2-LINE-COUNT.                     
W33304        ADD 1                   TO  PV2-PAGE-COUNT                        
W33304        MOVE PV2-PAGE-COUNT     TO  DP132O-PAGE-NUMBER                    
W33304        MOVE 12                 TO  PV2-LINE-COUNT                        
W33304        IF WS-RUN-TYPE-DAILY                                              
W33304            MOVE PC-4 TO DP132O-REPORT-NUMBER                             
W33304        ELSE                                                              
W33304            IF WS-RUN-TYPE-CUM                                            
W33304                MOVE PC-5 TO  DP132O-REPORT-NUMBER                        
W33304            ELSE                                                          
W33304                IF WS-RUN-TYPE-ERROR                                      
W33304                    MOVE PC-6 TO  DP132O-REPORT-NUMBER                    
W33304                END-IF                                                    
W33304            END-IF                                                        
W33304        END-IF                                                            
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304           FROM DP132O-STANDRD-HEADER-132-COLS                            
W33304           AFTER ADVANCING PAGE                                           
W33304        IF WS-RUN-TYPE-DAILY                                              
W33304            WRITE SUMM-SLS-PCT-REPORT-REC                                 
W33304              FROM HLS-HEADER-LINE-1                                      
W33304        ELSE                                                              
W33304            IF WS-RUN-TYPE-CUM                                            
W33304                WRITE SUMM-SLS-PCT-REPORT-REC                             
W33304                  FROM HLS-HEADER-LINE-1-CUMM                             
W33304            ELSE                                                          
W33304                IF WS-RUN-TYPE-ERROR                                      
W33304                    WRITE SUMM-SLS-PCT-REPORT-REC                         
W33304                      FROM HLS-HEADER-LINE-1-ERROR                        
W33304                END-IF                                                    
W33304            END-IF                                                        
W33304        END-IF                                                            
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304                      FROM TLS-CYCLE-99999                                
W33304                                   AFTER ADVANCING 2 LINES                
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304                      FROM HLS-HEADING-LINE-2-SUM                         
W33304                                   AFTER ADVANCING 2 LINES                
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304                      FROM HLS-HEADING-LINE-3-SUM                         
W33304                                   AFTER ADVANCING 1 LINE                 
W33304                                                                          
W33304        WRITE SUMM-SLS-PCT-REPORT-REC                                     
W33304                      FROM TLS-TOTAL-LINE-1 AFTER ADVANCING 1 LINE        
W33304                                                                          
W33304                      .                                                   
       Z999-SQL-ABEND.                                                          
                                                                                
           DISPLAY '**  ABEND     **'.                                          
W26600*    DISPLAY '**  PROGRAM   **  =  INKRP107'.                             
W26600     DISPLAY '**  PROGRAM   **  =  INKRP169'.                             
           DISPLAY '**  OPERATION **  = '  PV-OPER-ATTEMPTED                    
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
                                                                                
           COPY DPPD004.                                                        
                                                                                
           CALL 'ILBOABN0'  USING ABEND-4003.                                   
                                                                                
      ******************************************************************00000100
      *  THIS ROUTINE FORCES AN ABEND DUE TO A NON-DB2 RELATED PROBLEM. 00000200
      ******************************************************************00000300
       9999-ABEND.                                                      00000400
                                                                        00000500
           DISPLAY '*********'                                          00000600
           DISPLAY '**  ABEND     **'.                                  00000700
           DISPLAY '**  PROGRAM   **  =   INKRP169'                     00000800
           DISPLAY '**'                                                 00001100
           DISPLAY '**'                                                 00001200
           DISPLAY '**********************************'                 00001300
           CALL 'ILBOABN0'  USING ABEND-4013.                           00002000
                                                                        00010000
