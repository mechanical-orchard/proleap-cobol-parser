000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             RCKRP025.                                00020001
000300 AUTHOR.                 BUDDY BARNES.                            00030001
000400 DATE-WRITTEN.           OCT 1998.                                00040001
000500 DATE-COMPILED.                                                   00050000
000600******************************************************************00060000
000700*  COPY OF RCKRP018 FOR M.T.D. TOTALING BY STORE WITHIN CLASS     00070001
000800******************************************************************00080061
000900******************************************************************00090062
001000**               P R O G R A M    C H A N G E S                  *00100062
001100******************************************************************00110062
001200** DATE   |      CHANGES                             | REFERENCE *00120062
001300**---------------------------------------------------------------*00130062
001400** 10/98  | ORIGINAL VERSION                         |           *00140062
001500**---------------------------------------------------------------*00150062
001510******************************************************************00151073
001520** 10/14  | INC1024683 MODIFIED PROGRAM TO USE UNIT  | LENIN M   *00152074
001530**        | COST FOR IMPORT PO'S AND PRIVATE LABEL   | TAG :     *00153074
001540**        | DOMESTIC PO'S WHILE FIRST COST FOR       | LM4683    *00154074
001550**        | DOMESTIC PO'S.                           |           *00155074
001560******************************************************************00156074
001561** 10/14  | CHG0098147                               | PRITHIVI  *00156174
001562**        | CHANGES THRU OUT THE PROGRAM TO INCREASE |(COGNIZANT)*00156274
001563**        | THE SIZE OF PO# FROM 7 DIGITS TO 8 DIGITS| TAG :     *00156374
001564**        | THE SIZE OF PO# FROM 7 DIGITS TO 8 DIGITS|PS 10/27/14*00156474
001565******************************************************************00156574
001600******************************************************************00160062
001700 ENVIRONMENT DIVISION.                                            00170062
001800 CONFIGURATION SECTION.                                           00180062
001900 OBJECT-COMPUTER.            IBM-370.                             00190062
002000 SOURCE-COMPUTER.            IBM-370.                             00200062
002100 INPUT-OUTPUT SECTION.                                            00210062
002200 FILE-CONTROL.                                                    00220062
002300 SKIP1                                                            00230062
002400     SELECT STORE-EXTRACT        ASSIGN TO UT-S-INP01.            00240065
002500     SELECT BUYERS-RECEIPTS      ASSIGN TO UT-S-RPT01.            00250065
002600     SELECT CC-RUN-TYPE          ASSIGN TO UT-S-INP03.            00260065
002700 EJECT                                                            00270062
002800 DATA DIVISION.                                                   00280062
002900 FILE SECTION.                                                    00290062
003000 SKIP3                                                            00300062
003100 FD  STORE-EXTRACT                                                00310062
003200     RECORDING MODE IS F                                          00320062
003300     RECORD CONTAINS 550 CHARACTERS                               00330062
003400     BLOCK CONTAINS  0 RECORDS                                    00340062
003500     LABEL RECORDS ARE STANDARD.                                  00350062
003600 SKIP1                                                            00360062
003700 01  STORE-EXTRACT-REC           PIC X(550).                      00370062
003800 SKIP3                                                            00380062
003900 FD  BUYERS-RECEIPTS                                              00390062
004000     RECORDING MODE IS F                                          00400062
004100     RECORD CONTAINS 132 CHARACTERS                               00410062
004200     BLOCK CONTAINS  0 RECORDS                                    00420062
004300     LABEL RECORDS ARE STANDARD.                                  00430062
004400 SKIP1                                                            00440062
004500 01  BUYERS-RECEIPTS-RPT         PIC X(132).                      00450062
004600 SKIP3                                                            00460062
004700 FD  CC-RUN-TYPE                                                  00470062
004800     RECORDING MODE IS F                                          00480062
004900     RECORD CONTAINS 080 CHARACTERS                               00490062
005000     BLOCK CONTAINS  0 RECORDS                                    00500062
005100     LABEL RECORDS ARE STANDARD.                                  00510062
005200 SKIP1                                                            00520062
005300 01  CC-RUN-TYPE-RECORD          PIC X(080).                      00530062
005400 SKIP3                                                            00540062
005500 EJECT                                                            00550062
005600 WORKING-STORAGE SECTION.                                         00560062
005700                                                                  00570062
005800 01  PROGRAM-SWITCHES.                                            00580062
005900     05  PS-EOF-SW               PIC X(01) VALUE 'N'.             00590062
006000         88  PS-EOF              VALUE 'Y'.                       00600062
006100     05  PS-DEPT-BREAK-SW        PIC X(01) VALUE 'N'.             00610062
006200         88  PS-DEPT-BREAK       VALUE 'Y'.                       00620062
006300     05  PS-BYR-BREAK-SW         PIC X(01) VALUE 'N'.             00630062
006400         88  PS-BYR-BREAK        VALUE 'Y'.                       00640062
006500     05  PS-DMM-BREAK-SW         PIC X(01) VALUE 'N'.             00650062
006600         88  PS-DMM-BREAK        VALUE 'Y'.                       00660062
006700     05  PS-GMM-BREAK-SW         PIC X(01) VALUE 'N'.             00670062
006800         88  PS-GMM-BREAK        VALUE 'Y'.                       00680062
006900     05  PS-FINAL-BREAK-SW       PIC X(01) VALUE 'N'.             00690062
007000         88  PS-FINAL-BREAK-SW   VALUE 'Y'.                       00700062
007100     05  SW-WEEKLY-DTL-RECS      PIC X(01) VALUE 'N'.             00710062
007200         88  NO-WEEKLY-DTL-RECS  VALUE 'N'.                       00720062
007300         88  WEEKLY-DTL-RECS     VALUE 'Y'.                       00730062
007400     05  SW-WEEKLY-PO-RECS       PIC X(01) VALUE 'N'.             00740062
007500         88  NO-WEEKLY-PO-RECS   VALUE 'N'.                       00750062
007600         88  WEEKLY-PO-RECS      VALUE 'Y'.                       00760062
007700     05  SW-WEEKLY-CLASS-RECS    PIC X(01) VALUE 'N'.             00770062
007800         88  NO-WEEKLY-CLASS-RECS VALUE 'N'.                      00780062
007900         88  WEEKLY-CLASS-RECS    VALUE 'Y'.                      00790062
008000     05  SW-WEEKLY-MAJ-RECS      PIC X(01) VALUE 'N'.             00800062
008100         88  NO-WEEKLY-MAJ-RECS  VALUE 'N'.                       00810062
008200         88  WEEKLY-MAJ-RECS     VALUE 'Y'.                       00820062
008300     05  SW-WEEKLY-DEPT-RECS     PIC X(01) VALUE 'N'.             00830062
008400         88  NO-WEEKLY-DEPT-RECS VALUE 'N'.                       00840062
008500         88  WEEKLY-DEPT-RECS    VALUE 'Y'.                       00850062
008600********************** RECORD COUNTERS ***************************00860062
008700 77  WS-CNT-DTL                  PIC 9(9)            VALUE 0.     00870062
008800 77  WS-STORE-IN                 PIC S9(5)    COMP-3 VALUE +0.    00880062
008900********************** REPORT COUNTERS ***************************00890062
009000 77  WS-TOTAL-POSEQ-RETAIL       PIC S9(13)V99 COMP-3 VALUE +0.   00900066
009100 77  WS-TOTAL-POSEQ-COST         PIC S9(13)V99 COMP-3 VALUE +0.   00910066
009200 77  WS-TOTAL-POSEQ-UNITS        PIC S9(13)V99 COMP-3 VALUE +0.   00920066
009300 77  WS-TOTAL-PO-RETAIL          PIC S9(13)V99 COMP-3 VALUE +0.   00930066
009400 77  WS-TOTAL-PO-COST            PIC S9(13)V99 COMP-3 VALUE +0.   00940066
009500 77  WS-TOTAL-PO-UNITS           PIC S9(13)V99 COMP-3 VALUE +0.   00950066
009600 77  WS-TOTAL-CLASS-RETAIL       PIC S9(13)V99 COMP-3 VALUE +0.   00960066
009700 77  WS-TOTAL-CLASS-COST         PIC S9(13)V99 COMP-3 VALUE +0.   00970066
009800 77  WS-TOTAL-CLASS-UNITS        PIC S9(13)V99 COMP-3 VALUE +0.   00980066
009900 77  WS-TOTAL-MAJ-CLASS-RETAIL   PIC S9(13)V99 COMP-3 VALUE +0.   00990066
010000 77  WS-TOTAL-MAJ-CLASS-COST     PIC S9(13)V99 COMP-3 VALUE +0.   01000066
010100 77  WS-TOTAL-MAJ-CLASS-UNITS    PIC S9(13)V99 COMP-3 VALUE +0.   01010066
010200 77  WS-TOTAL-DEPT-RETAIL        PIC S9(13)V99 COMP-3 VALUE +0.   01020066
010300 77  WS-TOTAL-DEPT-COST          PIC S9(13)V99 COMP-3 VALUE +0.   01030066
010400 77  WS-TOTAL-DEPT-UNITS         PIC S9(13)V99 COMP-3 VALUE +0.   01040066
010500 77  WS-TOTAL-BYR-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01050066
010600 77  WS-TOTAL-BYR-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01060066
010700 77  WS-TOTAL-BYR-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01070066
010800 77  WS-TOTAL-DMM-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01080066
010900 77  WS-TOTAL-DMM-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01090066
011000 77  WS-TOTAL-DMM-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01100066
011100 77  WS-TOTAL-GMM-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01110066
011200 77  WS-TOTAL-GMM-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01120066
011300 77  WS-TOTAL-GMM-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01130066
011400 77  WS-TOTAL-RPT-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01140066
011500 77  WS-TOTAL-RPT-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01150066
011600 77  WS-TOTAL-RPT-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01160066
011700 77  WS-LINE-CNT                 PIC S9(3)    COMP-3 VALUE +56.   01170062
011800 77  WS-PAGE-CNT                 PIC S9(5)    COMP-3 VALUE +0.    01180062
011900********************** HOLD AREAS/SWITCHES ***********************01190062
012000 77  WS-HOLD-GM                  PIC X(02)     VALUE SPACES.      01200062
012100 77  WS-HOLD-DM                  PIC X(02)     VALUE SPACES.      01210062
012200 77  WS-HOLD-BYR                 PIC X(03)     VALUE SPACES.      01220062
012300 77  WS-MONTH                    PIC X(03)     VALUE SPACES.      01230062
012400 77  WS-HOLD-DEPT                PIC X(03)     VALUE SPACES.      01240062
012500 77  WS-HOLD-CLASS               PIC X(03)     VALUE SPACES.      01250062
012600 77  WS-HOLD-CLASS-NAME          PIC X(25)     VALUE SPACES.      01260062
012700 77  WS-HOLD-MAJ-CLASS           PIC X(02)     VALUE SPACES.      01270062
012800 77  WS-HOLD-MAJ-CLASS-NAME      PIC X(25)     VALUE SPACES.      01280062
012900 77  WS-HOLD-PO                  PIC 9(08)     VALUE ZEROS.       01290062
013000 77  WS-HOLD-REC-SEQ-NBR         PIC 9(09)     VALUE ZEROS.       01300062
013100 77  WS-HOLD-REC-SRC-CDE         PIC X(01)     VALUE SPACES.      01310062
013200 77  WS-HOLD-DEF                 PIC X(03)     VALUE SPACES.      01320062
013300 77  WS-HOLD-ADJ-CYC-NBR         PIC S9(09) COMP VALUE +0.        01330062
013400 77  WS-HOLD-VENDOR-NAME         PIC X(25)     VALUE SPACES.      01340062
013500 77  WS-HOLD-STORE               PIC S9(04) COMP VALUE ZEROS.     01350064
013600 77  WS-HOLD-OPER-UNT-ID         PIC S9(04) COMP VALUE ZEROS.     01360064
013700 77  WS-HOLD-RECEIPT-DATE        PIC X(06)     VALUE SPACES.      01370062
013800 77  WS-HOLD-VERIFY-DATE         PIC X(06)     VALUE SPACES.      01380062
013900 77  WS-HOLD-PRCS-DAYS           PIC 9(03)V9   VALUE ZEROS.       01390062
014000 77  WS-SAVE-MKUP                PIC 9(03)V9(4)-  VALUE ZEROS.    01400062
014100 01  WS-CC                       PIC 9               VALUE 1.     01410062
014200 01  WS-FIRST-TIME-IND           PIC X               VALUE 'X'.   01420062
014300     88  FIRST-TIME                                  VALUE 'X'.   01430062
014400 01  WS-FIRST-TIME-DATE-IND      PIC X               VALUE 'X'.   01440062
014500     88  FIRST-TIME-DATE                             VALUE 'X'.   01450062
014600 01  WS-WK-END-DATE                                  VALUE        01460062
014700                                                       LOW-VALUES.01470062
014800     05  WS-WK-END-CC            PIC XX.                          01480062
014900     05  WS-WK-END-YY            PIC XX.                          01490062
015000     05  WS-WK-END-MM            PIC XX.                          01500062
015100     05  WS-WK-END-DD            PIC XX.                          01510062
015200 01  WS-LAST-DAY-OF-WEEK.                                         01520062
015300     05  WS-LAST-DAY-OF-WEEK-CC  PIC XX.                          01530062
015400     05  WS-LAST-DAY-OF-WEEK-YY  PIC XX.                          01540062
015500     05  FILLER                  PIC X.                           01550062
015600     05  WS-LAST-DAY-OF-WEEK-MM  PIC XX.                          01560062
015700     05  FILLER                  PIC X.                           01570062
015800     05  WS-LAST-DAY-OF-WEEK-DD  PIC XX.                          01580062
015900 01  WS-1ST-DAY-OF-WEEK.                                          01590062
016000     05  WS-1ST-DAY-OF-WEEK-CC   PIC XX.                          01600062
016100     05  WS-1ST-DAY-OF-WEEK-YY   PIC XX.                          01610062
016200     05  FILLER                  PIC X.                           01620062
016300     05  WS-1ST-DAY-OF-WEEK-MM   PIC XX.                          01630062
016400     05  FILLER                  PIC X.                           01640062
016500     05  WS-1ST-DAY-OF-WEEK-DD   PIC XX.                          01650062
016600 01  WS-DATE-VERIFIED-COUNT.                                      01660062
016700     05  WS-DATE-VFYD-COUNT-MM   PIC XX.                          01670062
016800     05  WS-DATE-VFYD-COUNT-DD   PIC XX.                          01680062
016900     05  WS-DATE-VFYD-COUNT-YY   PIC XX.                          01690062
017000 01  WS-DATE-VERIFIED-PRT.                                        01700062
017100     05  WS-DATE-VERIFIED-PRT-MM PIC XX.                          01710062
017200     05  FILLER                  PIC X     VALUE '/'.             01720062
017300     05  WS-DATE-VERIFIED-PRT-DD PIC XX.                          01730062
017400     05  FILLER                  PIC X     VALUE '/'.             01740000
017500     05  WS-DATE-VERIFIED-PRT-YY PIC XX.                          01750062
017600 01  WS-DATE-RECEIVED.                                            01760000
017700     05  WS-DATE-RECEIVED-MM     PIC XX.                          01770000
017800     05  WS-DATE-RECEIVED-DD     PIC XX.                          01780000
017900     05  WS-DATE-RECEIVED-YY     PIC XX.                          01790000
018000 01  WS-DATE-RECEIVED-PRT.                                        01800000
018100     05  WS-DATE-RECEIVED-PRT-MM PIC XX.                          01810000
018200     05  FILLER                  PIC X     VALUE '/'.             01820000
018300     05  WS-DATE-RECEIVED-PRT-DD PIC XX.                          01830000
018400     05  FILLER                  PIC X     VALUE '/'.             01840000
018500     05  WS-DATE-RECEIVED-PRT-YY PIC XX.                          01850000
018600 01  WS-COMPARE-DATE.                                             01860000
018700     05  WS-COMPARE-DATE-CC      PIC XX.                          01870000
018800     05  WS-COMPARE-DATE-YY      PIC XX.                          01880000
018900     05  WS-COMPARE-DATE-MM      PIC XX.                          01890000
019000     05  WS-COMPARE-DATE-DD      PIC XX.                          01900000
019100 01  WS-DATE.                                                     01910000
019200     05  WS-DATE-YY              PIC XX.                          01920000
019300     05  WS-DATE-MM              PIC XX.                          01930000
019400     05  WS-DATE-DD              PIC XX.                          01940000
019500 01  WS-DATE-CCYYMMDD.                                            01950062
019600     05  WS-DATE-CCYYMMDD-CC     PIC XX.                          01960062
019700     05  WS-DATE-CCYYMMDD-YY     PIC XX.                          01970062
019800     05  WS-DATE-CCYYMMDD-MM     PIC XX.                          01980062
019900     05  WS-DATE-CCYYMMDD-DD     PIC XX.                          01990062
020000 01  WS-HOLD-TCOCNTL-DATE.                                        02000062
020100     05  WS-HOLD-TCOCNTL-CC      PIC XX.                          02010062
020200     05  WS-HOLD-TCOCNTL-YY      PIC XX.                          02020062
020300     05  FILLER                  PIC X.                           02030062
020400     05  WS-HOLD-TCOCNTL-MM      PIC XX.                          02040062
020500     05  FILLER                  PIC X.                           02050062
020600     05  WS-HOLD-TCOCNTL-DD      PIC XX.                          02060062
020700 01  WS-TIME.                                                     02070000
020800     05  WS-TIME-HH              PIC 99.                          02080000
020900     05  WS-TIME-MM              PIC 99.                          02090000
021000     05  WS-TIME-SS              PIC 99.                          02100000
021100                                                                  02110000
021200 01  WS-RUN-TYPE-RECORD.                                          02120000
021300     05  WS-RUN-TYPE             PIC X      VALUE ' '.            02130020
021400         88  WEEKLY-RUN          VALUE 'W'.                       02140000
021500         88  MONTHLY-RUN         VALUE 'M'.                       02150000
021600     05  FILLER                  PIC X(79).                       02160000
021700                                                                  02170000
021800 01  WS-HDR3-WEEK.                                                02180000
021900     05  FILLER              PIC X(43)       VALUE                02190000
022000     'VERIFIED COUNT INFORMATION FOR THE WEEK OF '.               02200000
022100     05  WS-HDR3-MM          PIC XX          VALUE SPACES.        02210000
022200     05  FILLER              PIC X           VALUE '/'.           02220000
022300     05  WS-HDR3-DD          PIC XX          VALUE SPACES.        02230000
022400     05  FILLER              PIC X           VALUE '/'.           02240000
022500     05  WS-HDR3-CC          PIC XX          VALUE SPACES.        02250000
022600     05  WS-HDR3-YY          PIC XX          VALUE SPACES.        02260000
022700     05  FILLER              PIC X(17)       VALUE SPACES.        02270055
022800     05  WS-HDR3-WEEKJOB     PIC X(08)       VALUE SPACES.        02280055
022900                                                                  02290056
023000 01  WS-HDR3-MONTH.                                               02300000
023100     05  FILLER              PIC X(43)       VALUE                02310000
023200     'VERIFIED COUNT INFORMATION FOR THE MONTH OF'.               02320000
023300     05  FILLER              PIC X           VALUE SPACES.        02330000
023400     05  WS-HDR3-MONTH-ABBR  PIC X(03)       VALUE SPACES.        02340000
023500     05  FILLER              PIC X           VALUE '.'.           02350000
023600     05  FILLER              PIC X           VALUE SPACES.        02360000
023700     05  WS-HDR3-MONTH-CC    PIC XX          VALUE SPACES.        02370000
023800     05  WS-HDR3-MONTH-YY    PIC XX          VALUE SPACES.        02380000
023900     05  FILLER              PIC X(17)       VALUE SPACES.        02390055
024000     05  WS-HDR3-MNTHJOB     PIC X(08)       VALUE SPACES.        02400055
024100                                                                  02410000
024200 01  WS-MISC-INFO.                                                02420000
024300     05  DEPT-FOUND-SW                     PIC X      VALUE 'N'.  02430000
024400         88  DEPT-FOUND                               VALUE 'Y'.  02440000
024500         88  DEPT-NOT-FOUND                           VALUE 'N'.  02450000
024600     05  END-OF-DEPT-SW                    PIC X      VALUE 'N'.  02460000
024700         88  END-OF-DEPT-CSR                          VALUE 'Y'.  02470000
024800         88  NOT-END-OF-DEPT-CSR                      VALUE 'N'.  02480000
024900     05  PC-MAX-RETRIES                    PIC S9(4)  VALUE +3    02490000
025000                                                      COMP-3.     02500000
025100     05  PC-MORE-THAN-MAX-RETRY            PIC S9(4)  VALUE +4.   02510000
025200     05  PV-PARAGRAPH-NAME                 PIC X(30).             02520000
025300     05  PV-DB2-OPERATION                  PIC X(30)  VALUE SPACE.02530000
025400     05  PV-RETRY-CNT                      PIC S9(04) VALUE +0    02540000
025500                                                      COMP SYNC.  02550000
025600     05  PV-DEPT-NBR-X                   PIC X(03).               02560000
025700     05  FILLER  REDEFINES  PV-DEPT-NBR-X.                        02570000
025800         10  PV-DEPT-NBR-9               PIC 9(03).               02580000
025900     05  PV-DEPT-NBR-B                   PIC S9(04) VALUE +0      02590000
026000                                             COMP SYNC.           02600000
026100     05  PV-MAX-DEPT-TBL-RECS            PIC S9(05) VALUE +999    02610000
026200                                             COMP-3.              02620000
026300     05  PV-NBR-DEPT-TBL-RECS            PIC S9(05) VALUE +0      02630000
026400                                             COMP-3.              02640000
026500     05  PV-HOLD-REC-SEQ-NBR-1-3 PIC 9(03).                       02650000
026600     05  FILLER  REDEFINES  PV-HOLD-REC-SEQ-NBR-1-3.              02660000
026700         10  PV-HOLD-REC-SEQ-NBR-1   PIC X(01).                   02670000
026800         10  PV-HOLD-REC-SEQ-NBR-2   PIC X(01).                   02680000
026900         10  PV-HOLD-REC-SEQ-NBR-3   PIC X(01).                   02690000
027000     05  PV-MAX-STORE-RECS               PIC S9(05) VALUE +0      02700016
027100                                             COMP-3.              02710016
027200     05  PV-MAX-STORE-RECS-DEPT          PIC S9(05) VALUE +0      02720020
027300                                             COMP-3.              02730020
027310                                                                  02731075
027320     05  PV-DISP-TABLE-IDX               PIC S9(04) COMP.         02732075
027330     05  PV-DISP-IDX                     PIC 9(04).               02733075
027340     05  PV-DISP-COUNT                   PIC ZZZ,ZZZ,ZZ9.         02734075
027350     05  PV-SE-STR-EXT-COUNT             PIC 9(09) VALUE ZEROES.  02735075
027360     05  PV-WKLY-RCPT-CNT                PIC 9(09) VALUE ZEROES.  02736075
027370     05  PV-DEPT-NO-RCPT-CNT             PIC 9(09) VALUE ZEROES.  02737075
027380     05  PV-RPT-DTL-LINE-CNT             PIC 9(09) VALUE ZEROES.  02738075
027390                                                                  02739075
027400                                                                  02740000
027500 01  DT-SAVE-STORE-TABLE.                                         02750003
027600     05  DT-SAVE-STORE-TBL  OCCURS 9999 TIMES                     02760064
027700                  INDEXED BY IDX-SAVE.                            02770006
027800         10  DT-SAVE-STORE-NBR     PIC S9(04) COMP.               02780064
027900         10  DT-SAVE-STORE-WEEK-RETAIL                            02790003
028000                                   PIC S9(13)V99 COMP-3 VALUE +0. 02800066
028100         10  DT-SAVE-STORE-WEEK-COST                              02810003
028200                                   PIC S9(13)V99 COMP-3 VALUE +0. 02820066
028300         10  DT-SAVE-STORE-MTD-RETAIL                             02830003
028400                                   PIC S9(13)V99 COMP-3 VALUE +0. 02840066
028500         10  DT-SAVE-STORE-MTD-COST                               02850003
028600                                   PIC S9(13)V99 COMP-3 VALUE +0. 02860066
028700                                                                  02870001
028800 01  DT-STORE-TABLE.                                              02880003
028900     05  DT-STORE-TBL  OCCURS 9999 TIMES                          02890064
029000                  INDEXED BY IDX-STORE.                           02900003
029100         10  DT-STORE-NBR          PIC S9(04) COMP.               02910064
029200         10  DT-STORE-WEEK-RETAIL                                 02920003
029300                                   PIC S9(13)V99 COMP-3 VALUE +0. 02930066
029400         10  DT-STORE-WEEK-COST                                   02940003
029500                                   PIC S9(13)V99 COMP-3 VALUE +0. 02950066
029600         10  DT-STORE-MTD-RETAIL                                  02960003
029700                                   PIC S9(13)V99 COMP-3 VALUE +0. 02970066
029800         10  DT-STORE-MTD-COST                                    02980003
029900                                   PIC S9(13)V99 COMP-3 VALUE +0. 02990066
030000                                                                  03000003
030100 01  DT-SAVE-STORE-TABLE-DEPT.                                    03010020
030200     05  DT-SAVE-STORE-TBL-DEPT  OCCURS 9999 TIMES                03020064
030300                  INDEXED BY IDX-SAVE-DEPT.                       03030020
030400         10  DT-SAVE-STORE-NBR-DEPT     PIC S9(04) COMP.          03040064
030500         10  DT-SAVE-STORE-WEEK-RETAIL-DEPT                       03050020
030600                                   PIC S9(13)V99 COMP-3 VALUE +0. 03060066
030700         10  DT-SAVE-STORE-WEEK-COST-DEPT                         03070020
030800                                   PIC S9(13)V99 COMP-3 VALUE +0. 03080066
030900         10  DT-SAVE-STORE-MTD-RETAIL-DEPT                        03090020
031000                                   PIC S9(13)V99 COMP-3 VALUE +0. 03100066
031100         10  DT-SAVE-STORE-MTD-COST-DEPT                          03110020
031200                                   PIC S9(13)V99 COMP-3 VALUE +0. 03120066
031300                                                                  03130020
031400 01  DT-STORE-TABLE-DEPT.                                         03140020
031500     05  DT-STORE-TBL-DEPT  OCCURS 9999 TIMES                     03150064
031600                  INDEXED BY IDX-STORE-DEPT.                      03160020
031700         10  DT-STORE-NBR-DEPT     PIC S9(04) COMP.               03170064
031800         10  DT-STORE-WEEK-RETAIL-DEPT                            03180020
031900                                   PIC S9(13)V99 COMP-3 VALUE +0. 03190066
032000         10  DT-STORE-WEEK-COST-DEPT                              03200020
032100                                   PIC S9(13)V99 COMP-3 VALUE +0. 03210066
032200         10  DT-STORE-MTD-RETAIL-DEPT                             03220020
032300                                   PIC S9(13)V99 COMP-3 VALUE +0. 03230066
032400         10  DT-STORE-MTD-COST-DEPT                               03240020
032500                                   PIC S9(13)V99 COMP-3 VALUE +0. 03250066
032600*                                                                 03260069
032601 01  PV-PO-NBR                     PIC S9(9)  VALUE ZEROS         03260174
032602                                              COMP.               03260274
032603 01  WS-PO-BEING-PROCESSED         PIC 9(09)  VALUE ZEROS.        03260374
032604 01  WS-COST-EXTENSION             PIC S9(9)V99.                  03260474
032700 01  ABEND-CODE                    PIC S9(04)     VALUE +0        03270020
032800                                                     COMP SYNC.   03280001
032900     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 03290001
033000     88  ABEND-4002-READ-ERROR                  VALUE +4002.      03300001
033100     88  ABEND-4003-CTRL-CARD-ERROR             VALUE +4003.      03310001
033200     88  ABEND-4004-TABLE-ERROR                 VALUE +4004.      03320001
033300     88  ABEND-4005-OPEN-ERROR                  VALUE +4005.      03330001
033400     88  ABEND-4006-CLOSE-ERROR                 VALUE +4006.      03340001
033500     88  ABEND-4007-SEQUENCE-ERROR              VALUE +4007.      03350001
033600     88  ABEND-4008-DATS-ERROR                  VALUE +4008.      03360001
033700     88  ABEND-4009-KEY-DATS-ERROR              VALUE +4009.      03370001
033800     88  ABEND-4013-DB2-ERROR                   VALUE +4013.      03380001
033900     88  ABEND-4019-DATE-ROUTINE                VALUE +4019.      03390001
034000                                                                  03400000
034100 01  PROGRAM-CONSTANTS.                                           03410000
034200     05  PC-DPKUT500             PIC X(08)  VALUE 'DPKUT500'.     03420000
034300                                                                  03430000
034400                                                                  03440000
034500*********************** STORE WORK RECORD IN ******************** 03450000
034600     COPY RCRD043.                                                03460064
034700                                                                  03470000
034800**************************************************                03480000
034900*  WORK AREA FOR DPKUT500 DATE ROUTINE           *                03490000
035000**************************************************                03500000
035100     COPY DPWS500.                                                03510064
035200                                                                  03520000
035300************************ HEADER/DETIAL LINES *********************03530000
035400     COPY DPWS132O.                                               03540064
035500                                                                  03550000
035600 01  WS-HEADER2.                                                  03560000
035700     05  FILLER              PIC X(55)       VALUE SPACES.        03570000
035800     05  FILLER              PIC X(77)       VALUE                03580000
035900     'BUYER RECEIPTS JOURNAL'.                                    03590000
036000                                                                  03600000
036100 01  WS-HEADER3.                                                  03610000
036200     05  FILLER              PIC X(40)       VALUE SPACES.        03620000
036300     05  WS-HDR3             PIC X(78)       VALUE SPACES.        03630056
036400     05  FILLER              PIC X(14)       VALUE SPACES.        03640056
036500                                                                  03650000
036600 01  WS-HEADER4.                                                  03660000
036700     05  FILLER              PIC X(01)       VALUE SPACES.        03670000
036800     05  FILLER              PIC X(06)       VALUE                03680000
036900     'GMM:  '.                                                    03690000
037000     05  WS-HDR4-GMM-NO      PIC X(02)       VALUE SPACES.        03700000
037100     05  FILLER              PIC X(03)       VALUE SPACES.        03710000
037200     05  WS-HDR4-GMM-NAME    PIC X(30)       VALUE SPACES.        03720000
037300     05  FILLER              PIC X(90)       VALUE SPACES.        03730000
037400                                                                  03740000
037500 01  WS-HEADER5.                                                  03750000
037600     05  FILLER              PIC X(01)       VALUE SPACES.        03760000
037700     05  FILLER              PIC X(06)       VALUE                03770000
037800     'DMM:  '.                                                    03780000
037900     05  WS-HDR5-DMM-NO      PIC X(02)       VALUE SPACES.        03790000
038000     05  FILLER              PIC X(03)       VALUE SPACES.        03800000
038100     05  WS-HDR5-DMM-NAME    PIC X(30)       VALUE SPACES.        03810000
038200     05  FILLER              PIC X(90)       VALUE SPACES.        03820000
038300                                                                  03830000
038400 01  WS-HEADER6.                                                  03840000
038500     05  FILLER              PIC X(01)       VALUE SPACES.        03850000
038600     05  FILLER              PIC X(06)       VALUE                03860000
038700     'BYR:  '.                                                    03870000
038800     05  WS-HDR6-BYR-NO      PIC X(03)       VALUE SPACES.        03880000
038900     05  FILLER              PIC X(02)       VALUE SPACES.        03890000
039000     05  WS-HDR6-BYR-NAME    PIC X(30)       VALUE SPACES.        03900000
039100     05  FILLER              PIC X(90)       VALUE SPACES.        03910000
039200                                                                  03920000
039300 01  WS-HEADER7.                                                  03930000
039400     05  FILLER              PIC X(01)       VALUE SPACES.        03940000
039500     05  FILLER              PIC X(06)       VALUE                03950000
039600     'DPT:  '.                                                    03960000
039700     05  WS-HDR7-DEPARTMENT  PIC X(03)       VALUE SPACES.        03970000
039800     05  FILLER              PIC X(02)       VALUE SPACES.        03980000
039900     05  WS-HDR7-DEPT-NAME   PIC X(25)       VALUE SPACES.        03990000
040000     05  FILLER              PIC X(95)       VALUE SPACES.        04000000
040100                                                                  04010000
040200 01  WS-HEADER8.                                                  04020000
040300     05  FILLER              PIC X(01)       VALUE SPACES.        04030000
040400     05  FILLER              PIC X(11)       VALUE                04040000
040500     'PO/SEQ     '.                                               04050000
040600     05  FILLER              PIC X(01)       VALUE SPACES.        04060000
040700     05  FILLER              PIC X(25)       VALUE SPACES.        04070000
040800     05  FILLER              PIC X(02)       VALUE SPACES.        04080000
040900     05  FILLER              PIC X(03)       VALUE                04090000
041000     'CLS'.                                                       04100000
041100     05  FILLER              PIC X(01)       VALUE SPACES.        04110000
041200     05  FILLER              PIC X(05)       VALUE                04120000
041300     'REC  '.                                                     04130000
041400     05  FILLER              PIC X(01)       VALUE SPACES.        04140000
041500     05  FILLER              PIC X(08)       VALUE                04150000
041600     ' RECEIPT'.                                                  04160000
041700     05  FILLER              PIC X(02)       VALUE SPACES.        04170000
041800     05  FILLER              PIC X(08)       VALUE                04180000
041900     ' VERIFY '.                                                  04190000
042000     05  FILLER              PIC X(01)       VALUE SPACES.        04200000
042100     05  FILLER              PIC X(04)       VALUE                04210000
042200     '# OF'.                                                      04220000
042300     05  FILLER              PIC X(01)       VALUE SPACES.        04230000
042400     05  FILLER              PIC X(12)       VALUE                04240000
042500     '    UNITS   '.                                              04250000
042600     05  FILLER              PIC X(01)       VALUE SPACES.        04260000
042700     05  FILLER              PIC X(16)       VALUE                04270000
042800     '      COST      '.                                          04280000
042900     05  FILLER              PIC X(01)       VALUE SPACES.        04290000
043000     05  FILLER              PIC X(16)       VALUE                04300000
043100     '     RETAIL     '.                                          04310000
043200     05  FILLER              PIC X(01)       VALUE SPACES.        04320000
043300     05  FILLER              PIC X(06)       VALUE                04330000
043400     ' MKUP '.                                                    04340000
043500     05  FILLER              PIC X(04)       VALUE SPACES.        04350000
043600                                                                  04360000
043700 01  WS-HEADER9.                                                  04370000
043800     05  FILLER              PIC X(01)       VALUE SPACES.        04380000
043900     05  FILLER              PIC X(11)       VALUE                04390000
044000     'NUMBER     '.                                               04400000
044100     05  FILLER              PIC X(01)       VALUE SPACES.        04410000
044200     05  FILLER              PIC X(25)       VALUE                04420000
044300     'VENDOR NAME              '.                                 04430000
044400     05  FILLER              PIC X(02)       VALUE SPACES.        04440000
044500     05  FILLER              PIC X(03)       VALUE                04450000
044600     'NUM'.                                                       04460000
044700     05  FILLER              PIC X(01)       VALUE SPACES.        04470000
044800     05  FILLER              PIC X(05)       VALUE                04480000
044900     'LOCAT'.                                                     04490000
045000     05  FILLER              PIC X(01)       VALUE SPACES.        04500000
045100     05  FILLER              PIC X(08)       VALUE                04510000
045200     '  DATE  '.                                                  04520000
045300     05  FILLER              PIC X(02)       VALUE SPACES.        04530000
045400     05  FILLER              PIC X(08)       VALUE                04540000
045500     '  DATE  '.                                                  04550000
045600     05  FILLER              PIC X(01)       VALUE SPACES.        04560000
045700     05  FILLER              PIC X(04)       VALUE                04570000
045800     'DAYS'.                                                      04580000
045900     05  FILLER              PIC X(01)       VALUE SPACES.        04590000
046000     05  FILLER              PIC X(12)       VALUE                04600000
046100     '   VERIFIED '.                                              04610000
046200     05  FILLER              PIC X(01)       VALUE SPACES.        04620000
046300     05  FILLER              PIC X(16)       VALUE                04630000
046400     '    VERIFIED    '.                                          04640000
046500     05  FILLER              PIC X(01)       VALUE SPACES.        04650000
046600     05  FILLER              PIC X(16)       VALUE                04660000
046700     '    VERIFIED    '.                                          04670000
046800     05  FILLER              PIC X(01)       VALUE SPACES.        04680000
046900     05  FILLER              PIC X(06)       VALUE                04690000
047000     '  %   '.                                                    04700000
047100     05  FILLER              PIC X(01)       VALUE SPACES.        04710000
047200     05  FILLER              PIC X(04)       VALUE                04720000
047300     'NOTE'.                                                      04730000
047400                                                                  04740000
047500 01  WS-HEADER10.                                                 04750000
047600     05  FILLER              PIC X(01)       VALUE SPACES.        04760000
047700     05  FILLER              PIC X(11)       VALUE                04770000
047800     '-----------'.                                               04780000
047900     05  FILLER              PIC X(01)       VALUE SPACES.        04790000
048000     05  FILLER              PIC X(25)       VALUE                04800000
048100     '-------------------------'.                                 04810000
048200     05  FILLER              PIC X(02)       VALUE SPACES.        04820000
048300     05  FILLER              PIC X(03)       VALUE                04830000
048400     '---'.                                                       04840000
048500     05  FILLER              PIC X(01)       VALUE SPACES.        04850000
048600     05  FILLER              PIC X(05)       VALUE                04860000
048700     '-----'.                                                     04870000
048800     05  FILLER              PIC X(01)       VALUE SPACES.        04880000
048900     05  FILLER              PIC X(08)       VALUE                04890000
049000     '--------'.                                                  04900000
049100     05  FILLER              PIC X(02)       VALUE SPACES.        04910000
049200     05  FILLER              PIC X(08)       VALUE                04920000
049300     '--------'.                                                  04930000
049400     05  FILLER              PIC X(01)       VALUE SPACES.        04940000
049500     05  FILLER              PIC X(04)       VALUE                04950000
049600     '----'.                                                      04960000
049700     05  FILLER              PIC X(01)       VALUE SPACES.        04970000
049800     05  FILLER              PIC X(12)       VALUE                04980000
049900     '-----------'.                                               04990000
050000     05  FILLER              PIC X(01)       VALUE SPACES.        05000000
050100     05  FILLER              PIC X(16)       VALUE                05010000
050200     '---------------'.                                           05020000
050300     05  FILLER              PIC X(01)       VALUE SPACES.        05030000
050400     05  FILLER              PIC X(16)       VALUE                05040000
050500     '---------------'.                                           05050000
050600     05  FILLER              PIC X(01)       VALUE SPACES.        05060000
050700     05  FILLER              PIC X(06)       VALUE                05070000
050800     '------'.                                                    05080000
050900     05  FILLER              PIC X(01)       VALUE SPACES.        05090000
051000     05  FILLER              PIC X(04)       VALUE                05100000
051100     '----'.                                                      05110000
051200                                                                  05120000
051300 01  WS-DETAIL.                                                   05130000
051400     05  FILLER              PIC X(01)       VALUE SPACES.        05140000
051500*PS 10/27/14 CHANGE STARTS                                        05150072
051510     05  WS-DTL-PO-NUMBER    PIC Z(08)       VALUE ZERO.          05151074
051520*PS 10/27/14 CHANGE ENDS                                          05152072
051600     05  WS-DASH1            PIC X(01)       VALUE SPACES.        05160000
051700     05  WS-DTL-REC-SEQ      PIC X(03)       VALUE SPACES.        05170000
051800     05  FILLER              PIC X(01)       VALUE SPACES.        05180000
051900     05  WS-DTL-VENDOR-NAME  PIC X(25)       VALUE SPACES.        05190000
052000     05  FILLER              PIC X(02)       VALUE SPACES.        05200000
052100     05  WS-DTL-CLASS        PIC X(02)       VALUE SPACES.        05210000
052200     05  FILLER              PIC X(02)       VALUE SPACES.        05220000
052300     05  WS-DTL-REC-LOC      PIC X(04)       VALUE SPACES.        05230000
052400     05  FILLER              PIC X(02)       VALUE SPACES.        05240000
052500     05  WS-DTL-REC-DATE     PIC X(08)       VALUE SPACES.        05250000
052600     05  FILLER              PIC X(02)       VALUE SPACES.        05260000
052700     05  WS-DTL-VRFD-DATE    PIC X(08)       VALUE SPACES.        05270000
052800     05  FILLER              PIC X(01)       VALUE SPACES.        05280000
052900     05  WS-DTL-PRCS-DAYS    PIC ZZ.9        VALUE ZEROS.         05290000
053000     05  FILLER              PIC X(01)       VALUE SPACES.        05300000
053100     05  WS-DTL-UNIT-TOTAL   PIC ZZZ,ZZZ,ZZZ- VALUE ZEROS.        05310000
053200     05  FILLER              PIC X(01)       VALUE SPACES.        05320000
053300     05  WS-DTL-TOTAL-COST   PIC $$$$,$$$,$$$.99-                 05330000
053400                                             VALUE ZEROS.         05340000
053500     05  FILLER              PIC X(01)       VALUE SPACES.        05350000
053600     05  WS-DTL-TOTAL-RETAIL PIC $$$$,$$$,$$$.99-                 05360000
053700                                             VALUE ZEROS.         05370000
053800     05  FILLER              PIC X(01)       VALUE SPACES.        05380000
053900     05  WS-DTL-MKUP         PIC ZZZ.9       VALUE ZEROS.         05390000
054000     05  WS-PCT1             PIC X(01)       VALUE SPACES.        05400000
054100     05  FILLER              PIC X(01)       VALUE SPACES.        05410000
054200     05  WS-DTL-DEF          PIC X(03)       VALUE SPACES.        05420000
054300                                                                  05430000
054400 01  WS-TOTAL-LINE1.                                              05440000
054500     05  FILLER              PIC X(19)       VALUE SPACES.        05450000
054600     05  WS-TTL-LIT-A        PIC X(11)       VALUE SPACES.        05460000
054700     05  WS-TTL-LIT-B        PIC X(02)       VALUE SPACES.        05470000
054800     05  FILLER              PIC X(02)       VALUE SPACES.        05480000
054900     05  WS-TTL-LIT-C        PIC X(25)       VALUE SPACES.        05490000
055000     05  WS-TTL-LIT-1        PIC X(12)       VALUE SPACES.        05500000
055100     05  FILLER              PIC X(03)       VALUE SPACES.        05510000
055200     05  WS-TTL-UNIT-TOTAL1  PIC ZZZ,ZZZ,ZZZ- VALUE ZEROS.        05520000
055300     05  FILLER              PIC X(01)       VALUE SPACES.        05530000
055400     05  WS-TTL-TOTAL-COST1  PIC $$$$,$$$,$$$.99-                 05540000
055500                                             VALUE ZEROS.         05550000
055510     05  FILLER  REDEFINES  WS-TTL-TOTAL-COST1.                   05551068
055520         10  WS-TTL-TOTAL-COST1-RD                                05552068
055530                             PIC $$$$$,$$$,$$$.99.                05553068
055600     05  FILLER              PIC X(01)       VALUE SPACES.        05560000
055700     05  WS-TTL-TOTAL-RETAIL1 PIC $$$$,$$$,$$$.99-                05570000
055800                                             VALUE ZEROS.         05580000
055830     05  FILLER  REDEFINES  WS-TTL-TOTAL-RETAIL1.                 05583066
055840         10  WS-TTL-TOTAL-RETAIL1-RD                              05584066
055850                             PIC $$$$$,$$$,$$$.99.                05585066
055900     05  FILLER              PIC X(01)       VALUE SPACES.        05590000
056000     05  WS-TTL-MKUP1        PIC ZZZ.9       VALUE ZEROS.         05600000
056100     05  WS-TTL-PCT1         PIC X(01)       VALUE SPACES.        05610000
056200     05  FILLER              PIC X(06)       VALUE SPACES.        05620000
056300                                                                  05630000
056400 01  WS-TOTAL-LINE2.                                              05640000
056500     05  FILLER              PIC X(59)       VALUE SPACES.        05650000
056600     05  WS-TTL-LIT-2        PIC X(12)       VALUE SPACES.        05660000
056700     05  FILLER              PIC X(03)       VALUE SPACES.        05670000
056800     05  WS-TTL-UNIT-TOTAL   PIC ZZZ,ZZZ,ZZZ- VALUE ZEROS.        05680000
056900     05  FILLER              PIC X(01)       VALUE SPACES.        05690000
057000     05  WS-TTL-TOTAL-COST   PIC $$$$,$$$,$$$.99-                 05700000
057100                                             VALUE ZEROS.         05710000
057110     05  FILLER  REDEFINES  WS-TTL-TOTAL-COST.                    05711068
057120         10  WS-TTL-TOTAL-COST-RD                                 05712068
057130                             PIC $$$$$,$$$,$$$.99.                05713068
057200     05  FILLER              PIC X(01)       VALUE SPACES.        05720000
057300     05  WS-TTL-TOTAL-RETAIL PIC $$$$,$$$,$$$.99-                 05730000
057400                                             VALUE ZEROS.         05740000
057410     05  FILLER  REDEFINES  WS-TTL-TOTAL-RETAIL.                  05741066
057420         10  WS-TTL-TOTAL-RETAIL-RD                               05742066
057430                             PIC $$$$$,$$$,$$$.99.                05743066
057500     05  FILLER              PIC X(01)       VALUE SPACES.        05750000
057600     05  WS-TTL-MKUP         PIC ZZZ.9       VALUE ZEROS.         05760000
057700     05  WS-TTL-PCT          PIC X(01)       VALUE SPACES.        05770000
057800     05  FILLER              PIC X(06)       VALUE SPACES.        05780000
057900                                                                  05790000
058000 01  WS-TOTAL-DASH.                                               05800000
058100     05  FILLER              PIC X(74)       VALUE SPACES.        05810000
058200     05  FILLER              PIC X(12)                            05820000
058300                             VALUE '------------'.                05830000
058400     05  FILLER              PIC X(01)       VALUE SPACES.        05840000
058500     05  FILLER              PIC X(16)                            05850000
058600                             VALUE '----------------'.            05860000
058700     05  FILLER              PIC X(01)       VALUE SPACES.        05870000
058800     05  FILLER              PIC X(16)                            05880000
058900                             VALUE '----------------'.            05890000
059000     05  FILLER              PIC X(01)       VALUE SPACES.        05900000
059100     05  FILLER              PIC X(06)                            05910000
059200                             VALUE '------'.                      05920000
059300     05  FILLER              PIC X(03)       VALUE SPACES.        05930000
059400                                                                  05940007
059500 01  STORE-TBL-HEAD1-DEPT.                                        05950020
059600     05  FILLER              PIC X(02)       VALUE SPACES.        05960016
059700     05  FILLER              PIC X(08)       VALUE                05970020
059800     '** DEPT '.                                                  05980020
059900     05  STORE-TBL-HEAD1-DPT PIC X(03)       VALUE SPACES.        05990021
060000     05  FILLER              PIC X(10)       VALUE                06000007
060100     ' TOTALS **'.                                                06010010
060200     05  FILLER              PIC X(110)      VALUE SPACES.        06020007
060300                                                                  06030020
060400 01  STORE-TBL-HEAD1.                                             06040020
060500     05  FILLER              PIC X(02)       VALUE SPACES.        06050020
060600     05  FILLER              PIC X(09)       VALUE                06060020
060700     '** CLASS '.                                                 06070020
060800     05  STORE-TBL-HEAD1-MAJ PIC X(02)       VALUE SPACES.        06080020
060900     05  FILLER              PIC X(10)       VALUE                06090020
061000     ' TOTALS **'.                                                06100020
061100     05  FILLER              PIC X(110)      VALUE SPACES.        06110020
061200                                                                  06120000
061300 01  STORE-TBL-HEAD2.                                             06130007
061400     05  FILLER              PIC X(05)       VALUE SPACES.        06140013
061500     05  FILLER              PIC X(09)       VALUE SPACES.        06150018
061600     05  STORE-TBL-HEAD2-TW1 PIC X(19)       VALUE                06160023
061700     '---- THIS WEEK ----'.                                       06170007
061800     05  FILLER              PIC X(01)       VALUE SPACES.        06180013
061900     05  FILLER              PIC X(10)       VALUE SPACES.        06190013
062000     05  FILLER              PIC X(19)       VALUE                06200023
062100     '-- MONTH-TO-DATE --'.                                       06210007
062200     05  FILLER              PIC X(01)       VALUE SPACES.        06220013
062300     05  FILLER              PIC X(06)       VALUE SPACES.        06230013
062400     05  FILLER              PIC X(10)       VALUE SPACES.        06240013
062500     05  STORE-TBL-HEAD2-TW2 PIC X(19)       VALUE                06250023
062600     '---- THIS WEEK ----'.                                       06260007
062700     05  FILLER              PIC X(01)       VALUE SPACES.        06270013
062800     05  FILLER              PIC X(10)       VALUE SPACES.        06280007
062900     05  FILLER              PIC X(19)       VALUE                06290007
063000     '-- MONTH-TO-DATE --'.                                       06300007
063100     05  FILLER              PIC X(01)       VALUE SPACES.        06310013
063200                                                                  06320007
063300 01  STORE-TBL-HEAD3.                                             06330007
063400     05  FILLER              PIC X(02)       VALUE SPACES.        06340016
063500     05  FILLER              PIC X(03)       VALUE 'STR'.         06350013
063600     05  FILLER              PIC X(01)       VALUE SPACES.        06360013
063700     05  STORE-TBL-HEAD3-CS1 PIC X(14)       VALUE                06370023
063800         '        COST  '.                                        06380013
063900     05  FILLER              PIC X(01)       VALUE SPACES.        06390007
064000     05  STORE-TBL-HEAD3-RT1 PIC X(14)       VALUE                06400023
064100         '       RETAIL '.                                        06410013
064200     05  FILLER              PIC X(01)       VALUE SPACES.        06420011
064300     05  FILLER              PIC X(14)       VALUE                06430013
064400         '        COST  '.                                        06440013
064500     05  FILLER              PIC X(01)       VALUE SPACES.        06450011
064600     05  FILLER              PIC X(14)       VALUE                06460013
064700         '       RETAIL '.                                        06470013
064800     05  FILLER              PIC X(03)       VALUE SPACES.        06480013
064900     05  FILLER              PIC X(03)       VALUE 'STR'.         06490013
065000     05  FILLER              PIC X(01)       VALUE SPACES.        06500013
065100     05  STORE-TBL-HEAD3-CS2 PIC X(14)       VALUE                06510023
065200         '        COST  '.                                        06520013
065300     05  FILLER              PIC X(01)       VALUE SPACES.        06530007
065400     05  STORE-TBL-HEAD3-RT2 PIC X(14)       VALUE                06540023
065500         '       RETAIL '.                                        06550013
065600     05  FILLER              PIC X(01)       VALUE SPACES.        06560011
065700     05  FILLER              PIC X(14)       VALUE                06570013
065800         '        COST  '.                                        06580013
065900     05  FILLER              PIC X(01)       VALUE SPACES.        06590011
066000     05  FILLER              PIC X(14)       VALUE                06600013
066100         '       RETAIL '.                                        06610013
066200                                                                  06620007
066300 01  STORE-TBL-DASH.                                              06630008
066400     05  FILLER              PIC X(02)       VALUE SPACES.        06640016
066500     05  FILLER              PIC X(03)       VALUE '---'.         06650013
066600     05  FILLER              PIC X(01)       VALUE SPACES.        06660013
066700     05  STORE-TBL-DASH-CS1  PIC X(14)       VALUE                06670024
066800         '--------------'.                                        06680014
066900     05  FILLER              PIC X(01)       VALUE SPACES.        06690007
067000     05  STORE-TBL-DASH-RT1  PIC X(14)       VALUE                06700024
067100         '--------------'.                                        06710014
067200     05  FILLER              PIC X(01)       VALUE SPACES.        06720013
067300     05  FILLER              PIC X(14)       VALUE                06730013
067400         '--------------'.                                        06740014
067500     05  FILLER              PIC X(01)       VALUE SPACES.        06750013
067600     05  FILLER              PIC X(14)       VALUE                06760013
067700         '--------------'.                                        06770014
067800     05  FILLER              PIC X(03)       VALUE SPACES.        06780013
067900     05  FILLER              PIC X(03)       VALUE '---'.         06790013
068000     05  FILLER              PIC X(01)       VALUE SPACES.        06800013
068100     05  STORE-TBL-DASH-CS2  PIC X(14)       VALUE                06810024
068200         '--------------'.                                        06820014
068300     05  FILLER              PIC X(01)       VALUE SPACES.        06830007
068400     05  STORE-TBL-DASH-RT2  PIC X(14)       VALUE                06840024
068500         '--------------'.                                        06850014
068600     05  FILLER              PIC X(01)       VALUE SPACES.        06860013
068700     05  FILLER              PIC X(14)       VALUE                06870013
068800         '--------------'.                                        06880014
068900     05  FILLER              PIC X(01)       VALUE SPACES.        06890013
069000     05  FILLER              PIC X(14)       VALUE                06900013
069100         '--------------'.                                        06910014
069200                                                                  06920007
069300 01  STORE-TBL-DETAIL.                                            06930007
069400     05  STORE-TBL-DETAIL1.                                       06940016
069500         10  FILLER              PIC X(01)       VALUE SPACES.    06950064
069600         10  WS-STORE-1          PIC 9(04).                       06960064
069700         10  FILLER              PIC X(01)       VALUE SPACES.    06970016
069800         10  WS-STORE-WEEK-COST-1        PIC $$$$$$$$$$.99-.      06980016
069900         10  FILLER              PIC X(01)       VALUE SPACES.    06990016
070000         10  WS-STORE-WEEK-RETAIL-1      PIC $$$$$$$$$$.99-.      07000016
070100         10  FILLER              PIC X(01)       VALUE SPACES.    07010016
070200         10  WS-STORE-MTD-COST-1         PIC $$$$$$$$$$.99-.      07020016
070300         10  FILLER              PIC X(01)       VALUE SPACES.    07030016
070400         10  WS-STORE-MTD-RETAIL-1       PIC $$$$$$$$$$.99-.      07040016
070500     05  STORE-TBL-DETAIL2.                                       07050016
070600         10  FILLER              PIC X(02)       VALUE SPACES.    07060064
070700         10  WS-STORE-2          PIC 9(04).                       07070064
070800         10  FILLER              PIC X(01)       VALUE SPACES.    07080016
070900         10  WS-STORE-WEEK-COST-2        PIC $$$$$$$$$$.99-.      07090016
071000         10  FILLER              PIC X(01)       VALUE SPACES.    07100016
071100         10  WS-STORE-WEEK-RETAIL-2      PIC $$$$$$$$$$.99-.      07110016
071200         10  FILLER              PIC X(01)       VALUE SPACES.    07120016
071300         10  WS-STORE-MTD-COST-2         PIC $$$$$$$$$$.99-.      07130016
071400         10  FILLER              PIC X(01)       VALUE SPACES.    07140016
071500         10  WS-STORE-MTD-RETAIL-2       PIC  $$$$$$$$$$.99-.     07150016
071600******************************************************************07160062
071700*    SQL COMMUNICATIONS AREA DCLGEN                               07170062
071800******************************************************************07180062
071900     EXEC SQL                                                     07190062
072000         INCLUDE SQLCA                                            07200062
072100     END-EXEC.                                                    07210062
072200******************************************************************07220062
072300*  EXTENSION TO THE SQL COMMUNICATIONS AREA FOR EDITING           07230062
072400*  SQL CODES FOR DISPLAY                                          07240062
072500******************************************************************07250062
072600     COPY SQLCA2.                                                 07260064
072700     EJECT                                                        07270062
072800******************************************************************07280062
072900*  DB2 FORMATTED MESSAGES                                        *07290062
073000******************************************************************07300062
073100     COPY DPWS004.                                                07310064
073200     EJECT                                                        07320062
073300******************************************************************07330062
073400*  COMPANY CONTROL TABLE                                          07340062
073500******************************************************************07350062
073600     EXEC SQL                                                     07360062
073700         INCLUDE TCOCNTL                                          07370062
073800     END-EXEC.                                                    07380062
073900                                                                  07390016
073910******************************************************************07391069
073920*  PURCHASE TABLE                                                 07392069
073930******************************************************************07393069
073940     EXEC SQL                                                     07394069
073950         INCLUDE TPURCHS                                          07395069
073960     END-EXEC.                                                    07396069
073970******************************************************************07397069
074000 PROCEDURE DIVISION.                                              07400000
074100 0000-OPEN-FILES.                                                 07410000
074110*                                                                 07411075
074120     DISPLAY ' '.                                                 07412075
074130     DISPLAY 'RCKRP025-START'.                                    07413075
074140     DISPLAY ' '.                                                 07414075
074150*                                                                 07415075
074200     OPEN INPUT  STORE-EXTRACT                                    07420000
074300                 CC-RUN-TYPE                                      07430000
074400          OUTPUT BUYERS-RECEIPTS.                                 07440001
074500                                                                  07450000
074600     INITIALIZE DT-STORE-TABLE.                                   07460003
074700     INITIALIZE DT-SAVE-STORE-TABLE.                              07470003
074800     INITIALIZE DT-STORE-TABLE-DEPT.                              07480020
074900     INITIALIZE DT-SAVE-STORE-TABLE-DEPT.                         07490020
075000     MOVE SPACES                     TO STORE-TBL-DETAIL.         07500029
075100     ACCEPT WS-DATE       FROM  DATE.                             07510003
075200     MOVE WS-DATE-MM  TO  DP132O-RUN-MONTH.                       07520000
075300     MOVE WS-DATE-DD  TO  DP132O-RUN-DAY.                         07530000
075400     MOVE WS-DATE-YY  TO  DP132O-RUN-YEAR.                        07540000
075500     ACCEPT WS-TIME       FROM  TIME.                             07550000
075600     MOVE WS-TIME-HH  TO  DP132O-RUN-HOUR.                        07560000
075700     MOVE WS-TIME-MM  TO  DP132O-RUN-MINUTE.                      07570000
075800     MOVE 'RCKRP025'  TO DP132O-PROGRAM-NAME.                     07580001
075900                                                                  07590000
076000     PERFORM 0005-READ-TCOCNTL THRU 0005-EXIT.                    07600062
076100     MOVE COCNTL-BTCH-PRC-DTE                                     07610062
076200                      TO  WS-HOLD-TCOCNTL-DATE.                   07620062
076300     MOVE WS-HOLD-TCOCNTL-CC                                      07630062
076400                      TO  WS-DATE-CCYYMMDD-CC.                    07640062
076500     MOVE WS-HOLD-TCOCNTL-YY                                      07650062
076600                      TO  WS-DATE-CCYYMMDD-YY.                    07660062
076700     MOVE WS-HOLD-TCOCNTL-MM                                      07670062
076800                      TO  WS-DATE-CCYYMMDD-MM.                    07680062
076900     MOVE WS-HOLD-TCOCNTL-DD                                      07690062
077000                      TO  WS-DATE-CCYYMMDD-DD.                    07700062
077100                                                                  07710062
077110*                                                                 07711075
077120     DISPLAY 'BATCH PROCESS DATE: ' COCNTL-BTCH-PRC-DTE.          07712075
077130     DISPLAY 'WS-DATE-CCYYMMDD:   ' WS-DATE-CCYYMMDD.             07713075
077140*                                                                 07714075
077200     PERFORM 0010-READ-CONTROL-FILE THRU 0010-EXIT.               07720000
077210*                                                                 07721075
077220     DISPLAY 'CONTROL FILE:       ' WS-RUN-TYPE-RECORD.           07722075
077230*                                                                 07723075
077300                                                                  07730000
077400     PERFORM UNTIL PS-EOF                                         07740000
077500         PERFORM 0200-READ-STORE-EXTRACT THRU 0200-EXIT           07750000
077600         IF PS-EOF                                                07760000
077700             CONTINUE                                             07770000
077800         ELSE                                                     07780000
077900             PERFORM 0300-PROCESS-DATA THRU 0300-EXIT             07790000
078000         END-IF                                                   07800000
078100     END-PERFORM.                                                 07810000
078200                                                                  07820000
078300     PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT.                 07830000
078400     PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT.                07840000
078500     PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT.               07850000
078600     PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT.               07860000
078700     PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT.                   07870000
078800     PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT.                    07880000
078900     PERFORM 0450-PRT-DMM-LINE THRU 0450-EXIT.                    07890000
079000     PERFORM 0460-PRT-GMM-LINE THRU 0460-EXIT.                    07900000
079100     PERFORM 0470-PRT-FINAL-LINE THRU 0470-EXIT.                  07910000
079200                                                                  07920000
079300     CLOSE STORE-EXTRACT                                          07930000
079400           CC-RUN-TYPE                                            07940000
079500           BUYERS-RECEIPTS.                                       07950001
079510*                                                                 07951075
079520     DISPLAY ' '.                                                 07952075
079530     MOVE PV-SE-STR-EXT-COUNT   TO  PV-DISP-COUNT.                07953075
079540     DISPLAY 'SE READ COUNT:      ' PV-DISP-COUNT.                07954075
079590     MOVE PV-RPT-DTL-LINE-CNT   TO  PV-DISP-COUNT.                07959075
079591     DISPLAY 'RPT DTL LINE CNT:   ' PV-DISP-COUNT.                07959175
079592     DISPLAY ' '.                                                 07959275
079593     DISPLAY 'RCKRP025-END  '.                                    07959377
079594     DISPLAY ' '.                                                 07959475
079595*                                                                 07959575
079600     GOBACK.                                                      07960000
079700                                                                  07970000
079800 0005-READ-TCOCNTL.                                               07980062
079900                                                                  07990062
080000     EXEC SQL                                                     08000062
080100         SELECT                                                   08010062
080200                BTCH_PRC_DTE - 5 DAYS                             08020062
080300         INTO  :COCNTL-BTCH-PRC-DTE                               08030062
080400         FROM TCOCNTL                                             08040062
080500         WHERE OPER_UNT_ID = 90                                   08050062
080600     END-EXEC.                                                    08060062
080700                                                                  08070062
080800     EVALUATE TRUE                                                08080062
080900         WHEN SQLCODE = +0                                        08090062
081000         WHEN SQLCODE = -811                                      08100062
081100             CONTINUE                                             08110062
081200         WHEN OTHER                                               08120062
081300             DISPLAY 'PGM RCKRP018 ABENDED - READ TCOCNTL '       08130062
081400             MOVE '0005-READ-TCOCNTL' TO PV-PARAGRAPH-NAME        08140062
081500             MOVE 'SELECT       '      TO PV-DB2-OPERATION        08150062
081600             PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT      08160062
081700     END-EVALUATE.                                                08170062
081800 0005-EXIT. EXIT.                                                 08180062
081900                                                                  08190062
082000 0010-READ-CONTROL-FILE.                                          08200000
082100     MOVE '0010-READ-CONTROL-FILE'     TO PV-PARAGRAPH-NAME.      08210000
082200                                                                  08220000
082300     READ CC-RUN-TYPE           INTO WS-RUN-TYPE-RECORD           08230000
082400         AT END                                                   08240000
082500             DISPLAY 'RCKRP025  - CONTROL FILE EMPTY'             08250001
082600     END-READ.                                                    08260000
082700 0010-EXIT. EXIT.                                                 08270000
082800                                                                  08280000
082900 0200-READ-STORE-EXTRACT.                                         08290000
083000     READ STORE-EXTRACT INTO RC043-EXP-STORE-EXTRACT-RECORD       08300000
083100         AT END                                                   08310000
083200             SET PS-EOF TO TRUE                                   08320076
083210         NOT AT END                                               08321076
083220             ADD 1      TO PV-SE-STR-EXT-COUNT.                   08322076
083300                                                                  08330000
083400     IF PS-EOF                                                    08340000
083500         CONTINUE                                                 08350000
083600     ELSE                                                         08360000
083700         ADD +1 TO WS-STORE-IN                                    08370000
083800                                                                  08380000
083900         MOVE RC043-DATE-VERIFIED-COUNT TO WS-DATE-VERIFIED-COUNT 08390000
084000         MOVE WS-DATE-VFYD-COUNT-MM      TO WS-COMPARE-DATE-MM    08400000
084100         MOVE WS-DATE-VFYD-COUNT-DD      TO WS-COMPARE-DATE-DD    08410000
084200         MOVE WS-DATE-VFYD-COUNT-YY      TO WS-COMPARE-DATE-YY    08420000
084300                                                                  08430000
084400         IF WS-COMPARE-DATE-YY > 80                               08440000
084500             MOVE '19'                   TO WS-COMPARE-DATE-CC    08450000
084600         ELSE                                                     08460000
084700             MOVE '20'                   TO WS-COMPARE-DATE-CC    08470000
084800         END-IF                                                   08480000
084900                                                                  08490000
085000         IF WS-COMPARE-DATE > WS-WK-END-DATE                      08500000
085100             MOVE WS-COMPARE-DATE        TO WS-WK-END-DATE        08510000
085200         END-IF                                                   08520000
085300     END-IF.                                                      08530000
085400 0200-EXIT. EXIT.                                                 08540000
085500                                                                  08550000
085600 0300-PROCESS-DATA.                                               08560000
085700                                                                  08570000
085800     IF FIRST-TIME-DATE AND                                       08580054
085900        ((WEEKLY-RUN AND RC043-MTD-CDE NOT EQUAL 'M') OR          08590054
086000         (MONTHLY-RUN))                                           08600054
086100         MOVE SPACE TO WS-FIRST-TIME-DATE-IND                     08610054
086200         PERFORM 1050-DATE-CALCULATION THRU                       08620000
086300                 1050-EXIT                                        08630000
086400         IF WEEKLY-RUN                                            08640000
086500             MOVE WS-1ST-DAY-OF-WEEK-MM     TO WS-HDR3-MM         08650000
086600             MOVE WS-1ST-DAY-OF-WEEK-DD     TO WS-HDR3-DD         08660000
086700             MOVE WS-1ST-DAY-OF-WEEK-CC     TO WS-HDR3-CC         08670000
086800             MOVE WS-1ST-DAY-OF-WEEK-YY     TO WS-HDR3-YY         08680000
086900             MOVE 'MPK11040'                TO WS-HDR3-WEEKJOB    08690058
087000             MOVE WS-HDR3-WEEK              TO WS-HDR3            08700000
087100             MOVE 1                      TO DP132O-REPORT-NUMBER  08710029
087200         ELSE                                                     08720000
087300         IF MONTHLY-RUN                                           08730000
087400             MOVE WS-MONTH                  TO WS-HDR3-MONTH-ABBR 08740000
087500             MOVE WS-1ST-DAY-OF-WEEK-CC     TO WS-HDR3-MONTH-CC   08750000
087600             MOVE WS-1ST-DAY-OF-WEEK-YY     TO WS-HDR3-MONTH-YY   08760000
087700             MOVE 'MPK51010'                TO WS-HDR3-MNTHJOB    08770058
087800             MOVE WS-HDR3-MONTH             TO WS-HDR3            08780000
087900             MOVE 2                      TO DP132O-REPORT-NUMBER  08790029
088000             MOVE SPACES                    TO STORE-TBL-HEAD2-TW108800025
088100                                               STORE-TBL-HEAD2-TW208810025
088200                                               STORE-TBL-HEAD3-CS108820025
088300                                               STORE-TBL-HEAD3-CS208830025
088400                                               STORE-TBL-HEAD3-RT108840025
088500                                               STORE-TBL-HEAD3-RT208850025
088600                                               STORE-TBL-DASH-CS1 08860025
088700                                               STORE-TBL-DASH-CS2 08870025
088800                                               STORE-TBL-DASH-RT1 08880025
088900                                               STORE-TBL-DASH-RT2 08890025
089000         ELSE                                                     08900000
089100             MOVE '???????????????????'     TO WS-HDR3.           08910000
089200                                                                  08920033
089300     MOVE RC043-LOC-NBR                 TO WS-HOLD-STORE.         08930064
089400                                                                  08940052
089500     IF FIRST-TIME                                                08950000
089600         MOVE SPACE TO WS-FIRST-TIME-IND                          08960000
089700         MOVE RC043-GMM-NBR             TO WS-HOLD-GM             08970000
089800         MOVE RC043-GMM-NBR             TO WS-HDR4-GMM-NO         08980000
089900         MOVE RC043-GMM-NAME            TO WS-HDR4-GMM-NAME       08990000
090000         MOVE RC043-DMM-NBR             TO WS-HOLD-DM             09000000
090100         MOVE RC043-DMM-NBR             TO WS-HDR5-DMM-NO         09010000
090200         MOVE RC043-DMM-NAME            TO WS-HDR5-DMM-NAME       09020000
090300         MOVE RC043-BYR-NBR             TO WS-HOLD-BYR            09030000
090400         MOVE RC043-BYR-NBR             TO WS-HDR6-BYR-NO         09040000
090500         MOVE RC043-BYR-NAME            TO WS-HDR6-BYR-NAME       09050000
090600         MOVE RC043-DEPT                TO WS-HOLD-DEPT           09060000
090700         MOVE RC043-DEPT                TO WS-HDR7-DEPARTMENT     09070000
090800         MOVE RC043-DEPT-NAME           TO WS-HDR7-DEPT-NAME      09080000
090900         MOVE RC043-CLASS               TO WS-HOLD-CLASS          09090000
091000         MOVE RC043-SUB-CL-DESC         TO WS-HOLD-CLASS-NAME     09100000
091100         MOVE RC043-MAJ-CL-NBR          TO WS-HOLD-MAJ-CLASS      09110000
091200         MOVE RC043-MAJ-CL-DESC         TO WS-HOLD-MAJ-CLASS-NAME 09120000
091300         MOVE RC043-PO                  TO WS-HOLD-PO             09130000
091400         MOVE RC043-REC-SEQ-NBR         TO WS-HOLD-REC-SEQ-NBR    09140000
091500         MOVE RC043-REC-SRC-CDE         TO WS-HOLD-REC-SRC-CDE    09150000
091600         MOVE RC043-DEFERRED            TO WS-HOLD-DEF            09160000
091700         MOVE RC043-ADJ-CYC-NBR         TO WS-HOLD-ADJ-CYC-NBR    09170000
091800         MOVE RC043-VENDOR-NAME-INHOUSE TO WS-HOLD-VENDOR-NAME    09180000
091900         MOVE RC043-OPER-UNT-ID         TO WS-HOLD-OPER-UNT-ID    09190000
092000         MOVE RC043-DATE-RECEIVED       TO WS-HOLD-RECEIPT-DATE   09200000
092100         MOVE RC043-DATE-VERIFIED-COUNT TO WS-HOLD-VERIFY-DATE    09210000
092200         MOVE RC043-PRCS-DAYS           TO WS-HOLD-PRCS-DAYS      09220000
092300             IF RC043-RECEIVING-LOCATION = 'DS'                   09230000
092400                  MOVE RC043-LOC-NBR      TO WS-HOLD-OPER-UNT-ID  09240064
092500             END-IF                                               09250000
092600     END-IF.                                                      09260000
092700                                                                  09270000
092800     IF RC043-GMM-NBR NOT = WS-HOLD-GM                            09280000
092900         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09290000
093000         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09300000
093100         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09310000
093200         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            09320000
093300         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                09330000
093400         PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT                 09340000
093500         PERFORM 0450-PRT-DMM-LINE THRU 0450-EXIT                 09350000
093600         MOVE 'Y'              TO PS-GMM-BREAK-SW                 09360000
093700         PERFORM 0460-PRT-GMM-LINE THRU 0460-EXIT                 09370000
093800         MOVE 'N'              TO PS-GMM-BREAK-SW                 09380000
093900     END-IF.                                                      09390000
094000                                                                  09400000
094100     IF RC043-DMM-NBR NOT = WS-HOLD-DM                            09410000
094200         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09420000
094300         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09430000
094400         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09440000
094500         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            09450000
094600         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                09460000
094700         PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT                 09470000
094800         MOVE 'Y'              TO PS-DMM-BREAK-SW                 09480000
094900         PERFORM 0450-PRT-DMM-LINE THRU 0450-EXIT                 09490000
095000         MOVE 'N'              TO PS-DMM-BREAK-SW                 09500000
095100     END-IF.                                                      09510000
095200                                                                  09520000
095300     IF RC043-BYR-NBR NOT = WS-HOLD-BYR                           09530000
095400         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09540000
095500         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09550000
095600         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09560000
095700         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            09570000
095800         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                09580000
095900         MOVE 'Y'              TO PS-BYR-BREAK-SW                 09590000
096000         PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT                 09600000
096100         MOVE 'N'              TO PS-BYR-BREAK-SW                 09610000
096200     END-IF.                                                      09620000
096300                                                                  09630000
096400     IF RC043-DEPT NOT = WS-HOLD-DEPT                             09640000
096500         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09650000
096600         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09660000
096700         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09670000
096800         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            09680000
096900         MOVE 'Y'              TO PS-DEPT-BREAK-SW                09690000
097000         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                09700000
097100         MOVE 'N'              TO PS-DEPT-BREAK-SW                09710000
097200     END-IF.                                                      09720000
097300                                                                  09730000
097400     IF RC043-MAJ-CL-NBR NOT = WS-HOLD-MAJ-CLASS                  09740000
097500         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09750000
097600         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09760000
097700         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09770000
097800         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            09780000
097900     END-IF.                                                      09790000
098000                                                                  09800000
098100     IF RC043-CLASS NOT = WS-HOLD-CLASS                           09810000
098200         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09820000
098300         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09830000
098400         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09840000
098500     END-IF.                                                      09850000
098600                                                                  09860000
098700     IF RC043-PO = WS-HOLD-PO AND                                 09870000
098800        RC043-REC-SEQ-NBR = WS-HOLD-REC-SEQ-NBR AND               09880000
098900        RC043-REC-SRC-CDE = WS-HOLD-REC-SRC-CDE AND               09890000
099000        RC043-ADJ-CYC-NBR = WS-HOLD-ADJ-CYC-NBR                   09900000
099100         NEXT SENTENCE                                            09910000
099200     ELSE                                                         09920000
099300     IF RC043-PO = WS-HOLD-PO                                     09930000
099400         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09940000
099500     ELSE                                                         09950000
099600         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09960000
099700         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09970000
099800     END-IF.                                                      09980000
099900                                                                  09990000
100000 0300-CONTINUE.                                                   10000033
100010     IF RC043-PO NOT    = WS-PO-BEING-PROCESSED                   10001069
100020         MOVE RC043-PO TO WS-PO-BEING-PROCESSED                   10002069
100030                          PV-PO-NBR                               10003069
100040         PERFORM 5000-GET-PO-INFO THRU 5000-EXIT                  10004069
100050     END-IF.                                                      10005069
100060     PERFORM 1300-COST-SELECT THRU 1300-EXIT.                     10006069
100100     PERFORM 0350-SAVE-TOTALS THRU 0350-EXIT.                     10010000
100300 0300-EXIT. EXIT.                                                 10030000
100400*                                                                 10040069
100410 1300-COST-SELECT.                                                10041069
100420     IF  RC043-PO-TYP-CDE  = ('IM' OR 'IE' OR 'IF')               10042074
100430     OR  PURCHS-DERVD-LBL-TYP-CDE = ('P' OR 'E')                  10043074
100440         MOVE RC043-COST-EXTENSION     TO WS-COST-EXTENSION       10044074
100450     ELSE                                                         10045069
100460         MOVE RC043-1ST-COST-EXTENSION TO WS-COST-EXTENSION       10046074
100470     END-IF.                                                      10047069
100480 1300-EXIT. EXIT.                                                 10048069
100490*                                                                 10049069
100500 0350-SAVE-TOTALS.                                                10050000
100600     IF WEEKLY-RUN AND RC043-MTD-CDE = 'M'                        10060053
100700         GO TO 0350-CONTINUE                                      10070053
100800     ELSE                                                         10080053
100900         MOVE 'Y'                       TO SW-WEEKLY-DTL-RECS     10090053
101000         MOVE 'Y'                       TO SW-WEEKLY-PO-RECS      10100053
101100         MOVE 'Y'                       TO SW-WEEKLY-CLASS-RECS   10110053
101200         MOVE 'Y'                       TO SW-WEEKLY-MAJ-RECS     10120053
101300         MOVE 'Y'                       TO SW-WEEKLY-DEPT-RECS.   10130053
101400                                                                  10140033
101500     COMPUTE WS-TOTAL-POSEQ-UNITS =                               10150000
101600         WS-TOTAL-POSEQ-UNITS  + RC043-RETAIL-UNITS-MARK.         10160061
101700     COMPUTE WS-TOTAL-POSEQ-COST  =                               10170000
101800*        WS-TOTAL-POSEQ-COST   + RC043-COST-EXTENSION.            10180069
101810         WS-TOTAL-POSEQ-COST   + WS-COST-EXTENSION.               10181069
101900     COMPUTE WS-TOTAL-POSEQ-RETAIL  =                             10190000
102000         WS-TOTAL-POSEQ-RETAIL  + RC043-RETAIL-EXTENSION.         10200000
102100                                                                  10210000
102200     COMPUTE WS-TOTAL-PO-UNITS =                                  10220000
102300         WS-TOTAL-PO-UNITS  + RC043-RETAIL-UNITS-MARK.            10230061
102400     COMPUTE WS-TOTAL-PO-COST  =                                  10240000
102500*        WS-TOTAL-PO-COST   + RC043-COST-EXTENSION.               10250069
102510         WS-TOTAL-PO-COST   + WS-COST-EXTENSION.                  10251069
102600     COMPUTE WS-TOTAL-PO-RETAIL  =                                10260000
102700         WS-TOTAL-PO-RETAIL  + RC043-RETAIL-EXTENSION.            10270000
102800                                                                  10280000
102900     COMPUTE WS-TOTAL-CLASS-UNITS =                               10290000
103000         WS-TOTAL-CLASS-UNITS  + RC043-RETAIL-UNITS-MARK.         10300061
103100     COMPUTE WS-TOTAL-CLASS-COST  =                               10310000
103200*        WS-TOTAL-CLASS-COST   + RC043-COST-EXTENSION.            10320069
103210         WS-TOTAL-CLASS-COST   + WS-COST-EXTENSION.               10321069
103300     COMPUTE WS-TOTAL-CLASS-RETAIL  =                             10330000
103400         WS-TOTAL-CLASS-RETAIL  + RC043-RETAIL-EXTENSION.         10340000
103500                                                                  10350000
103600     COMPUTE WS-TOTAL-MAJ-CLASS-UNITS =                           10360000
103700         WS-TOTAL-MAJ-CLASS-UNITS  + RC043-RETAIL-UNITS-MARK.     10370061
103800     COMPUTE WS-TOTAL-MAJ-CLASS-COST  =                           10380000
103900*        WS-TOTAL-MAJ-CLASS-COST   + RC043-COST-EXTENSION.        10390069
103910         WS-TOTAL-MAJ-CLASS-COST   + WS-COST-EXTENSION.           10391069
104000     COMPUTE WS-TOTAL-MAJ-CLASS-RETAIL  =                         10400000
104100         WS-TOTAL-MAJ-CLASS-RETAIL  + RC043-RETAIL-EXTENSION.     10410000
104200                                                                  10420000
104300     COMPUTE WS-TOTAL-DEPT-UNITS =                                10430000
104400         WS-TOTAL-DEPT-UNITS  + RC043-RETAIL-UNITS-MARK.          10440061
104500     COMPUTE WS-TOTAL-DEPT-COST  =                                10450000
104600*        WS-TOTAL-DEPT-COST   + RC043-COST-EXTENSION.             10460069
104610         WS-TOTAL-DEPT-COST   + WS-COST-EXTENSION.                10461070
104700     COMPUTE WS-TOTAL-DEPT-RETAIL  =                              10470000
104800         WS-TOTAL-DEPT-RETAIL  + RC043-RETAIL-EXTENSION.          10480000
104900                                                                  10490000
105000     COMPUTE WS-TOTAL-BYR-UNITS =                                 10500000
105100         WS-TOTAL-BYR-UNITS  + RC043-RETAIL-UNITS-MARK.           10510061
105200     COMPUTE WS-TOTAL-BYR-COST  =                                 10520000
105300*        WS-TOTAL-BYR-COST   + RC043-COST-EXTENSION.              10530070
105310         WS-TOTAL-BYR-COST   + WS-COST-EXTENSION.                 10531069
105400     COMPUTE WS-TOTAL-BYR-RETAIL  =                               10540000
105500         WS-TOTAL-BYR-RETAIL  + RC043-RETAIL-EXTENSION.           10550000
105600                                                                  10560000
105700     COMPUTE WS-TOTAL-DMM-UNITS =                                 10570000
105800         WS-TOTAL-DMM-UNITS  + RC043-RETAIL-UNITS-MARK.           10580061
105900     COMPUTE WS-TOTAL-DMM-COST  =                                 10590000
106000*        WS-TOTAL-DMM-COST   + RC043-COST-EXTENSION.              10600069
106010         WS-TOTAL-DMM-COST   + WS-COST-EXTENSION.                 10601069
106100     COMPUTE WS-TOTAL-DMM-RETAIL  =                               10610000
106200         WS-TOTAL-DMM-RETAIL  + RC043-RETAIL-EXTENSION.           10620000
106300                                                                  10630000
106400     COMPUTE WS-TOTAL-GMM-UNITS =                                 10640000
106500         WS-TOTAL-GMM-UNITS  + RC043-RETAIL-UNITS-MARK.           10650061
106600     COMPUTE WS-TOTAL-GMM-COST  =                                 10660000
106700*        WS-TOTAL-GMM-COST   + RC043-COST-EXTENSION.              10670069
106710         WS-TOTAL-GMM-COST   + WS-COST-EXTENSION.                 10671069
106800     COMPUTE WS-TOTAL-GMM-RETAIL  =                               10680000
106900         WS-TOTAL-GMM-RETAIL  + RC043-RETAIL-EXTENSION.           10690000
107000                                                                  10700000
107100     COMPUTE WS-TOTAL-RPT-UNITS  =                                10710000
107200         WS-TOTAL-RPT-UNITS  + RC043-RETAIL-UNITS-MARK.           10720061
107300     COMPUTE WS-TOTAL-RPT-COST   =                                10730000
107400*        WS-TOTAL-RPT-COST   + RC043-COST-EXTENSION.              10740069
107410         WS-TOTAL-RPT-COST   + WS-COST-EXTENSION.                 10741069
107500     COMPUTE WS-TOTAL-RPT-RETAIL =                                10750000
107600         WS-TOTAL-RPT-RETAIL + RC043-RETAIL-EXTENSION.            10760000
107700                                                                  10770003
107800 0350-CONTINUE.                                                   10780047
107900     SET IDX-SAVE                 TO WS-HOLD-STORE.               10790015
108000     MOVE WS-HOLD-STORE           TO DT-SAVE-STORE-NBR(IDX-SAVE). 10800015
108100     SET IDX-SAVE-DEPT            TO WS-HOLD-STORE.               10810020
108200     MOVE WS-HOLD-STORE                                           10820020
108300                       TO DT-SAVE-STORE-NBR-DEPT(IDX-SAVE-DEPT).  10830020
108400                                                                  10840033
108500     IF WEEKLY-RUN AND RC043-MTD-CDE = 'M'                        10850048
108600         NEXT SENTENCE                                            10860048
108700     ELSE                                                         10870048
108800         COMPUTE DT-SAVE-STORE-WEEK-RETAIL(IDX-SAVE) =            10880033
108900             DT-SAVE-STORE-WEEK-RETAIL(IDX-SAVE) +                10890033
109000                 RC043-RETAIL-EXTENSION                           10900033
109100         COMPUTE DT-SAVE-STORE-WEEK-COST  (IDX-SAVE) =            10910033
109200             DT-SAVE-STORE-WEEK-COST  (IDX-SAVE) +                10920033
109300                 RC043-COST-EXTENSION                             10930033
109400         COMPUTE DT-SAVE-STORE-WEEK-RETAIL-DEPT(IDX-SAVE-DEPT) =  10940033
109500             DT-SAVE-STORE-WEEK-RETAIL-DEPT(IDX-SAVE-DEPT) +      10950033
109600                 RC043-RETAIL-EXTENSION                           10960033
109700         COMPUTE DT-SAVE-STORE-WEEK-COST-DEPT(IDX-SAVE-DEPT) =    10970033
109800             DT-SAVE-STORE-WEEK-COST-DEPT(IDX-SAVE-DEPT) +        10980033
109900                 RC043-COST-EXTENSION.                            10990041
110000                                                                  11000003
110100     COMPUTE DT-SAVE-STORE-MTD-RETAIL(IDX-SAVE) =                 11010027
110200         DT-SAVE-STORE-MTD-RETAIL(IDX-SAVE) +                     11020027
110300             RC043-RETAIL-EXTENSION.                              11030027
110400     COMPUTE DT-SAVE-STORE-MTD-COST  (IDX-SAVE) =                 11040027
110500         DT-SAVE-STORE-MTD-COST  (IDX-SAVE) +                     11050027
110600             RC043-COST-EXTENSION.                                11060027
110700     COMPUTE DT-SAVE-STORE-MTD-RETAIL-DEPT(IDX-SAVE-DEPT) =       11070027
110800         DT-SAVE-STORE-MTD-RETAIL-DEPT(IDX-SAVE-DEPT) +           11080027
110900             RC043-RETAIL-EXTENSION.                              11090027
111000     COMPUTE DT-SAVE-STORE-MTD-COST-DEPT(IDX-SAVE-DEPT) =         11100027
111100         DT-SAVE-STORE-MTD-COST-DEPT  (IDX-SAVE-DEPT) +           11110027
111200             RC043-COST-EXTENSION.                                11120027
111300 0350-EXIT. EXIT.                                                 11130000
111400                                                                  11140000
111500 0400-PRT-DETAIL-LINE.                                            11150000
111600     IF NO-WEEKLY-DTL-RECS                                        11160033
111700         GO TO 0400-CONTINUE.                                     11170033
111800                                                                  11180033
111900     ADD 1                           TO WS-CNT-DTL.               11190000
112000     IF WS-CNT-DTL = 1                                            11200000
112100         MOVE 2                      TO WS-CC                     11210000
112200         MOVE WS-HOLD-VENDOR-NAME    TO WS-DTL-VENDOR-NAME        11220000
112300         MOVE WS-HOLD-CLASS          TO WS-DTL-CLASS              11230000
112400         ELSE                                                     11240000
112500             MOVE 1                  TO WS-CC                     11250000
112600     END-IF.                                                      11260000
112700     MOVE WS-HOLD-PO                 TO WS-DTL-PO-NUMBER.         11270000
112800     MOVE '-'                        TO WS-DASH1.                 11280000
112900                                                                  11290000
113000     MOVE WS-HOLD-REC-SEQ-NBR        TO PV-HOLD-REC-SEQ-NBR-1-3.  11300000
113100     IF PV-HOLD-REC-SEQ-NBR-1 = '0' AND                           11310000
113200        PV-HOLD-REC-SEQ-NBR-2 = '0'                               11320000
113300         MOVE PV-HOLD-REC-SEQ-NBR-3  TO WS-DTL-REC-SEQ            11330000
113400     ELSE                                                         11340000
113500     IF PV-HOLD-REC-SEQ-NBR-1 = '0'                               11350000
113600        STRING PV-HOLD-REC-SEQ-NBR-2 PV-HOLD-REC-SEQ-NBR-3        11360000
113700            DELIMITED BY SIZE INTO WS-DTL-REC-SEQ                 11370000
113800     ELSE                                                         11380000
113900        MOVE PV-HOLD-REC-SEQ-NBR-1-3 TO WS-DTL-REC-SEQ.           11390000
114000                                                                  11400000
114100     IF WS-HOLD-REC-SRC-CDE  = 'A' AND WS-HOLD-DEF = 'DEF'        11410000
114200         MOVE 'A/D'                  TO WS-DTL-DEF                11420000
114300     ELSE                                                         11430000
114400     IF WS-HOLD-REC-SRC-CDE  = 'A'                                11440000
114500         MOVE 'ADJ'                  TO WS-DTL-DEF                11450000
114600     ELSE                                                         11460000
114700     IF WS-HOLD-DEF          = 'DEF'                              11470000
114800         MOVE 'DEF'                  TO WS-DTL-DEF                11480000
114900     ELSE                                                         11490000
115000         MOVE '   '                  TO WS-DTL-DEF.               11500000
115100     MOVE WS-HOLD-OPER-UNT-ID        TO WS-DTL-REC-LOC.           11510000
115200     MOVE WS-HOLD-RECEIPT-DATE       TO WS-DATE-RECEIVED.         11520000
115300     MOVE WS-DATE-RECEIVED-MM        TO WS-DATE-RECEIVED-PRT-MM.  11530000
115400     MOVE WS-DATE-RECEIVED-DD        TO WS-DATE-RECEIVED-PRT-DD.  11540000
115500     MOVE WS-DATE-RECEIVED-YY        TO WS-DATE-RECEIVED-PRT-YY.  11550000
115600     MOVE WS-DATE-RECEIVED-PRT       TO WS-DTL-REC-DATE.          11560000
115700     MOVE WS-HOLD-VERIFY-DATE        TO WS-DATE-VERIFIED-COUNT.   11570000
115800     MOVE WS-DATE-VFYD-COUNT-MM      TO WS-DATE-VERIFIED-PRT-MM.  11580000
115900     MOVE WS-DATE-VFYD-COUNT-DD      TO WS-DATE-VERIFIED-PRT-DD.  11590000
116000     MOVE WS-DATE-VFYD-COUNT-YY      TO WS-DATE-VERIFIED-PRT-YY.  11600000
116100     MOVE WS-DATE-VERIFIED-PRT       TO WS-DTL-VRFD-DATE.         11610000
116200     MOVE WS-HOLD-PRCS-DAYS          TO WS-DTL-PRCS-DAYS.         11620000
116300     MOVE WS-TOTAL-POSEQ-UNITS       TO WS-DTL-UNIT-TOTAL.        11630000
116400     MOVE WS-TOTAL-POSEQ-COST        TO WS-DTL-TOTAL-COST.        11640000
116500     MOVE WS-TOTAL-POSEQ-RETAIL      TO WS-DTL-TOTAL-RETAIL.      11650000
116600     MOVE '%'                        TO WS-PCT1.                  11660000
116700                                                                  11670000
116800     IF WS-TOTAL-POSEQ-RETAIL = 0                                 11680000
116900         MOVE 0                      TO WS-DTL-MKUP               11690000
117000     ELSE                                                         11700000
117100         COMPUTE WS-SAVE-MKUP =                                   11710000
117200          ((WS-TOTAL-POSEQ-RETAIL - WS-TOTAL-POSEQ-COST) /        11720000
117300             WS-TOTAL-POSEQ-RETAIL)  * 100                        11730000
117400         MOVE WS-SAVE-MKUP           TO WS-DTL-MKUP.              11740000
117500                                                                  11750000
117600     IF WS-LINE-CNT > 55                                          11760000
117700         PERFORM 1000-PRINT-HEADINGS THRU                         11770000
117800                 1000-EXIT-PRINT-HEADINGS.                        11780000
117900     WRITE BUYERS-RECEIPTS-RPT FROM WS-DETAIL AFTER WS-CC.        11790000
117910                                                                  11791075
117920     ADD 1     TO PV-RPT-DTL-LINE-CNT.                            11792075
117930                                                                  11793075
118000     ADD WS-CC TO WS-LINE-CNT.                                    11800000
118100     MOVE 1 TO WS-CC.                                             11810000
118200     MOVE SPACES TO WS-DETAIL.                                    11820000
118300                                                                  11830033
118400 0400-CONTINUE.                                                   11840033
118500     MOVE RC043-PO                   TO WS-HOLD-PO.               11850000
118600     MOVE RC043-REC-SEQ-NBR          TO WS-HOLD-REC-SEQ-NBR.      11860000
118700     MOVE RC043-REC-SRC-CDE          TO WS-HOLD-REC-SRC-CDE.      11870000
118800     MOVE RC043-DEFERRED             TO WS-HOLD-DEF.              11880000
118900     MOVE RC043-ADJ-CYC-NBR          TO WS-HOLD-ADJ-CYC-NBR.      11890000
119000     MOVE RC043-VENDOR-NAME-INHOUSE  TO WS-HOLD-VENDOR-NAME.      11900000
119100     MOVE RC043-OPER-UNT-ID          TO WS-HOLD-OPER-UNT-ID.      11910000
119200     MOVE RC043-DATE-RECEIVED        TO WS-HOLD-RECEIPT-DATE.     11920000
119300     MOVE RC043-DATE-VERIFIED-COUNT  TO WS-HOLD-VERIFY-DATE.      11930000
119400     MOVE RC043-PRCS-DAYS            TO WS-HOLD-PRCS-DAYS.        11940000
119500     MOVE +0                         TO WS-TOTAL-POSEQ-UNITS      11950000
119600                                        WS-TOTAL-POSEQ-COST       11960000
119700                                        WS-TOTAL-POSEQ-RETAIL.    11970000
119800     IF RC043-RECEIVING-LOCATION = 'DS'                           11980000
119900             MOVE RC043-LOC-NBR      TO WS-HOLD-OPER-UNT-ID.      11990064
120000     MOVE 'N'                        TO SW-WEEKLY-DTL-RECS.       12000033
120100 0400-EXIT. EXIT.                                                 12010000
120200                                                                  12020000
120300 0410-PRT-POTOTAL-LINE.                                           12030000
120400     IF NO-WEEKLY-PO-RECS                                         12040033
120500         GO TO 0410-CONTINUE.                                     12050033
120600                                                                  12060033
120700     IF WS-CNT-DTL = 1                                            12070000
120800         GO TO 0410-CONTINUE.                                     12080053
120900                                                                  12090053
121000     IF WS-TOTAL-PO-UNITS = +0 AND WS-TOTAL-PO-COST = +0 AND      12100053
121100        WS-TOTAL-PO-RETAIL = +0                                   12110053
121200         GO TO 0410-CONTINUE.                                     12120053
121300                                                                  12130000
121400     MOVE '   PO TOTAL:'             TO WS-TTL-LIT-2.             12140000
121510     IF  WS-TOTAL-PO-RETAIL >  999999999.99                       12151067
121520         MOVE  WS-TOTAL-PO-RETAIL    TO WS-TTL-TOTAL-RETAIL-RD    12152066
121530     ELSE                                                         12153066
121540         MOVE  WS-TOTAL-PO-RETAIL    TO WS-TTL-TOTAL-RETAIL       12154066
121550     END-IF.                                                      12155066
121560     IF  WS-TOTAL-PO-COST >    999999999.99                       12156068
121570         MOVE  WS-TOTAL-PO-COST      TO WS-TTL-TOTAL-COST-RD      12157068
121580     ELSE                                                         12158068
121590         MOVE  WS-TOTAL-PO-COST      TO WS-TTL-TOTAL-COST         12159068
121591     END-IF.                                                      12159168
121700     MOVE  WS-TOTAL-PO-UNITS         TO WS-TTL-UNIT-TOTAL.        12170000
121800     MOVE '%'                        TO WS-TTL-PCT.               12180000
121900                                                                  12190000
122000     IF WS-TOTAL-PO-RETAIL  = 0                                   12200000
122100         MOVE 0                      TO WS-TTL-MKUP               12210000
122200     ELSE                                                         12220000
122300         COMPUTE WS-SAVE-MKUP =                                   12230000
122400          ((WS-TOTAL-PO-RETAIL   - WS-TOTAL-PO-COST  ) /          12240000
122500             WS-TOTAL-PO-RETAIL)  * 100                           12250000
122600         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              12260000
122700                                                                  12270000
122800     IF WS-LINE-CNT > 55                                          12280000
122900         PERFORM 1000-PRINT-HEADINGS THRU                         12290000
123000                 1000-EXIT-PRINT-HEADINGS.                        12300000
123100     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       12310000
123200     ADD WS-CC TO WS-LINE-CNT.                                    12320000
123300                                                                  12330000
123400 0410-CONTINUE.                                                   12340033
123500     MOVE 0                          TO WS-CNT-DTL.               12350000
123600     MOVE +0                         TO WS-TOTAL-PO-UNITS         12360000
123700                                        WS-TOTAL-PO-COST          12370000
123800                                        WS-TOTAL-PO-RETAIL.       12380000
123900     MOVE 'N'                        TO SW-WEEKLY-PO-RECS.        12390033
124000 0410-EXIT. EXIT.                                                 12400000
124100                                                                  12410000
124200 0420-PRT-CLSTOTAL-LINE.                                          12420000
124300     IF NO-WEEKLY-CLASS-RECS                                      12430033
124400         GO TO 0420-CONTINUE.                                     12440033
124500                                                                  12450033
124600     IF WS-LINE-CNT > 55                                          12460000
124700         PERFORM 1000-PRINT-HEADINGS THRU                         12470000
124800                 1000-EXIT-PRINT-HEADINGS.                        12480000
124900     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-DASH AFTER 1.        12490000
125000     ADD 1     TO WS-LINE-CNT.                                    12500000
125100                                                                  12510000
125200     MOVE 'SUBCLASS - '              TO WS-TTL-LIT-A.             12520000
125300     MOVE WS-HOLD-CLASS              TO WS-TTL-LIT-B.             12530000
125400     MOVE WS-HOLD-CLASS-NAME         TO WS-TTL-LIT-C.             12540000
125500     MOVE '      TOTAL:'             TO WS-TTL-LIT-1.             12550000
125610     IF  WS-TOTAL-CLASS-RETAIL >  999999999.99                    12561067
125620         MOVE  WS-TOTAL-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1-RD   12562066
125630     ELSE                                                         12563066
125640         MOVE  WS-TOTAL-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1      12564066
125650     END-IF.                                                      12565066
125660     IF  WS-TOTAL-CLASS-COST >    999999999.99                    12566068
125670         MOVE  WS-TOTAL-CLASS-COST TO WS-TTL-TOTAL-COST1-RD       12567068
125680     ELSE                                                         12568068
125690         MOVE  WS-TOTAL-CLASS-COST TO WS-TTL-TOTAL-COST1          12569068
125691     END-IF.                                                      12569168
125800     MOVE  WS-TOTAL-CLASS-UNITS      TO WS-TTL-UNIT-TOTAL1.       12580000
125900     MOVE '%'                        TO WS-TTL-PCT1.              12590000
126000                                                                  12600000
126100     IF WS-TOTAL-CLASS-RETAIL = 0                                 12610000
126200         MOVE 0                      TO WS-TTL-MKUP1              12620000
126300     ELSE                                                         12630000
126400         COMPUTE WS-SAVE-MKUP =                                   12640000
126500          ((WS-TOTAL-CLASS-RETAIL   - WS-TOTAL-CLASS-COST  ) /    12650000
126600             WS-TOTAL-CLASS-RETAIL)  * 100                        12660000
126700         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP1.             12670000
126800                                                                  12680000
126900     IF WS-LINE-CNT > 55                                          12690000
127000         PERFORM 1000-PRINT-HEADINGS THRU                         12700000
127100                 1000-EXIT-PRINT-HEADINGS.                        12710000
127200     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE1 AFTER 1.       12720000
127300     ADD WS-CC TO WS-LINE-CNT.                                    12730000
127400                                                                  12740000
127500 0420-CONTINUE.                                                   12750033
127600     MOVE RC043-CLASS                TO WS-HOLD-CLASS.            12760000
127700     MOVE RC043-SUB-CL-DESC          TO WS-HOLD-CLASS-NAME.       12770000
127800     MOVE +0                         TO WS-TOTAL-CLASS-UNITS      12780000
127900                                        WS-TOTAL-CLASS-COST       12790000
128000                                        WS-TOTAL-CLASS-RETAIL.    12800000
128100     MOVE 'N'                        TO SW-WEEKLY-CLASS-RECS.     12810033
128200 0420-EXIT. EXIT.                                                 12820000
128300                                                                  12830000
128400 0425-PRT-MAJTOTAL-LINE.                                          12840000
128500     IF NO-WEEKLY-MAJ-RECS                                        12850033
128600         GO TO 0425-CONTINUE.                                     12860033
128700                                                                  12870033
128800     IF WS-LINE-CNT > 55                                          12880000
128900         PERFORM 1000-PRINT-HEADINGS THRU                         12890000
129000                 1000-EXIT-PRINT-HEADINGS.                        12900000
129100     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-DASH AFTER 1.        12910000
129200     ADD 1     TO WS-LINE-CNT.                                    12920000
129300                                                                  12930000
129400     MOVE '   CLASS - '              TO WS-TTL-LIT-A.             12940000
129500     MOVE WS-HOLD-MAJ-CLASS          TO WS-TTL-LIT-B.             12950000
129600     MOVE WS-HOLD-MAJ-CLASS-NAME     TO WS-TTL-LIT-C.             12960000
129700     MOVE '      TOTAL:'             TO WS-TTL-LIT-1.             12970000
129810     IF  WS-TOTAL-MAJ-CLASS-RETAIL >  999999999.99                12981067
129820         MOVE WS-TOTAL-MAJ-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1-RD12982066
129830     ELSE                                                         12983066
129840         MOVE WS-TOTAL-MAJ-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1   12984066
129850     END-IF.                                                      12985066
129860     IF  WS-TOTAL-MAJ-CLASS-COST >    999999999.99                12986068
129870         MOVE WS-TOTAL-MAJ-CLASS-COST TO   WS-TTL-TOTAL-COST1-RD  12987068
129880     ELSE                                                         12988068
129890         MOVE WS-TOTAL-MAJ-CLASS-COST TO WS-TTL-TOTAL-COST1       12989068
129891     END-IF.                                                      12989168
130000     MOVE  WS-TOTAL-MAJ-CLASS-UNITS  TO WS-TTL-UNIT-TOTAL1.       13000000
130100     MOVE '%'                        TO WS-TTL-PCT1.              13010000
130200                                                                  13020000
130300     IF WS-TOTAL-MAJ-CLASS-RETAIL = 0                             13030000
130400         MOVE 0                      TO WS-TTL-MKUP1              13040000
130500     ELSE                                                         13050000
130600         COMPUTE WS-SAVE-MKUP =                                   13060000
130700          ((WS-TOTAL-MAJ-CLASS-RETAIL -                           13070000
130800            WS-TOTAL-MAJ-CLASS-COST  ) /                          13080000
130900             WS-TOTAL-MAJ-CLASS-RETAIL)  * 100                    13090000
131000         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP1.             13100000
131100                                                                  13110000
131200     IF WS-LINE-CNT > 55                                          13120000
131300         PERFORM 1000-PRINT-HEADINGS THRU                         13130000
131400                 1000-EXIT-PRINT-HEADINGS.                        13140000
131500     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE1 AFTER 1.       13150000
131600     ADD WS-CC TO WS-LINE-CNT.                                    13160000
131700                                                                  13170000
131800     IF WS-LINE-CNT > 55                                          13180000
131900         PERFORM 1000-PRINT-HEADINGS THRU                         13190000
132000                 1000-EXIT-PRINT-HEADINGS.                        13200000
132100     MOVE SPACES TO WS-DETAIL.                                    13210031
132200     WRITE BUYERS-RECEIPTS-RPT FROM WS-DETAIL AFTER 2.            13220018
132300     ADD 2     TO WS-LINE-CNT.                                    13230018
132400     MOVE 1 TO WS-CC.                                             13240000
132500                                                                  13250003
132600 0425-CONTINUE.                                                   13260033
132700     SET IDX-STORE TO 1.                                          13270014
132800     MOVE +0 TO PV-MAX-STORE-RECS.                                13280012
132900     PERFORM 0426-SETUP-STORE-TABLE THRU 0426-EXIT                13290012
133000         VARYING IDX-SAVE FROM 1 BY 1                             13300012
133100             UNTIL IDX-SAVE > 9999.                               13310064
133200                                                                  13320012
133300     PERFORM 0427-PRINT-STORE-TABLE THRU 0427-EXIT                13330012
133400         VARYING IDX-STORE FROM 1 BY 1                            13340012
133500             UNTIL IDX-STORE > PV-MAX-STORE-RECS.                 13350012
133600                                                                  13360016
133700     ADD 100 TO WS-LINE-CNT.                                      13370026
133800                                                                  13380026
133900     INITIALIZE DT-STORE-TABLE.                                   13390026
134000     INITIALIZE DT-SAVE-STORE-TABLE.                              13400026
134100                                                                  13410003
134200     MOVE RC043-MAJ-CL-NBR           TO WS-HOLD-MAJ-CLASS.        13420003
134300     MOVE RC043-MAJ-CL-DESC          TO WS-HOLD-MAJ-CLASS-NAME.   13430003
134400     MOVE +0                        TO WS-TOTAL-MAJ-CLASS-UNITS   13440003
134500                                       WS-TOTAL-MAJ-CLASS-COST    13450003
134600                                       WS-TOTAL-MAJ-CLASS-RETAIL. 13460003
134700     MOVE 'N'                        TO SW-WEEKLY-MAJ-RECS.       13470033
134800 0425-EXIT. EXIT.                                                 13480000
134900                                                                  13490003
135000 0426-SETUP-STORE-TABLE.                                          13500003
135100     IF DT-SAVE-STORE-WEEK-RETAIL(IDX-SAVE) = +0 AND              13510013
135200        DT-SAVE-STORE-WEEK-COST  (IDX-SAVE) = +0 AND              13520013
135300        DT-SAVE-STORE-MTD-RETAIL(IDX-SAVE) = +0 AND               13530013
135400        DT-SAVE-STORE-MTD-COST  (IDX-SAVE) = +0                   13540013
135500         GO TO 0426-EXIT                                          13550005
135600     ELSE                                                         13560003
135700        MOVE DT-SAVE-STORE-NBR(IDX-SAVE) TO                       13570012
135800                DT-STORE-NBR(IDX-STORE)                           13580012
135900        MOVE DT-SAVE-STORE-WEEK-COST  (IDX-SAVE) TO               13590012
136000             DT-STORE-WEEK-COST  (IDX-STORE)                      13600012
136100        MOVE DT-SAVE-STORE-WEEK-RETAIL(IDX-SAVE) TO               13610012
136200             DT-STORE-WEEK-RETAIL(IDX-STORE)                      13620012
136300        MOVE DT-SAVE-STORE-MTD-COST  (IDX-SAVE) TO                13630012
136400             DT-STORE-MTD-COST  (IDX-STORE)                       13640012
136500        MOVE DT-SAVE-STORE-MTD-RETAIL(IDX-SAVE) TO                13650012
136600             DT-STORE-MTD-RETAIL(IDX-STORE)                       13660012
136700        SET IDX-STORE UP BY +1                                    13670014
136800        ADD +1 TO  PV-MAX-STORE-RECS                              13680014
136900     END-IF.                                                      13690012
137000 0426-EXIT. EXIT.                                                 13700003
137100                                                                  13710000
137200 0427-PRINT-STORE-TABLE.                                          13720003
137300     IF IDX-STORE = 1 AND WS-LINE-CNT > 50                        13730003
137400         PERFORM 1000-PRINT-HEADINGS THRU                         13740003
137500                 1000-EXIT-PRINT-HEADINGS.                        13750003
137600                                                                  13760007
137700     IF IDX-STORE = 1                                             13770003
137800         MOVE WS-HOLD-MAJ-CLASS      TO STORE-TBL-HEAD1-MAJ       13780007
137900         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD1 AFTER 1   13790003
138000         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD2 AFTER 1   13800003
138100         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD3 AFTER 1   13810003
138200         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-DASH AFTER 1    13820003
138300         ADD 4 TO WS-LINE-CNT.                                    13830008
138400                                                                  13840007
138500     IF WS-LINE-CNT > 55                                          13850003
138600         PERFORM 1000-PRINT-HEADINGS THRU                         13860003
138700                 1000-EXIT-PRINT-HEADINGS                         13870007
138800         MOVE WS-HOLD-MAJ-CLASS      TO STORE-TBL-HEAD1-MAJ       13880007
138900         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD1 AFTER 1   13890007
139000         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD2 AFTER 1   13900007
139100         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD3 AFTER 1   13910007
139200         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-DASH AFTER 1    13920007
139300         ADD 4 TO WS-LINE-CNT.                                    13930008
139400                                                                  13940011
139500     MOVE DT-STORE-NBR  (IDX-STORE) TO WS-STORE-1.                13950026
139600     IF WEEKLY-RUN                                                13960040
139700         MOVE DT-STORE-WEEK-COST  (IDX-STORE) TO                  13970026
139800             WS-STORE-WEEK-COST-1                                 13980026
139900         MOVE DT-STORE-WEEK-RETAIL(IDX-STORE) TO                  13990026
140000             WS-STORE-WEEK-RETAIL-1                               14000026
140100     END-IF.                                                      14010040
140200     MOVE DT-STORE-MTD-COST  (IDX-STORE) TO                       14020009
140300         WS-STORE-MTD-COST-1.                                     14030003
140400     MOVE DT-STORE-MTD-RETAIL(IDX-STORE) TO                       14040009
140500         WS-STORE-MTD-RETAIL-1.                                   14050003
140600                                                                  14060026
140700     SET IDX-STORE UP BY +1.                                      14070009
140800     MOVE DT-STORE-NBR  (IDX-STORE) TO WS-STORE-2.                14080011
140900     IF WEEKLY-RUN                                                14090040
141000         MOVE DT-STORE-WEEK-COST  (IDX-STORE) TO                  14100026
141100             WS-STORE-WEEK-COST-2                                 14110026
141200         MOVE DT-STORE-WEEK-RETAIL(IDX-STORE) TO                  14120026
141300             WS-STORE-WEEK-RETAIL-2                               14130026
141400     END-IF.                                                      14140040
141500     MOVE DT-STORE-MTD-COST  (IDX-STORE) TO                       14150009
141600         WS-STORE-MTD-COST-2.                                     14160011
141700     MOVE DT-STORE-MTD-RETAIL(IDX-STORE) TO                       14170009
141800         WS-STORE-MTD-RETAIL-2.                                   14180011
141900                                                                  14190016
142000     IF DT-STORE-NBR  (IDX-STORE) = 0                             14200016
142100         MOVE SPACES TO STORE-TBL-DETAIL2.                        14210016
142200                                                                  14220011
142300     WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-DETAIL AFTER 1.     14230009
142400     ADD 1 TO WS-LINE-CNT.                                        14240009
142500     MOVE SPACES                     TO STORE-TBL-DETAIL.         14250026
142600 0427-EXIT. EXIT.                                                 14260003
142700                                                                  14270003
142800 0430-PRT-DEPT-LINE.                                              14280044
142900     IF NO-WEEKLY-DEPT-RECS                                       14290033
143000         GO TO 0430-CONTINUE.                                     14300033
143100                                                                  14310033
143200     MOVE ' DEPT TOTAL:'             TO WS-TTL-LIT-2.             14320000
143310     IF  WS-TOTAL-DEPT-RETAIL >  999999999.99                     14331067
143320         MOVE WS-TOTAL-DEPT-RETAIL TO WS-TTL-TOTAL-RETAIL-RD      14332066
143330     ELSE                                                         14333066
143340         MOVE WS-TOTAL-DEPT-RETAIL TO WS-TTL-TOTAL-RETAIL         14334066
143350     END-IF.                                                      14335066
143360     IF  WS-TOTAL-DEPT-COST >    999999999.99                     14336068
143370         MOVE WS-TOTAL-DEPT-COST TO WS-TTL-TOTAL-COST-RD          14337068
143380     ELSE                                                         14338068
143390         MOVE WS-TOTAL-DEPT-COST TO WS-TTL-TOTAL-COST             14339068
143391     END-IF.                                                      14339168
143500     MOVE  WS-TOTAL-DEPT-UNITS       TO WS-TTL-UNIT-TOTAL.        14350000
143600     MOVE '%'                        TO WS-TTL-PCT.               14360000
143700                                                                  14370000
143800     IF WS-TOTAL-DEPT-RETAIL = 0                                  14380000
143900         MOVE 0                      TO WS-TTL-MKUP               14390000
144000     ELSE                                                         14400000
144100         COMPUTE WS-SAVE-MKUP =                                   14410000
144200          ((WS-TOTAL-DEPT-RETAIL   - WS-TOTAL-DEPT-COST  ) /      14420000
144300             WS-TOTAL-DEPT-RETAIL)  * 100                         14430000
144400         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              14440000
144500                                                                  14450000
144600     IF WS-LINE-CNT > 55                                          14460000
144700         PERFORM 1000-PRINT-HEADINGS THRU                         14470000
144800                 1000-EXIT-PRINT-HEADINGS.                        14480000
144900     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       14490000
145000                                                                  14500028
145100     IF WS-LINE-CNT > 55                                          14510028
145200         PERFORM 1000-PRINT-HEADINGS THRU                         14520028
145300                 1000-EXIT-PRINT-HEADINGS.                        14530028
145400     MOVE SPACES TO WS-DETAIL.                                    14540031
145500     WRITE BUYERS-RECEIPTS-RPT FROM WS-DETAIL AFTER 2.            14550028
145600     ADD 2     TO WS-LINE-CNT.                                    14560028
145700     MOVE 1 TO WS-CC.                                             14570028
145800                                                                  14580020
145900 0430-CONTINUE.                                                   14590033
146000     SET IDX-STORE-DEPT TO 1.                                     14600020
146100     MOVE +0 TO PV-MAX-STORE-RECS-DEPT.                           14610020
146200     PERFORM 0432-SETUP-STORE-TABLE-DEPT THRU 0432-EXIT           14620020
146300         VARYING IDX-SAVE-DEPT FROM 1 BY 1                        14630020
146400             UNTIL IDX-SAVE-DEPT > 999.                           14640020
146500                                                                  14650020
146600     PERFORM 0433-PRINT-STORE-TABLE-DEPT THRU 0433-EXIT           14660020
146700         VARYING IDX-STORE-DEPT FROM 1 BY 1                       14670020
146800             UNTIL IDX-STORE-DEPT > PV-MAX-STORE-RECS-DEPT.       14680020
146900                                                                  14690020
147000     INITIALIZE DT-STORE-TABLE-DEPT.                              14700020
147100     INITIALIZE DT-SAVE-STORE-TABLE-DEPT.                         14710020
147200                                                                  14720000
147300     IF PS-DEPT-BREAK                                             14730000
147400         ADD 100 TO WS-LINE-CNT                                   14740000
147500     ELSE                                                         14750000
147600         MOVE SPACES TO WS-DETAIL                                 14760029
147700         IF WS-LINE-CNT > 55                                      14770029
147800             PERFORM 1000-PRINT-HEADINGS THRU                     14780029
147900                     1000-EXIT-PRINT-HEADINGS                     14790029
148000         ELSE                                                     14800029
148100             WRITE BUYERS-RECEIPTS-RPT FROM WS-DETAIL AFTER 3     14810030
148200             ADD 3     TO WS-LINE-CNT.                            14820030
148300                                                                  14830000
148400     MOVE +0                         TO WS-TOTAL-DEPT-UNITS       14840000
148500                                        WS-TOTAL-DEPT-COST        14850000
148600                                        WS-TOTAL-DEPT-RETAIL.     14860000
148700     MOVE RC043-DEPT                 TO WS-HOLD-DEPT.             14870000
148800     MOVE RC043-DEPT                 TO WS-HDR7-DEPARTMENT.       14880000
148900     MOVE RC043-DEPT-NAME            TO WS-HDR7-DEPT-NAME.        14890000
149000     MOVE 'N'                        TO SW-WEEKLY-DEPT-RECS.      14900033
149100 0430-EXIT. EXIT.                                                 14910000
149200                                                                  14920020
149300 0432-SETUP-STORE-TABLE-DEPT.                                     14930020
149400     IF DT-SAVE-STORE-WEEK-RETAIL-DEPT(IDX-SAVE-DEPT) = +0 AND    14940020
149500        DT-SAVE-STORE-WEEK-COST-DEPT  (IDX-SAVE-DEPT) = +0 AND    14950020
149600        DT-SAVE-STORE-MTD-RETAIL-DEPT (IDX-SAVE-DEPT) = +0 AND    14960020
149700        DT-SAVE-STORE-MTD-COST-DEPT   (IDX-SAVE-DEPT) = +0        14970020
149800         GO TO 0432-EXIT                                          14980020
149900     ELSE                                                         14990020
150000        MOVE DT-SAVE-STORE-NBR-DEPT(IDX-SAVE-DEPT) TO             15000020
150100                DT-STORE-NBR-DEPT(IDX-STORE-DEPT)                 15010020
150200        MOVE DT-SAVE-STORE-WEEK-COST-DEPT  (IDX-SAVE-DEPT) TO     15020020
150300             DT-STORE-WEEK-COST-DEPT  (IDX-STORE-DEPT)            15030020
150400        MOVE DT-SAVE-STORE-WEEK-RETAIL-DEPT(IDX-SAVE-DEPT) TO     15040020
150500             DT-STORE-WEEK-RETAIL-DEPT(IDX-STORE-DEPT)            15050020
150600        MOVE DT-SAVE-STORE-MTD-COST-DEPT  (IDX-SAVE-DEPT) TO      15060020
150700             DT-STORE-MTD-COST-DEPT  (IDX-STORE-DEPT)             15070020
150800        MOVE DT-SAVE-STORE-MTD-RETAIL-DEPT(IDX-SAVE-DEPT) TO      15080020
150900             DT-STORE-MTD-RETAIL-DEPT(IDX-STORE-DEPT)             15090020
151000        SET IDX-STORE-DEPT UP BY +1                               15100020
151100        ADD +1 TO  PV-MAX-STORE-RECS-DEPT                         15110020
151200     END-IF.                                                      15120020
151300 0432-EXIT. EXIT.                                                 15130020
151400                                                                  15140020
151500 0433-PRINT-STORE-TABLE-DEPT.                                     15150020
151600     IF IDX-STORE-DEPT = 1 AND WS-LINE-CNT > 50                   15160020
151700         PERFORM 1000-PRINT-HEADINGS THRU                         15170020
151800                 1000-EXIT-PRINT-HEADINGS.                        15180020
151900                                                                  15190020
152000     IF IDX-STORE-DEPT = 1                                        15200020
152100         MOVE WS-HOLD-DEPT           TO STORE-TBL-HEAD1-DPT       15210021
152200         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD1-DEPT      15220020
152300                                                        AFTER 1   15230020
152400         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD2 AFTER 1   15240020
152500         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD3 AFTER 1   15250020
152600         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-DASH AFTER 1    15260020
152700         ADD 4 TO WS-LINE-CNT.                                    15270020
152800                                                                  15280020
152900     IF WS-LINE-CNT > 55                                          15290020
153000         PERFORM 1000-PRINT-HEADINGS THRU                         15300020
153100                 1000-EXIT-PRINT-HEADINGS                         15310020
153200         MOVE WS-HOLD-DEPT           TO STORE-TBL-HEAD1-DPT       15320021
153300         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD1-DEPT      15330020
153400                                                        AFTER 1   15340020
153500         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD2 AFTER 1   15350020
153600         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-HEAD3 AFTER 1   15360020
153700         WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-DASH AFTER 1    15370020
153800         ADD 4 TO WS-LINE-CNT.                                    15380020
153900                                                                  15390020
154000     MOVE DT-STORE-NBR-DEPT  (IDX-STORE-DEPT) TO WS-STORE-1.      15400020
154100     IF WEEKLY-RUN                                                15410040
154200         MOVE DT-STORE-WEEK-COST-DEPT  (IDX-STORE-DEPT) TO        15420026
154300             WS-STORE-WEEK-COST-1                                 15430026
154400         MOVE DT-STORE-WEEK-RETAIL-DEPT(IDX-STORE-DEPT) TO        15440026
154500             WS-STORE-WEEK-RETAIL-1                               15450026
154600     END-IF.                                                      15460040
154700     MOVE DT-STORE-MTD-COST-DEPT  (IDX-STORE-DEPT) TO             15470020
154800         WS-STORE-MTD-COST-1.                                     15480020
154900     MOVE DT-STORE-MTD-RETAIL-DEPT(IDX-STORE-DEPT) TO             15490020
155000         WS-STORE-MTD-RETAIL-1.                                   15500020
155100                                                                  15510026
155200     SET IDX-STORE-DEPT UP BY +1.                                 15520020
155300     MOVE DT-STORE-NBR-DEPT  (IDX-STORE-DEPT) TO WS-STORE-2.      15530020
155400     IF WEEKLY-RUN                                                15540040
155500         MOVE DT-STORE-WEEK-COST-DEPT  (IDX-STORE-DEPT) TO        15550026
155600             WS-STORE-WEEK-COST-2                                 15560026
155700         MOVE DT-STORE-WEEK-RETAIL-DEPT(IDX-STORE-DEPT) TO        15570026
155800             WS-STORE-WEEK-RETAIL-2                               15580026
155900     END-IF.                                                      15590040
156000     MOVE DT-STORE-MTD-COST-DEPT  (IDX-STORE-DEPT) TO             15600020
156100         WS-STORE-MTD-COST-2.                                     15610020
156200     MOVE DT-STORE-MTD-RETAIL-DEPT(IDX-STORE-DEPT) TO             15620020
156300         WS-STORE-MTD-RETAIL-2.                                   15630020
156400                                                                  15640020
156500     IF DT-STORE-NBR-DEPT  (IDX-STORE-DEPT) = 0                   15650020
156600         MOVE SPACES TO STORE-TBL-DETAIL2.                        15660020
156700                                                                  15670020
156800     WRITE BUYERS-RECEIPTS-RPT FROM STORE-TBL-DETAIL AFTER 1.     15680020
156900     ADD 1 TO WS-LINE-CNT.                                        15690020
157000     MOVE SPACES                     TO STORE-TBL-DETAIL.         15700026
157100 0433-EXIT. EXIT.                                                 15710020
157200                                                                  15720000
157300 0440-PRT-BYR-LINE.                                               15730000
157400     MOVE 'BUYER TOTAL:'             TO WS-TTL-LIT-2.             15740000
157510     IF  WS-TOTAL-BYR-RETAIL >  999999999.99                      15751067
157520         MOVE WS-TOTAL-BYR-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       15752066
157530     ELSE                                                         15753066
157540         MOVE WS-TOTAL-BYR-RETAIL TO WS-TTL-TOTAL-RETAIL          15754066
157550     END-IF.                                                      15755066
157560     IF  WS-TOTAL-BYR-COST >    999999999.99                      15756068
157570         MOVE WS-TOTAL-BYR-COST TO WS-TTL-TOTAL-COST-RD           15757068
157580     ELSE                                                         15758068
157590         MOVE WS-TOTAL-BYR-COST TO WS-TTL-TOTAL-COST              15759068
157591     END-IF.                                                      15759168
157700     MOVE  WS-TOTAL-BYR-UNITS        TO WS-TTL-UNIT-TOTAL.        15770000
157800     MOVE '%'                        TO WS-TTL-PCT.               15780000
157900                                                                  15790000
158000     IF WS-TOTAL-BYR-RETAIL = 0                                   15800000
158100         MOVE 0                      TO WS-TTL-MKUP               15810000
158200     ELSE                                                         15820000
158300         COMPUTE WS-SAVE-MKUP =                                   15830000
158400          ((WS-TOTAL-BYR-RETAIL   - WS-TOTAL-BYR-COST  ) /        15840000
158500             WS-TOTAL-BYR-RETAIL)  * 100                          15850000
158600         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              15860000
158700                                                                  15870000
158800     IF WS-LINE-CNT > 55                                          15880000
158900         PERFORM 1000-PRINT-HEADINGS THRU                         15890000
159000                 1000-EXIT-PRINT-HEADINGS.                        15900000
159100     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       15910000
159200                                                                  15920000
159300     IF PS-BYR-BREAK                                              15930000
159400         ADD 100 TO WS-LINE-CNT                                   15940000
159500     ELSE                                                         15950000
159600         ADD 1 TO WS-LINE-CNT.                                    15960000
159700                                                                  15970000
159800     MOVE +0                         TO WS-TOTAL-BYR-UNITS        15980000
159900                                        WS-TOTAL-BYR-COST         15990000
160000                                        WS-TOTAL-BYR-RETAIL.      16000000
160100     MOVE RC043-BYR-NBR              TO WS-HOLD-BYR.              16010000
160200     MOVE RC043-BYR-NBR              TO WS-HDR6-BYR-NO.           16020000
160300     MOVE RC043-BYR-NAME             TO WS-HDR6-BYR-NAME.         16030000
160400 0440-EXIT. EXIT.                                                 16040000
160500                                                                  16050000
160600 0450-PRT-DMM-LINE.                                               16060000
160700     MOVE '  DMM TOTAL:'             TO WS-TTL-LIT-2.             16070000
160810     IF  WS-TOTAL-DMM-RETAIL >  999999999.99                      16081067
160820         MOVE WS-TOTAL-DMM-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       16082066
160830     ELSE                                                         16083066
160840         MOVE WS-TOTAL-DMM-RETAIL TO WS-TTL-TOTAL-RETAIL          16084066
160850     END-IF.                                                      16085066
160860     IF  WS-TOTAL-DMM-COST >    999999999.99                      16086068
160870         MOVE WS-TOTAL-DMM-COST TO WS-TTL-TOTAL-COST-RD           16087068
160880     ELSE                                                         16088068
160890         MOVE WS-TOTAL-DMM-COST TO WS-TTL-TOTAL-COST              16089068
160891     END-IF.                                                      16089168
161000     MOVE  WS-TOTAL-DMM-UNITS        TO WS-TTL-UNIT-TOTAL.        16100000
161100     MOVE '%'                        TO WS-TTL-PCT.               16110000
161200                                                                  16120000
161300     IF WS-TOTAL-DMM-RETAIL = 0                                   16130000
161400         MOVE 0                      TO WS-TTL-MKUP               16140000
161500     ELSE                                                         16150000
161600         COMPUTE WS-SAVE-MKUP =                                   16160000
161700          ((WS-TOTAL-DMM-RETAIL   - WS-TOTAL-DMM-COST  ) /        16170000
161800             WS-TOTAL-DMM-RETAIL)  * 100                          16180000
161900         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              16190000
162000                                                                  16200000
162100     IF WS-LINE-CNT > 55                                          16210000
162200         PERFORM 1000-PRINT-HEADINGS THRU                         16220000
162300                 1000-EXIT-PRINT-HEADINGS.                        16230000
162400     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       16240000
162500                                                                  16250000
162600     IF PS-DMM-BREAK                                              16260000
162700         ADD 100 TO WS-LINE-CNT                                   16270000
162800     ELSE                                                         16280000
162900         ADD 1 TO WS-LINE-CNT.                                    16290000
163000                                                                  16300000
163100     MOVE +0                         TO WS-TOTAL-DMM-UNITS        16310000
163200                                        WS-TOTAL-DMM-COST         16320000
163300                                        WS-TOTAL-DMM-RETAIL.      16330000
163400     MOVE RC043-DMM-NBR              TO WS-HOLD-DM.               16340000
163500     MOVE RC043-DMM-NBR              TO WS-HDR5-DMM-NO.           16350000
163600     MOVE RC043-DMM-NAME             TO WS-HDR5-DMM-NAME.         16360000
163700 0450-EXIT. EXIT.                                                 16370000
163800                                                                  16380000
163900 0460-PRT-GMM-LINE.                                               16390000
164000     MOVE '  GMM TOTAL:'             TO WS-TTL-LIT-2.             16400000
164110     IF  WS-TOTAL-GMM-RETAIL >  999999999.99                      16411067
164120         MOVE WS-TOTAL-GMM-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       16412066
164130     ELSE                                                         16413066
164140         MOVE WS-TOTAL-GMM-RETAIL TO WS-TTL-TOTAL-RETAIL          16414066
164150     END-IF.                                                      16415066
164160     IF  WS-TOTAL-GMM-COST >    999999999.99                      16416068
164170         MOVE WS-TOTAL-GMM-COST TO WS-TTL-TOTAL-COST-RD           16417068
164180     ELSE                                                         16418068
164190         MOVE WS-TOTAL-GMM-COST TO WS-TTL-TOTAL-COST              16419068
164191     END-IF.                                                      16419168
164300     MOVE  WS-TOTAL-GMM-UNITS        TO WS-TTL-UNIT-TOTAL.        16430000
164400     MOVE '%'                        TO WS-TTL-PCT.               16440000
164500                                                                  16450000
164600     IF WS-TOTAL-GMM-RETAIL = 0                                   16460000
164700         MOVE 0                      TO WS-TTL-MKUP               16470000
164800     ELSE                                                         16480000
164900         COMPUTE WS-SAVE-MKUP =                                   16490000
165000          ((WS-TOTAL-GMM-RETAIL   - WS-TOTAL-GMM-COST  ) /        16500000
165100             WS-TOTAL-GMM-RETAIL)  * 100                          16510000
165200         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              16520000
165300                                                                  16530000
165400     IF WS-LINE-CNT > 55                                          16540000
165500         PERFORM 1000-PRINT-HEADINGS THRU                         16550000
165600                 1000-EXIT-PRINT-HEADINGS.                        16560000
165700     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       16570000
165800                                                                  16580000
165900     IF PS-GMM-BREAK                                              16590000
166000         ADD 100 TO WS-LINE-CNT                                   16600000
166100     ELSE                                                         16610000
166200         ADD 1 TO WS-LINE-CNT.                                    16620000
166300                                                                  16630000
166400     MOVE +0                         TO WS-TOTAL-GMM-UNITS        16640000
166500                                        WS-TOTAL-GMM-COST         16650000
166600                                        WS-TOTAL-GMM-RETAIL.      16660000
166700     MOVE RC043-GMM-NBR              TO WS-HOLD-GM.               16670000
166800     MOVE RC043-GMM-NBR              TO WS-HDR4-GMM-NO.           16680000
166900     MOVE RC043-GMM-NAME             TO WS-HDR4-GMM-NAME.         16690000
167000 0460-EXIT. EXIT.                                                 16700000
167100                                                                  16710000
167200 0470-PRT-FINAL-LINE.                                             16720000
167300     MOVE 'FINAL TOTAL:'             TO WS-TTL-LIT-2.             16730000
167410     IF  WS-TOTAL-RPT-RETAIL >  999999999.99                      16741067
167420         MOVE WS-TOTAL-RPT-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       16742066
167430     ELSE                                                         16743066
167440         MOVE WS-TOTAL-RPT-RETAIL TO WS-TTL-TOTAL-RETAIL          16744066
167450     END-IF.                                                      16745066
167460     IF  WS-TOTAL-RPT-COST >    999999999.99                      16746068
167470         MOVE WS-TOTAL-RPT-COST TO WS-TTL-TOTAL-COST-RD           16747068
167480     ELSE                                                         16748068
167490         MOVE WS-TOTAL-RPT-COST TO WS-TTL-TOTAL-COST              16749068
167491     END-IF.                                                      16749168
167600     MOVE  WS-TOTAL-RPT-UNITS        TO WS-TTL-UNIT-TOTAL.        16760000
167700     MOVE '%'                        TO WS-TTL-PCT.               16770000
167800                                                                  16780000
167900     IF WS-TOTAL-RPT-RETAIL = 0                                   16790000
168000         MOVE 0                      TO WS-TTL-MKUP               16800000
168100     ELSE                                                         16810000
168200         COMPUTE WS-SAVE-MKUP =                                   16820000
168300          ((WS-TOTAL-RPT-RETAIL   - WS-TOTAL-RPT-COST  ) /        16830000
168400             WS-TOTAL-RPT-RETAIL)  * 100                          16840000
168500         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              16850000
168600                                                                  16860000
168700     IF WS-LINE-CNT > 55                                          16870000
168800         PERFORM 1000-PRINT-HEADINGS THRU                         16880000
168900                 1000-EXIT-PRINT-HEADINGS.                        16890000
169000     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       16900000
169100 0470-EXIT. EXIT.                                                 16910000
169200                                                                  16920000
169300 1000-PRINT-HEADINGS.                                             16930000
169400     ADD +1 TO WS-PAGE-CNT.                                       16940000
169500     MOVE WS-PAGE-CNT TO DP132O-PAGE-NUMBER.                      16950000
169600     WRITE BUYERS-RECEIPTS-RPT FROM                               16960000
169700                           DP132O-STANDRD-HEADER-132-COLS         16970000
169800                               AFTER PAGE.                        16980000
169900     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER2 AFTER 1.           16990000
170000     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER3 AFTER 1.           17000000
170100     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER4 AFTER 1.           17010000
170200     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER5 AFTER 1.           17020000
170300     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER6 AFTER 1.           17030000
170400     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER7 AFTER 2.           17040000
170500     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER8 AFTER 2.           17050000
170600     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER9 AFTER 1.           17060000
170700     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER10 AFTER 1.          17070000
170800     MOVE +11 TO WS-LINE-CNT.                                     17080000
170900     MOVE WS-HOLD-VENDOR-NAME        TO WS-DTL-VENDOR-NAME.       17090000
171000     MOVE WS-HOLD-CLASS              TO WS-DTL-CLASS.             17100000
171100 1000-EXIT-PRINT-HEADINGS. EXIT.                                  17110000
171200                                                                  17120000
171300 1050-DATE-CALCULATION.                                           17130000
171400     INITIALIZE DPG51.                                            17140000
171500     MOVE WS-DATE                  TO DPG51-SYSTEM-DATE.          17150000
171600     SET  DPG51-FISCAL-454-CALENDAR                               17160000
171700                                   TO TRUE.                       17170000
171800     SET  DPG51-DO-NOT-INCR-DECR-DATE                             17180000
171900                                   TO TRUE.                       17190000
172000                                                                  17200000
172100     SET DPG52-LK-DTE-ISO          TO TRUE.                       17210000
172200                                                                  17220000
172300     IF  WS-WK-END-DATE > WS-DATE-CCYYMMDD                        17230062
172400         MOVE WS-WK-END-DATE       TO DPG52-LK-DATE-INPUT         17240062
172500     ELSE                                                         17250062
172600         MOVE WS-DATE-CCYYMMDD     TO DPG52-LK-DATE-INPUT         17260062
172700     END-IF.                                                      17270062
172800                                                                  17280000
172900     CALL PC-DPKUT500 USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.  17290000
173000                                                                  17300000
173100     IF (DPG54-DATE-INVALID                                       17310000
173200     OR  DPG54-SEVERE-ERROR)                                      17320000
173300         DISPLAY '*** ABEND *** IN RCKRP025'                      17330001
173400         DISPLAY 'ERROR IN CALL TO DPKUT500'                      17340000
173500         DISPLAY DPG54-ERROR-MESSAGE                              17350000
173600         MOVE +4003 TO ABEND-CODE                                 17360000
173700         CALL 'ILBOABN0' USING ABEND-CODE                         17370000
173800     ELSE                                                         17380000
173900         MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO WS-1ST-DAY-OF-WEEK    17390000
174000         MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO WS-LAST-DAY-OF-WEEK   17400000
174100         MOVE DPG56-FISCAL-PERIOD-NAME-ABBR3   TO WS-MONTH        17410000
174200         DISPLAY 'WS-LAST-DAY-OF-WEEK =>' WS-LAST-DAY-OF-WEEK     17420000
174300         DISPLAY 'WS-1ST-DAY-0F-WEEK = ' WS-1ST-DAY-OF-WEEK       17430000
174400         DISPLAY 'WS-MONTH = ' WS-MONTH                           17440000
174500     END-IF.                                                      17450000
174600 1050-EXIT.  EXIT.                                                17460000
174610*                                                                 17461069
174620 5000-GET-PO-INFO.                                                17462069
174630*                                                                 17463069
174640     INITIALIZE  DCLTPURCHS.                                      17464069
174650     EXEC SQL                                                     17465069
174660        SELECT  DERVD_LBL_TYP_CDE                                 17466069
174670          INTO :PURCHS-DERVD-LBL-TYP-CDE                          17467069
174680        FROM  TPURCHS                                             17468069
174690        WHERE  VER_STATUS_CDE = 'A'                               17469069
174691               AND  PO_NBR    = :PV-PO-NBR                        17469169
174692        WITH UR                                                   17469269
174693     END-EXEC.                                                    17469369
174694*                                                                 17469469
174695     EVALUATE TRUE                                                17469569
174696        WHEN SQLCODE = ZERO                                       17469669
174697        WHEN SQLCODE = 100                                        17469771
174698          CONTINUE                                                17469871
174699        WHEN SQLWARN0 NOT = SPACES                                17469971
174700        WHEN SQLCODE  NOT = ZERO                                  17470071
174701          DISPLAY 'PGM RCKRP025 ABENDED - READ GET-PO-INFO '      17470171
174702          MOVE '5000-GET-PO-INFO'     TO PV-PARAGRAPH-NAME        17470271
174703          MOVE 'UNSUCCESSFUL SELECT ' TO PV-DB2-OPERATION         17470371
174704          PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT         17470471
174705     END-EVALUATE.                                                17470571
174706 5000-EXIT. EXIT.                                                 17470671
174707*                                                                 17470771
174710******************************************************************17471063
174800*  FORMAT A DB2 ERROR MESSAGE, RELEASE ALL LOCKS, AND ABEND THE  *17480063
174900*  PROGRAM.                                                      *17490063
175000******************************************************************17500063
175100 9100-SQL-ERROR.                                                  17510063
175200     MOVE SQLCODE                    TO SQLCODE2.                 17520063
175300     MOVE SQLERRD(3)                 TO SQLERRD3.                 17530063
175400     DISPLAY '** ABEND **          = SQL ERROR'.                  17540063
175500     DISPLAY '** PROGRAM **        = RCKRP018'                    17550063
175600     DISPLAY '** PARAGRAPH **      = ' PV-PARAGRAPH-NAME          17560063
175700     DISPLAY '** SQLCODE **        = ' SQLCODE2.                  17570063
175800     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  17580063
175900     DISPLAY '** SQLERRM **        = ' SQLERRM.                   17590063
176000     DISPLAY '** SQLERRMC **       = ' SQLERRMC.                  17600063
176100                                                                  17610063
176200     DISPLAY '** SQLWARN0 **       = ' SQLWARN0.                  17620063
176300     DISPLAY '** SQLWARN1 **       = ' SQLWARN1.                  17630063
176400     DISPLAY '** SQLWARN2 **       = ' SQLWARN2.                  17640063
176500     DISPLAY '** SQLWARN3 **       = ' SQLWARN3.                  17650063
176600     DISPLAY '** SQLWARN4 **       = ' SQLWARN4.                  17660063
176700     DISPLAY '** SQLWARN5 **       = ' SQLWARN5.                  17670063
176800     DISPLAY '** SQLWARN6 **       = ' SQLWARN6.                  17680063
176900     DISPLAY '** SQLWARN7 **       = ' SQLWARN7.                  17690063
177000     DISPLAY '** ABEND     **'.                                   17700063
177100     DISPLAY '** PROGRAM   ** = RCKRP018'.                        17710063
177200     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              17720063
177300     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               17730063
177400                                                                  17740063
177500 9100-SQL-ERROR-EXIT. EXIT.                                       17750063
177600******************************************************************17760063
177700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    17770063
177800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         17780063
177900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     17790063
178000* FORMAT.                                                         17800063
178100******************************************************************17810063
178200     COPY DPPD004.                                                17820064
