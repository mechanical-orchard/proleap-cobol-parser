000100 IDENTIFICATION DIVISION.                                         00010002
000200                                                                  00020002
000300 PROGRAM-ID.      TFKRP006.                                       00030002
000400 AUTHOR.          STEVEN NOWAK.                                   00040002
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050002
000600 DATE-WRITTEN.    04/01/06.                                       00060002
000700 DATE-COMPILED.                                                   00070002
000800                                                                  00080002
000900******************************************************************00090002
001000*  MODULE TYPE:   COBOL2 BATCH                                    00100002
001100*                                                                 00110002
001200*  DESCRIPTION:   WEEKLY CALLBACK ITEMS DETAIL REPORT             00120002
001300*                                                                 00130002
001400*========================== CHANGE LOG ===========================00140017
001500*  AUTH     BY         DATE                 DESCRIPTION           00150017
001600*=================================================================00160017
001700* WR30039  S.NOWAK   04-01-06   CREATE PROGRAM                    00170017
001800*                                                                 00180017
001900* P901928  S.NOWAK   07-20-06   ENSURE DATE IS ON REPORT EVEN IF  00190017
002000*                               NO DATA TO REPORT                 00200017
002100*                                                                 00210017
002200* WR34886  K.GIVENS  06-20-08   ADD DSTRY AND HOLD TO CLBK NUMBER 00220044
002300*                               COLUMN & CALLOUT SECTION ON REPORT00230044
002400*                                                                 00240040
002500******************************************************************00250002
002600                                                                  00260002
002700 ENVIRONMENT DIVISION.                                            00270002
002800 CONFIGURATION SECTION.                                           00280002
002900                                                                  00290002
003000 SOURCE-COMPUTER.        IBM-3090.                                00300002
003100 OBJECT-COMPUTER.        IBM-3090.                                00310002
003200                                                                  00320002
003300 INPUT-OUTPUT SECTION.                                            00330002
003400 FILE-CONTROL.                                                    00340002
003500                                                                  00350002
003600     SELECT EXTR-FILE ASSIGN TO INP01.                            00360002
003700     SELECT DATE-FILE ASSIGN TO INP02.                            00370004
003800     SELECT RPT-FILE-TERR  ASSIGN TO RPT01.                       00380005
003900     SELECT RPT-FILE-REGN  ASSIGN TO RPT02.                       00390005
004000     SELECT RPT-FILE-DIST  ASSIGN TO RPT03.                       00400005
004100     SELECT RPT-FILE-STR   ASSIGN TO RPT04.                       00410005
004200                                                                  00420002
004300 DATA DIVISION.                                                   00430002
004400 FILE SECTION.                                                    00440002
004500                                                                  00450002
004600 FD  EXTR-FILE                                                    00460002
004700     LABEL RECORDS STANDARD                                       00470002
004800     RECORDING MODE IS F                                          00480002
004900     BLOCK CONTAINS 0 RECORDS.                                    00490002
005000                                                                  00500002
005100 01  EXTR-REC                       PIC X(150).                   00510002
005200                                                                  00520002
005300 FD  DATE-FILE                                                    00530004
005400     LABEL RECORDS STANDARD                                       00540004
005500     RECORDING MODE IS F                                          00550004
005600     BLOCK CONTAINS 0 RECORDS.                                    00560004
005700                                                                  00570004
005800 01  DATE-REC                       PIC X(80).                    00580004
005900                                                                  00590004
006000 FD  RPT-FILE-TERR                                                00600005
006100     LABEL RECORDS STANDARD                                       00610002
006200     RECORDING MODE IS F                                          00620002
006300     BLOCK CONTAINS 0 RECORDS.                                    00630002
006400                                                                  00640002
006500 01  PRT-REC-TERR                   PIC X(132).                   00650005
006600                                                                  00660002
006700 FD  RPT-FILE-REGN                                                00670005
006800     LABEL RECORDS STANDARD                                       00680005
006900     RECORDING MODE IS F                                          00690005
007000     BLOCK CONTAINS 0 RECORDS.                                    00700005
007100                                                                  00710005
007200 01  PRT-REC-REGN                   PIC X(132).                   00720005
007300                                                                  00730005
007400 FD  RPT-FILE-DIST                                                00740005
007500     LABEL RECORDS STANDARD                                       00750005
007600     RECORDING MODE IS F                                          00760005
007700     BLOCK CONTAINS 0 RECORDS.                                    00770005
007800                                                                  00780005
007900 01  PRT-REC-DIST                   PIC X(132).                   00790005
008000                                                                  00800005
008100 FD  RPT-FILE-STR                                                 00810005
008200     LABEL RECORDS STANDARD                                       00820005
008300     RECORDING MODE IS F                                          00830005
008400     BLOCK CONTAINS 0 RECORDS.                                    00840005
008500                                                                  00850005
008600 01  PRT-REC-STR                    PIC X(132).                   00860005
008700                                                                  00870005
008800******************************************************************00880005
008900*                       WORKING STORAGE                           00890002
009000******************************************************************00900002
009100 WORKING-STORAGE SECTION.                                         00910002
009200                                                                  00920002
009300 01  W-START                        PIC X(40)                     00930002
009400     VALUE 'TFKRP006 - WORKING STORAGE BEGINS HERE'.              00940002
009500                                                                  00950002
009600                                                                  00960002
009700******************************************************************00970004
009800*                        ERROR HANDLING                           00980004
009900******************************************************************00990004
010000 01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 01000004
010100     88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           01010004
010200     88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01020004
010300                                                                  01030004
010400******************************************************************01040004
010500*                        CONTROL CARD                             01050004
010600******************************************************************01060004
010700 01  CC-CONTROL-CARD.                                             01070004
010800     05  CC-CNTL-CARD.                                            01080004
010900         10  CC-RPT-TYPE            PIC  X(01)  VALUE SPACE.      01090023
011000             88  CC-RPT-TYPE-WEEKLY             VALUE 'W'.        01100023
011100             88  CC-RPT-TYPE-MONTHLY            VALUE 'M'.        01110023
011200         10  CC-DATE                PIC  X(10)  VALUE SPACES.     01120023
011300         10  FILLER                 PIC  X(69)  VALUE SPACES.     01130023
011400                                                                  01140004
011500******************************************************************01150004
011600* PARAMETER LIST FOR THE CALENDAR ROUTINE                         01160004
011700******************************************************************01170004
011800     COPY DPWS500.                                                01180004
011900                                                                  01190004
012000******************************************************************01200002
012100*                         SWITCHES                                01210002
012200******************************************************************01220002
012300 01  PS-PROGRAM-SWITCHES.                                         01230002
012400     05  PS-EOF-SW                  PIC X(01)   VALUE 'N'.        01240002
012500         88  PS-END-OF-FILE                     VALUE 'Y'.        01250004
012600     05  PS-DATE-EOF-SW             PIC X(01)   VALUE 'N'.        01260004
012700         88  PS-DATE-EOF                        VALUE 'Y'.        01270004
012800     05  PS-PRINT-TERR-HDR-SW       PIC X(01)   VALUE 'Y'.        01280036
012900         88  PS-PRINT-TERR-HDR                  VALUE 'Y'.        01290036
013000         88  PS-NO-TERR-HDR                     VALUE 'N'.        01300036
013100     05  PS-PRINT-REGN-HDR-SW       PIC X(01)   VALUE 'Y'.        01310036
013200         88  PS-PRINT-REGN-HDR                  VALUE 'Y'.        01320036
013300         88  PS-NO-REGN-HDR                     VALUE 'N'.        01330036
013400     05  PS-PRINT-DIST-HDR-SW       PIC X(01)   VALUE 'Y'.        01340036
013500         88  PS-PRINT-DIST-HDR                  VALUE 'Y'.        01350036
013600         88  PS-NO-DIST-HDR                     VALUE 'N'.        01360036
013700     05  PS-PRINT-STR-HDR-SW        PIC X(01)   VALUE 'Y'.        01370036
013800         88  PS-PRINT-STR-HDR                   VALUE 'Y'.        01380036
013900         88  PS-NO-STR-HDR                      VALUE 'N'.        01390036
014000                                                                  01400002
014100******************************************************************01410002
014200*                        ACCUMULATORS                             01420002
014300******************************************************************01430002
014400 01  PA-ACCUMS.                                                   01440002
014500     05  PA-PAGE-CNT1               PIC 9(05)   VALUE ZEROS.      01450005
014600     05  PA-PAGE-CNT2               PIC 9(05)   VALUE ZEROS.      01460005
014700     05  PA-PAGE-CNT3               PIC 9(05)   VALUE ZEROS.      01470005
014800     05  PA-PAGE-CNT4               PIC 9(05)   VALUE ZEROS.      01480005
014900     05  PA-LINE-CNT1               PIC 9(02)   VALUE ZEROS.      01490036
015000     05  PA-LINE-CNT2               PIC 9(02)   VALUE ZEROS.      01500036
015100     05  PA-LINE-CNT3               PIC 9(02)   VALUE ZEROS.      01510036
015200     05  PA-LINE-CNT4               PIC 9(02)   VALUE ZEROS.      01520036
015300                                                                  01530002
015400     05  PA-READ                    PIC 9(11)   VALUE ZEROS.      01540002
015500                                                                  01550002
015600     05  PA-WRITE                   PIC 9(11)   VALUE ZEROS.      01560005
015700                                                                  01570005
015800     05  PA-COUNT                   PIC 9(09)   VALUE ZEROS.      01580005
015900                                                                  01590002
016000******************************************************************01600002
016100*                          CONSTANTS                              01610002
016200******************************************************************01620002
016300 01  PC-CONSTANTS.                                                01630002
016400     05  PC-PROGRAM-NAME            PIC  X(08)  VALUE 'TFKRP006'. 01640002
016500     05  PC-MAX-LINES               PIC  9(02)  VALUE 56.         01650002
016600                                                                  01660002
016700******************************************************************01670002
016800*                        PROGRAM VARIABLES                        01680006
016900******************************************************************01690002
017000 01  PV-PARAGRAPH-NAME              PIC X(30)  VALUE SPACES.      01700006
017100 01  PV-OPERATION-MSG               PIC X(30)  VALUE SPACES.      01710006
017200 01  PV-LAST-PRINTED-TERR           PIC 9(04)  VALUE ZERO.        01720013
017300 01  PV-LAST-PRINTED-REGN           PIC 9(04)  VALUE ZERO.        01730013
017400 01  PV-LAST-PRINTED-DIST           PIC 9(04)  VALUE ZERO.        01740013
017500 01  PV-LAST-PRINTED-STORE          PIC 9(04)  VALUE ZERO.        01750013
017600                                                                  01760013
017700******************************************************************01770006
017800*                          WORK AREA                              01780006
017900******************************************************************01790006
018000 01  WS-WORK-AREA.                                                01800006
018100     05  WS-HOLD-TERR               PIC  9(04)  VALUE ZERO.       01810005
018200     05  WS-HOLD-REGN               PIC  9(04)  VALUE ZERO.       01820005
018300     05  WS-HOLD-DIST               PIC  9(04)  VALUE ZERO.       01830005
018400     05  WS-HOLD-STORE              PIC  9(04)  VALUE ZERO.       01840005
018500     05  WS-HOLD-UPC                PIC  9(15)  VALUE ZEROS.      01850002
018600     05  WS-HOLD-SKU                PIC  X(30)  VALUE SPACES.     01860002
018700     05  WS-HOLD-TRAN               PIC  X(16)  VALUE SPACES.     01870002
018800     05  WS-HOLD-CLBK               PIC  9(09)  VALUE ZEROS.      01880002
018900                                                                  01890002
019000                                                                  01900002
019100******************************************************************01910002
019200*               SYTEM TIME AND DATE VARIABLES                     01920002
019300******************************************************************01930002
019400 01  SYS-DATE-TIME.                                               01940002
019500     05  SYS-DATE                   PIC  X(08)  VALUE SPACES.     01950002
019600     05  SYS-TIME                   PIC  X(08)  VALUE SPACES.     01960002
019700                                                                  01970002
019800 01  ST-BEG-TIME.                                                 01980002
019900     05  ST-BEG-HR                  PIC  9(02)  VALUE ZEROS.      01990002
020000     05  FILLER                     PIC  X(01)  VALUE ':'.        02000002
020100     05  ST-BEG-MN                  PIC  9(02)  VALUE ZEROS.      02010002
020200                                                                  02020002
020300 01  ST-END-TIME.                                                 02030002
020400     05  ST-END-HR                  PIC  9(02)  VALUE ZEROS.      02040002
020500     05  FILLER                     PIC  X(01)  VALUE ':'.        02050002
020600     05  ST-END-MN                  PIC  9(02)  VALUE ZEROS.      02060002
020700                                                                  02070002
020800 01  SD-EDIT-DATE.                                                02080002
020900     05  SD-MONTH                   PIC  9(02)  VALUE ZEROS.      02090002
021000     05  FILLER                     PIC  X(01)  VALUE '-'.        02100002
021100     05  SD-DAY                     PIC  9(02)  VALUE ZEROS.      02110002
021200     05  FILLER                     PIC  X(01)  VALUE '-'.        02120002
021300     05  SD-YEAR.                                                 02130002
021400         10  SD-CC                  PIC  9(02)  VALUE ZEROS.      02140002
021500         10  SD-YY                  PIC  9(02)  VALUE ZEROS.      02150002
021600                                                                  02160002
021700******************************************************************02170002
021800*                       COPY BOOKS                                02180002
021900******************************************************************02190002
022000     COPY TFRD058.                                                02200002
022100                                                                  02210002
022200******************************************************************02220002
022300* KOHLS STANDARD HEADING ROUTINE                                  02230002
022400******************************************************************02240002
022500     COPY DPWS132O.                                               02250004
022600******************************************************************02260002
022700* REPORT HEADINGS                                                 02270002
022800******************************************************************02280002
022900 01 PV-HDR1.                                                      02290002
023000     05  FILLER                    PIC X(38)  VALUE SPACES.       02300002
023100     05  FILLER                    PIC X(34)  VALUE               02310023
023200         'CALLBACK ITEMS SUMMARY REPORT FOR '.                    02320023
023300     05  HD-RPT-TYPE               PIC X(5).                      02330023
023400         88  HD-RPT-TYPE-WEEKLY               VALUE 'WEEK '.      02340023
023500         88  HD-RPT-TYPE-MONTHLY              VALUE 'MONTH'.      02350023
023600     05  FILLER                    PIC X(08)  VALUE ' ENDING '.   02360023
023700     05  HD-DATE                   PIC X(10)  VALUE SPACES.       02370002
023800     05  FILLER                    PIC X(37)  VALUE SPACES.       02380021
023900                                                                  02390002
024000 01 PV-HDR1A.                                                     02400005
024100     05  FILLER                    PIC X(58)  VALUE SPACES.       02410005
024200     05  HDR1A-RPT-TYPE            PIC X(16).                     02420005
024300         88  HDR1A-TERRITORY-RPT         VALUE 'TERRITORY REPORT'.02430005
024400         88  HDR1A-REGION-RPT            VALUE ' REGION REPORT  '.02440005
024500         88  HDR1A-DISTRICT-RPT          VALUE 'DISTRICT REPORT '.02450005
024600         88  HDR1A-STORE-RPT             VALUE '  STORE REPORT  '.02460005
024700     05  FILLER                    PIC X(58)  VALUE SPACES.       02470005
024800                                                                  02480005
024900 01  PV-HDR1B.                                                    02490023
025000     05  FILLER                    PIC X(23) VALUE SPACES.        02500033
025100     05  FILLER                    PIC X(36) VALUE                02510033
025200         'H O T   L E G A L   N O T I C E  -- '.                  02520034
025300     05  FILLER                    PIC X(49) VALUE                02530033
025400         'I M M E D I A T E   A C T I O N   R E Q U I R E D'.     02540033
025500     05  FILLER                    PIC X(24) VALUE SPACES.        02550033
025600                                                                  02560023
025700 01  PV-HDR1C.                                                    02570023
025800     05  FILLER                    PIC X(40) VALUE SPACES.        02580033
025900     05  FILLER                    PIC X(52) VALUE                02590033
026000         'ATTORNEY-CLIENT PRIVILEGED AND ATTORNEY WORK PRODUCT'.  02600033
026100     05  FILLER                    PIC X(40) VALUE SPACES.        02610033
026200                                                                  02620023
026300 01  PV-HDR1D.                                                    02630033
026400     05  FILLER                    PIC X(54) VALUE SPACES.        02640033
026500     05  FILLER                    PIC X(23) VALUE                02650033
026600         'C O N F I D E N T I A L'.                               02660033
026700     05  FILLER                    PIC X(55) VALUE SPACES.        02670033
026800                                                                  02680033
026900 01 PV-HDR2.                                                      02690002
027000     05  FILLER                    PIC X(04)  VALUE 'TERR'.       02700004
027100     05  FILLER                    PIC X(02)  VALUE SPACES.       02710004
027200     05  FILLER                    PIC X(04)  VALUE 'REGN'.       02720004
027300     05  FILLER                    PIC X(02)  VALUE SPACES.       02730004
027400     05  FILLER                    PIC X(04)  VALUE 'DIST'.       02740004
027500     05  FILLER                    PIC X(02)  VALUE SPACES.       02750004
027600     05  FILLER                    PIC X(05)  VALUE 'STORE'.      02760004
027700     05  FILLER                    PIC X(06)  VALUE SPACES.       02770020
027800     05  FILLER                    PIC X(07)  VALUE 'UPC NBR'.    02780002
027900     05  FILLER                    PIC X(08)  VALUE SPACES.       02790020
028000     05  FILLER                    PIC X(11)  VALUE               02800002
028100         'DESCRIPTION'.                                           02810002
028200     05  FILLER                    PIC X(21)  VALUE SPACES.       02820020
028300     05  FILLER                    PIC X(09)  VALUE               02830002
028400         'TRAN TYPE'.                                             02840002
028500     05  FILLER                    PIC X(14)  VALUE SPACES.       02850020
028600     05  FILLER                    PIC X(05)  VALUE 'COUNT'.      02860002
028700     05  FILLER                    PIC X(07)  VALUE SPACES.       02870020
028800     05  FILLER                    PIC X(08)  VALUE               02880002
028900         'CLBK NBR'.                                              02890002
029000     05  FILLER                    PIC X(13)  VALUE SPACES.       02900021
029100                                                                  02910002
029200 01 PV-HDR3.                                                      02920002
029300     05  FILLER                    PIC X(04)  VALUE ALL '='.      02930004
029400     05  FILLER                    PIC X(02)  VALUE SPACES.       02940004
029500     05  FILLER                    PIC X(04)  VALUE ALL '='.      02950004
029600     05  FILLER                    PIC X(02)  VALUE SPACES.       02960004
029700     05  FILLER                    PIC X(04)  VALUE ALL '='.      02970004
029800     05  FILLER                    PIC X(02)  VALUE SPACES.       02980004
029900     05  FILLER                    PIC X(05)  VALUE ALL '='.      02990004
030000     05  FILLER                    PIC X(06)  VALUE SPACES.       03000020
030100     05  FILLER                    PIC X(07)  VALUE ALL '='.      03010002
030200     05  FILLER                    PIC X(08)  VALUE SPACES.       03020020
030300     05  FILLER                    PIC X(11)  VALUE ALL '='.      03030002
030400     05  FILLER                    PIC X(21)  VALUE SPACES.       03040020
030500     05  FILLER                    PIC X(09)  VALUE ALL '='.      03050002
030600     05  FILLER                    PIC X(14)  VALUE SPACES.       03060020
030700     05  FILLER                    PIC X(05)  VALUE ALL '='.      03070002
030800     05  FILLER                    PIC X(07)  VALUE SPACES.       03080020
030900     05  FILLER                    PIC X(08)  VALUE ALL '='.      03090002
031000     05  FILLER                    PIC X(13)  VALUE SPACES.       03100021
031100                                                                  03110002
031200******************************************************************03120002
031300* DETAIL LINES                                                    03130002
031400******************************************************************03140002
031500 01  PV-DTL1.                                                     03150002
031600     05  DT-TERR-NBR               PIC ZZ99.                      03160024
031700     05  DT-TERR-NBR-X REDEFINES DT-TERR-NBR PIC X(04).           03170024
031800     05  FILLER                    PIC X(02)   VALUE SPACES.      03180004
031900     05  DT-REGN-NBR               PIC ZZ99.                      03190024
032000     05  DT-REGN-NBR-X REDEFINES DT-REGN-NBR PIC X(04).           03200024
032100     05  FILLER                    PIC X(02)   VALUE SPACES.      03210004
032200     05  DT-DIST-NBR               PIC Z999.                      03220024
032300     05  DT-DIST-NBR-X REDEFINES DT-DIST-NBR PIC X(04).           03230024
032400     05  FILLER                    PIC X(03)   VALUE SPACES.      03240004
032500     05  DT-STR-NBR                PIC 9999.                      03250024
032600     05  DT-STR-NBR-X REDEFINES DT-STR-NBR   PIC X(04).           03260024
032700     05  FILLER                    PIC X(02)   VALUE SPACES.      03270004
032800     05  DT-UPC-NBR                PIC ZZZZZZZZZZZZZZZ.           03280002
032900     05  FILLER                    PIC X(02)   VALUE SPACES.      03290002
033000     05  DT-SKU-DESC               PIC X(30)   VALUE SPACES.      03300002
033100     05  FILLER                    PIC X(02)   VALUE SPACES.      03310002
033200     05  DT-TRAN-TYPE              PIC X(16)   VALUE SPACES.      03320002
033300     05  FILLER                    PIC X(03)   VALUE SPACES.      03330022
033400     05  DT-COUNT                  PIC ZZZ,ZZZ,ZZ9.               03340013
033500     05  FILLER                    PIC X(06)   VALUE SPACES.      03350022
033600     05  DT-CLBK-ID                PIC ZZZZZZZZZ.                 03360002
033700     05  DT-CLBK-ID-X REDEFINES DT-CLBK-ID                        03370040
033800                                   PIC X(09).                     03380041
033900     05  FILLER                    PIC X(18)   VALUE SPACES.      03390021
034000                                                                  03400002
034100 01  PV-BLANK-LINE                 PIC X(132)  VALUE SPACES.      03410033
034200                                                                  03420033
034300 01  PV-TRAILER1.                                                 03430033
034400     05  FILLER                    PIC X(01)   VALUE SPACES.      03440033
034500     05  FILLER                    PIC X(44)   VALUE              03450039
034600            'REFER TO 4-DIGIT CALLBACK NUMBER TO PROCESS '.       03460039
034700     05  FILLER                    PIC X(08)   VALUE 'TRANSFER'.  03470034
034800     05  FILLER                    PIC X(79)   VALUE SPACES.      03480039
034900                                                                  03490033
035000 01  PV-TRAILER2.                                                 03500033
035100     05  FILLER                    PIC X(01)   VALUE SPACES.      03510033
035200     05  FILLER                    PIC X(57)   VALUE              03520038
035300      'CALLBACK CODE DSTRY INDICATES THAT MERCHANDISE SHOULD BE '.03530040
035400     05  FILLER                    PIC X(49)   VALUE              03540033
035500              'DESTROYED AT STORE LEVEL PER CORPORATE DIRECTION.'.03550034
035600     05  FILLER                    PIC X(25)   VALUE SPACES.      03560038
035700                                                                  03570033
035800 01  PV-TRAILER3.                                                 03580033
035900     05  FILLER                    PIC X(01)   VALUE SPACES.      03590033
036000     05  FILLER                    PIC X(54)   VALUE              03600040
036100        'CALLBACK CODE HOLD IS A TEMPORARY CALLBACK NUMBER AND '. 03610040
036200     05  FILLER                    PIC X(44)   VALUE              03620033
036300                   'WILL BE UPDATED ONCE RTV CALLBACK IS ISSUED.'.03630034
036400     05  FILLER                    PIC X(33)   VALUE SPACES.      03640040
036500                                                                  03650033
036600******************************************************************03660033
036700 PROCEDURE DIVISION.                                              03670033
036800******************************************************************03680002
036900* MAIN DRIVER                                                     03690002
037000******************************************************************03700002
037100 0000-MAIN-DRIVER.                                                03710002
037200                                                                  03720002
037300     PERFORM A1000-INITIALIZE.                                    03730002
037400                                                                  03740002
037500     PERFORM B1000-PROCESS                                        03750002
037600       UNTIL PS-END-OF-FILE.                                      03760004
037700                                                                  03770002
037800     PERFORM B2000-SETUP.                                         03780002
037900                                                                  03790002
038000     PERFORM Z9000-END-PROC.                                      03800002
038100                                                                  03810002
038200     GOBACK.                                                      03820002
038300                                                                  03830002
038400******************************************************************03840002
038500* PREFORMS TASK INITIATION PROCESSING                             03850002
038600******************************************************************03860002
038700 A1000-INITIALIZE.                                                03870002
038800                                                                  03880002
038900     OPEN INPUT  EXTR-FILE                                        03890002
039000                 DATE-FILE                                        03900004
039100          OUTPUT RPT-FILE-TERR                                    03910005
039200                 RPT-FILE-REGN                                    03920005
039300                 RPT-FILE-DIST                                    03930005
039400                 RPT-FILE-STR.                                    03940005
039500                                                                  03950002
039600     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 03960002
039700                                                                  03970002
039800     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            03980002
039900     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            03990002
040000                                                                  04000002
040100     MOVE SYS-DATE (1:2) TO SD-CC.                                04010002
040200     MOVE SYS-DATE (3:2) TO SD-YY.                                04020002
040300     MOVE SYS-DATE (5:2) TO SD-MONTH.                             04030002
040400     MOVE SYS-DATE (7:2) TO SD-DAY.                               04040002
040500                                                                  04050002
040600     PERFORM A1500-READ-CONTROL-CARD.                             04060004
040700     CLOSE DATE-FILE.                                             04070004
040800     IF PS-DATE-EOF                                               04080004
040900         MOVE 'A1000-INITIALIZE'  TO PV-PARAGRAPH-NAME            04090004
041000         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG    04100004
041100         SET ABEND-4003-CTRL-CARD-ERROR TO TRUE                   04110004
041200         PERFORM Z2000-ABEND                                      04120004
041300     END-IF.                                                      04130004
041400                                                                  04140004
041500     IF CC-RPT-TYPE = 'W'                                         04150023
041600         SET HD-RPT-TYPE-WEEKLY      TO TRUE                      04160023
041700     ELSE                                                         04170023
041800         IF CC-RPT-TYPE = 'M'                                     04180023
041900             SET HD-RPT-TYPE-MONTHLY TO TRUE                      04190023
042000         ELSE                                                     04200023
042100             MOVE 'A1000-INITIALIZE'  TO PV-PARAGRAPH-NAME        04210023
042200             MOVE 'CONTROL CARD RPT TYPE INVALID'                 04220023
042300                                      TO PV-OPERATION-MSG         04230023
042400             SET ABEND-4003-CTRL-CARD-ERROR TO TRUE               04240023
042500             PERFORM Z2000-ABEND                                  04250023
042600         END-IF                                                   04260023
042700     END-IF.                                                      04270023
042800                                                                  04280023
042900     PERFORM A1600-PROCESS-DATE.                                  04290004
043000                                                                  04300004
043100     PERFORM R1000-READ.                                          04310002
043200                                                                  04320002
043300     IF PS-END-OF-FILE                                            04330004
043400         CONTINUE                                                 04340004
043500     ELSE                                                         04350004
043600         MOVE TF058-TERR-NBR    TO WS-HOLD-TERR                   04360007
043700         MOVE TF058-REGN-NBR    TO WS-HOLD-REGN                   04370007
043800         MOVE TF058-DIST-NBR    TO WS-HOLD-DIST                   04380007
043900         MOVE TF058-STR-NBR     TO WS-HOLD-STORE                  04390007
044000         MOVE TF058-UPC-NBR     TO WS-HOLD-UPC                    04400004
044100         MOVE TF058-SKU-DESC    TO WS-HOLD-SKU                    04410004
044200         MOVE TF058-TRAN-TYPE   TO WS-HOLD-TRAN                   04420025
044300         MOVE TF058-CLBK-ID     TO WS-HOLD-CLBK                   04430004
044400     END-IF.                                                      04440004
044500                                                                  04450002
044600     PERFORM A2000-HDR-SETUP.                                     04460002
044700                                                                  04470002
044800***************************************************************** 04480004
044900*      READ CONTROL CARD                                          04490004
045000***************************************************************** 04500004
045100                                                                  04510004
045200 A1500-READ-CONTROL-CARD.                                         04520004
045300     READ DATE-FILE INTO CC-CNTL-CARD                             04530004
045400         AT END                                                   04540004
045500            SET PS-DATE-EOF TO TRUE                               04550004
045600     END-READ.                                                    04560004
045700                                                                  04570004
045800******************************************************************04580004
045900* GET THE BEGINNING AND ENDING DATES FOR THE REPORTING WEEK       04590004
046000******************************************************************04600004
046100 A1600-PROCESS-DATE.                                              04610004
046200                                                                  04620004
046300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04630004
046400                                                                  04640004
046500     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            04650023
046600                                                                  04660023
046700     IF CC-RPT-TYPE = 'W'                                         04670023
046800         SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE                   04680023
046900     ELSE                                                         04690023
047000         SET DPG51-FISCAL-454-CALENDAR TO TRUE                    04700023
047100     END-IF.                                                      04710023
047200                                                                  04720004
047300     MOVE CC-DATE TO DPG52-LK-DATE-INPUT.                         04730004
047400                                                                  04740004
047500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                04750004
047600                                             DPG52                04760004
047700                                             DPG53                04770004
047800                                             DPG54                04780004
047900                                             DPG55                04790004
048000                                             DPG56.               04800004
048100                                                                  04810004
048200     EVALUATE TRUE                                                04820004
048300        WHEN DPG54-NO-ERROR                                       04830004
048400            IF CC-RPT-TYPE-WEEKLY                                 04840023
048500                MOVE DPG55-LAST-WKDY-GREG-FMT   TO HD-DATE        04850023
048600            ELSE                                                  04860023
048700                MOVE DPG56-LAST-FP-GREG-FMT     TO HD-DATE        04870023
048800            END-IF                                                04880023
048900        WHEN DPG54-WARNING-ERROR                                  04890004
049000        WHEN DPG54-SEVERE-ERROR                                   04900004
049100            DISPLAY '          '                                  04910004
049200            DISPLAY 'CC-DATE = ' CC-DATE                          04920004
049300                                                                  04930004
049400            MOVE 'A1600-PROCESS-DATE' TO PV-PARAGRAPH-NAME        04940004
049500            SET ABEND-4019-CAL-SUB-ERROR TO TRUE                  04950004
049600                                                                  04960004
049700            PERFORM Z2000-ABEND                                   04970004
049800                                                                  04980004
049900     END-EVALUATE.                                                04990004
050000                                                                  05000004
050100******************************************************************05010002
050200* SETUP THE HEADER INFO                                           05020002
050300******************************************************************05030002
050400 A2000-HDR-SETUP.                                                 05040002
050500                                                                  05050002
050600     MOVE 'TFKRP006' TO DP132O-PROGRAM-NAME.                      05060002
050700                                                                  05070002
050800     MOVE SD-YY      TO DP132O-RUN-YEAR.                          05080002
050900     MOVE SD-MONTH   TO DP132O-RUN-MONTH.                         05090002
051000     MOVE SD-DAY     TO DP132O-RUN-DAY.                           05100002
051100                                                                  05110002
051200     MOVE ST-BEG-HR  TO DP132O-RUN-HOUR.                          05120002
051300     MOVE ST-BEG-MN  TO DP132O-RUN-MINUTE.                        05130002
051400                                                                  05140002
051500******************************************************************05150002
051600* MAIN PROCESS                                                    05160002
051700******************************************************************05170002
051800 B1000-PROCESS.                                                   05180002
051900                                                                  05190002
052000     IF  TF058-TERR-NBR    = WS-HOLD-TERR                         05200005
052100     AND TF058-REGN-NBR    = WS-HOLD-REGN                         05210005
052200     AND TF058-DIST-NBR    = WS-HOLD-DIST                         05220005
052300     AND TF058-STR-NBR     = WS-HOLD-STORE                        05230005
052400     AND TF058-UPC-NBR     = WS-HOLD-UPC                          05240005
052500     AND TF058-SKU-DESC    = WS-HOLD-SKU                          05250004
052600     AND TF058-TRAN-TYPE   = WS-HOLD-TRAN                         05260005
052700     AND TF058-CLBK-ID     = WS-HOLD-CLBK                         05270004
052800         ADD TF058-QTY TO PA-COUNT                                05280004
052900     ELSE                                                         05290002
053000         PERFORM B2000-SETUP                                      05300002
053100     END-IF.                                                      05310002
053200                                                                  05320002
053300     PERFORM R1000-READ.                                          05330002
053400                                                                  05340002
053500                                                                  05350002
053600******************************************************************05360002
053700* SETUP/PRINT RECORD                                              05370002
053800******************************************************************05380002
053900 B2000-SETUP.                                                     05390002
054000                                                                  05400002
054100     PERFORM P2100-SETUP-BREAKS.                                  05410032
054200                                                                  05420013
054300     MOVE WS-HOLD-UPC   TO DT-UPC-NBR.                            05430005
054400     MOVE WS-HOLD-SKU   TO DT-SKU-DESC.                           05440005
054500     MOVE WS-HOLD-TRAN  TO DT-TRAN-TYPE.                          05450005
054600     MOVE PA-COUNT      TO DT-COUNT.                              05460005
054700                                                                  05470043
054800     EVALUATE WS-HOLD-CLBK                                        05480040
054900         WHEN 11111                                               05490040
055000              MOVE '     HOLD'   TO DT-CLBK-ID-X                  05500042
055100         WHEN 99999                                               05510040
055200              MOVE '    DSTRY'   TO DT-CLBK-ID-X                  05520042
055300         WHEN OTHER                                               05530040
055400              MOVE WS-HOLD-CLBK  TO DT-CLBK-ID                    05540040
055500     END-EVALUATE.                                                05550040
055600                                                                  05560002
055700     PERFORM P2000-PRINT.                                         05570002
055800                                                                  05580002
055900     MOVE TF058-QTY TO PA-COUNT.                                  05590004
056000                                                                  05600002
056100     MOVE TF058-TERR-NBR    TO WS-HOLD-TERR.                      05610005
056200     MOVE TF058-REGN-NBR    TO WS-HOLD-REGN.                      05620005
056300     MOVE TF058-DIST-NBR    TO WS-HOLD-DIST.                      05630005
056400     MOVE TF058-STR-NBR     TO WS-HOLD-STORE.                     05640005
056500     MOVE TF058-UPC-NBR     TO WS-HOLD-UPC.                       05650004
056600     MOVE TF058-SKU-DESC    TO WS-HOLD-SKU.                       05660004
056700     MOVE TF058-TRAN-TYPE   TO WS-HOLD-TRAN.                      05670008
056800     MOVE TF058-CLBK-ID     TO WS-HOLD-CLBK.                      05680004
056900                                                                  05690002
057000******************************************************************05700005
057100* PRINT THE REPORT DETAIL LINES                                   05710002
057200******************************************************************05720002
057300 P2000-PRINT.                                                     05730002
057400                                                                  05740002
057500     IF  PA-LINE-CNT1 > PC-MAX-LINES                              05750008
057600       OR PS-PRINT-TERR-HDR                                       05760036
057700         PERFORM P3000-TERR-HDRS                                  05770016
057800     END-IF.                                                      05780016
057900     WRITE PRT-REC-TERR FROM PV-DTL1 AFTER 1.                     05790016
058000                                                                  05800016
058100     IF  PA-LINE-CNT2 > PC-MAX-LINES                              05810016
058200       OR PS-PRINT-REGN-HDR                                       05820036
058300         PERFORM P3100-REGN-HDRS                                  05830016
058400     END-IF.                                                      05840016
058500     WRITE PRT-REC-REGN FROM PV-DTL1 AFTER 1.                     05850016
058600                                                                  05860016
058700     IF  PA-LINE-CNT3 > PC-MAX-LINES                              05870016
058800       OR PS-PRINT-DIST-HDR                                       05880036
058900         PERFORM P3200-DIST-HDRS                                  05890016
059000     END-IF.                                                      05900016
059100     WRITE PRT-REC-DIST FROM PV-DTL1 AFTER 1.                     05910016
059200                                                                  05920016
059300     IF  PA-LINE-CNT4 > PC-MAX-LINES                              05930016
059400       OR PS-PRINT-STR-HDR                                        05940036
059500         PERFORM P3300-STORE-HDRS                                 05950016
059600     END-IF.                                                      05960002
059700     WRITE PRT-REC-STR FROM PV-DTL1 AFTER 1.                      05970006
059800                                                                  05980002
059900     IF  TF058-TERR-NBR = WS-HOLD-TERR                            05990011
060000         ADD 1 TO PA-LINE-CNT1                                    06000011
060100     ELSE                                                         06010011
060200         SET PS-PRINT-TERR-HDR                                    06020036
060300             PS-PRINT-REGN-HDR                                    06030036
060400             PS-PRINT-DIST-HDR                                    06040036
060500             PS-PRINT-STR-HDR TO TRUE                             06050036
060600     END-IF.                                                      06060011
060700                                                                  06070011
060800     IF  TF058-REGN-NBR = WS-HOLD-REGN                            06080011
060900         ADD 1 TO PA-LINE-CNT2                                    06090011
061000     ELSE                                                         06100011
061100         SET PS-PRINT-REGN-HDR                                    06110036
061200             PS-PRINT-DIST-HDR                                    06120036
061300             PS-PRINT-STR-HDR TO TRUE                             06130036
061400     END-IF.                                                      06140011
061500                                                                  06150011
061600     IF  TF058-DIST-NBR = WS-HOLD-DIST                            06160011
061700         ADD 1 TO PA-LINE-CNT3                                    06170011
061800     ELSE                                                         06180011
061900         SET PS-PRINT-DIST-HDR                                    06190036
062000             PS-PRINT-STR-HDR TO TRUE                             06200036
062100     END-IF.                                                      06210011
062200                                                                  06220011
062300     IF  TF058-STR-NBR = WS-HOLD-STORE                            06230011
062400         ADD 1 TO PA-LINE-CNT4                                    06240011
062500     ELSE                                                         06250011
062600         SET PS-PRINT-STR-HDR TO TRUE                             06260036
062700     END-IF.                                                      06270011
062800                                                                  06280011
062900     ADD 1 TO PA-WRITE.                                           06290005
063000                                                                  06300011
063100******************************************************************06310025
063200* SET UP THE BREAKS FOR TERR, REGN, DIST, AND STORE.              06320025
063300******************************************************************06330025
063400 P2100-SETUP-BREAKS.                                              06340027
063500                                                                  06350025
063600     IF PV-LAST-PRINTED-TERR = WS-HOLD-TERR                       06360025
063700         MOVE SPACES        TO DT-TERR-NBR-X                      06370025
063800     ELSE                                                         06380025
063900         MOVE WS-HOLD-TERR  TO DT-TERR-NBR                        06390025
064000                               PV-LAST-PRINTED-TERR               06400025
064100     END-IF.                                                      06410025
064200                                                                  06420025
064300     IF PV-LAST-PRINTED-REGN = WS-HOLD-REGN                       06430025
064400         MOVE SPACES        TO DT-REGN-NBR-X                      06440025
064500     ELSE                                                         06450025
064600         MOVE WS-HOLD-REGN  TO DT-REGN-NBR                        06460025
064700                               PV-LAST-PRINTED-REGN               06470025
064800     END-IF.                                                      06480025
064900                                                                  06490025
065000     IF PV-LAST-PRINTED-DIST = WS-HOLD-DIST                       06500025
065100         MOVE SPACES        TO DT-DIST-NBR-X                      06510025
065200     ELSE                                                         06520025
065300         MOVE WS-HOLD-DIST  TO DT-DIST-NBR                        06530025
065400                               PV-LAST-PRINTED-DIST               06540025
065500     END-IF.                                                      06550025
065600                                                                  06560025
065700     IF PV-LAST-PRINTED-STORE = WS-HOLD-STORE                     06570025
065800         MOVE SPACES        TO DT-STR-NBR-X                       06580025
065900     ELSE                                                         06590025
066000         MOVE WS-HOLD-STORE TO DT-STR-NBR                         06600025
066100                               PV-LAST-PRINTED-STORE              06610025
066200     END-IF.                                                      06620025
066300                                                                  06630025
066400******************************************************************06640007
066500* PRINT THE TERRITORY REPORT HEADINGS                             06650016
066600******************************************************************06660007
066700 P3000-TERR-HDRS.                                                 06670016
066800                                                                  06680007
066900*  WRITE TRAILER LINES ON BOTTOM OF PAGE BEFORE STARTING NEW PAGE 06690033
067000     IF PA-WRITE > 0                                              06700035
067100         PERFORM UNTIL PA-LINE-CNT1 = 60                          06710033
067200             WRITE PRT-REC-TERR FROM PV-BLANK-LINE AFTER 1        06720033
067300             ADD +1 TO PA-LINE-CNT1                               06730033
067400         END-PERFORM                                              06740033
067500         WRITE PRT-REC-TERR FROM PV-TRAILER1 AFTER 1              06750033
067600         WRITE PRT-REC-TERR FROM PV-TRAILER2 AFTER 1              06760033
067700         WRITE PRT-REC-TERR FROM PV-TRAILER3 AFTER 1              06770033
067800     END-IF.                                                      06780033
067900                                                                  06790033
068000*  TERRITORY REPORT                                               06800015
068100     ADD 1 TO PA-PAGE-CNT1                                        06810036
068200     MOVE 1            TO DP132O-REPORT-NUMBER                    06820036
068300     MOVE PA-PAGE-CNT1 TO DP132O-PAGE-NUMBER                      06830036
068400                                                                  06840007
068500     WRITE PRT-REC-TERR                                           06850036
068600       FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE             06860036
068700                                                                  06870007
068800     WRITE PRT-REC-TERR FROM PV-HDR1 AFTER 1                      06880036
068900     SET HDR1A-TERRITORY-RPT TO TRUE                              06890036
069000     WRITE PRT-REC-TERR FROM PV-HDR1A AFTER 1                     06900036
069100     WRITE PRT-REC-TERR FROM PV-HDR1B AFTER 2                     06910036
069200     WRITE PRT-REC-TERR FROM PV-HDR1C AFTER 1                     06920036
069300     WRITE PRT-REC-TERR FROM PV-HDR1D AFTER 1                     06930036
069400     WRITE PRT-REC-TERR FROM PV-HDR2 AFTER 2                      06940036
069500     WRITE PRT-REC-TERR FROM PV-HDR3 AFTER 1                      06950036
069600                                                                  06960007
069700     MOVE 10 TO PA-LINE-CNT1                                      06970036
069800     SET PS-NO-TERR-HDR TO TRUE                                   06980036
069900     MOVE WS-HOLD-TERR  TO DT-TERR-NBR                            06990036
070000     MOVE WS-HOLD-REGN  TO DT-REGN-NBR                            07000036
070100     MOVE WS-HOLD-DIST  TO DT-DIST-NBR                            07010036
070200     MOVE WS-HOLD-STORE TO DT-STR-NBR.                            07020036
070300                                                                  07030007
070400******************************************************************07040016
070500* PRINT THE REGION REPORT HEADINGS                                07050016
070600******************************************************************07060016
070700 P3100-REGN-HDRS.                                                 07070016
070800                                                                  07080016
070900*  WRITE TRAILER LINES ON BOTTOM OF PAGE BEFORE STARTING NEW PAGE 07090033
071000     IF PA-WRITE > 0                                              07100035
071100         PERFORM UNTIL PA-LINE-CNT2 = 60                          07110033
071200             WRITE PRT-REC-REGN FROM PV-BLANK-LINE AFTER 1        07120033
071300             ADD +1 TO PA-LINE-CNT2                               07130033
071400         END-PERFORM                                              07140033
071500         WRITE PRT-REC-REGN FROM PV-TRAILER1 AFTER 1              07150033
071600         WRITE PRT-REC-REGN FROM PV-TRAILER2 AFTER 1              07160033
071700         WRITE PRT-REC-REGN FROM PV-TRAILER3 AFTER 1              07170033
071800     END-IF.                                                      07180033
071900                                                                  07190033
072000*  REGION REPORT                                                  07200016
072100     ADD 1 TO PA-PAGE-CNT2                                        07210036
072200     MOVE 2            TO DP132O-REPORT-NUMBER                    07220036
072300     MOVE PA-PAGE-CNT2 TO DP132O-PAGE-NUMBER                      07230036
072400                                                                  07240016
072500     WRITE PRT-REC-REGN                                           07250036
072600       FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE             07260036
072700                                                                  07270016
072800     WRITE PRT-REC-REGN FROM PV-HDR1 AFTER 1                      07280036
072900     SET HDR1A-REGION-RPT TO TRUE                                 07290036
073000     WRITE PRT-REC-REGN FROM PV-HDR1A AFTER 1                     07300036
073100     WRITE PRT-REC-REGN FROM PV-HDR1B AFTER 2                     07310036
073200     WRITE PRT-REC-REGN FROM PV-HDR1C AFTER 1                     07320036
073300     WRITE PRT-REC-REGN FROM PV-HDR1D AFTER 1                     07330036
073400     WRITE PRT-REC-REGN FROM PV-HDR2 AFTER 2                      07340036
073500     WRITE PRT-REC-REGN FROM PV-HDR3 AFTER 1                      07350036
073600                                                                  07360016
073700     MOVE 10 TO PA-LINE-CNT2                                      07370036
073800     SET PS-NO-REGN-HDR TO TRUE.                                  07380036
073900     MOVE WS-HOLD-TERR  TO DT-TERR-NBR                            07390036
074000     MOVE WS-HOLD-REGN  TO DT-REGN-NBR                            07400036
074100     MOVE WS-HOLD-DIST  TO DT-DIST-NBR                            07410036
074200     MOVE WS-HOLD-STORE TO DT-STR-NBR.                            07420036
074300                                                                  07430016
074400******************************************************************07440016
074500* PRINT THE DISTRICT REPORT HEADINGS                              07450016
074600******************************************************************07460016
074700 P3200-DIST-HDRS.                                                 07470016
074800                                                                  07480016
074900*  WRITE TRAILER LINES ON BOTTOM OF PAGE BEFORE STARTING NEW PAGE 07490033
075000     IF PA-WRITE > 0                                              07500035
075100         PERFORM UNTIL PA-LINE-CNT3 = 60                          07510033
075200             WRITE PRT-REC-DIST FROM PV-BLANK-LINE AFTER 1        07520033
075300             ADD +1 TO PA-LINE-CNT3                               07530033
075400         END-PERFORM                                              07540033
075500         WRITE PRT-REC-DIST FROM PV-TRAILER1 AFTER 1              07550033
075600         WRITE PRT-REC-DIST FROM PV-TRAILER2 AFTER 1              07560033
075700         WRITE PRT-REC-DIST FROM PV-TRAILER3 AFTER 1              07570033
075800     END-IF.                                                      07580033
075900                                                                  07590033
076000*  DISTRICT REPORT                                                07600016
076100     ADD 1 TO PA-PAGE-CNT3                                        07610036
076200     MOVE 3            TO DP132O-REPORT-NUMBER                    07620036
076300     MOVE PA-PAGE-CNT3 TO DP132O-PAGE-NUMBER                      07630036
076400                                                                  07640016
076500     WRITE PRT-REC-DIST                                           07650036
076600       FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE             07660036
076700                                                                  07670016
076800     WRITE PRT-REC-DIST FROM PV-HDR1 AFTER 1                      07680036
076900     SET HDR1A-DISTRICT-RPT TO TRUE                               07690036
077000     WRITE PRT-REC-DIST FROM PV-HDR1A AFTER 1                     07700036
077100     WRITE PRT-REC-DIST FROM PV-HDR1B AFTER 2                     07710036
077200     WRITE PRT-REC-DIST FROM PV-HDR1C AFTER 1                     07720036
077300     WRITE PRT-REC-DIST FROM PV-HDR1D AFTER 1                     07730036
077400     WRITE PRT-REC-DIST FROM PV-HDR2 AFTER 2                      07740036
077500     WRITE PRT-REC-DIST FROM PV-HDR3 AFTER 1                      07750036
077600                                                                  07760016
077700     MOVE 10 TO PA-LINE-CNT3                                      07770036
077800     SET PS-NO-DIST-HDR TO TRUE.                                  07780036
077900     MOVE WS-HOLD-TERR  TO DT-TERR-NBR                            07790036
078000     MOVE WS-HOLD-REGN  TO DT-REGN-NBR                            07800036
078100     MOVE WS-HOLD-DIST  TO DT-DIST-NBR                            07810036
078200     MOVE WS-HOLD-STORE TO DT-STR-NBR.                            07820036
078300                                                                  07830016
078400******************************************************************07840016
078500* PRINT THE STORE REPORT HEADINGS                                 07850016
078600******************************************************************07860016
078700 P3300-STORE-HDRS.                                                07870016
078800                                                                  07880016
078900*  WRITE TRAILER LINES ON BOTTOM OF PAGE BEFORE STARTING NEW PAGE 07890033
079000     IF PA-WRITE > 0                                              07900035
079100         PERFORM UNTIL PA-LINE-CNT4 = 60                          07910033
079200             WRITE PRT-REC-STR FROM PV-BLANK-LINE AFTER 1         07920033
079300             ADD +1 TO PA-LINE-CNT4                               07930033
079400         END-PERFORM                                              07940033
079500         WRITE PRT-REC-STR FROM PV-TRAILER1 AFTER 1               07950033
079600         WRITE PRT-REC-STR FROM PV-TRAILER2 AFTER 1               07960033
079700         WRITE PRT-REC-STR FROM PV-TRAILER3 AFTER 1               07970033
079800     END-IF.                                                      07980033
079900                                                                  07990033
080000*  STORE REPORT                                                   08000016
080100     ADD 1 TO PA-PAGE-CNT4                                        08010036
080200     MOVE 4            TO DP132O-REPORT-NUMBER                    08020036
080300     MOVE PA-PAGE-CNT4 TO DP132O-PAGE-NUMBER                      08030036
080400                                                                  08040016
080500     WRITE PRT-REC-STR                                            08050036
080600       FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE             08060036
080700                                                                  08070016
080800     WRITE PRT-REC-STR FROM PV-HDR1 AFTER 1                       08080036
080900     SET HDR1A-STORE-RPT TO TRUE                                  08090036
081000     WRITE PRT-REC-STR FROM PV-HDR1A AFTER 1                      08100036
081100     WRITE PRT-REC-STR FROM PV-HDR1B AFTER 2                      08110036
081200     WRITE PRT-REC-STR FROM PV-HDR1C AFTER 1                      08120036
081300     WRITE PRT-REC-STR FROM PV-HDR1D AFTER 1                      08130036
081400     WRITE PRT-REC-STR FROM PV-HDR2 AFTER 2                       08140036
081500     WRITE PRT-REC-STR FROM PV-HDR3 AFTER 1                       08150036
081600                                                                  08160016
081700     MOVE 10 TO PA-LINE-CNT4                                      08170036
081800     SET PS-NO-STR-HDR TO TRUE                                    08180036
081900     MOVE WS-HOLD-TERR  TO DT-TERR-NBR                            08190036
082000     MOVE WS-HOLD-REGN  TO DT-REGN-NBR                            08200036
082100     MOVE WS-HOLD-DIST  TO DT-DIST-NBR                            08210036
082200     MOVE WS-HOLD-STORE TO DT-STR-NBR.                            08220036
082300                                                                  08230016
082400******************************************************************08240016
082500* READ THE INPUT FILE                                             08250016
082600*   - IF BEG-DATE IS SPACES, WE ARE JUST PASSING THE END DATE     08260016
082700*     FOR THE REPORT HEADER                                       08270004
082800******************************************************************08280002
082900 R1000-READ.                                                      08290002
083000                                                                  08300002
083100     READ EXTR-FILE INTO TF058-EXTRACT-REC                        08310004
083200        AT END MOVE 'Y' TO PS-EOF-SW                              08320004
083300        NOT AT END ADD 1 TO PA-READ.                              08330004
083400                                                                  08340002
083500******************************************************************08350004
083600* Z2000-ABEND - PERFORMS A NON-SQL-ABEND                          08360004
083700******************************************************************08370004
083800 Z2000-ABEND.                                                     08380004
083900     DISPLAY '** ABEND           **'.                             08390004
084000     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          08400004
084100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        08410004
084200     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         08420004
084300     CALL 'ILBOABN0' USING ABEND-CODE.                            08430004
084400                                                                  08440004
084500******************************************************************08450002
084600* PREFORMS TASK TERMINATION PROCESSING                            08460002
084700******************************************************************08470002
084800 Z9000-END-PROC.                                                  08480002
084900                                                                  08490002
085000*  WRITE TRAILER LINES ON BOTTOM OF LAST PAGE                     08500037
085100     IF PA-WRITE > 0                                              08510037
085200         PERFORM UNTIL PA-LINE-CNT1 = 60                          08520037
085300             WRITE PRT-REC-TERR FROM PV-BLANK-LINE AFTER 1        08530037
085400             ADD +1 TO PA-LINE-CNT1                               08540037
085500         END-PERFORM                                              08550037
085600         WRITE PRT-REC-TERR FROM PV-TRAILER1 AFTER 1              08560037
085700         WRITE PRT-REC-TERR FROM PV-TRAILER2 AFTER 1              08570037
085800         WRITE PRT-REC-TERR FROM PV-TRAILER3 AFTER 1              08580037
085900     END-IF.                                                      08590037
086000                                                                  08600037
086100     IF PA-WRITE > 0                                              08610037
086200         PERFORM UNTIL PA-LINE-CNT2 = 60                          08620037
086300             WRITE PRT-REC-REGN FROM PV-BLANK-LINE AFTER 1        08630037
086400             ADD +1 TO PA-LINE-CNT2                               08640037
086500         END-PERFORM                                              08650037
086600         WRITE PRT-REC-REGN FROM PV-TRAILER1 AFTER 1              08660037
086700         WRITE PRT-REC-REGN FROM PV-TRAILER2 AFTER 1              08670037
086800         WRITE PRT-REC-REGN FROM PV-TRAILER3 AFTER 1              08680037
086900     END-IF.                                                      08690037
087000                                                                  08700037
087100     IF PA-WRITE > 0                                              08710037
087200         PERFORM UNTIL PA-LINE-CNT3 = 60                          08720037
087300             WRITE PRT-REC-DIST FROM PV-BLANK-LINE AFTER 1        08730037
087400             ADD +1 TO PA-LINE-CNT3                               08740037
087500         END-PERFORM                                              08750037
087600         WRITE PRT-REC-DIST FROM PV-TRAILER1 AFTER 1              08760037
087700         WRITE PRT-REC-DIST FROM PV-TRAILER2 AFTER 1              08770037
087800         WRITE PRT-REC-DIST FROM PV-TRAILER3 AFTER 1              08780037
087900     END-IF.                                                      08790037
088000                                                                  08800037
088100     IF PA-WRITE > 0                                              08810037
088200         PERFORM UNTIL PA-LINE-CNT4 = 60                          08820037
088300             WRITE PRT-REC-STR  FROM PV-BLANK-LINE AFTER 1        08830037
088400             ADD +1 TO PA-LINE-CNT4                               08840037
088500         END-PERFORM                                              08850037
088600         WRITE PRT-REC-STR  FROM PV-TRAILER1 AFTER 1              08860037
088700         WRITE PRT-REC-STR  FROM PV-TRAILER2 AFTER 1              08870037
088800         WRITE PRT-REC-STR  FROM PV-TRAILER3 AFTER 1              08880037
088900     END-IF.                                                      08890037
089000                                                                  08900037
089100     CLOSE EXTR-FILE                                              08910037
089200           RPT-FILE-TERR                                          08920005
089300           RPT-FILE-REGN                                          08930005
089400           RPT-FILE-DIST                                          08940005
089500           RPT-FILE-STR.                                          08950006
089600                                                                  08960002
089700     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 08970002
089800                                                                  08980002
089900     MOVE SYS-TIME (1:2) TO ST-END-HR.                            08990002
090000     MOVE SYS-TIME (3:2) TO ST-END-MN.                            09000002
090100                                                                  09010002
090200     DISPLAY '                    '.                              09020002
090300     DISPLAY '**********************'.                            09030002
090400     DISPLAY '   TFKRP006 CONTROLS  '.                            09040002
090500     DISPLAY '**********************'.                            09050002
090600     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         09060002
090700     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          09070002
090800     DISPLAY 'END TIME  = ' ST-END-TIME.                          09080002
090900     DISPLAY '======================'.                            09090002
091000     DISPLAY 'RECS READ = ' PA-READ.                              09100002
091100     DISPLAY 'RECS WRITTEN ' PA-WRITE.                            09110005
091200     DISPLAY '            '.                                      09120002
091300                                                                  09130002
