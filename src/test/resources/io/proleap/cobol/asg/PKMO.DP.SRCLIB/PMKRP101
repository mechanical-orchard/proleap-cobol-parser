      *----------------------------------------------------------       00010000
       IDENTIFICATION DIVISION.                                         00020000
      *----------------------------------------------------------       00030000
       PROGRAM-ID.             PMKRP101.                                00040000
       AUTHOR.                 ALEXIS KEIKER.                           00050000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
       DATE-WRITTEN.           APRIL 2003.                              00070000
       DATE-COMPILED.                                                   00080000
      *----------------------------------------------------------       00090000
      *          PMKRP101 - PROMO ITEM SALES RESULTS SUMMARY            00100000
      *                           BY AD PAGE CONDENSED                  00101000
      *----------------------------------------------------------       00102000
      * THIS PROGRAM WILL PRODUCE EITHER A FORECAST ONLY REPORT         00102300
      * OR AN ACTUAL/FORECAST REPORT. THIS PROGRAM WILL READ            00102400
      * IN A SORTED INPUT FILE CREATED FROM PROGRAM PMKUT100.           00102500
      * IT WILL THEN REPORT EACH PROMO ITEMS SALE RESULTS.  IF          00102600
      * IT IS A FORECAST ONLY REPORT THEN THE INPUT FILE WOULD          00102700
      * HAVE AN 'F' IN THE SLS TYP CDE OF THE FILE.  THIS MEANS         00102800
      * ONLY FORECASTED INFORMATION WILL BE REPORTED.  IF IT HAS        00102900
      * AN 'A' IN THE SLS TYP CDE OF THE FILE, IT WILL REPORT ON        00103000
      * ACTUALS AND FORECASTS. THIS REPORT IS A CONDENSED VERSION       00103100
      * OF PMKRP100.                                                    00103200
      *----------------------------------------------------------       00103300
      * HISTORY LOG:                                                    00103400
      *----------------------------------------------------------       00103500
      * DATE: 03/25/2009                                                00103600
      * WR/IR#: WR33995                                                 00103700
      * PROGRAMMER: AMANDA JEFFORDS                                     00103800
      * DESCRIPTION: ADDED A TOTAL CUT SUMMARY ROW.                     00103900
      *                                                                 00104000
PGNBR * DATE: 06/20/2014                                                00104113
PGNBR * WR/IR#: PRB 47935                                               00104213
PGNBR * PROGRAMMER: COGNIZANT                                           00104313
PGNBR * DESCRIPTION: MODIFIED THE PROGRAM TO PROCESS THE PROMO ITEMS AS 00104413
PGNBR *              3 CATEGORIES ADVERTISED,ADVERTISED WITH NO PAGE    00104513
PGNBR *              AND UNADVERTISED VS 2 CATEGORIES ADV & UNADV       00104613
PGNBR *                                                                 00104713
      *----------------------------------------------------------       00104812
       ENVIRONMENT DIVISION.                                            00105000
      *----------------------------------------------------------       00106000
       CONFIGURATION SECTION.                                           00107000
       SOURCE-COMPUTER. IBM-3090.                                       00108000
       OBJECT-COMPUTER. IBM-3090.                                       00109000
                                                                        00110000
       INPUT-OUTPUT SECTION.                                            00120000
                                                                        00130000
       FILE-CONTROL.                                                    00140000
                                                                        00150000
           SELECT PROMO-ITM-SUMM-FILE                                   00160000
                  ASSIGN TO INP01.                                      00170000
                                                                        00180000
           SELECT PROMO-ITM-SUMM-REPORT                                 00190000
                  ASSIGN TO RPT01.                                      00200001
                                                                        00210000
      *----------------------------------------------------------       00220000
       DATA DIVISION.                                                   00230000
      *----------------------------------------------------------       00240000
       FILE SECTION.                                                    00250000
                                                                        00260000
       FD  PROMO-ITM-SUMM-FILE                                          00270000
           RECORDING MODE F                                             00280000
           BLOCK CONTAINS 0 RECORDS                                     00290000
           LABEL RECORDS ARE OMITTED.                                   00300000
       01  PROMO-ITM-SUMM-RECORD            PIC X(750).                 00310000
                                                                        00320000
       FD  PROMO-ITM-SUMM-REPORT                                        00330000
           RECORDING MODE F                                             00340000
           BLOCK CONTAINS 0 RECORDS                                     00350000
           LABEL RECORDS ARE OMITTED.                                   00360000
       01  PROMO-ITM-SUMM-RPT-LINE          PIC X(200).                 00370000
                                                                        00380000
       WORKING-STORAGE SECTION.                                         00390000
      *----------------------------------------------------------       00400000
      * CD- CONTROL DATES (DATES ACCEPTED INTO THE PROGRAM)             00410000
      *----------------------------------------------------------       00420000
       01  CD-CONTROL-DATES.                                            00430000
           05  CD-CPU-DATE.                                             00440000
               10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    00450000
               10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    00451000
               10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    00452000
                                                                        00453000
           05  CD-CPU-DATE-GREG.                                        00454000
               10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    00455000
               10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    00456000
               10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    00457000
                                                                        00458000
           05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    00459000
                                                                        00459100
      *----------------------------------------------------------       00459200
      * CT- CONTROL TIMES (TIMES ACCEPTED INTO THE PROGRAM)             00459300
      *----------------------------------------------------------       00459400
       01  CT-CONTROL-TIMES.                                            00459500
           05  CT-CPU-TIME.                                             00459600
               10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    00459700
               10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    00459800
               10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    00459900
               10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    00460000
                                                                        00460100
      *----------------------------------------------------------       00460200
      * PC- PROGRAM CONSTANTS                                           00460300
      *----------------------------------------------------------       00460400
       01  PC-PROGRAM-CONSTANTS.                                        00460500
           05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  00460600
           05  PC-SUB-1                     PIC 9(01)  VALUE 1.         00460700
           05  PC-SUB-2                     PIC 9(01)  VALUE 2.         00460800
           05  PC-DEFAULT-BEG-HR            PIC 9(02)  VALUE 0.         00460900
           05  PC-DEFAULT-BEG-MIN           PIC 9(02)  VALUE 0.         00461000
           05  PC-DEFAULT-END-HR            PIC 9(02)  VALUE 23.        00462000
           05  PC-DEFAULT-END-MIN           PIC 9(02)  VALUE 59.        00463000
           05  PC-CHAR-BUY                  PIC X(03)  VALUE 'BUY'.     00464000
           05  PC-CHAR-GET                  PIC X(03)  VALUE 'GET'.     00465000
           05  PC-CHAR-OFF                  PIC X(03)  VALUE 'OFF'.     00466000
           05  PC-CHAR-EFFECTIVE            PIC X(09)  VALUE            00467000
                                                'EFFECTIVE'.            00468000
           05  PC-FORECAST-RSLT             PIC X(36)  VALUE            00469000
               'FORECAST ONLY RESULTS (IN THOUSANDS)'.                  00470000
           05  PC-ACTUAL-RSLT               PIC X(36)  VALUE            00480000
               'ACTUAL RESULTS (IN THOUSANDS)       '.                  00490000
           05  PC-PERCENT-SIGN              PIC X(01)  VALUE '%'.       00500000
           05  PC-DOLLAR-SIGN               PIC X(01)  VALUE '$'.       00510000
           05  PC-FRONT-PAR                 PIC X(01)  VALUE '('.       00520000
           05  PC-BACK-PAR                  PIC X(01)  VALUE ')'.       00530000
           05  PC-ONE-LINE                  PIC S9(04) VALUE +1 COMP.   00540000
           05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            00550000
                                                       'PMKRP101'.      00560000
           05  PC-COLON                     PIC X(01)  VALUE ':'.       00570000
           05  PC-DASH                      PIC X(01)  VALUE '-'.       00580000
           05  PC-ALL-DAY                   PIC X(07)  VALUE            00590000
                                                       'ALL DAY'.       00600000
           05  PC-PROMO-ITEMS-ON-PAGE       PIC X(37)  VALUE            00610000
                'PROMO ITEMS ON PAGE:                 '.                00620000
 PGNBR     05  PC-PROMO-ITEMS-NO-PAGE       PIC X(37)  VALUE            00621003
 PGNBR          'ADVERTISED PROMO ITEMS WITH NO PAGE: '.                00622003
           05  PC-TIER-ACT-TITLE            PIC X(24)  VALUE            00630000
                ' TIERED ACTUAL RESULTS: '.                             00640000
           05  PC-PROMO-ITEMS-UNADV         PIC X(37)  VALUE            00650000
                'UNADVERTISED                         '.                00660000
           05  PC-PROMO-ITEMS-ADMIN         PIC X(37)  VALUE            00670000
                'ADMIN TIER PRICING - MDSE NOT ON SALE'.                00680000
           05  PC-TOTAL                     PIC X(21)  VALUE            00690000
                'TOTAL:               '.                                00700000
           05  PC-TOTAL-FOR-CUT             PIC X(18)  VALUE            00701000
                '  TOTAL FOR CUT   '.                                   00702000
           05  PC-TOTAL-FOR-PAGE            PIC X(18)  VALUE            00710000
                'TOTAL FOR PAGE:   '.                                   00720000
           05  PC-ADV-TOTAL                 PIC X(18)  VALUE            00730000
                'ADVERTISED TOTAL: '.                                   00740000
PGNBR      05  PC-ADVNO-TOTAL               PIC X(32)  VALUE            00741005
PGNBR           'ADVERTISED WITH NO PAGE TOTAL: '.                      00742005
           05  PC-UNADV-TOTAL               PIC X(20)  VALUE            00750000
                'UNADVERTISED TOTAL: '.                                 00760000
           05  PC-ADMIN-TOTAL               PIC X(20)  VALUE            00770000
                'ADMIN TIERED TOTAL: '.                                 00780000
           05  PC-PROMOTION-TOTAL           PIC X(18)  VALUE            00790000
                'PROMOTION TOTAL:  '.                                   00800000
                                                                        00810000
      *----------------------------------------------------------       00820000
      * PS- PROGRAM SWITCHES                                            00830000
      *----------------------------------------------------------       00840000
       01  PS-PROGRAM-SWITCHES.                                         00850000
           05  PS-SALES-RESULTS-SW          PIC X(01)  VALUE 'Y'.       00860000
               88  PS-EOF-SALES-RESULTS                VALUE 'N'.       00870000
               88  PS-NOT-EOF-SALES-RESULTS            VALUE 'Y'.       00880000
           05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       00890000
               88  PS-NOT-FIRST-TIME                   VALUE 'N'.       00900000
               88  PS-FIRST-TIME                       VALUE 'Y'.       00910000
           05  PS-ADMIN-HEADER-SW           PIC X(01)  VALUE 'Y'.       00920000
               88  PS-NO-ADMIN-HEADER                  VALUE 'N'.       00930000
               88  PS-ADMIN-HEADER                     VALUE 'Y'.       00940000
           05  PS-PAGE-SECTION-TTL-SW       PIC X(01)  VALUE 'Y'.       00950000
               88  PS-PAGE-SECTION-TTL                 VALUE 'N'.       00960000
               88  PS-NO-PAGE-TTL                      VALUE 'Y'.       00970000
           05  PS-ADV-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       00980000
               88  PS-ADV-PROMO-TTL                    VALUE 'N'.       00990000
               88  PS-NO-ADV-PROMO-TTL                 VALUE 'Y'.       01000000
PGNBR      05  PS-ADV-NOPGE-TTL-SW          PIC X(01)  VALUE 'Y'.       01001003
PGNBR          88  PS-ADV-NOPGE-TTL                    VALUE 'N'.       01002003
PGNBR          88  PS-NO-ADV-NOPGE-TTL                 VALUE 'Y'.       01003003
           05  PS-UNADV-PROMO-TTL-SW        PIC X(01)  VALUE 'Y'.       01010000
               88  PS-UNADV-PROMO-TTL                  VALUE 'N'.       01020000
               88  PS-NO-UNADV-PROMO-TTL               VALUE 'Y'.       01030000
           05  PS-ADMIN-TIER-TTL-SW         PIC X(01)  VALUE 'Y'.       01040000
               88  PS-ADMIN-TIER-TTL                   VALUE 'N'.       01050000
               88  PS-NO-ADMIN-TIER-TTL                VALUE 'Y'.       01060000
           05  PS-TOT-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       01070000
               88  PS-TOT-PROMO-TTL                    VALUE 'N'.       01080000
               88  PS-NO-TOT-PROMO-TTL                 VALUE 'Y'.       01090000
           05  PS-BLANK-LINE-SW             PIC X(01)  VALUE 'Y'.       01100000
               88  PS-BLANK-LINE                       VALUE 'N'.       01110000
               88  PS-NO-BLANK-LINE                    VALUE 'Y'.       01120000
PGNBR      05  PS-REC-TYPE-FLAG             PIC X(01)  VALUE '0'.       01121018
PGNBR          88  PS-ADVNOPG-FLAG                     VALUE '1'.       01122018
PGNBR          88  PS-ADVPG-FLAG                       VALUE '2'.       01123018
PGNBR          88  PS-NOADV-FLAG                       VALUE '3'.       01124018
PGNBR      05  PS-HOLD-REC-TYPE-FLAG        PIC X(01)  VALUE '0'.       01125018
PGNBR          88  PS-HOLD-ADVNOPG-FLAG                VALUE '1'.       01126018
PGNBR          88  PS-HOLD-ADVPG-FLAG                  VALUE '2'.       01127018
PGNBR          88  PS-HOLD-NOADV-FLAG                  VALUE '3'.       01128018
PGNBR      05  PS-EOF-REC-TYPE-FLAG         PIC X(01)  VALUE '0'.       01129018
PGNBR          88  PS-NO-EOF-REC-TYPE                  VALUE '0'.       01129118
PGNBR          88  PS-EOF-ADVNOPG                      VALUE '1'.       01129218
PGNBR          88  PS-EOF-ADVPG                        VALUE '2'.       01129318
PGNBR          88  PS-EOF-NOADV                        VALUE '3'.       01129418
                                                                        01130000
      *----------------------------------------------------------       01140000
      * PV- PROGRAM VARIABLES                                           01150000
      *----------------------------------------------------------       01160000
       01  PV-PROGRAM-VARIABLES.                                        01170000
           05  PV-ADVANCE-LINES             PIC S9(04) VALUE +1 COMP.   01180000
           05  PV-SAVE-LINE-AMT             PIC S9(04) VALUE +1 COMP.   01190000
           05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   01200000
           05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         01210000
           05  PV-VAR-IDX                   PIC S9(04) VALUE +0.        01211000
           05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACE.     01220000
           05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    01230000
           05  PV-OPERATION-MSG-2           PIC X(40)  VALUE SPACES.    01240000
           05  PV-SAVE-VAR                  PIC X(60)  VALUE SPACES.    01250000
           05  PV-SAVE-NUM                  PIC 9(02)  VALUE 0.         01260000
           05  PV-SAVE-LENGTH               PIC 9(02)  VALUE 0.         01270000
           05  PV-CHAR-LENGTH               PIC 9(02)  VALUE 0.         01271000
           05  PV-SUBSCRIPT                 PIC 9(02)  VALUE 0.         01280000
           05  PV-PROMO-NM-LENGTH           PIC 9(02)  VALUE 0.         01290000
           05  PV-AD-EVNT-NM-LENGTH         PIC 9(02)  VALUE 0.         01300000
           05  PV-AD-EVNT-NBR-LENGTH        PIC 9(02)  VALUE 0.         01310000
PGNBR      05  PV-FIRST-ADVNO-REC           PIC 9(05)  VALUE 0.         01311008
PGNBR      05  PV-FIRST-UNADV-REC           PIC 9(05)  VALUE 0.         01312008
                                                                        01320000
           05  PV-TIER-ITM-DESC.                                        01330000
               10  FILLER                   PIC X(01)  VALUE SPACES.    01340000
               10  PV-TIER-ITM-DESC-1       PIC X(39)  VALUE SPACES.    01350000
           05  PV-THRS-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01360000
           05  PV-THRS-AMT-NUM-X REDEFINES                              01370000
               PV-THRS-AMT-NUM              PIC 9(10).                  01380000
           05  PV-DISC-PCT-NUM              PIC 9(03)V9(03) VALUE 0.    01390000
           05  PV-DISC-PCT-NUM-X REDEFINES                              01400000
               PV-DISC-PCT-NUM              PIC 9(06).                  01410000
           05  PV-DISC-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01420000
           05  PV-DISC-AMT-NUM-X REDEFINES                              01430000
               PV-DISC-AMT-NUM              PIC 9(10).                  01440000
           05  PV-SAVE-THRS-AMT.                                        01450000
               10  PV-SAVE-THRS-AMT-1       PIC 9(08)  VALUE 0.         01460000
               10  PV-SAVE-THRS-AMT-2       PIC 9(02)  VALUE 0.         01470000
           05  PV-SAVE-DISC-PCT.                                        01480000
               10  PV-SAVE-DISC-PCT-1       PIC 9(03)  VALUE 0.         01490000
               10  PV-SAVE-DISC-PCT-2       PIC 9(03)  VALUE 0.         01500000
           05  PV-SAVE-DISC-AMT.                                        01510000
               10  PV-SAVE-DISC-AMT-1       PIC 9(08)  VALUE 0.         01520000
               10  PV-SAVE-DISC-AMT-2       PIC 9(02)  VALUE 0.         01530000
           05  PV-THRS-AMT-CHAR             PIC X(08)  VALUE SPACES.    01540000
           05  PV-DISC-PCT-CHAR             PIC X(03)  VALUE SPACES.    01550000
           05  PV-DISC-AMT-CHAR             PIC X(08)  VALUE SPACES.    01560000
           05  PV-THRS-QTY-CHAR             PIC X(05)  VALUE SPACES.    01570000
           05  PV-POINTER-FIELD             PIC S9(03) VALUE +0.        01580000
           05  PV-LAST-ADEVNT-ID            PIC 9(10)  VALUE 0.         01590000
           05  PV-LAST-PROMO-ID             PIC 9(10)  VALUE 0.         01600000
           05  PV-TIER-PRICG-ID             PIC 9(10)  VALUE 0.         01610000
           05  PV-AD-PG-NBR                 PIC 9(03)  VALUE 0.         01620000
           05  PV-AD-PG-SEQ-NBR             PIC 9(03)  VALUE 0.         01621000
           05  PV-SAVE-ADMIN-ID             PIC 9(10)  VALUE 0.         01630000
           05  PV-ROUND-TO-WHOLE-DOLLARS    PIC S9(09) VALUE +0.        01640000
           05  PV-ROUND-TO-TENTHS           PIC S9(09)V9 VALUE +0.      01650000
           05  PV-ROUND-TO-HDRTHS           PIC S9(09)V99 VALUE +0.     01651000
           05  PV-MU-PCT                    PIC S9(09)V9999 VALUE +0    01819200
                                                           COMP-3.      01819300
           05  PV-SELL-THRU-PCT             PIC S9(09)V9999 VALUE +0    01819400
                                                           COMP-3.      01819500
           05  PV-RPT-LINE                  PIC X(200) VALUE SPACES.    01819600
           05  PV-PROMO-STRT-TMST.                                      01819700
               10  PV-PROMO-STRT-DTE.                                   01819800
                   15  PV-PM-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    01819900
                   15  PV-PM-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    01820000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01821000
                   15  PV-PM-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    01822000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01823000
                   15  PV-PM-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    01824000
               10  FILLER                   PIC X(01)  VALUE SPACES.    01825000
               10  PV-PROMO-STRT-TM.                                    01826000
                   15  PV-PM-STRT-TM-HH     PIC X(02)  VALUE SPACES.    01827000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01828000
                   15  PV-PM-STRT-TM-MM     PIC X(02)  VALUE SPACES.    01829000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01830000
                   15  PV-PM-STRT-TM-SS     PIC X(02)  VALUE SPACES.    01840000
                                                                        01850000
           05  PV-PROMO-END-TMST.                                       01860000
               10  PV-PROMO-END-DTE.                                    01870000
                   15  PV-PM-END-DTE-CC     PIC X(02)  VALUE SPACES.    01880000
                   15  PV-PM-END-DTE-YY     PIC X(02)  VALUE SPACES.    01890000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01900000
                   15  PV-PM-END-DTE-MM     PIC X(02)  VALUE SPACES.    01910000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01920000
                   15  PV-PM-END-DTE-DD     PIC X(02)  VALUE SPACES.    01930000
               10  FILLER                   PIC X(01)  VALUE SPACES.    01940000
               10  PV-PROMO-END-TM.                                     01950000
                   15  PV-PM-END-TM-HH      PIC X(02)  VALUE SPACES.    01960000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01970000
                   15  PV-PM-END-TM-MM      PIC X(02)  VALUE SPACES.    01980000
                   15  FILLER               PIC X(01)  VALUE SPACES.    01990000
                   15  PV-PM-END-TM-SS      PIC X(02)  VALUE SPACES.    02000000
                                                                        02010000
           05  PV-PROMO-ITM-STRT-TMST.                                  02020000
               10  PV-PROMO-ITM-STRT-DTE.                               02030000
                   15  PV-PI-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    02040000
                   15  PV-PI-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    02050000
                   15  FILLER               PIC X(01)  VALUE SPACES.    02060000
                   15  PV-PI-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02070000
                   15  FILLER               PIC X(01)  VALUE SPACES.    02080000
                   15  PV-PI-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02090000
               10  FILLER                   PIC X(01)  VALUE SPACES.    02100000
               10  PV-PROMO-ITM-STRT-TM.                                02110000
                   15  PV-PI-STRT-TM-HH     PIC X(02)  VALUE SPACES.    02120000
                   15  FILLER               PIC X(01)  VALUE SPACES.    02130000
                   15  PV-PI-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02140000
                   15  FILLER               PIC X(01)  VALUE SPACES.    02150000
                   15  PV-PI-STRT-TM-SS     PIC X(02)  VALUE SPACES.    02160000
                                                                        02170000
           05  PV-PROMO-ITM-END-TMST.                                   02180000
               10  PV-PROMO-ITM-END-DTE.                                02190000
                   15  PV-PI-END-DTE-CC     PIC X(02)  VALUE SPACES.    02200000
                   15  PV-PI-END-DTE-YY     PIC X(02)  VALUE SPACES.    02201000
                   15  FILLER               PIC X(01)  VALUE SPACES.    02202000
                   15  PV-PI-END-DTE-MM     PIC X(02)  VALUE SPACES.    02203000
                   15  FILLER               PIC X(01)  VALUE SPACES.    02204000
                   15  PV-PI-END-DTE-DD     PIC X(02)  VALUE SPACES.    02205000
               10  FILLER                   PIC X(01)  VALUE SPACES.    02206000
               10  PV-PROMO-ITM-END-TM.                                 02207000
                   15  PV-PI-END-TM-HH      PIC X(02)  VALUE SPACES.    02208000
                   15  FILLER               PIC X(01)  VALUE SPACES.    02209000
                   15  PV-PI-END-TM-MM      PIC X(02)  VALUE SPACES.    02209100
                   15  FILLER               PIC X(01)  VALUE SPACES.    02209200
                   15  PV-PI-END-TM-SS      PIC X(02)  VALUE SPACES.    02209300
                                                                        02209400
           05  PV-PM-ITM-EFF-STRT-DTE.                                  02209500
               10  PV-EFF-STRT-DTE-MM       PIC X(02)  VALUE SPACES.    02209600
               10  FILLER                   PIC X(01)  VALUE '/'.       02209700
               10  PV-EFF-STRT-DTE-DD       PIC X(02)  VALUE SPACES.    02209800
               10  FILLER                   PIC X(01)  VALUE '/'.       02209900
               10  PV-EFF-STRT-DTE-YY       PIC X(02)  VALUE SPACES.    02210000
                                                                        02210100
           05  PV-PM-ITM-EFF-END-DTE.                                   02210200
               10  PV-EFF-END-DTE-MM        PIC X(02)  VALUE SPACES.    02210300
               10  FILLER                   PIC X(01)  VALUE '/'.       02210400
               10  PV-EFF-END-DTE-DD        PIC X(02)  VALUE SPACES.    02210500
               10  FILLER                   PIC X(01)  VALUE '/'.       02210600
               10  PV-EFF-END-DTE-YY        PIC X(02)  VALUE SPACES.    02210700
                                                                        02210800
           05  PV-EFF-DTE-LAYOUT.                                       02210900
               10  FILLER                   PIC X(02)  VALUE SPACES.    02211000
               10  PV-OPEN-PARENTH          PIC X(01)  VALUE SPACES.    02211100
               10  PV-EFF-STRT-DTE          PIC X(08)  VALUE SPACES.    02211200
               10  PV-DTE-DASH              PIC X(01)  VALUE SPACES.    02211300
               10  PV-EFF-END-DTE           PIC X(08)  VALUE SPACES.    02211400
               10  PV-CLOSE-PARENTH         PIC X(01)  VALUE SPACES.    02211500
                                                                        02211600
           05  PV-ADMIN-TIER-TOTALS.                                    02211700
               10  PV-TTL-SLS-RTL-AMT       PIC S9(09)V9(02) COMP-3     02211800
                                                       VALUE +0.        02211900
               10  PV-TTL-SLS-UNT-QTY       PIC S9(09)V9(02) COMP-3     02212000
                                                       VALUE +0.        02212100
               10  PV-TTL-MKDN-RTL-AMT      PIC S9(09)V9(02) COMP-3     02212200
                                                       VALUE +0.        02212300
               10  PV-TTL-SLS-COST-AMT      PIC S9(09)V9(02) COMP-3     02212400
                                                       VALUE +0.        02212500
                                                                        02212600
           05  PV-VARIABLE-OUTPUT-FIELD.                                02212700
               10  PV-BIT-VARIABLE          PIC X(01)  VALUE SPACES     02212800
                                             OCCURS 61 TIMES            02212900
                                             INDEXED BY                 02213000
                                             PV-BIT-IDX.                02213100
                                                                        02213200
           05  PV-VER-AD-VARIABLE.                                      02213300
               10  PV-PARENTHESES           PIC X(01)  VALUE SPACES.    02213400
               10  PV-VERSION-AD            PIC X(59)  VALUE SPACES.    02213500
                                                                        02213600
           05  PV-HEADER-DTE-TM.                                        02213700
               10  PV-BEG-DAY-ALPHA         PIC X(10).                  02213800
               10  PV-BEG-DATE              PIC X(08).                  02213900
               10  FILLER                   PIC X(02)  VALUE SPACES.    02214000
               10  PV-BEG-TIME.                                         02214100
                   15  PV-BEG-HR-TIME       PIC 9(02).                  02214200
                   15  PV-BEG-TIME-COLON    PIC X(01).                  02214300
                   15  PV-BEG-MIN-TIME      PIC 9(02).                  02214400
                   15  FILLER               PIC X(02)  VALUE SPACES.    02214500
               10  FILLER                   PIC X(11)  VALUE            02214600
                                            '   THROUGH '.              02214700
               10  PV-END-DAY-ALPHA         PIC X(10).                  02214800
               10  PV-END-DATE              PIC X(08).                  02214900
               10  FILLER                   PIC X(02)  VALUE SPACES.    02215000
               10  PV-END-TIME.                                         02215100
                   15  PV-END-HR-TIME       PIC 9(02).                  02215200
                   15  PV-END-TIME-COLON    PIC X(01).                  02215300
                   15  PV-END-MIN-TIME      PIC 9(02).                  02215400
                   15  FILLER               PIC X(02).                  02215500
               10  FILLER                   PIC X(22)  VALUE SPACES.    02215600
                                                                        02215700
      *----------------------------------------------------------       02215800
      * PA- PROGRAM ACCUMULATORS                                        02215900
      *----------------------------------------------------------       02216000
       01  PA-PROGRAM-ACCUMULATORS.                                     02216100
           05  PA-CNT-ADV-TOT               PIC 9(09)  VALUE ZEROES.    02216200
PGNBR      05  PA-CNT-ADVNO-TOT             PIC 9(09)  VALUE ZEROES.    02216311
           05  PA-CNT-UNADV-TOT             PIC 9(09)  VALUE ZEROES.    02216404
           05  PA-CNT-ADMIN-TOT             PIC 9(09)  VALUE ZEROES.    02216504
           05  PA-CNT-SPACES-1              PIC 9(09)  VALUE ZEROES.    02217000
           05  PA-CNT-POS-1                 PIC 9(09)  VALUE ZEROES.    02218000
           05  PA-CNT-SPACES-2              PIC 9(09)  VALUE ZEROES.    02219000
           05  PA-CNT-SPACES                PIC 9(09)  VALUE ZEROES.    02220000
           05  PA-CNT-POS-2                 PIC 9(09)  VALUE ZEROES.    02230000
                                                                        02240000
      *----------------------------------------------------------       02250000
      * TBL- TABLE VARIABLES                                            02260000
      *----------------------------------------------------------       02270000
      * NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02280000
      *    OCCURRENCE CONTAINS FORECAST FIGURES                         02290000
       01  TBL-SECT-TOTAL-TABLE.                                        02300000
           05  TBL-STOT-LINE-01 OCCURS 02 TIMES                         02310000
                                 INDEXED BY TBL-STOT-INDX.              02320000
               10  TBL-STOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    02330000
               10  TBL-STOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    02340000
               10  TBL-STOT-TOT-SLS-UNT-QTY                             02350000
                                            PIC S9(09)V9(02) COMP-3.    02360000
               10  TBL-STOT-TOT-EOH-INV-QTY                             02370000
                                            PIC S9(09)V9(02) COMP-3.    02380000
               10  TBL-STOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    02390000
               10  TBL-STOT-TOT-SLS-COST-AMT                            02400000
                                            PIC S9(09)V9(02) COMP-3.    02410000
                                                                        02420000
      * NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02430000
      *    OCCURRENCE CONTAINS FORECAST FIGURES                         02440000
       01  TBL-PROMO-TOTAL-TABLE.                                       02450000
           05  TBL-PMTOT-LINE-01 OCCURS 02 TIMES                        02460000
                                INDEXED BY TBL-PMTOT-INDX.              02470000
               10  TBL-PMTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    02480000
               10  TBL-PMTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    02490000
               10  TBL-PMTOT-TOT-SLS-UNT-QTY                            02500000
                                            PIC S9(09)V9(02) COMP-3.    02510000
               10  TBL-PMTOT-TOT-EOH-INV-QTY                            02520000
                                            PIC S9(09)V9(02) COMP-3.    02530000
               10  TBL-PMTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    02540000
               10  TBL-PMTOT-TOT-SLS-COST-AMT                           02550000
                                            PIC S9(09)V9(02) COMP-3.    02560000
                                                                        02570000
      * NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02570100
      *    OCCURRENCE CONTAINS FORECAST FIGURES                         02570200
       01  TBL-SEQ-TOTAL-TABLE.                                         02571000
           05  TBL-SEQTOT-LINE-01 OCCURS 02 TIMES                       02572000
                                 INDEXED BY TBL-SEQTOT-INDX.            02573000
               10  TBL-SEQTOT-TOT-SALE-AMT  PIC S9(09)V9(02) COMP-3.    02574000
               10  TBL-SEQTOT-TOT-MD-AMT    PIC S9(09)V9(02) COMP-3.    02575000
               10  TBL-SEQTOT-TOT-SLS-UNT-QTY                           02576000
                                            PIC S9(09)V9(02) COMP-3.    02577000
               10  TBL-SEQTOT-TOT-EOH-INV-QTY                           02578000
                                            PIC S9(09)V9(02) COMP-3.    02579000
               10  TBL-SEQTOT-PREP-UNT-QTY  PIC S9(09)V9(02) COMP-3.    02579100
               10  TBL-SEQTOT-TOT-SLS-COST-AMT                          02579200
                                            PIC S9(09)V9(02) COMP-3.    02579300
                                                                        02579400
      *----------------------------------------------------------       02580000
      * ABEND- ABEND VARIABLES                                          02590000
      *----------------------------------------------------------       02600000
       01  ABEND-CODE                       PIC S9(04) VALUE +0 COMP.   02610000
           88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     02620000
           88  ABEND-4002-READ-ERROR                   VALUE +4002.     02630000
           88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     02640000
           88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     02650000
           88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     02660000
           88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     02670000
           88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     02680000
           88  ABEND-4008-DATA-ERROR                   VALUE +4008.     02690000
           88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     02700000
           88  ABEND-4013-DB2-ERROR                    VALUE +4013.     02730000
           88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     02740000
           88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     02750000
                                                                        02760000
       01  END-OF-REPORT-LINE.                                          02770000
           05  FILLER                       PIC X(25)  VALUE            02780000
               ' ** END OF REPORT **     '.                             02790000
                                                                        02800000
      *----------------------------------------------------------       02810000
      * HD- HEADER INFO                                                 02820000
      *----------------------------------------------------------       02830000
       01  HEADER-01.                                                   02840000
           05  FILLER                       PIC X(62) VALUE SPACES.     02850000
           05  FILLER                       PIC X(44) VALUE             02860000
               'PROMO ITEM SUMMARY - BY AD PAGE CONDENSED - '.          02870000
           05  HDR-01-TITLE                 PIC X(36)  VALUE SPACES.    02880000
           05  FILLER                       PIC X(58) VALUE SPACES.     02890000
                                                                        02900000
       01  HEADER-02.                                                   02910000
           05  FILLER                       PIC X(12)  VALUE            02920000
                                            ' AD EVENT : '.             02930000
           05  HDR-02-ADEVNT-STRING         PIC X(188) VALUE SPACES.    02940000
                                                                        02950000
       01  HEADER-03.                                                   02960000
           05  FILLER                       PIC X(12)  VALUE            02970000
                                            ' PROMOTION: '.             02980000
           05  HDR-03-PROMO-STRING          PIC X(188) VALUE SPACES.    02990000
                                                                        03000000
       01  HEADER-04.                                                   03010000
           05  FILLER                       PIC X(45)  VALUE            03020000
               '                                             '.         03030000
           05  FILLER                       PIC X(45)  VALUE            03040000
               '                 SALES VOLUME              UN'.         03050000
           05  FILLER                       PIC X(45)  VALUE            03060000
               'ITS SOLD               PREP UNITS        SELL'.         03070000
           05  FILLER                       PIC X(45)  VALUE            03080000
               '         MARKUP %          DMM               '.         03090000
           05  FILLER                       PIC X(25)  VALUE            03120000
               '                    '.                                  03121000
                                                                        03122000
       01  HEADER-05.                                                   03123000
           05  FILLER                       PIC X(45)  VALUE            03124000
               ' PROMO ITEM DESCRIPTION                      '.         03125000
           05  FILLER                       PIC X(45)  VALUE            03126000
               '                ACT        FCST          ACT '.         03127000
           05  FILLER                       PIC X(45)  VALUE            03128000
               '       FCST          ACT        FCST    THRU '.         03129000
           05  FILLER                       PIC X(45)  VALUE            03130000
               '%      ACT     FCST     LAST NAME            '.         03140000
           05  FILLER                       PIC X(20)  VALUE            03150000
               '                    '.                                  03160000
                                                                        03190000
                                                                        03200000
      *----------------------------------------------------------       03210000
      * DTL- DETAIL INFO                                                03220000
      *----------------------------------------------------------       03230000
       01  DETAIL-HEADER-01.                                            03240000
           05  DTL-HDR-01-PAGE.                                         03250000
               10  DTL-HDR-01-PM-ITM-PAGE.                              03260000
                   15  FILLER               PIC X(01).                  03270000
                   15  DTL-HDR-01-PM-ITM-PAGE-TITLE                     03280000
                                            PIC X(21).                  03290000
                   15  DTL-HDR-01-PM-ITM-PAGE-NBR                       03300000
                                            PIC ZZ9.                    03310000
                   15  FILLER               PIC X(13).                  03320000
               10  DTL-HDR-01-NO-PAGE REDEFINES                         03330000
                   DTL-HDR-01-PM-ITM-PAGE .                             03340000
                   15  FILLER               PIC X(01).                  03350000
                   15  DTL-HDR-01-HEADING-TITLE                         03360000
                                            PIC X(37).                  03370000
           05  FILLER                       PIC X(162) VALUE SPACES.    03380000
                                                                        03390000
       01  DETAIL-HEADER-02.                                            03400000
           05  DTL-HDR-02-ADMIN-TIER.                                   03410000
               10  FILLER                   PIC X(01)  VALUE SPACES.    03420000
               10  DTL-HDR-02-PM-ITM-DESC   PIC X(40)  VALUE SPACES.    03430000
           05  FILLER                       PIC X(159) VALUE SPACES.    03440000
                                                                        03450000
       01  DETAIL-VARIABLE.                                             03460000
           05  FILLER                       PIC X(01)  VALUE SPACES.    03470000
           05  DTL-VAR-VOL-PCT-CHG          PIC ZZ9.9.                  03480000
           05  DTL-VAR-VOL-PCT-CHG1 REDEFINES                           03481000
               DTL-VAR-VOL-PCT-CHG          PIC ZZZ.Z.                  03482000
           05  FILLER                       PIC X(01)  VALUE SPACES.    03490000
                                                                        03500000
       01  DETAIL-01.                                                   03510000
           05  FILLER                       PIC X(01)  VALUE SPACES.    03520000
           05  DTL-01-PMITEM-DESC           PIC X(50).                  03530000
           05  FILLER                       PIC X(03)  VALUE SPACES.    03560000
           05  DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZ9.99.             03570000
           05  DTL-01-ACTL-SLS-RTL-AMT1 REDEFINES                       03571000
               DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03572000
           05  FILLER                       PIC X(02)  VALUE SPACES.    03580000
           05  DTL-01-FCST-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03590000
           05  FILLER                       PIC X(03)  VALUE SPACES.    03600000
           05  DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZ9.99.             03680000
           05  DTL-01-ACTL-UNT-SLD-QTY1 REDEFINES                       03680100
               DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03680200
           05  FILLER                       PIC X(02)  VALUE SPACES.    03680300
           05  DTL-01-FCST-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03680400
           05  FILLER                       PIC X(03)  VALUE SPACES.    03680500
           05  DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZ9.99.             03680600
           05  DTL-01-ACTL-PREP-UNT-QTY1 REDEFINES                      03680700
               DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03680800
           05  FILLER                       PIC X(02)  VALUE SPACES.    03680900
           05  DTL-01-FCST-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03681000
           05  FILLER                       PIC X(04)  VALUE SPACES.    03681100
           05  DTL-01-SELL-THRU-PCT         PIC ZZ9.9.                  03681200
           05  DTL-01-SELL-THRU-PCT1 REDEFINES                          03681300
               DTL-01-SELL-THRU-PCT         PIC ZZZ.Z.                  03681400
           05  DTL-O1-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03682000
           05  FILLER                       PIC X(04)  VALUE SPACES.    03685000
           05  DTL-01-ACTL-MU-PCT           PIC ZZ9.9.                  03686000
           05  DTL-01-ACTL-MU-PCT1 REDEFINES                            03686100
               DTL-01-ACTL-MU-PCT           PIC ZZZ.Z.                  03686200
           05  DTL-01-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03687000
           05  FILLER                       PIC X(03)  VALUE SPACES.    03688000
           05  DTL-01-FCST-MU-PCT           PIC ZZ9.9.                  03689000
           05  DTL-01-FCST-MU-PCT1 REDEFINES                            03689100
               DTL-01-FCST-MU-PCT           PIC ZZZ.Z.                  03689200
           05  DTL-01-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    03690000
           05  FILLER                       PIC X(04)  VALUE SPACES.    03690100
           05  DTL-01-DMM-LAST-NM           PIC X(40)  VALUE SPACES.    03691000
           05  FILLER                       PIC X(01)  VALUE SPACES.    03700000
                                                                        03765000
       01  DETAIL-02.                                                   03765100
           05  FILLER                       PIC X(01)  VALUE SPACES.    03765200
           05  DTL-02-DTES.                                             03765300
               10  DTL-02-EFF-DTES          PIC X(36)  VALUE SPACES.    03765400
               10  FILLER                   PIC X(26)  VALUE SPACES.    03765500
           05  DTL-02-VERSIONS                                          03765600
               REDEFINES DTL-02-DTES.                                   03765700
               10  FILLER                   PIC X(02).                  03765800
               10  DTL-01-VERSION-AD        PIC X(60).                  03765900
           05  FILLER                       PIC X(205) VALUE SPACES.    03766000
                                                                        03766100
       01  DETAIL-PMPG-TOTALS.                                          03771000
           05  DTL-PROMO-PAGE.                                          03772000
               10  DTL-PAGE-TITLE.                                      03773000
                   15  FILLER               PIC X(01).                  03774000
                   15  DTL-PG-PAGE-TITLE    PIC X(16).                  03775000
                   15  DTL-PG-PAGE-NBR      PIC ZZ9.                    03776000
                10 DTL-PROMO-TITLE REDEFINES                            03777000
                   DTL-PAGE-TITLE.                                      03778000
                   15  FILLER               PIC X(01).                  03779000
                   15  DTL-PM-PROMO-TITLE   PIC X(19).                  03780000
           05  FILLER                       PIC X(34)  VALUE SPACES.    03780100
           05  DTL-PMPG-ACTL-TOT-SLS-AMT    PIC ZZZ,ZZ9.99.             03780200
           05  DTL-PMPG-ACTL-TOT-SLS-AMT1 REDEFINES                     03780300
               DTL-PMPG-ACTL-TOT-SLS-AMT    PIC ZZZ,ZZZ.ZZ.             03780400
           05  FILLER                       PIC X(02)  VALUE SPACES.    03780500
           05  DTL-PMPG-FCST-TOT-SLS-AMT    PIC ZZZ,ZZZ.ZZ.             03780600
           05  FILLER                       PIC X(03)  VALUE SPACES.    03780800
           05  DTL-PMPG-TOT-ACTL-UNT-QTY    PIC ZZZ,ZZ9.99.             03781300
           05  DTL-PMPG-TOT-ACTL-UNT-QTY1 REDEFINES                     03781400
               DTL-PMPG-TOT-ACTL-UNT-QTY    PIC ZZZ,ZZZ.ZZ.             03781500
           05  FILLER                       PIC X(02)  VALUE SPACES.    03781600
           05  DTL-PMPG-TOT-FCST-UNT-QTY    PIC ZZZ,ZZZ.ZZ.             03781700
           05  FILLER                       PIC X(03)  VALUE SPACES.    03781800
           05  DTL-PMPG-TOT-ACTL-PREP-QTY   PIC ZZZ,ZZ9.99.             03781900
           05  DTL-PMPG-TOT-ACTL-PREP-QTY1 REDEFINES                    03782000
               DTL-PMPG-TOT-ACTL-PREP-QTY   PIC ZZZ,ZZZ.ZZ.             03782100
           05  FILLER                       PIC X(02)  VALUE SPACES.    03782200
           05  DTL-PMPG-TOT-FCST-PREP-QTY   PIC ZZZ,ZZZ.ZZ.             03782300
           05  FILLER                       PIC X(04)  VALUE SPACES.    03782400
           05  DTL-PMPG-TOT-SELL-THRU-PCT   PIC ZZ9.9.                  03782500
           05  DTL-PMPG-TOT-SELL-THRU-PCT1 REDEFINES                    03782600
               DTL-PMPG-TOT-SELL-THRU-PCT   PIC ZZZ.Z.                  03782700
           05  DTL-PMPG-SELL-PCT-SIGN       PIC X(01)  VALUE SPACES.    03782800
           05  FILLER                       PIC X(04)  VALUE SPACES.    03782900
           05  DTL-PMPG-TOT-ACTL-MU-PCT     PIC ZZ9.9.                  03783000
           05  DTL-PMPG-TOT-ACTL-MU-PCT1 REDEFINES                      03783100
               DTL-PMPG-TOT-ACTL-MU-PCT     PIC ZZZ.Z.                  03783200
           05  DTL-PMPG-ACTL-PCT-SIGN       PIC X(01)  VALUE SPACES.    03783300
           05  FILLER                       PIC X(03)  VALUE SPACES.    03783400
           05  DTL-PMPG-TOT-FCST-MU-PCT     PIC ZZ9.9.                  03783500
           05  DTL-PMPG-TOT-FCST-MU-PCT1 REDEFINES                      03783600
               DTL-PMPG-TOT-FCST-MU-PCT     PIC ZZZ.Z.                  03783700
           05  DTL-PMPG-FCST-PCT-SIGN       PIC X(01)  VALUE SPACES.    03783800
           05  FILLER                       PIC X(45)  VALUE SPACES.    03783900
                                                                        03784000
       01  DETAIL-ADV-TOTALS.                                           03784100
           05  DTL-ADV.                                                 03784200
               10  DTL-ADV-TITLE.                                       03784300
                   15  FILLER               PIC X(01).                  03784400
                   15  DTL-ADV-PM-TITLE     PIC X(18).                  03784500
           05  FILLER                       PIC X(35)  VALUE SPACES.    03784600
           05  DTL-ADV-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZ9.99.             03785000
           05  DTL-ADV-TOT-ACTL-SLS-AMT1 REDEFINES                      03785100
               DTL-ADV-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             03785200
           05  FILLER                       PIC X(02)  VALUE SPACES.    03786000
           05  DTL-ADV-TOT-FCST-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             03787000
           05  FILLER                       PIC X(03)  VALUE SPACES.    03787400
           05  DTL-ADV-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZ9.99.             03787900
           05  DTL-ADV-TOT-ACTL-UNT-QTY1 REDEFINES                      03788000
               DTL-ADV-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03788100
           05  FILLER                       PIC X(02)  VALUE SPACES.    03788200
           05  DTL-ADV-TOT-FCST-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03788300
           05  FILLER                       PIC X(03)  VALUE SPACES.    03788400
           05  DTL-ADV-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZ9.99.             03788500
           05  DTL-ADV-TOT-ACTL-PREP-QTY1 REDEFINES                     03788600
               DTL-ADV-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             03788700
           05  FILLER                       PIC X(02)  VALUE SPACES.    03788800
           05  DTL-ADV-TOT-FCST-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             03788900
           05  FILLER                       PIC X(04)  VALUE SPACES.    03789000
           05  DTL-ADV-TOT-SELL-THRU-PCT    PIC ZZ9.9.                  03789100
           05  DTL-ADV-TOT-SELL-THRU-PCT1 REDEFINES                     03789200
               DTL-ADV-TOT-SELL-THRU-PCT    PIC ZZZ.Z.                  03789300
           05  DTL-ADV-SELL-PCT-SIGN        PIC X(01)  VALUE SPACES.    03789400
           05  FILLER                       PIC X(04)  VALUE SPACES.    03789500
           05  DTL-ADV-TOT-ACTL-MU-PCT      PIC ZZ9.9.                  03789600
           05  DTL-ADV-TOT-ACTL-MU-PCT1 REDEFINES                       03789700
               DTL-ADV-TOT-ACTL-MU-PCT      PIC ZZZ.Z.                  03789800
           05  DTL-ADV-ACTL-PCT-SIGN        PIC X(01)  VALUE SPACES.    03789900
           05  FILLER                       PIC X(03)  VALUE SPACES.    03790000
           05  DTL-ADV-TOT-FCST-MU-PCT      PIC ZZ9.9.                  03790100
           05  DTL-ADV-TOT-FCST-MU-PCT1 REDEFINES                       03790200
               DTL-ADV-TOT-FCST-MU-PCT      PIC ZZZ.Z.                  03790300
           05  DTL-ADV-FCST-PCT-SIGN        PIC X(01)  VALUE SPACES.    03790400
           05  FILLER                       PIC X(45)  VALUE SPACES.    03790500
                                                                        03790600
PGNBR  01  DETAIL-ADVNO-TOTALS.                                         03790704
PGNBR      05  DTL-ADVNO.                                               03790804
PGNBR          10  DTL-ADVNO-TITLE.                                     03790904
PGNBR              15  FILLER               PIC X(01).                  03791004
PGNBR              15  DTL-ADVNO-PM-TITLE   PIC X(32).                  03791105
PGNBR      05  FILLER                       PIC X(21)  VALUE SPACES.    03791205
PGNBR      05  DTL-ADVNO-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             03791304
PGNBR      05  DTL-ADVNO-TOT-ACTL-SLS-AMT1 REDEFINES                    03791404
PGNBR          DTL-ADVNO-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             03791504
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    03791604
PGNBR      05  DTL-ADVNO-TOT-FCST-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             03791704
PGNBR      05  FILLER                       PIC X(03)  VALUE SPACES.    03791804
PGNBR      05  DTL-ADVNO-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             03791904
PGNBR      05  DTL-ADVNO-TOT-ACTL-UNT-QTY1 REDEFINES                    03792004
PGNBR          DTL-ADVNO-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             03792104
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    03792204
PGNBR      05  DTL-ADVNO-TOT-FCST-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             03792304
PGNBR      05  FILLER                       PIC X(03)  VALUE SPACES.    03792404
PGNBR      05  DTL-ADVNO-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             03792504
PGNBR      05  DTL-ADVNO-TOT-ACTL-PREP-QTY1 REDEFINES                   03792604
PGNBR          DTL-ADVNO-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             03792704
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    03792804
PGNBR      05  DTL-ADVNO-TOT-FCST-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             03792904
PGNBR      05  FILLER                       PIC X(04)  VALUE SPACES.    03793004
PGNBR      05  DTL-ADVNO-TOT-SELL-THRU-PCT  PIC ZZ9.9.                  03793104
PGNBR      05  DTL-ADVNO-TOT-SELL-THRU-PCT1 REDEFINES                   03793204
PGNBR          DTL-ADVNO-TOT-SELL-THRU-PCT  PIC ZZZ.Z.                  03793304
PGNBR      05  DTL-ADVNO-SELL-PCT-SIGN      PIC X(01)  VALUE SPACES.    03793404
PGNBR      05  FILLER                       PIC X(04)  VALUE SPACES.    03793504
PGNBR      05  DTL-ADVNO-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  03793604
PGNBR      05  DTL-ADVNO-TOT-ACTL-MU-PCT1 REDEFINES                     03793704
PGNBR          DTL-ADVNO-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  03793804
PGNBR      05  DTL-ADVNO-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    03793904
PGNBR      05  FILLER                       PIC X(03)  VALUE SPACES.    03794004
PGNBR      05  DTL-ADVNO-TOT-FCST-MU-PCT    PIC ZZ9.9.                  03794104
PGNBR      05  DTL-ADVNO-TOT-FCST-MU-PCT1 REDEFINES                     03794204
PGNBR          DTL-ADVNO-TOT-FCST-MU-PCT    PIC ZZZ.Z.                  03794304
PGNBR      05  DTL-ADVNO-FCST-PCT-SIGN      PIC X(01)  VALUE SPACES.    03794404
PGNBR      05  FILLER                       PIC X(45)  VALUE SPACES.    03794504
PGNBR                                                                   03794604
       01  DETAIL-UNADV-TOTALS.                                         03794700
           05  DTL-UNADV.                                               03794800
               10  DTL-UNADV-TITLE.                                     03794900
                   15  FILLER               PIC X(01).                  03795000
                   15  DTL-UNADV-PM-TITLE   PIC X(20).                  03795100
           05  FILLER                       PIC X(33)  VALUE SPACES.    03795200
           05  DTL-UNADV-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             03795300
           05  DTL-UNADV-TOT-ACTL-SLS-AMT1 REDEFINES                    03795400
               DTL-UNADV-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             03795500
           05  FILLER                       PIC X(02)  VALUE SPACES.    03795600
           05  DTL-UNADV-TOT-FCST-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             03795700
           05  FILLER                       PIC X(03)  VALUE SPACES.    03795800
           05  DTL-UNADV-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             03795900
           05  DTL-UNADV-TOT-ACTL-UNT-QTY1 REDEFINES                    03796000
               DTL-UNADV-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             03796100
           05  FILLER                       PIC X(02)  VALUE SPACES.    03796200
           05  DTL-UNADV-TOT-FCST-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             03796300
           05  FILLER                       PIC X(03)  VALUE SPACES.    03796400
           05  DTL-UNADV-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             03796500
           05  DTL-UNADV-TOT-ACTL-PREP-QTY1 REDEFINES                   03796600
               DTL-UNADV-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             03796700
           05  FILLER                       PIC X(02)  VALUE SPACES.    03796800
           05  DTL-UNADV-TOT-FCST-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             03796900
           05  FILLER                       PIC X(04)  VALUE SPACES.    03797000
           05  DTL-UNADV-TOT-SELL-THRU-PCT  PIC ZZ9.9.                  03797100
           05  DTL-UNADV-TOT-SELL-THRU-PCT1 REDEFINES                   03797200
               DTL-UNADV-TOT-SELL-THRU-PCT  PIC ZZZ.Z.                  03797300
           05  DTL-UNADV-SELL-PCT-SIGN      PIC X(01)  VALUE SPACES.    03797400
           05  FILLER                       PIC X(04)  VALUE SPACES.    03797500
           05  DTL-UNADV-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  03797600
           05  DTL-UNADV-TOT-ACTL-MU-PCT1 REDEFINES                     03797700
               DTL-UNADV-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  03797800
           05  DTL-UNADV-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    03797900
           05  FILLER                       PIC X(03)  VALUE SPACES.    03798000
           05  DTL-UNADV-TOT-FCST-MU-PCT    PIC ZZ9.9.                  03798100
           05  DTL-UNADV-TOT-FCST-MU-PCT1 REDEFINES                     03798200
               DTL-UNADV-TOT-FCST-MU-PCT    PIC ZZZ.Z.                  03798300
           05  DTL-UNADV-FCST-PCT-SIGN      PIC X(01)  VALUE SPACES.    03798400
           05  FILLER                       PIC X(45)  VALUE SPACES.    03798500
                                                                        03798600
       01  DETAIL-ATLVL-TOTALS.                                         03798700
           05  DTL-ATLVL.                                               03798800
               10  DTL-ATLVL-TITLE.                                     03798900
                   15  FILLER               PIC X(01).                  03799000
                   15  DTL-ATLVL-PM-TITLE   PIC X(20).                  03799100
           05  FILLER                       PIC X(33)  VALUE SPACES.    03799200
           05  DTL-ATLVL-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             03800000
           05  DTL-ATLVL-TOT-ACTL-SLS-AMT1 REDEFINES                    03801000
               DTL-ATLVL-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             03802000
           05  FILLER                       PIC X(15)  VALUE SPACES.    03802100
           05  DTL-ATLVL-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             03802200
           05  DTL-ATLVL-TOT-ACTL-UNT-QTY1 REDEFINES                    03802300
               DTL-ATLVL-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             03802400
           05  FILLER                       PIC X(15)  VALUE SPACES.    03802500
           05  DTL-ATLVL-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             03802600
           05  DTL-ATLVL-TOT-ACTL-PREP-QTY1 REDEFINES                   03802700
               DTL-ATLVL-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             03802800
           05  FILLER                       PIC X(14)  VALUE SPACES.    03802900
           05  DTL-ATLVL-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  03803000
           05  DTL-ATLVL-TOT-ACTL-MU-PCT1 REDEFINES                     03803100
               DTL-ATLVL-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  03803200
           05  DTL-ATLVL-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    03803300
           05  FILLER                       PIC X(66)  VALUE SPACES.    03803400
                                                                        03803500
       01  DETAIL-ADMIN-TOTALS.                                         03803600
           05  DTL-ADMIN.                                               03803700
               10  DTL-ADMIN-TITLE.                                     03803800
                   15  FILLER               PIC X(01).                  03803900
                   15  DTL-ADMIN-PM-TITLE   PIC X(20).                  03804000
           05  FILLER                       PIC X(33)  VALUE SPACES.    03804100
           05  DTL-ADMIN-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             03804200
           05  DTL-ADMIN-TOT-ACTL-SLS-AMT1 REDEFINES                    03804300
               DTL-ADMIN-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             03804400
           05  FILLER                       PIC X(15)  VALUE SPACES.    03805000
           05  DTL-ADMIN-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             03805100
           05  DTL-ADMIN-TOT-ACTL-UNT-QTY1 REDEFINES                    03805200
               DTL-ADMIN-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             03805300
           05  FILLER                       PIC X(15)  VALUE SPACES.    03805400
           05  DTL-ADMIN-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             03805500
           05  DTL-ADMIN-TOT-ACTL-PREP-QTY1 REDEFINES                   03805600
               DTL-ADMIN-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             03805700
           05  FILLER                       PIC X(14)  VALUE SPACES.    03805800
           05  DTL-ADMIN-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  03805900
           05  DTL-ADMIN-TOT-ACTL-MU-PCT1 REDEFINES                     03806000
               DTL-ADMIN-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  03806100
           05  DTL-ADMIN-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    03806200
           05  FILLER                       PIC X(66)  VALUE SPACES.    03806300
                                                                        03806400
      *----------------------------------------------------------       03807000
      * COPYBOOK FOR THE PROMO ITEM SUMMARY EXTRACT - INPUT             03807100
      *----------------------------------------------------------       03807200
           COPY PMRD100.                                                03807300
                                                                        03807400
      *----------------------------------------------------------       03807500
      *  DATE VALIDATION CALLING PARAMETER LIST                         03807600
      *----------------------------------------------------------       03807700
           COPY DPWS500.                                                03807800
                                                                        03807900
      *----------------------------------------------------------       03808000
      *  STANDARD HEADER LINE - KOHLS 200 COL                           03808100
      *----------------------------------------------------------       03808200
           COPY DPWS200O.                                               03808300
           EJECT                                                        03808400
                                                                        03808500
      *----------------------------------------------------------       03808600
       PROCEDURE DIVISION.                                              03808700
      *----------------------------------------------------------       03808800
       0000-MAINLINE.                                                   03808900
                                                                        03809000
           PERFORM 1000-INITIALIZATION.                                 03810000
                                                                        03820000
           PERFORM 2000-PROCESS-SALES-RESULTS                           03830000
                   UNTIL PS-EOF-SALES-RESULTS.                          03840000
                                                                        03850000
           PERFORM 3000-END-OF-JOB-ROUTINE.                             03860000
                                                                        03870000
           GOBACK.                                                      03880000
                                                                        03890000
      *0000-EXIT.                                                       03900000
       EJECT.                                                           03910000
                                                                        03920000
      *----------------------------------------------------------       03930000
      * 1000-INITIALIZATION.                                            03940000
      *     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      03950000
      *     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      03960000
      *     PARAMETERS IT MAY NEED TO USE TO READ AND PROCESS           03970000
      *     ANY OF THE RECORDS FROM THE INPUT FILE.                     03980000
      *----------------------------------------------------------       03990000
       1000-INITIALIZATION.                                             04000000
                                                                        04010000
           INITIALIZE PM100-PROMO-ITM-SUMM                              04020000
                      TBL-SECT-TOTAL-TABLE                              04030000
                      TBL-SEQ-TOTAL-TABLE                               04031000
                      TBL-PROMO-TOTAL-TABLE.                            04040000
                                                                        04050000
           SET PS-FIRST-TIME TO TRUE.                                   04051000
                                                                        04052000
           OPEN INPUT PROMO-ITM-SUMM-FILE                               04060000
               OUTPUT PROMO-ITM-SUMM-REPORT.                            04070000
                                                                        04071000
           ACCEPT CD-CPU-DATE FROM DATE.                                04072000
           MOVE CD-CPU-YR                  TO CD-CPU-YY.                04072100
           MOVE CD-CPU-MO                  TO CD-CPU-MM.                04072200
           MOVE CD-CPU-DY                  TO CD-CPU-DD.                04072300
                                                                        04072400
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04072500
           SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     04072600
           SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     04072700
           SET DPG52-LK-DTE-GREG           TO TRUE.                     04072800
           MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      04072900
           MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              04073000
                                           TO PV-OPERATION-MSG-1.       04074000
                                                                        04075000
           PERFORM 9100-CALENDAR-ROUTINE.                               04076000
                                                                        04077000
           MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          04078000
                                                                        04079000
           ACCEPT CT-CPU-TIME FROM TIME.                                04080000
           MOVE CT-CPU-HR                  TO DP200O-RUN-HOUR.          04090000
           MOVE CT-CPU-MIN                 TO DP200O-RUN-MINUTE.        04100000
           MOVE CD-CPU-MO                  TO DP200O-RUN-MONTH.         04110000
           MOVE CD-CPU-DY                  TO DP200O-RUN-DAY.           04120000
           MOVE CD-CPU-YR                  TO DP200O-RUN-YEAR.          04130000
           MOVE PC-CURRENT-PROGRAM-NAME    TO DP200O-PROGRAM-NAME.      04140000
                                                                        04150000
           PERFORM 8000-READ-SALES-RESULTS.                             04160000
                                                                        04170000
           IF PS-EOF-SALES-RESULTS                                      04180000
              DISPLAY 'NO PROMO ITEMS TO REPORT ON'                     04190000
           ELSE                                                         04200000
              SET PS-ADMIN-HEADER TO TRUE                               04220000
              EVALUATE TRUE                                             04230000
                WHEN PM100-ACTUAL                                       04240000
                     MOVE PC-ACTUAL-RSLT    TO HDR-01-TITLE             04250000
                WHEN PM100-FORECAST                                     04260000
                     MOVE PC-FORECAST-RSLT  TO HDR-01-TITLE             04270000
                WHEN OTHER                                              04280000
                     DISPLAY 'PM100-FCST-ACTUAL-IND: '                  04290000
                                    PM100-FCST-ACTUAL-IND               04300000
                     SET ABEND-4444-FORCED-ABEND TO TRUE                04310000
                     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    04320000
                     MOVE 'NOT A VALID FORECAST/ACTUAL IND'             04330000
                                             TO PV-OPERATION-MSG-1      04340000
                     PERFORM 9800-ABEND                                 04350000
              END-EVALUATE                                              04360000
           END-IF.                                                      04370000
                                                                        04380000
      *1000-EXIT.                                                       04390000
       EJECT.                                                           04400000
                                                                        04410000
      *----------------------------------------------------------       04420000
      * 2000-PROCESS-SALES-RESULTS.                                     04430000
      *     PROCESSES THE SALES RESULTS FILE AND CREATES A              04440000
      *     A REPORT. THIS REPORT BREAKS BY AD EVENT/PROMOTION.         04450000
      *     WITHIN EACH PROMOTION THE REPORT MAY HAVE A                 04460000
      *     ADVERTISED PROMOTION SECTION WHERE IT ALSO BREAKS           04470000
      *     EACH AD PAGE NUMBER.  IT MAY HAVE AN UNADVERTISED           04480000
      *     SECTION, AND IT MAY HAVE AN ADMIN TIERED PRICING            04490000
      *     SECTION.                                                    04500000
      *----------------------------------------------------------       04510000
       2000-PROCESS-SALES-RESULTS.                                      04520000
                                                                        04530000
           EVALUATE TRUE                                                04540000
             WHEN (PM100-AD-EVNT-ID IS NOT = PV-LAST-ADEVNT-ID)         04550000
               OR (PM100-PROMO-ID IS NOT = PV-LAST-PROMO-ID)            04560000
                  IF PS-NOT-FIRST-TIME                                  04570000
                     IF PS-ADMIN-TIER-TTL                               04580000
                        PERFORM 3140-PROCESS-ATIER-LVLS-TTL             04590000
                        PERFORM 3150-PROCESS-ADMIN-TIER-TTL             04600000
                        ADD 1             TO PA-CNT-ADMIN-TOT           04610000
                     ELSE                                               04620000
                        IF PS-UNADV-PROMO-TTL                           04630000
                           PERFORM 3130-PROCESS-UNADV-PROMO-TTL         04640000
                           ADD 1          TO PA-CNT-UNADV-TOT           04650000
                        ELSE                                            04660000
                           IF PS-ADV-PROMO-TTL                          04670000
                              PERFORM 3115-PROCESS-CUT-TTL              04670100
                              PERFORM 3110-PROCESS-PAGE-TTL             04671000
                              PERFORM 3120-PROCESS-ADV-PROMO-TTL        04672000
                              ADD 1       TO PA-CNT-ADV-TOT             04673000
PGNBR                      ELSE                                         04673104
PGNBR                         IF PS-ADV-NOPGE-TTL                       04673204
PGNBR                            PERFORM 3030-PROCESS-ADV-NOPGE-TTL     04673304
PGNBR                            ADD 1          TO PA-CNT-ADVNO-TOT     04673404
PGNBR                         END-IF                                    04673504
                           END-IF                                       04674000
                        END-IF                                          04675000
                     END-IF                                             04676000
                     SET PS-TOT-PROMO-TTL TO TRUE                       04677000
                     PERFORM 3100-SELECT-TOTAL-LINES                    04678000
                     PERFORM 2010-SET-TTL-PRINT-SW-OFF                  04679000
                     INITIALIZE TBL-SECT-TOTAL-TABLE                    04679100
                                TBL-SEQ-TOTAL-TABLE                     04679200
                                TBL-PROMO-TOTAL-TABLE                   04679300
                     SET PS-ADMIN-HEADER TO TRUE                        04679400
                  END-IF                                                04679500
                  PERFORM 2300-FORMAT-HEADING-FIELDS                    04679600
                  PERFORM 2100-ADEVNT-PROMO-HDR-BREAK                   04679700
                  PERFORM 2400-CREATE-HEADING-FIELDS                    04679800
                  PERFORM 3500-PROCESS-PAGE-HEADER                      04679900
                  PERFORM 3400-PROCESS-DETAIL-HEADER                    04680000
                  MOVE PM100-AD-EVNT-ID TO PV-LAST-ADEVNT-ID            04681000
                  MOVE PM100-PROMO-ID   TO PV-LAST-PROMO-ID             04690000
                  MOVE PM100-AD-PG-SEQ-NBR TO PV-AD-PG-SEQ-NBR          04691000
                  MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 04700000
                  SET PS-NOT-FIRST-TIME TO TRUE                         04710000
                  INITIALIZE PV-SAVE-ADMIN-ID                           04720000
PGNBR        WHEN PS-EOF-REC-TYPE-FLAG = 2                              04721015
                  PERFORM 3115-PROCESS-CUT-TTL                          04724010
                  PERFORM 3110-PROCESS-PAGE-TTL                         04725010
PGNBR             PERFORM 3120-PROCESS-ADV-PROMO-TTL                    04726012
PGNBR             ADD 1               TO PA-CNT-ADV-TOT                 04727012
PGNBR             INITIALIZE TBL-SECT-TOTAL-TABLE                       04728012
PGNBR             INITIALIZE TBL-SEQ-TOTAL-TABLE                        04729012
PGNBR             MOVE PM100-AD-PG-NBR TO PV-AD-PG-NBR                  04729112
PGNBR             MOVE PM100-AD-PG-SEQ-NBR TO PV-AD-PG-SEQ-NBR          04729212
PGNBR             PERFORM 3400-PROCESS-DETAIL-HEADER                    04729312
PGNBR        WHEN PS-EOF-REC-TYPE-FLAG = 1                              04729415
PGNBR             PERFORM 3030-PROCESS-ADV-NOPGE-TTL                    04729712
PGNBR             ADD 1               TO PA-CNT-ADVNO-TOT               04729812
                  INITIALIZE TBL-SECT-TOTAL-TABLE                       04729910
                  INITIALIZE TBL-SEQ-TOTAL-TABLE                        04730010
                  MOVE PM100-AD-PG-NBR TO PV-AD-PG-NBR                  04730112
                  MOVE PM100-AD-PG-SEQ-NBR TO PV-AD-PG-SEQ-NBR          04730210
                  PERFORM 3400-PROCESS-DETAIL-HEADER                    04730310
             WHEN (PM100-AD-PG-NBR IS NOT = PV-AD-PG-NBR)               04731000
PGNBR         AND (PM100-PROMO-ITM-ADV-IND = 'Y')                       04740012
                  PERFORM 3115-PROCESS-CUT-TTL                          04742000
                  PERFORM 3110-PROCESS-PAGE-TTL                         04750000
                  INITIALIZE TBL-SECT-TOTAL-TABLE                       04760000
                  INITIALIZE TBL-SEQ-TOTAL-TABLE                        04761000
                  MOVE PM100-AD-PG-NBR   TO PV-AD-PG-NBR                04770012
                  MOVE PM100-AD-PG-SEQ-NBR TO PV-AD-PG-SEQ-NBR          04771000
                  PERFORM 3400-PROCESS-DETAIL-HEADER                    04780000
             WHEN (PM100-PROMO-ITM-ADV-IND = 'A')                       04870000
              AND (PS-ADMIN-HEADER)                                     04880000
                  IF PS-UNADV-PROMO-TTL                                 04890000
                     PERFORM 3130-PROCESS-UNADV-PROMO-TTL               04900000
                     ADD 1              TO PA-CNT-UNADV-TOT             04901000
                  ELSE                                                  04902000
PGNBR                IF PS-ADV-PROMO-TTL                                04902112
                     PERFORM 3115-PROCESS-CUT-TTL                       04902200
                     PERFORM 3110-PROCESS-PAGE-TTL                      04903000
                     PERFORM 3120-PROCESS-ADV-PROMO-TTL                 04904000
                     ADD 1              TO PA-CNT-ADV-TOT               04905000
PGNBR                ELSE                                               04905112
PGNBR                   IF PS-ADV-NOPGE-TTL                             04905212
PGNBR                      PERFORM 3030-PROCESS-ADV-NOPGE-TTL           04905312
PGNBR                      ADD 1              TO PA-CNT-ADVNO-TOT       04905412
PGNBR                   END-IF                                          04905512
PGNBR                END-IF                                             04905612
                  END-IF                                                04906000
                  INITIALIZE TBL-SECT-TOTAL-TABLE                       04907000
                  INITIALIZE TBL-SEQ-TOTAL-TABLE                        04907100
                  SET PS-NO-ADMIN-HEADER TO TRUE                        04908000
                  PERFORM 3400-PROCESS-DETAIL-HEADER                    04909000
             WHEN (PM100-AD-PG-SEQ-NBR IS NOT = PV-AD-PG-SEQ-NBR)       04909100
                  PERFORM 3115-PROCESS-CUT-TTL                          04909300
                  INITIALIZE TBL-SEQ-TOTAL-TABLE                        04909400
                  MOVE PM100-AD-PG-SEQ-NBR TO PV-AD-PG-SEQ-NBR          04909500
           END-EVALUATE.                                                04910000
PGNBR                                                                   04910118
PGNBR      SET PS-NO-EOF-REC-TYPE TO TRUE.                              04910218
PGNBR                                                                   04911018
           PERFORM 2200-PROCESS-DETAIL.                                 04920000
                                                                        04930000
           PERFORM 8000-READ-SALES-RESULTS.                             04940000
                                                                        04950000
      *2000-EXIT.                                                       04960000
       EJECT.                                                           04970000
                                                                        04980000
      *----------------------------------------------------------       04990000
      * 2010-SET-TTL-PRINT-VARIABLES.                                   05000000
      *     SET ALL THE PRINT SWITCHES TO OFF.                          05010000
      *----------------------------------------------------------       05020000
       2010-SET-TTL-PRINT-SW-OFF.                                       05030000
                                                                        05040000
           SET PS-NO-PAGE-TTL         TO TRUE.                          05050000
           SET PS-NO-ADV-PROMO-TTL    TO TRUE.                          05060000
PGNBR      SET PS-NO-ADV-NOPGE-TTL    TO TRUE.                          05061006
           SET PS-NO-UNADV-PROMO-TTL  TO TRUE.                          05070000
           SET PS-NO-ADMIN-TIER-TTL   TO TRUE.                          05080000
           SET PS-NO-TOT-PROMO-TTL    TO TRUE.                          05090000
                                                                        05100000
           MOVE ZEROES                TO PA-CNT-ADV-TOT                 05110000
PGNBR                                    PA-CNT-ADVNO-TOT               05120006
                                         PA-CNT-UNADV-TOT               05121006
                                         PA-CNT-ADMIN-TOT.              05130000
                                                                        05140000
      *2010-EXIT.                                                       05150000
       EJECT.                                                           05160000
                                                                        05170000
      *----------------------------------------------------------       05180000
      * 2100-ADEVNT-PROMO-HDR-BREAK.                                    05190000
      *     WHEN AN ADEVENT ID/PROMO ID CHANGE, GIVE THE NEW            05200000
      *     START/END DATES.                                            05210000
      *----------------------------------------------------------       05220000
       2100-ADEVNT-PROMO-HDR-BREAK.                                     05230000
                                                                        05240000
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05250000
           SET DPG51-ACTUAL-CALENDAR-ONLY      TO TRUE.                 05260000
           SET DPG51-DO-NOT-INCR-DECR-DATE     TO TRUE.                 05270000
           SET DPG52-LK-DTE-ISO-FMT            TO TRUE.                 05280000
           MOVE PM100-PROMO-STRT-TMST          TO PV-PROMO-STRT-TMST.   05290000
           MOVE PM100-PROMO-END-TMST           TO PV-PROMO-END-TMST.    05300000
           MOVE PV-PROMO-STRT-DTE              TO DPG52-LK-DATE-INPUT.  05310000
           MOVE 'INVALID PROMO BEGINNING DATE' TO PV-OPERATION-MSG-1.   05311000
                                                                        05311100
           PERFORM 9100-CALENDAR-ROUTINE.                               05311200
                                                                        05311300
           MOVE DPG55-ALPHA-WEEK-DAY  TO PV-BEG-DAY-ALPHA.              05311400
           MOVE DPG55-GREG-DATE-FMT   TO PV-BEG-DATE.                   05311500
                                                                        05311600
           IF (PV-PM-STRT-TM-HH =                                       05311700
               PC-DEFAULT-BEG-HR AND                                    05311800
               PV-PM-STRT-TM-MM =                                       05311900
               PC-DEFAULT-BEG-MIN)                                      05312000
               IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  05313000
      * NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05314000
                  MOVE SPACES         TO PV-BEG-TIME                    05315000
                  MOVE PV-PM-STRT-TM-HH                                 05316000
                                      TO PV-BEG-HR-TIME                 05317000
                  MOVE PC-COLON       TO PV-BEG-TIME-COLON              05318000
                  MOVE PV-PM-STRT-TM-MM                                 05319000
                                      TO PV-BEG-MIN-TIME                05320000
               ELSE                                                     05330000
                  MOVE PC-ALL-DAY     TO PV-BEG-TIME                    05340000
               END-IF                                                   05350000
           ELSE                                                         05360000
      * NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05370000
              MOVE SPACES             TO PV-BEG-TIME                    05380000
              MOVE PV-PM-STRT-TM-HH                                     05390000
                                      TO PV-BEG-HR-TIME                 05400000
              MOVE PC-COLON           TO PV-BEG-TIME-COLON              05410000
              MOVE PV-PM-STRT-TM-MM                                     05420000
                                      TO PV-BEG-MIN-TIME                05430000
           END-IF.                                                      05440000
                                                                        05450000
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05460000
           SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    05470000
           SET DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                    05480000
           SET DPG52-LK-DTE-ISO-FMT         TO TRUE.                    05490000
           MOVE PV-PROMO-END-DTE            TO DPG52-LK-DATE-INPUT.     05500000
           MOVE 'INVALID PROMO ENDING DATE' TO PV-OPERATION-MSG-1.      05510000
                                                                        05520000
           PERFORM 9100-CALENDAR-ROUTINE.                               05530000
                                                                        05540000
           MOVE DPG55-ALPHA-WEEK-DAY  TO PV-END-DAY-ALPHA.              05550000
           MOVE DPG55-GREG-DATE-FMT   TO PV-END-DATE.                   05560000
                                                                        05570000
           IF (PV-PM-END-TM-HH =                                        05580000
               PC-DEFAULT-END-HR AND                                    05590000
               PV-PM-END-TM-MM =                                        05600000
               PC-DEFAULT-END-MIN)                                      05610000
               IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  05620000
      * NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05630000
                  MOVE SPACES         TO PV-END-TIME                    05640000
                  MOVE PV-PM-END-TM-HH                                  05650000
                                      TO PV-END-HR-TIME                 05660000
                  MOVE PC-COLON       TO PV-END-TIME-COLON              05670000
                  MOVE PV-PM-END-TM-MM                                  05680000
                                      TO PV-END-MIN-TIME                05690000
               ELSE                                                     05700000
                  MOVE PC-ALL-DAY     TO PV-END-TIME                    05710000
               END-IF                                                   05720000
            ELSE                                                        05730000
      * NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05740000
               MOVE SPACES            TO PV-END-TIME                    05750000
               MOVE PV-PM-END-TM-HH                                     05760000
                                      TO PV-END-HR-TIME                 05770000
               MOVE PC-COLON          TO PV-END-TIME-COLON              05780000
               MOVE PV-PM-END-TM-MM                                     05790000
                                      TO PV-END-MIN-TIME                05800000
           END-IF.                                                      05810000
                                                                        05820000
      *2100-EXIT.                                                       05830000
       EJECT.                                                           05840000
                                                                        05850000
      *----------------------------------------------------------       05860000
      * 2200-PROCESS-DETAIL.                                            05870000
      *     PROCESS REPORT DETAIL LINES.                                05880000
      *----------------------------------------------------------       05890000
       2200-PROCESS-DETAIL.                                             05900000
                                                                        05910000
           MOVE SPACES                TO DETAIL-01                      05920000
                                         DETAIL-02                      05930000
                                         DETAIL-VARIABLE.               05940000
                                                                        05950000
      *** WHEN THE RECORD IS ADMIN TIERED OR TIERED PRICING             05960000
      *** SET UP THE DETAIL LINES DIFFERENTLY.                          05970000
           IF PM100-ADMN-TIER-PRICG OR PM100-TIER-PRICG                 05980000
              PERFORM 2210-CREATE-TIER-DESC                             05990000
              MOVE PV-TIER-ITM-DESC   TO DTL-01-PMITEM-DESC             06000000
              IF PM100-TIER-PRICG-ID NOT = PV-TIER-PRICG-ID             06010000
                 AND PM100-ADMN-TIER-PRICG                              06020000
                 MOVE SPACES                  TO DETAIL-HEADER-02       06021000
                 IF PV-SAVE-ADMIN-ID NOT = 0                            06022000
                    PERFORM 3140-PROCESS-ATIER-LVLS-TTL                 06023000
                 END-IF                                                 06024000
                 INITIALIZE PV-ADMIN-TIER-TOTALS                        06025000
                 MOVE PM100-TIER-PRICG-ID  TO PV-SAVE-ADMIN-ID          06026000
                 MOVE PM100-PROMO-ITM-DESC TO DTL-HDR-02-PM-ITM-DESC    06027000
                 MOVE 2                    TO PV-ADVANCE-LINES          06028000
                                              PV-SAVE-LINE-AMT          06029000
                 ADD PV-ADVANCE-LINES      TO PV-LINE-CNT               06030000
                 PERFORM 3200-CHECK-MAX-LINE-CNT                        06040000
                 MOVE DETAIL-HEADER-02     TO PV-RPT-LINE               06050000
                 PERFORM 8200-WRITE-RPT-LINE                            06060000
                 MOVE PM100-TIER-PRICG-ID  TO PV-TIER-PRICG-ID          06070000
              END-IF                                                    06080000
      *** KEEP A RUNNING TOTAL OF ALL LEVELS OF ONE ADMIN               06090000
      *** TIERED GROUP.                                                 06091000
              IF PM100-ADMN-TIER-PRICG                                  06092000
                 ADD PM100-ACTL-SLS-RTL-AMT  TO PV-TTL-SLS-RTL-AMT      06093000
                 ADD PM100-ACTL-MKDN-RTL-AMT TO PV-TTL-MKDN-RTL-AMT     06094000
                 ADD PM100-ACTL-SLS-UNT-QTY  TO PV-TTL-SLS-UNT-QTY      06095000
                 ADD PM100-ACTL-SLS-COST-AMT TO PV-TTL-SLS-COST-AMT     06096000
              END-IF                                                    06097000
           ELSE                                                         06098000
              MOVE PM100-PROMO-ITM-DESC   TO DTL-01-PMITEM-DESC         06099000
           END-IF.                                                      06110000
                                                                        06111000
      *** THIS IS PROCESSED FOR ACTUAL REPORTS ONLY.                    06112000
           IF PM100-ACTUAL                                              06113000
              MOVE PM100-ACTL-SLS-RTL-AMT  TO DTL-01-ACTL-SLS-RTL-AMT   06115000
              MOVE PM100-ACTL-SLS-UNT-QTY  TO DTL-01-ACTL-UNT-SLD-QTY   06120000
                                                                        06131000
              IF PM100-SMPL-PRICG OR PM100-ADMN-TIER-PRICG              06140000
                 ADD PM100-ACTL-SLS-RTL-AMT  TO                         06150000
                                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)     06160000
                                    TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-1)   06161000
                                    TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)    06170000
                 ADD PM100-ACTL-MKDN-RTL-AMT TO                         06180000
                                    TBL-STOT-TOT-MD-AMT(PC-SUB-1)       06190000
                                    TBL-SEQTOT-TOT-MD-AMT(PC-SUB-1)     06191000
                                    TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)      06200000
                 ADD PM100-ACTL-SLS-UNT-QTY  TO                         06210000
                                    TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)  06220000
                                    TBL-SEQTOT-TOT-SLS-UNT-QTY(PC-SUB-1)06220100
                                    TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) 06221000
                 ADD PM100-ACTL-SLS-COST-AMT TO                         06222000
                                   TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)  06223000
                                   TBL-SEQTOT-TOT-SLS-COST-AMT(PC-SUB-1)06223100
                                   TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1) 06224000
              END-IF                                                    06225000
      *** THIS IS PROCESSED FOR ACTUAL SIMPLE PRICING RECORDS           06230000
      *** ONLY.                                                         06240000
              IF PM100-SMPL-PRICG                                       06250000
                 IF PM100-PROMO-REG-TYP-CDE = 'U '                      06260000
                    PERFORM 2220-FORMAT-PROMO-ITM-DTES                  06270000
                    MOVE PV-PM-ITM-EFF-STRT-DTE TO PV-EFF-STRT-DTE      06280000
                    MOVE PV-PM-ITM-EFF-END-DTE  TO PV-EFF-END-DTE       06290000
                    MOVE PC-DASH                TO PV-DTE-DASH          06300000
                    MOVE PC-FRONT-PAR           TO PV-OPEN-PARENTH      06310000
                    MOVE PC-BACK-PAR            TO PV-CLOSE-PARENTH     06320000
                    MOVE PV-EFF-DTE-LAYOUT      TO DTL-02-EFF-DTES      06330000
                 END-IF                                                 06340000
                 ADD PM100-ACTL-EOH-INV-QTY TO                          06350000
                                    TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1)  06360000
                                    TBL-SEQTOT-TOT-EOH-INV-QTY(PC-SUB-1)06361000
                                    TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) 06370000
                                                                        06371000
                 MOVE PM100-ACTL-PREP-UNT-QTY                           06390000
                                          TO DTL-01-ACTL-PREP-UNT-QTY   06400000
                 ADD PM100-ACTL-PREP-UNT-QTY TO                         06420000
                                      TBL-STOT-PREP-UNT-QTY(PC-SUB-1)   06430000
                                      TBL-SEQTOT-PREP-UNT-QTY(PC-SUB-1) 06431000
                                      TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)  06440000
                                                                        06441000
                 MOVE ZEROES              TO PV-ROUND-TO-TENTHS         06450000
                 ADD PM100-ACTL-TOT-MKUP-PCT                            06460000
                                          TO PV-ROUND-TO-TENTHS ROUNDED 06470000
                 MOVE PV-ROUND-TO-TENTHS  TO DTL-01-ACTL-MU-PCT         06480000
                 MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       06481000
                                                                        06490000
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          06550000
                 ADD PM100-SELL-THRU-PCT TO PV-ROUND-TO-TENTHS ROUNDED  06560000
                 MOVE PV-ROUND-TO-TENTHS TO DTL-01-SELL-THRU-PCT        06570000
                 MOVE PC-PERCENT-SIGN    TO DTL-O1-SELL-PCT-SIGN        06571000
              END-IF                                                    06715500
           END-IF.                                                      06715600
                                                                        06715700
      *** THIS IS PROCESSED FOR ALL SIMPLE PRICING RECORD IN            06715800
      *** ACTUAL AND FORECAST REPORTS.                                  06715900
           IF PM100-SMPL-PRICG                                          06716000
              MOVE PM100-FCST-SLS-RTL-AMT TO DTL-01-FCST-SLS-RTL-AMT    06718000
              ADD PM100-FCST-SLS-RTL-AMT  TO                            06720000
                                    TBL-STOT-TOT-SALE-AMT(PC-SUB-2)     06730000
                                    TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-2)   06731000
                                    TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)    06740000
              ADD PM100-FCST-MKDN-RTL-AMT TO                            06780000
                                    TBL-STOT-TOT-MD-AMT(PC-SUB-2)       06790000
                                    TBL-SEQTOT-TOT-MD-AMT(PC-SUB-2)     06791000
                                    TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)      06800000
                                                                        06801000
              MOVE PM100-FCST-SLS-UNT-QTY TO DTL-01-FCST-UNT-SLD-QTY    06820000
              ADD PM100-FCST-SLS-UNT-QTY  TO                            06840000
                                    TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)  06850000
                                    TBL-SEQTOT-TOT-SLS-UNT-QTY(PC-SUB-2)06851000
                                    TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2) 06860000
                                                                        06861000
              MOVE PM100-FCST-PROJD-UNT-QTY                             06880000
                                           TO DTL-01-FCST-PREP-UNT-QTY  06890000
              ADD PM100-FCST-PROJD-UNT-QTY TO                           06910000
                                    TBL-STOT-PREP-UNT-QTY(PC-SUB-2)     06920000
                                    TBL-SEQTOT-PREP-UNT-QTY(PC-SUB-2)   06921000
                                    TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)    06930000
              ADD PM100-FCST-SLS-COST-AMT TO                            06970000
                                   TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)  06980000
                                   TBL-SEQTOT-TOT-SLS-COST-AMT(PC-SUB-2)06981000
                                   TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2) 06990000
                                                                        07000000
              IF PM100-FCST-SLS-RTL-AMT = ZEROES                        07001000
                 CONTINUE                                               07002000
              ELSE                                                      07003000
                 MOVE ZEROES                 TO PV-ROUND-TO-TENTHS      07010000
                 ADD PM100-FCST-TOT-MKUP-PCT TO                         07020000
                                  PV-ROUND-TO-TENTHS ROUNDED            07021000
                 MOVE PV-ROUND-TO-TENTHS     TO DTL-01-FCST-MU-PCT      07030000
                 MOVE PC-PERCENT-SIGN        TO DTL-01-FCST-PCT-SIGN    07031000
              END-IF                                                    07090000
           END-IF.                                                      07100000
           MOVE PM100-DMA-LAST-NM     TO DTL-01-DMM-LAST-NM.            07101000
                                                                        07110000
           MOVE 1                     TO PV-ADVANCE-LINES               07120000
                                         PV-SAVE-LINE-AMT.              07130000
           ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   07140000
           PERFORM 3200-CHECK-MAX-LINE-CNT.                             07150000
           MOVE DETAIL-01             TO PV-RPT-LINE.                   07160000
           PERFORM 8200-WRITE-RPT-LINE.                                 07170000
                                                                        07171000
           IF PM100-PROMO-REG-TYP-CDE = 'U '                            07172000
              MOVE 1                     TO PV-ADVANCE-LINES            07173000
              ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 07174000
              MOVE DETAIL-02             TO PV-RPT-LINE                 07175000
              PERFORM 8200-WRITE-RPT-LINE                               07176000
           END-IF.                                                      07177000
                                                                        07178000
           IF PM100-AD-VERSION(PC-SUB-1) NOT = SPACES                   07178100
              MOVE SPACES TO PV-VERSION-AD                              07178200
              PERFORM 2230-CREATE-VERSION-DATA                          07178300
              MOVE 1                     TO PV-ADVANCE-LINES            07178400
              ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 07178500
              MOVE DETAIL-02             TO PV-RPT-LINE                 07178600
              PERFORM 8200-WRITE-RPT-LINE                               07178700
           END-IF.                                                      07178800
                                                                        07178900
      *2200-EXIT.                                                       07179000
       EJECT.                                                           07180000
                                                                        07190000
      *----------------------------------------------------------       07200000
      * 2210-CREATE-TIER-DESC.                                          07210000
      *     CREATE THE PROMO ITEM DESCRIPTION FIELD FOR TIERED          07220000
      *     AND ADMIN TIERED RECORDS.                                   07230000
      *----------------------------------------------------------       07240000
       2210-CREATE-TIER-DESC.                                           07250000
                                                                        07260000
           INITIALIZE PA-CNT-POS-1                                      07270000
                      PA-CNT-POS-2                                      07280000
                      PA-CNT-SPACES-1                                   07290000
                      PA-CNT-SPACES-2                                   07300000
                      PV-TIER-ITM-DESC.                                 07310000
                                                                        07320000
           EVALUATE TRUE                                                07330000
               WHEN PM100-TIER-PRICG-TYP-CDE = 'TAP'                    07340000
                    MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         07350000
                    MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        07360000
                    MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        07370000
                    INSPECT PV-THRS-AMT-CHAR REPLACING                  07380000
                            LEADING ZERO BY " "                         07390000
                    INSPECT PV-THRS-AMT-CHAR                            07400000
                           TALLYING PA-CNT-SPACES-1 FOR ALL " "         07410000
                    COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          07420000
                    ADD +1 TO PA-CNT-SPACES-1                           07430000
                    MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         07440000
                    MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        07450000
                    MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        07460000
                    INSPECT PV-DISC-PCT-CHAR REPLACING                  07470000
                            LEADING ZERO BY " "                         07480000
                    INSPECT PV-DISC-PCT-CHAR                            07490000
                           TALLYING PA-CNT-SPACES-2 FOR ALL " "         07500000
                    COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          07510000
                    ADD +1 TO PA-CNT-SPACES-2                           07520000
                    MOVE +1 TO PV-POINTER-FIELD                         07530000
                    STRING PC-CHAR-BUY DELIMITED BY " "                 07540000
                           " " DELIMITED BY SIZE                        07550000
                           PC-DOLLAR-SIGN DELIMITED BY " "              07560000
                           PV-THRS-AMT-CHAR                             07570000
                               (PA-CNT-SPACES-1:PA-CNT-POS-1)           07580000
                           "," DELIMITED BY SIZE                        07590000
                           " " DELIMITED BY SIZE                        07600000
                           PC-CHAR-GET DELIMITED BY " "                 07610000
                           " " DELIMITED BY SIZE                        07620000
                           PV-DISC-PCT-CHAR                             07630000
                               (PA-CNT-SPACES-2:PA-CNT-POS-2)           07640000
                           PC-PERCENT-SIGN DELIMITED BY " "             07650000
                           " " DELIMITED BY SIZE                        07660000
                           PC-CHAR-OFF DELIMITED BY " "                 07670000
                    INTO PV-TIER-ITM-DESC-1                             07680000
                    WITH POINTER PV-POINTER-FIELD                       07690000
               WHEN PM100-TIER-PRICG-TYP-CDE = 'TQP'                    07700000
                    MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        07710000
                    INSPECT PV-THRS-QTY-CHAR REPLACING                  07720000
                            LEADING ZERO BY " "                         07730000
                    INSPECT PV-THRS-QTY-CHAR                            07740000
                           TALLYING PA-CNT-SPACES-1 FOR ALL " "         07750000
                    COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          07760000
                    ADD +1 TO PA-CNT-SPACES-1                           07770000
                    MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         07780000
                    MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        07790000
                    MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        07800000
                    INSPECT PV-DISC-PCT-CHAR REPLACING                  07810000
                            LEADING ZERO BY " "                         07820000
                    INSPECT PV-DISC-PCT-CHAR                            07830000
                           TALLYING PA-CNT-SPACES-2 FOR ALL " "         07840000
                    COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          07850000
                    ADD +1 TO PA-CNT-SPACES-2                           07860000
                    MOVE +1 TO PV-POINTER-FIELD                         07870000
                    STRING PC-CHAR-BUY DELIMITED BY " "                 07880000
                           " " DELIMITED BY SIZE                        07890000
                           PV-THRS-QTY-CHAR                             07900000
                               (PA-CNT-SPACES-1:PA-CNT-POS-1)           07910000
                           "," DELIMITED BY SIZE                        07920000
                           " " DELIMITED BY SIZE                        07930000
                           PC-CHAR-GET DELIMITED BY " "                 07940000
                           " " DELIMITED BY SIZE                        07950000
                           PV-DISC-PCT-CHAR                             07960000
                               (PA-CNT-SPACES-2:PA-CNT-POS-2)           07970000
                           PC-PERCENT-SIGN DELIMITED BY " "             07980000
                           " " DELIMITED BY SIZE                        07990000
                           PC-CHAR-OFF DELIMITED BY " "                 07991000
                    INTO PV-TIER-ITM-DESC-1                             07992000
                    WITH POINTER PV-POINTER-FIELD                       07993000
               WHEN PM100-TIER-PRICG-TYP-CDE = 'TQA'                    07994000
                    MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        07995000
                    INSPECT PV-THRS-QTY-CHAR REPLACING                  07996000
                            LEADING ZERO BY " "                         07997000
                    INSPECT PV-THRS-QTY-CHAR                            07998000
                           TALLYING PA-CNT-SPACES-1 FOR ALL " "         07998100
                    COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          07998200
                    ADD +1 TO PA-CNT-SPACES-1                           07998300
                    MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         07998400
                    MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        07998500
                    MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        07998600
                    INSPECT PV-DISC-AMT-CHAR REPLACING                  07998700
                            LEADING ZERO BY " "                         07998800
                    INSPECT PV-DISC-AMT-CHAR                            07998900
                           TALLYING PA-CNT-SPACES-2 FOR ALL " "         07999000
                    COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          08000000
                    ADD +1 TO PA-CNT-SPACES-2                           08000100
                    MOVE +1 TO PV-POINTER-FIELD                         08000200
                    STRING PC-CHAR-BUY DELIMITED BY " "                 08000300
                           " " DELIMITED BY SIZE                        08000400
                           PV-THRS-QTY-CHAR                             08000500
                               (PA-CNT-SPACES-1:PA-CNT-POS-1)           08000600
                           "," DELIMITED BY SIZE                        08000700
                           " " DELIMITED BY SIZE                        08000800
                           PC-CHAR-GET DELIMITED BY " "                 08000900
                           " " DELIMITED BY SIZE                        08001000
                           PC-DOLLAR-SIGN DELIMITED BY " "              08001100
                           PV-DISC-AMT-CHAR                             08001200
                               (PA-CNT-SPACES-2:PA-CNT-POS-2)           08001300
                           " " DELIMITED BY SIZE                        08001400
                           PC-CHAR-OFF DELIMITED BY " "                 08001500
                    INTO PV-TIER-ITM-DESC-1                             08001600
                    WITH POINTER PV-POINTER-FIELD                       08001700
               WHEN PM100-TIER-PRICG-TYP-CDE = 'TAA'                    08001800
                    MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         08001900
                    MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        08002000
                    MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        08002100
                    INSPECT PV-THRS-AMT-CHAR REPLACING                  08002200
                            LEADING ZERO BY " "                         08002300
                    INSPECT PV-THRS-AMT-CHAR                            08002400
                           TALLYING PA-CNT-SPACES-1 FOR ALL " "         08002500
                    COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          08002600
                    ADD +1 TO PA-CNT-SPACES-1                           08002700
                    MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         08002800
                    MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        08002900
                    MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        08003000
                    INSPECT PV-DISC-AMT-CHAR REPLACING                  08003100
                            LEADING ZERO BY " "                         08003200
                    INSPECT PV-DISC-AMT-CHAR                            08003300
                           TALLYING PA-CNT-SPACES-2 FOR ALL " "         08003400
                    COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          08003500
                    ADD +1 TO PA-CNT-SPACES-2                           08003600
                    MOVE +1 TO PV-POINTER-FIELD                         08003700
                    STRING PC-CHAR-BUY DELIMITED BY " "                 08003800
                           " " DELIMITED BY SIZE                        08003900
                           PC-DOLLAR-SIGN DELIMITED BY " "              08004000
                           PV-THRS-AMT-CHAR                             08004100
                               (PA-CNT-SPACES-1:PA-CNT-POS-1)           08004200
                           "," DELIMITED BY SIZE                        08004300
                           " " DELIMITED BY SIZE                        08004400
                           PC-CHAR-GET DELIMITED BY " "                 08004500
                           " " DELIMITED BY SIZE                        08004600
                           PC-DOLLAR-SIGN DELIMITED BY " "              08004700
                           PV-DISC-AMT-CHAR                             08004800
                               (PA-CNT-SPACES-2:PA-CNT-POS-2)           08004900
                           " " DELIMITED BY SIZE                        08005000
                           PC-CHAR-OFF DELIMITED BY " "                 08005100
                    INTO PV-TIER-ITM-DESC-1                             08005200
                    WITH POINTER PV-POINTER-FIELD                       08005300
           END-EVALUATE.                                                08005400
                                                                        08005500
      *2210-EXIT.                                                       08005600
       EJECT.                                                           08005700
                                                                        08005800
      *----------------------------------------------------------       08005900
      * 2220-FORMAT-PROMO-ITM-DTES.                                     08006000
      *     IF THE PROMO ITEM IS ATTACHED TO AN UNADVERTISED            08006100
      *     PROMOTION, THE PROMO ITEM EFFECTIVE DATES NEED              08006200
      *     TO BE INCLUDED IN THE REPORTS.                              08006300
      *----------------------------------------------------------       08006400
       2220-FORMAT-PROMO-ITM-DTES.                                      08006500
                                                                        08006600
           MOVE PM100-PROMO-ITM-STRT-TMST TO PV-PROMO-ITM-STRT-TMST.    08006700
           MOVE PM100-PROMO-ITM-END-TMST  TO PV-PROMO-ITM-END-TMST.     08006800
           MOVE PV-PI-STRT-DTE-YY         TO PV-EFF-STRT-DTE-YY.        08006900
           MOVE PV-PI-STRT-DTE-MM         TO PV-EFF-STRT-DTE-MM.        08007000
           MOVE PV-PI-STRT-DTE-DD         TO PV-EFF-STRT-DTE-DD.        08007100
           MOVE PV-PI-END-DTE-YY          TO PV-EFF-END-DTE-YY.         08007200
           MOVE PV-PI-END-DTE-MM          TO PV-EFF-END-DTE-MM.         08007300
           MOVE PV-PI-END-DTE-DD          TO PV-EFF-END-DTE-DD.         08007400
                                                                        08007500
      *2220-EXIT.                                                       08007600
       EJECT.                                                           08007700
                                                                        08007800
      *----------------------------------------------------------       08007900
      * 2230-CREATE-VERSION-DATA.                                       08008000
      *     CREATE THE VERSION DATA IF THE PROMO ITEM HAS SPECIFIC      08008100
      *     VERSIONS THAT IT IS IN.                                     08008200
      *----------------------------------------------------------       08008300
       2230-CREATE-VERSION-DATA.                                        08008400
                                                                        08008500
           INITIALIZE PV-CHAR-LENGTH.                                   08008600
           MOVE +1 TO PV-POINTER-FIELD.                                 08008700
           PERFORM                                                      08008800
             VARYING PV-VAR-IDX FROM 1 BY 1                             08008900
               UNTIL PM100-AD-VERSION(PV-VAR-IDX) = SPACES              08009000
                  OR PV-VAR-IDX > 15                                    08009100
                    STRING PM100-AD-VERSION(PV-VAR-IDX) DELIMITED BY " "08009200
                    "," DELIMITED BY SIZE                               08009300
                    " " DELIMITED BY SIZE                               08009400
                INTO PV-VERSION-AD                                      08009500
                WITH POINTER PV-POINTER-FIELD                           08009600
           END-PERFORM.                                                 08009700
                                                                        08009800
           MOVE PC-FRONT-PAR          TO PV-PARENTHESES.                08009900
           MOVE PV-VERSION-AD         TO PV-SAVE-VAR.                   08010000
           MOVE 61                    TO PV-SAVE-NUM.                   08010100
           PERFORM 2310-COUNT-FIELD-LENGTH.                             08010200
           MOVE PV-SAVE-LENGTH        TO PV-CHAR-LENGTH.                08010300
                                                                        08010400
           MOVE PC-BACK-PAR          TO PV-VERSION-AD(PV-CHAR-LENGTH:1).08010500
           MOVE PV-VER-AD-VARIABLE   TO DTL-01-VERSION-AD.              08010600
                                                                        08010700
      *2230-EXIT.                                                       08010800
       EJECT.                                                           08010900
                                                                        08011000
      *----------------------------------------------------------       08011100
      * 2300-FORMAT-HEADING-FIELDS.                                     08011200
      *     FORMAT THE AD EVENT TITLES AND THE PROMOTION TITLES.        08011300
      *----------------------------------------------------------       08012000
       2300-FORMAT-HEADING-FIELDS.                                      08020000
                                                                        08021000
           MOVE PM100-AD-EVNT-NBR-TXT TO PV-SAVE-VAR.                   08022000
           MOVE 16                    TO PV-SAVE-NUM.                   08023000
           PERFORM 2310-COUNT-FIELD-LENGTH.                             08023100
           MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NBR-LENGTH.         08023200
                                                                        08023300
           MOVE PM100-AD-EVNT-NM      TO PV-SAVE-VAR.                   08023400
           MOVE 41                    TO PV-SAVE-NUM.                   08023500
           PERFORM 2310-COUNT-FIELD-LENGTH.                             08023600
           MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NM-LENGTH.          08023700
                                                                        08023800
           MOVE PM100-PROMO-NM        TO PV-SAVE-VAR.                   08023900
           MOVE 41                    TO PV-SAVE-NUM.                   08024000
           PERFORM 2310-COUNT-FIELD-LENGTH.                             08025000
           MOVE PV-SAVE-LENGTH        TO PV-PROMO-NM-LENGTH.            08025100
                                                                        08025200
      *2300-EXIT.                                                       08025300
       EJECT.                                                           08025400
                                                                        08025500
      *----------------------------------------------------------       08025600
      * 2310-COUNT-FIELD-LENGTH.                                        08025700
      *     COUNTS THE ACTUAL FIELD'S LENGTH.                           08025800
      *----------------------------------------------------------       08025900
       2310-COUNT-FIELD-LENGTH.                                         08026000
                                                                        08026100
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         08026200
           MOVE PV-SAVE-VAR    TO PV-VARIABLE-OUTPUT-FIELD.             08026300
                                                                        08026400
           MOVE PV-SAVE-NUM TO PV-SUBSCRIPT.                            08026500
                                                                        08026600
           PERFORM                                                      08026700
              VARYING PV-BIT-IDX FROM PV-SAVE-NUM BY -1                 08026800
              UNTIL PV-BIT-VARIABLE(PV-BIT-IDX) NOT = SPACES            08026900
                     OR PV-BIT-IDX = 1                                  08027000
              SUBTRACT 1 FROM PV-SUBSCRIPT                              08027100
           END-PERFORM.                                                 08027200
                                                                        08027300
           MOVE PV-SUBSCRIPT TO PV-SAVE-LENGTH.                         08027400
                                                                        08027500
      *2310-EXIT.                                                       08027600
       EJECT.                                                           08027700
                                                                        08027800
      *----------------------------------------------------------       08027900
      * 2400-CREATE-HEADING-FIELDS.                                     08028000
      *     CREATE THE AD EVENT AND THE PROMO HEADINGS.                 08028100
      *----------------------------------------------------------       08028200
       2400-CREATE-HEADING-FIELDS.                                      08028300
                                                                        08028400
           MOVE SPACES          TO HDR-02-ADEVNT-STRING                 08028500
                                   HDR-03-PROMO-STRING.                 08028600
                                                                        08028700
           MOVE +1 TO PV-POINTER-FIELD.                                 08028800
           STRING PM100-AD-EVNT-NBR-TXT(1:PV-AD-EVNT-NBR-LENGTH)        08028900
                  " " DELIMITED BY SIZE                                 08029000
                  PM100-AD-EVNT-NM(1:PV-AD-EVNT-NM-LENGTH)              08029100
                  " " DELIMITED BY SIZE                                 08029200
             INTO HDR-02-ADEVNT-STRING                                  08029300
             WITH POINTER PV-POINTER-FIELD.                             08029400
                                                                        08029500
           MOVE +1 TO PV-POINTER-FIELD.                                 08029600
           STRING PM100-PROMO-NM(1:PV-PROMO-NM-LENGTH)                  08029700
                  " " DELIMITED BY SIZE                                 08029800
                  " " DELIMITED BY SIZE                                 08029900
                  " " DELIMITED BY SIZE                                 08030000
                  PC-CHAR-EFFECTIVE DELIMITED BY " "                    08030100
                  ":" DELIMITED BY SIZE                                 08030200
                  " " DELIMITED BY SIZE                                 08030300
                  PV-HEADER-DTE-TM(1:87)                                08031000
                  " " DELIMITED BY SIZE                                 08031100
             INTO HDR-03-PROMO-STRING                                   08031200
             WITH POINTER PV-POINTER-FIELD.                             08031300
                                                                        08031400
      *2400-EXIT.                                                       08031500
       EJECT.                                                           08031600
                                                                        08031700
      *----------------------------------------------------------       08031800
      * 3000-END-OF-JOB-ROUTINE.                                        08031900
      *     PERFORMS THE FINAL PROCESSING OF THE PROGRAM.               08032000
      *     WRITES OUT THE CLOSING LINES OF THE REPORT, CLOSES          08032100
      *     ANY FILES, AND DISPLAYS ANY NECESSARY STATISTICS.           08032200
      *----------------------------------------------------------       08032300
       3000-END-OF-JOB-ROUTINE.                                         08032400
                                                                        08032500
      *** WRITE OUT THE LAST SECTION'S TOTAL                            08032600
           IF PS-NOT-FIRST-TIME                                         08032700
              IF PS-ADMIN-TIER-TTL                                      08032800
                 PERFORM 3140-PROCESS-ATIER-LVLS-TTL                    08032900
                 PERFORM 3150-PROCESS-ADMIN-TIER-TTL                    08033000
                 ADD 1           TO PA-CNT-ADMIN-TOT                    08033100
              ELSE                                                      08034000
                 IF PS-UNADV-PROMO-TTL                                  08035000
                    PERFORM 3130-PROCESS-UNADV-PROMO-TTL                08036000
                    ADD 1        TO PA-CNT-UNADV-TOT                    08036100
                 ELSE                                                   08036200
                    IF PS-ADV-PROMO-TTL                                 08036300
                       PERFORM 3110-PROCESS-PAGE-TTL                    08036400
                       PERFORM 3120-PROCESS-ADV-PROMO-TTL               08036500
                       ADD 1     TO PA-CNT-ADV-TOT                      08036600
PGNBR               ELSE                                                08036704
PGNBR                  IF PS-ADV-NOPGE-TTL                              08036804
PGNBR                     PERFORM 3030-PROCESS-ADV-NOPGE-TTL            08036904
PGNBR                     ADD 1          TO PA-CNT-ADVNO-TOT            08037004
PGNBR                  END-IF                                           08037104
                    END-IF                                              08037200
                 END-IF                                                 08037300
              END-IF                                                    08037400
              SET PS-TOT-PROMO-TTL TO TRUE                              08038000
              PERFORM 3100-SELECT-TOTAL-LINES                           08039000
                                                                        08040000
              MOVE 2                     TO PV-ADVANCE-LINES            08050000
                                            PV-SAVE-LINE-AMT            08060000
              ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 08061000
              PERFORM 3200-CHECK-MAX-LINE-CNT                           08062000
              MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                 08063000
              PERFORM 8200-WRITE-RPT-LINE                               08064000
           END-IF.                                                      08064100
                                                                        08065000
           CLOSE PROMO-ITM-SUMM-FILE                                    08066000
                 PROMO-ITM-SUMM-REPORT.                                 08067000
                                                                        08068000
      *3000-EXIT.                                                       08069000
       EJECT.                                                           08070000
                                                                        08080000
      *----------------------------------------------------------       08090000
      * 3100-SELECT-TOTAL-LINES.                                        08100000
      *     SELECTS WHICH TOTAL LINES TO PROCESS IN THE REPORT.         08110000
      *----------------------------------------------------------       08120000
       3100-SELECT-TOTAL-LINES.                                         08130000
                                                                        08140000
           SET PS-BLANK-LINE       TO TRUE.                             08150000
           MOVE 1                  TO PV-ADVANCE-LINES.                 08160000
           ADD  PV-ADVANCE-LINES   TO PV-LINE-CNT.                      08170000
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         08180000
           MOVE SPACES             TO PV-RPT-LINE.                      08190000
           PERFORM 8200-WRITE-RPT-LINE.                                 08200000
           SET PS-NO-BLANK-LINE    TO TRUE.                             08210000
                                                                        08220000
           IF PS-ADV-PROMO-TTL                                          08230000
              PERFORM 3120-PROCESS-ADV-PROMO-TTL                        08240000
PGNBR      END-IF.                                                      08250012
PGNBR                                                                   08251012
PGNBR      IF PS-ADV-NOPGE-TTL                                          08252012
PGNBR         PERFORM 3030-PROCESS-ADV-NOPGE-TTL                        08253012
           END-IF.                                                      08254004
                                                                        08260000
           IF PS-UNADV-PROMO-TTL                                        08270000
              PERFORM 3130-PROCESS-UNADV-PROMO-TTL                      08280000
           END-IF.                                                      08290000
                                                                        08300000
           IF PS-ADMIN-TIER-TTL                                         08310000
              PERFORM 3150-PROCESS-ADMIN-TIER-TTL                       08320000
           END-IF.                                                      08330000
                                                                        08340000
           IF PS-TOT-PROMO-TTL                                          08350000
              PERFORM 3160-PROCESS-PROMOTION-TTL                        08360000
           END-IF.                                                      08370000
                                                                        08380000
      *3100-EXIT.                                                       08390000
       EJECT.                                                           08400000
                                                                        08410000
      *----------------------------------------------------------       08420000
      * 3110-PROCESS-PAGE-TTL.                                          08430000
      *     PROCESS THE PAGE/SECTION TOTAL OF THE REPORT.               08440000
      *----------------------------------------------------------       08450000
       3110-PROCESS-PAGE-TTL.                                           08460000
                                                                        08470000
           MOVE SPACES                TO DETAIL-PMPG-TOTALS             08480000
                                         DETAIL-VARIABLE.               08490000
                                                                        08500000
           MOVE PC-TOTAL-FOR-PAGE     TO DTL-PG-PAGE-TITLE.             08510000
           MOVE PV-AD-PG-NBR          TO DTL-PG-PAGE-NBR.               08520000
                                                                        08530000
      *** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                08540000
           IF PM100-ACTUAL                                              08550000
              MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      08570000
                                      TO DTL-PMPG-ACTL-TOT-SLS-AMT      08580000
                                                                        08600000
              COMPUTE PV-SELL-THRU-PCT ROUNDED =                        08640000
                      (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             08650000
                      (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             08660000
                       TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       08670000
                       ON SIZE ERROR                                    08680000
                       MOVE 0 TO PV-SELL-THRU-PCT                       08690000
              END-COMPUTE                                               08700000
              MOVE ZEROES                TO PV-ROUND-TO-TENTHS          08940000
              ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  08950000
              MOVE PV-ROUND-TO-TENTHS    TO DTL-PMPG-TOT-SELL-THRU-PCT  08960000
              MOVE PC-PERCENT-SIGN       TO DTL-PMPG-SELL-PCT-SIGN      08961000
                                                                        09020000
              MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   09053000
                                         TO DTL-PMPG-TOT-ACTL-UNT-QTY   09054000
                                                                        09055100
              MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      09057000
                                         TO DTL-PMPG-TOT-ACTL-PREP-QTY  09058000
              IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               09110000
                 MOVE ZEROES             TO PV-MU-PCT                   09121000
                 MOVE PV-MU-PCT          TO DTL-PMPG-TOT-ACTL-MU-PCT    09122000
                 MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      09123000
              ELSE                                                      09130000
                 COMPUTE PV-MU-PCT ROUNDED =                            09140000
                         ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            09150000
                          TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         09160000
                          TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        09170000
                          ON SIZE ERROR                                 09180000
                          MOVE 0 TO PV-MU-PCT                           09190000
                 END-COMPUTE                                            09200000
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          09210000
                 ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  09220000
                 MOVE PV-ROUND-TO-TENTHS TO DTL-PMPG-TOT-ACTL-MU-PCT    09230000
                 MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      09231000
              END-IF                                                    09290000
           END-IF.                                                      09300000
                                                                        09310000
      *** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            09320000
           MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         09340000
                                      TO DTL-PMPG-FCST-TOT-SLS-AMT.     09350000
                                                                        09370000
           MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      09420000
                                      TO DTL-PMPG-TOT-FCST-UNT-QTY.     09430000
                                                                        09441000
           MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         09460000
                                      TO DTL-PMPG-TOT-FCST-PREP-QTY.    09470000
                                                                        09540000
           IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  09550000
               CONTINUE                                                 09560000
           ELSE                                                         09570000
               COMPUTE PV-MU-PCT ROUNDED =                              09580000
                       ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              09590000
                       TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            09600000
                       TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           09610000
                       ON SIZE ERROR                                    09620000
                       MOVE 0 TO PV-MU-PCT                              09630000
               END-COMPUTE                                              09640000
               MOVE ZEROES            TO PV-ROUND-TO-TENTHS             09650000
               ADD PV-MU-PCT          TO PV-ROUND-TO-TENTHS ROUNDED     09660000
               MOVE PV-ROUND-TO-TENTHS                                  09670000
                                      TO DTL-PMPG-TOT-FCST-MU-PCT       09680000
               MOVE PC-PERCENT-SIGN   TO DTL-PMPG-FCST-PCT-SIGN         09681000
           END-IF.                                                      09740000
                                                                        09750000
           MOVE 1                         TO PV-ADVANCE-LINES.          09760000
           ADD PV-ADVANCE-LINES           TO PV-LINE-CNT.               09770000
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         09780000
           MOVE DETAIL-PMPG-TOTALS        TO PV-RPT-LINE.               09790000
           PERFORM 8200-WRITE-RPT-LINE.                                 09800000
                                                                        09810000
      *3110-EXIT.                                                       09820000
       EJECT.                                                           09830000
                                                                        09840000
      *----------------------------------------------------------       09851000
      * 3115-PROCESS-CUT-TTL.                                           09852000
      *     PROCESS THE CUT TOTAL OF THE REPORT.                        09853000
      *----------------------------------------------------------       09854000
       3115-PROCESS-CUT-TTL.                                            09855000
                                                                        09856000
           MOVE SPACES                TO DETAIL-PMPG-TOTALS             09857000
                                         DETAIL-VARIABLE.               09858000
                                                                        09859000
           MOVE PC-TOTAL-FOR-CUT      TO DTL-PG-PAGE-TITLE.             09859100
                                                                        09859300
      *** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                09859400
           IF PM100-ACTUAL                                              09859500
              MOVE TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-1)                    09859600
                                      TO DTL-PMPG-ACTL-TOT-SLS-AMT      09859700
                                                                        09859800
              COMPUTE PV-SELL-THRU-PCT ROUNDED =                        09859900
                      (TBL-SEQTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /           09860000
                      (TBL-SEQTOT-TOT-EOH-INV-QTY(PC-SUB-1) +           09860100
                       TBL-SEQTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100     09860200
                       ON SIZE ERROR                                    09860300
                       MOVE 0 TO PV-SELL-THRU-PCT                       09860400
              END-COMPUTE                                               09860500
              MOVE ZEROES                TO PV-ROUND-TO-TENTHS          09860600
              ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  09860700
              MOVE PV-ROUND-TO-TENTHS    TO DTL-PMPG-TOT-SELL-THRU-PCT  09860800
              MOVE PC-PERCENT-SIGN       TO DTL-PMPG-SELL-PCT-SIGN      09860900
                                                                        09861000
              MOVE TBL-SEQTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                 09861100
                                         TO DTL-PMPG-TOT-ACTL-UNT-QTY   09861200
                                                                        09861300
              MOVE TBL-SEQTOT-PREP-UNT-QTY(PC-SUB-1)                    09861400
                                         TO DTL-PMPG-TOT-ACTL-PREP-QTY  09861500
              IF TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES             09861600
                 MOVE ZEROES             TO PV-MU-PCT                   09861700
                 MOVE PV-MU-PCT          TO DTL-PMPG-TOT-ACTL-MU-PCT    09861800
                 MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      09861900
              ELSE                                                      09862000
                 COMPUTE PV-MU-PCT ROUNDED =                            09862100
                         ((TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-1) -          09862200
                          TBL-SEQTOT-TOT-SLS-COST-AMT(PC-SUB-1))/       09862300
                          TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-1)) * 100      09862400
                          ON SIZE ERROR                                 09862500
                          MOVE 0 TO PV-MU-PCT                           09862600
                 END-COMPUTE                                            09862700
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          09862800
                 ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  09862900
                 MOVE PV-ROUND-TO-TENTHS TO DTL-PMPG-TOT-ACTL-MU-PCT    09863000
                 MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      09863100
              END-IF                                                    09863200
           END-IF.                                                      09863300
                                                                        09863400
      *** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            09863500
           MOVE TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-2)                       09863600
                                      TO DTL-PMPG-FCST-TOT-SLS-AMT.     09863700
                                                                        09863800
           MOVE TBL-SEQTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                    09863900
                                      TO DTL-PMPG-TOT-FCST-UNT-QTY.     09864000
                                                                        09864100
           MOVE TBL-SEQTOT-PREP-UNT-QTY(PC-SUB-2)                       09864200
                                      TO DTL-PMPG-TOT-FCST-PREP-QTY.    09864300
                                                                        09864400
           IF TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                09864500
               CONTINUE                                                 09864600
           ELSE                                                         09864700
               COMPUTE PV-MU-PCT ROUNDED =                              09864800
                       ((TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-2) -            09864900
                       TBL-SEQTOT-TOT-SLS-COST-AMT(PC-SUB-2))/          09865000
                       TBL-SEQTOT-TOT-SALE-AMT(PC-SUB-2)) * 100         09865100
                       ON SIZE ERROR                                    09865200
                       MOVE 0 TO PV-MU-PCT                              09865300
               END-COMPUTE                                              09865400
               MOVE ZEROES            TO PV-ROUND-TO-TENTHS             09865500
               ADD PV-MU-PCT          TO PV-ROUND-TO-TENTHS ROUNDED     09865600
               MOVE PV-ROUND-TO-TENTHS                                  09865700
                                      TO DTL-PMPG-TOT-FCST-MU-PCT       09865800
               MOVE PC-PERCENT-SIGN   TO DTL-PMPG-FCST-PCT-SIGN         09865900
           END-IF.                                                      09866000
                                                                        09866100
           MOVE 1                         TO PV-ADVANCE-LINES.          09866200
           ADD PV-ADVANCE-LINES           TO PV-LINE-CNT.               09866300
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         09866400
           MOVE DETAIL-PMPG-TOTALS        TO PV-RPT-LINE.               09866500
           PERFORM 8200-WRITE-RPT-LINE.                                 09866600
                                                                        09866700
           SET PS-BLANK-LINE       TO TRUE.                             09866800
           MOVE 1                  TO PV-ADVANCE-LINES.                 09866900
           ADD  PV-ADVANCE-LINES   TO PV-LINE-CNT.                      09867000
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         09867100
           MOVE SPACES             TO PV-RPT-LINE.                      09867200
           PERFORM 8200-WRITE-RPT-LINE.                                 09867300
           SET PS-NO-BLANK-LINE    TO TRUE.                             09867400
                                                                        09867500
      *3115-EXIT.                                                       09867600
       EJECT.                                                           09867700
                                                                        09867800
      *----------------------------------------------------------       09867900
      * 3120-PROCESS-ADV-PROMO-TTL.                                     09868000
      *     PROCESS THE ADVERTISED PROMOTION TOTAL OF THE REPORT.       09870000
      *----------------------------------------------------------       09880000
       3120-PROCESS-ADV-PROMO-TTL.                                      09890000
                                                                        09900000
      *** CHECKS TO SEE IF THE ADVERTISED TOTALS HAS BEEN               09910000
      *** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               09920000
      *** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                09930000
      *** THAT WAS SAVED FROM THE LAST PROCESSING.                      09940000
           IF PA-CNT-ADV-TOT = 0                                        09950000
              MOVE SPACES                TO DETAIL-ADV-TOTALS           09960000
                                            DETAIL-VARIABLE             09970000
              MOVE PC-ADV-TOTAL          TO DTL-ADV-PM-TITLE            09980000
              IF PM100-ACTUAL                                           09990000
                 MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                  10010000
                                         TO DTL-ADV-TOT-ACTL-SLS-AMT    10020000
                                                                        10022000
                 COMPUTE PV-SELL-THRU-PCT ROUNDED =                     10026000
                         (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /         10027000
                         (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +         10028000
                          TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100   10029000
                          ON SIZE ERROR                                 10030000
                          MOVE 0 TO PV-SELL-THRU-PCT                    10040000
                 END-COMPUTE                                            10050000
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10263300
                 ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  10263400
                 MOVE PV-ROUND-TO-TENTHS TO DTL-ADV-TOT-SELL-THRU-PCT   10263500
                 MOVE PC-PERCENT-SIGN    TO DTL-ADV-SELL-PCT-SIGN       10263600
                                                                        10270000
                 MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)               10280000
                                         TO DTL-ADV-TOT-ACTL-UNT-QTY    10290000
                                                                        10301000
                 MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                  10320000
                                         TO DTL-ADV-TOT-ACTL-PREP-QTY   10330000
                                                                        10390000
                 IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES           10400000
                    MOVE ZEROES             TO PV-MU-PCT                10411000
                    MOVE PV-MU-PCT          TO DTL-ADV-TOT-ACTL-MU-PCT  10412000
                    MOVE PC-PERCENT-SIGN    TO DTL-ADV-ACTL-PCT-SIGN    10413000
                 ELSE                                                   10420000
                    COMPUTE PV-MU-PCT ROUNDED =                         10430000
                            ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -        10440000
                             TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/     10450000
                             TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100    10460000
                             ON SIZE ERROR                              10470000
                             MOVE 0 TO PV-MU-PCT                        10480000
                    END-COMPUTE                                         10490000
                    MOVE ZEROES          TO PV-ROUND-TO-TENTHS          10500000
                    ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  10510000
                    MOVE PV-ROUND-TO-TENTHS                             10520000
                                         TO DTL-ADV-TOT-ACTL-MU-PCT     10530000
                    MOVE PC-PERCENT-SIGN TO DTL-ADV-ACTL-PCT-SIGN       10531000
                 END-IF                                                 10590000
              END-IF                                                    10600000
                                                                        10610000
              MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                     10630000
                                      TO DTL-ADV-TOT-FCST-SLS-AMT       10640000
                                                                        10660000
              MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                  10710000
                                      TO DTL-ADV-TOT-FCST-UNT-QTY       10720000
                                                                        10731000
              MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                     10750000
                                      TO DTL-ADV-TOT-FCST-PREP-QTY      10760000
                                                                        10830000
              IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              10840000
                 CONTINUE                                               10850000
              ELSE                                                      10860000
                 COMPUTE PV-MU-PCT ROUNDED =                            10870000
                         ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -           10880000
                           TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/       10890000
                           TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100      10900000
                           ON SIZE ERROR                                10910000
                           MOVE 0 TO PV-MU-PCT                          10920000
                 END-COMPUTE                                            10930000
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10940000
                 ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  10950000
                 MOVE PV-ROUND-TO-TENTHS TO DTL-ADV-TOT-FCST-MU-PCT     10960000
                 MOVE PC-PERCENT-SIGN    TO DTL-ADV-FCST-PCT-SIGN       10971000
              END-IF                                                    11030000
           END-IF.                                                      11040000
                                                                        11050000
           MOVE 1                     TO PV-ADVANCE-LINES.              11060000
           ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   11070000
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         11080000
           MOVE DETAIL-ADV-TOTALS     TO PV-RPT-LINE.                   11090000
           PERFORM 8200-WRITE-RPT-LINE.                                 11100000
                                                                        11110000
      *3120-EXIT.                                                       11120000
       EJECT.                                                           11130000
                                                                        11140000
      *----------------------------------------------------------       11150000
      * 3130-PROCESS-UNADV-PROMO-TTL.                                   11160000
      *     PROCESS THE UNADVERTISED PROMOTION TOTAL OF THE REPORT.     11170000
      *----------------------------------------------------------       11180000
       3130-PROCESS-UNADV-PROMO-TTL.                                    11190000
                                                                        11200000
      *** CHECKS TO SEE IF THE UNADVERTISED TOTALS HAS BEEN             11210000
      *** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               11220000
      *** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                11230000
      *** THAT WAS SAVED FROM THE LAST PROCESSING.                      11240000
           IF PA-CNT-UNADV-TOT = 0                                      11250000
              MOVE SPACES               TO DETAIL-UNADV-TOTALS          11260000
                                           DETAIL-VARIABLE              11270000
              MOVE PC-UNADV-TOTAL       TO DTL-UNADV-PM-TITLE           11280000
              IF PM100-ACTUAL                                           11290000
                 MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                   11310000
                                         TO DTL-UNADV-TOT-ACTL-SLS-AMT  11320000
                                                                        11340000
                 COMPUTE PV-SELL-THRU-PCT ROUNDED =                     11380000
                         (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /          11390000
                         (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +          11400000
                          TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100    11410000
                          ON SIZE ERROR                                 11420000
                          MOVE 0 TO PV-SELL-THRU-PCT                    11430000
                 END-COMPUTE                                            11440000
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11647000
                 ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  11648000
                 MOVE PV-ROUND-TO-TENTHS TO DTL-UNADV-TOT-SELL-THRU-PCT 11649000
                 MOVE PC-PERCENT-SIGN    TO DTL-UNADV-SELL-PCT-SIGN     11649100
                                                                        11650000
                 MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                11760000
                                         TO DTL-UNADV-TOT-ACTL-UNT-QTY  11761000
                                                                        11762100
                 MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                   11764000
                                         TO DTL-UNADV-TOT-ACTL-PREP-QTY 11765000
                                                                        11769200
                 IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES            11769300
                    MOVE ZEROES             TO PV-MU-PCT                11769500
                    MOVE PV-MU-PCT          TO DTL-UNADV-TOT-ACTL-MU-PCT11769600
                    MOVE PC-PERCENT-SIGN    TO DTL-UNADV-ACTL-PCT-SIGN  11769700
                 ELSE                                                   11769800
                    COMPUTE PV-MU-PCT ROUNDED =                         11769900
                            ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -         11770000
                             TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/      11770100
                             TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100     11770200
                             ON SIZE ERROR                              11770300
                             MOVE 0 TO PV-MU-PCT                        11770400
                    END-COMPUTE                                         11770500
                    MOVE ZEROES          TO PV-ROUND-TO-TENTHS          11770600
                    ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  11770700
                    MOVE PV-ROUND-TO-TENTHS                             11770800
                                         TO DTL-UNADV-TOT-ACTL-MU-PCT   11770900
                    MOVE PC-PERCENT-SIGN TO DTL-UNADV-ACTL-PCT-SIGN     11771000
                 END-IF                                                 11771800
              END-IF                                                    11771900
                                                                        11772000
              MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                      11772200
                                      TO DTL-UNADV-TOT-FCST-SLS-AMT     11772300
                                                                        11773000
              MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                   11773400
                                      TO DTL-UNADV-TOT-FCST-UNT-QTY     11773500
                                                                        11773700
              MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                      11773900
                                      TO DTL-UNADV-TOT-FCST-PREP-QTY    11774000
                                                                        11774600
              IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               11774700
                 CONTINUE                                               11774800
              ELSE                                                      11774900
                 COMPUTE PV-MU-PCT ROUNDED =                            11775000
                         ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -            11775100
                           TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/        11775200
                           TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100       11775300
                           ON SIZE ERROR                                11775400
                           MOVE 0 TO PV-MU-PCT                          11775500
                 END-COMPUTE                                            11775600
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11775700
                 ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11775800
                 MOVE PV-ROUND-TO-TENTHS TO DTL-UNADV-TOT-FCST-MU-PCT   11775900
                 MOVE PC-PERCENT-SIGN    TO DTL-UNADV-FCST-PCT-SIGN     11776000
              END-IF                                                    11776600
           END-IF.                                                      11776700
                                                                        11776800
           MOVE 1                      TO PV-ADVANCE-LINES.             11776900
           ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11777000
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         11777100
           MOVE DETAIL-UNADV-TOTALS    TO PV-RPT-LINE.                  11777200
           PERFORM 8200-WRITE-RPT-LINE.                                 11777300
                                                                        11777400
      *3130-EXIT.                                                       11777500
       EJECT.                                                           11777600
                                                                        11777700
      *----------------------------------------------------------       11777804
PGNBR * 3030-PROCESS-ADV-NOPGE-TTL.                                     11777912
PGNBR *     PROCESS THE ADVERTISED PROMO WITH NO PAGE TOTAL.            11778012
PGNBR *----------------------------------------------------------       11778112
PGNBR  3030-PROCESS-ADV-NOPGE-TTL.                                      11778212
PGNBR                                                                   11778312
PGNBR *** CHECKS TO SEE IF THE UNADVERTISED TOTALS HAS BEEN             11778412
PGNBR *** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               11778512
PGNBR *** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                11778612
PGNBR *** THAT WAS SAVED FROM THE LAST PROCESSING.                      11778712
PGNBR      IF PA-CNT-ADVNO-TOT = 0                                      11778812
PGNBR         MOVE SPACES               TO DETAIL-ADVNO-TOTALS          11778912
PGNBR                                      DETAIL-VARIABLE              11779012
PGNBR         MOVE PC-ADVNO-TOTAL       TO DTL-ADVNO-PM-TITLE           11779112
PGNBR         IF PM100-ACTUAL                                           11779212
PGNBR            MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                   11779312
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-SLS-AMT  11779412
PGNBR                                                                   11779512
PGNBR            COMPUTE PV-SELL-THRU-PCT ROUNDED =                     11779612
PGNBR                    (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /          11779712
PGNBR                    (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +          11779812
PGNBR                     TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100    11779912
PGNBR                     ON SIZE ERROR                                 11780012
PGNBR                     MOVE 0 TO PV-SELL-THRU-PCT                    11780112
PGNBR            END-COMPUTE                                            11780212
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11780312
PGNBR            ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  11780412
PGNBR            MOVE PV-ROUND-TO-TENTHS TO DTL-ADVNO-TOT-SELL-THRU-PCT 11780512
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-SELL-PCT-SIGN     11780612
PGNBR                                                                   11780712
PGNBR            MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                11780812
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-UNT-QTY  11780912
PGNBR                                                                   11781012
PGNBR            MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                   11781112
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-PREP-QTY 11781212
PGNBR                                                                   11781312
PGNBR            IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES            11781412
PGNBR               MOVE ZEROES             TO PV-MU-PCT                11781512
PGNBR               MOVE PV-MU-PCT          TO DTL-ADVNO-TOT-ACTL-MU-PCT11781612
PGNBR               MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-ACTL-PCT-SIGN  11781712
PGNBR            ELSE                                                   11781812
PGNBR               COMPUTE PV-MU-PCT ROUNDED =                         11781912
PGNBR                       ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -         11782012
PGNBR                        TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/      11782112
PGNBR                        TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100     11782212
PGNBR                        ON SIZE ERROR                              11782312
PGNBR                        MOVE 0 TO PV-MU-PCT                        11782412
PGNBR               END-COMPUTE                                         11782512
PGNBR               MOVE ZEROES          TO PV-ROUND-TO-TENTHS          11782612
PGNBR               ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  11782712
PGNBR               MOVE PV-ROUND-TO-TENTHS                             11782812
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-MU-PCT   11782912
PGNBR               MOVE PC-PERCENT-SIGN TO DTL-ADVNO-ACTL-PCT-SIGN     11783012
PGNBR            END-IF                                                 11783112
PGNBR         END-IF                                                    11783212
PGNBR                                                                   11783312
PGNBR         MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                      11783412
PGNBR                                 TO DTL-ADVNO-TOT-FCST-SLS-AMT     11783512
PGNBR                                                                   11783612
PGNBR         MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                   11783712
PGNBR                                 TO DTL-ADVNO-TOT-FCST-UNT-QTY     11783812
PGNBR                                                                   11783912
PGNBR         MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                      11784012
PGNBR                                 TO DTL-ADVNO-TOT-FCST-PREP-QTY    11784112
PGNBR                                                                   11784212
PGNBR         IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               11784312
PGNBR            CONTINUE                                               11784412
PGNBR         ELSE                                                      11784512
PGNBR            COMPUTE PV-MU-PCT ROUNDED =                            11784612
PGNBR                    ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -            11784712
PGNBR                      TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/        11784812
PGNBR                      TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100       11784912
PGNBR                      ON SIZE ERROR                                11785012
PGNBR                      MOVE 0 TO PV-MU-PCT                          11785112
PGNBR            END-COMPUTE                                            11785212
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11785312
PGNBR            ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11785412
PGNBR            MOVE PV-ROUND-TO-TENTHS TO DTL-ADVNO-TOT-FCST-MU-PCT   11785512
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-FCST-PCT-SIGN     11785612
PGNBR         END-IF                                                    11785712
PGNBR      END-IF.                                                      11785812
PGNBR                                                                   11785912
PGNBR      MOVE 1                      TO PV-ADVANCE-LINES.             11786012
PGNBR      ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11786112
PGNBR      PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         11786212
PGNBR      MOVE DETAIL-ADVNO-TOTALS    TO PV-RPT-LINE.                  11786312
PGNBR      PERFORM 8200-WRITE-RPT-LINE.                                 11786412
PGNBR                                                                   11786512
PGNBR *3130-EXIT.                                                       11786612
PGNBR  EJECT.                                                           11786712
PGNBR *----------------------------------------------------------       11786812
      * 3140-PROCESS-ATIER-LVLS-TTL.                                    11786900
      *     PROCESS THE TOTAL OF THE LEVELS WITHIN ONE ADMIN TIERED     11787000
      *     GROUP. ADMIN TIERED IS ONLY USED IN THE ACTUAL              11787100
      *     REPORTS.                                                    11787200
      *----------------------------------------------------------       11787300
       3140-PROCESS-ATIER-LVLS-TTL.                                     11787400
                                                                        11787500
           MOVE SPACES                TO DETAIL-ATLVL-TOTALS.           11787600
           MOVE PC-TOTAL              TO DTL-ATLVL-PM-TITLE.            11787700
                                                                        11787800
           MOVE PV-TTL-SLS-RTL-AMT    TO DTL-ATLVL-TOT-ACTL-SLS-AMT.    11787900
           MOVE PV-TTL-SLS-UNT-QTY    TO DTL-ATLVL-TOT-ACTL-UNT-QTY.    11788000
                                                                        11788100
           MOVE 1                     TO PV-ADVANCE-LINES.              11788200
           ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   11788300
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         11788400
           MOVE DETAIL-ATLVL-TOTALS   TO PV-RPT-LINE.                   11788500
           PERFORM 8200-WRITE-RPT-LINE.                                 11788600
                                                                        11788700
      *3140-EXIT.                                                       11788800
       EJECT.                                                           11788900
                                                                        11789000
      *----------------------------------------------------------       11789100
      * 3150-PROCESS-ADMIN-TIER-TTL.                                    11789200
      *     PROCESS THE ADMIN TIERED PRICING TOTAL OF THE REPORT.       11789300
      *     ADMIN TIERED IS USED ONLY IN THE ACTUAL REPORTS.            11789400
      *----------------------------------------------------------       11789500
       3150-PROCESS-ADMIN-TIER-TTL.                                     11789600
                                                                        11789700
      *** CHECKS TO SEE IF THE ADMIN TIERED TOTALS HAS BEEN             11789800
      *** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               11789900
      *** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                11790000
      *** THAT WAS SAVED FROM THE LAST PROCESSING.                      11790100
           IF PA-CNT-ADMIN-TOT = 0                                      11790200
              MOVE SPACES             TO DETAIL-ADMIN-TOTALS            11790300
                                         DETAIL-VARIABLE                11790400
              MOVE PC-ADMIN-TOTAL     TO DTL-ADMIN-PM-TITLE             11790500
                                                                        11790600
              MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      11790700
                                         TO DTL-ADMIN-TOT-ACTL-SLS-AMT  11790800
                                                                        11790900
              MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   11791000
                                      TO DTL-ADMIN-TOT-ACTL-UNT-QTY     11791100
           END-IF.                                                      11791200
                                                                        11792000
           MOVE 1                     TO PV-ADVANCE-LINES.              11793000
           ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   11794000
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         11795000
           MOVE DETAIL-ADMIN-TOTALS   TO PV-RPT-LINE.                   11796000
           PERFORM 8200-WRITE-RPT-LINE.                                 11796100
                                                                        11796200
      *3150-EXIT.                                                       11796300
       EJECT.                                                           11796400
                                                                        11796500
      *----------------------------------------------------------       11796600
      * 3160-PROCESS-PROMOTION-TTL.                                     11796700
      *     PROCESS THE COMPLETE PROMOTION TOTAL.                       11796800
      *----------------------------------------------------------       11796900
       3160-PROCESS-PROMOTION-TTL.                                      11797000
                                                                        11798000
           MOVE SPACES                TO DETAIL-PMPG-TOTALS             11799000
                                         DETAIL-VARIABLE.               11800000
                                                                        11801000
           MOVE PC-PROMOTION-TOTAL    TO DTL-PM-PROMO-TITLE.            11802000
                                                                        11802100
      *** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11802200
           IF PM100-ACTUAL                                              11802300
              MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                     11802500
                                      TO DTL-PMPG-ACTL-TOT-SLS-AMT      11802600
                                                                        11806300
              COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11806700
                      (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            11806800
                      (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +            11806900
                       TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      11807000
                       ON SIZE ERROR                                    11807100
                       MOVE 0 TO PV-SELL-THRU-PCT                       11807200
              END-COMPUTE                                               11807300
              MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11808200
              ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11808300
              MOVE PV-ROUND-TO-TENTHS    TO DTL-PMPG-TOT-SELL-THRU-PCT  11808400
              MOVE PC-PERCENT-SIGN       TO DTL-PMPG-SELL-PCT-SIGN      11808600
                                                                        11809200
              MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  11809400
                                         TO DTL-PMPG-TOT-ACTL-UNT-QTY   11809500
                                                                        11809700
              MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                     11809900
                                         TO DTL-PMPG-TOT-ACTL-PREP-QTY  11810000
                                                                        11810200
              IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              11810300
                 MOVE ZEROES             TO PV-MU-PCT                   11810500
                 MOVE PV-MU-PCT          TO DTL-PMPG-TOT-ACTL-MU-PCT    11810600
                 MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      11810700
              ELSE                                                      11810800
                 COMPUTE PV-MU-PCT ROUNDED =                            11810900
                         ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -           11811000
                          TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/        11811100
                          TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100       11811200
                          ON SIZE ERROR                                 11811300
                          MOVE 0 TO PV-MU-PCT                           11811400
                 END-COMPUTE                                            11811500
                 MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11811600
                 ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11811700
                 MOVE PV-ROUND-TO-TENTHS TO DTL-PMPG-TOT-ACTL-MU-PCT    11811800
                 MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      11811900
              END-IF                                                    11812500
           END-IF.                                                      11812600
                                                                        11812700
      *** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11812800
           MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                        11813000
                                      TO DTL-PMPG-FCST-TOT-SLS-AMT.     11813100
                                                                        11813300
           MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     11813500
                                      TO DTL-PMPG-TOT-FCST-UNT-QTY.     11813600
                                                                        11813800
           MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                        11814000
                                      TO DTL-PMPG-TOT-FCST-PREP-QTY.    11814100
                                                                        11814300
           IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 11814400
               CONTINUE                                                 11814500
           ELSE                                                         11814600
               COMPUTE PV-MU-PCT ROUNDED =                              11814700
                       ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             11814800
                       TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/           11814900
                       TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100          11815000
                       ON SIZE ERROR                                    11815100
                       MOVE 0 TO PV-MU-PCT                              11815200
               END-COMPUTE                                              11815300
               MOVE ZEROES            TO PV-ROUND-TO-TENTHS             11815400
               ADD PV-MU-PCT          TO PV-ROUND-TO-TENTHS ROUNDED     11815500
               MOVE PV-ROUND-TO-TENTHS                                  11815600
                                      TO DTL-PMPG-TOT-FCST-MU-PCT       11815700
               MOVE PC-PERCENT-SIGN   TO DTL-PMPG-FCST-PCT-SIGN         11815800
           END-IF.                                                      11816400
                                                                        11816500
           MOVE 1                        TO PV-ADVANCE-LINES.           11816600
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                11816700
           PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         11816800
           MOVE DETAIL-PMPG-TOTALS       TO PV-RPT-LINE.                11816900
           PERFORM 8200-WRITE-RPT-LINE.                                 11817000
                                                                        11817100
      *3160-EXIT.                                                       11817200
       EJECT.                                                           11817300
                                                                        11818000
      *----------------------------------------------------------       11818100
      * 3200-CHECK-MAX-LINE-CNT.                                        11818200
      *     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          11818300
      *     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              11818400
      *----------------------------------------------------------       11818500
       3200-CHECK-MAX-LINE-CNT.                                         11818600
                                                                        11818700
           IF PV-LINE-CNT > PC-MAX-LINE-CNT                             11818800
               PERFORM 3500-PROCESS-PAGE-HEADER                         11818900
               PERFORM 3400-PROCESS-DETAIL-HEADER                       11819000
               MOVE 1                  TO PV-ADVANCE-LINES              11819100
               ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   11819200
           END-IF.                                                      11819300
                                                                        11819400
      *3200-EXIT.                                                       11819500
       EJECT.                                                           11819600
                                                                        11819700
      *----------------------------------------------------------       11819800
      * 3300-CHECK-LNE-CNT-FOR-TTLS.                                    11819900
      *     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          11820000
      *     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              11830000
      *----------------------------------------------------------       11830100
       3300-CHECK-LNE-CNT-FOR-TTLS.                                     11830200
                                                                        11830300
           IF PV-LINE-CNT > PC-MAX-LINE-CNT                             11830400
               PERFORM 3500-PROCESS-PAGE-HEADER                         11830500
               IF PS-BLANK-LINE                                         11830600
                  MOVE 1                  TO PV-ADVANCE-LINES           11830700
                  ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                11830800
               ELSE                                                     11830900
                  MOVE 2                  TO PV-ADVANCE-LINES           11831000
                  ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                11831100
           END-IF.                                                      11831200
                                                                        11831300
      *3300-EXIT.                                                       11831400
       EJECT.                                                           11831500
                                                                        11831600
      *----------------------------------------------------------       11831700
      * 3400-PROCESS-DETAIL-HEADER.                                     11831800
      *     PROCESS REPORT DETAIL HEADER LINES.                         11831900
      *----------------------------------------------------------       11832000
       3400-PROCESS-DETAIL-HEADER.                                      11832100
                                                                        11832200
           MOVE SPACES                 TO DTL-HDR-01-PAGE.              11832300
           EVALUATE TRUE                                                11832400
               WHEN PM100-AD-PG-NBR NOT = 0 AND                         11832500
                    PM100-PROMO-ITM-ADV-IND = 'Y'                       11832600
                    MOVE PC-PROMO-ITEMS-ON-PAGE                         11832700
                                       TO DTL-HDR-01-PM-ITM-PAGE-TITLE  11832800
                    MOVE PM100-AD-PG-NBR                                11832900
                                       TO DTL-HDR-01-PM-ITM-PAGE-NBR    11833000
                    SET PS-PAGE-SECTION-TTL TO TRUE                     11833100
                    SET PS-ADV-PROMO-TTL    TO TRUE                     11833200
PGNBR          WHEN PM100-AD-PG-NBR = 0 AND                             11833303
PGNBR               PM100-PROMO-ITM-ADV-IND = 'Y'                       11833403
PGNBR               MOVE PC-PROMO-ITEMS-NO-PAGE                         11833503
PGNBR                                  TO DTL-HDR-01-HEADING-TITLE      11833607
PGNBR               SET PS-ADV-NOPGE-TTL    TO TRUE                     11834003
               WHEN PM100-AD-PG-NBR = 0 AND                             11834100
                    PM100-PROMO-ITM-ADV-IND = 'N'                       11834200
                    MOVE PC-PROMO-ITEMS-UNADV                           11834300
                                       TO DTL-HDR-01-HEADING-TITLE      11834400
                    SET PS-UNADV-PROMO-TTL  TO TRUE                     11834500
               WHEN OTHER                                               11834600
                    MOVE PC-PROMO-ITEMS-ADMIN                           11834700
                                       TO DTL-HDR-01-HEADING-TITLE      11834800
                    SET PS-ADMIN-TIER-TTL   TO TRUE                     11834900
           END-EVALUATE.                                                11835000
                                                                        11835100
           MOVE 2                      TO PV-ADVANCE-LINES              11835200
                                          PV-SAVE-LINE-AMT.             11835300
           ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11835400
           IF PV-LINE-CNT > PC-MAX-LINE-CNT                             11835500
               PERFORM 3500-PROCESS-PAGE-HEADER                         11835600
               MOVE PV-SAVE-LINE-AMT   TO PV-ADVANCE-LINES              11835700
               ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   11835800
           END-IF.                                                      11835900
           MOVE DETAIL-HEADER-01       TO PV-RPT-LINE.                  11836000
           PERFORM 8200-WRITE-RPT-LINE.                                 11836100
                                                                        11836200
      *3400-EXIT.                                                       11836300
       EJECT.                                                           11836400
                                                                        11836500
      *----------------------------------------------------------       11836600
      * 3500-PROCESS-PAGE-HEADER.                                       11836700
      *     PROCESS REPORT PAGE HEADERS.                                11836800
      *----------------------------------------------------------       11836900
       3500-PROCESS-PAGE-HEADER.                                        11837000
                                                                        11837100
           MOVE ZEROES                 TO PV-LINE-CNT.                  11837200
           ADD 1                       TO PV-PAGE-CNT.                  11837300
           MOVE PV-PAGE-CNT            TO DP200O-PAGE-NUMBER.           11837400
           MOVE 1                      TO DP200O-REPORT-NUMBER.         11837500
                                                                        11837600
           MOVE DP200O-STANDRD-HEADER-200-COLS                          11837700
                                       TO PV-RPT-LINE.                  11837800
           PERFORM 8100-WRITE-SLS-RPT-NEW-PAGE.                         11837900
                                                                        11838000
           MOVE HEADER-01              TO PV-RPT-LINE.                  11838100
           MOVE 2                      TO PV-ADVANCE-LINES.             11838200
           ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11838300
           PERFORM 8200-WRITE-RPT-LINE.                                 11838400
                                                                        11838500
           MOVE HEADER-02              TO PV-RPT-LINE.                  11838600
           MOVE 1                      TO PV-ADVANCE-LINES.             11838700
           ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11838800
           PERFORM 8200-WRITE-RPT-LINE.                                 11838900
                                                                        11839000
           MOVE HEADER-03              TO PV-RPT-LINE.                  11839100
           MOVE 1                      TO PV-ADVANCE-LINES.             11839200
           ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11839300
           PERFORM 8200-WRITE-RPT-LINE.                                 11839400
                                                                        11839500
           MOVE HEADER-04              TO PV-RPT-LINE.                  11839600
           MOVE 2                      TO PV-ADVANCE-LINES.             11839700
           ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11839800
           PERFORM 8200-WRITE-RPT-LINE                                  11839900
                                                                        11840000
           MOVE HEADER-05              TO PV-RPT-LINE.                  11840100
           MOVE 1                      TO PV-ADVANCE-LINES.             11840200
           ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11840300
           PERFORM 8200-WRITE-RPT-LINE.                                 11840400
                                                                        11840500
      *3500-EXIT.                                                       11840600
       EJECT.                                                           11840700
                                                                        11840800
      *----------------------------------------------------------       11841000
      * 8000-READ-SALES-RESULTS.                                        11841100
      *     READ SALES RESULTS INPUT RECORDS.                           11841200
      *----------------------------------------------------------       11841300
       8000-READ-SALES-RESULTS.                                         11841400
                                                                        11841500
           READ PROMO-ITM-SUMM-FILE INTO PM100-PROMO-ITM-SUMM           11841600
                AT END                                                  11841700
PGNBR              SET PS-EOF-SALES-RESULTS TO TRUE.                    11841814
PGNBR      EVALUATE TRUE                                                11842918
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'Y' AND                   11843018
PGNBR              PM100-AD-PG-NBR = 0                                  11843118
PGNBR              SET PS-ADVNOPG-FLAG TO TRUE                          11843218
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'Y' AND                   11843318
PGNBR              PM100-AD-PG-NBR > 0                                  11843418
PGNBR              SET PS-ADVPG-FLAG TO TRUE                            11843518
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'N'                       11843618
PGNBR              SET PS-NOADV-FLAG TO TRUE                            11843718
PGNBR         WHEN OTHER                                                11843818
PGNBR              CONTINUE                                             11843918
PGNBR      END-EVALUATE                                                 11844018
PGNBR                                                                   11844118
PGNBR      IF PS-HOLD-REC-TYPE-FLAG NOT = 0                             11844218
PGNBR         IF PS-REC-TYPE-FLAG NOT = PS-HOLD-REC-TYPE-FLAG           11844318
PGNBR            EVALUATE PS-HOLD-REC-TYPE-FLAG                         11844418
PGNBR               WHEN  '1'                                           11844518
PGNBR                     SET PS-EOF-ADVNOPG TO TRUE                    11844618
PGNBR               WHEN  '2'                                           11844718
PGNBR                     SET PS-EOF-ADVPG TO TRUE                      11844818
PGNBR               WHEN  '3'                                           11844918
PGNBR                     SET PS-EOF-NOADV TO TRUE                      11845018
PGNBR               WHEN  OTHER                                         11845118
PGNBR                     CONTINUE                                      11845218
PGNBR            END-EVALUATE                                           11845318
PGNBR         END-IF                                                    11845418
PGNBR      END-IF                                                       11845518
PGNBR                                                                   11845618
PGNBR      MOVE PS-REC-TYPE-FLAG TO  PS-HOLD-REC-TYPE-FLAG.             11845718
                                                                        11845815
      *8000-EXIT.                                                       11845915
       EJECT.                                                           11846015
                                                                        11846115
      *----------------------------------------------------------       11846215
      * 8100-WRITE-SLS-RPT-NEW-PAGE.                                    11846315
      *     WRITES NEW PAGE.                                            11846415
      *----------------------------------------------------------       11846515
       8100-WRITE-SLS-RPT-NEW-PAGE.                                     11846615
                                                                        11846715
           WRITE PROMO-ITM-SUMM-RPT-LINE                                11846815
                 FROM PV-RPT-LINE                                       11846915
                 AFTER ADVANCING PAGE.                                  11847015
                                                                        11847115
           ADD 2            TO PV-LINE-CNT.                             11847215
                                                                        11847315
      *8100-EXIT.                                                       11847415
       EJECT.                                                           11847515
                                                                        11847615
      *----------------------------------------------------------       11847715
      * 8200-WRITE-RPT-LINE.                                            11847815
      *     WRITES OUT A LINE ON THE REPORT.                            11847915
      *----------------------------------------------------------       11848015
       8200-WRITE-RPT-LINE.                                             11848115
                                                                        11848215
           WRITE PROMO-ITM-SUMM-RPT-LINE                                11848315
                 FROM PV-RPT-LINE                                       11848415
                 AFTER ADVANCING PV-ADVANCE-LINES.                      11848515
                                                                        11848615
      *8200-EXIT.                                                       11848715
       EJECT.                                                           11848815
                                                                        11849000
      *----------------------------------------------------------       11850900
      * 9100-CALENDAR-ROUTINE.                                          11851000
      *     CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.           11851100
      *----------------------------------------------------------       11851200
       9100-CALENDAR-ROUTINE.                                           11851300
                                                                        11851400
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          11851500
                                                   DPG53 DPG54          11851600
                                                   DPG55 DPG56.         11851700
           EVALUATE TRUE                                                11851800
               WHEN DPG54-NO-ERROR                                      11851900
                   CONTINUE                                             11852000
               WHEN DPG54-WARNING-ERROR                                 11852100
                   DISPLAY '** WARNING - PROGRAM '                      11852200
                            PC-CURRENT-PROGRAM-NAME ' **'               11852300
                   DISPLAY '** 9100-CALENDAR-ROUTINE'                   11852400
                   DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 11852500
                   DISPLAY '** DPG54-ERROR-MESSAGE: '                   11852600
                   DISPLAY '** ' DPG54-ERROR-MESSAGE                    11852700
                   DISPLAY '** DPG51: ' DPG51                           11852800
                   DISPLAY '** DPG52: ' DPG52                           11852900
                   DISPLAY '** PLEASE INVESTIGATE FURTHER **'           11853000
               WHEN DPG54-SEVERE-ERROR                                  11854000
                   DISPLAY '** ABEND - PROGRAM '                        11855000
                            PC-CURRENT-PROGRAM-NAME ' **'               11856000
                   DISPLAY '** 9100-CALENDAR-ROUTINE'                   11857000
                   DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  11858000
                   IF DPG54-CALENDAR-TYPE-INVALID                       11859000
                      DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          11860000
                      DISPLAY '** DPG51-CALENDAR-TYPE: '                11870000
                               DPG51-CALENDAR-TYPE                      11880000
                   END-IF                                               11890000
                   IF DPG54-DATE-INVALID                                11900000
                      DISPLAY '** DPG54-DATE-INVALID'                   11910000
                      DISPLAY '** DPG52-LK-DATE-INPUT: '                11920000
                               DPG52-LK-DATE-INPUT                      11930000
                   END-IF                                               11940000
                   IF DPG54-INCR-DECR-INVALID                           11950000
                      DISPLAY '** DPG54-INCR-DECR-INVALID'              11960000
                      DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     11970000
                               DPG51-INCREMENT-DECREMENT-FLAG           11980000
                   END-IF                                               11990000
                   MOVE DPG54-ERROR-MESSAGE                             12000000
                                       TO PV-OPERATION-MSG-2            12010000
                   SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            12020000
                   PERFORM 9800-ABEND                                   12030000
           END-EVALUATE.                                                12040000
                                                                        12050000
      *9100-EXIT.                                                       12060000
       EJECT.                                                           12070000
                                                                        12080000
      *----------------------------------------------------------       12090000
      * 9800-ABEND.                                                     12100000
      *     PERFORMS A NON-SQL-ABEND.                                   12110000
      *----------------------------------------------------------       12120000
       9800-ABEND.                                                      12130000
                                                                        12140000
           DISPLAY '** ABEND           **'.                             12150000
           DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  12160000
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        12170000
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       12180000
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       12190000
                                                                        12200000
           CALL 'ILBOABN0' USING ABEND-CODE.                            12210000
