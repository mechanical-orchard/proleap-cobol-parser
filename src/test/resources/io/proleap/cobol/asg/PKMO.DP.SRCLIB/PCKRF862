000100 IDENTIFICATION DIVISION.                                         00010004
000200                                                                  00020004
000300 PROGRAM-ID.             PCKRF862.                                00030004
000400 AUTHOR.                 LYNN MCADAMS.                            00040004
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050004
000600 DATE-WRITTEN            JANUARY, 2001.                           00060004
000700 DATE-COMPILED.                                                   00070004
000800                                                                  00080004
000900******************************************************************00090004
001000* THIS PROGRAM DISPLAYS THE ALTER REASON SCREEN ON THE            00100004
001100* LRT (LASER RADIO TERMINAL) WHEN F4-ALTER IS PRESSED FROM        00110012
001200* THE ADJUSTED CARTON UNITS SCREEN (PCKRF861).  THE OPERATOR      00120012
001300* CAN SELECT FROM A LIST OF REASON CODES FOR ADJUSTING THE        00130012
001400* UNITS IN A CARTON.                                              00140012
001500******************************************************************00150004
001600 ENVIRONMENT DIVISION.                                            00160004
001700 DATA DIVISION.                                                   00170004
001800 WORKING-STORAGE SECTION.                                         00180004
001900*                                                                 00190011
002000 01  CA-PROGRAM-DATA.                                             00200004
002100     05  CA-SELECTION-X              PIC  X(01)  VALUE SPACE.     00210004
002200     05  CA-SELECTION REDEFINES CA-SELECTION-X                    00220004
002300                                         PIC  9(01).              00230004
002400         88  CA-VALID-SELECTION               VALUE               00240004
002500*LMM         1 2 3 4 5 6.                                         00250025
002600             1 2.                                                 00260025
002700         88  CA-REASON-CDE-1                  VALUE 1.            00270004
002800         88  CA-REASON-CDE-2                  VALUE 2.            00280004
002900         88  CA-REASON-CDE-3                  VALUE 3.            00290004
003000         88  CA-REASON-CDE-4                  VALUE 4.            00300004
003100         88  CA-REASON-CDE-5                  VALUE 5.            00310004
003200         88  CA-REASON-CDE-6                  VALUE 6.            00320004
003300                                                                  00330004
003400     05  CA-REASON-CDES.                                          00340021
003500         10  CA-RSN-CDE-1            PIC X(08)  VALUE 'UNIT ADJ'. 00350025
003600         10  CA-RSN-CDE-2            PIC X(08)  VALUE 'DMGD UNT'. 00360025
003700         10  CA-RSN-CDE-3            PIC X(08)  VALUE 'NOT USED'. 00370025
003800         10  CA-RSN-CDE-4            PIC X(08)  VALUE 'NOT USED'. 00380025
003900         10  CA-RSN-CDE-5            PIC X(08)  VALUE 'NOT USED'. 00390025
004000         10  CA-RSN-CDE-6            PIC X(08)  VALUE 'NOT USED'. 00400025
004100                                                                  00410021
004200 01  PC-PROGRAM-CONSTANTS.                                        00420004
004300     05  PC-LOGON-TRAN-ID                PIC  X(04)  VALUE 'Z028'.00430004
004400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00440004
004500                                                     COMP SYNC.   00450004
004600     05  PC-LEAVE-SYSTEM-LENGTH         PIC S9(04)   VALUE +160   00460004
004700                                                     COMP SYNC.   00470004
004800     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'PCKRF862'.   00480004
004900     05  PC-DC-RF-APPL-PGM          PIC X(08) VALUE 'MPKCS027'.   00490004
005000     05  PC-ADJUST-CRTN-UNTS-PGM    PIC X(08) VALUE 'PCKRF861'.   00500004
005100     05  PC-ALTER-REASON-PGM        PIC X(08) VALUE 'PCKRF862'.   00510004
005200     05  PC-ADJUSTED-QTY-PGM        PIC X(08) VALUE 'PCKRF863'.   00520004
005300                                                                  00530004
005400     05  PC-PC-ALTER-REASON              PIC  X(04)  VALUE 'E862'.00540004
005500     05  PC-PC-MANIFEST-MENU             PIC  X(04)  VALUE 'E850'.00550004
005600     05  PC-01                           PIC  X(02)  VALUE '01'.  00560004
005700     05  PC-A                            PIC  X(01)  VALUE 'A'.   00570004
005800     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   00580004
005900     05  PC-N                            PIC  X(01)  VALUE 'N'.   00590004
006000                                                                  00600004
006100 01  PS-PROGRAM-SWITCHES.                                         00610004
006200     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   00620004
006300         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   00630004
006400         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   00640004
006500     05  PS-ABEND-IND                   PIC X(01)    VALUE 'N'.   00650004
006600         88  PS-NO-ABEND-IN-PROGRESS                 VALUE 'N'.   00660004
006700         88  PS-ABEND-IN-PROGRESS                    VALUE 'Y'.   00670004
006800     05  PS-INTERNAL-READER-ENQ-DEQ-IND                           00680004
006900                                        PIC X(01)    VALUE 'D'.   00690004
007000         88  PS-INTERNAL-READER-ENQUEUED             VALUE 'E'.   00700004
007100         88  PS-INTERNAL-READER-DEQUEUED             VALUE 'D'.   00710004
007200                                                                  00720004
007300                                                                  00730004
007400 01  PV-PROGRAM-VARIABLES.                                        00740004
007500     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00750004
007600     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  00760004
007700                                                     COMP SYNC.   00770004
007800     05  PV-LEAVE-SYSTEM-MESSAGE         PIC X(160)  VALUE SPACES.00780004
007900     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 00790004
008000     05  PV-SYSTEM-ID.                                            00800004
008100         10  FILLER              PIC  X(04)   VALUE SPACE.        00810004
008200         10  PV-REGION-IND       PIC  X(01).                      00820004
008300             88  PV-TEST-CICS                 VALUE 'T'.          00830004
008400             88  PV-QA-CICS                   VALUE 'Q'.          00840004
008500             88  PV-PROD-CICS                 VALUE 'P'.          00850004
008600             88  PV-LEARN-CICS                VALUE 'L'.          00860004
008700         10  FILLER              PIC X(03)    VALUE SPACES.       00870004
008800                                                                  00880020
008900                                                                  00890020
009000                                                                  00900011
009100 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  00910004
009200     05  TS-INFO-QUEUE-NAME.                                      00920004
009300         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 00930004
009400         10  FILLER                      PIC  X(04)  VALUE 'INFO'.00940004
009500                                                                  00950004
009600 01  SE-SYSTEM-ERROR-MESSAGE.                                     00960004
009700     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        00970025
009800         'END OF SESSION     '.                                   00980025
009900     05  PC-ENTER-THROUGH-MENU-MSG       PIC X(19) VALUE          00990028
010000         'ENTER THROUGH MENU '.                                   01000028
010100     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        01010025
010200         'INVALID SELECTION  '.                                   01020025
010300     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        01030025
010400         'UNRECOGNIZED PF KEY'.                                   01040025
010500     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01050025
010600         'TRANS NOT AVAILABLE'.                                   01060025
010700     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        01070025
010800         'CICS ABEND -CALL DP'.                                   01080025
010900     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        01090025
011000         'CICSAUTH BAD RETURN'.                                   01100025
011100     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        01110025
011200         'SELECTION NOT AVAIL'.                                   01120025
011300     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        01130025
011400         'NUMERIC VALUE REQ. '.                                   01140025
011500     05  FILLER                  PIC X(43)    VALUE               01150004
011600         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.           01160004
011700     05  FILLER                  PIC X(33)    VALUE               01170004
011800         'PROGRAM PCKRF862       EIBRESP = '.                     01180004
011900     05  SE-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         01190004
012000     05  FILLER                  PIC X(5)     VALUE SPACES.       01200004
012100     05  FILLER                  PIC X(14)    VALUE               01210004
012200         'ATTEMPTING TO '.                                        01220004
012300     05  SE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       01230004
012400                                                                  01240006
012500* COMMAREA LAYOUT FOR PCRF85X SCREENS                             01250006
012600 01  CA-COMMAREA.                                                 01260023
012700     COPY PCWS033.                                                01270006
012800                                                                  01280006
012900*  MAP LAYOUT                                                     01290006
013000     COPY PCKM862.                                                01300006
013100                                                                  01310007
013200* HELP SCREEN COMMAREA                                            01320007
013300     COPY PCWS192.                                                01330007
013400                                                                  01340007
013500* HELP SCREEN WORK AREA                                           01350007
013600     COPY PCWS188.                                                01360007
013700                                                                  01370007
013800* DB2 AREA FOR THE SHIPMENT UNIT TABLE - SUT_OTBND_CART           01380037
013900     EXEC SQL                                                     01390038
014000          INCLUDE SUT00024                                        01400038
014100     END-EXEC.                                                    01410038
014200                                                                  01420038
014300* COMMUNICATIONS AREA FOR DB2                                     01430038
014400     EXEC SQL                                                     01440038
014500         INCLUDE SQLCA                                            01450038
014600     END-EXEC.                                                    01460038
014700*                                                                 01470038
014800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01480004
014900     COPY DPWS013.                                                01490004
015000                                                                  01500004
015100*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        01510004
015200     COPY DPWS008.                                                01520010
015300                                                                  01530004
015400*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01540004
015500     COPY DPWS010I.                                               01550004
015600                                                                  01560004
015700*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01570004
015800     COPY DPWS015.                                                01580004
015900                                                                  01590004
016000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01600004
016100     COPY DFHAID.                                                 01610004
016200*                                                                 01620011
016300*                                                                 01630011
016400 LINKAGE SECTION.                                                 01640004
016500 01  DFHCOMMAREA.                                                 01650004
016600     05  FILLER                       OCCURS 1 TO 4072 TIMES      01660004
016700                                      DEPENDING ON EIBCALEN.      01670004
016800         10  FILLER                   PIC X.                      01680004
016900*                                                                 01690011
017000*                                                                 01700011
017100 PROCEDURE DIVISION.                                              01710004
017200 0000-PROGRAM-MAINLINE.                                           01720004
017300                                                                  01730029
017400     INITIALIZE CA-COMMAREA                                       01740027
017500     MOVE DFHCOMMAREA                 TO CA-COMMAREA              01750023
017600                                                                  01760004
017700     EVALUATE TRUE                                                01770004
017800         WHEN EIBCALEN = ZERO                                     01780004
017900              MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA   01790027
018000              PERFORM 8300-RETURN                                 01800027
018100                                                                  01810030
018200         WHEN EIBTRNID = 'Z278'                                   01820026
018300              MOVE DFHCOMMAREA         TO PC192-COMMAREA          01830027
018400              MOVE PC192-HOST-SAVE-AREA                           01840027
018500                                       TO CA-COMMAREA             01850027
018600              SET PC033-PROCESS-SCREEN TO TRUE                    01860027
018700              MOVE PC192-HOST-SAVE-MAP TO PC862AO                 01870027
018800              MOVE -1                  TO ASELECTL                01880027
018900              PERFORM 8000-SEND-MAP                               01890027
019000              PERFORM 8200-RETURN-TRANID                          01900027
019100                                                                  01910030
019200         WHEN PC033-INITIALIZE-SCREEN                             01920027
019300         WHEN EIBAID = DFHCLEAR                                   01930016
019400              SET PC033-PROCESS-SCREEN TO TRUE                    01940027
019500              MOVE PC-CURRENT-PROGRAM-NAME                        01950027
019600                                 TO PC033-LAST-PROGRAM            01960027
019700              MOVE -1       TO ASELECTL                           01970026
019800              PERFORM 8000-SEND-MAP                               01980016
019900              PERFORM 8200-RETURN-TRANID                          01990004
020000                                                                  02000013
020100         WHEN EIBAID = DFHPF1                                     02010016
020200             PERFORM 2100-RECEIVE-MAP                             02020022
020300             MOVE PC862AO             TO PC192-HOST-SAVE-MAP      02030016
020400             PERFORM 1200-HELP-SCREEN                             02040016
020500                                                                  02050016
020600         WHEN EIBAID = DFHPF3                                     02060018
020700              MOVE PC-ADJUST-CRTN-UNTS-PGM TO                     02070018
020800                          PV-TRANSFER-PROGRAM                     02080018
020900              PERFORM 4000-XCTL-TO-SELECTED-PROGRAM               02090022
021000                                                                  02100018
021100         WHEN EIBAID = DFHENTER                                   02110004
021200              PERFORM 2100-RECEIVE-MAP                            02120022
021300              PERFORM 2200-EDIT-SELECTION                         02130022
021400                                                                  02140013
021500         WHEN OTHER                                               02150004
021600              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     02160004
021700                                     TO AMSGLNO                   02170004
021800              PERFORM 8100-SEND-DATA-ONLY                         02180004
021900              PERFORM 8200-RETURN-TRANID                          02190004
022000     END-EVALUATE.                                                02200004
022100                                                                  02210004
022200     GOBACK.                                                      02220004
022300*                                                                 02230009
022400*                                                                 02240009
022500 1200-HELP-SCREEN.                                                02250022
022600     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      02260022
022700     MOVE 'PCKRF862'                  TO PC192-PROGRAM-NAME       02270022
022800     COPY PCPD188.                                                02280022
022900     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      02290022
023000     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     02300023
023100     PERFORM 8400-XCTL-TO-HELP.                                   02310022
023200*                                                                 02320022
023300*                                                                 02330022
023400 2000-PROCESS-SELECTION.                                          02340022
023500     MOVE PC-ADJUSTED-QTY-PGM    TO PV-TRANSFER-PROGRAM           02350022
023600     PERFORM 4000-XCTL-TO-SELECTED-PROGRAM.                       02360022
023700*                                                                 02370022
023800*                                                                 02380022
023900 2100-RECEIVE-MAP.                                                02390022
024000     EXEC CICS                                                    02400016
024100         RECEIVE MAP    ('PC862A')                                02410016
024200                 MAPSET ('PCKM862')                               02420016
024300                 RESP   (PV-CICS-RESPONSE)                        02430016
024400     END-EXEC.                                                    02440016
024500                                                                  02450016
024600     EVALUATE TRUE                                                02460016
024700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02470016
024800              PERFORM 2110-RECEIVE-SCREEN-FIELDS                  02480022
024900         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                02490016
025000              CONTINUE                                            02500016
025100         WHEN OTHER                                               02510016
025200              MOVE '2100-RECEIVE-MAP'                             02520022
025300                                     TO DP013-PARAGRAPH           02530016
025400              MOVE 'UNABLE TO RECEIVE MAP'                        02540016
025500                                     TO DP013-MESSAGE-TEXT (1)    02550016
025600              SET DP013-LOGIC-ABEND  TO TRUE                      02560016
025700              SET DP013-NO-ROLLBACK  TO TRUE                      02570016
025800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              02580016
025900     END-EVALUATE.                                                02590016
026000*                                                                 02600016
026100*                                                                 02610016
026200 2110-RECEIVE-SCREEN-FIELDS.                                      02620022
026300     IF  ASELECTL > ZERO                                          02630016
026400         MOVE ASELECTI               TO CA-SELECTION-X            02640016
026500     END-IF.                                                      02650016
026600*                                                                 02660016
026700*                                                                 02670016
026800 2200-EDIT-SELECTION.                                             02680022
026900     MOVE CA-SELECTION-X             TO DP010I-UNEDITED-FIELD.    02690004
027000     MOVE 1                          TO DP010I-MAXIMUM-DIGITS.    02700004
027100     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  02710004
027200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     02720004
027300                                                                  02730004
027410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             02741040
027420                         USING DP010I-NUMERIC-EDIT-AREA           02742040
027500                                                                  02750004
027600     IF  DP010I-ERROR-DETECTED                                    02760004
027700         MOVE PC-NON-NUMERIC-SELECTION-MSG                        02770004
027800                                     TO AMSGLNO                   02780004
027900         PERFORM 8100-SEND-DATA-ONLY                              02790004
028000         PERFORM 8200-RETURN-TRANID                               02800004
028100     ELSE                                                         02810004
028200         MOVE DP010I-NUMERIC-FIELD   TO CA-SELECTION              02820004
028300     END-IF.                                                      02830004
028400                                                                  02840004
028500     EVALUATE TRUE                                                02850019
028600         WHEN CA-SELECTION-X = '1'                                02860019
028700              MOVE CA-RSN-CDE-1 TO PC033-REASON-CDE               02870021
028800         WHEN CA-SELECTION-X = '2'                                02880019
028900              MOVE CA-RSN-CDE-2 TO PC033-REASON-CDE               02890021
029000              PERFORM 3000-CHECK-FOR-DMG-CRTN                     02900038
029100         WHEN CA-SELECTION-X = '3'                                02910019
029200              MOVE CA-RSN-CDE-3 TO PC033-REASON-CDE               02920021
029300         WHEN CA-SELECTION-X = '4'                                02930019
029400              MOVE CA-RSN-CDE-4 TO PC033-REASON-CDE               02940021
029500         WHEN CA-SELECTION-X = '5'                                02950019
029600              MOVE CA-RSN-CDE-5 TO PC033-REASON-CDE               02960021
029700     END-EVALUATE                                                 02970019
029800                                                                  02980019
029900     EVALUATE TRUE                                                02990019
030000         WHEN CA-VALID-SELECTION                                  03000004
030100             PERFORM 2000-PROCESS-SELECTION                       03010004
030200         WHEN OTHER                                               03020004
030300             MOVE DP015-UNP-NUM-BRT-MDT  TO ASELECTA              03030004
030400             MOVE PC-INVALID-SELECTION-MSG                        03040004
030500                                         TO AMSGLNO               03050004
030600             PERFORM 8100-SEND-DATA-ONLY                          03060004
030700             PERFORM 8200-RETURN-TRANID                           03070004
030800     END-EVALUATE.                                                03080004
030900*                                                                 03090009
031000 3000-CHECK-FOR-DMG-CRTN.                                         03100038
031100     EXEC SQL                                                     03110038
031200         SELECT CART.SHIPT_UNT_ID                                 03120039
031300         INTO  :SUT00024-SHIPT-UNT-ID                             03130039
031400         FROM  SUT_OTBND_CART CART                                03140038
031500         WHERE CART.SHIPT_UNT_ID     = :PC033-CARTON              03150038
031600           AND CART.CART_SRC_CDE     = 'DMG'                      03160038
031700     END-EXEC                                                     03170038
031800                                                                  03180038
031900     EVALUATE TRUE                                                03190034
032000         WHEN SQLCODE = +100                                      03200034
032100             PERFORM 2000-PROCESS-SELECTION                       03210034
032200         WHEN OTHER                                               03220034
032300             MOVE DP015-UNP-NUM-BRT-MDT  TO ASELECTA              03230034
032400             MOVE PC-INVALID-SELECTION-MSG  TO AMSGLNO            03240034
032500             PERFORM 8100-SEND-DATA-ONLY                          03250034
032600             PERFORM 8200-RETURN-TRANID                           03260034
032700     END-EVALUATE.                                                03270034
032800*                                                                 03280009
032900 4000-XCTL-TO-SELECTED-PROGRAM.                                   03290022
033000     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     03300004
033100     MOVE PC-CURRENT-PROGRAM-NAME    TO PC033-LAST-PROGRAM.       03310004
033200     MOVE CA-SELECTION               TO PC033-ADJ-OR-DMG-UNT-SW.  03320033
033300                                                                  03330004
033400     MOVE LENGTH OF CA-COMMAREA TO PV-COMMAREA-LENGTH             03340023
033500     EXEC CICS                                                    03350004
033600         XCTL                                                     03360004
033700             PROGRAM   (PV-TRANSFER-PROGRAM)                      03370004
033800             COMMAREA  (CA-COMMAREA)                              03380023
033900             LENGTH    (PV-COMMAREA-LENGTH)                       03390004
034000             RESP      (PV-CICS-RESPONSE)                         03400004
034100     END-EXEC.                                                    03410004
034200                                                                  03420004
034300     EVALUATE TRUE                                                03430004
034400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03440004
034500              CONTINUE                                            03450004
034600         WHEN OTHER                                               03460004
034700              MOVE '4000-XCTL-TO-SELECTED-PROGRAM'                03470022
034800                                     TO DP013-PARAGRAPH           03480004
034900              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       03490004
035000                                     TO DP013-MESSAGE-TEXT (1)    03500004
035100              MOVE PV-TRANSFER-PROGRAM                            03510004
035200                                     TO DP013-MESSAGE-TEXT (2)    03520004
035300              SET DP013-CICS-ABEND   TO TRUE                      03530004
035400              SET DP013-NO-ROLLBACK  TO TRUE                      03540004
035500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03550004
035600              MOVE PC-TRANS-UNAVAILABLE-MSG                       03560004
035700                                     TO AMSGLNO                   03570004
035800              SET PC033-PROCESS-SCREEN TO TRUE                    03580007
035900              PERFORM 8100-SEND-DATA-ONLY                         03590004
036000              PERFORM 8200-RETURN-TRANID                          03600004
036100     END-EVALUATE.                                                03610004
036200*                                                                 03620004
036300*                                                                 03630004
036400 8000-SEND-MAP.                                                   03640004
036500     EXEC CICS                                                    03650004
036600         SEND MAP       ('PC862A')                                03660004
036700              MAPSET    ('PCKM862')                               03670004
036800              ERASE                                               03680004
036900              RESP      (PV-CICS-RESPONSE)                        03690004
037000     END-EXEC.                                                    03700004
037100                                                                  03710004
037200     EVALUATE TRUE                                                03720004
037300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03730004
037400              CONTINUE                                            03740004
037500         WHEN OTHER                                               03750004
037600              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           03760004
037700              MOVE 'UNABLE TO SEND MAP'                           03770004
037800                                     TO DP013-MESSAGE-TEXT (1)    03780004
037900              SET DP013-CICS-ABEND   TO TRUE                      03790004
038000              SET DP013-NO-ROLLBACK  TO TRUE                      03800004
038100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03810004
038200     END-EVALUATE.                                                03820004
038300*                                                                 03830009
038400*                                                                 03840009
038500 8100-SEND-DATA-ONLY.                                             03850004
038600     MOVE -1 TO ASELECTL.                                         03860004
038700                                                                  03870004
038800     EXEC CICS                                                    03880004
038900         SEND MAP       ('PC862A')                                03890004
039000              MAPSET    ('PCKM862')                               03900004
039100              CURSOR                                              03910004
039200              DATAONLY                                            03920004
039300              RESP      (PV-CICS-RESPONSE)                        03930004
039400     END-EXEC.                                                    03940004
039500                                                                  03950004
039600     EVALUATE TRUE                                                03960004
039700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03970004
039800              CONTINUE                                            03980004
039900         WHEN OTHER                                               03990004
040000              MOVE '8100-SEND-DATA-ONLY'                          04000004
040100                                     TO DP013-PARAGRAPH           04010004
040200              MOVE 'UNABLE TO SEND DATA'                          04020004
040300                                     TO DP013-MESSAGE-TEXT (1)    04030004
040400              SET DP013-CICS-ABEND   TO TRUE                      04040004
040500              SET DP013-NO-ROLLBACK  TO TRUE                      04050004
040600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              04060004
040700     END-EVALUATE.                                                04070004
040800*                                                                 04080009
040900*                                                                 04090009
041000 8200-RETURN-TRANID.                                              04100004
041100     MOVE LENGTH OF CA-COMMAREA TO PV-COMMAREA-LENGTH             04110023
041200     EXEC CICS                                                    04120004
041300         RETURN TRANSID   (PC-PC-ALTER-REASON)                    04130004
041400                COMMAREA  (CA-COMMAREA)                           04140023
041500                LENGTH    (PV-COMMAREA-LENGTH)                    04150004
041600                RESP      (PV-CICS-RESPONSE)                      04160004
041700     END-EXEC.                                                    04170004
041800                                                                  04180004
041900     EVALUATE TRUE                                                04190004
042000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04200004
042100              CONTINUE                                            04210004
042200         WHEN OTHER                                               04220004
042300              MOVE '8200-RETURN-TRANID'                           04230004
042400                                     TO DP013-PARAGRAPH           04240004
042500              MOVE 'UNABLE TO RETURN TO TRANID'                   04250004
042600                                     TO DP013-MESSAGE-TEXT (1)    04260004
042700              SET DP013-CICS-ABEND   TO TRUE                      04270004
042800              SET DP013-NO-ROLLBACK  TO TRUE                      04280004
042900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              04290004
043000     END-EVALUATE.                                                04300004
043100*                                                                 04310009
043200*                                                                 04320009
043300 8300-RETURN.                                                     04330027
043400     EXEC CICS                                                    04340027
043500         SEND FROM (PV-MESSAGE-AREA)                              04350027
043600              LENGTH (19)                                         04360027
043700              ERASE                                               04370027
043800     END-EXEC.                                                    04380027
043900                                                                  04390027
044000     EXEC CICS                                                    04400027
044100         RETURN                                                   04410027
044200     END-EXEC.                                                    04420027
044300*                                                                 04430027
044400*                                                                 04440027
044500 8400-XCTL-TO-HELP.                                               04450007
044600                                                                  04460007
044700     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       04470007
044800                                                                  04480007
044900     EXEC CICS                                                    04490007
045000         XCTL                                                     04500007
045100             PROGRAM   (PV-TRANSFER-PROGRAM)                      04510007
045200             COMMAREA  (PC192-COMMAREA)                           04520007
045300             LENGTH    (PV-COMMAREA-LENGTH)                       04530007
045400             RESP      (PV-CICS-RESPONSE)                         04540007
045500     END-EXEC.                                                    04550007
045600                                                                  04560007
045700     EVALUATE TRUE                                                04570007
045800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04580007
045900              CONTINUE                                            04590007
046000         WHEN OTHER                                               04600007
046100             MOVE '8400-XCTL-TO-HELP' TO DP013-PARAGRAPH          04610007
046200             MOVE 'PCKRF862 - UNABLE TO XCTL TO PROGRAM: '        04620008
046300                                      TO DP013-MESSAGE-TEXT (1)   04630007
046400             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   04640007
046500             SET DP013-CICS-ABEND                                 04650007
046600                 DP013-ROLLBACK       TO TRUE                     04660007
046700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               04670007
046800             MOVE PC-TRANS-UNAVAILABLE-MSG                        04680007
046900                                      TO AMSGLNO                  04690007
047000             SET PC033-PROCESS-SCREEN TO TRUE                     04700007
047100             PERFORM 8000-SEND-MAP                                04710007
047200             PERFORM 8200-RETURN-TRANID                           04720007
047300     END-EVALUATE.                                                04730007
047400*                                                                 04740007
047500*                                                                 04750007
047600 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  04760004
047700     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            04770004
047800     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           04780004
047900     INITIALIZE DP013-SRC-TASK-NUMBER                             04790004
048000                DP013-STACK.                                      04800004
048100     SET DP013-LINK-RETURN           TO TRUE.                     04810004
048200                                                                  04820004
048300     EXEC CICS                                                    04830004
048400         LINK                                                     04840004
048500             PROGRAM   (DP013-NAME)                               04850004
048600             COMMAREA  (DP013-PARAMETERS)                         04860004
048700             LENGTH    (DP013-LENGTH)                             04870004
048800     END-EXEC.                                                    04880004
048900*                                                                 04890011
049000*                                                                 04900011
049100*    ABEND PROCESSOR MODULE                                       04910011
049200     COPY DPPD014.                                                04920004
