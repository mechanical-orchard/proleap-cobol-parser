000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP375.                                        00020000
000300 AUTHOR.         BARB SCHULTZ.                                    00030000
000400 DATE-WRITTEN.   DECEMBER 2020,                                   00040000
000500*DATE-COMPILED.                                                   00050000
000600******************************************************************00060005
000700* HALLMARK REJECTION REPORT PROGRAM                              *00070005
000750* MOVED 4050 TO RETURN-CODE IF THERE ARE REJECTIONS               00071007
000800*----------------------------------------------------------------*00080006
000900* CHANGE LOG:                                                    *00090006
001000*                                                                *00100006
030001*                                                                *00101020
029700*   DATE  03/16/2023                                             *00102021
029800*   CHANGE MADE: RECOMPILE FOR UPDATED COPYBOOKS APWS050 AND     *00103020
030000*                APRD051                                         *00104020
030000*      MADE BY: JEAN KURK               WR/IR #: CHG0285404      *00104121
030001*                                                                *00105020
001500******************************************************************00150006
001600                                                                  00160006
001700 ENVIRONMENT DIVISION.                                            00170006
001800 CONFIGURATION SECTION.                                           00180006
001900                                                                  00190006
002000 SOURCE-COMPUTER. IBM-3090.                                       00200006
002100 OBJECT-COMPUTER. IBM-3090.                                       00210006
002200                                                                  00220006
002300 INPUT-OUTPUT SECTION.                                            00230006
002400 FILE-CONTROL.                                                    00240006
002500                                                                  00250006
002600      SELECT HALLMARK-REJ-FILE ASSIGN TO INP01.                   00260006
002700      SELECT HALLMARK-REPORT ASSIGN TO RPT01.                     00270006
003000                                                                  00300006
003100 DATA DIVISION.                                                   00310006
003200 FILE SECTION.                                                    00320006
003300                                                                  00330006
003400 FD  HALLMARK-REJ-FILE                                            00340006
003500     RECORDING MODE IS F                                          00350006
003600     LABEL RECORDS ARE STANDARD                                   00360006
003700     BLOCK CONTAINS 0 RECORDS                                     00370006
003800     DATA RECORD IS HALLMARK-RECORD.                              00380006
003900 01  HALLMARK-RECORD             PIC X(500).                      00390006
004000                                                                  00400006
004100 FD  HALLMARK-REPORT                                              00410006
004200     RECORDING MODE IS F                                          00420006
004300     LABEL RECORDS ARE STANDARD                                   00430006
004400     RECORD CONTAINS 132 CHARACTERS                               00440006
004500     BLOCK CONTAINS 0 RECORDS                                     00450006
004600     DATA RECORD IS HALLMARK-LINE.                                00460006
004700 01  HALLMARK-LINE               PIC X(132).                      00470006
004800                                                                  00480006
006500 WORKING-STORAGE SECTION.                                         00650006
006600*--------------------------------------------------------------*  00660006
006700* STANDARD HEADER 132 COLUMNS                                  *  00670006
006800*--------------------------------------------------------------*  00680006
006900     COPY DPWS132O.                                               00690006
007000                                                                  00700006
007100*--------------------------------------------------------------*  00710006
007200* ERROR MESSAGE CODES DESCRIPTIONS                             *  00720006
007300*--------------------------------------------------------------*  00730006
007400     COPY APWS050.                                                00740006
007500                                                                  00750006
007600*--------------------------------------------------------------*  00760006
007700* HALLMARK REJECTION REPORT FILE LAYOUT                        *  00770006
007800*--------------------------------------------------------------*  00780006
007900 01  WS-HALLMARK-REJECT-REC.                                      00790006
008000     COPY APRD051.                                                00800006
008100                                                                  00810006
008200                                                                  00820006
008300*--------------------------------------------------------------*  00830006
008400* REPORT LINES                                                 *  00840006
008500*--------------------------------------------------------------*  00850006
008600 01  DIVIDE-LINE.                                                 00860006
008700     05  FILLER                  PIC X(132)   VALUE ALL '-'.      00870006
008800                                                                  00880006
008900 01  END-OF-INVOICE-LINE.                                         00890006
009000     05  FILLER                  PIC X(07)     VALUE SPACES.      00900006
009100     05  FILLER                  PIC X(27)     VALUE              00910006
009200             'E N D   O F   I N V O I C E'.                       00920006
009300     05  FILLER                  PIC X(98)     VALUE SPACES.      00930006
009400                                                                  00940006
009500 01  EOR-END-OF-REPORT-LINE.                                      00950006
009600     05  FILLER                  PIC X(37)     VALUE SPACES.      00960006
009700     05  FILLER                  PIC X(25)     VALUE              00970006
009800             'E N D   O F   R E P O R T'.                         00980006
009900     05  FILLER                  PIC X(88)     VALUE SPACES.      00990006
010000                                                                  01000006
010100 01  ERROR-DESC-LINE.                                             01010006
010200     05  FILLER                  PIC X(08)    VALUE               01020006
010300         'ERRORS: '.                                              01030006
010400     05  FILLER                  PIC X(119)   VALUE SPACES.       01040006
010500     05  FILLER                  PIC X(005)   VALUE '*****'.      01050006
010600                                                                  01060006
010700 01  HALLMARK-824-IND-LINE.                                       01070006
010800     05  FILLER                  PIC X(09)    VALUE               01080006
010900         '824 IND: '.                                             01090006
011000     05  HALLMARK-824-IND        PIC X(01)    VALUE SPACES.       01100006
011100     05  FILLER                  PIC X(122)   VALUE SPACES.       01110006
011200                                                                  01120006
011300 01  ERROR-LINE.                                                  01130006
011400     05  ERROR-LINE-AREA.                                         01140006
011500         10  ERROR-LINE-TBL      OCCURS 2 TIMES                   01150006
011600                                 INDEXED BY ERRLN-INDX.           01160006
011700             15  ERR-ASTR-1      PIC X(01).                       01170006
011800             15  ERR-NMBR        PIC X(02).                       01180006
011900             15  ERR-ASTR-2      PIC X(01).                       01190006
012000             15  FILLER          PIC X(01).                       01200006
012100             15  ERR-DATA        PIC X(55).                       01210006
012200             15  FILLER          PIC X(03).                       01220006
012300         10  FILLER              PIC X(12)    VALUE SPACES.       01230006
014800                                                                  01480006
014900 01  TYPE1-LINE.                                                  01490006
015000     05  FILLER                  PIC X(32)    VALUE               01500006
015100         'TYPE: 01  INTERCHANGE DATA      '.                      01510006
015200     05  FILLER                  PIC X(100)   VALUE SPACES.       01520006
015300 01  TYPE1-LINE2.                                                 01530006
015400     05  FILLER                  PIC X(30)    VALUE               01540006
015500         'HALLMARK SENDER ID QUALIFIER: '.                        01550006
015600     05  TYPE1-SEND-ID-QUAL      PIC X(02)    VALUE SPACES.       01560006
015700     05  FILLER                  PIC X(04)    VALUE SPACES.       01570006
015800     05  FILLER                  PIC X(20)    VALUE               01580006
015900         'HALLMARK SENDER ID: '.                                  01590006
016000     05  TYPE1-SENDER-ID         PIC X(15)    VALUE SPACES.       01600006
016100     05  FILLER                  PIC X(04)    VALUE SPACES.       01610006
016200     05  FILLER                  PIC X(15)    VALUE               01620006
016300         'HALLMARK TYPE: '.                                       01630006
016400     05  TYPE1-PROD-TEST         PIC X(01)    VALUE SPACES.       01640006
016500     05  FILLER                  PIC X(56)    VALUE SPACES.       01650006
016600 01  TYPE1-LINE3.                                                 01660006
016700     05  FILLER                  PIC X(15)    VALUE               01670006
016800         'INTERCHG DATE: '.                                       01680006
016900     05  TYPE1-INTERCHG-YY       PIC X(02)    VALUE SPACES.       01690006
017000     05  FILLER                  PIC X(01)    VALUE '/'.          01700006
017100     05  TYPE1-INTERCHG-MM       PIC X(02)    VALUE SPACES.       01710006
017200     05  FILLER                  PIC X(01)    VALUE '/'.          01720006
017300     05  TYPE1-INTERCHG-DD       PIC X(02)    VALUE SPACES.       01730006
017400     05  FILLER                  PIC X(04)    VALUE SPACES.       01740006
017500     05  FILLER                  PIC X(06)    VALUE 'TIME: '.     01750006
017600     05  FILLER                  PIC X(01)    VALUE SPACE.        01760006
017700     05  TYPE1-HH                PIC X(02)    VALUE SPACES.       01770006
017800     05  FILLER                  PIC X(01)    VALUE ':'.          01780006
017900     05  TYPE1-MM                PIC X(02)    VALUE SPACES.       01790006
018000     05  FILLER                  PIC X(04)    VALUE SPACES.       01800006
018100     05  FILLER                  PIC X(19)    VALUE               01810006
018200         'INTERCHG CNTL NBR: '.                                   01820006
018300     05  TYPE1-INTERCHG-CNTL     PIC X(09)    VALUE SPACES.       01830006
018400     05  FILLER                  PIC X(02)    VALUE SPACES.       01840006
018500     05  FILLER                  PIC X(13)    VALUE               01850006
018600         'GS CNTL NBR: '.                                         01860006
018700     05  TYPE1-GS-NBR            PIC X(09)    VALUE SPACES.       01870006
018800     05  FILLER                  PIC X(02)    VALUE SPACES.       01880006
018900     05  FILLER                  PIC X(13)    VALUE               01890006
019000         'TS CNTL NBR: '.                                         01900006
019100     05  TYPE1-TS-NBR            PIC X(09)    VALUE SPACES.       01910006
019200     05  FILLER                  PIC X(15)    VALUE SPACES.       01920006
019300                                                                  01930006
019400 01  TYPE2-LINE.                                                  01940006
019500     05  FILLER                  PIC X(32)    VALUE               01950006
019600         'TYPE: 02  INVOICE DATA          '.                      01960006
019700     05  FILLER                  PIC X(100)   VALUE SPACES.       01970006
019800 01  TYPE2-LINE2.                                                 01980006
019900     05  FILLER                  PIC X(11)    VALUE               01990006
020000         'STORE NO1: '.                                           02000006
020100     05  TYPE2-STORE-NBR1        PIC X(05)    VALUE SPACES.       02010006
020200     05  FILLER                  PIC X(04)    VALUE SPACES.       02020006
020300     05  FILLER                  PIC X(11)    VALUE               02030006
020400         'STORE NO2: '.                                           02040006
020500     05  TYPE2-STORE-NBR2        PIC X(05)    VALUE SPACES.       02050006
020600     05  FILLER                  PIC X(04)    VALUE SPACES.       02060006
020700     05  FILLER                  PIC X(19)    VALUE               02070006
020800         'LADING CARRIER ID: '.                                   02080006
020900     05  TYPE2-LAD-CARR          PIC X(16)    VALUE SPACES.       02090006
021000     05  FILLER                  PIC X(57)    VALUE SPACES.       02100006
021100                                                                  02110006
021200 01  TYPE2-LINE3.                                                 02120006
021300     05  FILLER                  PIC X(14)    VALUE               02130006
021400         'INVOICE DATE: '.                                        02140006
021500     05  TYPE2-INV-YY            PIC X(02)    VALUE SPACES.       02150006
021600     05  FILLER                  PIC X(01)    VALUE '/'.          02160006
021700     05  TYPE2-INV-MM            PIC X(02)    VALUE SPACES.       02170006
021800     05  FILLER                  PIC X(01)    VALUE '/'.          02180006
021900     05  TYPE2-INV-DD            PIC X(02)    VALUE SPACES.       02190006
022000     05  FILLER                  PIC X(06)    VALUE SPACES.       02200006
022100     05  FILLER                  PIC X(14)    VALUE               02210006
022200         'DATE SHIPPED: '.                                        02220006
022300     05  TYPE2-SHP-YY            PIC X(02)    VALUE SPACES.       02230006
022400     05  FILLER                  PIC X(01)    VALUE '/'.          02240006
022500     05  TYPE2-SHP-MM            PIC X(02)    VALUE SPACES.       02250006
022600     05  FILLER                  PIC X(01)    VALUE '/'.          02260006
022700     05  TYPE2-SHP-DD            PIC X(02)    VALUE SPACES.       02270006
022800     05  FILLER                  PIC X(06)    VALUE SPACES.       02280006
022900     05  FILLER                  PIC X(16)    VALUE               02290006
023000         'EFFECTIVE DATE: '.                                      02300006
023100     05  TYPE2-EFF-YY            PIC X(02)    VALUE SPACES.       02310006
023200     05  FILLER                  PIC X(01)    VALUE '/'.          02320006
023300     05  TYPE2-EFF-MM            PIC X(02)    VALUE SPACES.       02330006
023400     05  FILLER                  PIC X(01)    VALUE '/'.          02340006
023500     05  TYPE2-EFF-DD            PIC X(02)    VALUE SPACES.       02350006
023600     05  FILLER                  PIC X(52)    VALUE SPACES.       02360006
023700                                                                  02370006
023800 01  TYPE3-LINE.                                                  02380006
023900     05  FILLER                  PIC X(32)    VALUE               02390006
024000         'TYPE: 03  REMIT INSTRUCTIONS    '.                      02400006
024100     05  FILLER                  PIC X(100)   VALUE SPACES.       02410006
024200 01  TYPE3-LINE2.                                                 02420006
024300     05  FILLER                  PIC X(22)    VALUE               02430006
024400         'REMIT VENDOR DUNS NO: '.                                02440006
024500     05  TYPE3-DUNS-NBR          PIC X(09)    VALUE SPACES.       02450006
024600     05  FILLER                  PIC X(03)    VALUE SPACES.       02460006
024700     05  FILLER                  PIC X(15)    VALUE               02470006
024800         'REMIT TO NAME: '.                                       02480006
024900     05  TYPE3-NAME              PIC X(25)    VALUE SPACES.       02490006
025000     05  FILLER                  PIC X(58)    VALUE SPACES.       02500006
025100 01  TYPE3-LINE3.                                                 02510006
025200     05  FILLER                  PIC X(40)    VALUE SPACES.       02520006
025300     05  FILLER                  PIC X(09)    VALUE               02530006
025400         'ADDRESS: '.                                             02540006
025500     05  TYPE3-ADDR1             PIC X(25)    VALUE SPACES.       02550006
025600     05  FILLER                  PIC X(58)    VALUE SPACES.       02560006
025700 01  TYPE3-LINE4.                                                 02570006
025800     05  FILLER                  PIC X(40)    VALUE SPACES.       02580006
025900     05  FILLER                  PIC X(09)    VALUE               02590006
026000         '         '.                                             02600006
026100     05  TYPE3-ADDR2             PIC X(25)    VALUE SPACES.       02610006
026200     05  FILLER                  PIC X(58)    VALUE SPACES.       02620006
026300 01  TYPE3-LINE5.                                                 02630006
026400     05  FILLER                  PIC X(49)    VALUE SPACES.       02640006
026500     05  TYPE3-CITY              PIC X(19)    VALUE SPACES.       02650006
026600     05  FILLER                  PIC X(03)    VALUE SPACES.       02660006
026700     05  TYPE3-STATE             PIC X(02)    VALUE SPACES.       02670006
026800     05  FILLER                  PIC X(01)    VALUE SPACE.        02680006
026900     05  TYPE3-ZIP-5             PIC X(05)    VALUE SPACES.       02690006
027000     05  FILLER                  PIC X(01)    VALUE '-'.          02700006
027100     05  TYPE3-ZIP-4             PIC X(04)    VALUE SPACES.       02710006
027200     05  FILLER                  PIC X(58)    VALUE SPACES.       02720006
027300                                                                  02730006
027400 01  TYPE4-LINE.                                                  02740006
027500     05  FILLER                  PIC X(32)    VALUE               02750006
027600         'TYPE: 04  TERMS DATA            '.                      02760006
027700     05  FILLER                  PIC X(100)   VALUE SPACES.       02770006
027800 01  TYPE4-LINE2.                                                 02780006
027900     05  FILLER                  PIC X(16)    VALUE               02790006
028000         'TERMS TYPE CD:  '.                                      02800006
028100     05  TYPE4-TERMS-TYPE        PIC X(12)    VALUE SPACES.       02810006
028200     05  FILLER                  PIC X(12)    VALUE SPACES.       02820006
028300     05  FILLER                  PIC X(11)    VALUE               02830006
028400         'DISC PCT: '.                                            02840006
028500     05  FILLER                  PIC X(06)    VALUE SPACES.       02850006
028600     05  TYPE4-DISC-PCT          PIC ZZZ.99-.                     02860006
028700     05  FILLER                  PIC X(01)    VALUE '%'.          02870006
028800     05  FILLER                  PIC X(05)    VALUE SPACES.       02880006
028900     05  FILLER                  PIC X(22)    VALUE               02890006
029000         'DEFERRED PCT PAYABLE: '.                                02900006
029100     05  TYPE4-DEF-PCT-PAY       PIC ZZZ.99-.                     02910006
029200     05  FILLER                  PIC X(01)    VALUE '%'.          02920006
029300     05  FILLER                  PIC X(32)    VALUE SPACES.       02930006
029400 01  TYPE4-LINE3.                                                 02940006
029500     05  FILLER                  PIC X(22)    VALUE               02950006
029600         'TERMS BASIS DATE CD:  '.                                02960006
029700     05  TYPE4-BAS-DTE-CD        PIC X(12)    VALUE SPACES.       02970006
029800     05  FILLER                  PIC X(06)    VALUE SPACES.       02980006
029900     05  FILLER                  PIC X(15)    VALUE               02990006
030000         'DISC DUE DATE: '.                                       03000006
030100     05  TYPE4-DISC-DUE-YY       PIC X(02)    VALUE SPACES.       03010006
030200     05  FILLER                  PIC X(01)    VALUE '/'.          03020006
030300     05  TYPE4-DISC-DUE-MM       PIC X(02)    VALUE SPACES.       03030006
030400     05  FILLER                  PIC X(01)    VALUE '/'.          03040006
030500     05  TYPE4-DISC-DUE-DD       PIC X(02)    VALUE SPACES.       03050006
030600     05  FILLER                  PIC X(07)    VALUE SPACES.       03060006
030700     05  FILLER                  PIC X(20)    VALUE               03070006
030800         'DEFERRED DUE DATE:  '.                                  03080006
030900     05  TYPE4-DEF-DUE-YY        PIC X(02)    VALUE SPACES.       03090006
031000     05  FILLER                  PIC X(01)    VALUE '/'.          03100006
031100     05  TYPE4-DEF-DUE-MM        PIC X(02)    VALUE SPACES.       03110006
031200     05  FILLER                  PIC X(01)    VALUE '/'.          03120006
031300     05  TYPE4-DEF-DUE-DD        PIC X(02)    VALUE SPACES.       03130006
031400     05  FILLER                  PIC X(03)    VALUE SPACES.       03140006
031500     05  FILLER                  PIC X(32)    VALUE SPACES.       03150006
031600 01  TYPE4-LINE4.                                                 03160006
031700     05  FILLER                  PIC X(16)    VALUE               03170006
031800         'NET DUE DATE :  '.                                      03180006
031900     05  TYPE4-NET-DUE-YY        PIC X(02)    VALUE SPACES.       03190006
032000     05  FILLER                  PIC X(01)    VALUE '/'.          03200006
032100     05  TYPE4-NET-DUE-MM        PIC X(02)    VALUE SPACES.       03210006
032200     05  FILLER                  PIC X(01)    VALUE '/'.          03220006
032300     05  TYPE4-NET-DUE-DD        PIC X(02)    VALUE SPACES.       03230006
032400     05  FILLER                  PIC X(16)    VALUE SPACES.       03240006
032500     05  FILLER                  PIC X(15)    VALUE               03250006
032600         'DISC DAYS DUE: '.                                       03260006
032700     05  TYPE4-DISC-DAYS-DUE     PIC ZZ9      VALUE ZEROS.        03270006
032800     05  FILLER                  PIC X(12)    VALUE SPACES.       03280006
032900     05  FILLER                  PIC X(23)    VALUE               03290006
033000         'NET DEFERRED DAYS DUE: '.                               03300006
033100     05  FILLER                  PIC X(02)    VALUE SPACES.       03310006
033200     05  TYPE4-NET-DEF-DAYS      PIC ZZ9.                         03320006
033300     05  FILLER                  PIC X(06)    VALUE SPACES.       03330006
033400     05  FILLER                  PIC X(32)    VALUE SPACES.       03340006
033500 01  TYPE4-LINE5.                                                 03350006
033600     05  FILLER                  PIC X(40)    VALUE SPACES.       03360006
033700     05  FILLER                  PIC X(10)    VALUE               03370006
033800         'DISC AMT: '.                                            03380006
033900     05  TYPE4-DISC-AMT          PIC $$$$,$$$.99-.                03390006
034000     05  FILLER                  PIC X(08)    VALUE SPACES.       03400006
034100     05  FILLER                  PIC X(14)    VALUE               03410006
034200         'DEFERRED AMT: '.                                        03420006
034300     05  FILLER                  PIC X(03)    VALUE SPACES.       03430006
034400     05  TYPE4-DEF-AMT           PIC $$$$,$$$.99-.                03440006
034500     05  FILLER                  PIC X(01)    VALUE SPACES.       03450006
034600     05  FILLER                  PIC X(32)    VALUE SPACES.       03460006
034700                                                                  03470006
034800 01  TYPE5-LINE.                                                  03480006
034900     05  FILLER                  PIC X(32)    VALUE               03490006
035000         'TYPE: 05  ALLOWANCE/CHARGE DATA '.                      03500006
035100     05  FILLER                  PIC X(100)   VALUE SPACES.       03510006
035200 01  TYPE5-LINE2.                                                 03520006
035300     05  FILLER                  PIC X(16)    VALUE               03530006
035400         'ALLW/CHRG TYPE: '.                                      03540006
035500     05  TYPE5-ALLW-CHRG-TYPE    PIC X(11)   VALUE SPACE.         03550006
035600     05  FILLER                  PIC X(08)   VALUE SPACES.        03560006
035700     05  FILLER                  PIC X(16)   VALUE                03570006
035800         'ALLW/CHRG CODE: '.                                      03580006
035900     05  TYPE5-ALLW-CHRG-CD      PIC X(16)   VALUE SPACES.        03590006
036000     05  FILLER                  PIC X(02)   VALUE SPACES.        03600006
036100     05  FILLER                  PIC X(16)   VALUE                03610006
036200         'SPEC SRVC CODE: '.                                      03620006
036300     05  TYPE5-SPEC-SRVC-CD      PIC X(10)   VALUE SPACES.        03630006
036400     05  FILLER                  PIC X(02)   VALUE SPACES.        03640006
036500     05  FILLER                  PIC X(18)   VALUE                03650006
036600         'ALLW/CHRG METHOD: '.                                    03660006
036700     05  TYPE5-ALLW-CHRG-MTHD    PIC X(12)   VALUE SPACES.        03670006
036800     05  FILLER                  PIC X(19)   VALUE SPACES.        03680006
036900 01  TYPE5-LINE3.                                                 03690006
037000     05  FILLER                  PIC X(17)   VALUE                03700006
037100         'ALLW/CHRG TOTAL: '.                                     03710006
037200     05  TYPE5-ALLW-CHRG-TOTL    PIC $$$,$$$,$$$.99-.             03720006
037300     05  FILLER                  PIC X(03)   VALUE SPACES.        03730006
037400     05  FILLER                  PIC X(15)   VALUE                03740006
037500         'ALLW/CHRG PCT: '.                                       03750006
037600     05  TYPE5-ALLW-CHRG-PCT     PIC ZZZ.99-.                     03760006
037700     05  FILLER                  PIC X(01)   VALUE '%'.           03770006
037800     05  FILLER                  PIC X(11)   VALUE SPACES.        03780006
037900     05  FILLER                  PIC X(25)   VALUE                03790006
038000         'ALLW/CHRG PCT QUALIFIER: '.                             03800006
038100     05  TYPE5-ALLW-CHRG-QUAL    PIC X(10)   VALUE SPACE.         03810006
038200     05  FILLER                  PIC X(23)   VALUE SPACES.        03820006
038300                                                                  03830006
038400 01  TYPE6-LINE.                                                  03840006
038500     05  FILLER                  PIC X(32)    VALUE               03850006
038600         'TYPE: 06  SUMMARY DATA          '.                      03860006
038700     05  FILLER                  PIC X(100)   VALUE SPACES.       03870006
038800 01  TYPE6-LINE2.                                                 03880006
038900     05  FILLER                  PIC X(20)    VALUE               03890006
039000         'QUANTITY SHIPPED:   '.                                  03900006
039100     05  TYPE6-QTY-SHIP          PIC ZZ,ZZZ,ZZZ.99-.              03910006
039200     05  FILLER                  PIC X(02)    VALUE SPACES.       03920006
039300     05  FILLER                  PIC X(25)    VALUE               03930006
039400         'SHIPPED UNIT OF MEASURE: '.                             03940006
039500     05  TYPE6-SHIP-UOM          PIC X(09)    VALUE SPACES.       03950006
039600     05  FILLER                  PIC X(62)    VALUE SPACES.       03960006
039700 01  TYPE6-LINE3.                                                 03970006
039800     05  FILLER                  PIC X(19)    VALUE               03980006
039900         'GROSS INVOICE AMT: '.                                   03990006
040000     05  TYPE6-GROSS-INV-AMT     PIC $$$,$$$,$$$.99-.             04000006
040100     05  FILLER                  PIC X(02)    VALUE SPACES.       04010006
040200     05  FILLER                  PIC X(18)    VALUE               04020006
040300         'AMT SUBJ TO DISC: '.                                    04030006
040400     05  TYPE6-AMT-SUBJ-DISC     PIC $$$,$$$,$$$.99-.             04040006
040500     05  FILLER                  PIC X(02)    VALUE SPACES.       04050006
040600     05  FILLER                  PIC X(10)    VALUE               04060006
040700         'DISC AMT: '.                                            04070006
040800     05  TYPE6-DISC-AMT          PIC $$$,$$$,$$$.99-.             04080006
040900     05  FILLER                  PIC X(02)    VALUE SPACES.       04090006
041000     05  FILLER                  PIC X(14)    VALUE               04100006
041100         'DISC AMT DUE: '.                                        04110006
041200     05  TYPE6-DISC-AMT-DUE      PIC $$$,$$$,$$$.99-.             04120006
041300     05  FILLER                  PIC X(03)    VALUE SPACES.       04130006
041400                                                                  04140006
041500 01  TYPE7-LINE.                                                  04150006
041600     05  FILLER                  PIC X(32)    VALUE               04160006
041700         'TYPE: 07  DETAIL INVOICE DATA   '.                      04170006
041800     05  FILLER                  PIC X(100)   VALUE SPACES.       04180006
041900 01  TYPE7-LINE2.                                                 04190006
042000     05  FILLER                  PIC X(14)    VALUE               04200006
042100         'ID QUALIFIER: '.                                        04210006
042200     05  TYPE7-ID-QUAL           PIC X(02)    VALUE SPACES.       04220006
042300     05  FILLER                  PIC X(04)    VALUE SPACES.       04230006
042400     05  FILLER                  PIC X(04)    VALUE SPACES.       04240006
042500     05  TYPE7-UPC-TITLE         PIC X(10).                       04250006
042600     05  TYPE7-EAN-UPC           PIC X(16)    VALUE SPACES.       04260006
042700     05  FILLER                  PIC X(10)    VALUE               04270006
042800         '     SKU: '.                                            04280006
042900     05  TYPE7-SKU               PIC X(08)    VALUE SPACES.       04290006
043000     05  FILLER                  PIC X(92)    VALUE SPACES.       04300006
043100 01  TYPE7-LINE3.                                                 04310006
043200     05  FILLER                  PIC X(14)    VALUE               04320006
043300         'VENDOR STYLE: '.                                        04330006
043400     05  TYPE7-VNDR-STYLE        PIC X(20)    VALUE SPACES.       04340006
043500     05  FILLER                  PIC X(06)    VALUE SPACES.       04350006
043600     05  FILLER                  PIC X(17)    VALUE               04360006
043700         'NORMAL COLOR CD: '.                                     04370006
043800     05  TYPE7-NRML-CD           PIC X(03)    VALUE SPACES.       04380006
043900     05  FILLER                  PIC X(20)    VALUE SPACES.       04390006
044000     05  FILLER                  PIC X(11)    VALUE               04400006
044100         'SIZE CD:   '.                                           04410006
044200     05  TYPE7-SIZE-CD           PIC X(05)    VALUE SPACES.       04420006
044300     05  FILLER                  PIC X(36)    VALUE SPACES.       04430006
044400 01  TYPE7-LINE4.                                                 04440006
044500     05  FILLER                  PIC X(14)    VALUE               04450006
044600         'STYLE DESC:   '.                                        04460006
044700     05  TYPE7-VNDR-STYLE-DESC   PIC X(25)    VALUE SPACES.       04470006
044800     05  FILLER                  PIC X(01)    VALUE SPACES.       04480006
044900     05  FILLER                  PIC X(12)    VALUE               04490006
045000         'COLOR DESC: '.                                          04500006
045100     05  TYPE7-COLOR-DESC        PIC X(25)    VALUE SPACES.       04510006
045200     05  FILLER                  PIC X(03)    VALUE SPACES.       04520006
045300     05  FILLER                  PIC X(11)    VALUE               04530006
045400         'SIZE DESC: '.                                           04540006
045500     05  TYPE7-SIZE-DESC         PIC X(25)    VALUE SPACES.       04550006
045600     05  FILLER                  PIC X(56)    VALUE SPACES.       04560006
045700 01  TYPE7-LINE5.                                                 04570006
045800     05  FILLER                  PIC X(19)    VALUE               04580006
045900         'QUANTITY INVOICED: '.                                   04590006
046000     05  TYPE7-QTY-INVD          PIC ZZZ,ZZZ.99-.                 04600006
046100     05  FILLER                  PIC X(10)    VALUE SPACES.       04610006
046200     05  FILLER                  PIC X(17)    VALUE               04620006
046300         'UNIT OF MEASURE: '.                                     04630006
046400     05  TYPE7-UOM               PIC X(09)    VALUE SPACES.       04640006
046500     05  FILLER                  PIC X(04)    VALUE SPACES.       04650006
046600     05  FILLER                  PIC X(10)    VALUE SPACES.       04660006
046700     05  TYPE7-UNT-CST-TITLE     PIC X(11).                       04670006
046800     05  TYPE7-WHOL-COST         PIC $$,$$$,$$$.99-.              04680006
046900     05  FILLER                  PIC X(27)    VALUE SPACES.       04690006
047000                                                                  04700006
047100 01  TYPE7-LINE6.                                                 04710006
047200     05  FILLER                  PIC X(22)    VALUE               04720006
047300         'PACKITEM SUMMED COST: '.                                04730006
047400     05  TYPE7-PK-ITEM-SUMD-COST PIC $$,$$$,$$$.99-.              04740006
047500     05  FILLER                  PIC X(96)    VALUE SPACES.       04750006
047600                                                                  04760006
047700 01  TYPE-OTH-LINE.                                               04770006
047800     05  FILLER                  PIC X(06)    VALUE               04780006
047900         'TYPE: '.                                                04790006
048000     05  TYPE-OTH-REC-TYPE       PIC X(02)    VALUE SPACES.       04800006
048100     05  FILLER                  PIC X(02)    VALUE SPACES.       04810006
048200     05  FILLER                  PIC X(22)    VALUE SPACES.       04820006
048300     05  FILLER                  PIC X(100)   VALUE SPACES.       04830006
048400                                                                  04840006
048500 01  CALC-GROSS-LINE.                                             04850006
048600     05  FILLER                  PIC X(32)    VALUE               04860006
048700         'CALCULATED INVOICE EXTENSION =  '.                      04870006
048800     05  CALC-GROSS-EXTEN        PIC $$$$,$$$,$$$.99-.            04880006
048900     05  FILLER                  PIC X(20)    VALUE               04890006
049000         '  GROSS INVOICED =  '.                                  04900006
049100     05  GROSS-INVOICED          PIC $$$$,$$$,$$$.99-.            04910006
049200     05  FILLER                  PIC X(084)   VALUE SPACES.       04920006
049300                                                                  04930006
049400*--------------------------------------------------------------*  04940006
049500* REPORT HEADING LINES                                         *  04950006
049600*--------------------------------------------------------------*  04960006
049700 01  HL-HEADING-LINE1.                                            04970006
049800     05  FILLER                  PIC X(50)     VALUE SPACES.      04980006
049900     05  FILLER                  PIC X(35)     VALUE              04990006
050000             ' HALLMARK INVOICE REJECTION REPORT '.               05000006
050100     05  FILLER                  PIC X(05)     VALUE SPACES.      05010006
050200     05  HEADER-TYPE             PIC X(25)     VALUE SPACES.      05020006
050300     05  FILLER                  PIC X(20)     VALUE SPACES.      05030006
050400                                                                  05040006
050500 01  HL-HEADING-LINE2.                                            05050006
050600     05  FILLER                  PIC X(15)     VALUE              05060006
050700         'VENDOR DUN NO: '.                                       05070006
050800     05  HL2-VENDOR-NBR          PIC ZZZZZZZZ9.                   05080006
050900     05  FILLER                  PIC X(02)     VALUE SPACES.      05090006
051000     05  HL2-ENT-ID-DESC         PIC X(25)     VALUE SPACES.      05100006
051100     05  FILLER                  PIC X(04)     VALUE SPACES.      05110006
051200     05  FILLER                  PIC X(11)     VALUE              05120006
051300         'INVOICE # '.                                            05130006
051400     05  HL2-INVOICE-NBR         PIC X(22)     VALUE SPACES.      05140006
051500     05  FILLER                  PIC X(07)     VALUE SPACES.      05150006
051600     05  FILLER                  PIC X(05)     VALUE 'PO # '.     05160006
051700     05  HL2-PO-NBR              PIC ZZZZZZZZ9.                   05170006
051800     05  FILLER                  PIC X(02)     VALUE SPACES.      05180006
051900     05  FILLER                  PIC X(06)     VALUE 'ISA # '.    05190006
052000     05  HL2-INTERCHG-CNTL-NBR   PIC ZZZZZZZZ9.                   05200006
052100                                                                  05210006
053800 01  NO-DATA-LINE.                                                05380006
053900     05  FILLER                  PIC X(44)     VALUE SPACES.      05390006
054000     05  FILLER                  PIC X(41)     VALUE              05400006
054100             ' NO REJECTION INVOICES FOR THIS RUN      '.         05410006
054200     05  FILLER                  PIC X(46)     VALUE SPACES.      05420006
054400                                                                  05440006
054500 01  PC-PROGRAM-CONSTANTS.                                        05450006
054600     05  PC-SLASH                PIC X(01)     VALUE '/'.         05460006
054700     05  PC-DASH                 PIC X(01)     VALUE '-'.         05470006
054400                                                                  05471014
054800 01  PV-PROGRAM-VARIABLES.                                        05480006
054900     05  PV-ABEND-CODE           PIC S9(04)    VALUE ZEROES       05490006
055000                                               COMP.              05500006
055100                                                                  05510006
055200     05  PV-PROGRAM-NAME         PIC X(08)     VALUE 'APKRP375'.  05520006
055300     05  PV-LINE-COUNT           PIC S9(03)    VALUE ZEROES       05530006
055400                                               COMP-3.            05540006
055500     05  PV-LINE-COUNT-2         PIC S9(03)    VALUE ZEROES       05550006
055600                                               COMP-3.            05560006
056100     05  PV-LINE-LIMIT           PIC S9(03)    VALUE +60          05610006
056200                                               COMP-3.            05620006
056300     05  PV-PAGE-COUNT           PIC S9(06)    VALUE ZEROES       05630006
056400                                               COMP-3.            05640006
056900     05  PV-HALLMARK-ERROR-MSG   PIC X(75)     VALUE SPACES.      05690006
057000     05  PV-AP-EDIT-CODE         PIC 9(02)     VALUE ZERO.        05700006
057100     05  PV-DISC-AMT-DUE         PIC 999,999,999.99-.             05710006
057200     05  PV-GROSS-INV-AMT        PIC 999,999,999.99-.             05720006
057300     05  PV-TOT-INVC-LINES       PIC ZZ,ZZZ,ZZ9.                  05730006
057400                                                                  05740006
057500 01  WS-PROGRAM-SWITCHES.                                         05750006
057600     05  WS-HALLMARK-REJ-EOF-SW  PIC X(01)    VALUE 'N'.          05760006
057700         88  WS-HALLMARK-REJ-EOF     VALUE 'Y'.                   05770006
057800     05  WS-HALLMARK-EMPTY-FILE-SW PIC X(01)  VALUE 'N'.          05780006
057900         88  WS-HALLMARK-REJ-EMPTY-FILE VALUE 'Y'.                05790006
058000     05  WS-ERR-DETAIL-GROSS-INV PIC X(01)    VALUE 'N'.          05800006
058100         88  ERR-DETAIL-GROSS-INVOICE         VALUE 'Y'.          05810006
058200         88  NO-ERR-DETAIL-GROSS-INVOICE      VALUE 'N'.          05820006
058300     05  WS-AP-ERR-LINE-SWITCH   PIC X(01)    VALUE 'N'.          05830006
058400         88  AP-ERR-LINE                      VALUE 'Y'.          05840006
058500         88  NO-AP-ERR-LINE                   VALUE 'N'.          05850006
058600     05  WS-HALLMARK-ERR-LINE-SWITCH PIC X(01) VALUE 'N'.         05860006
058700         88  HALLMARK-ERR-LINE                VALUE 'Y'.          05870006
058800         88  NO-HALLMARK-ERR-LINE             VALUE 'N'.          05880006
058900     05  WS-HALLMARK-FIRST-TIME-SWITCH PIC X(01) VALUE 'Y'.       05890006
059000         88  HALLMARK-FIRST-TIME              VALUE 'Y'.          05900006
059100         88  HALLMARK-NOT-FIRST-TIME          VALUE 'N'.          05910006
059200     05  WS-AP-FIRST-TIME-SWITCH   PIC X(01)  VALUE 'Y'.          05920006
059300         88  AP-FIRST-TIME                    VALUE 'Y'.          05930006
059400         88  AP-NOT-FIRST-TIME                VALUE 'N'.          05940006
059500     05  WS-AP-EDIT-CODE    PIC 9(02)    VALUE ZERO.              05950006
059600         88  AP-EDIT                                              05960006
059700             VALUE 06 50 65 74 80 28 29 33 18 71 75.              05970006
059800                                                                  05980006
060100 01  SD-SYSTEM-DATE.                                              06010006
060200     05  SD-SYSTEM-YEAR          PIC 9(02)     VALUE ZEROES.      06020006
060300     05  SD-SYSTEM-MONTH         PIC 9(02)     VALUE ZEROES.      06030006
060400     05  SD-SYSTEM-DAY           PIC 9(02)     VALUE ZEROES.      06040006
060500                                                                  06050006
060600 01  ST-SYSTEM-TIME.                                              06060006
060700     05  ST-SYSTEM-HOUR          PIC 9(02)     VALUE ZEROES.      06070006
060800     05  ST-SYSTEM-MINUTE        PIC 9(02)     VALUE ZEROES.      06080006
060900     05  FILLER                  PIC X(04)     VALUE SPACES.      06090006
061000                                                                  06100006
061100 01  SUMM-ERR-TABLE.                                              06110006
061200     05  SUMM-ERR-FLAG-AREA      OCCURS 99 TIMES                  06120006
061300                                 INDEXED BY FLG-INDX.             06130006
061400         10  SUMM-ERR-FLAG       PIC X(01).                       06140006
061500                                                                  06150006
061600*------------------------*                                        06160006
061700 PROCEDURE DIVISION.                                              06170006
061800*------------------------*                                        06180006
061900 A000-MAIN-DRIVER.                                                06190006
062000                                                                  06200006
062100*--------------------------------------------------------------*  06210006
062200* THIS MODULE CONTROLS THE OVERALL FLOW OF THE PROGRAM THROUGH *  06220006
062300* TO ITS END.                                                  *  06230006
062400*--------------------------------------------------------------*  06240006
062500                                                                  06250006
062600     OPEN INPUT  HALLMARK-REJ-FILE                                06260006
062700          OUTPUT HALLMARK-REPORT.                                 06270008
063000                                                                  06300006
063100     PERFORM H000-HOUSEKEEPING.                                   06310006
063200     IF NOT WS-HALLMARK-REJ-EMPTY-FILE                            06320006
063300        PERFORM B000-PROCESS                                      06330006
063400             UNTIL WS-HALLMARK-REJ-EOF                            06340006
063500     END-IF.                                                      06350006
063600     PERFORM Z900-END-OF-JOB.                                     06360006
063700     STOP RUN.                                                    06370006
063800                                                                  06380006
063900*--------------------------------------------------------------*  06390006
064000* PROCESS THE HALLMARK TRANSMISSION REJECTED INVOICES          *  06400006
064100*--------------------------------------------------------------*  06410006
064200 B000-PROCESS.                                                    06420006
064300                                                                  06430006
064400     IF AP051-SORT-INVOICE-NBR NOT = HL2-INVOICE-NBR              06440006
064600        PERFORM W700-END-OF-INVOICE-LINE                          06460006
064700*       MOVE AP051-EXTENT-DUN-NBR      TO HL2-VENDOR-NBR          06470016
064700        MOVE AP051-SORT-VENDOR-NBR     TO HL2-VENDOR-NBR          06471016
064800        MOVE AP051-SORT-INVOICE-NBR    TO HL2-INVOICE-NBR         06481015
064900        MOVE AP051-KOHLS-PO-NBR        TO HL2-PO-NBR              06490006
065000        SET NO-ERR-DETAIL-GROSS-INVOICE TO TRUE                   06500006
065100        MOVE AP051-VENDOR-DESC         TO HL2-ENT-ID-DESC         06510006
065200        MOVE AP051-SAVE-INTERCHG-CNTL-NBR TO HL2-INTERCHG-CNTL-NBR06520006
065300        MOVE AP051-EDI-824-IND       TO HALLMARK-824-IND          06530006
065400        PERFORM W200-HEADING-ROUTINE                              06540006
065500     END-IF.                                                      06550006
065600                                                                  06560006
065700     EVALUATE AP051-RECORD-TYPE-IND                               06570006
065800        WHEN '01'                                                 06580006
065900             PERFORM C000-TYPE1                                   06590006
066000        WHEN '02'                                                 06600006
066100             PERFORM C100-TYPE2                                   06610006
066200        WHEN '03'                                                 06620006
066300             PERFORM C200-TYPE3                                   06630006
066400        WHEN '04'                                                 06640006
066500             PERFORM C300-TYPE4                                   06650006
066600        WHEN '05'                                                 06660006
066700             PERFORM C400-TYPE5                                   06670006
066800        WHEN '06'                                                 06680006
066900             PERFORM C500-TYPE6                                   06690006
067000        WHEN '07'                                                 06700006
067100             PERFORM C600-TYPE7                                   06710006
067300        WHEN HIGH-VALUES                                          06730006
067400             PERFORM C650-HIGH-VALUES                             06740006
067500        WHEN OTHER                                                06750006
067600             PERFORM C700-INVALID-TYPE                            06760006
067700     END-EVALUATE.                                                06770006
067800                                                                  06780006
067900** CHECK FOR ERRORS IN THE ERROR CODE AREA **                     06790006
068000     IF AP051-ERR-CD(1) = 0                                       06800006
068100        NEXT SENTENCE                                             06810006
068200     ELSE                                                         06820006
068300        PERFORM E100-ERROR-ROUTINE                                06830006
068400     END-IF.                                                      06840006
068500                                                                  06850006
068600     PERFORM W400-PRINT-DIVIDE-LINE.                              06860006
068700                                                                  06870006
068800     PERFORM R100-READ-HALLMARK-REJECT.                           06880006
068900                                                                  06890006
069000*--------------------------------------------------------------*  06900006
069100* PROCESS THE INTERCHANGE RECORD                               *  06910006
069200*--------------------------------------------------------------*  06920006
069300 C000-TYPE1.                                                      06930006
069400                                                                  06940006
069500     MOVE AP051-EDI-SENDER-ID-QUAL   TO TYPE1-SEND-ID-QUAL.       06950006
069600     MOVE AP051-EDI-SENDER-ID        TO TYPE1-SENDER-ID.          06960006
069700     MOVE AP051-INTERCHG-DTE-YY      TO TYPE1-INTERCHG-YY.        06970006
069800     MOVE AP051-INTERCHG-DTE-MM      TO TYPE1-INTERCHG-MM.        06980006
069900     MOVE AP051-INTERCHG-DTE-DD      TO TYPE1-INTERCHG-DD.        06990006
070000     MOVE AP051-INTERCHG-TME-HH      TO TYPE1-HH.                 07000006
070100     MOVE AP051-INTERCHG-TME-MM      TO TYPE1-MM.                 07010006
070200     MOVE AP051-INTERCHG-CNTL-NBR    TO TYPE1-INTERCHG-CNTL.      07020006
070300     MOVE AP051-GS-CNTL-NBR          TO TYPE1-GS-NBR.             07030006
070400     MOVE AP051-TS-CNTL-NBR          TO TYPE1-TS-NBR.             07040006
070500     MOVE AP051-PROD-TEST-IND        TO TYPE1-PROD-TEST.          07050006
070600                                                                  07060006
070700     ADD 4 TO PV-LINE-COUNT.                                      07070006
070800     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            07080006
070900        PERFORM W200-HEADING-ROUTINE                              07090006
071000     END-IF.                                                      07100006
071100                                                                  07110006
071200     WRITE HALLMARK-LINE FROM TYPE1-LINE                          07120006
071300         AFTER ADVANCING 2 LINE.                                  07130006
071400                                                                  07140006
071500     WRITE HALLMARK-LINE FROM TYPE1-LINE2                         07150006
071600         AFTER ADVANCING 1 LINE.                                  07160006
071700                                                                  07170006
071800     WRITE HALLMARK-LINE FROM TYPE1-LINE3                         07180006
071900         AFTER ADVANCING 1 LINE.                                  07190006
072000                                                                  07200006
072100*--------------------------------------------------------------*  07210006
072200* PROCESS THE INVOICE RECORD                                   *  07220006
072300*--------------------------------------------------------------*  07230006
072400 C100-TYPE2.                                                      07240006
072500                                                                  07250006
072600     MOVE AP051-KOHLS-STORE-NBR1    TO TYPE2-STORE-NBR1.          07260006
072700     MOVE AP051-KOHLS-STORE-NBR2    TO TYPE2-STORE-NBR2.          07270006
072800     MOVE AP051-LADING-CARRIER-NBR  TO TYPE2-LAD-CARR.            07280006
072900     MOVE AP051-INV-DTE-YY          TO TYPE2-INV-YY.              07290006
073000     MOVE AP051-INV-DTE-MM          TO TYPE2-INV-MM.              07300006
073100     MOVE AP051-INV-DTE-DD          TO TYPE2-INV-DD.              07310006
073200     MOVE AP051-SHPD-DTE-YY         TO TYPE2-SHP-YY.              07320006
073300     MOVE AP051-SHPD-DTE-MM         TO TYPE2-SHP-MM.              07330006
073400     MOVE AP051-SHPD-DTE-DD         TO TYPE2-SHP-DD.              07340006
073500     MOVE AP051-EFF-DTE-YY          TO TYPE2-EFF-YY.              07350006
073600     MOVE AP051-EFF-DTE-MM          TO TYPE2-EFF-MM.              07360006
073700     MOVE AP051-EFF-DTE-DD          TO TYPE2-EFF-DD.              07370006
073800                                                                  07380006
073900     ADD 4 TO PV-LINE-COUNT.                                      07390006
074000     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            07400006
074100        PERFORM W200-HEADING-ROUTINE                              07410006
074200     END-IF.                                                      07420006
074300                                                                  07430006
074400     WRITE HALLMARK-LINE FROM TYPE2-LINE                          07440006
074500         AFTER ADVANCING 2 LINE.                                  07450006
074600                                                                  07460006
074700     WRITE HALLMARK-LINE FROM TYPE2-LINE2                         07470006
074800         AFTER ADVANCING 1 LINE.                                  07480006
074900                                                                  07490006
075000     WRITE HALLMARK-LINE FROM TYPE2-LINE3                         07500006
075100         AFTER ADVANCING 1 LINE.                                  07510006
075200                                                                  07520006
075300*--------------------------------------------------------------*  07530006
075400* PROCESS THE REMIT TO RECORD                                  *  07540006
075500*--------------------------------------------------------------*  07550006
075600 C200-TYPE3.                                                      07560006
075700                                                                  07570006
075800     MOVE AP051-REMIT-VNDR-DUNS-NBR TO TYPE3-DUNS-NBR.            07580006
075900     MOVE AP051-REMIT-TO-NAME       TO TYPE3-NAME.                07590006
076000     MOVE AP051-REMIT-TO-ADDR-1     TO TYPE3-ADDR1.               07600006
076100     MOVE AP051-REMIT-TO-ADDR-2     TO TYPE3-ADDR2.               07610006
076200     MOVE AP051-REMIT-TO-CITY       TO TYPE3-CITY.                07620006
076300     MOVE AP051-REMIT-TO-STATE      TO TYPE3-STATE.               07630006
076400     MOVE AP051-REMIT-TO-ZIP-5      TO TYPE3-ZIP-5.               07640006
076500     MOVE AP051-REMIT-TO-ZIP-4      TO TYPE3-ZIP-4.               07650006
076600                                                                  07660006
076700     ADD 6 TO PV-LINE-COUNT.                                      07670006
076800     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            07680006
076900        PERFORM W200-HEADING-ROUTINE                              07690006
077000     END-IF.                                                      07700006
077100                                                                  07710006
077200     WRITE HALLMARK-LINE FROM TYPE3-LINE                          07720006
077300         AFTER ADVANCING 2 LINE.                                  07730006
077400                                                                  07740006
077500     WRITE HALLMARK-LINE FROM TYPE3-LINE2                         07750006
077600         AFTER ADVANCING 1 LINE.                                  07760006
077700                                                                  07770006
077800     WRITE HALLMARK-LINE FROM TYPE3-LINE3                         07780006
077900         AFTER ADVANCING 1 LINE.                                  07790006
078000                                                                  07800006
078100     WRITE HALLMARK-LINE FROM TYPE3-LINE4                         07810006
078200         AFTER ADVANCING 1 LINE.                                  07820006
078300                                                                  07830006
078400     WRITE HALLMARK-LINE FROM TYPE3-LINE5                         07840006
078500         AFTER ADVANCING 1 LINE.                                  07850006
078600                                                                  07860006
078700*--------------------------------------------------------------*  07870006
078800* PROCESS THE TERMS RECORD                                     *  07880006
078900*--------------------------------------------------------------*  07890006
079000 C300-TYPE4.                                                      07900006
079100                                                                  07910006
079200     EVALUATE AP051-TERMS-TYPE-CODE                               07920006
079300       WHEN '01'                                                  07930006
079400         MOVE 'BASIC       '        TO TYPE4-TERMS-TYPE           07940006
079500       WHEN '02'                                                  07950006
079600         MOVE 'END OF MONTH'        TO TYPE4-TERMS-TYPE           07960006
079700       WHEN '03'                                                  07970006
079800         MOVE 'FIXED DATE  '        TO TYPE4-TERMS-TYPE           07980006
079900       WHEN '04'                                                  07990006
080000         MOVE 'DEFR INSTALL'        TO TYPE4-TERMS-TYPE           08000006
080100       WHEN '05'                                                  08010006
080200         MOVE 'NO DISC     '        TO TYPE4-TERMS-TYPE           08020006
080300       WHEN '06'                                                  08030006
080400         MOVE 'MIXED       '        TO TYPE4-TERMS-TYPE           08040006
080500       WHEN '07'                                                  08050006
080600         MOVE 'EXTENDED    '        TO TYPE4-TERMS-TYPE           08060006
080700       WHEN '08'                                                  08070006
080800         MOVE 'BASIC DISC  '        TO TYPE4-TERMS-TYPE           08080006
080900       WHEN '09'                                                  08090006
081000         MOVE 'PROXIMO     '        TO TYPE4-TERMS-TYPE           08100006
081100       WHEN '10'                                                  08110006
081200         MOVE 'INSTANT     '        TO TYPE4-TERMS-TYPE           08120006
081300       WHEN '11'                                                  08130006
081400         MOVE 'ELECTIVE    '        TO TYPE4-TERMS-TYPE           08140006
081500       WHEN '12'                                                  08150006
081600         MOVE '10 DAYS EOM '        TO TYPE4-TERMS-TYPE           08160006
081700       WHEN '13'                                                  08170006
081800         MOVE 'PREV AGREED '        TO TYPE4-TERMS-TYPE           08180006
081900       WHEN '14'                                                  08190006
082000         MOVE 'MUTUAL DEFIN'        TO TYPE4-TERMS-TYPE           08200006
082100       WHEN OTHER                                                 08210006
082200         MOVE AP051-TERMS-TYPE-CODE TO TYPE4-TERMS-TYPE           08220006
082300     END-EVALUATE.                                                08230006
082400                                                                  08240006
082500     EVALUATE AP051-TRMS-BASIS-DTE-CODE                           08250006
082600       WHEN '01'                                                  08260006
082700         MOVE 'SHIP DATE   '        TO TYPE4-BAS-DTE-CD           08270006
082800       WHEN '02'                                                  08280006
082900         MOVE 'DELIV DATE  '        TO TYPE4-BAS-DTE-CD           08290006
083000       WHEN '03'                                                  08300006
083100         MOVE 'INVOICE DATE'        TO TYPE4-BAS-DTE-CD           08310006
083200       WHEN '04'                                                  08320006
083300         MOVE 'EFFECT DATE '        TO TYPE4-BAS-DTE-CD           08330006
083400       WHEN OTHER                                                 08340006
083500         MOVE AP051-TRMS-BASIS-DTE-CODE TO TYPE4-BAS-DTE-CD       08350006
083600     END-EVALUATE.                                                08360006
083700                                                                  08370006
083800     MOVE AP051-DISC-PCT            TO TYPE4-DISC-PCT.            08380006
083900     MOVE AP051-DISC-DUE-DTE-YY     TO TYPE4-DISC-DUE-YY.         08390006
084000     MOVE AP051-DISC-DUE-DTE-MM     TO TYPE4-DISC-DUE-MM.         08400006
084100     MOVE AP051-DISC-DUE-DTE-DD     TO TYPE4-DISC-DUE-DD.         08410006
084200     MOVE AP051-DISC-DAYS-DUE       TO TYPE4-DISC-DAYS-DUE.       08420006
084300     MOVE AP051-DISC-AMT            TO TYPE4-DISC-AMT.            08430006
084400     MOVE AP051-NET-DUE-DTE-YY      TO TYPE4-NET-DUE-YY.          08440006
084500     MOVE AP051-NET-DUE-DTE-MM      TO TYPE4-NET-DUE-MM.          08450006
084600     MOVE AP051-NET-DUE-DTE-DD      TO TYPE4-NET-DUE-DD.          08460006
084700     MOVE AP051-NET-DEFRD-DAYS-DUE  TO TYPE4-NET-DEF-DAYS.        08470006
084800     MOVE AP051-PCT-PAYABLE         TO TYPE4-DEF-PCT-PAY.         08480006
084900     MOVE AP051-DEF-DUE-DTE-YY      TO TYPE4-DEF-DUE-YY.          08490006
085000     MOVE AP051-DEF-DUE-DTE-MM      TO TYPE4-DEF-DUE-MM.          08500006
085100     MOVE AP051-DEF-DUE-DTE-DD      TO TYPE4-DEF-DUE-DD.          08510006
085200     MOVE AP051-DEFERRED-AMT        TO TYPE4-DEF-AMT.             08520006
085300                                                                  08530006
085400     ADD 6 TO PV-LINE-COUNT.                                      08540006
085500     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            08550006
085600        PERFORM W200-HEADING-ROUTINE                              08560006
085700     END-IF.                                                      08570006
085800                                                                  08580006
085900     WRITE HALLMARK-LINE FROM TYPE4-LINE                          08590006
086000         AFTER ADVANCING 2 LINE.                                  08600006
086100                                                                  08610006
086200     WRITE HALLMARK-LINE FROM TYPE4-LINE2                         08620006
086300         AFTER ADVANCING 1 LINE.                                  08630006
086400                                                                  08640006
086500     WRITE HALLMARK-LINE FROM TYPE4-LINE3                         08650006
086600         AFTER ADVANCING 1 LINE.                                  08660006
086700                                                                  08670006
086800     WRITE HALLMARK-LINE FROM TYPE4-LINE4                         08680006
086900         AFTER ADVANCING 1 LINE.                                  08690006
087000                                                                  08700006
087100     WRITE HALLMARK-LINE FROM TYPE4-LINE5                         08710006
087200         AFTER ADVANCING 1 LINE.                                  08720006
087300                                                                  08730006
087400*--------------------------------------------------------------*  08740006
087500* PROCESS THE ALLW/CHRG RECORD                                 *  08750006
087600*--------------------------------------------------------------*  08760006
087700 C400-TYPE5.                                                      08770006
087800                                                                  08780006
087900     EVALUATE AP051-ALLW-CHG-TYPE                                 08790006
088000       WHEN 'C'                                                   08800006
088100         MOVE 'CHARGE     '         TO TYPE5-ALLW-CHRG-TYPE       08810006
088200       WHEN 'A'                                                   08820006
088300         MOVE 'ALLOWANCE  '         TO TYPE5-ALLW-CHRG-TYPE       08830006
088400       WHEN 'N'                                                   08840006
088500         MOVE 'NO ALLW CHG'         TO TYPE5-ALLW-CHRG-TYPE       08850006
088600       WHEN OTHER                                                 08860006
088700         MOVE AP051-ALLW-CHG-TYPE   TO TYPE5-ALLW-CHRG-TYPE       08870006
088800     END-EVALUATE.                                                08880006
088900                                                                  08890006
089000     EVALUATE AP051-ALLW-CHRG-CODE                                08900006
089100       WHEN '275'                                                 08910006
089200       WHEN 'DSC'                                                 08920006
089300         MOVE 'TERMS DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         08930006
089400       WHEN 'TTD'                                                 08940006
089500         MOVE 'TRADE DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         08950006
089600       WHEN 'CAC'                                                 08960006
089700         MOVE 'CASH DISCOUNT   '    TO TYPE5-ALLW-CHRG-CD         08970006
089800       WHEN 'NSD'                                                 08980006
089900       WHEN 'NSA'                                                 08990006
090000         MOVE 'NEW STORE/PROMO '    TO TYPE5-ALLW-CHRG-CD         09000006
090100       WHEN 'FFA'                                                 09010006
090200         MOVE 'FREIGHT ALLOW   '    TO TYPE5-ALLW-CHRG-CD         09020006
090300       WHEN 'TAL'                                                 09030006
090400         MOVE 'TRUCKLOAD DISC  '    TO TYPE5-ALLW-CHRG-CD         09040006
090500       WHEN 'VAB'                                                 09050006
090600         MOVE 'VOLUME DISCOUNT '    TO TYPE5-ALLW-CHRG-CD         09060006
090700       WHEN 'RCA'                                                 09070006
090800         MOVE 'NO RET CRHALLMARKT AL' TO TYPE5-ALLW-CHRG-CD       09080006
090900       WHEN 'WSA'                                                 09090006
091000         MOVE 'WHAREHOUSE ALLW '    TO TYPE5-ALLW-CHRG-CD         09100006
091100       WHEN 'DDA'                                                 09110006
091200         MOVE 'DEFECTIVE ALLW  '    TO TYPE5-ALLW-CHRG-CD         09120006
091300       WHEN 'AAA'                                                 09130006
091400         MOVE 'ADVETISING ALLW '    TO TYPE5-ALLW-CHRG-CD         09140006
091500       WHEN 'EEA'                                                 09150006
091600         MOVE 'EARLY BUY ALLW  '    TO TYPE5-ALLW-CHRG-CD         09160006
091700       WHEN 'UUM'                                                 09170006
091800         MOVE 'UNSALEABLE MERCH'    TO TYPE5-ALLW-CHRG-CD         09180006
091900       WHEN '400'                                                 09190006
092000       WHEN 'FFC'                                                 09200006
092100       WHEN 'PAB'                                                 09210006
092200       WHEN 'SAB'                                                 09220006
092300       WHEN 'PST'                                                 09230006
092400       WHEN 'UUC'                                                 09240006
092500         MOVE 'FREIGHT CHARGE  '    TO TYPE5-ALLW-CHRG-CD         09250006
092600       WHEN 'MRK'                                                 09260006
092700         MOVE 'PRETICKETING    '    TO TYPE5-ALLW-CHRG-CD         09270006
092800       WHEN '445'                                                 09280006
092900       WHEN 'INS'                                                 09290006
093000         MOVE 'INSURANCE       '    TO TYPE5-ALLW-CHRG-CD         09300006
093100       WHEN 'MSG'                                                 09310006
093200         MOVE 'MISCELLANEOUS   '    TO TYPE5-ALLW-CHRG-CD         09320006
093300       WHEN 'MSC'                                                 09330006
093400         MOVE 'MISC/HANGER CHG '    TO TYPE5-ALLW-CHRG-CD         09340006
093500       WHEN 'SST'                                                 09350006
093600       WHEN 'TTL'                                                 09360006
093700       WHEN 'TTS'                                                 09370006
093800         MOVE 'TAX             '    TO TYPE5-ALLW-CHRG-CD         09380006
093900       WHEN 'SGG'                                                 09390006
094000         MOVE 'SMALL ORDER CHG '    TO TYPE5-ALLW-CHRG-CD         09400006
094100       WHEN 'HBG'                                                 09410006
094200       WHEN '690'                                                 09420006
094300         MOVE 'HANDLING        '    TO TYPE5-ALLW-CHRG-CD         09430006
094400       WHEN 'LAE'                                                 09440006
094500         MOVE 'LICENSE FEE     '    TO TYPE5-ALLW-CHRG-CD         09450006
094600       WHEN 'PPN'                                                 09460006
094700         MOVE 'PALLET CHARGE   '    TO TYPE5-ALLW-CHRG-CD         09470006
094800       WHEN OTHER                                                 09480006
094900         MOVE AP051-ALLW-CHRG-CODE  TO TYPE5-ALLW-CHRG-CD         09490006
095000     END-EVALUATE.                                                09500006
095100                                                                  09510006
095200     MOVE AP051-SPEC-SRVC-CODE      TO TYPE5-SPEC-SRVC-CD.        09520006
095300     EVALUATE AP051-SPEC-SRVC-CODE                                09530006
095400       WHEN 'FG        '                                          09540006
095500         MOVE 'FREE GOODS'          TO TYPE5-SPEC-SRVC-CD         09550006
095600       WHEN 'TC        '                                          09560006
095700         MOVE 'TICKETING '          TO TYPE5-SPEC-SRVC-CD         09570006
095800       WHEN OTHER                                                 09580006
095900         MOVE AP051-SPEC-SRVC-CODE  TO TYPE5-SPEC-SRVC-CD         09590006
096000     END-EVALUATE.                                                09600006
096100                                                                  09610006
096200     EVALUATE AP051-ALLW-CHRG-MTHD                                09620006
096300       WHEN '02'                                                  09630006
096400         MOVE 'OFF INVOICE '        TO TYPE5-ALLW-CHRG-MTHD       09640006
096500       WHEN OTHER                                                 09650006
096600         MOVE AP051-ALLW-CHRG-MTHD  TO TYPE5-ALLW-CHRG-MTHD       09660006
096700     END-EVALUATE.                                                09670006
096800                                                                  09680006
096900     MOVE AP051-ALLW-CHRG-TOTAL     TO TYPE5-ALLW-CHRG-TOTL.      09690006
097000     MOVE AP051-ALLW-CHRG-PCT       TO TYPE5-ALLW-CHRG-PCT.       09700006
097100     EVALUATE AP051-ALLW-CHRG-PCT-QUAL                            09710006
097200       WHEN '3'                                                   09720006
097300         MOVE 'DISC GROSS' TO TYPE5-ALLW-CHRG-QUAL                09730006
097400       WHEN OTHER                                                 09740006
097500         MOVE '          ' TO TYPE5-ALLW-CHRG-QUAL                09750006
097600     END-EVALUATE.                                                09760006
097700                                                                  09770006
097800     ADD 4 TO PV-LINE-COUNT.                                      09780006
097900     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            09790006
098000        PERFORM W200-HEADING-ROUTINE                              09800006
098100     END-IF.                                                      09810006
098200                                                                  09820006
098300     WRITE HALLMARK-LINE FROM TYPE5-LINE                          09830006
098400         AFTER ADVANCING 2 LINE.                                  09840006
098500                                                                  09850006
098600     WRITE HALLMARK-LINE FROM TYPE5-LINE2                         09860006
098700         AFTER ADVANCING 1 LINE.                                  09870006
098800                                                                  09880006
098900     WRITE HALLMARK-LINE FROM TYPE5-LINE3                         09890006
099000         AFTER ADVANCING 1 LINE.                                  09900006
099100                                                                  09910006
099200*--------------------------------------------------------------*  09920006
099300* PROCESS THE SUMMARY RECORD                                   *  09930006
099400*--------------------------------------------------------------*  09940006
099500 C500-TYPE6.                                                      09950006
099600                                                                  09960006
099700     MOVE AP051-QUANTITY-SHIPPED    TO TYPE6-QTY-SHIP.            09970006
099800     EVALUATE AP051-SHIP-UNIT-MEASURE                             09980006
099900       WHEN 'CA'                                                  09990006
100000         MOVE 'CASE     ' TO TYPE6-SHIP-UOM                       10000006
100100       WHEN 'CH'                                                  10010006
100200         MOVE 'CONTAINER' TO TYPE6-SHIP-UOM                       10020006
100300       WHEN 'CT'                                                  10030006
100400         MOVE 'CARTON   ' TO TYPE6-SHIP-UOM                       10040006
100500       WHEN 'EA'                                                  10050006
100600         MOVE 'EACH     ' TO TYPE6-SHIP-UOM                       10060006
100700       WHEN OTHER                                                 10070006
100800         MOVE SPACES      TO TYPE6-SHIP-UOM                       10080006
100900     END-EVALUATE.                                                10090006
101000                                                                  10100006
101100     MOVE AP051-GROSS-INVOICE-AMT   TO TYPE6-GROSS-INV-AMT.       10110006
101200     MOVE AP051-GROSS-INVOICE-AMT   TO GROSS-INVOICED.            10120006
101300     MOVE AP051-AMT-SBJ-DISCOUNT    TO TYPE6-AMT-SUBJ-DISC.       10130006
101400     MOVE AP051-DISCOUNT-AMT        TO TYPE6-DISC-AMT.            10140006
101500     MOVE AP051-DISCOUNTED-AMT-DUE  TO TYPE6-DISC-AMT-DUE.        10150006
101600                                                                  10160006
101700     ADD 4 TO PV-LINE-COUNT.                                      10170006
101800     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            10180006
101900        PERFORM W200-HEADING-ROUTINE                              10190006
102000     END-IF.                                                      10200006
102100                                                                  10210006
102200     WRITE HALLMARK-LINE FROM TYPE6-LINE                          10220006
102300         AFTER ADVANCING 2 LINE.                                  10230006
102400                                                                  10240006
102500     WRITE HALLMARK-LINE FROM TYPE6-LINE2                         10250006
102600         AFTER ADVANCING 1 LINE.                                  10260006
102700                                                                  10270006
102800     WRITE HALLMARK-LINE FROM TYPE6-LINE3                         10280006
102900         AFTER ADVANCING 1 LINE.                                  10290006
103000                                                                  10300006
103100*--------------------------------------------------------------*  10310006
103200* PROCESS THE ITEM DETAIL RECORD                               *  10320006
103300*--------------------------------------------------------------*  10330006
103400 C600-TYPE7.                                                      10340006
103500                                                                  10350006
103600     MOVE AP051-ID-QUALIFIER        TO TYPE7-ID-QUAL.             10360006
103700                                                                  10370006
103800     IF AP051-EAN-UPC(13:1) = SPACE                               10380006
103900        MOVE ' '                       TO TYPE7-EAN-UPC(1:1)      10390006
104000        MOVE AP051-EAN-UPC(1:1)        TO TYPE7-EAN-UPC(2:1)      10400006
104100        MOVE '-'                       TO TYPE7-EAN-UPC(3:1)      10410006
104200        MOVE AP051-EAN-UPC(2:5)        TO TYPE7-EAN-UPC(4:5)      10420006
104300        MOVE '-'                       TO TYPE7-EAN-UPC(9:1)      10430006
104400        MOVE AP051-EAN-UPC(7:5)        TO TYPE7-EAN-UPC(10:5)     10440006
104500        MOVE '-'                       TO TYPE7-EAN-UPC(15:1)     10450006
104600        MOVE AP051-EAN-UPC(12:1)       TO TYPE7-EAN-UPC(16:1)     10460006
104700     ELSE                                                         10470006
104800        MOVE AP051-EAN-UPC(1:2)        TO TYPE7-EAN-UPC(1:2)      10480006
104900        MOVE '-'                       TO TYPE7-EAN-UPC(3:1)      10490006
105000        MOVE AP051-EAN-UPC(3:5)        TO TYPE7-EAN-UPC(4:5)      10500006
105100        MOVE '-'                       TO TYPE7-EAN-UPC(9:1)      10510006
105200        MOVE AP051-EAN-UPC(8:5)        TO TYPE7-EAN-UPC(10:5)     10520006
105300        MOVE '-'                       TO TYPE7-EAN-UPC(15:1)     10530006
105400        MOVE AP051-EAN-UPC(13:1)       TO TYPE7-EAN-UPC(16:1)     10540006
105500     END-IF.                                                      10550006
105600                                                                  10560006
105700     MOVE AP051-KOHLS-SKU           TO TYPE7-SKU.                 10570006
105800     MOVE AP051-VENDOR-STYLE        TO TYPE7-VNDR-STYLE.          10580006
105900     MOVE AP051-VENDOR-STYLE-DSCRPT TO TYPE7-VNDR-STYLE-DESC.     10590006
106000     MOVE AP051-NRMA-COLOR-CODE     TO TYPE7-NRML-CD.             10600006
106100     MOVE AP051-VENDOR-COLOR-DSCRPT TO TYPE7-COLOR-DESC.          10610006
106200     MOVE AP051-NRMA-SIZE-CODE      TO TYPE7-SIZE-CD.             10620006
106300     MOVE AP051-VENDOR-SIZE-DSCRPT  TO TYPE7-SIZE-DESC.           10630006
106400     EVALUATE AP051-IT1-UNIT-MEASURE                              10640006
106500       WHEN 'EA'                                                  10650006
106600         MOVE 'EACH     ' TO TYPE7-UOM                            10660006
106700       WHEN 'PK'                                                  10670006
106800         MOVE 'PACK     ' TO TYPE7-UOM                            10680006
106900       WHEN 'PR'                                                  10690006
107000         MOVE 'PAIR     ' TO TYPE7-UOM                            10700006
107100       WHEN 'ST'                                                  10710006
107200         MOVE 'SET      ' TO TYPE7-UOM                            10720006
107300       WHEN 'AS'                                                  10730006
107400         MOVE 'PACK HDR ' TO TYPE7-UOM                            10740006
107500       WHEN 'PI'                                                  10750006
107600         MOVE 'PACKITEM ' TO TYPE7-UOM                            10760006
107700     END-EVALUATE.                                                10770006
107800                                                                  10780006
107900     MOVE AP051-QUANTITY-INVOICED   TO TYPE7-QTY-INVD.            10790006
108000     MOVE AP051-WHOLSALE-UNIT-COST  TO TYPE7-WHOL-COST.           10800006
108100                                                                  10810006
108200     IF AP051-IT1-MSR-PK-HDR                                      10820006
108300        MOVE 'PACK UPC: '              TO TYPE7-UPC-TITLE         10830006
108400        MOVE 'PACK COST: '             TO TYPE7-UNT-CST-TITLE     10840006
108500        MOVE AP051-PK-ITEM-SUMD-COST   TO TYPE7-PK-ITEM-SUMD-COST 10850006
108600        ADD 7 TO PV-LINE-COUNT                                    10860006
108700     ELSE                                                         10870006
108800        MOVE 'UPC CODE: '              TO TYPE7-UPC-TITLE         10880006
108900        MOVE 'UNIT COST: '             TO TYPE7-UNT-CST-TITLE     10890006
109000        ADD 6 TO PV-LINE-COUNT                                    10900006
109100     END-IF.                                                      10910006
109200                                                                  10920006
109300     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            10930006
109400        PERFORM W200-HEADING-ROUTINE                              10940006
109500     END-IF.                                                      10950006
109600                                                                  10960006
109700     WRITE HALLMARK-LINE FROM TYPE7-LINE                          10970006
109800         AFTER ADVANCING 2 LINE.                                  10980006
109900                                                                  10990006
110000     WRITE HALLMARK-LINE FROM TYPE7-LINE2                         11000006
110100         AFTER ADVANCING 1 LINE.                                  11010006
110200                                                                  11020006
110300     WRITE HALLMARK-LINE FROM TYPE7-LINE3                         11030006
110400         AFTER ADVANCING 1 LINE.                                  11040006
110500                                                                  11050006
110600     WRITE HALLMARK-LINE FROM TYPE7-LINE4                         11060006
110700         AFTER ADVANCING 1 LINE.                                  11070006
110800                                                                  11080006
110900     WRITE HALLMARK-LINE FROM TYPE7-LINE5                         11090006
111000         AFTER ADVANCING 1 LINE.                                  11100006
111100                                                                  11110006
111200     IF AP051-IT1-MSR-PK-HDR                                      11120006
111300        WRITE HALLMARK-LINE FROM TYPE7-LINE6                      11130006
111400            AFTER ADVANCING 1 LINE                                11140006
111500     END-IF.                                                      11150006
111600                                                                  11160006
111700*--------------------------------------------------------------*  11170006
111800* PROCESS THE HIGH-VALUES RECORD                               *  11180006
111900*--------------------------------------------------------------*  11190006
112000 C650-HIGH-VALUES.                                                11200006
112100                                                                  11210006
112200     IF AP051-ERR-TOO-MANY-LINES                                  11220006
112300        MOVE AP051-TOT-INVC-LINES TO PV-TOT-INVC-LINES            11230006
112400     END-IF.                                                      11240006
112500                                                                  11250006
112600*--------------------------------------------------------------*  11260006
112700* PROCESS AN INVALID RECORD TYPE                               *  11270006
112800*--------------------------------------------------------------*  11280006
112900 C700-INVALID-TYPE.                                               11290006
113000                                                                  11300006
113100     ADD 1 TO PV-LINE-COUNT.                                      11310006
113200     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            11320006
113300        PERFORM W200-HEADING-ROUTINE                              11330006
113400     END-IF.                                                      11340006
113500                                                                  11350006
113600     MOVE AP051-RECORD-TYPE-IND TO TYPE-OTH-REC-TYPE.             11360006
113700                                                                  11370006
113800     WRITE HALLMARK-LINE FROM TYPE-OTH-LINE                       11380006
113900         AFTER ADVANCING 1 LINE.                                  11390006
114000                                                                  11400006
114100*--------------------------------------------------------------*  11410006
114200* CHECK FOR ERROR CODES AND PRINT 3 PER REPORT LINE - DETAIL   *  11420006
114300*--------------------------------------------------------------*  11430006
114400 E100-ERROR-ROUTINE.                                              11440006
114500                                                                  11450006
114600     ADD 1 TO PV-LINE-COUNT.                                      11460006
114700     IF PV-LINE-COUNT >= PV-LINE-LIMIT - 1                        11470006
114800        PERFORM W200-HEADING-ROUTINE                              11480006
114900     END-IF.                                                      11490006
115000                                                                  11500006
115100     WRITE HALLMARK-LINE FROM ERROR-DESC-LINE                     11510006
115200         AFTER ADVANCING 1 LINE.                                  11520006
115300                                                                  11530006
115400     SET ERRLN-INDX TO 1.                                         11540006
115500     SET ERRLN-INDX DOWN BY 1.                                    11550006
115600     MOVE SPACES TO ERROR-LINE-AREA.                              11560006
115700                                                                  11570006
115800     PERFORM VARYING AP051-INDX FROM 1 BY 1                       11580006
115900        UNTIL AP051-INDX > 25                                     11590006
116000           OR AP051-ERR-CD(AP051-INDX) = ZEROS                    11600006
116100           SET ERR-INDX TO AP051-ERR-CD(AP051-INDX)               11610006
116200           SET FLG-INDX TO ERR-INDX                               11620006
116300           MOVE 'X' TO SUMM-ERR-FLAG(FLG-INDX)                    11630006
116400           SET ERRLN-INDX UP BY 1                                 11640006
116500           MOVE '*' TO ERR-ASTR-1(ERRLN-INDX)                     11650006
116600           MOVE '*' TO ERR-ASTR-2(ERRLN-INDX)                     11660006
116700           MOVE AP051-ERR-CD(AP051-INDX) TO PV-AP-EDIT-CODE       11670006
116800           PERFORM Y100-PROCESS-ERROR-MSG                         11680006
116900           MOVE PV-HALLMARK-ERROR-MSG TO ERR-DATA(ERRLN-INDX)     11690006
117000           IF AP051-ERR-CD(AP051-INDX) = 74                       11700006
117100              MOVE '80' TO ERR-NMBR(ERRLN-INDX)                   11710006
117200           ELSE                                                   11720006
117300              MOVE AP051-ERR-CD(AP051-INDX) TO                    11730006
117400                                  ERR-NMBR(ERRLN-INDX)            11740006
117500           END-IF                                                 11750006
117600                                                                  11760006
117700           IF ERRLN-INDX = 2                                      11770006
117800              PERFORM W600-WRITE-ERROR-LINE                       11780006
117900              SET ERRLN-INDX TO 1                                 11790006
118000              SET ERRLN-INDX DOWN BY 1                            11800006
118100              MOVE SPACES TO ERROR-LINE-AREA                      11810006
118200           END-IF                                                 11820006
118300     END-PERFORM.                                                 11830006
118400                                                                  11840006
118500     IF ERRLN-INDX > 0                                            11850006
118600        PERFORM W600-WRITE-ERROR-LINE                             11860006
118700     END-IF.                                                      11870006
118800                                                                  11880006
118900     IF AP051-ERR-DETL-GROSS-INV                                  11890006
119000        MOVE AP051-CALC-SUM-EXTEN   TO CALC-GROSS-EXTEN           11900006
119100        DISPLAY 'E100:AP051-CALC-SUM-EXTEN ' AP051-CALC-SUM-EXTEN 11910006
119200        DISPLAY ' '                                               11920006
119300        SET ERR-DETAIL-GROSS-INVOICE TO TRUE                      11930006
119400        WRITE HALLMARK-LINE FROM CALC-GROSS-LINE                  11940006
119500            AFTER ADVANCING 1 LINE                                11950006
119600     END-IF.                                                      11960006
119700                                                                  11970006
119800*--------------------------------------------------------------*  11980006
119900* PERFORM ALL DATE ROUTINES, FILE OPENS, ETC                   *  11990006
120000*--------------------------------------------------------------*  12000006
120100 H000-HOUSEKEEPING.                                               12010006
120200                                                                  12020006
120300     ACCEPT SD-SYSTEM-DATE FROM DATE.                             12030006
120400     ACCEPT ST-SYSTEM-TIME FROM TIME.                             12040006
120500                                                                  12050006
122500                                                                  12250006
122800     MOVE SD-SYSTEM-YEAR TO DP132O-RUN-YEAR.                      12280006
122900     MOVE SD-SYSTEM-MONTH TO DP132O-RUN-MONTH.                    12290006
123000     MOVE SD-SYSTEM-DAY TO DP132O-RUN-DAY.                        12300006
123100                                                                  12310006
123200     MOVE ST-SYSTEM-HOUR TO DP132O-RUN-HOUR.                      12320006
123300     MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE.                  12330006
123400                                                                  12340006
123500     MOVE PV-PROGRAM-NAME TO DP132O-PROGRAM-NAME.                 12350006
123600                                                                  12360006
123700     MOVE SPACES TO SUMM-ERR-TABLE.                               12370006
123800                                                                  12380006
123900     PERFORM R100-READ-HALLMARK-REJECT.                           12390006
124000     IF WS-HALLMARK-REJ-EOF                                       12400006
124100        DISPLAY '********************************* *'             12410006
124200        DISPLAY '*   EMPTY HALLMARK REJECTION FILE *'             12420006
124300        DISPLAY '*   PROGRAM ** = APKRP375         *'             12430006
124400        DISPLAY '*   PARAGRAPH  = H000-HOUSEKEEPING*'             12440006
124500        DISPLAY '***********************************'             12450006
124600        MOVE ZEROS                     TO HL2-VENDOR-NBR          12460006
124700                                          HL2-PO-NBR              12470006
124800                                          HL2-INTERCHG-CNTL-NBR   12480006
124900        MOVE SPACES                    TO HL2-INVOICE-NBR         12490006
125000                                          HL2-ENT-ID-DESC         12500006
125100        PERFORM W200-HEADING-ROUTINE                              12510006
125200        WRITE HALLMARK-LINE FROM NO-DATA-LINE                     12520006
125900        SET WS-HALLMARK-REJ-EMPTY-FILE TO TRUE                    12590006
126000     ELSE                                                         12600006
126050        MOVE 4050                      TO RETURN-CODE             12602007
126100        MOVE AP051-SORT-VENDOR-NBR     TO HL2-VENDOR-NBR          12610006
126200        MOVE AP051-SORT-INVOICE-NBR    TO HL2-INVOICE-NBR         12620006
126300        MOVE AP051-KOHLS-PO-NBR        TO HL2-PO-NBR              12630006
126400        MOVE AP051-VENDOR-DESC         TO HL2-ENT-ID-DESC         12640006
126500        MOVE AP051-SAVE-INTERCHG-CNTL-NBR TO HL2-INTERCHG-CNTL-NBR12650006
126600        MOVE AP051-EDI-824-IND            TO HALLMARK-824-IND     12660006
126700        PERFORM W200-HEADING-ROUTINE                              12670006
127000     END-IF.                                                      12700006
127100                                                                  12710006
127200*--------------------------------------------------------------*  12720006
127300* READ THE HALLMARK TRANSMISSION REJECTION FILE                *  12730006
127400*--------------------------------------------------------------*  12740006
127500 R100-READ-HALLMARK-REJECT.                                       12750006
127600                                                                  12760006
127700     READ HALLMARK-REJ-FILE INTO WS-HALLMARK-REJECT-REC           12770006
127800         AT END                                                   12780006
127900             SET WS-HALLMARK-REJ-EOF TO TRUE.                     12790006
128000                                                                  12800006
144200*--------------------------------------------------------------*  14420006
144300* WRITE THE DETAIL LINE HEADING - HALLMARK                     *  14430006
144400*--------------------------------------------------------------*  14440006
144500 W200-HEADING-ROUTINE.                                            14450006
144600                                                                  14460006
144700     ADD 1 TO PV-PAGE-COUNT.                                      14470006
145400     MOVE 1 TO DP132O-REPORT-NUMBER.                              14540017
145800                                                                  14580006
145900     MOVE  9 TO PV-LINE-COUNT.                                    14590006
146000                                                                  14600006
146100     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    14610006
146200                                                                  14620006
146300     WRITE HALLMARK-LINE FROM DP132O-STANDRD-HEADER-132-COLS      14630006
146400         AFTER ADVANCING PAGE.                                    14640006
146500                                                                  14650006
146600     WRITE HALLMARK-LINE FROM HL-HEADING-LINE1                    14660006
146700         AFTER ADVANCING 2 LINE.                                  14670006
146800                                                                  14680006
146900     WRITE HALLMARK-LINE FROM HL-HEADING-LINE2                    14690006
147000         AFTER ADVANCING 2 LINE.                                  14700006
147100                                                                  14710006
147200     WRITE HALLMARK-LINE FROM HALLMARK-824-IND-LINE               14720006
147300         AFTER ADVANCING 1 LINE.                                  14730006
147400                                                                  14740006
147500     WRITE HALLMARK-LINE FROM DIVIDE-LINE                         14750006
147600         AFTER ADVANCING 1 LINE.                                  14760006
147700                                                                  14770006
147800*--------------------------------------------------------------*  14780006
147900* PRINT THE RECORD TYPE DIVIDING LINE.                         *  14790006
148000*--------------------------------------------------------------*  14800006
148100 W400-PRINT-DIVIDE-LINE.                                          14810006
148200                                                                  14820006
148300     ADD 3 TO PV-LINE-COUNT.                                      14830006
148400     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            14840006
148500        PERFORM W200-HEADING-ROUTINE                              14850006
148600     ELSE                                                         14860006
148700        WRITE HALLMARK-LINE FROM DIVIDE-LINE                      14870006
148800            AFTER ADVANCING 2 LINE                                14880006
148900     END-IF.                                                      14890006
149000                                                                  14900006
155100*--------------------------------------------------------------*  15510006
155200* WRITE THE DETAIL REPORT ERROR LINE                           *  15520006
155300*--------------------------------------------------------------*  15530006
155400 W600-WRITE-ERROR-LINE.                                           15540006
155500                                                                  15550006
155600     ADD 1 TO PV-LINE-COUNT.                                      15560006
155700     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            15570006
155800        PERFORM W200-HEADING-ROUTINE                              15580006
155900     END-IF.                                                      15590006
156000                                                                  15600006
156100     WRITE HALLMARK-LINE FROM ERROR-LINE                          15610006
156200         AFTER ADVANCING 1 LINE.                                  15620006
156300                                                                  15630006
156400*--------------------------------------------------------------*  15640006
156500* WRITE THE DETAIL REPORT END OF INVOICE LINE                  *  15650006
156600*--------------------------------------------------------------*  15660006
156700 W700-END-OF-INVOICE-LINE .                                       15670006
156800                                                                  15680006
156900     ADD 1 TO PV-LINE-COUNT.                                      15690006
157000     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            15700006
157100        PERFORM W200-HEADING-ROUTINE                              15710006
157200     END-IF.                                                      15720006
157300                                                                  15730006
157400     WRITE HALLMARK-LINE FROM END-OF-INVOICE-LINE                 15740006
157500         AFTER ADVANCING 1 LINE.                                  15750006
157600                                                                  15760006
157700*--------------------------------------------------------------*  15770006
157800* ADDS THE FIELD RELATING TO THE ERROR MESSAGE                 *  15780006
157900*--------------------------------------------------------------*  15790006
158000 Y100-PROCESS-ERROR-MSG.                                          15800006
158100                                                                  15810006
158200     MOVE SPACES TO PV-HALLMARK-ERROR-MSG.                        15820006
158300     EVALUATE PV-AP-EDIT-CODE                                     15830006
158400         WHEN 11                                                  15840006
158500          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY '  '        15850006
158600                    ', '                      DELIMITED BY SIZE   15860006
158700                    TYPE2-INV-YY              DELIMITED BY SIZE   15870006
158800                    '/'                       DELIMITED BY SIZE   15880006
158900                    TYPE2-INV-MM              DELIMITED BY SIZE   15890006
159000                    '/'                       DELIMITED BY SIZE   15900006
159100                    TYPE2-INV-DD              DELIMITED BY SIZE   15910006
159200               INTO PV-HALLMARK-ERROR-MSG                         15920006
159300          END-STRING                                              15930006
159400         WHEN 14                                                  15940006
159500          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '15950006
159600                    ', '                      DELIMITED BY SIZE   15960006
159700                    TYPE5-ALLW-CHRG-CD        DELIMITED BY SIZE   15970006
159800                    '.'                       DELIMITED BY SIZE   15980006
159900               INTO PV-HALLMARK-ERROR-MSG                         15990006
160000          END-STRING                                              16000006
160100         WHEN 15                                                  16010006
160200          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16020006
160300                    ', '                      DELIMITED BY SIZE   16030006
160400                    TYPE5-ALLW-CHRG-CD        DELIMITED BY SIZE   16040006
160500                    '.'                       DELIMITED BY SIZE   16050006
160600               INTO PV-HALLMARK-ERROR-MSG                         16060006
160700          END-STRING                                              16070006
160800         WHEN 16                                                  16080006
160900          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16090006
161000                    ', '                      DELIMITED BY SIZE   16100006
161100                    TYPE5-ALLW-CHRG-TYPE      DELIMITED BY SIZE   16110006
161200                    '.'                       DELIMITED BY SIZE   16120006
161300               INTO PV-HALLMARK-ERROR-MSG                         16130006
161400          END-STRING                                              16140006
161500         WHEN 17                                                  16150006
161600          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16160006
161700                    ', '                      DELIMITED BY SIZE   16170006
161800                    TYPE5-SPEC-SRVC-CD        DELIMITED BY SIZE   16180006
161900                    '.'                       DELIMITED BY SIZE   16190006
162000               INTO PV-HALLMARK-ERROR-MSG                         16200006
162100          END-STRING                                              16210006
162200         WHEN 18                                                  16220006
162300          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16230006
162400                    ', '                      DELIMITED BY SIZE   16240006
162500                    HL2-PO-NBR                DELIMITED BY SIZE   16250006
162600                    '.'                       DELIMITED BY SIZE   16260006
162700               INTO PV-HALLMARK-ERROR-MSG                         16270006
162800          END-STRING                                              16280006
162900         WHEN 19                                                  16290006
163000          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16300006
163100                    ', '                      DELIMITED BY SIZE   16310006
163200                    TYPE5-ALLW-CHRG-QUAL      DELIMITED BY SIZE   16320006
163300                    '.'                       DELIMITED BY SIZE   16330006
163400               INTO PV-HALLMARK-ERROR-MSG                         16340006
163500          END-STRING                                              16350006
163600         WHEN 20                                                  16360006
163700          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16370006
163800                    ',  DC #1 '               DELIMITED BY SIZE   16380006
163900                    TYPE2-STORE-NBR1          DELIMITED BY SIZE   16390006
164000                    ',  DC #2 '               DELIMITED BY SIZE   16400006
164100                    TYPE2-STORE-NBR2          DELIMITED BY SIZE   16410006
164200               INTO PV-HALLMARK-ERROR-MSG                         16420006
164300          END-STRING                                              16430006
164400         WHEN 21                                                  16440006
164500          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16450006
164600                    ', '                      DELIMITED BY SIZE   16460006
164700                    TYPE7-ID-QUAL             DELIMITED BY SIZE   16470006
164800                    '.'                       DELIMITED BY SIZE   16480006
164900               INTO PV-HALLMARK-ERROR-MSG                         16490006
165000          END-STRING                                              16500006
165100         WHEN 24                                                  16510006
165200          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16520006
165300                    ', '                      DELIMITED BY SIZE   16530006
165400                    TYPE7-UOM                 DELIMITED BY SIZE   16540006
165500                    '.'                       DELIMITED BY SIZE   16550006
165600               INTO PV-HALLMARK-ERROR-MSG                         16560006
165700          END-STRING                                              16570006
165800         WHEN 26                                                  16580006
165900          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16590006
166000                    ', '                      DELIMITED BY SIZE   16600006
166100                    TYPE1-INTERCHG-YY         DELIMITED BY SIZE   16610006
166200                    '/'                       DELIMITED BY SIZE   16620006
166300                    TYPE1-INTERCHG-MM         DELIMITED BY SIZE   16630006
166400                    '/'                       DELIMITED BY SIZE   16640006
166500                    TYPE1-INTERCHG-DD         DELIMITED BY SIZE   16650006
166600               INTO PV-HALLMARK-ERROR-MSG                         16660006
166700          END-STRING                                              16670006
166800         WHEN 27                                                  16680006
166900          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16690006
167000                    ', STR #1 '               DELIMITED BY SIZE   16700006
167100                    TYPE2-STORE-NBR1          DELIMITED BY SIZE   16710006
167200                    ', STR #2 '               DELIMITED BY SIZE   16720006
167300                    TYPE2-STORE-NBR2          DELIMITED BY SIZE   16730006
167400               INTO PV-HALLMARK-ERROR-MSG                         16740006
167500          END-STRING                                              16750006
167600         WHEN 33                                                  16760006
167700          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16770006
167800                    ', STR #2 '             DELIMITED BY SIZE     16780006
167900                    TYPE2-STORE-NBR2        DELIMITED BY SIZE     16790006
168000               INTO PV-HALLMARK-ERROR-MSG                         16800006
168100          END-STRING                                              16810006
168200         WHEN 38                                                  16820006
168300          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16830006
168400                    ', STR #1 '             DELIMITED BY SIZE     16840006
168500                    TYPE2-STORE-NBR1        DELIMITED BY SIZE     16850006
168600                    ', STR #2 '             DELIMITED BY SIZE     16860006
168700                    TYPE2-STORE-NBR2        DELIMITED BY SIZE     16870006
168800               INTO PV-HALLMARK-ERROR-MSG                         16880006
168900          END-STRING                                              16890006
169000         WHEN 40                                                  16900006
169100          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16910006
169200                    ', '                      DELIMITED BY SIZE   16920006
169300                    TYPE4-TERMS-TYPE          DELIMITED BY '  '   16930006
169400                    '.'                       DELIMITED BY SIZE   16940006
169500               INTO PV-HALLMARK-ERROR-MSG                         16950006
169600          END-STRING                                              16960006
169700         WHEN 41                                                  16970006
169800          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '16980006
169900                    ', '                      DELIMITED BY SIZE   16990006
170000                    TYPE4-BAS-DTE-CD          DELIMITED BY '  '   17000006
170100                    '.'                       DELIMITED BY SIZE   17010006
170200               INTO PV-HALLMARK-ERROR-MSG                         17020006
170910          END-STRING                                              17091001
171100         WHEN 42                                                  17110000
171110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17111004
171300                    ', '                      DELIMITED BY SIZE   17130000
171400                    TYPE2-SHP-YY              DELIMITED BY SIZE   17140000
171500                    '/'                       DELIMITED BY SIZE   17150000
171600                    TYPE2-SHP-MM              DELIMITED BY SIZE   17160000
171700                    '/'                       DELIMITED BY SIZE   17170000
171800                    TYPE2-SHP-DD              DELIMITED BY SIZE   17180000
171900               INTO PV-HALLMARK-ERROR-MSG                         17190000
171910          END-STRING                                              17191001
172100         WHEN 43                                                  17210000
172110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17211004
172300                    ', '                      DELIMITED BY SIZE   17230000
172400                    TYPE2-EFF-YY              DELIMITED BY SIZE   17240000
172500                    '/'                       DELIMITED BY SIZE   17250000
172600                    TYPE2-EFF-MM              DELIMITED BY SIZE   17260000
172700                    '/'                       DELIMITED BY SIZE   17270000
172800                    TYPE2-EFF-DD              DELIMITED BY SIZE   17280000
172900               INTO PV-HALLMARK-ERROR-MSG                         17290000
172910          END-STRING                                              17291001
173100         WHEN 44                                                  17310000
173110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17311004
173300                    ', '                      DELIMITED BY SIZE   17330000
173400                    TYPE4-DISC-DUE-YY         DELIMITED BY SIZE   17340000
173500                    '/'                       DELIMITED BY SIZE   17350000
173600                    TYPE4-DISC-DUE-MM         DELIMITED BY SIZE   17360000
173700                    '/'                       DELIMITED BY SIZE   17370000
173800                    TYPE4-DISC-DUE-DD         DELIMITED BY SIZE   17380000
173900               INTO PV-HALLMARK-ERROR-MSG                         17390000
173910          END-STRING                                              17391001
174100         WHEN 45                                                  17410000
174110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17411004
174300                    ', '                      DELIMITED BY SIZE   17430000
174400                    TYPE4-NET-DUE-YY          DELIMITED BY SIZE   17440000
174500                    '/'                       DELIMITED BY SIZE   17450000
174600                    TYPE4-NET-DUE-MM          DELIMITED BY SIZE   17460000
174700                    '/'                       DELIMITED BY SIZE   17470000
174800                    TYPE4-NET-DUE-DD          DELIMITED BY SIZE   17480000
174900               INTO PV-HALLMARK-ERROR-MSG                         17490000
174910          END-STRING                                              17491001
175100         WHEN 46                                                  17510000
175110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17511004
175300                    ', '                      DELIMITED BY SIZE   17530000
175400                    TYPE4-DEF-DUE-YY          DELIMITED BY SIZE   17540000
175500                    '/'                       DELIMITED BY SIZE   17550000
175600                    TYPE4-DEF-DUE-MM          DELIMITED BY SIZE   17560000
175700                    '/'                       DELIMITED BY SIZE   17570000
175800                    TYPE4-DEF-DUE-DD          DELIMITED BY SIZE   17580000
175900               INTO PV-HALLMARK-ERROR-MSG                         17590000
175910          END-STRING                                              17591001
176100         WHEN 51                                                  17610000
176110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17611004
176300                    TYPE6-DISC-AMT-DUE        DELIMITED BY SIZE   17630000
176400                    '>'                       DELIMITED BY SIZE   17640000
176500                    TYPE6-GROSS-INV-AMT       DELIMITED BY SIZE   17650000
176600               INTO PV-HALLMARK-ERROR-MSG                         17660000
176610          END-STRING                                              17661001
176800         WHEN 53                                                  17680000
176810          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17681004
177000                    ', '                      DELIMITED BY SIZE   17700000
177100                    TYPE4-DISC-PCT            DELIMITED BY SIZE   17710000
177200                    '.'                       DELIMITED BY SIZE   17720000
177300               INTO PV-HALLMARK-ERROR-MSG                         17730000
177310          END-STRING                                              17731001
177500         WHEN 54                                                  17750000
177510          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17751004
177700                    ', '                      DELIMITED BY SIZE   17770000
177800                    TYPE4-DISC-AMT            DELIMITED BY SIZE   17780000
177900                    '.'                       DELIMITED BY SIZE   17790000
178000               INTO PV-HALLMARK-ERROR-MSG                         17800000
178010          END-STRING                                              17801001
178200         WHEN 55                                                  17820000
178210          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17821004
178400                    ', '                      DELIMITED BY SIZE   17840000
178500                    TYPE4-DEF-PCT-PAY         DELIMITED BY SIZE   17850000
178600                    '.'                       DELIMITED BY SIZE   17860000
178700               INTO PV-HALLMARK-ERROR-MSG                         17870000
178710          END-STRING                                              17871001
178900         WHEN 56                                                  17890000
178910          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17891004
179100                    ', '                      DELIMITED BY SIZE   17910000
179200                    TYPE4-DEF-AMT             DELIMITED BY SIZE   17920000
179300                    '.'                       DELIMITED BY SIZE   17930000
179400               INTO PV-HALLMARK-ERROR-MSG                         17940000
179410          END-STRING                                              17941001
179600         WHEN 57                                                  17960000
179610          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '17961004
179800                    ', '                      DELIMITED BY SIZE   17980000
179900                    TYPE5-ALLW-CHRG-TOTL      DELIMITED BY SIZE   17990000
180000                    '.'                       DELIMITED BY SIZE   18000000
180100               INTO PV-HALLMARK-ERROR-MSG                         18010000
180110          END-STRING                                              18011001
180300         WHEN 58                                                  18030000
180310          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18031004
180500                    ', '                      DELIMITED BY SIZE   18050000
180600                    TYPE5-ALLW-CHRG-PCT       DELIMITED BY SIZE   18060000
180700                    '.'                       DELIMITED BY SIZE   18070000
180800               INTO PV-HALLMARK-ERROR-MSG                         18080000
180810          END-STRING                                              18081001
181000         WHEN 59                                                  18100000
181010          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18101004
181200                    ', '                      DELIMITED BY SIZE   18120000
181300                    TYPE6-GROSS-INV-AMT       DELIMITED BY SIZE   18130000
181400                    '.'                       DELIMITED BY SIZE   18140000
181500               INTO PV-HALLMARK-ERROR-MSG                         18150000
181510          END-STRING                                              18151001
181700         WHEN 60                                                  18170000
181710          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18171004
181900                    ', '                      DELIMITED BY SIZE   18190000
182000                    TYPE6-AMT-SUBJ-DISC       DELIMITED BY SIZE   18200000
182100                    '.'                       DELIMITED BY SIZE   18210000
182200               INTO PV-HALLMARK-ERROR-MSG                         18220000
182210          END-STRING                                              18221001
182400         WHEN 61                                                  18240000
182410          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18241004
182600                    ', '                      DELIMITED BY SIZE   18260000
182700                    TYPE6-DISC-AMT            DELIMITED BY SIZE   18270000
182800                    '.'                       DELIMITED BY SIZE   18280000
182900               INTO PV-HALLMARK-ERROR-MSG                         18290000
182910          END-STRING                                              18291001
183100         WHEN 62                                                  18310000
183110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18311004
183300                    ', '                      DELIMITED BY SIZE   18330000
183400                    TYPE6-DISC-AMT-DUE        DELIMITED BY SIZE   18340000
183500                    '.'                       DELIMITED BY SIZE   18350000
183600               INTO PV-HALLMARK-ERROR-MSG                         18360000
183610          END-STRING                                              18361001
183800         WHEN 63                                                  18380000
183810          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18381004
184000                    ', '                      DELIMITED BY SIZE   18400000
184100                    TYPE7-QTY-INVD            DELIMITED BY SIZE   18410000
184200                    '.'                       DELIMITED BY SIZE   18420000
184300               INTO PV-HALLMARK-ERROR-MSG                         18430000
184310          END-STRING                                              18431001
184500         WHEN 64                                                  18450000
184510          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18451004
184700                    ', '                      DELIMITED BY SIZE   18470000
184800                    TYPE7-WHOL-COST           DELIMITED BY SIZE   18480000
184900                    '.'                       DELIMITED BY SIZE   18490000
185000               INTO PV-HALLMARK-ERROR-MSG                         18500000
185010          END-STRING                                              18501001
185200         WHEN 70                                                  18520000
185210          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18521004
185400                    ', '                      DELIMITED BY SIZE   18540000
185500                    TYPE1-SENDER-ID           DELIMITED BY SIZE   18550000
185600                    '.'                       DELIMITED BY SIZE   18560000
185700               INTO PV-HALLMARK-ERROR-MSG                         18570000
185710          END-STRING                                              18571001
185900         WHEN 74                                                  18590000
185910          MOVE EDI-ERROR-MSG(80) TO PV-HALLMARK-ERROR-MSG         18591004
186100         WHEN 75                                                  18610000
186110          STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY         '  '18611004
186300                    ' = '                     DELIMITED BY SIZE   18630000
186400                    PV-TOT-INVC-LINES         DELIMITED BY SIZE   18640000
186500                    '.'                       DELIMITED BY SIZE   18650000
186600               INTO PV-HALLMARK-ERROR-MSG                         18660000
186610          END-STRING                                              18661001
186800         WHEN OTHER                                               18680000
186900             MOVE EDI-ERROR-MSG(ERR-INDX)                         18690004
187000                                    TO PV-HALLMARK-ERROR-MSG      18700000
187100     END-EVALUATE.                                                18710000
187200                                                                  18720000
187300*--------------------------------------------------------------*  18730000
187400* END OF JOB ROUTINES, PRINT COUNTS, CLOSE FILES               *  18740000
187500*--------------------------------------------------------------*  18750000
187600 Z900-END-OF-JOB.                                                 18760000
187700                                                                  18770000
187800     ADD 1 TO PV-LINE-COUNT.                                      18780000
187900     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            18790000
188000        PERFORM W200-HEADING-ROUTINE                              18800000
188100     END-IF.                                                      18810000
188200                                                                  18820000
188300     IF NOT WS-HALLMARK-REJ-EMPTY-FILE                            18830000
188400        WRITE HALLMARK-LINE FROM END-OF-INVOICE-LINE              18840000
188500            AFTER ADVANCING 1 LINE                                18850000
188600     END-IF.                                                      18860000
188700                                                                  18870000
188800     ADD 2 TO PV-LINE-COUNT.                                      18880000
188900     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            18890000
189000        PERFORM W200-HEADING-ROUTINE                              18900000
189100     END-IF.                                                      18910000
189200                                                                  18920000
189300     IF NOT WS-HALLMARK-REJ-EMPTY-FILE                            18930000
189400        WRITE HALLMARK-LINE FROM EOR-END-OF-REPORT-LINE           18940000
189500            AFTER ADVANCING 2 LINE                                18950000
189600     END-IF.                                                      18960000
190200                                                                  19020000
190300     CLOSE HALLMARK-REJ-FILE                                      19030000
190400           HALLMARK-REPORT.                                       19040008
