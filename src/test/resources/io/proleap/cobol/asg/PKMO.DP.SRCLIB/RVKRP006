00001 ******************************************************************10/24/95
00002  IDENTIFICATION DIVISION.                                         RVKRP006
00003 ******************************************************************   LV002
00004                                                                   RVKRP006
00005  PROGRAM-ID.             RVKRP006.                                RVKRP006
00006  AUTHOR.                 MICHAEL WALTERS.                         RVKRP006
00007  INSTALLATION.           KOHLS.                                   RVKRP006
00008  DATE-WRITTEN            AUGUST, 1995.                            RVKRP006
00009  DATE-COMPILED.                                                   RVKRP006
00010                                                                   RVKRP006
00011 ******************************************************************RVKRP006
00012 *  THIS PROGRAM WILL SUMMARIZE ALL THE "SHIPPED" DEFECTIVE ITEMS  RVKRP006
00013 *  BY FACILITY AND DEPARTMENT.                                    RVKRP006
00014 ******************************************************************RVKRP006
00015                                                                   RVKRP006
00016 ******************************************************************RVKRP006
00017  ENVIRONMENT DIVISION.                                            RVKRP006
00018 ******************************************************************RVKRP006
00019                                                                   RVKRP006
00020  CONFIGURATION SECTION.                                           RVKRP006
00021                                                                   RVKRP006
00022  SOURCE-COMPUTER.        IBM-3090.                                RVKRP006
00023  OBJECT-COMPUTER.        IBM-3090.                                RVKRP006
00024                                                                   RVKRP006
00025  INPUT-OUTPUT SECTION.                                            RVKRP006
00026                                                                   RVKRP006
00027  FILE-CONTROL.                                                    RVKRP006
00028                                                                   RVKRP006
00029      SELECT RTV-REPORT-EXTRACT                                    RVKRP006
00030          ASSIGN TO IN01.                                          RVKRP006
00031                                                                   RVKRP006
00032      SELECT DI-DEFECT-ITEM-REPORT                                 RVKRP006
00033          ASSIGN TO RPT01.                                         RVKRP006
00034                                                                   RVKRP006
00035 ******************************************************************RVKRP006
00036  DATA DIVISION.                                                   RVKRP006
00037 ******************************************************************RVKRP006
00038                                                                   RVKRP006
00039  FILE SECTION.                                                    RVKRP006
00040                                                                   RVKRP006
00041  FD  RTV-REPORT-EXTRACT                                           RVKRP006
00042      RECORDING MODE IS F                                          RVKRP006
00043      LABEL RECORDS ARE STANDARD                                   RVKRP006
00044      BLOCK CONTAINS 0 RECORDS.                                    RVKRP006
00045                                                                   RVKRP006
00046  01  RTV-REPORT-EXTRACT-RECORD       PIC  X(200).                 RVKRP006
00047                                                                   RVKRP006
00048  FD  DI-DEFECT-ITEM-REPORT                                        RVKRP006
00049      RECORDING MODE IS F                                          RVKRP006
00050      LABEL RECORDS ARE STANDARD                                   RVKRP006
00051      BLOCK CONTAINS 0 RECORDS.                                    RVKRP006
00052                                                                   RVKRP006
00053  01  DI-DEFECT-ITEM-LINE             PIC  X(132).                 RVKRP006
00054                                                                   RVKRP006
00055 ******************************************************************RVKRP006
00056  WORKING-STORAGE SECTION.                                         RVKRP006
00057 ******************************************************************RVKRP006
00058                                                                   RVKRP006
00059 *                                                                 RVKRP006
00060 *  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                RVKRP006
00061 *                                                                 RVKRP006
00062      COPY DPWS132O.                                               RVKRP006
00063 *                                                                 RVKRP006
00064 *  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      RVKRP006
00065 *                                                                 RVKRP006
00066      COPY DPWS004.                                                RVKRP006
00067                                                                   RVKRP006
00068 *                                                                 RVKRP006
00069 *  RECORD LAYOUT OF THE RTV EXTRACT FILE.                         RVKRP006
00070 *                                                                 RVKRP006
00071      COPY RVWS010.                                                   CL**2
00072                                                                   RVKRP006
00073                                                                   RVKRP006
00074  01  ABEND-CODE                          PIC S9(04) VALUE +0      RVKRP006
00075                                                      COMP SYNC.   RVKRP006
00076  01  PH2-PAGE-HEADING-MONTHLY.                                    RVKRP006
00077      05  FILLER                          PIC  X(41)  VALUE SPACE. RVKRP006
00078      05  FILLER                          PIC  X(50)  VALUE        RVKRP006
00079          'RETURN-TO-VENDOR DEPARTMENT MONTHLY SUMMARY REPORT'.    RVKRP006
00080      05  FILLER                          PIC  X(41)  VALUE SPACE. RVKRP006
00081                                                                   RVKRP006
00082  01  PH2-PAGE-HEADING-YTD.                                        RVKRP006
00083      05  FILLER                          PIC  X(39)  VALUE SPACE. RVKRP006
00084      05  FILLER                          PIC  X(55)  VALUE        RVKRP006
00085        'RETURN-TO-VENDOR DEPARTMENT YEAR TO DATE SUMMARY REPORT'. RVKRP006
00086      05  FILLER                          PIC  X(38)  VALUE SPACE. RVKRP006
00075                                                                   RVKRP006
00076  01  PH2-PAGE-HEADING-WEEKLY.                                     RVKRP006
00077      05  FILLER                          PIC  X(41)  VALUE SPACE. RVKRP006
00078      05  FILLER                          PIC  X(50)  VALUE        RVKRP006
00079          'RETURN-TO-VENDOR DEPARTMENT WEEKLY SUMMARY REPORT '.    RVKRP006
00080      05  FILLER                          PIC  X(41)  VALUE SPACE. RVKRP006
00081                                                                   RVKRP006
00086      05  FILLER                          PIC  X(38)  VALUE SPACE. RVKRP006
00087                                                                   RVKRP006
00088  01  PH3-PAGE-HEADING-3.                                          RVKRP006
00089      05  FILLER                          PIC  X(44)  VALUE SPACE. RVKRP006
00090      05  FILLER                          PIC  X(12)  VALUE        RVKRP006
00091          'BEGIN DATE: '.                                          RVKRP006
00092      05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. RVKRP006
00093      05  FILLER                          PIC  X(13)  VALUE        RVKRP006
00094          ' - END DATE: '.                                         RVKRP006
00095      05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. RVKRP006
00096      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP006
00097                                                                   RVKRP006
00098  01  DH1-DETAIL-HEADING-1.                                        RVKRP006
00099      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00100      05  FILLER                          PIC  X(03)  VALUE        RVKRP006
00101          'DPT'.                                                   RVKRP006
00102      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00103      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP006
00104      05  FILLER                          PIC  X(02)  VALUE SPACE. RVKRP006
00105      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP006
00106      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00107      05  FILLER                          PIC  X(21)  VALUE        RVKRP006
00108          '   DEBITED & RETURNED'.                                 RVKRP006
00109      05  FILLER                          PIC  X(04)  VALUE SPACE. RVKRP006
00110      05  FILLER                          PIC  X(21)  VALUE        RVKRP006
00111          '  DEBITED & DESTROYED'.                                 RVKRP006
00112      05  FILLER                          PIC  X(04)  VALUE SPACE. RVKRP006
00113      05  FILLER                          PIC  X(21)  VALUE        RVKRP006
00114          '  MARKED OUT OF STOCK'.                                 RVKRP006
00115      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00116      05  FILLER                          PIC  X(05)  VALUE        RVKRP006
00117          ' % TO'.                                                 RVKRP006
00118                                                                   RVKRP006
00119  01  DH2-DETAIL-HEADING-2.                                        RVKRP006
00120      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00121      05  FILLER                          PIC  X(03)  VALUE        RVKRP006
00122          'NUM'.                                                   RVKRP006
00123      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00124      05  FILLER                          PIC  X(20)  VALUE        RVKRP006
00125          'DEPT DESCRIPTION    '.                                  RVKRP006
00126      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00127      05  FILLER                          PIC  X(20)  VALUE        RVKRP006
00128          'FACILITY            '.                                  RVKRP006
00129      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00130      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00131          '    QTY'.                                               RVKRP006
00132      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00133      05  FILLER                          PIC  X(12)  VALUE        RVKRP006
00134          '       COST '.                                          RVKRP006
00135      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP006
00136      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00137          '    QTY'.                                               RVKRP006
00138      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00139      05  FILLER                          PIC  X(12)  VALUE        RVKRP006
00140          '       COST '.                                          RVKRP006
00141      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP006
00142      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00143          '    QTY'.                                               RVKRP006
00144      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00145      05  FILLER                          PIC  X(12)  VALUE        RVKRP006
00146          '       COST '.                                          RVKRP006
00147      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00148      05  FILLER                          PIC  X(05)  VALUE        RVKRP006
00149          'TOTAL'.                                                 RVKRP006
00150                                                                   RVKRP006
00151  01  DHD-DETAIL-HEADING-DASHES.                                   RVKRP006
00152      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00153      05  FILLER                          PIC  X(03)  VALUE        RVKRP006
00154          '___'.                                                   RVKRP006
00155      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00156      05  FILLER                          PIC  X(20)  VALUE        RVKRP006
00157          '____________________'.                                  RVKRP006
00158      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00159      05  FILLER                          PIC  X(20)  VALUE        RVKRP006
00160          '____________________'.                                  RVKRP006
00161      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00162      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00163          '_______'.                                               RVKRP006
00164      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00165      05  FILLER                          PIC  X(13)  VALUE        RVKRP006
00166          '_____________'.                                         RVKRP006
00167      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00168      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00169          '_______'.                                               RVKRP006
00170      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00171      05  FILLER                          PIC  X(13)  VALUE        RVKRP006
00172          '_____________'.                                         RVKRP006
00173      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00174      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00175          '_______'.                                               RVKRP006
00176      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00177      05  FILLER                          PIC  X(13)  VALUE        RVKRP006
00178          '_____________'.                                         RVKRP006
00179      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00180      05  FILLER                          PIC  X(05)  VALUE        RVKRP006
00181          '_____'.                                                 RVKRP006
00182                                                                   RVKRP006
00183  01  DL-DETAIL-LINE.                                              RVKRP006
00184      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00185      05  DL-DPT-NBR                      PIC  X(03).              RVKRP006
00186      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00187      05  DL-DPT-DESC                     PIC  X(20).              RVKRP006
00188      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00189      05  DL-FCLTY-NAME                   PIC  X(20).              RVKRP006
00190      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00191      05  DL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP006
00192      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00193      05  DL-DR-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP006
00194      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00195      05  DL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP006
00196      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00197      05  DL-DD-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP006
00198      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00199      05  DL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP006
00200      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00201      05  DL-MO-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP006
00202      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00203      05  DL-PER-CENT-TO-TOTAL            PIC  ZZ9.9.              RVKRP006
00204                                                                   RVKRP006
00205  01  TL-TOTAL-LINE-DASHES.                                        RVKRP006
00206      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00207      05  FILLER                          PIC  X(20)  VALUE SPACES.RVKRP006
00208      05  FILLER                          PIC  X(27)  VALUE SPACES.RVKRP006
00209      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00210      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00211          '_______'.                                               RVKRP006
00212      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00213      05  FILLER                          PIC  X(13)  VALUE        RVKRP006
00214          '_____________'.                                         RVKRP006
00215      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00216      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00217          '_______'.                                               RVKRP006
00218      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00219      05  FILLER                          PIC  X(13)  VALUE        RVKRP006
00220          '_____________'.                                         RVKRP006
00221      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00222      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00223          '_______'.                                               RVKRP006
00224      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00225      05  FILLER                          PIC  X(13)  VALUE        RVKRP006
00226          '_____________'.                                         RVKRP006
00227      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00228      05  FILLER                          PIC  X(05)  VALUE        RVKRP006
00229          '_____'.                                                 RVKRP006
00230                                                                   RVKRP006
00231  01  TL-TOTAL-LINE.                                               RVKRP006
00232      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00233      05  FILLER                          PIC  X(16)  VALUE SPACES.RVKRP006
00234      05  TL-TOTAL-DESCRIPTION            PIC  X(22)  VALUE SPACES.RVKRP006
00235      05  FILLER                          PIC  X(07)  VALUE        RVKRP006
00236          'TOTAL: '.                                               RVKRP006
00237      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP006
00238      05  TL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP006
00239      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00240      05  TL-DR-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP006
00241      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00242      05  TL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP006
00243      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00244      05  TL-DD-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP006
00245      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP006
00246      05  TL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP006
00247      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00248      05  TL-MO-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP006
00249      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP006
00250      05  TL-PER-CENT-TO-TOTAL            PIC  ZZ9.9.              RVKRP006
00251                                                                   RVKRP006
00252                                                                   RVKRP006
00253  01  BLANK-LINE.                                                  RVKRP006
00254      05  FILLER                          PIC  X(132) VALUE SPACE. RVKRP006
00255                                                                   RVKRP006
00256  01  END-OF-REPORT-LINE.                                          RVKRP006
00257      05  FILLER                          PIC  X(88)  VALUE SPACE. RVKRP006
00258      05  FILLER                          PIC  X(25)  VALUE        RVKRP006
00259          '***** END OF REPORT *****'.                             RVKRP006
00260      05  FILLER                          PIC  X(87)  VALUE SPACE. RVKRP006
00261                                                                   RVKRP006
00262  01  ER-EMPTY-REPORT-LINE.                                        RVKRP006
00263      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP006
00264      05  FILLER                          PIC  X(48)  VALUE        RVKRP006
00265          '*** NO DATA SATISFIES THE SELECTION CRITERIA ***'.      RVKRP006
00266      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP006
00267                                                                   RVKRP006
00268  01  PA-PROGRAM-ACCUMULATORS.                                     RVKRP006
00269      05  PA-DPT-TOTALS.                                           RVKRP006
00270          10 PA-DR-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP006
00271                                                      COMP-3.      RVKRP006
00272          10 PA-DR-DPT-COST               PIC S9(08)V99            RVKRP006
00273                                                      VALUE +0     RVKRP006
00274                                                      COMP-3.      RVKRP006
00275          10 PA-DD-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP006
00276                                                      COMP-3.      RVKRP006
00277          10 PA-DD-DPT-COST               PIC S9(08)V99            RVKRP006
00278                                                      VALUE +0     RVKRP006
00279                                                      COMP-3.      RVKRP006
00280          10 PA-MO-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP006
00281                                                      COMP-3.      RVKRP006
00282          10 PA-MO-DPT-COST               PIC S9(08)V9999          RVKRP006
00283                                                      VALUE +0     RVKRP006
00284                                                      COMP-3.      RVKRP006
00285      05  PA-FCLTY-TOTALS.                                         RVKRP006
00286          10 PA-DR-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP006
00287                                                      COMP-3.      RVKRP006
00288          10 PA-DR-FCLTY-COST             PIC S9(08)V99            RVKRP006
00289                                                      VALUE +0     RVKRP006
00290                                                      COMP-3.      RVKRP006
00291          10 PA-DD-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP006
00292                                                      COMP-3.      RVKRP006
00293          10 PA-DD-FCLTY-COST             PIC S9(08)V99            RVKRP006
00294                                                      VALUE +0     RVKRP006
00295                                                      COMP-3.      RVKRP006
00296          10 PA-MO-FCLTY-QTY              PIC S9(06)  VALUE +0     RVKRP006
00297                                                      COMP-3.      RVKRP006
00298          10 PA-MO-FCLTY-COST             PIC S9(08)V9999          RVKRP006
00299                                                      VALUE +0     RVKRP006
00300                                                      COMP-3.      RVKRP006
00301      05  PA-GRAND-TOTALS.                                         RVKRP006
00302          10 PA-DR-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP006
00303                                                      COMP-3.      RVKRP006
00304          10 PA-DR-GRAND-COST             PIC S9(08)V99            RVKRP006
00305                                                      VALUE +0     RVKRP006
00306                                                      COMP-3.      RVKRP006
00307          10 PA-DD-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP006
00308                                                      COMP-3.      RVKRP006
00309          10 PA-DD-GRAND-COST             PIC S9(08)V99            RVKRP006
00310                                                      VALUE +0     RVKRP006
00311                                                      COMP-3.      RVKRP006
00312          10 PA-MO-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP006
00313                                                      COMP-3.      RVKRP006
00314          10 PA-MO-GRAND-COST             PIC S9(08)V9999          RVKRP006
00315                                                      VALUE +0     RVKRP006
00316                                                      COMP-3.      RVKRP006
00317      05  PA-HOLD-TOTALS.                                          RVKRP006
00318          10 PA-DR-HOLD-QTY               PIC S9(06)  VALUE +0     RVKRP006
00319                                                      COMP-3.      RVKRP006
00320          10 PA-DR-HOLD-COST              PIC S9(08)V99            RVKRP006
00321                                                      VALUE +0     RVKRP006
00322                                                      COMP-3.      RVKRP006
00323          10 PA-DD-HOLD-QTY               PIC S9(06)  VALUE +0     RVKRP006
00324                                                      COMP-3.      RVKRP006
00325          10 PA-DD-HOLD-COST              PIC S9(08)V99            RVKRP006
00326                                                      VALUE +0     RVKRP006
00327                                                      COMP-3.      RVKRP006
00328          10 PA-MO-HOLD-QTY               PIC S9(06)  VALUE +0     RVKRP006
00329                                                      COMP-3.      RVKRP006
00330          10 PA-MO-HOLD-COST              PIC S9(08)V9999          RVKRP006
00331                                                      VALUE +0     RVKRP006
00332                                                      COMP-3.      RVKRP006
00333                                                                   RVKRP006
00334  01  PC-CONSTANTS.                                                RVKRP006
00335      05  PC-COMMIT-INTERVAL              PIC  9(02)  VALUE 10.    RVKRP006
00336      05  PC-MAX-REFERRAL-CODES           PIC S9(04)  VALUE +7     RVKRP006
00337                                                      COMP SYNC.   RVKRP006
00338 * 6 LPI -- 14 X 8.5 PAPER (6 * 8.5 = 51)                          RVKRP006
00339      05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +55    RVKRP006
00340                                                      COMP SYNC.   RVKRP006
00341      05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   RVKRP006
00342                                                      COMP SYNC.   RVKRP006
00343      05  PC-ZERO                         PIC  9(01)  VALUE 0.     RVKRP006
00344      05  PC-ONE                          PIC  9(01)  VALUE 1.     RVKRP006
00345      05  PC-TWO                          PIC  9(01)  VALUE 2.     RVKRP006
00346      05  PC-THREE                        PIC  9(01)  VALUE 3.     RVKRP006
00347      05  PC-FOUR                         PIC  9(01)  VALUE 4.     RVKRP006
00348      05  PC-EIGHT                        PIC  9(01)  VALUE 8.     RVKRP006
00349      05  PC-NINE                         PIC  9(01)  VALUE 9.     RVKRP006
00350      05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  RVKRP006
00351      05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        RVKRP006
00352          'RVKRP006'.                                              RVKRP006
00353      05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        RVKRP006
00354          'RVK050  '.                                              RVKRP006
00355      05  PC-SKU-DESC-ZERO                PIC  X(15)  VALUE        RVKRP006
00356          'V E N D O R    '.                                       RVKRP006
00359      05  PC-MBS-SYSTEM-CODE-RV           PIC  X(02)  VALUE 'RV'.  RVKRP006
00360      05  PC-MBS-OP-CO-03                 PIC  X(02)  VALUE '03'.  RVKRP006
00361      05  PC-PGM-DPKUT039                 PIC  X(08)               RVKRP006
00362                                          VALUE 'DPKUT039'.        RVKRP006
00363                                                                   RVKRP006
00364  01  PS-PROGRAM-SWITCHES.                                         RVKRP006
00365      05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.   RVKRP006
00366          88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   RVKRP006
00367          88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   RVKRP006
00368                                                                   RVKRP006
00369      05  PS-NEW-LINE-IND                 PIC  X(01)  VALUE 'N'.   RVKRP006
00370          88  PS-NEW-LINE                             VALUE 'Y'.   RVKRP006
00371          88  PS-NO-NEW-LINE                          VALUE 'N'.   RVKRP006
00372                                                                   RVKRP006
00373      05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   RVKRP006
00374          88  PS-NO-DATA                              VALUE 'N'.   RVKRP006
00375          88  PS-DATA                                 VALUE 'Y'.   RVKRP006
00376                                                                   RVKRP006
00377      05  PS-TOTAL-TYPE-IND               PIC  X(01)  VALUE ' '.   RVKRP006
00378          88  PS-DPT-TOTAL                            VALUE '1'.   RVKRP006
00379          88  PS-FCLTY-TOTAL                          VALUE '2'.   RVKRP006
00380          88  PS-GRAND-TOTAL                          VALUE '3'.   RVKRP006
00381                                                                   RVKRP006
00382  01  PV-PROGRAM-VARIABLES.                                        RVKRP006
00383      05  PV-PER-CENT-CALC                PIC S9(03)V9(04) VALUE +0RVKRP006
00384                                                      COMP SYNC.   RVKRP006
00385      05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     RVKRP006
00386                                                      COMP SYNC.   RVKRP006
00387      05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     RVKRP006
00388                                                      COMP SYNC.   RVKRP006
00389                                                                   RVKRP006
00390      05  PV-HOLD-DPT-NBR                 PIC  X(03).              RVKRP006
00391      05  PV-HOLD-DPT-DESC                PIC  X(25).              RVKRP006
00392      05  PV-HOLD-OPER-UNT-ID             PIC S9(04) COMP.         RVKRP006
00393      05  PV-HOLD-FCLTY-NAME              PIC  X(25).              RVKRP006
00394 *                                                                 RVKRP006
00395      05  PV-RPT-TYPE                     PIC  X(1).               RVKRP006
00396          88  PV-MONTHLY-REPORT           VALUE 'M'.               RVKRP006
00397          88  PV-YEAR-TO-DATE-REPORT      VALUE 'Y'.               RVKRP006
00396          88  PV-WEEKLY-REPORT            VALUE 'W'.               RVKRP006
00398      05  PV-BEGIN-DATE.                                           RVKRP006
00399          10  PV-BEGIN-MONTH              PIC  9(02).              RVKRP006
00400          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP006
00401          10  PV-BEGIN-DAY                PIC  9(02).              RVKRP006
00402          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP006
00403          10  PV-BEGIN-CENTURY            PIC  9(02).              RVKRP006
00404          10  PV-BEGIN-YEAR               PIC  9(02).              RVKRP006
00405      05  PV-END-DATE.                                             RVKRP006
00406          10  PV-END-MONTH                PIC  9(02).              RVKRP006
00407          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP006
00408          10  PV-END-DAY                  PIC  9(02).              RVKRP006
00409          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP006
00410          10  PV-END-CENTURY              PIC  9(02).              RVKRP006
00411          10  PV-END-YEAR                 PIC  9(02).              RVKRP006
00412      05  PV-REPORT-LINE                 PIC X(132).               RVKRP006
00413                                                                   RVKRP006
00414  01  ST-SYSTEM-TIME.                                              RVKRP006
00415      05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. RVKRP006
00416      05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. RVKRP006
00417                                                                   RVKRP006
00418 *                                                                 RVKRP006
00419 ******************************************************************RVKRP006
00420 *  WORK FIELDS FOR THE MBS SUBROUTINE                             RVKRP006
00421 ******************************************************************RVKRP006
00422      COPY DPWS003.                                                RVKRP006
00423                                                                   RVKRP006
00424 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP006
00425  PROCEDURE DIVISION.                                              RVKRP006
00426 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP006
00427                                                                   RVKRP006
00428 ******************************************************************RVKRP006
00429 *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    RVKRP006
00430 ******************************************************************RVKRP006
00431  0000-PROGRAM-MAINLINE.                                           RVKRP006
00432                                                                   RVKRP006
00433      PERFORM 1000-INITIALIZE.                                     RVKRP006
00434                                                                   RVKRP006
00435      PERFORM 2000-CREATE-REPORT.                                  RVKRP006
00436                                                                   RVKRP006
00437      PERFORM 9000-EOJ-ROUTINE.                                    RVKRP006
00438      STOP RUN.                                                    RVKRP006
00439 *0000-EXIT.                                                       RVKRP006
00440                                                                   RVKRP006
00441 ******************************************************************RVKRP006
00442 *  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  RVKRP006
00443 *  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST RVKRP006
00444 *  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT RVKRP006
00445 *  FILE.                                                          RVKRP006
00446 ******************************************************************RVKRP006
00447  1000-INITIALIZE.                                                 RVKRP006
00448                                                                   RVKRP006
00449      OPEN OUTPUT DI-DEFECT-ITEM-REPORT                            RVKRP006
00450           INPUT  RTV-REPORT-EXTRACT.                              RVKRP006
00451                                                                   RVKRP006
00452      SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                      RVKRP006
00453                                                                   RVKRP006
00454      PERFORM 7000-READ-EXTRACT-FILE.                              RVKRP006
00455                                                                   RVKRP006
00456      IF PS-END-OF-EXTRACT-FILE                                    RVKRP006
00457          SET PS-NO-DATA          TO TRUE                          RVKRP006
00458      ELSE                                                         RVKRP006
00459          IF RV010-DETAIL-REC                                      RVKRP006
00460              DISPLAY '** ABEND **'                                RVKRP006
00461              DISPLAY '** PROGRAM = RVKRP006 **'                   RVKRP006
00462              DISPLAY '** PARAGRAPH = 1000-INITIALIZE.     **'     RVKRP006
00463              DISPLAY '** FIRST RECORD NOT THE DATE RECORD **'     RVKRP006
00464              MOVE +4003 TO ABEND-CODE                             RVKRP006
00465              CALL 'ILBOABN0' USING ABEND-CODE                     RVKRP006
00466          ELSE                                                     RVKRP006
00467              SET PS-DATA           TO TRUE                        RVKRP006
00468                                                                   RVKRP006
00469              MOVE RV010-RPT-TYPE   TO PV-RPT-TYPE                 RVKRP006
00470                                                                   RVKRP006
00471              MOVE RV010-END-MM     TO PV-END-MONTH                RVKRP006
00472              MOVE RV010-END-DD     TO PV-END-DAY                  RVKRP006
00473              MOVE RV010-END-CC     TO PV-END-CENTURY              RVKRP006
00474              MOVE RV010-END-YY     TO PV-END-YEAR                 RVKRP006
00475                                                                   RVKRP006
00476              MOVE RV010-BEGIN-MM   TO PV-BEGIN-MONTH              RVKRP006
00477              MOVE RV010-BEGIN-DD   TO PV-BEGIN-DAY                RVKRP006
00478              MOVE RV010-BEGIN-CC   TO PV-BEGIN-CENTURY            RVKRP006
00479              MOVE RV010-BEGIN-YY   TO PV-BEGIN-YEAR               RVKRP006
00480                                                                   RVKRP006
00481              MOVE PV-BEGIN-DATE    TO PH3-START-DATE              RVKRP006
00482              MOVE PV-END-DATE      TO PH3-END-DATE                RVKRP006
00483                                                                   RVKRP006
00484              MOVE RV010-CURR-YY    TO DP132O-RUN-YEAR             RVKRP006
00485              MOVE RV010-CURR-MM    TO DP132O-RUN-MONTH            RVKRP006
00486              MOVE RV010-CURR-DD    TO DP132O-RUN-DAY              RVKRP006
00487                                                                   RVKRP006
00488              ACCEPT ST-SYSTEM-TIME FROM TIME                      RVKRP006
00489              MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR             RVKRP006
00490              MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE           RVKRP006
00491                                                                   RVKRP006
00492              MOVE 'RVKRP006'       TO DP132O-PROGRAM-NAME         RVKRP006
00493                                                                   RVKRP006
                   EVALUATE TRUE                                                
00494                WHEN PV-MONTHLY-REPORT                             RVKRP006
00495                  MOVE 1            TO DP132O-REPORT-NUMBER        RVKRP006
00494                WHEN PV-YEAR-TO-DATE-REPORT                        RVKRP006
00497                  MOVE 2            TO DP132O-REPORT-NUMBER        RVKRP006
00494                WHEN PV-WEEKLY-REPORT                              RVKRP006
00495                  MOVE 3            TO DP132O-REPORT-NUMBER        RVKRP006
                   END-EVALUATE                                                 
00499                                                                   RVKRP006
00500              MOVE PC-MAX-REPORT-LINES                             RVKRP006
00501                                    TO PV-LINE-COUNT               RVKRP006
00502              MOVE +0               TO PV-PAGE-COUNT               RVKRP006
00503                                                                   RVKRP006
00504              INITIALIZE DL-DETAIL-LINE                            RVKRP006
00505                         PA-PROGRAM-ACCUMULATORS                   RVKRP006
00506                                                                   RVKRP006
00507              MOVE RV010-DR-TOTAL-QTY TO  PA-DR-HOLD-QTY           RVKRP006
00508              MOVE RV010-DR-TOTAL-COST TO PA-DR-HOLD-COST          RVKRP006
00509              MOVE RV010-DD-TOTAL-QTY TO  PA-DD-HOLD-QTY           RVKRP006
00510              MOVE RV010-DD-TOTAL-COST TO PA-DD-HOLD-COST          RVKRP006
00511              MOVE RV010-MO-TOTAL-QTY TO  PA-MO-HOLD-QTY           RVKRP006
00512              MOVE RV010-MO-TOTAL-COST TO PA-MO-HOLD-COST          RVKRP006
00513                                                                   RVKRP006
00514              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP006
00515          END-IF                                                   RVKRP006
00516      END-IF.                                                      RVKRP006
00517                                                                   RVKRP006
00518                                                                   RVKRP006
00519 *1000-EXIT.                                                       RVKRP006
00520                                                                   RVKRP006
00521 ******************************************************************RVKRP006
00522 * 2000-CREATE-REPORT                                              RVKRP006
00523 * PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNARVKRP006
00524 * SORT FILE.                                                      RVKRP006
00525 ******************************************************************RVKRP006
00526  2000-CREATE-REPORT.                                              RVKRP006
00527                                                                   RVKRP006
00528      IF PS-END-OF-EXTRACT-FILE                                    RVKRP006
00529          MOVE ER-EMPTY-REPORT-LINE  TO PV-REPORT-LINE             RVKRP006
00530          PERFORM 8000-PRINT-REPORT-LINE                           RVKRP006
00531      ELSE                                                         RVKRP006
00532          MOVE RV010-DPT-NBR       TO PV-HOLD-DPT-NBR              RVKRP006
00533          MOVE RV010-DPT-DESC      TO PV-HOLD-DPT-DESC             RVKRP006
00534          MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID          RVKRP006
00535          MOVE RV010-FCLTY-NAME    TO PV-HOLD-FCLTY-NAME           RVKRP006
00536 *                                                                 RVKRP006
00537          PERFORM UNTIL PS-END-OF-EXTRACT-FILE                     RVKRP006
00538              IF RV010-DPT-NBR = PV-HOLD-DPT-NBR                   RVKRP006
00539                  IF RV010-OPER-UNT-ID = PV-HOLD-OPER-UNT-ID       RVKRP006
00540                      PERFORM 2100-ACCUMULATE-TOTALS               RVKRP006
00541                  ELSE                                             RVKRP006
00542                      PERFORM 2200-FCLTY-BREAK                     RVKRP006
00543                  END-IF                                           RVKRP006
00544              ELSE                                                 RVKRP006
00545                  PERFORM 2300-DPT-BREAK                           RVKRP006
00546              END-IF                                               RVKRP006
00547                                                                   RVKRP006
00548              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP006
00549                                                                   RVKRP006
00550          END-PERFORM                                              RVKRP006
00551      END-IF.                                                      RVKRP006
00552                                                                   RVKRP006
00553 ******************************************************************RVKRP006
00554 * 2100-ACCUMULATE-TOTALS                                          RVKRP006
00555 * PROCESS:  THIS PARAGRAPH WILL ACCUMULATE TOTALS AT THE          RVKRP006
00556 *  DEPT/FACILITY LEVEL.                                           RVKRP006
00557 ******************************************************************RVKRP006
00558  2100-ACCUMULATE-TOTALS.                                          RVKRP006
00559                                                                   RVKRP006
00560      EVALUATE TRUE                                                RVKRP006
00561          WHEN RV010-RTV-TYPE                                      RVKRP006
00562              ADD RV010-UNIT-COST-AMT  TO PA-DR-FCLTY-COST         RVKRP006
00563              ADD +1                  TO PA-DR-FCLTY-QTY           RVKRP006
00564                                                                   RVKRP006
00565          WHEN RV010-DD-TYPE                                       RVKRP006
00566              ADD RV010-UNIT-COST-AMT  TO PA-DD-FCLTY-COST         RVKRP006
00567              ADD +1                  TO PA-DD-FCLTY-QTY           RVKRP006
00568                                                                   RVKRP006
00569          WHEN RV010-MO-TYPE                                       RVKRP006
00570              ADD RV010-UNIT-COST-AMT  TO PA-MO-FCLTY-COST         RVKRP006
00571              ADD +1                  TO PA-MO-FCLTY-QTY           RVKRP006
00572      END-EVALUATE.                                                RVKRP006
00573                                                                   RVKRP006
00574                                                                   RVKRP006
00575 ******************************************************************RVKRP006
00576 * 2200-FCLTY-BREAK.                                               RVKRP006
00577 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP006
00578 *  THE FACILITY:                                                  RVKRP006
00579 *     1) PRINT LINE OF OLD FACILITY TO REPORT                     RVKRP006
00580 *     2) RESET THE "HOLD" VARIABLES                               RVKRP006
00581 *     3) ADD "OLD" FACILITY TOTALS TO DEPARTMENT TOTALS           RVKRP006
00582 *     4) INITIALIZE FACILITY TOTALS FOR NEW FACILITY              RVKRP006
00583 *     5) ADD CURRENT VALUES TO NEW FACILITY TOTALS                RVKRP006
00584 ******************************************************************RVKRP006
00585  2200-FCLTY-BREAK.                                                RVKRP006
00586                                                                   RVKRP006
00587      PERFORM 8000-PRINT-REPORT-LINE.                              RVKRP006
00588                                                                   RVKRP006
00589      MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID              RVKRP006
00590      MOVE RV010-FCLTY-NAME    TO PV-HOLD-FCLTY-NAME.              RVKRP006
00591                                                                   RVKRP006
00592      ADD PA-DR-FCLTY-QTY      TO PA-DR-DPT-QTY.                   RVKRP006
00593      ADD PA-DR-FCLTY-COST     TO PA-DR-DPT-COST.                  RVKRP006
00594 *                                                                 RVKRP006
00595      ADD PA-DD-FCLTY-QTY      TO PA-DD-DPT-QTY.                   RVKRP006
00596      ADD PA-DD-FCLTY-COST     TO PA-DD-DPT-COST.                  RVKRP006
00597 *                                                                 RVKRP006
00598      ADD PA-MO-FCLTY-QTY      TO PA-MO-DPT-QTY.                   RVKRP006
00599      ADD PA-MO-FCLTY-COST     TO PA-MO-DPT-COST.                  RVKRP006
00600 *                                                                 RVKRP006
00601      INITIALIZE PA-FCLTY-TOTALS.                                  RVKRP006
00602 *                                                                 RVKRP006
00603      PERFORM 2100-ACCUMULATE-TOTALS.                              RVKRP006
00604                                                                   RVKRP006
00605 ******************************************************************RVKRP006
00606 * 2300-DPT-BREAK                                                  RVKRP006
00607 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP006
00608 *  THE DPT:                                                       RVKRP006
00609 *     1) PERFORM FACILITY BREAK LOGIC                             RVKRP006
00610 *     2) PRINT DEPARTMENT TOTAL LINE                              RVKRP006
00611 *     3) RESET THE "HOLD" DPT VALUE                               RVKRP006
00612 *     4) ADD "OLD" DPT TOTALS TO GRAND TOTALS                     RVKRP006
00613 *     5) INITIALIZE DPT TOTALS FOR NEW DPT                        RVKRP006
00614 ******************************************************************RVKRP006
00615  2300-DPT-BREAK.                                                  RVKRP006
00616                                                                   RVKRP006
00617      PERFORM 2200-FCLTY-BREAK.                                    RVKRP006
00618 *                                                                 RVKRP006
00619      SET PS-DPT-TOTAL         TO TRUE.                            RVKRP006
00620      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP006
00621                                                                   RVKRP006
00622      SET PS-NEW-LINE          TO TRUE.                            RVKRP006
00623 *                                                                 RVKRP006
00624      MOVE RV010-DPT-DESC      TO PV-HOLD-DPT-DESC.                RVKRP006
00625      MOVE RV010-DPT-NBR       TO PV-HOLD-DPT-NBR.                 RVKRP006
00626 *                                                                 RVKRP006
00627      ADD PA-DR-DPT-QTY        TO PA-DR-GRAND-QTY.                 RVKRP006
00628      ADD PA-DR-DPT-COST       TO PA-DR-GRAND-COST.                RVKRP006
00629                                                                   RVKRP006
00630      ADD PA-DD-DPT-QTY        TO PA-DD-GRAND-QTY.                 RVKRP006
00631      ADD PA-DD-DPT-COST       TO PA-DD-GRAND-COST.                RVKRP006
00632                                                                   RVKRP006
00633      ADD PA-MO-DPT-QTY        TO PA-MO-GRAND-QTY.                 RVKRP006
00634      ADD PA-MO-DPT-COST       TO PA-MO-GRAND-COST.                RVKRP006
00635 *                                                                 RVKRP006
00636      INITIALIZE PA-DPT-TOTALS.                                    RVKRP006
00637                                                                   RVKRP006
00638 *                                                                 RVKRP006
00639 *                                                                 RVKRP006
00640 ******************************************************************RVKRP006
00641 * 2500-GRAND-TOTAL                                                RVKRP006
00642 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR THE GRAND   RVKRP006
00643 *  TOTAL:                                                         RVKRP006
00644 *     1) PERFORM DPT BREAK LOGIC                                  RVKRP006
00645 *     2) PRINT GRAND TOTAL LINE                                   RVKRP006
00646 ******************************************************************RVKRP006
00647  2500-GRAND-TOTAL.                                                RVKRP006
00648                                                                   RVKRP006
00649      PERFORM 2300-DPT-BREAK.                                      RVKRP006
00650 *                                                                 RVKRP006
00651      SET PS-GRAND-TOTAL       TO TRUE.                            RVKRP006
00652      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP006
00653 *                                                                 RVKRP006
00654 *                                                                 RVKRP006
00655 ******************************************************************RVKRP006
00656 * 7000-READ-EXTRACT-FILE.                                        *RVKRP006
00657 *  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *RVKRP006
00658 *  FLAT FILE.                                                    *RVKRP006
00659 ******************************************************************RVKRP006
00660  7000-READ-EXTRACT-FILE.                                          RVKRP006
00661 *                                                                 RVKRP006
00662      READ RTV-REPORT-EXTRACT                                      RVKRP006
00663          INTO RV010-EXTRACT-RECORD                                RVKRP006
00664          AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               RVKRP006
00665                                                                   RVKRP006
00666 ******************************************************************RVKRP006
00667 * 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   RVKRP006
00668 * CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNTRVKRP006
00669 * INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  RVKRP006
00670 ******************************************************************RVKRP006
00671  8000-PRINT-REPORT-LINE.                                          RVKRP006
00672                                                                   RVKRP006
00673      ADD +1 TO PV-LINE-COUNT.                                     RVKRP006
00674                                                                   RVKRP006
00675      IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      RVKRP006
00676          PERFORM 8300-WRITE-PAGE-HEADING                          RVKRP006
00677          PERFORM 8400-WRITE-COLUMN-HEADING                        RVKRP006
00678      END-IF.                                                      RVKRP006
00679                                                                   RVKRP006
00680      IF PS-NEW-LINE                                               RVKRP006
00681          MOVE PV-HOLD-DPT-NBR      TO DL-DPT-NBR                  RVKRP006
00682          MOVE PV-HOLD-DPT-DESC     TO DL-DPT-DESC                 RVKRP006
00683          SET PS-NO-NEW-LINE        TO TRUE                        RVKRP006
00684      ELSE                                                         RVKRP006
00685          MOVE SPACES               TO DL-DPT-NBR                  RVKRP006
00686                                       DL-DPT-DESC                 RVKRP006
00687      END-IF.                                                      RVKRP006
00688                                                                   RVKRP006
00689      MOVE PV-HOLD-FCLTY-NAME       TO DL-FCLTY-NAME.              RVKRP006
00690      MOVE PA-DR-FCLTY-QTY          TO DL-DR-QTY.                  RVKRP006
00691      MOVE PA-DR-FCLTY-COST         TO DL-DR-COST.                 RVKRP006
00692      MOVE PA-DD-FCLTY-QTY          TO DL-DD-QTY.                  RVKRP006
00693      MOVE PA-DD-FCLTY-COST         TO DL-DD-COST.                 RVKRP006
00694      MOVE PA-MO-FCLTY-QTY          TO DL-MO-QTY.                  RVKRP006
00695      MOVE PA-MO-FCLTY-COST         TO DL-MO-COST.                 RVKRP006
                                                                                
GB         IF (PA-MO-FCLTY-COST  > 0) AND (PA-MO-HOLD-COST   > 0)               
00696         COMPUTE PV-PER-CENT-CALC =                                RVKRP006
00697             ((PA-MO-FCLTY-COST / PA-MO-HOLD-COST) * 100)          RVKRP006
00698                                                                   RVKRP006
GB         ELSE                                                                 
GB              MOVE +0 TO               PV-PER-CENT-CALC                       
GB         END-IF                                                               
                                                                                
00699      MOVE PV-PER-CENT-CALC         TO DL-PER-CENT-TO-TOTAL        RVKRP006
00700                                                                   RVKRP006
00701      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00702          FROM DL-DETAIL-LINE                                      RVKRP006
00703          AFTER ADVANCING 1 LINES.                                 RVKRP006
00704                                                                   RVKRP006
00705 *8000-EXIT.                                                       RVKRP006
00706                                                                   RVKRP006
00707 ******************************************************************RVKRP006
00708 * 8100-PRINT-TOTAL-LINE - WRITE THE CONTROL BREAK TOTAL LINES     RVKRP006
00709 ******************************************************************RVKRP006
00710  8100-PRINT-TOTAL-LINE.                                           RVKRP006
00711                                                                   RVKRP006
00712      EVALUATE TRUE                                                RVKRP006
00713          WHEN PS-DPT-TOTAL                                        RVKRP006
00714              MOVE SPACES              TO TL-TOTAL-DESCRIPTION     RVKRP006
00715 *            MOVE PV-HOLD-DPT-DESC    TO TL-TOTAL-DESCRIPTION     RVKRP006
00716              MOVE PA-DR-DPT-QTY       TO TL-DR-QTY                RVKRP006
00717              MOVE PA-DR-DPT-COST      TO TL-DR-COST               RVKRP006
00718              MOVE PA-DD-DPT-QTY       TO TL-DD-QTY                RVKRP006
00719              MOVE PA-DD-DPT-COST      TO TL-DD-COST               RVKRP006
00720              MOVE PA-MO-DPT-QTY       TO TL-MO-QTY                RVKRP006
00721              MOVE PA-MO-DPT-COST      TO TL-MO-COST               RVKRP006
                                                                                
GB                 IF (PA-MO-DPT-COST > 0 ) AND                                 
GB                    (PA-MO-HOLD-COST > 0 )                                    
00722                 COMPUTE PV-PER-CENT-CALC  =                       RVKRP006
00723                    ((PA-MO-DPT-COST / PA-MO-HOLD-COST) * 100)     RVKRP006
GB                 ELSE                                                         
GB                     MOVE +0 TO        PV-PER-CENT-CALC                       
GB                 END-IF                                                       
                                                                                
00725              MOVE PV-PER-CENT-CALC    TO TL-PER-CENT-TO-TOTAL     RVKRP006
00726                                                                   RVKRP006
00727          WHEN PS-GRAND-TOTAL                                      RVKRP006
00728              MOVE '                GRAND '                        RVKRP006
00729                                       TO TL-TOTAL-DESCRIPTION     RVKRP006
00730              MOVE PA-DR-GRAND-QTY     TO TL-DR-QTY                RVKRP006
00731              MOVE PA-DR-GRAND-COST    TO TL-DR-COST               RVKRP006
00732              MOVE PA-DD-GRAND-QTY     TO TL-DD-QTY                RVKRP006
00733              MOVE PA-DD-GRAND-COST    TO TL-DD-COST               RVKRP006
00734              MOVE PA-MO-GRAND-QTY     TO TL-MO-QTY                RVKRP006
00735              MOVE PA-MO-GRAND-COST    TO TL-MO-COST               RVKRP006
                                                                                
                   IF (PA-MO-GRAND-COST > 0) AND (PA-MO-HOLD-COST > 0)          
00736                 COMPUTE PV-PER-CENT-CALC =                        RVKRP006
00737                    ((PA-MO-GRAND-COST / PA-MO-HOLD-COST) * 100)   RVKRP006
                   ELSE                                                         
00738                 MOVE +0    TO PV-PER-CENT-CALC                    RVKRP006
                   END-IF                                                       
                                                                                
00739              MOVE PV-PER-CENT-CALC    TO TL-PER-CENT-TO-TOTAL     RVKRP006
00740                                                                   RVKRP006
00741              WRITE DI-DEFECT-ITEM-LINE                            RVKRP006
00742                  FROM TL-TOTAL-LINE-DASHES                        RVKRP006
00743                  AFTER ADVANCING 0 LINES                          RVKRP006
00744                                                                   RVKRP006
00745      END-EVALUATE.                                                RVKRP006
00746                                                                   RVKRP006
00747      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00748          FROM TL-TOTAL-LINE                                       RVKRP006
00749          AFTER ADVANCING 1 LINES.                                 RVKRP006
00750                                                                   RVKRP006
00751      ADD +1                        TO PV-LINE-COUNT.              RVKRP006
00752                                                                   RVKRP006
00753      PERFORM 8200-WRITE-BLANK-LINE.                               RVKRP006
00754                                                                   RVKRP006
00755                                                                   RVKRP006
00756 *8100-EXIT.                                                       RVKRP006
00757                                                                   RVKRP006
00758 ******************************************************************RVKRP006
00759 * 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      RVKRP006
00760 ******************************************************************RVKRP006
00761  8200-WRITE-BLANK-LINE.                                           RVKRP006
00762                                                                   RVKRP006
00763      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00764          FROM BLANK-LINE                                          RVKRP006
00765          AFTER ADVANCING 1 LINES.                                 RVKRP006
00766                                                                   RVKRP006
00767      ADD +1                        TO PV-LINE-COUNT.              RVKRP006
00768                                                                   RVKRP006
00769                                                                   RVKRP006
00770 *8200-EXIT.                                                       RVKRP006
00771 ******************************************************************RVKRP006
00772 * 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FORRVKRP006
00773 * THE DEFECTIVE ITEM REPORT.                                      RVKRP006
00774 ******************************************************************RVKRP006
00775  8300-WRITE-PAGE-HEADING.                                         RVKRP006
00776                                                                   RVKRP006
00777      ADD +1 TO PV-PAGE-COUNT.                                     RVKRP006
00778      MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    RVKRP006
00779                                                                   RVKRP006
00780      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00781          FROM DP132O-STANDRD-HEADER-132-COLS                      RVKRP006
00782          AFTER ADVANCING PAGE.                                    RVKRP006
00783                                                                   RVKRP006
           EVALUATE TRUE                                                        
00784        WHEN PV-MONTHLY-REPORT                                     RVKRP006
00785          WRITE DI-DEFECT-ITEM-LINE                                RVKRP006
00786              FROM PH2-PAGE-HEADING-MONTHLY                        RVKRP006
00787              AFTER ADVANCING 1 LINES                              RVKRP006
00788        WHEN PV-YEAR-TO-DATE-REPORT                                RVKRP006
00789          WRITE DI-DEFECT-ITEM-LINE                                RVKRP006
00790              FROM PH2-PAGE-HEADING-YTD                            RVKRP006
00791              AFTER ADVANCING 1 LINES                              RVKRP006
00784        WHEN PV-WEEKLY-REPORT                                      RVKRP006
00785          WRITE DI-DEFECT-ITEM-LINE                                RVKRP006
00786              FROM PH2-PAGE-HEADING-WEEKLY                         RVKRP006
00787              AFTER ADVANCING 1 LINES                              RVKRP006
00792      END-EVALUATE.                                                RVKRP006
00793                                                                   RVKRP006
00794      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00795          FROM PH3-PAGE-HEADING-3                                  RVKRP006
00796          AFTER ADVANCING 1 LINES.                                 RVKRP006
00797                                                                   RVKRP006
00798      MOVE +3     TO PV-LINE-COUNT.                                RVKRP006
00799                                                                   RVKRP006
00800      SET PS-NEW-LINE             TO TRUE.                         RVKRP006
00801                                                                   RVKRP006
00802 *8300-EXIT.                                                       RVKRP006
00803                                                                   RVKRP006
00804 ******************************************************************RVKRP006
00805 * 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       RVKRP006
00806 * THE DEFECTIVE ITEM REPORT.                                      RVKRP006
00807 ******************************************************************RVKRP006
00808  8400-WRITE-COLUMN-HEADING.                                       RVKRP006
00809                                                                   RVKRP006
00810      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00811          FROM DH1-DETAIL-HEADING-1                                RVKRP006
00812          AFTER ADVANCING 2 LINES.                                 RVKRP006
00813                                                                   RVKRP006
00814      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00815          FROM DH2-DETAIL-HEADING-2                                RVKRP006
00816          AFTER ADVANCING 1 LINES.                                 RVKRP006
00817                                                                   RVKRP006
00818      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00819          FROM DHD-DETAIL-HEADING-DASHES                           RVKRP006
00820          AFTER ADVANCING 0 LINES.                                 RVKRP006
00821                                                                   RVKRP006
00822      ADD +4       TO PV-LINE-COUNT.                               RVKRP006
00823 *8400-EXIT.                                                       RVKRP006
00824                                                                   RVKRP006
00825 ******************************************************************RVKRP006
00826 * 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  RVKRP006
00827 * CURSOR AND THE REPORT FILE.                                     RVKRP006
00828 ******************************************************************RVKRP006
00829  9000-EOJ-ROUTINE.                                                RVKRP006
00830                                                                   RVKRP006
00831      IF PS-NO-DATA                                                RVKRP006
00832          CONTINUE                                                 RVKRP006
00833      ELSE                                                         RVKRP006
00834          PERFORM 2500-GRAND-TOTAL                                 RVKRP006
00835      END-IF.                                                      RVKRP006
00836                                                                   RVKRP006
00837      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP006
00838          FROM END-OF-REPORT-LINE                                  RVKRP006
00839          AFTER ADVANCING 1 LINES.                                 RVKRP006
00840                                                                   RVKRP006
00841      CLOSE DI-DEFECT-ITEM-REPORT                                  RVKRP006
00842            RTV-REPORT-EXTRACT.                                    RVKRP006
00843                                                                   RVKRP006
00844 ******************************************************************RVKRP006
00845 **************************** END OF RVKRP006 *********************RVKRP006
00846 ******************************************************************RVKRP006
