000100*-------------------------------*                                 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-------------------------------*                                 00030000
000400 PROGRAM-ID.     RCKRP078.                                        00040000
000500 AUTHOR.         JOHN HUTCHINSON.                                 00050000
000600 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00060000
000700 DATE-WRITTEN    APRIL, 2003.                                     00070000
000800*----------------------------------------------------------------*00080000
000900*  THIS PROGRAM CREATES MONTHLY OVER/SHORT ANALYSIS SUMMARY RPTS. 00090009
001000*                                                                 00100000
001100*  BASED ON A INPUT CONTROL FILE WHICH CONTAINS WHAT TYPE OF RUN  00110009
001200*  IS BEING DONE, THE PROGRAM WILL CREATE REPORTS BY GMM, DMM,    00120009
001300*  BUYER, COMPANY AND COLBY INTERNATIONAL.                        00130009
001400*----------------------------------------------------------------*00140000
001500*-------------------------------*                                 00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700*-------------------------------*                                 00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900                                                                  00190000
002000 FILE-CONTROL.                                                    00200000
002100     SELECT DATE-FILE         ASSIGN TO UT-S-IN01.                00210000
002200     SELECT CONTROL-FILE      ASSIGN TO UT-S-IN02.                00220000
002300     SELECT INPUT-FILE        ASSIGN TO INP01.                    00230000
002400     SELECT REPORT-FILE       ASSIGN TO RPT01.                    00240000
002500                                                                  00250000
002600*-------------------------------*                                 00260000
002700 DATA DIVISION.                                                   00270000
002800*-------------------------------*                                 00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  DATE-FILE                                                    00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS.                                    00340000
003500 01  DATE-RECORD                    PIC X(80).                    00350000
003600                                                                  00360000
003700 FD  CONTROL-FILE                                                 00370000
003800     RECORDING MODE IS F                                          00380000
003900     LABEL RECORDS ARE STANDARD                                   00390000
004000     BLOCK CONTAINS 0 RECORDS.                                    00400000
004100 01  CONTROL-RECORD                 PIC X(80).                    00410000
004200                                                                  00420000
004300 FD  INPUT-FILE                                                   00430000
004400     RECORDING MODE IS F                                          00440000
004500     LABEL RECORDS ARE STANDARD                                   00450000
004600     BLOCK CONTAINS 0 RECORDS.                                    00460000
004700 01  INPUT-RECORD                   PIC X(400).                   00470000
004800                                                                  00480000
004900 FD  REPORT-FILE                                                  00490000
005000     RECORDING MODE IS F                                          00500000
005100     BLOCK CONTAINS 0 RECORDS                                     00510000
005200     LABEL RECORDS ARE OMITTED.                                   00520000
005300 01  REPORT-RECORD                  PIC X(150).                   00530000
005400                                                                  00540000
005500*-------------------------------*                                 00550000
005600 WORKING-STORAGE SECTION.                                         00560000
005700*-------------------------------*                                 00570000
005800 01  PS-SWITCHES.                                                 00580000
005900     05  PS-INPUT-EOF-SW            PIC X(01) VALUE 'N'.          00590000
006000         88  PS-INPUT-EOF-YES                 VALUE 'Y'.          00600000
006100         88  PS-INPUT-EOF-NO                  VALUE 'N'.          00610000
006200     05  PS-INPUT-DATA-SW           PIC X(01) VALUE 'Y'.          00620000
006300         88  PS-INPUT-DATA-YES                VALUE 'Y'.          00630000
006400         88  PS-INPUT-DATA-NO                 VALUE 'N'.          00640000
006500     05  PS-PROCESS-CURR-SW         PIC X(01) VALUE 'Y'.          00650000
006600         88  PS-PROCESS-CURR-YES              VALUE 'Y'.          00660000
006700         88  PS-PROCESS-CURR-NO               VALUE 'N'.          00670000
006800     05  PS-LINE-PRINTED-SW         PIC X(01) VALUE 'N'.          00680000
006900         88  PS-LINE-PRINTED-YES              VALUE 'Y'.          00690000
007000         88  PS-LINE-PRINTED-NO               VALUE 'N'.          00700000
007100     05  PS-PRINT-HEADINGS-SW       PIC X(01) VALUE 'N'.          00710000
007200         88  PS-PRINT-HEADINGS-YES            VALUE 'Y'.          00720000
007300         88  PS-PRINT-HEADINGS-NO             VALUE 'N'.          00730000
007400     05  PS-VALID-DATA-TO-PRINT-SW  PIC X(01) VALUE 'N'.          00740000
007500         88  PS-VALID-DATA-TO-PRINT-YES       VALUE 'Y'.          00750000
007600         88  PS-VALID-DATA-TO-PRINT-NO        VALUE 'N'.          00760000
007700                                                                  00770000
007800 01  PC-PROGRAM-CONSTANTS.                                        00780000
007900     05  PC-RPT-NBR-GMM             PIC 9(01) VALUE 1.            00790000
008000     05  PC-RPT-NBR-DMM             PIC 9(01) VALUE 2.            00800000
008100     05  PC-RPT-COMPANY             PIC 9(01) VALUE 3.            00810000
008200     05  PC-RPT-NBR-BYR             PIC 9(01) VALUE 4.            00820000
008300     05  PC-RPT-NBR-COLBY           PIC 9(01) VALUE 5.            00830000
008400     05  PC-ONE                     PIC 9(01) VALUE 1.            00840000
008500     05  PC-TWENTY-EIGHT            PIC 9(02) VALUE 28.           00850000
008600     05  PC-LINE-LIMIT              PIC S9(4) VALUE +62 COMP.     00860000
008700     05  PC-PCT-SIGN                PIC X(01) VALUE '%'.          00870000
008800     05  PC-PERIOD-06               PIC X(02) VALUE '06'.         00880000
008900     05  PC-PERIOD-07               PIC X(02) VALUE '07'.         00890000
009000     05  PC-CURRENT-PROGRAM         PIC X(08) VALUE 'RCKRP078'.   00900000
009100     05  PC-RUN-TYPE-GMM            PIC X(10) VALUE 'GMM       '. 00910000
009200     05  PC-RUN-TYPE-DMM            PIC X(10) VALUE 'DMM       '. 00920000
009300     05  PC-RUN-TYPE-COMPANY        PIC X(10) VALUE 'COMPANY   '. 00930000
009400     05  PC-RUN-TYPE-BYR            PIC X(10) VALUE 'BUYER     '. 00940000
009500     05  PC-RUN-TYPE-COLBY          PIC X(10) VALUE 'COLBY     '. 00950000
009600     05  PC-RUN-TYPE-VENDOR         PIC X(10) VALUE 'VENDOR    '. 00960000
009700     05  PC-TITLE-NAME-1            PIC X(05) VALUE 'TOTAL'.      00970000
009800     05  PC-TITLE-NAME-2            PIC X(05) VALUE 'FINAL'.      00980000
009900     05  PC-RUN-TYPE-KOHLS          PIC X(25) VALUE               00990000
010000                                    'KOHL''S DEPARTMENT STORES'.  01000000
010100     05  PC-RUN-TYPE-COLBY-INTL     PIC X(25) VALUE               01010000
010200                                    'COLBY INTERNATIONAL LTD  '.  01020000
010300                                                                  01030000
010400 01  PV-PROGRAM-VARIABLES.                                        01040000
010500     05  PV-LINE-COUNT              PIC S9(4) VALUE +66.          01050000
010600     05  PV-PAGE-COUNT              PIC S9(4) VALUE +0.           01060000
010700     05  PV-VENDOR-COUNT            PIC S9(4) VALUE +0.           01070000
010800     05  PV-REC-COUNT               PIC S9(9) VALUE +0.           01080000
010900     05  PV-HOLD-BYR-NMBR           PIC X(03) VALUE SPACES.       01090022
011000     05  PV-HOLD-DMM-NMBR           PIC X(02) VALUE SPACES.       01100022
011100     05  PV-HOLD-GMM-NMBR           PIC X(02) VALUE SPACES.       01110022
011200     05  PV-HOLD-VENDOR-DESC        PIC X(30) VALUE SPACES.       01120022
011300     05  PV-HOLD-IMPRT-VEND         PIC X(35) VALUE SPACES.       01130000
011400     05  PV-PCT-OVER                PIC S9(3)V999 VALUE +0.       01140000
011500     05  PV-PCT-SHORT               PIC S9(3)V999 VALUE +0.       01150000
011600                                                                  01160000
011700     05  PV-DISPLAY-QTY1            PIC ZZZ,ZZZ,ZZ9-.             01170006
011800     05  PV-DISPLAY-QTY2            PIC ZZZ,ZZZ,ZZ9-.             01180006
011900     05  PV-DISPLAY-QTY3            PIC ZZZ,ZZZ,ZZ9-.             01190016
012000     05  PV-EXPTED-ITM-QTY          PIC S9(09).                   01200006
012100     05  PV-TOTAL-OVER-SHORT        PIC S9(09).                   01210000
012200     05  PV-INTENDED-ORD-QTY        PIC S9(09).                   01220000
012300     05  PV-STILL-EXPECT-QTY        PIC S9(09).                   01230000
012400     05  PV-ACCURACY                PIC S9(3)V9(5).               01240000
012500     05  PV-ACCURACY-999            PIC S9(3).                    01250017
012600                                                                  01260000
012700 01  RUN-CONTROL-RECORD.                                          01270000
012800     05  CC-RUN-CONTROL             PIC X(07).                    01280000
012900         88  CC-GMM-NBR                       VALUE 'GMM NBR'.    01290000
013000         88  CC-DMM-NBR                       VALUE 'DMM NBR'.    01300000
013100         88  CC-COMPANY                       VALUE 'COMPANY'.    01310000
013200         88  CC-BYR-NBR                       VALUE 'BYR NBR'.    01320000
013300         88  CC-COLBY                         VALUE 'COLBY  '.    01330000
013400     05  FILLER                     PIC X(73).                    01340000
013500                                                                  01350000
013600 01  CC-CONTROL-CARD-PARAMETERS.                                  01360000
013700     05  CC-EXTRACT-DATE            PIC X(02) VALUE SPACES.       01370000
013800         88  CC-VALID-DATE                    VALUE 'AR' 'VE'     01380000
013900                                                    'BT'.         01390000
014000         88  CC-ARRIVED-DATE-EXTRACT          VALUE 'AR'.         01400000
014100         88  CC-VERIFYD-DATE-EXTRACT          VALUE 'VE'.         01410000
014200         88  CC-BOTH-DATE-EXTRACT             VALUE 'BT'.         01420000
014300     05  FILLER                     PIC X(01) VALUE SPACE.        01430000
014400     05  CC-EXTRACT-TYPE            PIC X(01) VALUE SPACE.        01440000
014500         88  CC-VALID-TYPE                    VALUE 'P'           01450008
014600                                                    'S' 'Y'.      01460000
014700         88  CC-PERIOD-NUMBER                 VALUE 'P'.          01470000
014800         88  CC-SEASON-NUMBER                 VALUE 'S'.          01480000
014900         88  CC-YEAR-END                      VALUE 'Y'.          01490000
015000     05  FILLER                     PIC X     VALUE SPACE.        01500000
015100     05  CC-EXTRACT-SEASON          PIC X(07) VALUE SPACE.        01510000
015200         88  CC-EXTRACT-VALID-SEASON          VALUE 'SPRING '     01520000
015300                                                    'FALL   '     01530000
015400                                                    'YEAREND'     01540000
015500                                                    'PERIOD '.    01550000
015600         88  CC-EXTRACT-SPRING                VALUE 'SPRING '.    01560000
015700         88  CC-EXTRACT-FALL                  VALUE 'FALL   '.    01570000
015800         88  CC-EXTRACT-YEAR-END              VALUE 'YEAREND'.    01580000
015900         88  CC-EXTRACT-PERIOD                VALUE 'PERIOD '.    01590000
016000     05  FILLER                     PIC X(68) VALUE SPACE.        01600000
016100                                                                  01610000
016200 01  PV-CURRENT-DATE-TIME.                                        01620000
016300     05  PV-CURRENT-DATE.                                         01630000
016400         10  PV-CURRENT-YY          PIC 9(02) VALUE ZERO.         01640000
016500         10  PV-CURRENT-MM          PIC 9(02) VALUE ZERO.         01650000
016600         10  PV-CURRENT-DD          PIC 9(02) VALUE ZERO.         01660000
016700     05  PV-CURRENT-TIME.                                         01670000
016800         10  PV-CURRENT-HOUR        PIC 9(02) VALUE ZERO.         01680000
016900         10  PV-CURRENT-MINUTE      PIC 9(02) VALUE ZERO.         01690000
017000         10  FILLER                 PIC 9(04) VALUE ZERO.         01700000
017100                                                                  01710000
017200 01  PV-DATE-AREA.                                                01720000
017300     05  PV-DATE-AREA-MM            PIC 9(02) VALUE ZERO.         01730000
017400     05  FILLER                     PIC X(01) VALUE '/'.          01740000
017500     05  PV-DATE-AREA-DD            PIC 9(02) VALUE ZERO.         01750000
017600     05  FILLER                     PIC X(01) VALUE '/'.          01760000
017700     05  PV-DATE-AREA-YY            PIC 9(02) VALUE ZERO.         01770000
017800                                                                  01780000
017900 01  PV-START-EXTRACT               PIC X(26) VALUE SPACE.        01790000
018000 01  FILLER REDEFINES PV-START-EXTRACT.                           01800000
018100     05  PV-START-CCYY-MM-DD.                                     01810000
018200         10  PV-START-EXTRACT-YYYY  PIC 9(04).                    01820000
018300         10  PV-START-EXTRACT-1ST   PIC X(01).                    01830000
018400         10  PV-START-EXTRACT-MM    PIC 9(02).                    01840000
018500         10  PV-START-EXTRACT-2ND   PIC X(01).                    01850000
018600         10  PV-START-EXTRACT-DD    PIC 9(02).                    01860000
018700     05  PV-START-EXTRACT-3RD       PIC X(01).                    01870000
018800     05  PV-START-TIMESTAMP         PIC X(15).                    01880000
018900                                                                  01890000
019000 01  PV-END-EXTRACT                 PIC X(26) VALUE SPACE.        01900000
019100 01  FILLER REDEFINES PV-END-EXTRACT.                             01910000
019200     05  PV-END-CCYY-MM-DD.                                       01920000
019300         10  PV-END-EXTRACT-YYYY    PIC 9(04).                    01930000
019400         10  PV-END-EXTRACT-YYYY-RE REDEFINES                     01940000
019500                                    PV-END-EXTRACT-YYYY.          01950000
019600             15  PV-END-EXTRACT-CC  PIC 9(02).                    01960000
019700             15  PV-END-EXTRACT-YY  PIC 9(02).                    01970000
019800         10  PV-END-EXTRACT-1ST     PIC X(01).                    01980000
019900         10  PV-END-EXTRACT-MM      PIC 9(02).                    01990000
020000         10  PV-END-EXTRACT-2ND     PIC X(01).                    02000000
020100         10  PV-END-EXTRACT-DD      PIC 9(02).                    02010000
020200     05  PV-END-EXTRACT-3RD         PIC X(01).                    02020000
020300     05  PV-END-TIMESTAMP           PIC X(15).                    02030000
020400                                                                  02040000
020500 01  PV-YEAR-FORMAT.                                              02050000
020600     05  PV-YEAR-FORMAT-CC          PIC 9(02) VALUE ZERO.         02060000
020700     05  PV-YEAR-FORMAT-YY          PIC 9(02) VALUE ZERO.         02070000
020800                                                                  02080000
020900 01  PV-ABEND-FIELDS.                                             02090000
021000     05  PV-ABEND-CODE              PIC S9(4) VALUE +0 COMP.      02100000
021100     05  PV-ABEND-PROGRAM           PIC X(08) VALUE 'RCKRP078'.   02110000
021200     05  PV-ABEND-PARAGRAPH         PIC X(50) VALUE SPACES.       02120000
021300     05  PV-ABEND-DISPLAY-1         PIC X(50) VALUE SPACES.       02130000
021400     05  PV-ABEND-DISPLAY-2         PIC X(50) VALUE SPACES.       02140000
021500     05  PV-ABEND-DISPLAY-3         PIC X(50) VALUE SPACES.       02150000
021600                                                                  02160000
021700*    ---------------------                                        02170000
021800*    INPUT DATE RECORD                                            02180000
021900*    ---------------------                                        02190000
022000     COPY RCRD067.                                                02200000
022100                                                                  02210000
022200 01  PV-HOLD-DATE-END.                                            02220000
022300     05  PV-HOLD-DATE-CCYY          PIC X(04) VALUE SPACES.       02230000
022400     05  FILLER                     PIC X(01) VALUE '-'.          02240000
022500     05  PV-HOLD-DATE-MM            PIC X(02) VALUE SPACES.       02250000
022600     05  FILLER                     PIC X(01) VALUE '-'.          02260000
022700     05  PV-HOLD-DATE-DD            PIC X(02) VALUE SPACES.       02270000
022800                                                                  02280000
022900 01  PV-DETAIL-TOTALS.                                            02290000
023000     05  PV-EXPTED-ITM-QTY-D2       PIC S9(09).                   02300000
023100     05  PV-TOTAL-OVER-SHORT-D2     PIC S9(09).                   02310000
023200     05  PV-INTENDED-ORD-QTY-D2     PIC S9(09).                   02320000
023300     05  PV-STILL-EXPECT-QTY-D2     PIC S9(09).                   02330000
023400                                                                  02340023
023500 01  PV-DETAIL-ACCUM.                                             02350023
023600     05  PV-ACCUM-PO-COUNT          PIC S9(9) VALUE +0.           02360023
023700     05  PV-ACCUM-OVERAGE-QTY       PIC S9(9) VALUE +0.           02370023
023800     05  PV-ACCUM-TOT-UNITS-OVER    PIC S9(9) VALUE +0.           02380023
023900     05  PV-ACCUM-SHORTAGE-QTY      PIC S9(9) VALUE +0.           02390023
024000     05  PV-ACCUM-TOT-UNITS-SHORT   PIC S9(9) VALUE +0.           02400023
024100     05  PV-ACCUM-CURR-SPLIT-QTY    PIC S9(9) VALUE +0.           02410023
024200     05  PV-ACCUM-EXPTED-ITM-QTY    PIC S9(9) VALUE +0.           02420023
024300     05  PV-ACCUM-OV-RETAIL-AMT     PIC S9(9)V99  VALUE +0.       02430023
024400     05  PV-ACCUM-SH-RETAIL-AMT     PIC S9(9)V99  VALUE +0.       02440023
024500                                                                  02450000
024600 01  PV-BREAK-TOTALS.                                             02460000
024700     05  PV-BRK-PO-COUNT            PIC S9(9) VALUE +0.           02470000
024800     05  PV-BRK-EXPTED-ITM-QTY      PIC S9(9) VALUE +0.           02480000
024900     05  PV-BRK-VERIFY-ITM-QTY      PIC S9(9) VALUE +0.           02490023
025000     05  PV-BRK-CURR-SPLIT-QTY      PIC S9(9) VALUE +0.           02500000
025100     05  PV-BRK-OVR-QTY             PIC S9(9) VALUE +0.           02510000
025200     05  PV-BRK-SHT-QTY             PIC S9(9) VALUE +0.           02520000
025300     05  PV-BRK-UNITS-OVER          PIC S9(9) VALUE +0.           02530000
025400     05  PV-BRK-UNITS-SHORT         PIC S9(9) VALUE +0.           02540000
025500     05  PV-BRK-OVR-RETAIL          PIC S9(9)V99  VALUE +0.       02550000
025600     05  PV-BRK-SHT-RETAIL          PIC S9(9)V99  VALUE +0.       02560000
025700     05  PV-BRK-OVSH                PIC S9(9)V99  VALUE +0.       02570000
025800     05  PV-BRK-PCT-OVER            PIC S9(3)V999 VALUE +0.       02580000
025900     05  PV-BRK-PCT-SHORT           PIC S9(3)V999 VALUE +0.       02590000
026000     05  PV-EXPTED-ITM-QTY-B1       PIC S9(09).                   02600000
026100     05  PV-TOTAL-OVER-SHORT-B1     PIC S9(09).                   02610000
026200     05  PV-INTENDED-ORD-QTY-B1     PIC S9(09).                   02620000
026300     05  PV-STILL-EXPECT-QTY-B1     PIC S9(09).                   02630000
026400     05  PV-EXPTED-ITM-QTY-B2       PIC S9(09).                   02640000
026500     05  PV-TOTAL-OVER-SHORT-B2     PIC S9(09).                   02650000
026600     05  PV-INTENDED-ORD-QTY-B2     PIC S9(09).                   02660000
026700     05  PV-STILL-EXPECT-QTY-B2     PIC S9(09).                   02670000
026800                                                                  02680000
026900 01  PV-FINAL-TOTALS.                                             02690000
027000     05  PV-TOT-PO-COUNT            PIC S9(9) VALUE +0.           02700000
027100     05  PV-TOT-EXPTED-ITM-QTY      PIC S9(9) VALUE +0.           02710000
027200     05  PV-TOT-VERIFY-ITM-QTY      PIC S9(9) VALUE +0.           02720000
027300     05  PV-TOT-CURR-SPLIT-QTY      PIC S9(9) VALUE +0.           02730000
027400     05  PV-TOT-OVR-QTY             PIC S9(9) VALUE +0.           02740000
027500     05  PV-TOT-SHT-QTY             PIC S9(9) VALUE +0.           02750000
027600     05  PV-TOT-UNITS-OVER          PIC S9(9) VALUE +0.           02760000
027700     05  PV-TOT-UNITS-SHORT         PIC S9(9) VALUE +0.           02770000
027800     05  PV-TOT-OVR-RETAIL          PIC S9(9)V99  VALUE +0.       02780000
027900     05  PV-TOT-SHT-RETAIL          PIC S9(9)V99  VALUE +0.       02790000
028000     05  PV-TOT-OVSH                PIC S9(9)V99  VALUE +0.       02800000
028100     05  PV-TOT-PCT-OVER            PIC S9(3)V999 VALUE +0.       02810000
028200     05  PV-TOT-PCT-SHORT           PIC S9(3)V999 VALUE +0.       02820000
028300     05  PV-EXPTED-ITM-QTY-T1       PIC S9(09).                   02830000
028400     05  PV-TOTAL-OVER-SHORT-T1     PIC S9(09).                   02840000
028500     05  PV-INTENDED-ORD-QTY-T1     PIC S9(09).                   02850000
028600     05  PV-STILL-EXPECT-QTY-T1     PIC S9(09).                   02860000
028700     05  PV-EXPTED-ITM-QTY-T2       PIC S9(09).                   02870000
028800     05  PV-TOTAL-OVER-SHORT-T2     PIC S9(09).                   02880000
028900     05  PV-INTENDED-ORD-QTY-T2     PIC S9(09).                   02890000
029000     05  PV-STILL-EXPECT-QTY-T2     PIC S9(09).                   02900000
029100                                                                  02910000
029200******************************************************************02920000
029300*                     P R I N T   L I N E S                      *02930000
029400******************************************************************02940000
029500 01  HL1-HEADING-LINE-1.                                          02950000
029600     05  HL1-RUN-DATE.                                            02960000
029700         10  HL1-RUN-MONTH          PIC 9(02) VALUE ZERO.         02970000
029800         10  FILLER                 PIC X(01) VALUE '/'.          02980000
029900         10  HL1-RUN-DAY            PIC 9(02) VALUE ZERO.         02990000
030000         10  FILLER                 PIC X(01) VALUE '/'.          03000000
030100         10  HL1-RUN-YEAR           PIC 9(02) VALUE ZERO.         03010000
030200     05  FILLER                     PIC X(02) VALUE SPACE.        03020000
030300     05  HL1-RUN-TIME.                                            03030000
030400         10  HL1-RUN-HOUR           PIC 9(02) VALUE ZERO.         03040000
030500         10  FILLER                 PIC X(01) VALUE ':'.          03050000
030600         10  HL1-RUN-MINUTE         PIC 9(02) VALUE ZERO.         03060000
030700     05  FILLER                     PIC X(39) VALUE SPACE.        03070000
030800     05  FILLER                     PIC X(47) VALUE               03080000
030900         'K O H L '' S   D E P A R T M E N T   S T O R E S'.      03090000
031000     05  FILLER                     PIC X(28) VALUE SPACE.        03100000
031100     05  HL1-PROGRAM-NAME           PIC X(08) VALUE SPACE.        03110000
031200     05  FILLER                     PIC X(01) VALUE '-'.          03120000
031300     05  HL1-REPORT-NUMBER          PIC 9(01) VALUE ZERO.         03130000
031400     05  FILLER                     PIC X(02) VALUE SPACE.        03140000
031500     05  FILLER                     PIC X(05) VALUE 'PAGE '.      03150000
031600     05  HL1-PAGE-NUMBER            PIC ZZZ9  VALUE ZERO.         03160000
031700                                                                  03170000
031800 01  HL2-HEADING-LINE-2.                                          03180000
031900     05  FILLER                 PIC X(55) VALUE SPACES.           03190000
032000     05  FILLER                 PIC X(45) VALUE                   03200000
032100         'OVERAGE/SHORTAGE RECEIVED REPORT (IN 1000''S)'.         03210000
032200     05  FILLER                 PIC X(50) VALUE SPACES.           03220000
032300                                                                  03230000
032400 01  HL2-HEADING-LINE-2B.                                         03240000
032500     05  FILLER                 PIC X(40) VALUE SPACES.           03250000
032600     05  FILLER                 PIC X(04) VALUE 'FOR '.           03260000
032700     05  HL2-MONTH              PIC X(06) VALUE 'MONTH '.         03270000
032800     05  HL2-MONTH-YEAR-START   PIC X(10) VALUE SPACES.           03280000
032900     05  FILLER                 PIC X(03) VALUE ' - '.            03290000
033000     05  HL2-MONTH-YEAR-END     PIC X(10) VALUE SPACES.           03300000
033100     05  FILLER                 PIC X(02) VALUE SPACES.           03310000
033200     05  HL2-FISCAL-PERIOD.                                       03320000
033300         10  FILLER             PIC X(16)                         03330000
033400                                VALUE 'FISCAL PERIOD - '.         03340000
033500         10  HL2-PERIOD         PIC X(02) VALUE SPACES.           03350000
033600     05  FILLER                 PIC X(02) VALUE SPACES.           03360000
033700     05  HL2-FISCAL-PERIOD.                                       03370000
033800         10  FILLER             PIC X(17)                         03380000
033900                                VALUE 'FISCAL QUARTER - '.        03390000
034000         10  HL2-QUARTER        PIC X(02) VALUE SPACES.           03400000
034100     05  FILLER                 PIC X(02) VALUE SPACES.           03410000
034200     05  HL2-FISCAL-SEASON.                                       03420000
034300         10  FILLER             PIC X(18)                         03430000
034400                                VALUE 'SEASONAL REPORT - '.       03440000
034500         10  HL2-SEASON         PIC X(06) VALUE SPACES.           03450000
034600     05  FILLER                 PIC X(10) VALUE SPACES.           03460000
034700                                                                  03470000
034800 01  HL3-HEADING-LINE-3.                                          03480000
034900     05  FILLER                 PIC X(14) VALUE                   03490000
035000                               'REPORT TYPE - '.                  03500000
035100     05  HL3-REPORT-TYPE        PIC X(11) VALUE SPACES.           03510000
035200     05  FILLER                 PIC X(03) VALUE SPACES.           03520000
035300     05  HL3-USER-ID            PIC X(03) VALUE SPACES.           03530000
035400     05  FILLER                 PIC X(01) VALUE SPACES.           03540000
035500     05  HL3-SEQUENCE-TYPE      PIC X(30) VALUE SPACES.           03550000
035600     05  FILLER                 PIC X(05) VALUE SPACES.           03560000
035700     05  FILLER                 PIC X(13) VALUE '| OVERAGE    '.  03570000
035800     05  FILLER                 PIC X(13) VALUE SPACES.           03580000
035900     05  FILLER                 PIC X(13) VALUE '| SHORTAGE   '.  03590000
036000     05  FILLER                 PIC X(15) VALUE SPACES.           03600000
036100     05  FILLER                 PIC X(13) VALUE '| TOTAL      '.  03610000
036200     05  FILLER                 PIC X(16) VALUE SPACES.           03620000
036300                                                                  03630000
036400 01  HL4-HEADING-LINE-4.                                          03640000
036500     05  FILLER                 PIC X(47) VALUE SPACES.           03650000
036600     05  FILLER                 PIC X(09) VALUE '   TOTAL '.      03660000
036700     05  FILLER                 PIC X(11) VALUE '    TOTAL  '.    03670000
036800     05  HL4-OVERAGE-GROUP.                                       03680000
036900         10  FILLER             PIC X(11) VALUE '|   TOTAL  '.    03690000
037000         10  FILLER             PIC X(07) VALUE '  TOTAL'.        03700000
037100         10  FILLER             PIC X(08) VALUE '  TOTAL '.       03710000
037200     05  HL4-SHORTAGE-GROUP.                                      03720000
037300         10  FILLER             PIC X(12) VALUE '|   TOTAL   '.   03730000
037400         10  FILLER             PIC X(07) VALUE '  TOTAL'.        03740000
037500         10  FILLER             PIC X(09) VALUE '   TOTAL '.      03750000
037600     05  HL4-TOTAL-GROUP.                                         03760000
037700         10  FILLER             PIC X(12) VALUE '|   TOTAL   '.   03770000
037800         10  FILLER             PIC X(08) VALUE '   NET  '.       03780000
037900         10  FILLER             PIC X(09) VALUE '|SHIPMENT'.      03790000
038000                                                                  03800000
038100 01  HL5-HEADING-LINE-5.                                          03810000
038200     05  FILLER                 PIC X(27) VALUE                   03820000
038300                                '                           '.    03830000
038400     05  FILLER                 PIC X(05) VALUE 'SALES'.          03840000
038500     05  FILLER                 PIC X(09) VALUE ' SHIPMENT'.      03850000
038600     05  FILLER                 PIC X(06) VALUE '   PO '.         03860000
038700     05  FILLER                 PIC X(09) VALUE '   UNITS '.      03870000
038800     05  FILLER                 PIC X(11) VALUE '    UNITS  '.    03880000
038900     05  HL5-OVERAGE-GROUP.                                       03890000
039000         10  FILLER             PIC X(11) VALUE '| UNITS ORD'.    03900000
039100         10  FILLER             PIC X(07) VALUE '   OVER'.        03910000
039200         10  FILLER             PIC X(08) VALUE '  %OVER '.       03920000
039300     05  HL5-SHORTAGE-GROUP.                                      03930000
039400         10  FILLER             PIC X(12) VALUE '| UNITS ORD '.   03940000
039500         10  FILLER             PIC X(07) VALUE '  SHORT'.        03950000
039600         10  FILLER             PIC X(09) VALUE '  %SHORT '.      03960000
039700     05  HL5-TOTAL-GROUP.                                         03970000
039800         10  FILLER             PIC X(12) VALUE '|   UNITS   '.   03980000
039900         10  FILLER             PIC X(08) VALUE ' RETAIL$'.       03990000
040000         10  FILLER             PIC X(09) VALUE '|ACCURACY'.      04000000
040100                                                                  04010000
040200 01  HL6-HEADING-LINE-6.                                          04020000
040300     05  FILLER                 PIC X(27) VALUE                   04030000
040400                                'VENDOR NAME                '.    04040000
040500     05  FILLER                 PIC X(05) VALUE ' RANK'.          04050000
040600     05  FILLER                 PIC X(09) VALUE ' ACCURACY'.      04060000
040700     05  FILLER                 PIC X(06) VALUE '  CNT '.         04070000
040800     05  FILLER                 PIC X(09) VALUE '  ORDERED'.      04080000
040900     05  FILLER                 PIC X(11) VALUE '  RECEIVED '.    04090000
041000     05  HL6-OVERAGE-GROUP.                                       04100000
041100         10  FILLER             PIC X(11) VALUE '| W/OVERAGE'.    04110000
041200         10  FILLER             PIC X(07) VALUE '  UNITS'.        04120000
041300         10  FILLER             PIC X(08) VALUE '   REC  '.       04130000
041400     05  HL6-SHORTAGE-GROUP.                                      04140000
041500         10  FILLER             PIC X(12) VALUE '| W/SHORTAGE'.   04150000
041600         10  FILLER             PIC X(07) VALUE '  UNITS'.        04160000
041700         10  FILLER             PIC X(09) VALUE '    REC  '.      04170000
041800     05  HL6-TOTAL-GROUP.                                         04180000
041900         10  FILLER             PIC X(12) VALUE '| OVER/SHORT'.   04190000
042000         10  FILLER             PIC X(08) VALUE ' IMPACT '.       04200000
042100         10  FILLER             PIC X(09) VALUE '|   YTD  '.      04210000
042200                                                                  04220000
042300 01  DL1-DETAIL-LINE-1.                                           04230000
042400     05  DL1-VENDOR-NAME        PIC X(27).                        04240000
042500     05  FILLER  REDEFINES  DL1-VENDOR-NAME.                      04250000
042600         10  DL1-ORDER-NBR      PIC 9(09).                        04260000
042700         10  FILLER             PIC X(18).                        04270000
042800     05  FILLER                 PIC X(01).                        04280000
042900     05  DL1-SALES-RANK         PIC ZZZ9.                         04290000
043000     05  FILLER                 PIC X(03).                        04300000
043100     05  DL1-SHIPMENT-ACCURACY  PIC ZZ9-.                         04310000
043200     05  DL1-PCT-1              PIC X(01).                        04320000
043300     05  FILLER                 PIC X(01).                        04330023
043400     05  DL1-PO-COUNT           PIC ZZZZ9.                        04340023
043500     05  FILLER                 PIC X(01).                        04350023
043600     05  DL1-UNITS-ORD          PIC ZZZ,ZZ9.9.                    04360023
043700     05  FILLER                 PIC X(01).                        04370023
043800     05  DL1-UNITS-RECV         PIC ZZZ,ZZ9.9.                    04380023
043900     05  DL1-OVERAGE-GROUP.                                       04390000
044000         10  FILLER                   PIC  X(01).                 04400023
044100         10  DL1-UNITS-ORD-OVER       PIC  ZZZ,ZZ9.9.             04410023
044200         10  FILLER                   PIC  X(01).                 04420023
044300         10  DL1-UNITS-RECV-OVER      PIC  ZZ,ZZ9.9.              04430023
044400         10  FILLER                   PIC  X(02).                 04440000
044500         10  DL1-PCT-OVER             PIC  ZZ9-.                  04450000
044600         10  DL1-PCT-2                PIC  X(01).                 04460000
044700     05  DL1-SHORTAGE-GROUP.                                      04470000
044800         10  FILLER                   PIC  X(01).                 04480023
044900         10  DL1-UNITS-ORD-SHORT      PIC  ZZZ,ZZ9.9.             04490023
045000         10  FILLER                   PIC  X(01).                 04500023
045100         10  DL1-UNITS-RECV-SHORT     PIC  ZZZ,ZZ9.9.             04510023
045200         10  FILLER                   PIC  X(03).                 04520000
045300         10  DL1-PCT-SHORT            PIC  ZZ9-.                  04530000
045400         10  DL1-PCT-3                PIC  X(01).                 04540000
045500     05  DL1-TOT-GROUP.                                           04550000
045600         10  FILLER                   PIC  X(01).                 04560023
045700         10  DL1-TOT-OVSH             PIC  ZZZ,ZZ9.9.             04570023
045800         10  FILLER                   PIC  X(01).                 04580023
045900         10  DL1-TOT-RETAIL-IMPACT    PIC  ZZZ,ZZ9.9-.            04590023
046000         10  FILLER                   PIC  X(03).                 04600000
046100         10  DL1-YTD-ACCURACY         PIC  ZZ9-.                  04610000
046200         10  DL1-PCT-4                PIC  X(01).                 04620000
046300         10  FILLER                   PIC  X(01).                 04630000
046400                                                                  04640000
046500 01  TL1-TOT-LINE-1.                                              04650000
046600     05  TL1-TITLE                    PIC  X(05).                 04660000
046700     05  FILLER                       PIC  X(01).                 04670000
046800     05  TL1-USER-ID                  PIC  X(03).                 04680000
046900     05  FILLER                       PIC  X(01).                 04690000
047000     05  TL1-VENDOR-NAME              PIC  X(24).                 04700000
047100     05  FILLER                       PIC  X(01).                 04710000
047200     05  TL1-SHIPMENT-ACCURACY        PIC  ZZ9-.                  04720000
047300     05  TL1-PCT-1                    PIC  X(01).                 04730000
047400     05  FILLER                       PIC  X(01).                 04740023
047500     05  TL1-PO-COUNT                 PIC  ZZZZ9.                 04750023
047600     05  FILLER                       PIC  X(01).                 04760000
047700     05  TL1-UNITS-ORD                PIC  ZZZ,ZZ9.9.             04770000
047800     05  FILLER                       PIC  X(01).                 04780000
047900     05  TL1-UNITS-RECV               PIC  ZZZ,ZZ9.9.             04790000
048000     05  TL1-OVERAGE-GROUP.                                       04800000
048100         10  FILLER                   PIC  X(01).                 04810000
048200         10  TL1-UNITS-ORD-OVER       PIC  ZZZ,ZZ9.9.             04820000
048300         10  FILLER                   PIC  X(01).                 04830000
048400         10  TL1-UNITS-RECV-OVER      PIC  ZZ,ZZ9.9.              04840000
048500         10  FILLER                   PIC  X(02).                 04850000
048600         10  TL1-PCT-OVER             PIC  ZZ9-.                  04860000
048700         10  TL1-PCT-2                PIC  X(01).                 04870000
048800     05  TL1-SHORTAGE-GROUP.                                      04880000
048900         10  FILLER                   PIC  X(01).                 04890000
049000         10  TL1-UNITS-ORD-SHORT      PIC  ZZZ,ZZ9.9.             04900000
049100         10  FILLER                   PIC  X(01).                 04910000
049200         10  TL1-UNITS-RECV-SHORT     PIC  ZZZ,ZZ9.9.             04920000
049300         10  FILLER                   PIC  X(03).                 04930000
049400         10  TL1-PCT-SHORT            PIC  ZZ9-.                  04940000
049500         10  TL1-PCT-3                PIC  X(01).                 04950000
049600     05  TL1-TOT-GROUP.                                           04960000
049700         10  FILLER                   PIC  X(01).                 04970000
049800         10  TL1-TOT-OVSH             PIC  ZZZ,ZZ9.9.             04980000
049900         10  FILLER                   PIC  X(01).                 04990000
050000         10  TL1-TOT-RETAIL-IMPACT    PIC  ZZZ,ZZ9.9-.            05000000
050100         10  FILLER                   PIC  X(03).                 05010000
050200         10  TL1-YTD-ACCURACY         PIC  ZZ9-.                  05020000
050300         10  TL1-PCT-4                PIC  X(01).                 05030000
050400         10  FILLER                   PIC  X(01).                 05040000
050500                                                                  05050000
050600 01  PR-PRINT-DASH-1.                                             05060000
050700     05  FILLER                 PIC X(67) VALUE SPACES.           05070000
050800     05  FILLER                 PIC X(83) VALUE ALL '-'.          05080000
050900                                                                  05090000
051000 01  PR-PRINT-DASH-2.                                             05100000
051100     05  FILLER                 PIC X(150) VALUE ALL '-'.         05110000
051200                                                                  05120000
051300 01  PR-PRINT-DASH-3.                                             05130000
051400     05  FILLER                 PIC X(150) VALUE ALL '='.         05140000
051500                                                                  05150000
051600 01  PR-PRINT-BLANK-LINE.                                         05160000
051700     05  FILLER                 PIC X(150) VALUE SPACES.          05170000
051800                                                                  05180000
051900 01  PR-PRINT-FINAL.                                              05190000
052000     05  FILLER                 PIC X(64) VALUE SPACES.           05200000
052100     05  FILLER                 PIC X(21) VALUE                   05210000
052200                                '*** END OF REPORT ***'.          05220000
052300     05  FILLER                 PIC X(65) VALUE SPACES.           05230000
052400                                                                  05240000
052500 01  PR-PRINT-NO-DETAIL.                                          05250000
052600     05  FILLER                 PIC X(60) VALUE SPACES.           05260000
052700     05  FILLER                 PIC X(29) VALUE                   05270000
052800                                '*** NO DETAILS TO REPORT ***'.   05280000
052900     05  FILLER                 PIC X(61) VALUE SPACES.           05290000
053000                                                                  05300000
053100*---------------------------------------------------------------* 05310000
053200*    COPYBOOK USED FOR INPUT FILE                               * 05320000
053300*---------------------------------------------------------------* 05330000
053400     COPY RCRD065.                                                05340000
053500                                                                  05350000
053600*---------------------------------------------------------------* 05360000
053700*    COPYBOOK USED BY CALENDAR ROUTINE                          * 05370000
053800*---------------------------------------------------------------* 05380000
053900     COPY DPWS500.                                                05390000
054000                                                                  05400000
054100***  EXEC SQL                                                     05410000
054200***      INCLUDE SQLCA                                            05420000
054300***  END-EXEC.                                                    05430000
054400                                                                  05440000
054500***  EXEC SQL                                                     05450000
054600***      INCLUDE TKRPRPM                                          05460000
054700***  END-EXEC.                                                    05470000
054800                                                                  05480000
054900*-------------------------*                                       05490000
055000 PROCEDURE DIVISION.                                              05500000
055100*-------------------------*                                       05510000
055200     OPEN INPUT DATE-FILE                                         05520000
055300                CONTROL-FILE                                      05530000
055400                INPUT-FILE                                        05540000
055500         OUTPUT REPORT-FILE.                                      05550000
055600                                                                  05560000
055700     PERFORM 1000-INITIALIZE.                                     05570000
055800                                                                  05580000
055900     IF PS-INPUT-EOF-YES                                          05590000
056000         PERFORM 6000-NO-REPORT-DETAIL                            05600000
056100         SET PS-INPUT-DATA-NO TO TRUE                             05610000
056200     ELSE                                                         05620000
056300         PERFORM 2000-MAIN-PROCESS                                05630000
056400           UNTIL  PS-INPUT-EOF-YES                                05640023
056500     END-IF.                                                      05650023
056600                                                                  05660000
056700     IF PS-VALID-DATA-TO-PRINT-NO                                 05670023
056800       AND PS-INPUT-DATA-YES                                      05680023
056900         PERFORM 6000-NO-REPORT-DETAIL                            05690000
057000         SET PS-INPUT-DATA-NO TO TRUE                             05700000
057100     END-IF.                                                      05710000
057200                                                                  05720000
057300     IF PS-INPUT-DATA-NO                                          05730000
057400         CONTINUE                                                 05740000
057500     ELSE                                                         05750000
057600         PERFORM 5100-PRINT-END-OF-REPORT                         05760023
057700     END-IF.                                                      05770023
057800                                                                  05780000
057900     CLOSE INPUT-FILE                                             05790000
058000           DATE-FILE                                              05800000
058100           CONTROL-FILE                                           05810000
058200           REPORT-FILE.                                           05820000
058300                                                                  05830000
058400 PROGRAM-EXIT.                                                    05840000
058500     GOBACK.                                                      05850000
058600                                                                  05860000
058700*---------------------------------------------------------------* 05870000
058800*    PROGRAM INITIALIZATION                                     * 05880000
058900*                                                               * 05890000
059000*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 05900000
059100*       THE REPORT HEADINGS.                                    * 05910000
059200*---------------------------------------------------------------* 05920000
059300 1000-INITIALIZE.                                                 05930000
059400                                                                  05940000
059500     ACCEPT RUN-CONTROL-RECORD FROM SYSIN.                        05950000
059600                                                                  05960000
059700     DISPLAY '--------------------------------------'.            05970000
059800     DISPLAY '-        PROGRAM - RCKRP078          -'.            05980000
059900     DISPLAY '--------------------------------------'.            05990000
060000     DISPLAY '                                      '.            06000000
060100                                                                  06010000
060200     DISPLAY 'CONTROL CARD SET-UP IS : ' RUN-CONTROL-RECORD.      06020000
060300                                                                  06030000
060400     ACCEPT PV-CURRENT-DATE FROM DATE.                            06040000
060500     ACCEPT PV-CURRENT-TIME FROM TIME.                            06050000
060600                                                                  06060000
060700     MOVE PV-CURRENT-YY       TO  HL1-RUN-YEAR.                   06070000
060800     MOVE PV-CURRENT-MM       TO  HL1-RUN-MONTH.                  06080000
060900     MOVE PV-CURRENT-DD       TO  HL1-RUN-DAY.                    06090000
061000     MOVE PV-CURRENT-HOUR     TO  HL1-RUN-HOUR.                   06100000
061100     MOVE PV-CURRENT-MINUTE   TO  HL1-RUN-MINUTE.                 06110000
061200     MOVE PC-CURRENT-PROGRAM  TO  HL1-PROGRAM-NAME.               06120000
061300                                                                  06130000
061400     MOVE SPACES TO DL1-DETAIL-LINE-1.                            06140000
061500                                                                  06150000
061600     PERFORM 7000-READ-DATE.                                      06160000
061700                                                                  06170000
061800     PERFORM 7100-READ-CONTROL-FILE.                              06180000
061900                                                                  06190000
062000     EVALUATE TRUE                                                06200000
062100                                                                  06210000
062200       WHEN CC-YEAR-END                                           06220000
062300           PERFORM 1200-FISCAL-RPT-DTE-RANGE                      06230000
062400           MOVE 'END OF YEAR'         TO  HL2-FISCAL-SEASON       06240000
062500           MOVE SPACES                TO  HL2-MONTH               06250000
062600           MOVE PV-START-EXTRACT-YYYY TO  RC067-DATE-STA-CCYY     06260000
062700           MOVE PV-START-EXTRACT-MM   TO  RC067-DATE-STA-MM       06270000
062800           MOVE PV-START-EXTRACT-DD   TO  RC067-DATE-STA-DD       06280000
062900           MOVE RC067-DATE-START      TO  HL2-MONTH-YEAR-START    06290000
063000           MOVE RC067-DATE-END        TO  HL2-MONTH-YEAR-END      06300000
063100                                                                  06310000
063200       WHEN CC-SEASON-NUMBER                                      06320000
063300           PERFORM 1300-SEASONAL-RPT-DTE-RANGE                    06330000
063400           MOVE CC-EXTRACT-SEASON     TO  HL2-SEASON              06340000
063500           MOVE SPACES                TO  HL2-MONTH               06350000
063600           MOVE PV-START-EXTRACT-YYYY TO  RC067-DATE-STA-CCYY     06360000
063700           MOVE PV-START-EXTRACT-MM   TO  RC067-DATE-STA-MM       06370000
063800           MOVE PV-START-EXTRACT-DD   TO  RC067-DATE-STA-DD       06380000
063900           MOVE RC067-DATE-START      TO  HL2-MONTH-YEAR-START    06390000
064000           MOVE RC067-DATE-END        TO  HL2-MONTH-YEAR-END      06400000
064100                                                                  06410000
064200       WHEN CC-EXTRACT-PERIOD                                     06420000
064300           MOVE SPACES                TO  HL2-FISCAL-SEASON       06430000
064400                                                                  06440000
064500     END-EVALUATE.                                                06450000
064600                                                                  06460000
064700     PERFORM 8000-READ-INPUT-FILE.                                06470000
064800                                                                  06480000
064900     MOVE RC065-BYR-NMBR         TO PV-HOLD-BYR-NMBR.             06490022
065000     MOVE RC065-DMM-NMBR         TO PV-HOLD-DMM-NMBR.             06500022
065100     MOVE RC065-GMM-NMBR         TO PV-HOLD-GMM-NMBR.             06510022
065200     MOVE RC065-VEND-DESC        TO PV-HOLD-VENDOR-DESC.          06520011
065300     MOVE RC065-IMPRT-FCTRY-NAME TO PV-HOLD-IMPRT-VEND.           06530011
065400                                                                  06540000
065500     IF CC-PERIOD-NUMBER                                          06550000
065600         IF RC065-MONTH-END-DATE EQUAL PV-HOLD-DATE-END           06560000
065700             SET PS-PROCESS-CURR-YES TO TRUE                      06570000
065800         ELSE                                                     06580000
065900             SET PS-PROCESS-CURR-NO  TO TRUE                      06590000
066000         END-IF                                                   06600000
066100     ELSE                                                         06610000
066200         SET PS-PROCESS-CURR-YES TO TRUE                          06620000
066300     END-IF.                                                      06630000
066400                                                                  06640000
066500     INITIALIZE PV-DETAIL-TOTALS                                  06650000
066600                PV-DETAIL-ACCUM                                   06660023
066700                PV-FINAL-TOTALS                                   06670000
066800                PV-BREAK-TOTALS.                                  06680000
066900                                                                  06690000
067000     PERFORM 1100-CHECK-CC-PARAMETERS.                            06700000
067100                                                                  06710000
067200     PERFORM 4100-PRINT-RPT-HEADING.                              06720000
067300                                                                  06730000
067400     DISPLAY ' '.                                                 06740004
067500                                                                  06750004
067600*----------------------------------------------------------------*06760000
067700*    CHECK THAT A VALID CONTROL RUN HAS BEEN REQUESTED.          *06770000
067800*----------------------------------------------------------------*06780000
067900 1100-CHECK-CC-PARAMETERS.                                        06790000
068000                                                                  06800000
068100     IF CC-GMM-NBR    OR                                          06810000
068200        CC-DMM-NBR    OR                                          06820000
068300        CC-COMPANY    OR                                          06830000
068400        CC-BYR-NBR    OR                                          06840000
068500        CC-COLBY                                                  06850000
068600         CONTINUE                                                 06860000
068700     ELSE                                                         06870000
068800         MOVE '1100-CHECK-CC-PARAMETERS' TO PV-ABEND-PARAGRAPH    06880000
068900         STRING  'CONTROL PARAMETERS: ' RUN-CONTROL-RECORD        06890000
069000             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            06900000
069100         STRING  'TYPE RUN   "' CC-RUN-CONTROL '" ' ' IS INVALID' 06910000
069200             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            06920000
069300         MOVE 'RUN ABORTED' TO PV-ABEND-DISPLAY-3                 06930000
069400         PERFORM 9000-ABEND-ROUTINE                               06940000
069500     END-IF.                                                      06950000
069600                                                                  06960000
069700     PERFORM 3500-SET-REPORT-TYPE.                                06970000
069800                                                                  06980000
069900*----------------------------------------------------------------*06990000
070000*    GET START/END DATES OF THE FISCAL PERIOD.                   *07000000
070100*----------------------------------------------------------------*07010000
070200 1200-FISCAL-RPT-DTE-RANGE.                                       07020000
070300     MOVE '1200-FISCAL-RPT-DTE-RANGE ' TO PV-ABEND-PARAGRAPH.     07030000
070400                                                                  07040000
070500     INITIALIZE DPG51                                             07050000
070600                DPG52                                             07060000
070700                DPG53                                             07070000
070800                DPG54                                             07080000
070900                DPG55                                             07090000
071000                DPG56.                                            07100000
071100                                                                  07110000
071200     MOVE PV-CURRENT-YY    TO  PV-DATE-AREA-YY.                   07120000
071300     MOVE PV-CURRENT-MM    TO  PV-DATE-AREA-MM.                   07130000
071400     MOVE PV-CURRENT-DD    TO  PV-DATE-AREA-DD.                   07140000
071500     MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT.               07150000
071600     MOVE PC-TWENTY-EIGHT  TO  DPG51-INCR-DECR-DAYS-9.            07160000
071700                                                                  07170000
071800     SET DPG51-FISCAL-454-CALENDAR                                07180000
071900         DPG51-DECREMENT-DATE                                     07190000
072000         DPG52-LK-DTE-GREG-FMT      TO TRUE.                      07200000
072100                                                                  07210000
072200     PERFORM 8100-CALL-DATE-MODULE.                               07220000
072300                                                                  07230000
072400     IF DPG56-FISCAL-PERIOD-NBR = 12                              07240000
072500         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      07250000
072600     ELSE                                                         07260000
072700         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      07270000
072800         INITIALIZE DPG51                                         07280000
072900                    DPG52                                         07290000
073000                    DPG53                                         07300000
073100                    DPG54                                         07310000
073200                    DPG55                                         07320000
073300                    DPG56                                         07330000
073400                                                                  07340000
073500         MOVE PC-ONE        TO DPG51-INCR-DECR-DAYS-9             07350000
073600         MOVE PV-DATE-AREA  TO DPG52-LK-DATE-INPUT                07360000
073700                                                                  07370000
073800         SET DPG51-FISCAL-454-CALENDAR                            07380000
073900             DPG51-DECREMENT-DATE                                 07390000
074000             DPG52-LK-DTE-GREG-FMT    TO TRUE                     07400000
074100                                                                  07410000
074200         PERFORM 8100-CALL-DATE-MODULE                            07420000
074300     END-IF.                                                      07430000
074400                                                                  07440000
074500*----------------------------------------------------------------*07450000
074600*    GET START/END DATES SEASONAL                                *07460000
074700*----------------------------------------------------------------*07470000
074800 1300-SEASONAL-RPT-DTE-RANGE.                                     07480000
074900     MOVE '1300-SEASONAL-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    07490000
075000                                                                  07500000
075100     INITIALIZE DPG51                                             07510000
075200                DPG52                                             07520000
075300                DPG53                                             07530000
075400                DPG54                                             07540000
075500                DPG55                                             07550000
075600                DPG56.                                            07560000
075700                                                                  07570000
075800     MOVE PV-CURRENT-YY    TO  PV-DATE-AREA-YY.                   07580000
075900     MOVE PV-CURRENT-MM    TO  PV-DATE-AREA-MM.                   07590000
076000     MOVE PV-CURRENT-DD    TO  PV-DATE-AREA-DD.                   07600000
076100     MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT.               07610000
076200     MOVE PC-TWENTY-EIGHT  TO  DPG51-INCR-DECR-DAYS-9.            07620000
076300                                                                  07630000
076400     SET DPG51-FISCAL-454-CALENDAR                                07640000
076500         DPG51-DECREMENT-DATE                                     07650000
076600         DPG52-LK-DTE-GREG-FMT   TO TRUE.                         07660000
076700                                                                  07670000
076800     PERFORM 8100-CALL-DATE-MODULE.                               07680000
076900                                                                  07690000
077000     MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO  PV-START-EXTRACT.        07700000
077100                                                                  07710000
077200     IF DPG56-FISCAL-PERIOD-NBR = 12                              07720000
077300         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO PV-END-EXTRACT        07730000
077400     END-IF.                                                      07740000
077500                                                                  07750000
077600     IF DPG56-FISCAL-PERIOD-NBR > 7                               07760000
077700         MOVE DPG56-FIRST-FD-DB2-ISO-FMT-YR TO  PV-YEAR-FORMAT    07770000
077800         MOVE PV-YEAR-FORMAT-YY             TO  PV-DATE-AREA-YY   07780000
077900         MOVE 01  TO  PV-DATE-AREA-MM                             07790000
078000                      PV-DATE-AREA-DD                             07800000
078100         INITIALIZE DPG51                                         07810000
078200                    DPG52                                         07820000
078300                    DPG53                                         07830000
078400                    DPG54                                         07840000
078500                    DPG55                                         07850000
078600                    DPG56                                         07860000
078700                                                                  07870000
078800         MOVE PV-DATE-AREA   TO  DPG52-LK-DATE-INPUT              07880000
078900         MOVE 220            TO  DPG51-INCR-DECR-DAYS-9           07890000
079000                                                                  07900000
079100         SET DPG51-FISCAL-454-CALENDAR                            07910000
079200             DPG51-INCREMENT-DATE                                 07920000
079300             DPG52-LK-DTE-GREG-FMT  TO TRUE                       07930000
079400                                                                  07940000
079500         PERFORM 8100-CALL-DATE-MODULE                            07950000
079600                                                                  07960000
079700         MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-START-EXTRACT      07970000
079800     END-IF.                                                      07980000
079900                                                                  07990000
080000*----------------------------------------------------------------*08000000
080100*    MAIN LINE PROCESSING.  DETERMINE IF INPUT TRANSACTION IS    *08010000
080200*    A YTD ENTRY (BASED ON CURRENT OR PAST DATE) AND ACCUMULATE  *08020000
080300*    YTD ACCURACY DATA FOR YTD SHIPMENT ACCURACY.                *08030000
080400*                                                                *08040000
080500*    IF NOT YTD, PROCESS AS NORMAL SUMMARIZED INPUT TRANS-       *08050000
080600*    ACTION AND WRITE TO REPORT.                                 *08060000
080700*----------------------------------------------------------------*08070000
080800 2000-MAIN-PROCESS.                                               08080000
080900***  DISPLAY '2000-MAIN-PROCESS'.                                 08090013
081000                                                                  08100000
081100     PERFORM 2100-CHECK-FOR-PRINT-BREAK.                          08110000
081200                                                                  08120000
081300     EVALUATE TRUE                                                08130000
081400        WHEN CC-BYR-NBR                                           08140000
081500        WHEN CC-DMM-NBR                                           08150000
081600        WHEN CC-GMM-NBR                                           08160000
081700            PERFORM 2200-PROCESS-BYR-DMM-GMM                      08170000
081800                                                                  08180000
081900        WHEN CC-COLBY                                             08190000
082000        WHEN CC-COMPANY                                           08200000
082100            PERFORM 2300-PROCESS-COLBY-TRANS                      08210000
082200                                                                  08220000
082300     END-EVALUATE.                                                08230000
082400                                                                  08240000
082500     IF PS-PROCESS-CURR-YES                                       08250000
082600       AND PS-PRINT-HEADINGS-YES                                  08260000
082700         SET PS-PRINT-HEADINGS-NO TO TRUE                         08270000
082800         PERFORM 4100-PRINT-RPT-HEADING                           08280000
082900     END-IF.                                                      08290000
083000                                                                  08300000
083100     PERFORM 8000-READ-INPUT-FILE.                                08310000
083200                                                                  08320000
083300*----------------------------------------------------------------*08330000
083400*    DETERMINE IF IT'S TIME FOR A PRINT CONTROL BREAK            *08340000
083500*----------------------------------------------------------------*08350000
083600 2100-CHECK-FOR-PRINT-BREAK.                                      08360000
083700***  DISPLAY ' 2100-CHECK-FOR-PRINT-BREAK'.                       08370024
083800                                                                  08380000
083900     EVALUATE TRUE                                                08390000
084000       WHEN CC-GMM-NBR                                            08400000
084100           IF RC065-GMM-NMBR NOT EQUAL PV-HOLD-GMM-NMBR           08410022
084200               SET PS-LINE-PRINTED-YES TO TRUE                    08420000
084300               SET PS-PRINT-HEADINGS-YES TO TRUE                  08430000
084400               PERFORM 3100-PRINT-DETAIL-LINE                     08440000
084500               PERFORM 4200-PRINT-BREAK-TOTALS                    08450000
084600               PERFORM 3500-SET-REPORT-TYPE                       08460000
084700               MOVE RC065-GMM-NMBR TO PV-HOLD-GMM-NMBR            08470022
084800               IF CC-SEASON-NUMBER                                08480023
084900                   INITIALIZE PV-DETAIL-ACCUM                     08490023
085000               END-IF                                             08500023
085100           END-IF                                                 08510000
085200                                                                  08520000
085300       WHEN CC-DMM-NBR                                            08530000
085400           IF RC065-DMM-NMBR NOT EQUAL PV-HOLD-DMM-NMBR           08540022
085500               SET PS-LINE-PRINTED-YES TO TRUE                    08550000
085600               SET PS-PRINT-HEADINGS-YES TO TRUE                  08560000
085700               PERFORM 3100-PRINT-DETAIL-LINE                     08570000
085800               PERFORM 4200-PRINT-BREAK-TOTALS                    08580000
085900               PERFORM 3500-SET-REPORT-TYPE                       08590000
086000               MOVE RC065-DMM-NMBR TO PV-HOLD-DMM-NMBR            08600022
086100               IF CC-SEASON-NUMBER                                08610023
086200                   INITIALIZE PV-DETAIL-ACCUM                     08620023
086300               END-IF                                             08630023
086400           END-IF                                                 08640000
086500                                                                  08650000
086600       WHEN CC-BYR-NBR                                            08660000
086700           IF RC065-BYR-NMBR NOT EQUAL PV-HOLD-BYR-NMBR           08670022
086800               SET PS-LINE-PRINTED-YES TO TRUE                    08680000
086900               SET PS-PRINT-HEADINGS-YES TO TRUE                  08690000
087000               PERFORM 3100-PRINT-DETAIL-LINE                     08700000
087100               PERFORM 4200-PRINT-BREAK-TOTALS                    08710000
087200               PERFORM 3500-SET-REPORT-TYPE                       08720000
087300               MOVE RC065-BYR-NMBR TO PV-HOLD-BYR-NMBR            08730022
087400               IF CC-SEASON-NUMBER                                08740023
087500                   INITIALIZE PV-DETAIL-ACCUM                     08750023
087600               END-IF                                             08760023
087700           END-IF                                                 08770000
087800                                                                  08780000
087900     END-EVALUATE.                                                08790000
088000                                                                  08800000
088100                                                                  08810023
088200*----------------------------------------------------------------*08820000
088300*    GMM / DMM / BUYER ALL ACCUM/PRINT ON VENDOR NAME CHANGE.    *08830022
088400*----------------------------------------------------------------*08840000
088500 2200-PROCESS-BYR-DMM-GMM.                                        08850000
088600***  DISPLAY ' 2200-PROCESS-BYR-DMM-GMM'.                         08860024
088700                                                                  08870000
088800     IF RC065-VEND-DESC NOT = PV-HOLD-VENDOR-DESC                 08880022
088900         IF PS-LINE-PRINTED-YES                                   08890011
089000             SET PS-LINE-PRINTED-NO TO TRUE                       08900011
089100         ELSE                                                     08910011
089200             PERFORM 3100-PRINT-DETAIL-LINE                       08920011
089300         END-IF                                                   08930011
089400         MOVE RC065-VEND-DESC TO PV-HOLD-VENDOR-DESC              08940022
089500         PERFORM 3200-ACCUM-YTD-TOTALS                            08950011
089600         PERFORM 2500-CHECK-FOR-RUN-TYPE                          08960011
089700     ELSE                                                         08970011
089800         PERFORM 3200-ACCUM-YTD-TOTALS                            08980011
089900         PERFORM 2500-CHECK-FOR-RUN-TYPE                          08990011
090000     END-IF.                                                      09000000
090100                                                                  09010000
090200*----------------------------------------------------------------*09020000
090300*    COLBY AND COMPANY PROCESSING.                               *09030000
090400*----------------------------------------------------------------*09040000
090500 2300-PROCESS-COLBY-TRANS.                                        09050000
090600***  DISPLAY ' 2300-PROCESS-COLBY-TRANS'.                         09060013
090700                                                                  09070000
090800     IF CC-COLBY                                                  09080011
090900***      DISPLAY '  2300 CC-COLBY = ' RC065-IMPRT-FCTRY-NAME      09090020
091000         IF (RC065-IMPRT-FCTRY-NAME NOT = PV-HOLD-IMPRT-VEND)     09100011
091100             IF PS-LINE-PRINTED-YES                               09110011
091200                 SET PS-LINE-PRINTED-NO TO TRUE                   09120011
091300             ELSE                                                 09130011
091400                 PERFORM 3100-PRINT-DETAIL-LINE                   09140011
091500             END-IF                                               09150011
091600             MOVE RC065-IMPRT-FCTRY-NAME TO PV-HOLD-IMPRT-VEND    09160011
091700             PERFORM 3200-ACCUM-YTD-TOTALS                        09170011
091800             PERFORM 2500-CHECK-FOR-RUN-TYPE                      09180011
091900             IF CC-SEASON-NUMBER                                  09190023
092000                 INITIALIZE PV-DETAIL-ACCUM                       09200023
092100             END-IF                                               09210023
092200         ELSE                                                     09220011
092300             PERFORM 3200-ACCUM-YTD-TOTALS                        09230011
092400             PERFORM 2500-CHECK-FOR-RUN-TYPE                      09240011
092500         END-IF                                                   09250011
092600     ELSE                                                         09260011
092700***      DISPLAY '  CC-COMPANY'                                   09270013
092800         IF RC065-VEND-DESC NOT = PV-HOLD-VENDOR-DESC             09280022
092900             IF PS-LINE-PRINTED-YES                               09290011
093000                 SET PS-LINE-PRINTED-NO TO TRUE                   09300011
093100             ELSE                                                 09310011
093200                 PERFORM 3100-PRINT-DETAIL-LINE                   09320011
093300             END-IF                                               09330011
093400             MOVE RC065-VEND-DESC TO PV-HOLD-VENDOR-DESC          09340022
093500             PERFORM 3200-ACCUM-YTD-TOTALS                        09350011
093600             PERFORM 2500-CHECK-FOR-RUN-TYPE                      09360011
093700         ELSE                                                     09370011
093800             PERFORM 3200-ACCUM-YTD-TOTALS                        09380011
093900             PERFORM 2500-CHECK-FOR-RUN-TYPE                      09390011
094000         END-IF                                                   09400011
094100     END-IF.                                                      09410000
094200                                                                  09420000
094300*----------------------------------------------------------------*09430000
094400*----------------------------------------------------------------*09440000
094500 2500-CHECK-FOR-RUN-TYPE.                                         09450000
094600***  DISPLAY '  2500-CHECK-FOR-RUN-TYPE '                         09460024
094700***          CC-EXTRACT-TYPE ' ' CC-EXTRACT-SEASON                09470024
094800***          ' ' RC065-VRFYD-PERIOD-NBR.                          09480024
094900                                                                  09490000
095000     EVALUATE TRUE                                                09500000
095100*END-OF-YEAR                                                      09510011
095200       WHEN CC-YEAR-END                                           09520000
095300           SET PS-PROCESS-CURR-YES TO TRUE                        09530000
095400           PERFORM 3000-PROCESS-INPUT-DETAILS                     09540000
095500*SPRING SEASON                                                    09550011
095600       WHEN CC-SEASON-NUMBER                                      09560007
095700         AND CC-EXTRACT-SPRING                                    09570007
095800           IF RC065-VRFYD-PERIOD-NBR < PC-PERIOD-07               09580023
095900               SET PS-PROCESS-CURR-YES TO TRUE                    09590023
096000               PERFORM 3600-ACCUM-INPUT-DETAILS                   09600023
096100           END-IF                                                 09610023
096200*FALL SEASON                                                      09620011
096300       WHEN CC-SEASON-NUMBER                                      09630008
096400         AND CC-EXTRACT-FALL                                      09640008
096500           IF RC065-VRFYD-PERIOD-NBR > PC-PERIOD-06               09650023
096600               SET PS-PROCESS-CURR-YES TO TRUE                    09660023
096700               PERFORM 3600-ACCUM-INPUT-DETAILS                   09670023
096800           END-IF                                                 09680023
096900*MONTHLY                                                          09690011
097000       WHEN CC-PERIOD-NUMBER                                      09700000
097100***        DISPLAY '   RC065-MONTH-END-DATE / PV-HOLD-DATE-END = '09710020
097200***                RC065-MONTH-END-DATE ' / ' PV-HOLD-DATE-END    09720021
097300           IF RC065-MONTH-END-DATE = PV-HOLD-DATE-END             09730001
097400               SET PS-PROCESS-CURR-YES TO TRUE                    09740000
097500               PERFORM 3000-PROCESS-INPUT-DETAILS                 09750000
097600           END-IF                                                 09760000
097700                                                                  09770000
097800     END-EVALUATE.                                                09780000
097900                                                                  09790000
098000*----------------------------------------------------------------*09800000
098100*    BUILD A REPORT DETAIL LINE AND ACCUMULATE REPORT BREAK      *09810000
098200*    TOTALS.                                                     *09820000
098300*----------------------------------------------------------------*09830000
098400 3000-PROCESS-INPUT-DETAILS.                                      09840000
098500***  DISPLAY '   **3000-PROCESS-INPUT-DETAILS**'.                 09850020
098600                                                                  09860000
098700     SET PS-VALID-DATA-TO-PRINT-YES TO TRUE.                      09870000
098800                                                                  09880000
098900     MOVE SPACES TO DL1-DETAIL-LINE-1.                            09890000
099000                                                                  09900000
099100     EVALUATE TRUE                                                09910000
099200       WHEN CC-COLBY                                              09920000
099300           IF RC065-IMPRT-FCTRY-NAME NOT = SPACES                 09930000
099400               MOVE RC065-IMPRT-FCTRY-NAME TO DL1-VENDOR-NAME     09940023
099500           ELSE                                                   09950000
099600               IF RC065-IMPRT-VEND-NAME NOT = SPACES              09960000
099700                   MOVE RC065-IMPRT-VEND-NAME TO DL1-VENDOR-NAME  09970000
099800               ELSE                                               09980000
099900                   MOVE RC065-VEND-DESC TO DL1-VENDOR-NAME        09990000
100000               END-IF                                             10000000
100100           END-IF                                                 10010000
100200                                                                  10020000
100300       WHEN OTHER                                                 10030000
100400           MOVE RC065-VEND-DESC TO DL1-VENDOR-NAME                10040023
100500                                                                  10050000
100600     END-EVALUATE.                                                10060000
100700                                                                  10070000
100800     MOVE RC065-PO-COUNT           TO  DL1-PO-COUNT.              10080000
100900     MOVE RC065-CFY-SLSRNK-NBR     TO  DL1-SALES-RANK.            10090000
101000                                                                  10100016
101100     IF RC065-CURR-SPLIT-QTY > +0                                 10110016
101200         COMPUTE PV-ACCURACY ROUNDED = ((1                        10120000
101300                                    - ((RC065-OVERAGE-QTY         10130000
101400                                      + RC065-SHORTAGE-QTY)       10140000
101500                                    /  RC065-CURR-SPLIT-QTY))     10150000
101600                                    *  100)                       10160000
101700         IF PV-ACCURACY > +0                                      10170000
101800             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    10180017
101900             MOVE PV-ACCURACY-999 TO DL1-SHIPMENT-ACCURACY        10190017
102000         ELSE                                                     10200000
102100             MOVE ZEROES          TO DL1-SHIPMENT-ACCURACY        10210017
102200     ELSE                                                         10220000
102300         MOVE ZEROES              TO DL1-SHIPMENT-ACCURACY        10230017
102400     END-IF.                                                      10240000
102500*JPL                                                              10250016
102600***  MOVE RC065-CURR-SPLIT-QTY TO PV-DISPLAY-QTY1                 10260020
102700***  MOVE RC065-OVERAGE-QTY    TO PV-DISPLAY-QTY2                 10270020
102800***  MOVE RC065-SHORTAGE-QTY   TO PV-DISPLAY-QTY3                 10280020
102900***  DISPLAY '     D1 - ORDERED / OVER / SHORT = '                10290020
103000***          PV-DISPLAY-QTY1 ' / '                                10300020
103100***          PV-DISPLAY-QTY2 ' / ' PV-DISPLAY-QTY3                10310020
103200                                                                  10320013
103300     COMPUTE DL1-UNITS-ORD         ROUNDED =                      10330000
103400             RC065-CURR-SPLIT-QTY / 1000.                         10340000
103500     COMPUTE DL1-UNITS-RECV        ROUNDED =                      10350000
103600             RC065-EXPTED-ITM-QTY / 1000.                         10360000
103700     COMPUTE DL1-TOT-OVSH          ROUNDED =                      10370000
103800            (RC065-OVERAGE-QTY    +                               10380000
103900             RC065-SHORTAGE-QTY)  / 1000.                         10390000
104000     COMPUTE DL1-TOT-RETAIL-IMPACT ROUNDED =                      10400000
104100            (RC065-OVERAGE-RETAIL-AMT -                           10410000
104200             RC065-SHORTAGE-RETAIL-AMT) / 1000.                   10420000
104300                                                                  10430000
104400     PERFORM 3300-COMPUTE-OVERAGE-NUMBERS.                        10440000
104500                                                                  10450000
104600     PERFORM 3400-COMPUTE-SHORTAGE-NUMBERS.                       10460000
104700                                                                  10470000
104800     ADD RC065-OVERAGE-QTY          TO  PV-BRK-OVSH               10480000
104900                                        PV-BRK-OVR-QTY.           10490000
105000     ADD RC065-SHORTAGE-QTY         TO  PV-BRK-OVSH               10500000
105100                                        PV-BRK-SHT-QTY.           10510000
105200     ADD RC065-OVERAGE-RETAIL-AMT   TO  PV-BRK-OVR-RETAIL.        10520000
105300     ADD RC065-SHORTAGE-RETAIL-AMT  TO  PV-BRK-SHT-RETAIL.        10530000
105400     ADD RC065-TOT-UNITS-ORD-OVER   TO  PV-BRK-UNITS-OVER.        10540000
105500     ADD RC065-TOT-UNITS-ORD-SHORT  TO  PV-BRK-UNITS-SHORT.       10550000
105600     ADD RC065-EXPTED-ITM-QTY       TO  PV-BRK-EXPTED-ITM-QTY.    10560000
105700     ADD RC065-VERIFY-ITM-QTY       TO  PV-BRK-VERIFY-ITM-QTY.    10570000
105800     ADD RC065-CURR-SPLIT-QTY       TO  PV-BRK-CURR-SPLIT-QTY.    10580000
105900     ADD RC065-PO-COUNT             TO  PV-BRK-PO-COUNT.          10590000
106000                                                                  10600000
106100*----------------------------------------------------------------*10610023
106200* SHIPPING ACCURACY CALCULATION.                                  10620000
106300*    1 - ((THE AMOUNT I AM STILL EXPECTING TO RECEIVE)            10630000
106400*       + ( OVER/SHORT KNOWN ALREADY) / INTENDED ORDER QTY)       10640000
106500*                                                                 10650000
106600*    NOTE: IN THE EVENT OF AN OVER SHIPMENT,                      10660000
106700*          WHERE RCVD IS GREATER THAN ORDERED,                    10670000
106800*          THEN STILL EXPECTING QTY IS ZERO.                      10680000
106900*----------------------------------------------------------------*10690000
107000 3010-ACCUM-SHIP-ACC-FIELDS.                                      10700000
107100***  DISPLAY '   3010-ACCUM-SHIP-ACC-FIELDS'.                     10710020
107200                                                                  10720000
107300*D2=DTL YTD /B1=BRK PERIOD /B2=BRK YTD /T1=TOT PERIOD /T2=TOT YTD 10730000
107400     MOVE RC065-EXPTED-ITM-QTY   TO PV-EXPTED-ITM-QTY.            10740000
107500     ADD PV-EXPTED-ITM-QTY       TO PV-EXPTED-ITM-QTY-D2          10750000
107600                                    PV-EXPTED-ITM-QTY-B2          10760004
107700                                    PV-EXPTED-ITM-QTY-T2.         10770004
107800*JPL                                                              10780006
107900***  MOVE RC065-EXPTED-ITM-QTY   TO PV-DISPLAY-QTY1.              10790020
108000***  MOVE PV-EXPTED-ITM-QTY-D2   TO PV-DISPLAY-QTY2.              10800020
108100***  DISPLAY '     RECEIVED-QTY / ACCUM = '                       10810020
108200***          PV-DISPLAY-QTY1  ' / ' PV-DISPLAY-QTY2.              10820020
108300                                                                  10830006
108400     IF CC-PERIOD-NUMBER                                          10840000
108500       AND RC065-MONTH-END-DATE   = PV-HOLD-DATE-END              10850004
108600         ADD PV-EXPTED-ITM-QTY   TO PV-EXPTED-ITM-QTY-B1          10860000
108700                                    PV-EXPTED-ITM-QTY-T1          10870004
108800     END-IF.                                                      10880000
108900                                                                  10890000
109000     COMPUTE PV-TOTAL-OVER-SHORT  = RC065-OVERAGE-QTY             10900004
109100                                  + RC065-SHORTAGE-QTY.           10910004
109200     ADD PV-TOTAL-OVER-SHORT     TO PV-TOTAL-OVER-SHORT-D2        10920004
109300                                    PV-TOTAL-OVER-SHORT-B2        10930004
109400                                    PV-TOTAL-OVER-SHORT-T2.       10940004
109500*JPL                                                              10950017
109600***  MOVE RC065-CURR-SPLIT-QTY TO PV-DISPLAY-QTY1                 10960020
109700***  MOVE RC065-OVERAGE-QTY    TO PV-DISPLAY-QTY2                 10970020
109800***  MOVE RC065-SHORTAGE-QTY   TO PV-DISPLAY-QTY3                 10980020
109900***  DISPLAY '     ORDERED / OVER / SHORT = '                     10990020
110000***          PV-DISPLAY-QTY1 ' / '                                11000020
110100***          PV-DISPLAY-QTY2 ' / ' PV-DISPLAY-QTY3                11010020
110200                                                                  11020017
110300     IF CC-PERIOD-NUMBER                                          11030000
110400       AND RC065-MONTH-END-DATE   = PV-HOLD-DATE-END              11040004
110500         ADD PV-TOTAL-OVER-SHORT TO PV-TOTAL-OVER-SHORT-B1        11050004
110600                                    PV-TOTAL-OVER-SHORT-T1        11060004
110700     END-IF.                                                      11070000
110800                                                                  11080000
110900     MOVE RC065-CURR-SPLIT-QTY   TO PV-INTENDED-ORD-QTY.          11090004
111000     ADD PV-INTENDED-ORD-QTY     TO PV-INTENDED-ORD-QTY-D2        11100004
111100                                    PV-INTENDED-ORD-QTY-B2        11110004
111200                                    PV-INTENDED-ORD-QTY-T2.       11120004
111300     IF CC-PERIOD-NUMBER                                          11130000
111400       AND RC065-MONTH-END-DATE   = PV-HOLD-DATE-END              11140004
111500         ADD PV-INTENDED-ORD-QTY TO PV-INTENDED-ORD-QTY-B1        11150004
111600                                    PV-INTENDED-ORD-QTY-T1        11160004
111700     END-IF.                                                      11170000
111800                                                                  11180000
111900     MOVE ZEROES TO PV-STILL-EXPECT-QTY.                          11190000
112000     IF RC065-CURR-SPLIT-QTY > RC065-EXPTED-ITM-QTY               11200000
112100         COMPUTE PV-STILL-EXPECT-QTY  = RC065-CURR-SPLIT-QTY      11210000
112200                                      - RC065-EXPTED-ITM-QTY      11220000
112300         ADD PV-STILL-EXPECT-QTY     TO PV-STILL-EXPECT-QTY-D2    11230000
112400                                        PV-STILL-EXPECT-QTY-B2    11240000
112500                                        PV-STILL-EXPECT-QTY-T2    11250000
112600         IF CC-PERIOD-NUMBER                                      11260000
112700           AND RC065-MONTH-END-DATE   = PV-HOLD-DATE-END          11270004
112800             ADD PV-STILL-EXPECT-QTY TO PV-STILL-EXPECT-QTY-B1    11280000
112900                                        PV-STILL-EXPECT-QTY-T1    11290000
113000         END-IF                                                   11300000
113100     END-IF.                                                      11310000
113200*JPL                                                              11320013
113300***  DISPLAY '     VENDOR NAME = ' RC065-VEND-DESC                11330020
113400***          '  DATE - ' RC065-MONTH-END-DATE.                    11340020
113500                                                                  11350000
113600*----------------------------------------------------------------*11360000
113700*    PRINT DETAIL LINE FOR THE LAST VENDOR PROCESSED.            *11370000
113800*----------------------------------------------------------------*11380000
113900 3100-PRINT-DETAIL-LINE.                                          11390000
114000***  DISPLAY '  3100-PRINT-DETAIL-LINE'.                          11400024
114100                                                                  11410000
114200* COMPUTE DETAIL SHIPPING ACCURACY YTD (D2)                       11420000
114300     IF PV-INTENDED-ORD-QTY-D2 > ZEROES                           11430000
114400*JPL                                                              11440015
114500***      MOVE PV-TOTAL-OVER-SHORT-D2 TO PV-DISPLAY-QTY1           11450020
114600***      MOVE PV-INTENDED-ORD-QTY-D2 TO PV-DISPLAY-QTY2           11460020
114700***      DISPLAY '   YTD - OVER-SHORT / INTENDED = '              11470020
114800***              PV-DISPLAY-QTY1 ' / ' PV-DISPLAY-QTY2            11480020
114900                                                                  11490015
115000         COMPUTE PV-ACCURACY ROUNDED = ((1                        11500000
115100                                  - (PV-TOTAL-OVER-SHORT-D2       11510000
115200                                  /  PV-INTENDED-ORD-QTY-D2))     11520000
115300                                  *  100)                         11530000
115400         IF PV-ACCURACY > +0                                      11540000
115500             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    11550017
115600             MOVE PV-ACCURACY-999 TO DL1-YTD-ACCURACY             11560017
115700         ELSE                                                     11570000
115800             MOVE ZEROES      TO DL1-YTD-ACCURACY                 11580000
115900     ELSE                                                         11590000
116000         MOVE ZEROES          TO DL1-YTD-ACCURACY                 11600000
116100     END-IF.                                                      11610000
116200                                                                  11620000
116300     IF (CC-YEAR-END OR CC-SEASON-NUMBER)                         11630023
116400***    AND (PV-REC-COUNT > +1)                                    11640023
116500       AND PS-PROCESS-CURR-YES                                    11650023
116600         PERFORM 4000-PRINT-DETAIL                                11660000
116700     END-IF.                                                      11670000
116800                                                                  11680000
116900     IF CC-PERIOD-NUMBER                                          11690000
117000         IF PS-PROCESS-CURR-YES                                   11700000
117100             PERFORM 4000-PRINT-DETAIL                            11710000
117200         END-IF                                                   11720000
117300     END-IF.                                                      11730000
117400                                                                  11740000
117500     INITIALIZE PV-DETAIL-TOTALS.                                 11750000
117600     SET PS-PROCESS-CURR-NO TO TRUE.                              11760019
117700                                                                  11770000
117800*----------------------------------------------------------------*11780000
117900*    ADD SHIPPING ACCURACY TO YEAR-TO-DATE TOTALS.               *11790000
118000*----------------------------------------------------------------*11800000
118100 3200-ACCUM-YTD-TOTALS.                                           11810000
118200***  DISPLAY '  3200-ACCUM-YTD-TOTALS'.                           11820013
118300                                                                  11830000
118400     PERFORM 3010-ACCUM-SHIP-ACC-FIELDS.                          11840000
118500                                                                  11850000
118600*----------------------------------------------------------------*11860000
118700*    CALCULATE OVERAGE SUMMARY REPORT AMOUNTS                    *11870000
118800*----------------------------------------------------------------*11880000
118900 3300-COMPUTE-OVERAGE-NUMBERS.                                    11890000
119000                                                                  11900000
119100     COMPUTE DL1-UNITS-RECV-OVER ROUNDED =                        11910000
119200                                 RC065-OVERAGE-QTY / 1000.        11920000
119300     COMPUTE DL1-UNITS-ORD-OVER  ROUNDED =                        11930000
119400                                 RC065-TOT-UNITS-ORD-OVER / 1000. 11940000
119500                                                                  11950000
119600     MOVE ZEROES TO PV-PCT-OVER.                                  11960000
119700                                                                  11970000
119800     IF RC065-TOT-UNITS-ORD-OVER NOT = ZEROES                     11980000
119900         COMPUTE PV-PCT-OVER ROUNDED = (RC065-OVERAGE-QTY         11990000
120000                                     / RC065-TOT-UNITS-ORD-OVER)  12000000
120100                                     * 100                        12010000
120200     END-IF.                                                      12020000
120300                                                                  12030000
120400     MOVE PV-PCT-OVER TO DL1-PCT-OVER.                            12040000
120500                                                                  12050000
120600*----------------------------------------------------------------*12060000
120700*    CALCULATE SHORTAGE SUMMARY REPORT AMOUNTS                   *12070000
120800*----------------------------------------------------------------*12080000
120900 3400-COMPUTE-SHORTAGE-NUMBERS.                                   12090000
121000                                                                  12100000
121100     COMPUTE DL1-UNITS-RECV-SHORT ROUNDED =                       12110000
121200             RC065-SHORTAGE-QTY  / 1000.                          12120000
121300     COMPUTE DL1-UNITS-ORD-SHORT  ROUNDED =                       12130000
121400             RC065-TOT-UNITS-ORD-SHORT / 1000.                    12140000
121500                                                                  12150000
121600     MOVE ZEROES TO PV-PCT-SHORT.                                 12160000
121700                                                                  12170000
121800     IF RC065-TOT-UNITS-ORD-SHORT NOT = ZEROES                    12180000
121900         COMPUTE PV-PCT-SHORT ROUNDED = (RC065-SHORTAGE-QTY       12190000
122000                                      / RC065-TOT-UNITS-ORD-SHORT)12200000
122100                                      * 100                       12210000
122200     END-IF.                                                      12220000
122300                                                                  12230000
122400     MOVE PV-PCT-SHORT TO DL1-PCT-SHORT.                          12240000
122500                                                                  12250000
122600*----------------------------------------------------------------*12260000
122700*    BASED ON THE RUN TYPE BEING PROCESSED, SET THE REPORT       *12270000
122800*    HEADINGS TO THE CORRECT NAMES.                              *12280000
122900*----------------------------------------------------------------*12290000
123000 3500-SET-REPORT-TYPE.                                            12300000
123100                                                                  12310000
123200     EVALUATE TRUE                                                12320000
123300       WHEN CC-GMM-NBR                                            12330000
123400           MOVE PC-RPT-NBR-GMM         TO HL1-REPORT-NUMBER       12340000
123500           MOVE PC-RUN-TYPE-GMM        TO HL3-REPORT-TYPE         12350000
123600           MOVE RC065-GMM-NAME         TO HL3-SEQUENCE-TYPE       12360000
123700           MOVE RC065-GMM-NMBR         TO HL3-USER-ID             12370000
123800                                                                  12380000
123900       WHEN CC-DMM-NBR                                            12390000
124000           MOVE PC-RPT-NBR-DMM         TO HL1-REPORT-NUMBER       12400000
124100           MOVE PC-RUN-TYPE-DMM        TO HL3-REPORT-TYPE         12410000
124200           MOVE RC065-DMM-NAME         TO HL3-SEQUENCE-TYPE       12420000
124300           MOVE RC065-DMM-NMBR         TO HL3-USER-ID             12430000
124400                                                                  12440000
124500       WHEN CC-COMPANY                                            12450000
124600           MOVE PC-RPT-COMPANY         TO HL1-REPORT-NUMBER       12460000
124700           MOVE PC-RUN-TYPE-COMPANY    TO HL3-REPORT-TYPE         12470000
124800           MOVE PC-RUN-TYPE-KOHLS      TO HL3-SEQUENCE-TYPE       12480000
124900           MOVE SPACES                 TO HL3-USER-ID             12490000
125000                                                                  12500000
125100       WHEN CC-BYR-NBR                                            12510000
125200           MOVE PC-RPT-NBR-BYR         TO HL1-REPORT-NUMBER       12520000
125300           MOVE PC-RUN-TYPE-BYR        TO HL3-REPORT-TYPE         12530000
125400           MOVE RC065-BYR-NAME         TO HL3-SEQUENCE-TYPE       12540000
125500           MOVE RC065-BYR-NMBR         TO HL3-USER-ID             12550000
125600                                                                  12560000
125700       WHEN CC-COLBY                                              12570000
125800           MOVE PC-RPT-NBR-COLBY       TO HL1-REPORT-NUMBER       12580000
125900           MOVE PC-RUN-TYPE-COLBY      TO HL3-REPORT-TYPE         12590000
126000           MOVE PC-RUN-TYPE-COLBY-INTL TO HL3-SEQUENCE-TYPE       12600000
126100           MOVE SPACES                 TO HL3-USER-ID             12610000
126200                                                                  12620000
126300     END-EVALUATE.                                                12630000
126400                                                                  12640000
126500*----------------------------------------------------------------*12650023
126600* ACCUMULATE DATA FOR PRINT DETAIL LINES FOR SEASONAL REPORTING. *12660023
126700*----------------------------------------------------------------*12670023
126800 3600-ACCUM-INPUT-DETAILS.                                        12680023
126900***  DISPLAY '   **3600-ACCUM-INPUT-DETAILS**'.                   12690024
127000                                                                  12700023
127100     SET PS-VALID-DATA-TO-PRINT-YES TO TRUE.                      12710023
127200                                                                  12720023
127300     MOVE SPACES TO DL1-DETAIL-LINE-1.                            12730023
127400                                                                  12740023
127500     EVALUATE TRUE                                                12750023
127600       WHEN CC-COLBY                                              12760023
127700           IF RC065-IMPRT-FCTRY-NAME NOT = SPACES                 12770023
127800               MOVE RC065-IMPRT-FCTRY-NAME TO DL1-VENDOR-NAME     12780023
127900           ELSE                                                   12790023
128000               IF RC065-IMPRT-VEND-NAME NOT = SPACES              12800023
128100                   MOVE RC065-IMPRT-VEND-NAME TO DL1-VENDOR-NAME  12810023
128200               ELSE                                               12820023
128300                   MOVE RC065-VEND-DESC TO DL1-VENDOR-NAME        12830023
128400               END-IF                                             12840023
128500           END-IF                                                 12850023
128600                                                                  12860023
128700       WHEN OTHER                                                 12870023
128800           MOVE RC065-VEND-DESC TO DL1-VENDOR-NAME                12880023
128900                                                                  12890023
129000     END-EVALUATE.                                                12900023
129100                                                                  12910023
129200     ADD RC065-PO-COUNT            TO PV-ACCUM-PO-COUNT.          12920023
129300     ADD RC065-OVERAGE-QTY         TO PV-ACCUM-OVERAGE-QTY.       12930023
129400     ADD RC065-TOT-UNITS-ORD-OVER  TO PV-ACCUM-TOT-UNITS-OVER.    12940023
129500     ADD RC065-SHORTAGE-QTY        TO PV-ACCUM-SHORTAGE-QTY.      12950023
129600     ADD RC065-TOT-UNITS-ORD-SHORT TO PV-ACCUM-TOT-UNITS-SHORT.   12960023
129700     ADD RC065-CURR-SPLIT-QTY      TO PV-ACCUM-CURR-SPLIT-QTY.    12970023
129800     ADD RC065-EXPTED-ITM-QTY      TO PV-ACCUM-EXPTED-ITM-QTY.    12980023
129900     ADD RC065-OVERAGE-RETAIL-AMT  TO PV-ACCUM-OV-RETAIL-AMT.     12990023
130000     ADD RC065-SHORTAGE-RETAIL-AMT TO PV-ACCUM-SH-RETAIL-AMT.     13000023
130100                                                                  13010023
130200     MOVE PV-ACCUM-PO-COUNT        TO DL1-PO-COUNT.               13020023
130300     MOVE RC065-CFY-SLSRNK-NBR     TO DL1-SALES-RANK.             13030023
130400                                                                  13040023
130500     IF PV-ACCUM-CURR-SPLIT-QTY > +0                              13050023
130600         COMPUTE PV-ACCURACY ROUNDED = ((1                        13060023
130700                                    - ((PV-ACCUM-OVERAGE-QTY      13070023
130800                                      + PV-ACCUM-SHORTAGE-QTY)    13080023
130900                                    / PV-ACCUM-CURR-SPLIT-QTY))   13090023
131000                                    *  100)                       13100023
131100         IF PV-ACCURACY > +0                                      13110023
131200             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    13120023
131300             MOVE PV-ACCURACY-999 TO DL1-SHIPMENT-ACCURACY        13130023
131400         ELSE                                                     13140023
131500             MOVE ZEROES          TO DL1-SHIPMENT-ACCURACY        13150023
131600     ELSE                                                         13160023
131700         MOVE ZEROES              TO DL1-SHIPMENT-ACCURACY        13170023
131800     END-IF.                                                      13180023
131900                                                                  13190023
132000     COMPUTE DL1-UNITS-ORD         ROUNDED =                      13200023
132100             PV-ACCUM-CURR-SPLIT-QTY / 1000.                      13210023
132200     COMPUTE DL1-UNITS-RECV        ROUNDED =                      13220023
132300             PV-ACCUM-EXPTED-ITM-QTY / 1000.                      13230023
132400     COMPUTE DL1-TOT-OVSH          ROUNDED =                      13240023
132500            (PV-ACCUM-OVERAGE-QTY    +                            13250023
132600             PV-ACCUM-SHORTAGE-QTY)  / 1000.                      13260023
132700     COMPUTE DL1-TOT-RETAIL-IMPACT ROUNDED =                      13270023
132800            (PV-ACCUM-OV-RETAIL-AMT -                             13280023
132900             PV-ACCUM-SH-RETAIL-AMT) / 1000.                      13290023
133000                                                                  13300023
133100*CALC OVERAGE NUMBERS (3300-PARAGRAPH).                           13310023
133200     COMPUTE DL1-UNITS-RECV-OVER   ROUNDED =                      13320023
133300             PV-ACCUM-OVERAGE-QTY    / 1000.                      13330023
133400     COMPUTE DL1-UNITS-ORD-OVER    ROUNDED =                      13340023
133500             PV-ACCUM-TOT-UNITS-OVER / 1000.                      13350023
133600     MOVE ZEROES TO PV-PCT-OVER.                                  13360023
133700     IF PV-ACCUM-TOT-UNITS-OVER NOT = ZEROES                      13370023
133800         COMPUTE PV-PCT-OVER ROUNDED = (PV-ACCUM-OVERAGE-QTY      13380023
133900                                     / PV-ACCUM-TOT-UNITS-OVER)   13390023
134000                                     * 100                        13400023
134100     END-IF.                                                      13410023
134200     MOVE PV-PCT-OVER TO DL1-PCT-OVER.                            13420023
134300                                                                  13430023
134400*CALC SHORTAGE NUMBERS (3400-PARAGRAPH).                          13440023
134500     COMPUTE DL1-UNITS-RECV-SHORT ROUNDED =                       13450023
134600             PV-ACCUM-SHORTAGE-QTY / 1000.                        13460023
134700     COMPUTE DL1-UNITS-ORD-SHORT  ROUNDED =                       13470023
134800             PV-ACCUM-TOT-UNITS-SHORT / 1000.                     13480023
134900     MOVE ZEROES TO PV-PCT-SHORT.                                 13490023
135000     IF PV-ACCUM-TOT-UNITS-SHORT NOT = ZEROES                     13500023
135100         COMPUTE PV-PCT-SHORT ROUNDED = (PV-ACCUM-SHORTAGE-QTY    13510023
135200                                      / PV-ACCUM-TOT-UNITS-SHORT) 13520023
135300                                      * 100                       13530023
135400     END-IF.                                                      13540023
135500     MOVE PV-PCT-SHORT TO DL1-PCT-SHORT.                          13550023
135600                                                                  13560023
135700*ACCUMULATE BREAK TOTALS.                                         13570023
135800     ADD RC065-OVERAGE-QTY          TO  PV-BRK-OVSH               13580023
135900                                        PV-BRK-OVR-QTY.           13590023
136000     ADD RC065-SHORTAGE-QTY         TO  PV-BRK-OVSH               13600023
136100                                        PV-BRK-SHT-QTY.           13610023
136200     ADD RC065-OVERAGE-RETAIL-AMT   TO  PV-BRK-OVR-RETAIL.        13620023
136300     ADD RC065-SHORTAGE-RETAIL-AMT  TO  PV-BRK-SHT-RETAIL.        13630023
136400     ADD RC065-TOT-UNITS-ORD-OVER   TO  PV-BRK-UNITS-OVER.        13640023
136500     ADD RC065-TOT-UNITS-ORD-SHORT  TO  PV-BRK-UNITS-SHORT.       13650023
136600     ADD RC065-EXPTED-ITM-QTY       TO  PV-BRK-EXPTED-ITM-QTY.    13660023
136700     ADD RC065-VERIFY-ITM-QTY       TO  PV-BRK-VERIFY-ITM-QTY.    13670023
136800     ADD RC065-CURR-SPLIT-QTY       TO  PV-BRK-CURR-SPLIT-QTY.    13680023
136900     ADD RC065-PO-COUNT             TO  PV-BRK-PO-COUNT.          13690023
137000                                                                  13700023
137100*----------------------------------------------------------------*13710000
137200*    PRINT DETAIL TOTALS                                         *13720000
137300*----------------------------------------------------------------*13730000
137400 4000-PRINT-DETAIL.                                               13740000
137500***  DISPLAY '   4000-PRINT-DETAIL FOR ' DL1-VENDOR-NAME.         13750024
137600                                                                  13760000
137700     IF PV-REC-COUNT = +1                                         13770000
137800         CONTINUE                                                 13780000
137900     ELSE                                                         13790000
138000         IF PS-VALID-DATA-TO-PRINT-YES                            13800000
138100             MOVE PC-PCT-SIGN TO DL1-PCT-1                        13810000
138200                                 DL1-PCT-2                        13820000
138300                                 DL1-PCT-3                        13830000
138400                                 DL1-PCT-4                        13840000
138500                                                                  13850000
138600             IF PV-LINE-COUNT > PC-LINE-LIMIT                     13860000
138700                 PERFORM 4100-PRINT-RPT-HEADING                   13870000
138800             END-IF                                               13880000
138900                                                                  13890000
139000             WRITE REPORT-RECORD FROM DL1-DETAIL-LINE-1           13900000
139100                 AFTER ADVANCING 2 LINES                          13910000
139200                                                                  13920000
139300             ADD 2 TO PV-LINE-COUNT                               13930000
139400             ADD 1 TO PV-VENDOR-COUNT                             13940000
139500         END-IF                                                   13950000
139600     END-IF.                                                      13960000
139700                                                                  13970000
139800*----------------------------------------------------------------*13980000
139900*    PRINT REPORT HEADING LINES.                                 *13990000
140000*----------------------------------------------------------------*14000000
140100 4100-PRINT-RPT-HEADING.                                          14010000
140200***  DISPLAY ' 4100-PRINT-RPT-HEADING'.                           14020013
140300                                                                  14030000
140400     ADD 1                TO PV-PAGE-COUNT.                       14040000
140500     MOVE PV-PAGE-COUNT   TO HL1-PAGE-NUMBER.                     14050000
140600                                                                  14060000
140700     WRITE REPORT-RECORD FROM HL1-HEADING-LINE-1                  14070000
140800         AFTER ADVANCING PAGE.                                    14080000
140900                                                                  14090000
141000     WRITE REPORT-RECORD FROM HL2-HEADING-LINE-2                  14100000
141100         AFTER ADVANCING 1 LINES.                                 14110000
141200                                                                  14120000
141300     WRITE REPORT-RECORD FROM HL2-HEADING-LINE-2B                 14130000
141400         AFTER ADVANCING 1 LINES.                                 14140000
141500                                                                  14150000
141600     WRITE REPORT-RECORD FROM PR-PRINT-DASH-1                     14160000
141700         AFTER ADVANCING 2 LINES.                                 14170000
141800                                                                  14180000
141900     WRITE REPORT-RECORD FROM HL3-HEADING-LINE-3                  14190000
142000         AFTER ADVANCING 1 LINES.                                 14200000
142100                                                                  14210000
142200     WRITE REPORT-RECORD FROM PR-PRINT-DASH-1                     14220000
142300         AFTER ADVANCING 1 LINES.                                 14230000
142400                                                                  14240000
142500     WRITE REPORT-RECORD FROM HL4-HEADING-LINE-4                  14250000
142600         AFTER ADVANCING 1 LINES.                                 14260000
142700                                                                  14270000
142800     WRITE REPORT-RECORD FROM HL5-HEADING-LINE-5                  14280000
142900         AFTER ADVANCING 1 LINES.                                 14290000
143000                                                                  14300000
143100     WRITE REPORT-RECORD FROM HL6-HEADING-LINE-6                  14310000
143200         AFTER ADVANCING 1 LINES.                                 14320000
143300                                                                  14330000
143400     WRITE REPORT-RECORD FROM PR-PRINT-DASH-2                     14340000
143500         AFTER ADVANCING 1 LINES.                                 14350000
143600                                                                  14360000
143700     MOVE 10 TO PV-LINE-COUNT.                                    14370000
143800                                                                  14380000
143900*----------------------------------------------------------------*14390000
144000*    PRINT BREAK TOTALS AFTER PERFORMING LINE CALCULATIONS.      *14400000
144100*----------------------------------------------------------------*14410000
144200 4200-PRINT-BREAK-TOTALS.                                         14420000
144300***  DISPLAY '  4200-PRINT-BREAK-TOTALS'.                         14430013
144400                                                                  14440000
144500     MOVE SPACES TO TL1-TOT-LINE-1.                               14450000
144600                                                                  14460000
144700     IF PV-BRK-UNITS-OVER NOT = ZEROES                            14470000
144800         COMPUTE PV-BRK-PCT-OVER       ROUNDED =                  14480000
144900                (PV-BRK-OVR-QTY      /                            14490000
145000                 PV-BRK-UNITS-OVER)  * 100                        14500000
145100     END-IF.                                                      14510000
145200                                                                  14520000
145300     IF PV-BRK-UNITS-SHORT NOT = ZEROES                           14530000
145400         COMPUTE PV-BRK-PCT-SHORT      ROUNDED =                  14540000
145500                (PV-BRK-SHT-QTY      /                            14550000
145600                 PV-BRK-UNITS-SHORT) * 100                        14560000
145700     END-IF.                                                      14570000
145800                                                                  14580000
145900* COMPUTE BREAK SHIPPING ACCURACY (B1)                            14590000
146000     IF PV-INTENDED-ORD-QTY-B1 > ZEROES                           14600000
146100         COMPUTE PV-ACCURACY ROUNDED = ((1                        14610000
146200                                       - (PV-TOTAL-OVER-SHORT-B1  14620000
146300                                       / PV-INTENDED-ORD-QTY-B1)) 14630000
146400                                       * 100)                     14640000
146500         IF PV-ACCURACY > +0                                      14650000
146600             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    14660017
146700             MOVE PV-ACCURACY-999 TO TL1-SHIPMENT-ACCURACY        14670017
146800         ELSE                                                     14680000
146900             MOVE ZEROES      TO TL1-SHIPMENT-ACCURACY            14690000
147000     ELSE                                                         14700000
147100         MOVE ZEROES          TO TL1-SHIPMENT-ACCURACY            14710000
147200     END-IF.                                                      14720000
147300                                                                  14730000
147400* COMPUTE BREAK SHIPPING ACCURACY YTD (B2)                        14740000
147500     IF PV-INTENDED-ORD-QTY-B2 > ZEROES                           14750000
147600         COMPUTE PV-ACCURACY ROUNDED = ((1                        14760000
147700                                  - (PV-TOTAL-OVER-SHORT-B2       14770000
147800                                  / PV-INTENDED-ORD-QTY-B2))      14780000
147900                                  * 100)                          14790000
148000         IF PV-ACCURACY > +0                                      14800000
148100             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    14810017
148200             MOVE PV-ACCURACY-999 TO TL1-YTD-ACCURACY             14820017
148300         ELSE                                                     14830000
148400             MOVE ZEROES      TO TL1-YTD-ACCURACY                 14840000
148500     ELSE                                                         14850000
148600         MOVE ZEROES          TO TL1-YTD-ACCURACY                 14860000
148700     END-IF.                                                      14870000
148800                                                                  14880000
148900     MOVE PC-TITLE-NAME-1    TO  TL1-TITLE.                       14890000
149000     MOVE HL3-SEQUENCE-TYPE  TO  TL1-VENDOR-NAME.                 14900000
149100     MOVE HL3-USER-ID        TO  TL1-USER-ID.                     14910000
149200     MOVE PV-BRK-PO-COUNT    TO  TL1-PO-COUNT.                    14920000
149300     MOVE PV-BRK-PCT-OVER    TO  TL1-PCT-OVER.                    14930000
149400     MOVE PV-BRK-PCT-SHORT   TO  TL1-PCT-SHORT.                   14940000
149500                                                                  14950000
149600     COMPUTE TL1-TOT-RETAIL-IMPACT ROUNDED =                      14960000
149700            (PV-BRK-OVR-RETAIL -                                  14970000
149800             PV-BRK-SHT-RETAIL)    / 1000.                        14980000
149900     COMPUTE TL1-UNITS-ORD         ROUNDED =                      14990000
150000             PV-BRK-CURR-SPLIT-QTY / 1000.                        15000000
150100     COMPUTE TL1-UNITS-RECV        ROUNDED =                      15010000
150200             PV-BRK-EXPTED-ITM-QTY / 1000.                        15020000
150300     COMPUTE TL1-UNITS-ORD-OVER    ROUNDED =                      15030000
150400             PV-BRK-UNITS-OVER     / 1000.                        15040000
150500     COMPUTE TL1-UNITS-RECV-OVER   ROUNDED =                      15050000
150600             PV-BRK-OVR-QTY        / 1000.                        15060000
150700     COMPUTE TL1-UNITS-ORD-SHORT   ROUNDED =                      15070000
150800             PV-BRK-UNITS-SHORT    / 1000.                        15080000
150900     COMPUTE TL1-UNITS-RECV-SHORT  ROUNDED =                      15090000
151000             PV-BRK-SHT-QTY        / 1000.                        15100000
151100     COMPUTE TL1-TOT-OVSH          ROUNDED =                      15110000
151200             PV-BRK-OVSH           / 1000.                        15120000
151300                                                                  15130000
151400     ADD PV-BRK-EXPTED-ITM-QTY     TO  PV-TOT-EXPTED-ITM-QTY.     15140000
151500     ADD PV-BRK-VERIFY-ITM-QTY     TO  PV-TOT-VERIFY-ITM-QTY.     15150000
151600     ADD PV-BRK-CURR-SPLIT-QTY     TO  PV-TOT-CURR-SPLIT-QTY.     15160000
151700     ADD PV-BRK-OVR-QTY            TO  PV-TOT-OVR-QTY.            15170000
151800     ADD PV-BRK-SHT-QTY            TO  PV-TOT-SHT-QTY.            15180000
151900     ADD PV-BRK-UNITS-OVER         TO  PV-TOT-UNITS-OVER.         15190000
152000     ADD PV-BRK-UNITS-SHORT        TO  PV-TOT-UNITS-SHORT.        15200000
152100     ADD PV-BRK-OVR-RETAIL         TO  PV-TOT-OVR-RETAIL.         15210000
152200     ADD PV-BRK-SHT-RETAIL         TO  PV-TOT-SHT-RETAIL.         15220000
152300     ADD PV-BRK-OVSH               TO  PV-TOT-OVSH.               15230000
152400     ADD PV-BRK-PO-COUNT           TO  PV-TOT-PO-COUNT.           15240000
152500                                                                  15250000
152600     MOVE PC-PCT-SIGN  TO  TL1-PCT-1                              15260000
152700                           TL1-PCT-2                              15270000
152800                           TL1-PCT-3                              15280000
152900                           TL1-PCT-4.                             15290000
153000                                                                  15300000
153100     IF PV-LINE-COUNT > PC-LINE-LIMIT                             15310000
153200         PERFORM 4100-PRINT-RPT-HEADING                           15320000
153300     END-IF.                                                      15330000
153400                                                                  15340000
153500     WRITE REPORT-RECORD FROM PR-PRINT-DASH-3                     15350000
153600         AFTER ADVANCING 2 LINES.                                 15360000
153700                                                                  15370000
153800     WRITE REPORT-RECORD FROM TL1-TOT-LINE-1                      15380000
153900         AFTER ADVANCING 2 LINES.                                 15390000
154000                                                                  15400000
154100     WRITE REPORT-RECORD FROM PR-PRINT-BLANK-LINE                 15410000
154200         AFTER ADVANCING 1 LINES.                                 15420000
154300                                                                  15430000
154400     INITIALIZE PV-BREAK-TOTALS.                                  15440000
154500                                                                  15450000
154600*----------------------------------------------------------------*15460000
154700*    PRINT FINAL TOTALS AFTER PERFORMING LINE CALCULATIONS.      *15470000
154800*----------------------------------------------------------------*15480000
154900 5000-PRINT-FINAL-TOTALS.                                         15490000
155000***  DISPLAY '  5000-PRINT-FINAL-TOTALS'.                         15500013
155100                                                                  15510000
155200     IF PS-PROCESS-CURR-YES                                       15520000
155300         PERFORM 3100-PRINT-DETAIL-LINE                           15530000
155400     END-IF.                                                      15540000
155500                                                                  15550000
155600     IF PV-BRK-PO-COUNT > +0                                      15560000
155700         PERFORM 4200-PRINT-BREAK-TOTALS                          15570000
155800     END-IF.                                                      15580000
155900                                                                  15590000
156000     MOVE SPACES TO TL1-TOT-LINE-1.                               15600000
156100                                                                  15610000
156200* COMPUTE TOTAL SHIPPING ACCURACY (T1)                            15620000
156300     IF PV-INTENDED-ORD-QTY-T1 > ZEROES                           15630000
156400         COMPUTE PV-ACCURACY ROUNDED = ((1                        15640000
156500                                - (PV-TOTAL-OVER-SHORT-T1         15650000
156600                                /  PV-INTENDED-ORD-QTY-T1))       15660000
156700                                *  100)                           15670000
156800         IF PV-ACCURACY > +0                                      15680000
156900             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    15690017
157000             MOVE PV-ACCURACY-999 TO TL1-SHIPMENT-ACCURACY        15700017
157100         ELSE                                                     15710000
157200             MOVE ZEROES      TO TL1-SHIPMENT-ACCURACY            15720000
157300     ELSE                                                         15730000
157400         MOVE ZEROES          TO TL1-SHIPMENT-ACCURACY            15740000
157500     END-IF.                                                      15750000
157600                                                                  15760000
157700* COMPUTE TOTAL SHIPPING ACCURACY YTD (T2)                        15770000
157800     IF PV-INTENDED-ORD-QTY-T2 > ZEROES                           15780000
157900         COMPUTE PV-ACCURACY ROUNDED = ((1                        15790000
158000                                  - (PV-TOTAL-OVER-SHORT-T2       15800000
158100                                  / PV-INTENDED-ORD-QTY-T2))      15810000
158200                                  * 100)                          15820000
158300         IF PV-ACCURACY > +0                                      15830000
158400             COMPUTE PV-ACCURACY-999 ROUNDED = PV-ACCURACY * 1    15840017
158500             MOVE PV-ACCURACY-999 TO TL1-YTD-ACCURACY             15850017
158600         ELSE                                                     15860000
158700             MOVE ZEROES      TO TL1-YTD-ACCURACY                 15870000
158800     ELSE                                                         15880000
158900         MOVE ZEROES          TO TL1-YTD-ACCURACY                 15890000
159000     END-IF.                                                      15900000
159100                                                                  15910000
159200     IF PV-TOT-UNITS-OVER NOT = ZEROES                            15920000
159300         COMPUTE PV-TOT-PCT-OVER ROUNDED = (PV-TOT-OVR-QTY        15930000
159400                                         / PV-TOT-UNITS-OVER)     15940000
159500                                         * 100                    15950000
159600     END-IF.                                                      15960000
159700                                                                  15970000
159800     IF PV-TOT-UNITS-SHORT NOT = ZEROES                           15980000
159900         COMPUTE PV-TOT-PCT-SHORT ROUNDED = (PV-TOT-SHT-QTY       15990000
160000                                          / PV-TOT-UNITS-SHORT)   16000000
160100                                          * 100                   16010000
160200     END-IF.                                                      16020000
160300                                                                  16030000
160400     MOVE PC-TITLE-NAME-2   TO  TL1-TITLE.                        16040000
160500     MOVE SPACES            TO  TL1-VENDOR-NAME.                  16050000
160600     MOVE PV-TOT-PCT-OVER   TO  TL1-PCT-OVER.                     16060000
160700     MOVE PV-TOT-PCT-SHORT  TO  TL1-PCT-SHORT.                    16070000
160800     MOVE PV-TOT-PO-COUNT   TO  TL1-PO-COUNT.                     16080000
160900                                                                  16090000
161000     COMPUTE TL1-TOT-RETAIL-IMPACT ROUNDED =                      16100000
161100            (PV-TOT-OVR-RETAIL     -                              16110000
161200             PV-TOT-SHT-RETAIL)    / 1000.                        16120000
161300     COMPUTE TL1-UNITS-ORD         ROUNDED =                      16130000
161400             PV-TOT-CURR-SPLIT-QTY / 1000.                        16140000
161500     COMPUTE TL1-UNITS-RECV        ROUNDED =                      16150000
161600             PV-TOT-EXPTED-ITM-QTY / 1000.                        16160000
161700     COMPUTE TL1-UNITS-ORD-OVER    ROUNDED =                      16170000
161800             PV-TOT-UNITS-OVER     / 1000.                        16180000
161900     COMPUTE TL1-UNITS-RECV-OVER   ROUNDED =                      16190000
162000             PV-TOT-OVR-QTY        / 1000.                        16200000
162100     COMPUTE TL1-UNITS-ORD-SHORT   ROUNDED =                      16210000
162200             PV-TOT-UNITS-SHORT    / 1000.                        16220000
162300     COMPUTE TL1-UNITS-RECV-SHORT  ROUNDED =                      16230000
162400             PV-TOT-SHT-QTY        / 1000.                        16240000
162500     COMPUTE TL1-TOT-OVSH          ROUNDED =                      16250000
162600             PV-TOT-OVSH           / 1000.                        16260000
162700                                                                  16270000
162800     MOVE PC-PCT-SIGN TO TL1-PCT-1                                16280000
162900                         TL1-PCT-2                                16290000
163000                         TL1-PCT-3                                16300000
163100                         TL1-PCT-4.                               16310000
163200                                                                  16320000
163300     IF PV-LINE-COUNT > PC-LINE-LIMIT                             16330000
163400         PERFORM 4100-PRINT-RPT-HEADING                           16340000
163500     END-IF.                                                      16350000
163600                                                                  16360000
163700     WRITE REPORT-RECORD FROM PR-PRINT-DASH-3                     16370000
163800         AFTER ADVANCING 2 LINES.                                 16380000
163900                                                                  16390000
164000     WRITE REPORT-RECORD FROM TL1-TOT-LINE-1                      16400000
164100         AFTER ADVANCING 2 LINES.                                 16410000
164200                                                                  16420000
164300     WRITE REPORT-RECORD FROM PR-PRINT-BLANK-LINE                 16430000
164400         AFTER ADVANCING 1 LINES.                                 16440000
164500                                                                  16450000
164600*---------------------------------------------------------------* 16460000
164700*    PRINT END OF REPORT BANNER                                 * 16470000
164800*---------------------------------------------------------------* 16480000
164900 5100-PRINT-END-OF-REPORT.                                        16490000
165000***  DISPLAY '5100-PRINT-END-OF-REPORT'.                          16500013
165100                                                                  16510000
165200     PERFORM 5000-PRINT-FINAL-TOTALS.                             16520000
165300                                                                  16530000
165400     IF PV-LINE-COUNT > PC-LINE-LIMIT                             16540000
165500         PERFORM 4100-PRINT-RPT-HEADING                           16550000
165600     END-IF.                                                      16560000
165700                                                                  16570000
165800     WRITE REPORT-RECORD FROM PR-PRINT-FINAL                      16580000
165900         AFTER ADVANCING 2 LINES.                                 16590000
166000                                                                  16600000
166100*---------------------------------------------------------------* 16610000
166200*    PRINT "NO DETAIL REPORT" BANNER                            * 16620000
166300*---------------------------------------------------------------* 16630000
166400 6000-NO-REPORT-DETAIL.                                           16640000
166500***  DISPLAY '6000-NO-REPORT-DETAIL'.                             16650013
166600                                                                  16660000
166700     IF PV-LINE-COUNT > PC-LINE-LIMIT                             16670000
166800         PERFORM 4100-PRINT-RPT-HEADING                           16680000
166900     END-IF.                                                      16690000
167000                                                                  16700000
167100     WRITE REPORT-RECORD FROM PR-PRINT-NO-DETAIL                  16710000
167200         AFTER ADVANCING 2 LINES.                                 16720000
167300                                                                  16730000
167400*----------------------------------------------------------------*16740000
167500*----------------------------------------------------------------*16750000
167600 7000-READ-DATE.                                                  16760000
167700     MOVE '7000-READ-DATE  '  TO PV-ABEND-PARAGRAPH.              16770000
167800                                                                  16780000
167900     READ DATE-FILE  INTO  RC067-DATE-RECORD                      16790000
168000       AT END                                                     16800000
168100         MOVE 'EMPTY DATE FILE '  TO PV-ABEND-DISPLAY-1           16810000
168200         PERFORM 9000-ABEND-ROUTINE                               16820000
168300     END-READ.                                                    16830000
168400                                                                  16840000
168500     DISPLAY 'DATE RECORD SET-UP IS  : ' RC067-DATE-RECORD.       16850003
168600                                                                  16860000
168700     MOVE RC067-DATE-START          TO  HL2-MONTH-YEAR-START.     16870000
168800     MOVE RC067-DATE-END            TO  HL2-MONTH-YEAR-END.       16880000
168900     MOVE RC067-DATE-FISCAL-PERIOD  TO  HL2-PERIOD.               16890000
169000     MOVE RC067-DATE-FISCAL-QUARTER TO  HL2-QUARTER.              16900000
169100                                                                  16910000
169200     MOVE RC067-DATE-END-CCYY       TO  PV-HOLD-DATE-CCYY.        16920000
169300     MOVE RC067-DATE-END-MM         TO  PV-HOLD-DATE-MM.          16930000
169400     MOVE RC067-DATE-END-DD         TO  PV-HOLD-DATE-DD.          16940000
169500                                                                  16950000
169600*----------------------------------------------------------------*16960000
169700*----------------------------------------------------------------*16970000
169800 7100-READ-CONTROL-FILE.                                          16980000
169900     MOVE '7100-READ-CONTROL-FILE'  TO PV-ABEND-PARAGRAPH.        16990000
170000                                                                  17000000
170100     READ CONTROL-FILE INTO CC-CONTROL-CARD-PARAMETERS            17010000
170200       AT END                                                     17020000
170300         MOVE 'EMPTY CONTROL FILE ' TO PV-ABEND-DISPLAY-1         17030000
170400         PERFORM 9000-ABEND-ROUTINE                               17040000
170500     END-READ.                                                    17050000
170600                                                                  17060000
170700     DISPLAY 'CONTROL CARD SET-UP IS : '                          17070000
170800             CC-CONTROL-CARD-PARAMETERS.                          17080000
170900     DISPLAY ' '.                                                 17090013
171000                                                                  17100000
171100*----------------------------------------------------------------*17110000
171200*    CHECK THAT A VALID DATE HAS BEEN REQUESTED....              *17120000
171300*    'AR' - ARRIVAL DATE                                         *17130000
171400*    'VE' - VERIFIED DATE                                        *17140000
171500*----------------------------------------------------------------*17150000
171600     IF NOT CC-VALID-DATE                                         17160000
171700         STRING  'CONTROL PARAMETERS: ' CC-CONTROL-CARD-PARAMETERS17170000
171800             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            17180000
171900         STRING  'DATE INDICATOR "' CC-EXTRACT-DATE '" ID INVALID'17190000
172000             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            17200000
172100         MOVE 'RUN ABORTED  ' TO PV-ABEND-DISPLAY-3               17210000
172200         PERFORM 9000-ABEND-ROUTINE                               17220000
172300     END-IF.                                                      17230000
172400                                                                  17240000
172500*----------------------------------------------------------------*17250000
172600*    CHECK THAT A VALID TYPE HAS BEEN REQUESTED......            *17260000
172700*    'P' - PERIOD                                                *17270000
172800*    'Q' - QUARTER                                               *17280000
172900*    'S' - SEASONAL                                              *17290000
173000*    'Y' - YEAR END                                              *17300000
173100*----------------------------------------------------------------*17310000
173200     IF NOT CC-VALID-TYPE                                         17320000
173300         STRING  'CONTROL PARAMETERS: ' CC-CONTROL-CARD-PARAMETERS17330000
173400             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            17340000
173500         STRING  'TYPE INDICATOR "' CC-EXTRACT-TYPE '" IS INVALID'17350000
173600             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            17360000
173700         MOVE 'RUN ABORTED' TO PV-ABEND-DISPLAY-3                 17370000
173800         PERFORM 9000-ABEND-ROUTINE                               17380000
173900     END-IF.                                                      17390000
174000                                                                  17400000
174100     IF NOT CC-EXTRACT-VALID-SEASON                               17410000
174200         STRING  'CONTROL PARAMETERS: ' CC-CONTROL-CARD-PARAMETERS17420000
174300             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-1            17430000
174400         STRING  'TYPE SEASON "' CC-EXTRACT-SEASON '" IS INVALID' 17440000
174500             DELIMITED BY SIZE INTO PV-ABEND-DISPLAY-2            17450000
174600         MOVE 'RUN ABORTED' TO PV-ABEND-DISPLAY-3                 17460000
174700         PERFORM 9000-ABEND-ROUTINE                               17470000
174800     END-IF.                                                      17480000
174900                                                                  17490000
175000*---------------------------------------------------------------* 17500000
175100*    READ INPUT FILE                                            * 17510000
175200*---------------------------------------------------------------* 17520000
175300 8000-READ-INPUT-FILE.                                            17530000
175400                                                                  17540000
175500     READ INPUT-FILE INTO RC065-RCVR-EXTRACT-RECORD               17550000
175600         AT END                                                   17560000
175700             SET PS-INPUT-EOF-YES TO TRUE                         17570000
175800     END-READ.                                                    17580000
175900                                                                  17590000
176000     ADD +1 TO PV-REC-COUNT.                                      17600000
176100*JPL                                                              17610013
176200***  DISPLAY '>8000-READ-INPUT-FILE - ' RC065-VEND-DESC.          17620013
176300                                                                  17630000
176400*----------------------------------------------------------------*17640000
176500*----------------------------------------------------------------*17650000
176600 8100-CALL-DATE-MODULE.                                           17660000
176700                                                                  17670000
176800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                17680000
176900                                             DPG52                17690000
177000                                             DPG53                17700000
177100                                             DPG54                17710000
177200                                             DPG55                17720000
177300                                             DPG56.               17730000
177400                                                                  17740000
177500     EVALUATE TRUE                                                17750000
177600       WHEN DPG54-SEVERE-ERROR                                    17760000
177700           DISPLAY '---------------------------------------------'17770000
177800           DISPLAY 'INPUT DATE IS        ' DPG52-LK-DATE-INPUT    17780000
177900           DISPLAY '---------------------------------------------'17790000
178000           DISPLAY '** ABEND **          '                        17800000
178100           DISPLAY '** PGM = RCKRP078    '                        17810000
178200           DISPLAY '** EXECUTE PARAGRAPH ' PV-ABEND-PARAGRAPH     17820000
178300           DISPLAY '** ABEND PARAGRAPH - 8100-CALL-DATE-MODULE'   17830000
178400           DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE.  '   17840000
178500           DISPLAY '** ERROR MESSAGE   = ' DPG54-ERROR-MESSAGE    17850000
178600           DISPLAY '** DPG51           = ' DPG51                  17860000
178700           DISPLAY '** DPG52           = ' DPG52                  17870000
178800           DISPLAY '** DPG53           = ' DPG53                  17880000
178900           DISPLAY '** DPG54           = ' DPG54                  17890000
179000           DISPLAY '---------------------------------------------'17900000
179100           MOVE +4003 TO PV-ABEND-CODE                            17910000
179200           CALL 'ILBOABN0' USING PV-ABEND-CODE                    17920000
179300                                                                  17930000
179400       WHEN OTHER                                                 17940000
179500           CONTINUE                                               17950000
179600                                                                  17960000
179700     END-EVALUATE.                                                17970000
179800                                                                  17980000
179900*----------------------------------------------------------------*17990000
180000*----------------------------------------------------------------*18000000
180100 9000-ABEND-ROUTINE.                                              18010000
180200                                                                  18020000
180300     DISPLAY '*-----------------------------------------*'        18030000
180400     DISPLAY ' PROGRAM    :  ' PV-ABEND-PROGRAM.                  18040000
180500     DISPLAY ' PARAGRAPH  :  ' PV-ABEND-PARAGRAPH.                18050000
180600     DISPLAY ' ABEND CODE :  ' PV-ABEND-CODE.                     18060000
180700     DISPLAY ' '                                                  18070000
180800     DISPLAY ' ' PV-ABEND-DISPLAY-1                               18080000
180900     DISPLAY ' ' PV-ABEND-DISPLAY-2                               18090000
181000     DISPLAY ' ' PV-ABEND-DISPLAY-3                               18100000
181100     DISPLAY '*-----------------------------------------*'        18110000
181200                                                                  18120000
181300     MOVE +4003  TO PV-ABEND-CODE.                                18130000
181400                                                                  18140000
181500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18150000
181600* ------------------------------------------------------------- * 18160000
