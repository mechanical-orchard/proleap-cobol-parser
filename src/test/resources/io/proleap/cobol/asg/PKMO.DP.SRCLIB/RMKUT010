000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RMKUT010.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           8-5-97.                                  00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM EXTRACTS INFORMATION FROM THE MERCHANDISE   *00120004
001210*  BUSINESS STRUCTURE AND THE LOCATION MAINTENANCE TABLES IN     *00121004
001220*  ORDER TO CREATE DEPARTMENT AND STORE RESPONSIBILITY EXTRACT   *00122004
001230*  FILES.  THESE FILES WILL BE UTILIZED BY INFOPAC IN ORDER TO   *00123004
001231*  PROVIDE A DYNAMIC MEANS FOR DISTRIBUTION OF REPORTS SEPARATED *00123104
001240*  OR DISTRIBUTED BY ASPECTS OF THE MERCHANT OR STORE            *00124004
001250*  RESPONSIBILITY STRUCTURE.  MERCHANT INFORMATION IS ACQUIRED   *00125004
001260*  BY DEPARTMENT FOR BUYERS AND MERCHANDISE ANALYSTS, AND IS     *00126004
001270*  ACQUIRED AT DMA LEVEL FOR DMMS AND GMA LEVEL FOR GMMS (THAT   *00127004
001280*  IS THE LEVEL AT WHICH THOSE RELATIONSHIPS ARE RECORDED IN THE *00128004
001290*  MBS).  EXTRACT RECORDS FOR ALL RESPONSIBILITY LEVELS ARE      *00129004
001291*  GENERATED BY DEPARTMENT.  STORE AND DISTRICT INFORMATION IS   *00129104
001292*  JOINED OFF THE LOCATION MAINTENANCE TABLE TO CREATE A         *00129204
001293*  COMPOSITE RESPONSIBILITY RECORD PER STORE.  DEPARTMENT STORES,*00129304
001294*  DISTRIBUTION CENTERS, CENTRAL STOCK, RETURN-TO-VENDOR         *00129404
001295*  LOCATIONS, ACCOUNTING LOCATIONS, AND HEADQUARTERS ARE ALL     *00129504
001296*  INCLUDED IN THE EXTRACT FILE.  BECAUSE OF THE VARIOUS DATES   *00129604
001297*  THAT WOULD INDICATE ELIBILITY FOR REPORT DISTRIBUTION WITHIN  *00129704
001298*  THE VARIOUS SYSTEMS, EXTRACT RECORDS ARE CREATED FOR ALL      *00129804
001299*  STORES THAT ARE DEFINED, REGARDLESS OF OPEN OR CLOSED STATUS. *00129904
001300******************************************************************00130000
001400                                                                  00140000
001500******************************************************************00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700******************************************************************00170000
001800                                                                  00180000
001900 CONFIGURATION SECTION.                                           00190000
002000                                                                  00200000
002100 SOURCE-COMPUTER.        IBM-3090.                                00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT INFOPAC-MERCHANT-FILE                                 00280000
002900         ASSIGN TO OUT01.                                         00290000
003000                                                                  00300000
003100     SELECT INFOPAC-STORE-FILE                                    00310000
003200         ASSIGN TO OUT02.                                         00320000
003210                                                                  00321015
003220     SELECT INFOPAC-MERCH-DEPT-FILE                               00322015
003230         ASSIGN TO OUT03.                                         00323015
003240                                                                  00324017
003250     SELECT INFOPAC-SUM-XREF-FILE                                 00325017
003260         ASSIGN TO OUT04.                                         00326017
003300                                                                  00330000
003400******************************************************************00340000
003500 DATA DIVISION.                                                   00350000
003600******************************************************************00360000
003700                                                                  00370000
003800 FILE SECTION.                                                    00380000
003900                                                                  00390000
004000 FD  INFOPAC-MERCHANT-FILE                                        00400000
004100     RECORDING MODE IS F                                          00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     BLOCK CONTAINS 0 RECORDS                                     00430000
004400     RECORD CONTAINS 60 CHARACTERS                                00440000
004500     DATA RECORDS IS IM-INFOPAC-MERCHANT-RECORD.                  00450000
004600                                                                  00460000
004700 01  IM-INFOPAC-MERCHANT-RECORD  PIC X(60).                       00470000
004800                                                                  00480000
004900 FD  INFOPAC-STORE-FILE                                           00490000
005000     RECORDING MODE IS F                                          00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     BLOCK CONTAINS 0 RECORDS                                     00520000
005300     RECORD CONTAINS 150 CHARACTERS                               00530000
005400     DATA RECORDS IS IS-INFOPAC-STORE-RECORD.                     00540000
005500                                                                  00550000
005600 01  IS-INFOPAC-STORE-RECORD     PIC X(150).                      00560000
005610                                                                  00561015
005620 FD  INFOPAC-MERCH-DEPT-FILE                                      00562015
005630     RECORDING MODE IS F                                          00563015
005640     LABEL RECORDS ARE STANDARD                                   00564015
005650     BLOCK CONTAINS 0 RECORDS                                     00565015
005660     RECORD CONTAINS 150 CHARACTERS                               00566015
005670     DATA RECORDS IS IM-INFOPAC-MERCH-DEPT-RECORD.                00567015
005680                                                                  00568015
005690 01  IM-INFOPAC-MERCH-DEPT-RECORD                                 00569015
005691                                 PIC X(150).                      00569115
005692                                                                  00569217
005693 FD  INFOPAC-SUM-XREF-FILE                                        00569317
005694     RECORDING MODE IS F                                          00569417
005695     LABEL RECORDS ARE STANDARD                                   00569517
005696     BLOCK CONTAINS 0 RECORDS                                     00569617
005697     RECORD CONTAINS 150 CHARACTERS                               00569722
005698     DATA RECORDS IS IS-INFOPAC-SUM-XREF-RECORD.                  00569817
005699                                                                  00569917
005700 01  IS-INFOPAC-SUM-XREF-RECORD  PIC X(150).                      00570022
005710                                                                  00571017
005800 WORKING-STORAGE SECTION.                                         00580000
005900                                                                  00590000
006000*                                                                 00600000
006100*  INFOPAC MERCHANT FILE LAYOUT                                   00610000
006200*                                                                 00620000
006300                                                                  00630000
006400     COPY RMRD001.                                                00640001
006500                                                                  00650000
006600*                                                                 00660000
006700*  INFOPAC STORE FILE LAYOUT                                      00670000
006800*                                                                 00680000
006900                                                                  00690000
007000     COPY RMRD002.                                                00700001
007010                                                                  00701015
007020*                                                                 00702015
007030*  INFOPAC MERCHANT DEPARTMENT FILE LAYOUT                        00703015
007040*                                                                 00704015
007050                                                                  00705015
007060     COPY RMRD003.                                                00706015
007070                                                                  00707017
007080*                                                                 00708017
007090*  INFOPAC SUMMARY XREF FILE LAYOUT                               00709017
007091*                                                                 00709117
007092                                                                  00709217
007093     COPY RMRD004.                                                00709317
007100                                                                  00710000
007200*                                                                 00720000
007300*  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        00730000
007400*                                                                 00740000
007500                                                                  00750000
007600     COPY DPWS004.                                                00760000
007700                                                                  00770000
007800 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          00780000
007900                                              COMP SYNC.          00790000
008000     88  AC-TABLE-OVERFLOW-4004               VALUE +4004.        00800000
008100     88  AC-DB2-ERROR-4013                    VALUE +4013.        00810000
008200                                                                  00820000
008300 01  PS-PROGRAM-SWITCHES.                                         00830000
008400     05  PS-END-OF-DEPT-RESP-CURSOR-SW                            00840000
008500                                 PIC X(1)     VALUE 'N'.          00850000
008600         88  PS-END-OF-DEPT-RESP-CURSOR       VALUE 'Y'.          00860000
008700                                                                  00870000
008800 01  PC-PROGRAM-CONSTANTS.                                        00880000
008900     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'RMKUT010'.   00890000
009000     05  PC-MAXIMUM-RETRY-COUNT  PIC S9(4)    VALUE +2            00900000
009100                                              COMP SYNC.          00910000
009110     05  PC-NULL-INDICATOR       PIC S9(4)    VALUE -1            00911011
009120                                              COMP SYNC.          00912011
009200     05  PC-20TH-CENTURY-WINDOW  PIC 9(2)     VALUE 80.           00920000
009300     05  PC-MDSE-GMA-LEVEL       PIC X(3)     VALUE 'GMA'.        00930000
009400     05  PC-MDSE-DMA-LEVEL       PIC X(3)     VALUE 'DMA'.        00940000
009500     05  PC-MDSE-DEPARTMENT-LEVEL                                 00950000
009600                                 PIC X(3)     VALUE 'DPT'.        00960000
009700     05  PC-KOHLS-OPERATING-COMPANY                               00970000
009800                                 PIC X(2)     VALUE '03'.         00980000
009900     05  PC-OPERATING-COMPANY-TYPE                                00990000
010000                                 PIC X(2)     VALUE 'OP'.         01000000
010100     05  PC-NEW-CONSTRUCTION-TYPE                                 01010003
010200                                 PIC X(2)     VALUE 'CN'.         01020003
010300     05  PC-DEBIT-ALLOWANCE-TYPE PIC X(2)     VALUE 'DA'.         01030003
010400     05  PC-NON-ALLOC-MKDN-TYPE  PIC X(2)     VALUE 'NA'.         01040003
010500     05  PC-NON-MDSE-DEPT-TYPE   PIC X(2)     VALUE 'ND'.         01050003
010600     05  PC-VENDOR-WHSE-TYPE     PIC X(2)     VALUE 'VN'.         01060002
010700     05  PC-RSPLVL-CDES.                                          01070000
010800         10  PC-RC-GMM           PIC X(3)     VALUE 'GMM'.        01080000
010900         10  PC-RC-DMM           PIC X(3)     VALUE 'DMM'.        01090000
011000         10  PC-RC-BUYER         PIC X(3)     VALUE 'BYR'.        01100000
011100         10  PC-RC-MERCH-ANALYST PIC X(3)     VALUE 'ANL'.        01110000
011200     05  PC-UNKNOWN-GMM-NAME     PIC X(18)    VALUE 'UNKNOWN GMM'.01120000
011300     05  PC-UNKNOWN-DMM-NAME     PIC X(18)    VALUE 'UNKNOWN DMM'.01130000
011310     05  PC-UNKNOWN-USERID       PIC X(8)     VALUE 'TK?'.        01131017
011400     05  PC-SUCCESSFUL-SQLCODE   PIC S9(9)    VALUE ZEROS         01140000
011500                                              COMP SYNC.          01150000
011600     05  PC-END-OF-CURSOR-SQLCODE                                 01160000
011700                                 PIC S9(9)    VALUE +100          01170000
011800                                              COMP SYNC.          01180000
011900     05  PC-ROW-NOT-FOUND-SQLCODE                                 01190000
012000                                 PIC S9(9)    VALUE +100          01200000
012100                                              COMP SYNC.          01210000
012200     05  PC-RESOURCE-NOT-AVAIL-SQLCODE                            01220000
012300                                 PIC S9(9)    VALUE -904          01230000
012400                                              COMP SYNC.          01240000
012500     05  PC-DEADLOCK-W-ROLLBCK-SQLCODE                            01250000
012600                                 PIC S9(9)    VALUE -911          01260000
012700                                              COMP SYNC.          01270000
012800     05  PC-DEADLOCK-WO-ROLLBCK-SQLCODE                           01280000
012900                                 PIC S9(9)    VALUE -913          01290000
013000                                              COMP SYNC.          01300000
013100                                                                  01310000
013200 01  PV-PROGRAM-VARIABLES.                                        01320000
013300     05  PV-RETRY-COUNT          PIC S9(4)    VALUE ZEROS         01330000
013400                                              COMP SYNC.          01340000
013510     05  PV-CURRENT-GMA-NBR      PIC X(2)     VALUE SPACES.       01351007
013600     05  PV-CURRENT-DMA-NBR      PIC X(2)     VALUE SPACES.       01360000
013700     05  PV-CURRENT-DEPT-NBR     PIC X(3)     VALUE SPACES.       01370000
013800     05  PV-BYR-NBR              PIC X(3)     VALUE SPACES.       01380000
013900     05  FILLER                  REDEFINES PV-BYR-NBR.            01390000
014000         10  FILLER              PIC X(1).                        01400000
014100         10  PV-BUYER-NUMBER     PIC X(2).                        01410000
014200     05  PV-GMM-WORKER-NBR       PIC S9(6)    VALUE ZEROS         01420000
014300                                              COMP-3.             01430000
014400     05  PV-GMM-UID-NBR          PIC X(8)     VALUE SPACES.       01440000
014500     05  PV-GMM-LAST-NAME        PIC X(18)    VALUE SPACES.       01450000
014600     05  PV-GMM-FIR-NAME         PIC X(12)    VALUE SPACES.       01460000
014700     05  PV-GMM-MID-INIT-NAME    PIC X(1)     VALUE SPACES.       01470000
014800     05  PV-DMM-WORKER-NBR       PIC S9(6)    VALUE ZEROS         01480000
014900                                              COMP-3.             01490000
015000     05  PV-DMM-UID-NBR          PIC X(8)     VALUE SPACES.       01500000
015100     05  PV-DMM-LAST-NAME        PIC X(18)    VALUE SPACES.       01510000
015200     05  PV-DMM-FIR-NAME         PIC X(12)    VALUE SPACES.       01520000
015300     05  PV-DMM-MID-INIT-NAME    PIC X(1)     VALUE SPACES.       01530000
015400     05  PV-LAST-DB2-ACTION      PIC X(50)    VALUE SPACES.       01540000
015500         88  PV-OPEN-DEPT-RESP-CURSOR         VALUE               01550000
015600             'OPEN THE DEPT CURSOR (TMDSEAR/TRSPBAR/TWORKER)  '.  01560000
015700         88  PV-FETCH-DEPT-RESP-ROW           VALUE               01570000
015800             'FETCH A ROW FROM THE DEPARTMENT CURSOR          '.  01580000
015900         88  PV-SELECT-GMA-RESP-ROW           VALUE               01590000
016000             'SELECT GMA RESP ROW (TMDSEAR/TRSPBAR/TWORKER)   '.  01600000
016100         88  PV-SELECT-DMA-RESP-ROW           VALUE               01610000
016200             'SELECT DMA RESP ROW (TMDSEAR/TRSPBAR/TWORKER)   '.  01620000
016300         88  PV-CLOSE-DEPT-RESP-CURSOR        VALUE               01630000
016400             'CLOSE THE DEPT CURSOR (TMDSEAR/TRSPBAR/TWORKER) '.  01640000
016500         88  PV-OPEN-STORE-CURSOR             VALUE               01650000
016600             'OPEN THE STORE CURSOR (XST_LOC,_LOC_DIST,_DIST) '.  01660012
016700         88  PV-FETCH-STORE-ROW               VALUE               01670000
016800             'FETCH A ROW FROM THE STORE CURSOR               '.  01680000
016900         88  PV-CLOSE-STORE-CURSOR            VALUE               01690000
017000             'CLOSE THE STORE CURSOR (XST_LOC,_LOC_DIST,_DIST)'.  01700012
017100                                                                  01710000
017200 01  CD-CURRENT-DATE.                                             01720000
017300     05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.         01730000
017400     05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.         01740000
017500     05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.         01750000
017600                                                                  01760000
017700 01  PT-PROGRAM-TOTALS.                                           01770000
017800     05  PT-MERCHANT-RCDS-WRITTEN                                 01780000
017900                                 PIC S9(7)    VALUE ZEROS         01790000
018000                                              COMP-3.             01800000
018100     05  PT-STORE-RCDS-WRITTEN   PIC S9(7)    VALUE ZEROS         01810000
018200                                              COMP-3.             01820000
018210     05  PT-MERCH-DEPT-RCDS-WRITTEN                               01821015
018220                                 PIC S9(7)    VALUE ZEROS         01822015
018230                                              COMP-3.             01823015
018240     05  PT-SUM-XREF-RCDS-WRITTEN                                 01824017
018250                                 PIC S9(7)    VALUE ZEROS         01825017
018260                                              COMP-3.             01826017
018300                                                                  01830000
018400 01  IC-ISO-CURRENT-DATE-AREA.                                    01840000
018500     05  IC-ISO-CURRENT-DATE-X.                                   01850000
018600         10  IC-ISO-CURRENT-CENTURY                               01860000
018700                                 PIC 9(2)     VALUE ZERO.         01870000
018800             88  IC-ISO-20TH-CENTURY          VALUE 19.           01880000
018900             88  IC-ISO-21ST-CENTURY          VALUE 20.           01890000
019000         10  IC-ISO-CURRENT-YEAR PIC 9(2)     VALUE ZERO.         01900000
019100         10  FILLER              PIC X(1)     VALUE '-'.          01910000
019200         10  IC-ISO-CURRENT-MONTH                                 01920000
019300                                 PIC 9(2)     VALUE ZERO.         01930000
019400         10  FILLER              PIC X(1)     VALUE '-'.          01940000
019500         10  IC-ISO-CURRENT-DAY  PIC 9(2)     VALUE ZERO.         01950000
019600     05  IC-ISO-CURRENT-DATE     REDEFINES IC-ISO-CURRENT-DATE-X  01960000
019700                                 PIC X(10).                       01970000
019800                                                                  01980000
019900 01  TD-TOTAL-DISPLAY-MESSAGE.                                    01990000
020000     05  TD-TOTAL-ID             PIC X(51)    VALUE SPACES.       02000000
020100         88  TD-MERCHANT-RCDS-WRITTEN-ID      VALUE               02010000
020200             'INFOPAC MERCHANT RECORDS WRITTEN . . . . . . . . '. 02020000
020300         88  TD-STORE-RCDS-WRITTEN-ID         VALUE               02030000
020400             'INFOPAC STORE RECORDS WRITTEN  . . . . . . . . . '. 02040000
020410         88  TD-MERCH-DEPT-RCDS-WRITTEN-ID    VALUE               02041015
020420             'INFOPAC MERCHANT DEPARTMENT RECORDS WRITTEN  . . '. 02042015
020430         88  TD-SUM-XREF-RCDS-WRITTEN-ID      VALUE               02043017
020440             'INFOPAC SUMMARY XREF RECORDS WRITTEN . . . . . . '. 02044017
020500     05  TD-TOTAL-AMOUNT         PIC Z,ZZZ,ZZ9                    02050000
020600                                              VALUE ZEROS.        02060000
020610                                                                  02061011
020620 01  IV-INDICATOR-VARIABLES.                                      02062011
020660     05  IV-MGR-NM               PIC S9(4)    VALUE ZEROS         02066011
020670                                              COMP SYNC.          02067011
020700                                                                  02070000
020800*                                                                 02080000
020900*  SQL AND COBOL DECLARATIONS FOR THE MBS MERCHANDISE AREA        02090000
021000*  TABLE (TMDSEAR)                                                02100000
021100*                                                                 02110000
021200                                                                  02120000
021300     EXEC SQL                                                     02130000
021400         INCLUDE TMDSEAR                                          02140000
021500     END-EXEC.                                                    02150000
021600                                                                  02160000
021700*                                                                 02170000
021800*  SQL AND COBOL DECLARATIONS FOR THE MBS RESPONSIBILITY AREA     02180000
021900*  TABLE (TRSPBAR)                                                02190000
022000*                                                                 02200000
022100                                                                  02210000
022200     EXEC SQL                                                     02220000
022300         INCLUDE TRSPBAR                                          02230000
022400     END-EXEC.                                                    02240000
022500                                                                  02250000
022600*                                                                 02260000
022700*  SQL AND COBOL DECLARATIONS FOR THE MBS WORKER TABLE (TWORKER)  02270000
022800*                                                                 02280000
022900                                                                  02290000
023000     EXEC SQL                                                     02300000
023100         INCLUDE TWORKER                                          02310000
023200     END-EXEC.                                                    02320000
023300                                                                  02330000
023400*                                                                 02340000
023500*  SQL AND COBOL DECLARATIONS FOR THE XS DOMAIN LOCATION TABLE    02350005
023600*  (XST_LOC).                                                     02360005
023610*                                                                 02361005
023700                                                                  02370000
023800     EXEC SQL                                                     02380000
023900         INCLUDE XST00001                                         02390005
024000     END-EXEC.                                                    02400000
024100                                                                  02410000
024200*                                                                 02420000
024300*  SQL AND COBOL DECLARATIONS FOR THE XS DOMAIN LOCATION-DISTRICT 02430005
024400*  ASSOCIATION TABLE (XST_LOC_DIST).                              02440005
024410*                                                                 02441005
024500                                                                  02450000
024600     EXEC SQL                                                     02460000
024700         INCLUDE XST00002                                         02470005
024800     END-EXEC.                                                    02480000
024810                                                                  02481005
024820*                                                                 02482005
024830*  SQL AND COBOL DECLARATIONS FOR THE XS DOMAIN DISTRICT TABLE    02483005
024840*  (XST_DIST).                                                    02484005
024850*                                                                 02485005
024860                                                                  02486005
024870     EXEC SQL                                                     02487005
024880         INCLUDE XST00003                                         02488005
024890     END-EXEC.                                                    02489005
024900                                                                  02490000
025000*                                                                 02500000
025100*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                02510000
025200*                                                                 02520000
025300                                                                  02530000
025400     EXEC SQL                                                     02540000
025500         INCLUDE SQLCA                                            02550000
025600     END-EXEC.                                                    02560000
025700                                                                  02570000
025800*                                                                 02580000
025900*  CURSOR USED TO RETRIEVE ALL ACTIVE MERCHANDISE DEPARTMENTS,    02590000
026000*  AND ALL ASSOCIATES CURRENTLY RESPONSIBLE FOR THOSE AREAS.      02600000
026100*                                                                 02610000
026200                                                                  02620000
026300     EXEC SQL                                                     02630000
026400         DECLARE DEPT_RESP_CURSOR CURSOR FOR                      02640000
026500              SELECT M.DEPT_NBR,                                  02650000
026600                     M.GMA_NBR,                                   02660000
026700                     M.DMA_NBR,                                   02670000
026800                     M.BYR_NBR,                                   02680000
026900                     R.WORKER_NBR,                                02690000
027000                     R.RSPLVL_CDE,                                02700000
027100                     W.UID_NBR,                                   02710000
027200                     W.LAST_NAME,                                 02720000
027300                     W.FIR_NAME,                                  02730000
027400                     W.MID_INIT_NAME                              02740000
027500                  FROM TMDSEAR M,                                 02750000
027600                       TRSPBAR R,                                 02760000
027700                       TWORKER W                                  02770000
027800                  WHERE ((M.OPERCO_NBR =                          02780000
027900                             :PC-KOHLS-OPERATING-COMPANY)  AND    02790000
028000                        (M.OPERCO_NBR = R.OPERCO_NBR)      AND    02800000
028100                        (M.MDSELV_CDE =                           02810000
028200                             :PC-MDSE-DEPARTMENT-LEVEL)    AND    02820000
028300                        (M.MDSEAR_DKEY = R.MDSEAR_DKEY)    AND    02830000
028400                        (:IC-ISO-CURRENT-DATE  BETWEEN            02840000
028500                             M.STRT_DTE            AND            02850000
028600                             M.END_DTE)                    AND    02860000
028700                        (:IC-ISO-CURRENT-DATE  BETWEEN            02870000
028800                             R.WORKER_STRT_DTE     AND            02880000
028900                             R.WORKER_END_DTE)             AND    02890000
029000                        (R.RSPLVL_CDE IN                          02900000
029100                             (:PC-RC-BUYER,                       02910000
029200                              :PC-RC-MERCH-ANALYST))       AND    02920000
029300                        (R.OPERCO_NBR = W.OPERCO_NBR)      AND    02930000
029400                        (R.WORKER_NBR = W.WORKER_NBR))            02940000
029500                  ORDER BY M.GMA_NBR,                             02950000
029600                           M.DMA_NBR,                             02960000
029700                           M.DEPT_NBR,                            02970000
029800                           R.RSPLVL_CDE,                          02980000
029900                           R.WORKER_NBR                           02990000
030000     END-EXEC.                                                    03000000
030100                                                                  03010000
030200*                                                                 03020000
030300*  CURSOR USED TO RETRIEVE ALL STORES AND THEIR DISTRICT          03030000
030400*  ASSOCIATIONS.                                                  03040000
030500*                                                                 03050000
030600                                                                  03060000
030700     EXEC SQL                                                     03070000
030800         DECLARE STORE_CURSOR CURSOR FOR                          03080000
030900              SELECT L.LOC_NBR,                                   03090005
031000                     L.LOC_TYP_CDE,                               03100006
031100                     L.LOC_NM,                                    03110005
031200                     L.OPN_DTE,                                   03120005
031300                     L.CLO_DTE,                                   03130005
031400                     L.MGR_NM,                                    03140005
031600                     COALESCE (DI.DIST_NBR, 0),                   03160006
031610                     COALESCE (DI.DIST_NM, ' '),                  03161006
031700                     COALESCE (DI.DIST_MGR_NM, ' ')               03170006
031900                  FROM XST_LOC L LEFT JOIN                        03190006
031910                      (SELECT LD.LOC_NBR,                         03191006
031920                              D.DIST_NBR,                         03192006
031930                              D.DIST_NM,                          03193006
031940                              D.DIST_MGR_NM                       03194006
031950                           FROM XST_LOC_DIST LD,                  03195006
031960                                XST_DIST D                        03196006
031970                           WHERE ((LD.DIST_NBR = D.DIST_NBR) AND  03197006
031980                                 (LD.END_DTE IS NULL))) AS DI     03198006
032000                  ON L.LOC_NBR = DI.LOC_NBR                       03200006
032400                  WHERE (L.LOC_TYP_CDE NOT IN                     03240010
032500                             (:PC-OPERATING-COMPANY-TYPE,         03250002
032600                              :PC-NEW-CONSTRUCTION-TYPE,          03260003
032700                              :PC-DEBIT-ALLOWANCE-TYPE,           03270003
032800                              :PC-NON-ALLOC-MKDN-TYPE,            03280002
032900                              :PC-NON-MDSE-DEPT-TYPE,             03290002
033000                              :PC-VENDOR-WHSE-TYPE))              03300006
033100                  ORDER BY L.LOC_NBR                              03310005
033200     END-EXEC.                                                    03320000
033300                                                                  03330000
033400******************************************************************03340000
033500 PROCEDURE DIVISION.                                              03350000
033600******************************************************************03360000
033700                                                                  03370000
033800 0000-MAINLINE.                                                   03380000
033900                                                                  03390000
034000     PERFORM 1000-INITIALIZE.                                     03400000
034100                                                                  03410000
034200     PERFORM 2000-CREATE-MERCHANT-RECORDS.                        03420000
034300                                                                  03430000
034400     PERFORM 3000-CREATE-STORE-RECORDS.                           03440000
034500                                                                  03450000
034600     PERFORM 1500-DISPLAY-PROGRAM-TOTALS.                         03460000
034700                                                                  03470000
034800     PERFORM 9000-EOJ-ROUTINE.                                    03480000
034900                                                                  03490000
035000     GOBACK.                                                      03500000
035100                                                                  03510000
035200******************************************************************03520000
035300*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES.  BUILD    *03530004
035310*  THE CURRENT DATE IN ISO FORMAT.  INITIALIZE ALL I/O AREAS.    *03531004
035400******************************************************************03540000
035500                                                                  03550000
035600 1000-INITIALIZE.                                                 03560000
035700     OPEN OUTPUT INFOPAC-MERCHANT-FILE                            03570000
035800                 INFOPAC-STORE-FILE                               03580015
035810                 INFOPAC-MERCH-DEPT-FILE                          03581017
035820                 INFOPAC-SUM-XREF-FILE.                           03582017
035900                                                                  03590000
036000     ACCEPT CD-CURRENT-DATE FROM DATE.                            03600000
036100     MOVE CD-CURRENT-YEAR TO IC-ISO-CURRENT-YEAR.                 03610000
036200     MOVE CD-CURRENT-MONTH TO IC-ISO-CURRENT-MONTH.               03620000
036300     MOVE CD-CURRENT-DAY TO IC-ISO-CURRENT-DAY.                   03630000
036400     IF IC-ISO-CURRENT-YEAR NOT < PC-20TH-CENTURY-WINDOW          03640000
036500         SET IC-ISO-20TH-CENTURY TO TRUE                          03650000
036600     ELSE                                                         03660000
036700         SET IC-ISO-21ST-CENTURY TO TRUE                          03670000
036800     END-IF.                                                      03680000
036900                                                                  03690000
037000     INITIALIZE RM001-INFOPAC-MERCHANT-RECORD                     03700001
037100                RM002-INFOPAC-STORE-RECORD                        03710015
037110                RM003-INFOPAC-MERCH-DPT-RECORD                    03711017
037120                RM004-INFOPAC-SUM-XREF-RECORD.                    03712017
037200*1000-EXIT.                                                       03720000
037300                                                                  03730000
037400******************************************************************03740000
037500*  DISPLAY SUMMARY TOTALS OF I/O ACTIVITY.                       *03750000
037600******************************************************************03760000
037700                                                                  03770000
037800 1500-DISPLAY-PROGRAM-TOTALS.                                     03780000
037900     SET TD-MERCHANT-RCDS-WRITTEN-ID TO TRUE.                     03790000
038000     MOVE PT-MERCHANT-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.            03800000
038100     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03810000
038200               TD-TOTAL-DISPLAY-MESSAGE.                          03820000
038300                                                                  03830000
038400     SET TD-STORE-RCDS-WRITTEN-ID TO TRUE.                        03840000
038500     MOVE PT-STORE-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.               03850000
038600     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03860000
038700               TD-TOTAL-DISPLAY-MESSAGE.                          03870000
038710                                                                  03871015
038711     SET TD-MERCH-DEPT-RCDS-WRITTEN-ID TO TRUE.                   03871115
038712     MOVE PT-MERCH-DEPT-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.          03871215
038713     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03871315
038714               TD-TOTAL-DISPLAY-MESSAGE.                          03871415
038715                                                                  03871517
038716     SET TD-SUM-XREF-RCDS-WRITTEN-ID TO TRUE.                     03871617
038717     MOVE PT-SUM-XREF-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.            03871717
038718     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03871817
038719               TD-TOTAL-DISPLAY-MESSAGE.                          03871917
038800*1500-EXIT.                                                       03880000
038900                                                                  03890000
039000******************************************************************03900000
039100*  CREATE INFOPAC DEPARTMENT RESPONSIBILITY RECORDS.  OPEN THE   *03910004
039110*  DEPARTMENT RESPONSIBILITY CURSOR, AND FETCH THE FIRST ROW.    *03911004
039120*  PROCESS ALL GMAS WITHIN THE COMPANY.  CLOSE THE DEPARTMENT    *03912004
039121*  RESPONSIBILITY CURSOR.                                        *03912104
039200******************************************************************03920000
039300                                                                  03930000
039400 2000-CREATE-MERCHANT-RECORDS.                                    03940000
039500     INITIALIZE PV-RETRY-COUNT.                                   03950000
039600     PERFORM                                                      03960000
039700             WITH TEST AFTER                                      03970000
039800             UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)             03980000
039900                    OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)) 03990000
040000         EXEC SQL                                                 04000000
040100             OPEN DEPT_RESP_CURSOR                                04010000
040200         END-EXEC                                                 04020000
040300                                                                  04030000
040400         EVALUATE TRUE                                            04040000
040500             WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE         04050000
040600             WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE         04060000
040700             WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE        04070000
040800                 ADD +1 TO PV-RETRY-COUNT                         04080000
040900             WHEN SQLWARN0 NOT = SPACES                           04090000
041000             WHEN SQLCODE < ZERO                                  04100000
041100             WHEN SQLCODE > ZERO                                  04110000
041200                 SET PV-OPEN-DEPT-RESP-CURSOR TO TRUE             04120000
041300                 PERFORM 9100-DB2-ERROR                           04130000
041400         END-EVALUATE                                             04140000
041500     END-PERFORM.                                                 04150000
041600                                                                  04160000
041700     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   04170000
041800         SET PV-OPEN-DEPT-RESP-CURSOR TO TRUE                     04180000
041900         PERFORM 9100-DB2-ERROR                                   04190000
042000     END-IF.                                                      04200000
042100                                                                  04210000
042200     PERFORM 7000-FETCH-DEPT-RESP-ROW.                            04220000
042300                                                                  04230000
042400     PERFORM 2100-PROCESS-GMA                                     04240000
042500         UNTIL PS-END-OF-DEPT-RESP-CURSOR.                        04250000
042600                                                                  04260000
042700     EXEC SQL                                                     04270000
042800         CLOSE DEPT_RESP_CURSOR                                   04280000
042900     END-EXEC.                                                    04290000
043000                                                                  04300000
043100     IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                       04310000
043200         SET PV-CLOSE-DEPT-RESP-CURSOR TO TRUE                    04320000
043300         PERFORM 9100-DB2-ERROR                                   04330000
043400     END-IF.                                                      04340000
043500*2000-EXIT.                                                       04350000
043600                                                                  04360000
043700******************************************************************04370000
043800*  PROCESS A GMA.  DETERMINE THE RESPONSIBLE GMM, AND ACQUIRE    *04380004
043810*  NAME AND ID INFORMATION.  PROCESS ALL SUBORDINATE DMAS.       *04381004
043900******************************************************************04390000
044000                                                                  04400000
044100 2100-PROCESS-GMA.                                                04410000
044200     MOVE MDSEAR-GMA-NBR TO PV-CURRENT-GMA-NBR.                   04420000
044300                                                                  04430000
044400     PERFORM 7100-GET-GMA-RESP.                                   04440000
044500                                                                  04450000
044600     PERFORM 2200-PROCESS-DMA                                     04460000
044700         UNTIL ((PS-END-OF-DEPT-RESP-CURSOR)                      04470000
044800                 OR (MDSEAR-GMA-NBR NOT = PV-CURRENT-GMA-NBR)).   04480000
044900*2100-EXIT.                                                       04490000
045000                                                                  04500000
045100******************************************************************04510000
045200*  PROCESS A DMA.  DETERMINE THE RESPONSIBLE DMM, AND ACQUIRE    *04520004
045210*  NAME AND ID INFORMATION.  PROCESS ALL SUBORDINATE DEPARTMENTS.*04521004
045300******************************************************************04530000
045400                                                                  04540000
045500 2200-PROCESS-DMA.                                                04550000
045600     MOVE MDSEAR-DMA-NBR TO PV-CURRENT-DMA-NBR.                   04560000
045700                                                                  04570000
045800     PERFORM 7200-GET-DMA-RESP.                                   04580000
045900                                                                  04590000
046000     PERFORM 2300-PROCESS-DEPARTMENT                              04600000
046100         UNTIL ((PS-END-OF-DEPT-RESP-CURSOR)                      04610000
046200                 OR (MDSEAR-GMA-NBR NOT = PV-CURRENT-GMA-NBR)     04620000
046300                 OR (MDSEAR-DMA-NBR NOT = PV-CURRENT-DMA-NBR)).   04630000
046400*2200-EXIT.                                                       04640000
046500                                                                  04650000
046600******************************************************************04660000
046700*  PROCESS A DEPARTMENT.  FOR EACH DEPARTMENT-RESPONSIBILITY     *04670004
046710*  CURSOR ROW RETRIEVED, CREATE AN INFOPAC DEPARTMENT            *04671004
046720*  RESPONSIBILITY EXTRACT RECORD, AND FETCH THE NEXT DEPARTMENT- *04672004
046721*  RESPONSIBILITY CURSOR ROW.  FOR THE DEPARTMENT, ALSO CREATE   *04672104
046730*  DEPARTMENT RESPONSIBILITY EXTRACT RECORDS FOR THE RESPONSIBLE *04673004
046740*  DMM AND GMM.                                                  *04674004
046800******************************************************************04680000
046900                                                                  04690000
047000 2300-PROCESS-DEPARTMENT.                                         04700000
047010     INITIALIZE RM003-INFOPAC-MERCH-DPT-RECORD.                   04701016
047100     MOVE MDSEAR-DEPT-NBR TO PV-CURRENT-DEPT-NBR                  04710016
047110                             RM003-DEPT-NBR.                      04711016
047200                                                                  04720000
047300     PERFORM                                                      04730000
047400             UNTIL ((PS-END-OF-DEPT-RESP-CURSOR)                  04740000
047500                 OR (MDSEAR-GMA-NBR NOT = PV-CURRENT-GMA-NBR)     04750000
047600                 OR (MDSEAR-DMA-NBR NOT = PV-CURRENT-DMA-NBR)     04760000
047700                 OR (MDSEAR-DEPT-NBR NOT = PV-CURRENT-DEPT-NBR))  04770000
047800         MOVE MDSEAR-DEPT-NBR TO RM001-DEPT-NBR                   04780001
047900         MOVE RSPBAR-RSPLVL-CDE TO RM001-RSPLVL-CDE               04790001
048000         IF RM001-RC-BUYER                                        04800001
048100             MOVE MDSEAR-BYR-NBR TO PV-BYR-NBR                    04810000
048200             MOVE PV-BUYER-NUMBER TO RM001-PRE-MBS-ID             04820001
048300         ELSE                                                     04830000
048400             INITIALIZE RM001-PRE-MBS-ID                          04840001
048500         END-IF                                                   04850000
048600         MOVE RSPBAR-WORKER-NBR TO RM001-WORKER-NBR               04860001
048700         MOVE WORKER-UID-NBR TO RM001-UID-NBR                     04870001
048800         MOVE WORKER-LAST-NAME TO RM001-LAST-NAME                 04880001
048900         MOVE WORKER-FIR-NAME TO RM001-FIR-NAME                   04890001
049000         MOVE WORKER-MID-INIT-NAME TO RM001-MID-INIT-NAME         04900001
049100                                                                  04910000
049200         PERFORM 8000-WRITE-MERCHANT-RECORD                       04920000
049212                                                                  04921218
049220         IF RM001-RC-BUYER                                        04922016
049222             MOVE MDSEAR-BYR-NBR TO RM003-BUYER-NBR               04922216
049223             MOVE WORKER-UID-NBR TO RM003-BUYER-USERID            04922316
049224             MOVE WORKER-LAST-NAME TO RM003-BUYER-LAST-NAME       04922416
049230         END-IF                                                   04923016
049300                                                                  04930000
049400         PERFORM 7000-FETCH-DEPT-RESP-ROW                         04940000
049500     END-PERFORM                                                  04950000
049600                                                                  04960000
049700     SET RM001-RC-DMM TO TRUE.                                    04970001
049800     MOVE PV-CURRENT-DEPT-NBR TO RM001-DEPT-NBR.                  04980001
049900     MOVE PV-CURRENT-DMA-NBR TO RM001-PRE-MBS-ID                  04990001
050000     MOVE PV-DMM-WORKER-NBR TO RM001-WORKER-NBR.                  05000001
050100     MOVE PV-DMM-UID-NBR TO RM001-UID-NBR.                        05010001
050200     MOVE PV-DMM-LAST-NAME TO RM001-LAST-NAME.                    05020001
050300     MOVE PV-DMM-FIR-NAME TO RM001-FIR-NAME.                      05030001
050400     MOVE PV-DMM-MID-INIT-NAME TO RM001-MID-INIT-NAME.            05040001
050500                                                                  05050000
050600     PERFORM 8000-WRITE-MERCHANT-RECORD.                          05060000
050700                                                                  05070000
050800     SET RM001-RC-GMM TO TRUE.                                    05080001
050900     MOVE PV-CURRENT-DEPT-NBR TO RM001-DEPT-NBR.                  05090001
051000     MOVE PV-CURRENT-GMA-NBR TO RM001-PRE-MBS-ID                  05100001
051100     MOVE PV-GMM-WORKER-NBR TO RM001-WORKER-NBR.                  05110001
051200     MOVE PV-GMM-UID-NBR TO RM001-UID-NBR.                        05120001
051300     MOVE PV-GMM-LAST-NAME TO RM001-LAST-NAME.                    05130001
051400     MOVE PV-GMM-FIR-NAME TO RM001-FIR-NAME.                      05140001
051500     MOVE PV-GMM-MID-INIT-NAME TO RM001-MID-INIT-NAME.            05150001
051600                                                                  05160000
051700     PERFORM 8000-WRITE-MERCHANT-RECORD.                          05170000
051701                                                                  05170116
051702     MOVE PV-DMM-UID-NBR TO RM003-DMM-USERID.                     05170216
051710     MOVE PV-CURRENT-DMA-NBR TO RM003-DMM-NBR.                    05171016
051740     MOVE PV-DMM-LAST-NAME TO RM003-DMM-LAST-NAME.                05174016
051741     MOVE PV-GMM-UID-NBR TO RM003-GMM-USERID.                     05174116
051750     MOVE PV-CURRENT-GMA-NBR TO RM003-GMM-NBR.                    05175016
051770     MOVE PV-GMM-LAST-NAME TO RM003-GMM-LAST-NAME.                05177016
051780                                                                  05178016
051790     PERFORM 8200-WRITE-MERCH-DEPT-RECORD.                        05179016
051791                                                                  05179121
051792     PERFORM 2400-CREATE-SUM-XREF-RECORDS.                        05179221
051800*2300-EXIT.                                                       05180000
051900                                                                  05190000
052000******************************************************************05200000
052100*                                                                *05210018
052200******************************************************************05220000
052300                                                                  05230000
052400 2400-CREATE-SUM-XREF-RECORDS.                                    05240018
052401     IF ((RM003-BUYER-USERID NOT = SPACES)                        05240118
052402             AND (RM003-BUYER-USERID NOT = PC-UNKNOWN-USERID))    05240218
052403         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05240318
052404         SET RM004-XT-DEPT-BYR TO TRUE                            05240418
052405         MOVE RM003-DEPT-NBR TO RM004-XREF-KEY                    05240520
052406         MOVE RM003-BUYER-USERID TO RM004-XREF-USERID             05240618
052409         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05240918
052410     END-IF.                                                      05241018
052411                                                                  05241118
052412     IF ((RM003-DMM-USERID NOT = SPACES)                          05241218
052413             AND (RM003-DMM-USERID NOT = PC-UNKNOWN-USERID))      05241318
052414         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05241418
052415         SET RM004-XT-DEPT-DMM TO TRUE                            05241518
052416         MOVE RM003-DEPT-NBR TO RM004-XREF-KEY                    05241620
052417         MOVE RM003-DMM-USERID TO RM004-XREF-USERID               05241718
052419         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05241918
052420     END-IF.                                                      05242018
052421                                                                  05242118
052422     IF ((RM003-GMM-USERID NOT = SPACES)                          05242218
052423             AND (RM003-GMM-USERID NOT = PC-UNKNOWN-USERID))      05242318
052424         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05242418
052425         SET RM004-XT-DEPT-GMM TO TRUE                            05242518
052426         MOVE RM003-DEPT-NBR TO RM004-XREF-KEY                    05242620
052427         MOVE RM003-GMM-USERID TO RM004-XREF-USERID               05242718
052429         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05242918
052430     END-IF.                                                      05243018
052431                                                                  05243118
052432     IF ((RM003-BUYER-USERID NOT = SPACES)                        05243218
052433             AND (RM003-BUYER-USERID NOT = PC-UNKNOWN-USERID))    05243318
052434         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05243418
052435         SET RM004-XT-BUYER-BYR TO TRUE                           05243518
052436         MOVE RM003-BUYER-NBR TO RM004-XREF-KEY                   05243620
052437         MOVE RM003-BUYER-USERID TO RM004-XREF-USERID             05243718
052439         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05243918
052440     END-IF.                                                      05244018
052441                                                                  05244118
052442     IF ((RM003-BUYER-USERID NOT = SPACES)                        05244218
052443             AND (RM003-BUYER-USERID NOT = PC-UNKNOWN-USERID))    05244318
052444         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05244418
052445         SET RM004-XT-BUYER     TO TRUE                           05244519
052446         MOVE RM003-BUYER-NBR TO RM004-XREF-KEY                   05244620
052447         MOVE RM003-BUYER-USERID TO RM004-XREF-USERID             05244718
052449         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05244918
052450     END-IF.                                                      05245018
052451                                                                  05245119
052452     IF ((RM003-DMM-USERID NOT = SPACES)                          05245219
052453             AND (RM003-DMM-USERID NOT = PC-UNKNOWN-USERID))      05245319
052454         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05245419
052455         SET RM004-XT-BUYER-DMM TO TRUE                           05245519
052456         MOVE RM003-BUYER-NBR TO RM004-XREF-KEY                   05245620
052457         MOVE RM003-DMM-USERID TO RM004-XREF-USERID               05245719
052459         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05245919
052460     END-IF.                                                      05246019
052461                                                                  05246119
052462     IF ((RM003-GMM-USERID NOT = SPACES)                          05246219
052463             AND (RM003-GMM-USERID NOT = PC-UNKNOWN-USERID))      05246319
052464         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05246419
052465         SET RM004-XT-BUYER-GMM TO TRUE                           05246519
052466         MOVE RM003-BUYER-NBR TO RM004-XREF-KEY                   05246620
052467         MOVE RM003-GMM-USERID TO RM004-XREF-USERID               05246719
052469         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05246919
052470     END-IF.                                                      05247019
052471                                                                  05247119
052472     IF ((RM003-BUYER-USERID NOT = SPACES)                        05247219
052473             AND (RM003-BUYER-USERID NOT = PC-UNKNOWN-USERID))    05247319
052474         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05247419
052475         SET RM004-XT-DMM-BYR TO TRUE                             05247519
052476         MOVE RM003-DMM-NBR TO RM004-XREF-KEY                     05247620
052477         MOVE RM003-BUYER-USERID TO RM004-XREF-USERID             05247719
052478         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05247819
052479     END-IF.                                                      05247919
052480                                                                  05248019
052481     IF ((RM003-DMM-USERID NOT = SPACES)                          05248119
052482             AND (RM003-DMM-USERID NOT = PC-UNKNOWN-USERID))      05248219
052483         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05248319
052484         SET RM004-XT-DMM TO TRUE                                 05248419
052485         MOVE RM003-DMM-NBR TO RM004-XREF-KEY                     05248520
052486         MOVE RM003-DMM-USERID TO RM004-XREF-USERID               05248619
052487         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05248719
052488     END-IF.                                                      05248819
052489                                                                  05248919
052490     IF ((RM003-GMM-USERID NOT = SPACES)                          05249019
052491             AND (RM003-GMM-USERID NOT = PC-UNKNOWN-USERID))      05249119
052492         INITIALIZE RM004-INFOPAC-SUM-XREF-RECORD                 05249219
052493         SET RM004-XT-GMM TO TRUE                                 05249319
052494         MOVE RM003-GMM-NBR TO RM004-XREF-KEY                     05249420
052495         MOVE RM003-GMM-USERID TO RM004-XREF-USERID               05249519
052496         PERFORM 8300-WRITE-SUM-XREF-RECORD                       05249619
052497     END-IF.                                                      05249719
052498*2400-EXIT.                                                       05249818
052499                                                                  05249918
052500******************************************************************05250018
052501*  CREATE INFOPAC STORE RESPONSIBILITY RECORDS.  OPEN THE STORE- *05250118
052502*  DISTRICT RESPONSIBILITY CURSOR.  CREATE ONE EXTRACT RECORD    *05250218
052503*  PER ROW RETRIEVED.  CLOSE THE STORE-DISTRICT RESPONSIBILITY   *05250318
052504*  CURSOR.                                                       *05250418
052505******************************************************************05250518
052506                                                                  05250618
052507 3000-CREATE-STORE-RECORDS.                                       05250718
052510     INITIALIZE PV-RETRY-COUNT.                                   05251000
052600     PERFORM                                                      05260000
052700             WITH TEST AFTER                                      05270000
052800             UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)             05280000
052900                    OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)) 05290000
053000         EXEC SQL                                                 05300000
053100             OPEN STORE_CURSOR                                    05310000
053200         END-EXEC                                                 05320000
053300                                                                  05330000
053400         EVALUATE TRUE                                            05340000
053500             WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE         05350000
053600             WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE         05360000
053700             WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE        05370000
053800                 ADD +1 TO PV-RETRY-COUNT                         05380000
053900             WHEN SQLWARN0 NOT = SPACES                           05390000
054000             WHEN SQLCODE < ZERO                                  05400000
054100             WHEN SQLCODE > ZERO                                  05410000
054200                 SET PV-OPEN-STORE-CURSOR TO TRUE                 05420000
054300                 PERFORM 9100-DB2-ERROR                           05430000
054400         END-EVALUATE                                             05440000
054500     END-PERFORM.                                                 05450000
054600                                                                  05460000
054700     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   05470000
054800         SET PV-OPEN-STORE-CURSOR TO TRUE                         05480000
054900         PERFORM 9100-DB2-ERROR                                   05490000
055000     END-IF.                                                      05500000
055100                                                                  05510000
055200     PERFORM 7300-FETCH-STORE-ROW.                                05520000
055300                                                                  05530000
055400     PERFORM 3100-PROCESS-STORE                                   05540000
055500         UNTIL SQLCODE = PC-END-OF-CURSOR-SQLCODE.                05550000
055600                                                                  05560000
055700     EXEC SQL                                                     05570000
055800         CLOSE STORE_CURSOR                                       05580000
055900     END-EXEC.                                                    05590000
056000                                                                  05600000
056100     IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                       05610000
056200         SET PV-CLOSE-STORE-CURSOR TO TRUE                        05620000
056300         PERFORM 9100-DB2-ERROR                                   05630000
056400     END-IF.                                                      05640000
056500*3000-EXIT.                                                       05650000
056600                                                                  05660000
056700******************************************************************05670000
056800*  PROCESS A STORE FROM THE STORE-DISTRICT CURSOR.  CREATE AN    *05680004
056810*  EXTRACT RECORD FOR THE INFOPAC STORE RESPONSIBILITY FILE.     *05681004
056820*  SELECT THE NEXT STORE ROW FROM THE STORE-DISTRICT CURSOR.     *05682004
056900******************************************************************05690000
057000                                                                  05700000
057100 3100-PROCESS-STORE.                                              05710000
057200     MOVE XST00001-LOC-NBR TO RM002-STR-NBR.                      05720008
057300     MOVE XST00001-LOC-TYP-CDE TO RM002-TYPE-CODE.                05730008
057400     MOVE XST00001-LOC-NM TO RM002-STORE-NAME.                    05740008
057500     MOVE XST00001-OPN-DTE TO RM002-OPENED-DATE.                  05750008
057600     MOVE XST00001-CLO-DTE TO RM002-CLOSED-DATE.                  05760008
057700                                                                  05770000
057800     IF ((IV-MGR-NM < ZEROS)                                      05780011
057810             OR (XST00001-MGR-NM = LOW-VALUES))                   05781011
057900         INITIALIZE XST00001-MGR-NM                               05790008
058000     END-IF.                                                      05800000
058100     MOVE XST00001-MGR-NM TO RM002-MGR-NAME.                      05810008
058200                                                                  05820000
058400     IF (XST00003-DIST-NBR = ZEROS)                               05840008
058500         INITIALIZE RM002-DISTRICT-NMBR                           05850012
058710     ELSE                                                         05871012
058720         MOVE XST00003-DIST-NBR TO RM002-DISTRICT-NMBR            05872014
058730     END-IF.                                                      05873012
058800                                                                  05880000
058900     IF XST00003-DIST-NM = LOW-VALUES                             05890008
059000         INITIALIZE XST00003-DIST-NM                              05900008
059100     END-IF.                                                      05910000
059200     MOVE XST00003-DIST-NM TO RM002-DISTRICT-NAME.                05920008
059300                                                                  05930000
059400     IF XST00003-DIST-MGR-NM = LOW-VALUES                         05940008
059500         INITIALIZE XST00003-DIST-MGR-NM                          05950008
059600     END-IF.                                                      05960000
059700     MOVE XST00003-DIST-MGR-NM TO RM002-DISTRICT-MGR-NAME.        05970008
059800                                                                  05980000
060400     PERFORM 8100-WRITE-STORE-RECORD.                             06040000
060500                                                                  06050000
060600     PERFORM 7300-FETCH-STORE-ROW.                                06060000
060700*3100-EXIT.                                                       06070000
060800                                                                  06080000
060900******************************************************************06090000
061000*  FETCH A DEPARTMENT ROW FROM THE CURRENT DEPARTMENT-           *06100000
061100*  RESPONSIBILITY CURSOR.                                        *06110000
061200******************************************************************06120000
061300                                                                  06130000
061400 7000-FETCH-DEPT-RESP-ROW.                                        06140000
061500     EXEC SQL                                                     06150000
061600         FETCH DEPT_RESP_CURSOR                                   06160000
061700             INTO :MDSEAR-DEPT-NBR,                               06170000
061800                  :MDSEAR-GMA-NBR,                                06180000
061900                  :MDSEAR-DMA-NBR,                                06190000
062000                  :MDSEAR-BYR-NBR,                                06200000
062100                  :RSPBAR-WORKER-NBR,                             06210000
062200                  :RSPBAR-RSPLVL-CDE,                             06220000
062300                  :WORKER-UID-NBR,                                06230000
062400                  :WORKER-LAST-NAME,                              06240000
062500                  :WORKER-FIR-NAME,                               06250000
062600                  :WORKER-MID-INIT-NAME                           06260000
062700     END-EXEC.                                                    06270000
062800                                                                  06280000
062900     IF ((SQLCODE < PC-SUCCESSFUL-SQLCODE)                        06290000
063000             OR ((SQLCODE > PC-SUCCESSFUL-SQLCODE)                06300000
063100             AND (SQLCODE NOT = PC-END-OF-CURSOR-SQLCODE))        06310000
063200             OR (SQLWARN0 NOT = SPACES))                          06320000
063300         SET PV-FETCH-DEPT-RESP-ROW TO TRUE                       06330000
063400         PERFORM 9100-DB2-ERROR                                   06340000
063500     ELSE                                                         06350000
063600         IF SQLCODE = PC-END-OF-CURSOR-SQLCODE                    06360000
063700             SET PS-END-OF-DEPT-RESP-CURSOR TO TRUE               06370000
063800         END-IF                                                   06380000
063900     END-IF.                                                      06390000
064000*7000-EXIT.                                                       06400000
064100                                                                  06410000
064200******************************************************************06420000
064300*  FIND THE GMM RESPONSIBLE FOR A GMA.                           *06430004
064400******************************************************************06440000
064500                                                                  06450000
064600 7100-GET-GMA-RESP.                                               06460000
064700     INITIALIZE PV-RETRY-COUNT.                                   06470000
064800     PERFORM 7110-SELECT-GMA-RESP                                 06480000
064900         WITH TEST AFTER                                          06490000
065000         UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)                 06500000
065100                 OR (SQLCODE = PC-ROW-NOT-FOUND-SQLCODE)          06510000
065200                 OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)).   06520000
065300                                                                  06530000
065400     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   06540000
065500         SET PV-SELECT-GMA-RESP-ROW TO TRUE                       06550000
065600         PERFORM 9100-DB2-ERROR                                   06560000
065700     END-IF.                                                      06570000
065800*7100-EXIT.                                                       06580000
065900                                                                  06590000
066000******************************************************************06600000
066110*  SELECT THE GMM INFORMATION FOR THE GMM RESPONSIBLE FOR A GMA. *06611004
066200******************************************************************06620000
066300                                                                  06630000
066400 7110-SELECT-GMA-RESP.                                            06640000
066500     EXEC SQL                                                     06650000
066600         SELECT R.WORKER_NBR,                                     06660000
066700                W.UID_NBR,                                        06670000
066800                W.LAST_NAME,                                      06680000
066900                W.FIR_NAME,                                       06690000
067000                W.MID_INIT_NAME                                   06700000
067100             INTO :PV-GMM-WORKER-NBR,                             06710000
067200                  :PV-GMM-UID-NBR,                                06720000
067300                  :PV-GMM-LAST-NAME,                              06730000
067400                  :PV-GMM-FIR-NAME,                               06740000
067500                  :PV-GMM-MID-INIT-NAME                           06750000
067600             FROM TMDSEAR M,                                      06760000
067700                  TRSPBAR R,                                      06770000
067800                  TWORKER W                                       06780000
067900             WHERE ((M.OPERCO_NBR =                               06790000
068000                             :PC-KOHLS-OPERATING-COMPANY)  AND    06800000
068100                   (M.OPERCO_NBR = R.OPERCO_NBR)           AND    06810000
068200                   (M.GMA_NBR = :MDSEAR-GMA-NBR)           AND    06820000
068300                   (M.MDSELV_CDE = :PC-MDSE-GMA-LEVEL)     AND    06830000
068400                   (M.MDSEAR_DKEY = R.MDSEAR_DKEY)         AND    06840000
068500                   (:IC-ISO-CURRENT-DATE  BETWEEN                 06850000
068600                        M.STRT_DTE            AND                 06860000
068700                        M.END_DTE)                         AND    06870000
068800                   (:IC-ISO-CURRENT-DATE  BETWEEN                 06880000
068900                        R.WORKER_STRT_DTE     AND                 06890000
069000                        R.WORKER_END_DTE)                  AND    06900000
069100                   (R.RSPLVL_CDE = :PC-RC-GMM)             AND    06910000
069200                   (R.OPERCO_NBR = W.OPERCO_NBR)           AND    06920000
069300                   (R.WORKER_NBR = W.WORKER_NBR))                 06930000
069400     END-EXEC.                                                    06940000
069500                                                                  06950000
069600     EVALUATE TRUE                                                06960000
069700         WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE             06970000
069800         WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE             06980000
069900         WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE            06990000
070000             ADD +1 TO PV-RETRY-COUNT                             07000000
070100         WHEN SQLWARN0 NOT = SPACES                               07010000
070200             SET PV-SELECT-GMA-RESP-ROW TO TRUE                   07020000
070300             PERFORM 9100-DB2-ERROR                               07030000
070400         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  07040000
070500             MOVE PC-UNKNOWN-GMM-NAME TO PV-GMM-LAST-NAME         07050000
070600             INITIALIZE PV-GMM-FIR-NAME                           07060000
070700                        PV-GMM-MID-INIT-NAME                      07070000
070800                        PV-GMM-UID-NBR                            07080000
070900                        PV-GMM-WORKER-NBR                         07090000
071000         WHEN SQLCODE = ZERO                                      07100000
071100             CONTINUE                                             07110000
071200         WHEN OTHER                                               07120000
071300             SET PV-SELECT-GMA-RESP-ROW TO TRUE                   07130000
071400             PERFORM 9100-DB2-ERROR                               07140000
071500     END-EVALUATE.                                                07150000
071600*7110-EXIT.                                                       07160000
071700                                                                  07170000
071800******************************************************************07180000
071900*  FIND THE DMM RESPONSIBLE FOR A DMA.                           *07190004
072000******************************************************************07200000
072100                                                                  07210000
072200 7200-GET-DMA-RESP.                                               07220000
072300     INITIALIZE PV-RETRY-COUNT.                                   07230000
072400     PERFORM 7210-SELECT-DMA-RESP                                 07240000
072500         WITH TEST AFTER                                          07250000
072600         UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)                 07260000
072700                 OR (SQLCODE = PC-ROW-NOT-FOUND-SQLCODE)          07270000
072800                 OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)).   07280000
072900                                                                  07290000
073000     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   07300000
073100         SET PV-SELECT-DMA-RESP-ROW TO TRUE                       07310000
073200         PERFORM 9100-DB2-ERROR                                   07320000
073300     END-IF.                                                      07330000
073400*7200-EXIT.                                                       07340000
073500                                                                  07350000
073600******************************************************************07360000
073700*  SELECT THE DMM INFORMATION FOR THE DMM RESPONSIBLE FOR A DMA. *07370004
073800******************************************************************07380000
073900                                                                  07390000
074000 7210-SELECT-DMA-RESP.                                            07400000
074100     EXEC SQL                                                     07410000
074200         SELECT R.WORKER_NBR,                                     07420000
074300                W.UID_NBR,                                        07430000
074400                W.LAST_NAME,                                      07440000
074500                W.FIR_NAME,                                       07450000
074600                W.MID_INIT_NAME                                   07460000
074700             INTO :PV-DMM-WORKER-NBR,                             07470000
074800                  :PV-DMM-UID-NBR,                                07480000
074900                  :PV-DMM-LAST-NAME,                              07490000
075000                  :PV-DMM-FIR-NAME,                               07500000
075100                  :PV-DMM-MID-INIT-NAME                           07510000
075200             FROM TMDSEAR M,                                      07520000
075300                  TRSPBAR R,                                      07530000
075400                  TWORKER W                                       07540000
075500             WHERE ((M.OPERCO_NBR =                               07550000
075600                             :PC-KOHLS-OPERATING-COMPANY)  AND    07560000
075700                   (M.OPERCO_NBR = R.OPERCO_NBR)           AND    07570000
075800                   (M.GMA_NBR = :MDSEAR-GMA-NBR)           AND    07580000
075900                   (M.DMA_NBR = :MDSEAR-DMA-NBR)           AND    07590000
076000                   (M.MDSELV_CDE = :PC-MDSE-DMA-LEVEL)     AND    07600000
076100                   (M.MDSEAR_DKEY = R.MDSEAR_DKEY)         AND    07610000
076200                   (:IC-ISO-CURRENT-DATE  BETWEEN                 07620000
076300                        M.STRT_DTE            AND                 07630000
076400                        M.END_DTE)                         AND    07640000
076500                   (:IC-ISO-CURRENT-DATE  BETWEEN                 07650000
076600                        R.WORKER_STRT_DTE     AND                 07660000
076700                        R.WORKER_END_DTE)                  AND    07670000
076800                   (R.RSPLVL_CDE = :PC-RC-DMM)             AND    07680000
076900                   (R.OPERCO_NBR = W.OPERCO_NBR)           AND    07690000
077000                   (R.WORKER_NBR = W.WORKER_NBR))                 07700000
077100     END-EXEC.                                                    07710000
077200                                                                  07720000
077300     EVALUATE TRUE                                                07730000
077400         WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE             07740000
077500         WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE             07750000
077600         WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE            07760000
077700             ADD +1 TO PV-RETRY-COUNT                             07770000
077800         WHEN SQLWARN0 NOT = SPACES                               07780000
077900             SET PV-SELECT-DMA-RESP-ROW TO TRUE                   07790000
078000             PERFORM 9100-DB2-ERROR                               07800000
078100         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  07810000
078200             MOVE PC-UNKNOWN-DMM-NAME TO PV-DMM-LAST-NAME         07820000
078300             INITIALIZE PV-DMM-FIR-NAME                           07830000
078400                        PV-DMM-MID-INIT-NAME                      07840000
078500                        PV-DMM-UID-NBR                            07850000
078600                        PV-DMM-WORKER-NBR                         07860000
078700         WHEN SQLCODE = ZERO                                      07870000
078800             CONTINUE                                             07880000
078900         WHEN OTHER                                               07890000
079000             SET PV-SELECT-DMA-RESP-ROW TO TRUE                   07900000
079100             PERFORM 9100-DB2-ERROR                               07910000
079200     END-EVALUATE.                                                07920000
079300*7210-EXIT.                                                       07930000
079400                                                                  07940000
079500******************************************************************07950000
079600*  FETCH A STORE ROW FROM THE STORE/DISTRICT CURSOR              *07960000
079700******************************************************************07970000
079800                                                                  07980000
079900 7300-FETCH-STORE-ROW.                                            07990000
080000     EXEC SQL                                                     08000000
080100         FETCH STORE_CURSOR                                       08010000
080200             INTO :XST00001-LOC-NBR,                              08020006
080300                  :XST00001-LOC-TYP-CDE,                          08030009
080400                  :XST00001-LOC-NM,                               08040006
080500                  :XST00001-OPN-DTE,                              08050006
080600                  :XST00001-CLO-DTE,                              08060006
080700                  :XST00001-MGR-NM                                08070011
080710                            :IV-MGR-NM,                           08071011
080800                  :XST00003-DIST-NBR,                             08080006
080900                  :XST00003-DIST-NM,                              08090006
081000                  :XST00003-DIST-MGR-NM                           08100006
081200     END-EXEC.                                                    08120000
081300                                                                  08130000
081400     IF ((SQLCODE < PC-SUCCESSFUL-SQLCODE)                        08140000
081500             OR ((SQLCODE > PC-SUCCESSFUL-SQLCODE)                08150000
081600             AND (SQLCODE NOT = PC-END-OF-CURSOR-SQLCODE))        08160000
081700             OR (SQLWARN0 NOT = SPACES))                          08170000
081800         SET PV-FETCH-STORE-ROW TO TRUE                           08180000
081900         PERFORM 9100-DB2-ERROR                                   08190000
082000     END-IF.                                                      08200000
082100*7300-EXIT.                                                       08210000
082200                                                                  08220000
082300******************************************************************08230000
082400*  WRITE AN INFOPAC MERCHANT FILE RECORD, AND ACCUMULATE I/O     *08240000
082500*  TOTALS.                                                       *08250000
082600******************************************************************08260000
082700                                                                  08270000
082800 8000-WRITE-MERCHANT-RECORD.                                      08280000
082900     WRITE IM-INFOPAC-MERCHANT-RECORD                             08290000
083000         FROM RM001-INFOPAC-MERCHANT-RECORD.                      08300001
083100                                                                  08310000
083200     ADD +1 TO PT-MERCHANT-RCDS-WRITTEN.                          08320000
083300*8000-EXIT.                                                       08330000
083400                                                                  08340000
083500******************************************************************08350000
083600*  WRITE AN INFOPAC STORE FILE RECORD, AND ACCUMULATE I/O        *08360000
083700*  TOTALS.                                                       *08370000
083800******************************************************************08380000
083900                                                                  08390000
084000 8100-WRITE-STORE-RECORD.                                         08400000
084100     WRITE IS-INFOPAC-STORE-RECORD                                08410000
084200         FROM RM002-INFOPAC-STORE-RECORD.                         08420001
084300                                                                  08430000
084400     ADD +1 TO PT-STORE-RCDS-WRITTEN.                             08440000
084500*8100-EXIT.                                                       08450000
084510                                                                  08451015
084520******************************************************************08452015
084530*  WRITE AN INFOPAC MERCHANT DEPARTMENT FILE RECORDS, AND        *08453015
084540*  ACCUMULATE I/O TOTALS.                                        *08454015
084550******************************************************************08455015
084560                                                                  08456015
084570 8200-WRITE-MERCH-DEPT-RECORD.                                    08457016
084580     WRITE IM-INFOPAC-MERCH-DEPT-RECORD                           08458015
084590         FROM RM003-INFOPAC-MERCH-DPT-RECORD.                     08459015
084591                                                                  08459115
084592     ADD +1 TO PT-MERCH-DEPT-RCDS-WRITTEN.                        08459215
084593*8200-EXIT.                                                       08459315
084594                                                                  08459417
084595******************************************************************08459517
084596*  WRITE AN INFOPAC MERCHANT DEPARTMENT FILE RECORDS, AND        *08459617
084597*  ACCUMULATE I/O TOTALS.                                        *08459717
084598******************************************************************08459817
084599                                                                  08459917
084600 8300-WRITE-SUM-XREF-RECORD.                                      08460017
084601     WRITE IS-INFOPAC-SUM-XREF-RECORD                             08460117
084602         FROM RM004-INFOPAC-SUM-XREF-RECORD.                      08460217
084603                                                                  08460317
084604     ADD +1 TO PT-SUM-XREF-RCDS-WRITTEN.                          08460417
084605*8300-EXIT.                                                       08460517
084610                                                                  08461017
084700******************************************************************08470000
084800*  CLOSE ALL FILES.                                              *08480000
084900******************************************************************08490000
085000                                                                  08500000
085100 9000-EOJ-ROUTINE.                                                08510000
085200     CLOSE INFOPAC-MERCHANT-FILE                                  08520000
085300           INFOPAC-STORE-FILE                                     08530015
085310           INFOPAC-MERCH-DEPT-FILE.                               08531015
085400*9000-EXIT.                                                       08540000
085500                                                                  08550000
085600******************************************************************08560000
085700*  FORMAT A DB2 ERROR MESSAGE, AND ABEND THE PROGRAM.            *08570000
085800******************************************************************08580000
085900                                                                  08590000
086000 9100-DB2-ERROR.                                                  08600000
086100     DISPLAY '** ABEND **'.                                       08610000
086200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - SQL ERROR'.             08620000
086300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ATTEMPTING TO '         08630000
086400               PV-LAST-DB2-ACTION.                                08640000
086500                                                                  08650000
086600*                                                                 08660000
086700*  ROUTINE TO CONVERT THE SQLCA INTO A READABLE FORMAT, USING     08670000
086800*  THE CALLED MODULE DSNTIAR.                                     08680000
086900*                                                                 08690000
087000                                                                  08700000
087100     COPY DPPD004.                                                08710000
087200                                                                  08720000
087300     SET AC-DB2-ERROR-4013 TO TRUE.                               08730000
087400     CALL 'ILBOABN0' USING ABEND-CODE.                            08740000
087500*9100-EXIT.                                                       08750000
