000100******************************************************************00010025
000200 IDENTIFICATION DIVISION.                                         00020025
000300******************************************************************00030025
000400                                                                  00040025
000500 PROGRAM-ID.       PCKCS011.                                      00050025
000600 AUTHOR.           ANNE RECKNAGEL.                                00060025
000700 INSTALLATION.     KOHLS.                                         00070025
000800 DATE-WRITTEN      APRIL, 1994.                                   00080025
000900 DATE-COMPILED.                                                   00090025
001000                                                                  00100025
001100******************************************************************00110025
001200* THIS PROGRAM PRODUCES THE CONTROL APRON.                        00120025
001300******************************************************************00130025
001400                                                                  00140025
001500******************************************************************00150025
001600 ENVIRONMENT DIVISION.                                            00160025
001700******************************************************************00170025
001800                                                                  00180025
001900******************************************************************00190025
002000 DATA DIVISION.                                                   00200025
002100******************************************************************00210025
002200                                                                  00220025
002300******************************************************************00230025
002400 WORKING-STORAGE SECTION.                                         00240025
002500******************************************************************00250025
002600                                                                  00260025
002700*                                                                 00270025
002800*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00280025
002900*                                                                 00290025
003000     COPY DFHAID.                                                 00300025
003100                                                                  00310025
003200*  COPY BOOK CONTAINING THE WORKING STORAGE VALUES REQUIRED FOR   00320025
003300*  DETERMINING THE PAYMENT TERMS                                  00330025
003400*                                                                 00340025
003500     COPY POWS020.                                                00350025
003600                                                                  00360025
003700*  COPY BOOK CONTAINING THE WORKING STORAGE VALUES REQUIRED FOR   00370025
003800*  CALLING THE PRINTER VALIDATION ROUTINE DPKCS060                00380025
003900*                                                                 00390025
004000     COPY DPWS072.                                                00400025
004100                                                                  00410025
004200*  COPY BOOK CONTAINING COMMON PRINTER LINE COMMANDS              00420025
004300*                                                                 00430025
004400     COPY DSWS004.                                                00440025
004500                                                                  00450025
004600*                                                                 00460025
004700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00470025
004800*                                                                 00480025
004900     COPY DPWS013.                                                00490025
005000                                                                  00500025
005100*                                                                 00510025
005200*  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE                00520025
005300*                                                                 00530025
005400     COPY DPWS004.                                                00540025
005500*                                                                 00550025
005600     COPY DPWS020.                                                00560025
005700*                                                                 00570025
005800                                                                  00580025
005900*    DOMAIN ITEM MODULE                                           00590025
006000     COPY XLWS001.                                                00600025
006100*                                                                 00610025
006200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     00620025
006300*                                                                 00630025
006400     EXEC SQL                                                     00640025
006500         INCLUDE TRECEIV                                          00650025
006600     END-EXEC.                                                    00660025
006700                                                                  00670025
006800     EXEC SQL                                                     00680025
006900         INCLUDE TRECDIS                                          00690025
007000     END-EXEC.                                                    00700025
007100                                                                  00710025
007200*                                                                 00720025
007300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00730025
007400*  TABLE                                                          00740025
007500*                                                                 00750025
007600     EXEC SQL                                                     00760025
007700         INCLUDE TRECITM                                          00770025
007800     END-EXEC.                                                    00780025
007900                                                                  00790025
008000*                                                                 00800025
008100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE WORK ORDER TABLE   00810025
008200*                                                                 00820025
008300     EXEC SQL                                                     00830025
008400         INCLUDE TWRKORD                                          00840025
008500     END-EXEC.                                                    00850025
008600                                                                  00860025
008700*                                                                 00870025
008800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STATUS CODE TABLE  00880025
008900*                                                                 00890025
009000     EXEC SQL                                                     00900025
009100          INCLUDE TSTATCD                                         00910025
009200     END-EXEC.                                                    00920025
009300                                                                  00930025
009400*                                                                 00940025
009500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00950025
009600*  HEADER TABLE                                                   00960025
009700*                                                                 00970025
009800     EXEC SQL                                                     00980025
009900          INCLUDE TPURCHS                                         00990025
010000     END-EXEC.                                                    01000025
010100                                                                  01010025
010200*                                                                 01020025
010300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01030025
010400*  ITEM TABLE                                                     01040025
010500*                                                                 01050025
010600     EXEC SQL                                                     01060025
010700          INCLUDE TPURITM                                         01070025
010800     END-EXEC.                                                    01080025
010900                                                                  01090025
011000*                                                                 01100025
011100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE EXTERNAL ENTERPRISE01110025
011200*  TABLE.                                                         01120025
011300*                                                                 01130025
011400     EXEC SQL                                                     01140025
011500          INCLUDE TEXTENT                                         01150025
011600     END-EXEC.                                                    01160025
011700                                                                  01170025
011800*                                                                 01180025
011900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRISE NAME    01190025
012000*  TABLE.                                                         01200025
012100*                                                                 01210025
012200     EXEC SQL                                                     01220025
012300          INCLUDE TENTNME                                         01230025
012400     END-EXEC.                                                    01240025
012500                                                                  01250025
012600*                                                                 01260025
012700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01270025
012800*  INSTRUCTIONS TABLE                                             01280025
012900*                                                                 01290025
013000     EXEC SQL                                                     01300025
013100          INCLUDE TPOINST                                         01310025
013200     END-EXEC.                                                    01320025
013300                                                                  01330025
013400*                                                                 01340025
013500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01350025
013600*  INSTRUCTIONS CODE TABLE                                        01360025
013700*                                                                 01370025
013800     EXEC SQL                                                     01380025
013900          INCLUDE TINSTCD                                         01390025
014000     END-EXEC.                                                    01400025
014100                                                                  01410025
014200*                                                                 01420025
014300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE WORK ORDER         01430025
014400*  INSTRUCTIONS TABLE                                             01440025
014500*                                                                 01450025
014600     EXEC SQL                                                     01460025
014700          INCLUDE TWKORIN                                         01470025
014800     END-EXEC.                                                    01480025
014900                                                                  01490025
015000*                                                                 01500025
015100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PACK SLIP TABLE    01510025
015200*                                                                 01520025
015300     EXEC SQL                                                     01530025
015400          INCLUDE TPKSLIP                                         01540025
015500     END-EXEC.                                                    01550025
015600                                                                  01560025
015700*                                                                 01570025
015800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VENDOR AGREEMENT   01580025
015900*  TABLE                                                          01590025
016000*                                                                 01600025
016100     EXEC SQL                                                     01610025
016200          INCLUDE TVNDAGR                                         01620025
016300     END-EXEC.                                                    01630025
016400                                                                  01640025
016500*                                                                 01650025
016600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VENDOR DEPARTMENT  01660025
016700*  TABLE                                                          01670025
016800*                                                                 01680025
016900     EXEC SQL                                                     01690025
017000          INCLUDE TVNDDPT                                         01700025
017100     END-EXEC.                                                    01710025
017200                                                                  01720025
017300*                                                                 01730025
017400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PAYMENT TERMS      01740025
017500*  TABLE                                                          01750025
017600*                                                                 01760025
017700     EXEC SQL                                                     01770025
017800          INCLUDE TPAYTRM                                         01780025
017900     END-EXEC.                                                    01790025
018000                                                                  01800025
018100*                                                                 01810025
018200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PLANNED SHIPMENT   01820025
018300*  TABLE                                                          01830025
018400*                                                                 01840025
018500     EXEC SQL                                                     01850025
018600          INCLUDE TPLNSHP                                         01860025
018700     END-EXEC.                                                    01870025
018800                                                                  01880025
018900*                                                                 01890025
019000*                                                                 01900025
019100*  COMMUNICATIONS AREA FOR DB2                                    01910025
019200*                                                                 01920025
019300     EXEC SQL                                                     01930025
019400         INCLUDE SQLCA                                            01940025
019500     END-EXEC.                                                    01950025
019600                                                                  01960025
019700*                                                                 01970025
019800*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            01980025
019900*                                                                 01990025
020000     COPY DRRD001O.                                               02000025
020100                                                                  02010025
020200*                                                                 02020025
020300*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        02030025
020400*                                                                 02040025
020500     COPY DRRD002O.                                               02050025
020600                                                                  02060025
020700 01  CA-COMMAREA.                                                 02070025
020800     05  CA-WRK-ORD-KEY-X.                                        02080025
020900         10  CA-ORD-NBR-X                PIC  X(08)  VALUE SPACE. 02090025
021000         10  CA-ORD-NBR  REDEFINES  CA-ORD-NBR-X                  02100025
021100                                         PIC  9(08).              02110025
021200         10  CA-RCVR-SEQ-NBR-X           PIC  X(03)  VALUE SPACE. 02120025
021300         10  CA-RCVR-SEQ-NBR  REDEFINES  CA-RCVR-SEQ-NBR-X        02130025
021400                                         PIC  9(03).              02140025
021500         10  CA-ORD-LNE-NBR-X            PIC  X(04)  VALUE SPACE. 02150025
021600         10  CA-ORD-LNE-NBR  REDEFINES  CA-ORD-LNE-NBR-X          02160025
021700                                         PIC  9(04).              02170025
021800         10  CA-WORK-ORD-SEQ-NBR-X       PIC  X(03)  VALUE SPACE. 02180025
021900         10  CA-WORK-ORD-SEQ-NBR  REDEFINES  CA-WORK-ORD-SEQ-NBR-X02190025
022000                                         PIC  9(03).              02200025
022100     05  CA-DESTINATION                  PIC  X(08)  VALUE SPACE. 02210025
022200     05  CA-PREPARER-USER-ID             PIC  X(08)  VALUE SPACE. 02220025
022300     05  CA-OPER-UNT-ID                  PIC  X(04)  VALUE SPACE. 02230025
022400     05  CA-FCLTY-ID                     PIC  X(04)  VALUE SPACE. 02240025
022500     05  CA-CONTROL-APRON-REQ-IND        PIC  X(01)  VALUE SPACE. 02250025
022600         88  CA-CNTL-APRON-HEADER                    VALUE 'H'.   02260025
022700     05  CA-PRTR-AUTO-CUTTER-IND         PIC  X(01)  VALUE SPACE. 02270025
022800     05  CA-PRTR-PRTR-BRCDE-IND          PIC  X(01)  VALUE SPACE. 02280025
022900     05  CA-PRTR-PRTR-CNTL-IND           PIC  X(01)  VALUE SPACE. 02290025
023000     05  FILLER                          PIC  X(04)  VALUE SPACE. 02300025
023100*                                                                 02310025
023200 01  DK-DB2-KEYS.                                                 02320025
023300     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  02330025
023400                                                     COMP.        02340025
023500     05  DK-RCVR-SEQ-NBR                 PIC S9(09)  VALUE ZEROS  02350025
023600                                                     COMP.        02360025
023700     05  DK-ORD-LNE-NBR                  PIC S9(04)  VALUE ZEROS  02370025
023800                                                     COMP.        02380025
023900     05  DK-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  02390025
024000                                                     COMP.        02400025
024100     05  DK-FCLTY-ID                     PIC S9(04)  VALUE ZEROS  02410025
024200                                                     COMP.        02420025
024300*                                                                 02430025
024400 01  HL1-HEADING-LINE-1.                                          02440025
024500     05  FILLER                          PIC  X(02)  VALUE SPACE. 02450025
024600     05  HL1-RUN-DATE.                                            02460025
024700         10  HL1-RUN-MONTH               PIC  9(02)  VALUE ZERO.  02470025
024800         10  FILLER                      PIC  X(01)  VALUE '/'.   02480025
024900         10  HL1-RUN-DAY                 PIC  9(02)  VALUE ZERO.  02490025
025000         10  FILLER                      PIC  X(01)  VALUE '/'.   02500025
025100         10  HL1-RUN-YEAR                PIC  9(02)  VALUE ZERO.  02510025
025200     05  FILLER                          PIC  X(02)  VALUE SPACE. 02520025
025300     05  HL1-RUN-TIME.                                            02530025
025400         10  HL1-RUN-HOUR                PIC  9(02)  VALUE ZERO.  02540025
025500         10  FILLER                      PIC  X(01)  VALUE ':'.   02550025
025600         10  HL1-RUN-MINUTE              PIC  9(02)  VALUE ZERO.  02560025
025700     05  FILLER                          PIC  X(24)  VALUE SPACE. 02570025
025800     05  HL1-RPT-HDR                     PIC  X(46)  VALUE SPACE. 02580025
025900     05  FILLER                          PIC  X(20)  VALUE SPACE. 02590025
026000     05  HL1-PROGRAM-NAME                PIC  X(08)  VALUE SPACE. 02600025
026100     05  FILLER                          PIC  X(01)  VALUE '-'.   02610025
026200     05  HL1-RPT-NBR                     PIC  9(01)  VALUE ZERO.  02620025
026300     05  FILLER                          PIC  X(02)  VALUE SPACE. 02630025
026400     05  FILLER                          PIC  X(05)  VALUE        02640025
026500         'PAGE '.                                                 02650025
026600     05  HL1-PGE-NBR                     PIC  9(01)  VALUE ZERO.  02660025
026700     05  FILLER                          PIC  X(04)  VALUE        02670025
026800         ' OF '.                                                  02680025
026900     05  HL1-OF-PGE-NBR                  PIC  9(01)  VALUE ZERO.  02690025
027000     05  FILLER                          PIC  X(02)  VALUE SPACE. 02700025
027100*                                                                 02710025
027200 01  HL2-HEADING-LINE-2.                                          02720025
027300     05  FILLER                          PIC  X(05)  VALUE SPACE. 02730025
027400     05  FILLER                          PIC  X(14)  VALUE        02740025
027500         'VENDOR NUMBER:'.                                        02750025
027600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02760025
027700     05  HL2-VENDOR-NBR                  PIC  X(09)  VALUE SPACE. 02770025
027800     05  FILLER                          PIC  X(18)  VALUE SPACE. 02780025
027900     05  FILLER                          PIC  X(13)  VALUE        02790025
028000         'OPERATING ID:'.                                         02800025
028100     05  FILLER                          PIC  X(01)  VALUE SPACE. 02810025
028200     05  HL2-OPERATING-ID                PIC  X(04)  VALUE SPACE. 02820025
028300     05  FILLER                          PIC  X(35)  VALUE SPACE. 02830025
028400     05  FILLER                          PIC  X(11)  VALUE        02840025
028500         'PRINTER ID:'.                                           02850025
028600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02860025
028700     05  HL2-PRINTER-DEST                PIC  X(08)  VALUE SPACE. 02870025
028800     05  FILLER                          PIC  X(12)  VALUE SPACE. 02880025
028900*                                                                 02890025
029000 01  HL3-HEADING-LINE-3.                                          02900025
029100     05  FILLER                          PIC  X(07)  VALUE SPACE. 02910025
029200     05  FILLER                          PIC  X(12)  VALUE        02920025
029300         'VENDOR NAME:'.                                          02930025
029400     05  FILLER                          PIC  X(01)  VALUE SPACE. 02940025
029500     05  HL3-VNDR-NME                    PIC  X(25)  VALUE SPACE. 02950025
029600     05  FILLER                          PIC  X(03)  VALUE SPACE. 02960025
029700     05  FILLER                          PIC  X(12)  VALUE        02970025
029800         'FACILITY ID:'.                                          02980025
029900     05  FILLER                          PIC  X(01)  VALUE SPACE. 02990025
030000     05  HL3-FACILITY-ID                 PIC  X(04)  VALUE SPACE. 03000025
030100     05  FILLER                          PIC  X(34)  VALUE SPACE. 03010025
030200     05  FILLER                          PIC  X(12)  VALUE        03020025
030300         'PREPARED BY:'.                                          03030025
030400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03040025
030500     05  HL3-PREPARER-USER-ID            PIC  X(08)  VALUE SPACE. 03050025
030600     05  FILLER                          PIC  X(12)  VALUE SPACE. 03060025
030700*                                                                 03070025
030800 01  HL4-HEADING-LINE-4.                                          03080025
030900     05  FILLER                          PIC  X(04)  VALUE SPACE. 03090025
031000     05  FILLER                          PIC  X(15)  VALUE        03100025
031100         'VENDOR INHOUSE:'.                                       03110025
031200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03120025
031300     05  HL4-VNDR-INHSE                  PIC  X(03)  VALUE SPACE. 03130025
031400     05  FILLER                          PIC  X(23)  VALUE SPACE. 03140025
031500     05  FILLER                          PIC  X(14)  VALUE        03150025
031600         'TOTAL CARTONS:'.                                        03160025
031700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03170025
031800     05  HL4-TOT-CARTON-CNT              PIC  ZZZZZ9.             03180025
031900     05  FILLER                          PIC  X(27)  VALUE SPACE. 03190025
032000     05  FILLER                          PIC  X(17)  VALUE        03200025
032100         'OLD RECEIVER NBR:'.                                     03210025
032200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03220025
032300     05  HL4-KEYREC                      PIC  ZZZZZZZZZ.          03230025
032400     05  FILLER                          PIC  X(11)  VALUE SPACE. 03240025
032500*                                                                 03250025
032600 01  HL5-HEADING-LINE-5.                                          03260025
032700     05  FILLER                          PIC  X(55)  VALUE SPACE. 03270025
032800     05  FILLER                          PIC  X(05)  VALUE        03280025
032900         'DEPT:'.                                                 03290025
033000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03300025
033100     05  HL5-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 03310025
033200     05  FILLER                          PIC  X(03)  VALUE SPACE. 03320025
033300     05  FILLER                          PIC  X(04)  VALUE        03330025
033400         'CLS:'.                                                  03340025
033500     05  FILLER                          PIC  X(01)  VALUE SPACE. 03350025
033600     05  HL5-CLASS-NBR                   PIC  X(02)  VALUE SPACE. 03360025
033700     05  FILLER                          PIC  X(03)  VALUE SPACE. 03370025
033800     05  FILLER                          PIC  X(04)  VALUE        03380025
033900         'SKU:'.                                                  03390025
034000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03400025
034100     05  HL5-SEQ-NBR                     PIC  9(08)  BLANK ZERO.  03410025
034200     05  FILLER                          PIC  X(42)  VALUE SPACE. 03420025
034300*                                                                 03430025
034400 01  HL6-HEADING-LINE-6.                                          03440025
034500     05  FILLER                          PIC  X(09)  VALUE SPACE. 03450025
034600     05  FILLER                          PIC  X(10)  VALUE        03460025
034700         'PO NUMBER:'.                                            03470025
034800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03480025
034900     05  HL6-PO-NBR                      PIC  X(08)  VALUE SPACE. 03490025
035000     05  FILLER                          PIC  X(26)  VALUE SPACE. 03500025
035100     05  FILLER                          PIC  X(06)  VALUE        03510025
035200         'STYLE:'.                                                03520025
035300     05  FILLER                          PIC  X(01)  VALUE SPACE. 03530025
035400     05  HL6-VNDR-STYLE-NME              PIC  X(20)  VALUE SPACE. 03540025
035500     05  FILLER                          PIC  X(16)  VALUE SPACE. 03550025
035600     05  FILLER                          PIC  X(14)  VALUE        03560025
035700         'DATE RECEIVED:'.                                        03570025
035800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03580025
035900     05  HL6-DATE-RCVD.                                           03590025
036000         10  HL6-RCVD-MONTH              PIC  9(02)  VALUE ZEROS. 03600025
036100         10  HL6-SLASH-ONE               PIC  X(01)  VALUE SPACE. 03610025
036200         10  HL6-RCVD-DAY                PIC  9(02)  VALUE ZEROS. 03620025
036300         10  HL6-SLASH-TWO               PIC  X(01)  VALUE SPACE. 03630025
036400         10  HL6-RCVD-YEAR               PIC  9(02)  VALUE ZEROS. 03640025
036500     05  FILLER                          PIC  X(12)  VALUE SPACE. 03650025
036600                                                                  03660025
036700 01  HL7-HEADING-LINE-7.                                          03670025
036800     05  FILLER                          PIC  X(06)  VALUE SPACE. 03680025
036900     05  FILLER                          PIC  X(13)  VALUE        03690025
037000         'SEQUENCE NBR:'.                                         03700025
037100     05  FILLER                          PIC  X(01)  VALUE SPACE. 03710025
037200     05  HL7-RCVR-SEQ-NBR                PIC  X(03)  VALUE SPACE. 03720025
037300     05  FILLER                          PIC  X(19)  VALUE SPACE. 03730025
037400     05  FILLER                          PIC  X(18)  VALUE        03740025
037500         'PO LINE ITEM DESC:'.                                    03750025
037600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03760025
037700     05  HL7-PO-LNE-ITM-DESC             PIC  X(25)  VALUE SPACE. 03770025
037800     05  FILLER                          PIC  X(11)  VALUE SPACE. 03780025
037900     05  FILLER                          PIC  X(14)  VALUE        03790025
038000         'DATE VERIFIED:'.                                        03800025
038100     05  FILLER                          PIC  X(01)  VALUE SPACE. 03810025
038200     05  HL7-DATE-VRFD.                                           03820025
038300         10  HL7-VRFD-MONTH              PIC  9(02)  VALUE ZEROS. 03830025
038400         10  HL7-SLASH-ONE               PIC  X(01)  VALUE SPACE. 03840025
038500         10  HL7-VRFD-DAY                PIC  9(02)  VALUE ZEROS. 03850025
038600         10  HL7-SLASH-TWO               PIC  X(01)  VALUE SPACE. 03860025
038700         10  HL7-VRFD-YEAR               PIC  9(02)  VALUE ZEROS. 03870025
038800     05  FILLER                          PIC  X(12)  VALUE SPACE. 03880025
038900                                                                  03890025
039000 01  HL8-HEADING-LINE-8.                                          03900025
039100     05  FILLER                          PIC  X(10)  VALUE SPACE. 03910025
039200     05  FILLER                          PIC  X(09)  VALUE        03920025
039300         'LINE NBR:'.                                             03930025
039400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03940025
039500     05  HL8-LINE-NBR                    PIC  X(04)  VALUE SPACE. 03950025
039600     05  FILLER                          PIC  X(17)  VALUE SPACE. 03960025
039700     05  FILLER                          PIC  X(19)  VALUE        03970025
039800         'SKU LINE ITEM DESC:'.                                   03980025
039900     05  FILLER                          PIC  X(01)  VALUE SPACE. 03990025
040000     05  HL8-SKU-ITM-DESC                PIC  X(25)  VALUE SPACE. 04000025
040100     05  FILLER                          PIC  X(47)  VALUE SPACE. 04010025
040200                                                                  04020025
040300 01  HL9-HEADING-LINE-9.                                          04030025
040400     05  FILLER                          PIC  X(07)  VALUE SPACE. 04040025
040500     05  FILLER                          PIC  X(12)  VALUE        04050025
040600         'INVOICE NBR:'.                                          04060025
040700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04070025
040800     05  HL9-INVOICE-NBR                 PIC  X(09)  VALUE SPACE. 04080025
040900     05  FILLER                          PIC  X(18)  VALUE SPACE. 04090025
041000     05  FILLER                          PIC  X(13)  VALUE        04100025
041100         'PO SIZE DESC:'.                                         04110025
041200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04120025
041300     05  HL9-PO-SIZE-DESC                PIC  X(25)  VALUE SPACE. 04130025
041400     05  FILLER                          PIC  X(46)  VALUE SPACE. 04140025
041500                                                                  04150025
041600 01  HL10-HEADING-LINE-10.                                        04160025
041700     05  FILLER                          PIC  X(14)  VALUE SPACE. 04170025
041800     05  FILLER                          PIC  X(05)  VALUE        04180025
041900         'COST:'.                                                 04190025
042000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04200025
042100     05  HL10-COST                       PIC  ZZ,ZZZ.99           04210025
042200                                                     VALUE ZEROS  04220025
042300                                         BLANK WHEN ZERO.         04230025
042400     05  FILLER                          PIC  X(17)  VALUE SPACE. 04240025
042500     05  FILLER                          PIC  X(14)  VALUE        04250025
042600         'SKU SIZE DESC:'.                                        04260025
042700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04270025
042800     05  HL10-SKU-SIZE-DESC              PIC  X(05)  VALUE SPACE. 04280025
042900     05  FILLER                          PIC  X(66)  VALUE SPACE. 04290025
043000                                                                  04300025
043100 01  HL11-HEADING-LINE-11.                                        04310025
043200     05  FILLER                          PIC  X(12)  VALUE SPACE. 04320025
043300     05  FILLER                          PIC  X(07)  VALUE        04330025
043400         'RETAIL:'.                                               04340025
043500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04350025
043600     05  HL11-UNT-RTL-PR-AMT             PIC  ZZ,ZZZ.99           04360025
043700                                                     VALUE ZEROS  04370025
043800                                         BLANK WHEN ZERO.         04380025
043900     05  FILLER                          PIC  X(17)  VALUE SPACE. 04390025
044000     05  FILLER                          PIC  X(14)  VALUE        04400025
044100         'PO COLOR DESC:'.                                        04410025
044200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04420025
044300     05  HL11-PO-COLOR-DESC              PIC  X(25)  VALUE SPACE. 04430025
044400     05  FILLER                          PIC  X(46)  VALUE SPACE. 04440025
044500                                                                  04450025
044600 01  HL12-HEADING-LINE-12.                                        04460025
044700     05  FILLER                          PIC  X(06)  VALUE SPACE. 04470025
044800     05  FILLER                          PIC  X(13)  VALUE        04480025
044900         'UNIT MEASURE:'.                                         04490025
045000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04500025
045100     05  HL12-UM                         PIC  X(02)  VALUE SPACE. 04510025
045200     05  FILLER                          PIC  X(23)  VALUE SPACE. 04520025
045300     05  FILLER                          PIC  X(15)  VALUE        04530025
045400         'SKU COLOR DESC:'.                                       04540025
045500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04550025
045600     05  HL12-SKU-COLOR-DESC             PIC  X(04)  VALUE SPACE. 04560025
045700     05  FILLER                          PIC  X(67)  VALUE SPACE. 04570025
045800                                                                  04580025
045900 01  HL13-HEADING-LINE-13.                                        04590025
046000     05  FILLER                          PIC  X(06)  VALUE SPACE. 04600025
046100     05  FILLER                          PIC  X(13)  VALUE        04610025
046200         'PAYMENT TERM:'.                                         04620025
046300     05  FILLER                          PIC  X(01)  VALUE SPACE. 04630025
046400     05  HL13-PAYMENT-TERM               PIC  X(28)  VALUE SPACE. 04640025
046500     05  FILLER                          PIC  X(02)  VALUE SPACE. 04650025
046600     05  FILLER                          PIC  X(10)  VALUE        04660025
046700         'FRGT CODE:'.                                            04670025
046800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04680025
046900     05  HL13-PAY-CDE                    PIC  X(01)  VALUE SPACE. 04690025
047000     05  FILLER                          PIC  X(70)  VALUE SPACE. 04700025
047100                                                                  04710025
047200 01  HL14-HEADING-LINE-14.                                        04720025
047300     05  FILLER                          PIC  X(05)  VALUE SPACE. 04730025
047400     05  FILLER                          PIC  X(14)  VALUE        04740025
047500         'SPECIAL INSTR:'.                                        04750025
047600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04760025
047700     05  HL14-SPECIAL-INSTR              PIC  X(50)  VALUE SPACE. 04770025
047800     05  FILLER                          PIC  X(62)  VALUE SPACE. 04780025
047900                                                                  04790025
048000*   PCKCS011-1 ONLY                                               04800025
048100 01  HL15-HEADING-LINE-15.                                        04810025
048200     05  FILLER                          PIC  X(09)  VALUE SPACE. 04820025
048300     05  FILLER                          PIC  X(10)  VALUE        04830025
048400         'PO NUMBER:'.                                            04840025
048500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04850025
048600     05  HL15-PO-NBR                     PIC  X(08)  VALUE SPACE. 04860025
048700     05  FILLER                          PIC  X(12)  VALUE SPACE. 04870025
048800     05  FILLER                          PIC  X(20)  VALUE        04880025
048900         'TOTAL RECEIVER COST:'.                                  04890025
049000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04900025
049100     05  HL15-TOT-RCVR-COST              PIC  $$,$$$,$$$.99.      04910025
049200     05  FILLER                          PIC  X(23)  VALUE SPACE. 04920025
049300     05  FILLER                          PIC  X(14)  VALUE        04930025
049400         'DATE RECEIVED:'.                                        04940025
049500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04950025
049600     05  HL15-DATE-RCVD.                                          04960025
049700         10  HL15-RCVD-MONTH             PIC  9(02)  VALUE ZEROS. 04970025
049800         10  HL15-SLASH-ONE              PIC  X(01)  VALUE SPACE. 04980025
049900         10  HL15-RCVD-DAY               PIC  9(02)  VALUE ZEROS. 04990025
050000         10  HL15-SLASH-TWO              PIC  X(01)  VALUE SPACE. 05000025
050100         10  HL15-RCVD-YEAR              PIC  9(02)  VALUE ZEROS. 05010025
050200     05  FILLER                          PIC  X(12)  VALUE SPACE. 05020025
050300                                                                  05030025
050400 01  HL16-HEADING-LINE-16.                                        05040025
050500     05  FILLER                          PIC  X(06)  VALUE SPACE. 05050025
050600     05  FILLER                          PIC  X(13)  VALUE        05060025
050700         'SEQUENCE NBR:'.                                         05070025
050800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05080025
050900     05  HL16-RCVR-SEQ-NBR               PIC  X(03)  VALUE SPACE. 05090025
051000     05  FILLER                          PIC  X(15)  VALUE SPACE. 05100025
051100     05  FILLER                          PIC  X(22)  VALUE        05110025
051200         'TOTAL RECEIVER RETAIL:'.                                05120025
051300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05130025
051400     05  HL16-TOT-RCVR-RETAIL            PIC  $$,$$$,$$$.99.      05140025
051500     05  FILLER                          PIC  X(23)  VALUE SPACE. 05150025
051600     05  FILLER                          PIC  X(14)  VALUE        05160025
051700         'DATE VERIFIED:'.                                        05170025
051800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05180025
051900     05  HL16-DATE-VRFD.                                          05190025
052000         10  HL16-VRFD-MONTH             PIC  9(02)  VALUE ZEROS. 05200025
052100         10  HL16-SLASH-ONE              PIC  X(01)  VALUE SPACE. 05210025
052200         10  HL16-VRFD-DAY               PIC  9(02)  VALUE ZEROS. 05220025
052300         10  HL16-SLASH-TWO              PIC  X(01)  VALUE SPACE. 05230025
052400         10  HL16-VRFD-YEAR              PIC  9(02)  VALUE ZEROS. 05240025
052500     05  FILLER                          PIC  X(12)  VALUE SPACE. 05250025
052600                                                                  05260025
052700*   FOR PCKCS011-1 REPORT ONLY                                    05270025
052800 01  HL17-HEADING-LINE-17.                                        05280025
052900     05  FILLER                          PIC  X(36)  VALUE SPACE. 05290025
053000     05  FILLER                          PIC  X(24)  VALUE        05300025
053100         'TOTAL VERIFIED QUANTITY:'.                              05310025
053200     05  FILLER                          PIC  X(05)  VALUE SPACE. 05320025
053300     05  HL17-TOT-VERFD-QTY              PIC  Z,ZZZ,ZZ9.          05330025
053400     05  FILLER                          PIC  X(59)  VALUE SPACE. 05340025
053500                                                                  05350025
053600                                                                  05360025
053700 01  DH1-DETAIL-HEADING-LINE-1.                                   05370025
053800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05380025
053900     05  FILLER                          PIC  X(05)  VALUE        05390025
054000         'STORE'.                                                 05400025
054100     05  FILLER                          PIC  X(02)  VALUE SPACE. 05410025
054200     05  FILLER                          PIC  X(06)  VALUE        05420025
054300         'EXPTED'.                                                05430025
054400     05  FILLER                          PIC  X(02)  VALUE SPACE. 05440025
054500     05  FILLER                          PIC  X(08)  VALUE        05450025
054600         'ACTUAL  '.                                              05460025
054700     05  FILLER                          PIC  X(02)  VALUE SPACE. 05470025
054800     05  FILLER                          PIC  X(07)  VALUE        05480025
054900         'AP VERF'.                                               05490025
055000     05  FILLER                          PIC  X(02)  VALUE SPACE. 05500025
055100     05  FILLER                          PIC  X(07)  VALUE        05510025
055200         'OPEN TO'.                                               05520025
055300     05  FILLER                          PIC  X(03)  VALUE SPACE. 05530025
055400     05  FILLER                          PIC  X(05)  VALUE        05540025
055500         'STORE'.                                                 05550025
055600     05  FILLER                          PIC  X(02)  VALUE SPACE. 05560025
055700     05  FILLER                          PIC  X(06)  VALUE        05570025
055800         'EXPTED'.                                                05580025
055900     05  FILLER                          PIC  X(02)  VALUE SPACE. 05590025
056000     05  FILLER                          PIC  X(08)  VALUE        05600025
056100         'ACTUAL  '.                                              05610025
056200     05  FILLER                          PIC  X(02)  VALUE SPACE. 05620025
056300     05  FILLER                          PIC  X(07)  VALUE        05630025
056400         'AP VERF'.                                               05640025
056500     05  FILLER                          PIC  X(02)  VALUE SPACE. 05650025
056600     05  FILLER                          PIC  X(07)  VALUE        05660025
056700         'OPEN TO'.                                               05670025
056800     05  FILLER                          PIC  X(03)  VALUE SPACE. 05680025
056900     05  FILLER                          PIC  X(05)  VALUE        05690025
057000         'STORE'.                                                 05700025
057100     05  FILLER                          PIC  X(02)  VALUE SPACE. 05710025
057200     05  FILLER                          PIC  X(06)  VALUE        05720025
057300         'EXPTED'.                                                05730025
057400     05  FILLER                          PIC  X(02)  VALUE SPACE. 05740025
057500     05  FILLER                          PIC  X(08)  VALUE        05750025
057600         'ACTUAL  '.                                              05760025
057700     05  FILLER                          PIC  X(02)  VALUE SPACE. 05770025
057800     05  FILLER                          PIC  X(07)  VALUE        05780025
057900         'AP VERF'.                                               05790025
058000     05  FILLER                          PIC  X(02)  VALUE SPACE. 05800025
058100     05  FILLER                          PIC  X(07)  VALUE        05810025
058200         'OPEN TO'.                                               05820025
058300     05  FILLER                          PIC  X(02)  VALUE SPACE. 05830025
058400                                                                  05840025
058500*   PCKCS011-1 ONLY                                               05850025
058600 01  DH2-DETAIL-HEADING-LINE-2.                                   05860025
058700     05  FILLER                          PIC  X(09)  VALUE SPACE. 05870025
058800     05  FILLER                          PIC  X(05)  VALUE        05880025
058900         'ITEMS'.                                                 05890025
059000     05  FILLER                          PIC  X(03)  VALUE SPACE. 05900025
059100     05  FILLER                          PIC  X(05)  VALUE        05910025
059200         'ITEMS'.                                                 05920025
059300     05  FILLER                          PIC  X(05)  VALUE SPACE. 05930025
059400     05  FILLER                          PIC  X(05)  VALUE        05940025
059500         'ITEMS'.                                                 05950025
059600     05  FILLER                          PIC  X(03)  VALUE SPACE. 05960025
059700     05  FILLER                          PIC  X(07)  VALUE        05970025
059800         'RECEIVE'.                                               05980025
059900     05  FILLER                          PIC  X(11)  VALUE SPACE. 05990025
060000     05  FILLER                          PIC  X(05)  VALUE        06000025
060100         'ITEMS'.                                                 06010025
060200     05  FILLER                          PIC  X(03)  VALUE SPACE. 06020025
060300     05  FILLER                          PIC  X(05)  VALUE        06030025
060400         'ITEMS'.                                                 06040025
060500     05  FILLER                          PIC  X(05)  VALUE SPACE. 06050025
060600     05  FILLER                          PIC  X(05)  VALUE        06060025
060700         'ITEMS'.                                                 06070025
060800     05  FILLER                          PIC  X(03)  VALUE SPACE. 06080025
060900     05  FILLER                          PIC  X(07)  VALUE        06090025
061000         'RECEIVE'.                                               06100025
061100     05  FILLER                          PIC  X(11)  VALUE SPACE. 06110025
061200     05  FILLER                          PIC  X(05)  VALUE        06120025
061300         'ITEMS'.                                                 06130025
061400     05  FILLER                          PIC  X(03)  VALUE SPACE. 06140025
061500     05  FILLER                          PIC  X(05)  VALUE        06150025
061600         'ITEMS'.                                                 06160025
061700     05  FILLER                          PIC  X(05)  VALUE SPACE. 06170025
061800     05  FILLER                          PIC  X(05)  VALUE        06180025
061900         'ITEMS'.                                                 06190025
062000     05  FILLER                          PIC  X(03)  VALUE SPACE. 06200025
062100     05  FILLER                          PIC  X(07)  VALUE        06210025
062200         'RECEIVE'.                                               06220025
062300     05  FILLER                          PIC  X(02)  VALUE SPACE. 06230025
062400                                                                  06240025
062500 01  DH3-DETAIL-HEADING-LINE-3.                                   06250025
062600     05  FILLER                          PIC  X(03)  VALUE SPACE. 06260025
062700     05  FILLER                          PIC  X(14)  VALUE        06270025
062800         'INVOICE NUMBER'.                                        06280025
062900     05  FILLER                          PIC  X(04)  VALUE SPACE. 06290025
063000     05  FILLER                          PIC  X(14)  VALUE        06300025
063100         'INVOICE NUMBER'.                                        06310025
063200     05  FILLER                          PIC  X(04)  VALUE SPACE. 06320025
063300     05  FILLER                          PIC  X(14)  VALUE        06330025
063400         'INVOICE NUMBER'.                                        06340025
063500     05  FILLER                          PIC  X(04)  VALUE SPACE. 06350025
063600     05  FILLER                          PIC  X(14)  VALUE        06360025
063700         'INVOICE NUMBER'.                                        06370025
063800     05  FILLER                          PIC  X(04)  VALUE SPACE. 06380025
063900     05  FILLER                          PIC  X(14)  VALUE        06390025
064000         'INVOICE NUMBER'.                                        06400025
064100     05  FILLER                          PIC  X(04)  VALUE SPACE. 06410025
064200     05  FILLER                          PIC  X(14)  VALUE        06420025
064300         'INVOICE NUMBER'.                                        06430025
064400     05  FILLER                          PIC  X(04)  VALUE SPACE. 06440025
064500     05  FILLER                          PIC  X(14)  VALUE        06450025
064600         'INVOICE NUMBER'.                                        06460025
064700     05  FILLER                          PIC  X(07)  VALUE SPACE. 06470025
064800                                                                  06480025
064900 01  DL1-DETAIL-LINE-1.                                           06490025
065000     05  FILLER                          PIC  X(01)  VALUE SPACE. 06500025
065100     05  DL1-DTL-LNE-AREA                OCCURS 3 TIMES           06510025
065200                                            INDEXED BY            06520025
065300                                            DL1-DTL-LNE-IDX.      06530025
065400         10  DL1-STR-NBR                 PIC  ZZZ9.               06540025
065500         10  FILLER                      PIC  X(02).              06550025
065600         10  DL1-EXPTED-ITM-CNT          PIC  ZZ,ZZ9.             06560025
065700         10  FILLER                      PIC  X(03).              06570025
065800         10  DL1-VERFD-ITM-CNT           PIC  ZZ,ZZ9.             06580025
065900         10  FILLER                      PIC  X(03).              06590025
066000         10  DL1-AP-VERFD-ITM-CNT        PIC  ZZ,ZZ9.             06600025
066100         10  FILLER                      PIC  X(04).              06610025
066200         10  DL1-UNITS-OPEN-TO-RECEIVE   PIC  X(06).              06620025
066300         10  FILLER                      PIC  X(04).              06630025
066400                                                                  06640025
066500*    FOR PCKCS011-1 ONLY                                          06650025
066600 01  DL2-DETAIL-LINE-2.                                           06660025
066700     05  FILLER                          PIC  X(05)  VALUE SPACE. 06670025
066800     05  DL2-DTL-LNE-AREA                OCCURS 7 TIMES           06680025
066900                                            INDEXED BY            06690025
067000                                            DL2-DTL-LNE-IDX.      06700025
067100         10  DL2-PKSL-NBR                PIC  X(10).              06710025
067200         10  FILLER                      PIC  X(08).              06720025
067300     05  FILLER                          PIC  X(01)  VALUE SPACE. 06730025
067400                                                                  06740025
067500 01  PC-PROGRAM-CONSTANTS.                                        06750025
067600     05  PC-DB2-DEFAULT-DATE             PIC  X(08)  VALUE        06760025
067700         '09/09/99'.                                              06770025
067800     05  PC-MULTIPLE-RESULT-SET-ROWS     PIC S9(04)  VALUE -811   06780025
067900                                                     COMP SYNC.   06790025
068000     05  PC-SLASH                        PIC  X(01)  VALUE '/'.   06800025
068100     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   06810025
068200                                                     COMP SYNC.   06820025
068300     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        06830025
068400         'PCKCS011'.                                              06840025
068500     05  PC-DPKCS060                     PIC  X(08)  VALUE        06850025
068600         'DPKCS060'.                                              06860025
068700     05  PC-ROWS-PER-PAGE                PIC S9(04)  VALUE +33    06870025
068800                                                     COMP SYNC.   06880025
068900     05  PC-COLS-PER-PAGE                PIC S9(04)  VALUE +3     06890025
069000                                                     COMP SYNC.   06900025
069100     05  PC-HDR-COLS-PER-PAGE            PIC S9(04)  VALUE +7     06910025
069200                                                     COMP SYNC.   06920025
069300     05  PC-MAX-STRS-PER-PAGE            PIC S9(04)  VALUE +99    06930025
069400                                                     COMP SYNC.   06940025
069500     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     06950025
069600                                                     COMP SYNC.   06960025
069700     05  PC-PUT                          PIC  X(03)  VALUE 'PUT'. 06970025
069800     05  PC-INIT                         PIC  X(04)  VALUE 'INIT'.06980025
069900     05  PC-TERM                         PIC  X(04)  VALUE 'TERM'.06990025
070000     05  PC-TOP-OF-PAGE                  PIC  X(01)  VALUE '1'.   07000025
070100     05  PC-SINGLE-SPACE                 PIC  X(01)  VALUE ' '.   07010025
070200     05  PC-DOUBLE-SPACE                 PIC  X(01)  VALUE '0'.   07020025
070300     05  PC-MULT-SPECIAL-INSTRS-MSG      PIC  X(50)  VALUE        07030025
070400         'MULT SPECIAL INSTRUCTIONS EXIST, SEE ONLINE SYSTEM'.    07040025
070500     05  PC-CONTROL-APRON-RPT-HDR        PIC  X(46)  VALUE        07050025
070600         '    C  O  N  T  R  O  L     A  P  R  O  N     '.        07060025
070700     05  PC-ABEND-MESSAGE                PIC  X(132) VALUE        07070025
070800          '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    07080025
070900                                                                  07090025
071000 01  PS-PROGRAM-SWITCHES.                                         07100025
071100     05  PS-PLAN-SW                      PIC  X      VALUE 'M'.   07110025
071200         88  PS-MASTER-PLAN                          VALUE 'M'.   07120025
071300         88  PS-SPECIFIC-PLAN                        VALUE 'S'.   07130025
071400     05  PS-DONE-SW                      PIC  X      VALUE 'N'.   07140025
071500         88  PS-NOT-DONE                             VALUE 'N'.   07150025
071600         88  PS-DONE                                 VALUE 'Y'.   07160025
071700     05  PS-SPECIAL-INSTRS-IND           PIC  X(01)  VALUE SPACE. 07170025
071800         88  PS-NO-SPECIAL-INSTRS-FOUND              VALUE 'N'.   07180025
071900         88  PS-MULT-SPECIAL-INSTRS-FOUND            VALUE 'Y'.   07190025
072000     05  PS-DRS-INITIALIZED-SW           PIC  X(01)  VALUE 'N'.   07200025
072100         88  PS-DRS-INITIALIZED                      VALUE 'Y'.   07210025
072200         88  PS-DRS-NOT-INITIALIZED                  VALUE 'N'.   07220025
072300                                                                  07230025
072400 01  PS-PROGRAM-SUBSCRIPTS.                                       07240025
072500     05  PS-DTL-LNE-SUB                  PIC S9(04)  VALUE +0     07250025
072600                                                     COMP SYNC.   07260025
072700     05  PS-PAGE-SUB                     PIC S9(04)  VALUE +0     07270025
072800                                                     COMP SYNC.   07280025
072900                                                                  07290025
073000 01  PV-PROGRAM-VARIABLES.                                        07300025
073100     05  PV-CICS-RESP                    PIC S9(4) VALUE ZERO     07310025
073200                                                COMP SYNC.        07320025
073300     05  PV-UNT-COST-AMT                 PIC S9(4)V999 COMP-3.    07330025
073400     05  PV-UNT-RTL-PR-AMT               PIC S9(6)V99 COMP-3.     07340025
073500     05  PV-OPER-UNT-ID.                                          07350025
073600         10  FILLER                      PIC  X(01).              07360025
073700         10  PV-3-DGT-OPER-UNT-ID        PIC  X(03).              07370025
073800     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZERO   07380025
073900                                                     COMP SYNC.   07390025
074000     05  PV-PAGES-REQ                    PIC  9(01)  VALUE ZEROS. 07400025
074100     05  PV-STR-NBR                      PIC  9(04)  VALUE ZEROS. 07410025
074200     05  PV-EXPTED-ITM-CNT               PIC  9(06)  VALUE ZEROS. 07420025
074300     05  PV-VERIFY-ITM-CNT               PIC  9(06)  VALUE ZEROS. 07430025
074400     05  PV-AP-VERIFY-ITM-CNT            PIC  9(06)  VALUE ZEROS. 07440025
074500     05  PV-SUM-VERIFY-ITM-QTY           PIC S9(09)  VALUE +0     07450025
074600                                                     COMP SYNC.   07460025
074700     05  PV-STARTING-IDX-LOCATION        PIC  9(03)  VALUE ZEROS. 07470025
074800     05  PV-STR-CNT                      PIC  9(04)  VALUE ZEROS. 07480025
074900     05  PV-STORES-GIVEN-PIECES          PIC  9(04)  VALUE ZEROS. 07490025
075000     05  PV-TOT-EXPTED-ITM-CNT           PIC  9(09)  VALUE ZEROS. 07500025
075100     05  PV-TOT-VERIFIED-ITM-CNT         PIC  9(09)  VALUE ZEROS. 07510025
075200     05  PV-TOT-AP-VERFD-ITM-CNT         PIC  9(09)  VALUE ZEROS. 07520025
075300     05  PV-TOT-ITM-RTL                  PIC S9(07)V99            07530025
075400                                                     VALUE ZEROS. 07540025
075500     05  PV-TOT-ITM-CST                  PIC S9(07)V99            07550025
075600                                                     VALUE ZEROS. 07560025
075700     05  PV-TOT-RCVR-ITM-RTL             PIC S9(07)V99            07570025
075800                                                     VALUE ZEROS. 07580025
075900     05  PV-TOT-RCVR-ITM-CST             PIC S9(07)V99            07590025
076000                                                     VALUE ZEROS. 07600025
076100     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  07610025
076200                                                     COMP SYNC.   07620025
076300     05  PV-CURRENT-DATE-X.                                       07630025
076400         10  PV-CURRENT-CENTURY-YEAR     PIC  9(04)  VALUE ZEROS. 07640025
076500         10  FILLER                      PIC  X(01)  VALUE '-'.   07650025
076600         10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 07660025
076700         10  FILLER                      PIC  X(01)  VALUE '-'.   07670025
076800         10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 07680025
076900     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            07690025
077000                                         PIC  X(10).              07700025
077100     05  PV-DISPLAY-ENT-ID               PIC  9(09)  VALUE ZEROS. 07710025
077200     05  PV-DISPLAY-KEYS.                                         07720025
077300         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  07730025
077400                                                BLANK WHEN ZEROS. 07740025
077500         10  FILLER                      PIC  X(02)  VALUE SPACE. 07750025
077600         10  PV-DISPLAY-RCVR-SEQ-NBR     PIC  9(09)  VALUE ZEROS  07760025
077700                                                BLANK WHEN ZEROS. 07770025
077800         10  FILLER                      PIC  X(02)  VALUE SPACE. 07780025
077900         10  PV-DISPLAY-ORD-LNE-NBR      PIC  9(04)  VALUE ZEROS  07790025
078000                                                BLANK WHEN ZEROS. 07800025
078100         10  FILLER                      PIC  X(02)  VALUE SPACE. 07810025
078200         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  07820025
078300                                                BLANK WHEN ZEROS. 07830025
078400         10  FILLER                      PIC  X(02)  VALUE SPACE. 07840025
078500         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  07850025
078600                                                BLANK WHEN ZEROS. 07860025
078700     05  PV-DB2-DATES.                                            07870025
078800         10  PV-DB2-REC-MONTH            PIC S9(09) VALUE +0      07880025
078900                                                    COMP.         07890025
079000         10  PV-DB2-REC-DAY              PIC S9(09) VALUE +0      07900025
079100                                                    COMP.         07910025
079200         10  PV-DB2-REC-YEAR             PIC S9(09) VALUE +0      07920025
079300                                                    COMP.         07930025
079400         10  PV-DB2-VERFYD-MONTH         PIC S9(09) VALUE +0      07940025
079500                                                    COMP.         07950025
079600         10  PV-DB2-VERFYD-DAY           PIC S9(09) VALUE +0      07960025
079700                                                    COMP.         07970025
079800         10  PV-DB2-VERFYD-YEAR          PIC S9(09) VALUE +0      07980025
079900                                                    COMP.         07990025
080000                                                                  08000025
080100 01  ASC-PAYT-TERM-ID-DESC               PIC  X(28).              08010025
080200                                                                  08020025
080300 01  ST-SYSTEM-TIME-DATE-AREA.                                    08030025
080400     05  ST-ABSTIME                      PIC S9(16)  VALUE +0     08040025
080500                                                     COMP SYNC.   08050025
080600     05  ST-SYSTEM-TIME.                                          08060025
080700         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 08070025
080800         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 08080025
080900             15  ST-SYSTEM-HOUR          PIC  X(02).              08090025
081000             15  FILLER                  PIC  X(01).              08100025
081100             15  ST-SYSTEM-MINUTE        PIC  X(02).              08110025
081200             15  FILLER                  PIC  X(01).              08120025
081300             15  ST-SYSTEM-SECOND        PIC  X(02).              08130025
081400     05  SD-SYSTEM-DATE.                                          08140025
081500         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 08150025
081600         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 08160025
081700             15  SD-SYSTEM-MONTH         PIC  X(02).              08170025
081800             15  FILLER                  PIC  X(01).              08180025
081900             15  SD-SYSTEM-DAY           PIC  X(02).              08190025
082000             15  FILLER                  PIC  X(01).              08200025
082100             15  SD-SYSTEM-YEAR          PIC  X(02).              08210025
082200         10  FILLER                      PIC  X(02)  VALUE SPACE. 08220025
082300     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       08230025
082400         10  FILLER                      PIC  X(06).              08240025
082500         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              08250025
082600     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     08260025
082700                                                     COMP.        08270025
082800*                                                                 08280025
082900*  THIS TABLE WILL CONSIST OF ONLY THOSE STORES WHICH HAVE AN     08290025
083000*  EXPECTED ITEM COUNT AND ARE FOUND ON THE STORE TABLE.  IT'S    08300025
083100*  USE IS FOR PRINTING THE STORE DETAIL LINE INFORMATION.         08310025
083200*                                                                 08320025
083300 01  EA-EXPTED-ALLOC-TABLE.                                       08330025
083400     05  EA-ALLOC-ENTRY                  OCCURS 396 TIMES         08340025
083500                                         INDEXED BY EA-ALLOC-IDX. 08350025
083600         10  EA-STR-NBR                  PIC  9(04).              08360025
083700         10  EA-STR-NBR-X  REDEFINES  EA-STR-NBR                  08370025
083800                                         PIC  X(04).              08380025
083900         10  EA-EXPTED-ITM-CNT           PIC  9(06).              08390025
084000         10  EA-VERFD-ITM-CNT            PIC  9(06).              08400025
084100         10  EA-AP-VERFD-ITM-CNT         PIC  9(06).              08410025
084200         10  EA-ITEMS-OPEN-TO-RECEIVE    PIC  X(06).              08420025
084300*                                                                 08430025
084400*  THIS TABLE WILL CONSIST OF ALL PACKSLIPS FOR A RECEIVER        08440025
084500*                                                                 08450025
084600 01  PT-PKSLIP-TABLE.                                             08460025
084700     05  PT-PKSLIP-ENTRY                 OCCURS 231 TIMES         08470025
084800                                         INDEXED BY PT-PKSL-IDX.  08480025
084900         10  PT-PKSL-NBR                 PIC  X(10).              08490025
085000*                                                                 08500025
085100 01  TL1-TOTAL-LINE-1.                                            08510025
085200     05  FILLER                          PIC  X(04)  VALUE SPACE. 08520025
085300     05  FILLER                          PIC  X(26)  VALUE        08530025
085400         'TOTAL STORES GIVEN ALLOCS:'.                            08540025
085500     05  FILLER                          PIC  X(01)  VALUE SPACE. 08550025
085600     05  TL1-TOT-STR-GIVEN               PIC Z,ZZ9   VALUE ZERO.  08560025
085700     05  FILLER                          PIC  X(06)  VALUE SPACE. 08570025
085800     05  FILLER                          PIC  X(26)  VALUE        08580025
085900         'TOTAL EXPECTED ITEM COUNT:'.                            08590025
086000     05  FILLER                          PIC  X(01)  VALUE SPACE. 08600025
086100     05  TL1-TOT-EXPTED-ITM-CNT          PIC Z,ZZZ,ZZ9            08610025
086200                                                     VALUE ZEROS. 08620025
086300     05  FILLER                          PIC  X(19)  VALUE SPACE. 08630025
086400     05  FILLER                          PIC  X(16)  VALUE        08640025
086500         'TOTAL ITEM COST:'.                                      08650025
086600     05  FILLER                          PIC  X(01)  VALUE SPACE. 08660025
086700     05  TL1-TOT-ITM-CST                 PIC $Z,ZZZ,ZZZ.99        08670025
086800                                                     VALUE ZEROS. 08680025
086900     05  FILLER                          PIC  X(05)  VALUE SPACE. 08690025
087000                                                                  08700025
087100 01 TL2-TOTAL-LINE-2.                                             08710025
087200     05  FILLER                          PIC  X(42)  VALUE SPACE. 08720025
087300     05  FILLER                          PIC  X(26)  VALUE        08730025
087400         'TOTAL ACTUAL   ITEM COUNT:'.                            08740025
087500     05  FILLER                          PIC  X(01)  VALUE SPACE. 08750025
087600     05  TL2-TOT-VERIFIED-ITM-CNT        PIC Z,ZZZ,ZZ9            08760025
087700                                                     VALUE ZEROS. 08770025
087800     05  FILLER                          PIC  X(17)  VALUE SPACE. 08780025
087900     05  FILLER                          PIC  X(18)  VALUE        08790025
088000         'TOTAL ITEM RETAIL:'.                                    08800025
088100     05  FILLER                          PIC  X(01)  VALUE SPACE. 08810025
088200     05  TL2-TOT-ITM-RTL                 PIC $Z,ZZZ,ZZZ.99        08820025
088300                                                     VALUE ZEROS. 08830025
088400     05  FILLER                          PIC  X(05)  VALUE SPACE. 08840025
088500                                                                  08850025
088600 01 TL3-TOTAL-LINE-3.                                             08860025
088700     05  FILLER                          PIC  X(39)  VALUE SPACE. 08870025
088800     05  FILLER                          PIC  X(29)  VALUE        08880025
088900         'TOTAL AP VERIFIED ITEM COUNT:'.                         08890025
089000     05  FILLER                          PIC  X(01)  VALUE SPACE. 08900025
089100     05  TL3-TOT-AP-VERFD-ITM-CNT        PIC Z,ZZZ,ZZ9            08910025
089200                                                     VALUE ZEROS. 08920025
089300     05  FILLER                          PIC  X(54)  VALUE SPACE. 08930025
089400                                                                  08940025
089500*                                                                 08950025
089600*  SQL DB2 RECEIPT ITEM DISTRIBUTION CURSOR DECLARATION           08960025
089700*                                                                 08970025
089800     EXEC SQL                                                     08980025
089900          DECLARE RECDIS_CSR CURSOR FOR                           08990025
090000              SELECT  STR_NBR,                                    09000025
090100                      EXPTED_ITM_QTY,                             09010025
090200                      VERIFY_ITM_QTY,                             09020025
090300                      AP_VERIFY_ITM_QTY                           09030025
090400                FROM  TRECDIS                                     09040025
090500               WHERE  (ORD_NBR           =  :DK-ORD-NBR           09050025
090600                 AND   ORD_LNE_NBR       =  :DK-ORD-LNE-NBR       09060025
090700                 AND   REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR)     09070026
090900            ORDER BY  STR_NBR                                     09090025
091000     END-EXEC.                                                    09100025
091100                                                                  09110025
091200                                                                  09120025
091300*                                                                 09130025
091400*  SQL DB2 PACK SLIP NUMBER CURSOR DECLARATION                    09140025
091500*                                                                 09150025
091600     EXEC SQL                                                     09160025
091700          DECLARE PKSL_CSR CURSOR FOR                             09170025
091800              SELECT  DISTINCT                                    09180025
091900                      PKSL_NBR                                    09190025
092000                FROM  TPKSLIP                                     09200025
092100               WHERE  (PO_NBR         =  :DK-ORD-NBR              09210025
092200                 AND   REC_SEQ_NBR    =  :DK-RCVR-SEQ-NBR         09220025
092300                 AND   VER_STAT_CDE   =  'A')                     09230025
092400            ORDER BY  PKSL_NBR                                    09240025
092500     END-EXEC.                                                    09250025
092600                                                                  09260025
092700*                                                                 09270025
092800*  SQL DB2 RECEIVER AMT CURSOR DECLARATION                        09280025
092900*                                                                 09290025
093000     EXEC SQL                                                     09300025
093100          DECLARE RECITM_CSR CURSOR FOR                           09310025
093200              SELECT  A.AP_VERIFY_ITM_QTY,                        09320025
093300                      C.UNT_RTL_PR_AMT,                           09330025
093400                      C.UNT_COST_AMT                              09340025
093500                FROM  TRECDIS A,                                  09350025
093600                      TRECITM B,                                  09360025
093700                      TPURITM C                                   09370025
093800               WHERE  A.ORD_NBR        =  :DK-ORD-NBR             09380025
093900                 AND  A.ORD_NBR        =  B.ORD_NBR               09390025
094000                 AND  B.ORD_NBR        =  C.PO_NBR                09400025
094100                 AND  A.ORD_LNE_NBR    =  B.ORD_LNE_NBR           09410025
094200                 AND  B.ORD_LNE_NBR    =  C.APP_PO_LNE_NBR        09420025
094300                 AND  A.REC_SEQ_NBR    =  :DK-RCVR-SEQ-NBR        09430025
094400                 AND  A.REC_SEQ_NBR    =  B.REC_SEQ_NBR           09440025
094500                 AND  A.OPER_UNT_ID    =  :DK-OPER-UNT-ID         09450025
094600                 AND  A.OPER_UNT_ID    =  B.OPER_UNT_ID           09460025
094700                 AND  A.FCLTY_ID       =  :DK-FCLTY-ID            09470025
094800                 AND  A.FCLTY_ID       =  B.FCLTY_ID              09480025
094900                 AND  B.VER_STATUS_CDE =  'A'                     09490026
095100                 AND  B.PO_VER_NBR     =  C.VER_NBR               09510025
095200     END-EXEC.                                                    09520025
095300                                                                  09530025
095400     COPY DPWS276.                                                09540025
095500******************************************************************09550025
095600 LINKAGE SECTION.                                                 09560025
095700******************************************************************09570025
095800 01  DFHCOMMAREA                   PIC X(43).                     09580025
095900/                                                                 09590025
096000******************************************************************09600025
096100 PROCEDURE DIVISION.                                              09610025
096200******************************************************************09620025
096300 0000-PROGRAM-MAINLINE.                                           09630025
096400                                                                  09640025
096500     PERFORM 1000-INITIALIZE.                                     09650025
096600     PERFORM 2000-BUILD-RPT-DATA.                                 09660025
096700                                                                  09670025
096800*    IF THE PRINTER HAS AUTO CUTTING, SEND THE CUT COMMAND        09680025
096900     IF  CA-PRTR-AUTO-CUTTER-IND = 'Y'                            09690025
097000         MOVE PC-PUT                 TO DRS01-DRRB-FUNC           09700025
097100         MOVE DS004-PLC-CUT-FORM     TO DRS01-COMM-DATA           09710025
097200         MOVE SPACES                 TO DRS01-COMM-CTL            09720025
097300         PERFORM 8000-LINK-TO-DRS                                 09730025
097400     END-IF.                                                      09740025
097500                                                                  09750025
097600     MOVE PC-TERM                TO DRS01-DRRB-FUNC.              09760025
097700     PERFORM 8000-LINK-TO-DRS.                                    09770025
097800                                                                  09780025
097900     GOBACK.                                                      09790025
098000                                                                  09800025
098100 1000-INITIALIZE.                                                 09810025
098200                                                                  09820025
098300     PERFORM 1010-RETRIEVE-STORED-DATA.                           09830025
098400                                                                  09840025
098500     MOVE CA-ORD-NBR             TO DK-ORD-NBR.                   09850025
098600     MOVE CA-RCVR-SEQ-NBR        TO DK-RCVR-SEQ-NBR.              09860025
098700     MOVE CA-ORD-LNE-NBR         TO DK-ORD-LNE-NBR.               09870025
098800     MOVE CA-OPER-UNT-ID         TO PV-OPER-UNT-ID.               09880025
098900     MOVE PV-3-DGT-OPER-UNT-ID   TO DK-OPER-UNT-ID.               09890025
099000     MOVE CA-FCLTY-ID            TO DK-FCLTY-ID.                  09900025
099100                                                                  09910025
099200     PERFORM 8100-FORMAT-TIME.                                    09920025
099300                                                                  09930025
099400     SET EA-ALLOC-IDX            TO 1.                            09940025
099500                                                                  09950025
099600     INITIALIZE EA-EXPTED-ALLOC-TABLE                             09960025
099700                PT-PKSLIP-TABLE.                                  09970025
099800                                                                  09980025
099900     IF CA-DESTINATION = 'XXXXXXXX'                               09990025
100000         MOVE 'R'                TO DRS02-DRIB-CLASS              10000025
100100         MOVE 'N'                TO DRS02-DRIB-HOLD               10010025
100200         MOVE 'LOCAL'            TO DRS02-DRIB-DEST               10020025
100300     ELSE                                                         10030025
100400         MOVE 'A'                TO DRS02-DRIB-CLASS              10040025
100500         MOVE 'N'                TO DRS02-DRIB-HOLD               10050025
100600         MOVE CA-DESTINATION     TO DRS02-DRIB-DEST               10060025
100700     END-IF.                                                      10070025
100800                                                                  10080025
100900     MOVE PC-INIT            TO DRS01-DRRB-FUNC.                  10090025
101000     MOVE DRS02-DRIB-HEADER  TO DRS01-COMM-DRIB-HDR.              10100025
101100     MOVE DRS02-DRIB-ATTRIB  TO DRS01-COMM-DRIB-AT1.              10110025
101200     PERFORM 8000-LINK-TO-DRS.                                    10120025
101300                                                                  10130025
101400     SET PS-DRS-INITIALIZED TO TRUE.                              10140025
101500                                                                  10150025
101600     IF CA-PRTR-PRTR-CNTL-IND = 'P'                               10160025
101700         PERFORM 1100-LOAD-FORM-TO-DRS                            10170025
101800     END-IF.                                                      10180025
101900     MOVE PC-PUT             TO  DRS01-DRRB-FUNC.                 10190025
102000                                                                  10200025
102100 1010-RETRIEVE-STORED-DATA.                                       10210025
102200                                                                  10220025
102300     EXEC CICS                                                    10230025
102400         RETRIEVE                                                 10240025
102500             INTO  (CA-COMMAREA)                                  10250025
102600             RESP  (PV-CICS-RESPONSE)                             10260025
102700     END-EXEC.                                                    10270025
102800                                                                  10280025
102900     EVALUATE TRUE                                                10290025
103000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10300025
103100             CONTINUE                                             10310025
103200         WHEN OTHER                                               10320025
103300             MOVE '1010-RETRIEVE-STORED-DATA'                     10330025
103400                                 TO DP013-PARAGRAPH               10340025
103500             MOVE 'UNABLE TO RETRIEVE DATA'                       10350025
103600                                 TO DP013-MESSAGE-TEXT (1)        10360025
103700             SET DP013-CICS-ABEND                                 10370025
103800                 DP013-NO-ROLLBACK                                10380025
103900                                 TO TRUE                          10390025
104000             PERFORM 9999-WRITE-CICS-LOG-MSG                      10400025
104100     END-EVALUATE.                                                10410025
104200                                                                  10420025
104300                                                                  10430025
104400***************************************************************   10440025
104500**  1100-LOAD-FORM-TO-DRS. -- CALL THE PRINT-PACKAGE PRINTER **   10450025
104600**  CONTROL MODULE TO GET THE FORM FOR SEND TO THE PRINTER.  **   10460025
104700**  THIS PARAGRAPH IS EXECUTED ONLY IF THE PRINTER ACCEPTS   **   10470025
104800**  PRINTER CONTROL COMMANDS                                 **   10480025
104900***************************************************************   10490025
105000 1100-LOAD-FORM-TO-DRS.                                           10500025
105100     INITIALIZE DP072-COMM-AREA.                                  10510025
105200     MOVE CA-DESTINATION             TO DP072-PRINTER-ID.         10520025
105300     MOVE PC-CURRENT-PROGRAM-NAME    TO DP072-RPT-PGM-NME.        10530025
105400     MOVE '01'                       TO DP072-RPT-PGM-TYP-ID.     10540025
105500     SET DP072-SELECT TO TRUE.                                    10550025
105600                                                                  10560025
105700     PERFORM 1101-LINK-DPKCS060.                                  10570025
105800                                                                  10580025
105900     MOVE DP072-PRTR-TRACK-NBR       TO DS004-PLC-LF-FORM-NBR.    10590025
106000     MOVE DS004-PES-8LPI             TO DS004-PLC-LF-LPI.         10600025
106100     MOVE PC-PUT                     TO DRS01-DRRB-FUNC.          10610025
106200     MOVE DS004-PLC-LOAD-FORM        TO DRS01-COMM-DATA.          10620025
106300     PERFORM 8000-LINK-TO-DRS.                                    10630025
106400                                                                  10640025
106500 1101-LINK-DPKCS060.                                              10650025
106600***************************************************************   10660025
106700**  1101-LINK-DPKCS060 -- LINK TO THE PRINT-PACKAGE  PRINTER **   10670025
106800**  CONTROL MODULE (DPKCS060)                                **   10680025
106900***************************************************************   10690025
107000     EXEC CICS                                                    10700025
107100         LINK PROGRAM  (PC-DPKCS060)                              10710025
107200              COMMAREA (DP072-COMM-AREA)                          10720025
107300              RESP     (PV-CICS-RESPONSE)                         10730025
107400     END-EXEC.                                                    10740025
107500                                                                  10750025
107600     EVALUATE TRUE                                                10760025
107700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10770025
107800             CONTINUE                                             10780025
107900         WHEN OTHER                                               10790025
108000               MOVE '1101-LINK-DPKCS060'                          10800025
108100                                    TO DP013-PARAGRAPH            10810025
108200               MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT (1)    10820025
108300               MOVE SQLCA           TO DP013-SQLCA                10830025
108400               SET DP013-CICS-ABEND                               10840025
108500                   DP013-NO-ROLLBACK TO TRUE                      10850025
108600               PERFORM 9999-WRITE-CICS-LOG-MSG                    10860025
108700     END-EVALUATE.                                                10870025
108800                                                                  10880025
108900******************************************************************10890025
109000*  THIS MODULE CONTROLS THE GATHERING OF DATA THAT WILL APPEAR    10900025
109100*  ON THE WORK ORDER DISTRIBUTION SHEET.                          10910025
109200******************************************************************10920025
109300 2000-BUILD-RPT-DATA.                                             10930025
109400                                                                  10940025
109500     MOVE CA-OPER-UNT-ID         TO HL2-OPERATING-ID.             10950025
109600     MOVE CA-FCLTY-ID            TO HL3-FACILITY-ID.              10960025
109700                                                                  10970025
109800     PERFORM 7500-SELECT-PO-HDR-DATA.                             10980025
109900     PERFORM 8500-GET-VENDOR-NUMBER.                              10990025
110000                                                                  11000025
110100     MOVE EXTENT-DUN-NBR         TO HL2-VENDOR-NBR.               11010025
110200     MOVE PURITM-SKU-DESC        TO HL7-PO-LNE-ITM-DESC.          11020025
110300     MOVE PURITM-SIZE-DESC       TO HL9-PO-SIZE-DESC.             11030025
110400     MOVE PURITM-UNT-COST-AMT    TO HL10-COST.                    11040025
110500     MOVE PURITM-COLOR-DESC      TO HL11-PO-COLOR-DESC.           11050025
110600     MOVE PURITM-UNT-RTL-PR-AMT  TO HL11-UNT-RTL-PR-AMT.          11060025
110700                                                                  11070025
110800     PERFORM 7950-GET-KEYREC-NBR.                                 11080025
110900                                                                  11090025
111000     MOVE RECEIV-RCVR-NBR        TO HL4-KEYREC.                   11100025
111100     MOVE RECEIV-ACTL-CART-CNT   TO HL4-TOT-CARTON-CNT.           11110025
111200                                                                  11120025
111300     PERFORM 7700-GET-PRIMARY-VNDR-NME.                           11130025
111400     MOVE CA-DESTINATION         TO HL2-PRINTER-DEST.             11140025
111500     MOVE ENTNME-ENT-NAME-DESC   TO HL3-VNDR-NME.                 11150025
111600                                                                  11160025
111700     PERFORM 7100-SELECT-SKU-INFO.                                11170025
111800     MOVE PURCHS-DEPT-NBR        TO HL5-DEPT-NBR.                 11180025
111900     MOVE XL001-SUB-CL-NBR-2CH   TO HL5-CLASS-NBR.                11190025
112000     MOVE XL001-SKU-NBR          TO HL5-SEQ-NBR.                  11200025
112100     MOVE CA-ORD-NBR-X           TO HL6-PO-NBR.                   11210025
112200     MOVE XL001-VS-NBR           TO HL6-VNDR-STYLE-NME.           11220025
112300     MOVE PV-DB2-REC-MONTH       TO HL6-RCVD-MONTH.               11230025
112400     MOVE PV-DB2-REC-DAY         TO HL6-RCVD-DAY.                 11240025
112500     MOVE PV-DB2-REC-YEAR        TO HL6-RCVD-YEAR.                11250025
112600     MOVE PC-SLASH               TO HL6-SLASH-ONE                 11260025
112700                                    HL6-SLASH-TWO.                11270025
112800     IF HL6-DATE-RCVD = PC-DB2-DEFAULT-DATE                       11280025
112900         MOVE SPACES             TO HL6-DATE-RCVD                 11290025
113000     END-IF.                                                      11300025
113100                                                                  11310025
113200     MOVE CA-RCVR-SEQ-NBR-X      TO HL7-RCVR-SEQ-NBR.             11320025
113300     MOVE PV-DB2-VERFYD-MONTH    TO HL7-VRFD-MONTH.               11330025
113400     MOVE PV-DB2-VERFYD-DAY      TO HL7-VRFD-DAY.                 11340025
113500     MOVE PV-DB2-VERFYD-YEAR     TO HL7-VRFD-YEAR.                11350025
113600     MOVE PC-SLASH               TO HL7-SLASH-ONE                 11360025
113700                                    HL7-SLASH-TWO.                11370025
113800     IF HL7-DATE-VRFD = PC-DB2-DEFAULT-DATE                       11380025
113900         MOVE SPACES             TO HL7-DATE-VRFD                 11390025
114000     END-IF.                                                      11400025
114100                                                                  11410025
114200     MOVE CA-ORD-LNE-NBR-X       TO HL8-LINE-NBR.                 11420025
114300     MOVE XL001-SKU-DESC         TO HL8-SKU-ITM-DESC.             11430025
114400     MOVE XL001-SIZE-DESC        TO HL10-SKU-SIZE-DESC.           11440025
114500     MOVE 'EA'                   TO HL12-UM.                      11450025
114600     MOVE XL001-SHRT-CLOR-DESC   TO HL12-SKU-COLOR-DESC.          11460025
114700                                                                  11470025
114800     PERFORM 8550-GET-VENDOR-INHOUSE-NBR.                         11480025
114900                                                                  11490025
115000     MOVE VNDDPT-INHOUSE-NBR     TO HL4-VNDR-INHSE.               11500025
115100                                                                  11510025
115200     PERFORM 7900-GET-INVOICE-NBR.                                11520025
115300     MOVE RECITM-PKSL-NBR        TO HL9-INVOICE-NBR.              11530025
115400                                                                  11540025
115500     PERFORM 8200-GET-DEFAULT-PAYMENT-TERM.                       11550025
115600                                                                  11560025
115700     IF  SQLCODE = +0                                             11570025
115800         PERFORM 8300-FORMAT-PAYMENT-TERM-DESC                    11580025
115900                                                                  11590025
116000         MOVE ASC-PAYT-TERM-ID-DESC                               11600025
116100                                 TO HL13-PAYMENT-TERM             11610025
116200     END-IF.                                                      11620025
116300                                                                  11630025
116400     PERFORM 8400-GET-PAY-CODE.                                   11640025
116500                                                                  11650025
116600     MOVE PLNSHP-FRGT-PAYT-CDE   TO HL13-PAY-CDE.                 11660025
116700                                                                  11670025
116800     PERFORM 7800-GET-SPECIAL-INSTRS.                             11680025
116900                                                                  11690025
117000     IF  PS-MULT-SPECIAL-INSTRS-FOUND                             11700025
117100         MOVE PC-MULT-SPECIAL-INSTRS-MSG                          11710025
117200                                 TO HL14-SPECIAL-INSTR            11720025
117300     ELSE                                                         11730025
117400         IF  PS-NO-SPECIAL-INSTRS-FOUND                           11740025
117500             CONTINUE                                             11750025
117600         ELSE                                                     11760025
117700             MOVE INSTCD-INSTR-DESC                               11770025
117800                                 TO HL14-SPECIAL-INSTR            11780025
117900         END-IF                                                   11790025
118000     END-IF.                                                      11800025
118100                                                                  11810025
118200     PERFORM 2500-GET-RECDIS-DATA.                                11820025
118300                                                                  11830025
118400     IF CA-CNTL-APRON-HEADER                                      11840025
118500         PERFORM 2400-GET-PKSLIP-DATA                             11850025
118600         PERFORM 4000-PRODUCE-HEADER                              11860025
118700     END-IF.                                                      11870025
118800                                                                  11880025
118900     COMPUTE PV-PAGES-REQ =                                       11890025
119000         (((PV-STR-CNT - 1) / PC-MAX-STRS-PER-PAGE) + 1).         11900025
119100                                                                  11910025
119200     PERFORM 4100-PRODUCE-RPT                                     11920025
119300         VARYING PS-PAGE-SUB                                      11930025
119400         FROM 1 BY 1                                              11940025
119500         UNTIL PS-PAGE-SUB > PV-PAGES-REQ.                        11950025
119600                                                                  11960025
119700******************************************************************11970025
119800*  THIS MODULE RETRIEVES THE PACK SLIP NUMBER FROM THE PACK SLIP  11980025
119900*  TABLE FOR THE RECEIVER REQUESTED.                              11990025
120000******************************************************************12000025
120100 2400-GET-PKSLIP-DATA.                                            12010025
120200                                                                  12020025
120300     SET PT-PKSL-IDX             TO +1.                           12030025
120400     PERFORM 2410-OPEN-PKSL-CSR.                                  12040025
120500     PERFORM 7300-FETCH-PKSL-CSR.                                 12050025
120600                                                                  12060025
120700     PERFORM 2420-BUILD-PKSL-DATA                                 12070025
120800         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        12080025
120900                                                                  12090025
121000     PERFORM 2430-CLOSE-PKSL-CSR.                                 12100025
121100                                                                  12110025
121200 2410-OPEN-PKSL-CSR.                                              12120025
121300                                                                  12130025
121400     EXEC SQL                                                     12140025
121500         OPEN PKSL_CSR                                            12150025
121600     END-EXEC.                                                    12160025
121700                                                                  12170025
121800     EVALUATE TRUE                                                12180025
121900         WHEN SQLCODE = ZERO                                      12190025
122000             CONTINUE                                             12200025
122100                                                                  12210025
122200         WHEN SQLWARN0 NOT = SPACE                                12220025
122300         WHEN SQLCODE < ZERO                                      12230025
122400         WHEN SQLCODE > ZERO                                      12240025
122500             MOVE '2410-OPEN-PKSL-CSR'                            12250025
122600                                 TO DP013-PARAGRAPH               12260025
122700             MOVE 'OPEN THE PKSL_CSR'                             12270025
122800                                 TO DP013-MESSAGE-TEXT (1)        12280025
122900             MOVE SQLCA          TO DP013-SQLCA                   12290025
123000             MOVE 'TPKSLIP'      TO DP013-DB2-TABLE-NAME (1)      12300025
123100             SET DP013-NO-ROLLBACK                                12310025
123200                 DP013-DB2-ABEND TO TRUE                          12320025
123300             PERFORM 9999-WRITE-CICS-LOG-MSG                      12330025
123400     END-EVALUATE.                                                12340025
123500                                                                  12350025
123600******************************************************************12360025
123700*  STORE THE PACK SLIP NUMBER IN THE TABLE                        12370025
123800******************************************************************12380025
123900 2420-BUILD-PKSL-DATA.                                            12390025
124000                                                                  12400025
124100     MOVE PKSLIP-PKSL-NBR        TO PT-PKSL-NBR (PT-PKSL-IDX).    12410025
124200                                                                  12420025
124300     SET PT-PKSL-IDX UP BY +1.                                    12430025
124400                                                                  12440025
124500     PERFORM 7300-FETCH-PKSL-CSR.                                 12450025
124600                                                                  12460025
124700 2430-CLOSE-PKSL-CSR.                                             12470025
124800                                                                  12480025
124900     EXEC SQL                                                     12490025
125000         CLOSE PKSL_CSR                                           12500025
125100     END-EXEC.                                                    12510025
125200                                                                  12520025
125300     EVALUATE TRUE                                                12530025
125400         WHEN SQLCODE = ZERO                                      12540025
125500             CONTINUE                                             12550025
125600                                                                  12560025
125700         WHEN SQLWARN0 NOT = SPACE                                12570025
125800         WHEN SQLCODE < ZERO                                      12580025
125900         WHEN SQLCODE > ZERO                                      12590025
126000             MOVE '2430-CLOSE-PKSL-CSR'                           12600025
126100                                 TO DP013-PARAGRAPH               12610025
126200             MOVE 'CLOSE THE PKSL_CSR'                            12620025
126300                                 TO DP013-MESSAGE-TEXT (1)        12630025
126400             MOVE SQLCA          TO DP013-SQLCA                   12640025
126500             MOVE 'TPKSLIP'      TO DP013-DB2-TABLE-NAME (1)      12650025
126600             SET DP013-NO-ROLLBACK                                12660025
126700                 DP013-DB2-ABEND TO TRUE                          12670025
126800             PERFORM 9999-WRITE-CICS-LOG-MSG                      12680025
126900     END-EVALUATE.                                                12690025
127000                                                                  12700025
127100******************************************************************12710025
127200*  THIS MODULE RETRIEVES DATA FROM THE RECEIPT ITEM DISTRIBUTION  12720025
127300*  TABLE.  THE RECEIPT ITEM DISTRIBUTION TABLE IS ACCESSED WHEN   12730025
127400*  THE WORK ORDER DISTRIBUTION INDICATOR IS EQUAL TO A 'N'.       12740025
127500******************************************************************12750025
127600 2500-GET-RECDIS-DATA.                                            12760025
127700                                                                  12770025
127800     PERFORM 2510-OPEN-RECDIS-CSR.                                12780025
127900     PERFORM 7400-FETCH-RECDIS-CSR.                               12790025
128000                                                                  12800025
128100     PERFORM 4200-CALC-OPEN-TO-REC                                12810025
128200                                                                  12820025
128300                                                                  12830025
128400     PERFORM 2520-SEND-REC-ITM-DISTRO-RECS                        12840025
128500         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        12850025
128600                                                                  12860025
128700     PERFORM 2530-CLOSE-RECDIS-CSR.                               12870025
128800                                                                  12880025
128900 2510-OPEN-RECDIS-CSR.                                            12890025
129000                                                                  12900025
129100     EXEC SQL                                                     12910025
129200         OPEN RECDIS_CSR                                          12920025
129300     END-EXEC.                                                    12930025
129400                                                                  12940025
129500     EVALUATE TRUE                                                12950025
129600         WHEN SQLCODE = ZERO                                      12960025
129700             CONTINUE                                             12970025
129800                                                                  12980025
129900         WHEN SQLWARN0 NOT = SPACE                                12990025
130000         WHEN SQLCODE < ZERO                                      13000025
130100         WHEN SQLCODE > ZERO                                      13010025
130200             MOVE '2510-OPEN-RECDIS-CSR'                          13020025
130300                                 TO DP013-PARAGRAPH               13030025
130400             MOVE 'OPEN THE RECDIS_CSR'                           13040025
130500                                 TO DP013-MESSAGE-TEXT (1)        13050025
130600             MOVE SQLCA          TO DP013-SQLCA                   13060025
130700             MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)      13070025
130800             SET DP013-NO-ROLLBACK                                13080025
130900                 DP013-DB2-ABEND TO TRUE                          13090025
131000             PERFORM 9999-WRITE-CICS-LOG-MSG                      13100025
131100     END-EVALUATE.                                                13110025
131200                                                                  13120025
131300******************************************************************13130025
131400*  PLACE THE EXPECTED ITEM COUNT AND OPEN TO RECEIVE AMOUNT WITH  13140025
131500*  THE APPROPRIATE STORE.                                         13150025
131600******************************************************************13160025
131700 2520-SEND-REC-ITM-DISTRO-RECS.                                   13170025
131800                                                                  13180025
131900     MOVE RECDIS-STR-NBR         TO PV-STR-NBR.                   13190025
132000     MOVE RECDIS-EXPTED-ITM-QTY  TO PV-EXPTED-ITM-CNT.            13200025
132100     MOVE RECDIS-VERIFY-ITM-QTY  TO PV-VERIFY-ITM-CNT.            13210025
132200     MOVE RECDIS-AP-VERIFY-ITM-QTY                                13220025
132300                                 TO PV-AP-VERIFY-ITM-CNT.         13230025
132400                                                                  13240025
132500     PERFORM 3000-FILL-PRINT-TBL.                                 13250025
132600     PERFORM 7400-FETCH-RECDIS-CSR.                               13260025
132700                                                                  13270025
132800 2530-CLOSE-RECDIS-CSR.                                           13280025
132900                                                                  13290025
133000     EXEC SQL                                                     13300025
133100         CLOSE RECDIS_CSR                                         13310025
133200     END-EXEC.                                                    13320025
133300                                                                  13330025
133400     EVALUATE TRUE                                                13340025
133500         WHEN SQLCODE = ZERO                                      13350025
133600             CONTINUE                                             13360025
133700                                                                  13370025
133800         WHEN SQLWARN0 NOT = SPACE                                13380025
133900         WHEN SQLCODE < ZERO                                      13390025
134000         WHEN SQLCODE > ZERO                                      13400025
134100             MOVE '2530-CLOSE-RECDIS-CSR'                         13410025
134200                                 TO DP013-PARAGRAPH               13420025
134300             MOVE 'CLOSE THE RECDIS_CSR'                          13430025
134400                                 TO DP013-MESSAGE-TEXT (1)        13440025
134500             MOVE SQLCA          TO DP013-SQLCA                   13450025
134600             MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)      13460025
134700             SET DP013-NO-ROLLBACK                                13470025
134800                 DP013-DB2-ABEND TO TRUE                          13480025
134900             PERFORM 9999-WRITE-CICS-LOG-MSG                      13490025
135000     END-EVALUATE.                                                13500025
135100                                                                  13510025
135200 4200-CALC-OPEN-TO-REC.                                           13520025
135300                                                                  13530025
135400     SET DP276-STORE-LEVEL-OTR                                    13540025
135500         DP276-PO-OTR            TO TRUE                          13550025
135600                                                                  13560025
135700                                                                  13570025
135800     INITIALIZE DP276-KEYS                                        13580025
135900     MOVE DK-ORD-NBR             TO DP276-PO-NBR                  13590025
136000     MOVE PURITM-PO-LNE-NBR      TO DP276-PO-LNE-NBR              13600025
136100     MOVE CA-RCVR-SEQ-NBR        TO DP276-REC-SEQ-NBR             13610025
136200     MOVE CA-OPER-UNT-ID         TO DP276-OPER-UNT-ID             13620025
136300     MOVE CA-FCLTY-ID            TO DP276-FCLTY-ID                13630025
136400     COPY DPPD276.                                                13640025
136500                                                                  13650025
136600******************************************************************13660025
136700*  MOVE THE NECESSARY FIELDS TO THE WORKING STORAGE TABLE USED    13670025
136800*  FOR PRINTING THE REPORT.                                       13680025
136900******************************************************************13690025
137000 3000-FILL-PRINT-TBL.                                             13700025
137100                                                                  13710025
137200     MOVE PV-STR-NBR             TO EA-STR-NBR (EA-ALLOC-IDX)     13720025
137300                                                                  13730025
137400     MOVE PV-EXPTED-ITM-CNT      TO EA-EXPTED-ITM-CNT             13740025
137500                                   (EA-ALLOC-IDX).                13750025
137600                                                                  13760025
137700     MOVE PV-VERIFY-ITM-CNT      TO EA-VERFD-ITM-CNT              13770025
137800                                   (EA-ALLOC-IDX).                13780025
137900                                                                  13790025
138000     MOVE PV-AP-VERIFY-ITM-CNT   TO EA-AP-VERFD-ITM-CNT           13800025
138100                                   (EA-ALLOC-IDX).                13810025
138200     ADD 1                       TO PV-STORES-GIVEN-PIECES.       13820025
138300                                                                  13830025
138400******************************************************************13840025
138500*  COMPUTES THE OPEN TO RECEIVE AMOUNT FOR THE GIVEN STORE.       13850025
138600******************************************************************13860025
138700                                                                  13870025
138800     MOVE PV-STR-NBR             TO DP276-SEARCH-NBR              13880025
138900     PERFORM 4210-SEARCH-OTR                                      13890025
139000     MOVE DP276-OTR-OUT-X        TO  EA-ITEMS-OPEN-TO-RECEIVE     13900025
139100                                      (EA-ALLOC-IDX)              13910025
139200                                                                  13920025
139300     SET EA-ALLOC-IDX UP BY +1.                                   13930025
139400                                                                  13940025
139500******************************************************************13950025
139600*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS TO      13960025
139700*  PRODUCE THE HEADER PAGE OF THE REPORT.                         13970025
139800******************************************************************13980025
139900 4000-PRODUCE-HEADER.                                             13990025
140000                                                                  14000025
140100     MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              14010025
140200                                                                  14020025
140300     MOVE SD-SYSTEM-MONTH        TO HL1-RUN-MONTH.                14030025
140400     MOVE SD-SYSTEM-DAY          TO HL1-RUN-DAY.                  14040025
140500     MOVE SD-SYSTEM-YEAR         TO HL1-RUN-YEAR.                 14050025
140600     MOVE ST-SYSTEM-HOUR         TO HL1-RUN-HOUR.                 14060025
140700     MOVE ST-SYSTEM-MINUTE       TO HL1-RUN-MINUTE.               14070025
140800                                                                  14080025
140900     MOVE PC-CONTROL-APRON-RPT-HDR                                14090025
141000                                 TO HL1-RPT-HDR.                  14100025
141100     MOVE PC-CURRENT-PROGRAM-NAME TO HL1-PROGRAM-NAME.            14110025
141200     MOVE 1                      TO HL1-RPT-NBR                   14120025
141300                                    HL1-PGE-NBR                   14130025
141400                                    HL1-OF-PGE-NBR                14140025
141500     MOVE HL1-HEADING-LINE-1     TO DRS01-COMM-DATA.              14150025
141600     MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               14160025
141700     PERFORM 8000-LINK-TO-DRS.                                    14170025
141800                                                                  14180025
141900     MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              14190025
142000     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               14200025
142100     PERFORM 8000-LINK-TO-DRS.                                    14210025
142200                                                                  14220025
142300     MOVE CA-DESTINATION         TO HL2-PRINTER-DEST.             14230025
142400     MOVE CA-PREPARER-USER-ID    TO HL3-PREPARER-USER-ID.         14240025
142500     MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              14250025
142600     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               14260025
142700     PERFORM 8000-LINK-TO-DRS.                                    14270025
142800                                                                  14280025
142900     MOVE RECEIV-ACTL-CART-CNT   TO HL4-TOT-CARTON-CNT.           14290025
143000     MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              14300025
143100     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               14310025
143200     PERFORM 8000-LINK-TO-DRS.                                    14320025
143300                                                                  14330025
143400     PERFORM 4200-OPEN-RECITM-CSR.                                14340025
143500     PERFORM 7200-FETCH-RECITM-CSR.                               14350025
143600     PERFORM 4210-CALC-RCVR-AMTS                                  14360025
143700         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        14370025
143800     PERFORM 4230-CLOSE-RECITM-CSR.                               14380025
143900                                                                  14390025
144000     MOVE PV-SUM-VERIFY-ITM-QTY  TO HL17-TOT-VERFD-QTY.           14400025
144100     MOVE HL17-HEADING-LINE-17   TO DRS01-COMM-DATA.              14410025
144200     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               14420025
144300     PERFORM 8000-LINK-TO-DRS.                                    14430025
144400                                                                  14440025
144500     MOVE CA-ORD-NBR-X           TO HL15-PO-NBR.                  14450025
144600     MOVE PV-TOT-RCVR-ITM-CST    TO HL15-TOT-RCVR-COST.           14460025
144700     MOVE PV-DB2-REC-MONTH       TO HL15-RCVD-MONTH.              14470025
144800     MOVE PV-DB2-REC-DAY         TO HL15-RCVD-DAY.                14480025
144900     MOVE PV-DB2-REC-YEAR        TO HL15-RCVD-YEAR.               14490025
145000     MOVE PC-SLASH               TO HL15-SLASH-ONE                14500025
145100                                    HL15-SLASH-TWO.               14510025
145200     IF HL15-DATE-RCVD = PC-DB2-DEFAULT-DATE                      14520025
145300         MOVE SPACES             TO HL15-DATE-RCVD                14530025
145400     END-IF.                                                      14540025
145500                                                                  14550025
145600     MOVE HL15-HEADING-LINE-15   TO DRS01-COMM-DATA.              14560025
145700     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               14570025
145800     PERFORM 8000-LINK-TO-DRS.                                    14580025
145900                                                                  14590025
146000     MOVE CA-RCVR-SEQ-NBR-X      TO HL16-RCVR-SEQ-NBR.            14600025
146100     MOVE PV-TOT-RCVR-ITM-RTL    TO HL16-TOT-RCVR-RETAIL.         14610025
146200     MOVE PV-DB2-VERFYD-MONTH    TO HL16-VRFD-MONTH.              14620025
146300     MOVE PV-DB2-VERFYD-DAY      TO HL16-VRFD-DAY.                14630025
146400     MOVE PV-DB2-VERFYD-YEAR     TO HL16-VRFD-YEAR.               14640025
146500     MOVE PC-SLASH               TO HL16-SLASH-ONE                14650025
146600                                    HL16-SLASH-TWO.               14660025
146700     IF HL16-DATE-VRFD = PC-DB2-DEFAULT-DATE                      14670025
146800         MOVE SPACES             TO HL16-DATE-VRFD                14680025
146900     END-IF.                                                      14690025
147000                                                                  14700025
147100     MOVE HL16-HEADING-LINE-16   TO DRS01-COMM-DATA.              14710025
147200     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               14720025
147300     PERFORM 8000-LINK-TO-DRS.                                    14730025
147400                                                                  14740025
147500     MOVE DH3-DETAIL-HEADING-LINE-3                               14750025
147600                                 TO DRS01-COMM-DATA.              14760025
147700     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               14770025
147800     PERFORM 8000-LINK-TO-DRS.                                    14780025
147900                                                                  14790025
148000     PERFORM 4010-PRINT-HDR-DTL-LNE                               14800025
148100         VARYING PS-DTL-LNE-SUB                                   14810025
148200         FROM 1 BY 1                                              14820025
148300         UNTIL PS-DTL-LNE-SUB > PC-ROWS-PER-PAGE.                 14830025
148400                                                                  14840025
148500******************************************************************14850025
148600*  THIS MODULE CONTROLS THE PRINTING OF THE HEADER DETAIL LINES.  14860025
148700******************************************************************14870025
148800 4010-PRINT-HDR-DTL-LNE.                                          14880025
148900                                                                  14890025
149000     SET PT-PKSL-IDX             TO PS-DTL-LNE-SUB.               14900025
149100                                                                  14910025
149200     PERFORM 4011-FILL-HDR-DTL-LNE                                14920025
149300        VARYING DL2-DTL-LNE-IDX                                   14930025
149400        FROM 1 BY 1                                               14940025
149500        UNTIL DL2-DTL-LNE-IDX > PC-HDR-COLS-PER-PAGE.             14950025
149600                                                                  14960025
149700     MOVE DL2-DETAIL-LINE-2      TO DRS01-COMM-DATA.              14970025
149800     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               14980025
149900     PERFORM 8000-LINK-TO-DRS.                                    14990025
150000                                                                  15000025
150100 4011-FILL-HDR-DTL-LNE.                                           15010025
150200                                                                  15020025
150300     MOVE SPACES                 TO DL2-DTL-LNE-AREA              15030025
150400                                   (DL2-DTL-LNE-IDX).             15040025
150500                                                                  15050025
150600     IF PT-PKSL-NBR (PT-PKSL-IDX) = SPACES                        15060025
150700         CONTINUE                                                 15070025
150800     ELSE                                                         15080025
150900         MOVE PT-PKSL-NBR (PT-PKSL-IDX)                           15090025
151000                                 TO DL2-PKSL-NBR (DL2-DTL-LNE-IDX)15100025
151100     END-IF.                                                      15110025
151200                                                                  15120025
151300     SET PT-PKSL-IDX UP BY PC-ROWS-PER-PAGE.                      15130025
151400                                                                  15140025
151500******************************************************************15150025
151600*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        15160025
151700******************************************************************15170025
151800 4100-PRODUCE-RPT.                                                15180025
151900                                                                  15190025
152000     MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              15200025
152100                                                                  15210025
152200     MOVE SD-SYSTEM-MONTH        TO HL1-RUN-MONTH.                15220025
152300     MOVE SD-SYSTEM-DAY          TO HL1-RUN-DAY.                  15230025
152400     MOVE SD-SYSTEM-YEAR         TO HL1-RUN-YEAR.                 15240025
152500     MOVE ST-SYSTEM-HOUR         TO HL1-RUN-HOUR.                 15250025
152600     MOVE ST-SYSTEM-MINUTE       TO HL1-RUN-MINUTE.               15260025
152700                                                                  15270025
152800     MOVE PC-CONTROL-APRON-RPT-HDR                                15280025
152900                                 TO HL1-RPT-HDR.                  15290025
153000     MOVE PC-CURRENT-PROGRAM-NAME TO HL1-PROGRAM-NAME.            15300025
153100     MOVE 2                      TO HL1-RPT-NBR.                  15310025
153200     MOVE PS-PAGE-SUB            TO HL1-PGE-NBR.                  15320025
153300     MOVE PV-PAGES-REQ           TO HL1-OF-PGE-NBR.               15330025
153400     MOVE HL1-HEADING-LINE-1     TO DRS01-COMM-DATA.              15340025
153500     MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               15350025
153600     PERFORM 8000-LINK-TO-DRS.                                    15360025
153700                                                                  15370025
153800     MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              15380025
153900     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               15390025
154000     PERFORM 8000-LINK-TO-DRS.                                    15400025
154100                                                                  15410025
154200     MOVE CA-DESTINATION         TO HL2-PRINTER-DEST.             15420025
154300     MOVE CA-PREPARER-USER-ID    TO HL3-PREPARER-USER-ID.         15430025
154400     MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              15440025
154500     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15450025
154600     PERFORM 8000-LINK-TO-DRS.                                    15460025
154700                                                                  15470025
154800     MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              15480025
154900     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15490025
155000     PERFORM 8000-LINK-TO-DRS.                                    15500025
155100                                                                  15510025
155200     MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              15520025
155300     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15530025
155400     PERFORM 8000-LINK-TO-DRS.                                    15540025
155500                                                                  15550025
155600     MOVE HL6-HEADING-LINE-6     TO DRS01-COMM-DATA.              15560025
155700     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15570025
155800     PERFORM 8000-LINK-TO-DRS.                                    15580025
155900                                                                  15590025
156000     MOVE HL7-HEADING-LINE-7     TO DRS01-COMM-DATA.              15600025
156100     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15610025
156200     PERFORM 8000-LINK-TO-DRS.                                    15620025
156300                                                                  15630025
156400     MOVE HL8-HEADING-LINE-8     TO DRS01-COMM-DATA.              15640025
156500     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15650025
156600     PERFORM 8000-LINK-TO-DRS.                                    15660025
156700                                                                  15670025
156800     MOVE HL9-HEADING-LINE-9     TO DRS01-COMM-DATA.              15680025
156900     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15690025
157000     PERFORM 8000-LINK-TO-DRS.                                    15700025
157100                                                                  15710025
157200     MOVE HL10-HEADING-LINE-10   TO DRS01-COMM-DATA.              15720025
157300     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15730025
157400     PERFORM 8000-LINK-TO-DRS.                                    15740025
157500                                                                  15750025
157600     MOVE HL11-HEADING-LINE-11   TO DRS01-COMM-DATA.              15760025
157700     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15770025
157800     PERFORM 8000-LINK-TO-DRS.                                    15780025
157900                                                                  15790025
158000     MOVE HL12-HEADING-LINE-12   TO DRS01-COMM-DATA.              15800025
158100     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15810025
158200     PERFORM 8000-LINK-TO-DRS.                                    15820025
158300                                                                  15830025
158400     MOVE HL13-HEADING-LINE-13   TO DRS01-COMM-DATA.              15840025
158500     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15850025
158600     PERFORM 8000-LINK-TO-DRS.                                    15860025
158700                                                                  15870025
158800     MOVE HL14-HEADING-LINE-14   TO DRS01-COMM-DATA.              15880025
158900     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               15890025
159000     PERFORM 8000-LINK-TO-DRS.                                    15900025
159100                                                                  15910025
159200     MOVE DH1-DETAIL-HEADING-LINE-1                               15920025
159300                                 TO DRS01-COMM-DATA.              15930025
159400     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               15940025
159500     PERFORM 8000-LINK-TO-DRS.                                    15950025
159600                                                                  15960025
159700     MOVE DH2-DETAIL-HEADING-LINE-2                               15970025
159800                                 TO DRS01-COMM-DATA.              15980025
159900     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               15990025
160000     PERFORM 8000-LINK-TO-DRS.                                    16000025
160100                                                                  16010025
160200     PERFORM 4110-PRINT-DTL-LNE                                   16020025
160300         VARYING PS-DTL-LNE-SUB                                   16030025
160400         FROM 1 BY 1                                              16040025
160500         UNTIL PS-DTL-LNE-SUB > PC-ROWS-PER-PAGE.                 16050025
160600                                                                  16060025
160700     MOVE PV-STORES-GIVEN-PIECES TO TL1-TOT-STR-GIVEN.            16070025
160800     MOVE PV-TOT-EXPTED-ITM-CNT  TO TL1-TOT-EXPTED-ITM-CNT.       16080025
160900                                                                  16090025
161000     COMPUTE PV-TOT-ITM-CST =                                     16100025
161100             PV-TOT-AP-VERFD-ITM-CNT * PURITM-UNT-COST-AMT.       16110025
161200                                                                  16120025
161300     MOVE PV-TOT-ITM-CST         TO TL1-TOT-ITM-CST.              16130025
161400     MOVE TL1-TOTAL-LINE-1       TO DRS01-COMM-DATA.              16140025
161500     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               16150025
161600     PERFORM 8000-LINK-TO-DRS.                                    16160025
161700                                                                  16170025
161800     MOVE PV-TOT-VERIFIED-ITM-CNT                                 16180025
161900                                 TO TL2-TOT-VERIFIED-ITM-CNT.     16190025
162000     COMPUTE PV-TOT-ITM-RTL =                                     16200025
162100             PV-TOT-AP-VERFD-ITM-CNT * PURITM-UNT-RTL-PR-AMT.     16210025
162200                                                                  16220025
162300     MOVE PV-TOT-ITM-RTL         TO TL2-TOT-ITM-RTL.              16230025
162400     MOVE TL2-TOTAL-LINE-2       TO DRS01-COMM-DATA.              16240025
162500     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               16250025
162600     PERFORM 8000-LINK-TO-DRS.                                    16260025
162700                                                                  16270025
162800     MOVE PV-TOT-AP-VERFD-ITM-CNT                                 16280025
162900                                 TO TL3-TOT-AP-VERFD-ITM-CNT.     16290025
163000     MOVE TL3-TOTAL-LINE-3       TO DRS01-COMM-DATA.              16300025
163100     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               16310025
163200     PERFORM 8000-LINK-TO-DRS.                                    16320025
163300                                                                  16330025
163400******************************************************************16340025
163500*  THIS MODULE CONTROLS THE PRINTING OF THE STORE DETAIL LINES.   16350025
163600*  ONLY STORES WHICH HAVE AN EXPECTED ALLOCATION WILL BE PRINTED. 16360025
163700******************************************************************16370025
163800 4110-PRINT-DTL-LNE.                                              16380025
163900                                                                  16390025
164000     IF PS-PAGE-SUB = 1                                           16400025
164100         SET EA-ALLOC-IDX        TO PS-DTL-LNE-SUB                16410025
164200     ELSE                                                         16420025
164300         COMPUTE PV-STARTING-IDX-LOCATION =                       16430025
164400         (((PS-PAGE-SUB - 1) * PC-MAX-STRS-PER-PAGE)              16440025
164500                   +  PS-DTL-LNE-SUB)                             16450025
164600         SET EA-ALLOC-IDX        TO PV-STARTING-IDX-LOCATION      16460025
164700     END-IF.                                                      16470025
164800                                                                  16480025
164900     PERFORM 4111-FILL-DTL-LNE                                    16490025
165000        VARYING DL1-DTL-LNE-IDX                                   16500025
165100        FROM 1 BY 1                                               16510025
165200        UNTIL DL1-DTL-LNE-IDX > PC-COLS-PER-PAGE.                 16520025
165300                                                                  16530025
165400     MOVE DL1-DETAIL-LINE-1      TO DRS01-COMM-DATA.              16540025
165500     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               16550025
165600     PERFORM 8000-LINK-TO-DRS.                                    16560025
165700                                                                  16570025
165800 4111-FILL-DTL-LNE.                                               16580025
165900                                                                  16590025
166000     MOVE SPACES                 TO DL1-DTL-LNE-AREA              16600025
166100                                   (DL1-DTL-LNE-IDX).             16610025
166200                                                                  16620025
166300     IF EA-STR-NBR (EA-ALLOC-IDX) = ZEROS                         16630025
166400         CONTINUE                                                 16640025
166500     ELSE                                                         16650025
166600         MOVE EA-STR-NBR (EA-ALLOC-IDX)                           16660025
166700                                 TO DL1-STR-NBR (DL1-DTL-LNE-IDX) 16670025
166800         MOVE EA-EXPTED-ITM-CNT (EA-ALLOC-IDX)                    16680025
166900                                 TO DL1-EXPTED-ITM-CNT            16690025
167000                                   (DL1-DTL-LNE-IDX)              16700025
167100         ADD  EA-EXPTED-ITM-CNT (EA-ALLOC-IDX)                    16710025
167200                                 TO PV-TOT-EXPTED-ITM-CNT         16720025
167300         MOVE EA-VERFD-ITM-CNT (EA-ALLOC-IDX)                     16730025
167400                                 TO DL1-VERFD-ITM-CNT             16740025
167500                                   (DL1-DTL-LNE-IDX)              16750025
167600         ADD  EA-VERFD-ITM-CNT (EA-ALLOC-IDX)                     16760025
167700                                 TO PV-TOT-VERIFIED-ITM-CNT       16770025
167800         MOVE EA-AP-VERFD-ITM-CNT (EA-ALLOC-IDX)                  16780025
167900                                 TO DL1-AP-VERFD-ITM-CNT          16790025
168000                                   (DL1-DTL-LNE-IDX)              16800025
168100         ADD  EA-AP-VERFD-ITM-CNT (EA-ALLOC-IDX)                  16810025
168200                                 TO PV-TOT-AP-VERFD-ITM-CNT       16820025
168300         MOVE EA-ITEMS-OPEN-TO-RECEIVE (EA-ALLOC-IDX)             16830025
168400                                 TO DL1-UNITS-OPEN-TO-RECEIVE     16840025
168500                                   (DL1-DTL-LNE-IDX)              16850025
168600     END-IF.                                                      16860025
168700                                                                  16870025
168800     SET EA-ALLOC-IDX UP BY PC-ROWS-PER-PAGE.                     16880025
168900                                                                  16890025
169000 4200-OPEN-RECITM-CSR.                                            16900025
169100                                                                  16910025
169200     EXEC SQL                                                     16920025
169300         OPEN RECITM_CSR                                          16930025
169400     END-EXEC.                                                    16940025
169500                                                                  16950025
169600     EVALUATE TRUE                                                16960025
169700         WHEN SQLCODE = ZERO                                      16970025
169800             CONTINUE                                             16980025
169900                                                                  16990025
170000         WHEN SQLWARN0 NOT = SPACE                                17000025
170100         WHEN SQLCODE < ZERO                                      17010025
170200         WHEN SQLCODE > ZERO                                      17020025
170300             MOVE '4200-OPEN-RECITM-CSR'                          17030025
170400                                 TO DP013-PARAGRAPH               17040025
170500             MOVE 'OPEN THE RECITM_CSR'                           17050025
170600                                 TO DP013-MESSAGE-TEXT (1)        17060025
170700             MOVE SQLCA          TO DP013-SQLCA                   17070025
170800             MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)      17080025
170900             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (2)      17090025
171000             MOVE 'TPURITM'      TO DP013-DB2-TABLE-NAME (3)      17100025
171100             SET DP013-NO-ROLLBACK                                17110025
171200                 DP013-DB2-ABEND TO TRUE                          17120025
171300             PERFORM 9999-WRITE-CICS-LOG-MSG                      17130025
171400     END-EVALUATE.                                                17140025
171500                                                                  17150025
171600******************************************************************17160025
171700*  CALCULATE THE RECEIVER COST AND RETAIL AMOUNTS                 17170025
171800******************************************************************17180025
171900 4210-CALC-RCVR-AMTS.                                             17190025
172000                                                                  17200025
172100     COMPUTE PV-TOT-RCVR-ITM-CST = PV-TOT-RCVR-ITM-CST +          17210025
172200         (PV-UNT-COST-AMT * RECDIS-AP-VERIFY-ITM-QTY).            17220025
172300                                                                  17230025
172400     COMPUTE PV-TOT-RCVR-ITM-RTL = PV-TOT-RCVR-ITM-RTL +          17240025
172500         (PV-UNT-RTL-PR-AMT * RECDIS-AP-VERIFY-ITM-QTY).          17250025
172600                                                                  17260025
172700     COMPUTE PV-SUM-VERIFY-ITM-QTY = PV-SUM-VERIFY-ITM-QTY +      17270025
172800                              RECDIS-AP-VERIFY-ITM-QTY.           17280025
172900                                                                  17290025
173000     PERFORM 7200-FETCH-RECITM-CSR.                               17300025
173100                                                                  17310025
173200 4230-CLOSE-RECITM-CSR.                                           17320025
173300                                                                  17330025
173400     EXEC SQL                                                     17340025
173500         CLOSE RECITM_CSR                                         17350025
173600     END-EXEC.                                                    17360025
173700                                                                  17370025
173800     EVALUATE TRUE                                                17380025
173900         WHEN SQLCODE = ZERO                                      17390025
174000             CONTINUE                                             17400025
174100                                                                  17410025
174200         WHEN SQLWARN0 NOT = SPACE                                17420025
174300         WHEN SQLCODE < ZERO                                      17430025
174400         WHEN SQLCODE > ZERO                                      17440025
174500             MOVE '4230-CLOSE-RECITM-CSR'                         17450025
174600                                 TO DP013-PARAGRAPH               17460025
174700             MOVE 'CLOSE THE RECITM_CSR'                          17470025
174800                                 TO DP013-MESSAGE-TEXT (1)        17480025
174900             MOVE SQLCA          TO DP013-SQLCA                   17490025
175000             MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)      17500025
175100             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (2)      17510025
175200             MOVE 'TPURITM'      TO DP013-DB2-TABLE-NAME (3)      17520025
175300             SET DP013-NO-ROLLBACK                                17530025
175400                 DP013-DB2-ABEND TO TRUE                          17540025
175500             PERFORM 9999-WRITE-CICS-LOG-MSG                      17550025
175600     END-EVALUATE.                                                17560025
175700                                                                  17570025
175800 7100-SELECT-SKU-INFO.                                            17580025
175900                                                                  17590025
176000     INITIALIZE XL001-ITEM-COMMAREA                               17600025
176100     SET XL001-SELECT-SKU                                         17610025
176200         XL001-SELECT-VND-STYL                                    17620025
176300         XL001-BY-ITEM                TO TRUE                     17630025
176400                                                                  17640025
176500     MOVE PURITM-ITM-NBR              TO XL001-KEY-ITM-NBR        17650025
176600                                                                  17660025
176700     PERFORM 8600-CALL-XLKUT001.                                  17670025
188500/                                                                 18850011
188600 7200-FETCH-RECITM-CSR.                                           18860025
188700                                                                  18870025
188800     EXEC SQL                                                     18880025
188900         FETCH  RECITM_CSR                                        18890025
189000          INTO  :RECDIS-AP-VERIFY-ITM-QTY,                        18900025
189100                :PV-UNT-RTL-PR-AMT,                               18910025
189200                :PV-UNT-COST-AMT                                  18920025
189300     END-EXEC.                                                    18930025
189400                                                                  18940025
189500     EVALUATE TRUE                                                18950025
189600         WHEN SQLCODE = ZERO                                      18960025
189700             CONTINUE                                             18970025
189800                                                                  18980025
189900         WHEN SQLCODE = PC-ROW-NOT-FOUND                          18990025
190000             CONTINUE                                             19000025
190100                                                                  19010025
190200         WHEN SQLWARN0 NOT = SPACE                                19020025
190300         WHEN SQLCODE < ZERO                                      19030025
190400         WHEN SQLCODE > ZERO                                      19040025
190500             MOVE '7200-FETCH-RECITM-CSR'                         19050025
190600                                 TO DP013-PARAGRAPH               19060025
190700             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 19070025
190800-                 'FROM THE RECITM_CSR'                           19080025
190900                                 TO DP013-MESSAGE-TEXT (1)        19090025
191000             MOVE SQLCA          TO DP013-SQLCA                   19100025
191100             MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)      19110025
191200             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (2)      19120025
191300             MOVE 'TPURITM'      TO DP013-DB2-TABLE-NAME (3)      19130025
191400             SET DP013-NO-ROLLBACK                                19140025
191500                 DP013-DB2-ABEND TO TRUE                          19150025
191600             PERFORM 9999-WRITE-CICS-LOG-MSG                      19160025
191700     END-EVALUATE.                                                19170025
191800                                                                  19180025
191900 7300-FETCH-PKSL-CSR.                                             19190025
192000                                                                  19200025
192100     INITIALIZE DCLTPKSLIP.                                       19210025
192200                                                                  19220025
192300     EXEC SQL                                                     19230025
192400         FETCH  PKSL_CSR                                          19240025
192500          INTO  :PKSLIP-PKSL-NBR                                  19250025
192600     END-EXEC.                                                    19260025
192700                                                                  19270025
192800     EVALUATE TRUE                                                19280025
192900         WHEN SQLCODE = ZERO                                      19290025
193000             CONTINUE                                             19300025
193100                                                                  19310025
193200         WHEN SQLCODE = PC-ROW-NOT-FOUND                          19320025
193300             CONTINUE                                             19330025
193400                                                                  19340025
193500         WHEN SQLWARN0 NOT = SPACE                                19350025
193600         WHEN SQLCODE < ZERO                                      19360025
193700         WHEN SQLCODE > ZERO                                      19370025
193800             MOVE '7300-FETCH-PKSL-CSR'                           19380025
193900                                 TO DP013-PARAGRAPH               19390025
194000             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 19400025
194100-                 'FROM THE PKSL_CSR'                             19410025
194200                                 TO DP013-MESSAGE-TEXT (1)        19420025
194300             MOVE SQLCA          TO DP013-SQLCA                   19430025
194400             MOVE 'TPKSLIP'      TO DP013-DB2-TABLE-NAME (1)      19440025
194500             SET DP013-NO-ROLLBACK                                19450025
194600                 DP013-DB2-ABEND TO TRUE                          19460025
194700             PERFORM 9999-WRITE-CICS-LOG-MSG                      19470025
194800     END-EVALUATE.                                                19480025
194900                                                                  19490025
195000 7400-FETCH-RECDIS-CSR.                                           19500025
195100                                                                  19510025
195200     INITIALIZE DCLTRECDIS.                                       19520025
195300                                                                  19530025
195400     EXEC SQL                                                     19540025
195500         FETCH  RECDIS_CSR                                        19550025
195600          INTO  :RECDIS-STR-NBR,                                  19560025
195700                :RECDIS-EXPTED-ITM-QTY,                           19570025
195800                :RECDIS-VERIFY-ITM-QTY,                           19580025
195900                :RECDIS-AP-VERIFY-ITM-QTY                         19590025
196000     END-EXEC.                                                    19600025
196100                                                                  19610025
196200     EVALUATE TRUE                                                19620025
196300         WHEN SQLCODE = ZERO                                      19630025
196400             ADD 1               TO PV-STR-CNT                    19640025
196500                                                                  19650025
196600         WHEN SQLCODE = PC-ROW-NOT-FOUND                          19660025
196700             CONTINUE                                             19670025
196800                                                                  19680025
196900         WHEN SQLWARN0 NOT = SPACE                                19690025
197000         WHEN SQLCODE < ZERO                                      19700025
197100         WHEN SQLCODE > ZERO                                      19710025
197200             MOVE '7400-FETCH-RECDIS-CSR'                         19720025
197300                                 TO DP013-PARAGRAPH               19730025
197400             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 19740025
197500-                 'FROM THE RECDIS_CSR'                           19750025
197600                                 TO DP013-MESSAGE-TEXT (1)        19760025
197700             MOVE SQLCA          TO DP013-SQLCA                   19770025
197800             MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)      19780025
197900             SET DP013-NO-ROLLBACK                                19790025
198000                 DP013-DB2-ABEND TO TRUE                          19800025
198100             PERFORM 9999-WRITE-CICS-LOG-MSG                      19810025
198200     END-EVALUATE.                                                19820025
198300                                                                  19830025
198400 7500-SELECT-PO-HDR-DATA.                                         19840025
198500                                                                  19850025
198600     INITIALIZE DCLTPURCHS                                        19860025
198700                DCLTPURITM                                        19870025
198800                DCLTSTATCD.                                       19880025
198900                                                                  19890025
199000     PERFORM                                                      19900025
199100         WITH TEST AFTER                                          19910025
199200         VARYING PV-SELECT-COUNTER                                19920025
199300         FROM 1 BY 1                                              19930025
199400         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              19940025
199500            OR  (SQLCODE = ZERO)                                  19950025
199600            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     19960025
199700                                                                  19970025
199800         EXEC SQL                                                 19980025
199900             SELECT  A.DEPT_NBR,                                  19990025
200000                     A.ENT_ID,                                    20000025
200100                     B.PO_LNE_NBR,                                20010025
200200                     B.SKU_DESC,                                  20020025
200300                     B.SIZE_DESC,                                 20030025
200400                     B.COLOR_DESC,                                20040025
200500                     B.UNT_RTL_PR_AMT,                            20050025
200600                     B.UNT_COST_AMT,                              20060025
200700                     B.ITM_NBR                                    20070025
200800               INTO  :PURCHS-DEPT-NBR,                            20080025
200900                     :PURCHS-ENT-ID,                              20090025
201000                     :PURITM-PO-LNE-NBR,                          20100025
201100                     :PURITM-SKU-DESC,                            20110025
201200                     :PURITM-SIZE-DESC,                           20120025
201300                     :PURITM-COLOR-DESC,                          20130025
201400                     :PURITM-UNT-RTL-PR-AMT,                      20140025
201500                     :PURITM-UNT-COST-AMT,                        20150025
201600                     :PURITM-ITM-NBR                              20160025
201700               FROM  TPURCHS A,                                   20170025
201800                     TPURITM B,                                   20180025
201900                     TSTATCD C                                    20190025
202000              WHERE (A.PO_NBR          =  :DK-ORD-NBR             20200025
202100                AND  A.PO_NBR          =  B.PO_NBR                20210025
202200                AND  B.APP_PO_LNE_NBR  =  :DK-ORD-LNE-NBR         20220025
202300                AND  A.VER_STATUS_CDE  =  'A'                     20230025
202400                AND  B.VER_STATUS_CDE  =  'A'                     20240025
202500                AND  C.STATUS_TYP_CDE  =  'P'                     20250025
202600                AND  C.STATUS_CLS     IN  ('ACT','CMP')           20260025
202700                AND  C.STATUS_CDE      =  A.STATUS_CDE)           20270025
202800         END-EXEC                                                 20280025
202900                                                                  20290025
203000         EVALUATE TRUE                                            20300025
203100             WHEN SQLCODE = ZERO                                  20310025
203200             WHEN SQLCODE = -904                                  20320025
203300             WHEN SQLCODE = -913                                  20330025
203400             WHEN SQLCODE = PC-ROW-NOT-FOUND                      20340025
203500                  CONTINUE                                        20350025
203600             WHEN SQLWARN0 NOT = SPACES                           20360025
203700             WHEN SQLCODE < ZERO                                  20370025
203800             WHEN SQLCODE > ZERO                                  20380025
203900                  MOVE '7500-SELECT-PO-HDR-DATA'                  20390025
204000                                 TO DP013-PARAGRAPH               20400025
204100                  MOVE 'SELECT INFO FOR THE FOLLOWING RECEIVER: ' 20410025
204200                                 TO DP013-MESSAGE-TEXT (1)        20420025
204300                  MOVE DK-ORD-NBR                                 20430025
204400                                 TO PV-DISPLAY-ORD-NBR            20440025
204500                  MOVE DK-ORD-LNE-NBR                             20450025
204600                                 TO PV-DISPLAY-ORD-LNE-NBR        20460025
204700                  MOVE PV-DISPLAY-KEYS                            20470025
204800                                 TO DP013-MESSAGE-TEXT (2)        20480025
204900                  MOVE SQLCA     TO DP013-SQLCA                   20490025
205000                  MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)      20500025
205100                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (2)      20510025
205200                  MOVE 'TSTATCD' TO DP013-DB2-TABLE-NAME (3)      20520025
205300                  SET DP013-DB2-ABEND                             20530025
205400                                 TO TRUE                          20540025
205500                  SET DP013-NO-ROLLBACK                           20550025
205600                                 TO TRUE                          20560025
205700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 20570025
205800         END-EVALUATE                                             20580025
205900     END-PERFORM.                                                 20590025
206000                                                                  20600025
206100     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO20610025
206200         MOVE '7500-SELECT-PO-HDR-DATA'                           20620025
206300                                 TO DP013-PARAGRAPH               20630025
206400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     20640025
206500                                 TO DP013-MESSAGE-TEXT (1)        20650025
206600         MOVE 'THE FOLLOWING RECEIVER: '                          20660025
206700                                 TO DP013-MESSAGE-TEXT (2)        20670025
206800         MOVE DK-ORD-NBR         TO PV-DISPLAY-ORD-NBR            20680025
206900         MOVE DK-ORD-LNE-NBR     TO PV-DISPLAY-ORD-LNE-NBR        20690025
207000         MOVE PV-DISPLAY-KEYS    TO DP013-MESSAGE-TEXT (3)        20700025
207100         MOVE SQLCA              TO DP013-SQLCA                   20710025
207200         MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)      20720025
207300         MOVE 'TPURITM'          TO DP013-DB2-TABLE-NAME (2)      20730025
207400         MOVE 'TSTATCD'          TO DP013-DB2-TABLE-NAME (3)      20740025
207500         SET DP013-DB2-ABEND     TO TRUE                          20750025
207600         SET DP013-NO-ROLLBACK   TO TRUE                          20760025
207700         PERFORM 9999-WRITE-CICS-LOG-MSG                          20770025
207800     END-IF.                                                      20780025
207900                                                                  20790025
208000 7700-GET-PRIMARY-VNDR-NME.                                       20800025
208100                                                                  20810025
208200     INITIALIZE DCLTENTNME.                                       20820025
208300                                                                  20830025
208400     PERFORM                                                      20840025
208500         WITH TEST AFTER                                          20850025
208600         VARYING PV-SELECT-COUNTER                                20860025
208700         FROM 1 BY 1                                              20870025
208800         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              20880025
208900            OR   (SQLCODE = ZERO)                                 20890025
209000            OR   (SQLCODE = PC-ROW-NOT-FOUND))                    20900025
209100                                                                  20910025
209200         EXEC SQL                                                 20920025
209300             SELECT  ENT_NAME_DESC                                20930025
209400               INTO  :ENTNME-ENT-NAME-DESC                        20940025
209500               FROM  TENTNME                                      20950025
209600              WHERE  (ENT_ID    =  :PURCHS-ENT-ID                 20960025
209700                AND   TYPE_CDE  =  '01')                          20970025
209800         END-EXEC                                                 20980025
209900                                                                  20990025
210000         EVALUATE TRUE                                            21000025
210100             WHEN SQLCODE = ZERO                                  21010025
210200             WHEN SQLCODE = -904                                  21020025
210300             WHEN SQLCODE = -913                                  21030025
210400             WHEN SQLCODE = PC-ROW-NOT-FOUND                      21040025
210500                  CONTINUE                                        21050025
210600             WHEN SQLWARN0 NOT = SPACES                           21060025
210700             WHEN SQLCODE < ZERO                                  21070025
210800             WHEN SQLCODE > ZERO                                  21080025
210900                  MOVE '7700-GET-PRIMARY-VNDR-NME'                21090025
211000                                 TO DP013-PARAGRAPH               21100025
211100                  MOVE 'SELECT PRIMARY VENDOR NAME ENT ID = '     21110025
211200                                 TO DP013-MESSAGE-TEXT (1)        21120025
211300                  MOVE PURCHS-ENT-ID                              21130025
211400                                 TO PV-DISPLAY-ENT-ID             21140025
211500                  MOVE PV-DISPLAY-ENT-ID                          21150025
211600                                 TO DP013-MESSAGE-TEXT (2)        21160025
211700                  MOVE SQLCA     TO DP013-SQLCA                   21170025
211800                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      21180025
211900                  SET DP013-DB2-ABEND                             21190025
212000                                 TO TRUE                          21200025
212100                  SET DP013-NO-ROLLBACK                           21210025
212200                                 TO TRUE                          21220025
212300                  PERFORM 9999-WRITE-CICS-LOG-MSG                 21230025
212400         END-EVALUATE                                             21240025
212500     END-PERFORM.                                                 21250025
212600                                                                  21260025
212700     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO21270025
212800         MOVE '7700-GET-PRIMARY-VNDR-NME'                         21280025
212900                                 TO DP013-PARAGRAPH               21290025
213000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     21300025
213100                                 TO DP013-MESSAGE-TEXT (1)        21310025
213200         MOVE 'THE PRIMARY VENDOR NAME.  ENT ID = '               21320025
213300                                 TO DP013-MESSAGE-TEXT (2)        21330025
213400         MOVE PURCHS-ENT-ID      TO PV-DISPLAY-ENT-ID             21340025
213500         MOVE PV-DISPLAY-ENT-ID  TO DP013-MESSAGE-TEXT (3)        21350025
213600         MOVE SQLCA              TO DP013-SQLCA                   21360025
213700         MOVE 'TENTNME'          TO DP013-DB2-TABLE-NAME (1)      21370025
213800         SET DP013-DB2-ABEND     TO TRUE                          21380025
213900         SET DP013-NO-ROLLBACK   TO TRUE                          21390025
214000         PERFORM 9999-WRITE-CICS-LOG-MSG                          21400025
214100     END-IF.                                                      21410025
214200                                                                  21420025
214300 7800-GET-SPECIAL-INSTRS.                                         21430025
214400                                                                  21440025
214500     INITIALIZE DCLTPOINST                                        21450025
214600                DCLTINSTCD.                                       21460025
214700                                                                  21470025
214800     PERFORM                                                      21480025
214900         WITH TEST AFTER                                          21490025
215000         VARYING PV-SELECT-COUNTER                                21500025
215100         FROM 1 BY 1                                              21510025
215200         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              21520025
215300            OR  (SQLCODE = ZERO)                                  21530025
215400            OR  (SQLCODE = PC-ROW-NOT-FOUND)                      21540025
215500            OR  (SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS))          21550025
215600                                                                  21560025
215700         EXEC SQL                                                 21570025
215800             SELECT  B.INSTR_DESC                                 21580025
215900               INTO  :INSTCD-INSTR-DESC                           21590025
216000               FROM  TPOINST A,                                   21600025
216100                     TINSTCD B                                    21610025
216200              WHERE  (A.PO_NBR     =  :DK-ORD-NBR                 21620025
216300                AND   A.RECIP_CDE  =  'DC'                        21630025
216400                AND   A.INSTR_NBR  =  B.INSTR_NBR)                21640025
216500         END-EXEC                                                 21650025
216600                                                                  21660025
216700         EVALUATE TRUE                                            21670025
216800             WHEN SQLCODE = ZERO                                  21680025
216900             WHEN SQLCODE = -904                                  21690025
217000             WHEN SQLCODE = -913                                  21700025
217100                 CONTINUE                                         21710025
217200                                                                  21720025
217300             WHEN SQLCODE = PC-ROW-NOT-FOUND                      21730025
217400                 SET PS-NO-SPECIAL-INSTRS-FOUND                   21740025
217500                                 TO TRUE                          21750025
217600             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           21760025
217700                 SET PS-MULT-SPECIAL-INSTRS-FOUND                 21770025
217800                                 TO TRUE                          21780025
217900             WHEN SQLWARN0 NOT = SPACES                           21790025
218000             WHEN SQLCODE < ZERO                                  21800025
218100             WHEN SQLCODE > ZERO                                  21810025
218200                  MOVE '7800-GET-SPECIAL-INSTRS'                  21820025
218300                                 TO DP013-PARAGRAPH               21830025
218400                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     21840025
218500                                 TO DP013-MESSAGE-TEXT (1)        21850025
218600                  MOVE DK-ORD-NBR                                 21860025
218700                                 TO PV-DISPLAY-ORD-NBR            21870025
218800                  MOVE PV-DISPLAY-KEYS                            21880025
218900                                 TO DP013-MESSAGE-TEXT (2)        21890025
219000                  MOVE SQLCA     TO DP013-SQLCA                   21900025
219100                  MOVE 'TPOINST' TO DP013-DB2-TABLE-NAME (1)      21910025
219200                  MOVE 'TINSTCD' TO DP013-DB2-TABLE-NAME (2)      21920025
219300                  SET DP013-DB2-ABEND                             21930025
219400                                 TO TRUE                          21940025
219500                  SET DP013-NO-ROLLBACK                           21950025
219600                                 TO TRUE                          21960025
219700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 21970025
219800         END-EVALUATE                                             21980025
219900     END-PERFORM.                                                 21990025
220000                                                                  22000025
220100     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO22010025
220200         MOVE '7800-GET-SPECIAL-INSTRS'                           22020025
220300                                 TO DP013-PARAGRAPH               22030025
220400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22040025
220500                                 TO DP013-MESSAGE-TEXT (1)        22050025
220600         MOVE 'THE SPECIAL INSTRUCTIONS.  KEYS = '                22060025
220700                                 TO DP013-MESSAGE-TEXT (2)        22070025
220800         MOVE DK-ORD-NBR         TO PV-DISPLAY-ORD-NBR            22080025
220900         MOVE PV-DISPLAY-KEYS    TO DP013-MESSAGE-TEXT (3)        22090025
221000         MOVE SQLCA              TO DP013-SQLCA                   22100025
221100         MOVE 'TPOINST'          TO DP013-DB2-TABLE-NAME (1)      22110025
221200         MOVE 'TINSTCD'          TO DP013-DB2-TABLE-NAME (2)      22120025
221300         SET DP013-DB2-ABEND     TO TRUE                          22130025
221400         SET DP013-NO-ROLLBACK   TO TRUE                          22140025
221500         PERFORM 9999-WRITE-CICS-LOG-MSG                          22150025
221600     END-IF.                                                      22160025
221700                                                                  22170025
221800 7900-GET-INVOICE-NBR.                                            22180025
221900                                                                  22190025
222000     INITIALIZE DCLTRECITM.                                       22200025
222100                                                                  22210025
222200     PERFORM                                                      22220025
222300         WITH TEST AFTER                                          22230025
222400         VARYING PV-SELECT-COUNTER                                22240025
222500         FROM 1 BY 1                                              22250025
222600         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              22260025
222700            OR  (SQLCODE = ZERO)                                  22270025
222800            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     22280025
222900                                                                  22290025
223000         EXEC SQL                                                 22300025
223100             SELECT  PKSL_NBR                                     22310025
223200               INTO  :RECITM-PKSL-NBR                             22320025
223300               FROM  TRECITM                                      22330025
223400              WHERE  ORD_NBR        = :DK-ORD-NBR                 22340025
223500                AND  ORD_LNE_NBR    = :DK-ORD-LNE-NBR             22350025
223600                AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR            22360025
223700                AND  OPER_UNT_ID    = :DK-OPER-UNT-ID             22370025
223800                AND  FCLTY_ID       = :DK-FCLTY-ID                22380025
223900                AND  VER_STATUS_CDE = 'A'                         22390025
224000         END-EXEC                                                 22400025
224100                                                                  22410025
224200         EVALUATE TRUE                                            22420025
224300             WHEN SQLCODE = ZERO                                  22430025
224400                 CONTINUE                                         22440025
224500                                                                  22450025
224600             WHEN SQLCODE = -904                                  22460025
224700             WHEN SQLCODE = -913                                  22470025
224800             WHEN SQLCODE = PC-ROW-NOT-FOUND                      22480025
224900                 CONTINUE                                         22490025
225000                                                                  22500025
225100             WHEN SQLWARN0 NOT = SPACES                           22510025
225200             WHEN SQLCODE < ZERO                                  22520025
225300             WHEN SQLCODE > ZERO                                  22530025
225400                  MOVE '7900-GET-INVOICE-NBR'                     22540025
225500                                 TO DP013-PARAGRAPH               22550025
225600                  MOVE 'SELECT PACK SLIP NUMBER = '               22560025
225700                                 TO DP013-MESSAGE-TEXT (1)        22570025
225800                  MOVE DK-ORD-NBR                                 22580025
225900                                 TO PV-DISPLAY-ORD-NBR            22590025
226000                  MOVE PV-DISPLAY-KEYS                            22600025
226100                                 TO DP013-MESSAGE-TEXT (2)        22610025
226200                  MOVE SQLCA     TO DP013-SQLCA                   22620025
226300                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      22630025
226400                  SET DP013-DB2-ABEND                             22640025
226500                                 TO TRUE                          22650025
226600                  SET DP013-NO-ROLLBACK                           22660025
226700                                 TO TRUE                          22670025
226800                  PERFORM 9999-WRITE-CICS-LOG-MSG                 22680025
226900         END-EVALUATE                                             22690025
227000     END-PERFORM.                                                 22700025
227100                                                                  22710025
227200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO22720025
227300         MOVE '7900-GET-INVOICE-NBR'                              22730025
227400                                 TO DP013-PARAGRAPH               22740025
227500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22750025
227600                                 TO DP013-MESSAGE-TEXT (1)        22760025
227700         MOVE 'THE PACK SLIP NUMBER.  KEYS = '                    22770025
227800                                 TO DP013-MESSAGE-TEXT (2)        22780025
227900         MOVE DK-ORD-NBR         TO PV-DISPLAY-ORD-NBR            22790025
228000         MOVE PV-DISPLAY-KEYS    TO DP013-MESSAGE-TEXT (3)        22800025
228100         MOVE SQLCA              TO DP013-SQLCA                   22810025
228200         MOVE 'TRECITM'          TO DP013-DB2-TABLE-NAME (1)      22820025
228300         SET DP013-DB2-ABEND     TO TRUE                          22830025
228400         SET DP013-NO-ROLLBACK   TO TRUE                          22840025
228500         PERFORM 9999-WRITE-CICS-LOG-MSG                          22850025
228600     END-IF.                                                      22860025
228700                                                                  22870025
228800 7950-GET-KEYREC-NBR.                                             22880025
228900                                                                  22890025
229000     INITIALIZE DCLTRECEIV.                                       22900025
229100                                                                  22910025
229200     PERFORM                                                      22920025
229300         WITH TEST AFTER                                          22930025
229400         VARYING PV-SELECT-COUNTER                                22940025
229500         FROM 1 BY 1                                              22950025
229600         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              22960025
229700            OR  (SQLCODE = ZERO)                                  22970025
229800            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     22980025
229900                                                                  22990025
230000         EXEC SQL                                                 23000025
230100             SELECT  MONTH (REC_TMST),                            23010025
230200                     DAY   (REC_TMST),                            23020025
230300                     YEAR  (REC_TMST),                            23030025
230400                     ACTL_CART_CNT,                               23040025
230500                     RCVR_NBR,                                    23050025
230600                     MONTH (VERFYD_TMST),                         23060025
230700                     DAY   (VERFYD_TMST),                         23070025
230800                     YEAR  (VERFYD_TMST)                          23080025
230900               INTO  :PV-DB2-REC-MONTH,                           23090025
231000                     :PV-DB2-REC-DAY,                             23100025
231100                     :PV-DB2-REC-YEAR,                            23110025
231200                     :RECEIV-ACTL-CART-CNT,                       23120025
231300                     :RECEIV-RCVR-NBR,                            23130025
231400                     :PV-DB2-VERFYD-MONTH,                        23140025
231500                     :PV-DB2-VERFYD-DAY,                          23150025
231600                     :PV-DB2-VERFYD-YEAR                          23160025
231700               FROM  TRECEIV                                      23170025
231800              WHERE  (ORD_NBR         =  :DK-ORD-NBR              23180025
231900                AND   REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR         23190025
232000                AND   OPER_UNT_ID     =  :DK-OPER-UNT-ID          23200025
232100                AND   FCLTY_ID        =  :DK-FCLTY-ID             23210025
232200                AND   VER_STATUS_CDE  =  'A')                     23220025
232300         END-EXEC                                                 23230025
232400                                                                  23240025
232500         EVALUATE TRUE                                            23250025
232600             WHEN SQLCODE = ZERO                                  23260025
232700             WHEN SQLCODE = -904                                  23270025
232800             WHEN SQLCODE = -913                                  23280025
232900             WHEN SQLCODE = PC-ROW-NOT-FOUND                      23290025
233000                 CONTINUE                                         23300025
233100                                                                  23310025
233200             WHEN SQLWARN0 NOT = SPACES                           23320025
233300             WHEN SQLCODE < ZERO                                  23330025
233400             WHEN SQLCODE > ZERO                                  23340025
233500                  MOVE '7950-GET-KEYREC-NBR'                      23350025
233600                                 TO DP013-PARAGRAPH               23360025
233700                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     23370025
233800                                 TO DP013-MESSAGE-TEXT (1)        23380025
233900                  MOVE DK-ORD-NBR                                 23390025
234000                                 TO PV-DISPLAY-ORD-NBR            23400025
234100                  MOVE DK-RCVR-SEQ-NBR                            23410025
234200                                 TO PV-DISPLAY-RCVR-SEQ-NBR       23420025
234300                  MOVE DK-OPER-UNT-ID                             23430025
234400                                 TO PV-DISPLAY-OPER-UNT-ID        23440025
234500                  MOVE DK-FCLTY-ID                                23450025
234600                                 TO PV-DISPLAY-FCLTY-ID           23460025
234700                  MOVE PV-DISPLAY-KEYS                            23470025
234800                                 TO DP013-MESSAGE-TEXT (2)        23480025
234900                  MOVE SQLCA     TO DP013-SQLCA                   23490025
235000                  MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)      23500025
235100                  SET DP013-DB2-ABEND                             23510025
235200                                 TO TRUE                          23520025
235300                  SET DP013-NO-ROLLBACK                           23530025
235400                                 TO TRUE                          23540025
235500                  PERFORM 9999-WRITE-CICS-LOG-MSG                 23550025
235600         END-EVALUATE                                             23560025
235700     END-PERFORM.                                                 23570025
235800                                                                  23580025
235900     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO23590025
236000         MOVE '7950-GET-KEYREC-NBR'                               23600025
236100                                 TO DP013-PARAGRAPH               23610025
236200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23620025
236300                                 TO DP013-MESSAGE-TEXT (1)        23630025
236400         MOVE 'THE KEYREC NUMBER.  KEYS = '                       23640025
236500                                 TO DP013-MESSAGE-TEXT (2)        23650025
236600         MOVE DK-ORD-NBR         TO PV-DISPLAY-ORD-NBR            23660025
236700         MOVE DK-RCVR-SEQ-NBR    TO PV-DISPLAY-RCVR-SEQ-NBR       23670025
236800         MOVE DK-OPER-UNT-ID     TO PV-DISPLAY-OPER-UNT-ID        23680025
236900         MOVE DK-FCLTY-ID        TO PV-DISPLAY-FCLTY-ID           23690025
237000         MOVE PV-DISPLAY-KEYS    TO DP013-MESSAGE-TEXT (3)        23700025
237100         MOVE SQLCA              TO DP013-SQLCA                   23710025
237200         MOVE 'TRECEIV'          TO DP013-DB2-TABLE-NAME (1)      23720025
237300         SET DP013-DB2-ABEND     TO TRUE                          23730025
237400         SET DP013-NO-ROLLBACK   TO TRUE                          23740025
237500         PERFORM 9999-WRITE-CICS-LOG-MSG                          23750025
237600     END-IF.                                                      23760025
237700                                                                  23770025
237800******************************************************************23780025
237900* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     23790025
238000******************************************************************23800025
238100 8000-LINK-TO-DRS.                                                23810025
238200                                                                  23820025
238300     EXEC CICS                                                    23830025
238400         LINK                                                     23840025
238500             PROGRAM   ('DRS1INTC')                               23850025
238600             COMMAREA  (DRS01-COMMAREA)                           23860025
238700     END-EXEC.                                                    23870025
238800                                                                  23880025
238900 8100-FORMAT-TIME.                                                23890025
239000                                                                  23900025
239100     EXEC CICS                                                    23910025
239200         ASKTIME ABSTIME (ST-ABSTIME)                             23920025
239300     END-EXEC.                                                    23930025
239400                                                                  23940025
239500     EXEC CICS                                                    23950025
239600         FORMATTIME ABSTIME  (ST-ABSTIME)                         23960025
239700                    MMDDYY   (SD-MMDDYY-FORMAT)                   23970025
239800                    DATESEP                                       23980025
239900                    TIME     (ST-HHMMSS-FORMAT)                   23990025
240000                    TIMESEP                                       24000025
240100     END-EXEC.                                                    24010025
240200                                                                  24020025
240300     EXEC CICS                                                    24030025
240400         FORMATTIME ABSTIME  (ST-ABSTIME)                         24040025
240500                       YEAR  (SD-YYYY-FORMAT)                     24050025
240600     END-EXEC.                                                    24060025
240700                                                                  24070025
240800     MOVE SD-YYYY-FORMAT         TO PV-CURRENT-CENTURY-YEAR.      24080025
240900     MOVE SD-SYSTEM-MONTH        TO PV-CURRENT-MONTH.             24090025
241000     MOVE SD-SYSTEM-DAY          TO PV-CURRENT-DAY.               24100025
241100                                                                  24110025
241200/                                                                 24120025
241300*----------------------------------------------------------------*24130025
241400*    GET DEFAULT PAYMENT TERM                                    *24140025
241500*----------------------------------------------------------------*24150025
241600                                                                  24160025
241700 8200-GET-DEFAULT-PAYMENT-TERM.                                   24170025
241800                                                                  24180025
241900     INITIALIZE DCLTPAYTRM.                                       24190025
242000                                                                  24200025
242100     PERFORM                                                      24210025
242200         WITH TEST AFTER                                          24220025
242300         VARYING PV-SELECT-COUNTER                                24230025
242400         FROM 1 BY 1                                              24240025
242500         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              24250025
242600             OR (SQLCODE = +0)                                    24260025
242700             OR (SQLCODE = +100))                                 24270025
242800                                                                  24280025
242900         EXEC SQL                                                 24290025
243000               SELECT B.PAY_TERM_ID                               24300025
243100                     ,B.DISCOUNT_DAYS_QTY                         24310025
243200                     ,B.DISCOUNT_PCT                              24320025
243300                     ,B.DUE_DAY_QTY                               24330025
243400                     ,B.DUE_DAY_FR_DTE_TXT                        24340025
243500                     ,B.OTHER_TXT                                 24350025
243600                INTO :PAYTRM-PAY-TERM-ID                          24360025
243700                    ,:PAYTRM-DISCOUNT-DAYS-QTY                    24370025
243800                    ,:PAYTRM-DISCOUNT-PCT                         24380025
243900                    ,:PAYTRM-DUE-DAY-QTY                          24390025
244000                    ,:PAYTRM-DUE-DAY-FR-DTE-TXT                   24400025
244100                    ,:PAYTRM-OTHER-TXT                            24410025
244200                FROM TVNDAGR A                                    24420025
244300                    ,TPAYTRM B                                    24430025
244400               WHERE A.DEPT_NBR          = :PURCHS-DEPT-NBR       24440025
244500                 AND A.ENT_ID            = :PURCHS-ENT-ID         24450025
244600                 AND A.AGRMT_TYP_ID      = '2'                    24460025
244700                 AND A.EFFECTIVE_DATE   <= CURRENT DATE           24470025
244800                 AND A.EXPIRATION_DATE  >  CURRENT DATE           24480025
244900                 AND B.PAY_TERM_ID       = A.PAYT_TERM_ID         24490025
245000         END-EXEC                                                 24500025
245100                                                                  24510025
245200         EVALUATE TRUE                                            24520025
245300             WHEN SQLCODE = +0                                    24530025
245400             WHEN SQLCODE = +100                                  24540025
245500             WHEN SQLCODE = -904                                  24550025
245600             WHEN SQLCODE = -913                                  24560025
245700                  CONTINUE                                        24570025
245800                                                                  24580025
245900             WHEN SQLWARN0 NOT = SPACES                           24590025
246000             WHEN SQLCODE < +0                                    24600025
246100             WHEN SQLCODE > +0                                    24610025
246200                  MOVE '8200-GET-DEFAULT-PAYMENT-TERM'            24620025
246300                                  TO DP013-PARAGRAPH              24630025
246400                  MOVE 'UNSUCCESSFUL SELECT PAYMENT TERMS'        24640025
246500                                  TO DP013-MESSAGE-TEXT (1)       24650025
246600                  MOVE SQLCA      TO DP013-SQLCA                  24660025
246700                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     24670025
246800                  MOVE 'TPAYTRM ' TO DP013-DB2-TABLE-NAME (2)     24680025
246900                  SET DP013-DB2-ABEND                             24690025
247000                      DP013-XCTL-DISPLAY-RESTART                  24700025
247100                                  TO TRUE                         24710025
247200                  PERFORM 9999-WRITE-CICS-LOG-MSG                 24720025
247300         END-EVALUATE                                             24730025
247400     END-PERFORM.                                                 24740025
247500                                                                  24750025
247600     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO24760025
247700         MOVE '8200-GET-DEFAULT-PAYMENT-TERM'                     24770025
247800                                  TO DP013-PARAGRAPH              24780025
247900         MOVE 'MAX RETRIES EXCEEDED ON SELECT PAYMENT TERMS'      24790025
248000                                  TO DP013-MESSAGE-TEXT (1)       24800025
248100         MOVE SQLCA               TO DP013-SQLCA                  24810025
248200         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     24820025
248300         MOVE 'TPAYTRM '          TO DP013-DB2-TABLE-NAME (2)     24830025
248400         SET DP013-DB2-ABEND                                      24840025
248500             DP013-XCTL-DISPLAY-RESTART                           24850025
248600                                  TO TRUE                         24860025
248700         PERFORM 9999-WRITE-CICS-LOG-MSG                          24870025
248800     END-IF.                                                      24880025
248900                                                                  24890025
249000/                                                                 24900025
249100*----------------------------------------------------------------*24910025
249200*    FORMAT PAYMENT TERM DESCRIPTION                             *24920025
249300*----------------------------------------------------------------*24930025
249400 8300-FORMAT-PAYMENT-TERM-DESC.                                   24940025
249500                                                                  24950025
249600     INITIALIZE ASC-PAYT-TERM-ID-DESC.                            24960025
249700                                                                  24970025
249800     COPY POPD001.                                                24980025
249900                                                                  24990025
250000/                                                                 25000025
250100*----------------------------------------------------------------*25010025
250200*    GET THE FREIGHT PAYMENT CODE                                *25020025
250300*----------------------------------------------------------------*25030025
250400                                                                  25040025
250500 8400-GET-PAY-CODE.                                               25050025
250600                                                                  25060025
250700     INITIALIZE DCLTPLNSHP.                                       25070025
250800                                                                  25080025
250900     PERFORM                                                      25090025
251000         WITH TEST AFTER                                          25100025
251100         VARYING PV-SELECT-COUNTER                                25110025
251200         FROM 1 BY 1                                              25120025
251300         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              25130025
251400             OR (SQLCODE = +0)                                    25140025
251500             OR (SQLCODE = +100))                                 25150025
251600                                                                  25160025
251700         EXEC SQL                                                 25170025
251800               SELECT FRGT_PAYT_CDE                               25180025
251900                INTO :PLNSHP-FRGT-PAYT-CDE                        25190025
252000                FROM TPLNSHP                                      25200025
252100               WHERE PO_NBR         = :DK-ORD-NBR                 25210025
252200                 AND VER_STATUS_CDE = 'A'                         25220025
252300         END-EXEC                                                 25230025
252400                                                                  25240025
252500         EVALUATE TRUE                                            25250025
252600             WHEN SQLCODE = +0                                    25260025
252700             WHEN SQLCODE = +100                                  25270025
252800             WHEN SQLCODE = -904                                  25280025
252900             WHEN SQLCODE = -913                                  25290025
253000                  CONTINUE                                        25300025
253100                                                                  25310025
253200             WHEN SQLWARN0 NOT = SPACES                           25320025
253300             WHEN SQLCODE < +0                                    25330025
253400             WHEN SQLCODE > +0                                    25340025
253500                  MOVE '8400-GET-PAY-CODE'                        25350025
253600                                  TO DP013-PARAGRAPH              25360025
253700                  MOVE 'UNSUCCESSFUL SELECT PAY CODE'             25370025
253800                                  TO DP013-MESSAGE-TEXT (1)       25380025
253900                  MOVE SQLCA      TO DP013-SQLCA                  25390025
254000                  MOVE 'TPLNSHP ' TO DP013-DB2-TABLE-NAME (1)     25400025
254100                  SET DP013-DB2-ABEND                             25410025
254200                      DP013-XCTL-DISPLAY-RESTART                  25420025
254300                                  TO TRUE                         25430025
254400                  PERFORM 9999-WRITE-CICS-LOG-MSG                 25440025
254500         END-EVALUATE                                             25450025
254600     END-PERFORM.                                                 25460025
254700                                                                  25470025
254800     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO25480025
254900         MOVE '8400-GET-PAY-CODE' TO DP013-PARAGRAPH              25490025
255000         MOVE 'MAX RETRIES EXCEEDED ON SELECT PAY CODE'           25500025
255100                                  TO DP013-MESSAGE-TEXT (1)       25510025
255200         MOVE SQLCA               TO DP013-SQLCA                  25520025
255300         MOVE 'TPLNSHP '          TO DP013-DB2-TABLE-NAME (1)     25530025
255400         SET DP013-XCTL-DISPLAY-RESTART                           25540025
255500             DP013-DB2-ABEND      TO TRUE                         25550025
255600         PERFORM 9999-WRITE-CICS-LOG-MSG                          25560025
255700     END-IF.                                                      25570025
255800                                                                  25580025
255900/                                                                 25590025
256000*----------------------------------------------------------------*25600025
256100*    GET THE DUNS NUMBER FROM THE EXTERNAL ENTERPRISE TABLE      *25610025
256200*----------------------------------------------------------------*25620025
256300                                                                  25630025
256400 8500-GET-VENDOR-NUMBER.                                          25640025
256500                                                                  25650025
256600     INITIALIZE DCLTEXTENT.                                       25660025
256700                                                                  25670025
256800     PERFORM                                                      25680025
256900         WITH TEST AFTER                                          25690025
257000         VARYING PV-SELECT-COUNTER                                25700025
257100         FROM 1 BY 1                                              25710025
257200         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              25720025
257300             OR (SQLCODE = +0)                                    25730025
257400             OR (SQLCODE = +100))                                 25740025
257500                                                                  25750025
257600         EXEC SQL                                                 25760025
257700               SELECT DUN_NBR                                     25770025
257800                 INTO :EXTENT-DUN-NBR                             25780025
257900                 FROM TEXTENT                                     25790025
258000                WHERE ENT_ID = :PURCHS-ENT-ID                     25800025
258100                WITH UR                                           25810025
258200         END-EXEC                                                 25820025
258300                                                                  25830025
258400         EVALUATE TRUE                                            25840025
258500             WHEN SQLCODE = +0                                    25850025
258600             WHEN SQLCODE = +100                                  25860025
258700             WHEN SQLCODE = -904                                  25870025
258800             WHEN SQLCODE = -913                                  25880025
258900                  CONTINUE                                        25890025
259000                                                                  25900025
259100             WHEN SQLWARN0 NOT = SPACES                           25910025
259200             WHEN SQLCODE < +0                                    25920025
259300             WHEN SQLCODE > +0                                    25930025
259400                  MOVE '8500-GET-VENDOR-NAME'                     25940025
259500                                  TO DP013-PARAGRAPH              25950025
259600                  MOVE 'UNSUCCESSFUL SELECT OF DUN NBR'           25960025
259700                                  TO DP013-MESSAGE-TEXT (1)       25970025
259800                  MOVE SQLCA      TO DP013-SQLCA                  25980025
259900                  MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)     25990025
260000                  SET DP013-DB2-ABEND                             26000025
260100                      DP013-XCTL-DISPLAY-RESTART                  26010025
260200                                  TO TRUE                         26020025
260300                  PERFORM 9999-WRITE-CICS-LOG-MSG                 26030025
260400         END-EVALUATE                                             26040025
260500     END-PERFORM.                                                 26050025
260600                                                                  26060025
260700     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO26070025
260800         MOVE '8500-GET-VENDOR-NAME'                              26080025
260900                                  TO DP013-PARAGRAPH              26090025
261000         MOVE 'MAX RETRIES EXCEEDED ON SELECT DUN NBR'            26100025
261100                                  TO DP013-MESSAGE-TEXT (1)       26110025
261200         MOVE SQLCA               TO DP013-SQLCA                  26120025
261300         MOVE 'TEXTENT '          TO DP013-DB2-TABLE-NAME (1)     26130025
261400         SET DP013-XCTL-DISPLAY-RESTART                           26140025
261500             DP013-DB2-ABEND      TO TRUE                         26150025
261600         PERFORM 9999-WRITE-CICS-LOG-MSG                          26160025
261700     END-IF.                                                      26170025
261800                                                                  26180025
261900 8550-GET-VENDOR-INHOUSE-NBR.                                     26190025
262000                                                                  26200025
262100     INITIALIZE DCLTVNDDPT.                                       26210025
262200                                                                  26220025
262300     PERFORM                                                      26230025
262400         WITH TEST AFTER                                          26240025
262500         VARYING PV-SELECT-COUNTER                                26250025
262600         FROM 1 BY 1                                              26260025
262700         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              26270025
262800             OR (SQLCODE = +0)                                    26280025
262900             OR (SQLCODE = +100))                                 26290025
263000                                                                  26300025
263100         EXEC SQL                                                 26310025
263200               SELECT INHOUSE_NBR                                 26320025
263300                 INTO :VNDDPT-INHOUSE-NBR                         26330025
263400                 FROM TVNDDPT                                     26340025
263500                WHERE ENT_ID   = :PURCHS-ENT-ID                   26350025
263600                  AND DEPT_NBR = :PURCHS-DEPT-NBR                 26360025
263700         END-EXEC                                                 26370025
263800                                                                  26380025
263900         EVALUATE TRUE                                            26390025
264000             WHEN SQLCODE = +0                                    26400025
264100             WHEN SQLCODE = +100                                  26410025
264200             WHEN SQLCODE = -904                                  26420025
264300             WHEN SQLCODE = -913                                  26430025
264400                  CONTINUE                                        26440025
264500                                                                  26450025
264600             WHEN SQLWARN0 NOT = SPACES                           26460025
264700             WHEN SQLCODE < +0                                    26470025
264800             WHEN SQLCODE > +0                                    26480025
264900                  MOVE '8550-GET-VENDOR-INHOUSE-NBR'              26490025
265000                                  TO DP013-PARAGRAPH              26500025
265100                  MOVE 'UNSUCCESSFUL SELECT OF INHSE NBR'         26510025
265200                                  TO DP013-MESSAGE-TEXT (1)       26520025
265300                  MOVE SQLCA      TO DP013-SQLCA                  26530025
265400                  MOVE 'TVNDDPT ' TO DP013-DB2-TABLE-NAME (1)     26540025
265500                  SET DP013-DB2-ABEND                             26550025
265600                      DP013-XCTL-DISPLAY-RESTART                  26560025
265700                                  TO TRUE                         26570025
265800                  PERFORM 9999-WRITE-CICS-LOG-MSG                 26580025
265900         END-EVALUATE                                             26590025
266000     END-PERFORM.                                                 26600025
266100                                                                  26610025
266200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO26620025
266300         MOVE '8550-GET-VENDOR-INHOUSE-NBR'                       26630025
266400                                  TO DP013-PARAGRAPH              26640025
266500         MOVE 'MAX RETRIES EXCEEDED ON SELECT INHSE NBR'          26650025
266600                                  TO DP013-MESSAGE-TEXT (1)       26660025
266700         MOVE SQLCA               TO DP013-SQLCA                  26670025
266800         MOVE 'TVNDDPT '          TO DP013-DB2-TABLE-NAME (1)     26680025
266900         SET DP013-XCTL-DISPLAY-RESTART                           26690025
267000             DP013-DB2-ABEND      TO TRUE                         26700025
267100         PERFORM 9999-WRITE-CICS-LOG-MSG                          26710025
267200     END-IF.                                                      26720025
267201                                                                  26720125
267202/                                                                 26720200
267203 8600-CALL-XLKUT001.                                              26720325
267204                                                                  26720425
267205     CALL XL001-VSM-PGM  USING DFHEIBLK                           26720525
267206                              XL001-COMMAREA                      26720625
267207                              XL001-ITEM-COMMAREA.                26720725
267208                                                                  26720825
267209     EVALUATE TRUE                                                26720925
267210         WHEN XL001-SUCCESSFUL                                    26721025
267220         WHEN XL001-SKU-NOT-FOUND                                 26722025
267230         WHEN XL001-VND-STYL-NOT-FOUND                            26723025
267240             CONTINUE                                             26724025
267250         WHEN XL001-SQL-ERROR                                     26725025
267260         WHEN XL001-INVALID-ACCESS                                26726025
267270             MOVE XL001-SQLCA      TO DP013-SQLCA                 26727025
267271                                                                  26727125
267272             MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH         26727200
267273             MOVE 'PCKCS011 - DB2 ERROR IN PROGRAM: '             26727300
267274                                      TO DP013-MESSAGE-TEXT (1)   26727400
267275             MOVE 'XLKUT001'          TO DP013-MESSAGE-TEXT (2)   26727500
267276             SET DP013-CICS-ABEND                                 26727600
267277                 DP013-ROLLBACK       TO TRUE                     26727700
267278             PERFORM 9999-WRITE-CICS-LOG-MSG                      26727825
267279         WHEN OTHER                                               26727925
267280             MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH         26728000
267281             MOVE 'PCKCS011 - UNDETERMINED ERROR IN PGM: '        26728100
267282                                      TO DP013-MESSAGE-TEXT (1)   26728200
267283             MOVE 'XLKUT001'          TO DP013-MESSAGE-TEXT (2)   26728300
267284             SET DP013-CICS-ABEND                                 26728400
267285                 DP013-ROLLBACK       TO TRUE                     26728500
267286             PERFORM 9999-WRITE-CICS-LOG-MSG                      26728625
267287     END-EVALUATE.                                                26728725
267288/                                                                 26728800
267289 9999-WRITE-CICS-LOG-MSG.                                         26728925
267290                                                                  26729025
267300     MOVE PC-CURRENT-PROGRAM-NAME TO DP013-PROGRAM.               26730025
267400     MOVE DFHEIBLK               TO DP013-DFHEIBLK.               26740025
267500     INITIALIZE DP013-SRC-TASK-NUMBER                             26750025
267600                DP013-STACK.                                      26760025
267700     SET DP013-LINK-RETURN       TO TRUE.                         26770025
267800                                                                  26780025
267900     IF PS-DRS-NOT-INITIALIZED                                    26790025
268000         MOVE 'A'                TO DRS02-DRIB-CLASS              26800025
268100         MOVE 'N'                TO DRS02-DRIB-HOLD               26810025
268200         MOVE CA-DESTINATION     TO DRS02-DRIB-DEST               26820025
268300         MOVE PC-INIT            TO DRS01-DRRB-FUNC               26830025
268400         MOVE DRS02-DRIB-HEADER  TO DRS01-COMM-DRIB-HDR           26840025
268500         MOVE DRS02-DRIB-ATTRIB  TO DRS01-COMM-DRIB-AT1           26850025
268600         PERFORM 8000-LINK-TO-DRS                                 26860025
268700     END-IF.                                                      26870025
268800     MOVE PC-PUT                   TO DRS01-DRRB-FUNC.            26880025
268900     MOVE SD-SYSTEM-MONTH        TO HL1-RUN-MONTH.                26890025
269000     MOVE SD-SYSTEM-DAY          TO HL1-RUN-DAY.                  26900025
269100     MOVE SD-SYSTEM-YEAR         TO HL1-RUN-YEAR.                 26910025
269200     MOVE ST-SYSTEM-HOUR         TO HL1-RUN-HOUR.                 26920025
269300     MOVE ST-SYSTEM-MINUTE       TO HL1-RUN-MINUTE.               26930025
269400                                                                  26940025
269500     MOVE PC-CONTROL-APRON-RPT-HDR                                26950025
269600                                 TO HL1-RPT-HDR.                  26960025
269700     MOVE PC-CURRENT-PROGRAM-NAME TO HL1-PROGRAM-NAME.            26970025
269800     MOVE 1                      TO HL1-RPT-NBR.                  26980025
269900     MOVE PS-PAGE-SUB            TO HL1-PGE-NBR.                  26990025
270000     MOVE PV-PAGES-REQ           TO HL1-OF-PGE-NBR.               27000025
270100     MOVE HL1-HEADING-LINE-1     TO DRS01-COMM-DATA.              27010025
270200     MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               27020025
270300     PERFORM 8000-LINK-TO-DRS.                                    27030025
270400                                                                  27040025
270500     MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              27050025
270600     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               27060025
270700     PERFORM 8000-LINK-TO-DRS.                                    27070025
270800                                                                  27080025
270900     MOVE CA-DESTINATION         TO HL2-PRINTER-DEST.             27090025
271000     MOVE CA-PREPARER-USER-ID    TO HL3-PREPARER-USER-ID.         27100025
271100     MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              27110025
271200     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27120025
271300     PERFORM 8000-LINK-TO-DRS.                                    27130025
271400                                                                  27140025
271500     MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              27150025
271600     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27160025
271700     PERFORM 8000-LINK-TO-DRS.                                    27170025
271800                                                                  27180025
271900     MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              27190025
272000     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27200025
272100     PERFORM 8000-LINK-TO-DRS.                                    27210025
272200                                                                  27220025
272300     MOVE HL6-HEADING-LINE-6     TO DRS01-COMM-DATA.              27230025
272400     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27240025
272500     PERFORM 8000-LINK-TO-DRS.                                    27250025
272600                                                                  27260025
272700     MOVE HL7-HEADING-LINE-7     TO DRS01-COMM-DATA.              27270025
272800     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27280025
272900     PERFORM 8000-LINK-TO-DRS.                                    27290025
273000                                                                  27300025
273100     MOVE HL8-HEADING-LINE-8     TO DRS01-COMM-DATA.              27310025
273200     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27320025
273300     PERFORM 8000-LINK-TO-DRS.                                    27330025
273400                                                                  27340025
273500     MOVE HL9-HEADING-LINE-9     TO DRS01-COMM-DATA.              27350025
273600     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27360025
273700     PERFORM 8000-LINK-TO-DRS.                                    27370025
273800                                                                  27380025
273900     MOVE HL10-HEADING-LINE-10   TO DRS01-COMM-DATA.              27390025
274000     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27400025
274100     PERFORM 8000-LINK-TO-DRS.                                    27410025
274200                                                                  27420025
274300     MOVE HL11-HEADING-LINE-11   TO DRS01-COMM-DATA.              27430025
274400     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27440025
274500     PERFORM 8000-LINK-TO-DRS.                                    27450025
274600                                                                  27460025
274700     MOVE HL12-HEADING-LINE-12   TO DRS01-COMM-DATA.              27470025
274800     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27480025
274900     PERFORM 8000-LINK-TO-DRS.                                    27490025
275000                                                                  27500025
275100     MOVE HL13-HEADING-LINE-13   TO DRS01-COMM-DATA.              27510025
275200     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27520025
275300     PERFORM 8000-LINK-TO-DRS.                                    27530025
275400                                                                  27540025
275500     MOVE HL14-HEADING-LINE-14   TO DRS01-COMM-DATA.              27550025
275600     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               27560025
275700     PERFORM 8000-LINK-TO-DRS.                                    27570025
275800                                                                  27580025
275900     MOVE DH1-DETAIL-HEADING-LINE-1                               27590025
276000                                 TO DRS01-COMM-DATA.              27600025
276100     MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               27610025
276200     PERFORM 8000-LINK-TO-DRS.                                    27620025
276300                                                                  27630025
276400     MOVE DH2-DETAIL-HEADING-LINE-2                               27640025
276500                                 TO DRS01-COMM-DATA.              27650025
276600     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               27660025
276700     PERFORM 8000-LINK-TO-DRS.                                    27670025
276800                                                                  27680025
276900     MOVE PC-ABEND-MESSAGE         TO  DRS01-COMM-DATA.           27690025
277000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27700025
277100     PERFORM 8000-LINK-TO-DRS.                                    27710025
277200                                                                  27720025
277300     MOVE DP013-PARAGRAPH          TO  DRS01-COMM-DATA.           27730025
277400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27740025
277500     PERFORM 8000-LINK-TO-DRS.                                    27750025
277600     MOVE DP013-MESSAGE-TEXT (1)   TO  DRS01-COMM-DATA.           27760025
277700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27770025
277800     PERFORM 8000-LINK-TO-DRS.                                    27780025
277900     MOVE DP013-MESSAGE-TEXT (2)   TO  DRS01-COMM-DATA.           27790025
278000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27800025
278100     PERFORM 8000-LINK-TO-DRS.                                    27810025
278200     MOVE DP013-MESSAGE-TEXT (3)   TO  DRS01-COMM-DATA.           27820025
278300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27830025
278400     PERFORM 8000-LINK-TO-DRS.                                    27840025
278500     MOVE DP013-DB2-TABLE-NAME (1) TO  DRS01-COMM-DATA.           27850025
278600     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27860025
278700     PERFORM 8000-LINK-TO-DRS.                                    27870025
278800     MOVE DP013-DB2-TABLE-NAME (2) TO  DRS01-COMM-DATA.           27880025
278900     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27890025
279000     PERFORM 8000-LINK-TO-DRS.                                    27900025
279100     MOVE DP013-DB2-TABLE-NAME (3) TO  DRS01-COMM-DATA.           27910025
279200     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            27920025
279300     PERFORM 8000-LINK-TO-DRS.                                    27930025
279400*                                                                 27940025
279500**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               27950025
279600*                                                                 27960025
279700     CALL 'DSNTIAR' USING SQLCA                                   27970025
279800                          DP004-FORMATTED-MESSAGE                 27980025
279900                          DP004-ERROR-LINE-LENGTH.                27990025
280000*                                                                 28000025
280100     MOVE DP004-ASTERISK-LINE      TO  DRS01-COMM-DATA.           28010025
280200     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            28020025
280300     PERFORM 8000-LINK-TO-DRS.                                    28030025
280400                                                                  28040025
280500     PERFORM                                                      28050025
280600         VARYING DP004-MSG-IDX                                    28060025
280700         FROM 1 BY 1                                              28070025
280800         UNTIL DP004-MSG-IDX > DP004-MAX-MESSAGE-LINES            28080025
280900             MOVE DP004-MESSAGE-LINE (DP004-MSG-IDX)              28090025
281000                                   TO  DRS01-COMM-DATA            28100025
281100         MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL             28110025
281200         PERFORM 8000-LINK-TO-DRS                                 28120025
281300     END-PERFORM.                                                 28130025
281400                                                                  28140025
281500*    IF THE PRINTER HAS AUTO CUTTING, SEND THE CUT COMMAND        28150025
281600     IF  CA-PRTR-AUTO-CUTTER-IND = 'Y'                            28160025
281700         MOVE PC-PUT             TO DRS01-DRRB-FUNC               28170025
281800         MOVE DS004-PLC-CUT-FORM TO DRS01-COMM-DATA               28180025
281900         MOVE SPACES             TO DRS01-COMM-CTL                28190025
282000         PERFORM 8000-LINK-TO-DRS                                 28200025
282100     END-IF                                                       28210025
282200                                                                  28220025
282300     MOVE PC-TERM                TO DRS01-DRRB-FUNC.              28230025
282400     PERFORM 8000-LINK-TO-DRS.                                    28240025
282500                                                                  28250025
282600     PERFORM DP013-0000-PROCESS-ABEND.                            28260025
282700                                                                  28270025
282800     EXEC CICS                                                    28280025
282900         RETURN                                                   28290025
283000     END-EXEC.                                                    28300025
283100     COPY DPPD013.                                                28310025
