000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP206.                                        00020000
000300 AUTHOR.         JOHN OBERHAUSER -CPU.                            00030000
000400*DATE-WRITTEN.   MARCH 28 1995.                                   00040000
000500*DATE-COMPILED.                                                   00050000
000600****************************************************************  00060000
000700* COBOL 2                                                      *  00070000
000800*--------------------------------------------------------------*  00080000
000900* EDI REJECTION REPORT PROGRAM                                 *  00090000
001000* (THIS IS A MODIFIED VERSION OF APKRP204)                     *  00100000
001100*--------------------------------------------------------------*  00110000
001200*  NOTE!!!!!                                                   *  00120000
001300*  IF CHANGING THE VALUES OF THE ERROR CODES FOR AP AND EDI,   *  00130000
001400*  CHANGE THE VALUE OF AP-EDIT.  THIS CONTAINS THE AP ERROR    *  00140000
001500*  CODES.  ALL ERROR CODES THAT ARE NOT LISTED HERE, ARE EDI   *  00150000
001600*  ERROR CODES.                                                *  00160000
001700*  WHEN AN ERROR 74 COMES UP, IT IS TREATED AS AN ERROR 80.    *  00170000
001800*  IT WILL PRINT THE EDI-ERR-MSG80.                            *  00180000
001900*--------------------------------------------------------------*  00190000
002000* CHANGE LOG:                                                  *  00200000
002100*                                                              *  00210000
002200* 08/29/94    BY MARILYN WILKINSON                             *  00220000
002300*             CHANGED PROGRAM TO ACCOMODATE A PRE-PRODUCTION   *  00230000
002400*             VERSION                                          *  00240000
002500*                                                              *  00250000
002600* 12/04/97    BY MIKE BESKE                  WR# 5091          *  00260000
002700*             CHANGED ALL OF THE '++INCLUDE' STATEMENTS TO     *  00270000
002800*             'COPY' STATEMENTS TO MEET CURRENT STANDARDS.     *  00280000
002900*                                                              *  00290000
003000* 11/16/99    BY MIKE BESKE                  WR# 5998          *  00300000
003100*             ALTERED THE CODE IN W000-SUMMARY-LINES TO PUT    *  00310000
003200*             ALL ERROR MESSAGES OUT TO THE EDI SUMMARY REPT   *  00320000
003300*             PER REQUEST OF JENNIFER QUAS.                    *  00330000
003400*                                                              *  00340000
003500* 11/17/99    BY MIKE BESKE                  WR# 5998          *  00350000
003600*             REVERSED THE CHANGES FROM 11-16-99.              *  00360000
003700*                                                              *  00370000
003800* 01/24/2000  BY JILL JUEL                   WR# 20675         *  00380000
003900*             CHANGED THE ERROR MESSAGES TO MAKE THEM MORE     *  00390000
004000*             USER FRIENDLY AND DISPLAY THE INVALID FIELD      *  00400000
004100*             WITH THE MESSAGE (ADDED ROUTINE Y100).           *  00410000
004200*                                                              *  00420000
004300* 02/01/2000  BY JILL JUEL                   WR# 20724         *  00430000
004400*             ADDED AP050-SAVE-INTERCHG-CNTL-NBR (ALSO         *  00440000
004500*             KNOWN AS THE ISA NUMBER) TO THE REPORT.          *  00450000
004600*                                                              *  00460000
004700* 02/02/2000 JILL JUEL                      WR#: 20626         *  00470000
004800*            - RECOMPILED PROGRAM. CHANGES WERE MADE TO        *  00480000
004900*              APRD050, APRD051, APRD052, AND APRD056 BY       *  00490000
005000*              THE EDI TEAM.                                   *  00500000
005100*                                                              *  00510000
005200* 07/20/2000 MIKE BESKE                     WR#: 20704         *  00520000
005300*            - REMOVED THE UNUSED ERROR CODES FROM THE 88      *  00530000
005400*              LEVEL VARIABLE AP-EDIT.  THIS WILL MATCH THE    *  00540000
005500*              CLEANUP DONE TO THE APWS050 COPYBOOK.           *  00550000
005600*                                                              *  00560000
005700* 11/10/2000 JILL JUEL                      WR#: 20224         *  00570000
005800*            - ADDED CODE TO INCLUDE THE 824 INDICATOR ON      *  00580000
005900*              THE REPORTS.                                    *  00590000
006000*                                                              *  00600000
006100* 08/08/2002 COLBY HANGER EXPENSE PROCESSING.  RECOMPILE FROM  *  00610000
006200*            PRODUCTION TO INCORPORATE COPYBOOK CHANGES.       *  00620000
006300*        BY: KEVIN CATLIN                   WR#: 23254         *  00630000
006400*                                                              *  00640000
006500*  DATE  05/08/2003                                            *  00650000
006600*      CHANGE MADE: CHANGE NEEDED FOR ARK PO NI-SKU.           *  00660000
006700*      REMOVED ALL REFERENCES FOR AP051-DEPT-NBR, AP051-CLASS, *  00670000
006800*      AP051-SKU-SEQ AND REPLACED WITH AP051-KOHLS-SKU.        *  00680000
006900*      MADE BY: ROLLIN KRING            WR/IR #: WR22557       *  00690000
007000*                                                              *  00700000
007100*  DATE  07/11/2003                                            *  00710000
007200*      CHANGE MADE: COMPOUND PREPACK EDI PROJECT               *  00720000
007300*      ADDED CODE TO HANDLE THE WARNING MESSAGES FROM THE      *  00730000
007400*      DETAIL RECORD 07 THAT HAS PACK HEADER DATA.             *  00740000
007500*      MADE BY: MIKE BESKE              WR/IR #: WR24658       *  00750000
007600*                                                              *  00760000
007700*  DATE  08/12/2003                                            *  00770000
007800*      CHANGE MADE: CORRECTED WHERE THE MOVE OF AP051-PK-      *  00780000
007900*      ITEM-SUMD-COST IS MOVED TO TYPE7-PK-ITEM-SUMD-COST      *  00790000
008000*      TO CORRECT SOC7 ABEND.                                  *  00800000
008100*      MADE BY: MIKE BESKE              WR/IR #: P000574638    *  00810000
008200*                                                              *  00820000
008300*  DATE  10/03/2003                                            *  00830000
008400*      CHANGE MADE: RECOMPILED TO PICK UP THE CHANGE TO THE    *  00840000
008500*      APWS050 COPYBOOK.                                       *  00850000
008600*      MADE BY: MIKE BESKE              WR/IR #: WR25850       *  00860000
008700*                                                              *  00870000
008800*  DATE  03/29/2004                                            *  00880000
008900*      CHANGE MADE: INCREASED THE SIZE FOR THE STORE NUMBERS   *  00890000
009000*      IN TYPE2-LINE2 FROM 3 TO 5.                             *  00900000
009100*      MADE BY: MIKE BESKE              WR/IR #: WR25805       *  00910000
009200*                                                              *  00920000
009300*  DATE  03/11/2007                                            *  00930000
009400*      CHANGE MADE: MATCH BY DC -- ADDED LOGIC TO PARAGRAPH    *  00940000
009500*      Y100-PROCESS-ERROR-MSG FOR ERROR CODES 20, 33, AND 38.  *  00950000
009600*      ALSO ADDED WARNING CODES 28, 29, AND 33 TO AP-EDIT.     *  00960000
009700*      MADE BY: KRYSTEN LEARY           WR/IR #: WR21578       *  00970000
009800*                                                              *  00980000
009900*  DATE  04/23/2007                                            *  00990000
010000*      CHANGE MADE: MODIFIED THE 'WHEN 18' OF THE EVALUATE     *  01000000
010100*      STATEMENT IN PARAGRAPH Y100-PROCESS-ERROR-MSG BY        *  01010000
010200*      REPLACING THE TYPE5-ALLW-CHRG-MTHD WITH HL2-PO-NBR.     *  01020000
010300*      ALSO ADDED WARNING CODE 18 TO AP-EDIT.                  *  01030000
010400*      MADE BY: KRYSTEN LEARY           WR/IR #: WR26018       *  01040000
010500*                                                              *  01050000
010600*  DATE  05/16/2007                                            *  01060000
010700*      CHANGE MADE: ADDED ERROR CODE 71 TO AP-EDIT 88 LEVEL.   *  01070000
010800*      MADE BY: MIKE BESKE              WR/IR #: P001021023    *  01080000
010900*                                                              *  01090000
011000*  DATE  12/19/2007                                            *  01100000
011100*      CHANGE MADE: ADDED ERROR CODE 75 TO AP-EDIT 88 LEVEL.   *  01110000
011200*      ADDED CODE TO DISPLAY THE TOTAL INVOICE LINES COUNT     *  01120000
011300*      AS PART OF THE ERROR CODE 75 MESSAGE.  NEW PARA C650-   *  01130000
011400*      MOD PARA Y100-.  ALSO ADDED NUMEROUS MISSING END-IF STMT*  01140000
011500*      THROUGHOUT THE PROGRAM.                                 *  01150000
011600*      MADE BY: MIKE BESKE              WR/IR #: WR31187       *  01160000
011700*                                                              *  01170095
011800*  DATE  08/01/2014                                            *  01180096
011900*      CHANGE MADE: ADDED A NEW FLAG TO GET A  CONDITION CODE  *  01190095
012000*      AS 0 WHEN THE EDI SUMMARY REPORT GENERATES FOR DIRECT   *  01200095
012100*      SHIP INVOICES ELSE 4095.                                *  01210095
012200*      MADE BY: JAVED (COGNIZANT)       WR/IR #: CHG0087259    *  01220097
012300*                                                              *  01221098
012400*  DATE  11/04/2014                                            *  01222098
012500*      CHANGE MADE: PO EXTENDED DIGIT CHANGES.                 *  01223098
012600*      EXTENDED PO# FROM 7 TO 9.                               *  01224098
012601*      MADE BY: COGNIZANT               WR/IR #: CHG0094517    *  01226098
012300*                                                              *  01227099
012400*  DATE  03/16/2023                                            *  01228099
012500*      CHANGE MADE: RECOMPILE FOR CHGS TO COPYBOOKS APWS050    *  01229099
012600*                   AND APRD051, ADD NEW ERROR REPORT FOR      *  01229199
012600*                   DIRECT IMPORTS EDI ERRORS                  *  01229299
012600*                   CHANGE REPORT NUMBERS TO MATCH FOR PROD    *  01229399
012600*                   VS TEST                                    *  01229499
012601*      MADE BY: JEAN KURK               WR/IR #: CHG0285404    *  01229599
012300*                                                              *  01229699
012400*  DATE  12/05/2023                                            *  01229799
012500*      CHANGE MADE: REMOVE DISPLAY STMTS                       *  01229899
012601*      MADE BY: JEAN KURK               WR/IR #: CHG0297360    *  01230399
012602****************************************************************  01231000
012603                                                                  01240000
012604 ENVIRONMENT DIVISION.                                            01250000
012605 CONFIGURATION SECTION.                                           01260000
012606                                                                  01270000
012607 SOURCE-COMPUTER. IBM-3090.                                       01280000
012608 OBJECT-COMPUTER. IBM-3090.                                       01290000
012609                                                                  01300000
012610 INPUT-OUTPUT SECTION.                                            01310000
012620 FILE-CONTROL.                                                    01320000
012700                                                                  01330000
012800      SELECT EDI-REJ-FILE ASSIGN TO INP01.                        01340000
012900      SELECT EDI-REPORT ASSIGN TO RPT01.                          01350000
013000      SELECT EDI-SUMM-REPORT ASSIGN TO RPT02.                     01360000
013100      SELECT AP-SUMM-REPORT ASSIGN TO RPT03.                      01370000
013100      SELECT AP-DI-EDI-REJ  ASSIGN TO RPT04.                      01371099
013200                                                                  01380000
013300 DATA DIVISION.                                                   01390000
013400 FILE SECTION.                                                    01400000
013500                                                                  01410000
013600 FD  EDI-REJ-FILE                                                 01420000
013700     RECORDING MODE IS F                                          01430000
013800     LABEL RECORDS ARE STANDARD                                   01440000
013900     BLOCK CONTAINS 0 RECORDS                                     01450000
014000     DATA RECORD IS EDI-RECORD.                                   01460000
014100 01  EDI-RECORD                  PIC X(500).                      01470000
014200                                                                  01480000
014300 FD  EDI-REPORT                                                   01490000
014400     RECORDING MODE IS F                                          01500000
014500     LABEL RECORDS ARE STANDARD                                   01510000
014600     RECORD CONTAINS 132 CHARACTERS                               01520000
014700     BLOCK CONTAINS 0 RECORDS                                     01530000
014800     DATA RECORD IS EDI-LINE.                                     01540000
014900 01  EDI-LINE                    PIC X(132).                      01550000
015000                                                                  01560000
015100 FD  EDI-SUMM-REPORT                                              01570000
015200     RECORDING MODE IS F                                          01580000
015300     LABEL RECORDS ARE STANDARD                                   01590000
015400     RECORD CONTAINS 132 CHARACTERS                               01600000
015500     BLOCK CONTAINS 0 RECORDS                                     01610000
015600     DATA RECORD IS EDI-SUMM-LINE.                                01620000
015700 01  EDI-SUMM-LINE               PIC X(132).                      01630000
015800                                                                  01640000
015900 FD  AP-SUMM-REPORT                                               01650000
016000     RECORDING MODE IS F                                          01660000
016100     LABEL RECORDS ARE STANDARD                                   01670000
016200     RECORD CONTAINS 132 CHARACTERS                               01680000
016300     BLOCK CONTAINS 0 RECORDS                                     01690000
016400     DATA RECORD IS AP-SUMM-LINE.                                 01700000
016500 01  AP-SUMM-LINE               PIC X(132).                       01710000
015800                                                                  01711099
015900 FD  AP-DI-EDI-REJ                                                01712099
016000     RECORDING MODE IS F                                          01713099
016100     LABEL RECORDS ARE STANDARD                                   01714099
016200     RECORD CONTAINS 132 CHARACTERS                               01715099
016300     BLOCK CONTAINS 0 RECORDS                                     01716099
016400     DATA RECORD IS AP-DI-REJ-LINE.                               01717099
016500 01  AP-DI-REJ-LINE             PIC X(132).                       01718099
016600                                                                  01720000
016700 WORKING-STORAGE SECTION.                                         01730000
016800*--------------------------------------------------------------*  01740000
016900* STANDARD HEADER 132 COLUMNS                                  *  01750000
017000*--------------------------------------------------------------*  01760000
017100     COPY DPWS132O.                                               01770000
017200                                                                  01780000
017300*--------------------------------------------------------------*  01790000
017400* ERROR MESSAGE CODES DESCRIPTIONS                             *  01800000
017500*--------------------------------------------------------------*  01810000
017600     COPY APWS050.                                                01820000
017700                                                                  01830000
017800*--------------------------------------------------------------*  01840000
017900* EDI REJECTION REPORT FILE LAYOUT                             *  01850000
018000*--------------------------------------------------------------*  01860000
018100 01  WS-EDI-REJECT-REC.                                           01870000
018200     COPY APRD051.                                                01880000
018300                                                                  01890000
018400                                                                  01900000
018500*--------------------------------------------------------------*  01910000
018600* REPORT LINES                                                 *  01920000
018700*--------------------------------------------------------------*  01930000
018800 01  DIVIDE-LINE.                                                 01940000
018900     05  FILLER                  PIC X(132)   VALUE ALL '-'.      01950000
019000                                                                  01960000
019100 01  END-OF-INVOICE-LINE.                                         01970000
019200     05  FILLER                  PIC X(07)     VALUE SPACES.      01980000
019300     05  FILLER                  PIC X(27)     VALUE              01990000
019400             'E N D   O F   I N V O I C E'.                       02000000
019500     05  FILLER                  PIC X(98)     VALUE SPACES.      02010000
019600                                                                  02020000
019700 01  EOR-END-OF-REPORT-LINE.                                      02030000
019800     05  FILLER                  PIC X(37)     VALUE SPACES.      02040000
019900     05  FILLER                  PIC X(25)     VALUE              02050000
020000             'E N D   O F   R E P O R T'.                         02060000
020100     05  FILLER                  PIC X(88)     VALUE SPACES.      02070000
020200                                                                  02080000
020300 01  ERROR-DESC-LINE.                                             02090000
020400     05  FILLER                  PIC X(08)    VALUE               02100000
020500         'ERRORS: '.                                              02110000
020600     05  FILLER                  PIC X(119)   VALUE SPACES.       02120000
020700     05  FILLER                  PIC X(005)   VALUE '*****'.      02130000
020800                                                                  02140000
020900 01  EDI-824-IND-LINE.                                            02150000
021000     05  FILLER                  PIC X(09)    VALUE               02160000
021100         '824 IND: '.                                             02170000
021200     05  EDI-824-IND             PIC X(01)    VALUE SPACES.       02180000
021300     05  FILLER                  PIC X(122)   VALUE SPACES.       02190000
021400                                                                  02200000
021500 01  ERROR-LINE.                                                  02210000
021600     05  ERROR-LINE-AREA.                                         02220000
021700         10  ERROR-LINE-TBL      OCCURS 2 TIMES                   02230000
021800                                 INDEXED BY ERRLN-INDX.           02240000
021900             15  ERR-ASTR-1      PIC X(01).                       02250000
022000             15  ERR-NMBR        PIC X(02).                       02260000
022100             15  ERR-ASTR-2      PIC X(01).                       02270000
022200             15  FILLER          PIC X(01).                       02280000
022300             15  ERR-DATA        PIC X(55).                       02290000
022400             15  FILLER          PIC X(03).                       02300000
022500         10  FILLER              PIC X(12)    VALUE SPACES.       02310000
022600                                                                  02320000
022700 01  ERROR-LINE-EDI.                                              02330000
022800     05  ERROR-LINE-AREA-EDI.                                     02340000
022900         10  ERROR-LINE-TBL-EDI  OCCURS 2 TIMES                   02350000
023000                                 INDEXED BY ERRLN-EDI-INDX.       02360000
023100             15  ERR-ASTR-EDI-1  PIC X(01).                       02370000
023200             15  ERR-NMBR-EDI    PIC X(02).                       02380000
023300             15  ERR-ASTR-EDI-2  PIC X(01).                       02390000
023400             15  FILLER          PIC X(01).                       02400000
023500             15  ERR-DATA-EDI    PIC X(55).                       02410000
023600             15  FILLER          PIC X(03).                       02420000
023700         10  FILLER              PIC X(12)    VALUE SPACES.       02430000
023800                                                                  02440000
023900 01  ERROR-LINE-AP.                                               02450000
024000     05  ERROR-LINE-AREA-AP.                                      02460000
024100         10  ERROR-LINE-TBL-AP   OCCURS 2 TIMES                   02470000
024200                                 INDEXED BY ERRLN-AP-INDX.        02480000
024300             15  ERR-ASTR-AP-1   PIC X(01).                       02490000
024400             15  ERR-NMBR-AP     PIC X(02).                       02500000
024500             15  ERR-ASTR-AP-2   PIC X(01).                       02510000
024600             15  FILLER          PIC X(01).                       02520000
024700             15  ERR-DATA-AP     PIC X(55).                       02530000
024800             15  FILLER          PIC X(03).                       02540000
024900         10  FILLER              PIC X(12)    VALUE SPACES.       02550000
025000                                                                  02560000
025100 01  TYPE1-LINE.                                                  02570000
025200     05  FILLER                  PIC X(32)    VALUE               02580000
025300         'TYPE: 01  INTERCHANGE DATA      '.                      02590000
025400     05  FILLER                  PIC X(100)   VALUE SPACES.       02600000
025500 01  TYPE1-LINE2.                                                 02610000
025600     05  FILLER                  PIC X(25)    VALUE               02620000
025700         'EDI SENDER ID QUALIFIER: '.                             02630000
025800     05  TYPE1-SEND-ID-QUAL      PIC X(02)    VALUE SPACES.       02640000
025900     05  FILLER                  PIC X(04)    VALUE SPACES.       02650000
026000     05  FILLER                  PIC X(15)    VALUE               02660000
026100         'EDI SENDER ID: '.                                       02670000
026200     05  TYPE1-SENDER-ID         PIC X(15)    VALUE SPACES.       02680000
026300     05  FILLER                  PIC X(04)    VALUE SPACES.       02690000
026400     05  FILLER                  PIC X(10)    VALUE               02700000
026500         'EDI TYPE: '.                                            02710000
026600     05  TYPE1-PROD-TEST         PIC X(01)    VALUE SPACES.       02720000
026700     05  FILLER                  PIC X(56)    VALUE SPACES.       02730000
026800 01  TYPE1-LINE3.                                                 02740000
026900     05  FILLER                  PIC X(15)    VALUE               02750000
027000         'INTERCHG DATE: '.                                       02760000
027100     05  TYPE1-INTERCHG-YY       PIC X(02)    VALUE SPACES.       02770000
027200     05  FILLER                  PIC X(01)    VALUE '/'.          02780000
027300     05  TYPE1-INTERCHG-MM       PIC X(02)    VALUE SPACES.       02790000
027400     05  FILLER                  PIC X(01)    VALUE '/'.          02800000
027500     05  TYPE1-INTERCHG-DD       PIC X(02)    VALUE SPACES.       02810000
027600     05  FILLER                  PIC X(04)    VALUE SPACES.       02820000
027700     05  FILLER                  PIC X(06)    VALUE 'TIME: '.     02830000
027800     05  FILLER                  PIC X(01)    VALUE SPACE.        02840000
027900     05  TYPE1-HH                PIC X(02)    VALUE SPACES.       02850000
028000     05  FILLER                  PIC X(01)    VALUE ':'.          02860000
028100     05  TYPE1-MM                PIC X(02)    VALUE SPACES.       02870000
028200     05  FILLER                  PIC X(04)    VALUE SPACES.       02880000
028300     05  FILLER                  PIC X(19)    VALUE               02890000
028400         'INTERCHG CNTL NBR: '.                                   02900000
028500     05  TYPE1-INTERCHG-CNTL     PIC X(09)    VALUE SPACES.       02910000
028600     05  FILLER                  PIC X(02)    VALUE SPACES.       02920000
028700     05  FILLER                  PIC X(13)    VALUE               02930000
028800         'GS CNTL NBR: '.                                         02940000
028900     05  TYPE1-GS-NBR            PIC X(09)    VALUE SPACES.       02950000
029000     05  FILLER                  PIC X(02)    VALUE SPACES.       02960000
029100     05  FILLER                  PIC X(13)    VALUE               02970000
029200         'TS CNTL NBR: '.                                         02980000
029300     05  TYPE1-TS-NBR            PIC X(09)    VALUE SPACES.       02990000
029400     05  FILLER                  PIC X(15)    VALUE SPACES.       03000000
029500                                                                  03010000
029600 01  TYPE2-LINE.                                                  03020000
029700     05  FILLER                  PIC X(32)    VALUE               03030000
029800         'TYPE: 02  INVOICE DATA          '.                      03040000
029900     05  FILLER                  PIC X(100)   VALUE SPACES.       03050000
030000 01  TYPE2-LINE2.                                                 03060000
030100     05  FILLER                  PIC X(11)    VALUE               03070000
030200         'STORE NO1: '.                                           03080000
030300     05  TYPE2-STORE-NBR1        PIC X(05)    VALUE SPACES.       03090000
030400     05  FILLER                  PIC X(04)    VALUE SPACES.       03100000
030500     05  FILLER                  PIC X(11)    VALUE               03110000
030600         'STORE NO2: '.                                           03120000
030700     05  TYPE2-STORE-NBR2        PIC X(05)    VALUE SPACES.       03130000
030800     05  FILLER                  PIC X(04)    VALUE SPACES.       03140000
030900     05  FILLER                  PIC X(19)    VALUE               03150000
031000         'LADING CARRIER ID: '.                                   03160000
031100     05  TYPE2-LAD-CARR          PIC X(16)    VALUE SPACES.       03170000
031200     05  FILLER                  PIC X(57)    VALUE SPACES.       03180000
031300                                                                  03190000
031400 01  TYPE2-LINE3.                                                 03200000
031500     05  FILLER                  PIC X(14)    VALUE               03210000
031600         'INVOICE DATE: '.                                        03220000
031700     05  TYPE2-INV-YY            PIC X(02)    VALUE SPACES.       03230000
031800     05  FILLER                  PIC X(01)    VALUE '/'.          03240000
031900     05  TYPE2-INV-MM            PIC X(02)    VALUE SPACES.       03250000
032000     05  FILLER                  PIC X(01)    VALUE '/'.          03260000
032100     05  TYPE2-INV-DD            PIC X(02)    VALUE SPACES.       03270000
032200     05  FILLER                  PIC X(06)    VALUE SPACES.       03280000
032300     05  FILLER                  PIC X(14)    VALUE               03290000
032400         'DATE SHIPPED: '.                                        03300000
032500     05  TYPE2-SHP-YY            PIC X(02)    VALUE SPACES.       03310000
032600     05  FILLER                  PIC X(01)    VALUE '/'.          03320000
032700     05  TYPE2-SHP-MM            PIC X(02)    VALUE SPACES.       03330000
032800     05  FILLER                  PIC X(01)    VALUE '/'.          03340000
032900     05  TYPE2-SHP-DD            PIC X(02)    VALUE SPACES.       03350000
033000     05  FILLER                  PIC X(06)    VALUE SPACES.       03360000
033100     05  FILLER                  PIC X(16)    VALUE               03370000
033200         'EFFECTIVE DATE: '.                                      03380000
033300     05  TYPE2-EFF-YY            PIC X(02)    VALUE SPACES.       03390000
033400     05  FILLER                  PIC X(01)    VALUE '/'.          03400000
033500     05  TYPE2-EFF-MM            PIC X(02)    VALUE SPACES.       03410000
033600     05  FILLER                  PIC X(01)    VALUE '/'.          03420000
033700     05  TYPE2-EFF-DD            PIC X(02)    VALUE SPACES.       03430000
033800     05  FILLER                  PIC X(52)    VALUE SPACES.       03440000
033900                                                                  03450000
034000 01  TYPE3-LINE.                                                  03460000
034100     05  FILLER                  PIC X(32)    VALUE               03470000
034200         'TYPE: 03  REMIT INSTRUCTIONS    '.                      03480000
034300     05  FILLER                  PIC X(100)   VALUE SPACES.       03490000
034400 01  TYPE3-LINE2.                                                 03500000
034500     05  FILLER                  PIC X(22)    VALUE               03510000
034600         'REMIT VENDOR DUNS NO: '.                                03520000
034700     05  TYPE3-DUNS-NBR          PIC X(09)    VALUE SPACES.       03530000
034800     05  FILLER                  PIC X(03)    VALUE SPACES.       03540000
034900     05  FILLER                  PIC X(15)    VALUE               03550000
035000         'REMIT TO NAME: '.                                       03560000
035100     05  TYPE3-NAME              PIC X(25)    VALUE SPACES.       03570000
035200     05  FILLER                  PIC X(58)    VALUE SPACES.       03580000
035300 01  TYPE3-LINE3.                                                 03590000
035400     05  FILLER                  PIC X(40)    VALUE SPACES.       03600000
035500     05  FILLER                  PIC X(09)    VALUE               03610000
035600         'ADDRESS: '.                                             03620000
035700     05  TYPE3-ADDR1             PIC X(25)    VALUE SPACES.       03630000
035800     05  FILLER                  PIC X(58)    VALUE SPACES.       03640000
035900 01  TYPE3-LINE4.                                                 03650000
036000     05  FILLER                  PIC X(40)    VALUE SPACES.       03660000
036100     05  FILLER                  PIC X(09)    VALUE               03670000
036200         '         '.                                             03680000
036300     05  TYPE3-ADDR2             PIC X(25)    VALUE SPACES.       03690000
036400     05  FILLER                  PIC X(58)    VALUE SPACES.       03700000
036500 01  TYPE3-LINE5.                                                 03710000
036600     05  FILLER                  PIC X(49)    VALUE SPACES.       03720000
036700     05  TYPE3-CITY              PIC X(19)    VALUE SPACES.       03730000
036800     05  FILLER                  PIC X(03)    VALUE SPACES.       03740000
036900     05  TYPE3-STATE             PIC X(02)    VALUE SPACES.       03750000
037000     05  FILLER                  PIC X(01)    VALUE SPACE.        03760000
037100     05  TYPE3-ZIP-5             PIC X(05)    VALUE SPACES.       03770000
037200     05  FILLER                  PIC X(01)    VALUE '-'.          03780000
037300     05  TYPE3-ZIP-4             PIC X(04)    VALUE SPACES.       03790000
037400     05  FILLER                  PIC X(58)    VALUE SPACES.       03800000
037500                                                                  03810000
037600 01  TYPE4-LINE.                                                  03820000
037700     05  FILLER                  PIC X(32)    VALUE               03830000
037800         'TYPE: 04  TERMS DATA            '.                      03840000
037900     05  FILLER                  PIC X(100)   VALUE SPACES.       03850000
038000 01  TYPE4-LINE2.                                                 03860000
038100     05  FILLER                  PIC X(16)    VALUE               03870000
038200         'TERMS TYPE CD:  '.                                      03880000
038300     05  TYPE4-TERMS-TYPE        PIC X(12)    VALUE SPACES.       03890000
038400     05  FILLER                  PIC X(12)    VALUE SPACES.       03900000
038500     05  FILLER                  PIC X(11)    VALUE               03910000
038600         'DISC PCT: '.                                            03920000
038700     05  FILLER                  PIC X(06)    VALUE SPACES.       03930000
038800     05  TYPE4-DISC-PCT          PIC ZZZ.99-.                     03940000
038900     05  FILLER                  PIC X(01)    VALUE '%'.          03950000
039000     05  FILLER                  PIC X(05)    VALUE SPACES.       03960000
039100     05  FILLER                  PIC X(22)    VALUE               03970000
039200         'DEFERRED PCT PAYABLE: '.                                03980000
039300     05  TYPE4-DEF-PCT-PAY       PIC ZZZ.99-.                     03990000
039400     05  FILLER                  PIC X(01)    VALUE '%'.          04000000
039500     05  FILLER                  PIC X(32)    VALUE SPACES.       04010000
039600 01  TYPE4-LINE3.                                                 04020000
039700     05  FILLER                  PIC X(22)    VALUE               04030000
039800         'TERMS BASIS DATE CD:  '.                                04040000
039900     05  TYPE4-BAS-DTE-CD        PIC X(12)    VALUE SPACES.       04050000
040000     05  FILLER                  PIC X(06)    VALUE SPACES.       04060000
040100     05  FILLER                  PIC X(15)    VALUE               04070000
040200         'DISC DUE DATE: '.                                       04080000
040300     05  TYPE4-DISC-DUE-YY       PIC X(02)    VALUE SPACES.       04090000
040400     05  FILLER                  PIC X(01)    VALUE '/'.          04100000
040500     05  TYPE4-DISC-DUE-MM       PIC X(02)    VALUE SPACES.       04110000
040600     05  FILLER                  PIC X(01)    VALUE '/'.          04120000
040700     05  TYPE4-DISC-DUE-DD       PIC X(02)    VALUE SPACES.       04130000
040800     05  FILLER                  PIC X(07)    VALUE SPACES.       04140000
040900     05  FILLER                  PIC X(20)    VALUE               04150000
041000         'DEFERRED DUE DATE:  '.                                  04160000
041100     05  TYPE4-DEF-DUE-YY        PIC X(02)    VALUE SPACES.       04170000
041200     05  FILLER                  PIC X(01)    VALUE '/'.          04180000
041300     05  TYPE4-DEF-DUE-MM        PIC X(02)    VALUE SPACES.       04190000
041400     05  FILLER                  PIC X(01)    VALUE '/'.          04200000
041500     05  TYPE4-DEF-DUE-DD        PIC X(02)    VALUE SPACES.       04210000
041600     05  FILLER                  PIC X(03)    VALUE SPACES.       04220000
041700     05  FILLER                  PIC X(32)    VALUE SPACES.       04230000
041800 01  TYPE4-LINE4.                                                 04240000
041900     05  FILLER                  PIC X(16)    VALUE               04250000
042000         'NET DUE DATE :  '.                                      04260000
042100     05  TYPE4-NET-DUE-YY        PIC X(02)    VALUE SPACES.       04270000
042200     05  FILLER                  PIC X(01)    VALUE '/'.          04280000
042300     05  TYPE4-NET-DUE-MM        PIC X(02)    VALUE SPACES.       04290000
042400     05  FILLER                  PIC X(01)    VALUE '/'.          04300000
042500     05  TYPE4-NET-DUE-DD        PIC X(02)    VALUE SPACES.       04310000
042600     05  FILLER                  PIC X(16)    VALUE SPACES.       04320000
042700     05  FILLER                  PIC X(15)    VALUE               04330000
042800         'DISC DAYS DUE: '.                                       04340000
042900     05  TYPE4-DISC-DAYS-DUE     PIC ZZ9      VALUE ZEROS.        04350000
043000     05  FILLER                  PIC X(12)    VALUE SPACES.       04360000
043100     05  FILLER                  PIC X(23)    VALUE               04370000
043200         'NET DEFERRED DAYS DUE: '.                               04380000
043300     05  FILLER                  PIC X(02)    VALUE SPACES.       04390000
043400     05  TYPE4-NET-DEF-DAYS      PIC ZZ9.                         04400000
043500     05  FILLER                  PIC X(06)    VALUE SPACES.       04410000
043600     05  FILLER                  PIC X(32)    VALUE SPACES.       04420000
043700 01  TYPE4-LINE5.                                                 04430000
043800     05  FILLER                  PIC X(40)    VALUE SPACES.       04440000
043900     05  FILLER                  PIC X(10)    VALUE               04450000
044000         'DISC AMT: '.                                            04460000
044100     05  TYPE4-DISC-AMT          PIC $$$$,$$$.99-.                04470000
044200     05  FILLER                  PIC X(08)    VALUE SPACES.       04480000
044300     05  FILLER                  PIC X(14)    VALUE               04490000
044400         'DEFERRED AMT: '.                                        04500000
044500     05  FILLER                  PIC X(03)    VALUE SPACES.       04510000
044600     05  TYPE4-DEF-AMT           PIC $$$$,$$$.99-.                04520000
044700     05  FILLER                  PIC X(01)    VALUE SPACES.       04530000
044800     05  FILLER                  PIC X(32)    VALUE SPACES.       04540000
044900                                                                  04550000
045000 01  TYPE5-LINE.                                                  04560000
045100     05  FILLER                  PIC X(32)    VALUE               04570000
045200         'TYPE: 05  ALLOWANCE/CHARGE DATA '.                      04580000
045300     05  FILLER                  PIC X(100)   VALUE SPACES.       04590000
045400 01  TYPE5-LINE2.                                                 04600000
045500     05  FILLER                  PIC X(16)    VALUE               04610000
045600         'ALLW/CHRG TYPE: '.                                      04620000
045700     05  TYPE5-ALLW-CHRG-TYPE    PIC X(11)   VALUE SPACE.         04630000
045800     05  FILLER                  PIC X(08)   VALUE SPACES.        04640000
045900     05  FILLER                  PIC X(16)   VALUE                04650000
046000         'ALLW/CHRG CODE: '.                                      04660000
046100     05  TYPE5-ALLW-CHRG-CD      PIC X(16)   VALUE SPACES.        04670000
046200     05  FILLER                  PIC X(02)   VALUE SPACES.        04680000
046300     05  FILLER                  PIC X(16)   VALUE                04690000
046400         'SPEC SRVC CODE: '.                                      04700000
046500     05  TYPE5-SPEC-SRVC-CD      PIC X(10)   VALUE SPACES.        04710000
046600     05  FILLER                  PIC X(02)   VALUE SPACES.        04720000
046700     05  FILLER                  PIC X(18)   VALUE                04730000
046800         'ALLW/CHRG METHOD: '.                                    04740000
046900     05  TYPE5-ALLW-CHRG-MTHD    PIC X(12)   VALUE SPACES.        04750000
047000     05  FILLER                  PIC X(19)   VALUE SPACES.        04760000
047100 01  TYPE5-LINE3.                                                 04770000
047200     05  FILLER                  PIC X(17)   VALUE                04780000
047300         'ALLW/CHRG TOTAL: '.                                     04790000
047400     05  TYPE5-ALLW-CHRG-TOTL    PIC $$$,$$$,$$$.99-.             04800000
047500     05  FILLER                  PIC X(03)   VALUE SPACES.        04810000
047600     05  FILLER                  PIC X(15)   VALUE                04820000
047700         'ALLW/CHRG PCT: '.                                       04830000
047800     05  TYPE5-ALLW-CHRG-PCT     PIC ZZZ.99-.                     04840000
047900     05  FILLER                  PIC X(01)   VALUE '%'.           04850000
048000     05  FILLER                  PIC X(11)   VALUE SPACES.        04860000
048100     05  FILLER                  PIC X(25)   VALUE                04870000
048200         'ALLW/CHRG PCT QUALIFIER: '.                             04880000
048300     05  TYPE5-ALLW-CHRG-QUAL    PIC X(10)   VALUE SPACE.         04890000
048400     05  FILLER                  PIC X(23)   VALUE SPACES.        04900000
048500                                                                  04910000
048600 01  TYPE6-LINE.                                                  04920000
048700     05  FILLER                  PIC X(32)    VALUE               04930000
048800         'TYPE: 06  SUMMARY DATA          '.                      04940000
048900     05  FILLER                  PIC X(100)   VALUE SPACES.       04950000
049000 01  TYPE6-LINE2.                                                 04960000
049100     05  FILLER                  PIC X(20)    VALUE               04970000
049200         'QUANTITY SHIPPED:   '.                                  04980000
049300     05  TYPE6-QTY-SHIP          PIC ZZ,ZZZ,ZZZ.99-.              04990000
049400     05  FILLER                  PIC X(02)    VALUE SPACES.       05000000
049500     05  FILLER                  PIC X(25)    VALUE               05010000
049600         'SHIPPED UNIT OF MEASURE: '.                             05020000
049700     05  TYPE6-SHIP-UOM          PIC X(09)    VALUE SPACES.       05030000
049800     05  FILLER                  PIC X(62)    VALUE SPACES.       05040000
049900 01  TYPE6-LINE3.                                                 05050000
050000     05  FILLER                  PIC X(19)    VALUE               05060000
050100         'GROSS INVOICE AMT: '.                                   05070000
050200     05  TYPE6-GROSS-INV-AMT     PIC $$$,$$$,$$$.99-.             05080000
050300     05  FILLER                  PIC X(02)    VALUE SPACES.       05090000
050400     05  FILLER                  PIC X(18)    VALUE               05100000
050500         'AMT SUBJ TO DISC: '.                                    05110000
050600     05  TYPE6-AMT-SUBJ-DISC     PIC $$$,$$$,$$$.99-.             05120000
050700     05  FILLER                  PIC X(02)    VALUE SPACES.       05130000
050800     05  FILLER                  PIC X(10)    VALUE               05140000
050900         'DISC AMT: '.                                            05150000
051000     05  TYPE6-DISC-AMT          PIC $$$,$$$,$$$.99-.             05160000
051100     05  FILLER                  PIC X(02)    VALUE SPACES.       05170000
051200     05  FILLER                  PIC X(14)    VALUE               05180000
051300         'DISC AMT DUE: '.                                        05190000
051400     05  TYPE6-DISC-AMT-DUE      PIC $$$,$$$,$$$.99-.             05200000
051500     05  FILLER                  PIC X(03)    VALUE SPACES.       05210000
051600                                                                  05220000
051700 01  TYPE7-LINE.                                                  05230000
051800     05  FILLER                  PIC X(32)    VALUE               05240000
051900         'TYPE: 07  DETAIL INVOICE DATA   '.                      05250000
052000     05  FILLER                  PIC X(100)   VALUE SPACES.       05260000
052100 01  TYPE7-LINE2.                                                 05270000
052200     05  FILLER                  PIC X(14)    VALUE               05280000
052300         'ID QUALIFIER: '.                                        05290000
052400     05  TYPE7-ID-QUAL           PIC X(02)    VALUE SPACES.       05300000
052500     05  FILLER                  PIC X(04)    VALUE SPACES.       05310000
052600     05  FILLER                  PIC X(04)    VALUE SPACES.       05320000
052700     05  TYPE7-UPC-TITLE         PIC X(10).                       05330000
052800     05  TYPE7-EAN-UPC           PIC X(16)    VALUE SPACES.       05340000
052900     05  FILLER                  PIC X(10)    VALUE               05350000
053000         '     SKU: '.                                            05360000
053100     05  TYPE7-SKU               PIC X(08)    VALUE SPACES.       05370000
053200     05  FILLER                  PIC X(92)    VALUE SPACES.       05380000
053300 01  TYPE7-LINE3.                                                 05390000
053400     05  FILLER                  PIC X(14)    VALUE               05400000
053500         'VENDOR STYLE: '.                                        05410000
053600     05  TYPE7-VNDR-STYLE        PIC X(20)    VALUE SPACES.       05420000
053700     05  FILLER                  PIC X(06)    VALUE SPACES.       05430000
053800     05  FILLER                  PIC X(17)    VALUE               05440000
053900         'NORMAL COLOR CD: '.                                     05450000
054000     05  TYPE7-NRML-CD           PIC X(03)    VALUE SPACES.       05460000
054100     05  FILLER                  PIC X(20)    VALUE SPACES.       05470000
054200     05  FILLER                  PIC X(11)    VALUE               05480000
054300         'SIZE CD:   '.                                           05490000
054400     05  TYPE7-SIZE-CD           PIC X(05)    VALUE SPACES.       05500000
054500     05  FILLER                  PIC X(36)    VALUE SPACES.       05510000
054600 01  TYPE7-LINE4.                                                 05520000
054700     05  FILLER                  PIC X(14)    VALUE               05530000
054800         'STYLE DESC:   '.                                        05540000
054900     05  TYPE7-VNDR-STYLE-DESC   PIC X(25)    VALUE SPACES.       05550000
055000     05  FILLER                  PIC X(01)    VALUE SPACES.       05560000
055100     05  FILLER                  PIC X(12)    VALUE               05570000
055200         'COLOR DESC: '.                                          05580000
055300     05  TYPE7-COLOR-DESC        PIC X(25)    VALUE SPACES.       05590000
055400     05  FILLER                  PIC X(03)    VALUE SPACES.       05600000
055500     05  FILLER                  PIC X(11)    VALUE               05610000
055600         'SIZE DESC: '.                                           05620000
055700     05  TYPE7-SIZE-DESC         PIC X(25)    VALUE SPACES.       05630000
055800     05  FILLER                  PIC X(56)    VALUE SPACES.       05640000
055900 01  TYPE7-LINE5.                                                 05650000
056000     05  FILLER                  PIC X(19)    VALUE               05660000
056100         'QUANTITY INVOICED: '.                                   05670000
056200     05  TYPE7-QTY-INVD          PIC ZZZ,ZZZ.99-.                 05680000
056300     05  FILLER                  PIC X(10)    VALUE SPACES.       05690000
056400     05  FILLER                  PIC X(17)    VALUE               05700000
056500         'UNIT OF MEASURE: '.                                     05710000
056600     05  TYPE7-UOM               PIC X(09)    VALUE SPACES.       05720000
056700     05  FILLER                  PIC X(04)    VALUE SPACES.       05730000
056800     05  FILLER                  PIC X(10)    VALUE SPACES.       05740000
056900     05  TYPE7-UNT-CST-TITLE     PIC X(11).                       05750000
057000     05  TYPE7-WHOL-COST         PIC $$,$$$,$$$.99-.              05760000
057100     05  FILLER                  PIC X(27)    VALUE SPACES.       05770000
057200                                                                  05780000
057300 01  TYPE7-LINE6.                                                 05790000
057400     05  FILLER                  PIC X(22)    VALUE               05800000
057500         'PACKITEM SUMMED COST: '.                                05810000
057600     05  TYPE7-PK-ITEM-SUMD-COST PIC $$,$$$,$$$.99-.              05820000
057700     05  FILLER                  PIC X(96)    VALUE SPACES.       05830000
057800                                                                  05840000
057900 01  TYPE-OTH-LINE.                                               05850000
058000     05  FILLER                  PIC X(06)    VALUE               05860000
058100         'TYPE: '.                                                05870000
058200     05  TYPE-OTH-REC-TYPE       PIC X(02)    VALUE SPACES.       05880000
058300     05  FILLER                  PIC X(02)    VALUE SPACES.       05890000
058400     05  FILLER                  PIC X(22)    VALUE SPACES.       05900000
058500     05  FILLER                  PIC X(100)   VALUE SPACES.       05910000
058600                                                                  05920000
058700 01  CALC-GROSS-LINE.                                             05930000
058800     05  FILLER                  PIC X(32)    VALUE               05940000
058900         'CALCULATED INVOICE EXTENSION =  '.                      05950000
059000     05  CALC-GROSS-EXTEN        PIC $$$$,$$$,$$$.99-.            05960000
059100     05  FILLER                  PIC X(20)    VALUE               05970000
059200         '  GROSS INVOICED =  '.                                  05980000
059300     05  GROSS-INVOICED          PIC $$$$,$$$,$$$.99-.            05990000
059400     05  FILLER                  PIC X(084)   VALUE SPACES.       06000000
059500                                                                  06010000
059600*--------------------------------------------------------------*  06020000
059700* REPORT HEADING LINES                                         *  06030000
059800*--------------------------------------------------------------*  06040000
059900 01  HL-HEADING-LINE1.                                            06050000
060000     05  FILLER                  PIC X(50)     VALUE SPACES.      06060000
060100     05  FILLER                  PIC X(30)     VALUE              06070000
060200             ' EDI INVOICE REJECTION REPORT '.                    06080000
060300     05  FILLER                  PIC X(05)     VALUE SPACES.      06090000
060400     05  HEADER-TYPE             PIC X(25)     VALUE SPACES.      06100000
060500     05  FILLER                  PIC X(20)     VALUE SPACES.      06110000
060600                                                                  06120000
060700 01  HL-HEADING-LINE2.                                            06130000
060800     05  FILLER                  PIC X(15)     VALUE              06140000
060900         'VENDOR DUN NO: '.                                       06150000
061000     05  HL2-VENDOR-NBR          PIC ZZZZZZZZ9.                   06160000
061100     05  FILLER                  PIC X(02)     VALUE SPACES.      06170000
061200     05  HL2-ENT-ID-DESC         PIC X(25)     VALUE SPACES.      06180000
061300     05  FILLER                  PIC X(04)     VALUE SPACES.      06190000
061400     05  FILLER                  PIC X(11)     VALUE              06200000
061500         'INVOICE # '.                                            06210000
061600     05  HL2-INVOICE-NBR         PIC X(22)     VALUE SPACES.      06220000
061700     05  FILLER                  PIC X(07)     VALUE SPACES.      06230000
061800     05  FILLER                  PIC X(05)     VALUE 'PO # '.     06240000
061900     05  HL2-PO-NBR              PIC ZZZZZZZZ9.                   06250098
062000     05  FILLER                  PIC X(02)     VALUE SPACES.      06260098
062100     05  FILLER                  PIC X(06)     VALUE 'ISA # '.    06270000
062200     05  HL2-INTERCHG-CNTL-NBR   PIC ZZZZZZZZ9.                   06280000
062300                                                                  06290000
062400 01  HL-HEADING-LINE1-2-EDI.                                      06300000
062500     05  FILLER                  PIC X(46)     VALUE SPACES.      06310000
062600     05  FILLER                  PIC X(38)     VALUE              06320000
062700             ' SUMMARY EDI INVOICE REJECTION REPORT '.            06330000
062800     05  FILLER                  PIC X(05)     VALUE SPACES.      06340000
062900     05  HEADER-TYPE1-2-EDI      PIC X(25)     VALUE SPACES.      06350000
063000     05  FILLER                  PIC X(16)     VALUE SPACES.      06360000
063100                                                                  06370000
063200 01  HL-HEADING-LINE1-2-AP.                                       06380000
063300     05  FILLER                  PIC X(46)     VALUE SPACES.      06390000
063400     05  FILLER                  PIC X(38)     VALUE              06400000
063500             ' SUMMARY AP INVOICE REJECTION REPORT '.             06410000
063600     05  FILLER                  PIC X(05)     VALUE SPACES.      06420000
063700     05  HEADER-TYPE1-2-AP       PIC X(25)     VALUE SPACES.      06430000
063800     05  FILLER                  PIC X(16)     VALUE SPACES.      06440000
063900                                                                  06450000
064000 01  NO-DATA-LINE.                                                06460000
064100     05  FILLER                  PIC X(44)     VALUE SPACES.      06470000
064200     05  FILLER                  PIC X(41)     VALUE              06480000
064300             ' NO REJECTION INVOICES FOR THIS RUN      '.         06490000
064400     05  FILLER                  PIC X(46)     VALUE SPACES.      06500000
064500                                                                  06510000
064600                                                                  06520000
064700 01  PC-PROGRAM-CONSTANTS.                                        06530000
064800     05  PC-SLASH                PIC X(01)     VALUE '/'.         06540000
064900     05  PC-DASH                 PIC X(01)     VALUE '-'.         06550000
065000 01  PV-PROGRAM-VARIABLES.                                        06560000
065100     05  PV-ABEND-CODE           PIC S9(04)    VALUE ZEROES       06570000
065200                                               COMP.              06580000
065300                                                                  06590000
065400     05  PV-PROGRAM-NAME         PIC X(08)     VALUE 'APKRP206'.  06600000
065500     05  PV-LINE-COUNT           PIC S9(03)    VALUE ZEROES       06610000
065600                                               COMP-3.            06620000
065700     05  PV-LINE-COUNT-2         PIC S9(03)    VALUE ZEROES       06630000
065800                                               COMP-3.            06640000
065900     05  PV-LINE-COUNT-2-EDI     PIC S9(03)    VALUE ZEROES       06650000
066000                                               COMP-3.            06660000
066100     05  PV-LINE-COUNT-2-AP      PIC S9(03)    VALUE ZEROES       06670000
066200                                               COMP-3.            06680000
066100     05  PV-LINE-COUNT-DI        PIC 9(03)     VALUE 100.         06681099
066300     05  PV-LINE-LIMIT           PIC S9(03)    VALUE +60          06690000
066400                                               COMP-3.            06700000
066500     05  PV-PAGE-COUNT           PIC S9(06)    VALUE ZEROES       06710000
066600                                               COMP-3.            06720000
066700     05  PV-PAGE-COUNT-2-EDI     PIC S9(06)    VALUE ZEROES       06730000
066800                                               COMP-3.            06740000
066900     05  PV-PAGE-COUNT-2-AP      PIC S9(06)    VALUE ZEROES       06750000
067000                                               COMP-3.            06760000
066900     05  PV-PAGE-COUNT-DI        PIC S9(06)    VALUE ZEROES       06761099
067000                                               COMP-3.            06762099
067100     05  PV-EDI-ERROR-MSG        PIC X(75)     VALUE SPACES.      06770000
067200     05  PV-AP-EDIT-CODE         PIC 9(02)     VALUE ZERO.        06780000
067300     05  PV-DISC-AMT-DUE         PIC 999,999,999.99-.             06790000
067400     05  PV-GROSS-INV-AMT        PIC 999,999,999.99-.             06800000
067500     05  PV-TOT-INVC-LINES       PIC ZZ,ZZZ,ZZ9.                  06810000
067500     05  PV-NEXUS-COUNT          PIC 9(5) VALUE ZERO.             06811099
067500     05  PV-NEXUS-INVC           PIC X(1) VALUE 'N'.              06812099
005300         88  PV-NEXUS-INVC-YES      VALUE 'Y'.                    06813099
005400         88  PV-NEXUS-INVC-NO       VALUE 'N'.                    06814099
067600                                                                  06820000
067700 01  WS-PROGRAM-SWITCHES.                                         06830000
067800     05  WS-EDI-REJ-EOF-SW       PIC X(01)    VALUE 'N'.          06840000
067900         88  WS-EDI-REJ-EOF          VALUE 'Y'.                   06850000
068000     05  WS-EDI-EMPTY-FILE-SW    PIC X(01)    VALUE 'N'.          06860000
068100         88  WS-EDI-REJ-EMPTY-FILE   VALUE 'Y'.                   06870000
068200     05  WS-ERR-DETAIL-GROSS-INV PIC X(01)    VALUE 'N'.          06880000
068300         88  ERR-DETAIL-GROSS-INVOICE         VALUE 'Y'.          06890000
068400         88  NO-ERR-DETAIL-GROSS-INVOICE      VALUE 'N'.          06900000
068500     05  WS-AP-ERR-LINE-SWITCH   PIC X(01)    VALUE 'N'.          06910000
068600         88  AP-ERR-LINE                      VALUE 'Y'.          06920000
068700         88  NO-AP-ERR-LINE                   VALUE 'N'.          06930000
068800     05  WS-EDI-ERR-LINE-SWITCH  PIC X(01)    VALUE 'N'.          06940000
068900         88  EDI-ERR-LINE                     VALUE 'Y'.          06950000
069000         88  NO-EDI-ERR-LINE                  VALUE 'N'.          06960000
069100     05  WS-EDI-FIRST-TIME-SWITCH  PIC X(01)  VALUE 'Y'.          06970000
069200         88  EDI-FIRST-TIME                   VALUE 'Y'.          06980000
069300         88  EDI-NOT-FIRST-TIME               VALUE 'N'.          06990000
069400     05  WS-AP-FIRST-TIME-SWITCH   PIC X(01)  VALUE 'Y'.          07000000
069500         88  AP-FIRST-TIME                    VALUE 'Y'.          07010000
069600         88  AP-NOT-FIRST-TIME                VALUE 'N'.          07020000
069802     05  WS-AP-EDIT-CODE         PIC 9(02)    VALUE ZERO.         07060000
069803         88  AP-EDIT                                              07070000
069900             VALUE 06 50 65 74 80 28 29 33 18 71 75.              07080000
070000                                                                  07090000
070100 01  REPORT-TYPE-CONTROL         PIC X(01)     VALUE SPACE.       07100000
070200                                                                  07110000
070300 01  SD-SYSTEM-DATE.                                              07120000
070400     05  SD-SYSTEM-YEAR          PIC 9(02)     VALUE ZEROES.      07130000
070500     05  SD-SYSTEM-MONTH         PIC 9(02)     VALUE ZEROES.      07140000
070600     05  SD-SYSTEM-DAY           PIC 9(02)     VALUE ZEROES.      07150000
070700                                                                  07160000
070800 01  ST-SYSTEM-TIME.                                              07170000
070900     05  ST-SYSTEM-HOUR          PIC 9(02)     VALUE ZEROES.      07180000
071000     05  ST-SYSTEM-MINUTE        PIC 9(02)     VALUE ZEROES.      07190000
071100     05  FILLER                  PIC X(04)     VALUE SPACES.      07200000
071200                                                                  07210000
071300 01  SUMM-ERR-TABLE.                                              07220000
071400     05  SUMM-ERR-FLAG-AREA      OCCURS 99 TIMES                  07230000
071500                                 INDEXED BY FLG-INDX.             07240000
071600         10  SUMM-ERR-FLAG       PIC X(01).                       07250000
071700                                                                  07260000
071800*------------------------*                                        07270000
071900 PROCEDURE DIVISION.                                              07280000
072000*------------------------*                                        07290000
072100 A000-MAIN-DRIVER.                                                07300000
072200                                                                  07310000
072300*--------------------------------------------------------------*  07320000
072400* THIS MODULE CONTROLS THE OVERALL FLOW OF THE PROGRAM THROUGH *  07330000
072500* TO ITS END.                                                  *  07340000
072600*--------------------------------------------------------------*  07350000
072700                                                                  07360000
072800     OPEN INPUT  EDI-REJ-FILE                                     07370000
072900          OUTPUT EDI-REPORT                                       07380000
073000                 EDI-SUMM-REPORT                                  07390000
073000                 AP-DI-EDI-REJ                                    07391099
073100                 AP-SUMM-REPORT.                                  07400000
073200                                                                  07410000
073300     PERFORM H000-HOUSEKEEPING.                                   07420000
073400     IF NOT WS-EDI-REJ-EMPTY-FILE                                 07430000
073500        PERFORM B000-PROCESS                                      07440000
073600             UNTIL WS-EDI-REJ-EOF                                 07450000
073700     END-IF.                                                      07460000
073800     PERFORM Z900-END-OF-JOB.                                     07470000
073900     STOP RUN.                                                    07480000
074000                                                                  07490000
074100*--------------------------------------------------------------*  07500000
074200* PROCESS THE EDI TRANSMISSION REJECTED INVOICES               *  07510000
074300*--------------------------------------------------------------*  07520000
074400 B000-PROCESS.                                                    07530000
074500                                                                  07540000
074600     IF AP051-SORT-INVOICE-NBR NOT = HL2-INVOICE-NBR              07550000
074700        PERFORM W000-SUMMARY-LINES                                07560000
074800        PERFORM W700-END-OF-INVOICE-LINE                          07570000
074900        MOVE AP051-SORT-VENDOR-NBR     TO HL2-VENDOR-NBR          07580000
075000        MOVE AP051-SORT-INVOICE-NBR    TO HL2-INVOICE-NBR         07590000
075100        MOVE AP051-KOHLS-PO-NBR        TO HL2-PO-NBR              07600000
075200        SET NO-ERR-DETAIL-GROSS-INVOICE TO TRUE                   07610000
075300        MOVE AP051-VENDOR-DESC         TO HL2-ENT-ID-DESC         07620000
075400        MOVE AP051-SAVE-INTERCHG-CNTL-NBR TO HL2-INTERCHG-CNTL-NBR07630000
075500        MOVE AP051-EDI-824-IND            TO EDI-824-IND          07640000
080700        MOVE AP051-ADDL-NEXUS-INVC     TO PV-NEXUS-INVC           07641099
080700        IF PV-NEXUS-INVC-YES                                      07643099
080700            ADD 1 TO PV-NEXUS-COUNT                               07644099
080700        END-IF                                                    07645099
075600        PERFORM W200-HEADING-ROUTINE                              07650000
075700     END-IF.                                                      07660000
075800                                                                  07670000
075900     EVALUATE AP051-RECORD-TYPE-IND                               07680000
076000        WHEN '01'                                                 07690000
076100             PERFORM C000-TYPE1                                   07700000
076200        WHEN '02'                                                 07710000
076300             PERFORM C100-TYPE2                                   07720000
076400        WHEN '03'                                                 07730000
076500             PERFORM C200-TYPE3                                   07740000
076600        WHEN '04'                                                 07750000
076700             PERFORM C300-TYPE4                                   07760000
076800        WHEN '05'                                                 07770000
076900             PERFORM C400-TYPE5                                   07780000
077000        WHEN '06'                                                 07790000
077100             PERFORM C500-TYPE6                                   07800000
077200        WHEN '07'                                                 07810000
077300             PERFORM C600-TYPE7                                   07820000
077400** THE FOLLOWING IS CHECKING FOR HIGH-VALUES **                   07830000
077500        WHEN HIGH-VALUES                                          07840000
077600             PERFORM C650-HIGH-VALUES                             07850000
077700        WHEN OTHER                                                07860000
077800             PERFORM C700-INVALID-TYPE                            07870000
077900     END-EVALUATE.                                                07880000
078000                                                                  07890000
078100** CHECK FOR ERRORS IN THE ERROR CODE AREA **                     07900000
078200     IF AP051-ERR-CD(1) = 0                                       07910000
078300        NEXT SENTENCE                                             07920000
078400     ELSE                                                         07930000
078500        PERFORM E100-ERROR-ROUTINE                                07940000
078600     END-IF.                                                      07950000
078700                                                                  07960000
078800     PERFORM W400-PRINT-DIVIDE-LINE.                              07971099
078900                                                                  07980000
079000     PERFORM R100-READ-EDI-REJECT.                                07990000
079100                                                                  08000000
079200*--------------------------------------------------------------*  08010000
079300* PROCESS THE INTERCHANGE RECORD                               *  08020000
079400*--------------------------------------------------------------*  08030000
079500 C000-TYPE1.                                                      08040000
079600                                                                  08050000
079700     MOVE AP051-EDI-SENDER-ID-QUAL   TO TYPE1-SEND-ID-QUAL.       08060099
079800     MOVE AP051-EDI-SENDER-ID        TO TYPE1-SENDER-ID.          08070099
079900     MOVE AP051-INTERCHG-DTE-YY      TO TYPE1-INTERCHG-YY.        08080099
080000     MOVE AP051-INTERCHG-DTE-MM      TO TYPE1-INTERCHG-MM.        08090099
080100     MOVE AP051-INTERCHG-DTE-DD      TO TYPE1-INTERCHG-DD.        08100099
080200     MOVE AP051-INTERCHG-TME-HH      TO TYPE1-HH.                 08110099
080300     MOVE AP051-INTERCHG-TME-MM      TO TYPE1-MM.                 08120099
080400     MOVE AP051-INTERCHG-CNTL-NBR    TO TYPE1-INTERCHG-CNTL.      08130099
080500     MOVE AP051-GS-CNTL-NBR          TO TYPE1-GS-NBR.             08140099
080600     MOVE AP051-TS-CNTL-NBR          TO TYPE1-TS-NBR.             08150099
080700     MOVE AP051-PROD-TEST-IND        TO TYPE1-PROD-TEST.          08160099
080800                                                                  08170000
080900     ADD 4 TO PV-LINE-COUNT.                                      08180099
081000     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            08190099
081100        PERFORM W200-HEADING-ROUTINE                              08200099
081200     END-IF.                                                      08210099
081300                                                                  08220000
081400     WRITE EDI-LINE FROM TYPE1-LINE                               08230099
081500         AFTER ADVANCING 2 LINE.                                  08240099
081600                                                                  08250000
081700     WRITE EDI-LINE FROM TYPE1-LINE2                              08260099
081800         AFTER ADVANCING 1 LINE.                                  08270099
081900                                                                  08280000
082000     WRITE EDI-LINE FROM TYPE1-LINE3                              08290099
082100         AFTER ADVANCING 1 LINE.                                  08300099
082200                                                                  08310000
081100     IF PV-NEXUS-INVC-YES                                         08310199
080900         ADD 4 TO PV-LINE-COUNT-DI                                08310399
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     08310499
081100             PERFORM W550-HEADING-DI                              08310599
081400         WRITE AP-DI-REJ-LINE FROM TYPE1-LINE                     08311199
081500             AFTER ADVANCING 2 LINE                               08312099
081700         WRITE AP-DI-REJ-LINE FROM TYPE1-LINE2                    08314099
081800             AFTER ADVANCING 1 LINE                               08315099
082000         WRITE AP-DI-REJ-LINE FROM TYPE1-LINE3                    08317099
082100             AFTER ADVANCING 1 LINE                               08318099
081400     END-IF.                                                      08318199
082200                                                                  08319099
082300*--------------------------------------------------------------*  08320000
082400* PROCESS THE INVOICE RECORD                                   *  08330000
082500*--------------------------------------------------------------*  08340000
082600 C100-TYPE2.                                                      08350000
082700                                                                  08360000
082800     MOVE AP051-KOHLS-STORE-NBR1    TO TYPE2-STORE-NBR1.          08370000
082900     MOVE AP051-KOHLS-STORE-NBR2    TO TYPE2-STORE-NBR2.          08380000
083000     MOVE AP051-LADING-CARRIER-NBR  TO TYPE2-LAD-CARR.            08390000
083100     MOVE AP051-INV-DTE-YY          TO TYPE2-INV-YY.              08400000
083200     MOVE AP051-INV-DTE-MM          TO TYPE2-INV-MM.              08410000
083300     MOVE AP051-INV-DTE-DD          TO TYPE2-INV-DD.              08420000
083400     MOVE AP051-SHPD-DTE-YY         TO TYPE2-SHP-YY.              08430000
083500     MOVE AP051-SHPD-DTE-MM         TO TYPE2-SHP-MM.              08440000
083600     MOVE AP051-SHPD-DTE-DD         TO TYPE2-SHP-DD.              08450000
083700     MOVE AP051-EFF-DTE-YY          TO TYPE2-EFF-YY.              08460000
083800     MOVE AP051-EFF-DTE-MM          TO TYPE2-EFF-MM.              08470000
083900     MOVE AP051-EFF-DTE-DD          TO TYPE2-EFF-DD.              08480000
084000                                                                  08490000
084100     ADD 4 TO PV-LINE-COUNT.                                      08500000
084200     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            08510000
084300        PERFORM W200-HEADING-ROUTINE                              08520000
084400     END-IF.                                                      08530000
084500                                                                  08540000
084600     WRITE EDI-LINE FROM TYPE2-LINE                               08550000
084700         AFTER ADVANCING 2 LINE.                                  08560000
084800                                                                  08570000
084900     WRITE EDI-LINE FROM TYPE2-LINE2                              08580000
085000         AFTER ADVANCING 1 LINE.                                  08590000
085100                                                                  08600000
085200     WRITE EDI-LINE FROM TYPE2-LINE3                              08610000
085300         AFTER ADVANCING 1 LINE.                                  08620000
085400                                                                  08630000
081400     IF PV-NEXUS-INVC-YES                                         08630299
080900         ADD 4 TO PV-LINE-COUNT-DI                                08630399
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     08630499
081100             PERFORM W550-HEADING-DI                              08630599
081101         END-IF                                                   08630699
081400         WRITE AP-DI-REJ-LINE FROM TYPE2-LINE                     08630899
081500             AFTER ADVANCING 2 LINE                               08630999
081400         WRITE AP-DI-REJ-LINE FROM TYPE2-LINE2                    08631099
081500             AFTER ADVANCING 1 LINE                               08631199
081400         WRITE AP-DI-REJ-LINE FROM TYPE2-LINE3                    08631299
081500             AFTER ADVANCING 1 LINE                               08632099
085300     END-IF.                                                      08639399
085100                                                                  08639499
085500*--------------------------------------------------------------*  08640000
085600* PROCESS THE REMIT TO RECORD                                  *  08650000
085700*--------------------------------------------------------------*  08660000
085800 C200-TYPE3.                                                      08670000
085900                                                                  08680000
086000     MOVE AP051-REMIT-VNDR-DUNS-NBR TO TYPE3-DUNS-NBR.            08690000
086100     MOVE AP051-REMIT-TO-NAME       TO TYPE3-NAME.                08700000
086200     MOVE AP051-REMIT-TO-ADDR-1     TO TYPE3-ADDR1.               08710000
086300     MOVE AP051-REMIT-TO-ADDR-2     TO TYPE3-ADDR2.               08720000
086400     MOVE AP051-REMIT-TO-CITY       TO TYPE3-CITY.                08730000
086500     MOVE AP051-REMIT-TO-STATE      TO TYPE3-STATE.               08740000
086600     MOVE AP051-REMIT-TO-ZIP-5      TO TYPE3-ZIP-5.               08750000
086700     MOVE AP051-REMIT-TO-ZIP-4      TO TYPE3-ZIP-4.               08760000
086800                                                                  08770000
086900     ADD 6 TO PV-LINE-COUNT.                                      08780000
087000     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            08790000
087100        PERFORM W200-HEADING-ROUTINE                              08800000
087200     END-IF.                                                      08810000
087300                                                                  08820000
087400     WRITE EDI-LINE FROM TYPE3-LINE                               08830000
087500         AFTER ADVANCING 2 LINE.                                  08840000
087600                                                                  08850000
087700     WRITE EDI-LINE FROM TYPE3-LINE2                              08860000
087800         AFTER ADVANCING 1 LINE.                                  08870000
087900                                                                  08880000
088000     WRITE EDI-LINE FROM TYPE3-LINE3                              08890000
088100         AFTER ADVANCING 1 LINE.                                  08900000
088200                                                                  08910000
088300     WRITE EDI-LINE FROM TYPE3-LINE4                              08920000
088400         AFTER ADVANCING 1 LINE.                                  08930000
088500                                                                  08940000
088600     WRITE EDI-LINE FROM TYPE3-LINE5                              08950000
088700         AFTER ADVANCING 1 LINE.                                  08960000
088800                                                                  08970000
081400     IF PV-NEXUS-INVC-YES                                         08971099
080900         ADD 6 TO PV-LINE-COUNT-DI                                08972099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     08973099
081100             PERFORM W550-HEADING-DI                              08974099
081101         END-IF                                                   08974199
081400         WRITE AP-DI-REJ-LINE FROM TYPE3-LINE                     08975099
081500             AFTER ADVANCING 2 LINE                               08976099
081400         WRITE AP-DI-REJ-LINE FROM TYPE3-LINE2                    08977099
081500             AFTER ADVANCING 1 LINE                               08978099
081400         WRITE AP-DI-REJ-LINE FROM TYPE3-LINE3                    08979099
081500             AFTER ADVANCING 1 LINE                               08979199
081400         WRITE AP-DI-REJ-LINE FROM TYPE3-LINE4                    08979299
081500             AFTER ADVANCING 1 LINE                               08979399
081400         WRITE AP-DI-REJ-LINE FROM TYPE3-LINE5                    08979499
081500             AFTER ADVANCING 1 LINE                               08979599
085300     END-IF.                                                      08979699
085100                                                                  08979799
088900*--------------------------------------------------------------*  08980000
089000* PROCESS THE TERMS RECORD                                     *  08990000
089100*--------------------------------------------------------------*  09000000
089200 C300-TYPE4.                                                      09010000
089300                                                                  09020000
089400     EVALUATE AP051-TERMS-TYPE-CODE                               09030000
089500       WHEN '01'                                                  09040000
089600         MOVE 'BASIC       '        TO TYPE4-TERMS-TYPE           09050000
089700       WHEN '02'                                                  09060000
089800         MOVE 'END OF MONTH'        TO TYPE4-TERMS-TYPE           09070000
089900       WHEN '03'                                                  09080000
090000         MOVE 'FIXED DATE  '        TO TYPE4-TERMS-TYPE           09090000
090100       WHEN '04'                                                  09100000
090200         MOVE 'DEFR INSTALL'        TO TYPE4-TERMS-TYPE           09110000
090300       WHEN '05'                                                  09120000
090400         MOVE 'NO DISC     '        TO TYPE4-TERMS-TYPE           09130000
090500       WHEN '06'                                                  09140000
090600         MOVE 'MIXED       '        TO TYPE4-TERMS-TYPE           09150000
090700       WHEN '07'                                                  09160000
090800         MOVE 'EXTENDED    '        TO TYPE4-TERMS-TYPE           09170000
090900       WHEN '08'                                                  09180000
091000         MOVE 'BASIC DISC  '        TO TYPE4-TERMS-TYPE           09190000
091100       WHEN '09'                                                  09200000
091200         MOVE 'PROXIMO     '        TO TYPE4-TERMS-TYPE           09210000
091300       WHEN '10'                                                  09220000
091400         MOVE 'INSTANT     '        TO TYPE4-TERMS-TYPE           09230000
091500       WHEN '11'                                                  09240000
091600         MOVE 'ELECTIVE    '        TO TYPE4-TERMS-TYPE           09250000
091700       WHEN '12'                                                  09260000
091800         MOVE '10 DAYS EOM '        TO TYPE4-TERMS-TYPE           09270000
091900       WHEN '13'                                                  09280000
092000         MOVE 'PREV AGREED '        TO TYPE4-TERMS-TYPE           09290000
092100       WHEN '14'                                                  09300000
092200         MOVE 'MUTUAL DEFIN'        TO TYPE4-TERMS-TYPE           09310000
092300       WHEN OTHER                                                 09320000
092400         MOVE AP051-TERMS-TYPE-CODE TO TYPE4-TERMS-TYPE           09330000
092500     END-EVALUATE.                                                09340000
092600                                                                  09350000
092700     EVALUATE AP051-TRMS-BASIS-DTE-CODE                           09360000
092800       WHEN '01'                                                  09370000
092900         MOVE 'SHIP DATE   '        TO TYPE4-BAS-DTE-CD           09380000
093000       WHEN '02'                                                  09390000
093100         MOVE 'DELIV DATE  '        TO TYPE4-BAS-DTE-CD           09400000
093200       WHEN '03'                                                  09410000
093300         MOVE 'INVOICE DATE'        TO TYPE4-BAS-DTE-CD           09420000
093400       WHEN '04'                                                  09430000
093500         MOVE 'EFFECT DATE '        TO TYPE4-BAS-DTE-CD           09440000
093600       WHEN OTHER                                                 09450000
093700         MOVE AP051-TRMS-BASIS-DTE-CODE TO TYPE4-BAS-DTE-CD       09460000
093800     END-EVALUATE.                                                09470000
093900                                                                  09480000
094000     MOVE AP051-DISC-PCT            TO TYPE4-DISC-PCT.            09490000
094100     MOVE AP051-DISC-DUE-DTE-YY     TO TYPE4-DISC-DUE-YY.         09500000
094200     MOVE AP051-DISC-DUE-DTE-MM     TO TYPE4-DISC-DUE-MM.         09510000
094300     MOVE AP051-DISC-DUE-DTE-DD     TO TYPE4-DISC-DUE-DD.         09520000
094400     MOVE AP051-DISC-DAYS-DUE       TO TYPE4-DISC-DAYS-DUE.       09530000
094500     MOVE AP051-DISC-AMT            TO TYPE4-DISC-AMT.            09540000
094600     MOVE AP051-NET-DUE-DTE-YY      TO TYPE4-NET-DUE-YY.          09550000
094700     MOVE AP051-NET-DUE-DTE-MM      TO TYPE4-NET-DUE-MM.          09560000
094800     MOVE AP051-NET-DUE-DTE-DD      TO TYPE4-NET-DUE-DD.          09570000
094900     MOVE AP051-NET-DEFRD-DAYS-DUE  TO TYPE4-NET-DEF-DAYS.        09580000
095000     MOVE AP051-PCT-PAYABLE         TO TYPE4-DEF-PCT-PAY.         09590000
095100     MOVE AP051-DEF-DUE-DTE-YY      TO TYPE4-DEF-DUE-YY.          09600000
095200     MOVE AP051-DEF-DUE-DTE-MM      TO TYPE4-DEF-DUE-MM.          09610000
095300     MOVE AP051-DEF-DUE-DTE-DD      TO TYPE4-DEF-DUE-DD.          09620000
095400     MOVE AP051-DEFERRED-AMT        TO TYPE4-DEF-AMT.             09630000
095500                                                                  09640000
095600     ADD 6 TO PV-LINE-COUNT.                                      09650000
095700     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            09660000
095800        PERFORM W200-HEADING-ROUTINE                              09670000
095900     END-IF.                                                      09680000
096000                                                                  09690000
096100     WRITE EDI-LINE FROM TYPE4-LINE                               09700000
096200         AFTER ADVANCING 2 LINE.                                  09710000
096300                                                                  09720000
096400     WRITE EDI-LINE FROM TYPE4-LINE2                              09730000
096500         AFTER ADVANCING 1 LINE.                                  09740000
096600                                                                  09750000
096700     WRITE EDI-LINE FROM TYPE4-LINE3                              09760000
096800         AFTER ADVANCING 1 LINE.                                  09770000
096900                                                                  09780000
097000     WRITE EDI-LINE FROM TYPE4-LINE4                              09790000
097100         AFTER ADVANCING 1 LINE.                                  09800000
097200                                                                  09810000
097300     WRITE EDI-LINE FROM TYPE4-LINE5                              09820000
097400         AFTER ADVANCING 1 LINE.                                  09830000
097500                                                                  09840000
081400     IF PV-NEXUS-INVC-YES                                         09841099
080900         ADD 6 TO PV-LINE-COUNT-DI                                09842099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     09843099
081100             PERFORM W550-HEADING-DI                              09844099
081101         END-IF                                                   09844199
081400         WRITE AP-DI-REJ-LINE FROM TYPE4-LINE                     09845099
081500             AFTER ADVANCING 2 LINE                               09846099
081400         WRITE AP-DI-REJ-LINE FROM TYPE4-LINE2                    09847099
081500             AFTER ADVANCING 1 LINE                               09848099
081400         WRITE AP-DI-REJ-LINE FROM TYPE4-LINE3                    09849099
081500             AFTER ADVANCING 1 LINE                               09849199
081400         WRITE AP-DI-REJ-LINE FROM TYPE4-LINE4                    09849299
081500             AFTER ADVANCING 1 LINE                               09849399
081400         WRITE AP-DI-REJ-LINE FROM TYPE4-LINE5                    09849499
081500             AFTER ADVANCING 1 LINE                               09849599
085300     END-IF.                                                      09849699
085100                                                                  09849799
097600*--------------------------------------------------------------*  09850000
097700* PROCESS THE ALLW/CHRG RECORD                                 *  09860000
097800*--------------------------------------------------------------*  09870000
097900 C400-TYPE5.                                                      09880000
098000                                                                  09890000
098100     EVALUATE AP051-ALLW-CHG-TYPE                                 09900000
098200       WHEN 'C'                                                   09910000
098300         MOVE 'CHARGE     '         TO TYPE5-ALLW-CHRG-TYPE       09920000
098400       WHEN 'A'                                                   09930000
098500         MOVE 'ALLOWANCE  '         TO TYPE5-ALLW-CHRG-TYPE       09940000
098600       WHEN 'N'                                                   09950000
098700         MOVE 'NO ALLW CHG'         TO TYPE5-ALLW-CHRG-TYPE       09960000
098800       WHEN OTHER                                                 09970000
098900         MOVE AP051-ALLW-CHG-TYPE   TO TYPE5-ALLW-CHRG-TYPE       09980000
099000     END-EVALUATE.                                                09990000
099100                                                                  10000000
099200     EVALUATE AP051-ALLW-CHRG-CODE                                10010000
099300       WHEN '275'                                                 10020000
099400       WHEN 'DSC'                                                 10030000
099500         MOVE 'TERMS DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         10040000
099600       WHEN 'TTD'                                                 10050000
099700         MOVE 'TRADE DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         10060000
099800       WHEN 'CAC'                                                 10070000
099900         MOVE 'CASH DISCOUNT   '    TO TYPE5-ALLW-CHRG-CD         10080000
100000       WHEN 'NSD'                                                 10090000
100100       WHEN 'NSA'                                                 10100000
100200         MOVE 'NEW STORE/PROMO '    TO TYPE5-ALLW-CHRG-CD         10110000
100300       WHEN 'FFA'                                                 10120000
100400         MOVE 'FREIGHT ALLOW   '    TO TYPE5-ALLW-CHRG-CD         10130000
100500       WHEN 'TAL'                                                 10140000
100600         MOVE 'TRUCKLOAD DISC  '    TO TYPE5-ALLW-CHRG-CD         10150000
100700       WHEN 'VAB'                                                 10160000
100800         MOVE 'VOLUME DISCOUNT '    TO TYPE5-ALLW-CHRG-CD         10170000
100900       WHEN 'RCA'                                                 10180000
101000         MOVE 'NO RET CREDIT AL'    TO TYPE5-ALLW-CHRG-CD         10190000
101100       WHEN 'WSA'                                                 10200000
101200         MOVE 'WHAREHOUSE ALLW '    TO TYPE5-ALLW-CHRG-CD         10210000
101300       WHEN 'DDA'                                                 10220000
101400         MOVE 'DEFECTIVE ALLW  '    TO TYPE5-ALLW-CHRG-CD         10230000
101500       WHEN 'AAA'                                                 10240000
101600         MOVE 'ADVETISING ALLW '    TO TYPE5-ALLW-CHRG-CD         10250000
101700       WHEN 'EEA'                                                 10260000
101800         MOVE 'EARLY BUY ALLW  '    TO TYPE5-ALLW-CHRG-CD         10270000
101900       WHEN 'UUM'                                                 10280000
102000         MOVE 'UNSALEABLE MERCH'    TO TYPE5-ALLW-CHRG-CD         10290000
102100       WHEN '400'                                                 10300000
102200       WHEN 'FFC'                                                 10310000
102300       WHEN 'PAB'                                                 10320000
102400       WHEN 'SAB'                                                 10330000
102500       WHEN 'PST'                                                 10340000
102600       WHEN 'UUC'                                                 10350000
102700         MOVE 'FREIGHT CHARGE  '    TO TYPE5-ALLW-CHRG-CD         10360000
102800       WHEN 'MRK'                                                 10370000
102900         MOVE 'PRETICKETING    '    TO TYPE5-ALLW-CHRG-CD         10380000
103000       WHEN '445'                                                 10390000
103100       WHEN 'INS'                                                 10400000
103200         MOVE 'INSURANCE       '    TO TYPE5-ALLW-CHRG-CD         10410000
103300       WHEN 'MSG'                                                 10420000
103400         MOVE 'MISCELLANEOUS   '    TO TYPE5-ALLW-CHRG-CD         10430000
103500       WHEN 'MSC'                                                 10440000
103600         MOVE 'MISC/HANGER CHG '    TO TYPE5-ALLW-CHRG-CD         10450000
103700       WHEN 'SST'                                                 10460000
103800       WHEN 'TTL'                                                 10470000
103900       WHEN 'TTS'                                                 10480000
104000         MOVE 'TAX             '    TO TYPE5-ALLW-CHRG-CD         10490000
104100       WHEN 'SGG'                                                 10500000
104200         MOVE 'SMALL ORDER CHG '    TO TYPE5-ALLW-CHRG-CD         10510000
104300       WHEN 'HBG'                                                 10520000
104400       WHEN '690'                                                 10530000
104500         MOVE 'HANDLING        '    TO TYPE5-ALLW-CHRG-CD         10540000
104600       WHEN 'LAE'                                                 10550000
104700         MOVE 'LICENSE FEE     '    TO TYPE5-ALLW-CHRG-CD         10560000
104800       WHEN 'PPN'                                                 10570000
104900         MOVE 'PALLET CHARGE   '    TO TYPE5-ALLW-CHRG-CD         10580000
105000       WHEN OTHER                                                 10590000
105100         MOVE AP051-ALLW-CHRG-CODE  TO TYPE5-ALLW-CHRG-CD         10600000
105200     END-EVALUATE.                                                10610000
105300                                                                  10620000
105400     MOVE AP051-SPEC-SRVC-CODE      TO TYPE5-SPEC-SRVC-CD.        10630000
105500     EVALUATE AP051-SPEC-SRVC-CODE                                10640000
105600       WHEN 'FG        '                                          10650000
105700         MOVE 'FREE GOODS'          TO TYPE5-SPEC-SRVC-CD         10660000
105800       WHEN 'TC        '                                          10670000
105900         MOVE 'TICKETING '          TO TYPE5-SPEC-SRVC-CD         10680000
106000       WHEN OTHER                                                 10690000
106100         MOVE AP051-SPEC-SRVC-CODE  TO TYPE5-SPEC-SRVC-CD         10700000
106200     END-EVALUATE.                                                10710000
106300                                                                  10720000
106400     EVALUATE AP051-ALLW-CHRG-MTHD                                10730000
106500       WHEN '02'                                                  10740000
106600         MOVE 'OFF INVOICE '        TO TYPE5-ALLW-CHRG-MTHD       10750000
106700       WHEN OTHER                                                 10760000
106800         MOVE AP051-ALLW-CHRG-MTHD  TO TYPE5-ALLW-CHRG-MTHD       10770000
106900     END-EVALUATE.                                                10780000
107000                                                                  10790000
107100     MOVE AP051-ALLW-CHRG-TOTAL     TO TYPE5-ALLW-CHRG-TOTL.      10800000
107200     MOVE AP051-ALLW-CHRG-PCT       TO TYPE5-ALLW-CHRG-PCT.       10810000
107300     EVALUATE AP051-ALLW-CHRG-PCT-QUAL                            10820000
107400       WHEN '3'                                                   10830000
107500         MOVE 'DISC GROSS' TO TYPE5-ALLW-CHRG-QUAL                10840000
107600       WHEN OTHER                                                 10850000
107700         MOVE '          ' TO TYPE5-ALLW-CHRG-QUAL                10860000
107800     END-EVALUATE.                                                10870000
107900                                                                  10880000
108000     ADD 4 TO PV-LINE-COUNT.                                      10890000
108100     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            10900000
108200        PERFORM W200-HEADING-ROUTINE                              10910000
108300     END-IF.                                                      10920000
108400                                                                  10930000
108500     WRITE EDI-LINE FROM TYPE5-LINE                               10940000
108600         AFTER ADVANCING 2 LINE.                                  10950000
108700                                                                  10960000
108800     WRITE EDI-LINE FROM TYPE5-LINE2                              10970000
108900         AFTER ADVANCING 1 LINE.                                  10980000
109000                                                                  10990000
109100     WRITE EDI-LINE FROM TYPE5-LINE3                              11000000
109200         AFTER ADVANCING 1 LINE.                                  11010000
109300                                                                  11020000
081400     IF PV-NEXUS-INVC-YES                                         11021099
080900         ADD 4 TO PV-LINE-COUNT-DI                                11022099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     11023099
081100             PERFORM W550-HEADING-DI                              11024099
081101         END-IF                                                   11024199
081400         WRITE AP-DI-REJ-LINE FROM TYPE5-LINE                     11025099
081500             AFTER ADVANCING 2 LINE                               11026099
081400         WRITE AP-DI-REJ-LINE FROM TYPE5-LINE2                    11027099
081500             AFTER ADVANCING 1 LINE                               11028099
081400         WRITE AP-DI-REJ-LINE FROM TYPE5-LINE3                    11029099
081500             AFTER ADVANCING 1 LINE                               11029199
085300     END-IF.                                                      11029699
085100                                                                  11029799
109400*--------------------------------------------------------------*  11030000
109500* PROCESS THE SUMMARY RECORD                                   *  11040000
109600*--------------------------------------------------------------*  11050000
109700 C500-TYPE6.                                                      11060000
109800                                                                  11070000
109900     MOVE AP051-QUANTITY-SHIPPED    TO TYPE6-QTY-SHIP.            11080000
110000     EVALUATE AP051-SHIP-UNIT-MEASURE                             11090000
110100       WHEN 'CA'                                                  11100000
110200         MOVE 'CASE     ' TO TYPE6-SHIP-UOM                       11110000
110300       WHEN 'CH'                                                  11120000
110400         MOVE 'CONTAINER' TO TYPE6-SHIP-UOM                       11130000
110500       WHEN 'CT'                                                  11140000
110600         MOVE 'CARTON   ' TO TYPE6-SHIP-UOM                       11150000
110700       WHEN 'EA'                                                  11160000
110800         MOVE 'EACH     ' TO TYPE6-SHIP-UOM                       11170000
110900       WHEN OTHER                                                 11180000
111000         MOVE SPACES      TO TYPE6-SHIP-UOM                       11190000
111100     END-EVALUATE.                                                11200000
111200                                                                  11210000
111300     MOVE AP051-GROSS-INVOICE-AMT   TO TYPE6-GROSS-INV-AMT.       11220000
111400     MOVE AP051-GROSS-INVOICE-AMT   TO GROSS-INVOICED.            11230000
111500     MOVE AP051-AMT-SBJ-DISCOUNT    TO TYPE6-AMT-SUBJ-DISC.       11240000
111600     MOVE AP051-DISCOUNT-AMT        TO TYPE6-DISC-AMT.            11250000
111700     MOVE AP051-DISCOUNTED-AMT-DUE  TO TYPE6-DISC-AMT-DUE.        11260000
111800                                                                  11270000
111900     ADD 4 TO PV-LINE-COUNT.                                      11280000
112000     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            11290000
112100        PERFORM W200-HEADING-ROUTINE                              11300000
112200     END-IF.                                                      11310000
112300                                                                  11320000
112400     WRITE EDI-LINE FROM TYPE6-LINE                               11330000
112500         AFTER ADVANCING 2 LINE.                                  11340000
112600                                                                  11350000
112700     WRITE EDI-LINE FROM TYPE6-LINE2                              11360000
112800         AFTER ADVANCING 1 LINE.                                  11370000
112900                                                                  11380000
113000     WRITE EDI-LINE FROM TYPE6-LINE3                              11390000
113100         AFTER ADVANCING 1 LINE.                                  11400000
113200                                                                  11410000
081400     IF PV-NEXUS-INVC-YES                                         11411099
080900         ADD 4 TO PV-LINE-COUNT-DI                                11412099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     11413099
081100             PERFORM W550-HEADING-DI                              11414099
081101         END-IF                                                   11414199
081400         WRITE AP-DI-REJ-LINE FROM TYPE6-LINE                     11415099
081500             AFTER ADVANCING 2 LINE                               11416099
081400         WRITE AP-DI-REJ-LINE FROM TYPE6-LINE2                    11417099
081500             AFTER ADVANCING 1 LINE                               11418099
081400         WRITE AP-DI-REJ-LINE FROM TYPE6-LINE3                    11419099
081500             AFTER ADVANCING 1 LINE                               11419199
085300     END-IF.                                                      11419299
085100                                                                  11419399
113300*--------------------------------------------------------------*  11420000
113400* PROCESS THE ITEM DETAIL RECORD                               *  11430000
113500*--------------------------------------------------------------*  11440000
113600 C600-TYPE7.                                                      11450000
113700                                                                  11460000
113800     MOVE AP051-ID-QUALIFIER        TO TYPE7-ID-QUAL.             11470000
113900                                                                  11480000
114000     IF AP051-EAN-UPC(13:1) = SPACE                               11490000
114100        MOVE ' '                       TO TYPE7-EAN-UPC(1:1)      11500000
114200        MOVE AP051-EAN-UPC(1:1)        TO TYPE7-EAN-UPC(2:1)      11510000
114300        MOVE '-'                       TO TYPE7-EAN-UPC(3:1)      11520000
114400        MOVE AP051-EAN-UPC(2:5)        TO TYPE7-EAN-UPC(4:5)      11530000
114500        MOVE '-'                       TO TYPE7-EAN-UPC(9:1)      11540000
114600        MOVE AP051-EAN-UPC(7:5)        TO TYPE7-EAN-UPC(10:5)     11550000
114700        MOVE '-'                       TO TYPE7-EAN-UPC(15:1)     11560000
114800        MOVE AP051-EAN-UPC(12:1)       TO TYPE7-EAN-UPC(16:1)     11570000
114900     ELSE                                                         11580000
115000        MOVE AP051-EAN-UPC(1:2)        TO TYPE7-EAN-UPC(1:2)      11590000
115100        MOVE '-'                       TO TYPE7-EAN-UPC(3:1)      11600000
115200        MOVE AP051-EAN-UPC(3:5)        TO TYPE7-EAN-UPC(4:5)      11610000
115300        MOVE '-'                       TO TYPE7-EAN-UPC(9:1)      11620000
115400        MOVE AP051-EAN-UPC(8:5)        TO TYPE7-EAN-UPC(10:5)     11630000
115500        MOVE '-'                       TO TYPE7-EAN-UPC(15:1)     11640000
115600        MOVE AP051-EAN-UPC(13:1)       TO TYPE7-EAN-UPC(16:1)     11650000
115700     END-IF.                                                      11660000
115800                                                                  11670000
115900     MOVE AP051-KOHLS-SKU           TO TYPE7-SKU.                 11680000
116000     MOVE AP051-VENDOR-STYLE        TO TYPE7-VNDR-STYLE.          11690000
116100     MOVE AP051-VENDOR-STYLE-DSCRPT TO TYPE7-VNDR-STYLE-DESC.     11700000
116200     MOVE AP051-NRMA-COLOR-CODE     TO TYPE7-NRML-CD.             11710000
116300     MOVE AP051-VENDOR-COLOR-DSCRPT TO TYPE7-COLOR-DESC.          11720000
116400     MOVE AP051-NRMA-SIZE-CODE      TO TYPE7-SIZE-CD.             11730000
116500     MOVE AP051-VENDOR-SIZE-DSCRPT  TO TYPE7-SIZE-DESC.           11740000
116600     EVALUATE AP051-IT1-UNIT-MEASURE                              11750000
116700       WHEN 'EA'                                                  11760000
116800         MOVE 'EACH     ' TO TYPE7-UOM                            11770000
116900       WHEN 'PK'                                                  11780000
117000         MOVE 'PACK     ' TO TYPE7-UOM                            11790000
117100       WHEN 'PR'                                                  11800000
117200         MOVE 'PAIR     ' TO TYPE7-UOM                            11810000
117300       WHEN 'ST'                                                  11820000
117400         MOVE 'SET      ' TO TYPE7-UOM                            11830000
117500       WHEN 'AS'                                                  11840000
117600         MOVE 'PACK HDR ' TO TYPE7-UOM                            11850000
117700       WHEN 'PI'                                                  11860000
117800         MOVE 'PACKITEM ' TO TYPE7-UOM                            11870000
117900     END-EVALUATE.                                                11880000
118000                                                                  11890000
118100     MOVE AP051-QUANTITY-INVOICED   TO TYPE7-QTY-INVD.            11900000
118200     MOVE AP051-WHOLSALE-UNIT-COST  TO TYPE7-WHOL-COST.           11910000
118300                                                                  11920000
118400     IF AP051-IT1-MSR-PK-HDR                                      11930000
118500        MOVE 'PACK UPC: '              TO TYPE7-UPC-TITLE         11940000
118600        MOVE 'PACK COST: '             TO TYPE7-UNT-CST-TITLE     11950000
118700        MOVE AP051-PK-ITEM-SUMD-COST   TO TYPE7-PK-ITEM-SUMD-COST 11960000
118800        ADD 7 TO PV-LINE-COUNT                                    11970000
081400        IF PV-NEXUS-INVC-YES                                      11971099
080900            ADD 7 TO PV-LINE-COUNT-DI                             11972099
081400        END-IF                                                    11973099
118900     ELSE                                                         11980000
119000        MOVE 'UPC CODE: '              TO TYPE7-UPC-TITLE         11990000
119100        MOVE 'UNIT COST: '             TO TYPE7-UNT-CST-TITLE     12000000
119200        ADD 6 TO PV-LINE-COUNT                                    12010000
081400        IF PV-NEXUS-INVC-YES                                      12011099
080900            ADD 6 TO PV-LINE-COUNT-DI                             12012099
081400        END-IF                                                    12013099
119300     END-IF.                                                      12020000
119400                                                                  12030000
119500     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            12040000
119600        PERFORM W200-HEADING-ROUTINE                              12050000
119700     END-IF.                                                      12060000
119800                                                                  12070000
119900     WRITE EDI-LINE FROM TYPE7-LINE                               12080000
120000         AFTER ADVANCING 2 LINE.                                  12090000
120100                                                                  12100000
120200     WRITE EDI-LINE FROM TYPE7-LINE2                              12110000
120300         AFTER ADVANCING 1 LINE.                                  12120000
120400                                                                  12130000
120500     WRITE EDI-LINE FROM TYPE7-LINE3                              12140000
120600         AFTER ADVANCING 1 LINE.                                  12150000
120700                                                                  12160000
120800     WRITE EDI-LINE FROM TYPE7-LINE4                              12170000
120900         AFTER ADVANCING 1 LINE.                                  12180000
121000                                                                  12190000
121100     WRITE EDI-LINE FROM TYPE7-LINE5                              12200000
121200         AFTER ADVANCING 1 LINE.                                  12210000
121300                                                                  12220000
121400     IF AP051-IT1-MSR-PK-HDR                                      12230000
121500        WRITE EDI-LINE FROM TYPE7-LINE6                           12240000
121600            AFTER ADVANCING 1 LINE                                12250000
121700     END-IF.                                                      12260000
121800                                                                  12270000
081400     IF PV-NEXUS-INVC-YES                                         12271099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     12273099
081100             PERFORM W550-HEADING-DI                              12274099
081101         END-IF                                                   12274199
081400         WRITE AP-DI-REJ-LINE FROM TYPE7-LINE                     12275099
081500             AFTER ADVANCING 2 LINE                               12276099
081400         WRITE AP-DI-REJ-LINE FROM TYPE7-LINE2                    12277099
081500             AFTER ADVANCING 1 LINE                               12278099
081400         WRITE AP-DI-REJ-LINE FROM TYPE7-LINE3                    12279099
081500             AFTER ADVANCING 1 LINE                               12279199
081400         WRITE AP-DI-REJ-LINE FROM TYPE7-LINE4                    12279299
081500             AFTER ADVANCING 1 LINE                               12279399
081400         WRITE AP-DI-REJ-LINE FROM TYPE7-LINE5                    12279499
081500             AFTER ADVANCING 1 LINE                               12279599
121400         IF AP051-IT1-MSR-PK-HDR                                  12279699
121500            WRITE AP-DI-REJ-LINE FROM TYPE7-LINE6                 12279799
121600                AFTER ADVANCING 1 LINE                            12279899
121700     END-IF.                                                      12279999
085100                                                                  12280199
121900*--------------------------------------------------------------*  12281000
122000* PROCESS THE HIGH-VALUES RECORD                               *  12290000
122100*--------------------------------------------------------------*  12300000
122200 C650-HIGH-VALUES.                                                12310000
122300                                                                  12320000
122400     IF AP051-ERR-TOO-MANY-LINES                                  12330000
122500        MOVE AP051-TOT-INVC-LINES TO PV-TOT-INVC-LINES            12340000
122600     END-IF.                                                      12350000
122700                                                                  12360000
122800*--------------------------------------------------------------*  12370000
122900* PROCESS AN INVALID RECORD TYPE                               *  12380000
123000*--------------------------------------------------------------*  12390000
123100 C700-INVALID-TYPE.                                               12400000
123200                                                                  12410000
123300     ADD 1 TO PV-LINE-COUNT.                                      12420000
123400     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            12430000
123500        PERFORM W200-HEADING-ROUTINE                              12440000
123600     END-IF.                                                      12450000
123700                                                                  12460000
123800     MOVE AP051-RECORD-TYPE-IND TO TYPE-OTH-REC-TYPE.             12470000
123900                                                                  12480000
124000     WRITE EDI-LINE FROM TYPE-OTH-LINE                            12490000
124100         AFTER ADVANCING 1 LINE.                                  12500000
124200                                                                  12510000
081400     IF PV-NEXUS-INVC-YES                                         12511099
080900         ADD 1 TO PV-LINE-COUNT-DI                                12511199
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     12512099
081100             PERFORM W550-HEADING-DI                              12513099
081101         END-IF                                                   12513199
081400         WRITE AP-DI-REJ-LINE FROM TYPE-OTH-LINE                  12514099
124100             AFTER ADVANCING 1 LINE                               12515099
124200     END-IF.                                                      12516099
124200                                                                  12517099
124300*--------------------------------------------------------------*  12520000
124400* CHECK FOR ERROR CODES AND PRINT 3 PER REPORT LINE - DETAIL   *  12530000
124500*--------------------------------------------------------------*  12540000
124600 E100-ERROR-ROUTINE.                                              12550000
124700                                                                  12560000
124800     ADD 1 TO PV-LINE-COUNT.                                      12570000
124900     IF PV-LINE-COUNT >= PV-LINE-LIMIT - 1                        12580000
125000        PERFORM W200-HEADING-ROUTINE                              12590000
125100     END-IF.                                                      12600000
125200                                                                  12610000
125300     WRITE EDI-LINE FROM ERROR-DESC-LINE                          12620000
125400         AFTER ADVANCING 1 LINE.                                  12630000
125500                                                                  12640000
081400     IF PV-NEXUS-INVC-YES                                         12641099
080900         ADD 1 TO PV-LINE-COUNT-DI                                12642099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     12643099
081100             PERFORM W550-HEADING-DI                              12644099
081101         END-IF                                                   12644199
081400         WRITE AP-DI-REJ-LINE FROM ERROR-DESC-LINE                12645099
124100             AFTER ADVANCING 1 LINE                               12646099
124200     END-IF.                                                      12647099
124200                                                                  12648099
125600     SET ERRLN-INDX TO 1.                                         12650000
125700     SET ERRLN-INDX DOWN BY 1.                                    12660000
125800     MOVE SPACES TO ERROR-LINE-AREA.                              12670000
125900                                                                  12680000
126000     PERFORM VARYING AP051-INDX FROM 1 BY 1                       12690000
126100        UNTIL AP051-INDX > 25                                     12700000
126200           OR AP051-ERR-CD(AP051-INDX) = ZEROS                    12710000
126300           SET ERR-INDX TO AP051-ERR-CD(AP051-INDX)               12720000
126400           SET FLG-INDX TO ERR-INDX                               12730000
126500           MOVE 'X' TO SUMM-ERR-FLAG(FLG-INDX)                    12740000
126600           SET ERRLN-INDX UP BY 1                                 12750000
126700           MOVE '*' TO ERR-ASTR-1(ERRLN-INDX)                     12760000
126800           MOVE '*' TO ERR-ASTR-2(ERRLN-INDX)                     12770000
126900           MOVE AP051-ERR-CD(AP051-INDX) TO PV-AP-EDIT-CODE       12780000
127000           PERFORM Y100-PROCESS-ERROR-MSG                         12790000
127100           MOVE PV-EDI-ERROR-MSG TO ERR-DATA(ERRLN-INDX)          12800000
127200           IF AP051-ERR-CD(AP051-INDX) = 74                       12810000
127300              MOVE '80' TO ERR-NMBR(ERRLN-INDX)                   12820000
127400           ELSE                                                   12830000
127500              MOVE AP051-ERR-CD(AP051-INDX) TO                    12840000
127600                                  ERR-NMBR(ERRLN-INDX)            12850000
127700           END-IF                                                 12860000
127800                                                                  12870000
127900           IF ERRLN-INDX = 2                                      12880000
128000              PERFORM W600-WRITE-ERROR-LINE                       12890000
128100              SET ERRLN-INDX TO 1                                 12900000
128200              SET ERRLN-INDX DOWN BY 1                            12910000
128300              MOVE SPACES TO ERROR-LINE-AREA                      12920000
128400           END-IF                                                 12930000
128500     END-PERFORM.                                                 12940000
128600                                                                  12950000
128700     IF ERRLN-INDX > 0                                            12960000
128800        PERFORM W600-WRITE-ERROR-LINE                             12970000
128900     END-IF.                                                      12980000
129000                                                                  12990000
129100     IF AP051-ERR-DETL-GROSS-INV                                  13000000
129200        MOVE AP051-CALC-SUM-EXTEN   TO CALC-GROSS-EXTEN           13010000
129200*       DISPLAY 'E100:AP051-CALC-SUM-EXTEN ' AP051-CALC-SUM-EXTEN 13011099
129200*       DISPLAY ' '                                               13012099
129300        SET ERR-DETAIL-GROSS-INVOICE TO TRUE                      13020000
129400        WRITE EDI-LINE FROM CALC-GROSS-LINE                       13030000
129500            AFTER ADVANCING 1 LINE                                13040000
129500                                                                  13040199
081400        IF PV-NEXUS-INVC-YES                                      13041099
081400            WRITE AP-DI-REJ-LINE FROM CALC-GROSS-LINE             13045099
124100                AFTER ADVANCING 1 LINE                            13046099
124200        END-IF                                                    13047099
129600     END-IF.                                                      13050000
129700                                                                  13060000
129800*--------------------------------------------------------------*  13070000
129900* PERFORM ALL DATE ROUTINES, FILE OPENS, ETC                   *  13080000
130000*--------------------------------------------------------------*  13090000
130100 H000-HOUSEKEEPING.                                               13100000
130200                                                                  13110000
130300     ACCEPT SD-SYSTEM-DATE FROM DATE.                             13120000
130400     ACCEPT ST-SYSTEM-TIME FROM TIME.                             13130000
130500                                                                  13140000
130600     ACCEPT REPORT-TYPE-CONTROL.                                  13150000
130700     EVALUATE REPORT-TYPE-CONTROL                                 13160000
130800        WHEN 'T'                                                  13170000
130900          MOVE '     EDI TEST DATA       ' TO HEADER-TYPE         13180000
131000                                              HEADER-TYPE1-2-EDI  13190000
131100                                              HEADER-TYPE1-2-AP   13200000
131200        WHEN 'P'                                                  13210000
131300          MOVE '  EDI PRODUCTION DATA    ' TO HEADER-TYPE         13220000
131400                                              HEADER-TYPE1-2-EDI  13230000
131500                                              HEADER-TYPE1-2-AP   13240000
131600        WHEN 'A'                                                  13250000
131700          MOVE ' EDI PRE-PRODUCTION DATA ' TO HEADER-TYPE         13260000
131800                                              HEADER-TYPE1-2-EDI  13270000
131900                                              HEADER-TYPE1-2-AP   13280000
132000        WHEN OTHER                                                13290000
132100          MOVE '   DATA TYPE UNKNOWN     ' TO HEADER-TYPE         13300000
132200                                              HEADER-TYPE1-2-EDI  13310000
132300                                              HEADER-TYPE1-2-AP   13320000
132400     END-EVALUATE.                                                13330000
132500                                                                  13340000
132600     DISPLAY 'TYPE OF REPORT = ' REPORT-TYPE-CONTROL.             13350000
132700                                                                  13360000
132800     MOVE SD-SYSTEM-YEAR TO DP132O-RUN-YEAR.                      13370000
132900     MOVE SD-SYSTEM-MONTH TO DP132O-RUN-MONTH.                    13380000
133000     MOVE SD-SYSTEM-DAY TO DP132O-RUN-DAY.                        13390000
133100                                                                  13400000
133200     MOVE ST-SYSTEM-HOUR TO DP132O-RUN-HOUR.                      13410000
133300     MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE.                  13420000
133400                                                                  13430000
133500     MOVE PV-PROGRAM-NAME TO DP132O-PROGRAM-NAME.                 13440000
133600                                                                  13450000
133700     MOVE SPACES TO SUMM-ERR-TABLE.                               13460000
133800                                                                  13470000
133900     PERFORM R100-READ-EDI-REJECT.                                13480000
134000     IF WS-EDI-REJ-EOF                                            13490000
134100        DISPLAY '********************************* *'             13500000
134200        DISPLAY '*   EMPTY EDI REJECTION FILE      *'             13510000
134300        DISPLAY '*   PROGRAM ** = APKRP206         *'             13520000
134400        DISPLAY '*   PARAGRAPH  = H000-HOUSEKEEPING*'             13530000
134500        DISPLAY '***********************************'             13540000
134600        MOVE ZEROS                     TO HL2-VENDOR-NBR          13550000
134700                                          HL2-PO-NBR              13560000
134800                                          HL2-INTERCHG-CNTL-NBR   13570000
134900        MOVE SPACES                    TO HL2-INVOICE-NBR         13580000
135000                                          HL2-ENT-ID-DESC         13590000
135100        PERFORM W200-HEADING-ROUTINE                              13600000
135200        WRITE EDI-LINE FROM NO-DATA-LINE                          13610000
081100        PERFORM W550-HEADING-DI                                   13614099
081400        WRITE AP-DI-REJ-LINE FROM NO-DATA-LINE                    13615099
135300        PERFORM W500-SUMMARY-HEADING-EDI                          13620000
135400        WRITE EDI-SUMM-LINE FROM NO-DATA-LINE                     13630000
135500            AFTER ADVANCING 2 LINE                                13640000
135600        PERFORM W500-SUMMARY-HEADING-AP                           13650000
135700        WRITE AP-SUMM-LINE FROM NO-DATA-LINE                      13660000
135800            AFTER ADVANCING 2 LINE                                13670000
135900        SET WS-EDI-REJ-EMPTY-FILE TO TRUE                         13680000
136000     ELSE                                                         13690000
136100        MOVE AP051-SORT-VENDOR-NBR     TO HL2-VENDOR-NBR          13700000
136200        MOVE AP051-SORT-INVOICE-NBR    TO HL2-INVOICE-NBR         13710000
136300        MOVE AP051-KOHLS-PO-NBR        TO HL2-PO-NBR              13720000
136400        MOVE AP051-VENDOR-DESC         TO HL2-ENT-ID-DESC         13730000
136500        MOVE AP051-SAVE-INTERCHG-CNTL-NBR TO HL2-INTERCHG-CNTL-NBR13740000
136600        MOVE AP051-EDI-824-IND            TO EDI-824-IND          13750000
080700        MOVE AP051-ADDL-NEXUS-INVC     TO PV-NEXUS-INVC           13751099
136700        PERFORM W200-HEADING-ROUTINE                              13760000
136800        PERFORM W500-SUMMARY-HEADING-EDI                          13770000
136900        PERFORM W500-SUMMARY-HEADING-AP                           13780000
135600*       PERFORM W550-HEADING-DI                                   13781099
137000     END-IF.                                                      13790000
137100                                                                  13800000
137200*--------------------------------------------------------------*  13810000
137300* READ THE EDI TRANSMISSION REJECTION FILE                     *  13820000
137400*--------------------------------------------------------------*  13830000
137500 R100-READ-EDI-REJECT.                                            13840000
137600                                                                  13850000
137700     READ EDI-REJ-FILE INTO WS-EDI-REJECT-REC                     13860000
137800         AT END                                                   13870000
137900             SET WS-EDI-REJ-EOF  TO TRUE.                         13880000
138000                                                                  13881199
138000                                                                  13890000
138100*--------------------------------------------------------------*  13900000
138200* SEPARATE THE AP AND EDI SUMMARY REPORTS                      *  13910000
138300*--------------------------------------------------------------*  13920000
138400 W000-SUMMARY-LINES.                                              13930000
138500                                                                  13940000
138600     SET ERRLN-EDI-INDX TO 1.                                     13950000
138700     SET ERRLN-EDI-INDX DOWN BY 1.                                13960000
138800     MOVE SPACES TO ERROR-LINE-AREA-EDI.                          13970000
138900     SET ERRLN-AP-INDX TO 1.                                      13980000
139000     SET ERRLN-AP-INDX DOWN BY 1.                                 13990000
139100     MOVE SPACES TO ERROR-LINE-AREA-AP.                           14000000
139200                                                                  14010000
139300     MOVE ZERO TO WS-AP-EDIT-CODE                                 14020000
139400     PERFORM VARYING FLG-INDX   FROM 1 BY 1                       14030000
139500        UNTIL FLG-INDX   > 99                                     14040000
139600           ADD 1 TO WS-AP-EDIT-CODE                               14050000
139700           IF SUMM-ERR-FLAG(FLG-INDX) = 'X'                       14060000
139800              SET ERR-INDX TO FLG-INDX                            14070000
139900              IF AP-EDIT                                          14080000
140000                 PERFORM W010-AP-SUMMARY-LINES                    14090000
140100                 SET AP-ERR-LINE TO TRUE                          14100000
140200              ELSE                                                14110000
140300                 PERFORM W005-EDI-SUMMARY-LINES                   14120000
140400                 SET EDI-ERR-LINE TO TRUE                         14130000
140500              END-IF                                              14140000
140600           END-IF                                                 14150000
140700     END-PERFORM.                                                 14160000
140800                                                                  14170000
140900** CLEAR FLAGGED CODES ON THE TABLE.                              14180000
141000     MOVE SPACES TO SUMM-ERR-TABLE.                               14190000
141100                                                                  14200000
141200     IF ERRLN-EDI-INDX > 0                                        14210000
141300        PERFORM W100-WRITE-SUMM-ERR-LINE-EDI                      14220000
141400     END-IF.                                                      14230000
141500                                                                  14240000
141600     IF ERRLN-AP-INDX > 0                                         14250000
141700        PERFORM W100-WRITE-SUMM-ERR-LINE-AP                       14260000
141800     END-IF.                                                      14270000
141900                                                                  14280000
142000     IF EDI-ERR-LINE                                              14290000
142100         ADD 3 TO PV-LINE-COUNT-2-EDI                             14300000
142200         IF ERR-DETAIL-GROSS-INVOICE                              14310000
142300            WRITE EDI-SUMM-LINE FROM CALC-GROSS-LINE              14320000
142400              AFTER ADVANCING 1 LINE                              14330000
142500         END-IF                                                   14340000
142600         WRITE EDI-SUMM-LINE FROM EDI-824-IND-LINE                14350000
142700               AFTER ADVANCING 1 LINE                             14360000
142800         WRITE EDI-SUMM-LINE FROM DIVIDE-LINE                     14370000
142900               AFTER ADVANCING 1 LINE                             14380000
143000     END-IF.                                                      14390000
143100                                                                  14400000
143200     IF AP-ERR-LINE                                               14410000
143300         ADD 3 TO PV-LINE-COUNT-2-AP                              14420000
143400         IF ERR-DETAIL-GROSS-INVOICE                              14430000
143500            WRITE AP-SUMM-LINE FROM CALC-GROSS-LINE               14440000
143600              AFTER ADVANCING 1 LINE                              14450000
143700         END-IF                                                   14460000
143800         WRITE AP-SUMM-LINE FROM EDI-824-IND-LINE                 14470000
143900               AFTER ADVANCING 1 LINE                             14480000
144000         WRITE AP-SUMM-LINE FROM DIVIDE-LINE                      14490000
144100               AFTER ADVANCING 1 LINE                             14500000
144200     END-IF.                                                      14510000
144300                                                                  14520000
144400     SET NO-EDI-ERR-LINE TO TRUE.                                 14530000
144500     SET EDI-FIRST-TIME TO TRUE.                                  14540000
144600     SET NO-AP-ERR-LINE TO TRUE.                                  14550000
144700     SET AP-FIRST-TIME TO TRUE.                                   14560000
144800                                                                  14570000
144900*--------------------------------------------------------------*  14580000
145000* WRITE THE SUMMARY REPORT LINES FOR EDI                       *  14590000
145100*--------------------------------------------------------------*  14600000
145200 W005-EDI-SUMMARY-LINES.                                          14610000
145300                                                                  14620000
145400     IF EDI-FIRST-TIME                                            14630000
145500         ADD 3 TO PV-LINE-COUNT-2-EDI                             14640000
145600         IF PV-LINE-COUNT-2-EDI >= PV-LINE-LIMIT - 1              14650000
145700            PERFORM W500-SUMMARY-HEADING-EDI                      14660000
145800         END-IF                                                   14670000
145900         WRITE EDI-SUMM-LINE FROM HL-HEADING-LINE2                14680000
146000             AFTER ADVANCING 2 LINE                               14690000
146100         WRITE EDI-SUMM-LINE FROM ERROR-DESC-LINE                 14700000
146200             AFTER ADVANCING 1 LINE                               14710000
146300     END-IF.                                                      14720000
146400                                                                  14730000
146500     SET ERRLN-EDI-INDX UP BY 1.                                  14740000
146600     MOVE '*' TO ERR-ASTR-EDI-1(ERRLN-EDI-INDX).                  14750000
146700     MOVE '*' TO ERR-ASTR-EDI-2(ERRLN-EDI-INDX).                  14760000
146800     MOVE WS-AP-EDIT-CODE TO PV-AP-EDIT-CODE                      14770000
146900     PERFORM Y100-PROCESS-ERROR-MSG                               14780000
147000     MOVE PV-EDI-ERROR-MSG TO ERR-DATA-EDI(ERRLN-EDI-INDX)        14790000
147100     IF WS-AP-EDIT-CODE = 74                                      14800000
147200         MOVE '80' TO ERR-NMBR-EDI(ERRLN-EDI-INDX)                14810000
147300     ELSE                                                         14820000
147400         MOVE WS-AP-EDIT-CODE TO ERR-NMBR-EDI(ERRLN-EDI-INDX)     14830000
147500     END-IF.                                                      14840000
147600                                                                  14850000
147700     IF ERRLN-EDI-INDX = 2                                        14860000
147800        PERFORM W100-WRITE-SUMM-ERR-LINE-EDI                      14870000
147900        SET ERRLN-EDI-INDX TO 1                                   14880000
148000        SET ERRLN-EDI-INDX DOWN BY 1                              14890000
148100        MOVE SPACES TO ERROR-LINE-AREA-EDI                        14900000
148200     END-IF.                                                      14910000
148300                                                                  14920000
148400     SET EDI-NOT-FIRST-TIME TO TRUE.                              14930000
148500                                                                  14940000
148600*--------------------------------------------------------------*  14950000
148700* WRITE THE SUMMARY REPORT LINES FOR AP                        *  14960000
148800*--------------------------------------------------------------*  14970000
148900 W010-AP-SUMMARY-LINES.                                           14980000
149000                                                                  14990000
149100     IF AP-FIRST-TIME                                             15000000
149200         ADD 3 TO PV-LINE-COUNT-2-AP                              15010000
149300         IF PV-LINE-COUNT-2-AP >= PV-LINE-LIMIT - 1               15020000
149400            PERFORM W500-SUMMARY-HEADING-AP                       15030000
149500         END-IF                                                   15040000
149600         WRITE AP-SUMM-LINE FROM HL-HEADING-LINE2                 15050000
149700             AFTER ADVANCING 2 LINE                               15060000
149800         WRITE AP-SUMM-LINE FROM ERROR-DESC-LINE                  15070000
149900             AFTER ADVANCING 1 LINE                               15080000
150000     END-IF.                                                      15090000
150100                                                                  15100000
150200     SET ERRLN-AP-INDX UP BY 1.                                   15110000
150300     MOVE '*' TO ERR-ASTR-AP-1(ERRLN-AP-INDX).                    15120000
150400     MOVE '*' TO ERR-ASTR-AP-2(ERRLN-AP-INDX).                    15130000
150500     MOVE WS-AP-EDIT-CODE TO PV-AP-EDIT-CODE                      15140000
150600     PERFORM Y100-PROCESS-ERROR-MSG                               15150000
150700     MOVE PV-EDI-ERROR-MSG TO ERR-DATA-AP(ERRLN-AP-INDX)          15160000
150800     IF WS-AP-EDIT-CODE = 74                                      15170000
150900         MOVE '80' TO ERR-NMBR-AP(ERRLN-AP-INDX)                  15180000
151000     ELSE                                                         15190000
151100         MOVE WS-AP-EDIT-CODE TO ERR-NMBR-AP(ERRLN-AP-INDX)       15200000
151200     END-IF.                                                      15210000
151300                                                                  15220000
151400     IF ERRLN-AP-INDX = 2                                         15230000
151500        PERFORM W100-WRITE-SUMM-ERR-LINE-AP                       15240000
151600        SET ERRLN-AP-INDX TO 1                                    15250000
151700        SET ERRLN-AP-INDX DOWN BY 1                               15260000
151800        MOVE SPACES TO ERROR-LINE-AREA-AP                         15270000
151900     END-IF.                                                      15280000
152000                                                                  15290000
152100     SET AP-NOT-FIRST-TIME TO TRUE.                               15300000
152200                                                                  15310000
152300*--------------------------------------------------------------*  15320000
152400* WRITE THE SUMMARY ERROR LINES                                *  15330000
152500*--------------------------------------------------------------*  15340000
152600 W100-WRITE-SUMM-ERR-LINE-EDI.                                    15350000
152700                                                                  15360000
152800     ADD 1 TO PV-LINE-COUNT-2-EDI.                                15370000
152900     IF PV-LINE-COUNT-2-EDI >= PV-LINE-LIMIT                      15380000
153000        PERFORM W500-SUMMARY-HEADING-EDI                          15390000
153100     END-IF.                                                      15400000
153200                                                                  15410000
153300     WRITE EDI-SUMM-LINE FROM ERROR-LINE-EDI                      15420000
153400         AFTER ADVANCING 1 LINE.                                  15430000
153701                                                                  15470000
153702*--------------------------------------------------------------*  15480000
153703* WRITE THE SUMMARY ERROR LINES                                *  15490000
153800*--------------------------------------------------------------*  15500000
153900 W100-WRITE-SUMM-ERR-LINE-AP.                                     15510000
154000                                                                  15520000
154100     ADD 1 TO PV-LINE-COUNT-2-AP.                                 15530000
154200     IF PV-LINE-COUNT-2-AP >= PV-LINE-LIMIT                       15540000
154300        PERFORM W500-SUMMARY-HEADING-AP                           15550000
154400     END-IF.                                                      15560000
154500                                                                  15570000
154600     WRITE AP-SUMM-LINE FROM ERROR-LINE-AP                        15580000
154700         AFTER ADVANCING 1 LINE.                                  15590000
154800                                                                  15600000
154900*--------------------------------------------------------------*  15610000
155000* WRITE THE DETAIL LINE HEADING - EDI                          *  15620000
155100*--------------------------------------------------------------*  15630000
155200 W200-HEADING-ROUTINE.                                            15640000
155300                                                                  15650000
155400     ADD 1 TO PV-PAGE-COUNT.                                      15660000
155500*    EVALUATE REPORT-TYPE-CONTROL                                 15670099
155600*       WHEN 'T'                                                  15680099
155700*          MOVE 1 TO DP132O-REPORT-NUMBER                         15690099
155800*       WHEN 'A'                                                  15700099
155900*          MOVE 3 TO DP132O-REPORT-NUMBER                         15710099
156000*       WHEN 'P'                                                  15720099
156300*          MOVE 5 TO DP132O-REPORT-NUMBER                         15730099
156200*       WHEN OTHER                                                15740099
156300*          MOVE 1 TO DP132O-REPORT-NUMBER                         15750099
156400*    END-EVALUATE.                                                15760099
156500                                                                  15770000
156100     MOVE 5 TO DP132O-REPORT-NUMBER.                              15771099
156600     MOVE  9 TO PV-LINE-COUNT.                                    15780000
156700                                                                  15790000
156800     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    15800000
156900                                                                  15810000
157000     WRITE EDI-LINE FROM DP132O-STANDRD-HEADER-132-COLS           15820000
157100         AFTER ADVANCING PAGE.                                    15830000
157200                                                                  15840000
157300     WRITE EDI-LINE FROM HL-HEADING-LINE1                         15850000
157400         AFTER ADVANCING 2 LINE.                                  15860000
157500                                                                  15870000
157600     WRITE EDI-LINE FROM HL-HEADING-LINE2                         15880000
157700         AFTER ADVANCING 2 LINE.                                  15890000
157800                                                                  15900000
157900     WRITE EDI-LINE FROM EDI-824-IND-LINE                         15910000
158000         AFTER ADVANCING 1 LINE.                                  15920000
158100                                                                  15930000
158200     WRITE EDI-LINE FROM DIVIDE-LINE                              15940000
158300         AFTER ADVANCING 1 LINE.                                  15950000
158400                                                                  15960000
158500*--------------------------------------------------------------*  15972000
158600* PRINT THE RECORD TYPE DIVIDING LINE.                         *  15980000
158700*--------------------------------------------------------------*  15990000
158800 W400-PRINT-DIVIDE-LINE.                                          16000000
158900                                                                  16010000
159000     ADD 3 TO PV-LINE-COUNT.                                      16020000
159100     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            16030000
159200        PERFORM W200-HEADING-ROUTINE                              16040000
159300     ELSE                                                         16050000
159400        WRITE EDI-LINE FROM DIVIDE-LINE                           16060000
159500            AFTER ADVANCING 2 LINE                                16070000
159600     END-IF.                                                      16080000
159700                                                                  16090000
081100     IF PV-NEXUS-INVC-YES                                         16091099
080900         ADD 3 TO PV-LINE-COUNT-DI                                16092199
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     16092299
081100             PERFORM W550-HEADING-DI                              16092399
159300         ELSE                                                     16092499
081400             WRITE AP-DI-REJ-LINE FROM DIVIDE-LINE                16092699
081500                 AFTER ADVANCING 2 LINE                           16092799
081500         END-IF                                                   16093099
081500     END-IF.                                                      16093199
159700                                                                  16094099
159800*--------------------------------------------------------------*  16100000
159900* SUMMARY REPORT HEADING ROUTINE - EDI                        *   16110000
160000*--------------------------------------------------------------*  16120000
160100 W500-SUMMARY-HEADING-EDI.                                        16130000
160200                                                                  16140000
160300     ADD 1 TO PV-PAGE-COUNT-2-EDI.                                16150000
160400*    EVALUATE REPORT-TYPE-CONTROL                                 16160099
160500*       WHEN 'T'                                                  16170099
160600*          MOVE 2 TO DP132O-REPORT-NUMBER                         16180099
160700*       WHEN 'A'                                                  16190099
160800*          MOVE 4 TO DP132O-REPORT-NUMBER                         16200099
160900*       WHEN 'P'                                                  16210099
161000*          MOVE 6 TO DP132O-REPORT-NUMBER                         16220099
161100*       WHEN OTHER                                                16230099
161200*          MOVE 2 TO DP132O-REPORT-NUMBER                         16240099
161300*    END-EVALUATE.                                                16250099
161400                                                                  16260000
161000     MOVE 6 TO DP132O-REPORT-NUMBER.                              16261099
161500     MOVE  7 TO PV-LINE-COUNT-2-EDI.                              16270000
161600                                                                  16280000
161700     MOVE PV-PAGE-COUNT-2-EDI TO DP132O-PAGE-NUMBER.              16290000
161800                                                                  16300000
161900     WRITE EDI-SUMM-LINE FROM DP132O-STANDRD-HEADER-132-COLS      16310000
162000         AFTER ADVANCING PAGE.                                    16320000
162100                                                                  16330000
162200     WRITE EDI-SUMM-LINE FROM HL-HEADING-LINE1-2-EDI              16340000
162300         AFTER ADVANCING 2 LINE.                                  16350000
162400                                                                  16360000
162500     WRITE EDI-SUMM-LINE FROM DIVIDE-LINE                         16370000
162600         AFTER ADVANCING 2 LINE.                                  16380000
162700                                                                  16390000
162800*--------------------------------------------------------------*  16400000
162900* SUMMARY REPORT HEADING ROUTINE - AP                          *  16410000
163000*--------------------------------------------------------------*  16420000
163100 W500-SUMMARY-HEADING-AP.                                         16430000
163200                                                                  16440000
163300     ADD 1 TO PV-PAGE-COUNT-2-AP.                                 16450000
163400*    EVALUATE REPORT-TYPE-CONTROL                                 16460099
163500*       WHEN 'T'                                                  16470099
163600*          MOVE 7 TO DP132O-REPORT-NUMBER                         16480099
163700*       WHEN 'A'                                                  16490099
163800*          MOVE 8 TO DP132O-REPORT-NUMBER                         16500099
163900*       WHEN 'P'                                                  16510099
164000*          MOVE 9 TO DP132O-REPORT-NUMBER                         16520099
164100*       WHEN OTHER                                                16530099
164200*          MOVE 7 TO DP132O-REPORT-NUMBER                         16540099
164300*    END-EVALUATE.                                                16550099
164400                                                                  16560000
164000     MOVE 9 TO DP132O-REPORT-NUMBER.                              16561099
164500     MOVE  7 TO PV-LINE-COUNT-2-AP.                               16570000
164600                                                                  16580000
164700     MOVE PV-PAGE-COUNT-2-AP TO DP132O-PAGE-NUMBER.               16590000
164800                                                                  16600000
164900     WRITE AP-SUMM-LINE FROM DP132O-STANDRD-HEADER-132-COLS       16610000
165000         AFTER ADVANCING PAGE.                                    16620000
165100                                                                  16630000
165200     WRITE AP-SUMM-LINE FROM HL-HEADING-LINE1-2-AP                16640000
165300         AFTER ADVANCING 2 LINE.                                  16650000
165400                                                                  16660000
165500     WRITE AP-SUMM-LINE FROM DIVIDE-LINE                          16670000
165600         AFTER ADVANCING 2 LINE.                                  16680000
165700                                                                  16690000
154900*--------------------------------------------------------------*  16691099
155000* WRITE THE DETAIL LINE HEADING - INFOR NEXUS EDI ERRORS       *  16692099
155100*--------------------------------------------------------------*  16693099
155200 W550-HEADING-DI.                                                 16694099
155300                                                                  16695099
155400     ADD 1 TO PV-PAGE-COUNT-DI.                                   16696099
156100     MOVE 7 TO DP132O-REPORT-NUMBER.                              16699999
156600     MOVE  9 TO PV-LINE-COUNT-DI.                                 16700099
156700                                                                  16700199
156800     MOVE PV-PAGE-COUNT-DI TO DP132O-PAGE-NUMBER.                 16700299
156900                                                                  16700399
157000     WRITE AP-DI-REJ-LINE                                         16700599
157000         FROM DP132O-STANDRD-HEADER-132-COLS                      16700699
157100         AFTER ADVANCING PAGE.                                    16700799
157300     WRITE AP-DI-REJ-LINE FROM HL-HEADING-LINE1                   16700899
157400         AFTER ADVANCING 2 LINE.                                  16700999
157300     WRITE AP-DI-REJ-LINE FROM HL-HEADING-LINE2                   16701099
157700         AFTER ADVANCING 2 LINE.                                  16701199
157300     WRITE AP-DI-REJ-LINE FROM EDI-824-IND-LINE                   16701399
158000         AFTER ADVANCING 1 LINE.                                  16701599
157300     WRITE AP-DI-REJ-LINE FROM DIVIDE-LINE                        16701699
158300         AFTER ADVANCING 1 LINE.                                  16701999
158400                                                                  16702099
165800*--------------------------------------------------------------*  16703000
165900* WRITE THE DETAIL REPORT ERROR LINE                           *  16710000
166000*--------------------------------------------------------------*  16720000
166100 W600-WRITE-ERROR-LINE.                                           16730000
166200                                                                  16740000
166300     ADD 1 TO PV-LINE-COUNT.                                      16750000
166400     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            16760000
166500        PERFORM W200-HEADING-ROUTINE                              16770000
166600     END-IF.                                                      16780000
166700                                                                  16790000
166800     WRITE EDI-LINE FROM ERROR-LINE                               16800000
166900         AFTER ADVANCING 1 LINE.                                  16810000
167000                                                                  16820000
081100     IF PV-NEXUS-INVC-YES                                         16821099
080900         ADD 1 TO PV-LINE-COUNT-DI                                16822099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     16823099
081100             PERFORM W550-HEADING-DI                              16824099
159300         END-IF                                                   16825099
081400         WRITE AP-DI-REJ-LINE FROM ERROR-LINE                     16826099
081500             AFTER ADVANCING 1 LINE                               16827099
081500     END-IF.                                                      16829099
159700                                                                  16829199
167100*--------------------------------------------------------------*  16830000
167200* WRITE THE DETAIL REPORT END OF INVOICE LINE                  *  16840000
167300*--------------------------------------------------------------*  16850000
167400 W700-END-OF-INVOICE-LINE.                                        16860099
167500                                                                  16870000
167600     ADD 1 TO PV-LINE-COUNT.                                      16880000
167700     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            16890000
167800        PERFORM W200-HEADING-ROUTINE                              16900000
167900     END-IF.                                                      16910000
168000                                                                  16920000
168100     WRITE EDI-LINE FROM END-OF-INVOICE-LINE                      16930000
168200         AFTER ADVANCING 1 LINE.                                  16940000
168300                                                                  16950000
081100     IF PV-NEXUS-INVC-YES                                         16951099
080900         ADD 1 TO PV-LINE-COUNT-DI                                16952099
081000         IF PV-LINE-COUNT-DI >= PV-LINE-LIMIT                     16953099
081100             PERFORM W550-HEADING-DI                              16954099
159300         END-IF                                                   16955099
081400         WRITE AP-DI-REJ-LINE FROM END-OF-INVOICE-LINE            16956099
081500             AFTER ADVANCING 1 LINE                               16957099
156600         MOVE 100 TO PV-LINE-COUNT-DI                             16958199
081500     END-IF.                                                      16959099
159700                                                                  16959199
168400*--------------------------------------------------------------*  16960000
168500* ADDS THE FIELD RELATING TO THE ERROR MESSAGE                 *  16970000
168600*--------------------------------------------------------------*  16980000
168700 Y100-PROCESS-ERROR-MSG.                                          16990000
168800                                                                  17000000
168900     MOVE SPACES TO PV-EDI-ERROR-MSG.                             17010000
169000     EVALUATE PV-AP-EDIT-CODE                                     17020000
169100         WHEN 11                                                  17030000
169200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17040000
169300                    ', '                      DELIMITED BY SIZE   17050000
169400                    TYPE2-INV-YY              DELIMITED BY SIZE   17060000
169500                    '/'                       DELIMITED BY SIZE   17070000
169600                    TYPE2-INV-MM              DELIMITED BY SIZE   17080000
169700                    '/'                       DELIMITED BY SIZE   17090000
169800                    TYPE2-INV-DD              DELIMITED BY SIZE   17100000
169900               INTO PV-EDI-ERROR-MSG                              17110000
170000             END-STRING                                           17120000
170100         WHEN 14                                                  17130000
170200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17140000
170300                    ', '                      DELIMITED BY SIZE   17150000
170400                    TYPE5-ALLW-CHRG-CD        DELIMITED BY SIZE   17160000
170500                    '.'                       DELIMITED BY SIZE   17170000
170600               INTO PV-EDI-ERROR-MSG                              17180000
170700             END-STRING                                           17190000
170800         WHEN 15                                                  17200000
170900             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17210000
171000                    ', '                      DELIMITED BY SIZE   17220000
171100                    TYPE5-ALLW-CHRG-CD        DELIMITED BY SIZE   17230000
171200                    '.'                       DELIMITED BY SIZE   17240000
171300               INTO PV-EDI-ERROR-MSG                              17250000
171400             END-STRING                                           17260000
171500         WHEN 16                                                  17270000
171600             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17280000
171700                    ', '                      DELIMITED BY SIZE   17290000
171800                    TYPE5-ALLW-CHRG-TYPE      DELIMITED BY SIZE   17300000
171900                    '.'                       DELIMITED BY SIZE   17310000
172000               INTO PV-EDI-ERROR-MSG                              17320000
172100             END-STRING                                           17330000
172200         WHEN 17                                                  17340000
172300             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17350000
172400                    ', '                      DELIMITED BY SIZE   17360000
172500                    TYPE5-SPEC-SRVC-CD        DELIMITED BY SIZE   17370000
172600                    '.'                       DELIMITED BY SIZE   17380000
172700               INTO PV-EDI-ERROR-MSG                              17390000
172800             END-STRING                                           17400000
172900         WHEN 18                                                  17410000
173000             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17420000
173100                    ', '                      DELIMITED BY SIZE   17430000
173200                    HL2-PO-NBR                DELIMITED BY SIZE   17440000
173300                    '.'                       DELIMITED BY SIZE   17450000
173400               INTO PV-EDI-ERROR-MSG                              17460000
173500             END-STRING                                           17470000
173600         WHEN 19                                                  17480000
173700             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17490000
173800                    ', '                      DELIMITED BY SIZE   17500000
173900                    TYPE5-ALLW-CHRG-QUAL      DELIMITED BY SIZE   17510000
174000                    '.'                       DELIMITED BY SIZE   17520000
174100               INTO PV-EDI-ERROR-MSG                              17530000
174200             END-STRING                                           17540000
174300         WHEN 20                                                  17550000
174400             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17560000
174500                    ',  DC #1 '               DELIMITED BY SIZE   17570000
174600                    TYPE2-STORE-NBR1          DELIMITED BY SIZE   17580000
174700                    ',  DC #2 '               DELIMITED BY SIZE   17590000
174800                    TYPE2-STORE-NBR2          DELIMITED BY SIZE   17600000
174900               INTO PV-EDI-ERROR-MSG                              17610000
175000             END-STRING                                           17620000
175100         WHEN 21                                                  17630000
175200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17640000
175300                    ', '                      DELIMITED BY SIZE   17650000
175400                    TYPE7-ID-QUAL             DELIMITED BY SIZE   17660000
175500                    '.'                       DELIMITED BY SIZE   17670000
175600               INTO PV-EDI-ERROR-MSG                              17680000
175700             END-STRING                                           17690000
175800         WHEN 24                                                  17700000
175900             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17710000
176000                    ', '                      DELIMITED BY SIZE   17720000
176100                    TYPE7-UOM                 DELIMITED BY SIZE   17730000
176200                    '.'                       DELIMITED BY SIZE   17740000
176300               INTO PV-EDI-ERROR-MSG                              17750000
176400             END-STRING                                           17760000
176500         WHEN 26                                                  17770000
176600             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17780000
176700                    ', '                      DELIMITED BY SIZE   17790000
176800                    TYPE1-INTERCHG-YY         DELIMITED BY SIZE   17800000
176900                    '/'                       DELIMITED BY SIZE   17810000
177000                    TYPE1-INTERCHG-MM         DELIMITED BY SIZE   17820000
177100                    '/'                       DELIMITED BY SIZE   17830000
177200                    TYPE1-INTERCHG-DD         DELIMITED BY SIZE   17840000
177300               INTO PV-EDI-ERROR-MSG                              17850000
177400             END-STRING                                           17860000
177500         WHEN 27                                                  17870000
177600             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17880000
177700                    ', STR #1 '               DELIMITED BY SIZE   17890000
177800                    TYPE2-STORE-NBR1          DELIMITED BY SIZE   17900000
177900                    ', STR #2 '               DELIMITED BY SIZE   17910000
178000                    TYPE2-STORE-NBR2          DELIMITED BY SIZE   17920000
178100               INTO PV-EDI-ERROR-MSG                              17930000
178200             END-STRING                                           17940000
178300         WHEN 33                                                  17950000
178400             STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY '  '     17960000
178500                    ', STR #2 '             DELIMITED BY SIZE     17970000
178600                    TYPE2-STORE-NBR2        DELIMITED BY SIZE     17980000
178700               INTO PV-EDI-ERROR-MSG                              17990000
178800             END-STRING                                           18000000
178900         WHEN 38                                                  18010000
179000             STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY '  '     18020000
179100                    ', STR #1 '             DELIMITED BY SIZE     18030000
179200                    TYPE2-STORE-NBR1        DELIMITED BY SIZE     18040000
179300                    ', STR #2 '             DELIMITED BY SIZE     18050000
179400                    TYPE2-STORE-NBR2        DELIMITED BY SIZE     18060000
179500               INTO PV-EDI-ERROR-MSG                              18070000
179600             END-STRING                                           18080000
179700         WHEN 40                                                  18090000
179800             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18100000
179900                    ', '                      DELIMITED BY SIZE   18110000
180000                    TYPE4-TERMS-TYPE          DELIMITED BY '  '   18120000
180100                    '.'                       DELIMITED BY SIZE   18130000
180200               INTO PV-EDI-ERROR-MSG                              18140000
180300             END-STRING                                           18150000
180400         WHEN 41                                                  18160000
180500             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18170000
180600                    ', '                      DELIMITED BY SIZE   18180000
180700                    TYPE4-BAS-DTE-CD          DELIMITED BY '  '   18190000
180800                    '.'                       DELIMITED BY SIZE   18200000
180900               INTO PV-EDI-ERROR-MSG                              18210000
181000             END-STRING                                           18220000
181100         WHEN 42                                                  18230000
181200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18240000
181300                    ', '                      DELIMITED BY SIZE   18250000
181400                    TYPE2-SHP-YY              DELIMITED BY SIZE   18260000
181500                    '/'                       DELIMITED BY SIZE   18270000
181600                    TYPE2-SHP-MM              DELIMITED BY SIZE   18280000
181700                    '/'                       DELIMITED BY SIZE   18290000
181800                    TYPE2-SHP-DD              DELIMITED BY SIZE   18300000
181900               INTO PV-EDI-ERROR-MSG                              18310000
182000             END-STRING                                           18320000
182100         WHEN 43                                                  18330000
182200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18340000
182300                    ', '                      DELIMITED BY SIZE   18350000
182400                    TYPE2-EFF-YY              DELIMITED BY SIZE   18360000
182500                    '/'                       DELIMITED BY SIZE   18370000
182600                    TYPE2-EFF-MM              DELIMITED BY SIZE   18380000
182700                    '/'                       DELIMITED BY SIZE   18390000
182800                    TYPE2-EFF-DD              DELIMITED BY SIZE   18400000
182900               INTO PV-EDI-ERROR-MSG                              18410000
183000             END-STRING                                           18420000
183100         WHEN 44                                                  18430000
183200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18440000
183300                    ', '                      DELIMITED BY SIZE   18450000
183400                    TYPE4-DISC-DUE-YY         DELIMITED BY SIZE   18460000
183500                    '/'                       DELIMITED BY SIZE   18470000
183600                    TYPE4-DISC-DUE-MM         DELIMITED BY SIZE   18480000
183700                    '/'                       DELIMITED BY SIZE   18490000
183800                    TYPE4-DISC-DUE-DD         DELIMITED BY SIZE   18500000
183900               INTO PV-EDI-ERROR-MSG                              18510000
184000             END-STRING                                           18520000
184100         WHEN 45                                                  18530000
184200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18540000
184300                    ', '                      DELIMITED BY SIZE   18550000
184400                    TYPE4-NET-DUE-YY          DELIMITED BY SIZE   18560000
184500                    '/'                       DELIMITED BY SIZE   18570000
184600                    TYPE4-NET-DUE-MM          DELIMITED BY SIZE   18580000
184700                    '/'                       DELIMITED BY SIZE   18590000
184800                    TYPE4-NET-DUE-DD          DELIMITED BY SIZE   18600000
184900               INTO PV-EDI-ERROR-MSG                              18610000
185000             END-STRING                                           18620000
185100         WHEN 46                                                  18630000
185200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18640000
185300                    ', '                      DELIMITED BY SIZE   18650000
185400                    TYPE4-DEF-DUE-YY          DELIMITED BY SIZE   18660000
185500                    '/'                       DELIMITED BY SIZE   18670000
185600                    TYPE4-DEF-DUE-MM          DELIMITED BY SIZE   18680000
185700                    '/'                       DELIMITED BY SIZE   18690000
185800                    TYPE4-DEF-DUE-DD          DELIMITED BY SIZE   18700000
185900               INTO PV-EDI-ERROR-MSG                              18710000
186000             END-STRING                                           18720000
186100         WHEN 51                                                  18730000
186200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18740000
186300                    TYPE6-DISC-AMT-DUE        DELIMITED BY SIZE   18750000
186400                    '>'                       DELIMITED BY SIZE   18760000
186500                    TYPE6-GROSS-INV-AMT       DELIMITED BY SIZE   18770000
186600               INTO PV-EDI-ERROR-MSG                              18780000
186700             END-STRING                                           18790000
186800         WHEN 53                                                  18800000
186900             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18810000
187000                    ', '                      DELIMITED BY SIZE   18820000
187100                    TYPE4-DISC-PCT            DELIMITED BY SIZE   18830000
187200                    '.'                       DELIMITED BY SIZE   18840000
187300               INTO PV-EDI-ERROR-MSG                              18850000
187400             END-STRING                                           18860000
187500         WHEN 54                                                  18870000
187600             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18880000
187700                    ', '                      DELIMITED BY SIZE   18890000
187800                    TYPE4-DISC-AMT            DELIMITED BY SIZE   18900000
187900                    '.'                       DELIMITED BY SIZE   18910000
188000               INTO PV-EDI-ERROR-MSG                              18920000
188100             END-STRING                                           18930000
188200         WHEN 55                                                  18940000
188300             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   18950000
188400                    ', '                      DELIMITED BY SIZE   18960000
188500                    TYPE4-DEF-PCT-PAY         DELIMITED BY SIZE   18970000
188600                    '.'                       DELIMITED BY SIZE   18980000
188700               INTO PV-EDI-ERROR-MSG                              18990000
188800             END-STRING                                           19000000
188900         WHEN 56                                                  19010000
189000             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19020000
189100                    ', '                      DELIMITED BY SIZE   19030000
189200                    TYPE4-DEF-AMT             DELIMITED BY SIZE   19040000
189300                    '.'                       DELIMITED BY SIZE   19050000
189400               INTO PV-EDI-ERROR-MSG                              19060000
189500             END-STRING                                           19070000
189600         WHEN 57                                                  19080000
189700             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19090000
189800                    ', '                      DELIMITED BY SIZE   19100000
189900                    TYPE5-ALLW-CHRG-TOTL      DELIMITED BY SIZE   19110000
190000                    '.'                       DELIMITED BY SIZE   19120000
190100               INTO PV-EDI-ERROR-MSG                              19130000
190200             END-STRING                                           19140000
190300         WHEN 58                                                  19150000
190400             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19160000
190500                    ', '                      DELIMITED BY SIZE   19170000
190600                    TYPE5-ALLW-CHRG-PCT       DELIMITED BY SIZE   19180000
190700                    '.'                       DELIMITED BY SIZE   19190000
190800               INTO PV-EDI-ERROR-MSG                              19200000
190900             END-STRING                                           19210000
191000         WHEN 59                                                  19220000
191100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19230000
191200                    ', '                      DELIMITED BY SIZE   19240000
191300                    TYPE6-GROSS-INV-AMT       DELIMITED BY SIZE   19250000
191400                    '.'                       DELIMITED BY SIZE   19260000
191500               INTO PV-EDI-ERROR-MSG                              19270000
191600             END-STRING                                           19280000
191700         WHEN 60                                                  19290000
191800             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19300000
191900                    ', '                      DELIMITED BY SIZE   19310000
192000                    TYPE6-AMT-SUBJ-DISC       DELIMITED BY SIZE   19320000
192100                    '.'                       DELIMITED BY SIZE   19330000
192200               INTO PV-EDI-ERROR-MSG                              19340000
192300             END-STRING                                           19350000
192400         WHEN 61                                                  19360000
192500             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19370000
192600                    ', '                      DELIMITED BY SIZE   19380000
192700                    TYPE6-DISC-AMT            DELIMITED BY SIZE   19390000
192800                    '.'                       DELIMITED BY SIZE   19400000
192900               INTO PV-EDI-ERROR-MSG                              19410000
193000             END-STRING                                           19420000
193100         WHEN 62                                                  19430000
193200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19440000
193300                    ', '                      DELIMITED BY SIZE   19450000
193400                    TYPE6-DISC-AMT-DUE        DELIMITED BY SIZE   19460000
193500                    '.'                       DELIMITED BY SIZE   19470000
193600               INTO PV-EDI-ERROR-MSG                              19480000
193700             END-STRING                                           19490000
193800         WHEN 63                                                  19500000
193900             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19510000
194000                    ', '                      DELIMITED BY SIZE   19520000
194100                    TYPE7-QTY-INVD            DELIMITED BY SIZE   19530000
194200                    '.'                       DELIMITED BY SIZE   19540000
194300               INTO PV-EDI-ERROR-MSG                              19550000
194400             END-STRING                                           19560000
194500         WHEN 64                                                  19570000
194600             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19580000
194700                    ', '                      DELIMITED BY SIZE   19590000
194800                    TYPE7-WHOL-COST           DELIMITED BY SIZE   19600000
194900                    '.'                       DELIMITED BY SIZE   19610000
195000               INTO PV-EDI-ERROR-MSG                              19620000
195100             END-STRING                                           19630000
195200         WHEN 70                                                  19640000
195300             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19650000
195400                    ', '                      DELIMITED BY SIZE   19660000
195500                    TYPE1-SENDER-ID           DELIMITED BY SIZE   19670000
195600                    '.'                       DELIMITED BY SIZE   19680000
195700               INTO PV-EDI-ERROR-MSG                              19690000
195800             END-STRING                                           19700000
195900         WHEN 74                                                  19710000
196000             MOVE EDI-ERROR-MSG(80) TO PV-EDI-ERROR-MSG           19720000
196100         WHEN 75                                                  19730000
196200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   19740000
196300                    ' = '                     DELIMITED BY SIZE   19750000
196400                    PV-TOT-INVC-LINES         DELIMITED BY SIZE   19760000
196500                    '.'                       DELIMITED BY SIZE   19770000
196600               INTO PV-EDI-ERROR-MSG                              19780000
196700             END-STRING                                           19790000
196800         WHEN OTHER                                               19800000
196900             MOVE EDI-ERROR-MSG(ERR-INDX) TO PV-EDI-ERROR-MSG     19810000
197000     END-EVALUATE.                                                19820000
197100                                                                  19830000
197200*--------------------------------------------------------------*  19840000
197300* END OF JOB ROUTINES, PRINT COUNTS, CLOSE FILES               *  19850000
197400*--------------------------------------------------------------*  19860000
197500 Z900-END-OF-JOB.                                                 19870000
197600                                                                  19880000
197700     ADD 1 TO PV-LINE-COUNT.                                      19890000
197800     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            19900000
197900        PERFORM W200-HEADING-ROUTINE                              19910000
198000     END-IF.                                                      19920000
198100                                                                  19930000
198200     IF NOT WS-EDI-REJ-EMPTY-FILE                                 19940000
198300        WRITE EDI-LINE FROM END-OF-INVOICE-LINE                   19950000
198400            AFTER ADVANCING 1 LINE                                19960000
081100        IF PV-NEXUS-INVC-YES                                      19961099
081400            WRITE AP-DI-REJ-LINE FROM END-OF-INVOICE-LINE         19966099
081500                AFTER ADVANCING 1 LINE                            19967099
081500        END-IF                                                    19969099
198500     END-IF.                                                      19970000
198600                                                                  19980000
198200     IF PV-NEXUS-COUNT = 0                                        19981099
075600        MOVE 0                    TO HL2-VENDOR-NBR               19981199
075600        MOVE SPACES               TO HL2-ENT-ID-DESC              19981299
075600        MOVE SPACES               TO HL2-INVOICE-NBR              19981399
075600        MOVE 0                    TO HL2-PO-NBR                   19981499
075600        MOVE 0                    TO HL2-INTERCHG-CNTL-NBR        19981599
075600        PERFORM W550-HEADING-DI                                   19981699
081400        WRITE AP-DI-REJ-LINE FROM NO-DATA-LINE                    19986099
081500            AFTER ADVANCING 1 LINE                                19987099
198500     END-IF.                                                      19989099
198600                                                                  19989199
198700     ADD 2 TO PV-LINE-COUNT.                                      19990000
198800     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            20000000
198900        PERFORM W200-HEADING-ROUTINE                              20010000
199000     END-IF.                                                      20020000
199100                                                                  20030000
199200     IF NOT WS-EDI-REJ-EMPTY-FILE                                 20040000
199300        WRITE EDI-LINE FROM EOR-END-OF-REPORT-LINE                20050000
199400            AFTER ADVANCING 2 LINE                                20060000
081100        IF PV-NEXUS-INVC-YES                                      20061099
081400            WRITE AP-DI-REJ-LINE FROM EOR-END-OF-REPORT-LINE      20062099
081500                AFTER ADVANCING 1 LINE                            20063099
081500        END-IF                                                    20064099
199500     END-IF.                                                      20070000
199600                                                                  20080000
199700     IF NOT WS-EDI-REJ-EMPTY-FILE                                 20090000
199800        PERFORM W000-SUMMARY-LINES                                20100000
199900     END-IF.                                                      20110000
200000                                                                  20120094
200402                                                                  20180000
200403     CLOSE EDI-REJ-FILE                                           20190000
200404           EDI-REPORT                                             20200000
200405           EDI-SUMM-REPORT                                        20210000
200405           AP-DI-EDI-REJ                                          20211099
200406           AP-SUMM-REPORT.                                        20220000
