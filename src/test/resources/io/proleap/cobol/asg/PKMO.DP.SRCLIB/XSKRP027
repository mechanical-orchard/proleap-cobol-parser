000100*----------------------------------------------------------       00010035
000200 IDENTIFICATION DIVISION.                                         00020035
000300*----------------------------------------------------------       00030035
000400 PROGRAM-ID.    XSKRP027.                                         00040035
000500 AUTHOR.        JOSEPH MENYAH.                                    00050035
000600 DATE-WRITTEN.  OCTOBER , 2002.                                   00060035
000700                                                                  00070035
000800*----------------------------------------------------------       00080035
000900*            ADHOC STORELIST EVENT INTEGRITY CHECK                00090035
001000*----------------------------------------------------------       00100035
001010* THIS PROGRAM WILL PERFORM THE NECESSARY BUSINESS EVENT          00110035
001020* INTEGRITY CHECK FOR THE PROMOTION BSINESS EVENT.                00120035
001124*                                                                 00130035
001125*----------------------------------------------------------       00140035
P11215*  DATE:11/22/2010 CHANGED BY: COGNIZANT     PBI11215             00150035
P11215*  CHANGED THE PGM LOGIC IN SUCH A WAY SO THAT                    00160035
P11215*  THE REPORT WILL SKIP THE SKU'S AND READ THE NEXT SKU           00170035
P11215*  WHEN STAT_CDE IN PROMO TABLES IS EQUAL TO 'D'.                 00180035
001128*----------------------------------------------------------       00190035
100691* DATE: 01-14-2015                                                00200039
100691* WR/IR#: CHG0100691                                              00210039
100691* PROGRAMMER: COGNIZANT                                           00220039
100691* DESCRIPTION: CHANGED THE LENGTH OF ERROR-RECORD FROM 80 TO 125  00230039
100691* TO ACCOMODATE THE FULL DIFFERENCES-RECORD WHILE WRITING         00240039
001160*----------------------------------------------------------       00250035
001128*----------------------------------------------------------       00251036
001129* DATE:                                                           00252036
001130* WR/IR#:                                                         00253036
001131* PROGRAMMER:                                                     00254036
001140* DESCRIPTION:                                                    00255036
001150*                                                                 00256036
001160*----------------------------------------------------------       00257036
001170 ENVIRONMENT DIVISION.                                            00260035
001180*----------------------------------------------------------       00270035
001190 CONFIGURATION SECTION.                                           00280035
001200 SOURCE-COMPUTER. IBM-3090.                                       00290035
001300 OBJECT-COMPUTER. IBM-3090.                                       00300035
001400                                                                  00310035
001500 INPUT-OUTPUT SECTION.                                            00320035
001600                                                                  00330035
001700 FILE-CONTROL.                                                    00340035
004900     SELECT CONTROL-CARD                                          00350035
005000         ASSIGN TO INP00.                                         00360035
                                                                        00370035
004900     SELECT PROMO-EXTRACT-FILE                                    00380035
005000         ASSIGN TO INP01.                                         00390035
                                                                        00400035
004900     SELECT DOMAIN-EXTRACT-FILE                                   00410035
005000         ASSIGN TO INP02.                                         00420035
                                                                        00430035
                                                                        00440035
004900     SELECT ERROR-FILE                                            00450035
005000         ASSIGN TO OUT01.                                         00460035
                                                                        00470035
004900     SELECT REPORT-FILE                                           00480035
005000         ASSIGN TO RPT01.                                         00490035
                                                                        00500035
001900*----------------------------------------------------------       00510035
002000 DATA DIVISION.                                                   00520035
002100*----------------------------------------------------------       00530035
002200 FILE SECTION.                                                    00540035
002300                                                                  00550035
008000 FD  PROMO-EXTRACT-FILE                                           00560035
008100     RECORDING MODE IS F                                          00570035
008200     LABEL RECORDS ARE OMITTED                                    00580035
008300     RECORD CONTAINS 125 CHARACTERS                               00590035
008400     DATA RECORD IS PROMO-EVNT-RECORD.                            00600035
008500 01  PROMO-EVNT-REC              PIC X(125).                      00610035
008600                                                                  00620035
008000 FD  DOMAIN-EXTRACT-FILE                                          00630035
008100     RECORDING MODE IS F                                          00640035
008200     LABEL RECORDS ARE OMITTED                                    00650035
008300     RECORD CONTAINS 125 CHARACTERS                               00660035
008400     DATA RECORD IS DOMAIN-EVNT-RECORD.                           00670035
008500 01  DOMAIN-EVNT-REC              PIC X(125).                     00680035
006500                                                                  00690035
       FD  CONTROL-CARD                                                 00700035
           RECORDING MODE F                                             00710035
           BLOCK CONTAINS 0 RECORDS                                     00720035
           LABEL RECORDS ARE OMITTED                                    00730035
           DATA RECORD IS CONTROL-CARD-RECORD.                          00740035
       01  CONTROL-CARD-RECORD             PIC X(080).                  00750035
                                                                        00760035
       FD  REPORT-FILE                                                  00770035
           RECORDING MODE F                                             00780035
           BLOCK CONTAINS 0 RECORDS                                     00790035
           LABEL RECORDS ARE OMITTED                                    00800035
009600     RECORD CONTAINS 132 CHARACTERS                               00810035
           DATA RECORD IS REPORT-RECORD.                                00820035
       01  REPORT-RECORD                   PIC X(132).                  00830035
                                                                        00840035
       FD  ERROR-FILE                                                   00850035
           RECORDING MODE F                                             00860035
           BLOCK CONTAINS 0 RECORDS                                     00870035
           LABEL RECORDS ARE OMITTED                                    00880035
           DATA RECORD IS DIFFERENCES-RECORD.                           00890035
       01  DIFFERENCES-RECORD              PIC X(125).                  00900035
                                                                        00910035
002500*---------------------------------------------------------        00920035
002600                                                                  00930035
002700 WORKING-STORAGE SECTION.                                         00940035
002800*---------------------------------------------------------        00950035
003500* PC- PROGRAM CONSTANTS                                           00960035
003600*----------------------------------------------------------       00970035
003700 01  PC-PROGRAM-CONSTANTS.                                        00980035
003800     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XSKRP027'. 00990035
003900     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   01000035
004000                                                                  01010035
097700 01  CD-CPU-DATE.                                                 01020035
097800     03  CD-CPU-YEAR             PIC 99.                          01030035
097900     03  CD-CPU-MONTH            PIC 99.                          01040035
098000     03  CD-CPU-DAY              PIC 99.                          01050035
098100                                                                  01060035
098200 01  CD-CPU-DATE-CC.                                              01070035
098300     03  CD-CPU-CENT             PIC 99.                          01080035
098400     03  CD-CPU-YYMMDD           PIC 9(6).                        01090035
                                                                        01100035
084800 01  PC-REPORT-NO                PIC  9(5)          VALUE 00001.  01110035
                                                                        01120035
011200 01  CT-CPU-TIME.                                                 01130035
011300     03  CT-HOUR                 PIC 99.                          01140035
011400     03  CT-MINUTE               PIC 99.                          01150035
011500     03  FILLER                  PIC 9(4).                        01160035
      *----------------------------------------------------------       01170035
      **PROGRAM                                                         01180035
      *----------------------------------------------------------       01190035
       01  PC-PROGRAM-COUNTER.                                          01200035
           05  PC-RECORD-COUNT                 PIC S9(09) VALUE ZEROS   01210035
                                                          COMP-3.       01220035
           05  PC-PROMO-EXTRACT-RECS-READ      PIC 9(09) VALUE ZEROS.   01230035
           05  PC-DOMAIN-EXTRACT-RECS-READ     PIC 9(09) VALUE ZEROS.   01240035
           05  PC-ERROR-RECORD-WRITTEN         PIC 9(09) VALUE ZEROS.   01250035
           05  PC-ERROR-REPORT-WRITTEN         PIC 9(09) VALUE ZEROS.   01260035
           05  PC-PAGE-CNT                     PIC 9(09) VALUE ZEROS.   01270035
004100*----------------------------------------------------------       01280035
004200* PS- PROGRAM SWITCHES                                            01290035
004300*----------------------------------------------------------       01300035
004400 01  PS-PROGRAM-SWITCHES.                                         01310035
004500     05  PS-EOF-PROMO-EXTRACT-SW          PIC X(01)  VALUE SPACE. 01320035
004600         88  PS-EOF-PROMO                        VALUE 'Y'.       01330035
004600         88  PS-NOT-EOF-PROMO                    VALUE 'N'.       01340035
004800                                                                  01350035
004500     05  PS-EOF-DOMAIN-EXTRACT-SW         PIC X(01)  VALUE SPACE. 01360035
004600         88  PS-EOF-DOMAIN                       VALUE 'Y'.       01370035
004600         88  PS-NOT-EOF-DOMAIN                   VALUE 'N'.       01380035
004800                                                                  01390035
004500     05  PS-NEW-RECORD-SW                 PIC X(01)  VALUE SPACE. 01400035
004600         88  PS-NEW-RECORD                       VALUE 'Y'.       01410035
004600         88  PS-NOT-NEW-RECORD                   VALUE 'N'.       01420035
004800                                                                  01430035
004900*----------------------------------------------------------       01440035
      *    CONTROL-CARD-LAYOUT.                                         01450035
004900*----------------------------------------------------------       01460035
       01  CONTROL-CARD-LAYOUT.                                         01470035
           05  CC-START-POINT                  PIC 9(05) VALUE ZEROS.   01480035
           05  FILLER                          PIC X(01) VALUE SPACES.  01490035
           05  CC-READ-FREQUENCY               PIC 9(05) VALUE ZEROS.   01500035
           05  FILLER                          PIC X(69) VALUE SPACES.  01510035
004900*----------------------------------------------------------       01520035
005000* PV- PROGRAM VARIABLES                                           01530035
005100*----------------------------------------------------------       01540035
005200 01 PV-PROGRAM-VARIABLES.                                         01550035
013800    05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 01560035
005500    05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   01570035
005600    05  PV-MAX-OFFSET-DTE             PIC 9(08)  VALUE 0.         01580035
005710    05  PV-ADHC-STR-GP-ID-HLD         PIC 9(10) VALUE 0.          01590035
005710    05  PV-STR-NBR-HLD                PIC 9(05) VALUE 0.          01600035
005800    05  PV-ACTION-CODE                PIC X(01).                  01610035
005810        88  PV-INSERT-DATA                       VALUE 'I'.       01620035
005820        88  PV-UPDATE-DATA                       VALUE 'U'.       01630035
                                                                        01640035
006000    05  PV-RECORD-COUNT               PIC 9(05) VALUE ZEROS.      01650035
006000    05  PV-LD-STATUS-CDE              PIC X(02).                  01660035
006100        88  PV-NO-ERROR                          VALUE '00'.      01670035
006200        88  PV-CRITICAL-ERROR                    VALUE '01'.      01680035
006300        88  PV-NOT-CRITICAL-ERROR                VALUE '02'.      01690035
007000                                                                  01700035
           05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     01710035
               88  PS-ERROR-FOUND                        VALUE 'Y'.     01720035
               88  PS-ERROR-NOT-FOUND                    VALUE 'N'.     01730035
                                                                        01740035
007100    05  PV-STRT-PARM.                                             01750035
007200        10  PV-STRT-DTE-CC            PIC X(02).                  01760035
007200        10  PV-STRT-DTE-YY            PIC X(02).                  01770035
007400        10  PV-STRT-DTE-MM            PIC X(02).                  01780035
007600        10  PV-STRT-DTE-DD            PIC X(02).                  01790035
007400        10  FILLER                    PIC X.                      01800035
007400        10  PV-DECREMENT              PIC X(02).                  01810035
007400        10  FILLER                    PIC X(69).                  01820035
007700                                                                  01830035
007100    05  PV-PROMO-STRT-DTE           PIC X(10).                    01840035
007100    05  PV-PROMO-END-DTE            PIC X(10).                    01850035
                                                                        01860035
008600    05  PV-PROMO-KEY.                                             01870035
008700        10  PV-PM-ADHC-STR-GP-ID          PIC 9(10).              01880035
008700        10  PV-PM-STR-NBR                 PIC 9(05).              01890035
                                                                        01900035
008600    05  PV-DOMAIN-KEY.                                            01910035
008700        10  PV-XS-ADHC-STR-GP-ID          PIC 9(10).              01920035
008700        10  PV-XS-STR-NBR                 PIC 9(05).              01930035
                                                                        01940035
008600    05  PV-AD-EVNT-END-DTE-TM.                                    01950035
008700        10  PV-AD-EVNT-END-DTE.                                   01960035
008800            15  PV-AD-EVNT-DTE-TM2-CCYY   PIC X(04).              01970035
008900            15  FILLER                    PIC X(01).              01980035
009000            15  PV-AD-EVNT-DTE-TM2-MM     PIC X(02).              01990035
009100            15  FILLER                    PIC X(01).              02000035
009200            15  PV-AD-EVNT-DTE-TM2-DD     PIC X(02).              02010035
009300        10  PV-AD-EVNT-END-TM             PIC X(16).              02020035
009400                                                                  02030035
008600    05  PV-PROMO-SOURCE              PIC X(40) VALUE              02040035
              'DATA SOURCE IS THE PROMO DATABASE'.                      02050035
                                                                        02060035
008600    05  PV-PROMO-NF                  PIC X(40) VALUE              02070035
              'RECORD NOT FOUND IN XS DOMAIN'.                          02080035
                                                                        02090035
008600    05  PV-DOMAIN-SOURCE             PIC X(40) VALUE              02100035
              'DATA SOURCE IS THE XS DOMAIN DATABASE'.                  02110035
                                                                        02120035
008600    05  PV-DOMAIN-NF                  PIC X(40) VALUE             02130035
              'RECORD NOT FOUND IN PROMO TABLES'.                       02140035
                                                                        02150035
       01  PV-PM-TOTAL-RECORD.                                          02160035
           05 PV-PM-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    02170035
           05 PV-PM-ACTION-CDE                 PIC X(01) VALUE 'T'.     02180035
           05 PV-PM-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    02190035
                                                                        02200035
       01  PV-XS-TOTAL-RECORD.                                          02210035
           05 PV-XS-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    02220035
           05 PV-XS-ACTION-CDE                 PIC X(01) VALUE 'T'.     02230035
           05 PV-XS-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    02240035
                                                                        02250035
100691 01  ERROR-RECORD               PIC X(125)   VALUE SPACES.        02260039
100691*01  ERROR-RECORD               PIC X(080)   VALUE SPACES.        02261039
                                                                        02270035
042800     COPY DPWS132O.                                               02280035
042900                                                                  02290035
                                                                        02300035
043100 01  DR-HEAD2.                                                    02310035
043200     05  FILLER                 PIC X(41)    VALUE SPACES.        02320035
043300     05  DR-TITLE               PIC X(55)    VALUE                02330035
043400      'INTEGRITY CHECK PROGRAM  - ADHOC STORE LIST'.              02340035
                                                                        02350035
043500                                                                  02360035
043100 01  DR-HEAD3.                                                    02370035
043200     05  FILLER                 PIC X(03)    VALUE                02380035
            'KEY'.                                                      02390035
043200     05  FILLER                 PIC X(15)    VALUE SPACES.        02400035
043200     05  FILLER                 PIC X(10)    VALUE                02410035
            'FIELD NAME'.                                               02420035
043200     05  FILLER                 PIC X(14)    VALUE SPACES.        02430035
043200     05  FILLER                 PIC X(05)    VALUE                02440035
            'VALUE'.                                                    02450035
043200     05  FILLER                 PIC X(31)    VALUE SPACES.        02460035
043200     05  FILLER                 PIC X(16)    VALUE                02470035
            'SOURCE / MESSAGE'.                                         02480035
043200     05  FILLER                 PIC X(35)    VALUE SPACES.        02490035
043500                                                                  02500035
043100 01  DR-HEAD5.                                                    02510035
043200     05  FILLER                 PIC X(132)   VALUE ALL '='.       02520035
000700 01  REPORT-DETAIL.                                               02530035
000800   05 PROMO-RPT-INFO.                                             02540035
000800      10 PROMO-EVNT-KEY.                                          02550035
000800         15 PROMO-EVNT-ID            PIC 9(10) VALUE ZERO.        02560035
000800         15 PROMO-EVNT-STR-NBR       PIC 9(05) VALUE ZERO.        02570035
 00800      10 FILLER                      PIC X(5).                    02580035
 00800      10 PROMO-RPT-DATA-NAME         PIC X(20).                   02590035
 00800      10 FILLER                      PIC X(2).                    02600035
 00800      10 PROMO-RPT-DATA-VALUE        PIC X(40).                   02610035
000800   05 REPORT-NOTES                   PIC X(40).                   02620035
010900*----------------------------------------------------------       02630035
011000* DOMAIN ADHOC STORE LIST EVENT RECORD LAYOUT                     02640035
011100*----------------------------------------------------------       02650035
011200     COPY XSRD024.                                                02660035
011800                                                                  02670035
004900*----------------------------------------------------------       02680035
005000* PROMO ADHOC STORE LIST  COPY BOOK.                              02690035
005100*----------------------------------------------------------       02700035
           COPY PMRD705.                                                02710035
011800                                                                  02720035
030310                                                                  02730035
031400*----------------------------------------------------------       02740035
031500 PROCEDURE DIVISION.                                              02750035
032100*----------------------------------------------------------       02760035
032200 0000-MAINLINE.                                                   02770035
128200     ACCEPT CD-CPU-DATE FROM DATE.                                02780035
128300     IF CD-CPU-YEAR > 80                                          02790035
128400         MOVE 19 TO CD-CPU-CENT                                   02800035
128500     ELSE                                                         02810035
128600         MOVE 20 TO CD-CPU-CENT.                                  02820035
128700     MOVE CD-CPU-DATE TO CD-CPU-YYMMDD.                           02830035
128800                                                                  02840035
128900     ACCEPT CT-CPU-TIME FROM TIME.                                02850035
032300                                                                  02860035
032400     PERFORM 1000-INITIALIZATION.                                 02870035
032500                                                                  02880035
032600     PERFORM 2000-PROCESS-EXTRACT-DATA                            02890035
032700             UNTIL PS-EOF-DOMAIN                                  02900035
032700                OR PS-EOF-PROMO.                                  02910035
                                                                        02920035
           PERFORM 3000-PROCESS-EXTRA-RECORDS                           02930035
032700             UNTIL PS-EOF-DOMAIN                                  02940035
032700               AND PS-EOF-PROMO.                                  02950035
035000                                                                  02960035
035100     PERFORM 9999-WRAPUP.                                         02970035
035200                                                                  02980035
035500     GOBACK.                                                      02990035
035700                                                                  03000035
035701*0000-EXIT.                                                       03010035
035702 EJECT.                                                           03020035
035703                                                                  03030035
035800*----------------------------------------------------------       03040035
035900* 1000-INITIALIZATION.                                            03050035
036000*     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            03060035
036100*     UPDATE OR INSERT A RECORD.                                  03070035
036200*----------------------------------------------------------       03080035
036300 1000-INITIALIZATION.                                             03090035
                                                                        03100035
132408     MOVE CD-CPU-YEAR  TO DP132O-RUN-YEAR.                        03110035
132409     MOVE CD-CPU-MONTH TO DP132O-RUN-MONTH.                       03120035
132410     MOVE CD-CPU-DAY   TO DP132O-RUN-DAY.                         03130035
132420     MOVE CT-HOUR    TO DP132O-RUN-HOUR.                          03140035
132430     MOVE CT-MINUTE  TO DP132O-RUN-MINUTE.                        03150035
132440     MOVE 'XSKRP027' TO DP132O-PROGRAM-NAME.                      03160035
132450     MOVE 1          TO DP132O-REPORT-NUMBER.                     03170035
           SET PS-NOT-EOF-PROMO TO TRUE.                                03180035
           SET PS-NOT-EOF-DOMAIN TO TRUE.                               03190035
026600     OPEN INPUT  PROMO-EXTRACT-FILE                               03200035
026600                 DOMAIN-EXTRACT-FILE                              03210035
026600                 CONTROL-CARD                                     03220035
026600          OUTPUT ERROR-FILE                                       03230035
026600                 REPORT-FILE.                                     03240035
                                                                        03250035
           PERFORM 9999-PRINT-HEADINGS.                                 03260035
           PERFORM 9999-READ-CONTROL-CARD.                              03270035
           READ DOMAIN-EXTRACT-FILE INTO PV-XS-TOTAL-RECORD             03280035
           READ PROMO-EXTRACT-FILE INTO PV-PM-TOTAL-RECORD              03290035
                                                                        03300035
           IF PV-PM-TOTAL-NBR-OF-RECS NOT EQUAL TO                      03310035
              PV-XS-TOTAL-NBR-OF-RECS                                   03320035
             MOVE 1 TO CC-START-POINT                                   03330035
             MOVE 1 TO CC-READ-FREQUENCY                                03340035
           END-IF.                                                      03350035
                                                                        03360035
           PERFORM 9999-READ-PROMO-EXTRACT CC-START-POINT TIMES.        03370035
           PERFORM 9999-READ-DOMAIN-EXTRACT  CC-START-POINT TIMES.      03380035
                                                                        03390035
056500                                                                  03400035
037240*1100-EXIT.                                                       03410035
037250 EJECT.                                                           03420035
037251                                                                  03430035
037260*----------------------------------------------------------       03440035
037300* 2000-PROCESS-EXTRACT-DATA.                                      03450035
037400*     THIS CHECKS THE ACTION TO SEE WHETHER THE RECORD            03460035
037500*     SHOULD BE INSERTED INTO THE AD EVENT TABLE OR UPDATED.      03470035
037600*     IF SOMETHING IS WRONG WITH THE ACTION CODE IT WILL          03480035
037700*     PROCESS AN ERROR AND EXIT THE PROGRAM.                      03490035
037800*----------------------------------------------------------       03500035
037900 2000-PROCESS-EXTRACT-DATA.                                       03510035
                                                                        03520035
           IF PM705-ADHC-STR-GP-ID = XS024-ADHC-STR-GP-ID               03530035
              IF PM705-STR-NBR        = XS024-STR-NBR                   03540035
                PERFORM 2100-COMPARE-FIELDS                             03550035
                PERFORM 9999-READ-DOMAIN-EXTRACT                        03560035
                        CC-READ-FREQUENCY TIMES                         03570035
                PERFORM 9999-READ-PROMO-EXTRACT                         03580035
                        CC-READ-FREQUENCY TIMES                         03590035
              ELSE                                                      03600035
                 IF PM705-STR-NBR > XS024-STR-NBR                       03610035
                    MOVE PV-DOMAIN-NF TO REPORT-NOTES                   03620035
                    MOVE PV-DOMAIN-KEY TO PROMO-EVNT-KEY                03630035
                    PERFORM 9999-WRITE-ERROR-REPORT                     03640035
                    MOVE XS024-ADHOC-STR-LST-RECORD TO ERROR-RECORD     03650035
                    PERFORM 9999-WRITE-ERROR-RECORD                     03660035
                    PERFORM 9999-READ-DOMAIN-EXTRACT                    03670035
                 ELSE                                                   03680035
P11215            IF PM705-STAT-CDE = 'D'                               03690035
P11215              PERFORM 9999-READ-PROMO-EXTRACT                     03700035
P11215            ELSE                                                  03710035
                    MOVE PV-PROMO-NF   TO REPORT-NOTES                  03720035
                    MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY                03730035
                    PERFORM 9999-WRITE-ERROR-REPORT                     03740035
                    MOVE PM705-ADHOC-STR-LST-RECORD TO ERROR-RECORD     03750035
                    PERFORM 9999-WRITE-ERROR-RECORD                     03760035
                    PERFORM 9999-READ-PROMO-EXTRACT                     03770035
P11215            END-IF                                                03780035
                 END-IF                                                 03790035
              END-IF                                                    03800035
           ELSE                                                         03810035
              IF PM705-ADHC-STR-GP-ID  > XS024-ADHC-STR-GP-ID           03820035
                 MOVE PV-DOMAIN-NF TO REPORT-NOTES                      03830035
                 MOVE PV-DOMAIN-KEY TO PROMO-EVNT-KEY                   03840035
                 PERFORM 9999-WRITE-ERROR-REPORT                        03850035
                 MOVE XS024-ADHOC-STR-LST-RECORD TO ERROR-RECORD        03860035
                 PERFORM 9999-WRITE-ERROR-RECORD                        03870035
                 PERFORM 9999-READ-DOMAIN-EXTRACT                       03880035
              ELSE                                                      03890035
P11215         IF PM705-STAT-CDE = 'D'                                  03900035
P11215           PERFORM 9999-READ-PROMO-EXTRACT                        03910035
P11215         ELSE                                                     03920035
                 MOVE PV-PROMO-NF TO REPORT-NOTES                       03930035
                 MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY                    03940035
                 PERFORM 9999-WRITE-ERROR-REPORT                        03950035
                 MOVE PM705-ADHOC-STR-LST-RECORD TO ERROR-RECORD        03960035
                 PERFORM 9999-WRITE-ERROR-RECORD                        03970035
                 PERFORM 9999-READ-PROMO-EXTRACT                        03980035
P11215         END-IF                                                   03990035
              END-IF                                                    04000035
           END-IF.                                                      04010035
038000                                                                  04020035
038110*2000-EXIT.                                                       04030035
038200 EJECT.                                                           04040035
                                                                        04050035
038300*------------------------------------------------------           04060035
038400* 2100-COMPARE-FIELDS.                                            04070035
038500*     COMPARES THE EXTRACT FILES AND NOTES ANY DIFFERENCES        04080035
038600*------------------------------------------------------           04090035
038210                                                                  04100035
054400 2100-COMPARE-FIELDS.                                             04110035
036600     IF PM705-BUSINESS-EVNT-ID NOT EQUAL XS024-BUSINESS-EVNT-ID   04120035
              MOVE 'PM705-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      04130035
              MOVE PM705-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     04140035
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             04150035
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           04160035
              PERFORM 9999-WRITE-ERROR-REPORT                           04170035
              MOVE 'XS024-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      04180035
              MOVE XS024-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     04190035
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             04200035
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           04210035
              PERFORM 9999-WRITE-ERROR-REPORT                           04220035
              SET PS-ERROR-FOUND     TO TRUE                            04230035
           END-IF.                                                      04240035
                                                                        04250035
036600     IF PM705-ADHC-STR-GP-ID   NOT EQUAL XS024-ADHC-STR-GP-ID     04260035
              MOVE 'PM705-ADHC-STR-GP-ID'   TO PROMO-RPT-DATA-NAME      04270035
              MOVE PM705-ADHC-STR-GP-ID     TO PROMO-RPT-DATA-VALUE     04280035
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             04290035
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           04300035
              PERFORM 9999-WRITE-ERROR-REPORT                           04310035
              MOVE 'XS024-ADHC-STR-GP-ID'   TO PROMO-RPT-DATA-NAME      04320035
              MOVE XS024-ADHC-STR-GP-ID     TO PROMO-RPT-DATA-VALUE     04330035
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             04340035
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           04350035
              PERFORM 9999-WRITE-ERROR-REPORT                           04360035
              SET PS-ERROR-FOUND     TO TRUE                            04370035
           END-IF.                                                      04380035
                                                                        04390035
036600     IF PM705-STAT-CDE  NOT EQUAL XS024-STAT-CDE                  04400035
              MOVE 'PM705-STAT-CDE'   TO PROMO-RPT-DATA-NAME            04410035
              MOVE PM705-STAT-CDE           TO PROMO-RPT-DATA-VALUE     04420035
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             04430035
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           04440035
              PERFORM 9999-WRITE-ERROR-REPORT                           04450035
              MOVE 'XS024-STAT-CDE'   TO PROMO-RPT-DATA-NAME            04460035
              MOVE XS024-STAT-CDE     TO PROMO-RPT-DATA-VALUE           04470035
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             04480035
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           04490035
              PERFORM 9999-WRITE-ERROR-REPORT                           04500035
              SET PS-ERROR-FOUND     TO TRUE                            04510035
           END-IF.                                                      04520035
                                                                        04530035
036600     IF PM705-STR-NBR NOT EQUAL XS024-STR-NBR                     04540035
              MOVE 'PM705-STR-NBR'     TO PROMO-RPT-DATA-NAME           04550035
              MOVE PM705-STR-NBR       TO PROMO-RPT-DATA-VALUE          04560035
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             04570035
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           04580035
              PERFORM 9999-WRITE-ERROR-REPORT                           04590035
              MOVE 'XS024-STR-NBR'   TO PROMO-RPT-DATA-NAME             04600035
              MOVE XS024-STR-NBR     TO PROMO-RPT-DATA-VALUE            04610035
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             04620035
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           04630035
              PERFORM 9999-WRITE-ERROR-REPORT                           04640035
              SET PS-ERROR-FOUND     TO TRUE                            04650035
           END-IF.                                                      04660035
                                                                        04670035
036600     IF PM705-STRT-TMST  NOT EQUAL XS024-STRT-TMST                04680035
              MOVE 'PM705-STRT-TMST'  TO PROMO-RPT-DATA-NAME            04690035
              MOVE PM705-STRT-TMST    TO PROMO-RPT-DATA-VALUE           04700035
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             04710035
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           04720035
              PERFORM 9999-WRITE-ERROR-REPORT                           04730035
              MOVE 'XS024-STRT-TMST' TO PROMO-RPT-DATA-NAME             04740035
              MOVE XS024-STRT-TMST   TO PROMO-RPT-DATA-VALUE            04750035
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             04760035
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           04770035
              PERFORM 9999-WRITE-ERROR-REPORT                           04780035
              SET PS-ERROR-FOUND     TO TRUE                            04790035
           END-IF.                                                      04800035
                                                                        04810035
036600     IF PM705-END-TMST  NOT EQUAL XS024-END-TMST                  04820035
              MOVE 'PM705-END-TMST'  TO PROMO-RPT-DATA-NAME             04830035
              MOVE PM705-END-TMST    TO PROMO-RPT-DATA-VALUE            04840035
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             04850035
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           04860035
              PERFORM 9999-WRITE-ERROR-REPORT                           04870035
              MOVE 'XS024-END-TMST' TO PROMO-RPT-DATA-NAME              04880035
              MOVE XS024-END-TMST   TO PROMO-RPT-DATA-VALUE             04890035
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             04900035
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           04910035
              PERFORM 9999-WRITE-ERROR-REPORT                           04920035
              SET PS-ERROR-FOUND     TO TRUE                            04930035
           END-IF.                                                      04940035
                                                                        04950035
                                                                        04960035
                                                                        04970035
           IF  PS-ERROR-FOUND                                           04980035
037200        IF PM705-LAST-UPD-TMST > XS024-LAST-UPD-TMST              04990035
                 PERFORM 9999-FORMAT-ERROR-RECORD                       05000035
                 PERFORM 9999-WRITE-ERROR-RECORD                        05010035
              END-IF                                                    05020035
              SET PS-ERROR-NOT-FOUND     TO TRUE                        05030035
           END-IF.                                                      05040035
054500                                                                  05050035
056900 2100-EXIT.                                                       05060035
057000     EXIT.                                                        05070035
043600 EJECT.                                                           05080035
043610                                                                  05090035
                                                                        05100035
      ******************************************************************05110035
      **COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   05120035
      ******************************************************************05130035
       3000-PROCESS-EXTRA-RECORDS.                                      05140035
                                                                        05150035
           IF  PS-NOT-EOF-PROMO                                         05160035
P11215      IF PM705-STAT-CDE = 'D'                                     05170035
P11215         PERFORM 9999-READ-PROMO-EXTRACT                          05180035
P11215      ELSE                                                        05190035
               INITIALIZE REPORT-DETAIL                                 05200035
               MOVE PV-PROMO-NF             TO REPORT-NOTES             05210035
               MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY          05220035
               PERFORM 9999-WRITE-ERROR-REPORT                          05230035
               MOVE PM705-ADHOC-STR-LST-RECORD TO ERROR-RECORD          05240035
               PERFORM 9999-WRITE-ERROR-RECORD                          05250035
               PERFORM 9999-READ-PROMO-EXTRACT                          05260035
P11215      END-IF                                                      05270035
           END-IF.                                                      05280035
                                                                        05290035
           IF  PS-NOT-EOF-DOMAIN                                        05300035
               INITIALIZE REPORT-DETAIL                                 05310035
               MOVE PV-DOMAIN-NF             TO REPORT-NOTES            05320035
               MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY          05330035
               PERFORM 9999-WRITE-ERROR-REPORT                          05340035
               MOVE XS024-ADHOC-STR-LST-RECORD TO ERROR-RECORD          05350035
               PERFORM 9999-WRITE-ERROR-RECORD                          05360035
               PERFORM 9999-READ-DOMAIN-EXTRACT                         05370035
           END-IF.                                                      05380035
                                                                        05390035
056900 3000-EXIT.                                                       05400035
057000     EXIT.                                                        05410035
                                                                        05420035
       EJECT.                                                           05430035
059800*----------------------------------------------------------       05440035
059900* 9999-WRAPUP.                                                    05450035
059910*     MOVES ALL ERROR CODES TO THE LINKAGE VARIABLES TO           05460035
059920*     BE PASSED BACK TO THE CALLING PROGRAM.  EXITS THE           05470035
059930*     PROGRAM.                                                    05480035
060000*----------------------------------------------------------       05490035
060100 9999-WRAPUP.                                                     05500035
026600     CLOSE PROMO-EXTRACT-FILE                                     05510035
026600           DOMAIN-EXTRACT-FILE                                    05520035
026600           ERROR-FILE                                             05530035
026600           REPORT-FILE.                                           05540035
                                                                        05550035
           IF  PC-ERROR-RECORD-WRITTEN > 0                              05560035
               MOVE 04               TO RETURN-CODE                     05570035
           END-IF.                                                      05580035
                                                                        05590035
                                                                        05600035
060500                                                                  05610035
060710*9999-EXIT.                                                       05620035
060800 EJECT.                                                           05630035
      ***************************************************************** 05640035
      **FORMAT ERROR-RECORD                                             05650035
      ***************************************************************** 05660035
       9999-FORMAT-ERROR-RECORD.                                        05670035
           MOVE PM705-ADHOC-STR-LST-RECORD TO ERROR-RECORD.             05680035
                                                                        05690035
       EJECT.                                                           05700035
      ***************************************************************** 05710035
      **READ PROMO  EXTRACT FILE                                        05720035
      ***************************************************************** 05730035
       9999-READ-PROMO-EXTRACT.                                         05740035
           IF  PS-NOT-EOF-PROMO                                         05750035
               READ PROMO-EXTRACT-FILE INTO PM705-ADHOC-STR-LST-RECORD  05760035
                    AT END                                              05770035
                       SET PS-EOF-PROMO TO TRUE                         05780035
               END-READ                                                 05790035
           END-IF.                                                      05800035
                                                                        05810035
           IF  PS-NOT-EOF-PROMO                                         05820035
               ADD +1                  TO PC-PROMO-EXTRACT-RECS-READ    05830035
               MOVE PM705-ADHC-STR-GP-ID TO PV-PM-ADHC-STR-GP-ID        05840035
               MOVE PM705-STR-NBR        TO PV-PM-STR-NBR               05850035
           END-IF.                                                      05860035
                                                                        05870035
       EJECT.                                                           05880035
      ***************************************************************** 05890035
      **READ XS EXTRACT FILE                                            05900035
      ***************************************************************** 05910035
       9999-READ-DOMAIN-EXTRACT.                                        05920035
           IF  PS-NOT-EOF-DOMAIN                                        05930035
               READ DOMAIN-EXTRACT-FILE INTO XS024-ADHOC-STR-LST-RECORD 05940035
                    AT END                                              05950035
                       SET PS-EOF-DOMAIN TO TRUE                        05960035
               END-READ                                                 05970035
           END-IF.                                                      05980035
                                                                        05990035
           IF  PS-NOT-EOF-DOMAIN                                        06000035
               ADD +1                    TO PC-DOMAIN-EXTRACT-RECS-READ 06010035
               MOVE XS024-ADHC-STR-GP-ID TO PV-XS-ADHC-STR-GP-ID        06020035
               MOVE XS024-STR-NBR        TO PV-XS-STR-NBR               06030035
           END-IF.                                                      06040035
                                                                        06050035
       EJECT.                                                           06060035
      ***************************************************************** 06070035
      **READ CONTROL CARD FOR FREQUENCY OF COMPARE                      06080035
      ***************************************************************** 06090035
       9999-READ-CONTROL-CARD.                                          06100035
                                                                        06110035
           READ CONTROL-CARD INTO CONTROL-CARD-LAYOUT.                  06120035
                                                                        06130035
       EJECT.                                                           06140035
      ***************************************************************** 06150035
      **WRITE ERROR RECORD                                              06160035
      ***************************************************************** 06170035
       9999-WRITE-ERROR-RECORD.                                         06180035
                                                                        06190035
           WRITE DIFFERENCES-RECORD FROM ERROR-RECORD.                  06200035
                                                                        06210035
           ADD +1                       TO PC-ERROR-RECORD-WRITTEN.     06220035
                                                                        06230035
       EJECT.                                                           06240035
      ***************************************************************** 06250035
      **WRITE ERROR REPORT                                              06260035
      ***************************************************************** 06270035
       9999-WRITE-ERROR-REPORT.                                         06280035
           IF PC-ERROR-REPORT-WRITTEN > 66                              06290035
              PERFORM 9999-PRINT-HEADINGS                               06300035
           ELSE                                                         06310035
              WRITE REPORT-RECORD FROM REPORT-DETAIL                    06320035
              INITIALIZE REPORT-DETAIL                                  06330035
              ADD +1 TO PC-ERROR-REPORT-WRITTEN                         06340035
           END-IF.                                                      06350035
                                                                        06360035
       EJECT.                                                           06370035
      ***************************************************************** 06380035
      **PRINT HEADINGS                                                  06390035
      ***************************************************************** 06400035
       9999-PRINT-HEADINGS.                                             06410035
           ADD 1 TO PC-PAGE-CNT.                                        06420035
           MOVE PC-PAGE-CNT TO DP132O-PAGE-NUMBER.                      06430035
           MOVE ZEROS TO PC-ERROR-REPORT-WRITTEN.                       06440035
                                                                        06450035
491700     WRITE REPORT-RECORD                                          06460035
491800         FROM DP132O-STANDRD-HEADER-132-COLS                      06470035
491900         AFTER ADVANCING PAGE.                                    06480035
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     06490035
                                                                        06500035
491700     WRITE REPORT-RECORD                                          06510035
491800         FROM DR-HEAD2                                            06520035
491900         AFTER ADVANCING 1 LINE.                                  06530035
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     06540035
                                                                        06550035
491700     WRITE REPORT-RECORD                                          06560035
491800         FROM DR-HEAD3                                            06570035
491900         AFTER ADVANCING 2 LINE.                                  06580035
           ADD +2                       TO PC-ERROR-REPORT-WRITTEN.     06590035
                                                                        06600035
491700     WRITE REPORT-RECORD                                          06610035
491800         FROM DR-HEAD5                                            06620035
491900         AFTER ADVANCING 1 LINE.                                  06630035
                                                                        06640035
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     06650035
                                                                        06660035
       EJECT.                                                           06670035
