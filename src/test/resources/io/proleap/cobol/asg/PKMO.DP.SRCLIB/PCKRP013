000100***************************************************************** 00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300***************************************************************** 00030002
000400                                                                  00040002
000500 PROGRAM-ID.             PCKRP013.                                00050002
000600 AUTHOR.                 PATRICK BURKE.                           00060002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070002
000800 DATE-WRITTEN.           JANUARY 2002.                            00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100***************************************************************** 00110002
001200*  THIS PROGRAM TAKE THE EXTRACT FILE CREATED IN PCKUT019 AND     00120002
001300*  CREATES A DAILY REPORT TO LIST UNITS WORKED BY OPERATIONAL     00130002
001400*  UNIT.                                                          00140002
001500***************************************************************** 00150002
001600 ENVIRONMENT DIVISION.                                            00160002
001700***************************************************************** 00170002
001800 CONFIGURATION SECTION.                                           00180002
001900 SOURCE-COMPUTER.                        IBM-3090.                00190002
002000 OBJECT-COMPUTER.                        IBM-3090.                00200002
002100 INPUT-OUTPUT SECTION.                                            00210002
002200 FILE-CONTROL.                                                    00220002
002300                                                                  00230002
002400     SELECT EXTRACT-FILE                                          00240002
002500         ASSIGN TO INP01.                                         00250002
002600                                                                  00260002
002700     SELECT REPORT-FILE-1                                         00270011
002800         ASSIGN TO RPT01.                                         00280002
002900                                                                  00290002
003000     SELECT REPORT-FILE-2                                         00300011
003100         ASSIGN TO RPT02.                                         00310011
003200                                                                  00320011
003300***************************************************************** 00330002
003400 DATA DIVISION.                                                   00340002
003500***************************************************************** 00350002
003600 FILE SECTION.                                                    00360002
003700                                                                  00370002
003800 FD  EXTRACT-FILE                                                 00380002
003900     RECORDING MODE IS F                                          00390002
004000     LABEL RECORDS ARE STANDARD                                   00400002
004100     BLOCK CONTAINS 0 RECORDS.                                    00410002
004200 01  EXTRACT-RECORD                   PIC X(170).                 00420002
004300                                                                  00430002
004400 FD  REPORT-FILE-1                                                00440011
004500     RECORDING MODE IS F                                          00450002
004600     BLOCK CONTAINS 0 RECORDS.                                    00460002
004700 01  REPORT-RECORD-1                  PIC X(132).                 00470011
004800                                                                  00480011
004900 FD  REPORT-FILE-2                                                00490011
005000     RECORDING MODE IS F                                          00500011
005100     BLOCK CONTAINS 0 RECORDS.                                    00510011
005200 01  REPORT-RECORD-2                  PIC X(132).                 00520011
005300/                                                                 00530011
005400***************************************************************** 00540002
005500 WORKING-STORAGE SECTION.                                         00550002
005600***************************************************************** 00560002
005700*                                                                 00570002
005800**************************************************************    00580011
005900*  CONTROL CARD LAYOUT.                                           00590032
006000**************************************************************    00600032
006100     COPY PCWS239.                                                00610032
006200/                                                                 00620032
006300**************************************************************    00630032
006400 01  PS-SWITCHES.                                                 00640002
006500     05  PS-WRITE-EXTRACT-SW          PIC X(01) VALUE 'N'.        00650026
006600         88  PS-WRITE-EXTRACT                   VALUE 'Y'.        00660026
006700         88  PS-WRITE-EXTRACT-NO                VALUE 'N'.        00670026
006800     05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00680002
006900         88  PS-PRINT-DETAILS                   VALUE 'Y'.        00690002
007000         88  PS-NOT-PRINT-DETAILS               VALUE 'N'.        00700002
007100     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00710002
007200         88  PS-END-OF-INPUT                    VALUE 'Y'.        00720002
007300         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00730002
007400     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00740026
007500         88  PS-NEW-PAGE                        VALUE 'Y'.        00750026
007600         88  PS-SAME-PAGE                       VALUE 'N'.        00760026
007700     05  PS-PRINT-LINE-SW             PIC X(01) VALUE 'N'.        00770002
007800         88  PS-PRINT-LINE                      VALUE 'Y'.        00780002
007900                                                                  00790002
008000 01  DK-DB2-KEYS.                                                 00800002
008100     05  DK-RUN-DATE                  PIC X(10).                  00810002
008200     05  DK-WEEK-END-DATE             PIC X(10).                  00820002
008300                                                                  00830002
008400                                                                  00840002
008500 01  PV-DATE-RECORD.                                              00850002
008600     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     00860002
008700     05  FILLER                       PIC X(01) VALUE SPACES.     00870002
008800     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     00880002
008900                                                                  00890002
009000 01  SD-SYSTEM-DATE.                                              00900002
009100     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00910002
009200     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00920002
009300     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00930002
009400                                                                  00940002
009500 01  ST-SYSTEM-TIME.                                              00950002
009600     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00960002
009700     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00970002
009800     05  FILLER                     PIC  9(04)   VALUE ZERO.      00980002
009900                                                                  00990002
010000 01  PV-VARIABLES.                                                01000002
010100     05  PV-READ-COUNT                PIC S9(7) COMP-3            01010002
010200                                                VALUE ZERO.       01020002
010300     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            01030002
010400                                                VALUE ZERO.       01040002
010500     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01050002
010600                                                VALUE ZERO.       01060002
010700     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01070002
010800                                                VALUE ZERO.       01080002
010900     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01090002
011000                                                 COMP SYNC.       01100002
011100     05  PV-SPACE-COUNT               PIC S9(05) VALUE ZERO       01110002
011200                                                 COMP-3.          01120002
011300     05  PV-CHAR-COUNT                PIC S9(05) VALUE ZERO       01130002
011400                                                 COMP-3.          01140002
011500     05  PV-REMAINDER                 PIC S9(05) VALUE ZERO       01150002
011600                                                 COMP-3.          01160002
011700     05  PV-RESULT                    PIC S9(05)V99 VALUE ZERO    01170002
011800                                                 COMP-3.          01180002
011900     05  PV-DEPT                      PIC 9(03) VALUE ZEROS.      01190002
012000     05  PV-STORE-NBR                 PIC S9(4) COMP.             01200011
012100     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01210011
012200     05  PV-LOCATION-NBR              PIC 9(04) VALUE ZEROS.      01220002
012300     05  PV-OPER-ID                   PIC S9(4) COMP.             01230014
012400     05  PV-PREV-OPER-ID              PIC 9(04) VALUE ZEROS.      01240014
012500     05  PV-SHIFT-NBR                 PIC 9(01) VALUE ZEROS.      01250014
012600     05  PV-UNIT-RETAIL               PIC X(14) VALUE SPACES.     01260002
012700     05  PV-OPER-DESC                 PIC X(05) VALUE SPACES.     01270008
012800     05  PV-EXTENDED-RETAIL           PIC S9(12)V99.              01280002
012900     05  PV-EXTENDED-RETAIL-Z         PIC ZZZ,ZZZ,ZZZ.ZZ-         01290002
013000                                                 VALUE ZEROS.     01300002
013100                                                                  01310002
013200     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01320002
013300     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01330002
013400     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01340002
013500                                                                  01350002
013600     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01360002
013700     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01370002
013800     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    01380014
013900     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    01390014
014000     05  PV-DB2-YEAR                  PIC S9(08) COMP             01400009
014100                                          VALUE ZERO.             01410009
014200     05  PV-DB2-MONTH                 PIC S9(08) COMP             01420009
014300                                          VALUE ZERO.             01430009
014400     05  PV-DB2-DAY                   PIC S9(08) COMP             01440009
014500                                          VALUE ZERO.             01450009
014600     05  PV-DB2-HOUR                  PIC S9(08) COMP             01460009
014700                                          VALUE ZERO.             01470009
014800     05  PV-DB2-MINUTE                PIC S9(08) COMP             01480009
014900                                          VALUE ZERO.             01490009
015000     05  PV-DB2-SECOND                PIC S9(08) COMP             01500009
015100                                          VALUE ZERO.             01510009
015200                                                                  01520010
015300     05  PV-DIVIDEND                  PIC 9(03)V9999.             01530010
015400                                                                  01540009
015500******************************************************************01550009
015600 01  PV-DETAIL-LINE.                                              01560009
015700     05  PV-3RD-UNITS                 PIC S9(09) VALUE +0         01570010
015800                                                 COMP.            01580010
015900     05  PV-3RD-PERCENT               PIC S9(03)V9 VALUE +0       01590010
016000                                                 COMP.            01600010
016100     05  PV-3RD-RETAIL                PIC S9(09) VALUE +0 COMP.   01610018
016200     05  PV-1ST-UNITS                 PIC S9(09) VALUE +0         01620010
016300                                                 COMP.            01630010
016400     05  PV-1ST-PERCENT               PIC S9(03)V9 VALUE +0       01640010
016500                                                 COMP.            01650010
016600     05  PV-1ST-RETAIL                PIC S9(09) VALUE +0 COMP.   01660018
016700     05  PV-2ND-UNITS                 PIC S9(09) VALUE +0         01670010
016800                                                 COMP.            01680010
016900     05  PV-2ND-PERCENT               PIC S9(03)V9 VALUE +0       01690010
017000                                                 COMP.            01700010
017100     05  PV-2ND-RETAIL                PIC S9(09) VALUE +0 COMP.   01710018
017200     05  PV-DC-TOT-UNITS              PIC S9(09) VALUE +0         01720010
017300                                                 COMP.            01730010
017400     05  PV-DC-TOT-RETAIL             PIC S9(09) VALUE +0 COMP.   01740018
017500     05  PV-DC-COMP-PERCENT           PIC S9(03)V9 VALUE +0       01750010
017600                                                 COMP.            01760010
017700     05  PV-DC-COMP1-PERCENT          PIC S9(03)V9 VALUE +0       01770022
017800                                                 COMP.            01780022
017900     05  PV-DC-COMP2-PERCENT          PIC S9(03)V9 VALUE +0       01790022
018000                                                 COMP.            01800022
018100     05  PV-DC-COMP3-PERCENT          PIC S9(03)V9 VALUE +0       01810022
018200                                                 COMP.            01820022
018300                                                                  01830002
018400 01  PV-TOTAL-LINE.                                               01840009
018500     05  PV-COMP-3RD-UNITS            PIC S9(09) VALUE +0         01850010
018600                                                 COMP.            01860010
018700     05  PV-COMP-3RD-PERCENT          PIC S9(03)V9 VALUE +0       01870010
018800                                                 COMP.            01880010
018900     05  PV-COMP-3RD-RETAIL           PIC S9(09) VALUE +0 COMP.   01890018
019000     05  PV-COMP-1ST-UNITS            PIC S9(09) VALUE +0         01900010
019100                                                 COMP.            01910010
019200     05  PV-COMP-1ST-PERCENT          PIC S9(03)V9 VALUE +0       01920010
019300                                                 COMP.            01930010
019400     05  PV-COMP-1ST-RETAIL           PIC S9(09) VALUE +0 COMP.   01940018
019500     05  PV-COMP-2ND-UNITS            PIC S9(09) VALUE +0         01950010
019600                                                 COMP.            01960010
019700     05  PV-COMP-2ND-PERCENT          PIC S9(03)V9 VALUE +0       01970010
019800                                                 COMP.            01980010
019900     05  PV-COMP-2ND-RETAIL           PIC S9(09) VALUE +0 COMP.   01990018
020000     05  PV-COMP-TOT-UNITS            PIC S9(09) VALUE +0         02000010
020100                                                 COMP.            02010010
020200     05  PV-COMP-TOT-RETAIL           PIC S9(13)V99 COMP-3.       02020014
020300*    05  PV-COMP-TOT-PERCENT          PIC S9(03)V9 VALUE +0       02030010
020400*                                                COMP.            02040010
020500                                                                  02050009
020600******************************************************************02060009
020700 01  PV-VERIFIED-DATE.                                            02070002
020800     05  PV-VERIFIED-MM             PIC  X(02)   VALUE SPACES.    02080002
020900     05  FILLER                     PIC  X(01)   VALUE '/'.       02090002
021000     05  PV-VERIFIED-DD             PIC  X(02)   VALUE SPACES.    02100002
021100     05  FILLER                     PIC  X(01)   VALUE '/'.       02110002
021200     05  PV-VERIFIED-CC             PIC  X(02)   VALUE '20'.      02120002
021300     05  PV-VERIFIED-YY             PIC  X(02)   VALUE SPACES.    02130002
021400                                                                  02140002
021500 01  PV-FORMAT-DATE.                                              02150002
021600     05  PV-FORMAT-CCYY           PIC  X(04)   VALUE SPACES.      02160002
021700     05  FILLER                   PIC  X(01)   VALUE '/'.         02170002
021800     05  PV-FORMAT-MM             PIC  X(02)   VALUE SPACES.      02180002
021900     05  FILLER                   PIC  X(01)   VALUE '/'.         02190002
022000     05  PV-FORMAT-DD             PIC  X(02)   VALUE SPACES.      02200002
022100                                                                  02210002
022200 01  PV-BUCKETS COMP-3.                                           02220002
022300     05  PV-CLASS-TOTAL-UNITS      PIC S9(7) VALUE ZERO.          02230002
022400     05  PV-CLASS-TOTAL-RETAIL     PIC S9(10)V99 VALUE ZERO.      02240002
022500                                                                  02250002
022600     05  PV-DEPT-TOTAL-UNITS       PIC S9(7) VALUE ZERO.          02260002
022700     05  PV-DEPT-TOTAL-RETAIL      PIC S9(10)V99 VALUE ZERO.      02270002
022800                                                                  02280002
022900     05  PV-LOC-TOTAL-UNITS        PIC S9(7) VALUE ZERO.          02290002
023000     05  PV-LOC-TOTAL-RETAIL       PIC S9(10)V99 VALUE ZERO.      02300002
023100                                                                  02310002
023200 01  PV-ABEND-FIELDS.                                             02320002
023300     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02330002
023400                                                 COMP SYNC.       02340002
023500     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'PCKRP013'.02350030
023600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02360002
023700     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    02370002
023800     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    02380002
023900     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    02390002
024000     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    02400002
024100     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02410002
024200     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02420002
024300     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02430002
024400/                                                                 02440002
024500 01  PC-CONSTANTS.                                                02450002
024600     05  PC-RCKUT112                  PIC X(08) VALUE 'RCKUT112'. 02460002
024700     05  PC-DPKUT500                  PIC X(08) VALUE 'DPKUT500'. 02470002
024800     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP013'. 02480003
024900     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02490002
025000     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02500002
025100                                                COMP-3.           02510002
025200     05  PC-MPS-PROGRAM-NAME          PIC  X(08)    VALUE         02520002
025300         'DPKUT039'.                                              02530002
025400     05  PC-SYSTEM-CODE              PIC  X(02)    VALUE 'MP'.    02540002
025500     05  PC-CURRENT-OPERATING-COMPANY                             02550002
025600                                     PIC  X(02)    VALUE '03'.    02560002
025700/                                                                 02570002
025800******************************************************************02580002
025900*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02590002
026000******************************************************************02600002
026100     COPY DPWS132O.                                               02610002
026200*                                                                 02620002
026300 01  HL-HEADING-LINE-1.                                           02630002
026400     05  HL1-SPECIAL-RUN             PIC  X(39).                  02640019
026500     05  FILLER                      PIC  X(45)  VALUE            02650007
026600      'DAILY LISTING OF UNITS WORKED BY SHIFT WITHIN'.            02660010
026700     05  FILLER                      PIC  X(39)  VALUE            02670010
026800      ' OPER UNIT                             '.                  02680010
026900                                                                  02690002
027000 01  HL-HEADING-LINE-1A.                                          02700002
027100     05  HL1A-REQUEST1               PIC  X(17).                  02710019
027200     05  HL1A-USER-ID                PIC  X(08).                  02720019
027300     05  HL1A-REQUEST2               PIC  X(04).                  02730019
027400     05  FILLER                      PIC  X(10)  VALUE SPACES.    02740025
027500     05  FILLER                      PIC  X(26)  VALUE            02750025
027600      'BUSINESS DATE RANGE FROM: '.                               02760010
027700     05  HL1A-FROM-DATE.                                          02770003
027800         10  HL1A-FROM-MM            PIC 99.                      02780003
027900         10  FILLER                  PIC X VALUE '/'.             02790002
028000         10  HL1A-FROM-DD            PIC 99.                      02800003
028100         10  FILLER                  PIC X VALUE '/'.             02810002
028200         10  HL1A-FROM-CCYY          PIC 9(04).                   02820003
028300     05  FILLER                      PIC X(4)  VALUE              02830003
028400            ' TO '.                                               02840003
028500     05  HL1A-TO-DATE.                                            02850003
028600         10  HL1A-TO-MM              PIC 99.                      02860003
028700         10  FILLER                  PIC X VALUE '/'.             02870003
028800         10  HL1A-TO-DD              PIC 99.                      02880003
028900         10  FILLER                  PIC X VALUE '/'.             02890003
029000         10  HL1A-TO-CCYY            PIC 9(04).                   02900003
029100     05  FILLER                      PIC  X(47)  VALUE SPACES.    02910002
029200                                                                  02920002
029300 01  HL-HEADING-LINE-2.                                           02930002
029400     05  FILLER                      PIC  X(13)  VALUE            02940036
029500            'OPER UNIT  - '.                                      02950036
029600     05  HL2-LOCATION.                                            02960033
029700         10  HL2-OPER-ID             PIC  X(04) VALUE SPACES.     02970034
029800         10  FILLER                  PIC  X(01) VALUE SPACES.     02980034
029900         10  HL2-LOC-DESC            PIC  X(25) VALUE SPACES.     02990034
030000     05  HL2-CORPORATE REDEFINES HL2-LOCATION.                    03000034
030100         10  HL2-CORP-SUM            PIC  X(30).                  03010034
030200     05  FILLER                      PIC  X(57)  VALUE SPACES.    03020036
030300                                                                  03030002
030400 01  HL-HEADING-LINE-3.                                           03040002
030500     05  FILLER                      PIC  X(44)  VALUE            03050023
030600           '                                           '.         03060023
030700     05  FILLER                      PIC  X(44)  VALUE            03070023
030800           '                                           '.         03080023
030900     05  FILLER                      PIC  X(44)  VALUE            03090024
031000           '                      OPER        OPER  OPER'.        03100024
031100                                                                  03110002
031200 01  HL-HEADING-LINE-4.                                           03120007
031300     05  FILLER                      PIC  X(44)  VALUE            03130023
031400           'OPER           3RD   3RD    3RD SHIFT      '.         03140023
031500     05  FILLER                      PIC  X(44)  VALUE            03150023
031600           '   1ST   1ST    1ST SHIFT         2ND    2ND'.        03160024
031700     05  FILLER                      PIC  X(44)  VALUE            03170024
031800           '    2ND SHIFT        TOTAL       TOTAL  % TO'.        03180024
031900                                                                  03190007
032000 01  HL-HEADING-LINE-5.                                           03200007
032100     05  FILLER                      PIC  X(44)  VALUE            03210023
032200           'DESC         SHIFT  % TO       RETAIL       '.        03220024
032300     05  FILLER                      PIC  X(44)  VALUE            03230023
032400           ' SHIFT  % TO       RETAIL        SHIFT  % TO'.        03240024
032500     05  FILLER                      PIC  X(44)  VALUE            03250023
032600           '       RETAIL        SHIFT      RETAIL  COMP'.        03260024
032700                                                                  03270002
032800 01  HL-HEADING-LINE-6.                                           03280007
032900     05  FILLER                      PIC  X(44)  VALUE            03290023
033000           '             UNITS TOTAL      DOLLARS       '.        03300024
033100     05  FILLER                      PIC  X(44)  VALUE            03310023
033200           ' UNITS TOTAL      DOLLARS        UNITS TOTAL'.        03320024
033300     05  FILLER                      PIC  X(44)  VALUE            03330023
033400           '      DOLLARS        UNITS     DOLLARS TOTAL'.        03340024
033500                                                                  03350004
033600 01  DL-DETAIL-LINE-1.                                            03360002
033700     05  DL1-OPER-DESC                PIC X(05).                  03370004
033800     05  FILLER                       PIC X(02) VALUE SPACES.     03380023
033900     05  DL1-3RD-UNITS                PIC ZZZ,ZZZ,ZZ9.            03390004
034000     05  FILLER                       PIC X(01) VALUE SPACES.     03400023
034100     05  DL1-3RD-PERCENT              PIC ZZZ.9.                  03410004
034200     05  FILLER                       PIC X(02) VALUE SPACES.     03420023
034300     05  DL1-3RD-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03430042
034400     05  FILLER                       PIC X(02) VALUE SPACES.     03440004
034500     05  DL1-1ST-UNITS                PIC ZZZ,ZZZ,ZZ9.            03450004
034600     05  FILLER                       PIC X(01) VALUE SPACES.     03460023
034700     05  DL1-1ST-PERCENT              PIC ZZZ.9.                  03470004
034800     05  FILLER                       PIC X(02) VALUE SPACES.     03480023
034900     05  DL1-1ST-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03490042
035000     05  FILLER                       PIC X(02) VALUE SPACES.     03500023
035100     05  DL1-2ND-UNITS                PIC ZZZ,ZZZ,ZZ9.            03510004
035200     05  FILLER                       PIC X(01) VALUE SPACES.     03520023
035300     05  DL1-2ND-PERCENT              PIC ZZZ.9.                  03530004
035400     05  FILLER                       PIC X(02) VALUE SPACES.     03540023
035500     05  DL1-2ND-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03550042
035600     05  FILLER                       PIC X(02) VALUE SPACES.     03560023
035700     05  DL1-DC-TOT-UNITS             PIC ZZZ,ZZZ,ZZ9.            03570004
035800     05  FILLER                       PIC X(01) VALUE SPACES.     03580023
035900     05  DL1-DC-TOT-RETAIL            PIC ZZZ,ZZZ,ZZ9.            03590042
036000     05  FILLER                       PIC X(01) VALUE SPACES.     03600023
036100     05  DL1-COMP-PERCENT             PIC ZZZ.9.                  03610008
036200                                                                  03620002
036300 01  TL1-COMP-LINE.                                               03630008
036400     05  FILLER                       PIC X(08) VALUE             03640005
036500         'COMPANY '.                                              03650005
036600     05  FILLER                       PIC X(124) VALUE SPACES.    03660005
036700                                                                  03670002
036800 01  TL2-COMP-LINE.                                               03680008
036900     05  FILLER                       PIC X(07) VALUE             03690025
037000         'TOTAL  '.                                               03700025
037100     05  TL2-3RD-UNITS                PIC ZZZ,ZZZ,ZZ9.            03710005
037200     05  FILLER                       PIC X(01) VALUE SPACES.     03720023
037300     05  TL2-3RD-PERCENT              PIC ZZZ.9.                  03730005
037400     05  FILLER                       PIC X(02) VALUE SPACES.     03740023
037500     05  TL2-3RD-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03750042
037600     05  FILLER                       PIC X(02) VALUE SPACES.     03760005
037700     05  TL2-1ST-UNITS                PIC ZZZ,ZZZ,ZZ9.            03770005
037800     05  FILLER                       PIC X(01) VALUE SPACES.     03780023
037900     05  TL2-1ST-PERCENT              PIC ZZZ.9.                  03790005
038000     05  FILLER                       PIC X(02) VALUE SPACES.     03800023
038100     05  TL2-1ST-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03810042
038200     05  FILLER                       PIC X(02) VALUE SPACES.     03820023
038300     05  TL2-2ND-UNITS                PIC ZZZ,ZZZ,ZZ9.            03830005
038400     05  FILLER                       PIC X(01) VALUE SPACES.     03840023
038500     05  TL2-2ND-PERCENT              PIC ZZZ.9.                  03850005
038600     05  FILLER                       PIC X(02) VALUE SPACES.     03860023
038700     05  TL2-2ND-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03870042
038800     05  FILLER                       PIC X(02) VALUE SPACES.     03880023
038900     05  TL2-COMP-TOT-UNITS           PIC ZZZ,ZZZ,ZZ9.            03890009
039000     05  FILLER                       PIC X(01) VALUE SPACES.     03900025
039100     05  TL2-COMP-TOT-RETAIL          PIC ZZZ,ZZZ,ZZ9.            03910042
039200     05  FILLER                       PIC X(01) VALUE SPACES.     03920023
039300     05  TL2-COMP-TOT-PERCENT         PIC ZZZ.9.                  03930010
039400                                                                  03940002
039500                                                                  03950002
039600 01  ER-END-OF-REPORT-LINE.                                       03960002
039700     05  FILLER                       PIC X(19)  VALUE            03970002
039800         '** END OF REPORT **'.                                   03980002
039900     05  FILLER                       PIC X(113)  VALUE SPACES.   03990002
040000                                                                  04000002
040100 01  EP-EMPTY-REPORT-LINE.                                        04010002
040200     05  FILLER                       PIC X(34)  VALUE SPACES.    04020002
040300     05  FILLER                       PIC X(52)  VALUE            04030011
040400      '*************** EMPTY INPUT FILE *******************'.     04040011
040500     05  FILLER                       PIC X(49)  VALUE SPACES.    04050002
040600                                                                  04060010
040700 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    04070002
040800                                                                  04080010
040900 01  EL1-ERROR-LINE-1P.                                           04090010
041000     05  FILLER                      PIC  X(02)     VALUE SPACES. 04100010
041100     05  FILLER                      PIC  X(48)     VALUE         04110010
041200         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04120010
041300     05  FILLER                      PIC  X(49)     VALUE         04130010
041400         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     04140010
041500     05  FILLER                      PIC  X(33)     VALUE         04150010
041600         'COMPLETED.                       '.                     04160010
041700                                                                  04170010
041800 01  EL2-ERROR-LINE-2F.                                           04180010
041900     05  FILLER                      PIC  X(02)     VALUE SPACES. 04190010
042000     05  FILLER                      PIC  X(36)     VALUE         04200010
042100         'NONE OF YOUR REPORTS WERE CREATED.  '.                  04210010
042200     05  FILLER                      PIC  X(36)     VALUE         04220010
042300         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  04230010
042400     05  FILLER                      PIC  X(58)     VALUE SPACES. 04240010
042500                                                                  04250010
042600 01  EL3-ERROR-LINE-3.                                            04260010
042700     05  FILLER                      PIC  X(02)     VALUE SPACES. 04270010
042800     05  FILLER                      PIC  X(50)     VALUE         04280010
042900         'YOUR REQUEST WAS AS FOLLOWS:                      '.    04290010
043000     05  FILLER                      PIC  X(81)     VALUE SPACES. 04300010
043100                                                                  04310010
043200 01  EL4-ERROR-LINE-4.                                            04320010
043300     05  FILLER                      PIC  X(02)     VALUE SPACES. 04330040
043400     05  FILLER                      PIC  X(18)     VALUE         04340040
043500         'REQUESTOR       : '.                                    04350040
043600     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 04360040
043700     05  FILLER                      PIC  X(07)     VALUE SPACES. 04370040
043800     05  FILLER                      PIC  X(21)     VALUE         04380040
043900         'PRINTER DESTINATION: '.                                 04390040
044000     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 04400040
044100     05  FILLER                      PIC  X(65)     VALUE SPACES. 04410010
044200                                                                  04420010
044300 01  EL5-ERROR-LINE-5B.                                           04430010
044400     05  FILLER                      PIC  X(02)     VALUE SPACES. 04440035
044500     05  FILLER                      PIC  X(18)     VALUE         04450037
044600         'START DATE RANGE: '.                                    04460037
044700     05  EL5-START-DATE-RANGE        PIC  X(10).                  04470037
044800     05  FILLER                      PIC  X(07)     VALUE SPACES. 04480040
044900     05  FILLER                      PIC  X(21)     VALUE         04490040
045000         'END DATE RANGE     : '.                                 04500040
045100     05  EL5-END-DATE-RANGE          PIC  X(10).                  04510037
045200     05  FILLER                      PIC  X(20)     VALUE SPACES. 04520037
045300/                                                                 04530035
045400******************************************************************04540005
045500*  COPYBOOK USED BY MBS SYSTEM                                    04550005
045600******************************************************************04560005
045700     COPY DPWS003.                                                04570002
045800*                                                                 04580002
045900******************************************************************04590002
046000*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 04600002
046100******************************************************************04610002
046200     COPY DPWS024.                                                04620002
046300/                                                                 04630002
046400******************************************************************04640002
046500*  DB2 FORMATTED MESSAGE AREA                                     04650002
046600******************************************************************04660002
046700     COPY DPWS004.                                                04670002
046800/                                                                 04680002
046900******************************************************************04690002
047000* CORPORATE DATE ROUTINES                                         04700002
047100******************************************************************04710002
047200     COPY DPWS500.                                                04720002
047300/                                                                 04730002
047400******************************************************************04740005
047500*  RECORD LAYOUT FOR INPUT FILE                                   04750005
047600******************************************************************04760005
047700     COPY PCRD012.                                                04770005
047800/                                                                 04780005
047900*    LOCATION MODULE                                                      
048000     COPY XLWS071.                                                        
048100/                                                                         
048200******************************************************************04790002
048300*   DB2 SQL COMMUNICATION AREA                                    04800002
048400******************************************************************04810002
048500     EXEC SQL                                                     04820002
048600         INCLUDE SQLCA                                            04830002
048700     END-EXEC.                                                    04840002
048800*                                                                 04850002
048900     COPY SQLCA2.                                                 04860002
049000*                                                                 04870002
049100******************************************************************04960002
049200*   DB2 TABLE                                                     04970002
049300******************************************************************04980002
049400     EXEC SQL                                                     04990002
049500          INCLUDE TCOCNTL                                         05000002
049600     END-EXEC.                                                    05010002
049700*                                                                 05020002
049800******************************************************************05030002
049900 PROCEDURE DIVISION.                                              05040002
050000******************************************************************05050043
050100* MOVE +1 TO RETURN-CODE WHEN ONLY WRITING TO A PRINTER.         *05060043
050200* IF RETURN-CODE =+1 JCL WILL NOT RUN THE INFOPAC STEPS.         *05070043
050300******************************************************************05080002
050400 0000-MAINLINE.                                                   05090002
050500                                                                  05100002
050600     ACCEPT PC239-CONTROL-CARD FROM SYSIN.                        05110007
050700     DISPLAY 'CONTROL CARD = ' PC239-CONTROL-CARD.                05120007
050800                                                                  05130007
050900     IF CC-RPT-PCKRP013                                           05140010
051000         OPEN INPUT  EXTRACT-FILE                                 05150010
051100         IF CC-ROUTE-TO-RDS                                       05160010
051200            OPEN OUTPUT REPORT-FILE-1                             05170010
051300         ELSE                                                     05180010
051400            OPEN OUTPUT REPORT-FILE-2                             05190043
051500         END-IF                                                   05200010
051600                                                                  05210010
051700         PERFORM 2100-READ-EXTRACT                                05220010
051800         PERFORM 1050-BUILD-HEADINGS                              05230040
051900         PERFORM 1000-INITIALIZE                                  05240040
052000                                                                  05250002
052100         IF PC012-RCD-TYPE-ERROR                                  05260011
052200             PERFORM 7000-WRITE-ERROR-REPORT                      05270038
052300         ELSE                                                     05280010
052400             PERFORM 8100-WRITE-SUB-HEADINGS                      05290040
052500             PERFORM 2000-PROCESS-EXTRACT                         05300040
052600                 UNTIL PS-END-OF-INPUT                            05310040
052700             PERFORM 3100-COMPANY-TOTALS                          05320040
052800             PERFORM 9000-EOJ                                     05330040
052900         END-IF                                                   05340040
053000     END-IF.                                                      05350040
053100                                                                  05360002
053200     IF CC-ROUTE-TO-RDS                                           05370045
053300        NEXT SENTENCE                                             05380045
053400     ELSE                                                         05390045
053500        MOVE +1 TO RETURN-CODE                                    05400045
053600     END-IF.                                                      05410045
053700                                                                  05420002
053800     GOBACK.                                                      05430002
053900                                                                  05440002
054000******************************************************************05450002
054100 1000-INITIALIZE.                                                 05460002
054200******************************************************************05470002
054300*                                                                 05480002
054400* LOAD SYSTEM DATE INTO HEADINGS                                  05490002
054500     ACCEPT SD-SYSTEM-DATE FROM DATE.                             05500002
054600     ACCEPT ST-SYSTEM-TIME FROM TIME.                             05510002
054700                                                                  05520002
054800     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              05530002
054900     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             05540002
055000     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               05550002
055100     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              05560002
055200     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            05570002
055300                                                                  05580002
055400     MOVE PC-CURRENT-PROGRAM-NAME                                 05590002
055500                                 TO DP132O-PROGRAM-NAME.          05600002
055600     MOVE 1                      TO DP132O-REPORT-NUMBER          05610002
055700                                    DP132O-PAGE-NUMBER.           05620002
055800                                                                  05630002
055900     IF CC-BATCH-REQUEST                                          05640019
056000        CONTINUE                                                  05650019
056100     ELSE                                                         05660019
056200        MOVE '** SPECIAL REQUESTED RUN **' TO HL1-SPECIAL-RUN     05670019
056300        MOVE '** REQUESTED BY: '         TO HL1A-REQUEST1         05680019
056400        MOVE CC-USER-ID                  TO HL1A-USER-ID          05690019
056500        MOVE '**  '                      TO HL1A-REQUEST2         05700020
056600     END-IF.                                                      05710019
056700                                                                  05720019
056800     PERFORM 8000-WRITE-MAIN-HEADINGS.                            05730009
056900        INITIALIZE PV-BUCKETS.                                    05740009
057000*                                                                 05750002
057100************************************************************      05760039
057200* BUILD HEADINGS.                                                 05770039
057300************************************************************      05780039
057400 1050-BUILD-HEADINGS.                                             05790039
057500*                                                                 05800039
057600     IF CC-OPER-ALL                                               05810039
057700        MOVE 'CORPORATE SUMMARY'    TO HL2-CORPORATE              05820039
057800     ELSE                                                         05830039
057900        MOVE CC-OPER-UNIT-ID        TO HL2-OPER-ID                05840039
058000                                      PV-STORE-NBR                05850039
058100        PERFORM 1200-SELECT-OPER-DESC.                            05860039
058200/                                                                 05870039
058300************************************************************      05880026
058400* CHECK NUMBER OF ROWS TO BE WRITTEN TO OUTPUT.                   05890026
058500************************************************************      05900026
058600 1100-CHECK-WRITE-EXTRACT.                                        05910028
058700                                                                  05920026
058800     IF CC-OPER-ALL                                               05930026
058900        SET PS-WRITE-EXTRACT   TO TRUE                            05940026
059000     ELSE                                                         05950026
059100         IF PC012-OPER-UNT-ID  = CC-OPER-UNIT-ID                  05960027
059200            SET PS-WRITE-EXTRACT    TO TRUE                       05970026
059300     ELSE                                                         05980026
059400            SET PS-WRITE-EXTRACT-NO TO TRUE                       05990026
059500         END-IF                                                   06000026
059600     END-IF.                                                      06010026
059700/                                                                 06020026
059800***************************************************************** 06030008
059900 1200-SELECT-OPER-DESC.                                           06040008
060000***************************************************************** 06050008
060100*                                                                 06060008
060200     INITIALIZE XL071-COMMAREA-REC.                               05790023
060300     MOVE PV-STORE-NBR         TO XL071-LOCATION-NUMBER           05800023
060400                                                                  05810023
060500     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05820023
060600                                                                  05830023
060700     EVALUATE TRUE                                                05840023
060800     WHEN XL071-NO-ERRORS                                         05850023
060900         MOVE XL071-LOC-NM    TO PV-STORE-NAME                    05860023
061000     WHEN XL071-LOC-NOT-FOUND                                     05870023
061100     WHEN XL071-DC-ASGMT-NOT-FND                                  05880023
061200         MOVE SPACES           TO  PV-STORE-NAME                  05890023
061300     WHEN XL071-BAD-DB2-RETURN                                    05900023
061400         MOVE XL071-SQLCA             TO SQLCA                    05910023
061500         MOVE '1200-SELECT-OPER-DESC'                             05920023
061600                                TO PV-PARAGRAPH                   05930023
061700         MOVE 'SELECT'          TO PV-DB2-FUNCTION                05940023
061800         MOVE ' CALL TO XLKUT071'                                 05950023
061900                                TO PV-DB2-OPERATION-MESSAGE-1     05960023
062000         MOVE ' TABLE = XLT_LOC '                                 05970023
062100                                TO PV-DB2-OPERATION-MESSAGE-2     05980023
062200         PERFORM 9200-SQL-ABEND                                   05990023
062300     END-EVALUATE.                                                06000023
062400/                                                                 06010023
062500***************************************************************** 06320002
062600 1250-SELECT-LOCATION-DESC.                                       06330002
062700***************************************************************** 06340002
062800*                                                                 06350002
062900     INITIALIZE XL071-COMMAREA-REC.                               05790023
063000     MOVE PV-OPER-ID           TO XL071-LOCATION-NUMBER           05800023
063100                                                                  05810023
063200     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05820023
063300                                                                  05830023
063400     EVALUATE TRUE                                                05840023
063500     WHEN XL071-NO-ERRORS                                         05850023
063600         MOVE XL071-LOC-5-ABBR-NM TO PV-OPER-DESC                 05860023
063700     WHEN XL071-LOC-NOT-FOUND                                     05870023
063800     WHEN XL071-DC-ASGMT-NOT-FND                                  05880023
063900         MOVE SPACES           TO  PV-OPER-DESC                   05890023
064000     WHEN XL071-BAD-DB2-RETURN                                    05900023
064100         MOVE XL071-SQLCA             TO SQLCA                    05910023
064200         MOVE '1250-SELECT-LOCATION-DESC'                         05920023
064300                                TO PV-PARAGRAPH                   05930023
064400         MOVE 'SELECT'          TO PV-DB2-FUNCTION                05940023
064500         MOVE ' CALL TO XLKUT071'                                 05950023
064600                                TO PV-DB2-OPERATION-MESSAGE-1     05960023
064700         MOVE ' TABLE = XLT_LOC '                                 05970023
064800                                TO PV-DB2-OPERATION-MESSAGE-2     05980023
064900         PERFORM 9200-SQL-ABEND                                   05990023
065000     END-EVALUATE.                                                06000023
065100/                                                                 06600002
065200******************************************************************06610008
065300*  PRINT A 'NO INPUT' REPORT LINE.                                06620002
065400******************************************************************06630002
065500 1300-NO-DETAIL-LINE.                                             06640002
065600                                                                  06650002
065700         IF CC-ROUTE-TO-RDS                                       06660011
065800             WRITE REPORT-RECORD-1                                06670011
065900               FROM EP-EMPTY-REPORT-LINE                          06680011
066000                 AFTER ADVANCING 3 LINES                          06690011
066100         ELSE                                                     06700011
066200             WRITE REPORT-RECORD-2                                06710011
066300               FROM EP-EMPTY-REPORT-LINE                          06720011
066400                 AFTER ADVANCING 3 LINES.                         06730011
066500*                                                                 06740002
066600***************************************************************** 06750008
066700* CHECK SHIFT NUMBER AND MOVE TOTALS TO WORKING STORAGE.          06760008
066800***************************************************************** 06770008
066900 1500-PROCESS-DC-SHIFT.                                           06780008
067000*                                                                 06790008
067100     EVALUATE TRUE                                                06800008
067200        WHEN PC012-SHIFT-NBR = 1                                  06810011
067300            MOVE PC012-UNT-WRKD-QTY       TO  PV-1ST-UNITS        06820008
067400            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-1ST-RETAIL       06830008
067500                                                                  06840015
067600            IF PV-DC-TOT-UNITS   > ZERO                           06850018
067700              DIVIDE PV-1ST-UNITS  BY  PV-DC-TOT-UNITS            06860018
067800                GIVING PV-DIVIDEND ROUNDED                        06870018
067900              MULTIPLY PV-DIVIDEND BY 100                         06880031
068000                GIVING PV-1ST-PERCENT                             06890031
068100              IF PV-1ST-PERCENT     = ZERO AND                    06900041
068200                 PV-1ST-UNITS       > ZERO                        06910041
068300                 MOVE .1      TO PV-1ST-PERCENT                   06920041
068400              END-IF                                              06930031
068500            ELSE                                                  06940018
068600                  MOVE ZEROES  TO  PV-DIVIDEND                    06950018
068700                                   PV-1ST-PERCENT                 06960018
068800            END-IF                                                06970018
068900                                                                  06980015
069000        WHEN PC012-SHIFT-NBR = 2                                  06990015
069100            MOVE PC012-UNT-WRKD-QTY       TO  PV-2ND-UNITS        07000015
069200            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-2ND-RETAIL       07010015
069300                                                                  07020015
069400            IF PV-DC-TOT-UNITS    > ZERO                          07030021
069500              DIVIDE PV-2ND-UNITS BY PV-DC-TOT-UNITS              07040021
069600                GIVING PV-DIVIDEND ROUNDED                        07050015
069700              MULTIPLY PV-DIVIDEND BY 100                         07060031
069800                GIVING PV-2ND-PERCENT                             07070031
069900              IF PV-2ND-PERCENT     = ZERO AND                    07080041
070000                 PV-2ND-UNITS       > ZERO                        07090041
070100                 MOVE .1      TO PV-2ND-PERCENT                   07100041
070200              END-IF                                              07110031
070300            ELSE                                                  07120015
070400                  MOVE ZEROES  TO  PV-DIVIDEND                    07130015
070500                                   PV-2ND-PERCENT                 07140015
070600            END-IF                                                07150015
070700                                                                  07160015
070800        WHEN PC012-SHIFT-NBR = 3                                  07170015
070900            MOVE PC012-UNT-WRKD-QTY       TO  PV-3RD-UNITS        07180015
071000            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-3RD-RETAIL       07190015
071100                                                                  07200015
071200            IF PV-DC-TOT-UNITS    > ZERO                          07210021
071300              DIVIDE PV-3RD-UNITS BY PV-DC-TOT-UNITS              07220021
071400                GIVING PV-DIVIDEND ROUNDED                        07230010
071500              MULTIPLY PV-DIVIDEND BY 100                         07240031
071600                GIVING PV-3RD-PERCENT                             07250031
071700              IF PV-3RD-PERCENT     = ZERO AND                    07260041
071800                 PV-3RD-UNITS       > ZERO                        07270041
071900                 MOVE .1      TO PV-3RD-PERCENT                   07280041
072000              END-IF                                              07290031
072100            ELSE                                                  07300010
072200                  MOVE ZEROES  TO  PV-DIVIDEND                    07310010
072300                                   PV-3RD-PERCENT                 07320010
072400            END-IF                                                07330010
072500                                                                  07340008
072600     END-EVALUATE.                                                07350008
072700/                                                                 07360008
072800***************************************************************** 07370008
072900* MOVE TOTALS TO REPORT FIELDS.                                   07380008
073000***************************************************************** 07390008
073100 1510-PROCESS-DC-TOTAL.                                           07400008
073200*                                                                 07410008
073300     MOVE PC012-UNT-WRKD-QTY       TO PV-DC-TOT-UNITS.            07420013
073400     MOVE PC012-EXTD-RTL-WRKD-AMT  TO PV-DC-TOT-RETAIL.           07430013
073500                                                                  07440010
073600     IF PV-COMP-TOT-UNITS  > ZERO                                 07450018
073700       DIVIDE PV-DC-TOT-UNITS    BY  PV-COMP-TOT-UNITS            07460018
073800         GIVING PV-DIVIDEND ROUNDED                               07470018
073900       MULTIPLY PV-DIVIDEND BY 100                                07480031
074000         GIVING PV-DC-COMP-PERCENT                                07490031
074100       IF PV-DC-COMP-PERCENT = ZERO AND                           07500041
074200          PV-DC-TOT-UNITS    > ZERO                               07510041
074300          MOVE .1      TO PV-DC-COMP-PERCENT                      07520041
074400       END-IF                                                     07530031
074500     ELSE                                                         07540018
074600           MOVE ZEROES  TO  PV-DIVIDEND                           07550018
074700                            PV-DC-COMP-PERCENT                    07560018
074800     END-IF.                                                      07570018
074900/                                                                 07580008
075000***************************************************************** 07590008
075100* CHECK SHIFT NUMBER AND MOVE COMPANY TOTALS TO WS.               07600008
075200***************************************************************** 07610008
075300 1600-PROCESS-COMP-SHIFT.                                         07620008
075400*                                                                 07630008
075500     EVALUATE TRUE                                                07640008
075600        WHEN PC012-SHIFT-NBR = 1                                  07650011
075700            MOVE PC012-UNT-WRKD-QTY       TO  PV-COMP-1ST-UNITS   07660009
075800            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-COMP-1ST-RETAIL  07670009
075900                                                                  07680022
076000            IF PV-COMP-TOT-UNITS  > ZERO                          07690022
076100              DIVIDE PV-COMP-1ST-UNITS  BY  PV-COMP-TOT-UNITS     07700022
076200                GIVING PV-DIVIDEND ROUNDED                        07710022
076300              MULTIPLY PV-DIVIDEND BY 100                         07720031
076400                GIVING PV-COMP-1ST-PERCENT                        07730031
076500              IF PV-COMP-1ST-PERCENT = ZERO AND                   07740041
076600                 PV-COMP-1ST-UNITS  > ZERO                        07750041
076700                 MOVE .1      TO PV-COMP-1ST-PERCENT              07760041
076800              END-IF                                              07770031
076900            ELSE                                                  07780022
077000                  MOVE ZEROES  TO  PV-DIVIDEND                    07790022
077100                                   PV-COMP-1ST-PERCENT            07800041
077200            END-IF                                                07810022
077300                                                                  07820008
077400        WHEN PC012-SHIFT-NBR = 2                                  07830011
077500            MOVE PC012-UNT-WRKD-QTY       TO  PV-COMP-2ND-UNITS   07840009
077600            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-COMP-2ND-RETAIL  07850009
077700                                                                  07860022
077800            IF PV-COMP-TOT-UNITS  > ZERO                          07870022
077900              DIVIDE PV-COMP-2ND-UNITS  BY  PV-COMP-TOT-UNITS     07880022
078000                GIVING PV-DIVIDEND ROUNDED                        07890022
078100              MULTIPLY PV-DIVIDEND BY 100                         07900031
078200                GIVING PV-COMP-2ND-PERCENT                        07910031
078300              IF PV-COMP-2ND-PERCENT = ZERO AND                   07920041
078400                 PV-COMP-2ND-UNITS  > ZERO                        07930041
078500                 MOVE .1      TO PV-COMP-2ND-PERCENT              07940041
078600              END-IF                                              07950031
078700            ELSE                                                  07960022
078800                  MOVE ZEROES  TO  PV-DIVIDEND                    07970022
078900                                   PV-COMP-2ND-PERCENT            07980041
079000            END-IF                                                07990022
079100                                                                  08000008
079200        WHEN PC012-SHIFT-NBR = 3                                  08010011
079300            MOVE PC012-UNT-WRKD-QTY       TO  PV-COMP-3RD-UNITS   08020009
079400            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-COMP-3RD-RETAIL  08030009
079500                                                                  08040022
079600            IF PV-COMP-TOT-UNITS  > ZERO                          08050022
079700              DIVIDE PV-COMP-3RD-UNITS  BY  PV-COMP-TOT-UNITS     08060022
079800                GIVING PV-DIVIDEND ROUNDED                        08070022
079900                MULTIPLY PV-DIVIDEND BY 100                       08080022
080000                  GIVING PV-COMP-3RD-PERCENT                      08090022
080100              IF PV-COMP-3RD-PERCENT = ZERO AND                   08100041
080200                 PV-COMP-3RD-UNITS  > ZERO                        08110041
080300                 MOVE .1      TO PV-COMP-3RD-PERCENT              08120041
080400              END-IF                                              08130031
080500            ELSE                                                  08140022
080600                  MOVE ZEROES  TO  PV-DIVIDEND                    08150022
080700                                   PV-COMP-3RD-PERCENT            08160041
080800            END-IF                                                08170022
080900                                                                  08180008
081000     END-EVALUATE.                                                08190008
081100/                                                                 08200008
081200***************************************************************** 08210013
081300* MOVE COMPANY TOTALS TO WS.                                      08220013
081400***************************************************************** 08230013
081500 1610-PROCESS-COMP-TOTAL.                                         08240013
081600*                                                                 08250013
081700     MOVE PC012-UNT-WRKD-QTY       TO  PV-COMP-TOT-UNITS.         08260013
081800     MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-COMP-TOT-RETAIL.        08270013
081900/                                                                 08280013
082000******************************************************************08290002
082100 2000-PROCESS-EXTRACT.                                            08300002
082200******************************************************************08310002
082300*                                                                 08320002
082400     EVALUATE TRUE                                                08330008
082500       WHEN PC012-RECORD-TYPE-CDE = 'B'                           08340010
082600           PERFORM 1610-PROCESS-COMP-TOTAL                        08350013
082700                                                                  08360008
082800       WHEN PC012-RECORD-TYPE-CDE = 'C'                           08370014
082900           PERFORM 1600-PROCESS-COMP-SHIFT                        08380014
083000                                                                  08390014
083100       WHEN PC012-RECORD-TYPE-CDE = 'D'                           08400014
083200           PERFORM 1510-PROCESS-DC-TOTAL                          08410014
083300                                                                  08420014
083400       WHEN PC012-RECORD-TYPE-CDE = 'E'                           08430014
083500           PERFORM 1500-PROCESS-DC-SHIFT                          08440014
083600           IF PV-SHIFT-NBR    = 3                                 08450014
083700               PERFORM 3000-PRINT-DETAILS                         08460014
083800           END-IF                                                 08470014
083900                                                                  08480014
084000     END-EVALUATE.                                                08490008
084100                                                                  08500002
084200     PERFORM 2100-READ-EXTRACT.                                   08510009
084300*                                                                 08520002
084400******************************************************************08530002
084500*  READ NEXT INPUT FILE RECORD.                                   08540002
084600******************************************************************08550002
084700 2100-READ-EXTRACT.                                               08560002
084800                                                                  08570002
084900     READ EXTRACT-FILE INTO PC012-RECORD-LAYOUT                   08580010
085000        AT END                                                    08590002
085100           SET PS-END-OF-INPUT TO TRUE                            08600002
085200        NOT AT END                                                08610002
085300           ADD +1                  TO PV-READ-COUNT               08620008
085400           MOVE PC012-OPER-UNT-ID  TO PV-OPER-ID                  08630008
085500           MOVE PC012-SHIFT-NBR    TO PV-SHIFT-NBR                08640014
085600     END-READ.                                                    08650002
085700*                                                                 08660002
085800******************************************************************08670002
085900*  FILL AND PRINT DETAIL REPORT LINE.                             08680002
086000******************************************************************08690002
086100 3000-PRINT-DETAILS.                                              08700002
086200*                                                                 08710002
086300     IF PV-OPER-ID  = ZERO                                        08720020
086400         CONTINUE                                                 08730020
086500     ELSE                                                         08740020
086600         PERFORM 1250-SELECT-LOCATION-DESC                        08750020
086700     END-IF.                                                      08760020
086800                                                                  08770020
086900     MOVE PV-OPER-DESC            TO DL1-OPER-DESC.               08780008
087000     MOVE PV-3RD-UNITS            TO DL1-3RD-UNITS.               08790008
087100     MOVE PV-3RD-PERCENT          TO DL1-3RD-PERCENT.             08800008
087200     MOVE PV-3RD-RETAIL           TO DL1-3RD-RETAIL.              08810008
087300                                                                  08820002
087400     MOVE PV-1ST-UNITS            TO DL1-1ST-UNITS.               08830008
087500     MOVE PV-1ST-PERCENT          TO DL1-1ST-PERCENT.             08840008
087600     MOVE PV-1ST-RETAIL           TO DL1-1ST-RETAIL.              08850008
087700                                                                  08860008
087800     MOVE PV-2ND-UNITS            TO DL1-2ND-UNITS.               08870008
087900     MOVE PV-2ND-PERCENT          TO DL1-2ND-PERCENT.             08880008
088000     MOVE PV-2ND-RETAIL           TO DL1-2ND-RETAIL.              08890008
088100                                                                  08900008
088200     MOVE PV-DC-TOT-UNITS         TO DL1-DC-TOT-UNITS.            08910008
088300     MOVE PV-DC-TOT-RETAIL        TO DL1-DC-TOT-RETAIL.           08920008
088400     MOVE PV-DC-COMP-PERCENT      TO DL1-COMP-PERCENT.            08930009
088500                                                                  08940002
088600*CHECK FOR OVERFLOW.                                              08950002
088700     ADD 1 TO PV-LINE-COUNT.                                      08960002
088800     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         08970002
088900         SET PS-NEW-PAGE TO TRUE                                  08980002
089000         PERFORM 8000-WRITE-MAIN-HEADINGS                         08990002
089100         PERFORM 8100-WRITE-SUB-HEADINGS                          09000002
089200     END-IF.                                                      09010002
089300                                                                  09020002
089400*IF NEW PAGE, DISPLAY WEEK-END DATE.                              09030002
089500     IF PS-NEW-PAGE                                               09040002
089600         SET PS-SAME-PAGE             TO TRUE                     09050002
089700     END-IF.                                                      09060002
089800                                                                  09070002
089900*WRITE DETAIL LINE.                                               09080002
090000         IF CC-ROUTE-TO-RDS                                       09090011
090100             WRITE REPORT-RECORD-1                                09100011
090200               FROM DL-DETAIL-LINE-1                              09110011
090300                 AFTER ADVANCING 1 LINES                          09120011
090400                                                                  09130016
090500             WRITE REPORT-RECORD-1                                09140016
090600               FROM DL-BLANK-LINE                                 09150016
090700                 AFTER ADVANCING 1 LINE                           09160016
090800             ADD 2                   TO PV-LINE-COUNT             09170016
090900         ELSE                                                     09180011
091000             WRITE REPORT-RECORD-2                                09190011
091100               FROM DL-DETAIL-LINE-1                              09200011
091200                 AFTER ADVANCING 1 LINES                          09210016
091300                                                                  09220016
091400             WRITE REPORT-RECORD-2                                09230016
091500               FROM DL-BLANK-LINE                                 09240016
091600                 AFTER ADVANCING 1 LINE                           09250016
091700             ADD 2                   TO PV-LINE-COUNT.            09260016
091800*                                                                 09270002
091900******************************************************************09280002
092000 3100-COMPANY-TOTALS.                                             09290009
092100******************************************************************09300002
092200*                                                                 09310002
092300     MOVE PV-COMP-3RD-UNITS       TO TL2-3RD-UNITS.               09320009
092400     MOVE PV-COMP-3RD-PERCENT     TO TL2-3RD-PERCENT.             09330009
092500     MOVE PV-COMP-3RD-RETAIL      TO TL2-3RD-RETAIL.              09340009
092600                                                                  09350008
092700     MOVE PV-COMP-1ST-UNITS       TO TL2-1ST-UNITS.               09360009
092800     MOVE PV-COMP-1ST-PERCENT     TO TL2-1ST-PERCENT.             09370009
092900     MOVE PV-COMP-1ST-RETAIL      TO TL2-1ST-RETAIL.              09380009
093000                                                                  09390008
093100     MOVE PV-COMP-2ND-UNITS       TO TL2-2ND-UNITS.               09400009
093200     MOVE PV-COMP-2ND-PERCENT     TO TL2-2ND-PERCENT.             09410009
093300     MOVE PV-COMP-2ND-RETAIL      TO TL2-2ND-RETAIL.              09420009
093400                                                                  09430008
093500     MOVE PV-COMP-TOT-UNITS       TO TL2-COMP-TOT-UNITS.          09440011
093600     MOVE PV-COMP-TOT-RETAIL      TO TL2-COMP-TOT-RETAIL.         09450011
093700                                                                  09460002
093800     IF CC-ROUTE-TO-RDS                                           09470011
093900         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 09480011
094000             AFTER ADVANCING 1 LINE                               09490011
094100         ADD 1                   TO PV-LINE-COUNT                 09500011
094200                                                                  09510002
094300         WRITE REPORT-RECORD-1 FROM TL1-COMP-LINE                 09520014
094400             AFTER ADVANCING 1 LINE                               09530011
094500         WRITE REPORT-RECORD-1 FROM TL2-COMP-LINE                 09540014
094600             AFTER ADVANCING 1 LINE                               09550014
094700         ADD 2                    TO PV-LINE-COUNT                09560014
094800                                                                  09570002
094900         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 09580011
095000         AFTER ADVANCING 1 LINE                                   09590011
095100         ADD 1                     TO PV-LINE-COUNT               09600011
095200     ELSE                                                         09610011
095300         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 09620011
095400             AFTER ADVANCING 1 LINE                               09630011
095500         ADD 1                   TO PV-LINE-COUNT                 09640011
095600                                                                  09650011
095700         WRITE REPORT-RECORD-2 FROM TL1-COMP-LINE                 09660014
095800             AFTER ADVANCING 1 LINE                               09670011
095900         WRITE REPORT-RECORD-2 FROM TL2-COMP-LINE                 09680014
096000             AFTER ADVANCING 1 LINE                               09690014
096100         ADD 1                    TO PV-LINE-COUNT                09700011
096200                                                                  09710011
096300         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 09720011
096400         AFTER ADVANCING 1 LINE                                   09730011
096500         ADD 1                     TO PV-LINE-COUNT.              09740011
096600*                                                                 09750002
096700******************************************************************09760010
096800*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *09770010
096900******************************************************************09780010
097000 7000-WRITE-ERROR-REPORT.                                         09790010
097100*                                                                 09800010
097200     IF CC-ROUTE-TO-RDS                                           09810011
097300         WRITE REPORT-RECORD-1                                    09820011
097400           FROM EL1-ERROR-LINE-1P                                 09830011
097500             AFTER ADVANCING 3 LINES                              09840011
097600*                                                                 09850011
097700         WRITE REPORT-RECORD-1                                    09860011
097800           FROM EL2-ERROR-LINE-2F                                 09870011
097900             AFTER ADVANCING 2 LINES                              09880011
098000*                                                                 09890011
098100         WRITE REPORT-RECORD-1                                    09900011
098200           FROM EL3-ERROR-LINE-3                                  09910011
098300             AFTER ADVANCING 2 LINES                              09920011
098400*                                                                 09930011
098500         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              09940011
098600         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                09950011
098700                                                                  09960037
098800         WRITE REPORT-RECORD-1                                    09970011
098900           FROM EL4-ERROR-LINE-4                                  09980011
099000             AFTER ADVANCING 3 LINES                              09990011
099100                                                                  10000036
099200         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    10010037
099300         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      10020037
099400                                                                  10030036
099500         WRITE REPORT-RECORD-1                                    10040036
099600           FROM EL5-ERROR-LINE-5B                                 10050036
099700             AFTER ADVANCING 2 LINES                              10060039
099800*                                                                 10070035
099900         WRITE REPORT-RECORD-1                                    10080011
100000           FROM ER-END-OF-REPORT-LINE                             10090011
100100             AFTER ADVANCING 6 LINES                              10100011
100200     ELSE                                                         10110011
100300         WRITE REPORT-RECORD-2                                    10120011
100400           FROM EL1-ERROR-LINE-1P                                 10130011
100500             AFTER ADVANCING 3 LINES                              10140011
100600*                                                                 10150011
100700         WRITE REPORT-RECORD-2                                    10160011
100800           FROM EL2-ERROR-LINE-2F                                 10170011
100900             AFTER ADVANCING 2 LINES                              10180011
101000*                                                                 10190011
101100         WRITE REPORT-RECORD-2                                    10200011
101200           FROM EL3-ERROR-LINE-3                                  10210011
101300             AFTER ADVANCING 2 LINES                              10220011
101400*                                                                 10230011
101500         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              10240011
101600         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                10250011
101700                                                                  10260037
101800         WRITE REPORT-RECORD-2                                    10270011
101900           FROM EL4-ERROR-LINE-4                                  10280011
102000             AFTER ADVANCING 3 LINES                              10290011
102100*                                                                 10300011
102200         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    10310037
102300         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      10320037
102400                                                                  10330035
102500         WRITE REPORT-RECORD-2                                    10340011
102600           FROM EL5-ERROR-LINE-5B                                 10350011
102700             AFTER ADVANCING 2 LINE                               10360011
102800*                                                                 10370011
102900         WRITE REPORT-RECORD-2                                    10380011
103000           FROM ER-END-OF-REPORT-LINE                             10390011
103100             AFTER ADVANCING 6 LINES.                             10400011
103200*                                                                 10410011
103300******************************************************************10420011
103400 8000-WRITE-MAIN-HEADINGS.                                        10430002
103500******************************************************************10440002
103600*                                                                 10450002
103700     MOVE CC-START-RPT-DATE-RANGE     TO HL1A-FROM-DATE.          10460008
103800     MOVE CC-END-RPT-DATE-RANGE       TO HL1A-TO-DATE.            10470008
103900                                                                  10480002
104000     IF CC-OPER-ALL                                               10490034
104100        CONTINUE                                                  10500034
104200     ELSE                                                         10510034
104300        MOVE PV-STORE-NAME            TO HL2-LOC-DESC.            10520034
104400                                                                  10530008
104500     ADD 1                            TO PV-PAGE-COUNT.           10540002
104600     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      10550002
104700     MOVE ZERO                        TO PV-LINE-COUNT.           10560002
104800                                                                  10570002
104900     IF CC-ROUTE-TO-RDS                                           10580011
105000         WRITE REPORT-RECORD-1 FROM                               10590011
105100             DP132O-STANDRD-HEADER-132-COLS                       10600011
105200             AFTER ADVANCING PAGE                                 10610011
105300                                                                  10620011
105400         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1             10630011
105500            AFTER ADVANCING 2 LINES                               10640011
105600                                                                  10650011
105700         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1A            10660011
105800            AFTER ADVANCING 2 LINES                               10670011
105900                                                                  10680011
106000         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2             10690011
106100            AFTER ADVANCING 2 LINES                               10700011
106200         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 10710011
106300             AFTER ADVANCING 3 LINES                              10720011
106400         ADD 7                            TO PV-LINE-COUNT        10730011
106500     ELSE                                                         10740011
106600         WRITE REPORT-RECORD-2 FROM                               10750011
106700             DP132O-STANDRD-HEADER-132-COLS                       10760011
106800             AFTER ADVANCING PAGE                                 10770011
106900                                                                  10780011
107000         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-1             10790011
107100            AFTER ADVANCING 2 LINES                               10800011
107200                                                                  10810011
107300         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-1A            10820011
107400            AFTER ADVANCING 2 LINES                               10830011
107500                                                                  10840011
107600         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-2             10850011
107700            AFTER ADVANCING 2 LINES                               10860011
107800         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 10870011
107900             AFTER ADVANCING 3 LINES                              10880011
108000         ADD 7                            TO PV-LINE-COUNT.       10890011
108100*                                                                 10900002
108200******************************************************************10910002
108300 8100-WRITE-SUB-HEADINGS.                                         10920002
108400******************************************************************10930002
108500*                                                                 10940002
108600     IF CC-ROUTE-TO-RDS                                           10950011
108700         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3             10960011
108800            AFTER ADVANCING 1 LINES                               10970011
108900                                                                  10980011
109000         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4             10990011
109100            AFTER ADVANCING 1 LINES                               11000011
109200                                                                  11010011
109300         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-5             11020011
109400            AFTER ADVANCING 1 LINES                               11030011
109500                                                                  11040011
109600         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-6             11050014
109700            AFTER ADVANCING 1 LINES                               11060014
109800                                                                  11070014
109900         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 11080011
110000             AFTER ADVANCING 1 LINE                               11090011
110100         ADD 3                            TO PV-LINE-COUNT        11100011
110200     ELSE                                                         11110011
110300         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-3             11120011
110400            AFTER ADVANCING 1 LINES                               11130011
110500                                                                  11140011
110600         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-4             11150011
110700            AFTER ADVANCING 1 LINES                               11160011
110800                                                                  11170011
110900         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-5             11180011
111000            AFTER ADVANCING 1 LINES                               11190011
111100                                                                  11200011
111200         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-6             11210014
111300            AFTER ADVANCING 1 LINES                               11220014
111400                                                                  11230014
111500         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 11240014
111600             AFTER ADVANCING 1 LINE                               11250014
111700         ADD 3                            TO PV-LINE-COUNT.       11260014
111800*                                                                 11270002
111900******************************************************************11280002
112000 9000-EOJ.                                                        11290002
112100******************************************************************11300002
112200*                                                                 11310002
112300     IF CC-ROUTE-TO-RDS                                           11320011
112400         WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE         11330011
112500            AFTER ADVANCING 2 LINES                               11340011
112600     ELSE                                                         11350011
112700         WRITE REPORT-RECORD-2 FROM ER-END-OF-REPORT-LINE         11360020
112800            AFTER ADVANCING 2 LINES.                              11370011
112900                                                                  11380002
113000*CLOSE FILES.                                                     11390002
113100     CLOSE EXTRACT-FILE                                           11400002
113200                                                                  11410010
113300     IF CC-ROUTE-TO-RDS                                           11420010
113400        CLOSE REPORT-FILE-1                                       11430010
113500     ELSE                                                         11440010
113600        CLOSE REPORT-FILE-2                                       11450010
113700     END-IF.                                                      11460010
113800/                                                                 11470002
113900******************************************************************11480002
114000 9200-SQL-ABEND.                                                  11490002
114100******************************************************************11500002
114200                                                                  11510002
114300     MOVE SQLCODE                     TO SQLCODE2.                11520002
114400     MOVE SQLERRD(3)                  TO SQLERRD3.                11530002
114500                                                                  11540002
114600     DISPLAY '** ABEND **         ** = SQLERROR'.                 11550002
114700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        11560002
114800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   11570002
114900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11580002
115000     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     11590002
115100     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     11600002
115200     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     11610002
115300                                                                  11620002
115400     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                11630002
115500     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                11640002
115600     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 11650002
115700     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                11660002
115800                                                                  11670002
115900                                                                  11680002
116000     MOVE +4013                       TO PV-ABEND-CODE.           11690002
116100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11700002
116200                                                                  11710002
116300******************************************************************11720002
116400 9300-SQL-WARNING.                                                11730002
116500******************************************************************11740002
116600                                                                  11750002
116700     DISPLAY '9300-SQL-WARNING'.                                  11760002
116800     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        11770002
116900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   11780002
117000     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11790002
117100                                                                  11800002
117200     MOVE SQLCODE                     TO SQLCODE2.                11810002
117300     MOVE SQLERRD(3)                  TO SQLERRD3.                11820002
117400     DISPLAY '** ABEND **       ** = SQLWARNING'.                 11830002
117500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  11840002
117600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  11850002
117700     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  11860002
117800     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  11870002
117900     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  11880002
118000     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  11890002
118100     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  11900002
118200     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  11910002
118300     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  11920002
118400     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  11930002
118500                                                                  11940002
118600     MOVE +4013                       TO PV-ABEND-CODE.           11950002
118700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11960002
118800*                                                                 11970002
118900******************************************************************11980002
119000*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       11990002
119100******************************************************************12000002
119200 9400-ABEND.                                                      12010002
119300*                                                                 12020002
119400     DISPLAY '***************************'.                       12030002
119500     DISPLAY '**       ABEND           **'.                       12040002
119600     DISPLAY '**  IN PROGRAM RCKRP035  **'.                       12050002
119700     DISPLAY '***************************'.                       12060002
119800     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH.             12070002
119900     DISPLAY '**   ERROR         ** = ' DP003-RETURN-MSG.         12080002
120000     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       12090002
120100     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       12100002
120200                                                                  12110002
120300     MOVE +4014                  TO PV-ABEND-CODE.                12120002
120400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12130002
120500*                                                                 12140002
120600******************************************************************12150002
