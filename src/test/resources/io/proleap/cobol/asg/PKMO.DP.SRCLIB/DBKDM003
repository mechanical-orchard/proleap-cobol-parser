000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     DBKDM003.                                        00020029
000300 AUTHOR.         TOM PETERSON.                                    00030000
000400 INSTALLATION.   KOHLS.                                           00040000
000500 DATE-WRITTEN.   JUNE 2000.                                       00050000
000600****************************************************************  00060000
000700***   DB2 TABLE GROWTH STATISTICS                            ***  00070029
000800***               E.K.R.3 TSO OPTION                         ***  00080000
000900****************************************************************  00090000
001000***************  MODIFICATION HISTORY  *************************  00100021
001100****************************************************************  00110021
001200***  DATE     NAME          TYPE OF CHANGE                   ***  00120020
001300****************************************************************  00130020
001400*** 12/20/00  CRAIG MARTIN   CHANGED REPORT-TITLE2 TO ALLOW  ***  00140020
001500***                          MORE SPACES BETWEEN TABLE NAME  ***  00150020
001600***                          AND CREATOR. ALSO MOVED DATE IN ***  00160023
001700***                          TITLE1.                         ***  00170023
001800*** 09/05/03  TOM PETERSON   REMOVE TROWCNT REFERENCE AND    ***  00180025
001900***                          REPLACE WITH SYSTABLES_HIST AND ***  00190025
002000***                          SYSTABLEPART_HIST.              ***  00200025
002100****************************************************************  00210025
002200***********************************************************       00220051
002300* 03/08  LARRY SCHLEICHER                                         00230059
002400*     ADDED SUPPORT FOR DB2 VERSION 8.  ALLOW THE LENGTH          00240051
002500*     OF TABLE NAMES TO INCREASE FROM 18 CHARACTERS TO 128.       00250058
002600***********************************************************       00260051
002610* 05/08  LARRY SCHLEICHER                                         00261062
002620*     CHANGED THE SETTING OF THE CURSOR FROM THE CMNEKTAB         00262062
002630*     FIELD TO THE CMNEKCRE FIELD.                                00263062
002640***********************************************************       00264062
002650* 03/11  LARRY SCHLEICHER                                         00265064
002660*     CHANGED THE VALUE OF THE DP023-RECOUNT FIELD FROM           00266064
002670*     8000 TO 82500 TO ACCOMODATE LARGER OUTPUT FILES.            00267064
001050***********************************************************       00267165
001020* 03/14  BETSY JEFFERY                                            00267265
001030*     INCREASED THE SIZE OF THE TEMPORARY FILE NAME TO            00267365
001040*     MULTI-LOGON ISPF REQUIREMENTS.                              00267465
002680***********************************************************       00268064
001020* 04/21  BRAD DORN                                                00269066
001030*     FIXED ISSUES WITH PAGE SAVINGS DISPLAY:                     00269166
001040*     1) NEGATIVE VALUES SHOWED AS POSITIVE                       00269266
001040*     2) LEADING DIGIT CUT OFF WHEN VALUE WAS 4 DIGITS.           00269366
002680***********************************************************       00269566
002700 ENVIRONMENT DIVISION.                                            00270000
002800 CONFIGURATION SECTION.                                           00280000
002900 SOURCE-COMPUTER.        IBM.                                     00290000
003000 OBJECT-COMPUTER.        IBM.                                     00300000
003100 INPUT-OUTPUT SECTION.                                            00310000
003200                                                                  00320000
003300 FILE-CONTROL.                                                    00330000
003400                                                                  00340000
003500     SELECT BROWSE-FILE ASSIGN TO TGRWDATA.                       00350039
003600                                                                  00360000
003700 DATA DIVISION.                                                   00370000
003800 FILE SECTION.                                                    00380000
003900 FD  BROWSE-FILE                                                  00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     RECORD CONTAINS 132 CHARACTERS                               00420033
004300     BLOCK CONTAINS 0 RECORDS                                     00430000
004400     DATA RECORD IS BROWSE-RECORD.                                00440000
004500 01  BROWSE-RECORD           PIC X(132).                          00450033
004600                                                                  00460000
004700*                                                                 00470000
004800     EJECT                                                        00480000
004900 WORKING-STORAGE SECTION.                                         00490000
005000*                                                                 00500000
005100 01  SQL-FILLER          PIC X.                                   00510000
005200                                                                  00520000
005300 01  REPORT-TITLE1.                                               00530000
005400     05  PIC X(52)  VALUE  SPACES.                                00540040
005500     05  PIC X(28)  VALUE  'PRODUCTION GROWTH STATISTICS'.        00550040
005600     05  PIC X(52)  VALUE  SPACES.                                00560040
005700                                                                  00570000
005800 01  REPORT-TITLE2.                                               00580000
005900     05  PIC X(02)  VALUE  SPACES.                                00590012
006000     05  PIC X(10)  VALUE  'TABLE   = '.                          00600057
006100     05  TITLE-TABLE    PIC X(120)  VALUE SPACES.                 00610057
006200                                                                  00620054
006300 01  REPORT-TITLE3.                                               00630054
006400     05  PIC X(02)  VALUE  SPACES.                                00640054
006500     05  PIC X(10)  VALUE  'CREATOR = '.                          00650057
006600     05  TITLE-CREATOR  PIC X(8)    VALUE SPACES.                 00660000
006700                                                                  00670000
006800 01  REPORT-LINE-HDR0.                                            00680028
006900     05  PIC X(17)  VALUE  SPACES.                                00690028
007000     05  PIC X(04)  VALUE  ' AVG'.                                00700028
007100                                                                  00710028
007200 01  REPORT-LINE-HDR1.                                            00720028
007300     05  PIC X(04)  VALUE  'PART'.                                00730028
007400     05  PIC X(01)  VALUE  SPACES.                                00740028
007500     05  PIC X(10)  VALUE  ' RUNSTATS'.                           00750028
007600     05  PIC X(02)  VALUE  SPACES.                                00760028
007700     05  PIC X(04)  VALUE  ' ROW'.                                00770028
007800     05  PIC X(02)  VALUE  SPACES.                                00780028
007900     05  PIC X(09)  VALUE  '   ROW   '.                           00790005
008000     05  PIC X(01)  VALUE  SPACES.                                00800018
008100     05  PIC X(09)  VALUE  'ROW COUNT'.                           00810018
008200     05  PIC X(01)  VALUE  SPACES.                                00820018
008300     05  PIC X(09)  VALUE  'ROW COUNT'.                           00830018
008400     05  PIC X(02)  VALUE  SPACES.                                00840018
008500     05  PIC X(09)  VALUE  'COMPRESS '.                           00850018
008600     05  PIC X(02)  VALUE  SPACES.                                00860000
008700     05  PIC X(09)  VALUE  SPACES.                                00870018
008800     05  PIC X(01)  VALUE  SPACES.                                00880018
008900     05  PIC X(09)  VALUE  'FARINDREF'.                           00890018
009000     05  PIC X(01)  VALUE  SPACES.                                00900018
009100     05  PIC X(09)  VALUE  'FARINDREF'.                           00910018
009200     05  PIC X(02)  VALUE  SPACES.                                00920000
009300     05  PIC X(10)  VALUE  SPACES.                                00930018
009400     05  PIC X(01)  VALUE  SPACES.                                00940018
009500     05  PIC X(10)  VALUE  'NEARINDREF'.                          00950018
009600     05  PIC X(01)  VALUE  SPACES.                                00960018
009700     05  PIC X(10)  VALUE  'NEARINDREF'.                          00970018
009800                                                                  00980000
009900 01  REPORT-LINE-HDR2.                                            00990000
010000     05  PIC X(04)  VALUE  ' NBR'.                                01000000
010100     05  PIC X(01)  VALUE  SPACES.                                01010018
010200     05  PIC X(10)  VALUE  '   DATE'.                             01020000
010300     05  PIC X(02)  VALUE  SPACES.                                01030000
010400     05  PIC X(04)  VALUE  'LGTH'.                                01040018
010500     05  PIC X(02)  VALUE  SPACES.                                01050000
010600     05  PIC X(09)  VALUE  '  COUNT  '.                           01060005
010700     05  PIC X(01)  VALUE  SPACES.                                01070018
010800     05  PIC X(09)  VALUE  ' +/- CHG '.                           01080018
010900     05  PIC X(01)  VALUE  SPACES.                                01090018
011000     05  PIC X(09)  VALUE  ' % CHANGE'.                           01100018
011100     05  PIC X(02)  VALUE  SPACES.                                01110018
011200     05  PIC X(09)  VALUE  '% PG SAVE'.                           01120018
011300     05  PIC X(02)  VALUE  SPACES.                                01130015
011400     05  PIC X(09)  VALUE  'FARINDREF'.                           01140018
011500     05  PIC X(01)  VALUE  SPACES.                                01150018
011600     05  PIC X(09)  VALUE  ' +/- CHG '.                           01160018
011700     05  PIC X(01)  VALUE  SPACES.                                01170018
011800     05  PIC X(09)  VALUE  ' % CHANGE'.                           01180018
011900     05  PIC X(02)  VALUE  SPACES.                                01190000
012000     05  PIC X(10)  VALUE  'NEARINDREF'.                          01200018
012100     05  PIC X(01)  VALUE  SPACES.                                01210018
012200     05  PIC X(10)  VALUE  ' +/- CHG  '.                          01220018
012300     05  PIC X(01)  VALUE  SPACES.                                01230018
012400     05  PIC X(10)  VALUE  ' % CHANGE '.                          01240018
012500                                                                  01250000
012600 01  REPORT-LINE-HDR3.                                            01260000
012700     05  PIC X(04)  VALUE  '----'.                                01270000
012800     05  PIC X(01)  VALUE  SPACES.                                01280018
012900     05  PIC X(10)  VALUE  '----------'.                          01290000
013000     05  PIC X(02)  VALUE  SPACES.                                01300000
013100     05  PIC X(04)  VALUE  '----'.                                01310000
013200     05  PIC X(02)  VALUE  SPACES.                                01320000
013300     05  PIC X(09)  VALUE  '---------'.                           01330000
013400     05  PIC X(01)  VALUE  SPACES.                                01340018
013500     05  PIC X(09)  VALUE  '---------'.                           01350000
013600     05  PIC X(01)  VALUE  SPACES.                                01360018
013700     05  PIC X(09)  VALUE  '---------'.                           01370016
013800     05  PIC X(02)  VALUE  SPACES.                                01380018
013900     05  PIC X(09)  VALUE  '---------'.                           01390018
014000     05  PIC X(02)  VALUE  SPACES.                                01400000
014100     05  PIC X(09)  VALUE  '---------'.                           01410000
014200     05  PIC X(01)  VALUE  SPACES.                                01420018
014300     05  PIC X(09)  VALUE  '---------'.                           01430000
014400     05  PIC X(01)  VALUE  SPACES.                                01440018
014500     05  PIC X(09)  VALUE  '---------'.                           01450000
014600     05  PIC X(02)  VALUE  SPACES.                                01460000
014700     05  PIC X(10)  VALUE  '----------'.                          01470000
014800     05  PIC X(01)  VALUE  SPACES.                                01480018
014900     05  PIC X(10)  VALUE  '----------'.                          01490000
015000     05  PIC X(01)  VALUE  SPACES.                                01500018
015100     05  PIC X(10)  VALUE  '----------'.                          01510000
015200                                                                  01520000
015300 01  REPORT-LINE-DTL.                                             01530000
015400     05  RL-PART-NBR       PIC ZZZ9        VALUE ZEROES.          01540009
015500     05  PIC X(01)  VALUE  SPACES.                                01550018
015600     05  RL-STATS-DATE     PIC X(10)       VALUE SPACES.          01560009
015700     05  PIC X(02)  VALUE  SPACES.                                01570000
015800     05  RL-ROW-LENGTH     PIC ZZZ9        VALUE ZEROES.          01580009
015900     05  PIC X(02)  VALUE  SPACES.                                01590007
016000     05  RL-ROW-CNT        PIC ZZZZZZZZ9   VALUE ZEROES.          01600009
016100     05  PIC X(01)  VALUE  SPACES.                                01610018
016200     05  RL-ROW-CNT-I-D    PIC ZZZZZZZZ9-  VALUE ZEROES.          01620009
016300     05  PIC X(03)  VALUE  SPACES.                                01630018
016400     05  RL-ROW-PCT-I-D    PIC ZZ9-        VALUE ZEROES.          01640009
016500     05  RL-PCT1           PIC X(01)       VALUE SPACES.          01650015
016600     05  FILLER            PIC X(03)       VALUE SPACES.          01660066
016700     05  RL-COMPR-SAVE-PCT PIC ZZZ9-       VALUE ZEROES.          01670066
016800     05  FILLER            PIC X(01)       VALUE SPACES.          01680016
016900     05  RL-PCT4           PIC X(04)       VALUE SPACES.          01690016
017000     05  RL-FAR-PG-CNT     PIC ZZZZZZZZ9   VALUE ZEROES.          01700009
017100     05  PIC X(01)  VALUE  SPACES.                                01710018
017200     05  RL-FAR-PG-CNT-I-D PIC ZZZZZZZZ9-  VALUE ZEROES.          01720009
017300     05  PIC X(03)  VALUE  SPACES.                                01730018
017400     05  RL-FAR-PG-PCT-I-D PIC ZZ9-        VALUE ZEROES.          01740009
017500     05  RL-PCT2           PIC X(05)       VALUE SPACES.          01750010
017600     05  RL-NEAR-PG-CNT    PIC ZZZZZZZZ9   VALUE ZEROES.          01760009
017700     05  PIC X(02)  VALUE  SPACES.                                01770018
017800     05  RL-NEAR-PG-CNT-I-D PIC ZZZZZZZZ9- VALUE ZEROES.          01780009
017900     05  PIC X(04)  VALUE  SPACES.                                01790018
018000     05  RL-NEAR-PG-PCT-I-D PIC ZZ9-       VALUE ZEROES.          01800009
018100     05  RL-PCT3           PIC X(01)       VALUE SPACES.          01810015
018200                                                                  01820000
018300 01  END-OF-REPORT.                                               01830005
018400     05  FILLER            PIC X(56)   VALUE  SPACES.             01840005
018500     05  FILLER            PIC X(21)                              01850005
018600         VALUE  '*** END OF REPORT ***'.                          01860005
018700     05  FILLER            PIC X(55)   VALUE  SPACES.             01870032
018800                                                                  01880005
018900 01  ISP-FUNCTIONS.                                               01890000
019000     05  ISP-DISPLAY     PIC X(8) VALUE 'DISPLAY'.                01900000
019100     05  ISP-ADDPOP      PIC X(8) VALUE 'ADDPOP  '.               01910000
019200     05  ISP-REMPOP      PIC X(8) VALUE 'REMPOP  '.               01920000
019300     05  ISP-VDEFINE     PIC X(8) VALUE 'VDEFINE'.                01930000
019400     05  ISP-VDELETE     PIC X(8) VALUE 'VDELETE'.                01940000
019500     05  ISP-VGET        PIC X(8) VALUE 'VGET'.                   01950000
019600     05  ISP-VPUT        PIC X(8) VALUE 'VPUT'.                   01960000
019700     05  ISP-VRESET      PIC X(8) VALUE 'VRESET'.                 01970000
019800     05  ISP-VCOPY       PIC X(8) VALUE 'VCOPY'.                  01980000
019900     05  ISP-VREPLACE    PIC X(8) VALUE 'VREPLACE'.               01990000
020000     05  ISP-TBOPEN      PIC X(8) VALUE 'TBOPEN'.                 02000000
020100     05  ISP-TBCREATE    PIC X(8) VALUE 'TBCREATE'.               02010000
020200     05  ISP-TBCLOSE     PIC X(8) VALUE 'TBCLOSE'.                02020000
020300     05  ISP-TBEND       PIC X(8) VALUE 'TBEND  '.                02030000
020400     05  ISP-TBDISPL     PIC X(8) VALUE 'TBDISPL'.                02040000
020500     05  ISP-TBSORT      PIC X(8) VALUE 'TBSORT'.                 02050000
020600     05  ISP-TBTOP       PIC X(8) VALUE 'TBTOP'.                  02060000
020700     05  ISP-TBBOTTOM    PIC X(8) VALUE 'TBBOTTOM'.               02070000
020800     05  ISP-TBSKIP      PIC X(8) VALUE 'TBSKIP'.                 02080000
020900     05  ISP-TBADD       PIC X(8) VALUE 'TBADD '.                 02090000
021000     05  ISP-TBPUT       PIC X(8) VALUE 'TBPUT '.                 02100000
021100     05  ISP-TBMOD       PIC X(8) VALUE 'TBMOD '.                 02110000
021200     05  ISP-TBDELETE    PIC X(8) VALUE 'TBDELETE'.               02120000
021300     05  ISP-TBEXIST     PIC X(8) VALUE 'TBEXIST '.               02130000
021400     05  ISP-TBSCAN      PIC X(8) VALUE 'TBSCAN'.                 02140000
021500     05  ISP-TBPAD       PIC 9(8) COMP VALUE 0.                   02150000
021600     05  ISP-NEWCOPY     PIC X(8) VALUE 'NEWCOPY'.                02160000
021700     05  ISP-FTOPEN      PIC X(8) VALUE 'FTOPEN'.                 02170000
021800     05  ISP-FTINCL      PIC X(8) VALUE 'FTINCL'.                 02180000
021900     05  ISP-FTCLOSE     PIC X(8) VALUE 'FTCLOSE'.                02190000
022000     05  ISP-SELECT      PIC X(8) VALUE 'SELECT'.                 02200000
022100     05  ISP-BROWSE      PIC X(8) VALUE 'BROWSE'.                 02210000
022200     05  ISP-SETMSG      PIC X(8) VALUE 'SETMSG'.                 02220000
022300     05  ISP-CONTROL     PIC X(8) VALUE 'CONTROL'.                02230000
022400     05  ISP-NONDISPL    PIC X(8) VALUE 'NONDISPL'.               02240000
022500     05  ISP-SPLIT       PIC X(8) VALUE 'SPLIT'.                  02250000
022600     05  ISP-DISABLE     PIC X(8) VALUE 'DISABLE'.                02260000
022700     05  ISP-ENABLE      PIC X(8) VALUE 'ENABLE'.                 02270000
022800     05  ISP-NO          PIC X(8) VALUE 'NO'.                     02280000
022900     05  ISP-YES         PIC X(8) VALUE 'YES'.                    02290000
023000*                                                                 02300000
023100 01  ISP-MISC-DEFS.                                               02310000
023200     05  ISP-FORMAT      PIC X(8) VALUE 'CHAR'.                   02320000
023300     05  ISP-MOVE        PIC X(8) VALUE 'MOVE'.                   02330000
023400     05  ISP-WRITE       PIC X(8) VALUE 'WRITE'.                  02340000
023500     05  ISP-NOWRITE     PIC X(8) VALUE 'NOWRITE'.                02350000
023600     05  ISP-REPLACE     PIC X(8) VALUE 'REPLACE'.                02360000
023700     05  ISP-ORDERED     PIC X(8) VALUE 'ORDERED'.                02370000
023800     05  ISP-SHARED      PIC X(8) VALUE 'SHARED'.                 02380000
023900     05  ISP-PROFILE     PIC X(8) VALUE 'PROFILE'.                02390000
024000     05  ISP-ASIS        PIC X(8) VALUE 'ASIS'.                   02400000
024100     05  ISP-NOREAD      PIC X(8) VALUE 'NOREAD'.                 02410000
024200     05  ISP-NEXT        PIC X(8) VALUE 'NEXT'.                   02420000
024300     05  ISP-TEMP        PIC X(8) VALUE 'TEMP'.                   02430000
024400     05  ISP-PANEL       PIC X(8) VALUE  SPACES.                  02440000
024500     05  ISP-DUMMY       PIC X(8) VALUE  SPACES.                  02450000
024600     05  ISP-MSG         PIC X(8) VALUE  'CMN000  '.              02460000
024700     05  ISP-CSR         PIC X(8) VALUE  SPACES.                  02470000
024800     05  ISP-FIELD       PIC X(8) VALUE  SPACES.                  02480000
024900     05  ISP-SKEL        PIC X(8) VALUE  SPACES.                  02490000
025000     05  ISP-ERRORS      PIC X(8) VALUE 'ERRORS'.                 02500000
025100     05  ISP-RETURN      PIC X(8) VALUE 'RETURN'.                 02510000
025200     05  ISP-CANCEL      PIC X(8) VALUE 'CANCEL'.                 02520000
025300     05  ISP-SAVE        PIC X(8) VALUE 'SAVE'.                   02530000
025400     05  ISP-RESTORE     PIC X(8) VALUE 'RESTORE'.                02540000
025500     05  TBL-LIST-GT     PIC X(4) VALUE '(GT)'.                   02550000
025600*                                                                 02560000
025700***  DEFINE DATA TYPE PARAMETER FOR VARIABLE DEFINE SERVICE CALL. 02570000
025800*                                                                 02580000
025900 01  CHAR                PIC X(08)     VALUE 'CHAR    '.          02590000
026000                                                                  02600034
026100*                                                                 02610034
026200*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              02620034
026300*                                                                 02630034
026400     COPY DPWS023.                                                02640034
026500                                                                  02650034
026600*                                                                 02660034
026700*  PARAMETER LIST FOR THE ISPF PRINT PANEL ROUTINE                02670034
026800*                                                                 02680034
026900     COPY DPWS300.                                                02690034
027000                                                                  02700034
027100 01  VAR-SMSG                    PIC X(24)   VALUE SPACES.        02710044
027200 01  FILLER                      REDEFINES VAR-SMSG.              02720044
027300     05  VAR-SMSG-FILLER         PIC X(20).                       02730044
027400     05  VAR-SMSG-SQLCODE        PIC 9(4).                        02740044
027500 01  VAR-LMSG                    PIC X(72)   VALUE SPACES.        02750044
027600 01  PV-PROGRAM-VARIABLES.                                        02760034
027700     05  VAR-ZTEMPF              PIC X(44)   VALUE SPACES.        02770034
027800     05  VAR-DSNAME              PIC X(46)   VALUE SPACES.        02780034
027900     05  VAR-VOLUME              PIC X(06)   VALUE SPACES.        02790034
028000     05  VAR-PASSWORD            PIC X(08)   VALUE SPACES.        02800034
028100     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             02810034
028200         10  FILLER              PIC X(13)    VALUE               02820034
028300             'DYNALC ERROR '.                                     02830034
028400         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        02840034
028500         10  FILLER              PIC X(2)     VALUE '; '.         02850034
028600         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       02860034
028700         10  FILLER              PIC X(5)     VALUE ' DD; '.      02870034
028800         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       02880034
028900     05  PV-BROWSE-DSNAME        PIC X(44)   VALUE SPACES.        02890043
029000     05  PV-COUNTR               PIC S9(4)   COMP.                02900034
029100     05  PV-FIELD-LENGTH         PIC 9(8)     VALUE ZEROS         02910045
029200                                              COMP SYNC.          02920045
029300*                                                                 02930000
029400***  DEFINE STORAGE FOR DIALOG VARIABLES.                         02940000
029500*                                                                 02950000
029600 01  VAR-CMNEKTAB        PIC X(43)     VALUE SPACES.              02960049
029700 01  VAR-CMNEKTB2        PIC X(43)     VALUE SPACES.              02970049
029800 01  VAR-CMNEKTB3        PIC X(42)     VALUE SPACES.              02980049
029900 01  VAR-128-TABLE-NAME  PIC X(128)    VALUE SPACES.              02990049
030000 01  VAR-CMNEKCRE        PIC X(08)     VALUE SPACES.              03000000
030100 01  ABEND-CODE                    PIC S9(4) VALUE ZERO           03010000
030200                                             COMP.                03020000
030300     88  ABEND-4013                          VALUE 4013.          03030000
030400                                                                  03040000
030500 01  HOLD-DYNALC-DSNAME          PIC X(44)   VALUE SPACES.        03050000
030600                                                                  03060000
030700 01  HOLD-LAST-UPD-DTE           PIC X(10)   VALUE SPACES.        03070026
030800 01  HOLD-PART-NBR               PIC S9(4)   VALUE +0 COMP.       03080008
030900 01  HOLD-ROW-CNT-NBR            PIC S9(9)   COMP.                03090000
031000 01  HOLD-RELOC-FAR-PG-NBR       PIC S9(9)   COMP.                03100000
031100 01  HOLD-RELOC-NEAR-PG-NBR      PIC S9(9)   COMP.                03110000
031200                                                                  03120000
031300 01  WORK-ROW-CNT                PIC S9(9)    VALUE +0.           03130011
031400 01  WORK-ROW-PCT                PIC S9(3)V99 VALUE +0.           03140011
031500 01  WORK-FAR-PG-CNT             PIC S9(9)    VALUE +0.           03150011
031600 01  WORK-FAR-PG-PCT             PIC S9(3)V99 VALUE +0.           03160011
031700 01  WORK-NEAR-PG-CNT            PIC S9(9)    VALUE +0.           03170011
031800 01  WORK-NEAR-PG-PCT            PIC S9(3)V99 VALUE +0.           03180011
031900                                                                  03190000
032000 01  PS-PRINT-SWITCH               PIC X(1)  VALUE 'N'.           03200000
032100     88  PS-EOF-PRINT                        VALUE 'Y'.           03210000
032200     88  PS-NOT-EOF-PRINT                    VALUE 'N'.           03220000
032300 01  PS-ALLOCATE-SW                PIC X(1)  VALUE 'N'.           03230000
032400     88  PS-IS-ALLOCATED                     VALUE 'Y'.           03240000
032500     88  PS-IS-NOT-ALLOCATED                 VALUE 'N'.           03250000
032600 01  PS-DB2-ERROR-INDICATOR        PIC X(1)  VALUE 'N'.           03260000
032700     88  PS-DB2-ERROR                        VALUE 'Y'.           03270000
032800     88  PS-NO-DB2-ERROR                     VALUE 'N'.           03280000
032900 01  PS-USER-INPUT                 PIC X(1)  VALUE 'N'.           03290000
033000     88  PS-USER-INPUT-VALID                 VALUE 'Y'.           03300000
033100     88  PS-USER-INPUT-NOT-VALID             VALUE 'N'.           03310000
033200 01  PS-PKEY                       PIC X(1)  VALUE 'N'.           03320000
033300     88  PS-PKEY-DEFINED                     VALUE 'Y'.           03330000
033400     88  PS-PKEY-NOT-DEFINED                 VALUE 'N'.           03340000
033500 01  PS-KEY-COLUMN-SELECT          PIC X(1)  VALUE 'N'.           03350000
033600     88  PS-KEY-COLUMN-SELECTED              VALUE 'Y'.           03360000
033700     88  PS-KEY-COLUMN-NOT-SELECTED          VALUE 'N'.           03370000
033800 01  PS-PROCS-SW                   PIC X(1)  VALUE 'Y'.           03380000
033900     88  MORE-PROCS                          VALUE 'Y'.           03390000
034000     88  NO-MORE-PROCS                       VALUE 'N'.           03400000
034100 01  PS-PLANS-SW                   PIC X(1)  VALUE 'Y'.           03410000
034200     88  MORE-PLANS                          VALUE 'Y'.           03420000
034300     88  NO-MORE-PLANS                       VALUE 'N'.           03430000
034400                                                                  03440000
034500**                                                                03450000
034600 01  PROGRAM-CONSTANTS.                                           03460035
034700     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'DBKDM003'.   03470036
034800     05  PC-BROWSE-DDNAME          PIC X(08)  VALUE 'TGRWDATA'.   03480043
034900     05  PC-BROWSE-DSNAME-SUFFIX   PIC X(05)  VALUE '.TGRW'.      03490043
035000*                                                                 03500000
035100 01  COMMON-NAMELIST.                                             03510000
035200     05  NAM-ZTEMPF      PIC X(08)     VALUE 'ZTEMPF'.            03520000
035300     05  NAM-SMSG        PIC X(08)     VALUE 'SMSG'.              03530000
035400     05  NAM-LMSG        PIC X(08)     VALUE 'LMSG'.              03540000
035500*                                                                 03550000
035600***  DEFINE DIALOG VARIABLE NAMES FOR DIALOG SERVICE CALLS.       03560000
035700*                                                                 03570000
035800 01  NAM-CMNEKTAB        PIC X(08)     VALUE 'CMNEKTAB'.          03580000
035900 01  NAM-CMNEKTB2        PIC X(08)     VALUE 'CMNEKTB2'.          03590049
036000 01  NAM-CMNEKTB3        PIC X(08)     VALUE 'CMNEKTB3'.          03600049
036100 01  NAM-CMNEKCRE        PIC X(08)     VALUE 'CMNEKCRE'.          03610000
036200*                                                                 03620000
036300***                                                               03630000
036400************************************************************      03640000
036500*    SYSIBM.SYSTABLES     DCLGEN                           *      03650002
036600************************************************************      03660000
036700     EXEC SQL                                                     03670000
036800         INCLUDE SYSTABLE                                         03680002
036900     END-EXEC.                                                    03690000
037000*                                                                 03700000
037100************************************************************      03710002
037200*    SYSIBM.SYSTABLES_HIST DCLGEN                          *      03720025
037300************************************************************      03730002
037400     EXEC SQL                                                     03740002
037500         INCLUDE SYSTBHST                                         03750025
037600     END-EXEC.                                                    03760002
037700*                                                                 03770002
037800************************************************************      03780025
037900*    SYSIBM.SYSTABLEPART_HIST DCLGEN                       *      03790025
038000************************************************************      03800025
038100     EXEC SQL                                                     03810025
038200         INCLUDE SYSTBPTH                                         03820025
038300     END-EXEC.                                                    03830025
038400*                                                                 03840025
038500************************************************************      03850000
038600*    DECLARE STATS_CURSOR CURSOR                           *      03860025
038700************************************************************      03870000
038800*                                                                 03880000
038900     EXEC SQL                                                     03890000
039000      DECLARE STATS_CURSOR CURSOR FOR                             03900025
039100          SELECT  A.PARTITION                                     03910027
039200                 ,DATE(A.STATSTIME)                               03920025
039300                 ,B.AVGROWLEN                                     03930025
039400                 ,INTEGER(A.CARDF)                                03940025
039500                 ,A.PAGESAVE                                      03950025
039600                 ,A.FARINDREF                                     03960025
039700                 ,A.NEARINDREF                                    03970025
039800          FROM    SYSIBM.SYSTABLEPART_HIST A                      03980025
039900                 ,SYSIBM.SYSTABLES_HIST B                         03990025
040000          WHERE A.DBNAME = B.DBNAME                               04000025
040100          AND   A.TSNAME = B.TSNAME                               04010025
040200          AND   A.STATSTIME = B.STATSTIME                         04020025
040300          AND   B.NAME = :VAR-128-TABLE-NAME                      04030049
040400          AND   B.CREATOR = :VAR-CMNEKCRE                         04040025
040500          ORDER BY 1,2                                            04050025
040600     END-EXEC.                                                    04060000
040700                                                                  04070031
040800************************************************************      04080000
040900*    SQL COMMUNICATIONS AREA DCLGEN                        *      04090000
041000************************************************************      04100000
041100*                                                                 04110000
041200     EXEC SQL                                                     04120000
041300         INCLUDE SQLCA                                            04130000
041400     END-EXEC.                                                    04140000
041500*                                                                 04150000
041600*                                                                 04160000
041700 PROCEDURE DIVISION.                                              04170000
041800                                                                  04180000
041900************************************************************      04190000
042000*    VDEFINES FOR PANEL                                    *      04200000
042100************************************************************      04210000
042200     MOVE LENGTH OF VAR-ZTEMPF TO PV-FIELD-LENGTH.                04220046
042300     CALL 'ISPLINK' USING ISP-VDEFINE NAM-ZTEMPF VAR-ZTEMPF       04230046
042400                          ISP-FORMAT PV-FIELD-LENGTH.             04240046
042500     MOVE LENGTH OF VAR-SMSG TO PV-FIELD-LENGTH.                  04250046
042600     CALL 'ISPLINK' USING ISP-VDEFINE NAM-SMSG VAR-SMSG           04260046
042700                          ISP-FORMAT PV-FIELD-LENGTH.             04270046
042800     MOVE LENGTH OF VAR-LMSG TO PV-FIELD-LENGTH.                  04280046
042900     CALL 'ISPLINK' USING ISP-VDEFINE NAM-LMSG VAR-LMSG           04290046
043000                          ISP-FORMAT PV-FIELD-LENGTH.             04300046
043100     MOVE LENGTH OF VAR-CMNEKTAB TO PV-FIELD-LENGTH.              04310046
043200     CALL 'ISPLINK' USING ISP-VDEFINE                             04320046
043300         NAM-CMNEKTAB  VAR-CMNEKTAB  CHAR  PV-FIELD-LENGTH.       04330046
043400     MOVE LENGTH OF VAR-CMNEKTB2 TO PV-FIELD-LENGTH.              04340050
043500     CALL 'ISPLINK' USING ISP-VDEFINE                             04350049
043600         NAM-CMNEKTB2  VAR-CMNEKTB2  CHAR  PV-FIELD-LENGTH.       04360049
043700     MOVE LENGTH OF VAR-CMNEKTB3 TO PV-FIELD-LENGTH.              04370049
043800     CALL 'ISPLINK' USING ISP-VDEFINE                             04380049
043900         NAM-CMNEKTB3  VAR-CMNEKTB3  CHAR  PV-FIELD-LENGTH.       04390049
044000     MOVE LENGTH OF VAR-CMNEKCRE TO PV-FIELD-LENGTH.              04400046
044100     CALL 'ISPLINK' USING ISP-VDEFINE                             04410046
044200         NAM-CMNEKCRE  VAR-CMNEKCRE  CHAR  PV-FIELD-LENGTH.       04420046
044300                                                                  04430000
044400************************************************************      04440000
044500*    VGETS FROM PROFILES                                   *      04450000
044600************************************************************      04460000
044700                                                                  04470000
044800     CALL 'ISPLINK' USING ISP-VGET NAM-ZTEMPF ISP-SHARED.         04480000
044900     MOVE SPACES TO ISP-MSG.                                      04490000
045000                                                                  04500034
045100     INSPECT VAR-ZTEMPF TALLYING PV-COUNTR FOR CHARACTERS         04510034
045200                 BEFORE INITIAL '.CNTL'.                          04520034
045300     MOVE VAR-ZTEMPF (1:PV-COUNTR)  TO PV-BROWSE-DSNAME.          04530043
045400     ADD 1 TO PV-COUNTR.                                          04540034
045500     MOVE PC-BROWSE-DSNAME-SUFFIX TO                              04550042
045600               PV-BROWSE-DSNAME (PV-COUNTR:5).                    04560043
045700                                                                  04570000
045800     PERFORM 1700-DISPLAY-PANEL THRU 1700-EXIT UNTIL              04580000
045900          RETURN-CODE NOT = 0.                                    04590000
046000                                                                  04600034
046100     IF PS-IS-ALLOCATED                                           04610034
046200         PERFORM 9100-DELETE-FILE                                 04620034
046300     END-IF.                                                      04630034
046400                                                                  04640000
046500     GOBACK.                                                      04650000
046600                                                                  04660000
046700************************************************************      04670000
046800*    DISPLAY THE PANEL                                     *      04680000
046900************************************************************      04690000
047000*                                                                 04700000
047100 1700-DISPLAY-PANEL.                                              04710000
047200                                                                  04720000
047300     MOVE 'CMNEKCRE' TO ISP-CSR.                                  04730061
047400     MOVE 'CMNEKR3' TO ISP-PANEL.                                 04740000
047500     CALL 'ISPLINK' USING ISP-DISPLAY,                            04750000
047600                          ISP-PANEL,                              04760000
047700                          ISP-MSG,                                04770000
047800                          ISP-CSR.                                04780000
047900                                                                  04790000
048000     MOVE SPACES TO ISP-MSG.                                      04800000
048100     MOVE SPACES TO VAR-SMSG.                                     04810000
048200     MOVE SPACES TO VAR-LMSG.                                     04820000
048300                                                                  04830000
048400     IF RETURN-CODE NOT = 0                                       04840000
048500         GO TO 1700-EXIT.                                         04850000
048600                                                                  04860000
048700     PERFORM 2100-EDIT-INPUT THRU 2100-EXIT.                      04870000
048800     IF PS-USER-INPUT-NOT-VALID                                   04880000
048900         GO TO 1700-EXIT.                                         04890000
049000                                                                  04900000
049100     IF PS-IS-NOT-ALLOCATED                                       04910034
049200         PERFORM 3000-ALLOCATE-TEMP-FILE                          04920034
049300     END-IF.                                                      04930034
049400                                                                  04940000
049500     IF PS-IS-ALLOCATED                                           04950000
049600         OPEN OUTPUT BROWSE-FILE                                  04960000
049700         WRITE BROWSE-RECORD FROM REPORT-TITLE1                   04970000
049800         MOVE SPACES TO BROWSE-RECORD                             04980000
049900         WRITE BROWSE-RECORD                                      04990000
050000         PERFORM 4000-GROWTH-STATS                                05000000
050100             THRU 4000-EXIT                                       05010000
050200         MOVE SPACES TO BROWSE-RECORD                             05020005
050300         WRITE BROWSE-RECORD                                      05030005
050400         WRITE BROWSE-RECORD FROM END-OF-REPORT                   05040005
050500         CLOSE BROWSE-FILE                                        05050034
050600     END-IF.                                                      05060034
050700                                                                  05070034
050800     IF ((PS-IS-ALLOCATED)                                        05080034
050900             AND (PS-NO-DB2-ERROR))                               05090034
051000         PERFORM 8000-BROWSE-FILE                                 05100034
051100     END-IF.                                                      05110034
051200                                                                  05120000
051300 1700-EXIT.                                                       05130000
051400     EXIT.                                                        05140000
051500     EJECT                                                        05150000
051600************************************************************      05160000
051700* SET SWITCHES TO INDICATE WHAT OPTION HAS BEEN SPECIFIED  *      05170000
051800* BY THE USER                                              *      05180000
051900************************************************************      05190000
052000 2100-EDIT-INPUT.                                                 05200000
052100                                                                  05210000
052200     SET PS-NOT-EOF-PRINT TO TRUE.                                05220000
052300     SET PS-NO-DB2-ERROR TO TRUE.                                 05230000
052400     MOVE 'Y' TO PS-USER-INPUT.                                   05240000
052500                                                                  05250000
052600     IF (VAR-CMNEKTAB = SPACES  AND                               05260049
052700         VAR-CMNEKTB2 = SPACES  AND                               05270049
052800         VAR-CMNEKTB3 = SPACES) OR                                05280049
052900        VAR-CMNEKCRE = SPACES                                     05290049
053000          MOVE 'N' TO PS-USER-INPUT                               05300049
053100          MOVE 'SPECIFY REQUIRED PARM' TO VAR-SMSG                05310049
053200          MOVE                                                    05320049
053300          'SUPPLY THE NAME OF THE DB2 TABLE AND ITS CREATOR'      05330049
053400              TO VAR-LMSG                                         05340049
053500          MOVE 'CMN000  ' TO ISP-MSG                              05350049
053600     ELSE                                                         05360049
053700          MOVE 'Y' TO PS-USER-INPUT                               05370049
053800          IF VAR-CMNEKTB2 NOT = SPACES                            05380049
053900              STRING VAR-CMNEKTAB        DELIMITED BY ' ',        05390049
054000                     VAR-CMNEKTB2        DELIMITED BY ' '         05400049
054100                  INTO VAR-128-TABLE-NAME                         05410049
054200              IF VAR-CMNEKTB3 NOT = SPACES                        05420049
054300                  STRING VAR-128-TABLE-NAME  DELIMITED BY ' '     05430049
054400                         VAR-CMNEKTB3        DELIMITED BY ' '     05440049
054500                      INTO VAR-128-TABLE-NAME                     05450049
054600              END-IF                                              05460049
054700          ELSE                                                    05470049
054800              IF VAR-CMNEKTB3 NOT = SPACES                        05480049
054900                  STRING VAR-CMNEKTAB        DELIMITED BY ' ',    05490049
055000                         VAR-CMNEKTB3        DELIMITED BY ' '     05500049
055100                      INTO VAR-128-TABLE-NAME                     05510049
055200              ELSE                                                05520049
055300                  MOVE VAR-CMNEKTAB   TO VAR-128-TABLE-NAME       05530049
055400              END-IF                                              05540060
055410          END-IF                                                  05541060
055500     END-IF.                                                      05550049
055600                                                                  05560000
055700     EXEC SQL                                                     05570000
055800       SELECT    '1'                                              05580000
055900         INTO                                                     05590000
056000            :SQL-FILLER                                           05600000
056100       FROM      SYSIBM.SYSTABLES                                 05610000
056200       WHERE     NAME    = :VAR-128-TABLE-NAME                    05620049
056300       AND       CREATOR = :VAR-CMNEKCRE                          05630000
056400     END-EXEC.                                                    05640000
056500     IF SQLCODE = ZERO                                            05650000
056600         GO TO 2100-EXIT.                                         05660000
056700     IF SQLCODE = +100                                            05670000
056800         MOVE 'TABLE NOT FOUND' TO VAR-SMSG                       05680000
056900          MOVE 'N' TO PS-USER-INPUT                               05690000
057000       ELSE                                                       05700000
057100          MOVE 'N' TO PS-USER-INPUT                               05710000
057200         MOVE 'SQLCODE = ' TO VAR-SMSG-FILLER                     05720000
057300         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         05730000
057400         MOVE '2100-EDIT-INPUT ABEND, CONTACT DATA RESOURCE'      05740053
057500             TO VAR-LMSG.                                         05750053
057600****     STRING VAR-128-TABLE-NAME DELIMITED BY ' ',              05760053
057700****           ' CRE = '           DELIMITED BY SIZE,             05770053
057800****           VAR-CMNEKCRE        DELIMITED BY ' '               05780053
057900****       INTO VAR-LMSG.                                         05790053
058000     MOVE 'CMN000  ' TO ISP-MSG .                                 05800000
058100     SET  PS-DB2-ERROR TO TRUE.                                   05810000
058200 2100-EXIT.                                                       05820000
058300     EXIT.                                                        05830000
058400     EJECT                                                        05840000
058500************************************************************      05850000
058600* USE DYNALLOC TO ALLOCATE TEMP FILE THAT WILL BE DISPLAYED*      05860000
058700************************************************************      05870000
058800 3000-ALLOCATE-TEMP-FILE.                                         05880000
058900     PERFORM 9100-DELETE-FILE.                                    05890034
059000                                                                  05900034
059100     IF ((DP023-LASTRC = ZERO)                                    05910034
059200             OR (DP023-LASTRC = DP023-RC-DATASET-DOESNT-EXIST))   05920034
059300         INITIALIZE DP023-DYNALC-PARMS                            05930034
059400         MOVE PC-BROWSE-DDNAME TO DP023-DDNAME                    05940043
059500         MOVE PV-BROWSE-DSNAME TO DP023-DSNAME                    05950043
059600         SET DP023-DISP-NEW TO TRUE                               05960034
059700         SET DP023-FREE-CLOSE-NO TO TRUE                          05970034
059800         SET DP023-RECFM-FIXED-BLOCK TO TRUE                      05980034
059900         MOVE LENGTH OF BROWSE-RECORD TO DP023-RECSZ              05990047
060000         MOVE 82500 TO DP023-RECOUNT                              06000063
060100                                                                  06010034
060200         SET DP023-DISABLE-DISPLAY-ABEND TO TRUE                  06020034
060300                                                                  06030034
060400         PERFORM DP023-0000-DYNALC                                06040034
060500         IF DP023-LASTRC = ZERO                                   06050034
060600             SET PS-IS-ALLOCATED TO TRUE                          06060034
060700         ELSE                                                     06070034
060800             SET PS-IS-NOT-ALLOCATED TO TRUE                      06080034
060900             MOVE DP023-DDNAME TO PV-DR-DDNAME                    06090034
061000             MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE       06100034
061100             MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC      06110034
061200             MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG         06120034
061300             MOVE 'CMN000  ' TO ISP-MSG                           06130034
061400         END-IF                                                   06140034
061500     ELSE                                                         06150034
061600         SET PS-IS-NOT-ALLOCATED TO TRUE                          06160034
061700         MOVE DP023-DDNAME TO PV-DR-DDNAME                        06170034
061800         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           06180034
061900         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          06190034
062000         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG             06200034
062100         MOVE 'CMN000  ' TO ISP-MSG                               06210034
062200     END-IF.                                                      06220034
062300                                                                  06230034
062400************************************************************      06240000
062500* MAIN-LINE LOGIC                                          *      06250000
062600************************************************************      06260000
062700 4000-GROWTH-STATS.                                               06270003
062800                                                                  06280000
062900     PERFORM 4200-OPEN-STATS-CURSOR                               06290025
063000         THRU 4200-EXIT.                                          06300000
063100     IF PS-DB2-ERROR                                              06310000
063200         GO TO 4000-EXIT.                                         06320000
063300                                                                  06330000
063400     MOVE 'N' TO PS-PKEY.                                         06340000
063500     MOVE VAR-128-TABLE-NAME TO TITLE-TABLE.                      06350049
063600     MOVE VAR-CMNEKCRE TO TITLE-CREATOR.                          06360000
063700                                                                  06370001
063800     WRITE BROWSE-RECORD FROM REPORT-TITLE2.                      06380000
063900     WRITE BROWSE-RECORD FROM REPORT-TITLE3.                      06390054
064000                                                                  06400000
064100     WRITE BROWSE-RECORD FROM REPORT-LINE-HDR0.                   06410028
064200     WRITE BROWSE-RECORD FROM REPORT-LINE-HDR1.                   06420028
064300     WRITE BROWSE-RECORD FROM REPORT-LINE-HDR2.                   06430000
064400     WRITE BROWSE-RECORD FROM REPORT-LINE-HDR3.                   06440000
064500                                                                  06450000
064600     PERFORM 4300-FETCH-STATS THRU 4300-EXIT                      06460025
064700         UNTIL SQLCODE NOT = ZERO.                                06470000
064800     IF PS-DB2-ERROR                                              06480000
064900         GO TO 4000-EXIT.                                         06490000
065000                                                                  06500000
065100     PERFORM 4400-CLOSE-STATS-CURSOR                              06510025
065200         THRU 4400-EXIT.                                          06520000
065300                                                                  06530000
065400 4000-EXIT.                                                       06540000
065500     EXIT.                                                        06550000
065600     EJECT                                                        06560000
065700************************************************************      06570000
065800* OPEN STATS_CURSOR CURSOR                                 *      06580025
065900************************************************************      06590000
066000 4200-OPEN-STATS-CURSOR.                                          06600025
066100                                                                  06610000
066200      EXEC SQL                                                    06620000
066300          OPEN STATS_CURSOR                                       06630025
066400      END-EXEC.                                                   06640000
066500                                                                  06650000
066600      IF SQLCODE NOT = 0                                          06660000
066700          SET PS-DB2-ERROR TO TRUE                                06670000
066800          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     06680000
066900          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        06690000
067000          MOVE '4200-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    06700000
067100               TO VAR-LMSG                                        06710000
067200          MOVE 'CMN000  ' TO ISP-MSG.                             06720000
067300                                                                  06730000
067400 4200-EXIT.                                                       06740000
067500     EXIT.                                                        06750000
067600     EJECT                                                        06760000
067700************************************************************      06770000
067800* FETCH THE ROWS FROM STATS                                *      06780025
067900************************************************************      06790000
068000 4300-FETCH-STATS.                                                06800025
068100                                                                  06810000
068200     INITIALIZE DCLSYSTBHST.                                      06820025
068300     INITIALIZE DCLSYSTBPTH.                                      06830025
068400                                                                  06840000
068500     EXEC SQL                                                     06850000
068600         FETCH STATS_CURSOR                                       06860025
068700         INTO                                                     06870000
068800               :SYSTBPTH-PARTITION,                               06880025
068900               :HOLD-LAST-UPD-DTE,                                06890026
069000               :SYSTBHST-AVGROWLEN,                               06900025
069100               :SYSTBPTH-CARDF,                                   06910025
069200               :SYSTBPTH-PAGESAVE,                                06920025
069300               :SYSTBPTH-FARINDREF,                               06930025
069400               :SYSTBPTH-NEARINDREF                               06940025
069500     END-EXEC.                                                    06950000
069600                                                                  06960000
069700     IF SQLCODE = ZERO                                            06970000
069800         PERFORM 4310-CREATE-RPT THRU 4310-EXIT                   06980000
069900         GO TO 4300-EXIT.                                         06990000
070000     IF SQLCODE NOT = +100                                        07000000
070100         PERFORM 4400-CLOSE-STATS-CURSOR THRU 4400-EXIT           07010025
070200         SET PS-DB2-ERROR TO TRUE                                 07020000
070300         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      07030000
070400         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         07040000
070500         MOVE                                                     07050000
070600         '4300-FETCH-STATS ABEND, CONTACT DATA RESOURCE'          07060025
070700             TO VAR-LMSG                                          07070000
070800         MOVE 'CMN000  ' TO ISP-MSG.                              07080000
070900                                                                  07090000
071000  4300-EXIT.                                                      07100000
071100     EXIT.                                                        07110000
071200     EJECT                                                        07120000
071300************************************************************      07130000
071400* CREATE REPORT                                            *      07140000
071500************************************************************      07150000
071600 4310-CREATE-RPT.                                                 07160000
071700                                                                  07170000
071800     MOVE SPACES TO REPORT-LINE-DTL.                              07180006
071900                                                                  07190006
072000     MOVE SYSTBPTH-PARTITION TO RL-PART-NBR.                      07200026
072100     MOVE HOLD-LAST-UPD-DTE TO RL-STATS-DATE.                     07210026
072200     MOVE SYSTBHST-AVGROWLEN TO RL-ROW-LENGTH.                    07220026
072300     MOVE SYSTBPTH-PAGESAVE TO RL-COMPR-SAVE-PCT.                 07230026
072400     MOVE '%' TO RL-PCT4.                                         07240017
072500     MOVE SYSTBPTH-CARDF TO RL-ROW-CNT.                           07250026
072600     MOVE SYSTBPTH-FARINDREF TO RL-FAR-PG-CNT.                    07260026
072700     MOVE SYSTBPTH-NEARINDREF TO RL-NEAR-PG-CNT.                  07270026
072800                                                                  07280000
072900     IF SYSTBPTH-PARTITION = HOLD-PART-NBR                        07290026
073000         PERFORM 4315-COMPUTE-CHG                                 07300009
073100     ELSE                                                         07310009
073200         MOVE SPACES TO BROWSE-RECORD                             07320009
073300         WRITE BROWSE-RECORD                                      07330009
073400     END-IF.                                                      07340009
073500                                                                  07350000
073600     WRITE BROWSE-RECORD FROM REPORT-LINE-DTL.                    07360000
073700                                                                  07370000
073800     MOVE SYSTBPTH-PARTITION TO HOLD-PART-NBR.                    07380026
073900     MOVE SYSTBPTH-CARDF TO HOLD-ROW-CNT-NBR.                     07390026
074000     MOVE SYSTBPTH-FARINDREF TO HOLD-RELOC-FAR-PG-NBR.            07400026
074100     MOVE SYSTBPTH-NEARINDREF TO HOLD-RELOC-NEAR-PG-NBR.          07410026
074200*                                                                 07420000
074300 4310-EXIT.                                                       07430000
074400     EXIT.                                                        07440003
074500     EJECT                                                        07450003
074600************************************************************      07460000
074700* COMPUTE CHG                                              *      07470000
074800************************************************************      07480000
074900 4315-COMPUTE-CHG.                                                07490000
075000                                                                  07500000
075100     COMPUTE WORK-ROW-CNT = SYSTBPTH-CARDF - HOLD-ROW-CNT-NBR.    07510026
075200     MOVE WORK-ROW-CNT TO RL-ROW-CNT-I-D.                         07520000
075300                                                                  07530000
075400     IF HOLD-ROW-CNT-NBR > 0                                      07540009
075500         COMPUTE WORK-ROW-PCT = ((SYSTBPTH-CARDF -                07550026
075600             HOLD-ROW-CNT-NBR) / HOLD-ROW-CNT-NBR) * 100          07560010
075700         END-COMPUTE                                              07570010
075800         MOVE WORK-ROW-PCT TO RL-ROW-PCT-I-D                      07580009
075900         MOVE '%' TO RL-PCT1                                      07590010
076000     END-IF.                                                      07600009
076100                                                                  07610009
076200     COMPUTE WORK-FAR-PG-CNT =                                    07620000
076300         SYSTBPTH-FARINDREF - HOLD-RELOC-FAR-PG-NBR.              07630026
076400     MOVE WORK-FAR-PG-CNT TO RL-FAR-PG-CNT-I-D.                   07640000
076500                                                                  07650000
076600     IF HOLD-RELOC-FAR-PG-NBR > 0                                 07660009
076700         COMPUTE WORK-FAR-PG-PCT = ((SYSTBPTH-FARINDREF -         07670026
076800             HOLD-RELOC-FAR-PG-NBR) / HOLD-RELOC-FAR-PG-NBR) * 10007680010
076900         END-COMPUTE                                              07690010
077000         MOVE WORK-FAR-PG-PCT TO RL-FAR-PG-PCT-I-D                07700009
077100         MOVE '%' TO RL-PCT2                                      07710010
077200     END-IF.                                                      07720009
077300                                                                  07730000
077400     COMPUTE WORK-NEAR-PG-CNT =                                   07740000
077500         SYSTBPTH-NEARINDREF - HOLD-RELOC-NEAR-PG-NBR.            07750026
077600     MOVE WORK-NEAR-PG-CNT TO RL-NEAR-PG-CNT-I-D.                 07760000
077700                                                                  07770000
077800     IF HOLD-RELOC-NEAR-PG-NBR > 0                                07780019
077900         COMPUTE WORK-NEAR-PG-PCT = ((SYSTBPTH-NEARINDREF -       07790026
078000           HOLD-RELOC-NEAR-PG-NBR) / HOLD-RELOC-NEAR-PG-NBR) * 10007800010
078100         END-COMPUTE                                              07810010
078200         MOVE WORK-NEAR-PG-PCT TO RL-NEAR-PG-PCT-I-D              07820009
078300         MOVE '%' TO RL-PCT3                                      07830010
078400     END-IF.                                                      07840009
078500*                                                                 07850000
078600 4315-EXIT.                                                       07860000
078700     EXIT.                                                        07870004
078800     EJECT                                                        07880004
078900************************************************************      07890000
079000* CLOSE STATS_CURSOR                                      *       07900025
079100************************************************************      07910000
079200 4400-CLOSE-STATS-CURSOR.                                         07920025
079300                                                                  07930000
079400     EXEC SQL                                                     07940000
079500         CLOSE STATS_CURSOR                                       07950025
079600     END-EXEC.                                                    07960000
079700                                                                  07970000
079800     IF SQLCODE NOT = ZERO                                        07980000
079900         SET PS-DB2-ERROR TO TRUE                                 07990000
080000         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      08000000
080100         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         08010000
080200         MOVE '4400-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    08020000
080300              TO VAR-LMSG                                         08030000
080400         MOVE 'CMN000  ' TO ISP-MSG.                              08040000
080500*                                                                 08050000
080600 4400-EXIT.                                                       08060000
080700     EXIT.                                                        08070000
080800     EJECT                                                        08080000
080900************************************************************      08090000
081000* DISPLAY BROWSE-FILE                                      *      08100000
081100************************************************************      08110000
081200 8000-BROWSE-FILE.                                                08120000
081300     MOVE ZERO TO PV-COUNTR.                                      08130034
081400     INSPECT PV-BROWSE-DSNAME TALLYING PV-COUNTR FOR              08140043
081500                 CHARACTERS BEFORE INITIAL '.'.                   08150034
081600     ADD 2 TO PV-COUNTR.                                          08160034
081700*BLJ MOVE PV-BROWSE-DSNAME (PV-COUNTR:13) TO VAR-DSNAME.          08170065
081700     MOVE PV-BROWSE-DSNAME (PV-COUNTR:21) TO VAR-DSNAME.          08171065
081800     MOVE 'CMNEKR6D' TO ISP-PANEL.                                08180034
081900     CALL 'ISPLINK' USING ISP-BROWSE,                             08190034
082000                          VAR-DSNAME,                             08200034
082100                          VAR-VOLUME,                             08210034
082200                          VAR-PASSWORD,                           08220034
082300                          ISP-PANEL.                              08230034
082400*                                                                 08240034
082500*  CALL THE COMMON PRINT REQUEST PANEL PROGRAM TO ALLOW THE OPTION08250034
082600*  OF PRINTING THE FILE THAT WAS JUST BROWSED.                    08260034
082700*                                                                 08270034
082800     INITIALIZE DP300-ISPF-PRINT-PARMS.                           08280034
082900     MOVE PC-CURRENT-PROGRAM-NAME TO                              08290034
083000               DP300-CALLING-PROGRAM-NAME.                        08300034
083100     MOVE 1 TO DP300-CALLING-REPORT-NUMBER.                       08310034
083200     MOVE PV-BROWSE-DSNAME TO DP300-FILE-DSNAME.                  08320043
083300     SET DP300-FR-FIXED-BLOCK TO TRUE.                            08330034
083400     MOVE 132 TO DP300-FILE-LRECL.                                08340034
083500     SET DP300-PT-PRINT-TITLE-LINE                                08350034
083600         DP300-RH-REPEAT-HEADINGS TO TRUE.                        08360034
083700     MOVE 7 TO DP300-HEADING-LINE-COUNT.                          08370041
083800     CALL DP300-ISPF-PRINT-REQ-PROGRAM                            08380034
083900               USING DP300-ISPF-PRINT-PARMS.                      08390034
084000     MOVE 'CMN000  ' TO ISP-MSG                                   08400034
084100     MOVE DP300-ERROR-MESSAGE TO VAR-LMSG.                        08410034
084200     IF DP300-RI-PRINT-REQUESTED                                  08420034
084300         MOVE DP300-ERROR-MESSAGE TO VAR-SMSG                     08430034
084400     END-IF.                                                      08440034
084500                                                                  08450034
084600************************************************************      08460034
084700* DELETE BROWSE FILE                                       *      08470034
084800************************************************************      08480034
084900 9100-DELETE-FILE.                                                08490034
085000     INITIALIZE DP023-DYNALC-PARMS.                               08500034
085100     MOVE PC-BROWSE-DDNAME TO DP023-DDNAME.                       08510043
085200     MOVE PV-BROWSE-DSNAME TO DP023-DSNAME.                       08520043
085300     SET DP023-DISP-DELETE TO TRUE.                               08530034
085400     SET DP023-FREE-CLOSE-NO TO TRUE.                             08540034
085500     SET DP023-RECFM-FIXED-BLOCK TO TRUE.                         08550034
085600     MOVE LENGTH OF BROWSE-RECORD TO DP023-RECSZ.                 08560047
085700     MOVE ZEROES TO DP023-RECOUNT.                                08570047
085800                                                                  08580034
085900     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     08590034
086000                                                                  08600034
086100     PERFORM DP023-0000-DYNALC.                                   08610034
086200                                                                  08620034
086300     SET PS-IS-NOT-ALLOCATED TO TRUE.                             08630034
086400                                                                  08640034
086500*                                                                 08650034
086600*  DYNAMIC ALLOCATION ROUTINE                                     08660034
086700*                                                                 08670034
086800     COPY DPPD023.                                                08680034
