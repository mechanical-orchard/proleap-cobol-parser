00001 *************************                                         02/05/92
00002  IDENTIFICATION DIVISION.                                         MBKCS130
00003 *************************                                            LV049
00004  PROGRAM-ID.    MBKCS130.                                            CL**1
00005  AUTHOR.        MIKE FURLICK.                                        CL**1
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                             CL**1
00007  DATE-WRITTEN.  9-06-91.                                             CL**1
00008  DATE-COMPILED.                                                      CL**1
00009                                                                      CL**1
00010 *****************************************************************    CL**1
00011 *    R130 - APPLICATION SYSTEM ADD/DELETE/UPDATE.                    CL**1
00012 *                                                                    CL**1
00013 *    THIS PROGRAM PERFORMS THE MAINTENANCE TO THE RESPONSIBILTY      CL**1
00014 *    LEVEL TABLE (TRSPLVL).                                          CL**1
00015 *    FOR THE UPDATE AND DELETE FUNCTIONS, SELECTED DATA IS PASSED    CL**1
00016 *    HERE FROM MBKCS129 (RESPONSIBILITY LIST) FOR THE ADD FUNCTION   CL**1
00017 *    NO LIST IS PASSED AND THE RESPONSIBILITY CODE ON THE SCREEN     CL**1
00018 *    IS UNPROTECTED.                                                 CL**1
00019 *                                                                    CL**1
00020 *****************************************************************    CL**1
001802* 10/09/97 - PAUL KEBER/STRATAGEM - WR# 5280                     *        
001803*   PREVENT THE ENTRY OF UNDERSCORES IN THE DESCRIPTION FIELD    *        
001804*   IN ORDER TO PREVENT PROBLEMS LOADING DATA WAREHOUSE DB2PE    *        
001805*   TABLE INFORMATION.                                           *        
001810******************************************************************        
00021                                                                      CL**1
00022 *                                                                    CL**1
00023 *                                                                    CL**1
00024 *                                                                    CL**1
00025  ENVIRONMENT DIVISION.                                               CL**1
00026 *                                                                    CL**1
00027 *                                                                    CL**1
00028 *                                                                    CL**1
00029  DATA DIVISION.                                                      CL**1
00030 *                                                                    CL**1
00031 *                                                                    CL**1
00032  WORKING-STORAGE SECTION.                                            CL**1
00033 *                                                                    CL**1
00034  01  PC-PROGRAM-CONSTANTS.                                           CL**1
00035      05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.   CL**1
00036      05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072     CL**1
00037                                                      COMP SYNC.      CL**1
00038      05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE           CL**1
00039      'MB130A  '.                                                     CL**1
00040      05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE           CL**1
00041      'MBKM130 '.                                                     CL**1
00042      05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE           CL**1
00043      'MBKCS130'.                                                     CL**1
00044      05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128      CL**1
00045                                                      COMP SYNC.      CL**1
00046      05  FILLER REDEFINES PC-ERASE-EOF-COMP.                         CL**1
00047          10  FILLER                     PIC X(01).                   CL**1
00048          10  PC-ERASE-EOF               PIC X(01).                   CL**1
00049      05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3         CL**1
00050                                                      COMP-3.         CL**1
00051      05  PC-N                           PIC X        VALUE 'N'.      CL**1
00052      05  PC-Y                           PIC X        VALUE 'Y'.      CL**1
00053  01  PC-COMPANY                         PIC XX       VALUE '03'.     CL**1
00054 *                                                                    CL**1
00055  01  PC-TSYMSG-NUMBERS.                                              CL**1
00056      05  PC-TSYMSG-00004                PIC 9(5)    VALUE 00004.     CL*24
00057      05  PC-TSYMSG-00005                PIC 9(5)    VALUE 00005.     CL*24
00058      05  PC-TSYMSG-00007                PIC 9(5)    VALUE 00007.     CL**1
00059      05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.     CL**1
00060      05  PC-TSYMSG-00034                PIC 9(5)    VALUE 00034.     CL**1
00061      05  PC-TSYMSG-00045                PIC 9(5)    VALUE 00045.     CL*10
00062      05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.     CL**1
00063      05  PC-TSYMSG-00051                PIC 9(5)    VALUE 00051.     CL**1
00064      05  PC-TSYMSG-00052                PIC 9(5)    VALUE 00052.     CL**1
00065      05  PC-TSYMSG-00053                PIC 9(5)    VALUE 00053.     CL**1
00066      05  PC-TSYMSG-00054                PIC 9(5)    VALUE 00054.     CL**1
00067      05  PC-TSYMSG-00055                PIC 9(5)    VALUE 00055.     CL**1
00068      05  PC-TSYMSG-00057                PIC 9(5)    VALUE 00057.     CL**1
00069      05  PC-TSYMSG-00059                PIC 9(5)    VALUE 00059.     CL**1
00070      05  PC-TSYMSG-00061                PIC 9(5)    VALUE 00061.     CL**1
00071      05  PC-TSYMSG-00062                PIC 9(5)    VALUE 00062.     CL**1
00072      05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.     CL**1
00073      05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.     CL**1
00074      05  PC-TSYMSG-00115                PIC 9(5)    VALUE 00115.     CL*15
00075      05  PC-TSYMSG-00117                PIC 9(5)    VALUE 00117.     CL*15
00076      05  PC-TSYMSG-00118                PIC 9(5)    VALUE 00118.     CL*15
00077      05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.     CL*15
00078      05  PC-TSYMSG-00149                PIC 9(5)    VALUE 00149.     CL*15
00078      05  PC-TSYMSG-01643                PIC 9(5)    VALUE 01643.     CL*15
00079      05  PC-TSYMSG-99901                PIC 9(5)    VALUE 99901.     CL*43
00080 *                                                                    CL**1
00081  01  PM-PROGRAM-MESSAGES.                                            CL**1
00082      05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE           CL**1
00083      'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                   CL**1
00084      05  PM-PROGRAM-MESSAGE-22          PIC X(78)    VALUE           CL**1
00085      'LOGIC ERROR IN TRYING TO READ APLSYS QUEUE - RESP = '.         CL**1
00086      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-22.                     CL**1
00087          10  FILLER                     PIC X(61).                   CL**1
00088          10  PM-RESP-22                 PIC 9999.                    CL**1
00089          10  FILLER                     PIC X(12).                   CL**1
00090 *                                                                    CL**1
00091  01  PS-PROGRAM-SUBSCRIPTS.                                          CL**1
00092      05  PS-SUB                         PIC S9(04)   VALUE +0        CL**1
00093                                                      COMP SYNC.      CL**1
00094      05  PS-ITEM-SUB                    PIC S9(09)   VALUE +0        CL**1
00095                                                      COMP-3.         CL**1
00096                                                                      CL**1
00097  01  PS-PROGRAM-SWITCHES.                                            CL**1
00098      05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.      CL**1
00099          88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.      CL**1
00100          88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.      CL**1
00101          88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.      CL**1
00102          88  PS-SEND-DATA-ONLY                       VALUE '4'.      CL**1
00103          88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.      CL**1
00104          88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.      CL**1
00105      05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.      CL**1
00106          88  PS-ERROR                                VALUE 'Y'.      CL**1
00107          88  PS-NO-ERROR                             VALUE 'N'.      CL**1
00108      05  PS-INTER-APPL-VALID-SW         PIC X(01)    VALUE 'N'.      CL**1
00109          88  PS-INTER-APPL-VALID                     VALUE 'Y'.      CL**1
00110          88  PS-INTER-APPL-NOT-VALID                 VALUE 'N'.      CL**1
00111      05  PS-WARNING-SW                  PIC X(01)    VALUE 'N'.      CL**1
00112          88  PS-WARNING                              VALUE 'Y'.      CL**1
00113          88  PS-NO-WARNING                           VALUE 'N'.      CL**1
00114      05  PS-INFORMATIONAL-SW            PIC X(01)    VALUE 'N'.      CL**1
00115          88  PS-INFORMATIONAL                        VALUE 'Y'.      CL**1
00116          88  PS-NOT-INFORMATIONAL                    VALUE 'N'.      CL**1
00117      05  PS-PROCESSING-SW               PIC X(01)    VALUE 'N'.      CL**1
00118          88  PS-CONTINUE                             VALUE 'Y'.      CL*27
00119          88  PS-DONT-PROCESS                         VALUE 'N'.      CL*27
00120      05  PS-SAVE-SW                     PIC X(01)    VALUE 'N'.      CL**1
00121          88  PS-SAVE-DATA                            VALUE 'Y'.      CL*27
00122          88  PS-DONT-SAVE-DATA                       VALUE 'N'.      CL*27
00123      EJECT                                                           CL**1
00124  01  PV-PROGRAM-VARIABLES.                                           CL**1
00125      05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0        CL**1
00126                                                      COMP SYNC.      CL**1
00127      05  PV-RESP                        PIC S9(04)   VALUE +0        CL**1
00128                                                      COMP SYNC.      CL**1
00129      05  PV-ITEM                        PIC S9(04)   VALUE +0        CL**1
00130                                                      COMP SYNC.      CL**1
020401     05  PV-UNDERSCORE-COUNT            PIC S9(04)   VALUE +0     RC      
020410                                                     COMP SYNC.   RC      
00132      05  PV-SQL-SUB                     PIC S9(4)    COMP.           CL**1
00131      05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.   CL**1
00133      05  PV-RETRY-COUNTER               PIC S9(3)    COMP-3.         CL**1
00134 *                                                                    CL**1
00135  01  PV-DB2-COUNT                       PIC S9(9)    VALUE +0        CL**1
00136                                                      COMP-3.         CL**1
00137  01  PV-DB2-DATE                        PIC X(10).                   CL**1
00138  01  FILLER  REDEFINES PV-DB2-DATE.                                  CL**1
00139      05  PV-DD-CCYY                     PIC X(4).                    CL**1
00140      05  FILLER                         PIC X.                       CL**1
00141          88  PV-DD-DASH1                             VALUE '-'.      CL**1
00142      05  PV-DD-MM                       PIC XX.                      CL**1
00143      05  FILLER                         PIC X.                       CL**1
00144          88  PV-DD-DASH2                             VALUE '-'.      CL**1
00145      05  PV-DD-RL                       PIC XX.                      CL**1
00146 *                                                                    CL**1
00147  EJECT                                                               CL**1
00148 *****************************************************************    CL**1
00149 *    STANDARD COMMAREA.                                              CL**1
00150 *****************************************************************    CL**1
00151                                                                      CL**1
00152      COPY DPWS020.                                                   CL*49
00153      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                   CL**1
00154                                                                      CL**1
00155 *****************************************************************    CL**1
00156 *    INTER-APPLICATION COMMAREA.                                     CL**1
00157 *****************************************************************    CL**1
00158                                                                      CL**1
00159          10  INTER-APPL-COMM-AREA       PIC X(200).                  CL**1
00160      COPY MBWS005.                                                   CL*49
00161 *****************************************************************    CL**1
00162 *    SPECIFIC COMMMAREA FOR MBKCS130.                                CL**1
00163 *****************************************************************    CL**1
00164          10  MB130-SPECIFIC-COMMAREA.                                CL**1
00165              15  MB130-APPL-CURSOR-POSITION          PIC S9(04)      CL**1
00166                                                      COMP.           CL**1
00167              15  MB130-RL-SUB                        PIC S9(4)       CL**1
00168                                                          COMP.       CL**1
00169              15  MB130-RL-ITEM                       PIC S9(4)       CL**1
00170                                                          COMP.       CL**1
00171            12    MB130-LAST-AREA.                                    CL*11
00172              15  MB130-LAST-RSPLVL-CODE              PIC X(3).       CL**1
00173              15  MB130-LAST-DESC                     PIC X(25).      CL**1
00174            12    MB130-LAST-AREA-END.                                CL*11
00175              15  MB130-CONFIRM-SWITCH                PIC X.          CL*24
00176                  88  MB130-CANT-CONFIRM              VALUE 'N'.      CL*27
00177                  88  MB130-CAN-CONFIRM               VALUE 'Y'.      CL*27
00178              15  MB130-ACTION                        PIC X.          CL*10
00179                  88  MB130-ADD-FUNCTION              VALUE 'A'.      CL*27
00180                  88  MB130-UPDATE-FUNCTION           VALUE 'U'.      CL*27
00181                  88  MB130-DELETE-FUNCTION           VALUE 'D'.      CL*27
00182              15  MB130-TEMP-QUEUE-NAME.                              CL**1
00183                  20  MB130-TERM-ID                   PIC X(4).       CL**1
00184                  20  MB130-TASK-NUMBER               PIC S9(7)       CL**1
00185                                                          COMP-3.     CL**1
00186              15  MB130-SAVE-INTER-APPL-COMMAREA      PIC X(200).     CL**1
00187              15  MB130-SAVE-TS-QUEUE                 PIC X(1700).    CL*18
00188 *                                                                    CL**1
00189      EJECT                                                           CL**1
00190 *****************************************************************    CL**1
00191 *    RESPONSIBILITY LIST QUEUE RECORD LAYOUT.                        CL**1
00192 *****************************************************************    CL**1
00193  01 RSPLVL-LIST-RECORD.                                              CL**1
00194      COPY MBWS129.                                                   CL*49
00195                                                                      CL**1
00196 *                                                                    CL**1
00197      EJECT                                                           CL**1
00198 *****************************************************************    CL**1
00199 *    ABEND PROCESSING COPYBOOK.                                      CL**1
00200 *****************************************************************    CL**1
00201                                                                      CL**1
00202      COPY DPWS013.                                                   CL**1
00203                                                                      CL**1
00197      EJECT                                                           CL**1
00198 *****************************************************************    CL**1
00199 *    SYSTEM MESSAGE COPYBOOK.                                        CL**1
00200 *****************************************************************    CL**1
00201                                                                      CL**1
00202      COPY DPWS006.                                                   CL**1
00203                                                                      CL**1
00204      EJECT                                                           CL**1
00205 *****************************************************************    CL**1
00206 *    ATTRIBUTE SETTINGS COPYBOOK.                                    CL**1
00207 *****************************************************************    CL**1
00208                                                                      CL**1
00209      COPY DPWS015.                                                   CL**1
00210                                                                      CL**1
00211 *****************************************************************    CL**1
00212 *    CURRENT DATE AND TIME COPYBOOK.                                 CL**1
00213 *****************************************************************    CL**1
00214                                                                      CL**1
00215      COPY DPWS017.                                                   CL**1
00216                                                                      CL**1
00217 *****************************************************************    CL**1
00218 *    TOGGLE FUNCTION KEY LINES COPYBOOK.                             CL**1
00219 *****************************************************************    CL**1
00220                                                                      CL**1
00221      COPY DPWS009.                                                   CL**1
00222                                                                      CL**1
00223 *****************************************************************    CL**1
00224 *    FUNCTION KEYS COPYBOOK.                                         CL**1
00225 *****************************************************************    CL**1
00226                                                                      CL**1
00227      COPY DPWS016.                                                   CL**1
00228                                                                      CL**1
00229 *****************************************************************    CL**1
00230 *    DPKUT045 COPYBOOK.                                              CL**1
00231 *****************************************************************    CL**1
00232                                                                      CL**1
00233      COPY DPWS045.                                                   CL**1
00234                                                                      CL**1
00235 *****************************************************************    CL**1
00236 *    NUMERIC EDIT LAYOUT.                                            CL**1
00237 *****************************************************************    CL**1
00238                                                                      CL**1
00239      COPY DPWS010I.                                                  CL**1
00240                                                                      CL**1
00241 *****************************************************************    CL**1
00242 *    MESSAGE RECORD LAYOUT                                           CL**1
00243 *****************************************************************    CL**1
00244                                                                      CL**1
00245      COPY DPRD507I.                                                  CL**1
00246                                                                      CL**1
00247 *****************************************************************    CL**1
00248 *    STANDARD ATTENTION IDENTIFIER LIST                              CL**1
00249 *****************************************************************    CL**1
00250                                                                      CL**1
00251      COPY DFHAID.                                                    CL**1
00252                                                                      CL**1
00253 *****************************************************************    CL**1
00254 *    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST           CL**1
00255 *****************************************************************    CL**1
00256                                                                      CL**1
00257      COPY DFHBMSCA.                                                  CL**1
00258                                                                      CL**1
00259 *****************************************************************    CL**1
00260 *    MAP LAYOUT                                                      CL**1
00261 *****************************************************************    CL**1
00262                                                                      CL**1
00263      COPY MBKM130.                                                   CL**1
00264  01  MD-MAP-DATA-AREA  REDEFINES MB130AO PIC X(1000).                CL**1
00265 *                                                                    CL**1
00266  EJECT                                                               CL**1
00267 *                                                                    CL**1
00268 *    DB2 AREA FOR TRSPLVL                                            CL**1
00269 *                                                                    CL**1
00270      EXEC SQL                                                        CL**1
00271           INCLUDE TRSPLVL                                            CL**1
00272      END-EXEC.                                                       CL**1
00273 *                                                                    CL**1
00274 *    DB2 AREA FOR TMDSEAR                                            CL**1
00275 *                                                                    CL**1
00276      EXEC SQL                                                        CL**1
00277           INCLUDE TMDSEAR                                            CL**1
00278      END-EXEC.                                                       CL**1
00279 *                                                                    CL**1
00280 *    DB2 AREA FOR TRSPBAR                                            CL**1
00281 *                                                                    CL**1
00282      EXEC SQL                                                        CL**1
00283           INCLUDE TRSPBAR                                            CL**1
00284      END-EXEC.                                                       CL**1
00285 *                                                                    CL**1
00286 *    DB2 AREA FOR COMMUNICATIONS                                     CL**1
00287 *                                                                    CL**1
00288      EXEC SQL                                                        CL**1
00289           INCLUDE SQLCA                                              CL**1
00290      END-EXEC.                                                       CL**1
00291 *                                                                    CL**1
00292  EJECT                                                               CL**1
00293  LINKAGE SECTION.                                                    CL**1
00294                                                                      CL**1
00295  01  DFHCOMMAREA.                                                    CL**1
00296      05  FILLER                         OCCURS  1 TO 4072 TIMES      CL**1
00297                                         DEPENDING ON EIBCALEN.       CL**1
00298          10  FILLER                     PIC X.                       CL**1
00299                                                                      CL**1
00300 *                                                                    CL**1
00301 *                                                                    CL**1
00302 *                                                                    CL**1
00303  PROCEDURE DIVISION.                                                 CL**1
00304                                                                      CL**1
00305                                                                      CL**1
00306  0000-MAIN-MODULE.                                                   CL**4
00307                                                                      CL**1
00308 ******************************************************************   CL**1
00309 *    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.              CL**1
00310 ******************************************************************   CL**1
00311                                                                      CL**1
00312      PERFORM DP015-0000-CHECK-COMMAREA.                              CL**1
00313                                                                      CL**1
00314      IF DP020-SRC-RETURN-W-TRAN-ID                                   CL**1
00315          PERFORM 1000-CONTROL-PROCESSING                             CL**4
00316      END-IF.                                                         CL**1
00317                                                                      CL**1
00318      PERFORM DP003-0000-RETURN-TO-CICS.                              CL**1
00319  EJECT                                                               CL**1
00320 ******************************************************************   CL**1
00321 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT       CL**1
00322 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                       CL**1
00323 *                                                                    CL**1
00324 *    PERFORMED BY 0000-MAIN-MODULE.                                  CL**4
00325 ******************************************************************   CL**1
00326 *                                                                    CL**1
00327  1000-CONTROL-PROCESSING.                                            CL**4
00328 *                                                                    CL**1
00329      SET PS-CONTINUE           TO  TRUE.                             CL*27
00330 *                                                                    CL**1
00331      EVALUATE TRUE                                                   CL**1
00332          WHEN DP020-NEXT-ACT-INITIAL                                 CL**1
00333              PERFORM 4100-VALIDATE-COMMAREA                          CL*41
00334              IF  PS-INTER-APPL-NOT-VALID                             CL*41
00335                  MOVE DP016-PF3                                      CL*41
00336                                TO  DP020-SRC-AID                     CL*41
00337                  SET DP020-MSG-FATAL                                 CL*44
00338                                TO  TRUE                              CL*44
00339                  MOVE PC-TSYMSG-99901                                CL*43
00340                                TO  DP020-MSG-NUMBER                  CL*43
00341                  PERFORM DP015-1000-START-NAVIGATOR                  CL*42
00342              ELSE                                                    CL*41
00343                  INITIALIZE MB130-SPECIFIC-COMMAREA                  CL*41
00344                  SET PS-SEND-MAP-N-DATA-FRSET                        CL*41
00345                                TO  TRUE                              CL*41
00346                  SET DP020-NEXT-ACT-READ-MAP                         CL*41
00347                                TO  TRUE                              CL*41
00348                  PERFORM 2000-BUILD-INITIAL-PANEL                    CL*41
00349              END-IF                                                  CL*41
00350 *                                                                    CL**1
00351          WHEN DP020-NEXT-ACT-READ-MAP                                CL**1
00352              PERFORM 3000-PROCESS-PANEL                              CL**4
00353 *                                                                    CL**1
00354          WHEN DP020-NEXT-ACT-RETURN                                  CL**1
00355              SET PS-SEND-MAP-N-DATA-FRSET                            CL**1
00356                                TO  TRUE                              CL**1
00357              MOVE MB130-SAVE-INTER-APPL-COMMAREA                     CL**1
00358                                TO  MB005-INTER-APPL-COMMAREA         CL**1
00359              PERFORM 3400-MOVE-COMMAREA-TO-SCREEN                    CL**4
00360              IF  MB130-DELETE-FUNCTION                               CL*27
00361                  CONTINUE                                            CL*27
00362              ELSE                                                    CL*27
00363                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*27
00364              END-IF                                                  CL*27
00365              PERFORM 2200-DISPLAY-PANEL                              CL**4
00366 *                                                                    CL**1
00367          WHEN DP020-NEXT-ACT-ERROR                                   CL**1
00368              MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                    CL**1
00369              IF DP020-NAV-MNEMONIC = SPACES                          CL**1
00370                  MOVE SPACES   TO  ANAVCMDO                          CL**1
00371                  MOVE DP015-UNDERLINE                                CL**1
00372                                TO  ANAVCMDH                          CL**1
00373                  MOVE DP015-GREEN                                    CL**1
00374                                TO  ANAVCMDC                          CL**1
00375              ELSE                                                    CL**1
00376                  MOVE DP015-REVERSE                                  CL**1
00377                                TO  ANAVCMDH                          CL**1
00378                  MOVE DP015-RED                                      CL**1
00379                                TO  ANAVCMDC                          CL**1
00380              END-IF                                                  CL**1
00381 *                                                                    CL**1
00382              MOVE PV-MESSAGE   TO  DP020-MSG-MESSAGE                 CL**1
00383                                                                      CL**1
00384              SET DP020-MSG-FATAL                                     CL**1
00385                                TO  TRUE                              CL**1
00386              SET PS-SEND-DATA-ONLY-FRSET                             CL**1
00387                                TO  TRUE                              CL**1
00388              PERFORM 2200-DISPLAY-PANEL                              CL**4
00389 *                                                                    CL**1
00390          WHEN OTHER                                                  CL**1
00391              SET DP013-LOGIC-ABEND TO TRUE                           CL**1
00392              SET DP013-NO-ROLLBACK TO TRUE                           CL**1
00393              MOVE '1000-CONTROL-PROCESSING'                          CL**4
00394                                TO  DP013-PARAGRAPH                   CL**1
00395              MOVE PM-PROGRAM-MESSAGE-12                              CL**1
00396                                TO  DP013-MESSAGE-TEXT(1)             CL**1
00397              PERFORM DP013-0000-PROCESS-ABEND                        CL**1
00398      END-EVALUATE.                                                   CL**1
00399 *                                                                    CL**1
00400  EJECT                                                               CL**1
00401 ******************************************************************   CL**1
00402 *    ENSURE THE QUEUE WAS PASSED WITH DATA.  STOP PROCESSING IF      CL**1
00403 *    NOT!                                                            CL**1
00404 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL**4
00405 ******************************************************************   CL**1
00406 *                                                                    CL**1
00407  2000-BUILD-INITIAL-PANEL.                                           CL**4
00408 *                                                                    CL**1
00409      IF  MB005-LIST-QUEUE-NAME GREATER THAN SPACES                   CL**1
00410          MOVE 1                TO  MB130-RL-ITEM                     CL**1
00411          PERFORM 2170-READ-LIST-QUEUE                                CL**5
00412          MOVE RSPLVL-LIST-RECORD                                     CL*18
00413                                TO  MB130-SAVE-TS-QUEUE               CL*18
00414          MOVE MBWS129-ACTION   TO  MB130-ACTION                      CL*10
00415          MOVE 1                TO  MB130-RL-SUB                      CL**1
00416          MOVE SPACES           TO  DCLTRSPLVL                        CL*32
00417          MOVE MBWS129-RLEVEL (1)                                     CL**1
00418                                TO  RSPLVL-CDE                        CL**1
00419          SET PS-SAVE-DATA      TO  TRUE                              CL*27
00420          PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                        CL**4
00421      ELSE                                                            CL**1
00422          SET MB130-ADD-FUNCTION                                      CL*27
00423                                TO  TRUE                              CL**1
00424      END-IF.                                                         CL**1
00425      MOVE PC-COMPANY           TO  AOPERCOO.                         CL*14
00426      MOVE -1                   TO  ANAVCMDL.                         CL*35
00427      PERFORM 2200-DISPLAY-PANEL.                                     CL**4
00428 *                                                                    CL**1
00429  EJECT                                                               CL**1
00430 ******************************************************************   CL**1
00431 *    OBTAIN THE RESPONSIBILITY LEVEL DATA.                           CL**1
00432 *                                                                    CL**1
00433 *    PERFORMED BY 2000, 2140                                         CL*14
00434 ******************************************************************   CL**1
00435 *                                                                    CL**1
00436  2100-RETRIEVE-DATA-FOR-PANEL.                                       CL**4
00437 *                                                                    CL**1
00438      PERFORM                                                         CL**1
00439          WITH TEST AFTER                                             CL**1
00440          VARYING PV-SQL-SUB                                          CL**1
00441          FROM 1 BY 1                                                 CL**1
00442          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL**1
00443             OR SQLCODE = 0                                           CL**1
00444             OR SQLCODE = +100                                        CL**1
00445 *                                                                    CL**1
00446          EXEC SQL                                                    CL**1
00447               SELECT                                                 CL**1
00448                      RSPLVL_DESC                                     CL**2
00449               INTO                                                   CL**1
00450                      :RSPLVL-DESC                                    CL**1
00451               FROM                                                   CL**1
00452                      TRSPLVL                                         CL**1
00453               WHERE                                                  CL**1
00454                      RSPLVL_CDE     = :RSPLVL-CDE                    CL**1
00455          END-EXEC                                                    CL**1
00456 *                                                                    CL**1
00457          EVALUATE TRUE                                               CL**1
00458              WHEN SQLCODE = -904                                     CL**1
00459              WHEN SQLCODE = -913                                     CL**1
00460              WHEN SQLCODE = ZERO                                     CL**1
00461              WHEN SQLCODE = +100                                     CL**1
00462                   CONTINUE                                           CL**1
00463              WHEN SQLWARN0 NOT EQUAL SPACE                           CL**1
00464              WHEN SQLCODE NOT EQUAL ZERO                             CL**1
00465                   MOVE '2100-RETRIEVE-DATA-FOR-PANEL'                CL**4
00466                                TO  DP013-PARAGRAPH                   CL**1
00467                   MOVE 'READ RSPLVL'                                 CL**1
00468                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00469                   MOVE SQLCA   TO  DP013-SQLCA                       CL**1
00470                   SET DP013-DB2-ABEND                                CL**1
00471                                TO  TRUE                              CL**1
00472                   PERFORM DP013-0000-PROCESS-ABEND                   CL**1
00473          END-EVALUATE                                                CL**1
00474      END-PERFORM.                                                    CL**1
00475 *                                                                    CL**1
00476      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL**1
00477          MOVE '2100-RETRIEVE-DATA-FOR-PANEL'                         CL**4
00478                                TO  DP013-PARAGRAPH                   CL**1
00479          MOVE 'MAX RETRIES EXCEEDED FOR READ APLSYS'                 CL**1
00480                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00481          MOVE SQLCA            TO  DP013-SQLCA                       CL**1
00482          SET DP013-DB2-ABEND   TO  TRUE                              CL**1
00483          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
00484      END-IF.                                                         CL**1
00485 *                                                                    CL**1
00486      MOVE RSPLVL-CDE           TO  MB130-LAST-RSPLVL-CODE            CL*19
00487                                    ARSPLVLO.                         CL*19
00488      IF  PS-SAVE-DATA                                                CL*33
00489          MOVE RSPLVL-DESC      TO  MB130-LAST-DESC                   CL*32
00490                                    ARSPDESO                          CL*32
00491      END-IF.                                                         CL*33
00492 *                                                                    CL*32
00493      IF (SQLCODE NOT EQUAL ZERO                                      CL*35
00494      AND NOT MB130-ADD-FUNCTION)                                     CL*35
00495          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER                  CL*22
00496          SET DP020-MSG-FATAL   TO  TRUE                              CL*21
00497      END-IF.                                                         CL**1
00498 *                                                                    CL**1
00499  EJECT                                                               CL**1
00500 ******************************************************************   CL**1
00501 *    VALIDATION HAS BEEN PERFORMED.  A NEW BUSINESS GROUP MAY        CL**1
00502 *    BE ADDED.                                                       CL**1
00503 *                                                                    CL**1
00504 *    PERFORMED BY 3000                                               CL**4
00505 ******************************************************************   CL**1
00506 *                                                                    CL**1
00507  2110-ADD-RSPLVL.                                                    CL**5
00508 *                                                                    CL**1
00509      PERFORM                                                         CL**1
00510          WITH TEST AFTER                                             CL**1
00511          VARYING PV-SQL-SUB                                          CL**1
00512          FROM 1 BY 1                                                 CL**1
00513          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL**1
00514             OR SQLCODE = 0                                           CL**1
00515 *                                                                    CL**1
00516          EXEC SQL                                                    CL**1
00517               INSERT INTO TRSPLVL                                    CL**1
00518                     (RSPLVL_CDE,                                     CL**1
00519                      RSPLVL_DESC)                                    CL**1
00520               VALUES                                                 CL**1
00521                     (:MB130-LAST-RSPLVL-CODE,                        CL*34
00522                      :MB130-LAST-DESC)                               CL*34
00523          END-EXEC                                                    CL**1
00524 *                                                                    CL**1
00525          EVALUATE TRUE                                               CL**1
00526              WHEN SQLCODE = -904                                     CL**1
00527              WHEN SQLCODE = -913                                     CL**1
00528              WHEN SQLCODE = ZERO                                     CL**1
00529                   CONTINUE                                           CL**1
00530              WHEN SQLWARN0 NOT EQUAL SPACE                           CL**1
00531              WHEN SQLCODE NOT EQUAL ZERO                             CL**1
00532                   MOVE '2110-ADD-RSPLVL'                             CL**5
00533                                TO  DP013-PARAGRAPH                   CL**1
00534                   MOVE 'ADD RSPLVL'                                  CL**1
00535                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00536                   MOVE SQLCA   TO  DP013-SQLCA                       CL**1
00537                   SET DP013-DB2-ABEND                                CL**1
00538                                TO  TRUE                              CL**1
00539                   PERFORM DP013-0000-PROCESS-ABEND                   CL**1
00540          END-EVALUATE                                                CL**1
00541      END-PERFORM.                                                    CL**1
00542 *                                                                    CL**1
00543      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL**1
00544          MOVE '2110-ADD-RSPLVL'                                      CL**5
00545                                TO  DP013-PARAGRAPH                   CL**1
00546          MOVE 'MAX RETRIES EXCEEDED FOR ADD RSPLVL'                  CL**1
00547                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00548          MOVE SQLCA            TO  DP013-SQLCA                       CL**1
00549          SET DP013-DB2-ABEND   TO  TRUE                              CL**1
00550          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
00551      END-IF.                                                         CL**1
00552 *                                                                    CL**1
00553      MOVE SPACES               TO  ARSPLVLO                          CL*14
00554                                    ARSPDESO                          CL*14
00555                                    MB130-LAST-AREA.                  CL*11
00556 *                                                                    CL**8
00557      MOVE PC-TSYMSG-00034      TO  DP020-MSG-NUMBER.                 CL**1
00558      SET DP020-MSG-INFORMATIONAL                                     CL**1
00559                                TO  TRUE.                             CL**1
00560 *                                                                    CL**1
00561  EJECT                                                               CL**1
00562 ******************************************************************   CL**1
00563 *    VALIDATION HAS BEEN PERFORMED.  THE CURRENT BUSINESS GROUP      CL**1
00564 *    IS TO BE DELETED.                                               CL**1
00565 *                                                                    CL**1
00566 *    PERFORMED BY 2160.                                              CL**5
00567 ******************************************************************   CL**1
00568 *                                                                    CL**1
00569  2120-DELETE-RSPLVL.                                                 CL**5
00570 *                                                                    CL**1
00571      PERFORM                                                         CL**1
00572          WITH TEST AFTER                                             CL**1
00573          VARYING PV-SQL-SUB                                          CL**1
00574          FROM 1 BY 1                                                 CL**1
00575          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL**1
00576             OR SQLCODE = 0                                           CL**1
00577             OR SQLCODE = +100                                        CL**1
00578 *                                                                    CL**1
00579          EXEC SQL                                                    CL**1
00580               DELETE FROM                                            CL**1
00581                     TRSPLVL                                          CL**1
00582               WHERE                                                  CL**1
00583                     RSPLVL_CDE   =  :MB130-LAST-RSPLVL-CODE          CL*34
00584          END-EXEC                                                    CL**1
00585 *                                                                    CL**1
00586          EVALUATE TRUE                                               CL**1
00587              WHEN SQLCODE = -904                                     CL**1
00588              WHEN SQLCODE = -913                                     CL**1
00589              WHEN SQLCODE = +100                                     CL**1
00590              WHEN SQLCODE = ZERO                                     CL**1
00591                   CONTINUE                                           CL**1
00592              WHEN SQLWARN0 NOT EQUAL SPACE                           CL**1
00593              WHEN SQLCODE NOT EQUAL ZERO                             CL**1
00594                   MOVE '2120-DELETE-RSPLVL'                          CL**5
00595                                TO  DP013-PARAGRAPH                   CL**1
00596                   MOVE 'DELETE RSPLVL'                               CL**1
00597                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00598                   MOVE SQLCA   TO  DP013-SQLCA                       CL**1
00599                   SET DP013-DB2-ABEND                                CL**1
00600                                TO  TRUE                              CL**1
00601                   PERFORM DP013-0000-PROCESS-ABEND                   CL**1
00602          END-EVALUATE                                                CL**1
00603      END-PERFORM.                                                    CL**1
00604 *                                                                    CL**1
00605      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL**1
00606          MOVE '2120-DELETE-RSPLVL'                                   CL**5
00607                                TO  DP013-PARAGRAPH                   CL**1
00608          MOVE 'MAX RETRIES EXCEEDED FOR DELETE RSPLVL'               CL**1
00609                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00610          MOVE SQLCA            TO  DP013-SQLCA                       CL**1
00611          SET DP013-DB2-ABEND   TO  TRUE                              CL**1
00612          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
00613      END-IF.                                                         CL**1
00614 *                                                                    CL**1
00615      IF  SQLCODE = ZERO                                              CL**1
00616          MOVE PC-TSYMSG-00115  TO  DP020-MSG-NUMBER                  CL*15
00617          SET DP020-MSG-INFORMATIONAL                                 CL*31
00618                                TO  TRUE                              CL*31
00619      ELSE                                                            CL**1
00620          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER                  CL*15
00621          SET DP020-MSG-FATAL   TO  TRUE                              CL*31
00622      END-IF.                                                         CL**1
00623 *                                                                    CL**1
00624 *                                                                    CL**1
00625  EJECT                                                               CL**1
00626 ******************************************************************   CL**1
00627 *    VALIDATION HAS BEEN PERFORMED.  THE CURRENT APPLICATION         CL**1
00628 *    SYSTEM CODE CAN BE UPDATED.                                     CL**1
00629 *                                                                    CL**1
00630 *    PERFORMED BY 3000.                                              CL**4
00631 ******************************************************************   CL**1
00632 *                                                                    CL**1
00633  2130-UPDATE-RSPLVL.                                                 CL**4
00634 *                                                                    CL**1
00635      PERFORM                                                         CL**1
00636          WITH TEST AFTER                                             CL**1
00637          VARYING PV-SQL-SUB                                          CL**1
00638          FROM 1 BY 1                                                 CL**1
00639          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL**1
00640             OR SQLCODE = 0                                           CL**1
00641             OR SQLCODE = +100                                        CL**1
00642 *                                                                    CL**1
00643          EXEC SQL                                                    CL**1
00644               UPDATE                                                 CL**1
00645                     TRSPLVL                                          CL**1
00646                 SET                                                  CL**1
00647                     RSPLVL_DESC      =  :MB130-LAST-DESC             CL*34
00648               WHERE                                                  CL**1
00649                     RSPLVL_CDE       =  :MB130-LAST-RSPLVL-CODE      CL*34
00650          END-EXEC                                                    CL**1
00651 *                                                                    CL**1
00652          EVALUATE TRUE                                               CL**1
00653              WHEN SQLCODE = -904                                     CL**1
00654              WHEN SQLCODE = -913                                     CL**1
00655              WHEN SQLCODE = +100                                     CL**1
00656              WHEN SQLCODE = ZERO                                     CL**1
00657                   CONTINUE                                           CL**1
00658              WHEN SQLWARN0 NOT EQUAL SPACE                           CL**1
00659              WHEN SQLCODE NOT EQUAL ZERO                             CL**1
00660                   MOVE '2130-UPDATE-RSPLVL'                          CL**4
00661                                TO  DP013-PARAGRAPH                   CL**1
00662                   MOVE 'UPDATE RSPLVL'                               CL**1
00663                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00664                   MOVE SQLCA   TO  DP013-SQLCA                       CL**1
00665                   SET DP013-DB2-ABEND                                CL**1
00666                                TO  TRUE                              CL**1
00667                   PERFORM DP013-0000-PROCESS-ABEND                   CL**1
00668          END-EVALUATE                                                CL**1
00669      END-PERFORM.                                                    CL**1
00670 *                                                                    CL**1
00671      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL**1
00672          MOVE '2130-UPDATE-RSPLVL'                                   CL**4
00673                                TO  DP013-PARAGRAPH                   CL**1
00674          MOVE 'MAX RETRIES EXCEEDED FOR UPDATE RSPLVL'               CL**1
00675                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00676          MOVE SQLCA            TO  DP013-SQLCA                       CL**1
00677          SET DP013-DB2-ABEND   TO  TRUE                              CL**1
00678          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
00679      END-IF.                                                         CL**1
00680 *                                                                    CL**1
00681      IF  SQLCODE EQUAL ZERO                                          CL**1
00682          MOVE PC-TSYMSG-00059  TO  DP020-MSG-NUMBER                  CL**1
00683          SET DP020-MSG-INFORMATIONAL                                 CL*31
00684                                TO  TRUE                              CL*31
00685      ELSE                                                            CL**1
00686          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER                  CL*15
00687          SET DP020-MSG-FATAL   TO  TRUE                              CL*31
00688      END-IF.                                                         CL**1
00689 *                                                                    CL**1
00690 *                                                                    CL**5
00691  EJECT                                                               CL**5
00692 ******************************************************************   CL**5
00693 *    READ THE TEMP STORAGE QUEUE, GET THE NEXT BUSINESS GROUP.       CL**5
00694 *    IF AT END, ISSUE MESSAGE, OTHERWISE CONTINUE PROCESSING.        CL**5
00695 *                                                                    CL**5
00696 *    PERFORMED BY 3000                                               CL**5
00697 ******************************************************************   CL**5
00698 *                                                                    CL**5
00699  2140-GET-NEXT-RSPLVL.                                               CL**5
00700 *                                                                    CL**5
00701      ADD 1                     TO  MB130-RL-SUB.                     CL**5
00702      IF  MB130-RL-SUB GREATER THAN MBWS129-MAX-RLEVELS               CL**5
00703          ADD 1                 TO  MB130-RL-ITEM                     CL**5
00704          MOVE 1                TO  MB130-RL-SUB                      CL**5
00705          PERFORM 2170-READ-LIST-QUEUE                                CL*18
00706          MOVE RSPLVL-LIST-RECORD                                     CL*18
00707                                TO  MB130-SAVE-TS-QUEUE               CL*18
00708      ELSE                                                            CL*18
00709          MOVE MB130-SAVE-TS-QUEUE                                    CL*18
00710                                TO  RSPLVL-LIST-RECORD                CL*18
00711      END-IF.                                                         CL**5
00712 *                                                                    CL**5
00713      IF  MBWS129-RLEVEL (MB130-RL-SUB) GREATER THAN SPACES           CL**5
00714          MOVE SPACES           TO  DCLTRSPLVL                        CL*32
00715          MOVE MBWS129-RLEVEL (MB130-RL-SUB)                          CL**5
00716                                TO  RSPLVL-CDE                        CL**5
00717          SET PS-SAVE-DATA      TO  TRUE                              CL*27
00718          PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                        CL**5
00719          MOVE DP015-GREEN      TO  ARSPDESC                          CL*40
00720          MOVE DP015-UNDERLINE  TO  ARSPDESH                          CL*40
00721      ELSE                                                            CL**5
00722          SUBTRACT 1          FROM  MB130-RL-SUB                      CL*23
00723          MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER                  CL*24
00724          SET DP020-MSG-INFORMATIONAL                                 CL*24
00725                                TO  TRUE                              CL*24
00726      END-IF.                                                         CL**5
00727 *                                                                    CL**5
00728  EJECT                                                               CL**5
00729 ******************************************************************   CL**5
00730 *    DETERMINE WHETHER THE DEPARTMENT DISCOUNT CODE IS ACTIVE.       CL**5
00731 *    IF IT IS, IT MAY NOT BE DELETED.                                CL**5
00732 *                     ---                                            CL**5
00733 *    PERFORMED BY C300                                               CL**5
00734 ******************************************************************   CL**5
00735 *                                                                    CL**5
00736  2150-ACTIVE-CHECK.                                                  CL**5
00737 *                                                                    CL**5
00738      PERFORM DP017-0000-GET-CURR-DATE-TIME.                          CL**5
00739      MOVE DP017-CURRENT-YMD-YYYY                                     CL**5
00740                                TO  PV-DD-CCYY.                       CL**5
00741      MOVE DP017-CURRENT-YMD-MONTH                                    CL**5
00742                                TO  PV-DD-MM.                         CL**5
00743      MOVE DP017-CURRENT-YMD-DAY                                      CL**5
00744                                TO  PV-DD-RL.                         CL**5
00745      SET PV-DD-DASH1           TO  TRUE.                             CL**5
00746      SET PV-DD-DASH2           TO  TRUE.                             CL**5
00747 *                                                                    CL**5
00748      PERFORM                                                         CL**5
00749          WITH TEST AFTER                                             CL**5
00750          VARYING PV-SQL-SUB                                          CL**5
00751          FROM 1 BY 1                                                 CL**5
00752          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL**5
00753             OR SQLCODE = 0                                           CL**5
00754             OR SQLCODE = +100                                        CL**5
00755 *                                                                    CL**5
00756          EXEC SQL                                                    CL**5
00757            SELECT                                                    CL**5
00758                   COUNT(DISTINCT R.RSPLVL_CDE)                       CL**5
00759            INTO                                                      CL**5
00760                  :PV-DB2-COUNT                                       CL**5
00761            FROM                                                      CL**5
00762                 TMDSEAR A,                                           CL**5
00763                 TRSPBAR R                                            CL**5
00764            WHERE                                                     CL**5
00765                  A.OPERCO_NBR    =  :PC-COMPANY                      CL**5
00766              AND R.MDSEAR_DKEY   =   A.MDSEAR_DKEY                   CL**5
00767              AND R.RSPLVL_CDE    =  :MB130-LAST-RSPLVL-CODE          CL*34
00768          END-EXEC                                                    CL**5
00769 *                                                                    CL**5
00770          EVALUATE TRUE                                               CL**5
00771              WHEN SQLCODE = -904                                     CL**5
00772              WHEN SQLCODE = -913                                     CL**5
00773              WHEN SQLCODE = ZERO                                     CL**5
00774              WHEN SQLCODE = +100                                     CL**5
00775                   CONTINUE                                           CL**5
00776              WHEN SQLWARN0 NOT EQUAL SPACE                           CL**5
00777              WHEN SQLCODE NOT EQUAL ZERO                             CL**5
00778                   MOVE '2150-ACTIVE-CHECK'                           CL*21
00779                                TO  DP013-PARAGRAPH                   CL**5
00780                   MOVE 'COUNT FUNCTION - RESPONSIBILTY CODE'         CL**5
00781                                TO  DP013-MESSAGE-TEXT (1)            CL**5
00782                   MOVE SQLCA   TO  DP013-SQLCA                       CL**5
00783                   SET DP013-DB2-ABEND                                CL**5
00784                                TO  TRUE                              CL**5
00785                   PERFORM DP013-0000-PROCESS-ABEND                   CL**5
00786          END-EVALUATE                                                CL**5
00787      END-PERFORM.                                                    CL**5
00788 *                                                                    CL**5
00789      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL**5
00790          MOVE '2150-ACTIVE-CHECK'                                    CL**5
00791                                TO  DP013-PARAGRAPH                   CL**5
00792          MOVE 'MAX RETRIES EXCEEDED FOR COUNT - ACTIVE CHECK'        CL**5
00793                                TO  DP013-MESSAGE-TEXT (1)            CL**5
00794          MOVE SQLCA            TO  DP013-SQLCA                       CL**5
00795          SET DP013-DB2-ABEND   TO  TRUE                              CL**5
00796          PERFORM DP013-0000-PROCESS-ABEND                            CL**5
00797      END-IF.                                                         CL**5
00798 *                                                                    CL**5
00799      IF  PV-DB2-COUNT GREATER THAN ZERO                              CL**5
00800          MOVE PC-TSYMSG-00149  TO  DP020-MSG-NUMBER                  CL*15
00801          SET PS-DONT-PROCESS   TO  TRUE                              CL*27
00802          SET DP020-MSG-FATAL   TO  TRUE                              CL*38
00803      ELSE                                                            CL**5
00804          MOVE PC-TSYMSG-00004  TO  DP020-MSG-NUMBER                  CL*26
00805          SET DP020-MSG-INFORMATIONAL                                 CL*38
00806                                TO  TRUE                              CL*38
00807      END-IF.                                                         CL**5
00808 *                                                                    CL**5
00809 *                                                                    CL**1
00810  EJECT                                                               CL**1
00811 ******************************************************************   CL**1
00812 *    READ THE TEMPORARY STORAGE QUEUE THAT CONTAINS THE SELECTED     CL**1
00813 *    RESPONSIBILITIES FROM MBKCS129 (RESPONSIBILITY LEVEL LIST).     CL*38
00814 *                                                                    CL**1
00815 *    PERFORMED BY 2000, 2140                                         CL**4
00816 ******************************************************************   CL**1
00817 *                                                                    CL**1
00818  2170-READ-LIST-QUEUE.                                               CL**5
00819 *                                                                    CL**1
00820      EXEC CICS                                                       CL**1
00821          READQ TS                                                    CL**1
00822          QUEUE(MB005-LIST-QUEUE-NAME)                                CL**1
00823          INTO(RSPLVL-LIST-RECORD)                                    CL**1
00824          LENGTH(MB005-LIST-QUEUE-LENGTH)                             CL**1
00825          ITEM(MB130-RL-ITEM)                                         CL**1
00826          RESP(PV-RESP)                                               CL**1
00827      END-EXEC.                                                       CL**1
00828 *                                                                    CL**1
00829      IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                           CL**1
00830          MOVE PV-RESP          TO  PM-RESP-22                        CL**1
00831          SET DP013-LOGIC-ABEND TO  TRUE                              CL**1
00832          SET DP013-NO-ROLLBACK TO  TRUE                              CL**1
00833          MOVE '2170-READ-LIST-QUEUE'                                 CL**5
00834                                TO  DP013-PARAGRAPH                   CL**1
00835          MOVE PM-PROGRAM-MESSAGE-22                                  CL**1
00836                                TO  DP013-MESSAGE-TEXT (1)            CL**1
00837          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
00838      END-IF.                                                         CL**1
00839 *                                                                    CL**7
00840  EJECT                                                               CL**7
00841 ******************************************************************   CL**7
00842 *    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.          CL**7
00843 *                                                                    CL**7
00844 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL**7
00845 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL**7
00846 ******************************************************************   CL**7
00847 *                                                                    CL**7
00848  2200-DISPLAY-PANEL.                                                 CL**7
00849 *                                                                    CL**7
00850      PERFORM DP017-0000-GET-CURR-DATE-TIME.                          CL**7
00851      MOVE DP017-EDITED-TIME-HMS                                      CL**7
00852                                TO  ATIMEO.                           CL**7
00853      IF  NOT DP020-MSG-FATAL                                         CL**7
00854          IF  MB130-ADD-FUNCTION                                      CL*27
00855              MOVE -1           TO  ARSPLVLL                          CL*14
00856              MOVE DP015-GREEN  TO  ARSPLVLC                          CL*14
00857              MOVE DP015-UNDERLINE                                    CL**7
00858                                TO  ARSPLVLH                          CL*14
00859          ELSE                                                        CL*10
00860              IF  MB130-UPDATE-FUNCTION                               CL*27
00861                  MOVE -1       TO  ARSPDESL                          CL*17
00862              END-IF                                                  CL*17
00863          END-IF                                                      CL*17
00864      END-IF.                                                         CL**7
00865 *                                                                    CL**7
00866      IF  MB130-ADD-FUNCTION                                          CL*27
00867          MOVE DP015-UNP-ALP-NOR-MDT                                  CL**7
00868                                TO  ARSPLVLA                          CL*14
00869      END-IF.                                                         CL**7
00870 *                                                                    CL**7
00871      IF  MB130-DELETE-FUNCTION                                       CL*27
00872          MOVE DP015-ASK-NOR-OFF                                      CL*17
00873                                TO  ARSPDESA                          CL*17
00874          MOVE DP015-BLUE       TO  ARSPDESC                          CL*17
00875          MOVE DP015-HL-OFF     TO  ARSPDESH                          CL*17
00876          MOVE -1               TO  ANAVCMDL                          CL*17
00877      END-IF.                                                         CL*17
00878 *                                                                    CL*17
00879      IF  PS-SEND-MAP-N-DATA-FRSET                                    CL**7
00880          PERFORM DP002-0000-FORMAT-TITLE-LINES                       CL**7
00881          PERFORM DP009-0000-LOAD-FK-LINES                            CL**7
00882      END-IF.                                                         CL**7
00883 *                                                                    CL**7
00884      PERFORM DP005-0000-FORMAT-MSG-LINES.                            CL**7
00885                                                                      CL**7
00886      PERFORM DP008-0000-WRITE-PANEL.                                 CL**7
00887 *                                                                    CL**4
00888  EJECT                                                               CL**4
00889 ******************************************************************   CL**4
00890 *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED     CL**4
00891 *    ON WHAT FUNCTION KEY WAS SELECTED.                              CL**4
00892 *                                                                    CL**4
00893 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL**4
00894 ******************************************************************   CL**4
00895 *                                                                    CL**4
00896  3000-PROCESS-PANEL.                                                 CL**4
00897 *                                                                    CL**4
00898      PERFORM DP007-0000-GET-PANEL.                                   CL**4
00899      SET PS-SEND-DATA-ONLY-FRSET                                     CL**4
00900                                TO TRUE.                              CL**4
00901 *                                                                    CL**9
00902      IF  (DP020-SRC-AID NOT EQUAL DP016-PF5                          CL**9
00903      AND  DP020-SRC-AID NOT EQUAL DP016-CLEAR)                       CL**9
00904          PERFORM 3200-MOVE-SCREEN-TO-COMMAREA                        CL**9
00905      END-IF.                                                         CL**9
00906 *                                                                    CL**9
00907      IF (MB130-CAN-CONFIRM                                           CL*36
00908      AND NOT DP020-FK-CONFIRM(DP020-SRC-AID))                        CL*36
00909          SET MB130-CANT-CONFIRM                                      CL*37
00910                                TO  TRUE                              CL*36
00911      END-IF.                                                         CL*36
00912      PERFORM 3100-CHECK-LOCAL-FKEYS.                                 CL**9
00913 *                                                                    CL**9
00914  EJECT                                                               CL**9
00915 ******************************************************************   CL**9
00916 *   DETERMINE THE PROCESSING PATH HERE.                              CL**9
00917 *                                                                    CL**9
00918 *   PERFORMED BY 3000.                                               CL**9
00919 ******************************************************************   CL**9
00920 *                                                                    CL**9
00921  3100-CHECK-LOCAL-FKEYS.                                             CL**9
00922 *                                                                    CL**9
00923      EVALUATE TRUE                                                   CL**4
00924 *                                                                    CL**4
00925          WHEN DP020-SRC-AID = DP016-CLEAR                            CL**4
00926              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL**4
00927              PERFORM 3400-MOVE-COMMAREA-TO-SCREEN                    CL**5
00928              IF  MB130-DELETE-FUNCTION                               CL*27
00929                  CONTINUE                                            CL*26
00930              ELSE                                                    CL*26
00931                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*26
00932              END-IF                                                  CL*26
00933              PERFORM 2200-DISPLAY-PANEL                              CL**5
00934 *                                                                    CL**5
00935          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                        CL**5
00936              MOVE SPACES       TO  ANAVCMDO                          CL*46
00937                                    ANAVKEYO                          CL*47
00938              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL*11
00939              IF  MB130-ADD-FUNCTION                                  CL*27
00940                  MOVE SPACES   TO  MB130-LAST-AREA                   CL*11
00941                  PERFORM 3400-MOVE-COMMAREA-TO-SCREEN                CL*11
00942              ELSE                                                    CL*11
00943                  SET PS-SAVE-DATA                                    CL*27
00944                                TO  TRUE                              CL*12
00945                  MOVE MB130-LAST-RSPLVL-CODE                         CL*11
00946                                TO  RSPLVL-CDE                        CL**5
00947                  PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                CL*11
00948                  MOVE PC-COMPANY                                     CL*13
00949                                TO  AOPERCOO                          CL*14
00950              END-IF                                                  CL*11
00951              PERFORM 2200-DISPLAY-PANEL                              CL**5
00952 *                                                                    CL**4
00953 *    "NEXT" PROCESSING - POSITION TO NEXT DEPARTMENT DISCOUNT CODE   CL**4
00954 *                                                                    CL**4
00955          WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)                 CL*25
00956              IF  MB130-ADD-FUNCTION                                  CL*27
00957                  MOVE PC-TSYMSG-00045                                CL*10
00958                                TO  DP020-MSG-NUMBER                  CL*10
00959                  SET DP020-MSG-FATAL                                 CL*10
00960                                TO  TRUE                              CL*10
00961                  MOVE -1       TO  ANAVCMDL                          CL*11
00962              ELSE                                                    CL*10
00963                  PERFORM 2140-GET-NEXT-RSPLVL                        CL*10
00964              END-IF                                                  CL*10
00965              PERFORM 2200-DISPLAY-PANEL                              CL*24
00966 *                                                                    CL**4
00967          WHEN DP020-SRC-AID = DP016-PA2                              CL**4
00968              PERFORM DP009-0000-LOAD-FK-LINES                        CL**4
00969              PERFORM DP017-0000-GET-CURR-DATE-TIME                   CL**4
00970              SET PS-SEND-DATA-ONLY                                   CL**4
00971                                TO  TRUE                              CL**4
00972              MOVE -1           TO  ANAVCMDL                          CL**4
00973              PERFORM DP008-0000-WRITE-PANEL                          CL**4
00974 *                                                                    CL**4
00975          WHEN DP020-FK-RETURN(DP020-SRC-AID)                         CL**4
00976               PERFORM 4000-NAVIGATE                                  CL*18
00977 *                                                                    CL*18
00978          WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                     CL*15
00979               PERFORM 4000-NAVIGATE                                  CL**4
00980 *                                                                    CL**4
00981          WHEN DP020-SRC-AID = DP016-ENTER                            CL**4
00982              IF  DP020-NAV-MNEMONIC GREATER THAN SPACES              CL**4
00983                  PERFORM 4000-NAVIGATE                               CL**4
00984              ELSE                                                    CL**4
00985                  IF  NOT MB130-DELETE-FUNCTION                       CL*39
00986                      PERFORM 3300-EDIT-DATA-IN-COMMAREA              CL*39
00987                  END-IF                                              CL*39
00988                  PERFORM 2200-DISPLAY-PANEL                          CL*39
00989              END-IF                                                  CL*39
00990 *                                                                    CL**4
00991 *    ADD FUNCTION                                                    CL**4
00992 *                                                                    CL**4
00993          WHEN DP020-SRC-AID = DP016-PF13                             CL**4
00994              IF  MB130-ADD-FUNCTION                                  CL*27
00995                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*10
00996                  IF  PS-CONTINUE                                     CL*27
00997                      PERFORM 2110-ADD-RSPLVL                         CL*10
00998                  END-IF                                              CL*10
00999              ELSE                                                    CL*10
01000                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*48
01001                  MOVE PC-TSYMSG-00045                                CL*10
01002                                TO  DP020-MSG-NUMBER                  CL*10
01003                  SET DP020-MSG-FATAL                                 CL*10
01004                                TO  TRUE                              CL*10
01005                  MOVE -1       TO  ANAVCMDL                          CL*11
01006              END-IF                                                  CL*10
01007              PERFORM 2200-DISPLAY-PANEL                              CL**4
01008 *                                                                    CL**4
01009 *    UPDATE FUNCTION                                                 CL**4
01010 *                                                                    CL**4
01011          WHEN DP020-SRC-AID = DP016-PF15                             CL*10
01012              IF  MB130-UPDATE-FUNCTION                               CL*27
01013                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*10
01014                  IF  PS-CONTINUE                                     CL*27
01015                      PERFORM 2130-UPDATE-RSPLVL                      CL*10
01016                  END-IF                                              CL*10
01017              ELSE                                                    CL*10
01018                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*48
01019                  MOVE PC-TSYMSG-00045                                CL*10
01020                                TO  DP020-MSG-NUMBER                  CL*10
01021                  SET DP020-MSG-FATAL                                 CL*10
01022                                TO  TRUE                              CL*10
01023                  MOVE -1       TO  ANAVCMDL                          CL*11
01024              END-IF                                                  CL*10
01025              PERFORM 2200-DISPLAY-PANEL                              CL**4
01026 *                                                                    CL**4
01027 *    DELETE FUNCTION                                                 CL**4
01028 *                                                                    CL**4
01029          WHEN DP020-SRC-AID = DP016-PF16                             CL**4
01030              IF  MB130-DELETE-FUNCTION                               CL*27
01031                  SET MB130-CAN-CONFIRM                               CL*36
01032                                TO  TRUE                              CL*36
01033                  MOVE MB130-LAST-RSPLVL-CODE                         CL*29
01034                                TO  RSPLVL-CDE                        CL*30
01035                  SET PS-DONT-SAVE-DATA                               CL*27
01036                                TO  TRUE                              CL*27
01037                  PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                CL*27
01038                  IF  SQLCODE EQUAL ZERO                              CL*27
01039                      PERFORM 2150-ACTIVE-CHECK                       CL*27
01040                  END-IF                                              CL*27
01041              ELSE                                                    CL*10
01042                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*48
01043                  MOVE PC-TSYMSG-00045                                CL*10
01044                                TO  DP020-MSG-NUMBER                  CL*10
01045                  SET DP020-MSG-FATAL                                 CL*10
01046                                TO  TRUE                              CL*10
01047                  MOVE -1       TO  ANAVCMDL                          CL*11
01048              END-IF                                                  CL*10
01049              PERFORM 2200-DISPLAY-PANEL                              CL**4
01050 *                                                                    CL*24
01051          WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                        CL*24
01052              IF  MB130-DELETE-FUNCTION                               CL*27
01053                  IF  MB130-CAN-CONFIRM                               CL*27
01054                      PERFORM 2150-ACTIVE-CHECK                       CL*24
01055                      IF  PS-CONTINUE                                 CL*27
01056                          PERFORM 2120-DELETE-RSPLVL                  CL*27
01057                      END-IF                                          CL*24
01058                  ELSE                                                CL*24
01059                      MOVE PC-TSYMSG-00118                            CL*26
01060                                TO  DP020-MSG-NUMBER                  CL*24
01061                      SET DP020-MSG-FATAL                             CL*24
01062                                TO  TRUE                              CL*24
01063                      MOVE -1   TO  ANAVCMDL                          CL*24
01064                  END-IF                                              CL*24
01065              ELSE                                                    CL*24
01066                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*48
01067                  MOVE PC-TSYMSG-00045                                CL*24
01068                                TO  DP020-MSG-NUMBER                  CL*24
01069                  SET DP020-MSG-FATAL                                 CL*24
01070                                TO  TRUE                              CL*24
01071                  MOVE -1       TO  ANAVCMDL                          CL*24
01072              END-IF                                                  CL*24
01073              PERFORM 2200-DISPLAY-PANEL                              CL*24
01074 *                                                                    CL**4
01075          WHEN OTHER                                                  CL**4
01076              PERFORM 3300-EDIT-DATA-IN-COMMAREA                      CL*45
01077              MOVE PC-TSYMSG-00045                                    CL*10
01078                                TO  DP020-MSG-NUMBER                  CL*10
01079              SET DP020-MSG-FATAL                                     CL*10
01080                                TO  TRUE                              CL*10
01081              MOVE -1           TO  ANAVCMDL                          CL*11
01082              PERFORM 2200-DISPLAY-PANEL                              CL**4
01083      END-EVALUATE.                                                   CL**4
01084 *                                                                    CL**4
01085  EJECT                                                               CL**4
01086 ******************************************************************   CL**4
01087 *    HERE WE SIMPLY MOVE THE DATA FROM THE SCREEN (WHERE PRESENT)    CL**5
01088 *    TO THE COMM AREA.                                               CL**5
01089 *                                                                    CL**4
01090 *    PERFORMED BY 3000                                               CL**4
01091 ******************************************************************   CL**4
01092 *                                                                    CL**4
01093  3200-MOVE-SCREEN-TO-COMMAREA.                                       CL**4
01094 *                                                                    CL**4
01095      IF (ARSPDESL GREATER THAN ZERO                                  CL*14
01096      OR  ARSPDESA EQUAL PC-ERASE-EOF)                                CL*14
01097          MOVE ARSPDESI         TO  MB130-LAST-DESC                   CL*14
01098      END-IF.                                                         CL**4
01099 *                                                                    CL**4
01100      IF (ARSPLVLL GREATER THAN ZERO                                  CL*14
01101      OR  ARSPLVLA EQUAL PC-ERASE-EOF)                                CL*14
01102          MOVE ARSPLVLI         TO  MB130-LAST-RSPLVL-CODE            CL*14
01103      END-IF.                                                         CL**4
01104 *                                                                    CL**4
01105  EJECT                                                               CL**4
01106 ******************************************************************   CL**4
01107 *    HERE WE SIMPLY ENSURE THE DESCRIPTION IS NOT SPACES, AND        CL**4
01108 *    IF ITS THE ADD FUNCTION, DON'T ALLOW A DUPLICATE KEY.           CL**4
01109 *                                                                    CL**4
01110 *    PERFORMED BY 3000, 3200.                                        CL**5
01111 ******************************************************************   CL**4
01112 *                                                                    CL**4
01113  3300-EDIT-DATA-IN-COMMAREA.                                         CL**4
01114 *                                                                    CL**4
01115      IF  NOT MB130-DELETE-FUNCTION                                   CL*48
01116          IF  MB130-LAST-DESC GREATER THAN SPACES                     CL*48
195300**         CHECK THE RESPONSIBILITY DESCRIPTION FIELD FOR                C
195300**         UNDERSCORES                                                   C
195400             MOVE ZERO TO PV-UNDERSCORE-COUNT                         RCK0
195500             INSPECT MB130-LAST-DESC                                  RCK0
195600                 TALLYING PV-UNDERSCORE-COUNT                         RCK0
195700                 FOR ALL '_'                                          RCK0
195800             IF PV-UNDERSCORE-COUNT > ZERO                               C
01180                  MOVE DP015-RED    TO  ARSPDESC                      CL*68
01181                  MOVE DP015-REVERSE                                  CL*68
01181                                    TO  ARSPDESH                      CL*68
01182                  MOVE -1           TO  ARSPDESL                      CL*68
01183                  SET DP020-MSG-FATAL                                 CL*68
01178                                    TO  TRUE                          CL*68
01184                  SET PS-DONT-PROCESS                                 CL*68
01178                                    TO  TRUE                          CL*68
196300***            ** AN UNDERSCORE (_) IS AN INVALID CHARACTER --       CL   
196400***               PLEASE REMOVE **                                   CL   
196500                 MOVE PC-TSYMSG-01643                                     
01185                                    TO  DP020-MSG-NUMBER              CL*68
01198              ELSE                                                 MBKCS105
01177                  MOVE DP015-GREEN  TO  ARSPDESC                      CL*68
01178                  MOVE DP015-UNDERLINE                                CL*68
01178                                    TO  ARSPDESH                      CL*68
196800             END-IF                                                       
01119          ELSE                                                        CL*48
01120              MOVE DP015-RED        TO  ARSPDESC                      CL*48
01121              MOVE DP015-REVERSE    TO  ARSPDESH                      CL*48
01122              MOVE -1               TO  ARSPDESL                      CL*48
01123              SET DP020-MSG-FATAL   TO  TRUE                          CL*48
01124              SET PS-DONT-PROCESS   TO  TRUE                          CL*48
01125              MOVE PC-TSYMSG-00007  TO  DP020-MSG-NUMBER              CL*48
01126          END-IF                                                      CL*48
01127      END-IF.                                                         CL*48
01128 *                                                                    CL**4
01129      IF  MB130-ADD-FUNCTION                                          CL*27
01130          IF  MB130-LAST-RSPLVL-CODE NOT GREATER THAN SPACES          CL**8
01131              MOVE DP015-RED    TO  ARSPLVLC                          CL*14
01132              MOVE DP015-REVERSE                                      CL**8
01133                                TO  ARSPLVLH                          CL*14
01134              MOVE -1           TO  ARSPLVLL                          CL*14
01135              SET DP020-MSG-FATAL                                     CL**8
01136                                TO  TRUE                              CL**8
01137              SET PS-DONT-PROCESS                                     CL*27
01138                                TO  TRUE                              CL**8
01139              MOVE PC-TSYMSG-00007                                    CL**9
01140                                TO  DP020-MSG-NUMBER                  CL**8
01141          ELSE                                                        CL**8
01142              MOVE MB130-LAST-RSPLVL-CODE                             CL**8
01143                                TO  RSPLVL-CDE                        CL**8
01144              SET PS-DONT-SAVE-DATA                                   CL*27
01145                                TO  TRUE                              CL**8
01146              PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                    CL**8
01147 *                                                                    CL**9
01148              IF  SQLCODE EQUAL ZERO                                  CL**8
01149                  MOVE DP015-RED                                      CL**8
01150                                TO  ARSPLVLC                          CL*14
01151                  MOVE DP015-REVERSE                                  CL**8
01152                                TO  ARSPLVLH                          CL*14
01153                  MOVE -1       TO  ARSPLVLL                          CL*14
01154                  SET DP020-MSG-FATAL                                 CL**8
01155                                TO  TRUE                              CL**8
01156                  SET PS-DONT-PROCESS                                 CL*27
01157                                TO  TRUE                              CL**8
01158                  MOVE PC-TSYMSG-00117                                CL*15
01159                                TO  DP020-MSG-NUMBER                  CL*15
01160              END-IF                                                  CL**9
01161          END-IF                                                      CL**9
01162      END-IF.                                                         CL**4
01163 *                                                                    CL**4
01164  EJECT                                                               CL**4
01165 ******************************************************************   CL**4
01166 *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.              CL**4
01167 *                                                                    CL**4
01168 *    PERFORMED BY 2000, 2140.                                        CL**4
01169 ******************************************************************   CL**4
01170 *                                                                    CL**4
01171  3400-MOVE-COMMAREA-TO-SCREEN.                                       CL**4
01172 *                                                                    CL**4
01173      MOVE MB130-LAST-RSPLVL-CODE                                     CL**4
01174                                TO  ARSPLVLO.                         CL*14
01175      MOVE MB130-LAST-DESC      TO  ARSPDESO.                         CL*14
01176      MOVE PC-COMPANY           TO  AOPERCOO.                         CL*14
01177 *                                                                    CL**4
01178  EJECT                                                               CL**4
01179 ******************************************************************   CL**4
01180 *    IF THE USER HITS A KEY THAT REQUIRES US TO GO TO ANOTHER        CL**4
01181 *    TRANSACTION, SAVE THE INTER APPLICATION COMMUNICATIONS AREA     CL**4
01182 *    AND START THE NAVIGATOR.                                        CL**4
01183 *                                                                    CL**4
01184 *    PERFORMED BY 3000                                               CL**4
01185 ******************************************************************   CL**4
01186 *                                                                    CL**4
01187  4000-NAVIGATE.                                                      CL**4
01188 *                                                                    CL**4
01189      COMPUTE MB005-NUMBER-PROCESSED-ITEMS =                          CL*23
01190            ((MB130-RL-ITEM - 1) * MBWS129-MAX-RLEVELS) +             CL*23
01191              MB130-RL-SUB.                                           CL*23
01192 *                                                                    CL*23
01193      MOVE MB005-INTER-APPL-COMMAREA                                  CL**4
01194                                TO  MB130-SAVE-INTER-APPL-COMMAREA.   CL**4
01195      PERFORM DP015-1000-START-NAVIGATOR.                             CL**4
01196 *                                                                    CL*41
01197  EJECT                                                               CL*41
01198 ******************************************************************   CL*41
01199 *    ENSURE WE ENTERED THIS PROGRAM ACCORDING TO HOYLE.              CL*41
01200 *                                                                    CL*41
01201 *    PERFORMED BY 1000                                               CL*41
01202 ******************************************************************   CL*41
01203 *                                                                    CL*41
01204  4100-VALIDATE-COMMAREA.                                             CL*41
01205 *                                                                    CL*41
01206      IF  DP020-MB-RESP-LEVEL-LIST                                    CL*41
01207          SET PS-INTER-APPL-VALID                                     CL*41
01208                                TO  TRUE                              CL*41
01209      ELSE                                                            CL*41
01210          SET PS-INTER-APPL-NOT-VALID                                 CL*41
01211                                TO  TRUE                              CL*41
01212      END-IF.                                                         CL*41
01213 *                                                                    CL**1
01214  EJECT                                                               CL**1
01215 ******************************************************************   CL**1
01216 *    FILL IN SCREEN HEADER MODULE                                    CL**1
01217 ******************************************************************   CL**1
01218                                                                      CL**1
01219      COPY DPPD002.                                                   CL**1
01220  EJECT                                                               CL**1
01221 ******************************************************************   CL**1
01222 *    RETURN TO CICS MODULE                                           CL**1
01223 ******************************************************************   CL**1
01224                                                                      CL**1
01225      COPY DPPD003.                                                   CL**1
01226  EJECT                                                               CL**1
01227 ******************************************************************   CL**1
01228 *    FORMAT MESSAGE LINES MODULE                                     CL**1
01229 ******************************************************************   CL**1
01230                                                                      CL**1
01231      COPY DPPD005.                                                   CL**1
01232  EJECT                                                               CL**1
01233 ******************************************************************   CL**1
01234 *    GET PANEL MODULE                                                CL**1
01235 ******************************************************************   CL**1
01236                                                                      CL**1
01237      COPY DPPD007.                                                   CL**1
01238  EJECT                                                               CL**1
01239 ******************************************************************   CL**1
01240 *    WRITE PANEL MODULE                                              CL**1
01241 ******************************************************************   CL**1
01242                                                                      CL**1
01243      COPY DPPD008.                                                   CL**1
01244  EJECT                                                               CL**1
01245 ******************************************************************   CL**1
01246 *    TOGGLE THE FUNCTION KEY LINE MODULE                             CL**1
01247 ******************************************************************   CL**1
01248                                                                      CL**1
01249      COPY DPPD009.                                                   CL**1
01250  EJECT                                                               CL**1
01251 ******************************************************************   CL**1
01252 *    ABEND PROCESSOR MODULE                                          CL**1
01253 ******************************************************************   CL**1
01254                                                                      CL**1
01255      COPY DPPD013.                                                   CL**1
01256  EJECT                                                               CL**1
01257 ******************************************************************   CL**1
01258 *    CHECK COMMUNICATION AREA MODULE                                 CL**1
01259 ******************************************************************   CL**1
01260                                                                      CL**1
01261      COPY DPPD015.                                                   CL**1
01262  EJECT                                                               CL**1
01263 ******************************************************************   CL**1
01264 *    UPDATE TIME AND DATE MODULE                                     CL**1
01265 ******************************************************************   CL**1
01266                                                                      CL**1
01267      COPY DPPD017.                                                   CL**1
01268  EJECT                                                               CL**1
