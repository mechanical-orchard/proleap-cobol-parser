000010******************************************************************00001001
000020*    I M P O R T A N T                                           *00002001
000030*                                                                *00003001
000040* This is a copy of SUKCS583 - this version does NOT have any    *00004001
000050* database updates.                                              *00005001
000060*                                                                *00006001
000070* Any changes to SUKCS583 must also be made to SUKCS752.         *00007001
000080*                                                                *00008001
000090* This module will be used for the Mainframe Modernization       *00009001
000091* process to determine if the carton will need to be audited     *00009101
000092* or not.  Initial process will NOT select any orders in an      *00009201
000093* audit group that will need cartons audited.                    *00009301
000094*                                                                *00009401
000095* removed paragraphs:                                            *00009501
000096*    8300-INSERT-TSUNAUD                                         *00009601
000097*    8350-INSERT-TSUATRN                                         *00009701
000098*    8400-INSERT-PO-AUD-REQ                                      *00009801
000099*    8410-CHK-IF-RFID-AUDIT-EXISTS                               *00009901
000100*    8420-UPDATE-RWK-NO                                          *00010001
000101*    8700-UPDATE-SUT-PO-AUD-REQ                                  *00010101
000102*                                                                *00010201
000103*    1490-UPDATE-REQ-BY-TYPE                                     *00010301
000104*    1620-CREATE-RANDOM-NBR                                      *00010401
000105*    1640-BUILD-TSUNAUD                                          *00010501
000106*    1660-BUILD-TSUATRN                                          *00010601
000107*    1680-BUILD-SUT-PO-AUD-REQ                                   *00010701
000108*    8550-VALIDATE-AUDIT-NBR                                     *00010801
000109*                                                                *00010901
000110******************************************************************00011001
000120******************************************************************00012001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400 PROGRAM-ID.             SUKCS752.                                00040001
000500 AUTHOR.                 LARRY SCHLEICHER.                        00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060001
000700 DATE-WRITTEN            NOV, 2001.                               00070001
000800 DATE-COMPILED.                                                   00080001
000900******************************************************************00090001
001000* THIS PROGRAM WILL DETERMINE IF A CARTON NEED TO BE AUDITED      00100001
001100* USING THE PARAMETERS SET UP FOR THE VENDOR.                     00110001
001101******************************************************************00110101
001102* 11/05/2013  CHERI PARMLEY                                      *00110201
001103*             INCLUDE THE PACKING TYPE THE SELECT OF THE         *00110301
001104*             SUT_PO_AUD_REQ TABLE.                              *00110401
001105* 01/06/2014  GERMAN BANDA                                       *00110501
001106*             INCLUDE THE FOLLOWING LINE IN CURSOR FOR 8410-     *00110601
001107*             AND  CART_PRMPT_CDE NOT IN ('D','F')                00110701
001108*                                                                *00110801
001109*             PARA 8410- AND 8420- WERE ADDED TO SEE IF THERE    *00110901
001110*             WAS AN RFID AUDIT DONE, AND THEN POPULATE THE      *00111001
001111*             REWORK # IF THE RFID AUDIT ALSO REFERS TO THE QC   *00111101
001112*             AUDIT (COMBO)                                      *00111201
001113*                                                                *00111301
001114*             INTRODUCE NEW AUDIT TYPE - SUT00014-AUD-TYP-CDE = R*00111401
001115*             THIS IS USED IN THE PO EXCEPTION LOGIC REGARDLESS  *00111501
001116*             IF ITS RFID, IT WILL CHECK IF PO EXCEPTION AND IF  *00111601
001117*             FOUND SEND % BACK TO RECEIVING PROGRAMS FOR 100%   *00111701
001118*             AUDIT REQUIRED. LOGIC IN 1700-                     *00111801
001119******************************************************************00111901
001120 ENVIRONMENT DIVISION.                                            00112001
001121 DATA DIVISION.                                                   00112101
001122******************************************************************00112201
001123 WORKING-STORAGE SECTION.                                         00112301
001124                                                                  00112401
001125 01  DK-DB2-KEYS.                                                 00112501
001126     05  DK-PO-NBR                PIC S9(09)  COMP.               00112601
001127     05  DK-PO-LINE-NBR           PIC S9(09)  COMP.               00112701
001128     05  DK-PO-DRIVER-LINE        PIC S9(09)  COMP.               00112801
001129     05  DK-SHUUPC-LNE-NBR        PIC S9(09)  COMP.               00112901
001130     05  DK-PREPK-ID              PIC S9(04)  COMP.               00113001
001140     05  DK-OPER-UNT-ID           PIC S9(04)  COMP.               00114001
001150     05  DK-INBND-TRIP-ID         PIC S9(09)  COMP.               00115001
001160     05  DK-RCVR-SEQ-NBR          PIC S9(09)  COMP.               00116001
001170     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00117001
001180     05  DK-ENT-ID                PIC S9(09)  COMP.               00118001
001190     05  DK-DEPT-NBR              PIC S9(04)  COMP-4.             00119001
001200     05  DK-PKGNG-TYP-CDE         PIC  X(02).                     00120001
001300     05  DK-AUDIT-CNTL-NBR        PIC S9(09) COMP.                00130001
001400     05  DK-RFID-AUD-CNTL-NBR     PIC S9(09) COMP.                00140001
001410     05  DK-BYPASS-PO-NBR         PIC S9(09)  COMP.               00141001
001420     05  DK-BYPASS-REC-SEQ-NBR    PIC S9(09)  COMP.               00142001
001430                                                                  00143001
001440 01  DN-DB2-NULL-INDICATORS.                                      00144001
001450     05  DN-SUM-NULL                PIC S9(04) COMP VALUE ZEROES. 00145001
001460     05  DN-SUM-NULL-UPC            PIC S9(04) COMP VALUE ZEROES. 00146001
001470*                                                                 00147001
001480*----------------------------------------------------------------*00148001
001490* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00149001
001500*----------------------------------------------------------------*00150001
001600     COPY SURD021.                                                00160001
001700                                                                  00170001
001800******************************************************************00180001
001900*  RANDOM NUMBER AREA.                                            00190001
002000******************************************************************00200001
002100     COPY DPWS902.                                                00210001
002200                                                                  00220001
002300******************************************************************00230001
002400*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00240001
002500******************************************************************00250001
002600     COPY DPWS013.                                                00260001
002700                                                                  00270001
002800*----------------------------------------------------------------*00280001
002900*  PROGRAM CONSTANTS                                             *00290001
003000*----------------------------------------------------------------*00300001
003100 01  PC-PROGRAM-CONSTANTS.                                        00310001
003200     05  PC-F                     PIC  X(01)  VALUE 'F'.          00320001
003300     05  PC-P                     PIC  X(01)  VALUE 'P'.          00330001
003400     05  PC-I                     PIC  X(01)  VALUE 'I'.          00340001
003500     05  PC-N                     PIC  X(01)  VALUE 'N'.          00350001
003600     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00360001
003700     05  PC-A                     PIC  X(01)  VALUE 'A'.          00370001
003800     05  PC-D                     PIC  X(01)  VALUE 'D'.          00380001
003900     05  PC-C                     PIC  X(01)  VALUE 'C'.          00390001
004000     05  PC-R                     PIC  X(01)  VALUE 'R'.          00400001
004100     05  PC-Q                     PIC  X(01)  VALUE 'Q'.          00410001
004200     05  PC-IP                    PIC  X(02)  VALUE 'IP'.         00420001
004300     05  PC-02                    PIC  X(02)  VALUE '02'.         00430001
004400     05  PC-DEFAULT               PIC  X(06)  VALUE 'DEFALT'.     00440001
004500     05  PC-DEFAULT-DATE          PIC  X(26)  VALUE               00450001
004600                                  '9999-09-09-09.09.09.999999'.   00460001
004700     05  PC-RANDOM-NBR-GENERATOR  PIC  X(08)  VALUE 'DPKUT902'.   00470001
004800     05  PC-LOG-QUEUE             PIC  X(04)  VALUE 'CSSL'.       00480001
004900     05  PC-LOG-QUEUE-2           PIC  X(04)  VALUE 'CSSL'.       00490001
005000     05  PC-MSG-TABLE-SIZE            PIC S9(03) COMP-3 VALUE 200.00500001
005100     05  PC-100                       PIC  9(03)V99     VALUE 100.00510001
005200     05  PC-LOGON-TRAN-ID                PIC  X(04)  VALUE 'Z028'.00520001
005300                                                                  00530001
005400*----------------------------------------------------------------*00540001
005500*  PROGRAM SWITCHES                                              *00550001
005600*----------------------------------------------------------------*00560001
005700 01  PS-PROGRAM-SWITCHES.                                         00570001
005800     05  PS-CARTON-ALREADY-EXISTS-SW     PIC  X(01)  VALUE 'N'.   00580001
005900         88  PS-CARTON-ALREADY-EXISTS                VALUE 'Y'.   00590001
006000         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   00600001
006100     05  PS-SHOW-DEBUG-SW                PIC  X(01)  VALUE 'N'.   00610001
006200         88  PS-DONT-SHOW-DEBUG-INFO                 VALUE 'N'.   00620001
006300         88  PS-SHOW-DEBUG-INFO                      VALUE 'Y'.   00630001
006400     05  PS-REQ-REC-FOUND-SW             PIC  X(01)  VALUE 'N'.   00640001
006500         88  PS-REQ-REC-FOUND                        VALUE 'Y'.   00650001
006600         88  PS-NO-REQ-REC-FOUND                     VALUE 'N'.   00660001
006700     05  PS-RFID-REC-FOUND-SW            PIC  X(01)  VALUE 'N'.   00670001
006800         88  PS-RFID-REC-FOUND                       VALUE 'Y'.   00680001
006900         88  PS-NO-RFID-REC-FOUND                    VALUE 'N'.   00690001
007000     05  PS-NO-AUDIT-STARTED-SW          PIC  X(01)  VALUE 'N'.   00700001
007100         88  PS-AUDIT-STARTED                        VALUE 'Y'.   00710001
007200         88  PS-NO-AUDIT-STARTED                     VALUE 'N'.   00720001
007300     05  PS-DEPT-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   00730001
007400         88  PS-DEPT-RANK-FOUND                      VALUE 'Y'.   00740001
007500         88  PS-NO-DEPT-RANK-FOUND                   VALUE 'N'.   00750001
007600     05  PS-PASSED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   00760001
007700         88  PS-PASSED-AUDITS-FOUND                  VALUE 'Y'.   00770001
007800         88  PS-NO-PASSED-AUDITS-FOUND               VALUE 'N'.   00780001
007900     05  PS-FAILED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   00790001
008000         88  PS-FAILED-AUDITS-FOUND                  VALUE 'Y'.   00800001
008100         88  PS-NO-FAILED-AUDITS-FOUND               VALUE 'N'.   00810001
008200     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   00820001
008300         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   00830001
008400         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   00840001
008500     05  PS-VEND-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   00850001
008600         88  PS-VEND-RANK-FOUND                      VALUE 'Y'.   00860001
008700         88  PS-NO-VEND-RANK-FOUND                   VALUE 'N'.   00870001
008800     05  PS-DEFAULT-RANK-FOUND-SW        PIC  X(01)  VALUE 'N'.   00880001
008900         88  PS-DEFAULT-RANK-FOUND                   VALUE 'Y'.   00890001
009000         88  PS-NO-DEFAULT-RANK-FOUND                VALUE 'N'.   00900001
009100     05  PS-PO-INFO-FOUND-SW             PIC  X(01)  VALUE 'N'.   00910001
009200         88  PS-PO-INFO-FOUND                        VALUE 'Y'.   00920001
009300         88  PS-NO-PO-INFO-FOUND                     VALUE 'N'.   00930001
009400     05  PS-LINE-LEVEL-FOUND-SW          PIC  X(01)  VALUE 'N'.   00940001
009500         88  PS-LINE-LEVEL-FOUND                     VALUE 'Y'.   00950001
009600         88  PS-NO-LINE-LEVEL-FOUND                  VALUE 'N'.   00960001
009700     05  PS-PO-LEVEL-FOUND-SW            PIC  X(01)  VALUE 'N'.   00970001
009800         88  PS-PO-LEVEL-FOUND                       VALUE 'Y'.   00980001
009900         88  PS-NO-PO-LEVEL-FOUND                    VALUE 'N'.   00990001
010000     05  PS-AUDIT-IS-REQUIRED-SW         PIC  X(01)  VALUE 'N'.   01000001
010100         88  PS-AUDIT-IS-REQUIRED                    VALUE 'Y'.   01010001
010200         88  PS-AUDIT-IS-NOT-REQUIRED                VALUE 'N'.   01020001
010300     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01030001
010400         88  PS-ERROR                                VALUE 'Y'.   01040001
010500         88  PS-ERROR-NO                             VALUE 'N'.   01050001
010600     05  PS-DUMP-TO-LOG-SW               PIC X(01)   VALUE 'N'.   01060001
010700         88  PS-DONT-DUMP-TO-LOG                     VALUE 'N'.   01070001
010800         88  PS-DUMP-TO-LOG                          VALUE 'Y'.   01080001
010900     05  PS-BLD-INTERNAL-TABLE-SW     PIC  X(01) VALUE 'N'.       01090001
011000         88  PS-BLD-INTERNAL-TABLE-YES           VALUE 'Y'.       01100001
011100         88  PS-BLD-INTERNAL-TABLE-NO            VALUE 'N'.       01110001
011200     05  PS-BYPASS-PROMPT-AUDIT-SW       PIC  X(01)  VALUE 'N'.   01120001
011300         88  PS-BYPASS-PROMPT-AUDIT                  VALUE 'Y'.   01130001
011400         88  PS-BYPASS-PROMPT-AUDIT-NO               VALUE 'N'.   01140001
011500                                                                  01150001
011600*----------------------------------------------------------------*01160001
011700*  PROGRAM VARIABLES                                             *01170001
011800*----------------------------------------------------------------*01180001
011900 01  PV-PROGRAM-VARIABLES.                                        01190001
012000                                                                  01200001
012100     05  PV-DISPLAY-AUDIT                PIC 9(09).               01210001
012110     05  PV-DISPLAY-PO-NBR               PIC 9(09).               01211001
012120     05  PV-DISPLAY-PO-LINE-NBR          PIC 9(04).               01212001
012130     05  PV-DISPLAY-PREPK-ID             PIC 9(04).               01213001
012140     05  PV-DISPLAY-PREPK                PIC 9(04).               01214001
012150     05  PV-DISPLAY-OPER-UNT-ID          PIC 9(04).               01215001
012160     05  PV-DISPLAY-OPER                 PIC 9(04).               01216001
012170     05  PV-DISPLAY-INBND-TRIP-ID        PIC 9(09).               01217001
012180     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 9(09).               01218001
012190     05  PV-DISPLAY-SHIPT-UNT-ID         PIC 9(18).               01219001
012200     05  PV-DISPLAY-ENT-ID               PIC 9(09).               01220001
012300     05  PV-DISPLAY-DEPT-NBR             PIC 9(04).               01230001
012400     05  PV-DISPLAY-CK-AFT-DAY-QTY       PIC 9(04).               01240001
012500     05  PV-DISPLAY-LIMIT-DAYS           PIC 9(09).               01250001
012600     05  PV-DISPLAY-TASK                 PIC 9(07).               01260001
012700     05  PV-DISPLAY-MSG-NBR              PIC 9(03).               01270001
012800                                                                  01280001
012810     05  PV-DISP-THIN1                   PIC -999.99.             01281006
012820     05  PV-DISP-THIN2                   PIC  Z,ZZ9.              01282006
012830     05  PV-DISP-THIN3                   PIC ZZZ,ZZZ,ZZ9.         01283006
012840     05  PV-DISP-THIN4                   PIC  Z,ZZ9.              01284006
012850     05  PV-DISP-THIN5                   PIC  Z,ZZ9.              01285006
012860                                                                  01286006
012900     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACES.01290001
013000     05  PV-CICS-MSG-AREA-3              PIC  X(125) VALUE SPACES.01300001
013100                                                                  01310001
013200     05  PV-DISP-OPER                    PIC 9(04).               01320001
013300     05  PV-DISP-PO                      PIC 9(09).               01330001
013400     05  PV-DISP-RCVR                    PIC 9(04).               01340001
013500     05  PV-DISP-LINE                    PIC 9(04).               01350001
013501     05  PV-DISP-PREPK                   PIC 9(04).               01350101
013502     05  PV-DISP-SQL                     PIC -999.                01350201
013503     05  PV-DISP-SSCC                    PIC 9(18).               01350301
013504     05  PV-DISP-ENTID                   PIC 9(09).               01350401
013505     05  PV-DISP-DEPT                    PIC 9(04).               01350501
013506     05  PV-DISP-TRIP                    PIC 9(04).               01350601
013507     05  PV-CICS-MSG-AREA-D              PIC  X(120) VALUE SPACES.01350701
013508                                                                  01350801
013509     05  PV-PASSED-COUNT                 PIC S9(4)  COMP.         01350901
013510     05  PV-PROMPTED-CNT                 PIC S9(4)  COMP.         01351001
013520     05  PV-DB2-COUNT-EXP-SCN            PIC S9(4)  VALUE +0      01352001
013530                                                    COMP.         01353001
013540     05  PV-CARTONS-TO-AUDIT             PIC S9(9)  VALUE +0      01354001
013550                                                    COMP.         01355001
013560     05  PV-UNITS-TO-AUDIT               PIC S9(9)  VALUE +0      01356001
013570                                                    COMP.         01357001
013580     05  PV-TOTAL-CARTONS                PIC S9(9)  VALUE +0      01358001
013590                                                    COMP.         01359001
013600     05  PV-CHECK-IN-COUNT               PIC S9(9)  VALUE +0      01360001
013700                                                    COMP.         01370001
013800     05  PV-TOTAL-UNITS                  PIC S9(9)  VALUE +0      01380001
013900                                                    COMP.         01390001
014000     05  PV-SUM-EXPTD-ALLOC              PIC S9(9)  VALUE +0      01400001
014100                                                    COMP.         01410001
014200     05  PV-SUM-OF-ALL-LINES             PIC S9(9)  VALUE +0      01420001
014300                                                    COMP.         01430001
014400     05  PV-AUDIT-CNTL-NBR-X             PIC  X(09) VALUE SPACE.  01440001
014500     05  PV-AUDIT-CNTL-NBR  REDEFINES                             01450001
014600         PV-AUDIT-CNTL-NBR-X             PIC  9(09).              01460001
014700     05  PV-LIMIT-DAYS                   PIC S9(09) COMP.         01470001
014800     05  PV-SHPD-QTY-SUM                 PIC S9(09) COMP-3.       01480001
014900     05  PV-CARTON-COUNT                 PIC S9(09) COMP.         01490001
015000     05  PV-CICS-MSG-AREA                PIC  X(125) VALUE SPACE. 01500001
015100     05  PV-CICS-RESPONSE                PIC S9(08) VALUE ZEROS   01510001
015200                                                    COMP SYNC.    01520001
015300     05  PV-EIBTASKN                     PIC Z(06)9.              01530001
015400     05  PV-PREV-SEQUENCE                PIC S9(05) COMP-3        01540001
015500                                                     VALUE ZERO.  01550001
015600     05  PV-NEXT-SEQUENCE                PIC S9(05) COMP-3        01560001
015700                                                     VALUE ZERO.  01570001
015800     05  PV-UNT-QTY                      PIC  9(05)V99.           01580001
015900     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 01590001
016000     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   01600001
016100                                                     COMP.        01610001
016200     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   01620001
016300                                                     COMP SYNC.   01630001
016400     05  PV-CSSL-PARA                    PIC  X(04) VALUE SPACES. 01640001
016500     05  PV-PARM-SECONDS                 PIC S9(09) COMP VALUE 0. 01650001
016600                                                                  01660001
016700     05  PV-INIT-TIMESTAMP               PIC  X(26) VALUE SPACES. 01670001
016800     05  PV-INIT-TIMESTAMP-R REDEFINES PV-INIT-TIMESTAMP.         01680001
016900         10  FILLER                      PIC  X(11).              01690001
017000         10  PV-INIT-HH                  PIC  9(02).              01700001
017100         10  FILLER                      PIC  X(01).              01710001
017200         10  PV-INIT-MM                  PIC  9(02).              01720001
017300         10  FILLER                      PIC  X(01).              01730001
017400         10  PV-INIT-SS                  PIC  9(02).              01740001
017410         10  FILLER                      PIC  X(07).              01741001
017420     05  PV-INIT-TIME-KEY.                                        01742001
017430         10  PV-INIT-KEY-HH              PIC  9(02).              01743001
017431         10  PV-INIT-KEY-MM              PIC  9(02).              01743101
017432         10  PV-INIT-KEY-SS              PIC  9(02).              01743201
017433     05  PV-DURATION-SEC                 PIC S9(09) COMP VALUE 0. 01743301
017434     05  PV-DISP-DURATION                PIC  9(09)   VALUE ZEROS.01743401
017435     05  PV-DISP-PARM-SECONDS            PIC  9(09)   VALUE ZEROS.01743501
017436     05  PV-DURATION-NANO-SEC            PIC S9(10) COMP VALUE 0. 01743601
017437     05  PV-WORK-NANO-SEC                PIC  9(10) VALUE ZEROES. 01743701
017438     05  PV-WORK-NANO-SEC-REDEF REDEFINES PV-WORK-NANO-SEC.       01743801
017439         10  PV-WORK-NANO-MIN-1-2        PIC  9(02).              01743901
017440         10  PV-WORK-NANO-SEC-3-4        PIC  9(02).              01744001
017450         10  PV-WORK-NANO-MICRO-5-10     PIC  9(06).              01745001
017460     05  PV-DISP-NANO-SEC                PIC  X(12).              01746001
017470     05  PV-DISP-NANO-SEC-REDEF REDEFINES PV-DISP-NANO-SEC.       01747001
017480         10  PV-DISP-NANO-MIN-1-2        PIC  9(02).              01748001
017490         10  PV-DISP-NANO-DASH-1         PIC  X(01).              01749001
017500         10  PV-DISP-NANO-SEC-3-4        PIC  9(02).              01750001
017510         10  PV-DISP-NANO-DASH-2         PIC  X(01).              01751001
017511         10  PV-DISP-NANO-MICRO-5-10     PIC  9(06).              01751101
017512     05  PV-CURRENT-PARA-TMST            PIC  X(26).              01751201
017513                                                                  01751301
017514     05  PV-DISP-DRVR-LINE               PIC  9(04) value zeros.  01751401
017515     05  PV-DISP-AUDIT                   PIC  9(09) value zeros.  01751501
017516     05  PV-DISP-RFID-AUDIT              PIC  9(09) value zeros.  01751601
017517     05  PV-DISP-SQLCODE                 PIC  -999  value zeros.  01751701
017518                                                                  01751801
017519                                                                  01751901
017520*----------------------------------------------------------------*01752001
017530* PARAGRAPH TRACKING TABLE - USED FOR DEBUGGING                  *01753001
017531* WILL TRACK PARAGRAPHS IN THIS TABLE - IF WE SEE TRANSACTION    *01753101
017532* IF TAKING LONGER THEN X SECONDS TO RESPOND, WILL DUMP THE      *01753201
017533* TABLE TO CSSL                                                  *01753301
017534* PARM PATIM5                                                    *01753401
017535*----------------------------------------------------------------*01753501
017536 01  PT-PARA-TRACKING-TABLE.                                      01753601
017537     05  PT-ENTRIES               OCCURS 1500 TIMES               01753701
017538                                  INDEXED BY PT-TRACK-IDX.        01753801
017539         10 PT-TRACK-ENTRY.                                       01753901
017540             15 FILLER            PIC  X(01) VALUE SPACE.         01754001
017541             15 PT-PROGRAM        PIC  X(08) VALUE 'SUKCS771'.    01754101
017542             15 FILLER            PIC  X(01) VALUE SPACE.         01754201
017543             15 pt-dc             PIC  9(04) VALUE zeroes.        01754301
017544             15 filler            PIC  X(01) VALUE '-'.           01754401
017545             15 PT-sscc           PIC  9(18) VALUE zeroes.        01754501
017546             15 filler            PIC  X(01) VALUE '-'.           01754601
017547             15 pt-start-hhmmss   PIC  9(06) VALUE zeroes.        01754701
017548             15 FILLER            PIC  X(01) VALUE SPACE.         01754801
017549             15 PT-INDEX-NBR      PIC  9(05) VALUE ZEROES.        01754901
017550             15 FILLER            PIC  X(01) VALUE SPACE.         01755001
017551             15 PT-paragraph      PIC  X(04) VALUE SPACE.         01755101
017552             15 FILLER            PIC  X(01) VALUE SPACE.         01755201
017553             15 PT-TIMESTAMP      PIC  X(26) VALUE SPACE.         01755301
017554             15 FILLER            PIC  X(01) VALUE SPACE.         01755401
017555             15 PT-DURATION       PIC  9(09) VALUE ZEROES.        01755501
017556             15 FILLER            PIC  X(01) VALUE SPACE.         01755601
017557             15 PT-nano-sec       PIC  x(12) VALUE ZEROES.        01755701
017558     05  PT-MAX-PARA-ENTRIES      PIC  9(04) VALUE 1500.          01755801
017559     05  PT-CURR-ENTRIES          PIC  9(04) VALUE ZEROES.        01755901
017560     05  PT-CURR-PARA             PIC  X(04) VALUE SPACES.        01756001
017561                                                                  01756101
017562                                                                  01756201
017563                                                                  01756301
017564                                                                  01756401
017565/                                                                 01756501
017566 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  01756601
017567     05  TS-INFO-QUEUE-NAME.                                      01756701
017568         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 01756801
017569         10  FILLER                      PIC  X(04)  VALUE 'INFO'.01756901
017570                                                                  01757001
017580/                                                                 01758001
017590 01  PT-MSG-TABLE.                                                01759001
017600     05  PT-MSG-LINES OCCURS 200 TIMES                            01760001
017700                              INDEXED BY PT-MSG-IDX.              01770001
017800         10  PT-MSG-SEQ                  PIC S9(05) COMP-3.       01780001
017900         10  PT-MSG-LINE                 PIC X(69).               01790001
018000                                                                  01800001
018100     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP         01810001
018200                                                     VALUE ZERO.  01820001
018300     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  01830001
018400                                                     COMP SYNC.   01840001
018500                                                                  01850001
018600*                                                                 01860001
018700     COPY DPWS026.                                                01870001
018800                                                                  01880001
018900*---------------------------------------------------------------* 01890001
019000*    DB2 AREA FOR THE RECEIVER HEADER TABLE                     * 01900001
019100*---------------------------------------------------------------* 01910001
019200     EXEC SQL                                                     01920001
019300          INCLUDE TRECEIV                                         01930001
019400     END-EXEC.                                                    01940001
019500*---------------------------------------------------------------* 01950001
019600*    DB2 AREA FOR THE PURCHASE TABLE                            * 01960001
019700*---------------------------------------------------------------* 01970001
019800     EXEC SQL                                                     01980001
019900          INCLUDE TPURCHS                                         01990001
020000     END-EXEC.                                                    02000001
020100*---------------------------------------------------------------* 02010001
020200*    DB2 AREA FOR SHIPMENT PO TABLE                             * 02020001
020300*---------------------------------------------------------------* 02030001
020400     EXEC SQL                                                     02040001
020500          INCLUDE TSHPTPO                                         02050001
020600     END-EXEC.                                                    02060001
020700*---------------------------------------------------------------* 02070001
020800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02080001
020900*  (TSHPUNT)                                                      02090001
021000*---------------------------------------------------------------* 02100001
021100     EXEC SQL                                                     02110001
021200         INCLUDE TSHPUNT                                          02120001
021300     END-EXEC.                                                    02130001
021400                                                                  02140001
021500*---------------------------------------------------------------* 02150001
021600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CARTON LOCATION    02160001
021700*  (TSHUNLO)                                                      02170001
021800*---------------------------------------------------------------* 02180001
021900     EXEC SQL                                                     02190001
022000         INCLUDE TSHUNLO                                          02200001
022100     END-EXEC.                                                    02210001
022200                                                                  02220001
022300*---------------------------------------------------------------* 02230001
022400*    DB2 AREA FOR THE INPKSU TABLE                                02240001
022500*---------------------------------------------------------------* 02250001
022600     EXEC SQL                                                     02260001
022700          INCLUDE TINPKSU                                         02270001
022800     END-EXEC.                                                    02280001
022900*---------------------------------------------------------------* 02290001
023000*    DB2 AREA FOR THE PACKSLIP TABLE                            * 02300001
023100*---------------------------------------------------------------* 02310001
023200     EXEC SQL                                                     02320001
023300          INCLUDE TPKSLIP                                         02330001
023400     END-EXEC.                                                    02340001
023500*---------------------------------------------------------------* 02350001
023600*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TABLE                 * 02360001
023700*---------------------------------------------------------------* 02370001
023800     EXEC SQL                                                     02380001
023900         INCLUDE TSUNAUD                                          02390001
024000     END-EXEC.                                                    02400001
024100*---------------------------------------------------------------* 02410001
024200*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TRANSACTION TABLE     * 02420001
024300*---------------------------------------------------------------* 02430001
024400     EXEC SQL                                                     02440001
024500         INCLUDE TSUATRN                                          02450001
024600     END-EXEC.                                                    02460001
024700*---------------------------------------------------------------* 02470001
024800*    DB2 AREA FOR THE PO AUDIT EXC TABLE (SUT_PO_AUD_EXC)       * 02480001
024900*---------------------------------------------------------------* 02490001
025000     EXEC SQL                                                     02500001
025100         INCLUDE SUT00014                                         02510001
025200     END-EXEC.                                                    02520001
025300*---------------------------------------------------------------* 02530001
025400*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 02540001
025500*---------------------------------------------------------------* 02550001
025600     EXEC SQL                                                     02560001
025700         INCLUDE SUT00015                                         02570001
025800     END-EXEC.                                                    02580001
025900*---------------------------------------------------------------* 02590001
026000*    DB2 AREA FOR THE VENDOR AUDIT PARM TABLE (SUT_PO_AUD_PARM) * 02600001
026100*---------------------------------------------------------------* 02610001
026200     EXEC SQL                                                     02620001
026300         INCLUDE SUT00017                                         02630001
026400     END-EXEC.                                                    02640001
026500*---------------------------------------------------------------* 02650001
026600*    DB2 AREA FOR THE VENDOR DEPT RANKING TBL (SUT_VND_DEPT_RNKG) 02660001
026700*---------------------------------------------------------------* 02670001
026800     EXEC SQL                                                     02680001
026900         INCLUDE SUT00018                                         02690001
027000     END-EXEC.                                                    02700001
027100*---------------------------------------------------------------* 02710001
027200*    DB2 AREA FOR THE VENDOR RANKING TABLE (SUT_VND_RNKG)       * 02720001
027300*---------------------------------------------------------------* 02730001
027400     EXEC SQL                                                     02740001
027500         INCLUDE SUT00019                                         02750001
027600     END-EXEC.                                                    02760001
027700*---------------------------------------------------------------* 02770001
027800*    DB2 AREA FOR THE DISTRIBUTION HEADER TABLE                 * 02780001
027900*---------------------------------------------------------------* 02790001
028000     EXEC SQL                                                     02800001
028100          INCLUDE TDISTHD                                         02810001
028200     END-EXEC.                                                    02820001
028300*---------------------------------------------------------------* 02830001
028400*    DB2 AREA FOR THE DISTRIBUTION DETAIL TABLE                 * 02840001
028500*---------------------------------------------------------------* 02850001
028600     EXEC SQL                                                     02860001
028700          INCLUDE TDISTDT                                         02870001
028800     END-EXEC.                                                    02880001
028900*---------------------------------------------------------------* 02890001
029000*    DB2 AREA FOR THE RECEIVER ITEM TABLE                       * 02900001
029100*---------------------------------------------------------------* 02910001
029200     EXEC SQL                                                     02920001
029300          INCLUDE TRECITM                                         02930001
029400     END-EXEC.                                                    02940001
029500*---------------------------------------------------------------* 02950001
029600*    DB2 AREA FOR THE PURCHASE ITEM TABLE                       * 02960001
029700*---------------------------------------------------------------* 02970001
029800     EXEC SQL                                                     02980001
029900          INCLUDE TPURITM                                         02990001
030000     END-EXEC.                                                    03000001
030100*---------------------------------------------------------------* 03010001
030200*    DB2 AREA FOR THE SHIPPING UPC TABLE                        * 03020001
030300*---------------------------------------------------------------* 03030001
030400     EXEC SQL                                                     03040001
030500          INCLUDE TSHUUPC                                         03050001
030600     END-EXEC.                                                    03060001
030700*---------------------------------------------------------------* 03070001
030800*    DB2 AREA FOR THE RECEIVING SYSTEM PARM TABLE               * 03080001
030900*---------------------------------------------------------------* 03090001
031000     EXEC SQL                                                     03100001
031100         INCLUDE TKRPRPM                                          03110001
031200     END-EXEC.                                                    03120001
031300*----------------------------------------------------------------*03130001
031400*  COMMUNICATIONS AREA FOR DB2                                   *03140001
031500*----------------------------------------------------------------*03150001
031600     EXEC SQL                                                     03160001
031700         INCLUDE SQLCA                                            03170001
031800     END-EXEC.                                                    03180001
031900                                                                  03190001
032000                                                                  03200001
032100******************************************************************03210001
032200 LINKAGE SECTION.                                                 03220001
032300******************************************************************03230001
032400 01  DFHCOMMAREA.                                                 03240001
032500     05  FILLER                         OCCURS  1 TO 4072 TIMES   03250001
032600                                      DEPENDING ON EIBCALEN.      03260001
032700         10  FILLER                   PIC X.                      03270001
032800                                                                  03280001
032900******************************************************************03290001
033000 PROCEDURE DIVISION.                                              03300001
033100******************************************************************03310001
033200 0000-PROGRAM-MAINLINE.                                           03320001
033300     MOVE EIBTASKN                 TO  PV-EIBTASKN.               03330001
033400     INITIALIZE                        SU021-CARTON-AUDIT-RECORD. 03340001
033500     MOVE DFHCOMMAREA              TO  SU021-CARTON-AUDIT-RECORD. 03350001
033600                                                                  03360001
033700     PERFORM 9125-GET-START-TMST.                                 03370001
033701                                                                  03370101
033702     SET PS-BLD-INTERNAL-TABLE-NO  TO  TRUE.                      03370201
033703     MOVE 999999999                TO  PV-PARM-SECONDS.           03370301
033704                                                                  03370401
033705     MOVE SPACES                   TO PV-CICS-MSG-AREA.           03370501
033706     INITIALIZE PT-MSG-TABLE.                                     03370601
033707     MOVE 1                        TO PT-MSG-SEQ (PT-MSG-IDX).    03370701
033708                                                                  03370801
033709     IF SU021-PRINT-APPLY                                         03370901
033710        MOVE SU021-OPER-UNT-ID TO DP026-LOCATION-NBR              03371001
033720     ELSE                                                         03372001
033730        PERFORM 0500-FIND-SYSTEM-ID                               03373001
033740        PERFORM 0700-FIND-LOGON-INFO                              03374001
033750     END-IF.                                                      03375001
033760                                                                  03376001
033770     IF DP026-LOCATION-NBR = 90                                   03377001
033780         MOVE SU021-OPER-UNT-ID        TO DK-OPER-UNT-ID          03378001
033790     ELSE                                                         03379001
033800         IF DP026-LOCATION-NBR NOT = SU021-OPER-UNT-ID            03380001
033900             SET SU021-AUDIT-IS-COMPLETE TO TRUE                  03390001
034000             PERFORM 9998-RETURN                                  03400001
034100         ELSE                                                     03410001
034200             MOVE SU021-OPER-UNT-ID        TO DK-OPER-UNT-ID      03420001
034300         END-IF                                                   03430001
034400     END-IF.                                                      03440001
034500     PERFORM 8850-SELECT-TKRPRPM.                                 03450001
034600                                                                  03460001
034700     PERFORM 9100-CHECK-PARA-TRACK-SEC.                           03470001
034800                                                                  03480001
034900     STRING ' SUKCS752 - '                                        03490001
035000            ' PS-SHOW-DEBUG-SW= ' PS-SHOW-DEBUG-SW                03500001
035100         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  03510001
035200     PERFORM 9990-WRITE-CICS.                                     03520001
035300                                                                  03530001
035400* RESERVE THE LOG QUEUE FOR THE EXCLUSIVE USE OF THIS TRANSACTION 03540001
035500* TO KEEP OTHER TRANSACTIONS FROM INTERUPTING THE DISPLAY.        03550001
035600* THIS IS DONE ONLY IF THE DEBUGGING FLAG FOR THE DC IS           03560001
035700* SWITCHED ON.  IF AN ERROR OCCURS WHEN THE FLAG IS OFF,          03570001
035800* WE WILL ENQ THE LOG BEFORE DUMPING THE MESSAGE TABLE.           03580001
035900                                                                  03590001
036000     IF PS-SHOW-DEBUG-INFO                                        03600001
036100         EXEC CICS ENQ                                            03610001
036200             RESOURCE(PC-LOG-QUEUE)                               03620001
036300         END-EXEC                                                 03630001
036400     END-IF.                                                      03640001
036500                                                                  03650001
036600                                                                  03660001
036700     IF SU021-CARTON-CHECK-IN                                     03670001
036800         SET PS-AUDIT-IS-NOT-REQUIRED TO TRUE                     03680001
036900         PERFORM 1000-DETERMINE-IF-AUDIT-REQ                      03690001
037000     ELSE                                                         03700001
037100         IF SU021-CARTON-AUDIT                                    03710001
037200             PERFORM 2000-AUDIT-CARTON-DATA                       03720001
037300         ELSE                                                     03730001
037400             SET SU021-INVALID-REQUEST TO TRUE                    03740001
037500         END-IF                                                   03750001
037600     END-IF.                                                      03760001
037700                                                                  03770001
037800                                                                  03780001
037900                                                                  03790001
038000                                                                  03800001
038100                                                                  03810001
038200                                                                  03820001
038300*                                                                 03830001
038400 0500-FIND-SYSTEM-ID.                                             03840001
038500                                                                  03850001
038600     EXEC CICS                                                    03860001
038700         INQUIRE                                                  03870001
038800             TRANSACTION   (PC-LOGON-TRAN-ID)                     03880001
038900             REMOTESYSTEM  (PV-SYSID)                             03890001
039000             RESP          (PV-CICS-RESPONSE)                     03900001
039100     END-EXEC.                                                    03910001
039200                                                                  03920001
039300     EVALUATE TRUE                                                03930001
039400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03940001
039500             CONTINUE                                             03950001
039600         WHEN OTHER                                               03960001
039700             MOVE '0500-FIND-SYSTEM-ID'                           03970001
039800                 TO DP013-PARAGRAPH                               03980001
039900             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 03990001
040000                 TO DP013-MESSAGE-TEXT (1)                        04000001
040100             SET DP013-CICS-ABEND      TO  TRUE                   04010001
040200             SET DP013-NO-ROLLBACK     TO  TRUE                   04020001
040300             PERFORM 9999-WRITE-CICS-LOG-MSG                      04030001
040400             SET PS-DUMP-TO-LOG       TO TRUE                     04040001
040500     END-EVALUATE.                                                04050001
040600*                                                                 04060001
040700 0700-FIND-LOGON-INFO.                                            04070001
040800                                                                  04080001
040900     MOVE LENGTH OF DP026-SIGN-ON-INFO                            04090001
041000                    TO  PV-SIGN-ON-INFO-LENGTH.                   04100001
041100     MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   04110001
041200     MOVE +1        TO  PV-TS-ITEM.                               04120001
041300                                                                  04130001
041400     IF PV-SYSID = SPACES                                         04140001
041500         EXEC CICS                                                04150001
041600             READQ TS                                             04160001
041700                 QUEUE  (TS-INFO-QUEUE-NAME)                      04170001
041800                 ITEM   (PV-TS-ITEM)                              04180001
041900                 INTO   (DP026-SIGN-ON-INFO)                      04190001
042000                 RESP   (PV-CICS-RESPONSE)                        04200001
042100         END-EXEC                                                 04210001
042200     ELSE                                                         04220001
042300         EXEC CICS                                                04230001
042400             READQ TS                                             04240001
042500                 QUEUE   (TS-INFO-QUEUE-NAME)                     04250001
042600                 SYSID   (PV-SYSID)                               04260001
042700                 ITEM    (PV-TS-ITEM)                             04270001
042800                 INTO    (DP026-SIGN-ON-INFO)                     04280001
042900                 LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 04290001
043000                 RESP    (PV-CICS-RESPONSE)                       04300001
043100         END-EXEC                                                 04310001
043200     END-IF.                                                      04320001
043300                                                                  04330001
043400     EVALUATE TRUE                                                04340001
043500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04350001
043600             CONTINUE                                             04360001
043700         WHEN OTHER                                               04370001
043800             MOVE '0700-FIND-LOGON-INFO'                          04380001
043900                 TO DP013-PARAGRAPH                               04390001
044000             MOVE 'UNABLE TO READ LOGON TSQ'                      04400001
044100                 TO DP013-MESSAGE-TEXT (1)                        04410001
044200             MOVE SU021-PO-NUMBER    TO PV-DISPLAY-PO-NBR         04420001
044300             MOVE SU021-LINE-NBR     TO PV-DISPLAY-PO-LINE-NBR    04430001
044400             MOVE SU021-OPER-UNT-ID  TO PV-DISPLAY-OPER-UNT-ID    04440001
044500             MOVE SU021-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID   04450001
044600             STRING ' SUKCS752 - '                                04460001
044700                    ' PO = '                                      04470001
044800               PV-DISPLAY-PO-NBR                                  04480001
044900               ' LINE = '                                         04490001
045000               PV-DISPLAY-PO-LINE-NBR                             04500001
045100               ' OPER = '                                         04510001
045110               PV-DISPLAY-OPER-UNT-ID                             04511001
045111               DELIMITED BY SIZE                                  04511101
045112               INTO DP013-MESSAGE-TEXT (2)                        04511201
045113             STRING ' SUKCS752 - '                                04511301
045114                    ' CARTON = '                                  04511401
045115               PV-DISPLAY-SHIPT-UNT-ID                            04511501
045116               DELIMITED BY SIZE                                  04511601
045117               INTO DP013-MESSAGE-TEXT (3)                        04511701
045118             SET DP013-CICS-ABEND     TO TRUE                     04511801
045119             SET DP013-NO-ROLLBACK    TO TRUE                     04511901
045120             PERFORM 9999-WRITE-CICS-LOG-MSG                      04512001
045130     END-EVALUATE.                                                04513001
045140*-----------------------------------------------------------------04514001
045150*DETERMINE IF AN AUDIT IS NEEDED FOR THIS PO                      04515001
045160*-----------------------------------------------------------------04516001
045170 1000-DETERMINE-IF-AUDIT-REQ.                                     04517001
045171                                                                  04517101
045172     IF  PS-BLD-INTERNAL-TABLE-YES                                04517201
045173         MOVE '1000'  TO  PV-CSSL-PARA                            04517301
045174         PERFORM 9120-INTERNAL-TABLE                              04517401
045175     END-IF.                                                      04517501
045176                                                                  04517601
045177     STRING ' SUKCS752 - '                                        04517701
045178            ' 1000-DETERMINE-IF-AUDIT-REQ'                        04517801
045179         DELIMITED BY SIZE                                        04517901
045180         INTO PV-CICS-MSG-AREA.                                   04518001
045190     PERFORM 9990-WRITE-CICS.                                     04519001
045200     MOVE SU021-CARTON-AUDIT-RECORD                               04520001
045300           TO PV-CICS-MSG-AREA.                                   04530001
045400     PERFORM 9990-WRITE-CICS.                                     04540001
045500     MOVE SU021-PO-NUMBER         TO DK-PO-NBR.                   04550001
045600     IF SU021-PACKAGE-TYPE-CODE = 'BC'                            04560001
045700         MOVE SU021-LINE-NBR          TO DK-PO-LINE-NBR           04570001
045800     ELSE                                                         04580001
045900         MOVE 0                       TO DK-PO-LINE-NBR           04590001
046000     END-IF.                                                      04600001
046100     IF SU021-PACKAGE-TYPE-CODE = 'PP'                            04610001
046200         MOVE SU021-PRE-PACK-ID       TO DK-PREPK-ID              04620001
046300     ELSE                                                         04630001
046400         MOVE 0                       TO DK-PREPK-ID              04640001
046500     END-IF.                                                      04650001
046600     MOVE SU021-REC-SEQ-NBR       TO DK-RCVR-SEQ-NBR.             04660001
046700     MOVE SU021-INBOUND-TRIP-ID   TO DK-INBND-TRIP-ID.            04670001
046800     MOVE SU021-SHIPT-UNT-ID      TO DK-SHIPT-UNT-ID.             04680001
046900*  CHECK IF SUT_PO_AUD_REQ RECORDS EXIST                          04690001
047000     PERFORM 7000-SELECT-REQ-INFO.                                04700001
047100                                                                  04710001
047200     IF PS-REQ-REC-FOUND                                          04720001
047300         MOVE SUT00015-AUD-CNTL-NBR   TO SU021-AUDIT-NUMBER       04730001
047400         PERFORM 9000-SELECT-CARTON                               04740001
047500     END-IF.                                                      04750001
047600*   CHECK IF AUDIT IS ALREADY DONE                                04760001
047700     IF NOT SU021-DB2-ERROR AND                                   04770001
047800        PS-REQ-REC-FOUND AND                                      04780001
047900        (SUT00015-CART-PRMPT-CDE = 'D' OR                         04790001
048000         SUT00015-CART-PRMPT-CDE = 'F')                           04800001
048100         IF SUT00015-CART-PRMPT-CDE = 'D'                         04810001
048200             IF SUT00015-AUD-STAT-CDE = 'P' OR                    04820001
048300                SUT00015-AUD-STAT-CDE = 'N'                       04830001
048400                 SET SU021-AUDIT-IS-COMPLETE TO TRUE              04840001
048500             ELSE                                                 04850001
048600                 IF SUT00015-AUD-STAT-CDE = 'F'                   04860001
048700                     SET SU021-REWORK  TO TRUE                    04870001
048800                 ELSE                                             04880001
048900***    SUT00015-AUD-STAT-CDE = 'I'                                04890001
049000                     SET SU021-AUDIT-PENDING TO TRUE              04900001
049100                 END-IF                                           04910001
049200             END-IF                                               04920001
049300         ELSE                                                     04930001
049400             SET SU021-REWORK TO TRUE                             04940001
049500     ELSE                                                         04950001
049600       IF NOT SU021-DB2-ERROR                                     04960001
049700*   IF NO SUT_PO_AUD_REQ FOUND, GET DEPT AND ENT-ID               04970001
049800         IF PS-NO-REQ-REC-FOUND                                   04980001
049900             PERFORM 7150-RETREIVE-PO-INFO                        04990001
050000             MOVE PURCHS-DEPT-NBR         TO DK-DEPT-NBR          05000001
050100             MOVE PURCHS-ENT-ID           TO DK-ENT-ID            05010001
050200         ELSE                                                     05020001
050300             MOVE SUT00015-DEPT-NBR       TO DK-DEPT-NBR          05030001
050400             MOVE SUT00015-ENT-ID         TO DK-ENT-ID            05040001
050500             SET PS-PO-INFO-FOUND TO TRUE                         05050001
050600         END-IF                                                   05060001
050700         IF PS-PO-INFO-FOUND                                      05070001
051900             IF PS-REQ-REC-FOUND                                  05190001
052000                PERFORM 7190-RETREIVE-PO-AUD-PARM                 05200001
052100             ELSE                                                 05210001
052200                PERFORM 1100-RETREIVE-VENDOR-RANKING              05220001
052300             END-IF                                               05230001
052400             MOVE SU021-PO-NUMBER TO                              05240001
052500                  DK-BYPASS-PO-NBR                                05250001
052501             MOVE SU021-REC-SEQ-NBR TO                            05250101
052502                  DK-BYPASS-REC-SEQ-NBR                           05250201
052503             PERFORM 1200-CHECK-PO-AUDIT-EXC                      05250301
052504             PERFORM 7100-CHECK-FOR-BYPASS                        05250401
052505             IF  SUT00017-AUD-PCT = 0   AND                       05250501
052506                 PS-NO-LINE-LEVEL-FOUND AND                       05250601
052507                 PS-NO-PO-LEVEL-FOUND                             05250701
052508                 IF PS-NO-REQ-REC-FOUND                           05250801
052509                     SET SU021-AUDIT-IS-COMPLETE TO TRUE          05250901
052510                 ELSE                                             05251001
052520                     PERFORM 1430-DETERMINE-STAT-CDE              05252001
052530                 END-IF                                           05253001
052540             ELSE                                                 05254001
052550               PERFORM 1400-CHECK-FOR-IN-PROCES-AUDIT             05255001
052560*   AUDIT HAS BEEN STARTED FOR THIS DC                            05256001
052570               IF PS-AUDIT-STARTED                                05257001
052580                 PERFORM 1430-DETERMINE-STAT-CDE                  05258001
052590               ELSE                                               05259001
052600                 PERFORM 7850-SELECT-DC-PASSED                    05260001
052700                 IF  PV-PASSED-COUNT > 0    AND                   05270001
052800                     PS-NO-LINE-LEVEL-FOUND AND                   05280001
052900                     PS-NO-PO-LEVEL-FOUND                         05290001
053000                     SET SU021-AUDIT-IS-COMPLETE TO TRUE          05300001
053100                 ELSE                                             05310001
053300                                                                  05330001
053400*   NO RECORDS EXIST IN THE SUT_PO_AUD_EXC TABLE                  05340001
053500                   IF PS-NO-LINE-LEVEL-FOUND AND                  05350001
053600                      PS-NO-PO-LEVEL-FOUND                        05360001
053700                     PERFORM 1300-CHECK-PO-AUDIT-REQ              05370001
053800                     PERFORM 1410-CHECK-PROMPTED-LINES            05380001
053900*   SOME FAILED AUDITS HAVE BEEN FOUND                            05390001
054000                     IF PS-FAILED-AUDITS-FOUND                    05400001
054100                         SET SU021-AUDIT-REQUIRED TO TRUE         05410001
054200                         PERFORM 1500-CALCULATE-QUANTITIES        05420005
054300                         PERFORM 1600-INSERT-INTO-TABLES          05430007
054400                     ELSE                                         05440001
054500*   SOME PASSED AUDITS HAVE BEEN FOUND FOR THIS ITEM              05450001
054600                       IF PS-PASSED-AUDITS-FOUND                  05460001
054700                         IF SUT00017-CKD-DC-QTY > PV-PASSED-COUNT 05470001
054800*        CHECK THE NUMBER OF LINES FOR THE PO-RCVR PROMPTED       05480001
054900                             IF  PV-PROMPTED-CNT >=               05490001
055000                                 SUT00017-MAX-PO-LNE-QTY AND      05500001
055100                                 SUT00017-MAX-PO-LNE-QTY > 0      05510001
055200                                   SET SU021-AUDIT-IS-COMPLETE    05520001
055300                                       TO TRUE                    05530001
055400                             ELSE                                 05540001
055500                                 SET SU021-AUDIT-REQUIRED         05550001
055600                                     TO TRUE                      05560001
055700                                 PERFORM                          05570005
055800                                     1500-CALCULATE-QUANTITIES    05580005
055900                                 PERFORM                          05590007
056000                                      1600-INSERT-INTO-TABLES     05600007
056100                             END-IF                               05610001
056200                         ELSE                                     05620001
056300                             SET SU021-AUDIT-IS-COMPLETE TO TRUE  05630001
056400                         END-IF                                   05640001
056500*    NO FAILED OR PASSED AUDITS HAVE BEEN FOUND                   05650001
056600                       ELSE                                       05660001
056700*        CHECK THE NUMBER OF LINES FOR THE PO-RCVR PROMPTED       05670001
056800                         IF  PV-PROMPTED-CNT >=                   05680001
056900                             SUT00017-MAX-PO-LNE-QTY  AND         05690001
057000                             SUT00017-MAX-PO-LNE-QTY > 0          05700001
057100                               SET SU021-AUDIT-IS-COMPLETE        05710001
057200                                       TO TRUE                    05720001
057300                         ELSE                                     05730001
057400                             SET SU021-AUDIT-REQUIRED TO TRUE     05740001
057500                             PERFORM 1500-CALCULATE-QUANTITIES    05750005
057600                             PERFORM 1600-INSERT-INTO-TABLES      05760007
057700                         END-IF                                   05770001
057800                       END-IF                                     05780001
057900                     END-IF                                       05790001
058000*   A RECORD EXIST IN THE SUT_PO_AUD_EXC TABLE                    05800001
058100                   ELSE                                           05810001
058200                     PERFORM 1700-RETURN-WITH-EXC-VALUES          05820001
058300                   END-IF                                         05830001
058400                 END-IF                                           05840001
058500               END-IF                                             05850001
058600             END-IF                                               05860001
058700         ELSE                                                     05870001
058800             SET SU021-DB2-ERROR TO TRUE                          05880001
058900         END-IF                                                   05890001
059000       END-IF                                                     05900001
059100     END-IF.                                                      05910001
059200                                                                  05920001
059210                                                                  05921004
059220     STRING ' SUKCS752 - '                                        05922004
059230            ' BEFORE RETURN '                                     05923004
059231            ' AUDIT REQUIRED:'  SU021-AUDIT-VALIDATION-SW         05923109
059240         DELIMITED BY SIZE                                        05924004
059250         INTO PV-CICS-MSG-AREA.                                   05925004
059260     PERFORM 9990-WRITE-CICS.                                     05926004
059270                                                                  05927004
059280     move SU021-CARTON-AUDIT-RECORD to DFHCOMMAREA.               05928009
059290                                                                  05929009
059291                                                                  05929109
059300     PERFORM 9998-RETURN.                                         05930001
059400                                                                  05940001
059500*-----------------------------------------------------------------05950001
059600*RETRIEVE THE VENDOR RANKING FOR THE PO                           05960001
059700*-----------------------------------------------------------------05970001
059800 1100-RETREIVE-VENDOR-RANKING.                                    05980001
059900                                                                  05990001
060000     IF  PS-BLD-INTERNAL-TABLE-YES                                06000001
060100         MOVE '1100'  TO  PV-CSSL-PARA                            06010001
060200         PERFORM 9120-INTERNAL-TABLE                              06020001
060300     END-IF.                                                      06030001
060400                                                                  06040001
060500     STRING ' SUKCS752 - '                                        06050001
060600            ' 1100-RETREIVE-VENDOR-RANKING'                       06060001
060700         DELIMITED BY SIZE                                        06070001
060800         INTO PV-CICS-MSG-AREA.                                   06080001
060900     PERFORM 9990-WRITE-CICS.                                     06090001
061000     MOVE SU021-PACKAGE-TYPE-CODE TO DK-PKGNG-TYP-CDE.            06100001
061100     IF PS-REQ-REC-FOUND                                          06110001
061200         PERFORM 7200-RETREIVE-VENDOR-DEPT                        06120001
061300         IF PS-NO-DEPT-RANK-FOUND                                 06130001
061400             PERFORM 7300-RETREIVE-VENDOR-RANK                    06140001
061500             IF PS-NO-VEND-RANK-FOUND                             06150001
061600                 PERFORM 7400-RETREIVE-DEFAULT-RANK               06160001
061700                 IF PS-DEFAULT-RANK-FOUND                         06170001
061800                     MOVE 'DEFAULT RANK FOUND '                   06180001
061900                                     TO PV-CICS-MSG-AREA          06190001
062000                     PERFORM 9990-WRITE-CICS                      06200001
062100                     MOVE SUT00017-CK-AFT-DAY-QTY                 06210001
062200                          TO PV-DISPLAY-CK-AFT-DAY-QTY            06220001
062300                     STRING ' SUKCS752 - '                        06230001
062400                            'CHECK AFTER DAYS = '                 06240001
062500                                   DELIMITED BY SIZE              06250001
062600                             PV-DISPLAY-CK-AFT-DAY-QTY            06260001
062700                                   DELIMITED BY SIZE              06270001
062800                                   INTO PV-CICS-MSG-AREA          06280001
062900                     PERFORM 9990-WRITE-CICS                      06290001
063000                     MOVE PV-LIMIT-DAYS                           06300001
063100                               TO PV-DISPLAY-LIMIT-DAYS           06310001
063200                     STRING ' SUKCS752 - '                        06320001
063300                            'PV-LIMIT-DAYS  = '                   06330001
063400                                   DELIMITED BY SIZE              06340001
063500                            PV-DISPLAY-LIMIT-DAYS                 06350001
063600                                   DELIMITED BY SIZE              06360001
063700                                   INTO PV-CICS-MSG-AREA          06370001
063800                     PERFORM 9990-WRITE-CICS                      06380001
063900                 END-IF                                           06390001
064000             ELSE                                                 06400001
064100                 MOVE 'VEND RANK FOUND '                          06410001
064200                                 TO PV-CICS-MSG-AREA              06420001
064300                 PERFORM 9990-WRITE-CICS                          06430001
064400                 MOVE SUT00017-CK-AFT-DAY-QTY                     06440001
064500                      TO PV-DISPLAY-CK-AFT-DAY-QTY                06450001
064600                 STRING ' SUKCS752 - '                            06460001
064700                        'CHECK AFTER DAYS = '                     06470001
064800                               DELIMITED BY SIZE                  06480001
064900                         PV-DISPLAY-CK-AFT-DAY-QTY                06490001
065000                               DELIMITED BY SIZE                  06500001
065100                               INTO PV-CICS-MSG-AREA              06510001
065200                 PERFORM 9990-WRITE-CICS                          06520001
065300                 MOVE PV-LIMIT-DAYS                               06530001
065400                           TO PV-DISPLAY-LIMIT-DAYS               06540001
065500                 STRING ' SUKCS752 - '                            06550001
065600                        'PV-LIMIT-DAYS  = '                       06560001
065700                               DELIMITED BY SIZE                  06570001
065800                        PV-DISPLAY-LIMIT-DAYS                     06580001
065900                               DELIMITED BY SIZE                  06590001
066000                               INTO PV-CICS-MSG-AREA              06600001
066100                 PERFORM 9990-WRITE-CICS                          06610001
066200             END-IF                                               06620001
066300         ELSE                                                     06630001
066400             MOVE 'DEPT RANK FOUND '                              06640001
066500                                 TO PV-CICS-MSG-AREA              06650001
066600             PERFORM 9990-WRITE-CICS                              06660001
066700             MOVE SUT00017-CK-AFT-DAY-QTY                         06670001
066800                  TO PV-DISPLAY-CK-AFT-DAY-QTY                    06680001
066900             STRING ' SUKCS752 - '                                06690001
067000                    'CHECK AFTER DAYS = '                         06700001
067100                           DELIMITED BY SIZE                      06710001
067200                     PV-DISPLAY-CK-AFT-DAY-QTY                    06720001
067300                           DELIMITED BY SIZE                      06730001
067400                           INTO PV-CICS-MSG-AREA                  06740001
067500             PERFORM 9990-WRITE-CICS                              06750001
067600             MOVE PV-LIMIT-DAYS                                   06760001
067700                       TO PV-DISPLAY-LIMIT-DAYS                   06770001
067800             STRING ' SUKCS752 - '                                06780001
067900                    'PV-LIMIT-DAYS  = '                           06790001
068000                           DELIMITED BY SIZE                      06800001
068100                    PV-DISPLAY-LIMIT-DAYS                         06810001
068200                           DELIMITED BY SIZE                      06820001
068300                           INTO PV-CICS-MSG-AREA                  06830001
068400             PERFORM 9990-WRITE-CICS                              06840001
068500         END-IF                                                   06850001
068600     ELSE                                                         06860001
068700         PERFORM 7250-RETREIVE-VENDOR-DEPT                        06870001
068800         IF PS-NO-DEPT-RANK-FOUND                                 06880001
068900             PERFORM 7350-RETREIVE-VENDOR-RANK                    06890001
069000             IF PS-NO-VEND-RANK-FOUND                             06900001
069100                 PERFORM 7450-RETREIVE-DEFAULT-RANK               06910001
069200                 IF PS-DEFAULT-RANK-FOUND                         06920001
069300                     MOVE 'DEFAULT RANK FOUND '                   06930001
069400                                     TO PV-CICS-MSG-AREA          06940001
069500                     PERFORM 9990-WRITE-CICS                      06950001
069600                     MOVE SUT00017-CK-AFT-DAY-QTY                 06960001
069700                          TO PV-DISPLAY-CK-AFT-DAY-QTY            06970001
069800                     STRING ' SUKCS752 - '                        06980001
069900                            'CHECK AFTER DAYS = '                 06990001
070000                                   DELIMITED BY SIZE              07000001
070100                             PV-DISPLAY-CK-AFT-DAY-QTY            07010001
070200                                   DELIMITED BY SIZE              07020001
070300                                   INTO PV-CICS-MSG-AREA          07030001
070400                     PERFORM 9990-WRITE-CICS                      07040001
070500                     MOVE PV-LIMIT-DAYS                           07050001
070600                               TO PV-DISPLAY-LIMIT-DAYS           07060001
070700                     STRING ' SUKCS752 - '                        07070001
070800                            'PV-LIMIT-DAYS  = '                   07080001
070900                                   DELIMITED BY SIZE              07090001
071000                            PV-DISPLAY-LIMIT-DAYS                 07100001
071100                                   DELIMITED BY SIZE              07110001
071200                                   INTO PV-CICS-MSG-AREA          07120001
071300                     PERFORM 9990-WRITE-CICS                      07130001
071400                 END-IF                                           07140001
071500             ELSE                                                 07150001
071600                 MOVE 'VEND RANK FOUND '                          07160001
071700                                 TO PV-CICS-MSG-AREA              07170001
071800                 PERFORM 9990-WRITE-CICS                          07180001
071900                 MOVE SUT00017-CK-AFT-DAY-QTY                     07190001
072000                      TO PV-DISPLAY-CK-AFT-DAY-QTY                07200001
072010                 STRING ' SUKCS752 - '                            07201001
072020                        'CHECK AFTER DAYS = '                     07202001
072030                               DELIMITED BY SIZE                  07203001
072040                         PV-DISPLAY-CK-AFT-DAY-QTY                07204001
072050                               DELIMITED BY SIZE                  07205001
072060                               INTO PV-CICS-MSG-AREA              07206001
072070                 PERFORM 9990-WRITE-CICS                          07207001
072080                 MOVE PV-LIMIT-DAYS                               07208001
072090                           TO PV-DISPLAY-LIMIT-DAYS               07209001
072100                 STRING ' SUKCS752 - '                            07210001
072200                        'PV-LIMIT-DAYS  = '                       07220001
072300                               DELIMITED BY SIZE                  07230001
072400                        PV-DISPLAY-LIMIT-DAYS                     07240001
072500                               DELIMITED BY SIZE                  07250001
072600                               INTO PV-CICS-MSG-AREA              07260001
072700                 PERFORM 9990-WRITE-CICS                          07270001
072800             END-IF                                               07280001
072900         ELSE                                                     07290001
073000             MOVE 'DEPT RANK FOUND '                              07300001
073100                                 TO PV-CICS-MSG-AREA              07310001
073200             PERFORM 9990-WRITE-CICS                              07320001
073300             MOVE SUT00017-CK-AFT-DAY-QTY                         07330001
073400                  TO PV-DISPLAY-CK-AFT-DAY-QTY                    07340001
073500             STRING ' SUKCS752 - '                                07350001
073600                    'CHECK AFTER DAYS = '                         07360001
073700                           DELIMITED BY SIZE                      07370001
073800                     PV-DISPLAY-CK-AFT-DAY-QTY                    07380001
073900                           DELIMITED BY SIZE                      07390001
074000                           INTO PV-CICS-MSG-AREA                  07400001
074100             PERFORM 9990-WRITE-CICS                              07410001
074200             MOVE PV-LIMIT-DAYS                                   07420001
074300                       TO PV-DISPLAY-LIMIT-DAYS                   07430001
074400             STRING ' SUKCS752 - '                                07440001
074500                    'PV-LIMIT-DAYS  = '                           07450001
074600                           DELIMITED BY SIZE                      07460001
074700                    PV-DISPLAY-LIMIT-DAYS                         07470001
074800                           DELIMITED BY SIZE                      07480001
074900                           INTO PV-CICS-MSG-AREA                  07490001
075000             PERFORM 9990-WRITE-CICS                              07500001
075100         END-IF                                                   07510001
075200     END-IF.                                                      07520001
075300                                                                  07530001
075400*-----------------------------------------------------------------07540001
075500*CHECK TO SEE IF THE PO NEEDS TO BE AUDITED                       07550001
075600*-----------------------------------------------------------------07560001
075700 1200-CHECK-PO-AUDIT-EXC.                                         07570001
075800                                                                  07580001
075900     IF  PS-BLD-INTERNAL-TABLE-YES                                07590001
076000         MOVE '1200'  TO  PV-CSSL-PARA                            07600001
076100         PERFORM 9120-INTERNAL-TABLE                              07610001
076200     END-IF.                                                      07620001
076201                                                                  07620101
076202     STRING ' SUKCS752 - '                                        07620201
076203            ' 1200-CHECK-PO-AUDIT-EXC'                            07620301
076204         DELIMITED BY SIZE                                        07620401
076205         INTO PV-CICS-MSG-AREA.                                   07620501
076206     PERFORM 9990-WRITE-CICS.                                     07620601
076207*  FOR PRE-PAC 'PP' OR BULK 'BC' ORDERS, PERFORM THE LINE OR PACK 07620701
076208*  ID CHECK                                                       07620801
076209     SET PS-NO-LINE-LEVEL-FOUND                                   07620901
076210         PS-NO-PO-LEVEL-FOUND    TO TRUE.                         07621001
076220     IF SU021-PACKAGE-TYPE-CODE = 'BC'                            07622001
076230         PERFORM 7500-SELECT-BULK                                 07623001
076240     ELSE                                                         07624001
076250         IF SU021-PACKAGE-TYPE-CODE = 'PP'                        07625001
076260             PERFORM 7550-SELECT-PRE-PACK                         07626001
076270         END-IF                                                   07627001
076280     END-IF.                                                      07628001
076290     IF PS-NO-LINE-LEVEL-FOUND                                    07629001
076300         PERFORM 7600-SELECT-PO-LEVEL                             07630001
076400     END-IF.                                                      07640001
076500                                                                  07650001
076600*-----------------------------------------------------------------07660001
076700*CHECK TO SEE IF THE PO NEEDS TO BE AUDITED                       07670001
076800*-----------------------------------------------------------------07680001
076900 1300-CHECK-PO-AUDIT-REQ.                                         07690001
077000                                                                  07700001
077100     IF  PS-BLD-INTERNAL-TABLE-YES                                07710001
077200         MOVE '1300'  TO  PV-CSSL-PARA                            07720001
077300         PERFORM 9120-INTERNAL-TABLE                              07730001
077400     END-IF.                                                      07740001
077500                                                                  07750001
077600     STRING ' SUKCS752 - '                                        07760001
077700            ' 1300-CHECK-PO-AUDIT-REQ'                            07770001
077800         DELIMITED BY SIZE                                        07780001
077900         INTO PV-CICS-MSG-AREA.                                   07790001
078000     PERFORM 9990-WRITE-CICS.                                     07800001
078100     SET PS-NO-FAILED-AUDITS-FOUND                                07810001
078200         PS-NO-PASSED-AUDITS-FOUND    TO TRUE.                    07820001
078300     PERFORM 7700-SELECT-FAILED.                                  07830001
078400     IF PS-NO-FAILED-AUDITS-FOUND                                 07840001
078500         PERFORM 7800-SELECT-PASSED                               07850001
078600     END-IF.                                                      07860001
078700                                                                  07870001
078800*  AN AUDIT FOR THIS PO (LINE OR PREPACK-ID) HAS FAILED, SO       07880001
078900*  THIS CARTON MUST BE AUDITED                                    07890001
079000                                                                  07900001
079100     IF PS-FAILED-AUDITS-FOUND                                    07910001
079200         SET PS-AUDIT-IS-REQUIRED TO TRUE                         07920001
079300     END-IF.                                                      07930001
079400                                                                  07940001
079500                                                                  07950001
079600*-----------------------------------------------------------------07960001
079700*                                                                 07970001
079800*                                                                 07980001
079900*-----------------------------------------------------------------07990001
080000 1400-CHECK-FOR-IN-PROCES-AUDIT.                                  08000001
080100                                                                  08010001
080200     IF  PS-BLD-INTERNAL-TABLE-YES                                08020001
080300         MOVE '1400'  TO  PV-CSSL-PARA                            08030001
080400         PERFORM 9120-INTERNAL-TABLE                              08040001
080500     END-IF.                                                      08050001
080600                                                                  08060001
080700     STRING ' SUKCS752 - '                                        08070001
080800            ' 1400-CHECK-FOR-IN-PROCES-AUDIT'                     08080001
080900         DELIMITED BY SIZE                                        08090001
081000         INTO PV-CICS-MSG-AREA.                                   08100001
081100     PERFORM 9990-WRITE-CICS.                                     08110001
081200     PERFORM 7900-SELECT-THIS-FACILITY.                           08120001
081300                                                                  08130001
081400                                                                  08140001
081500*-----------------------------------------------------------------08150001
081600*                                                                 08160001
081700*                                                                 08170001
081800*-----------------------------------------------------------------08180001
081900 1410-CHECK-PROMPTED-LINES.                                       08190001
082000                                                                  08200001
082100     IF  PS-BLD-INTERNAL-TABLE-YES                                08210001
082101         MOVE '1410'  TO  PV-CSSL-PARA                            08210101
082102         PERFORM 9120-INTERNAL-TABLE                              08210201
082103     END-IF.                                                      08210301
082104                                                                  08210401
082105     STRING ' SUKCS752 - '                                        08210501
082106            ' 1410-CHECK-PROMPTED-LINES'                          08210601
082107         DELIMITED BY SIZE                                        08210701
082108         INTO PV-CICS-MSG-AREA.                                   08210801
082109     PERFORM 9990-WRITE-CICS.                                     08210901
082110     PERFORM 7950-SELECT-PROMPTED-LINES.                          08211001
082120                                                                  08212001
082130                                                                  08213001
082140*-----------------------------------------------------------------08214001
082150*                                                                 08215001
082160*                                                                 08216001
082170*-----------------------------------------------------------------08217001
082180 1430-DETERMINE-STAT-CDE.                                         08218001
082190                                                                  08219001
082200     IF  PS-BLD-INTERNAL-TABLE-YES                                08220001
082300         MOVE '1430'  TO  PV-CSSL-PARA                            08230001
082400         PERFORM 9120-INTERNAL-TABLE                              08240001
082500     END-IF.                                                      08250001
082600                                                                  08260001
082700     STRING ' SUKCS752 - '                                        08270001
082800            ' 1430-DETERMINE-STAT-CDE'                            08280001
082900         DELIMITED BY SIZE                                        08290001
083000         INTO PV-CICS-MSG-AREA.                                   08300001
083100     PERFORM 9990-WRITE-CICS.                                     08310001
083200**    AUDIT IS NO LONGER NEEDED OR HAS PASSED AN AUDIT            08320001
083300     IF SUT00015-AUD-STAT-CDE = PC-N OR                           08330001
083400        SUT00015-AUD-STAT-CDE = PC-P                              08340001
083500         SET SU021-AUDIT-IS-COMPLETE TO TRUE                      08350001
083600     ELSE                                                         08360001
083700**    HAS FAILED AN AUDIT                                         08370001
083800         IF SUT00015-AUD-STAT-CDE = PC-F                          08380001
083900             SET SU021-REWORK TO TRUE                             08390001
084000         ELSE                                                     08400001
084100**    AN AUDIT IS IN-PROCESS                                      08410001
084200             IF SUT00015-AUD-STAT-CDE = PC-I                      08420001
084300                 MOVE SUT00015-AUD-CNTL-NBR  TO PV-AUDIT-CNTL-NBR 08430001
084400                                                DK-AUDIT-CNTL-NBR 08440001
084500*  IF THIS CARTON HAS ALREADY BEEN SCANNED, GO THROUGH THE LOGIC  08450001
084600*  THIS FAR TO DETERMINBE THE RETURN STATUS - DO NOT DO ANY       08460001
084700*  INSERTS OR UPDATES ON THE DATABASES.                           08470001
084800                 IF PS-CARTON-ALREADY-EXISTS AND                  08480001
084900                    SUT00015-AUD-CNTL-NBR = SUATRN-AUD-CNTL-NBR   08490001
085000                     SET SU021-AUDIT-PENDING  TO TRUE             08500001
085100                 ELSE                                             08510001
085200                     PERFORM 1460-CHECK-IF-PROMPTING-DONE         08520001
085300                 END-IF                                           08530001
085400             END-IF                                               08540001
085500         END-IF                                                   08550001
085600     END-IF.                                                      08560001
085700                                                                  08570001
085800 1460-CHECK-IF-PROMPTING-DONE.                                    08580001
085900                                                                  08590001
086000     IF  PS-BLD-INTERNAL-TABLE-YES                                08600001
086100         MOVE '1460'  TO  PV-CSSL-PARA                            08610001
086200         PERFORM 9120-INTERNAL-TABLE                              08620001
086300     END-IF.                                                      08630001
086400                                                                  08640001
086410     STRING ' SUKCS752 - '                                        08641001
086420            ' 1460-CHECK-IF-PROMPTING-DONE'                       08642001
086430         DELIMITED BY SIZE                                        08643001
086440         INTO PV-CICS-MSG-AREA.                                   08644001
086450     PERFORM 9990-WRITE-CICS.                                     08645001
086460*    DETERMINE UNIT COUNT                                         08646001
086470     IF SU021-PACKAGE-TYPE-CODE = 'BC'                            08647001
086480         PERFORM 8100-SUM-PROMPTED-UNITS                          08648001
086490         PERFORM 8150-SELECT-CURRENT-CARTON                       08649001
086500*THIN    PERFORM 1660-BUILD-TSUATRN                               08650001
086600         IF PS-DUMP-TO-LOG                                        08660001
086700             CONTINUE                                             08670001
086800         ELSE                                                     08680001
086900             IF SUT00015-UNT-QTY >                                08690001
087000                          (SHUUPC-SHPD-QTY + PV-SHPD-QTY-SUM)     08700001
087100                 PERFORM 8200-SUM-CARTONS                         08710001
087200*THIN            IF SUT00015-CART-QTY > PV-CARTON-COUNT           08720001
087300*THIN                CONTINUE                                     08730001
087400*THIN            ELSE                                             08740001
087500*THIN                PERFORM 1490-UPDATE-REQ-BY-TYPE              08750001
087600*THIN            END-IF                                           08760001
087700*THIN        ELSE                                                 08770001
087800*THIN            PERFORM 1490-UPDATE-REQ-BY-TYPE                  08780001
087900*THIN        END-IF                                               08790001
088000             SET SU021-AUDIT-REQUIRED TO TRUE                     08800001
088100         END-IF                                                   08810001
088200     ELSE                                                         08820001
088300         IF SU021-PACKAGE-TYPE-CODE = 'PP'                        08830001
088400             MOVE SU021-DRIVER-LINE-NBR TO DK-PO-DRIVER-LINE      08840001
088500             PERFORM 8900-SUM-PP-PROMPTED-UNITS                   08850001
088600             PERFORM 8950-SELECT-CURRENT-PP-CARTON                08860001
088700*THIN        PERFORM 1660-BUILD-TSUATRN                           08870001
088800             IF PS-DUMP-TO-LOG                                    08880001
088900                 CONTINUE                                         08890001
089000             ELSE                                                 08900001
089100                 IF SUT00015-UNT-QTY >                            08910001
089200                          (SHUUPC-SHPD-QTY + PV-SHPD-QTY-SUM)     08920001
089300                     PERFORM 8200-SUM-CARTONS                     08930001
089400*THIN                IF SUT00015-CART-QTY > PV-CARTON-COUNT       08940001
089500*THIN                    CONTINUE                                 08950001
089600*THIN                ELSE                                         08960001
089700*THIN                    PERFORM 1490-UPDATE-REQ-BY-TYPE          08970001
089800*THIN                END-IF                                       08980001
089900*THIN            ELSE                                             08990001
090000*THIN                PERFORM 1490-UPDATE-REQ-BY-TYPE              09000001
090100                 END-IF                                           09010004
090200                 SET SU021-AUDIT-REQUIRED TO TRUE                 09020001
090300             END-IF                                               09030001
090400         ELSE                                                     09040001
090500*    DETERMINE CARTON COUNT                                       09050001
090600*THIN        PERFORM 1660-BUILD-TSUATRN                           09060001
090700             IF PS-DUMP-TO-LOG                                    09070001
090800                 CONTINUE                                         09080001
090900             ELSE                                                 09090001
091000                 PERFORM 8200-SUM-CARTONS                         09100001
091100*THIN            IF SUT00015-CART-QTY > PV-CARTON-COUNT           09110001
091200*THIN                CONTINUE                                     09120001
091300*THIN            ELSE                                             09130001
091400*THIN                PERFORM 1490-UPDATE-REQ-BY-TYPE              09140001
091500*THIN            END-IF                                           09150001
091600                 SET SU021-AUDIT-REQUIRED TO TRUE                 09160001
091700             END-IF                                               09170001
091800         END-IF                                                   09180001
091900     END-IF.                                                      09190001
092000*THIN                                                             09200003
093500*-----------------------------------------------------------------09350001
093600*DETERMINE THE NUMBER OF CARTONS OR UNITS TO BE AUDITED.          09360001
093700*-----------------------------------------------------------------09370001
093800 1500-CALCULATE-QUANTITIES.                                       09380005
093900                                                                  09390005
093901     IF  PS-BLD-INTERNAL-TABLE-YES                                09390105
093902         MOVE '1500'  TO  PV-CSSL-PARA                            09390205
093903         PERFORM 9120-INTERNAL-TABLE                              09390305
093904     END-IF.                                                      09390405
093905                                                                  09390505
093906     STRING ' SUKCS752 - '                                        09390605
093907            ' 1500-CALCULATE-QUANTITIES'                          09390705
093908         DELIMITED BY SIZE                                        09390805
093909         INTO PV-CICS-MSG-AREA.                                   09390905
093910     PERFORM 9990-WRITE-CICS.                                     09391005
093920     IF SU021-PACKAGE-TYPE-CODE = 'PS'                            09392005
093930         PERFORM 1530-CALCULATE-PACK-BY-STORE                     09393005
093940     ELSE                                                         09394005
093950         IF SU021-PACKAGE-TYPE-CODE = 'BC'                        09395005
093960             PERFORM 1560-CALCULATE-BULK                          09396005
093970         ELSE                                                     09397005
093980             IF SU021-PACKAGE-TYPE-CODE = 'PP'                    09398005
093990                     PERFORM 1590-CALCULATE-PRE-PACK              09399005
094000             END-IF                                               09400005
094100         END-IF                                                   09410005
094200     END-IF.                                                      09420005
094300                                                                  09430005
094400 1530-CALCULATE-PACK-BY-STORE.                                    09440005
094500                                                                  09450005
094600     IF  PS-BLD-INTERNAL-TABLE-YES                                09460005
094700         MOVE '1530'  TO  PV-CSSL-PARA                            09470005
094800         PERFORM 9120-INTERNAL-TABLE                              09480005
094900     END-IF.                                                      09490005
095000                                                                  09500005
095100     STRING ' SUKCS752 - '                                        09510005
095200            ' 1530-CALCULATE-PACK-BY-STORE'                       09520005
095300         DELIMITED BY SIZE                                        09530005
095400         INTO PV-CICS-MSG-AREA.                                   09540005
095500     PERFORM 9990-WRITE-CICS.                                     09550005
095600     MOVE ZERO                 TO PV-UNITS-TO-AUDIT.              09560005
095700     PERFORM 8250-SELECT-EXPECTD-CNT.                             09570005
095800**  ADD 1 CARTON BECAUSE THE SUBSELECT IN THE 8250- PARA          09580005
095900**  REMOVED THE CURRENT CARTON THAT IS BEING PROCESSED            09590005
096000     COMPUTE PV-DB2-COUNT-EXP-SCN =                               09600005
096100             PV-DB2-COUNT-EXP-SCN + 1.                            09610005
096200     IF SUT00017-AUD-PCT > 0 AND                                  09620005
096300        PV-DB2-COUNT-EXP-SCN > 0                                  09630005
096400         COMPUTE PV-CARTONS-TO-AUDIT ROUNDED =                    09640005
096500           (PV-DB2-COUNT-EXP-SCN * (SUT00017-AUD-PCT / 100))      09650005
096600         IF PV-CARTONS-TO-AUDIT < 1                               09660005
096700             MOVE 1 TO    PV-CARTONS-TO-AUDIT                     09670005
096800         END-IF                                                   09680005
096900     ELSE                                                         09690005
097000         MOVE PV-DB2-COUNT-EXP-SCN TO PV-CARTONS-TO-AUDIT         09700005
097100     END-IF.                                                      09710005
097200     IF PV-CARTONS-TO-AUDIT < SUT00017-MIN-CART-CKD-QTY AND       09720005
097300        PV-DB2-COUNT-EXP-SCN > SUT00017-MIN-CART-CKD-QTY          09730005
097400         MOVE SUT00017-MIN-CART-CKD-QTY TO PV-CARTONS-TO-AUDIT    09740005
097500     ELSE                                                         09750005
097600         IF PV-CARTONS-TO-AUDIT > SUT00017-MAX-CART-CKD-QTY       09760005
097700             MOVE SUT00017-MAX-CART-CKD-QTY                       09770005
097800                                        TO PV-CARTONS-TO-AUDIT    09780005
097900         END-IF                                                   09790005
098000     END-IF.                                                      09800005
098001                                                                  09800106
098002     MOVE SUT00017-AUD-PCT               TO PV-DISP-THIN1.        09800206
098003     MOVE PV-DB2-COUNT-EXP-SCN           TO PV-DISP-THIN2.        09800306
098004     MOVE PV-CARTONS-TO-AUDIT            TO PV-DISP-THIN3.        09800406
098005     MOVE SUT00017-MIN-CART-CKD-QTY      TO PV-DISP-THIN4.        09800506
098006     MOVE SUT00017-MAX-CART-CKD-QTY      TO PV-DISP-THIN5.        09800606
098007                                                                  09800706
098010     STRING ' SUKCS752 - '                                        09801006
098020            ' 1530- '                                             09802006
098021            ' SUT00017-AUD-PCT:         ' PV-DISP-THIN1           09802106
098030         DELIMITED BY SIZE                                        09803006
098040         INTO PV-CICS-MSG-AREA.                                   09804006
098050     PERFORM 9990-WRITE-CICS.                                     09805006
098051                                                                  09805106
098052     STRING ' SUKCS752 - '                                        09805206
098053            ' 1530- '                                             09805306
098054            ' PV-DB2-COUNT-EXP-SCN:     ' PV-DISP-THIN2           09805406
098055         DELIMITED BY SIZE                                        09805506
098056         INTO PV-CICS-MSG-AREA.                                   09805606
098057     PERFORM 9990-WRITE-CICS.                                     09805706
098058                                                                  09805806
098060     STRING ' SUKCS752 - '                                        09806006
098070            ' 1530- '                                             09807006
098080            ' PV-CARTONS-TO-AUDIT:      ' PV-DISP-THIN3           09808006
098090         DELIMITED BY SIZE                                        09809006
098091         INTO PV-CICS-MSG-AREA.                                   09809106
098092     PERFORM 9990-WRITE-CICS.                                     09809206
098093                                                                  09809306
098094     STRING ' SUKCS752 - '                                        09809406
098095            ' 1530- '                                             09809506
098096            ' SUT00017-MIN-CART-CKD-QTY:' PV-DISP-THIN4           09809606
098097         DELIMITED BY SIZE                                        09809706
098098         INTO PV-CICS-MSG-AREA.                                   09809806
098099     PERFORM 9990-WRITE-CICS.                                     09809906
098100                                                                  09810006
098101     STRING ' SUKCS752 - '                                        09810106
098102            ' 1530- '                                             09810206
098103            ' SUT00017-MAX-CART-CKD-QTY ' PV-DISP-THIN5           09810306
098104         DELIMITED BY SIZE                                        09810406
098105         INTO PV-CICS-MSG-AREA.                                   09810506
098106     PERFORM 9990-WRITE-CICS.                                     09810606
098110                                                                  09811005
098130     move spaces to pv-cics-msg-area                              09813006
098180     PERFORM 9990-WRITE-CICS.                                     09818006
098190                                                                  09819006
098200 1560-CALCULATE-BULK.                                             09820005
098300                                                                  09830005
098400     IF  PS-BLD-INTERNAL-TABLE-YES                                09840005
098500         MOVE '1560'  TO  PV-CSSL-PARA                            09850005
098600         PERFORM 9120-INTERNAL-TABLE                              09860005
098700     END-IF.                                                      09870005
098701                                                                  09870105
098702     STRING ' SUKCS752 - '                                        09870205
098703            ' 1560-CALCULATE-BULK'                                09870305
098704         DELIMITED BY SIZE                                        09870405
098705         INTO PV-CICS-MSG-AREA.                                   09870505
098706     PERFORM 9990-WRITE-CICS.                                     09870605
098707     PERFORM 8450-SELECT-DIST-HEAD.                               09870705
098708     IF DISTHD-OTPK-UNT-QTY = 0                                   09870805
098709         PERFORM 8500-SUM-DISTRO-DETAIL                           09870905
098710         MOVE PV-SUM-EXPTD-ALLOC   TO PV-TOTAL-UNITS              09871005
098720     ELSE                                                         09872005
098730         COMPUTE PV-TOTAL-UNITS =                                 09873005
098740              DISTHD-TOT-CART-CNT * DISTHD-OTPK-UNT-QTY           09874005
098750     END-IF.                                                      09875005
098760     IF SUT00017-AUD-PCT > 0 AND                                  09876005
098770        PV-TOTAL-UNITS > 0                                        09877005
098780         COMPUTE PV-UNITS-TO-AUDIT ROUNDED =                      09878005
098790           (PV-TOTAL-UNITS * (SUT00017-AUD-PCT / 100))            09879005
098800         IF PV-UNITS-TO-AUDIT = 0                                 09880005
098900             MOVE 1              TO PV-UNITS-TO-AUDIT             09890005
099000         END-IF                                                   09900005
099100     ELSE                                                         09910005
099200         MOVE PV-TOTAL-UNITS TO PV-UNITS-TO-AUDIT                 09920005
099300     END-IF.                                                      09930005
099400                                                                  09940005
099500     MOVE DK-PO-LINE-NBR            TO DK-SHUUPC-LNE-NBR.         09950005
099600     PERFORM 8800-COUNT-CHECKED-IN-CRTNS.                         09960005
099700**  ADD 1 TO THE TOTAL-CARTON-TO-AUDIT BECAUSE THE CARTON WE ARE  09970005
099800**  PROCESSING  WOULD HAVE BEEN INCLUDED IN THE COUNT COMING      09980005
099900**  FROM THE 8800- PARA - AND WE ARE SUBTRACTING THAT COUNT       09990005
100000     COMPUTE DISTHD-TOT-CART-CNT =                                10000005
100100            (DISTHD-TOT-CART-CNT + 1) - PV-CHECK-IN-COUNT.        10010005
100200     IF DISTHD-TOT-CART-CNT > SUT00017-MAX-CART-CKD-QTY           10020005
100300         MOVE SUT00017-MAX-CART-CKD-QTY                           10030005
100400                                    TO PV-CARTONS-TO-AUDIT        10040005
100500     ELSE                                                         10050005
100600         MOVE DISTHD-TOT-CART-CNT   TO PV-CARTONS-TO-AUDIT        10060005
100700     END-IF.                                                      10070005
100800                                                                  10080005
100900                                                                  10090005
101000 1590-CALCULATE-PRE-PACK.                                         10100005
101100                                                                  10110005
101200     IF  PS-BLD-INTERNAL-TABLE-YES                                10120005
101300         MOVE '1590'  TO  PV-CSSL-PARA                            10130005
101400         PERFORM 9120-INTERNAL-TABLE                              10140005
101500     END-IF.                                                      10150005
101600                                                                  10160005
101700     STRING ' SUKCS752 - '                                        10170005
101800            ' 1590-CALCULATE-PRE-PACK'                            10180005
101900         DELIMITED BY SIZE                                        10190005
102000         INTO PV-CICS-MSG-AREA.                                   10200005
102100     PERFORM 9990-WRITE-CICS.                                     10210005
102200     MOVE SU021-DRIVER-LINE-NBR TO DK-PO-DRIVER-LINE.             10220005
102300     PERFORM 8600-SELECT-DRIVER-LINE-QTY.                         10230005
102400     PERFORM 8650-SUM-PRE-PACK-DETAIL.                            10240005
102500     IF SUT00017-AUD-PCT > 0 AND                                  10250005
102600        PV-SUM-OF-ALL-LINES > 0                                   10260005
102700         COMPUTE PV-UNITS-TO-AUDIT ROUNDED =                      10270005
102800           (PV-SUM-OF-ALL-LINES * (SUT00017-AUD-PCT / 100))       10280005
102900         IF PV-UNITS-TO-AUDIT = 0                                 10290005
103000             MOVE 1              TO PV-UNITS-TO-AUDIT             10300005
103100         END-IF                                                   10310005
103200     ELSE                                                         10320005
103300         MOVE PV-SUM-OF-ALL-LINES       TO PV-UNITS-TO-AUDIT      10330005
103400     END-IF.                                                      10340005
103500                                                                  10350005
103600     MOVE DK-PO-DRIVER-LINE         TO DK-SHUUPC-LNE-NBR.         10360005
103700     PERFORM 8800-COUNT-CHECKED-IN-CRTNS.                         10370005
103800**  ADD 1 TO THE TOTAL-CARTON-TO-AUDIT BECAUSE THE CARTON WE ARE  10380005
103900**  PROCESSING  WOULD HAVE BEEN INCLUDED IN THE COUNT COMING      10390005
104000**  FROM THE 8800- PARA - AND WE ARE SUBTRACTING THAT COUNT       10400005
104100     COMPUTE DISTHD-TOT-CART-CNT =                                10410005
104200            (DISTHD-TOT-CART-CNT + 1) - PV-CHECK-IN-COUNT.        10420005
104300     IF DISTHD-TOT-CART-CNT > SUT00017-MAX-CART-CKD-QTY           10430005
104400         MOVE SUT00017-MAX-CART-CKD-QTY                           10440005
104500                                    TO PV-CARTONS-TO-AUDIT        10450005
104600     ELSE                                                         10460005
104700         MOVE DISTHD-TOT-CART-CNT TO PV-CARTONS-TO-AUDIT          10470005
104800     END-IF.                                                      10480005
104900                                                                  10490005
105000 1600-INSERT-INTO-TABLES.                                         10500007
105100                                                                  10510007
105110***   ---- THIS PARAGRAPH INDICATES THE CARTON IS FOR AUDIT GROUP 10511007
105120                                                                  10512007
105200     IF  PS-BLD-INTERNAL-TABLE-YES                                10520007
105300         MOVE '1600'  TO  PV-CSSL-PARA                            10530007
105400         PERFORM 9120-INTERNAL-TABLE                              10540007
105500     END-IF.                                                      10550007
105600                                                                  10560007
105700     STRING ' SUKCS752 - '                                        10570007
105800            ' 1600-INSERT-INTO-TABLES'                            10580007
105900         DELIMITED BY SIZE                                        10590007
106000         INTO PV-CICS-MSG-AREA.                                   10600007
106100     PERFORM 9990-WRITE-CICS.                                     10610007
106110                                                                  10611007
106200     SET PS-AUDIT-NBR-EXISTS                                      10620007
106300         SU021-AUDIT-REQUIRED  TO  TRUE.                          10630008
106310     MOVE 'Y'  TO  SU021-AUDIT-REQUIRED-SW.                       10631010
106400                                                                  10640009
122404                                                                  12240401
122405 1700-RETURN-WITH-EXC-VALUES.                                     12240501
122406     STRING ' SUKCS752 - '                                        12240601
122407            ' 1700-RETURN-WITH-EXC-VALUES'                        12240701
122408         DELIMITED BY SIZE                                        12240801
122409         INTO PV-CICS-MSG-AREA.                                   12240901
122410     PERFORM 9990-WRITE-CICS.                                     12241001
122420     IF SUT00014-AUD-TYP-CDE = PC-N                               12242001
122430         SET SU021-AUDIT-IS-COMPLETE TO TRUE                      12243001
122440     ELSE                                                         12244001
122450*CLP 12/04/13 START                                               12245001
122460*        PC-R IS FOR RFID - NEEDED FOR PO EXECEPTION              12246001
122470*                           EVEN THOUGH IN QC MODULE              12247001
122480         IF SUT00014-AUD-TYP-CDE = PC-A OR PC-Q OR PC-R           12248001
122490             SET SU021-100-PC-AUDIT-REQD TO TRUE                  12249001
122500         ELSE                                                     12250001
122600             SET SU021-DB2-ERROR TO TRUE                          12260001
122700         END-IF                                                   12270001
122800*CLP 12/04/13 END                                                 12280001
122900     END-IF.                                                      12290001
123000                                                                  12300001
123100 2000-AUDIT-CARTON-DATA.                                          12310001
123200                                                                  12320001
123300     IF  PS-BLD-INTERNAL-TABLE-YES                                12330001
123400         MOVE '2000'  TO  PV-CSSL-PARA                            12340001
123401         PERFORM 9120-INTERNAL-TABLE                              12340101
123402     END-IF.                                                      12340201
123403                                                                  12340301
123404     STRING ' SUKCS752 - '                                        12340401
123405            ' 2000-AUDIT-CARTON-DATA'                             12340501
123406         DELIMITED BY SIZE                                        12340601
123407         INTO PV-CICS-MSG-AREA.                                   12340701
123408     PERFORM 9990-WRITE-CICS.                                     12340801
123409                                                                  12340901
123410 7000-SELECT-REQ-INFO.                                            12341001
123420                                                                  12342001
123430     IF  PS-BLD-INTERNAL-TABLE-YES                                12343001
123440         MOVE '7000'  TO  PV-CSSL-PARA                            12344001
123450         PERFORM 9120-INTERNAL-TABLE                              12345001
123460     END-IF.                                                      12346001
123470                                                                  12347001
123480     STRING ' SUKCS752 - '                                        12348001
123490            ' 7000-SELECT-REQ-INFO'                               12349001
123500         DELIMITED BY SIZE                                        12350001
123600         INTO PV-CICS-MSG-AREA.                                   12360001
123700     PERFORM 9990-WRITE-CICS.                                     12370001
123800                                                                  12380001
123900     INITIALIZE DCLSUT00015.                                      12390001
124000                                                                  12400001
124100     EXEC SQL                                                     12410001
124200          SELECT AUD_CNTL_NBR                                     12420001
124300             ,   VND_RNKG_CDE                                     12430001
124400             ,   PKGNG_TYP_CDE                                    12440001
124500             ,   EFF_BEG_TMST                                     12450001
124600             ,   AUD_STAT_CDE                                     12460001
124700             ,   CART_PRMPT_CDE                                   12470001
124800             ,   ENT_ID                                           12480001
124900             ,   DEPT_NBR                                         12490001
125000          INTO   :SUT00015-AUD-CNTL-NBR                           12500001
125100             ,   :SUT00015-VND-RNKG-CDE                           12510001
125200             ,   :SUT00015-PKGNG-TYP-CDE                          12520001
125300             ,   :SUT00015-EFF-BEG-TMST                           12530001
125400             ,   :SUT00015-AUD-STAT-CDE                           12540001
125500             ,   :SUT00015-CART-PRMPT-CDE                         12550001
125600             ,   :SUT00015-ENT-ID                                 12560001
125700             ,   :SUT00015-DEPT-NBR                               12570001
125800          FROM   SUT_PO_AUD_REQ                                   12580001
125900          WHERE  PO_NBR         = :DK-PO-NBR                      12590001
126000            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 12600001
126100            AND  PO_PREPK_ID    = :DK-PREPK-ID                    12610001
126200            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                12620001
126300            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 12630001
126500            AND  PKGNG_TYP_CDE  <> 'RF'                           12650001
126600           with ur                                                12660002
126700     END-EXEC.                                                    12670001
126800                                                                  12680001
126900     EVALUATE TRUE                                                12690001
127000         WHEN SQLCODE = ZERO                                      12700001
127100         WHEN SQLCODE = -811                                      12710001
127200             SET PS-REQ-REC-FOUND TO TRUE                         12720001
127300         WHEN SQLCODE = +100                                      12730001
127400             SET PS-NO-REQ-REC-FOUND TO TRUE                      12740001
127500         WHEN SQLWARN0 NOT = SPACES                               12750001
127600         WHEN SQLCODE NOT EQUAL ZERO                              12760001
127700              MOVE '7000'  TO  PV-CSSL-PARA                       12770001
127800              PERFORM 9110-WRITE-SURD021-TO-CSSL                  12780001
127900                                                                  12790001
128000             MOVE '7000-SELECT-REQ-INFO'                          12800001
128100                             TO DP013-PARAGRAPH                   12810001
128200             MOVE 'SUKCS752 - GET BULK REQ RECS'                  12820001
128300                             TO DP013-MESSAGE-TEXT(1)             12830001
128310             MOVE DK-OPER-UNT-ID  TO PV-DISPLAY-OPER              12831001
128320             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            12832001
128330             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      12833001
128340             MOVE DK-PO-LINE-NBR  TO PV-DISPLAY-PO-LINE-NBR       12834001
128350             MOVE DK-PREPK-ID     TO PV-DISPLAY-PREPK             12835001
128360             STRING 'PO:'            PV-DISPLAY-OPER              12836001
128370                    '-'              PV-DISPLAY-PO-NBR            12837001
128380                    '-'              PV-DISPLAY-RCVR-SEQ-NBR      12838001
128390                    '-'              PV-DISPLAY-PO-LINE-NBR       12839001
128391                    ' PREPK:'        PV-DISPLAY-PREPK             12839101
128392                                     DELIMITED BY SIZE            12839201
128393                           INTO DP013-MESSAGE-TEXT(2)             12839301
128394             MOVE SQLCA      TO DP013-SQLCA                       12839401
128395             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           12839501
128396             SET DP013-DB2-ABEND                                  12839601
128397                             TO TRUE                              12839701
128398             SET DP013-NO-ROLLBACK                                12839801
128399                             TO TRUE                              12839901
128400             PERFORM 9999-WRITE-CICS-LOG-MSG                      12840001
128500             SET PS-DUMP-TO-LOG       TO TRUE                     12850001
128600             SET SU021-DB2-ERROR TO TRUE                          12860001
128700     END-EVALUATE.                                                12870001
128800                                                                  12880001
128900******************************************************************12890001
129000*  7100-CHECK-FOR-BYPASS                                         *12900001
129100*  USING THE PO/RECEIVER FROM THE COMM AREA, RUN THIS SQL TO     *12910001
129200*  SEE IF THE OPER_UNT_ID FROM TRECEIV MAY BE SET UP ON THE      *12920001
129300*  PARM TABLE FOR PARM BYQAUD TO SEE IF WE ARE TO BYPASS         *12930001
129400*  PROMPTING AN AUDIT FOR MERCHANDISE BEING WORKED FOR THAT      *12940001
129500*  OPER UNIT ID.                                                 *12950001
129600*  FYI - IF A ROW IS FOUND IN THIS SQL, THAT MEANS THE DC IS     *12960001
129700*  SET UP TO BYPASS AUDIT PROMPTING - WHEN THAT IS THE CASE,     *12970001
129800*  THE PROGRAM WILL CHECK TO SEE IF SOMETHING HAD BEEN FOUND IN  *12980001
129900*  THE 1200-CHECK-PO-AUDIT-EXC PARAGRAPH AND IF NOT, THEN THE    *12990001
130000*  PROGRAM WILL SET THE PS-PO-LEVEL-FOUND TO TRUE AND MOVE A     *13000001
130100*  VALUE OF 'N' TO THE SUT00014-AUD-TYP-CDE FIELD SO THAT THE    *13010001
130200*  PROGRAM WILL NOW PROCESS THIS AUDIT CHECK AS IF THE RECEIVER  *13020001
130300*  WAS SET TO NO PROMPT FOR AUDITS.  IF AN EXCEPTION HAD BEEN    *13030001
130400*  FOUND IN THE 1200-CHECK-PO-AUDIT-EXC CALL, THEN NOTHING MORE  *13040001
130500*  WILL BE DONE AS THE PROGRAM WILL NOT PROMPT FOR AN AUDIT      *13050001
130600*  BECAUSE OF THE AUDIT EXCEPTION FOUND WHICH HAS PRIORITY OVER  *13060001
130700*  AUDIT PROMPTING.                                              *13070001
130800******************************************************************13080001
130900 7100-CHECK-FOR-BYPASS.                                           13090001
131000                                                                  13100001
131100     IF  PS-BLD-INTERNAL-TABLE-YES                                13110001
131200         MOVE '7100'  TO  PV-CSSL-PARA                            13120001
131210         PERFORM 9120-INTERNAL-TABLE                              13121001
131220     END-IF.                                                      13122001
131230                                                                  13123001
131240     STRING ' SUKCS752 - '                                        13124001
131250            ' 7100-CHECK-FOR-BYPASS'                              13125001
131260         DELIMITED BY SIZE                                        13126001
131270         INTO PV-CICS-MSG-AREA.                                   13127001
131280     PERFORM 9990-WRITE-CICS.                                     13128001
131290     EXEC SQL                                                     13129001
131291          SELECT A.OPER_UNT_ID                                    13129101
131292          INTO   :RECEIV-OPER-UNT-ID                              13129201
131293          FROM   TRECEIV A                                        13129301
131294             ,   TKRPRPM B                                        13129401
131295          WHERE  A.ORD_NBR           = :DK-BYPASS-PO-NBR          13129501
131296            AND  A.REC_SEQ_NBR       = :DK-BYPASS-REC-SEQ-NBR     13129601
131297            AND  B.LOC_ID            = A.OPER_UNT_ID              13129701
131298            AND  B.INTFC_SYS_CDE     = 'AUD'                      13129801
131299            AND  B.SYS_PRC_FUNC_CDE  = 'BYQAUD'                   13129901
131300            AND  B.FUNC_TXT          = 'Y'                        13130001
131301            AND  B.FUNC_BEG_TMST    <= CURRENT TIMESTAMP          13130101
131302            AND  B.FUNC_END_TMST    >= CURRENT TIMESTAMP          13130201
131303            AND  B.FUNC_PRC_STAT_CDE = 'AC'                       13130301
131304           WITH UR                                                13130401
131305     END-EXEC.                                                    13130501
131306                                                                  13130601
131307     EVALUATE TRUE                                                13130701
131308         WHEN SQLCODE = ZERO                                      13130801
131309             SET PS-BYPASS-PROMPT-AUDIT TO TRUE                   13130901
131310             IF  PS-NO-LINE-LEVEL-FOUND                           13131001
131311             AND PS-NO-PO-LEVEL-FOUND                             13131101
131312                 SET PS-PO-LEVEL-FOUND TO TRUE                    13131201
131313                 MOVE 'N' TO SUT00014-AUD-TYP-CDE                 13131301
131314             END-IF                                               13131401
131315         WHEN SQLCODE = +100                                      13131501
131316             SET PS-BYPASS-PROMPT-AUDIT-NO TO TRUE                13131601
131317         WHEN SQLWARN0 NOT = SPACES                               13131701
131318         WHEN SQLCODE NOT EQUAL ZERO                              13131801
131319              MOVE '7100'  TO  PV-CSSL-PARA                       13131901
131320              PERFORM 9110-WRITE-SURD021-TO-CSSL                  13132001
131321                                                                  13132101
131322             MOVE '7100-CHECK-FOR-BYPASS '                        13132201
131323                             TO DP013-PARAGRAPH                   13132301
131324             MOVE 'SUKCS752 - CHECK FOR BYPASS OF AUDIT '         13132401
131325                             TO DP013-MESSAGE-TEXT(1)             13132501
131326             MOVE DK-BYPASS-PO-NBR  TO PV-DISPLAY-PO-NBR          13132601
131327             MOVE DK-BYPASS-REC-SEQ-NBR TO                        13132701
131328                  PV-DISPLAY-RCVR-SEQ-NBR                         13132801
131329             STRING 'PO/REC: '      PV-DISPLAY-PO-NBR             13132901
131330                    ' - '           PV-DISPLAY-RCVR-SEQ-NBR       13133001
131331              DELIMITED BY SIZE                                   13133101
131332                           INTO DP013-MESSAGE-TEXT(2)             13133201
131333             MOVE SQLCA      TO DP013-SQLCA                       13133301
131334             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           13133401
131335             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(2)           13133501
131336             SET DP013-DB2-ABEND                                  13133601
131337                             TO TRUE                              13133701
131338             SET DP013-NO-ROLLBACK                                13133801
131339                             TO TRUE                              13133901
131340             PERFORM 9999-WRITE-CICS-LOG-MSG                      13134001
131341             SET PS-DUMP-TO-LOG       TO TRUE                     13134101
131342             SET SU021-DB2-ERROR TO TRUE                          13134201
131343     END-EVALUATE.                                                13134301
131344                                                                  13134401
131345 7150-RETREIVE-PO-INFO.                                           13134501
131346                                                                  13134601
131347     IF  PS-BLD-INTERNAL-TABLE-YES                                13134701
131348         MOVE '7150'  TO  PV-CSSL-PARA                            13134801
131349         PERFORM 9120-INTERNAL-TABLE                              13134901
131350     END-IF.                                                      13135001
131360                                                                  13136001
131370     STRING ' SUKCS752 - '                                        13137001
131380            ' 7150-RETREIVE-PO-INFO'                              13138001
131390         DELIMITED BY SIZE                                        13139001
131400         INTO PV-CICS-MSG-AREA.                                   13140001
131500     PERFORM 9990-WRITE-CICS.                                     13150001
131600     EXEC SQL                                                     13160001
131700          SELECT DEPT_NBR                                         13170001
131800              ,  ENT_ID                                           13180001
131900          INTO   :PURCHS-DEPT-NBR                                 13190001
132000              ,  :PURCHS-ENT-ID                                   13200001
132100          FROM   TPURCHS                                          13210001
132200          WHERE  PO_NBR   = :DK-PO-NBR                            13220001
132300            AND  VER_STATUS_CDE = 'A'                             13230001
132400           WITH UR                                                13240001
132500     END-EXEC.                                                    13250001
132600                                                                  13260001
132700     EVALUATE TRUE                                                13270001
132800         WHEN SQLCODE = ZERO                                      13280001
132900             SET PS-PO-INFO-FOUND TO TRUE                         13290001
133000         WHEN SQLCODE = +100                                      13300001
133100             SET PS-NO-PO-INFO-FOUND TO TRUE                      13310001
133200         WHEN SQLWARN0 NOT = SPACES                               13320001
133300         WHEN SQLCODE NOT EQUAL ZERO                              13330001
133400              MOVE '7150'  TO  PV-CSSL-PARA                       13340001
133500              PERFORM 9110-WRITE-SURD021-TO-CSSL                  13350001
133600                                                                  13360001
133610             MOVE '7150-RETREIVE-PO-INFO'                         13361001
133620                             TO DP013-PARAGRAPH                   13362001
133630             MOVE 'SUKCS752 - GET PO INFO '                       13363001
133640                             TO DP013-MESSAGE-TEXT(1)             13364001
133650             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 13365001
133660             STRING 'PO:'       PV-DISPLAY-PO-NBR                 13366001
133670              DELIMITED BY SIZE                                   13367001
133680                           INTO DP013-MESSAGE-TEXT(2)             13368001
133690             MOVE SQLCA      TO DP013-SQLCA                       13369001
133700             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME(1)           13370001
133800             SET DP013-DB2-ABEND                                  13380001
133900                             TO TRUE                              13390001
134000             SET DP013-NO-ROLLBACK                                13400001
134100                             TO TRUE                              13410001
134200             PERFORM 9999-WRITE-CICS-LOG-MSG                      13420001
134300             SET PS-DUMP-TO-LOG       TO TRUE                     13430001
134400             SET PS-NO-PO-INFO-FOUND TO TRUE                      13440001
134500             SET SU021-DB2-ERROR TO TRUE                          13450001
134600     END-EVALUATE.                                                13460001
134700                                                                  13470001
134800 7190-RETREIVE-PO-AUD-PARM.                                       13480001
134900                                                                  13490001
135000     IF  PS-BLD-INTERNAL-TABLE-YES                                13500001
135100         MOVE '7190'  TO  PV-CSSL-PARA                            13510001
135200         PERFORM 9120-INTERNAL-TABLE                              13520001
135300     END-IF.                                                      13530001
135400                                                                  13540001
135500     STRING ' SUKCS752 - '                                        13550001
135600            ' 7190-RETREIVE-PO-AUD-PARM'                          13560001
135700         DELIMITED BY SIZE                                        13570001
135800         INTO PV-CICS-MSG-AREA.                                   13580001
135900     PERFORM 9990-WRITE-CICS.                                     13590001
136000     EXEC SQL                                                     13600001
136100          SELECT VND_RNKG_CDE                                     13610001
136200              ,  PKGNG_TYP_CDE                                    13620001
136300              ,  EFF_BEG_TMST                                     13630001
136400              ,  AUD_PCT                                          13640001
136500              ,  CKD_PCT                                          13650001
136600              ,  MAX_CKD_QTY                                      13660001
136700              ,  MAX_CART_CKD_QTY                                 13670001
136800              ,  MIN_CART_CKD_QTY                                 13680001
136900              ,  CKD_DC_QTY                                       13690001
137000              ,  MAX_PO_LNE_QTY                                   13700001
137100              ,  CK_AFT_DAY_QTY                                   13710001
137200              ,  CK_AFT_RCVR_QTY                                  13720001
137300              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         13730001
137400          INTO   :SUT00017-VND-RNKG-CDE                           13740001
137500              ,  :SUT00017-PKGNG-TYP-CDE                          13750001
137600              ,  :SUT00017-EFF-BEG-TMST                           13760001
137700              ,  :SUT00017-AUD-PCT                                13770001
137800              ,  :SUT00017-CKD-PCT                                13780001
137900              ,  :SUT00017-MAX-CKD-QTY                            13790001
138000              ,  :SUT00017-MAX-CART-CKD-QTY                       13800001
138100              ,  :SUT00017-MIN-CART-CKD-QTY                       13810001
138200              ,  :SUT00017-CKD-DC-QTY                             13820001
138300              ,  :SUT00017-MAX-PO-LNE-QTY                         13830001
138400              ,  :SUT00017-CK-AFT-DAY-QTY                         13840001
138500              ,  :SUT00017-CK-AFT-RCVR-QTY                        13850001
138600              ,  :PV-LIMIT-DAYS                                   13860001
138700          FROM   SUT_PO_AUD_PARM A                                13870001
138800          WHERE  A.VND_RNKG_CDE  = :SUT00015-VND-RNKG-CDE         13880001
138900            AND  A.PKGNG_TYP_CDE = :SUT00015-PKGNG-TYP-CDE        13890001
139000            AND  A.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         13900001
139100           WITH UR                                                13910001
139200     END-EXEC.                                                    13920001
139300                                                                  13930001
139400     EVALUATE TRUE                                                13940001
139500         WHEN SQLCODE = ZERO                                      13950001
139600             CONTINUE                                             13960001
139700         WHEN SQLWARN0 NOT = SPACES                               13970001
139800         WHEN SQLCODE NOT EQUAL ZERO                              13980001
139900              MOVE '7190'  TO  PV-CSSL-PARA                       13990001
140000              PERFORM 9110-WRITE-SURD021-TO-CSSL                  14000001
140010                                                                  14001001
140020             MOVE '7190-RETREIVE-PO-AUD-PARM'                     14002001
140030                             TO DP013-PARAGRAPH                   14003001
140040             MOVE 'SUKCS752 - GET AUD PARM DATA '                 14004001
140050                             TO DP013-MESSAGE-TEXT(1)             14005001
140060             STRING 'RANK:'     SUT00015-VND-RNKG-CDE             14006001
140070                    ' PKG TYP:' SUT00015-PKGNG-TYP-CDE            14007001
140080                    ' BEG:'     SUT00015-EFF-BEG-TMST             14008001
140090                                DELIMITED BY SIZE                 14009001
140100                           INTO DP013-MESSAGE-TEXT(2)             14010001
140200             MOVE SQLCA      TO DP013-SQLCA                       14020001
140300             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(1)           14030001
140400             SET DP013-DB2-ABEND                                  14040001
140500                             TO TRUE                              14050001
140600             SET DP013-NO-ROLLBACK                                14060001
140700                             TO TRUE                              14070001
140800             PERFORM 9999-WRITE-CICS-LOG-MSG                      14080001
140900             SET PS-DUMP-TO-LOG       TO TRUE                     14090001
141000             SET PS-NO-PO-INFO-FOUND TO TRUE                      14100001
141100             SET SU021-DB2-ERROR TO TRUE                          14110001
141200     END-EVALUATE.                                                14120001
141300                                                                  14130001
141400 7200-RETREIVE-VENDOR-DEPT.                                       14140001
141500                                                                  14150001
141600     IF  PS-BLD-INTERNAL-TABLE-YES                                14160001
141700         MOVE '7200'  TO  PV-CSSL-PARA                            14170001
141800         PERFORM 9120-INTERNAL-TABLE                              14180001
141900     END-IF.                                                      14190001
142000                                                                  14200001
142100     STRING ' SUKCS752 - '                                        14210001
142200            ' 7200-RETREIVE-VENDOR-DEPT'                          14220001
142300         DELIMITED BY SIZE                                        14230001
142400         INTO PV-CICS-MSG-AREA.                                   14240001
142500     PERFORM 9990-WRITE-CICS.                                     14250001
142600     EXEC SQL                                                     14260001
142700          SELECT B.VND_RNKG_CDE                                   14270001
142800              ,  B.PKGNG_TYP_CDE                                  14280001
142900              ,  EFF_BEG_TMST                                     14290001
143000              ,  AUD_PCT                                          14300001
143100              ,  CKD_PCT                                          14310001
143200              ,  MAX_CKD_QTY                                      14320001
143300              ,  MAX_CART_CKD_QTY                                 14330001
143400              ,  MIN_CART_CKD_QTY                                 14340001
143500              ,  CKD_DC_QTY                                       14350001
143600              ,  MAX_PO_LNE_QTY                                   14360001
143700              ,  CK_AFT_DAY_QTY                                   14370001
143800              ,  CK_AFT_RCVR_QTY                                  14380001
143900              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         14390001
144000          INTO   :SUT00017-VND-RNKG-CDE                           14400001
144100              ,  :SUT00017-PKGNG-TYP-CDE                          14410001
144200              ,  :SUT00017-EFF-BEG-TMST                           14420001
144300              ,  :SUT00017-AUD-PCT                                14430001
144400              ,  :SUT00017-CKD-PCT                                14440001
144410              ,  :SUT00017-MAX-CKD-QTY                            14441001
144420              ,  :SUT00017-MAX-CART-CKD-QTY                       14442001
144430              ,  :SUT00017-MIN-CART-CKD-QTY                       14443001
144440              ,  :SUT00017-CKD-DC-QTY                             14444001
144450              ,  :SUT00017-MAX-PO-LNE-QTY                         14445001
144460              ,  :SUT00017-CK-AFT-DAY-QTY                         14446001
144470              ,  :SUT00017-CK-AFT-RCVR-QTY                        14447001
144480              ,  :PV-LIMIT-DAYS                                   14448001
144490          FROM   SUT_VND_DEPT_RNKG A                              14449001
144500             ,   SUT_PO_AUD_PARM   B                              14450001
144501          WHERE  A.ENT_ID        = :DK-ENT-ID                     14450101
144502            AND  A.DEPT_NBR      = :DK-DEPT-NBR                   14450201
144503            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              14450301
144504            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 14450401
144505            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                14450501
144506            AND  B.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         14450601
144507           WITH UR                                                14450701
144508     END-EXEC.                                                    14450801
144509                                                                  14450901
144510     EVALUATE TRUE                                                14451001
144511         WHEN SQLCODE = ZERO                                      14451101
144512             SET PS-DEPT-RANK-FOUND TO TRUE                       14451201
144513         WHEN SQLCODE = +100                                      14451301
144514             SET PS-NO-DEPT-RANK-FOUND TO TRUE                    14451401
144515         WHEN SQLWARN0 NOT = SPACES                               14451501
144516         WHEN SQLCODE NOT EQUAL ZERO                              14451601
144517              MOVE '7200'  TO  PV-CSSL-PARA                       14451701
144518              PERFORM 9110-WRITE-SURD021-TO-CSSL                  14451801
144519                                                                  14451901
144520             MOVE '7200-RETREIVE-VENDOR-DEPT'                     14452001
144530                             TO DP013-PARAGRAPH                   14453001
144540             MOVE 'SUKCS752 - GET VENDOR DEPT'                    14454001
144550                             TO DP013-MESSAGE-TEXT(1)             14455001
144560             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                14456001
144561             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              14456101
144562             STRING 'ENT:'       PV-DISPLAY-ENT-ID                14456201
144563                    ' DEPT:'     PV-DISPLAY-DEPT-NBR              14456301
144564                    ' TYP:'      DK-PKGNG-TYP-CDE                 14456401
144565                    ' '          SUT00015-EFF-BEG-TMST            14456501
144566                                 DELIMITED BY SIZE                14456601
144567                           INTO DP013-MESSAGE-TEXT(2)             14456701
144568             MOVE SQLCA      TO DP013-SQLCA                       14456801
144569             MOVE 'SUT00018' TO DP013-DB2-TABLE-NAME(1)           14456901
144570             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           14457001
144580             SET DP013-DB2-ABEND                                  14458001
144590                             TO TRUE                              14459001
144600             SET DP013-NO-ROLLBACK                                14460001
144601                             TO TRUE                              14460101
144602             PERFORM 9999-WRITE-CICS-LOG-MSG                      14460201
144603             SET PS-DUMP-TO-LOG       TO TRUE                     14460301
144604             SET PS-NO-PO-INFO-FOUND TO TRUE                      14460401
144605             SET SU021-DB2-ERROR TO TRUE                          14460501
144606     END-EVALUATE.                                                14460601
144607                                                                  14460704
144608     STRING ' SUKCS752 - '                                        14460804
144609            ' 7200-RETREIVE-VENDOR-DEPT'                          14460904
144610            ' ' SUT00017-VND-RNKG-CDE                             14461004
144611            ' ' SUT00017-PKGNG-TYP-CDE                            14461104
144612         DELIMITED BY SIZE                                        14461204
144613         INTO PV-CICS-MSG-AREA.                                   14461304
144614     PERFORM 9990-WRITE-CICS.                                     14461404
144615                                                                  14461504
144616 7250-RETREIVE-VENDOR-DEPT.                                       14461604
144617                                                                  14461704
144618     IF  PS-BLD-INTERNAL-TABLE-YES                                14461804
144619         MOVE '7250'  TO  PV-CSSL-PARA                            14461904
144620         PERFORM 9120-INTERNAL-TABLE                              14462004
144621     END-IF.                                                      14462104
144622                                                                  14462204
144623     STRING ' SUKCS752 - '                                        14462304
144624            ' 7250-RETREIVE-VENDOR-DEPT'                          14462404
144625         DELIMITED BY SIZE                                        14462504
144626         INTO PV-CICS-MSG-AREA.                                   14462604
144627     PERFORM 9990-WRITE-CICS.                                     14462704
144628     EXEC SQL                                                     14462804
144629          SELECT B.VND_RNKG_CDE                                   14462904
144630              ,  B.PKGNG_TYP_CDE                                  14463004
144631              ,  EFF_BEG_TMST                                     14463104
144632              ,  AUD_PCT                                          14463204
144633              ,  CKD_PCT                                          14463304
144634              ,  MAX_CKD_QTY                                      14463404
144635              ,  MAX_CART_CKD_QTY                                 14463504
144636              ,  MIN_CART_CKD_QTY                                 14463604
144637              ,  CKD_DC_QTY                                       14463704
144638              ,  MAX_PO_LNE_QTY                                   14463804
144640              ,  CK_AFT_DAY_QTY                                   14464001
144650              ,  CK_AFT_RCVR_QTY                                  14465001
144660              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         14466001
144670          INTO   :SUT00017-VND-RNKG-CDE                           14467001
144680              ,  :SUT00017-PKGNG-TYP-CDE                          14468001
144690              ,  :SUT00017-EFF-BEG-TMST                           14469001
144700              ,  :SUT00017-AUD-PCT                                14470001
144800              ,  :SUT00017-CKD-PCT                                14480001
144900              ,  :SUT00017-MAX-CKD-QTY                            14490001
145000              ,  :SUT00017-MAX-CART-CKD-QTY                       14500001
145100              ,  :SUT00017-MIN-CART-CKD-QTY                       14510001
145200              ,  :SUT00017-CKD-DC-QTY                             14520001
145300              ,  :SUT00017-MAX-PO-LNE-QTY                         14530001
145400              ,  :SUT00017-CK-AFT-DAY-QTY                         14540001
145500              ,  :SUT00017-CK-AFT-RCVR-QTY                        14550001
145600              ,  :PV-LIMIT-DAYS                                   14560001
145700          FROM   SUT_VND_DEPT_RNKG A                              14570001
145800             ,   SUT_PO_AUD_PARM   B                              14580001
145900          WHERE  A.ENT_ID        = :DK-ENT-ID                     14590001
146000            AND  A.DEPT_NBR      = :DK-DEPT-NBR                   14600001
146100            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              14610001
146200            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 14620001
146300            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                14630001
146400            AND  B.EFF_BEG_TMST  =                                14640001
146500             (SELECT MAX(C.EFF_BEG_TMST)                          14650001
146600              FROM   SUT_PO_AUD_PARM C                            14660001
146700              WHERE  B.VND_RNKG_CDE  = C.VND_RNKG_CDE             14670001
146800                AND  B.PKGNG_TYP_CDE = C.PKGNG_TYP_CDE)           14680001
146900           WITH UR                                                14690001
147000     END-EXEC.                                                    14700001
147100                                                                  14710001
147200     EVALUATE TRUE                                                14720001
147300         WHEN SQLCODE = ZERO                                      14730001
147400             SET PS-DEPT-RANK-FOUND TO TRUE                       14740001
147500         WHEN SQLCODE = +100                                      14750001
147600             SET PS-NO-DEPT-RANK-FOUND TO TRUE                    14760001
147700         WHEN SQLWARN0 NOT = SPACES                               14770001
147800         WHEN SQLCODE NOT EQUAL ZERO                              14780001
147900              MOVE '7250'  TO  PV-CSSL-PARA                       14790001
148000              PERFORM 9110-WRITE-SURD021-TO-CSSL                  14800001
148100                                                                  14810001
148200             MOVE '7250-RETREIVE-VENDOR-DEPT'                     14820001
148300                             TO DP013-PARAGRAPH                   14830001
148400             MOVE 'SUKCS752 - GET VENDOR DEPT'                    14840001
148500                             TO DP013-MESSAGE-TEXT(1)             14850001
148600             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                14860001
148700             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              14870001
148710             STRING 'ENT:'       PV-DISPLAY-ENT-ID                14871001
148720                    ' DEPT:'     PV-DISPLAY-DEPT-NBR              14872001
148730                    ' PKG TYP:'  DK-PKGNG-TYP-CDE                 14873001
148740                                 DELIMITED BY SIZE                14874001
148750                           INTO DP013-MESSAGE-TEXT(2)             14875001
148760             MOVE SQLCA      TO DP013-SQLCA                       14876001
148770             MOVE 'SUT00018' TO DP013-DB2-TABLE-NAME(1)           14877001
148780             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           14878001
148790             SET DP013-DB2-ABEND                                  14879001
148800                             TO TRUE                              14880001
148900             SET DP013-NO-ROLLBACK                                14890001
149000                             TO TRUE                              14900001
149100             PERFORM 9999-WRITE-CICS-LOG-MSG                      14910001
149200             SET PS-DUMP-TO-LOG       TO TRUE                     14920001
149300             SET PS-NO-PO-INFO-FOUND TO TRUE                      14930001
149400             SET SU021-DB2-ERROR TO TRUE                          14940001
149500     END-EVALUATE.                                                14950001
149510                                                                  14951004
149520     STRING ' SUKCS752 - '                                        14952004
149530            ' 7250-RETREIVE-VENDOR-DEPT'                          14953004
149540            ' ' SUT00017-VND-RNKG-CDE                             14954004
149550            ' ' SUT00017-PKGNG-TYP-CDE                            14955004
149560         DELIMITED BY SIZE                                        14956004
149570         INTO PV-CICS-MSG-AREA.                                   14957004
149600                                                                  14960001
149700 7300-RETREIVE-VENDOR-RANK.                                       14970001
149800                                                                  14980001
149900     IF  PS-BLD-INTERNAL-TABLE-YES                                14990001
150000         MOVE '7300'  TO  PV-CSSL-PARA                            15000001
150100         PERFORM 9120-INTERNAL-TABLE                              15010001
150200     END-IF.                                                      15020001
150300                                                                  15030001
150400     STRING ' SUKCS752 - '                                        15040001
150500            ' 7300-RETREIVE-VENDOR-RANK'                          15050001
150600         DELIMITED BY SIZE                                        15060001
150700         INTO PV-CICS-MSG-AREA.                                   15070001
150800     PERFORM 9990-WRITE-CICS.                                     15080001
150900     EXEC SQL                                                     15090001
151000          SELECT B.VND_RNKG_CDE                                   15100001
151100              ,  B.PKGNG_TYP_CDE                                  15110001
151200              ,  EFF_BEG_TMST                                     15120001
151300              ,  AUD_PCT                                          15130001
151400              ,  CKD_PCT                                          15140001
151500              ,  MAX_CKD_QTY                                      15150001
151600              ,  MAX_CART_CKD_QTY                                 15160001
151700              ,  MIN_CART_CKD_QTY                                 15170001
151800              ,  CKD_DC_QTY                                       15180001
151900              ,  MAX_PO_LNE_QTY                                   15190001
152000              ,  CK_AFT_DAY_QTY                                   15200001
152100              ,  CK_AFT_RCVR_QTY                                  15210001
152200              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         15220001
152300          INTO   :SUT00017-VND-RNKG-CDE                           15230001
152400              ,  :SUT00017-PKGNG-TYP-CDE                          15240001
152500              ,  :SUT00017-EFF-BEG-TMST                           15250001
152600              ,  :SUT00017-AUD-PCT                                15260001
152700              ,  :SUT00017-CKD-PCT                                15270001
152800              ,  :SUT00017-MAX-CKD-QTY                            15280001
152900              ,  :SUT00017-MAX-CART-CKD-QTY                       15290001
153000              ,  :SUT00017-MIN-CART-CKD-QTY                       15300001
153100              ,  :SUT00017-CKD-DC-QTY                             15310001
153200              ,  :SUT00017-MAX-PO-LNE-QTY                         15320001
153300              ,  :SUT00017-CK-AFT-DAY-QTY                         15330001
153400              ,  :SUT00017-CK-AFT-RCVR-QTY                        15340001
153500              ,  :PV-LIMIT-DAYS                                   15350001
153600          FROM   SUT_VND_RNKG      A                              15360001
153700             ,   SUT_PO_AUD_PARM   B                              15370001
153800          WHERE  A.ENT_ID        = :DK-ENT-ID                     15380001
153900            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              15390001
154000            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 15400001
154100            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                15410001
154200            AND  B.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         15420001
154300           WITH UR                                                15430001
154400     END-EXEC.                                                    15440001
154500                                                                  15450001
154600     EVALUATE TRUE                                                15460001
154700         WHEN SQLCODE = ZERO                                      15470001
154800             SET PS-VEND-RANK-FOUND TO TRUE                       15480001
154900         WHEN SQLCODE = +100                                      15490001
155000             SET PS-NO-VEND-RANK-FOUND TO TRUE                    15500001
155100         WHEN SQLWARN0 NOT = SPACES                               15510001
155200         WHEN SQLCODE NOT EQUAL ZERO                              15520001
155300              MOVE '7300'  TO  PV-CSSL-PARA                       15530001
155400              PERFORM 9110-WRITE-SURD021-TO-CSSL                  15540001
155500                                                                  15550001
155600             MOVE '7300-RETREIVE-VENDOR-RANK'                     15560001
155700                             TO DP013-PARAGRAPH                   15570001
155800             MOVE 'SUKCS752 - GET VENDOR RANK'                    15580001
155900                             TO DP013-MESSAGE-TEXT(1)             15590001
156000             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                15600001
156100             STRING 'ENT:'       PV-DISPLAY-ENT-ID                15610001
156200                    ' PKG TYP:'  DK-PKGNG-TYP-CDE                 15620001
156300                    ' '          SUT00015-EFF-BEG-TMST            15630001
156400                                 DELIMITED BY SIZE                15640001
156500                           INTO DP013-MESSAGE-TEXT(2)             15650001
156600             MOVE SQLCA      TO DP013-SQLCA                       15660001
156700             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           15670001
156800             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           15680001
156900             SET DP013-DB2-ABEND                                  15690001
157000                             TO TRUE                              15700001
157100             SET DP013-NO-ROLLBACK                                15710001
157200                             TO TRUE                              15720001
157300             PERFORM 9999-WRITE-CICS-LOG-MSG                      15730001
157400             SET PS-DUMP-TO-LOG       TO TRUE                     15740001
157500             SET PS-NO-PO-INFO-FOUND TO TRUE                      15750001
157600             SET SU021-DB2-ERROR TO TRUE                          15760001
157700     END-EVALUATE.                                                15770001
157710                                                                  15771004
157720     STRING ' SUKCS752 - '                                        15772004
157730            ' 7300-RETREIVE-VENDOR-RANK'                          15773004
157740            ' ' SUT00017-VND-RNKG-CDE                             15774004
157750            ' ' SUT00017-PKGNG-TYP-CDE                            15775004
157760         DELIMITED BY SIZE                                        15776004
157770         INTO PV-CICS-MSG-AREA.                                   15777004
157800                                                                  15780001
157900 7350-RETREIVE-VENDOR-RANK.                                       15790001
158000                                                                  15800001
158100     IF  PS-BLD-INTERNAL-TABLE-YES                                15810001
158200         MOVE '7350'  TO  PV-CSSL-PARA                            15820001
158300         PERFORM 9120-INTERNAL-TABLE                              15830001
158400     END-IF.                                                      15840001
158500                                                                  15850001
158600     STRING ' SUKCS752 - '                                        15860001
158700            ' 7350-RETREIVE-VENDOR-RANK'                          15870001
158800         DELIMITED BY SIZE                                        15880001
158900         INTO PV-CICS-MSG-AREA.                                   15890001
159000     PERFORM 9990-WRITE-CICS.                                     15900001
159100     EXEC SQL                                                     15910001
159200          SELECT B.VND_RNKG_CDE                                   15920001
159300              ,  B.PKGNG_TYP_CDE                                  15930001
159400              ,  EFF_BEG_TMST                                     15940001
159500              ,  AUD_PCT                                          15950001
159600              ,  CKD_PCT                                          15960001
159700              ,  MAX_CKD_QTY                                      15970001
159800              ,  MAX_CART_CKD_QTY                                 15980001
159900              ,  MIN_CART_CKD_QTY                                 15990001
160000              ,  CKD_DC_QTY                                       16000001
160100              ,  MAX_PO_LNE_QTY                                   16010001
160200              ,  CK_AFT_DAY_QTY                                   16020001
160300              ,  CK_AFT_RCVR_QTY                                  16030001
160400              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         16040001
160500          INTO   :SUT00017-VND-RNKG-CDE                           16050001
160600              ,  :SUT00017-PKGNG-TYP-CDE                          16060001
160700              ,  :SUT00017-EFF-BEG-TMST                           16070001
160800              ,  :SUT00017-AUD-PCT                                16080001
160900              ,  :SUT00017-CKD-PCT                                16090001
161000              ,  :SUT00017-MAX-CKD-QTY                            16100001
161100              ,  :SUT00017-MAX-CART-CKD-QTY                       16110001
161200              ,  :SUT00017-MIN-CART-CKD-QTY                       16120001
161300              ,  :SUT00017-CKD-DC-QTY                             16130001
161400              ,  :SUT00017-MAX-PO-LNE-QTY                         16140001
161500              ,  :SUT00017-CK-AFT-DAY-QTY                         16150001
161600              ,  :SUT00017-CK-AFT-RCVR-QTY                        16160001
161700              ,  :PV-LIMIT-DAYS                                   16170001
161800          FROM   SUT_VND_RNKG      A                              16180001
161900             ,   SUT_PO_AUD_PARM   B                              16190001
162000          WHERE  A.ENT_ID        = :DK-ENT-ID                     16200001
162100            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              16210001
162200            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 16220001
162300            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                16230001
162400            AND  B.EFF_BEG_TMST  =                                16240001
162500             (SELECT MAX(C.EFF_BEG_TMST)                          16250001
162600              FROM   SUT_PO_AUD_PARM   C                          16260001
162700              WHERE  B.VND_RNKG_CDE  = C.VND_RNKG_CDE             16270001
162800                AND  B.PKGNG_TYP_CDE = C.PKGNG_TYP_CDE)           16280001
162900           WITH UR                                                16290001
163000     END-EXEC.                                                    16300001
163100                                                                  16310001
163200     EVALUATE TRUE                                                16320001
163300         WHEN SQLCODE = ZERO                                      16330001
163400             SET PS-VEND-RANK-FOUND TO TRUE                       16340001
163500         WHEN SQLCODE = +100                                      16350001
163600             SET PS-NO-VEND-RANK-FOUND TO TRUE                    16360001
163700         WHEN SQLWARN0 NOT = SPACES                               16370001
163800         WHEN SQLCODE NOT EQUAL ZERO                              16380001
163900              MOVE '7350'  TO  PV-CSSL-PARA                       16390001
164000              PERFORM 9110-WRITE-SURD021-TO-CSSL                  16400001
164100                                                                  16410001
164200             MOVE '7350-RETREIVE-VENDOR-RANK'                     16420001
164300                             TO DP013-PARAGRAPH                   16430001
164400             MOVE 'SUKCS752 - GET VENDOR RANK'                    16440001
164410                             TO DP013-MESSAGE-TEXT(1)             16441001
164420             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                16442001
164430             STRING 'ENT:'       PV-DISPLAY-ENT-ID                16443001
164440                    ' PKG TYP:'  DK-PKGNG-TYP-CDE                 16444001
164450                                 DELIMITED BY SIZE                16445001
164460                           INTO DP013-MESSAGE-TEXT(2)             16446001
164470             MOVE SQLCA      TO DP013-SQLCA                       16447001
164480             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           16448001
164490             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           16449001
164500             SET DP013-DB2-ABEND                                  16450001
164600                             TO TRUE                              16460001
164700             SET DP013-NO-ROLLBACK                                16470001
164800                             TO TRUE                              16480001
164900             PERFORM 9999-WRITE-CICS-LOG-MSG                      16490001
165000             SET PS-DUMP-TO-LOG       TO TRUE                     16500001
165100             SET PS-NO-PO-INFO-FOUND TO TRUE                      16510001
165200             SET SU021-DB2-ERROR TO TRUE                          16520001
165300     END-EVALUATE.                                                16530001
165301                                                                  16530104
165310     STRING ' SUKCS752 - '                                        16531004
165320            ' 7350-RETREIVE-VENDOR-RANK'                          16532004
165330            ' ' SUT00017-VND-RNKG-CDE                             16533004
165340            ' ' SUT00017-PKGNG-TYP-CDE                            16534004
165350         DELIMITED BY SIZE                                        16535004
165360         INTO PV-CICS-MSG-AREA.                                   16536004
165370                                                                  16537004
165400                                                                  16540001
165500 7400-RETREIVE-DEFAULT-RANK.                                      16550001
165600                                                                  16560001
165700     IF  PS-BLD-INTERNAL-TABLE-YES                                16570001
165800         MOVE '7400'  TO  PV-CSSL-PARA                            16580001
165900         PERFORM 9120-INTERNAL-TABLE                              16590001
166000     END-IF.                                                      16600001
166100                                                                  16610001
166200     STRING ' SUKCS752 - '                                        16620001
166300            ' 7400-RETREIVE-DEFAULT-RANK'                         16630001
166400         DELIMITED BY SIZE                                        16640001
166500         INTO PV-CICS-MSG-AREA.                                   16650001
166600     PERFORM 9990-WRITE-CICS.                                     16660001
166700                                                                  16670001
166800     EXEC SQL                                                     16680001
166900          SELECT VND_RNKG_CDE                                     16690001
167000              ,  PKGNG_TYP_CDE                                    16700001
167100              ,  EFF_BEG_TMST                                     16710001
167200              ,  AUD_PCT                                          16720001
167300              ,  CKD_PCT                                          16730001
167400              ,  MAX_CKD_QTY                                      16740001
167500              ,  MAX_CART_CKD_QTY                                 16750001
167600              ,  MIN_CART_CKD_QTY                                 16760001
167700              ,  CKD_DC_QTY                                       16770001
167800              ,  MAX_PO_LNE_QTY                                   16780001
167900              ,  CK_AFT_DAY_QTY                                   16790001
168000              ,  CK_AFT_RCVR_QTY                                  16800001
168100              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         16810001
168200          INTO   :SUT00017-VND-RNKG-CDE                           16820001
168300              ,  :SUT00017-PKGNG-TYP-CDE                          16830001
168400              ,  :SUT00017-EFF-BEG-TMST                           16840001
168500              ,  :SUT00017-AUD-PCT                                16850001
168600              ,  :SUT00017-CKD-PCT                                16860001
168700              ,  :SUT00017-MAX-CKD-QTY                            16870001
168800              ,  :SUT00017-MAX-CART-CKD-QTY                       16880001
168900              ,  :SUT00017-MIN-CART-CKD-QTY                       16890001
169000              ,  :SUT00017-CKD-DC-QTY                             16900001
169100              ,  :SUT00017-MAX-PO-LNE-QTY                         16910001
169200              ,  :SUT00017-CK-AFT-DAY-QTY                         16920001
169300              ,  :SUT00017-CK-AFT-RCVR-QTY                        16930001
169400              ,  :PV-LIMIT-DAYS                                   16940001
169500          FROM   SUT_PO_AUD_PARM                                  16950001
169600          WHERE  PKGNG_TYP_CDE   = :DK-PKGNG-TYP-CDE              16960001
169700            AND  VND_RNKG_CDE    = :PC-DEFAULT                    16970001
169800            AND  EFF_BEG_TMST    = :SUT00015-EFF-BEG-TMST         16980001
169900           WITH UR                                                16990001
170000     END-EXEC.                                                    17000001
170100                                                                  17010001
170200     EVALUATE TRUE                                                17020001
170300         WHEN SQLCODE = ZERO                                      17030001
170400             SET PS-DEFAULT-RANK-FOUND TO TRUE                    17040001
170500         WHEN SQLCODE = +100                                      17050001
170600             SET PS-NO-DEFAULT-RANK-FOUND TO TRUE                 17060001
170700         WHEN SQLWARN0 NOT = SPACES                               17070001
170800         WHEN SQLCODE NOT EQUAL ZERO                              17080001
170900              MOVE '7400'  TO  PV-CSSL-PARA                       17090001
171000              PERFORM 9110-WRITE-SURD021-TO-CSSL                  17100001
171100                                                                  17110001
171200             MOVE '7400-RETREIVE-DEFAULT-RANK'                    17120001
171300                             TO DP013-PARAGRAPH                   17130001
171400             MOVE 'SUKCS752 - GET DEFAULT RANK'                   17140001
171500                             TO DP013-MESSAGE-TEXT(1)             17150001
171510             STRING 'PKG TYP:'  DK-PKGNG-TYP-CDE                  17151001
171520                    ' DFLT:'    PC-DEFAULT                        17152001
171530                    ' '         SUT00015-EFF-BEG-TMST             17153001
171540                                DELIMITED BY SIZE                 17154001
171550                           INTO DP013-MESSAGE-TEXT(2)             17155001
171560             MOVE SQLCA      TO DP013-SQLCA                       17156001
171570             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           17157001
171580             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           17158001
171590             SET DP013-DB2-ABEND                                  17159001
171600                             TO TRUE                              17160001
171700             SET DP013-NO-ROLLBACK                                17170001
171800                             TO TRUE                              17180001
171900             PERFORM 9999-WRITE-CICS-LOG-MSG                      17190001
172000             SET PS-DUMP-TO-LOG       TO TRUE                     17200001
172100             SET PS-NO-PO-INFO-FOUND TO TRUE                      17210001
172200             SET SU021-DB2-ERROR TO TRUE                          17220001
172300     END-EVALUATE.                                                17230001
172310                                                                  17231004
172320     STRING ' SUKCS752 - '                                        17232004
172330            ' 7400-RETREIVE-DEFAULT-RANK'                         17233004
172340            ' ' SUT00017-VND-RNKG-CDE                             17234004
172350            ' ' SUT00017-PKGNG-TYP-CDE                            17235004
172360         DELIMITED BY SIZE                                        17236004
172370         INTO PV-CICS-MSG-AREA.                                   17237004
172400                                                                  17240001
172500 7450-RETREIVE-DEFAULT-RANK.                                      17250001
172600                                                                  17260001
172700     IF  PS-BLD-INTERNAL-TABLE-YES                                17270001
172800         MOVE '7450'  TO  PV-CSSL-PARA                            17280001
172900         PERFORM 9120-INTERNAL-TABLE                              17290001
173000     END-IF.                                                      17300001
173100                                                                  17310001
173200     STRING ' SUKCS752 - '                                        17320001
173300            ' 7450-RETREIVE-DEFAULT-RANK'                         17330001
173400         DELIMITED BY SIZE                                        17340001
173500         INTO PV-CICS-MSG-AREA.                                   17350001
173600     PERFORM 9990-WRITE-CICS.                                     17360001
173700     EXEC SQL                                                     17370001
173800          SELECT VND_RNKG_CDE                                     17380001
173900              ,  PKGNG_TYP_CDE                                    17390001
174000              ,  EFF_BEG_TMST                                     17400001
174100              ,  AUD_PCT                                          17410001
174200              ,  CKD_PCT                                          17420001
174300              ,  MAX_CKD_QTY                                      17430001
174400              ,  MAX_CART_CKD_QTY                                 17440001
174500              ,  MIN_CART_CKD_QTY                                 17450001
174600              ,  CKD_DC_QTY                                       17460001
174700              ,  MAX_PO_LNE_QTY                                   17470001
174800              ,  CK_AFT_DAY_QTY                                   17480001
174900              ,  CK_AFT_RCVR_QTY                                  17490001
175000              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         17500001
175100          INTO   :SUT00017-VND-RNKG-CDE                           17510001
175200              ,  :SUT00017-PKGNG-TYP-CDE                          17520001
175300              ,  :SUT00017-EFF-BEG-TMST                           17530001
175400              ,  :SUT00017-AUD-PCT                                17540001
175500              ,  :SUT00017-CKD-PCT                                17550001
175600              ,  :SUT00017-MAX-CKD-QTY                            17560001
175700              ,  :SUT00017-MAX-CART-CKD-QTY                       17570001
175800              ,  :SUT00017-MIN-CART-CKD-QTY                       17580001
175900              ,  :SUT00017-CKD-DC-QTY                             17590001
176000              ,  :SUT00017-MAX-PO-LNE-QTY                         17600001
176100              ,  :SUT00017-CK-AFT-DAY-QTY                         17610001
176200              ,  :SUT00017-CK-AFT-RCVR-QTY                        17620001
176300              ,  :PV-LIMIT-DAYS                                   17630001
176400          FROM   SUT_PO_AUD_PARM A                                17640001
176500          WHERE  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              17650001
176600            AND  A.VND_RNKG_CDE  = :PC-DEFAULT                    17660001
176700            AND  A.EFF_BEG_TMST  =                                17670001
176800             (SELECT MAX(B.EFF_BEG_TMST)                          17680001
176900              FROM   SUT_PO_AUD_PARM   B                          17690001
177000              WHERE  A.VND_RNKG_CDE  = B.VND_RNKG_CDE             17700001
177100                AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE)           17710001
177200           WITH UR                                                17720001
177300     END-EXEC.                                                    17730001
177400                                                                  17740001
177500     EVALUATE TRUE                                                17750001
177600         WHEN SQLCODE = ZERO                                      17760001
177700             SET PS-DEFAULT-RANK-FOUND TO TRUE                    17770001
177800         WHEN SQLCODE = +100                                      17780001
177900             SET PS-NO-DEFAULT-RANK-FOUND TO TRUE                 17790001
178000         WHEN SQLWARN0 NOT = SPACES                               17800001
178100         WHEN SQLCODE NOT EQUAL ZERO                              17810001
178200              MOVE '7450'  TO  PV-CSSL-PARA                       17820001
178300              PERFORM 9110-WRITE-SURD021-TO-CSSL                  17830001
178400                                                                  17840001
178500             MOVE '7450-RETREIVE-DEFAULT-RANK'                    17850001
178600                             TO DP013-PARAGRAPH                   17860001
178700             MOVE 'SUKCS752 - GET DEFAULT RANK'                   17870001
178800                             TO DP013-MESSAGE-TEXT(1)             17880001
178900             STRING 'PKG TYP:'  DK-PKGNG-TYP-CDE                  17890001
179000                    ' DFLT:'    PC-DEFAULT                        17900001
179100                                DELIMITED BY SIZE                 17910001
179200                           INTO DP013-MESSAGE-TEXT(2)             17920001
179300             MOVE SQLCA      TO DP013-SQLCA                       17930001
179400             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           17940001
179500             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           17950001
179600             SET DP013-DB2-ABEND                                  17960001
179700                             TO TRUE                              17970001
179800             SET DP013-NO-ROLLBACK                                17980001
179900                             TO TRUE                              17990001
180000             PERFORM 9999-WRITE-CICS-LOG-MSG                      18000001
180100             SET PS-DUMP-TO-LOG       TO TRUE                     18010001
180200             SET PS-NO-PO-INFO-FOUND TO TRUE                      18020001
180300             SET SU021-DB2-ERROR TO TRUE                          18030001
180400     END-EVALUATE.                                                18040001
180500                                                                  18050001
180600 7500-SELECT-BULK.                                                18060001
180700                                                                  18070001
180800     IF  PS-BLD-INTERNAL-TABLE-YES                                18080001
180900         MOVE '7500'  TO  PV-CSSL-PARA                            18090001
181000         PERFORM 9120-INTERNAL-TABLE                              18100001
181100     END-IF.                                                      18110001
181200                                                                  18120001
181300     STRING ' SUKCS752 - '                                        18130001
181400            ' 7500-SELECT-BULK'                                   18140001
181500         DELIMITED BY SIZE                                        18150001
181600         INTO PV-CICS-MSG-AREA.                                   18160001
181700     PERFORM 9990-WRITE-CICS.                                     18170001
181800     EXEC SQL                                                     18180001
181900          SELECT AUD_TYP_CDE                                      18190001
182000              ,  CRE_TMST                                         18200001
182100              ,  LAST_UPD_TMST                                    18210001
182200              ,  LAST_UPD_BY_USR_ID                               18220001
182300          INTO   :SUT00014-AUD-TYP-CDE                            18230001
182400              ,  :SUT00014-CRE-TMST                               18240001
182500              ,  :SUT00014-LAST-UPD-TMST                          18250001
182600              ,  :SUT00014-LAST-UPD-BY-USR-ID                     18260001
182700          FROM   SUT_PO_AUD_EXC                                   18270001
182800          WHERE  PO_NBR        = :DK-PO-NBR                       18280001
182900            AND  PO_LNE_NBR    = :DK-PO-LINE-NBR                  18290001
183000            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  18300001
183100           WITH UR                                                18310001
183200     END-EXEC.                                                    18320001
183300                                                                  18330001
183400     EVALUATE TRUE                                                18340001
183500         WHEN SQLCODE = ZERO                                      18350001
183600             SET PS-LINE-LEVEL-FOUND  TO TRUE                     18360001
183700             MOVE 'PS-LINE-LEVEL-FOUND ' TO PV-CICS-MSG-AREA      18370001
183800             PERFORM 9990-WRITE-CICS                              18380001
183900         WHEN SQLCODE = +100                                      18390001
184000             CONTINUE                                             18400001
184100         WHEN SQLWARN0 NOT = SPACES                               18410001
184200         WHEN SQLCODE NOT EQUAL ZERO                              18420001
184300              MOVE '7500'  TO  PV-CSSL-PARA                       18430001
184400              PERFORM 9110-WRITE-SURD021-TO-CSSL                  18440001
184500                                                                  18450001
184600             MOVE '7500-SELECT-BULK'                              18460001
184610                             TO DP013-PARAGRAPH                   18461001
184620             MOVE 'SUKCS752 - GET PRE-PACK'                       18462001
184630                             TO DP013-MESSAGE-TEXT(1)             18463001
184640             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        18464001
184650             MOVE DK-PO-NBR      TO PV-DISPLAY-PO-NBR             18465001
184660             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        18466001
184670             STRING 'PO:'           PV-DISPLAY-OPER-UNT-ID        18467001
184680                    '-'             PV-DISPLAY-PO-NBR             18468001
184690                    ' lne:'         PV-DISPLAY-PO-LINE-NBR        18469001
184700                                    DELIMITED BY SIZE             18470001
184800                           INTO DP013-MESSAGE-TEXT(2)             18480001
184900             MOVE SQLCA      TO DP013-SQLCA                       18490001
185000             MOVE 'SUT00014' TO DP013-DB2-TABLE-NAME(1)           18500001
185100             SET DP013-DB2-ABEND                                  18510001
185200                             TO TRUE                              18520001
185300             SET DP013-NO-ROLLBACK                                18530001
185400                             TO TRUE                              18540001
185500             PERFORM 9999-WRITE-CICS-LOG-MSG                      18550001
185600             SET PS-DUMP-TO-LOG       TO TRUE                     18560001
185700             SET PS-NO-PO-INFO-FOUND TO TRUE                      18570001
185800             SET SU021-DB2-ERROR TO TRUE                          18580001
185900     END-EVALUATE.                                                18590001
186000                                                                  18600001
186100 7550-SELECT-PRE-PACK.                                            18610001
186200                                                                  18620001
186300     IF  PS-BLD-INTERNAL-TABLE-YES                                18630001
186400         MOVE '7550'  TO  PV-CSSL-PARA                            18640001
186500         PERFORM 9120-INTERNAL-TABLE                              18650001
186600     END-IF.                                                      18660001
186700                                                                  18670001
186800     STRING ' SUKCS752 - '                                        18680001
186900            ' 7550-SELECT-PRE-PACK'                               18690001
187000         DELIMITED BY SIZE                                        18700001
187100         INTO PV-CICS-MSG-AREA.                                   18710001
187200     PERFORM 9990-WRITE-CICS.                                     18720001
187300     EXEC SQL                                                     18730001
187400          SELECT AUD_TYP_CDE                                      18740001
187500              ,  CRE_TMST                                         18750001
187600              ,  LAST_UPD_TMST                                    18760001
187700              ,  LAST_UPD_BY_USR_ID                               18770001
187800          INTO   :SUT00014-AUD-TYP-CDE                            18780001
187900              ,  :SUT00014-CRE-TMST                               18790001
188000              ,  :SUT00014-LAST-UPD-TMST                          18800001
188100              ,  :SUT00014-LAST-UPD-BY-USR-ID                     18810001
188200          FROM   SUT_PO_AUD_EXC                                   18820001
188300          WHERE  PO_NBR        = :DK-PO-NBR                       18830001
188400            AND  PO_PREPK_ID   = :DK-PREPK-ID                     18840001
188500            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  18850001
188600           WITH UR                                                18860001
188700     END-EXEC.                                                    18870001
188800                                                                  18880001
188900     EVALUATE TRUE                                                18890001
189000         WHEN SQLCODE = ZERO                                      18900001
189100             SET PS-LINE-LEVEL-FOUND  TO TRUE                     18910001
189200             MOVE 'PS-LINE-LEVEL-FOUND ' TO PV-CICS-MSG-AREA      18920001
189300             PERFORM 9990-WRITE-CICS                              18930001
189400         WHEN SQLCODE = +100                                      18940001
189500             CONTINUE                                             18950001
189600         WHEN SQLWARN0 NOT = SPACES                               18960001
189700         WHEN SQLCODE NOT EQUAL ZERO                              18970001
189800              MOVE '7550'  TO  PV-CSSL-PARA                       18980001
189900              PERFORM 9110-WRITE-SURD021-TO-CSSL                  18990001
190000                                                                  19000001
190100             MOVE '7550-SELECT-PRE-PACK'                          19010001
190200                             TO DP013-PARAGRAPH                   19020001
190300             MOVE 'SUKCS752 - GET PRE-PACK'                       19030001
190400                             TO DP013-MESSAGE-TEXT(1)             19040001
190410             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        19041001
190420             MOVE DK-PO-NBR      TO PV-DISPLAY-PO-NBR             19042001
190430             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           19043001
190440             STRING 'PO:'           PV-DISPLAY-OPER-UNT-ID        19044001
190450                    '-'             PV-DISPLAY-PO-NBR             19045001
190460                    ' PREPK:'       PV-DISPLAY-PREPK-ID           19046001
190470                                    DELIMITED BY SIZE             19047001
190480                           INTO DP013-MESSAGE-TEXT(2)             19048001
190490             MOVE SQLCA      TO DP013-SQLCA                       19049001
190500             MOVE 'SUT00014' TO DP013-DB2-TABLE-NAME(1)           19050001
190600             SET DP013-DB2-ABEND                                  19060001
190700                             TO TRUE                              19070001
190800             SET DP013-NO-ROLLBACK                                19080001
190900                             TO TRUE                              19090001
191000             PERFORM 9999-WRITE-CICS-LOG-MSG                      19100001
191100             SET PS-DUMP-TO-LOG       TO TRUE                     19110001
191200             SET PS-NO-PO-INFO-FOUND TO TRUE                      19120001
191300             SET SU021-DB2-ERROR TO TRUE                          19130001
191400     END-EVALUATE.                                                19140001
191500                                                                  19150001
191600 7600-SELECT-PO-LEVEL.                                            19160001
191700                                                                  19170001
191800     IF  PS-BLD-INTERNAL-TABLE-YES                                19180001
191900         MOVE '7600'  TO  PV-CSSL-PARA                            19190001
192000         PERFORM 9120-INTERNAL-TABLE                              19200001
192100     END-IF.                                                      19210001
192200                                                                  19220001
192300     STRING ' SUKCS752 - '                                        19230001
192400            ' 7600-SELECT-PO-LEVEL'                               19240001
192500         DELIMITED BY SIZE                                        19250001
192600         INTO PV-CICS-MSG-AREA.                                   19260001
192700     PERFORM 9990-WRITE-CICS.                                     19270001
192800     EXEC SQL                                                     19280001
192900          SELECT AUD_TYP_CDE                                      19290001
193000              ,  CRE_TMST                                         19300001
193100              ,  LAST_UPD_TMST                                    19310001
193200              ,  LAST_UPD_BY_USR_ID                               19320001
193300          INTO   :SUT00014-AUD-TYP-CDE                            19330001
193400              ,  :SUT00014-CRE-TMST                               19340001
193500              ,  :SUT00014-LAST-UPD-TMST                          19350001
193600              ,  :SUT00014-LAST-UPD-BY-USR-ID                     19360001
193700          FROM   SUT_PO_AUD_EXC                                   19370001
193800          WHERE  PO_NBR        = :DK-PO-NBR                       19380001
193900            AND  PO_LNE_NBR    = 0                                19390001
194000            AND  PO_PREPK_ID   = 0                                19400001
194100            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  19410001
194200           WITH UR                                                19420001
194300     END-EXEC.                                                    19430001
194400                                                                  19440001
194500     EVALUATE TRUE                                                19450001
194600         WHEN SQLCODE = ZERO                                      19460001
194700             SET PS-PO-LEVEL-FOUND  TO TRUE                       19470001
194800             MOVE 'PS-PO-LEVEL-FOUND ' TO PV-CICS-MSG-AREA        19480001
194900             PERFORM 9990-WRITE-CICS                              19490001
195000         WHEN SQLCODE = +100                                      19500001
195100             CONTINUE                                             19510001
195200         WHEN SQLWARN0 NOT = SPACES                               19520001
195300         WHEN SQLCODE NOT EQUAL ZERO                              19530001
195400              MOVE '7600'  TO  PV-CSSL-PARA                       19540001
195500              PERFORM 9110-WRITE-SURD021-TO-CSSL                  19550001
195600                                                                  19560001
195700             MOVE '7600-SELECT-PO-LEVEL'                          19570001
195800                             TO DP013-PARAGRAPH                   19580001
195900             MOVE 'SUKCS752 - GET PRE-PACK'                       19590001
196000                             TO DP013-MESSAGE-TEXT(1)             19600001
196100             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        19610001
196200             MOVE DK-PO-NBR      TO PV-DISPLAY-PO-NBR             19620001
196300             STRING 'PO:'           PV-DISPLAY-OPER-UNT-ID        19630001
196400                    '-'             PV-DISPLAY-PO-NBR             19640001
196410                                    DELIMITED BY SIZE             19641001
196420                           INTO DP013-MESSAGE-TEXT(2)             19642001
196430             MOVE SQLCA      TO DP013-SQLCA                       19643001
196440             MOVE 'SUT00014' TO DP013-DB2-TABLE-NAME(1)           19644001
196450             SET DP013-DB2-ABEND                                  19645001
196460                             TO TRUE                              19646001
196470             SET DP013-NO-ROLLBACK                                19647001
196480                             TO TRUE                              19648001
196490             PERFORM 9999-WRITE-CICS-LOG-MSG                      19649001
196500             SET PS-DUMP-TO-LOG       TO TRUE                     19650001
196600             SET PS-NO-PO-INFO-FOUND TO TRUE                      19660001
196700             SET SU021-DB2-ERROR TO TRUE                          19670001
196800     END-EVALUATE.                                                19680001
196900                                                                  19690001
197000 7700-SELECT-FAILED.                                              19700001
197100                                                                  19710001
197200     IF  PS-BLD-INTERNAL-TABLE-YES                                19720001
197300         MOVE '7700'  TO  PV-CSSL-PARA                            19730001
197400         PERFORM 9120-INTERNAL-TABLE                              19740001
197500     END-IF.                                                      19750001
197600                                                                  19760001
197700     STRING ' SUKCS752 - '                                        19770001
197800            ' 7700-SELECT-FAILED'                                 19780001
197900         DELIMITED BY SIZE                                        19790001
198000         INTO PV-CICS-MSG-AREA.                                   19800001
198100     PERFORM 9990-WRITE-CICS.                                     19810001
198200     EXEC SQL                                                     19820001
198300          SELECT AUD_CNTL_NBR                                     19830001
198400              ,  UNT_QTY                                          19840001
198500          INTO   :SUT00015-AUD-CNTL-NBR                           19850001
198600              ,  :SUT00015-UNT-QTY                                19860001
198700          FROM   SUT_PO_AUD_REQ                                   19870001
198800          WHERE  PO_NBR         = :DK-PO-NBR                      19880001
198900            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 19890001
199000            AND  PO_PREPK_ID    = :DK-PREPK-ID                    19900001
199100            AND  AUD_STAT_CDE   = :PC-F                           19910001
199200            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  19920001
199400            AND  PKGNG_TYP_CDE  <> 'RF'                           19940001
199500           with ur                                                19950002
199600     END-EXEC.                                                    19960001
199700                                                                  19970001
199800     EVALUATE TRUE                                                19980001
199900         WHEN SQLCODE = ZERO                                      19990001
200000         WHEN SQLCODE = -811                                      20000001
200100             SET PS-FAILED-AUDITS-FOUND TO TRUE                   20010001
200200             MOVE 'PS-FAILED-AUDITS-FOUND ' TO PV-CICS-MSG-AREA   20020001
200300             PERFORM 9990-WRITE-CICS                              20030001
200400         WHEN SQLCODE = +100                                      20040001
200500             CONTINUE                                             20050001
200600         WHEN SQLWARN0 NOT = SPACES                               20060001
200700         WHEN SQLCODE NOT EQUAL ZERO                              20070001
200800              MOVE '7700'  TO  PV-CSSL-PARA                       20080001
200900              PERFORM 9110-WRITE-SURD021-TO-CSSL                  20090001
201000                                                                  20100001
201100             MOVE '7700-SELECT-FAILED'                            20110001
201200                             TO DP013-PARAGRAPH                   20120001
201300             MOVE 'SUKCS752 - GET FAILED AUDITS'                  20130001
201400                             TO DP013-MESSAGE-TEXT(1)             20140001
201500             MOVE DK-PO-NBR      TO PV-DISPLAY-PO-NBR             20150001
201510             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        20151001
201520             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           20152001
201530             STRING 'PO:'           PV-DISPLAY-PO-NBR             20153001
201540                    ' LNE:'         PV-DISPLAY-PO-LINE-NBR        20154001
201550                    ' PREPK:'       PV-DISPLAY-PREPK-ID           20155001
201560                                       DELIMITED BY SIZE          20156001
201570                           INTO DP013-MESSAGE-TEXT(2)             20157001
201580             MOVE SQLCA      TO DP013-SQLCA                       20158001
201590             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           20159001
201600             SET DP013-DB2-ABEND                                  20160001
201700                             TO TRUE                              20170001
201800             SET DP013-NO-ROLLBACK                                20180001
201900                             TO TRUE                              20190001
202000             PERFORM 9999-WRITE-CICS-LOG-MSG                      20200001
202100             SET PS-DUMP-TO-LOG       TO TRUE                     20210001
202200             SET SU021-DB2-ERROR TO TRUE                          20220001
202300     END-EVALUATE.                                                20230001
202400                                                                  20240001
202500 7800-SELECT-PASSED.                                              20250001
202600                                                                  20260001
202700     IF  PS-BLD-INTERNAL-TABLE-YES                                20270001
202800         MOVE '7800'  TO  PV-CSSL-PARA                            20280001
202900         PERFORM 9120-INTERNAL-TABLE                              20290001
203000     END-IF.                                                      20300001
203100                                                                  20310001
203200     STRING ' SUKCS752 - '                                        20320001
203300            ' 7700-SELECT-BC-PASSED'                              20330001
203400         DELIMITED BY SIZE                                        20340001
203500         INTO PV-CICS-MSG-AREA.                                   20350001
203600     PERFORM 9990-WRITE-CICS.                                     20360001
203700     MOVE 0         TO PV-PASSED-COUNT.                           20370001
203800     EXEC SQL                                                     20380001
203900          SELECT COUNT(DISTINCT OPER_UNT_ID)                      20390001
204000          INTO   :PV-PASSED-COUNT                                 20400001
204100          FROM   SUT_PO_AUD_REQ                                   20410001
204200          WHERE  PO_NBR         = :DK-PO-NBR                      20420001
204300            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 20430001
204400            AND  PO_PREPK_ID    = :DK-PREPK-ID                    20440001
204500            AND  AUD_STAT_CDE   = :PC-P                           20450001
204600            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  20460001
204800            AND  PKGNG_TYP_CDE  <> 'RF'                           20480001
204900           with ur                                                20490002
205000     END-EXEC.                                                    20500001
205100                                                                  20510001
205200     EVALUATE TRUE                                                20520001
205300         WHEN SQLCODE = ZERO                                      20530001
205400             IF PV-PASSED-COUNT > 0                               20540001
205410                 SET PS-PASSED-AUDITS-FOUND TO TRUE               20541001
205420                 MOVE 'PS-PASSED-AUDITS-FOUND '                   20542001
205430                                              TO PV-CICS-MSG-AREA 20543001
205440                 PERFORM 9990-WRITE-CICS                          20544001
205450             END-IF                                               20545001
205460         WHEN SQLWARN0 NOT = SPACES                               20546001
205470         WHEN SQLCODE NOT EQUAL ZERO                              20547001
205480              MOVE '7800'  TO  PV-CSSL-PARA                       20548001
205490              PERFORM 9110-WRITE-SURD021-TO-CSSL                  20549001
205500                                                                  20550001
205600             MOVE '7800-SELECT-PASSED'                            20560001
205700                             TO DP013-PARAGRAPH                   20570001
205800             MOVE 'SUKCS752 - GET PASSED AUDITS'                  20580001
205900                             TO DP013-MESSAGE-TEXT(1)             20590001
206000             MOVE DK-PO-NBR      TO PV-DISPLAY-PO-NBR             20600001
206010             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        20601001
206020             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           20602001
206030             STRING 'PO:'           PV-DISPLAY-PO-NBR             20603001
206040                    ' LNE:'         PV-DISPLAY-PO-LINE-NBR        20604001
206050                    ' PREPK:'       PV-DISPLAY-PREPK-ID           20605001
206060                  DELIMITED BY SIZE                               20606001
206070                           INTO DP013-MESSAGE-TEXT(2)             20607001
206080             MOVE SQLCA      TO DP013-SQLCA                       20608001
206090             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           20609001
206100             SET DP013-DB2-ABEND                                  20610001
206200                             TO TRUE                              20620001
206300             SET DP013-NO-ROLLBACK                                20630001
206400                             TO TRUE                              20640001
206500             PERFORM 9999-WRITE-CICS-LOG-MSG                      20650001
206600             SET PS-DUMP-TO-LOG       TO TRUE                     20660001
206700             SET SU021-DB2-ERROR TO TRUE                          20670001
206800     END-EVALUATE.                                                20680001
206900                                                                  20690001
207000                                                                  20700001
207100 7850-SELECT-DC-PASSED.                                           20710001
207200                                                                  20720001
207300     IF  PS-BLD-INTERNAL-TABLE-YES                                20730001
207400         MOVE '7850'  TO  PV-CSSL-PARA                            20740001
207500         PERFORM 9120-INTERNAL-TABLE                              20750001
207600     END-IF.                                                      20760001
207700                                                                  20770001
207800     STRING ' SUKCS752 - '                                        20780001
207900            ' 7850-SELECT-DC-PASSED'                              20790001
208000         DELIMITED BY SIZE                                        20800001
208100         INTO PV-CICS-MSG-AREA.                                   20810001
208200     PERFORM 9990-WRITE-CICS.                                     20820001
208300     MOVE 0         TO PV-PASSED-COUNT.                           20830001
208400     EXEC SQL                                                     20840001
208500          SELECT COUNT(*)                                         20850001
208600          INTO   :PV-PASSED-COUNT                                 20860001
208700          FROM   SUT_PO_AUD_REQ                                   20870001
208800          WHERE  PO_NBR         = :DK-PO-NBR                      20880001
208900            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 20890001
209000            AND  PO_PREPK_ID    = :DK-PREPK-ID                    20900001
209100            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 20910001
209200            AND  AUD_STAT_CDE   = :PC-P                           20920001
209300            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  20930001
209500            AND  PKGNG_TYP_CDE  <> 'RF'                           20950001
209600           with ur                                                20960002
209700     END-EXEC.                                                    20970001
209800                                                                  20980001
209900     EVALUATE TRUE                                                20990001
210000         WHEN SQLCODE = ZERO                                      21000001
210100             CONTINUE                                             21010001
210200         WHEN SQLWARN0 NOT = SPACES                               21020001
210300         WHEN SQLCODE NOT EQUAL ZERO                              21030001
210400              MOVE '7850'  TO  PV-CSSL-PARA                       21040001
210500              PERFORM 9110-WRITE-SURD021-TO-CSSL                  21050001
210600                                                                  21060001
210700             MOVE '7850-SELECT-PASSED'                            21070001
210800                             TO DP013-PARAGRAPH                   21080001
210900             MOVE 'SUKCS752 - GET PASSED AUDITS'                  21090001
211000                             TO DP013-MESSAGE-TEXT(1)             21100001
211100             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        21110001
211200             MOVE DK-PO-NBR      TO PV-DISPLAY-PO-NBR             21120001
211300             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        21130001
211400             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           21140001
211500             STRING 'PO NBR: '      PV-DISPLAY-OPER-UNT-ID        21150001
211600                    '-'             PV-DISPLAY-PO-NBR             21160001
211700                    ' LNE:'         PV-DISPLAY-PO-LINE-NBR        21170001
211800                    ' PREPK:'       PV-DISPLAY-PREPK-ID           21180001
211900                                    DELIMITED BY SIZE             21190001
212000                           INTO DP013-MESSAGE-TEXT(2)             21200001
212100             MOVE SQLCA      TO DP013-SQLCA                       21210001
212200             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           21220001
212300             SET DP013-DB2-ABEND                                  21230001
212400                             TO TRUE                              21240001
212500             SET DP013-NO-ROLLBACK                                21250001
212600                             TO TRUE                              21260001
212700             PERFORM 9999-WRITE-CICS-LOG-MSG                      21270001
212800             SET PS-DUMP-TO-LOG       TO TRUE                     21280001
212900             SET SU021-DB2-ERROR TO TRUE                          21290001
213000     END-EVALUATE.                                                21300001
213100                                                                  21310001
213200                                                                  21320001
213300                                                                  21330001
213400 7900-SELECT-THIS-FACILITY.                                       21340001
213500                                                                  21350001
213600     IF  PS-BLD-INTERNAL-TABLE-YES                                21360001
213700         MOVE '7900'  TO  PV-CSSL-PARA                            21370001
213710         PERFORM 9120-INTERNAL-TABLE                              21371001
213720     END-IF.                                                      21372001
213730                                                                  21373001
213740     STRING ' SUKCS752 - '                                        21374001
213750            ' 7900-SELECT-THIS-FACILITY'                          21375001
213760         DELIMITED BY SIZE                                        21376001
213770         INTO PV-CICS-MSG-AREA.                                   21377001
213780     PERFORM 9990-WRITE-CICS.                                     21378001
213790     EXEC SQL                                                     21379001
213800          SELECT AUD_CNTL_NBR                                     21380001
213900             ,   AUD_STAT_CDE                                     21390001
214000             ,   CART_QTY                                         21400001
214100             ,   UNT_QTY                                          21410001
214200          INTO   :SUT00015-AUD-CNTL-NBR                           21420001
214300             ,   :SUT00015-AUD-STAT-CDE                           21430001
214400             ,   :SUT00015-CART-QTY                               21440001
214500             ,   :SUT00015-UNT-QTY                                21450001
214600          FROM   SUT_PO_AUD_REQ                                   21460001
214700          WHERE  PO_NBR         = :DK-PO-NBR                      21470001
214800            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 21480001
214900            AND  PO_PREPK_ID    = :DK-PREPK-ID                    21490001
215000            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                21500001
215100            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 21510001
215300            AND  PKGNG_TYP_CDE  <> 'RF'                           21530001
215400           with ur                                                21540002
215500     END-EXEC.                                                    21550001
215600                                                                  21560001
215700     EVALUATE TRUE                                                21570001
215800         WHEN SQLCODE = ZERO                                      21580001
215900             SET PS-AUDIT-STARTED TO TRUE                         21590001
216000             MOVE 'PS-BC-AUDIT-STARTED    '   TO PV-CICS-MSG-AREA 21600001
216100             PERFORM 9990-WRITE-CICS                              21610001
216200         WHEN SQLCODE = +100                                      21620001
216300             SET PS-NO-AUDIT-STARTED TO TRUE                      21630001
216400             MOVE 'PS-NO-BC-AUDIT-STARTED '   TO PV-CICS-MSG-AREA 21640001
216500             PERFORM 9990-WRITE-CICS                              21650001
216600         WHEN SQLWARN0 NOT = SPACES                               21660001
216700         WHEN SQLCODE NOT EQUAL ZERO                              21670001
216800              MOVE '7900'  TO  PV-CSSL-PARA                       21680001
216900              PERFORM 9110-WRITE-SURD021-TO-CSSL                  21690001
217000                                                                  21700001
217100             MOVE '7900-SELECT-THIS-FACILITY'                     21710001
217200                             TO DP013-PARAGRAPH                   21720001
217300             MOVE 'SUKCS752 - GET AUDITS FOR THIS FACILITY'       21730001
217310                             TO DP013-MESSAGE-TEXT(1)             21731001
217320             MOVE DK-OPER-UNT-ID  TO PV-DISPLAY-OPER-UNT-ID       21732001
217330             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            21733001
217340             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      21734001
217350             MOVE DK-PO-LINE-NBR  TO PV-DISPLAY-PO-LINE-NBR       21735001
217360             MOVE DK-PREPK-ID     TO PV-DISPLAY-PREPK-ID          21736001
217370             STRING 'po:'            PV-DISPLAY-OPER-UNT-ID       21737001
217380                    '-'              PV-DISPLAY-PO-NBR            21738001
217390                    '-'              PV-DISPLAY-RCVR-SEQ-NBR      21739001
217391                    ' LNE:'          PV-DISPLAY-PO-LINE-NBR       21739101
217392                    ' PREPK:'        PV-DISPLAY-PREPK-ID          21739201
217393                                       DELIMITED BY SIZE          21739301
217394                           INTO DP013-MESSAGE-TEXT(2)             21739401
217395             MOVE SQLCA      TO DP013-SQLCA                       21739501
217396             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           21739601
217397             SET DP013-DB2-ABEND                                  21739701
217398                             TO TRUE                              21739801
217399             SET DP013-NO-ROLLBACK                                21739901
217400                             TO TRUE                              21740001
217500             PERFORM 9999-WRITE-CICS-LOG-MSG                      21750001
217600             SET PS-DUMP-TO-LOG       TO TRUE                     21760001
217700             SET SU021-DB2-ERROR TO TRUE                          21770001
217800     END-EVALUATE.                                                21780001
217900                                                                  21790001
218000                                                                  21800001
218100*----------------------------------------------------------------*21810001
218200* COUNT THE NUMBER OF LINES ALREADY PROMPTED FOR THIS PO-RCVR    *21820001
218300*----------------------------------------------------------------*21830001
218400 7950-SELECT-PROMPTED-LINES.                                      21840001
218500                                                                  21850001
218600     IF  PS-BLD-INTERNAL-TABLE-YES                                21860001
218700         MOVE '7950'  TO  PV-CSSL-PARA                            21870001
218800         PERFORM 9120-INTERNAL-TABLE                              21880001
218900     END-IF.                                                      21890001
219000                                                                  21900001
219100     STRING ' SUKCS752 - '                                        21910001
219200            ' 7950-SELECT-PROMPTED-LINES'                         21920001
219300         DELIMITED BY SIZE                                        21930001
219400         INTO PV-CICS-MSG-AREA.                                   21940001
219500     PERFORM 9990-WRITE-CICS.                                     21950001
219600                                                                  21960001
219700     EXEC SQL                                                     21970001
219800          SELECT COUNT(*)                                         21980001
219900          INTO   :PV-PROMPTED-CNT                                 21990001
220000          FROM   SUT_PO_AUD_REQ                                   22000001
220100          WHERE  PO_NBR         = :DK-PO-NBR                      22010001
220200            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                22020001
220400            AND  PKGNG_TYP_CDE  <> 'RF'                           22040001
220500           with ur                                                22050002
220600     END-EXEC.                                                    22060001
220700                                                                  22070001
220800     EVALUATE TRUE                                                22080001
220900         WHEN SQLCODE = ZERO                                      22090001
221000         WHEN SQLCODE = +100                                      22100001
221100             CONTINUE                                             22110001
221200         WHEN SQLWARN0 NOT = SPACES                               22120001
221300         WHEN SQLCODE NOT EQUAL ZERO                              22130001
221400              MOVE '7950'  TO  PV-CSSL-PARA                       22140001
221500              PERFORM 9110-WRITE-SURD021-TO-CSSL                  22150001
221600                                                                  22160001
221700             MOVE '7950-SELECT-PROMPTED-LINES'                    22170001
221800                                        TO DP013-PARAGRAPH        22180001
221900             MOVE 'SUKCS752 - GET LINE COUNT FOR PO-RCVR  '       22190001
222000                                        TO DP013-MESSAGE-TEXT(1)  22200001
222100             MOVE DK-PO-NBR             TO PV-DISPLAY-PO-NBR      22210001
222200             MOVE DK-RCVR-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ-NBR22220001
222300             STRING 'PO:'                  PV-DISPLAY-PO-NBR      22230001
222400                    '-'                    PV-DISPLAY-RCVR-SEQ-NBR22240001
222500                                           DELIMITED BY SIZE      22250001
222600                                      INTO DP013-MESSAGE-TEXT(2)  22260001
222700             MOVE SQLCA      TO DP013-SQLCA                       22270001
222800             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           22280001
222900             SET DP013-DB2-ABEND                                  22290001
223000                             TO TRUE                              22300001
223100             SET DP013-NO-ROLLBACK                                22310001
223200                             TO TRUE                              22320001
223300             PERFORM 9999-WRITE-CICS-LOG-MSG                      22330001
223400             SET PS-DUMP-TO-LOG       TO TRUE                     22340001
223500             SET SU021-DB2-ERROR TO TRUE                          22350001
223600     END-EVALUATE.                                                22360001
223700                                                                  22370001
223800******************************************************************22380001
223900* 8000-SELECT-SHPUNT                                              22390001
224000*    GET THE STORE NUMBER FROM THE SHIPPING UNIT TABLE            22400001
224100******************************************************************22410001
224200 8000-SELECT-SHPUNT.                                              22420001
224300                                                                  22430001
224400     IF  PS-BLD-INTERNAL-TABLE-YES                                22440001
224500         MOVE '8000'  TO  PV-CSSL-PARA                            22450001
224600         PERFORM 9120-INTERNAL-TABLE                              22460001
224700     END-IF.                                                      22470001
224800                                                                  22480001
224900     EXEC SQL                                                     22490001
225000         SELECT A.DEST_OPER_UNT_ID                                22500001
225100              , A.ACTV_IND                                        22510001
225200         INTO   :SHPUNT-DEST-OPER-UNT-ID                          22520001
225300              , :SHPUNT-ACTV-IND                                  22530001
225400          FROM  TSHPUNT A                                         22540001
225500          WHERE A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID            22550001
225600           WITH UR                                                22560001
225700     END-EXEC.                                                    22570001
225800                                                                  22580001
225900     EVALUATE TRUE                                                22590001
226000        WHEN SQLCODE = ZERO                                       22600001
226100             IF SHPUNT-ACTV-IND  = 'I'                            22610001
226200                 MOVE ZEROS        TO SHPUNT-DEST-OPER-UNT-ID     22620001
226300             END-IF                                               22630001
226400        WHEN SQLCODE = +100                                       22640001
226500             MOVE ZEROS         TO SHPUNT-DEST-OPER-UNT-ID        22650001
226600         WHEN SQLWARN0 NOT = SPACES                               22660001
226700         WHEN SQLCODE NOT EQUAL ZERO                              22670001
226800              MOVE '8000'  TO  PV-CSSL-PARA                       22680001
226900              PERFORM 9110-WRITE-SURD021-TO-CSSL                  22690001
227000                                                                  22700001
227100             MOVE '8000-SELECT-SHPUNT'                            22710001
227200                             TO DP013-PARAGRAPH                   22720001
227300             MOVE 'SUKCS752 - GET DEST OPER UNIT'                 22730001
227400                             TO DP013-MESSAGE-TEXT(1)             22740001
227500             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      22750001
227510             STRING 'SSCC:'          PV-DISPLAY-SHIPT-UNT-ID      22751001
227520                                     DELIMITED BY SIZE            22752001
227530                           INTO DP013-MESSAGE-TEXT(2)             22753001
227540             MOVE SQLCA      TO DP013-SQLCA                       22754001
227550             MOVE 'TSHPUNT ' TO DP013-DB2-TABLE-NAME(1)           22755001
227560             SET DP013-DB2-ABEND                                  22756001
227570                             TO TRUE                              22757001
227580             SET DP013-NO-ROLLBACK                                22758001
227590                             TO TRUE                              22759001
227600             PERFORM 9999-WRITE-CICS-LOG-MSG                      22760001
227700             SET PS-DUMP-TO-LOG       TO TRUE                     22770001
227800             SET SU021-DB2-ERROR TO TRUE                          22780001
227900     END-EVALUATE.                                                22790001
228000                                                                  22800001
228100                                                                  22810001
228200 8100-SUM-PROMPTED-UNITS.                                         22820001
228300                                                                  22830001
228400     IF  PS-BLD-INTERNAL-TABLE-YES                                22840001
228500         MOVE '8100'  TO  PV-CSSL-PARA                            22850001
228600         PERFORM 9120-INTERNAL-TABLE                              22860001
228700     END-IF.                                                      22870001
228800                                                                  22880001
228900     STRING ' SUKCS752 - '                                        22890001
229000            ' 8100-SUM-PROMPTED-UNITS'                            22900001
229100         DELIMITED BY SIZE                                        22910001
229200         INTO PV-CICS-MSG-AREA.                                   22920001
229300     PERFORM 9990-WRITE-CICS.                                     22930001
229400     EXEC SQL                                                     22940001
229500         SELECT SUM(B.SHPD_QTY)                                   22950001
229600           INTO :PV-SHPD-QTY-SUM :DN-SUM-NULL                     22960001
229700           FROM TSUATRN A                                         22970001
229800             ,  TSHUUPC B                                         22980001
229900         WHERE A.AUD_CNTL_NBR    = :DK-AUDIT-CNTL-NBR             22990001
230000           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 23000001
230100          with ur                                                 23010001
230200     END-EXEC.                                                    23020001
230300                                                                  23030001
230400     EVALUATE TRUE                                                23040001
230500         WHEN SQLCODE = ZERO                                      23050001
230600             IF DN-SUM-NULL = -1                                  23060001
230700                 MOVE 0     TO PV-SHPD-QTY-SUM                    23070001
230800             END-IF                                               23080001
230900         WHEN SQLWARN0 NOT = SPACES                               23090001
231000         WHEN SQLCODE NOT EQUAL ZERO                              23100001
231100              MOVE '8100'  TO  PV-CSSL-PARA                       23110001
231200              PERFORM 9110-WRITE-SURD021-TO-CSSL                  23120001
231300                                                                  23130001
231400             MOVE '8100-SUM-PROMPTED-UNITS'                       23140001
231500                             TO DP013-PARAGRAPH                   23150001
231600             MOVE 'SUM THE PROMPTED CARTONS'                      23160001
231700                             TO DP013-MESSAGE-TEXT(1)             23170001
231710             MOVE DK-AUDIT-CNTL-NBR    TO PV-DISPLAY-AUDIT        23171001
231720             MOVE SUATRN-SHIPT-UNT-ID  TO PV-DISPLAY-SHIPT-UNT-ID 23172001
231730             STRING 'AUDIT:'              PV-DISPLAY-AUDIT        23173001
231740                    ' SSCC:'              PV-DISPLAY-SHIPT-UNT-ID 23174001
231750                                          DELIMITED BY SIZE       23175001
231760                                       INTO DP013-MESSAGE-TEXT (2)23176001
231770             MOVE SQLCA      TO DP013-SQLCA                       23177001
231780             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           23178001
231790             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(2)           23179001
231800             SET DP013-DB2-ABEND                                  23180001
231900                             TO TRUE                              23190001
232000             SET DP013-NO-ROLLBACK                                23200001
232100                             TO TRUE                              23210001
232200             PERFORM 9999-WRITE-CICS-LOG-MSG                      23220001
232300             SET PS-DUMP-TO-LOG       TO TRUE                     23230001
232400             SET SU021-DB2-ERROR TO TRUE                          23240001
232500     END-EVALUATE.                                                23250001
232600                                                                  23260001
232700                                                                  23270001
232800 8150-SELECT-CURRENT-CARTON.                                      23280001
232900                                                                  23290001
233000     IF  PS-BLD-INTERNAL-TABLE-YES                                23300001
233100         MOVE '8150'  TO  PV-CSSL-PARA                            23310001
233200         PERFORM 9120-INTERNAL-TABLE                              23320001
233300     END-IF.                                                      23330001
233400                                                                  23340001
233500     STRING ' SUKCS752 - '                                        23350001
233600            ' 8150-SELECT-CURRENT-CARTON'                         23360001
233700         DELIMITED BY SIZE                                        23370001
233800         INTO PV-CICS-MSG-AREA.                                   23380001
233900     PERFORM 9990-WRITE-CICS.                                     23390001
234000     EXEC SQL                                                     23400001
234100         SELECT SUM(SHPD_QTY)                                     23410001
234200           INTO :SHUUPC-SHPD-QTY  :DN-SUM-NULL-UPC                23420001
234300           FROM TSHUUPC                                           23430001
234400         WHERE SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID               23440001
234500           AND TRN_NBR           = :DK-PO-NBR                     23450001
234600           AND TRN_LNE_NBR       = :DK-PO-LINE-NBR                23460001
234700          WITH UR                                                 23470001
234800     END-EXEC.                                                    23480001
234900                                                                  23490001
235000     EVALUATE TRUE                                                23500001
235100         WHEN SQLCODE = ZERO                                      23510001
235200             IF DN-SUM-NULL-UPC = -1                              23520001
235300                 MOVE 0     TO SHUUPC-SHPD-QTY                    23530001
235400             END-IF                                               23540001
235500         WHEN SQLWARN0 NOT = SPACES                               23550001
235600         WHEN SQLCODE NOT EQUAL ZERO                              23560001
235700              MOVE '8150'  TO  PV-CSSL-PARA                       23570001
235800              PERFORM 9110-WRITE-SURD021-TO-CSSL                  23580001
235900                                                                  23590001
236000             MOVE '8100-SUM-PROMPTED-UNITS'                       23600001
236100                             TO DP013-PARAGRAPH                   23610001
236200             MOVE 'SUM THE PROMPTED CARTONS'                      23620001
236300                             TO DP013-MESSAGE-TEXT(1)             23630001
236400             MOVE DK-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID    23640001
236500             MOVE DK-PO-NBR         TO PV-DISPLAY-PO-NBR          23650001
236510             MOVE DK-PO-LINE-NBR    TO PV-DISPLAY-PO-LINE-NBR     23651001
236520             STRING 'SSCC:'             PV-DISPLAY-SHIPT-UNT-ID   23652001
236530                    ' PO:'              PV-DISPLAY-PO-NBR         23653001
236540                    ' LNE:'             PV-DISPLAY-PO-LINE-NBR    23654001
236550                                        DELIMITED BY SIZE         23655001
236560                                   INTO DP013-MESSAGE-TEXT (2)    23656001
236570             MOVE SQLCA      TO DP013-SQLCA                       23657001
236580             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           23658001
236590             SET DP013-DB2-ABEND                                  23659001
236600                             TO TRUE                              23660001
236700             SET DP013-NO-ROLLBACK                                23670001
236800                             TO TRUE                              23680001
236900             PERFORM 9999-WRITE-CICS-LOG-MSG                      23690001
237000             SET PS-DUMP-TO-LOG       TO TRUE                     23700001
237100             SET SU021-DB2-ERROR TO TRUE                          23710001
237200     END-EVALUATE.                                                23720001
237300                                                                  23730001
237400                                                                  23740001
237500 8200-SUM-CARTONS.                                                23750001
237600                                                                  23760001
237700     IF  PS-BLD-INTERNAL-TABLE-YES                                23770001
237800         MOVE '8200'  TO  PV-CSSL-PARA                            23780001
237900         PERFORM 9120-INTERNAL-TABLE                              23790001
238000     END-IF.                                                      23800001
238100                                                                  23810001
238200     STRING ' SUKCS752 - '                                        23820001
238300            ' 8200-SUM-CARTONS'                                   23830001
238400         DELIMITED BY SIZE                                        23840001
238500         INTO PV-CICS-MSG-AREA.                                   23850001
238600     PERFORM 9990-WRITE-CICS.                                     23860001
238700     EXEC SQL                                                     23870001
238800         SELECT COUNT(*)                                          23880001
238900           INTO :PV-CARTON-COUNT                                  23890001
239000           FROM TSUATRN                                           23900001
239100         WHERE  AUD_CNTL_NBR     = :DK-AUDIT-CNTL-NBR             23910001
239110          with ur                                                 23911002
239200     END-EXEC.                                                    23920001
239300                                                                  23930001
239400     EVALUATE TRUE                                                23940001
239500         WHEN SQLCODE = ZERO                                      23950001
239600             CONTINUE                                             23960001
239700         WHEN SQLWARN0 NOT = SPACES                               23970001
239800         WHEN SQLCODE NOT EQUAL ZERO                              23980001
239900              MOVE '8200'  TO  PV-CSSL-PARA                       23990001
240000              PERFORM 9110-WRITE-SURD021-TO-CSSL                  24000001
240100                                                                  24010001
240110             MOVE '8200-SUM-CARTONS'                              24011001
240120                             TO DP013-PARAGRAPH                   24012001
240130             MOVE 'SUM THE PROMPTED CARTONS'                      24013001
240140                             TO DP013-MESSAGE-TEXT(1)             24014001
240150             MOVE DK-AUDIT-CNTL-NBR    TO PV-DISPLAY-AUDIT        24015001
240160             STRING 'AUDIT:'              PV-DISPLAY-AUDIt        24016001
240170                                          DELIMITED BY SIZE       24017001
240180                                     INTO DP013-MESSAGE-TEXT (2)  24018001
240190             MOVE SQLCA      TO DP013-SQLCA                       24019001
240200             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           24020001
240300             SET DP013-DB2-ABEND                                  24030001
240400                             TO TRUE                              24040001
240500             SET DP013-NO-ROLLBACK                                24050001
240600                             TO TRUE                              24060001
240700             PERFORM 9999-WRITE-CICS-LOG-MSG                      24070001
240800             SET PS-DUMP-TO-LOG       TO TRUE                     24080001
240900             SET SU021-DB2-ERROR TO TRUE                          24090001
241000     END-EVALUATE.                                                24100001
241100                                                                  24110001
241200                                                                  24120001
241300 8250-SELECT-EXPECTD-CNT.                                         24130001
241400                                                                  24140001
241500     IF  PS-BLD-INTERNAL-TABLE-YES                                24150001
241600         MOVE '8250'  TO  PV-CSSL-PARA                            24160001
241700         PERFORM 9120-INTERNAL-TABLE                              24170001
241800     END-IF.                                                      24180001
241900                                                                  24190001
242000     STRING ' SUKCS752 - '                                        24200001
242100            ' 8250-SELECT-EXPECTD-CNT'                            24210001
242200         DELIMITED BY SIZE                                        24220001
242300         INTO PV-CICS-MSG-AREA.                                   24230001
242400     PERFORM 9990-WRITE-CICS.                                     24240001
242500     INITIALIZE        PV-DB2-COUNT-EXP-SCN.                      24250001
242600                                                                  24260001
242700     EXEC SQL                                                     24270001
242800          SELECT  COUNT(*)                                        24280001
242900          INTO  :PV-DB2-COUNT-EXP-SCN                             24290001
243000          FROM   TSHPTPO B                                        24300001
243100                ,TPKSLIP C                                        24310001
243200                ,TINPKSU D                                        24320001
243300          WHERE B.PO_NBR         = :DK-PO-NBR                     24330001
243400            AND B.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               24340001
243500            AND B.PO_NBR         = C.PO_NBR                       24350001
243600            AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                  24360001
243700            AND B.PRIM_SHIPT_IND = 'Y'                            24370001
243800            AND C.VER_STAT_CDE   = 'A'                            24380001
243900            AND B.PO_NBR         = D.PO_NBR                       24390001
244000            AND D.SEQ_NBR        = C.SEQ_NBR                      24400001
244100            AND NOT EXISTS                                        24410001
244200             (SELECT *                                            24420001
244300                FROM TSHUNLO E                                    24430001
244400               WHERE  E.SHIPT_UNT_ID   = D.SHIPT_UNT_ID           24440001
244500                 AND  E.ACTV_CDE       = 'A'                      24450001
244600                 AND  E.SCN_LOC_ID     = 'RECV')                  24460001
244700           with ur                                                24470001
244800     END-EXEC                                                     24480001
244900                                                                  24490001
245000                                                                  24500001
245100     EVALUATE TRUE                                                24510001
245200         WHEN SQLCODE = ZERO                                      24520001
245300         WHEN SQLCODE = +100                                      24530001
245400              CONTINUE                                            24540001
245500         WHEN SQLWARN0 NOT = SPACE                                24550001
245600         WHEN SQLCODE NOT = ZERO                                  24560001
245700              MOVE '8250'  TO  PV-CSSL-PARA                       24570001
245800              PERFORM 9110-WRITE-SURD021-TO-CSSL                  24580001
245900                                                                  24590001
246000             MOVE '8250-SELECT-EXPECTD-CNT'                       24600001
246100                               TO DP013-PARAGRAPH                 24610001
246110             MOVE 'SUKCS752 - GET PO EXPECTED COUNT'              24611001
246120                             TO DP013-MESSAGE-TEXT(1)             24612001
246130             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            24613001
246140             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      24614001
246150             STRING 'PO:'            PV-DISPLAY-PO-NBR            24615001
246160                    '-'              PV-DISPLAY-RCVR-SEQ-NBR      24616001
246170                                       DELIMITED BY SIZE          24617001
246180                           INTO DP013-MESSAGE-TEXT(2)             24618001
246190             MOVE SQLCA      TO DP013-SQLCA                       24619001
246200             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           24620001
246300             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(2)           24630001
246400             MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME(3)           24640001
246500             SET DP013-DB2-ABEND                                  24650001
246600                             TO TRUE                              24660001
246700             SET DP013-NO-ROLLBACK                                24670001
246800                             TO TRUE                              24680001
246900             PERFORM 9999-WRITE-CICS-LOG-MSG                      24690001
247000             SET PS-DUMP-TO-LOG       TO TRUE                     24700001
247100             SET SU021-DB2-ERROR TO TRUE                          24710001
247200     END-EVALUATE.                                                24720001
247300                                                                  24730001
247400                                                                  24740001
270623******************************************************************27062301
270624*  READ THE DISTRIBUTION TRANSACTION HEADER FOR MODULE AND        27062401
270625*  CARTON DATA.                                                   27062501
270626******************************************************************27062601
270627 8450-SELECT-DIST-HEAD.                                           27062701
270628                                                                  27062801
270629     IF  PS-BLD-INTERNAL-TABLE-YES                                27062901
270630         MOVE '8450'  TO  PV-CSSL-PARA                            27063001
270631         PERFORM 9120-INTERNAL-TABLE                              27063101
270632     END-IF.                                                      27063201
270633                                                                  27063301
270634     STRING ' SUKCS752 - '                                        27063401
270635            ' 8450-SELECT-DIST-HEAD'                              27063501
270636         DELIMITED BY SIZE                                        27063601
270637         INTO PV-CICS-MSG-AREA.                                   27063701
270638     PERFORM 9990-WRITE-CICS.                                     27063801
270639     INITIALIZE DCLTDISTHD.                                       27063901
270640                                                                  27064001
270641     EXEC SQL                                                     27064101
270642         SELECT  TOT_CART_CNT                                     27064201
270643              ,  OTPK_UNT_QTY                                     27064301
270644           INTO  :DISTHD-TOT-CART-CNT                             27064401
270645              ,  :DISTHD-OTPK-UNT-QTY                             27064501
270646           FROM  TDISTHD                                          27064601
270647          WHERE  ORD_NBR         = :DK-PO-NBR                     27064701
270648            AND  RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR               27064801
270649            AND  ORD_LNE_NBR     = :DK-PO-LINE-NBR                27064901
270650           WITH UR                                                27065001
270660     END-EXEC.                                                    27066001
270670                                                                  27067001
270680     EVALUATE TRUE                                                27068001
270690         WHEN SQLCODE = ZERO                                      27069001
270700             CONTINUE                                             27070001
270800         WHEN SQLWARN0 NOT = SPACES                               27080001
270900         WHEN SQLCODE NOT EQUAL ZERO                              27090001
271000              MOVE '8450'  TO  PV-CSSL-PARA                       27100001
271100              PERFORM 9110-WRITE-SURD021-TO-CSSL                  27110001
271200                                                                  27120001
271300             MOVE '8450-SELECT-DIST-HEAD'                         27130001
271400                             TO DP013-PARAGRAPH                   27140001
271500             MOVE 'SELECT DIST HEADER'                            27150001
271600                             TO DP013-MESSAGE-TEXT(1)             27160001
271700             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            27170001
271710             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      27171001
271720             MOVE DK-PO-LINE-NBR  TO PV-DISPLAY-PO-LINE-NBR       27172001
271730             STRING 'PO:'            PV-DISPLAY-PO-NBR            27173001
271740                    '-'              PV-DISPLAY-RCVR-SEQ-NBR      27174001
271750                    '-'              PV-DISPLAY-PO-LINE-NBR       27175001
271760                                     DELIMITED BY SIZE            27176001
271770                                INTO DP013-MESSAGE-TEXT(2)        27177001
271780             MOVE SQLCA      TO DP013-SQLCA                       27178001
271790             MOVE 'TDISTHD'  TO DP013-DB2-TABLE-NAME(1)           27179001
271800             SET DP013-DB2-ABEND                                  27180001
271900                             TO TRUE                              27190001
272000             SET DP013-NO-ROLLBACK                                27200001
272100                             TO TRUE                              27210001
272200             PERFORM 9999-WRITE-CICS-LOG-MSG                      27220001
272300             SET PS-DUMP-TO-LOG       TO TRUE                     27230001
272400             SET SU021-DB2-ERROR TO TRUE                          27240001
272500     END-EVALUATE.                                                27250001
272600                                                                  27260001
272700******************************************************************27270001
272800 8500-SUM-DISTRO-DETAIL.                                          27280001
272900                                                                  27290001
273000     IF  PS-BLD-INTERNAL-TABLE-YES                                27300001
273100         MOVE '8500'  TO  PV-CSSL-PARA                            27310001
273200         PERFORM 9120-INTERNAL-TABLE                              27320001
273300     END-IF.                                                      27330001
273400                                                                  27340001
273500     STRING ' SUKCS752 - '                                        27350001
273600            ' 8500-SUM-DISTRO-DETAIL'                             27360001
273700         DELIMITED BY SIZE                                        27370001
273800         INTO PV-CICS-MSG-AREA.                                   27380001
273900     PERFORM 9990-WRITE-CICS.                                     27390001
274000     INITIALIZE DCLTDISTDT.                                       27400001
274100                                                                  27410001
274200     EXEC SQL                                                     27420001
274300         SELECT  SUM(EXPTED_ALLOC_QTY)                            27430001
274400           INTO  :PV-SUM-EXPTD-ALLOC :DN-SUM-NULL                 27440001
274500           FROM  TDISTDT                                          27450001
274600          WHERE  ORD_NBR         = :DK-PO-NBR                     27460001
274700            AND  RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR               27470001
274800            AND  ORD_LNE_NBR     = :DK-PO-LINE-NBR                27480001
274900           WITH UR                                                27490001
275000     END-EXEC.                                                    27500001
275100                                                                  27510001
275200     EVALUATE TRUE                                                27520001
275300         WHEN SQLCODE = ZERO                                      27530001
275400             IF DN-SUM-NULL = -1                                  27540001
275500                 MOVE 0     TO PV-SUM-EXPTD-ALLOC                 27550001
275600             END-IF                                               27560001
275700         WHEN SQLWARN0 NOT = SPACES                               27570001
275800         WHEN SQLCODE NOT EQUAL ZERO                              27580001
275900              MOVE '8500'  TO  PV-CSSL-PARA                       27590001
276000              PERFORM 9110-WRITE-SURD021-TO-CSSL                  27600001
276100                                                                  27610001
276200             MOVE '8500-SUM-DISTRO-DETAIL'                        27620001
276300                             TO DP013-PARAGRAPH                   27630001
276400             MOVE 'SUM DISTRO DETAIL'                             27640001
276500                             TO DP013-MESSAGE-TEXT(1)             27650001
276600             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            27660001
276700             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      27670001
276800             MOVE DK-PO-LINE-NBR  TO PV-DISPLAY-PO-LINE-NBR       27680001
276900             STRING 'PO:'            PV-DISPLAY-PO-NBR            27690001
277000                    '-'              PV-DISPLAY-RCVR-SEQ-NBR      27700001
277100                    '-'              PV-DISPLAY-PO-LINE-NBR       27710001
277200                                     DELIMITED BY SIZE            27720001
277300                                INTO DP013-MESSAGE-TEXT(2)        27730001
277400             MOVE SQLCA      TO DP013-SQLCA                       27740001
277500             MOVE 'TDISTDT'  TO DP013-DB2-TABLE-NAME(1)           27750001
277600             SET DP013-DB2-ABEND                                  27760001
277700                             TO TRUE                              27770001
277800             SET DP013-NO-ROLLBACK                                27780001
277900                             TO TRUE                              27790001
278000             PERFORM 9999-WRITE-CICS-LOG-MSG                      27800001
278100             SET PS-DUMP-TO-LOG       TO TRUE                     27810001
278200             SET SU021-DB2-ERROR TO TRUE                          27820001
278300     END-EVALUATE.                                                27830001
278400                                                                  27840001
284200******************************************************************28420001
284300*  READ THE DISTRIBUTION TRANSACTION HEADER FOR MODULE AND        28430001
284400*  CARTON DATA.                                                   28440001
284500******************************************************************28450001
284600 8600-SELECT-DRIVER-LINE-QTY.                                     28460001
284700                                                                  28470001
284800     IF  PS-BLD-INTERNAL-TABLE-YES                                28480001
284900         MOVE '8600'  TO  PV-CSSL-PARA                            28490001
285000         PERFORM 9120-INTERNAL-TABLE                              28500001
285100     END-IF.                                                      28510001
285200                                                                  28520001
285300     STRING ' SUKCS752 - '                                        28530001
285400            ' 8600-SELECT-DRIVER-LINE-QTY'                        28540001
285500         DELIMITED BY SIZE                                        28550001
285600         INTO PV-CICS-MSG-AREA.                                   28560001
285700     PERFORM 9990-WRITE-CICS.                                     28570001
285800     INITIALIZE DCLTDISTHD.                                       28580001
285900                                                                  28590001
286000     EXEC SQL                                                     28600001
286100         SELECT  TOT_CART_CNT                                     28610001
286200              ,  OTPK_UNT_QTY                                     28620001
286300           INTO  :DISTHD-TOT-CART-CNT                             28630001
286400              ,  :DISTHD-OTPK-UNT-QTY                             28640001
286500           FROM  TDISTHD                                          28650001
286600          WHERE  ORD_NBR           = :DK-PO-NBR                   28660001
286700            AND  RCVR_SEQ_NBR      = :DK-RCVR-SEQ-NBR             28670001
286800            AND  ORD_LNE_NBR       = :DK-PO-DRIVER-LINE           28680001
286900            AND  PREPK_LNE_PRC_CDE = :PC-D                        28690001
287000           WITH UR                                                28700001
287100     END-EXEC.                                                    28710001
287200                                                                  28720001
287300     EVALUATE TRUE                                                28730001
287400         WHEN SQLCODE = ZERO                                      28740001
287500             CONTINUE                                             28750001
287600         WHEN SQLWARN0 NOT = SPACES                               28760001
287700         WHEN SQLCODE NOT EQUAL ZERO                              28770001
287800              MOVE '8600'  TO  PV-CSSL-PARA                       28780001
287900              PERFORM 9110-WRITE-SURD021-TO-CSSL                  28790001
288000                                                                  28800001
288100             MOVE '8600-SELECT-DRIVER-LINE-QTY'                   28810001
288200                             TO DP013-PARAGRAPH                   28820001
288300             MOVE 'SELECT DIST HEADER'                            28830001
288400                             TO DP013-MESSAGE-TEXT(1)             28840001
288410             MOVE DK-PO-NBR         TO PV-DISPLAY-PO-NBR          28841001
288420             MOVE DK-RCVR-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR    28842001
288430             MOVE DK-PO-DRIVER-LINE TO PV-DISPLAY-PO-LINE-NBR     28843001
288440             STRING 'PO:'              PV-DISPLAY-PO-NBR          28844001
288450                    '-'                PV-DISPLAY-RCVR-SEQ-NBR    28845001
288460                    '-'                PV-DISPLAY-PO-LINE-NBR     28846001
288470                                       DELIMITED BY SIZE          28847001
288480                                  INTO DP013-MESSAGE-TEXT(2)      28848001
288490             MOVE SQLCA      TO DP013-SQLCA                       28849001
288500             MOVE 'TDISTHD'  TO DP013-DB2-TABLE-NAME(1)           28850001
288600             SET DP013-DB2-ABEND                                  28860001
288700                             TO TRUE                              28870001
288800             SET DP013-NO-ROLLBACK                                28880001
288900                             TO TRUE                              28890001
289000             PERFORM 9999-WRITE-CICS-LOG-MSG                      28900001
289100             SET PS-DUMP-TO-LOG       TO TRUE                     28910001
289200             SET SU021-DB2-ERROR TO TRUE                          28920001
289300     END-EVALUATE.                                                28930001
289400                                                                  28940001
289500 8650-SUM-PRE-PACK-DETAIL.                                        28950001
289600                                                                  28960001
289700     IF  PS-BLD-INTERNAL-TABLE-YES                                28970001
289800         MOVE '8650'  TO  PV-CSSL-PARA                            28980001
289900         PERFORM 9120-INTERNAL-TABLE                              28990001
290000     END-IF.                                                      29000001
290100                                                                  29010001
290200     STRING ' SUKCS752 - '                                        29020001
290300            ' 8650-SUM-PRE-PACK-DETAIL'                           29030001
290400         DELIMITED BY SIZE                                        29040001
290500         INTO PV-CICS-MSG-AREA.                                   29050001
290600     PERFORM 9990-WRITE-CICS.                                     29060001
290700     EXEC SQL                                                     29070001
290800          SELECT SUM(D.EXPTED_ALLOC_QTY)                          29080001
290900           INTO  :PV-SUM-OF-ALL-LINES  :DN-SUM-NULL               29090001
291000            FROM TRECITM A                                        29100001
291100                ,TPURITM B                                        29110001
291200                ,TDISTHD C                                        29120001
291300                ,TDISTDT D                                        29130001
291400           WHERE A.ORD_NBR           = :DK-PO-NBR                 29140001
291500             AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR           29150001
291600             AND A.PREPK_ID          = :DK-PREPK-ID               29160001
291700             AND A.ORD_NBR           = B.PO_NBR                   29170001
291800             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           29180001
291900             AND A.VER_STATUS_CDE    = :PC-A                      29190001
292000             AND A.PO_VER_NBR        = B.VER_NBR                  29200001
292100             AND C.ORD_NBR           = A.ORD_NBR                  29210001
292200             AND C.RCVR_SEQ_NBR      = A.REC_SEQ_NBR              29220001
292300             AND C.ORD_LNE_NBR       = A.ORD_LNE_NBR              29230001
292400             AND D.ORD_NBR           = C.ORD_NBR                  29240001
292500             AND D.RCVR_SEQ_NBR      = C.RCVR_SEQ_NBR             29250001
292600             AND D.ORD_LNE_NBR       = C.ORD_LNE_NBR              29260001
292700            WITH UR                                               29270001
292800     END-EXEC.                                                    29280001
292900                                                                  29290001
293000     EVALUATE TRUE                                                29300001
293100         WHEN SQLCODE = ZERO                                      29310001
293200             IF DN-SUM-NULL = -1                                  29320001
293300                 MOVE 0     TO PV-SUM-OF-ALL-LINES                29330001
293400             END-IF                                               29340001
293500         WHEN SQLWARN0 NOT = SPACES                               29350001
293600         WHEN SQLCODE NOT EQUAL ZERO                              29360001
293700              MOVE '8650'  TO  PV-CSSL-PARA                       29370001
293800              PERFORM 9110-WRITE-SURD021-TO-CSSL                  29380001
293900                                                                  29390001
294000             MOVE '8650-SUM-PRE-PACK-DETAIL'                      29400001
294100                             TO DP013-PARAGRAPH                   29410001
294200             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            29420001
294300             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      29430001
294400             MOVE DK-PREPK-ID     TO PV-DISPLAY-PREPK-ID          29440001
294500             STRING 'PO:'            PV-DISPLAY-PO-NBR            29450001
294600                    '-'              PV-DISPLAY-RCVR-SEQ-NBR      29460001
294700                    ' PREPK:'        PV-DISPLAY-PREPK-ID          29470001
294710                                       DELIMITED BY SIZE          29471001
294720                           INTO DP013-MESSAGE-TEXT(1)             29472001
294730             MOVE SQLCA      TO DP013-SQLCA                       29473001
294740             MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(1)           29474001
294750             MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME(2)           29475001
294760             MOVE 'TDISTHD'  TO DP013-DB2-TABLE-NAME(3)           29476001
294770             MOVE 'TDISTDT'  TO DP013-DB2-TABLE-NAME(4)           29477001
294780             SET DP013-DB2-ABEND                                  29478001
294790                             TO TRUE                              29479001
294800             SET DP013-NO-ROLLBACK                                29480001
294900                             TO TRUE                              29490001
295000             PERFORM 9999-WRITE-CICS-LOG-MSG                      29500001
295100             SET PS-DUMP-TO-LOG       TO TRUE                     29510001
295200             SET SU021-DB2-ERROR TO TRUE                          29520001
295300     END-EVALUATE.                                                29530001
295400                                                                  29540001
301500 8800-COUNT-CHECKED-IN-CRTNS.                                     30150001
301600                                                                  30160001
301700     IF  PS-BLD-INTERNAL-TABLE-YES                                30170001
301800         MOVE '8800'  TO  PV-CSSL-PARA                            30180001
301900         PERFORM 9120-INTERNAL-TABLE                              30190001
302000     END-IF.                                                      30200001
302100                                                                  30210001
302200     STRING ' SUKCS752 - '                                        30220001
302300            ' 8800-COUNT-CHECKED-IN-CRTNS'                        30230001
302400         DELIMITED BY SIZE                                        30240001
302500         INTO PV-CICS-MSG-AREA.                                   30250001
302600     PERFORM 9990-WRITE-CICS.                                     30260001
302700                                                                  30270001
302800     EXEC SQL                                                     30280001
302900          SELECT   COUNT (DISTINCT C.SHIPT_UNT_ID)                30290001
303000            INTO  :PV-CHECK-IN-COUNT                              30300001
303100            FROM  TPKSLIP A                                       30310001
303200               ,  TINPKSU B                                       30320001
303300               ,  TSHUUPC C                                       30330001
303400               ,  TSHUNLO D                                       30340001
303500           WHERE  A.PO_NBR         = :DK-PO-NBR                   30350001
303600             AND  A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             30360001
303700             AND  A.VER_STAT_CDE   = 'A'                          30370001
303800             AND  A.PKSL_STAT_CDE  = 'AC'                         30380001
303900             AND  B.PO_NBR         = A.PO_NBR                     30390001
304000             AND  B.SEQ_NBR        = A.SEQ_NBR                    30400001
304100             AND  C.SHIPT_UNT_ID   = B.SHIPT_UNT_ID               30410001
304200             AND  C.TRN_NBR        = B.PO_NBR                     30420001
304300             AND  C.TRN_LNE_NBR    = :DK-SHUUPC-LNE-NBR           30430001
304400             AND  C.SHIPT_UNT_ID   = D.SHIPT_UNT_ID               30440001
304500             AND  D.ACTV_CDE       = 'A'                          30450001
304600             AND  D.SCN_LOC_ID     = 'RECV'                       30460001
304610            with ur                                               30461002
304700     END-EXEC.                                                    30470001
304800                                                                  30480001
304900     EVALUATE TRUE                                                30490001
305000         WHEN SQLCODE = ZERO                                      30500001
305100             CONTINUE                                             30510001
305200         WHEN SQLWARN0 NOT = SPACES                               30520001
305300         WHEN SQLCODE NOT EQUAL ZERO                              30530001
305400              MOVE '8800'  TO  PV-CSSL-PARA                       30540001
305500              PERFORM 9110-WRITE-SURD021-TO-CSSL                  30550001
305600                                                                  30560001
305700             MOVE '8800-COUNT-CHECKED-IN-CRTNS'                   30570001
305800                             TO DP013-PARAGRAPH                   30580001
305900             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            30590001
306000             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      30600001
306100             STRING 'PO:'            PV-DISPLAY-PO-NBR            30610001
306200                    '-'              PV-DISPLAY-RCVR-SEQ-NBR      30620001
306300                                     DELIMITED BY SIZE            30630001
306400                                INTO DP013-MESSAGE-TEXT(1)        30640001
306500             MOVE SQLCA      TO DP013-SQLCA                       30650001
306600             MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME(1)           30660001
306700             MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME(1)           30670001
306800             MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME(1)           30680001
306900             MOVE 'TSHUNLO ' TO DP013-DB2-TABLE-NAME(1)           30690001
307000             SET DP013-DB2-ABEND                                  30700001
307100                             TO TRUE                              30710001
307200             SET DP013-NO-ROLLBACK                                30720001
307300                             TO TRUE                              30730001
307400             PERFORM 9999-WRITE-CICS-LOG-MSG                      30740001
307500             SET PS-DUMP-TO-LOG       TO TRUE                     30750001
307600             SET SU021-DB2-ERROR TO TRUE                          30760001
307700     END-EVALUATE.                                                30770001
307800                                                                  30780001
307900                                                                  30790001
308000 8850-SELECT-TKRPRPM.                                             30800001
308100                                                                  30810001
308200     IF  PS-BLD-INTERNAL-TABLE-YES                                30820001
308300         MOVE '8850'  TO  PV-CSSL-PARA                            30830001
308400         PERFORM 9120-INTERNAL-TABLE                              30840001
308500     END-IF.                                                      30850001
308600                                                                  30860001
308700     STRING ' SUKCS752 - '                                        30870001
308800            ' 8850-SELECT-TKRPRPM'                                30880001
308900         DELIMITED BY SIZE                                        30890001
309000         INTO PV-CICS-MSG-AREA.                                   30900001
309100     PERFORM 9990-WRITE-CICS.                                     30910001
309200                                                                  30920001
309300     EXEC SQL                                                     30930001
309400          SELECT FUNC_TXT                                         30940001
309500            INTO :KRPRPM-FUNC-TXT                                 30950001
309600            FROM TKRPRPM                                          30960001
309700           WHERE LOC_ID            = :DK-OPER-UNT-ID              30970001
309800             AND INTFC_SYS_CDE    = 'AUD'                         30980001
309900             AND SYS_PRC_FUNC_CDE = 'DMPAUD'                      30990001
310000             AND FUNC_PRC_STAT_CDE = 'AC'                         31000001
310100            WITH UR                                               31010001
310200     END-EXEC.                                                    31020001
310300                                                                  31030001
310400     EVALUATE TRUE                                                31040001
310500         WHEN SQLCODE = ZERO                                      31050001
310600             IF KRPRPM-FUNC-TXT = 'Y'                             31060001
310700                 SET PS-SHOW-DEBUG-INFO                           31070001
310800                                      TO TRUE                     31080001
310900             ELSE                                                 31090001
311000                 SET PS-DONT-SHOW-DEBUG-INFO                      31100001
311100                                      TO TRUE                     31110001
311200             END-IF                                               31120001
311300         WHEN SQLWARN0 NOT = SPACES                               31130001
311400         WHEN SQLCODE NOT EQUAL ZERO                              31140001
311500              MOVE '8850'  TO  PV-CSSL-PARA                       31150001
311600              PERFORM 9110-WRITE-SURD021-TO-CSSL                  31160001
311700                                                                  31170001
311800             MOVE '8850-SELECT-TKRPRPM'                           31180001
311900                             TO DP013-PARAGRAPH                   31190001
312000             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        31200001
312100             STRING 'OPER:'         PV-DISPLAY-OPER-UNT-ID        31210001
312200                                    DELIMITED BY SIZE             31220001
312300                               INTO DP013-MESSAGE-TEXT(1)         31230001
312400             MOVE SQLCA      TO DP013-SQLCA                       31240001
312500             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           31250001
312600             SET DP013-DB2-ABEND                                  31260001
312700                             TO TRUE                              31270001
312800             SET DP013-NO-ROLLBACK                                31280001
312900                             TO TRUE                              31290001
313000             PERFORM 9999-WRITE-CICS-LOG-MSG                      31300001
313100             SET PS-DUMP-TO-LOG       TO TRUE                     31310001
313200             SET SU021-DB2-ERROR TO TRUE                          31320001
313300     END-EVALUATE.                                                31330001
313400                                                                  31340001
313500 8900-SUM-PP-PROMPTED-UNITS.                                      31350001
313600                                                                  31360001
313700     IF  PS-BLD-INTERNAL-TABLE-YES                                31370001
313800         MOVE '8900'  TO  PV-CSSL-PARA                            31380001
313900         PERFORM 9120-INTERNAL-TABLE                              31390001
314000     END-IF.                                                      31400001
314100                                                                  31410001
314200     STRING ' SUKCS752 - '                                        31420001
314300            ' 8900-SUM-PP-PROMPTED-UNITS'                         31430001
314400         DELIMITED BY SIZE                                        31440001
314500         INTO PV-CICS-MSG-AREA.                                   31450001
314600     PERFORM 9990-WRITE-CICS.                                     31460001
314700     EXEC SQL                                                     31470001
314800         SELECT SUM(B.SHPD_QTY)                                   31480001
314900           INTO :PV-SHPD-QTY-SUM :DN-SUM-NULL                     31490001
315000           FROM TSUATRN A                                         31500001
315100             ,  TSHUUPC B                                         31510001
315200         WHERE A.AUD_CNTL_NBR    = :DK-AUDIT-CNTL-NBR             31520001
315300           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 31530001
315400           AND B.TRN_NBR         = :DK-PO-NBR                     31540001
315500           AND B.TRN_LNE_NBR     = :DK-PO-DRIVER-LINE             31550001
315510          with ur                                                 31551002
315600     END-EXEC.                                                    31560001
315700                                                                  31570001
315800     EVALUATE TRUE                                                31580001
315900         WHEN SQLCODE = ZERO                                      31590001
316000             IF DN-SUM-NULL = -1                                  31600001
316100                 MOVE 0     TO PV-SHPD-QTY-SUM                    31610001
316200             END-IF                                               31620001
316300         WHEN SQLWARN0 NOT = SPACES                               31630001
316400         WHEN SQLCODE NOT EQUAL ZERO                              31640001
316410              MOVE '8900'  TO  PV-CSSL-PARA                       31641001
316420              PERFORM 9110-WRITE-SURD021-TO-CSSL                  31642001
316430                                                                  31643001
316440             MOVE '8900-SUM-PP-PROMPTED-UNITS'                    31644001
316450                             TO DP013-PARAGRAPH                   31645001
316460             MOVE 'SUM THE PROMPTED CARTONS'                      31646001
316470                             TO DP013-MESSAGE-TEXT(1)             31647001
316471             MOVE DK-AUDIT-CNTL-NBR TO PV-DISPLAY-AUDIT           31647101
316472             MOVE DK-PO-NBR         TO PV-DISPLAY-PO-NBR          31647201
316473             MOVE DK-PO-DRIVER-LINE TO PV-DISPLAY-PO-LINE-NBR     31647301
316474             STRING 'AUDIT:'           PV-DISPLAY-AUDIT           31647401
316475                    ' PO:'             PV-DISPLAY-PO-NBR          31647501
316476                    ' LNE:'            PV-DISPLAY-PO-LINE-NBR     31647601
316477                                       DELIMITED BY SIZE          31647701
316478                                  INTO DP013-MESSAGE-TEXT (2)     31647801
316479             MOVE SQLCA      TO DP013-SQLCA                       31647901
316480             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           31648001
316490             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           31649001
316500             SET DP013-DB2-ABEND                                  31650001
316600                             TO TRUE                              31660001
316700             SET DP013-NO-ROLLBACK                                31670001
316800                             TO TRUE                              31680001
316900             PERFORM 9999-WRITE-CICS-LOG-MSG                      31690001
317000             SET PS-DUMP-TO-LOG       TO TRUE                     31700001
317100             SET SU021-DB2-ERROR TO TRUE                          31710001
317200     END-EVALUATE.                                                31720001
317300                                                                  31730001
317400 8950-SELECT-CURRENT-PP-CARTON.                                   31740001
317500                                                                  31750001
317600     IF  PS-BLD-INTERNAL-TABLE-YES                                31760001
317700         MOVE '8950'  TO  PV-CSSL-PARA                            31770001
317800         PERFORM 9120-INTERNAL-TABLE                              31780001
317900     END-IF.                                                      31790001
318000                                                                  31800001
318100     STRING ' SUKCS752 - '                                        31810001
318200            ' 8950-SELECT-CURRENT-PP-CARTON'                      31820001
318300         DELIMITED BY SIZE                                        31830001
318400         INTO PV-CICS-MSG-AREA.                                   31840001
318500     PERFORM 9990-WRITE-CICS.                                     31850001
318600     EXEC SQL                                                     31860001
318700         SELECT SUM(SHPD_QTY)                                     31870001
318800           INTO :SHUUPC-SHPD-QTY :DN-SUM-NULL-UPC                 31880001
318900           FROM TSHUUPC                                           31890001
319000         WHERE SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID               31900001
319100           AND TRN_NBR           = :DK-PO-NBR                     31910001
319200           AND TRN_LNE_NBR       = :DK-PO-DRIVER-LINE             31920001
319300          WITH UR                                                 31930001
319400     END-EXEC.                                                    31940001
319500                                                                  31950001
319600     EVALUATE TRUE                                                31960001
319700         WHEN SQLCODE = ZERO                                      31970001
319800             IF DN-SUM-NULL-UPC = -1                              31980001
319900                 MOVE 0     TO SHUUPC-SHPD-QTY                    31990001
320000             END-IF                                               32000001
320100         WHEN SQLWARN0 NOT = SPACES                               32010001
320200         WHEN SQLCODE NOT EQUAL ZERO                              32020001
320300              MOVE '8950'  TO  PV-CSSL-PARA                       32030001
320400              PERFORM 9110-WRITE-SURD021-TO-CSSL                  32040001
320500                                                                  32050001
320600             MOVE '8950-SELECT-CURRENT-PP-CARTON'                 32060001
320700                             TO DP013-PARAGRAPH                   32070001
320800             MOVE 'SELECT THE UNIT QTY - THIS CARTON'             32080001
320900                             TO DP013-MESSAGE-TEXT(1)             32090001
320910             MOVE DK-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID    32091001
320920             MOVE DK-PO-NBR         TO PV-DISPLAY-PO-NBR          32092001
320930             MOVE DK-PO-DRIVER-LINE TO PV-DISPLAY-PO-LINE-NBR     32093001
320940             STRING 'SSCC:'            PV-DISPLAY-SHIPT-UNT-ID    32094001
320950                    ' PO:'             PV-DISPLAY-PO-NBR          32095001
320960                    ' LNE:'            PV-DISPLAY-PO-LINE-NBR     32096001
320970                                       DELIMITED BY SIZE          32097001
320980                                  INTO DP013-MESSAGE-TEXT(2)      32098001
320990             MOVE SQLCA      TO DP013-SQLCA                       32099001
321000             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           32100001
321100             SET DP013-DB2-ABEND                                  32110001
321200                             TO TRUE                              32120001
321300             SET DP013-NO-ROLLBACK                                32130001
321400                             TO TRUE                              32140001
321500             PERFORM 9999-WRITE-CICS-LOG-MSG                      32150001
321600             SET PS-DUMP-TO-LOG       TO TRUE                     32160001
321700             SET SU021-DB2-ERROR TO TRUE                          32170001
321800     END-EVALUATE.                                                32180001
321900                                                                  32190001
322000                                                                  32200001
322100 9000-SELECT-CARTON.                                              32210001
322200                                                                  32220001
322300     IF  PS-BLD-INTERNAL-TABLE-YES                                32230001
322400         MOVE '9000'  TO  PV-CSSL-PARA                            32240001
322500         PERFORM 9120-INTERNAL-TABLE                              32250001
322600     END-IF.                                                      32260001
322700                                                                  32270001
322800     STRING ' SUKCS752 - '                                        32280001
322900            ' 9000-SELECT-CARTON'                                 32290001
323000         DELIMITED BY SIZE                                        32300001
323100         INTO PV-CICS-MSG-AREA.                                   32310001
323200     PERFORM 9990-WRITE-CICS.                                     32320001
323300                                                                  32330001
323400     EXEC SQL                                                     32340001
323500         SELECT A.AUD_CNTL_NBR                                    32350001
323600           INTO :SUATRN-AUD-CNTL-NBR                              32360001
323700           FROM TSUATRN A                                         32370001
323800             ,  SUT_PO_AUD_REQ B                                  32380001
323900         WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                32390001
324000           AND  A.AUD_CNTL_NBR  = B.AUD_CNTL_NBR                  32400001
324200           AND  B.PKGNG_TYP_CDE <> 'RF'                           32420001
324400           WITH UR                                                32440001
324500     END-EXEC.                                                    32450001
324600                                                                  32460001
324700     EVALUATE TRUE                                                32470001
324800         WHEN SQLCODE = ZERO                                      32480001
324900             SET PS-CARTON-ALREADY-EXISTS TO TRUE                 32490001
325000         WHEN SQLCODE = -811                                      32500001
325100             PERFORM 9010-SELECT-CARTON-2                         32510001
325200         WHEN SQLCODE = +100                                      32520001
325300             SET PS-CARTON-DOESNT-EXIST   TO TRUE                 32530001
325400         WHEN SQLWARN0 NOT = SPACES                               32540001
325500         WHEN SQLCODE NOT EQUAL ZERO                              32550001
325600              MOVE '9000'  TO  PV-CSSL-PARA                       32560001
325700              PERFORM 9110-WRITE-SURD021-TO-CSSL                  32570001
325800                                                                  32580001
325810             MOVE '9000-SELECT-CARTON'                            32581001
325820                             TO DP013-PARAGRAPH                   32582001
325830             MOVE 'SELECT THE CARTON'                             32583001
325840                             TO DP013-MESSAGE-TEXT(1)             32584001
325850             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      32585001
325860             STRING 'SSCC:'          PV-DISPLAY-SHIPT-UNT-ID      32586001
325870                                     DELIMITED BY SIZE            32587001
325880                                INTO DP013-MESSAGE-TEXT(2)        32588001
325890             MOVE SQLCA      TO DP013-SQLCA                       32589001
325900             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           32590001
326000             SET DP013-DB2-ABEND                                  32600001
326100                             TO TRUE                              32610001
326200             SET DP013-NO-ROLLBACK                                32620001
326300                             TO TRUE                              32630001
326400             PERFORM 9999-WRITE-CICS-LOG-MSG                      32640001
326500             SET PS-DUMP-TO-LOG       TO TRUE                     32650001
326600             SET SU021-DB2-ERROR TO TRUE                          32660001
326700     END-EVALUATE.                                                32670001
326800                                                                  32680001
326900                                                                  32690001
327000 9010-SELECT-CARTON-2.                                            32700001
327100                                                                  32710001
327200     IF  PS-BLD-INTERNAL-TABLE-YES                                32720001
327300         MOVE '9010'  TO  PV-CSSL-PARA                            32730001
327400         PERFORM 9120-INTERNAL-TABLE                              32740001
327500     END-IF.                                                      32750001
327600                                                                  32760001
327700                                                                  32770001
327800     STRING ' SUKCS752 - '                                        32780001
327900            ' 9010-SELECT-CARTON-2'                               32790001
328000         DELIMITED BY SIZE                                        32800001
328100         INTO PV-CICS-MSG-AREA.                                   32810001
328200     PERFORM 9990-WRITE-CICS.                                     32820001
328300                                                                  32830001
328400     EXEC SQL                                                     32840001
328500         SELECT A.AUD_CNTL_NBR                                    32850001
328600           INTO :SUATRN-AUD-CNTL-NBR                              32860001
328700           FROM TSUATRN A                                         32870001
328800             ,  SUT_PO_AUD_REQ B                                  32880001
328900         WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                32890001
329000           AND  A.AUD_CNTL_NBR  = B.AUD_CNTL_NBR                  32900001
329100           AND  A.REC_SEQ_NBR   = :DK-RCVR-SEQ-NBR                32910001
329200           AND  B.OPER_UNT_ID   = :DK-OPER-UNT-ID                 32920001
329400           AND  B.PKGNG_TYP_CDE <> 'RF'                           32940001
329600           WITH UR                                                32960001
329700     END-EXEC.                                                    32970001
329800                                                                  32980001
329900     EVALUATE TRUE                                                32990001
330000         WHEN SQLCODE = ZERO                                      33000001
330100         WHEN SQLCODE = -811                                      33010001
330200             SET PS-CARTON-ALREADY-EXISTS TO TRUE                 33020001
330300         WHEN SQLCODE = +100                                      33030001
330400             SET PS-CARTON-DOESNT-EXIST   TO TRUE                 33040001
330500         WHEN SQLWARN0 NOT = SPACES                               33050001
330600         WHEN SQLCODE NOT EQUAL ZERO                              33060001
330700              MOVE '9010'  TO  PV-CSSL-PARA                       33070001
330710              PERFORM 9110-WRITE-SURD021-TO-CSSL                  33071001
330720                                                                  33072001
330730             MOVE '9010-SELECT-CARTON-2'                          33073001
330740                             TO DP013-PARAGRAPH                   33074001
330750             MOVE 'SELECT THE CARTON'                             33075001
330760                             TO DP013-MESSAGE-TEXT(1)             33076001
330770             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      33077001
330780             MOVE DK-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR      33078001
330781             MOVE DK-OPER-UNT-ID  TO PV-DISPLAY-OPER-UNT-ID       33078101
330782             STRING 'SSCC:'          PV-DISPLAY-SHIPT-UNT-ID      33078201
330783                    ' RCVR:'         PV-DISPLAY-RCVR-SEQ-NBR      33078301
330784                    ' OPER:'         PV-DISPLAY-OPER-UNT-ID       33078401
330785                                     DELIMITED BY SIZE            33078501
330786                                INTO DP013-MESSAGE-TEXT(2)        33078601
330787             MOVE SQLCA      TO DP013-SQLCA                       33078701
330788             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           33078801
330789             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(2)           33078901
330790             SET DP013-DB2-ABEND                                  33079001
330800                             TO TRUE                              33080001
330900             SET DP013-NO-ROLLBACK                                33090001
331000                             TO TRUE                              33100001
331100             PERFORM 9999-WRITE-CICS-LOG-MSG                      33110001
331200             SET PS-DUMP-TO-LOG       TO TRUE                     33120001
331300             SET SU021-DB2-ERROR TO TRUE                          33130001
331400     END-EVALUATE.                                                33140001
331500                                                                  33150001
331600                                                                  33160001
331700*---------------------------------------------------------------* 33170001
331800* check parm table (TKRPRPM) to check for logging to CSSL       * 33180001
331900* IF PROGRAM IS TAKING TOO LONG TO RESPOND.  THE VALUE WILL     * 33190001
332000* BE seconds AND WILL BE USED TO DETERMINE IF WE SHOULD WRITE   * 33200001
332100* pt-pARA-tRACKING TABLE TO CSSL                                * 33210001
332200* check parm table (TKRPRPM) to check if will be building the   * 33220001
332300* internal table during processing.  this will be used when     * 33230001
332400* dc's report long resonse times                                * 33240001
332500*  2015-01-29 - DMH                                             * 33250001
332600*---------------------------------------------------------------* 33260001
332610 9100-CHECK-PARA-TRACK-SEC.                                       33261001
332620                                                                  33262001
332630     IF  PS-BLD-INTERNAL-TABLE-YES                                33263001
332640         MOVE  '9100'  TO  PV-CSSL-PARA                           33264001
332650         PERFORM 9120-INTERNAL-TABLE                              33265001
332660     END-IF.                                                      33266001
332670                                                                  33267001
332680     STRING ' SUKCS752 - '                                        33268001
332690            ' 9100-CHECK-PARA-TRACK-SEC '                         33269001
332700         DELIMITED BY SIZE                                        33270001
332701         INTO PV-CICS-MSG-AREA.                                   33270101
332702                                                                  33270201
332703     EXEC SQL                                                     33270301
332704          SELECT  FUNC_QTY                                        33270401
332705               ,  FUNC_txt                                        33270501
332706            INTO :PV-PARM-seconds                                 33270601
332707               , :PS-BLD-INTERNAL-TABLE-SW                        33270701
332708            FROM  TKRPRPM                                         33270801
332709           WHERE  LOC_ID            = :DK-OPER-UNT-ID             33270901
332710             AND  INTFC_SYS_CDE     = 'KHL'                       33271001
332711             AND  SYS_PRC_FUNC_CDE  = 'PATIM5'                    33271101
332712             AND  FUNC_PRC_STAT_CDE = 'AC'                        33271201
332713             AND  fUNC_BEG_TMST    <=  current timestamp          33271301
332714             AND  fUNC_END_TMST    >=  current timestamp          33271401
332715            WITH UR                                               33271501
332716     END-EXEC.                                                    33271601
332717                                                                  33271701
332718     EVALUATE TRUE                                                33271801
332719         WHEN SQLCODE = ZERO                                      33271901
332720              CONTINUE                                            33272001
332721                                                                  33272101
332722         WHEN SQLCODE = +100                                      33272201
332723              MOVE 999999999  TO  PV-PARM-SECONDS                 33272301
332724              SET  PS-BLD-INTERNAL-TABLE-NO   TO TRUE             33272401
332725                                                                  33272501
332726         WHEN SQLWARN0 NOT = SPACES                               33272601
332727         WHEN SQLCODE NOT EQUAL ZERO                              33272701
332728              MOVE '9100'  TO  PV-CSSL-PARA                       33272801
332729              PERFORM 9110-WRITE-SURD021-TO-CSSL                  33272901
332730                                                                  33273001
332731              SET PS-BLD-INTERNAL-TABLE-NO   TO  TRUE             33273101
332732              MOVE  SQLCODE           TO pv-disp-sqlcode          33273201
332733                                                                  33273301
332734             MOVE '9100-CHECK-PARA-TRACK-SEC'                     33273401
332735                             TO DP013-PARAGRAPH                   33273501
332736             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        33273601
332737             STRING ' SUKCS752 9100'                              33273701
332738                    ' OPER:'         PV-DISPLAY-OPER-UNT-ID       33273801
332739                    ' sql:'          PV-DISP-sqlcode              33273901
332740                                     DELIMITED BY SIZE            33274001
332741                                INTO DP013-MESSAGE-TEXT(1)        33274101
332742             MOVE SQLCA      TO DP013-SQLCA                       33274201
332743             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           33274301
332744                                                                  33274401
332745                                                                  33274501
332746             SET DP013-DB2-ABEND                                  33274601
332747                             TO TRUE                              33274701
332748             SET DP013-NO-ROLLBACK                                33274801
332749                             TO TRUE                              33274901
332750             PERFORM 9999-WRITE-CICS-LOG-MSG                      33275001
332760             SET PS-DUMP-TO-LOG       TO TRUE                     33276001
332770             SET SU021-DB2-ERROR TO TRUE                          33277001
332780     END-EVALUATE.                                                33278001
332790                                                                  33279001
332791                                                                  33279101
332792*---------------------------------------------------------------* 33279201
332793* WRITE COMMAREA TO CSSL                                        * 33279301
332794* DMH - 01/29/15                                                * 33279401
332795*---------------------------------------------------------------* 33279501
332796 9110-WRITE-SURD021-TO-CSSL.                                      33279601
332797                                                                  33279701
332798     IF  PS-BLD-INTERNAL-TABLE-YES                                33279801
332799         MOVE  '9110'  TO  PV-CSSL-PARA                           33279901
332800         PERFORM 9120-INTERNAL-TABLE                              33280001
332801     END-IF.                                                      33280101
332802                                                                  33280201
332803     INITIALIZE PV-CICS-MSG-AREA-3                                33280301
332804     MOVE SU021-PO-NUMBER          TO PV-DISP-PO                  33280401
332805     MOVE SU021-LINE-NBR           TO PV-DISP-LINE                33280501
332806     MOVE SU021-DRIVER-LINE-NBR    TO PV-DISP-DRVR-LINE           33280601
332807     MOVE SU021-PRE-PACK-ID        TO PV-DISP-PREPK               33280701
332808     MOVE SU021-OPER-UNT-ID        TO PV-DISP-OPER                33280801
332809     MOVE SU021-REC-SEQ-NBR        TO PV-DISP-RCVR                33280901
332810     MOVE SU021-INBOUND-TRIP-ID    TO PV-DISP-TRIP                33281001
332811     MOVE SU021-SHIPT-UNT-ID       TO PV-DISP-SSCC                33281101
332812     MOVE SU021-AUDIT-NUMBER       TO PV-DISP-AUDIT               33281201
332813     MOVE SU021-RFID-AUDIT-NUMBER  TO PV-DISP-RFID-AUDIT          33281301
332814     MOVE SQLCODE                  TO PV-DISP-SQLCODE             33281401
332815                                                                  33281501
332816     STRING  ' SUKCS752 '   PV-CSSL-PARA                          33281601
332817             ' TYPE:'       SU021-AUDIT-REQUEST-TYPE              33281701
332818             ' PO:'         PV-DISP-PO                            33281801
332819             ' LINE:'       PV-DISP-LINE                          33281901
332820             ' DR LINE:'    PV-DISP-DRVR-LINE                     33282001
332821             ' PREPK:'      PV-DISP-PREPK                         33282101
332822             ' OPER:'       PV-DISP-OPER                          33282201
332823             ' RCVR:'       PV-DISP-RCVR                          33282301
332824             ' SQL:'        pv-disp-sqlcode                       33282401
332825                            DELIMITED BY SIZE                     33282501
332826                       INTO PV-CICS-MSG-AREA                      33282601
332827                                                                  33282701
332828     PERFORM 9997-WRITE-TO-CSSL                                   33282801
332829                                                                  33282901
332830     INITIALIZE PV-CICS-MSG-AREA                                  33283001
332831     STRING  ' SUKCS752 '                                         33283101
332832             ' TRIP:'      PV-DISP-TRIP                           33283201
332833             ' SSCC:'      PV-DISP-SSCC                           33283301
332834             ' USR:'       SU021-USER-ID                          33283401
332835             ' DEF AUD:'   SU021-DEFERRED-AUDIT-IND               33283501
332836             ' AUD REQ:'   SU021-AUDIT-REQUIRED-SW                33283601
332837             ' AUDIT:'     PV-DISP-AUDIT                          33283701
332838                           DELIMITED BY SIZE                      33283801
332839                      INTO PV-CICS-MSG-AREA                       33283901
332840                                                                  33284001
332841     PERFORM 9997-WRITE-TO-CSSL                                   33284101
332842                                                                  33284201
332843     INITIALIZE PV-CICS-MSG-AREA                                  33284301
332844     STRING  ' SUKCS752 '                                         33284401
332845             ' VALID:'      SU021-AUDIT-VALIDATION-SW             33284501
332846             ' PNA:'        SU021-PRINT-APPLY-SW                  33284601
332847             ' RFID:'       SU021-RFID-AUDIT-REQUIRED-SW          33284701
332848             ' RFID AUD:'   PV-DISP-RFID-AUDIT                    33284801
332849             ' RFID VALID:' SU021-RFID-AUDIT-VALIDATION-SW        33284901
332850                           DELIMITED BY SIZE                      33285001
332851                      INTO PV-CICS-MSG-AREA                       33285101
332852                                                                  33285201
332853     PERFORM 9997-WRITE-TO-CSSL.                                  33285301
332854                                                                  33285401
332855                                                                  33285501
332856*---------------------------------------------------------------* 33285601
332857* BUILD INTERNAL TABLE WITN PARAGRAPH TRACKING                  * 33285701
332858* DMH - 01/29/15                                                * 33285801
332859*---------------------------------------------------------------* 33285901
332860 9120-INTERNAL-TABLE.                                             33286001
332861                                                                  33286101
332862     PERFORM 9130-GET-CURRENT-TMST.                               33286201
332863     ADD  +1  TO  PT-CURR-ENTRIES.                                33286301
332864     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         33286401
332865                                                                  33286501
332866     MOVE 'SUKCS752'           TO PT-PROGRAM(PT-TRACK-IDX).       33286601
332867     MOVE PT-CURR-ENTRIES      TO PT-INDEX-NBR(PT-TRACK-IDX).     33286701
332868     MOVE PV-CSSL-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     33286801
332869     MOVE PV-CURRENT-PARA-TMST TO PT-TIMESTAMP(PT-TRACK-IDX).     33286901
332870     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      33287001
332871                                                                  33287101
332872     MOVE PV-DURATION-NANO-SEC    TO PV-WORK-NANO-SEC.            33287201
332873     MOVE PV-WORK-NANO-MIN-1-2    TO PV-DISP-NANO-MIN-1-2.        33287301
332874     MOVE '-'                     TO PV-DISP-NANO-DASH-1.         33287401
332875     MOVE PV-WORK-NANO-SEC-3-4    TO PV-DISP-NANO-SEC-3-4.        33287501
332876     MOVE '-'                     TO PV-DISP-NANO-DASH-2.         33287601
332877     MOVE PV-WORK-NANO-MICRO-5-10 TO PV-DISP-NANO-MICRO-5-10.     33287701
332878     MOVE PV-DISP-NANO-SEC     TO PT-NANO-SEC(PT-TRACK-IDX).      33287801
332879                                                                  33287901
332880     MOVE SU021-OPER-UNT-ID     tO PT-DC(PT-TRACK-IDX).           33288001
332881     MOVE SU021-SHIPT-UNT-ID    tO PT-sscc(PT-TRACK-IDX).         33288101
332882     MOVE PV-INIT-TIME-KEY      TO PT-START-HHMMSS(PT-TRACK-IDX). 33288201
332883                                                                  33288301
332884                                                                  33288401
332885                                                                  33288501
332886*---------------------------------------------------------------* 33288601
332887*                                                               * 33288701
332888* DMH - 01/29/15                                                * 33288801
332889*---------------------------------------------------------------* 33288901
332890 9125-GET-START-TMST.                                             33289001
332900                                                                  33290001
332910         EXEC SQL                                                 33291001
332920             SET :PV-INIT-TIMESTAMP  =  CURRENT TIMESTAMP         33292001
332921         END-EXEC.                                                33292101
332922                                                                  33292201
332923     MOVE  PV-INIT-HH    TO  PV-INIT-KEY-HH.                      33292301
332924     MOVE  PV-INIT-MM    TO  PV-INIT-KEY-MM.                      33292401
332925     MOVE  PV-INIT-SS    TO  PV-INIT-KEY-SS.                      33292501
332926                                                                  33292601
332927                                                                  33292701
332928*---------------------------------------------------------------* 33292801
332929*                                                               * 33292901
332930* DMH - 01/29/15                                                * 33293001
332931*---------------------------------------------------------------* 33293101
332932 9130-GET-CURRENT-TMST.                                           33293201
332933     EXEC SQL                                                     33293301
332934          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           33293401
332935     END-EXEC.                                                    33293501
332936                                                                  33293601
332937     EXEC SQL                                                     33293701
332938          SELECT                                                  33293801
332939                 TIMESTAMPDIFF( 2 ,CHAR(:PV-CURRENT-PARA-TMST     33293901
332940                   - TIMESTAMP(:PV-INIT-TIMESTAMP)))              33294001
332941               , TIMESTAMPDIFF( 1 ,CHAR(:PV-CURRENT-PARA-TMST     33294101
332942                   - TIMESTAMP(:PV-INIT-TIMESTAMP)))              33294201
332943            INTO :PV-DURATION-SEC                                 33294301
332944               , :PV-DURATION-nano-sec                            33294401
332945            FROM  SYSIBM.SYSDUMMY1                                33294501
332946     END-EXEC.                                                    33294601
332947                                                                  33294701
332948                                                                  33294801
332949*---------------------------------------------------------------* 33294901
332950*                                                               * 33295001
332951* DMH - 01/29/15                                                * 33295101
332952*---------------------------------------------------------------* 33295201
332953 9140-DUMP-TABLE-TO-CSSL.                                         33295301
332954                                                                  33295401
332955     INITIALIZE PV-CICS-MSG-AREA                                  33295501
332956                                                                  33295601
332957     MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA           33295701
332958                                                                  33295801
332959     EXEC CICS                                                    33295901
332960         WRITEQ TD                                                33296001
332961         QUEUE(PC-LOG-QUEUE-2)                                    33296101
332962         FROM(PV-CICS-MSG-AREA)                                   33296201
332963         RESP(PV-CICS-RESPONSE)                                   33296301
332964     END-EXEC.                                                    33296401
332965                                                                  33296501
332966                                                                  33296601
332967                                                                  33296701
332968*---------------------------------------------------------------* 33296801
332969*                                                               * 33296901
332970* DMH - 01/29/15                                                * 33297001
332971*---------------------------------------------------------------* 33297101
332972 9150-CLEAR-TABLE.                                                33297201
332973                                                                  33297301
332974     MOVE  SPACES  TO  PT-PROGRAM(PT-TRACK-IDX).                  33297401
332975     MOVE  ZEROES  TO  PT-INDEX-NBR(PT-TRACK-IDX).                33297501
332976     MOVE  SPACES  TO  PT-PARAGRAPH(PT-TRACK-IDX).                33297601
332977     MOVE  SPACES  TO  PT-TIMESTAMP(PT-TRACK-IDX).                33297701
332978     MOVE  ZEROES  TO  PT-DURATION(PT-TRACK-IDX).                 33297801
332979                                                                  33297901
332980                                                                  33298001
332981 9990-WRITE-CICS.                                                 33298101
332982                                                                  33298201
332983* IF YOU'RE AT THE LAST OCCURRENCE OF THE TABLE,                  33298301
332984* THE NEXT MESSAGE WILL GO INTO THE FIRST OCCURRENCE.  KEEP       33298401
332985* INCREMENTING THE SEQUENCE SO THAT IF THE TABLE IS DUMPED TO THE 33298501
332986* LOG YOU WILL BE ABLE TO SEE THE LAST 200 LINES AND HOW THEY     33298601
332987* WRAPPED AROUND.                                                 33298701
332988                                                                  33298801
332989     EVALUATE TRUE                                                33298901
332990     WHEN PT-MSG-IDX < PC-MSG-TABLE-SIZE                          33299001
333000         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 33300001
333100         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         33310001
333200         SET PT-MSG-IDX UP BY 1                                   33320001
333300     WHEN PT-MSG-IDX = PC-MSG-TABLE-SIZE                          33330001
333400         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 33340001
333500         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         33350001
333600         SET PT-MSG-IDX               TO 1                        33360001
333700     END-EVALUATE                                                 33370001
333800                                                                  33380001
333900     COMPUTE PV-NEXT-SEQUENCE = PV-PREV-SEQUENCE + 1              33390001
334000     MOVE PV-NEXT-SEQUENCE            TO PT-MSG-SEQ (PT-MSG-IDX)  33400001
334100                                                                  33410001
334200                                                                  33420001
334300*  IF THE DC HAS TRACE PROCESSING TURNED ON, ALL MESSAGES WILL    33430001
334400*  BE DISPLAYED AS THEY OCCUR.  DUMPING THE MESSAGE TABLE WILL    33440001
334500*  BE UNNECESSARY BECAUSE OF THE REAL-TIME DISPLAYS.              33450001
334600*                                                                 33460001
334700     IF PS-SHOW-DEBUG-INFO                                        33470001
334800         PERFORM 9991-WRITEQ                                      33480001
334900     END-IF                                                       33490001
335000     MOVE SPACES                      TO PV-CICS-MSG-AREA.        33500001
335100                                                                  33510001
335200                                                                  33520001
335300 9991-WRITEQ.                                                     33530001
335400     EXEC CICS                                                    33540001
335500         WRITEQ TD                                                33550001
335600         QUEUE(PC-LOG-QUEUE)                                      33560001
335700         FROM(PV-CICS-MSG-AREA)                                   33570001
335800         RESP(PV-CICS-RESPONSE)                                   33580001
335900     END-EXEC.                                                    33590001
336000                                                                  33600001
336100                                                                  33610001
336200 9995-WRITE-CICS-CSSL.                                            33620001
336300                                                                  33630001
336400     EXEC CICS                                                    33640001
336500         WRITEQ TD                                                33650001
336600         QUEUE('CSSL')                                            33660001
336700         FROM(PV-CICS-MSG-AREA-D)                                 33670001
336710         RESP(PV-CICS-RESPONSE)                                   33671001
336720     END-EXEC.                                                    33672001
336730                                                                  33673001
336740     MOVE SPACES TO PV-CICS-MSG-AREA-D.                           33674001
336750                                                                  33675001
336760                                                                  33676001
336770*-----------------------------------------------------------------33677001
336780 9997-WRITE-TO-CSSL.                                              33678001
336790*-----------------------------------------------------------------33679001
336791     MOVE LENGTH OF PV-CICS-MSG-AREA    TO PV-COMMAREA-LENGTH.    33679101
336792                                                                  33679201
336793     EXEC CICS                                                    33679301
336794          WRITEQ TD                                               33679401
336795          QUEUE(PC-LOG-QUEUE-2)                                   33679501
336796          FROM(PV-CICS-MSG-AREA)                                  33679601
336797          RESP(PV-CICS-RESPONSE)                                  33679701
336798      END-EXEC.                                                   33679801
336799                                                                  33679901
336800                                                                  33680001
336810*-----------------------------------------------------------------33681001
336820*  RETURN TO CALLING PROGRAM                                      33682001
336830*-----------------------------------------------------------------33683001
336840 9998-RETURN.                                                     33684001
336850                                                                  33685001
336860     STRING ' SUKCS752 - '                                        33686001
336870            ' 9998-RETURN'                                        33687001
336880         DELIMITED BY SIZE                                        33688001
336890         INTO PV-CICS-MSG-AREA.                                   33689001
336900     PERFORM 9990-WRITE-CICS.                                     33690001
337000                                                                  33700001
337100* 02/01/15 begin                                                  33710001
337200     IF  PS-BLD-INTERNAL-TABLE-YES  and                           33720001
337300         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  33730001
337400                                                                  33740001
337500         move '9998'  to  PV-CSSL-PARA                            33750001
337600         move spaces to  pv-ciCS-MSG-AREA                         33760001
337610         PERFORM 9997-WRITE-TO-CSSL                               33761001
337611                                                                  33761101
337612         perform 9110-WRITE-SURD021-TO-CSSL                       33761201
337613                                                                  33761301
337614         move spaces to  pv-ciCS-MSG-AREA                         33761401
337615         PERFORM 9997-WRITE-TO-CSSL                               33761501
337616                                                                  33761601
337617         STRING ' SUKCS752-DID NOT MEET SLA'                      33761701
337618                ' OPER:'       PV-DISP-OPER                       33761801
337619                ' PO:'         PV-DISP-PO                         33761901
337620                '-'            PV-DISP-RCVR                       33762001
337621                ' LINE:'       PV-DISP-LINE                       33762101
337622                ' DR LINE:'    PV-DISP-DRVR-LINE                  33762201
337623                ' PREPK:'      PV-DISP-PREPK                      33762301
337624                ' SSCC:'      PV-DISP-SSCC                        33762401
337625                              DELIMITED BY SIZE                   33762501
337626                         INTO PV-CICS-MSG-AREA                    33762601
337627         PERFORM 9997-WRITE-TO-CSSL                               33762701
337628                                                                  33762801
337629         move spaces to  pv-ciCS-MSG-AREA                         33762901
337630         move PV-DURATION-SEC  to PV-DISP-DURATION                33763001
337640                                                                  33764001
337641         STRING ' SUKCS752 '                                      33764101
337642                ' INIT:'       PV-INIT-TIMESTAMP                  33764201
337643                ' CURR:'       PV-CURRENT-PARA-TMST               33764301
337644                ' DURA:'       PV-DISP-DURATION                   33764401
337645                ' NANO:'       PV-DISP-NANO-SEC                   33764501
337646                              DELIMITED BY SIZE                   33764601
337647                         INTO PV-CICS-MSG-AREA                    33764701
337648         PERFORM 9997-WRITE-TO-CSSL                               33764801
337649                                                                  33764901
337650         move spaces to  pv-ciCS-MSG-AREA                         33765001
337651         PERFORM 9997-WRITE-TO-CSSL                               33765101
337652                                                                  33765201
337653         PERFORM 9140-DUMP-TABLE-TO-CSSL                          33765301
337654         VARYING PT-TRACK-IDX                                     33765401
337655            FROM 1 BY 1                                           33765501
337656           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 33765601
337657              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             33765701
337658                                                                  33765801
337659         PERFORM 9150-CLEAR-TABLE                                 33765901
337660         VARYING PT-TRACK-IDX                                     33766001
337661            FROM 1 BY 1                                           33766101
337662            UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                33766201
337663               OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES            33766301
337664                                                                  33766401
337665         MOVE ZEROES TO PT-CURR-ENTRIES                           33766501
337666         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   33766601
337667                                                                  33766701
337668         INITIALIZE PV-CICS-MSG-AREA                              33766801
337669         MOVE PV-DURATION-SEC TO  PV-DISP-DURATION                33766901
337670         STRING ' SUKCS752-DID NOT MEET SLA'                      33767001
337671                ' OPER:'       PV-DISP-OPER                       33767101
337672                ' PO:'         PV-DISP-PO                         33767201
337673                '-'            PV-DISP-RCVR                       33767301
337674                ' LINE:'       PV-DISP-LINE                       33767401
337675                ' DR LINE:'    PV-DISP-DRVR-LINE                  33767501
337676                ' PREPK:'      PV-DISP-PREPK                      33767601
337677                ' SSCC:'      PV-DISP-SSCC                        33767701
337678                ' DONE'                                           33767801
337679                              DELIMITED BY SIZE                   33767901
337680                         INTO PV-CICS-MSG-AREA                    33768001
337681         PERFORM 9997-WRITE-TO-CSSL                               33768101
337682                                                                  33768201
337683         move spaces to  pv-ciCS-MSG-AREA                         33768301
337684         PERFORM 9997-WRITE-TO-CSSL                               33768401
337685     end-if.                                                      33768501
337686                                                                  33768601
337687* 02/01/15 end                                                    33768701
337688                                                                  33768801
337689                                                                  33768901
337690     MOVE SU021-CARTON-AUDIT-RECORD     TO DFHCOMMAREA.           33769001
337700                                                                  33770001
337800     EXEC CICS                                                    33780001
337900          RETURN                                                  33790001
338000     END-EXEC.                                                    33800001
338100                                                                  33810001
338200                                                                  33820001
338300 9999-WRITE-TO-CSSL.                                              33830001
338400     STRING ' SUKCS752 - '                                        33840001
338500            ' 9999-WRITE-TO-CSSL'                                 33850001
338600         DELIMITED BY SIZE                                        33860001
338700         INTO PV-CICS-MSG-AREA.                                   33870001
338800     PERFORM 9990-WRITE-CICS.                                     33880001
338900     MOVE LENGTH OF PV-CICS-MSG-AREA2                             33890001
339000       TO PV-COMMAREA-LENGTH                                      33900001
339100     EXEC CICS                                                    33910001
339200          WRITEQ TD                                               33920001
339300           QUEUE   ('CSSL')                                       33930001
339400            FROM   (PV-CICS-MSG-AREA2)                            33940001
339500          LENGTH   (PV-COMMAREA-LENGTH)                           33950001
339600            RESP   (PV-CICS-RESP)                                 33960001
339700     END-EXEC.                                                    33970001
339800                                                                  33980001
339900*                                                                 33990001
340000 9999-WRITE-CICS-LOG-MSG.                                         34000001
340010     STRING ' SUKCS752 - '                                        34001001
340020            ' 9999-WRITE-CICS-LOG-MSG'                            34002001
340030         DELIMITED BY SIZE                                        34003001
340040         INTO PV-CICS-MSG-AREA.                                   34004001
340050     PERFORM 9990-WRITE-CICS.                                     34005001
340060     MOVE 'SUKCS752'                 TO DP013-PROGRAM.            34006001
340070     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           34007001
340080     INITIALIZE DP013-SRC-TASK-NUMBER                             34008001
340090                DP013-STACK.                                      34009001
340100     SET DP013-LINK-RETURN           TO TRUE.                     34010001
340200                                                                  34020001
340300     EXEC CICS                                                    34030001
340400         LINK                                                     34040001
340500             PROGRAM   (DP013-NAME)                               34050001
340600             COMMAREA  (DP013-PARAMETERS)                         34060001
340700             LENGTH    (DP013-LENGTH)                             34070001
340800     END-EXEC.                                                    34080001
340900                                                                  34090001
341000                                                                  34100001
341100 9999-FINAL-DUMP.                                                 34110001
341200*  IF AN ERROR HAS OCCURRED, DUMP THE MESSAGE TABLE WHICH WILL    34120001
341300*  CONTAIN THE LAST 200 TRACE DISPLAYS.  IF THE TABLE EVER        34130001
341400*  OVERFLOW, YOU WILL SEE THE SEQUENCE NUMBERS WRAP.  UNUSED      34140001
341500*  OCCRENCES ARE NOT DISPLAYED.                                   34150001
341600*                                                                 34160001
341700                                                                  34170001
341800     STRING ' SUKCS752 - '                                        34180001
341900            ' 9999-FINAL-DUMP'                                    34190001
342000         DELIMITED BY SIZE                                        34200001
342100         INTO PV-CICS-MSG-AREA                                    34210001
342200     PERFORM 9990-WRITE-CICS.                                     34220001
342300                                                                  34230001
342400     EXEC CICS ENQ                                                34240001
342500         RESOURCE(PC-LOG-QUEUE)                                   34250001
342600     END-EXEC                                                     34260001
342700                                                                  34270001
342800     MOVE PV-EIBTASKN             TO PV-DISPLAY-TASK.             34280001
342900     PERFORM VARYING PT-MSG-IDX FROM 1 BY 1 UNTIL                 34290001
343000                     PT-MSG-IDX > PC-MSG-TABLE-SIZE               34300001
343100         IF PT-MSG-SEQ (PT-MSG-IDX) > ZERO                        34310001
343200             MOVE PT-MSG-SEQ (PT-MSG-IDX)                         34320001
343300                                  TO PV-DISPLAY-MSG-NBR           34330001
343400             STRING ' SUKCS752 - '                                34340001
343500                    ' ' PV-DISPLAY-TASK ' '                       34350001
343600                  PV-DISPLAY-MSG-NBR ' '                          34360001
343700                  PT-MSG-LINE (PT-MSG-IDX)                        34370001
343800                  DELIMITED BY SIZE                               34380001
343900                                INTO PV-CICS-MSG-AREA             34390001
344000             PERFORM 9991-WRITEQ                                  34400001
344100         END-IF                                                   34410001
344200     END-PERFORM.                                                 34420001
344300                                                                  34430001
344400     SET PT-MSG-IDX               TO 1.                           34440001
344500     SET PS-DONT-DUMP-TO-LOG      TO TRUE.                        34450001
344600                                                                  34460001
344700     EXEC CICS DEQ                                                34470001
344800         RESOURCE(PC-LOG-QUEUE)                                   34480001
344900     END-EXEC.                                                    34490001
345000                                                                  34500001
