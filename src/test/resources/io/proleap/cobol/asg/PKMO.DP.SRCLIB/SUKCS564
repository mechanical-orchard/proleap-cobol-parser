000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    SUKCS564.                                         00040001
000500 AUTHOR.        DEANNA BRANTNER / DENNIS STEFFEN.                 00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  SUMMER 2002.                                      00070001
000800 DATE-COMPILED.                                                   00080001
000900                                                                  00090001
001000*---------------------------------------------------------------* 00100001
001100*    S564 - SHIPPING DOOR STATUS  - DOOR CARTON DIVERT LIST     * 00110001
001200*---------------------------------------------------------------* 00120001
001210* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00121050
001220* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00122051
001230* MAKING THE CALL DYNAMIC VS STATIC.                              00123051
001130*                                                                 00123152
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00123252
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00123352
001240*---------------------------------------------------------------* 00124051
001300                                                                  00130051
001400 ENVIRONMENT DIVISION.                                            00140001
001500                                                                  00150001
001600 DATA DIVISION.                                                   00160001
001700                                                                  00170001
001800 WORKING-STORAGE SECTION.                                         00180001
001900                                                                  00190001
002000 01  DK-DB2-KEYS.                                                 00200001
002100     05  DK-START-TMST                  PIC  X(26)  VALUE SPACES. 00210001
002200     05  DK-END-TMST                    PIC  X(26)  VALUE SPACES. 00220001
002300     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00230001
002400                                                   COMP.          00240001
002500     05  DK-DOOR-ID                     PIC  X(04) VALUE SPACES.  00250001
002600     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00260001
002700                                                   COMP.          00270001
002800     05  DK-OUTBOUND-TRIP-ID            PIC S9(09) COMP.          00280001
002900     05  DK-SML-NBR                     PIC S9(18)V COMP-3.       00290001
002910     05  DK-DIVERT-DATE                 PIC X(10).                00291044
002920     05  DK-DIVERT-TIME                 PIC X(08).                00292044
003000                                                                  00300001
003100 01  PC-PROGRAM-CONSTANTS.                                        00310001
003200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU564A  '.  00320001
003300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM564'.   00330001
003400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS564'.  00340001
003500     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00350014
003600     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00360001
003700     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00370001
003800     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00380001
003900     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00390001
004000     05  PC-SHOW-NEXT-CARTON       PIC  X(01)  VALUE '3'.         00400001
004100     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +11          00410001
004200                                               COMP SYNC.         00420001
004300     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00430001
004400                                               COMP SYNC.         00440001
004500     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00450001
004600                                               COMP-3.            00460001
004700     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00470001
004800                                               COMP SYNC.         00480001
004900     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00490001
005000                                               COMP-3.            00500001
005100     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00510001
005200     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00520001
005300     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00530001
005400     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00540001
005500     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00550001
005600     05  PC-LOW-TMST               PIC X(26)   VALUE              00560001
005700                                   '0001-01-01-01.01.01.000000'.  00570001
005800                                                                  00580051
005900*----------------------------------------------------------------*00590001
006000*  SYSTEM MESSAGES                                               *00600001
006100*----------------------------------------------------------------*00610001
006200*   00005 = INVALID VALUE                                        *00620001
006300*   00008 = MUST BE NUMERIC                                      *00630001
006400*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00640001
006500*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00650001
006600*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00660001
006700*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00670001
006800*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00680001
006900*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00690001
007000*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00700001
007100*   00069 - TOP OF LIST                                          *00710001
007200*   00070 - BOTTOM OF LIST                                       *00720001
007300*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00730001
007400*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00740001
007500*   00279 - MORE ITEMS TO DISPLAY                                *00750001
007600*   00743 - TRIP DOES NOT EXIST                                  *00760001
007700*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *00770001
007800*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00780001
007900*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00790001
008000*   02790 = YOU DO NOT HAVE AUTHORITY TO PERFORM THIS FUNCTION   *00800001
008100*   02791 = TRLR ALREADY HAS BEGIN CUTOFF - END CUTOFF IS NEEDED.*00810001
008200*   02792 = ENDING CUTOFF ALREADY EXISTS FOR TRLR-BEGIN CUTOFF NE*00820001
008300*   02793 = CARTON IS ALREADY LOADED ONTO A TRAILER.             *00830001
008400*   02794 = INVALID BEGIN DIVERT. PREVIOUS DIVERTED CARTONS NOT A*00840001
008500*   02795 = BEGIN CUTOFF ASSIGNMENT SUCCESSFUL.                  *00850001
008600*   02796 = END CUTOFF ASSIGNMENT SUCCESSFUL.                    *00860001
008700*   02799 = END CARTON DIVERT TIME MUST BE GREATER THAN BEGIN CAR*00870001
008800*   03486 = SHIP TRLR AND CARTON MUST HAVE SAME STORE DEST       *00880031
008810*   03663 = BEGIN CUTOFF IS BEFORE LAST END CUTOFF               *00881032
008820*   03729 = DISPLAY THE NEXT CUTOFF IN ERROR MESSAGE             *00882040
008900*   99901 = INVALID COMMAND WAS ENTERED                          *00890001
009000*----------------------------------------------------------------*00900001
009100     05  PC-TSYMSG-NUMBERS.                                       00910001
009200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00920001
009300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00930001
009400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00940001
009500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00950001
009600         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00960001
009700         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00970001
009800         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00980001
009900         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00990001
010000         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01000001
010100         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01010001
010200         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01020001
010300         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01030001
010400         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01040001
010500         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01050001
010600         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01060001
010700         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01070001
010800         10  PC-TSYMSG-02790            PIC  9(05)  VALUE 02790.  01080001
010900         10  PC-TSYMSG-02791            PIC  9(05)  VALUE 02791.  01090001
011000         10  PC-TSYMSG-02792            PIC  9(05)  VALUE 02792.  01100001
011100         10  PC-TSYMSG-02793            PIC  9(05)  VALUE 02793.  01110001
011200         10  PC-TSYMSG-02794            PIC  9(05)  VALUE 02794.  01120001
011300         10  PC-TSYMSG-02795            PIC  9(05)  VALUE 02795.  01130001
011400         10  PC-TSYMSG-02796            PIC  9(05)  VALUE 02796.  01140001
011500         10  PC-TSYMSG-02799            PIC  9(05)  VALUE 02799.  01150001
011600         10  PC-TSYMSG-03486            PIC  9(05)  VALUE 03486.  01160019
011610         10  PC-TSYMSG-03663            PIC  9(05)  VALUE 03663.  01161036
011620         10  PC-TSYMSG-03729            PIC  9(05)  VALUE 03729.  01162040
011700*                                                                 01170001
011800 01  PS-PROGRAM-SWITCHES.                                         01180001
011900     05  PS-REBUILD-AFTER-UPDATE-SW     PIC  X(01)  VALUE 'N'.    01190001
012000         88  PS-REBUILD-AFTER-UPDATE                VALUE 'Y'.    01200001
012100         88  PS-REBUILD-AFTER-UPDATE-NO             VALUE 'N'.    01210001
012200     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01220001
012300         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01230001
012400         88  PS-BLOCK-ERROR                         VALUE 'N'.    01240001
012500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    01250001
012600         88  PS-NO-ERROR                            VALUE 'N'.    01260001
012700         88  PS-ERROR                               VALUE 'Y'.    01270001
012800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01280001
012900         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01290001
013000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01300001
013100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01310001
013200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01320001
013300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01330001
013400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01340001
013500         88  PS-DONE                                VALUE 'Y'.    01350001
013600         88  PS-NOT-DONE                            VALUE 'N'.    01360001
013700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01370001
013800         88  PS-LIST-END                            VALUE 'Y'.    01380001
013900         88  PS-NO-LIST-END                         VALUE 'N'.    01390001
014000     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01400001
014100         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01410001
014200         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01420001
014300     05  PS-EXISTING-DOOR-SW            PIC X(03)   VALUE 'OLD'.  01430001
014400         88  PS-BRAND-NEW-DOOR                      VALUE 'NEW'.  01440001
014500         88  PS-EXISTING-DOOR                       VALUE 'OLD'.  01450001
014600*                                                                 01460001
014700 01  PV-PROGRAM-VARIABLES.                                        01470001
014800     05  PV-REC-SEQ                      PIC 9(09)  VALUE ZEROES. 01480001
014900     05  PV-REC-SEQ-R REDEFINES PV-REC-SEQ.                       01490001
015000         10  FILLER                      PIC X(06).               01500001
015100         10  PV-REC-SEQ-7-9              PIC X(03).               01510001
015200     05  PV-SELECTED                     PIC S9(09)  VALUE ZEROES 01520001
015300                                                     COMP-3.      01530001
015400     05  PV-RACF-ERROR-CODE              PIC  9(04) VALUE ZEROES. 01540001
015500     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01550001
015600                                                     COMP SYNC.   01560001
015700     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01570001
015800     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01580001
015900     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01590001
016000                                        COMP SYNC.                01600001
016100     05  PV-SUB                         PIC S9(04)  VALUE +0      01610001
016200                                                    COMP SYNC.    01620001
016300     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01630001
016400                                                    COMP SYNC.    01640001
016500     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01650001
016600                                                    COMP-3.       01660001
016700     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01670001
016800                                                    COMP-3.       01680001
016900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01690001
017000                                                    COMP-3.       01700001
017100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01710001
017200                                                    COMP-3.       01720001
017300     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01730001
017400                                                    COMP-3.       01740001
017500     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01750001
017600                                                    COMP-3.       01760001
017700     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01770001
017800                                                    COMP-3.       01780001
017900     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01790001
018000                                                    COMP SYNC.    01800001
018100     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01810001
018200                                                    COMP SYNC.    01820001
018300     05  PV-ITEM                        PIC S9(04)  VALUE +0      01830001
018400                                                    COMP SYNC.    01840001
018500     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01850001
018600                                                    COMP SYNC.    01860001
018700     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01870001
018800                                                    COMP SYNC.    01880001
018900     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01890001
019000                                                    COMP SYNC.    01900001
019100     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01910001
019200                                                    COMP SYNC.    01920001
019300     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01930001
019400                                                    COMP SYNC.    01940001
019500     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01950001
019600                                                    COMP SYNC.    01960001
019700     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01970001
019800                                                    COMP SYNC.    01980001
019900     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01990001
020000                                                    COMP SYNC.    02000001
020100     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02010001
020200                                                    COMP SYNC.    02020001
020300     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02030001
020400                                                    COMP SYNC.    02040001
020500     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02050001
020600                                                    COMP SYNC.    02060001
020700     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02070001
020800                                                    COMP SYNC.    02080001
020900     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02090001
021000                                                    COMP SYNC.    02100001
021100     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02110001
021200                                                    COMP.         02120001
021300     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02130001
021400                                                    COMP.         02140001
021500     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02150001
021600                                                    COMP.         02160001
021700     05  PV-SOFT-ABORT-MSG.                                       02170001
021800         10  FILLER            PIC X(12) VALUE ' SUKCS564 - '.    02180001
021900         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02190001
022000         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02200001
022100         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02210001
022200         10  PV-SOFT-PARAGRAPH PIC X(30).                         02220001
022300     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02230001
022400                                                     COMP SYNC.   02240001
022500     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02250001
022600     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02260001
022700     05  PV-CICS-MSG-HOLD.                                        02270001
022800         10  FILLER                      PIC  X(01)  VALUE SPACE. 02280001
022900         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02290001
023000     05  PV-CICS-MSG-HOLD2.                                       02300001
023100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02310001
023200         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02320001
023300     05  PV-TASK                         PIC 9999.                02330001
023400                                                                  02340001
023500     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02350001
023600     05  PV-TMST-R REDEFINES  PV-TMST.                            02360001
023700         10   PV-TMST-DATE.                                       02370001
023800             15   PV-TMST-MM            PIC X(02).                02380001
023900             15   PV-TMST-DD            PIC X(02).                02390001
024000             15   PV-TMST-CC            PIC X(04).                02400001
024100             15   FILLER                PIC X(01).                02410001
024200             15   FILLER                PIC X(01).                02420001
024300         10   FILLER                    PIC X(01).                02430001
024400         10   PV-TMST-TIME.                                       02440001
024500             15   PV-TMST-HRS           PIC X(02).                02450001
024600             15   FILLER                PIC X(01).                02460001
024700             15   PV-TMST-MIN           PIC X(02).                02470001
024800         10   FILLER                    PIC X(01).                02480001
024900         10   PV-TMST-SEC               PIC X(02).                02490001
025000         10   FILLER                    PIC X(07).                02500001
025100     05  PV-TMST-X REDEFINES  PV-TMST.                            02510001
025200         10   PV-TMST2-DATE.                                      02520001
025300             15   PV-TMST2-CC           PIC X(02).                02530001
025400             15   PV-TMST2-YY           PIC X(02).                02540001
025500             15   FILLER                PIC X(01).                02550001
025600             15   PV-TMST2-MM           PIC X(02).                02560001
025700             15   FILLER                PIC X(01).                02570001
025800             15   PV-TMST2-DD           PIC X(02).                02580001
025900         10   FILLER                    PIC X(01).                02590001
026000         10   PV-TMST2-TIME.                                      02600001
026100             15   PV-TMST2-HRS          PIC X(02).                02610001
026200             15   FILLER                PIC X(01).                02620001
026300             15   PV-TMST2-MIN          PIC X(02).                02630001
026400         10   FILLER                    PIC X(01).                02640001
026500         10   PV-TMST2-SEC              PIC X(02).                02650001
026600         10   FILLER                    PIC X(07).                02660001
026700     05  PV-FROM-TMST.                                            02670001
026800         10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              02680001
026900         10   FILLER        PIC X(01)  VALUE '-'.                 02690001
027000         10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              02700001
027100         10   FILLER        PIC X(01)  VALUE '-'.                 02710001
027200         10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              02720001
027300         10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  02730001
027400     05  PV-TO-TMST.                                              02740001
027500         10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              02750001
027600         10   FILLER        PIC X(01)  VALUE '-'.                 02760001
027700         10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              02770001
027800         10   FILLER        PIC X(01)  VALUE '-'.                 02780001
027900         10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              02790001
028000         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  02800001
028100     05  PV-DATE-TIME.                                            02810001
028200         10   PV-DT-CC      PIC X(02)  VALUE '20'.                02820001
028300         10   PV-DT-YY      PIC X(02)  VALUE ZEROES.              02830001
028400         10   FILLER        PIC X(01)  VALUE '-'.                 02840001
028500         10   PV-DT-MM      PIC X(02)  VALUE ZEROES.              02850001
028600         10   FILLER        PIC X(01)  VALUE '-'.                 02860001
028700         10   PV-DT-DD      PIC X(02)  VALUE ZEROES.              02870001
028800         10   FILLER        PIC X(01)  VALUE '-'.                 02880001
028900         10   PV-DT-HRS     PIC X(02)   VALUE SPACES.             02890001
029000         10   FILLER        PIC X(01)   VALUE '.'.                02900001
029100         10   PV-DT-MIN     PIC X(02)   VALUE SPACES.             02910001
029200         10   FILLER        PIC X(01)   VALUE '.'.                02920001
029300         10   PV-DT-SEC     PIC X(09)   VALUE '59.999999'.        02930001
029400     05  PV-DATE-DISPLAY.                                         02940001
029500         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 02950001
029600         10   PV-SLASH-1                PIC X(01)   VALUE '-'.    02960001
029700         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 02970001
029800         10   PV-SLASH-2                PIC X(01)   VALUE '-'.    02980001
029900         10   PV-DISPLAY-YY             PIC X(02)   VALUE SPACES. 02990001
030000     05  PV-TIME-DISPLAY.                                         03000001
030100         10   PV-DISPLAY-HRS           PIC X(02)   VALUE SPACES.  03010001
030200         10   FILLER                   PIC X(01)   VALUE '.'.     03020001
030300         10   PV-DISPLAY-MIN           PIC X(02)   VALUE SPACES.  03030001
030400     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 03040001
030500     05  PV-USA-DATE                     PIC  X(10) VALUE SPACES. 03050001
030600     05  PV-JIS-TIME                     PIC  X(08) VALUE SPACES. 03060023
030700     05  PV-JIS-TIME-R REDEFINES PV-JIS-TIME.                     03070023
030800         10  PV-JIS-HH-MM                PIC  X(05).              03080025
030900         10  FILLER                      PIC  X(03).              03090025
031000     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 03100001
031100     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 03110001
031200     05  PV-SEL-TERM-ID                  PIC  X(04).              03120001
031300     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03130001
031400     05  PV-SEL-SEQ                      PIC  9(01).              03140001
031500     05  PV-BEGIN-COUNT                  PIC S9(05) COMP-3.       03150001
031600     05  PV-DIVERT-COUNT                 PIC S9(05) COMP-3.       03160001
031700     05  PV-TRLR-COUNT                   PIC S9(09) COMP-3.       03170029
031800     05  PV-CUTOFF-COUNT                 PIC S9(03) COMP-3.       03180001
031900     05  PV-DISP-PO-RCVR.                                         03190001
032000         10  PV-DISP-PO                  PIC Z(7)9.               03200001
032100         10  FILLER                      PIC X(01) VALUE '-'.     03210001
032200         10  PV-DISP-RCVR                PIC X(3).                03220001
032300                                                                  03230017
032400     05  PV-DISP-TRN-NBR.                                         03240017
032500         10  PV-DISP-TRN                 PIC Z(09).               03250017
032600         10  FILLER                      PIC X(03).               03260017
032700                                                                  03270016
032710     05  PV-DISP-DVRT-CNT             PIC Z(09) VALUE ZEROES.     03271038
032711     05  PV-DISP-OPER                 PIC Z(04) VALUE ZEROES.     03271138
032712     05  PV-DISP-SML                  PIC 9(18) VALUE ZEROES.     03271238
032713     05  PV-DISP-SQLCODE              PIC -999  VALUE ZEROES.     03271338
032720                                                                  03272038
032800     05  PV-CARTON-MSG.                                           03280016
032900         10  FILLER                   PIC X(01) VALUE SPACE.      03290016
033000         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 03300016
033100         10  FILLER                   PIC X(01) VALUE '-'.        03310016
033200         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     03320016
033300         10  FILLER                   PIC X(05) VALUE ' REC='.    03330016
033400         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     03340016
033500         10  FILLER                   PIC X(10)                   03350016
033600                             VALUE ' CTN STAT='.                  03360016
033700         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     03370016
033800         10  FILLER                   PIC X(01) VALUE '/'.        03380016
033900         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     03390016
034000         10  FILLER                   PIC X(05) VALUE ' SER='.    03400016
034100         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     03410016
034200         10  FILLER                   PIC X(06) VALUE ' TRIP='.   03420016
034300         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     03430016
034400         10  FILLER                   PIC X(06) VALUE ' STAT='.   03440016
034500         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     03450016
034600         10  FILLER                   PIC X(06) VALUE ' USER='.   03460016
034700         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     03470016
034701                                                                  03470140
034720     05  PV-ERROR-INFO.                                           03472040
034730         10  PV-ERROR-SML          PIC  9(18)  VALUE ZEROES.      03473040
034740         10  PV-ERROR-FUNCTION     PIC  X(09)  VALUE SPACES.      03474042
034750         10  PV-ERROR-DATE         PIC  X(10)  VALUE SPACES.      03475040
034751         10  FILLER                PIC  X(01)  VALUE SPACES.      03475143
034752         10  PV-ERROR-AT           PIC  X(01)  VALUE SPACES.      03475242
034753         10  FILLER                PIC  X(01)  VALUE SPACES.      03475343
034754         10  PV-ERROR-TIME         PIC  X(10)  VALUE SPACES.      03475442
034760     05  PV-DIVERT-DATE            PIC  X(10)  VALUE SPACES.      03476040
034761     05  PV-DIVERT-TIME            PIC  X(05)  VALUE SPACES.      03476142
034800                                                                  03480016
034900******************************************************************03490001
035000**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03500001
035100**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03510001
035200**  APPLICATION-SPECIFIC COMMAREA.                              **03520001
035300******************************************************************03530001
035400 01  LQW-LIST-QUEUE-WORK-AREA.                                    03540001
035500     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03550001
035600     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           03560001
035700                                        INDEXED BY LQW-IDX.       03570001
035800         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03580001
035900         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03590001
036000         10  LQW-SELECTED-SW            PIC  X(01).               03600001
036100             88  LQW-SELECT                         VALUE 'S'.    03610001
036200             88  LQW-DESELECT                       VALUE ' '.    03620001
036300         10  LQW-ACTION                 PIC  X(03).               03630001
036400             88  LQW-DEL                            VALUE 'DEL'.  03640001
036500             88  LQW-INQ                            VALUE 'INQ'.  03650001
036600             88  LQW-UPD                            VALUE 'UPD'.  03660001
036700             88  LQW-ERR                            VALUE 'ERR'.  03670001
036800         10  LQW-SML                    PIC  9(18).               03680001
036900         10  LQW-DEST-NBR               PIC  9(04).               03690001
037000         10  LQW-CREATE                 PIC  X(03).               03700001
037100         10  LQW-PO-RCVR                PIC  X(12).               03710001
037200         10  LQW-LOAD-STATUS            PIC  X(05).               03720001
037300         10  LQW-ACTV-CDE               PIC  X(01).               03730001
037400         10  LQW-STAT-DATE              PIC  X(08).               03740001
037500         10  LQW-STAT-TIME              PIC  X(05).               03750001
037600         10  LQW-TRLR-SRL-NBR           PIC  9(09).               03760001
037700         10  LQW-ERROR-SW               PIC  X(01).               03770001
037800         10  LQW-CALL-PGM               PIC  X(08).               03780001
037900                                                                  03790001
038000*---------------------------------------------------------------* 03800001
038100* SELECTON QUEUE LAYOUT                                         * 03810001
038200*---------------------------------------------------------------* 03820001
038300     COPY SUWS010.                                                03830001
038400                                                                  03840001
038500******************************************************************03850001
038600* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    03860049
038700******************************************************************03870001
038800     COPY PCWS046.                                                03880001
038900                                                                  03890001
039000*---------------------------------------------------------------* 03900001
039100*    MAP LAYOUT                                                 * 03910001
039200*---------------------------------------------------------------* 03920001
039300     COPY SUKM564.                                                03930001
039400*                                                                 03940001
039500 01  MR-OCCURS-LAYOUT                   REDEFINES  SU564AO.       03950001
039600     05  FILLER                         PIC X(197).               03960001
039700     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          03970001
039800         10  MR-SELECTL                 PIC S9(04) COMP.          03980001
039900         10  MR-SELECTA                 PIC  X(01).               03990001
040000         10  MR-SELECTC                 PIC  X(01).               04000001
040100         10  MR-SELECTH                 PIC  X(01).               04010001
040200         10  MR-SELECTI                 PIC  X(01).               04020001
040300                                                                  04030001
040400         10  MR-ACTIONL                 PIC S9(04) COMP.          04040001
040500         10  MR-ACTIONA                 PIC  X(01).               04050001
040600         10  MR-ACTIONC                 PIC  X(01).               04060001
040700         10  MR-ACTIONH                 PIC  X(01).               04070001
040800         10  MR-ACTION                  PIC  X(03).               04080001
040900                                                                  04090001
041000         10  MR-SMLL                    PIC S9(04) COMP.          04100001
041100         10  MR-SMLA                    PIC  X(01).               04110001
041200         10  MR-SMLC                    PIC  X(01).               04120001
041300         10  MR-SMLH                    PIC  X(01).               04130001
041400         10  MR-SML                     PIC  X(18).               04140001
041500                                                                  04150001
041600         10  MR-DEST-NBRL               PIC S9(04) COMP.          04160001
041700         10  MR-DEST-NBRA               PIC  X(01).               04170001
041800         10  MR-DEST-NBRC               PIC  X(01).               04180001
041900         10  MR-DEST-NBRH               PIC  X(01).               04190001
042000         10  MR-DEST-NBR                PIC  X(04).               04200001
042100                                                                  04210001
042200         10  MR-CREATEL                 PIC S9(04) COMP.          04220001
042300         10  MR-CREATEA                 PIC  X(01).               04230001
042400         10  MR-CREATEC                 PIC  X(01).               04240001
042500         10  MR-CREATEH                 PIC  X(01).               04250001
042600         10  MR-CREATE                  PIC  X(03).               04260001
042700                                                                  04270001
042800         10  MR-PO-RCVRL                PIC S9(04) COMP.          04280001
042900         10  MR-PO-RCVRA                PIC  X(01).               04290001
043000         10  MR-PO-RCVRC                PIC  X(01).               04300001
043100         10  MR-PO-RCVRH                PIC  X(01).               04310001
043200         10  MR-PO-RCVR                 PIC  X(12).               04320001
043300                                                                  04330001
043400         10  MR-LOAD-STATUSL            PIC S9(04) COMP.          04340001
043500         10  MR-LOAD-STATUSA            PIC  X(01).               04350001
043600         10  MR-LOAD-STATUSC            PIC  X(01).               04360001
043700         10  MR-LOAD-STATUSH            PIC  X(01).               04370001
043800         10  MR-LOAD-STATUS             PIC  X(05).               04380001
043900                                                                  04390001
044000         10  MR-ACTV-CDEL               PIC S9(04) COMP.          04400001
044100         10  MR-ACTV-CDEA               PIC  X(01).               04410001
044200         10  MR-ACTV-CDEC               PIC  X(01).               04420001
044300         10  MR-ACTV-CDEH               PIC  X(01).               04430001
044400         10  MR-ACTV-CDE                PIC  X(01).               04440001
044500                                                                  04450001
044600         10  MR-STAT-DATEL              PIC S9(04) COMP.          04460001
044700         10  MR-STAT-DATEA              PIC  X(01).               04470001
044800         10  MR-STAT-DATEC              PIC  X(01).               04480001
044900         10  MR-STAT-DATEH              PIC  X(01).               04490001
045000         10  MR-STAT-DATE               PIC  X(08).               04500001
045100                                                                  04510001
045200         10  MR-STAT-TIMEL              PIC S9(04) COMP.          04520001
045300         10  MR-STAT-TIMEA              PIC  X(01).               04530001
045400         10  MR-STAT-TIMEC              PIC  X(01).               04540001
045500         10  MR-STAT-TIMEH              PIC  X(01).               04550001
045600         10  MR-STAT-TIME               PIC  X(05).               04560001
045700                                                                  04570001
045800         10  MR-TRLR-SRL-NBRL           PIC S9(04) COMP.          04580001
045900         10  MR-TRLR-SRL-NBRA           PIC  X(01).               04590001
046000         10  MR-TRLR-SRL-NBRC           PIC  X(01).               04600001
046100         10  MR-TRLR-SRL-NBRH           PIC  X(01).               04610001
046200         10  MR-TRLR-SRL-NBR            PIC  X(09).               04620001
046300                                                                  04630015
046400*---------------------------------------------------------------* 04640015
046500*    COMM AREA FOR LOCATION MODULE                                04650015
046600*---------------------------------------------------------------* 04660015
046700     COPY XLWS071.                                                04670013
046800                                                                  04680015
046900*---------------------------------------------------------------* 04690001
047000*    ATTRIBUTE SETTINGS                                           04700001
047100*---------------------------------------------------------------* 04710001
047200     COPY DPWS015.                                                04720001
047300                                                                  04730001
047400*---------------------------------------------------------------* 04740001
047500*    FUNCTION KEYS                                                04750001
047600*---------------------------------------------------------------* 04760001
047700     COPY DPWS016.                                                04770001
047800                                                                  04780001
047900*----------------------------------------------------------------*04790001
048000**  SECURITY SUBROUTINE PARAMETERS                                04800001
048100*----------------------------------------------------------------*04810001
048200     COPY DPWS008.                                                04820008
048300                                                                  04830001
048400*---------------------------------------------------------------* 04840001
048500*    NUMERIC EDIT LAYOUT.                                       * 04850001
048600*---------------------------------------------------------------* 04860001
048700     COPY DPWS010I.                                               04870001
048800                                                                  04880001
048900*---------------------------------------------------------------* 04890001
049000*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04900052
049100*---------------------------------------------------------------* 04910001
049200     COPY DPWS030.                                                04920001
049200     COPY DPWS930.                                                04921052
049300                                                                  04930001
049400*---------------------------------------------------------------* 04940001
049500*    STANDARD COMMAREA.                                         * 04950001
049600*---------------------------------------------------------------* 04960001
049700     COPY DPWS020.                                                04970001
049800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04980001
049900                                                                  04990001
050000*---------------------------------------------------------------* 05000001
050100* INTER-APPLICATION COMMAREA.                                   * 05010001
050200*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05020001
050300*             SPEC SCREEN.                                      * 05030001
050400*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05040001
050500*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05050001
050600*---------------------------------------------------------------* 05060001
050700                                                                  05070001
050800         10  INTER-APPL-COMM-AREA       PIC X(200).               05080001
050900     COPY SUWS008.                                                05090001
051000     COPY SUWS009.                                                05100001
051100*---------------------------------------------------------------* 05110001
051200*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05120001
051300*---------------------------------------------------------------* 05130001
051400         10  ASC-SPECIFIC-COMMAREA.                               05140001
051500             15  ASC-OPER-UNT-ID             PIC  X(04).          05150010
051600             15  ASC-OPER-UNT-ID-N REDEFINES                      05160001
051700                     ASC-OPER-UNT-ID         PIC  9(04).          05170001
051800             15  ASC-OPER-UNT-NAME           PIC  X(25).          05180001
051900             15  ASC-SCAC-CODE               PIC  X(04).          05190001
052000             15  ASC-TRLR-SRL-NMBR           PIC  9(09).          05200001
052100             15  ASC-OPEN-TRLR-SRL           PIC  9(09).          05210001
052200             15  ASC-TRLR-ID                 PIC  X(12).          05220001
052300             15  ASC-OUTBOUND-TRIP-ID        PIC  9(09).          05230001
052400             15  ASC-OPEN-OTBND-TRIP         PIC  9(09).          05240001
052500             15  ASC-DOORSLOT                PIC  X(06).          05250001
052600             15  ASC-NUMBER                  PIC  X(06).          05260001
052700             15  ASC-DOOR-DESC               PIC  X(25).          05270001
052800             15  ASC-DOOR-ID                 PIC  X(04).          05280001
052900             15  ASC-DOOR-TYPE               PIC  X(02).          05290001
053000             15  ASC-DOOR-TYPE-DESC          PIC  X(30).          05300001
053100             15  ASC-STR-NBR-X               PIC  X(04).          05310001
053200             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           05320001
053300                 20  ASC-STR-NBR             PIC  9(04).          05330001
053400             15  ASC-TRIP-DEST-OPER          PIC  X(04).          05340001
053500             15 ASC-TRIP-DEST-OPER-X REDEFINES ASC-TRIP-DEST-OPER.05350001
053600                 20  ASC-TRIP-DEST-OPER-N    PIC  9(04).          05360001
053700             15  ASC-ACTIVITY-CODE           PIC  X(01).          05370001
053800             15  ASC-FROM-DATE               PIC  X(10).          05380001
053900             15  ASC-TO-DATE                 PIC  X(10).          05390001
054000             15  ASC-STATUS-TIME             PIC  X(05).          05400001
054100             15  ASC-SML-NBR                 PIC  9(18).          05410001
054200             15  ASC-CREATE-ID               PIC  X(03).          05420001
054300             15  ASC-PO-RCVR                 PIC  X(12).          05430001
054400                                                                  05440017
054500             15  ASC-TRN-NBR                 PIC  9(09).          05450017
054600                                                                  05460017
054700             15  ASC-LOAD-STAT               PIC  X(05).          05470001
054800             15  ASC-CARTON                  PIC  X(01).          05480001
054900             15  ASC-TRLR-SEAL               PIC  X(20).          05490001
055000             15  ASC-STATUS-DATE             PIC  X(10).          05500001
055100             15  ASC-SHOW-CARTON-SW          PIC  X(01).          05510001
055200                 88  ASC-SHOW-NEXT-CARTON     VALUE '3'.          05520001
055300             15  ASC-SAVE-CURSOR-SW          PIC X(01).           05530001
055400*-----------------------------------------------------------------05540001
055500             15  ASC-BLK-SUB                  PIC S9(04) COMP     05550001
055600                                                         SYNC.    05560001
055700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05570001
055800                                                         SYNC.    05580001
055900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05590001
056000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05600001
056100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05610001
056200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05620001
056300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05630001
056400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05640001
056500                                                         SYNC.    05650001
056600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05660001
056700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05670001
056800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05680001
056900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05690001
057000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05700001
057100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05710001
057200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05720001
057300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05730001
057400             15  ASC-LIST-QUEUE-NAME.                             05740001
057500                 20  ASC-LIST-TERM-ID         PIC  X(04).         05750001
057600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05760001
057700                 20  ASC-LIST-SEQ             PIC  9(01).         05770001
057800                                                                  05780001
057900             15  ASC-START-ITEM-REQUEST.                          05790001
058000                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05800001
058100                                                                  05810001
058200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05820001
058300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05830001
058400             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05840001
058500                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05850001
058600             15  ASC-SEL-QUEUE-NAME.                              05860001
058700                 20  ASC-SEL-TERM-ID          PIC  X(04).         05870001
058800                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05880001
058900                 20  ASC-SEL-SEQ              PIC  9(01).         05890001
059000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05900001
059100                                                                  05910001
059200*-----------------------------------------------------------------05920001
059300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05930001
059400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05940001
059500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05950001
059600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05960001
059700                                                                  05970001
059800                 20  ASC-ITEM-ARRAY.                              05980001
059900                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        05990001
060000                         30  ASC-LIST-ITEM-NUMBER                 06000001
060100                                                     PIC S9(09)   06010001
060200                                                     COMP-3.      06020001
060300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06030001
060400                             88  ASC-VALID-SELECT    VALUE ' '    06040001
060500                                                           'S'    06050001
060600                                                           'B'    06060001
060700                                                           'E'.   06070001
060800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06080001
060900                             88  ASC-TEMP-SELECT     VALUE 'S'.   06090001
061000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06100001
061100                             88  ASC-TEMP-END        VALUE 'E'.   06110001
061200                         30  ASC-SELECTED-SW         PIC  X(01).  06120001
061300                             88  ASC-NO-SELECT       VALUE ' '.   06130001
061400                             88  ASC-SELECT          VALUE 'S'.   06140001
061500                             88  ASC-BEGIN           VALUE 'B'.   06150001
061600                             88  ASC-END             VALUE 'E'.   06160001
061700                         30  ASC-ACTION               PIC  X(03). 06170001
061800                         30  ASC-SML                  PIC  9(18). 06180001
061900                         30  ASC-DEST-NBR             PIC  9(04). 06190001
062000                         30  ASC-CREATE               PIC  X(03). 06200001
062100                         30  ASC-PO-RCVR-NBR          PIC  X(12). 06210001
062200                         30  ASC-LOAD-STATUS          PIC  X(05). 06220001
062300                         30  ASC-ACTV-CDE             PIC  X(01). 06230001
062400                         30  ASC-STAT-DATE            PIC  X(08). 06240001
062500                         30  ASC-STAT-TIME            PIC  X(05). 06250001
062600                         30  ASC-TRLR-SRL-NBR         PIC  Z(09). 06260001
062700                         30  ASC-TRLR-SRL-NBR-N REDEFINES         06270001
062800                                                ASC-TRLR-SRL-NBR. 06280001
062900                             35  ASC-TRLR-SRL-NBR-X   PIC  X(09). 06290001
063000                         30  ASC-ERROR-SW             PIC  X(01). 06300001
063100                             88  ASC-MISSING-DATA    VALUE '1'.   06310001
063200                             88  ASC-NO-MISSING-DATA VALUE '2'.   06320001
063300                             88  ASC-INACTIVE-CRTN   VALUE '3'.   06330001
063400                             88  ASC-ACTIVE-CRTN     VALUE '4'.   06340001
063500                         30  ASC-CALL-PGM             PIC  X(08). 06350001
063600                                                                  06360001
063700*---------------------------------------------------------------* 06370001
063800*    ABEND PROCESSING                                             06380001
063900*---------------------------------------------------------------* 06390001
064000     COPY DPWS013.                                                06400001
064100                                                                  06410001
064200*---------------------------------------------------------------* 06420001
064300*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 06430001
064400*---------------------------------------------------------------* 06440001
064500     EXEC SQL                                                     06450001
064600          INCLUDE TSUOBTR                                         06460001
064700     END-EXEC.                                                    06470001
064800                                                                  06480001
064900*---------------------------------------------------------------* 06490001
065000*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 06500001
065100*---------------------------------------------------------------* 06510001
065200     EXEC SQL                                                     06520001
065300          INCLUDE TSUOBTS                                         06530001
065400     END-EXEC.                                                    06540001
065500                                                                  06550001
065600*---------------------------------------------------------------* 06560001
065700*    TSUOBSC - TRIP STATUS CODE DESCRIPTION                       06570001
065800*---------------------------------------------------------------* 06580001
065900     EXEC SQL                                                     06590001
066000          INCLUDE TSUOBSC                                         06600001
066100     END-EXEC.                                                    06610001
066200                                                                  06620001
066300*---------------------------------------------------------------* 06630001
066400*    TSUCDOT - CARTON DIVERT - TRIP ASSOCIATION TABLE             06640001
066500*---------------------------------------------------------------* 06650001
066600     EXEC SQL                                                     06660001
066700          INCLUDE TSUCDOT                                         06670001
066800     END-EXEC.                                                    06680001
066900                                                                  06690001
067000*---------------------------------------------------------------* 06700001
067100*    TSUCRDV - CARTON DIVERT TABLE                                06710001
067200*---------------------------------------------------------------* 06720001
067300     EXEC SQL                                                     06730001
067400          INCLUDE TSUCRDV                                         06740001
067500     END-EXEC.                                                    06750001
067600                                                                  06760001
067700*    USER-TRAILER AUDIT                                           06770001
067800*    SUT_TRIP_WRKR_AUD                                            06780001
067900     EXEC SQL                                                     06790001
068000         INCLUDE SUT00006                                         06800001
068100     END-EXEC.                                                    06810001
068200                                                                  06820001
068300*---------------------------------------------------------------* 06830001
068400*    SUT_OTBND_LOC SHIPPING UNIT LOCATION TABLE                   06840001
068500*---------------------------------------------------------------* 06850001
068600     EXEC SQL                                                     06860001
068700          INCLUDE SUT00027                                        06870001
068800     END-EXEC.                                                    06880001
068900                                                                  06890001
069000*---------------------------------------------------------------* 06900001
069100*    SUT_OTBND_CART SHIPPING UNIT TABLE                           06910001
069200*---------------------------------------------------------------* 06920001
069300     EXEC SQL                                                     06930001
069400          INCLUDE SUT00024                                        06940001
069500     END-EXEC.                                                    06950001
069600                                                                  06960001
069700                                                                  06970001
069800*---------------------------------------------------------------* 06980001
069900*    SUT_OTBND_UPC UPC TABLE                                      06990001
070000*---------------------------------------------------------------* 07000001
070100     EXEC SQL                                                     07010001
070200          INCLUDE SUT00028                                        07020001
070300     END-EXEC.                                                    07030001
070400                                                                  07040001
070500*---------------------------------------------------------------* 07050001
070600*    TCNDCDR - DC TO DOOR ASSIGNMENT                            * 07060001
070700*---------------------------------------------------------------* 07070001
070800     EXEC SQL                                                     07080001
070900          INCLUDE TCNDCDR                                         07090001
071000     END-EXEC.                                                    07100001
071100                                                                  07110001
071200*---------------------------------------------------------------* 07120001
071300*    TCNDRTY - DOOR TYPES                                         07130001
071400*---------------------------------------------------------------* 07140001
071500     EXEC SQL                                                     07150001
071600          INCLUDE TCNDRTY                                         07160001
071700     END-EXEC.                                                    07170001
071800                                                                  07180001
071900*---------------------------------------------------------------* 07190001
072000*   TCNDRST - DC DOOR TO STORE ASSOCIATION TABLE                * 07200001
072100*---------------------------------------------------------------* 07210001
072200     EXEC SQL                                                     07220001
072300          INCLUDE TCNDRST                                         07230001
072400     END-EXEC.                                                    07240001
072500                                                                  07250001
072600*---------------------------------------------------------------* 07260001
072700*    TCNTRID - TRAILIER ID TABLE                                  07270001
072800*---------------------------------------------------------------* 07280001
072900     EXEC SQL                                                     07290001
073000          INCLUDE TCNTRID                                         07300001
073100     END-EXEC.                                                    07310001
073200                                                                  07320001
073300*---------------------------------------------------------------* 07330001
073400*    DB2 AREA FOR COMMUNICATIONS                                * 07340001
073500*---------------------------------------------------------------* 07350001
073600     EXEC SQL                                                     07360001
073700          INCLUDE SQLCA                                           07370001
073800     END-EXEC.                                                    07380001
073900                                                                  07390001
074000******************************************************************07400001
074100* VARIOUS CURSORS, SELECTS, AND WORKING STORAGE AREAS FOR         07410001
074200* RETRIEVING CARTONS                                              07420001
074300******************************************************************07430001
074400     COPY PCWS049.                                                07440001
074500     COPY PCWS050.                                                07450001
074600                                                                  07460001
074700*-----------------------------------------------------------------07470001
074800 LINKAGE SECTION.                                                 07480001
074900                                                                  07490001
075000 01  DFHCOMMAREA.                                                 07500001
075100     05  FILLER                         OCCURS  1 TO 4072 TIMES   07510001
075200                                        DEPENDING ON EIBCALEN.    07520001
075300         10  FILLER                     PIC X.                    07530001
075400                                                                  07540001
075500                                                                  07550051
075600 PROCEDURE DIVISION.                                              07560001
075700******************************************************************07570001
075800**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07580001
075900**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07590001
076000**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07600001
076100******************************************************************07610001
076200 0000-MAIN-MODULE.                                                07620001
076300     INITIALIZE DP030-CICS-API-FIELDS.                            07630001
076400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07640001
076500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07650001
076600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07660001
076700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07670001
076800     MOVE LENGTH OF SU564AI        TO DP030-MAP-LENGTH (1).       07680001
076900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07690001
077000     PERFORM 0001-CALL-CICS-ARCH-API.                             07700001
077100*                                                                 07710001
077200     PERFORM 1000-CONTROL-PROCESSING                              07720001
077300*                                                                 07730001
077400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07740001
077500     PERFORM 0001-CALL-CICS-ARCH-API.                             07750001
077600                                                                  07760001
077700******************************************************************07770001
077800**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07780001
077900**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07790001
078000******************************************************************07800001
078100 0001-CALL-CICS-ARCH-API.                                         07810001
078200*    CALL 'DPKCS030' USING DFHEIBLK                               07820052
078200     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07821052
078300                           DFHCOMMAREA                            07830001
078400                           DP030-CICS-API-FIELDS                  07840001
078500                           DP020-STANDARD-COMMAREA                07850001
078600                           SU564AI.                               07860001
078700*                                                                 07870001
078800     IF  DP030-RC-CALL-SUCCESSFUL                                 07880001
078900         CONTINUE                                                 07890001
079000     ELSE                                                         07900001
079100         SET DP013-NO-ROLLBACK                                    07910001
079200             DP013-XCTL-DISPLAY-RESTART                           07920001
079300             DP013-CICS-ABEND      TO TRUE                        07930001
079400         MOVE '0001-CALL-CICS-ARCH-API'                           07940001
079500                                   TO DP013-PARAGRAPH             07950001
079600*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07960052
079700*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07970052
079600         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O07971052
079700-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07972052
079800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07980001
079900         PERFORM DP013-0000-PROCESS-ABEND                         07990001
080000     END-IF.                                                      08000001
080100*----------------------------------------------------------------*08010001
080200* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08020001
080300* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08030001
080400*                                                                *08040001
080500* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08050001
080600*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08060001
080700*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08070001
080800*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08080001
080900*----------------------------------------------------------------*08090001
081000                                                                  08100001
081100 1000-CONTROL-PROCESSING.                                         08110001
081200                                                                  08120001
081300     EVALUATE TRUE                                                08130001
081400         WHEN DP020-NEXT-ACT-INITIAL                              08140001
081500             INITIALIZE ASC-SPECIFIC-COMMAREA                     08150001
081600             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08160001
081700                                      ASC-SEL-TERM-ID             08170001
081800             MOVE DP020-SRC-TASK-NUMBER                           08180001
081900                                   TO ASC-LIST-TASK-NUMBER        08190001
082000                                      ASC-SEL-TASK-NUMBER         08200001
082100             MOVE PC-LIST-QUEUE-SEQ                               08210001
082200                                   TO ASC-LIST-SEQ                08220001
082300             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 08230001
082400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08240001
082500***-----$TEMPLATE NOTE$-------------------------------------------08250001
082600*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,08260001
082700*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  08270001
082800*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08280001
082900***---------------------------------------------------------------08290001
083000             IF  PS-COMMAREA-NOT-VALID                            08300001
083100                 SET DP020-NEXT-ACT-APPL-ERROR                    08310001
083200                                   TO TRUE                        08320001
083300             ELSE                                                 08330001
083400                 PERFORM 4000-BUILD-INITIAL-PANEL                 08340001
083500             END-IF                                               08350001
083600                                                                  08360001
083700         WHEN DP020-NEXT-ACT-READ-MAP                             08370001
083800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08380001
083900                                   TO PV-TOP-ITEM                 08390001
084000             PERFORM 2000-PROCESS-PANEL                           08400001
084100                                                                  08410001
084200         WHEN DP020-NEXT-ACT-RETURN                               08420001
084300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08430001
084400                                   TO PV-TOP-ITEM                 08440001
084500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08450001
084600             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08460001
084700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08470001
084900                                                                  08490001
085000         WHEN OTHER                                               08500001
085100             SET DP013-LOGIC-ABEND TO TRUE                        08510001
085200             SET DP013-NO-ROLLBACK TO TRUE                        08520001
085300             MOVE '1000-CONTROL-PROCESSING'                       08530001
085400                                   TO DP013-PARAGRAPH             08540001
085500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08550001
085600                                   TO DP013-MESSAGE-TEXT(1)       08560001
085700             PERFORM DP013-0000-PROCESS-ABEND                     08570001
085800     END-EVALUATE.                                                08580001
085900                                                                  08590001
086000                                                                  08600051
086100*----------------------------------------------------------------*08610001
086200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08620001
086300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08630001
086400*----------------------------------------------------------------*08640001
086500                                                                  08650001
086600 1100-PROCESS-INTER-APPL-COMM.                                    08660001
086700                                                                  08670001
086800     SET PS-COMMAREA-VALID         TO TRUE.                       08680001
086900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08690001
087000                                                                  08700001
087100     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          08710001
087200                             OR PC-SHOW-NEXT-CARTON               08720001
087300         MOVE SU008-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        08730001
087400                                         DK-OPER-UNT-ID           08740001
087500         MOVE SU008-DOOR-ID           TO ASC-DOOR-ID              08750001
087600         MOVE SU008-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NMBR        08760001
087700         MOVE SU008-SCAC-CDE          TO ASC-SCAC-CODE            08770001
087800                                                                  08780001
087900         MOVE SU008-DATE-RANGE-FROM   TO ASC-FROM-DATE            08790001
088000         MOVE SU008-DATE-RANGE-TO     TO ASC-TO-DATE              08800001
088100         MOVE SU008-CARTONS           TO ASC-CARTON               08810001
088200         MOVE SU008-DEST-STR-NBR      TO ASC-STR-NBR              08820001
088300         MOVE SU008-TRIP-ID           TO ASC-OUTBOUND-TRIP-ID     08830001
088400                                         DK-OUTBOUND-TRIP-ID      08840001
088500         MOVE SU008-TRLR-SEAL-NBR     TO ASC-TRLR-SEAL            08850001
088600     ELSE                                                         08860001
088700         SET ASC-USE-SELECTION-QUEUE TO TRUE                      08870001
088800         MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                   08880001
088900                                      ASC-NUMBER-OF-SELECTED-ITEMS08890001
089000         MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08900001
089100         MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      08910001
089200         MOVE SU009-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        08920001
089300                                         DK-OPER-UNT-ID           08930001
089400         MOVE SU009-DOOR-ID           TO ASC-DOOR-ID              08940001
089500                                         DK-DOOR-ID               08950001
089600         PERFORM 1120-PREPARE-LIST-ENTRY                          08960001
089700     END-IF.                                                      08970001
089800                                                                  08980001
089900 1120-PREPARE-LIST-ENTRY.                                         08990001
090000                                                                  09000001
090100     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                09010001
090200     MOVE ZERO                     TO ASC-SEL-ITEM.               09020001
090300     PERFORM 1130-GET-NEXT-RECORD.                                09030001
090400                                                                  09040001
090500*-----------------------------------------------------------------09050001
090600*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*09060001
090700*-----------------------------------------------------------------09070001
090800 1130-GET-NEXT-RECORD.                                            09080001
090900                                                                  09090001
091000     ADD +1                       TO ASC-SEL-SUB.                 09100001
091100                                                                  09110001
091200     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            09120001
091300         ADD +1                   TO ASC-SEL-ITEM                 09130001
091400         MOVE +1                  TO ASC-SEL-SUB                  09140001
091500     END-IF.                                                      09150001
091600                                                                  09160001
091700     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09170001
091800         PERFORM 9100-READ-SEL-QUEUE                              09180001
091900         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      09190001
092000             MOVE SU010-DOOR-ID (ASC-SEL-SUB) TO ASC-DOOR-ID      09200001
092100             MOVE SU010-DOOR-TYPE (ASC-SEL-SUB) TO ASC-DOOR-TYPE  09210001
092200             MOVE SU010-DESCRIPTION (ASC-SEL-SUB) TO              09220001
092300                                                   ASC-DOOR-DESC  09230001
092400             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)  TO            09240001
092500                                                 ASC-TRLR-SRL-NMBR09250001
092600             MOVE SU010-TRIP-ID (ASC-SEL-SUB) TO                  09260001
092700                                             ASC-OUTBOUND-TRIP-ID 09270001
092800             MOVE SU010-STAT-DATE (ASC-SEL-SUB)                   09280001
092900                                               TO ASC-STATUS-DATE 09290001
093000             MOVE SU010-DEST-NBR (ASC-SEL-SUB) TO ASC-STR-NBR     09300001
093100             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  09310001
093200             PERFORM 9200-REWRITE-SEL-QUEUE                       09320001
093300         ELSE                                                     09330001
093400             SUBTRACT +1 FROM ASC-SEL-SUB                         09340001
093500             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09350001
093600             SET DP020-MSG-INFORMATIONAL                          09360001
093700                 PS-LIST-END             TO TRUE                  09370001
093800         END-IF                                                   09380001
093900     ELSE                                                         09390001
094000         SUBTRACT +1 FROM ASC-SEL-ITEM                            09400001
094100         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  09410001
094200         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09420001
094300         SET DP020-MSG-INFORMATIONAL                              09430001
094400             PS-LIST-END             TO TRUE                      09440001
094500     END-IF.                                                      09450001
094600                                                                  09460001
094700*-----------------------------------------------------------------09470001
094800*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09480001
094900*    PROCESSED.                                                  *09490001
095000*-----------------------------------------------------------------09500001
095100 1140-GET-PREV-RECORD.                                            09510001
095200                                                                  09520001
095300     SUBTRACT +1 FROM ASC-SEL-SUB.                                09530001
095400                                                                  09540001
095500     IF  ASC-SEL-SUB < +1                                         09550001
095600         SUBTRACT +1 FROM ASC-SEL-ITEM                            09560001
095700         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  09570001
095800     END-IF.                                                      09580001
095900                                                                  09590001
096000     IF  ASC-SEL-ITEM > ZERO                                      09600001
096100         PERFORM 9100-READ-SEL-QUEUE                              09610001
096200             MOVE SU010-DOOR-ID (ASC-SEL-SUB)                     09620001
096300                                      TO ASC-DOOR-ID              09630001
096400             MOVE SU010-DOOR-TYPE (ASC-SEL-SUB)                   09640001
096500                                      TO ASC-DOOR-TYPE            09650001
096600             MOVE SU010-DESCRIPTION (ASC-SEL-SUB)                 09660001
096700                                      TO ASC-DOOR-DESC            09670001
096800             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)                09680001
096900                                      TO ASC-TRLR-SRL-NMBR        09690001
097000             MOVE SU010-TRIP-ID (ASC-SEL-SUB)                     09700001
097100                                      TO ASC-OUTBOUND-TRIP-ID     09710001
097200             MOVE SU010-STAT-DATE (ASC-SEL-SUB)                   09720001
097300                                      TO ASC-STATUS-DATE          09730001
097400             MOVE SU010-DEST-NBR (ASC-SEL-SUB)                    09740001
097500                                      TO ASC-STR-NBR              09750001
097600             SET SU010-INQ (ASC-SEL-SUB)                          09760001
097700                                      TO TRUE                     09770001
097800             PERFORM 9200-REWRITE-SEL-QUEUE                       09780001
097900         ELSE                                                     09790001
098000             MOVE +1                  TO ASC-SEL-ITEM             09800001
098100                                         ASC-SEL-SUB              09810001
098200             MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER         09820001
098300             SET DP020-MSG-INFORMATIONAL                          09830001
098400                 PS-LIST-END          TO TRUE                     09840001
098500     END-IF.                                                      09850001
098600                                                                  09860001
098700                                                                  09870051
098800*----------------------------------------------------------------*09880001
098900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09890001
099000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09900001
099100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09910001
099200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09920001
099300* FUNCTION KEYS CAN GET THIS FAR.                                *09930001
099400*----------------------------------------------------------------*09940001
099500                                                                  09950001
099600 2000-PROCESS-PANEL.                                              09960001
099700     EVALUATE TRUE                                                09970001
099800         WHEN DP020-SRC-AID = DP016-CLEAR                         09980001
099900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09990001
100000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10000001
100100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10010001
100200                                                                  10020001
100300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10030001
100400             PERFORM 2050-DELETE-LIST-QUEUE                       10040001
100500             INITIALIZE ASC-OUTBOUND-TRIP-ID                      10050001
100600                        ASC-PO-RCVR                               10060001
100700             PERFORM 4000-BUILD-INITIAL-PANEL                     10070001
100800                                                                  10080001
100900         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10090001
101000             PERFORM 2140-DESELECT-ALL-ITEMS                      10100001
101100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10110001
101200                                                                  10120001
101300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10130001
101400             PERFORM 2150-SELECT-ALL-ITEMS                        10140001
101500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10150001
101600                                                                  10160001
101700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10170001
101800             IF  ASC-USE-SELECTION-QUEUE                          10180001
101900                 PERFORM 2110-GET-NEXT-MESSAGE                    10190001
102000                 PERFORM 3200-RESET-ATTRIBUTES                    10200001
102100                 PERFORM 2050-DELETE-LIST-QUEUE                   10210001
102200                 PERFORM 4000-BUILD-INITIAL-PANEL                 10220001
102300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10230001
102400             ELSE                                                 10240001
102500*                --- BOTTOM OF LIST ---                           10250001
102600                 MOVE PC-TSYMSG-00070                             10260001
102700                                   TO DP020-MSG-NUMBER            10270001
102800                 SET DP020-MSG-INFORMATIONAL                      10280001
102900                     PS-ERROR      TO TRUE                        10290001
103000             END-IF                                               10300001
103100                                                                  10310001
103200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10320001
103300             IF  ASC-USE-SELECTION-QUEUE                          10330001
103400                 PERFORM 2120-GET-PREV-MESSAGE                    10340001
103600                 PERFORM 3200-RESET-ATTRIBUTES                    10360001
103700                 PERFORM 2050-DELETE-LIST-QUEUE                   10370001
103800                 PERFORM 4000-BUILD-INITIAL-PANEL                 10380001
103900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10390001
104000             ELSE                                                 10400001
104100*                --- TOP OF LIST ---                              10410001
104200                 MOVE PC-TSYMSG-00069                             10420001
104300                                   TO DP020-MSG-NUMBER            10430001
104400                 SET DP020-MSG-INFORMATIONAL                      10440001
104500                                   TO TRUE                        10450001
104600             END-IF                                               10460001
104700                                                                  10470001
104800         WHEN OTHER                                               10480001
104900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10490001
105000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10500001
105100             IF  PS-NO-ERROR                                      10510001
105200                 SET DP030-CONTINUE-GO                            10520001
105300                                 TO TRUE                          10530001
105400                 PERFORM 2100-CHECK-FUNCTION-KEY                  10540001
105500             ELSE                                                 10550001
105600                 SET DP030-OVERRIDE-GO                            10560001
105700                                 TO TRUE                          10570001
105800             END-IF                                               10580001
105900     END-EVALUATE.                                                10590001
106000                                                                  10600051
106100*----------------------------------------------------------------*10610001
106200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10620001
106300*----------------------------------------------------------------*10630001
106400 2050-DELETE-LIST-QUEUE.                                          10640001
106500                                                                  10650001
106600     EXEC CICS                                                    10660001
106700         DELETEQ TS                                               10670001
106800             QUEUE (ASC-LIST-QUEUE-NAME)                          10680001
106900             RESP  (PV-CICS-RESP)                                 10690001
107000     END-EXEC.                                                    10700001
107100                                                                  10710001
107200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10720001
107300        (PV-CICS-RESP = DFHRESP(QIDERR))                          10730001
107400         CONTINUE                                                 10740001
107500     ELSE                                                         10750001
107600         SET DP013-CICS-ABEND      TO TRUE                        10760001
107700         SET DP013-NO-ROLLBACK     TO TRUE                        10770001
107800                                                                  10780001
107900         MOVE '2050-DELETE-LIST-QUEUE'                            10790001
108000                                   TO DP013-PARAGRAPH             10800001
108100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10810001
108200                                   TO DP013-MESSAGE-TEXT (1)      10820001
108300         PERFORM DP013-0000-PROCESS-ABEND                         10830001
108400     END-IF.                                                      10840001
108500                                                                  10850001
108600     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10860001
108700                                                                  10870051
108800*----------------------------------------------------------------*10880001
108900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10890001
109000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10900001
109100* CICS ARCHITECTURE API.                                         *10910001
109200*----------------------------------------------------------------*10920001
109300 2100-CHECK-FUNCTION-KEY.                                         10930001
109400     EVALUATE TRUE                                                10940001
109500                                                                  10950051
109600* F22 - CARTON DETAIL                                             10960001
109700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10970001
109800* F18 - CARTON PACKED DETAIL                                      10980001
109900         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              10990001
110000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11000001
110100                 SET ASC-USE-SELECTION-QUEUE TO TRUE              11010001
110200                 INITIALIZE SU009-INTER-APPL-COMMAREA             11020001
110300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11030001
110400                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11040001
110500                 MOVE ASC-NUMBER-OF-TS-ITEMS                      11050001
110600                                      TO SU009-NUMBER-OF-TS-ITEMS 11060001
110700                 MOVE ASC-SEL-QUEUE-NAME   TO SU009-SEL-QUEUE-NAME11070001
110800                 MOVE ASC-OPER-UNT-ID       TO SU009-OPER-UNT-ID  11080001
110900                 MOVE ASC-DOOR-ID           TO SU009-DOOR-ID      11090001
111000                 MOVE ASC-TRLR-SRL-NMBR     TO SU009-TRLR-SRL-NBR 11100001
111100                 MOVE ASC-OUTBOUND-TRIP-ID  TO SU009-TRIP-ID      11110001
111200                 MOVE ASC-STR-NBR           TO SU009-DEST-STR-NBR 11120001
111300                 MOVE ASC-SCAC-CODE         TO SU009-SCAC-CDE     11130001
111400                 PERFORM 5000-PREPARE-SEL-QUEUE                   11140001
111500             ELSE                                                 11150001
111600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11160001
111700                 SET DP030-OVERRIDE-GO TO TRUE                    11170001
111800                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         11180001
111900                 SET DP020-MSG-WARNING TO TRUE                    11190001
112000             END-IF                                               11200001
112100                                                                  11210051
112200* F23 - BEGIN CARTON CUT OFF                                      11220001
112300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11230001
112400             MOVE 'SUCUTOFF' TO DP008-FUNCTION-NAME               11240001
112500             PERFORM 2105-RACF-ACCESS                             11250001
112600             IF  PS-ACCESS-NOT-ALLOWED                            11260001
112700                 SET  PS-ERROR                                    11270001
112800                      DP020-MSG-FATAL TO TRUE                     11280001
112900                 MOVE PC-TSYMSG-02790 TO DP020-MSG-NUMBER         11290001
113000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11300001
113100             ELSE                                                 11310001
113200                                                                  11320001
113300               IF  PS-NO-ERROR                                    11330001
113400                                                                  11340009
113500*** DETERMINE IF TRIP IS STILL OPEN AT THIS DOOR                  11350009
113700                 MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID         11370010
113800                 MOVE ASC-DOOR-ID      TO  DK-DOOR-ID             11380010
113900                 PERFORM 4053-GET-OPEN-TRIP                       11390009
114000*                                                                 11400009
114100                 IF  ASC-OPEN-OTBND-TRIP > ZEROES                 11410009
114200                     PERFORM 5000-PREPARE-SEL-QUEUE               11420009
114300                     SET SU010-IDX TO  1                          11430009
114400                     IF SU010-LOAD-STAT (SU010-IDX)               11440001
114500                                 NOT = 'DVRTD'   AND              11450001
114600                        SU010-LOAD-STAT (SU010-IDX)               11460001
114700                                 NOT = 'INACT'                    11470001
114800                         SET  PS-ERROR                            11480001
114900                              DP020-MSG-FATAL TO TRUE             11490001
115000                         MOVE PC-TSYMSG-02793 TO DP020-MSG-NUMBER 11500001
115100                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11510001
115200                     ELSE                                         11520001
115300                         PERFORM 2100A-CAN-I-IGNORE-EDITS         11530001
115400                                                                  11540001
115500                         PERFORM 3600-RETRIEVE-START-TMST         11550001
115800                         IF  ASC-DOOR-TYPE  =  'SH'               11580019
115900                             IF  SUCRDV-DEST-OPER-UNT-ID  =       11590021
116000                                 ASC-TRIP-DEST-OPER-N             11600019
116100                                 CONTINUE                         11610019
116200                             ELSE                                 11620019
116300                                 SET  PS-ERROR                    11630019
116400                                      DP020-MSG-FATAL TO TRUE     11640019
116500                                 MOVE PC-TSYMSG-03486             11650019
116600                                              TO DP020-MSG-NUMBER 11660019
116700                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 11670019
116800                              END-IF                              11680019
116900                          END-IF                                  11690019
117300                         IF PS-NO-ERROR                           11730019
117400                             IF  PS-BRAND-NEW-DOOR                11740019
117500                                 PERFORM 3650-INSERT-ROW-TSUCDOT  11750019
117600                             ELSE                                 11760019
117800                             PERFORM 3610-CHECK-4-BEGIN-CUTOFF    11780019
117900                             IF PS-NO-ERROR                       11790019
118000                                 PERFORM 3620-CHECK-4-PRIOR-CRTNS 11800019
118100                             ELSE                                 11810019
118200                                 PERFORM                          11820019
118300                                    4400-MOVE-COMMAREA-TO-SCREEN  11830001
118400                                 SET DP030-OVERRIDE-GO TO TRUE    11840019
118500                             END-IF                               11850019
118600                             END-IF                               11860019
118700                         END-IF                                   11870019
118800                                                                  11880001
118900                     END-IF                                       11890001
119000                 ELSE                                             11900001
119100                     SET  PS-ERROR                                11910001
119200                          DP020-MSG-FATAL TO TRUE                 11920001
119300                     MOVE PC-TSYMSG-00743 TO DP020-MSG-NUMBER     11930001
119400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11940001
119500                 END-IF                                           11950001
119600               ELSE                                               11960001
119700                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         11970001
119800                 SET DP020-MSG-WARNING TO TRUE                    11980001
119900               END-IF                                             11990001
120000             END-IF                                               12000001
120100                                                                  12010051
120200* F24 - END CARTON CUT OFF                                        12020001
120300         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12030001
120400             MOVE 'SUCUTOFF' TO DP008-FUNCTION-NAME               12040001
120500             PERFORM 2105-RACF-ACCESS                             12050001
120600             IF  PS-ACCESS-NOT-ALLOWED                            12060001
120700                 SET  PS-ERROR                                    12070001
120800                      DP020-MSG-FATAL TO TRUE                     12080001
120900                 MOVE PC-TSYMSG-02790 TO DP020-MSG-NUMBER         12090001
121000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12100001
121100             ELSE                                                 12110001
121200                                                                  12120001
121300               IF  PS-NO-ERROR                                    12130001
121400                                                                  12140009
121500*** DETERMINE IF TRIP IS STILL OPEN AT THIS DOOR                  12150009
121700                 MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID         12170010
121800                 MOVE ASC-DOOR-ID      TO  DK-DOOR-ID             12180010
121900                 PERFORM 4053-GET-OPEN-TRIP                       12190009
122000*                                                                 12200009
122100                 IF  ASC-OPEN-OTBND-TRIP > ZEROES                 12210001
122200                     PERFORM 5000-PREPARE-SEL-QUEUE               12220001
122300                     SET SU010-IDX TO  1                          12230001
122400                     IF SU010-LOAD-STAT (SU010-IDX)               12240001
122500                                 NOT = 'DVRTD'      AND           12250001
122600                        SU010-LOAD-STAT (SU010-IDX)               12260001
122700                                 NOT = 'INACT'                    12270001
122800                         SET  PS-ERROR                            12280001
122900                              DP020-MSG-FATAL TO TRUE             12290001
123000                         MOVE PC-TSYMSG-02793 TO DP020-MSG-NUMBER 12300001
123100                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     12310001
123200                     ELSE                                         12320001
123300                         PERFORM 3600-RETRIEVE-START-TMST         12330001
123600                         IF  ASC-DOOR-TYPE  =  'SH'               12360019
123700                             IF  SUCRDV-DEST-OPER-UNT-ID  =       12370021
123800                                 ASC-TRIP-DEST-OPER-N             12380019
123900                                 CONTINUE                         12390019
124000                              ELSE                                12400019
124100                                 SET  PS-ERROR                    12410019
124200                                      DP020-MSG-FATAL TO TRUE     12420019
124300                                 MOVE PC-TSYMSG-03486             12430019
124400                                              TO DP020-MSG-NUMBER 12440019
124500                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 12450019
124600                             END-IF                               12460019
124700                         END-IF                                   12470019
125000                         IF PS-NO-ERROR                           12500022
125100                             PERFORM 3700-CHECK-4-END-CUTOFF      12510019
125200                         END-IF                                   12520019
125300                                                                  12530019
125400                         IF PS-NO-ERROR                           12540001
125500                             PERFORM 3710-UPDATE-TSUCDOT          12550001
125600                         ELSE                                     12560001
125700                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 12570001
125800                             SET DP030-OVERRIDE-GO TO TRUE        12580001
125900                         END-IF                                   12590001
126000                     END-IF                                       12600001
126100                 ELSE                                             12610001
126200                     SET  PS-ERROR                                12620001
126300                          DP020-MSG-FATAL TO TRUE                 12630001
126400                     MOVE PC-TSYMSG-00743 TO DP020-MSG-NUMBER     12640001
126500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12650001
126600                 END-IF                                           12660001
126700               ELSE                                               12670001
126800                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         12680001
126900                 SET DP020-MSG-WARNING TO TRUE                    12690001
127000               END-IF                                             12700001
127100             END-IF                                               12710001
127200                                                                  12720051
127300* F6 - FIRST PAGE                                                 12730001
127400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  12740001
127500             MOVE +1               TO PV-TOP-ITEM                 12750001
127600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12760001
127700                                                                  12770051
127800* F7 - PREVIOUS PAGE                                              12780001
127900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12790001
128000             PERFORM 2110-BROWSE-BACKWARD                         12800001
128100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12810001
128200                                                                  12820051
128300* F8 - NEXT PAGE                                                  12830001
128400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12840001
128500             PERFORM 2120-BROWSE-FORWARD                          12850001
128600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12860001
128700                                                                  12870051
128800* ENTER KEY                                                       12880001
128900         WHEN DP020-SRC-AID = DP016-ENTER                         12890001
129000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12900001
129100             IF  PS-ERROR                                         12910001
129200                 CONTINUE                                         12920001
129300             ELSE                                                 12930001
129400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12940001
129500             END-IF                                               12950001
129600                                                                  12960001
129700         WHEN OTHER                                               12970001
129800             SET DP013-NO-ROLLBACK                                12980001
129900                 DP013-XCTL-DISPLAY-RESTART                       12990001
130000                 DP013-CICS-ABEND  TO TRUE                        13000001
130100             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    13010001
130200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13020001
130300                                   TO DP013-MESSAGE-TEXT (1)      13030001
130400             PERFORM DP013-0000-PROCESS-ABEND                     13040001
130500     END-EVALUATE.                                                13050001
130600                                                                  13060051
130700 2100A-CAN-I-IGNORE-EDITS.                                        13070001
130800     MOVE ASC-OPER-UNT-ID-N   TO DK-OPER-UNT-ID                   13080001
130900     MOVE ASC-DOOR-ID         TO DK-DOOR-ID                       13090001
131000     MOVE ASC-OPEN-OTBND-TRIP TO DK-OUTBOUND-TRIP-ID              13100001
131100     PERFORM 7300-ANY-OTHER-TRLRS-THIS-DOOR                       13110001
131200                                                                  13120001
131300     IF PV-TRLR-COUNT = ZERO                                      13130001
131400*        THERE WERE NO OTHER TRAILERS EVER AT THIS DOOR           13140001
131500         PERFORM 7310-CHECK-EXISTING-CUTOFFS                      13150001
131600         IF PV-CUTOFF-COUNT = ZERO                                13160001
131700*            NO CUTOFFS WERE EVER DONE ON THIS DIVERT             13170001
131800             SET PS-BRAND-NEW-DOOR  TO TRUE                       13180001
131900         ELSE                                                     13190001
132000             SET PS-EXISTING-DOOR   TO TRUE                       13200001
132100         END-IF                                                   13210001
132200     ELSE                                                         13220001
132300         SET PS-EXISTING-DOOR       TO TRUE                       13230001
132400     END-IF.                                                      13240001
132500*                                                                 13250001
132600*----------------------------------------------------------------*13260001
132700* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     13270001
132800*----------------------------------------------------------------*13280001
132900 2105-RACF-ACCESS.                                                13290001
133000                                                                  13300001
133100      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  13310001
133200      SET DP008-ACCESS-TYPE-USE          TO TRUE                  13320001
133300                                                                  13330001
133400      EXEC CICS                                                   13340001
133500         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 13350001
133600              COMMAREA (DP008-SECURITY-COMMAREA)                  13360001
133700              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             13370001
133800      END-EXEC                                                    13380001
133900                                                                  13390001
134000      IF DP008-CALL-SUCCESSFUL                                    13400001
134100         IF DP008-ACCESS-ALLOWED                                  13410001
134200             SET PS-ACCESS-ALLOWED TO TRUE                        13420001
134300         ELSE                                                     13430001
134400             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    13440001
134500             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          13450001
134600             STRING ' SUKCS564- RACF -'  DELIMITED BY SIZE        13460001
134700                    ' DP008-ACCESS-SW- ' DELIMITED BY SIZE        13470001
134800                      DP008-ACCESS-SW    DELIMITED BY SIZE        13480001
134900                    ' RACF ERROR CODE-'  DELIMITED BY SIZE        13490001
135000                      PV-RACF-ERROR-CODE DELIMITED BY SIZE        13500001
135100                                    INTO PV-CICS-MSG-AREA2        13510001
135200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     13520001
135300               TO PV-COMMAREA-LENGTH                              13530001
135400             EXEC CICS                                            13540001
135500                  WRITEQ TD                                       13550001
135600                   QUEUE  ('CSSL')                                13560001
135700                    FROM  (PV-CICS-MSG-AREA2)                     13570001
135800                  LENGTH  (PV-COMMAREA-LENGTH)                    13580001
135900                    RESP  (PV-CICS-RESP)                          13590001
136000             END-EXEC                                             13600001
136100         END-IF                                                   13610001
136200     ELSE                                                         13620001
136300         MOVE ' 2105-RACF-ACCESS' TO DP013-PARAGRAPH              13630001
136400          MOVE 'UNABLE TO ACCESS CICS'                            13640001
136500                               TO DP013-MESSAGE-TEXT (1)          13650001
136600          MOVE SQLCA           TO DP013-SQLCA                     13660001
136700          SET DP013-DB2-ABEND                                     13670001
136800              DP013-XCTL-DISPLAY-RESTART TO TRUE                  13680001
136900          PERFORM DP013-0000-PROCESS-ABEND                        13690001
137000      END-IF.                                                     13700001
137100                                                                  13710001
137200                                                                  13720051
137300*----------------------------------------------------------------*13730001
137400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13740001
137500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13750001
137600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13760001
137700*    MESSAGE.                                                    *13770001
137800*----------------------------------------------------------------*13780001
137900                                                                  13790001
138000 2110-BROWSE-BACKWARD.                                            13800001
138100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13810001
138200         GIVING PV-TOP-ITEM.                                      13820001
138300*                                                                 13830001
138400     IF  ((PV-TOP-ITEM < +1)                                      13840001
138500       OR (PV-TOP-ITEM = +1))                                     13850001
138600         MOVE +1                   TO PV-TOP-ITEM                 13860001
138700*        -- TOP OF LIST --                                        13870001
138800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13880001
138900         SET DP020-MSG-INFORMATIONAL TO TRUE                      13890001
139000     END-IF.                                                      13900001
139100                                                                  13910001
139200                                                                  13920051
139300*----------------------------------------------------------------*13930001
139400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13940001
139500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13950001
139600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13960001
139700*----------------------------------------------------------------*13970001
139800                                                                  13980001
139900 2120-BROWSE-FORWARD.                                             13990001
140000                                                                  14000001
140100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14010001
140200         GIVING PV-TOP-ITEM.                                      14020001
140300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   14030001
140400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14040001
140500                                   TO PV-TOP-ITEM                 14050001
140600*        -- BOTTOM OF LIST --                                     14060001
140700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14070001
140800         SET DP020-MSG-INFORMATIONAL                              14080001
140900                                   TO TRUE                        14090001
141000     ELSE                                                         14100001
141100         COMPUTE PV-BOTTOM-ITEM =                                 14110001
141200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14120001
141300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14130001
141400*            -- BOTTOM OF LIST --                                 14140001
141500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14150001
141600             SET DP020-MSG-INFORMATIONAL                          14160001
141700                                   TO TRUE                        14170001
141800         END-IF                                                   14180001
141900     END-IF.                                                      14190001
142000                                                                  14200051
142100                                                                  14210001
142200 2110-GET-NEXT-MESSAGE.                                           14220001
142300     ADD +1                        TO ASC-SEL-SUB.                14230001
142400     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            14240001
142500         ADD +1                    TO ASC-SEL-ITEM                14250001
142600         MOVE +1                   TO ASC-SEL-SUB                 14260001
142700     END-IF.                                                      14270001
142800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                14280001
142900         PERFORM 9100-READ-SEL-QUEUE                              14290001
143000         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      14300001
143100             MOVE SU010-DOOR-ID (ASC-SEL-SUB) TO ASC-DOOR-ID      14310001
143200             MOVE SU010-DOOR-TYPE (ASC-SEL-SUB) TO ASC-DOOR-TYPE  14320001
143300             MOVE SU010-DESCRIPTION (ASC-SEL-SUB) TO              14330001
143400                                                   ASC-DOOR-DESC  14340001
143500             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)  TO            14350001
143600                                                 ASC-TRLR-SRL-NMBR14360001
143700             MOVE SU010-TRIP-ID (ASC-SEL-SUB) TO                  14370001
143800                                             ASC-OUTBOUND-TRIP-ID 14380001
143900             MOVE SU010-STAT-DATE (ASC-SEL-SUB)                   14390001
144000                                               TO ASC-STATUS-DATE 14400001
144100             MOVE SU010-DEST-NBR (ASC-SEL-SUB) TO ASC-STR-NBR     14410001
144200                                                                  14420001
144300             SET SU010-INQ (ASC-SEL-SUB)                          14430001
144400                                   TO TRUE                        14440001
144500             PERFORM 9200-REWRITE-SEL-QUEUE                       14450001
144600         ELSE                                                     14460001
144700             SUBTRACT +1 FROM ASC-SEL-SUB                         14470001
144800*            --- BOTTOM OF LIST ---                               14480001
144900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14490001
145000             SET DP020-MSG-INFORMATIONAL                          14500001
145100                                   TO TRUE                        14510001
145200         END-IF                                                   14520001
145300     ELSE                                                         14530001
145400         SUBTRACT +1 FROM ASC-SEL-ITEM                            14540001
145500         MOVE SU010-MAX-ITEMS      TO ASC-SEL-SUB                 14550001
145600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14560001
145700         SET DP020-MSG-INFORMATIONAL                              14570001
145800                                   TO TRUE                        14580001
145900     END-IF.                                                      14590001
146000 2120-GET-PREV-MESSAGE.                                           14600001
146100     SUBTRACT +1 FROM ASC-SEL-SUB.                                14610001
146200     IF  ASC-SEL-SUB < +1                                         14620001
146300         SUBTRACT +1 FROM ASC-SEL-ITEM                            14630001
146400         MOVE SU010-MAX-ITEMS      TO ASC-SEL-SUB                 14640001
146500     END-IF.                                                      14650001
146600*                                                                 14660001
146700     IF  ASC-SEL-ITEM > ZERO                                      14670001
146800         PERFORM 9100-READ-SEL-QUEUE                              14680001
146900             MOVE SU010-DOOR-ID (ASC-SEL-SUB) TO ASC-DOOR-ID      14690001
147000             MOVE SU010-DOOR-TYPE (ASC-SEL-SUB) TO ASC-DOOR-TYPE  14700001
147100             MOVE SU010-DESCRIPTION (ASC-SEL-SUB) TO              14710001
147200                                                   ASC-DOOR-DESC  14720001
147300             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)  TO            14730001
147400                                                 ASC-TRLR-SRL-NMBR14740001
147500             MOVE SU010-TRIP-ID (ASC-SEL-SUB) TO                  14750001
147600                                             ASC-OUTBOUND-TRIP-ID 14760001
147700             MOVE SU010-STAT-DATE (ASC-SEL-SUB)                   14770001
147800                                               TO ASC-STATUS-DATE 14780001
147900             MOVE SU010-DEST-NBR (ASC-SEL-SUB) TO ASC-STR-NBR     14790001
148000             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  14800001
148100             PERFORM 9200-REWRITE-SEL-QUEUE                       14810001
148200                                                                  14820001
148300     ELSE                                                         14830001
148400         MOVE +1                   TO ASC-SEL-ITEM                14840001
148500                                      ASC-SEL-SUB                 14850001
148600*        --- TOP OF LIST ---                                      14860001
148700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14870001
148800         SET DP020-MSG-INFORMATIONAL                              14880001
148900                                   TO TRUE                        14890001
149000     END-IF.                                                      14900001
149100*----------------------------------------------------------------*14910001
149200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14920001
149300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14930001
149400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14940001
149500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14950001
149600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14960001
149700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14970001
149800*----------------------------------------------------------------*14980001
149900                                                                  14990001
150000 2130-CHECK-FOR-JUMP-BROWSE.                                      15000001
150100     SET PS-NO-ERROR               TO TRUE.                       15010001
150200     IF (ASC-START-ITEM-REQUEST = SPACE)                          15020001
150300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15030001
150400                                   TO PV-TOP-ITEM                 15040001
150500     ELSE                                                         15050001
150600         MOVE ASC-START-ITEM-REQUEST                              15060001
150700                                   TO DP010I-UNEDITED-FIELD       15070001
150800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15080001
150900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15090001
151000         SET DP010I-NEGATIVE-NOT-ALLOWED                          15100001
151100                                   TO TRUE                        15110001
151200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15120051
151210              USING DP010I-NUMERIC-EDIT-AREA                      15121051
151300                                                                  15130001
151400         IF  NOT DP010I-ERROR-DETECTED                            15140001
151500             MOVE DP010I-NUMERIC-FIELD                            15150001
151600                                   TO  ASC-START-ITEM-REQUEST-N   15160001
151700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  15170001
151800                 IF  ASC-START-ITEM-REQUEST-N >                   15180001
151900                                          ASC-NUMBER-OF-ITEMS-READ15190001
152000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         15200001
152100                     COMPUTE PV-TOP-ITEM =                        15210001
152200                             ASC-NUMBER-OF-ITEMS-READ             15220001
152300                             - PC-ITEMS-PER-PANEL + 1             15230001
152400                     IF  PV-TOP-ITEM < +1                         15240001
152500                         MOVE +1   TO PV-TOP-ITEM                 15250001
152600                         MOVE PC-TSYMSG-00070                     15260001
152700                                   TO DP020-MSG-NUMBER            15270001
152800                         SET DP020-MSG-INFORMATIONAL              15280001
152900                                   TO TRUE                        15290001
153000                     ELSE                                         15300001
153100                         MOVE  PV-TOP-ITEM                        15310001
153200                                      TO  ASC-START-ITEM-REQUEST-N15320001
153300                     END-IF                                       15330001
153400                 ELSE                                             15340001
153500                     MOVE ASC-START-ITEM-REQUEST-N                15350001
153600                                   TO PV-TOP-ITEM                 15360001
153700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      15370001
153800                     COMPUTE PV-BOTTOM-ITEM =                     15380001
153900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     15390001
154000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ15400001
154100                          SUBTRACT  PV-TOP-ITEM                   15410001
154200                              FROM  ASC-NUMBER-OF-ITEMS-READ      15420001
154300                            GIVING  ASC-ITEMS-DISPLAYED           15430001
154400                          MOVE  ASC-NUMBER-OF-ITEMS-READ          15440001
154500                            TO  PV-BOTTOM-ITEM                    15450001
154600*                        -- BOTTOM OF LIST --                     15460001
154700                         MOVE PC-TSYMSG-00070                     15470001
154800                                   TO DP020-MSG-NUMBER            15480001
154900                         SET DP020-MSG-INFORMATIONAL              15490001
155000                                   TO TRUE                        15500001
155100                     END-IF                                       15510001
155200                 END-IF                                           15520001
155300             ELSE                                                 15530001
155400*                --- VALUE OUT OF RANGE ----                      15540001
155500                 MOVE PC-TSYMSG-00101                             15550001
155600                                   TO DP020-MSG-NUMBER            15560001
155700                 MOVE -1           TO ASTRTITL                    15570001
155800                 SET DP030-SET-CURSOR-APPL-1                      15580001
155900                                   TO TRUE                        15590001
156000                 MOVE DP015-REVERSE                               15600001
156100                                   TO ASTRTITH                    15610001
156200                 MOVE DP015-RED    TO ASTRTITC                    15620001
156300                 MOVE DP015-UNP-NUM-BRT-MDT                       15630001
156400                                   TO ASTRTITA                    15640001
156500                 SET DP020-MSG-FATAL                              15650001
156600                                   TO TRUE                        15660001
156700                 SET PS-ERROR      TO TRUE                        15670001
156800             END-IF                                               15680001
156900                                                                  15690001
157000         ELSE                                                     15700001
157100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15710001
157200             MOVE -1               TO ASTRTITL                    15720001
157300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15730001
157400             MOVE DP015-REVERSE    TO ASTRTITH                    15740001
157500             MOVE DP015-RED        TO ASTRTITC                    15750001
157600             MOVE DP015-UNP-NUM-BRT-MDT                           15760001
157700                                   TO ASTRTITA                    15770001
157800             SET DP020-MSG-FATAL   TO TRUE                        15780001
157900             SET PS-ERROR          TO TRUE                        15790001
158000         END-IF                                                   15800001
158100     END-IF.                                                      15810001
158200                                                                  15820051
158300*----------------------------------------------------------------*15830001
158400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *15840001
158500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *15850001
158600*----------------------------------------------------------------*15860001
158700 2140-DESELECT-ALL-ITEMS.                                         15870001
158800     MOVE +1                       TO ASC-BLK-SUB.                15880001
158900                                                                  15890001
159000     PERFORM 2141-CLEAR-SELECTED-INDS                             15900001
159100         VARYING ASC-ITEM-SUB                                     15910001
159200         FROM 1 BY 1                                              15920001
159300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15930001
159400                                                                  15940001
159500     ADD +1                        TO ASC-BLK-SUB.                15950001
159600                                                                  15960001
159700     PERFORM 2141-CLEAR-SELECTED-INDS                             15970001
159800         VARYING ASC-ITEM-SUB                                     15980001
159900         FROM 1 BY 1                                              15990001
160000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16000001
160100                                                                  16010001
160200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16020001
160300                                   TO PV-LIST-ITEM-NUMBER.        16030001
160400                                                                  16040001
160500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16050001
160600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16060001
160700                                                                  16070001
160800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16080001
160900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16090001
161000         MOVE +1                   TO ASC-BLK-SUB                 16100001
161100                                                                  16110001
161200         PERFORM 5100-WRITE-TEMP-STORAGE                          16120001
161300                                                                  16130001
161400         MOVE +1                   TO PV-BLOCK-NUMBER             16140001
161500                                                                  16150001
161600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16160001
161700             PV-FIRST-BLOCK-IN-ARRAY - 1                          16170001
161800                                                                  16180001
161900         PERFORM                                                  16190001
162000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16200001
162100                                                                  16210001
162200             PERFORM 4410-READ-TEMP-STORAGE                       16220001
162300                                                                  16230001
162400             PERFORM 2141-CLEAR-SELECTED-INDS                     16240001
162500                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16250001
162600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16260001
162700                                                                  16270001
162800             PERFORM 5100-WRITE-TEMP-STORAGE                      16280001
162900                                                                  16290001
163000             ADD +1                TO PV-BLOCK-NUMBER             16300001
163100                                                                  16310001
163200         END-PERFORM                                              16320001
163300                                                                  16330001
163400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16340001
163500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16350001
163600                                                                  16360001
163700         PERFORM                                                  16370001
163800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16380001
163900                   ASC-HIGHEST-BLOCK-WRITTEN                      16390001
164000                                                                  16400001
164100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16410001
164200                                   TO PV-BLOCK-NUMBER             16420001
164300                                                                  16430001
164400             PERFORM 4410-READ-TEMP-STORAGE                       16440001
164500                                                                  16450001
164600             PERFORM 2141-CLEAR-SELECTED-INDS                     16460001
164700                 VARYING ASC-ITEM-SUB                             16470001
164800                 FROM 1 BY 1                                      16480001
164900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16490001
165000                                                                  16500001
165100             PERFORM 5100-WRITE-TEMP-STORAGE                      16510001
165200                                                                  16520001
165300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16530001
165400                                                                  16540001
165500         END-PERFORM                                              16550001
165600                                                                  16560001
165700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16570001
165800                                   TO PV-BLOCK-NUMBER             16580001
165900                                                                  16590001
166000         PERFORM 4410-READ-TEMP-STORAGE                           16600001
166100     END-IF.                                                      16610001
166200                                                                  16620001
166300                                                                  16630001
166400     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 16640001
166500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.16650001
166600     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  16660001
166700                                                                  16670001
166800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16680001
166900                                                                  16690001
167000                                                                  16700051
167100*----------------------------------------------------------------*16710001
167200*    MARK EACH ITEM AS BEING NOT SELECTED.                       *16720001
167300*----------------------------------------------------------------*16730001
167400                                                                  16740001
167500 2141-CLEAR-SELECTED-INDS.                                        16750001
167600                                                                  16760001
167700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16770001
167800             NOT EQUAL ZERO                                       16780001
167900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16790001
168000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16800001
168100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    16810001
168200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16820001
168300                                   TO TRUE                        16830001
168400         END-IF                                                   16840001
168500     END-IF.                                                      16850001
168600                                                                  16860001
168700                                                                  16870051
168800*----------------------------------------------------------------*16880001
168900*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *16890001
169000*  FOR ALL ITEMS.                                                *16900001
169100*----------------------------------------------------------------*16910001
169200                                                                  16920001
169300 2150-SELECT-ALL-ITEMS.                                           16930001
169400                                                                  16940001
169500     MOVE +1                       TO ASC-BLK-SUB.                16950001
169600                                                                  16960001
169700     PERFORM 2151-SET-SELECTED-INDS                               16970001
169800         VARYING ASC-ITEM-SUB                                     16980001
169900         FROM 1 BY 1                                              16990001
170000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17000001
170100                                                                  17010001
170200     ADD +1                        TO ASC-BLK-SUB.                17020001
170300                                                                  17030001
170400     PERFORM 2151-SET-SELECTED-INDS                               17040001
170500         VARYING ASC-ITEM-SUB                                     17050001
170600         FROM 1 BY 1                                              17060001
170700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17070001
170800                                                                  17080001
170900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17090001
171000                                   TO PV-LIST-ITEM-NUMBER.        17100001
171100                                                                  17110001
171200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17120001
171300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17130001
171400                                                                  17140001
171500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17150001
171600        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    17160001
171700         MOVE +1                   TO ASC-BLK-SUB                 17170001
171800                                                                  17180001
171900         PERFORM 5100-WRITE-TEMP-STORAGE                          17190001
172000                                                                  17200001
172100         MOVE +1                   TO PV-BLOCK-NUMBER             17210001
172200                                                                  17220001
172300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17230001
172400             PV-FIRST-BLOCK-IN-ARRAY - 1                          17240001
172500                                                                  17250001
172600         PERFORM                                                  17260001
172700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17270001
172800                                                                  17280001
172900             PERFORM 4410-READ-TEMP-STORAGE                       17290001
173000                                                                  17300001
173100             PERFORM 2151-SET-SELECTED-INDS                       17310001
173200                 VARYING ASC-ITEM-SUB                             17320001
173300                 FROM 1 BY 1                                      17330001
173400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17340001
173500                                                                  17350001
173600             PERFORM 5100-WRITE-TEMP-STORAGE                      17360001
173700                                                                  17370001
173800             ADD +1                TO PV-BLOCK-NUMBER             17380001
173900                                                                  17390001
174000         END-PERFORM                                              17400001
174100                                                                  17410001
174200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17420001
174300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17430001
174400                                                                  17440001
174500         PERFORM                                                  17450001
174600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17460001
174700                   ASC-HIGHEST-BLOCK-WRITTEN                      17470001
174800                                                                  17480001
174900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17490001
175000                                   TO PV-BLOCK-NUMBER             17500001
175100                                                                  17510001
175200             PERFORM 4410-READ-TEMP-STORAGE                       17520001
175300                                                                  17530001
175400             PERFORM 2151-SET-SELECTED-INDS                       17540001
175500                 VARYING ASC-ITEM-SUB                             17550001
175600                 FROM 1 BY 1                                      17560001
175700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17570001
175800                                                                  17580001
175900             PERFORM 5100-WRITE-TEMP-STORAGE                      17590001
176000                                                                  17600001
176100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17610001
176200                                                                  17620001
176300         END-PERFORM                                              17630001
176400                                                                  17640001
176500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17650001
176600                                   TO PV-BLOCK-NUMBER             17660001
176700                                                                  17670001
176800         PERFORM 4410-READ-TEMP-STORAGE                           17680001
176900     END-IF.                                                      17690001
177000                                                                  17700001
177100                                                                  17710001
177200     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             17720001
177300                       ASC-NUMBER-OF-SELECTED-ITEMS.              17730001
177400                                                                  17740001
177500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17750001
177600                                                                  17760001
177700                                                                  17770051
177800*----------------------------------------------------------------*17780001
177900*    MARK EACH ITEM AS BEING SELECTED.                           *17790001
178000*----------------------------------------------------------------*17800001
178100                                                                  17810001
178200 2151-SET-SELECTED-INDS.                                          17820001
178300                                                                  17830001
178400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17840001
178500             NOT EQUAL ZERO                                       17850001
178600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17860001
178700             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17870001
178800                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        17880001
178900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17890001
179000                               TO  TRUE                           17900001
179100         END-IF                                                   17910001
179200     END-IF.                                                      17920001
179300******************************************************************17930001
179400** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **17940001
179500** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **17950001
179600******************************************************************17960001
179700 2200-MOVE-SCREEN-TO-COMMAREA.                                    17970001
179800                                                                  17980001
179900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             17990001
180000     MOVE +1                       TO PV-SUB.                     18000001
180100*                                                                 18010001
180200     PERFORM 3100-SET-SUBSCRIPTS.                                 18020001
180300     IF  ASTRTITL > ZERO                                          18030001
180400         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          18040001
180500     ELSE                                                         18050001
180600         IF  ASTRTITF = DP015-ERASE-EOF                           18060001
180700             INITIALIZE ASC-START-ITEM-REQUEST                    18070001
180800         END-IF                                                   18080001
180900     END-IF.                                                      18090001
181000     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18100001
181100         VARYING PV-SUB                                           18110001
181200         FROM 1 BY 1                                              18120001
181300         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      18130001
181400******************************************************************18140001
181500** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**18150001
181600******************************************************************18160001
181700 2210-MOVE-LINES-TO-COMMAREA.                                     18170001
181800     IF  MR-SELECTL (PV-SUB) > ZERO                               18180001
181900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18190001
182000         MOVE MR-SELECTI (PV-SUB)                                 18200001
182100                                   TO ASC-TEMP-SELECTED-SW        18210001
182200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18220001
182300     ELSE                                                         18230001
182400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                18240001
182500                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     18250001
182600                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        18260001
182700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18270001
182800         END-IF                                                   18280001
182900     END-IF.                                                      18290001
183000     ADD +1                        TO ASC-ITEM-SUB.               18300001
183100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        18310001
183200          IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                    18320001
183300              COMPUTE PV-BLOCK-NUMBER  =                          18330001
183400                 1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /        18340001
183500                     PC-ITEMS-PER-PANEL                           18350001
183600              PERFORM 5105-REWRITE-ASC-LISTQ                      18360001
183700          END-IF                                                  18370001
183800          ADD +1                    TO ASC-BLK-SUB                18380001
183900          MOVE +1                   TO ASC-ITEM-SUB               18390001
184000      ELSE                                                        18400001
184100          IF  PV-SUB = ASC-ITEMS-DISPLAYED                        18410001
184200              IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                18420001
184300                  COMPUTE PV-BLOCK-NUMBER  =                      18430001
184400                     1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /    18440001
184500                         PC-ITEMS-PER-PANEL                       18450001
184600                  PERFORM 5105-REWRITE-ASC-LISTQ                  18460001
184700              END-IF                                              18470001
184800         END-IF                                                   18480001
184900     END-IF.                                                      18490001
185000                                                                  18500001
185500******************************************************************18550001
185600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **18560001
185700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **18570001
185800******************************************************************18580001
185900 3000-EDIT-DATA-IN-COMMAREA.                                      18590001
186000     SET PS-NO-ERROR               TO TRUE.                       18600001
186100     PERFORM 3200-RESET-ATTRIBUTES.                               18610001
186200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18620001
186300**                                                                18630001
186400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              18640001
186500* EDITTING IS DONE FROM THE BOTTOM UP.                            18650001
186600**                                                                18660001
186700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       18670001
186800         ASC-ITEMS-DISPLAYED - 1.                                 18680001
186900     PERFORM 3100-SET-SUBSCRIPTS.                                 18690001
187000     PERFORM 3300-EDIT-SELECTIONS                                 18700001
187100         VARYING PV-SUB                                           18710001
187200         FROM PV-SUB BY -1                                        18720001
187300         UNTIL PV-SUB < +1                                        18730001
187400*                                                                 18740001
187500     IF  PS-NO-ERROR                                              18750001
187600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18760001
187700     END-IF.                                                      18770001
187800*                                                                 18780001
187900     IF  ((PS-NO-ERROR)                                           18790001
188000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18800001
188100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18810001
188200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18820001
188300     END-IF.                                                      18830001
188400                                                                  18840051
188500*----------------------------------------------------------------*18850001
188600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18860001
188700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18870001
188800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18880001
188900*                                                                *18890001
189000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18900001
189100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18910001
189200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18920001
189300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18930001
189400*----------------------------------------------------------------*18940001
189500                                                                  18950001
189600 3100-SET-SUBSCRIPTS.                                             18960001
189700                                                                  18970001
189800     COMPUTE ASC-ITEM-SUB =                                       18980001
189900         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18990001
190000                                                                  19000001
190100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19010001
190200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19020001
190300                                                                  19030001
190400         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               19040001
190500     ELSE                                                         19050001
190600         MOVE +1                     TO ASC-BLK-SUB               19060001
190700     END-IF.                                                      19070001
190800******************************************************************19080001
190900** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **19090001
191000******************************************************************19100001
191100                                                                  19110001
191200 3200-RESET-ATTRIBUTES.                                           19120001
191300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   19130001
191400     MOVE DP015-GREEN              TO ASTRTITC.                   19140001
191500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   19150001
191600*                                                                 19160001
191700     PERFORM                                                      19170001
191800         VARYING PV-SUB                                           19180001
191900         FROM 1 BY 1                                              19190001
192000         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        19200001
192100         MOVE DP015-UNP-ALP-NOR-OFF                               19210001
192200                                   TO MR-SELECTA (PV-SUB)         19220001
192300         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         19230001
192400         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         19240001
192500     END-PERFORM.                                                 19250001
192600                                                                  19260001
192700******************************************************************19270001
192800** CHANGE THE ATTRIBUTES OF ROWS WITH MISSING DATA.               19280001
192900******************************************************************19290001
193000 3250-CHANGE-ATTRIBUTES.                                          19300001
193100     MOVE DP015-YELLOW        TO    MR-SMLC (PV-SUB)              19310001
193200                                    MR-DEST-NBRC (PV-SUB)         19320001
193300                                    MR-CREATEC (PV-SUB)           19330001
193400                                    MR-PO-RCVRC (PV-SUB)          19340001
193500                                    MR-LOAD-STATUSC (PV-SUB)      19350001
193600                                    MR-ACTV-CDEC (PV-SUB)         19360001
193700                                    MR-STAT-DATEC (PV-SUB)        19370001
193800                                    MR-STAT-TIMEC (PV-SUB)        19380001
193900                                    MR-TRLR-SRL-NBRC (PV-SUB).    19390001
194000                                                                  19400001
194100******************************************************************19410001
194200** CHANGE THE ATTRIBUTES BACK OF ROWS WITH DATA.                  19420001
194300******************************************************************19430001
194400 3255-CHANGE-ATTRIBUTES-BACK.                                     19440001
194500     MOVE DP015-BLUE          TO    MR-SMLC (PV-SUB)              19450001
194600                                    MR-DEST-NBRC (PV-SUB)         19460001
194700                                    MR-CREATEC (PV-SUB)           19470001
194800                                    MR-PO-RCVRC (PV-SUB)          19480001
194900                                    MR-LOAD-STATUSC (PV-SUB)      19490001
195000                                    MR-ACTV-CDEC (PV-SUB)         19500001
195100                                    MR-STAT-DATEC (PV-SUB)        19510001
195200                                    MR-STAT-TIMEC (PV-SUB)        19520001
195300                                    MR-TRLR-SRL-NBRC (PV-SUB).    19530001
195400                                                                  19540001
195500                                                                  19550001
195600                                                                  19560001
195700******************************************************************19570001
195800** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **19580001
195900** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **19590001
196000** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **19600001
196100** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **19610001
196200******************************************************************19620001
196300 3300-EDIT-SELECTIONS.                                            19630001
196400     EVALUATE TRUE                                                19640001
196500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19650001
196600             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         19660001
196700                 CONTINUE                                         19670001
196800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         19680001
196900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19690001
197000                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   19700001
197100                 MOVE ASC-TEMP-SELECTED-SW                        19710001
197200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19720001
197300                                TO ASC-SELECTED-SW                19730001
197400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19740001
197500             END-IF                                               19750001
197600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19760001
197700                 = SPACE                                          19770001
197800             EVALUATE TRUE                                        19780001
197900                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19790001
198000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19800001
198100                     MOVE SPACE TO ASC-SELECTED-SW                19810001
198200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19820001
198300                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19830001
198400                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    19840001
198500                     MOVE SPACE TO ASC-SELECTED-SW                19850001
198600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19860001
198700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19870001
198800                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      19880001
198900                     MOVE SPACE TO ASC-SELECTED-SW                19890001
199000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19900001
199100             END-EVALUATE                                         19910001
199200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19920001
199300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19930001
199400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19940001
199500             END-IF                                               19950001
199600             PERFORM 3310-EDIT-RANGE                              19960001
199700         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19970001
199800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19980001
199900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19990001
200000             END-IF                                               20000001
200100             PERFORM 3310-EDIT-RANGE                              20010001
200200         WHEN OTHER                                               20020001
200300             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           20030001
200400             SET DP020-MSG-FATAL    TO TRUE                       20040001
200500             MOVE -1                TO MR-SELECTL (PV-SUB)        20050001
200600             SET DP030-SET-CURSOR-APPL-1                          20060001
200700                                    TO TRUE                       20070001
200800             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        20080001
200900             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        20090001
201000             SET PS-ERROR TO TRUE                                 20100001
201100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20110001
201200                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     20120001
201300                 MOVE SPACE         TO ASC-SELECTED-SW            20130001
201400                                        (ASC-BLK-SUB ASC-ITEM-SUB)20140001
201500             END-IF                                               20150001
201600     END-EVALUATE.                                                20160001
201700                                                                  20170001
201800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 20180001
201900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               20190001
202000     IF  ASC-ITEM-SUB < 1                                         20200001
202100         SUBTRACT +1 FROM ASC-BLK-SUB                             20210001
202200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                20220001
202300     END-IF.                                                      20230001
202400******************************************************************20240001
202500** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20250001
202600** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20260001
202700** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20270001
202800** THE ENDING.                                                  **20280001
202900******************************************************************20290001
203000 3310-EDIT-RANGE.                                                 20300001
203100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20310001
203200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20320001
203300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20330001
203400                                   TO ASC-SELECTED-SW             20340001
203500                                        (ASC-BLK-SUB ASC-ITEM-SUB)20350001
203600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20360001
203700         ELSE                                                     20370001
203800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20380001
203900                 CONTINUE                                         20390001
204000             ELSE                                                 20400001
204100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20410001
204200                 MOVE PC-TSYMSG-00054                             20420001
204300                                   TO DP020-MSG-NUMBER            20430001
204400                 SET DP020-MSG-FATAL                              20440001
204500                                   TO TRUE                        20450001
204600                 MOVE -1           TO MR-SELECTL (PV-SUB)         20460001
204700                 SET DP030-SET-CURSOR-APPL-1                      20470001
204800                                   TO TRUE                        20480001
204900                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20490001
205000                 MOVE DP015-UNDERLINE                             20500001
205100                                   TO MR-SELECTH (PV-SUB)         20510001
205200                 SET PS-ERROR      TO TRUE                        20520001
205300             END-IF                                               20530001
205400         END-IF                                                   20540001
205500     ELSE                                                         20550001
205600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20560001
205700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20570001
205800                                   TO ASC-SELECTED-SW             20580001
205900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20590001
206000             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20600001
206100         ELSE                                                     20610001
206200             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20620001
206300                 CONTINUE                                         20630001
206400             ELSE                                                 20640001
206500*                -- ONLY ONE END-OF-RANGE ALLOWED --              20650001
206600                 MOVE PC-TSYMSG-00055                             20660001
206700                                   TO DP020-MSG-NUMBER            20670001
206800                 SET DP020-MSG-FATAL                              20680001
206900                                   TO TRUE                        20690001
207000                 MOVE -1           TO MR-SELECTL (PV-SUB)         20700001
207100                 SET DP030-SET-CURSOR-APPL-1                      20710001
207200                                   TO TRUE                        20720001
207300                 SET PS-ERROR      TO TRUE                        20730001
207400             END-IF                                               20740001
207500         END-IF                                                   20750001
207600     END-IF.                                                      20760001
207700*                                                                 20770001
207800******************************************************************20780001
207900** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20790001
208000** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20800001
208100******************************************************************20810001
208200 3400-CHECK-RANGE-SEQUENCE.                                       20820001
208300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20830001
208400       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20840001
208500       AND  ASC-START-OF-SELECTED-RANGE >                         20850001
208600                                         ASC-END-OF-SELECTED-RANGE20860001
208700*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20870001
208800         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20880001
208900         SET DP020-MSG-FATAL TO TRUE                              20890001
209000         SET PS-ERROR TO TRUE                                     20900001
209100         PERFORM 3410-POSITION-AT-ERROR                           20910001
209200     END-IF.                                                      20920001
209300******************************************************************20930001
209400** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20940001
209500** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20950001
209600** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20960001
209700******************************************************************20970001
209800 3410-POSITION-AT-ERROR.                                          20980001
209900     SET DP030-SET-CURSOR-APPL-1                                  20990001
210000                                   TO TRUE.                       21000001
210100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 21010001
210200                    - PV-TOP-ITEM + 1.                            21020001
210300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21030001
210400         CONTINUE                                                 21040001
210500     ELSE                                                         21050001
210600         MOVE -1                   TO MR-SELECTL (PV-SUB)         21060001
210700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21070001
210800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21080001
210900     END-IF.                                                      21090001
211000*                                                                 21100001
211100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   21110001
211200                    - PV-TOP-ITEM + 1.                            21120001
211300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21130001
211400         CONTINUE                                                 21140001
211500     ELSE                                                         21150001
211600         MOVE -1                   TO MR-SELECTL (PV-SUB)         21160001
211700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21170001
211800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21180001
211900     END-IF.                                                      21190001
212000                                                                  21200051
212100*----------------------------------------------------------------*21210001
212200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21220001
212300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21230001
212400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21240001
212500*----------------------------------------------------------------*21250001
212600                                                                  21260001
212700 3500-MARK-RANGE-AS-SELECTED.                                     21270001
212800     MOVE +1                       TO  ASC-BLK-SUB.               21280001
212900     PERFORM 3510-MARK-SELECTED-INDS                              21290001
213000         VARYING ASC-ITEM-SUB                                     21300001
213100         FROM 1 BY 1                                              21310001
213200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21320001
213300                                                                  21330001
213400     ADD +1                        TO ASC-BLK-SUB.                21340001
213500     PERFORM 3510-MARK-SELECTED-INDS                              21350001
213600         VARYING ASC-ITEM-SUB                                     21360001
213700         FROM 1 BY 1                                              21370001
213800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21380001
213900                                                                  21390001
214000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21400001
214100                                   TO  PV-LIST-ITEM-NUMBER.       21410001
214200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21420001
214300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21430001
214400               PC-ITEMS-PER-PANEL).                               21440001
214500                                                                  21450001
214600     MOVE ASC-START-OF-SELECTED-RANGE                             21460001
214700                                   TO PV-START-OF-SELECTED-RANGE. 21470001
214800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21480001
214900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21490001
215000               PC-ITEMS-PER-PANEL).                               21500001
215100                                                                  21510001
215200     MOVE ASC-END-OF-SELECTED-RANGE                               21520001
215300                                   TO  PV-END-OF-SELECTED-RANGE.  21530001
215400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21540001
215500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21550001
215600               PC-ITEMS-PER-PANEL).                               21560001
215700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21570001
215800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21580001
215900                                                                  21590001
216000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21600001
216100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21610001
216200         MOVE +1                   TO ASC-BLK-SUB                 21620001
216300         PERFORM 5100-WRITE-TEMP-STORAGE                          21630001
216400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21640001
216500             PV-FIRST-BLOCK-IN-ARRAY - 1                          21650001
216600                                                                  21660001
216700         PERFORM                                                  21670001
216800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21680001
216900                   PV-PREV-BLOCK-IN-ARRAY                         21690001
217000             MOVE PV-FIRST-BLOCK-IN-RANGE                         21700001
217100                                   TO PV-BLOCK-NUMBER             21710001
217200             PERFORM 4410-READ-TEMP-STORAGE                       21720001
217300             PERFORM 3510-MARK-SELECTED-INDS                      21730001
217400                 VARYING ASC-ITEM-SUB                             21740001
217500                 FROM 1 BY 1                                      21750001
217600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21760001
217700             PERFORM 5100-WRITE-TEMP-STORAGE                      21770001
217800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21780001
217900         END-PERFORM                                              21790001
218000                                                                  21800001
218100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21810001
218200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21820001
218300         PERFORM                                                  21830001
218400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21840001
218500                   PV-LAST-BLOCK-IN-RANGE                         21850001
218600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21860001
218700                                   TO PV-BLOCK-NUMBER             21870001
218800             PERFORM 4410-READ-TEMP-STORAGE                       21880001
218900             PERFORM 3510-MARK-SELECTED-INDS                      21890001
219000                 VARYING ASC-ITEM-SUB                             21900001
219100                 FROM 1 BY 1                                      21910001
219200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21920001
219300             PERFORM 5100-WRITE-TEMP-STORAGE                      21930001
219400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21940001
219500         END-PERFORM                                              21950001
219600                                                                  21960001
219700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21970001
219800                                   TO PV-BLOCK-NUMBER             21980001
219900         PERFORM 4410-READ-TEMP-STORAGE                           21990001
220000     END-IF.                                                      22000001
220100                                                                  22010001
220200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 22020001
220300                                      ASC-END-OF-SELECTED-RANGE.  22030001
220400                                                                  22040001
220500                                                                  22050051
220600*----------------------------------------------------------------*22060001
220700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *22070001
220800*----------------------------------------------------------------*22080001
220900                                                                  22090001
221000 3510-MARK-SELECTED-INDS.                                         22100001
221100                                                                  22110001
221200     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22120001
221300                                ASC-ITEM-SUB) >                   22130001
221400         ASC-START-OF-SELECTED-RANGE)                             22140001
221500     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22150001
221600                                ASC-ITEM-SUB) =                   22160001
221700         ASC-START-OF-SELECTED-RANGE)                             22170001
221800                                                                  22180001
221900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22190001
222000                                    ASC-ITEM-SUB) <               22200001
222100             ASC-END-OF-SELECTED-RANGE)                           22210001
222200         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22220001
222300                                    ASC-ITEM-SUB) =               22230001
222400             ASC-END-OF-SELECTED-RANGE)                           22240001
222500                                                                  22250001
222600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22260001
222700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   22270001
222800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   22280001
222900                               TO TRUE                            22290001
223000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22300001
223100                               TO TRUE                            22310001
223200                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    22320001
223300             END-IF                                               22330001
223400         END-IF                                                   22340001
223500     END-IF.                                                      22350001
223600                                                                  22360051
223700*----------------------------------------------------------------*22370001
223800* RETRIEVE START TMST FOR SML SELECTED.                           22380001
223900*----------------------------------------------------------------*22390001
224000 3600-RETRIEVE-START-TMST.                                        22400001
224100     MOVE SU010-SML (SU010-IDX) TO DK-SML-NBR.                    22410001
224200     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                22420001
224300     EXEC SQL                                                     22430001
224400          SELECT DIVERT_TMST                                      22440001
224500                ,DEST_OPER_UNT_ID                                 22450019
224600            INTO :DK-START-TMST                                   22460001
224700                ,:SUCRDV-DEST-OPER-UNT-ID                         22470020
224800            FROM TSUCRDV                                          22480001
224900           WHERE OPER_UNT_ID     = :DK-OPER-UNT-ID                22490001
225000             AND SHIPT_UNT_ID    = :DK-SML-NBR                    22500001
225100      END-EXEC                                                    22510001
225200                                                                  22520001
225300      EVALUATE TRUE                                               22530001
225400          WHEN SQLCODE = +0                                       22540001
225500              SET  PS-NO-ERROR  TO TRUE                           22550001
225510          WHEN SQLCODE = -811                                     22551044
225511              PERFORM 3603-RETRIEVE-START-TMST-MULT               22551146
225600          WHEN OTHER                                              22560001
225700              MOVE SU010-STAT-DATE(SU010-IDX) TO                  22570001
225800                                      PV-DATE-DISPLAY             22580001
225900              MOVE SU010-STAT-TIME(SU010-IDX) TO                  22590001
226000                                      PV-TIME-DISPLAY             22600001
226100              MOVE PV-DISPLAY-MM    TO  PV-DT-MM                  22610001
226200              MOVE PV-DISPLAY-YY    TO  PV-DT-YY                  22620001
226300              MOVE PV-DISPLAY-DD    TO  PV-DT-DD                  22630001
226400              MOVE PV-DISPLAY-HRS   TO  PV-DT-HRS                 22640001
226500              MOVE PV-DISPLAY-MIN   TO  PV-DT-MIN                 22650001
226600              MOVE PV-DATE-TIME     TO  DK-START-TMST             22660001
226700     END-EVALUATE.                                                22670001
226800                                                                  22680001
226810*----------------------------------------------------------------*22681044
226820* RETRIEVE START TMST WHEN MULTIPLE DIVERTS                       22682044
226830*----------------------------------------------------------------*22683044
226840 3603-RETRIEVE-START-TMST-MULT.                                   22684044
226880     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                22688044
226890     EXEC SQL                                                     22689044
226891          SELECT A.DIVERT_TMST                                    22689148
226892                ,A.DEST_OPER_UNT_ID                               22689248
226893            INTO :DK-START-TMST                                   22689344
226894                ,:SUCRDV-DEST-OPER-UNT-ID                         22689444
226895            FROM TSUCRDV A                                        22689548
226896           WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID            22689648
226897             AND A.SHIPT_UNT_ID      = :DK-SML-NBR                22689748
226898             AND A.DOOR_ID           = :ASC-DOOR-ID               22689848
226899             AND A.DIVERT_TMST  IN                                22689948
226900                 (SELECT MAX(B.DIVERT_TMST)                       22690048
226901                    FROM TSUCRDV B                                22690148
226902                   WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID        22690248
226903                     AND A.DOOR_ID       =  B.DOOR_ID             22690348
226904                     AND A.OPER_UNT_ID   =  B.OPER_UNT_ID         22690448
226905                 )                                                22690548
226906      END-EXEC                                                    22690648
226907                                                                  22690748
226908      EVALUATE TRUE                                               22690848
226909          WHEN SQLCODE = +0                                       22690948
226910              SET  PS-NO-ERROR  TO TRUE                           22691048
226911          WHEN OTHER                                              22691148
226912              MOVE SU010-STAT-DATE(SU010-IDX) TO                  22691248
226913                                      PV-DATE-DISPLAY             22691348
226914              MOVE SU010-STAT-TIME(SU010-IDX) TO                  22691448
226915                                      PV-TIME-DISPLAY             22691548
226916              MOVE PV-DISPLAY-MM    TO  PV-DT-MM                  22691648
226917              MOVE PV-DISPLAY-YY    TO  PV-DT-YY                  22691748
226918              MOVE PV-DISPLAY-DD    TO  PV-DT-DD                  22691848
226919              MOVE PV-DISPLAY-HRS   TO  PV-DT-HRS                 22691948
226920              MOVE PV-DISPLAY-MIN   TO  PV-DT-MIN                 22692048
226921              MOVE PV-DATE-TIME     TO  DK-START-TMST             22692148
226922     END-EVALUATE.                                                22692248
226923                                                                  22692348
226930*----------------------------------------------------------------*22693001
227000* CHECK TO SEE IF THERE ALREADY IS A BEGIN CUTOFF WITHOUT AN     *22700001
227100* ENDING POINT.                                                   22710001
227200*----------------------------------------------------------------*22720001
227300 3610-CHECK-4-BEGIN-CUTOFF.                                       22730001
227400     MOVE ASC-OPEN-OTBND-TRIP   TO DK-OUTBOUND-TRIP-ID.           22740001
227500     MOVE ASC-DOOR-ID           TO DK-DOOR-ID.                    22750001
227600     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                22760001
227700     MOVE ASC-TRIP-DEST-OPER    TO DK-STORE-NUMBER.               22770001
227800     EXEC SQL                                                     22780001
227900          SELECT COUNT(*)                                         22790001
228000            INTO :PV-BEGIN-COUNT                                  22800001
228100            FROM TSUCDOT                                          22810001
228200           WHERE OTBND_TRIP_ID   = :DK-OUTBOUND-TRIP-ID           22820001
228300             AND END_DIVERT_TMST = '9999-09-09-09.09.09.999999'   22830001
228400      END-EXEC                                                    22840001
228500                                                                  22850001
228600      EVALUATE TRUE                                               22860001
228700          WHEN SQLCODE = +0                                       22870001
228800*        IF THERE WERE ANY OTHER TRAILERS ASSIGNED TO THIS DOOR IN22880001
228900*        THE PAST AND OTHER CUTOFFS EXIST, THE EDIT RESULTS ARE   22890001
229000*        VALID                                                    22900001
229100               IF PS-EXISTING-DOOR                                22910001
229200                   IF PV-BEGIN-COUNT > ZERO                       22920001
229300                      SET  PS-ERROR                               22930001
229400                           DP020-MSG-FATAL TO TRUE                22940001
229500                      MOVE PC-TSYMSG-02791 TO DP020-MSG-NUMBER    22950001
229600                   END-IF                                         22960001
229700               END-IF                                             22970001
229800          WHEN OTHER                                              22980001
229900               SET PS-ERROR TO TRUE                               22990001
230000     END-EVALUATE.                                                23000001
230100                                                                  23010001
230200*----------------------------------------------------------------*23020001
230300* CHECK TO SEE IF THERE ARE ANY CARTONS DIVERTED TO THIS TRAILER  23030001
230400* PRIOR TO THE CARTON SELECTED, THAT ARE NOT ASSIGNED TO THE TRLR.23040001
230500* EX:  CARTONS DIVERTED TO TRAILER: 1 2 3 4 5 6 7 8 9 10 11 12 13.23050001
230600* BEGIN DIVERT = 1, END DIVERT = 7.  ASSOCIATE SELECTS CARTON 10  23060001
230700* AS NEXT BEGIN DIVERT.  THIS WOULD BE AN ERROR SINCE CARTONS 8 & 23070001
230800* 9 WERE SKIPPED.  GET MAX END DIVERT TIMESTAMP FOR THIS TRIP.    23080001
230900* IF +0, COUNT # OF CARTONS DIVERTED.  IF > 0, THAT IS AN ERROR.  23090001
231000* IF +100, GET MAX CUTOFF FOR PREVIOUS TRIP, THEN COUNT CARTONS.  23100001
231100*----------------------------------------------------------------*23110001
231200 3620-CHECK-4-PRIOR-CRTNS.                                        23120001
231300     EXEC SQL                                                     23130001
231400          SELECT MAX(END_DIVERT_TMST)                             23140001
231500            INTO :DK-END-TMST                                     23150001
231600            FROM TSUCDOT                                          23160001
231700           WHERE OPER_UNT_ID     = :DK-OPER-UNT-ID                23170001
231800             AND DOOR_ID         = :DK-DOOR-ID                    23180001
231900             AND END_DIVERT_TMST <> '9999-09-09-09.09.09.999999'  23190001
232000      END-EXEC                                                    23200001
232100                                                                  23210001
232200      EVALUATE TRUE                                               23220001
232300          WHEN SQLCODE = +0                                       23230001
232301***                                                               23230132
232303*** DK-END-TMST = LAST END DIVERT MARKED FOR THE DOOR             23230332
232304*** DK-START-TMST = DIVERT TMST FOR THE SELECTED CARTON           23230432
232305***                                                               23230532
232310              IF  DK-END-TMST  >  DK-START-TMST                   23231034
232312                  SET  PS-ERROR                                   23231232
232313                       DP020-MSG-FATAL TO TRUE                    23231332
232314                  MOVE PC-TSYMSG-03663 TO DP020-MSG-NUMBER        23231436
232315                  MOVE DK-END-TMST       TO DP020-MSG-TEXT        23231533
232316             ELSE                                                 23231632
232400                  PERFORM 3630-COUNT-CRTNS-DIVERTED               23240032
232410             END-IF                                               23241032
232500          WHEN SQLCODE = +100                                     23250001
232600               IF ASC-DOOR-TYPE = 'SH'                            23260001
232700                  PERFORM 3640-MAX-TMST-SHIP                      23270001
232800               ELSE                                               23280001
232900                  PERFORM 3645-MAX-TMST-SHTL                      23290001
233000               END-IF                                             23300001
233100          WHEN SQLCODE = -305                                     23310001
233200               MOVE '0001-01-01-00.00.00.000000'                  23320001
233300                                       TO  DK-END-TMST            23330001
233400               PERFORM 3630-COUNT-CRTNS-DIVERTED                  23340001
233500          WHEN OTHER                                              23350001
233600               SET PS-ERROR TO TRUE                               23360001
233700     END-EVALUATE.                                                23370001
233800                                                                  23380001
233900*----------------------------------------------------------------*23390001
234000* COUNT THE NUMBER OF CARTONS DIVERTED BETWEEN THE TRIP END       23400001
234100* DIVERT TIMESTAMP AND THE DIVERT TIMESTAMP OF THE SELECTED CRTNS.23410001
234200*----------------------------------------------------------------*23420001
234300 3630-COUNT-CRTNS-DIVERTED.                                       23430001
234400                                                                  23440001
234500     IF ASC-DOOR-TYPE = 'SH'                                      23450001
234600         EXEC SQL                                                 23460001
234700              SELECT COUNT(*)                                     23470001
234800                INTO :PV-DIVERT-COUNT                             23480001
234900                FROM TSUCRDV A                                    23490001
235000               WHERE A.DIVERT_TMST      >  :DK-END-TMST           23500001
235100                 AND A.DIVERT_TMST      <  :DK-START-TMST         23510001
235200                 AND A.OPER_UNT_ID      =  :DK-OPER-UNT-ID        23520001
235300                 AND A.DOOR_ID          =  :DK-DOOR-ID            23530001
235400                 AND A.DEST_OPER_UNT_ID =  :DK-STORE-NUMBER       23540001
235500                 AND A.SHIPT_UNT_ID     <> :DK-SML-NBR            23550001
235600                 AND A.ACTV_CDE         =  'A'                    23560001
235700                 AND A.DIVERT_TMST =                              23570001
235800               (SELECT MAX(B.DIVERT_TMST)                         23580001
235900                   FROM TSUCRDV B                                 23590001
236000                   WHERE B.SHIPT_UNT_ID     =   A.SHIPT_UNT_ID    23600026
236100                     AND B.ACTV_CDE         =  'A')               23610001
236200         END-EXEC                                                 23620001
236300     ELSE                                                         23630001
236400         EXEC SQL                                                 23640001
236500               SELECT COUNT(*)                                    23650001
236600                INTO :PV-DIVERT-COUNT                             23660001
236700                FROM TSUCRDV A                                    23670001
236800               WHERE A.DIVERT_TMST   >  :DK-END-TMST              23680001
236900                 AND A.DIVERT_TMST   <  :DK-START-TMST            23690001
237000                 AND A.OPER_UNT_ID   =  :DK-OPER-UNT-ID           23700001
237100                 AND A.DOOR_ID       =  :DK-DOOR-ID               23710001
237200                 AND A.SHIPT_UNT_ID  <> :DK-SML-NBR               23720001
237300                 AND A.ACTV_CDE      =  'A'                       23730001
237400                 AND A.DIVERT_TMST =                              23740001
237500               (SELECT MAX(B.DIVERT_TMST)                         23750001
237600                   FROM TSUCRDV B                                 23760001
237700                   WHERE B.SHIPT_UNT_ID     =   A.SHIPT_UNT_ID    23770026
237800                     AND B.ACTV_CDE         =  'A')               23780001
237900          END-EXEC                                                23790001
238000     END-IF.                                                      23800001
238100                                                                  23810001
238200     EVALUATE TRUE                                                23820001
238300         WHEN SQLCODE = +0                                        23830001
238400             IF PS-BRAND-NEW-DOOR                                 23840001
238500                 PERFORM 3650-INSERT-ROW-TSUCDOT                  23850001
238600             ELSE                                                 23860001
238700                 IF PV-DIVERT-COUNT > 0                           23870001
238711***                                                               23871137
238712*** ADD DISPLAY OF CARTON COUNT INFO IF CARTONS HAVE BEEN         23871237
238713*** MISSED                                                        23871337
238715***                                                               23871537
238722                  MOVE PV-DIVERT-COUNT     TO PV-DISP-DVRT-CNT    23872237
238723                  MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER        23872337
238727                  MOVE DK-SML-NBR          TO PV-DISP-SML         23872737
238728                  MOVE SQLCODE             TO PV-DISP-SQLCODE     23872837
238729                                                                  23872937
238730                  MOVE SPACES TO PV-CICS-MSG-AREA                 23873038
238732                  PERFORM 8000-WRITE-CSSL                         23873238
238733                                                                  23873337
238734                  STRING ' SUKCS564-3630-'                        23873437
238735                         '  DVRT CNT:'     PV-DISP-DVRT-CNT       23873537
238736                         '  OPER:'         PV-DISP-OPER           23873637
238737                         '  DOOR:'         DK-DOOR-ID             23873737
238739                         '  SQL:'          PV-DISP-SQLCODE        23873937
238740                                           DELIMITED BY SIZE      23874037
238741                                     INTO  PV-CICS-MSG-AREA       23874138
238742                  PERFORM 8000-WRITE-CSSL                         23874238
238743                  MOVE SPACES TO PV-CICS-MSG-AREA                 23874338
238744                                                                  23874437
238745                  STRING ' SUKCS564-3630-'                        23874537
238746                         '  START TMST:'   DK-START-TMST          23874637
238748                                           DELIMITED BY SIZE      23874837
238749                                     INTO  PV-CICS-MSG-AREA       23874938
238750                  PERFORM 8000-WRITE-CSSL                         23875038
238751                                                                  23875137
238752                  MOVE SPACES TO PV-CICS-MSG-AREA                 23875238
238753                  STRING ' SUKCS564-3630-'                        23875337
238754                         '  END TMST:'     DK-END-TMST            23875438
238755                         '  SML NBR:'      PV-DISP-SML            23875537
238756                                           DELIMITED BY SIZE      23875637
238757                                     INTO  PV-CICS-MSG-AREA       23875738
238758                  PERFORM 8000-WRITE-CSSL                         23875838
238759                                                                  23875937
238760                  MOVE SPACES TO PV-CICS-MSG-AREA                 23876038
238761                  PERFORM 8000-WRITE-CSSL                         23876138
238762***                                                               23876237
238763*** ADD DISPLAY OF CARTON COUNT INFO IF CARTONS HAVE BEEN         23876337
238764*** MISSED                                                        23876437
238768*** GET NEXT CARTON AND DIVERT DATE - TO BE DISPLAYED IN NEW      23876839
238769*** ERROR MESSAGE - 3729                                          23876939
238770***                                                               23877039
238771                      PERFORM 3635-GET-NEXT-DIVERT                23877139
238772                      MOVE SPACES TO PV-ERROR-INFO                23877240
238773                      MOVE SUCRDV-SHIPT-UNT-ID                    23877340
238774                                          TO PV-ERROR-SML         23877440
238775                      MOVE ' DVRT ON '    TO PV-ERROR-FUNCTION    23877542
238776                      MOVE PV-DIVERT-DATE TO PV-ERROR-DATE        23877640
238777                      MOVE '@'            TO PV-ERROR-AT          23877742
238778                      MOVE PV-DIVERT-TIME TO PV-ERROR-TIME        23877842
238779                      MOVE PC-TSYMSG-03729                        23877942
238780                                          TO DP020-MSG-NUMBER     23878042
238781                      MOVE PV-ERROR-INFO  TO DP020-MSG-TEXT       23878142
238800                      SET  PS-ERROR                               23880001
238900                           DP020-MSG-FATAL TO TRUE                23890001
239100                 ELSE                                             23910001
239200                     PERFORM 3650-INSERT-ROW-TSUCDOT              23920001
239300                 END-IF                                           23930001
239400             END-IF                                               23940001
239500         WHEN OTHER                                               23950001
239600              SET PS-ERROR TO TRUE                                23960001
239700     END-EVALUATE.                                                23970001
239800                                                                  23980001
239801                                                                  23980139
239802*----------------------------------------------------------------*23980239
239804* GET THE NEXT SML AND DIVERT DATE THAT SHOULD BE USED AS THE    *23980439
239805* BEGIN DIVERT CARTON                                            *23980539
239806*----------------------------------------------------------------*23980639
239810 3635-GET-NEXT-DIVERT.                                            23981039
239828     IF ASC-DOOR-TYPE = 'SH'                                      23982840
239829         EXEC SQL                                                 23982940
239830              SELECT                                              23983040
239840                     DATE(A.DIVERT_TMST)                          23984040
239841                   , TIME(A.DIVERT_TMST)                          23984142
239842                   , A.DIVERT_TMST                                23984242
239843                   , SHIPT_UNT_ID                                 23984342
239844                INTO                                              23984442
239845                     :PV-DIVERT-DATE                              23984542
239846                   , :PV-DIVERT-TIME                              23984642
239847                   , :SUCRDV-DIVERT-TMST                          23984742
239848                   , :SUCRDV-SHIPT-UNT-ID                         23984842
239850                FROM TSUCRDV A                                    23985040
239860               WHERE A.DIVERT_TMST      >  :DK-END-TMST           23986040
239870                 AND A.DIVERT_TMST      <  :DK-START-TMST         23987040
239880                 AND A.OPER_UNT_ID      =  :DK-OPER-UNT-ID        23988040
239890                 AND A.DOOR_ID          =  :DK-DOOR-ID            23989040
239891                 AND A.DEST_OPER_UNT_ID =  :DK-STORE-NUMBER       23989140
239892                 AND A.SHIPT_UNT_ID     <> :DK-SML-NBR            23989240
239893                 AND A.ACTV_CDE         =  'A'                    23989340
239894                 AND A.DIVERT_TMST =                              23989440
239895               (SELECT MAX(B.DIVERT_TMST)                         23989540
239896                   FROM TSUCRDV B                                 23989640
239897                   WHERE B.SHIPT_UNT_ID     =   A.SHIPT_UNT_ID    23989740
239898                     AND B.ACTV_CDE         =  'A')               23989840
239899                ORDER BY A.DIVERT_TMST                            23989940
239900                FETCH FIRST 1 ROW ONLY                            23990040
239901         END-EXEC                                                 23990140
239902     ELSE                                                         23990240
239903         EXEC SQL                                                 23990340
239904              SELECT                                              23990440
239905                     DATE(A.DIVERT_TMST)                          23990540
239906                   , A.DIVERT_TMST                                23990640
239907                   , SHIPT_UNT_ID                                 23990740
239909                INTO                                              23990940
239910                     :PV-DIVERT-DATE                              23991040
239911                   , :SUCRDV-DIVERT-TMST                          23991140
239912                   , :SUCRDV-SHIPT-UNT-ID                         23991240
239913                FROM TSUCRDV A                                    23991340
239914               WHERE A.DIVERT_TMST   >  :DK-END-TMST              23991440
239915                 AND A.DIVERT_TMST   <  :DK-START-TMST            23991540
239916                 AND A.OPER_UNT_ID   =  :DK-OPER-UNT-ID           23991640
239917                 AND A.DOOR_ID       =  :DK-DOOR-ID               23991740
239918                 AND A.SHIPT_UNT_ID  <> :DK-SML-NBR               23991840
239919                 AND A.ACTV_CDE      =  'A'                       23991940
239920                 AND A.DIVERT_TMST =                              23992040
239921               (SELECT MAX(B.DIVERT_TMST)                         23992140
239922                   FROM TSUCRDV B                                 23992240
239923                   WHERE B.SHIPT_UNT_ID     =   A.SHIPT_UNT_ID    23992340
239924                     AND B.ACTV_CDE         =  'A')               23992440
239925                ORDER BY A.DIVERT_TMST                            23992540
239926                FETCH FIRST 1 ROW ONLY                            23992640
239927          END-EXEC                                                23992740
239928     END-IF.                                                      23992840
239929                                                                  23992940
239930                                                                  23993039
239931      EVALUATE TRUE                                               23993139
239932          WHEN SQLCODE = +0                                       23993239
239933               CONTINUE                                           23993339
239934          WHEN SQLCODE = +100                                     23993439
239935               CONTINUE                                           23993539
239936          WHEN OTHER                                              23993639
239937               SET PS-ERROR TO TRUE                               23993739
239938     END-EVALUATE.                                                23993839
239939                                                                  23993939
239940                                                                  23994039
239950*----------------------------------------------------------------*23995001
240000* IF THE DOOR TYPE IS A SHIPPING DOOR, USE THIS SQL TO RETRIEVE   24000001
240100* MAX TIMESTAMP.                                                  24010001
240200*----------------------------------------------------------------*24020001
240300 3640-MAX-TMST-SHIP.                                              24030001
240400     EXEC SQL                                                     24040001
240500         SELECT MAX(A.END_DIVERT_TMST)                            24050001
240600           INTO :DK-END-TMST                                      24060001
240700           FROM TSUCDOT A                                         24070001
240800               ,TSUOBTR B                                         24080001
240900         WHERE A.OPER_UNT_ID      =  :DK-OPER-UNT-ID              24090001
241000           AND A.DOOR_ID          =  :DK-DOOR-ID                  24100001
241100           AND A.OTBND_TRIP_ID    =  :DK-OUTBOUND-TRIP-ID         24110001
241200           AND B.DEST_OPER_UNT_ID =  :DK-STORE-NUMBER             24120001
241300           AND A.END_DIVERT_TMST  <= '9999-09-09-09.09.09.999999' 24130001
241400     END-EXEC.                                                    24140001
241500                                                                  24150001
241600      EVALUATE TRUE                                               24160001
241700          WHEN SQLCODE = +0                                       24170001
241800              PERFORM 3630-COUNT-CRTNS-DIVERTED                   24180001
241900          WHEN SQLCODE = +100                                     24190001
242000               MOVE '0001-01-01-00.00.00.000000'                  24200001
242100                                      TO DK-END-TMST              24210001
242200          WHEN OTHER                                              24220001
242300               SET PS-ERROR TO TRUE                               24230001
242400     END-EVALUATE.                                                24240001
242500                                                                  24250001
242600*----------------------------------------------------------------*24260001
242700* IF DOOR TYPE IS NOT SHIPPING, USE THIS SQL TO RETRIEVE MAX      24270001
242800* TIMESTAMP.                                                      24280001
242900*----------------------------------------------------------------*24290001
243000 3645-MAX-TMST-SHTL.                                              24300001
243100                                                                  24310001
243200     EXEC SQL                                                     24320001
243300         SELECT MAX(A.END_DIVERT_TMST)                            24330001
243400           INTO :DK-END-TMST                                      24340001
243500           FROM TSUCDOT A                                         24350001
243600         WHERE A.OPER_UNT_ID      =  :DK-OPER-UNT-ID              24360001
243700           AND A.DOOR_ID          =  :DK-DOOR-ID                  24370001
243800           AND A.END_DIVERT_TMST  <= '9999-09-09-09.09.09.999999' 24380001
243900     END-EXEC.                                                    24390001
244000                                                                  24400001
244100      EVALUATE TRUE                                               24410001
244200          WHEN SQLCODE = +0                                       24420001
244300              PERFORM 3630-COUNT-CRTNS-DIVERTED                   24430001
244400          WHEN SQLCODE = +100                                     24440001
244500               MOVE '0001-01-01-00.00.00.000000'                  24450001
244600                                      TO DK-END-TMST              24460001
244700          WHEN OTHER                                              24470001
244800               SET PS-ERROR TO TRUE                               24480001
244900     END-EVALUATE.                                                24490001
245000                                                                  24500001
245100*----------------------------------------------------------------*24510001
245200* IF THERE ARE NO ERRORS, INSERT A ROW INTO TSUCDOT.              24520001
245300*----------------------------------------------------------------*24530001
245400 3650-INSERT-ROW-TSUCDOT.                                         24540001
245500     EXEC SQL                                                     24550001
245600          INSERT                                                  24560001
245700            INTO TSUCDOT                                          24570001
245800           (OTBND_TRIP_ID                                         24580001
245900           ,OPER_UNT_ID                                           24590001
246000           ,DOOR_ID                                               24600001
246100           ,STRT_DIVERT_TMST                                      24610001
246200           ,END_DIVERT_TMST                                       24620001
246300           ,STRT_SCN_TMST                                         24630001
246400           ,STRT_SCN_USR_ID                                       24640001
246500           ,END_SCN_TMST                                          24650001
246600           ,END_SCN_USR_ID)                                       24660001
246700        VALUES                                                    24670001
246800           (:DK-OUTBOUND-TRIP-ID                                  24680001
246900           ,:DK-OPER-UNT-ID                                       24690001
247000           ,:DK-DOOR-ID                                           24700001
247100           ,:DK-START-TMST                                        24710001
247200           , '9999-09-09-09.09.09.999999'                         24720001
247300           ,CURRENT TIMESTAMP                                     24730001
247400           ,:DP020-USERID                                         24740001
247500           , '9999-09-09-09.09.09.999999'                         24750001
247600           ,'        ')                                           24760001
247700      END-EXEC                                                    24770001
247800                                                                  24780001
247900      EVALUATE TRUE                                               24790001
248000          WHEN SQLCODE = +0                                       24800001
248100                                                                  24810001
248200               MOVE 'SUKC564A' TO SUT00006-CRE-BY-PGM-NM          24820001
248300               PERFORM 7400-INSERT-WRKR-AUD                       24830001
248400               SET PS-REBUILD-AFTER-UPDATE  TO  TRUE              24840001
248500               PERFORM 3660-SYNCPOINT                             24850001
248600               PERFORM 2050-DELETE-LIST-QUEUE                     24860001
248700               PERFORM 3200-RESET-ATTRIBUTES                      24870001
248800               PERFORM 4000-BUILD-INITIAL-PANEL                   24880001
248900               MOVE PC-TSYMSG-02795  TO  DP020-MSG-NUMBER         24890001
249000          WHEN SQLCODE = -904                                     24900001
249100          WHEN SQLCODE = -911                                     24910001
249200          WHEN SQLCODE = -913                                     24920001
249300               SET  PS-ERROR                                      24930001
249400                    DP020-MSG-FATAL TO TRUE                       24940001
249500              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24950001
249600          WHEN OTHER                                              24960001
249700               SET  PS-ERROR                                      24970001
249800                    DP020-MSG-FATAL TO TRUE                       24980001
249900              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          24990001
250000     END-EVALUATE.                                                25000001
250100                                                                  25010001
250200                                                                  25020001
250300 3660-SYNCPOINT.                                                  25030001
250400         EXEC CICS                                                25040001
250500              SYNCPOINT                                           25050001
250600         END-EXEC.                                                25060001
250700                                                                  25070001
250800                                                                  25080001
250900*----------------------------------------------------------------*25090001
251000* MAKE SURE THAT THERE IS A BEGIN CUTOFF WITHOUT AN END CUTOFF   *25100001
251100*----------------------------------------------------------------*25110001
251200 3700-CHECK-4-END-CUTOFF.                                         25120001
251300     MOVE ASC-OPEN-OTBND-TRIP   TO DK-OUTBOUND-TRIP-ID.           25130001
251400     MOVE ASC-DOOR-ID           TO DK-DOOR-ID.                    25140001
251500     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                25150001
251600     MOVE ASC-TRIP-DEST-OPER    TO DK-STORE-NUMBER.               25160001
251700     EXEC SQL                                                     25170001
251800          SELECT STRT_DIVERT_TMST                                 25180001
251900            INTO :SUCDOT-STRT-DIVERT-TMST                         25190001
252000            FROM TSUCDOT                                          25200001
252100           WHERE OTBND_TRIP_ID   = :DK-OUTBOUND-TRIP-ID           25210001
252200             AND END_DIVERT_TMST = '9999-09-09-09.09.09.999999'   25220001
252300      END-EXEC                                                    25230001
252400                                                                  25240001
252500      EVALUATE TRUE                                               25250001
252600          WHEN SQLCODE = +0                                       25260001
252700               IF DK-START-TMST > SUCDOT-STRT-DIVERT-TMST         25270001
252800                   SET PS-NO-ERROR TO TRUE                        25280001
252900               ELSE                                               25290001
253000                   SET PS-ERROR                                   25300001
253100                       DP020-MSG-FATAL TO TRUE                    25310001
253200                   MOVE PC-TSYMSG-02799 TO DP020-MSG-NUMBER       25320001
253300               END-IF                                             25330001
253400          WHEN SQLCODE = +100                                     25340001
253500               SET  PS-ERROR                                      25350001
253600                    DP020-MSG-FATAL TO TRUE                       25360001
253700               MOVE PC-TSYMSG-02792 TO DP020-MSG-NUMBER           25370001
253800          WHEN OTHER                                              25380001
253900               SET PS-ERROR TO TRUE                               25390001
254000     END-EVALUATE.                                                25400001
254100                                                                  25410001
254200*----------------------------------------------------------------*25420001
254300* IF THERE ARE NO ERRORS, UPDATE ROW ON TSUCDOT.                  25430001
254400*----------------------------------------------------------------*25440001
254500 3710-UPDATE-TSUCDOT.                                             25450001
254600     EXEC SQL                                                     25460001
254700          UPDATE TSUCDOT                                          25470001
254800             SET END_DIVERT_TMST    =  :DK-START-TMST             25480001
254900                ,END_SCN_TMST       =  CURRENT TIMESTAMP          25490001
255000                ,END_SCN_USR_ID     =  :DP020-USERID              25500001
255100          WHERE OTBND_TRIP_ID       =  :DK-OUTBOUND-TRIP-ID       25510001
255200            AND END_DIVERT_TMST     = '9999-09-09-09.09.09.999999'25520001
255300      END-EXEC                                                    25530001
255400                                                                  25540001
255500      EVALUATE TRUE                                               25550001
255600          WHEN SQLCODE = +0                                       25560001
255800               MOVE 'SUKC564B'        TO SUT00006-CRE-BY-PGM-NM   25580001
255900               PERFORM 7400-INSERT-WRKR-AUD                       25590001
256000               SET PS-REBUILD-AFTER-UPDATE  TO  TRUE              25600001
256100               PERFORM 3660-SYNCPOINT                             25610001
256200               PERFORM 2050-DELETE-LIST-QUEUE                     25620001
256300               PERFORM 3200-RESET-ATTRIBUTES                      25630001
256400               PERFORM 4000-BUILD-INITIAL-PANEL                   25640001
256600              MOVE PC-TSYMSG-02796  TO  DP020-MSG-NUMBER          25660001
256700          WHEN SQLCODE = -904                                     25670001
256800          WHEN SQLCODE = -911                                     25680001
256900          WHEN SQLCODE = -913                                     25690001
257000               SET  PS-ERROR                                      25700001
257100                    DP020-MSG-FATAL TO TRUE                       25710001
257200              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25720001
257300          WHEN OTHER                                              25730001
257400               SET  PS-ERROR                                      25740001
257500                    DP020-MSG-FATAL TO TRUE                       25750001
257600              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          25760001
257700     END-EVALUATE.                                                25770001
257800                                                                  25780001
257900                                                                  25790051
258000*----------------------------------------------------------------*25800001
258100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25810001
258200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25820001
258300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25830001
258400*    DISPLAY THE PANEL TO USER.                                  *25840001
258500*----------------------------------------------------------------*25850001
258600                                                                  25860001
258700 4000-BUILD-INITIAL-PANEL.                                        25870001
258800                                                                  25880001
258900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            25890001
259000                                 ASC-BLOCK-ENTRIES (2).           25900001
259100     MOVE +1                 TO ASC-BLK-SUB.                      25910001
259200     SET ASC-ITEMS-LEFT-ON-DB                                     25920001
259300                             TO TRUE.                             25930001
259400                                                                  25940001
259500     MOVE +0                 TO ASC-ITEM-SUB                      25950001
259600                                ASC-NUMBER-OF-ITEMS-READ          25960001
259700                                ASC-NUMBER-OF-SELECTED-ITEMS      25970001
259800                                ASC-HIGHEST-BLOCK-WRITTEN         25980001
259900                                ASC-START-OF-SELECTED-RANGE       25990001
260000                                ASC-END-OF-SELECTED-RANGE         26000001
260100                                ASC-ITEM-AT-TOP-OF-PANEL.         26010001
260200                                                                  26020001
260300     PERFORM 4050-SELECT-INFORMATION.                             26030001
260400                                                                  26040001
260500     PERFORM 4100-OPEN-CURSOR.                                    26050001
260600     EVALUATE TRUE                                                26060001
260700         WHEN ASC-SHOW-NEXT-CARTON                                26070001
260800             PERFORM 4300-READ-ITEMS-FROM-DB                      26080001
260900         WHEN PC049-SHTL-DVRT-CRTN-CSR                            26090001
261000         WHEN PC049-SHIP-DVRT-CRTN-CSR                            26100001
261100             IF PC049-DIVERT-CUTOFFS-YES                          26110001
261200                 PERFORM 4300-READ-ITEMS-FROM-DB                  26120001
261300             END-IF                                               26130001
261400                                                                  26140001
261500         WHEN PC049-DATE-DVRT-CRTN-CSR                            26150001
261600             IF PC049-NO-ERROR                                    26160001
261700                 PERFORM 4306-READ-ITEMS-FROM-DB                  26170001
261800             END-IF                                               26180001
261900                                                                  26190001
262000     END-EVALUATE.                                                26200001
262100                                                                  26210001
262200     IF ASC-SHOW-NEXT-CARTON                                      26220001
262300         CONTINUE                                                 26230001
262400     ELSE                                                         26240001
262500         PERFORM 4200-CLOSE-CURSOR                                26250001
262600     END-IF                                                       26260001
262700                                                                  26270001
262800     MOVE +1                   TO  PV-TOP-ITEM.                   26280001
262900*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        26290001
263000*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   26300001
263100*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      26310001
263200*    THE ORIGINAL SCREEN.                                         26320001
263300     EVALUATE TRUE                                                26330001
263400         WHEN SU010-SELECTED-ITEMS > 1                            26340001
263500             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  26350001
263600                 SET DP020-MSG-WARNING TO  TRUE                   26360001
263700                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       26370001
263800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              26380001
263900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             26390001
264000             ELSE                                                 26400001
264100                 MOVE -1               TO MR-SELECTL (1)          26410001
264200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              26420001
264300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             26430001
264400             END-IF                                               26440001
264500         WHEN OTHER                                               26450001
264600             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  26460001
264700                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            26470001
264800                 SET DP020-MSG-FATAL   TO  TRUE                   26480001
264900                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       26490001
265000             ELSE                                                 26500001
265100                 MOVE -1               TO MR-SELECTL (1)          26510001
265200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              26520001
265300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             26530001
265400             END-IF                                               26540001
265500     END-EVALUATE.                                                26550001
265600                                                                  26560001
265700*----------------------------------------------------------------*26570001
265800*    FILL TOP OF SCREEN WITH DATA                                 26580001
265900*----------------------------------------------------------------*26590001
266000 4050-SELECT-INFORMATION.                                         26600001
266100     MOVE ASC-OPER-UNT-ID-N  TO  DK-OPER-UNT-ID.                  26610001
266200                                                                  26620015
266300     INITIALIZE XL071-COMMAREA-REC.                               26630011
266400     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               26640011
266500                                                                  26650011
266600     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      26660011
266700                                    XL071-COMMAREA                26670011
266800                                    XL071-COMMAREA-REC.           26680011
266900                                                                  26690011
267000     IF XL071-NO-ERRORS                                           26700011
267100         MOVE XL071-LOC-NM       TO ASC-OPER-UNT-NAME             26710011
267200     ELSE                                                         26720011
267300         MOVE SPACES             TO ASC-OPER-UNT-NAME             26730011
267400     END-IF.                                                      26740011
267500                                                                  26750001
267600     IF ASC-DOOR-ID = SPACES AND ASC-OUTBOUND-TRIP-ID > ZERO      26760001
267700         PERFORM 4052-GET-DOOR-ID                                 26770001
267800     ELSE                                                         26780001
267900         MOVE ASC-DOOR-ID  TO DK-DOOR-ID                          26790001
268000     END-IF.                                                      26800001
268100                                                                  26810001
268200     PERFORM 4320-GET-DOOR-ID-DESC                                26820001
268300                                                                  26830001
268400     IF DP020-INT-APPL-FORMAT-IND = PC-SHOW-NEXT-CARTON           26840001
268500         CONTINUE                                                 26850001
268600     ELSE                                                         26860001
268700         PERFORM 4053-GET-OPEN-TRIP                               26870001
268800     END-IF                                                       26880001
268900                                                                  26890001
269000     EVALUATE TRUE                                                26900001
269100     WHEN DP020-INT-APPL-FORMAT-IND = PC-SHOW-NEXT-CARTON         26910001
269200         MOVE PC-SHOW-NEXT-CARTON       TO ASC-SHOW-CARTON-SW     26920001
269300                                                                  26930001
269400     WHEN DP020-INT-APPL-FORMAT-IND                               26940001
269500                         = PC-CRIT-SPEC-FORMAT                    26950001
269600                        AND ASC-OUTBOUND-TRIP-ID = ZEROES         26960001
269700         SET PC049-DATE-DVRT-CRTN-CSR TO TRUE                     26970001
269800     WHEN OTHER                                                   26980001
269900         IF ASC-DOOR-TYPE = 'SH'                                  26990001
270000             SET PC049-SHIPPING-TRLR                              27000001
270100                 PC049-SHIP-DVRT-CRTN-CSR  TO TRUE                27010001
270200         ELSE                                                     27020001
270300             SET PC049-SHUTL-STRG-TRLR                            27030001
270400                 PC049-SHTL-DVRT-CRTN-CSR TO TRUE                 27040001
270500         END-IF                                                   27050001
270600     END-EVALUATE.                                                27060001
270700                                                                  27070001
270800     MOVE PC049-CURSOR-SWITCHES       TO ASC-SAVE-CURSOR-SW.      27080001
270900                                                                  27090001
271000******************************************************************27100001
271100*  GET MAXIMUM AND MINIMUM DIVERT ON TIMESTAMP FOR A TRAILER     *27110001
271200*  INCLUDING CARTONS ASSUMED ONTO TRAILER                        *27120001
271300******************************************************************27130001
271400 4051-RETRIEVE-TMST.                                              27140001
271500     MOVE ASC-OUTBOUND-TRIP-ID  TO  PC049-DK-OTBND-TRIP-ID.       27150001
271600     MOVE ASC-STR-NBR           TO  PC049-DK-TRLR-DEST.           27160001
271700     PERFORM P4000-STRT-END-DVRT.                                 27170001
271800     PERFORM P3000-DOOR-STR-CSR.                                  27180001
271900                                                                  27190001
272000*-----------------------------------------------------------------27200001
272100*  GET DOOR ID WHEN OUTBOUND TRIP ID IS ENTERED ON CRIT SPEC      27210001
272200*-----------------------------------------------------------------27220001
272300 4052-GET-DOOR-ID.                                                27230001
272400                                                                  27240001
272500     EXEC SQL                                                     27250001
272600          SELECT  A.DOOR_ID                                       27260001
272700                , B.DEST_OPER_UNT_ID                              27270001
272800                , B.DOOR_TYP_CDE                                  27280001
272900            INTO  :SUOBTS-DOOR-ID                                 27290001
273000                , :SUOBTR-DEST-OPER-UNT-ID                        27300001
273100                , :SUOBTR-DOOR-TYP-CDE                            27310001
273200            FROM  TSUOBTS A                                       27320001
273300                , TSUOBTR B                                       27330001
273400           WHERE  A.OTBND_TRIP_ID     =  :DK-OUTBOUND-TRIP-ID     27340001
273500             AND  A.STAT_OPER_UNT_ID  =  :DK-OPER-UNT-ID          27350001
273600             AND  A.OTBND_TRIP_ID     =  B.OTBND_TRIP_ID          27360001
273700             AND  A.STAT_OPER_UNT_ID  =  B.ORGN_OPER_UNT_ID       27370001
273800     END-EXEC.                                                    27380001
273900      EVALUATE TRUE                                               27390001
274000          WHEN SQLCODE = +0                                       27400001
274100          WHEN SQLCODE = -811                                     27410001
274200               MOVE SUOBTS-DOOR-ID          TO ASC-DOOR-ID        27420001
274300                                               DK-DOOR-ID         27430001
274400               MOVE SUOBTR-DEST-OPER-UNT-ID TO ASC-STR-NBR        27440001
274500               MOVE SUOBTR-DOOR-TYP-CDE     TO ASC-DOOR-TYPE      27450001
274600          WHEN OTHER                                              27460001
274700               MOVE SPACES                TO ASC-DOOR-ID          27470001
274800                                             ASC-STR-NBR-X        27480001
274900                                             ASC-DOOR-TYPE        27490001
275000     END-EVALUATE.                                                27500001
275100                                                                  27510001
275200*-----------------------------------------------------------------27520001
275300*  GET OPEN OUTBOUND TRIP ID IF THERE IS ONE FOR THE DOOR         27530001
275400*-----------------------------------------------------------------27540001
275500 4053-GET-OPEN-TRIP.                                              27550001
275600                                                                  27560001
275700     EXEC SQL                                                     27570001
275800          SELECT  A.OTBND_TRIP_ID                                 27580001
275900                , B.DEST_OPER_UNT_ID                              27590001
276000                , B.TRLR_SRL_NBR                                  27600001
276100                , B.DOOR_TYP_CDE                                  27610001
276200                , D.DOOR_TYP_CDE_DESC                             27620001
276300            INTO  :SUOBTS-OTBND-TRIP-ID                           27630001
276400                , :SUOBTR-DEST-OPER-UNT-ID                        27640001
276500                , :SUOBTR-TRLR-SRL-NBR                            27650001
276600                , :SUOBTR-DOOR-TYP-CDE                            27660001
276700                , :CNDRTY-DOOR-TYP-CDE-DESC                       27670001
276800            FROM  TSUOBTS A                                       27680001
276900                , TSUOBTR B                                       27690001
277000                , TCNDRTY D                                       27700001
277100           WHERE  A.STAT_OPER_UNT_ID  =  :DK-OPER-UNT-ID          27710001
277200             AND  A.DOOR_ID           =  :DK-DOOR-ID              27720001
277300             AND  A.TRIP_STAT_CDE    IN  ('DO','AO')              27730001
277400             AND  A.OTBND_TRIP_ID     =  B.OTBND_TRIP_ID          27740001
277500             AND  A.STAT_OPER_UNT_ID  =  B.ORGN_OPER_UNT_ID       27750001
277600             AND  B.DOOR_TYP_CDE      =  D.DOOR_TYP_CDE           27760001
277700             AND OTBND_STAT_TMST =                                27770001
277800                     (SELECT MAX(C.OTBND_STAT_TMST)               27780001
277900                FROM TSUOBTS C                                    27790001
278000               WHERE A.OTBND_TRIP_ID  =  C.OTBND_TRIP_ID)         27800001
278100     END-EXEC.                                                    27810001
278200                                                                  27820001
278300      EVALUATE TRUE                                               27830001
278400          WHEN SQLCODE = +0                                       27840001
278500          WHEN SQLCODE = -811                                     27850001
278600               MOVE SUOBTS-OTBND-TRIP-ID  TO ASC-OPEN-OTBND-TRIP  27860001
278700               MOVE SUOBTR-DEST-OPER-UNT-ID TO ASC-TRIP-DEST-OPER 27870001
278800               MOVE SUOBTR-TRLR-SRL-NBR     TO ASC-OPEN-TRLR-SRL  27880001
278900               MOVE CNDRTY-DOOR-TYP-CDE-DESC TO ASC-DOOR-TYPE-DESC27890001
279000          WHEN SQLCODE = +100                                     27900001
279100               INITIALIZE ASC-OPEN-OTBND-TRIP                     27910001
279200                          ASC-TRIP-DEST-OPER                      27920001
279300                          ASC-OPEN-TRLR-SRL                       27930001
279400         WHEN SQLWARN0 NOT = SPACE                                27940001
279500         WHEN SQLCODE NOT = ZERO                                  27950001
279600              MOVE '4053-GET-OPEN-TRIP'  TO DP013-PARAGRAPH       27960001
279700              MOVE 'SELECT OPEN TRIP INFO'                        27970001
279800                               TO DP013-MESSAGE-TEXT (1)          27980001
279900              MOVE SQLCA       TO DP013-SQLCA                     27990001
280000              MOVE 'TSUOBTS'   TO DP013-DB2-TABLE-NAME (1)        28000001
280100              MOVE 'TSUOBTR'   TO DP013-DB2-TABLE-NAME (2)        28010001
280200              SET DP013-DB2-ABEND TO TRUE                         28020001
280300              PERFORM DP013-0000-PROCESS-ABEND                    28030001
280400     END-EVALUATE.                                                28040001
280500                                                                  28050001
280600*----------------------------------------------------------------*28060001
280700* OPEN THE CURSOR                                                 28070001
280800*----------------------------------------------------------------*28080001
280900 4100-OPEN-CURSOR.                                                28090001
281000                                                                  28100001
281100     EVALUATE TRUE                                                28110001
281200         WHEN ASC-SHOW-NEXT-CARTON                                28120001
281300             CONTINUE                                             28130001
281400                                                                  28140001
281500         WHEN PC049-DATE-DVRT-CRTN-CSR                            28150001
281600             MOVE ASC-OPER-UNT-ID-N     TO PC049-DK-OPER-UNT-ID   28160001
281700             MOVE ASC-DOOR-ID           TO PC049-DK-DOOR-ID       28170001
281800             MOVE ASC-OUTBOUND-TRIP-ID  TO PC049-DK-OTBND-TRIP-ID 28180001
281900             MOVE ASC-FROM-DATE TO PV-TMST                        28190001
282000             MOVE PV-TMST-MM    TO PV-FROM-MM                     28200001
282100             MOVE PV-TMST-DD    TO PV-FROM-DD                     28210001
282200             MOVE PV-TMST-CC    TO PV-FROM-YY                     28220001
282300             MOVE PV-FROM-TMST  TO PC049-DK-START-TMST            28230001
282400             MOVE ASC-TO-DATE   TO PV-TMST                        28240001
282500             MOVE PV-TMST-MM    TO PV-TO-MM                       28250001
282600             MOVE PV-TMST-DD    TO PV-TO-DD                       28260001
282700             MOVE PV-TMST-CC    TO PV-TO-YY                       28270001
282800             MOVE PV-TO-TMST    TO PC049-DK-END-TMST              28280001
282900             PERFORM P7265-OPEN-DATE-DVRT-CSR                     28290001
283000         WHEN OTHER                                               28300001
283100             MOVE ASC-OPER-UNT-ID-N     TO PC049-DK-OPER-UNT-ID   28310001
283200             MOVE ASC-DOOR-ID           TO PC049-DK-DOOR-ID       28320001
283300             MOVE ASC-OUTBOUND-TRIP-ID  TO PC049-DK-OTBND-TRIP-ID 28330001
283400             PERFORM 4051-RETRIEVE-TMST                           28340001
283500             IF PC049-DIVERT-CUTOFFS-YES                          28350001
283600                 PERFORM P7030-OPEN-DVRT-CRTN-CSR                 28360001
283700             END-IF                                               28370001
283800     END-EVALUATE.                                                28380001
283900                                                                  28390001
284000     MOVE EIBTASKN TO PV-TASK                                     28400001
284100     STRING 'TASK '                                               28410001
284200             PV-TASK                                              28420001
284300             '- SUKCS564 / '                                      28430001
284400             'PC049-CURSOR-SWITCHES - '                           28440001
284500             PC049-CURSOR-SWITCHES DELIMITED BY SIZE              28450001
284600             INTO PV-CICS-MSG-AREA.                               28460001
284800                                                                  28480001
284900*----------------------------------------------------------------*28490001
285000* CLOSE THE CURSOR.                                               28500001
285100*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *28510001
285200*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *28520001
285300*   USER.                                                        *28530001
285400*----------------------------------------------------------------*28540001
285500 4200-CLOSE-CURSOR.                                               28550001
285600                                                                  28560001
285700     IF PC049-SHTL-DVRT-CRTN-CSR OR PC049-SHIP-DVRT-CRTN-CSR      28570001
285800         PERFORM P7050-CLOSE-DVRT-CRTN-CSR                        28580001
285900     ELSE                                                         28590001
286000         IF PC049-DATE-DVRT-CRTN-CSR                              28600001
286100             PERFORM P7275-CLOSE-DATE-DVRT-CSR                    28610001
286200         END-IF                                                   28620001
286300     END-IF.                                                      28630001
286400                                                                  28640001
286500                                                                  28650051
286600*----------------------------------------------------------------*28660001
286700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *28670001
286800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *28680001
286900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *28690001
287000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *28700001
287100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *28710001
287200*                                                                *28720001
287300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *28730001
287400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *28740001
287500*    UPON INITIALIZATION.                                        *28750001
287600*----------------------------------------------------------------*28760001
287700                                                                  28770001
287800 4300-READ-ITEMS-FROM-DB.                                         28780001
287900                                                                  28790001
288000*    SHOW ONLY ONE LINE                                           28800001
288100     IF ASC-SHOW-NEXT-CARTON                                      28810001
288200         PERFORM 7320-FIND-LAST-END-CUTOFF                        28820001
288300         PERFORM 7330-FIND-NEXT-DIVERTED-CTN                      28830001
288400         IF PS-NO-ERROR                                           28840001
288500             PERFORM 7340-GET-SUCDRV-INFO                         28850001
288600             PERFORM 4350-RETRIEVE-PO-INFO                        28860001
288700             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  28870001
288800             MOVE 1                    TO ASC-BLK-SUB             28880001
288900                                          ASC-ITEM-SUB            28890001
289000                                          ASC-LIST-ITEM-NUMBER    28900001
289100                                        (ASC-BLK-SUB ASC-ITEM-SUB)28910001
289200             PERFORM 4300AA-LOAD-COMMAREA                         28920001
289300             SET ASC-BLOCK-MODIFIED (1)  TO TRUE                  28930001
289400         END-IF                                                   28940001
289500                                                                  28950001
289600     ELSE                                                         28960001
289700                                                                  28970001
289800     PERFORM                                                      28980001
289900         VARYING PV-READ-COUNT                                    28990001
290000         FROM 1 BY 1                                              29000001
290100         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29010001
290200            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29020001
290300                                                                  29030001
290400         PERFORM 4310-FETCH                                       29040001
290500                                                                  29050001
290600         IF  ASC-ITEMS-LEFT-ON-DB                                 29060001
290700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                29070001
290800                 ADD +1            TO ASC-ITEM-SUB                29080001
290900             ELSE                                                 29090001
291000                 ADD +1            TO ASC-BLK-SUB                 29100001
291100                 MOVE +1           TO ASC-ITEM-SUB                29110001
291200                                                                  29120001
291300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         29130001
291400                     MOVE +1       TO ASC-BLK-SUB                 29140001
291500                     SET ASC-BLOCK-MODIFIED (1)                   29150001
291600                                   TO TRUE                        29160001
291700                     PERFORM 5100-WRITE-TEMP-STORAGE              29170001
291800                     MOVE ASC-BLOCK-ENTRIES                       29180001
291900                               (PC-MAX-BLOCKS-IN-ARRAY)           29190001
292000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 29200001
292100                     ADD +1        TO ASC-BLK-SUB                 29210001
292200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   29220001
292300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      29230001
292400                                   TO TRUE                        29240001
292500                 END-IF                                           29250001
292600             END-IF                                               29260001
292700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    29270001
292800             MOVE ASC-NUMBER-OF-ITEMS-READ                        29280001
292900                                   TO ASC-LIST-ITEM-NUMBER        29290001
293000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29300001
293100             PERFORM 4300AA-LOAD-COMMAREA                         29310001
293200         END-IF                                                   29320001
293300     END-PERFORM                                                  29330001
293400     END-IF.                                                      29340001
293500                                                                  29350001
293600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          29360001
293700         MOVE +1               TO ASC-BLK-SUB                     29370001
293800         PERFORM 5100-WRITE-TEMP-STORAGE                          29380001
293900         ADD +1                TO ASC-BLK-SUB                     29390001
294000         PERFORM 5100-WRITE-TEMP-STORAGE                          29400001
294100                                                                  29410001
294200         MOVE 1                TO ASC-BLK-SUB                     29420001
294300                                  PV-BLOCK-NUMBER                 29430001
294400         PERFORM 4410-READ-TEMP-STORAGE                           29440001
294500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             29450001
294600             MOVE 2            TO ASC-BLK-SUB                     29460001
294700                                  PV-BLOCK-NUMBER                 29470001
294800             PERFORM 4410-READ-TEMP-STORAGE                       29480001
294900         END-IF                                                   29490001
295000     END-IF.                                                      29500001
295100                                                                  29510001
295200 4300AA-LOAD-COMMAREA.                                            29520001
295300             MOVE SUCRDV-SHIPT-UNT-ID                             29530001
295400                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 29540001
295500             MOVE SUCRDV-DEST-OPER-UNT-ID TO                      29550001
295600                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 29560001
295700             MOVE ASC-CREATE-ID                                   29570001
295800                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 29580001
295900                                                                  29590017
296000             IF ASC-CREATE-ID = 'FXR'                             29600017
296100                MOVE ASC-TRN-NBR                                  29610017
296200                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 29620017
296300             ELSE                                                 29630017
296400                MOVE ASC-PO-RCVR                                  29640017
296500                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 29650001
296600                MOVE ASC-LOAD-STAT                                29660017
296700                    TO ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) 29670001
296800             END-IF                                               29680017
296900                                                                  29690017
297000             IF SUCRDV-ACTV-CDE = 'I'                             29700001
297100                 PERFORM 7000-SELECT-OUTBND-LOC                   29710001
297200                 IF SUT00027-ACTV-CDE = 'I'                       29720001
297300                     MOVE SUCRDV-ACTV-CDE TO                      29730001
297400                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 29740001
297500                 ELSE                                             29750001
297600                     MOVE SPACES TO                               29760001
297700                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 29770001
297800                 END-IF                                           29780001
297900             ELSE                                                 29790001
298000                 MOVE SPACES TO                                   29800001
298100                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 29810001
298200             END-IF                                               29820001
298300                                                                  29830001
298400             IF PC049-PV-BEG-DVRT                                 29840001
298500                 MOVE 'DVT B' TO ASC-LOAD-STATUS                  29850001
298600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29860001
298700             ELSE                                                 29870001
298800                 IF PC049-PV-END-DVRT                             29880001
298900                     MOVE 'DVT E' TO ASC-LOAD-STATUS              29890001
299000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29900001
299100                 END-IF                                           29910001
299200             END-IF                                               29920001
299300                                                                  29930001
299400             MOVE SUCRDV-DIVERT-TMST     TO PV-TMST               29940001
299500             PERFORM 4300A-FORMAT-DATE-TIME                       29950001
299600             STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)             29960001
299700                     DELIMITED BY SIZE                            29970001
299800                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 29980001
299900             MOVE PV-JIS-HH-MM                                    29990023
300000                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 30000001
300100                                                                  30010001
300200             MOVE ASC-TRLR-SRL-NMBR TO                            30020001
300300                      ASC-TRLR-SRL-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 30030001
301500             IF ASC-PO-RCVR-NBR(ASC-BLK-SUB ASC-ITEM-SUB) = SPACES30150001
301600                 SET ASC-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)  30160001
301700                                TO TRUE                           30170001
301800             ELSE                                                 30180001
302300                 SET ASC-NO-MISSING-DATA(ASC-BLK-SUB ASC-ITEM-SUB)30230001
302400                                TO TRUE                           30240001
302500             END-IF.                                              30250001
302600 4300A-FORMAT-DATE-TIME.                                          30260001
302700     EXEC SQL                                                     30270001
302800     SELECT                                                       30280001
302900         CHAR(DATE(:PV-TMST),USA)                                 30290001
303000     ,   CHAR(TIME(:PV-TMST),JIS)                                 30300001
303100     INTO                                                         30310001
303200         :PV-USA-DATE                                             30320001
303300     ,   :PV-JIS-TIME                                             30330001
303400     FROM SYSIBM.SYSDUMMY1                                        30340001
303500     END-EXEC.                                                    30350001
303600                                                                  30360001
303700     EVALUATE TRUE                                                30370001
303800         WHEN SQLCODE = ZERO                                      30380001
303900             CONTINUE                                             30390001
304000         WHEN SQLWARN0 NOT = SPACE                                30400001
304100         WHEN SQLCODE NOT = ZERO                                  30410001
304200              MOVE '4300A-FORMAT-DATE-TIME'  TO DP013-PARAGRAPH   30420001
304300              MOVE 'FORMAT DATE AND TIME'                         30430001
304400                               TO DP013-MESSAGE-TEXT (1)          30440001
304500              MOVE SQLCA       TO DP013-SQLCA                     30450001
304600              MOVE 'SYSDUMMY1'   TO DP013-DB2-TABLE-NAME (1)      30460001
304700              SET DP013-DB2-ABEND TO TRUE                         30470001
304800              PERFORM DP013-0000-PROCESS-ABEND                    30480001
304900     END-EVALUATE.                                                30490001
305000                                                                  30500051
305100*-----------------------------------------------------------------30510001
305200* FETCH DATA FROM THE DATE DOOR DIVERTED CURSOR                   30520001
305300*-----------------------------------------------------------------30530001
305400 4306-READ-ITEMS-FROM-DB.                                         30540001
305500                                                                  30550001
305600     PERFORM                                                      30560001
305700         VARYING PV-READ-COUNT                                    30570001
305800         FROM 1 BY 1                                              30580001
305900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    30590001
306000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         30600001
306100                                                                  30610001
306200         PERFORM 4310-FETCH                                       30620001
306300                                                                  30630001
306400         IF  ASC-ITEMS-LEFT-ON-DB                                 30640001
306500             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                30650001
306600                 ADD +1            TO ASC-ITEM-SUB                30660001
306700             ELSE                                                 30670001
306800                 ADD +1            TO ASC-BLK-SUB                 30680001
306900                 MOVE +1           TO ASC-ITEM-SUB                30690001
307000                                                                  30700001
307100                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         30710001
307200                     MOVE +1       TO ASC-BLK-SUB                 30720001
307300                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           30730001
307400                     PERFORM 5100-WRITE-TEMP-STORAGE              30740001
307500                     MOVE ASC-BLOCK-ENTRIES                       30750001
307600                                   (PC-MAX-BLOCKS-IN-ARRAY)       30760001
307700                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 30770001
307800                     ADD +1        TO ASC-BLK-SUB                 30780001
307900                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   30790001
308000                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      30800001
308100                                                          TO TRUE 30810001
308200                 END-IF                                           30820001
308300             END-IF                                               30830001
308400             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    30840001
308500             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          30850001
308600             MOVE ASC-NUMBER-OF-ITEMS-READ                        30860001
308700                                   TO ASC-LIST-ITEM-NUMBER        30870001
308800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30880001
308900             MOVE SPACES           TO  ASC-ACTION                 30890001
309000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30900001
309100             MOVE SUCRDV-SHIPT-UNT-ID                             30910001
309200                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 30920001
309300             MOVE SUCRDV-DEST-OPER-UNT-ID TO                      30930001
309400                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 30940001
309500             MOVE ASC-CREATE-ID                                   30950001
309600                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 30960001
309700             IF ASC-CREATE-ID = 'FXR'                             30970018
309800                MOVE ASC-TRN-NBR                                  30980018
309900                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 30990018
310000             ELSE                                                 31000018
310100                MOVE ASC-PO-RCVR                                  31010018
310200                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 31020001
310300             END-IF                                               31030018
310400                                                                  31040031
310500* CHECK FOR UNKNOWN CREATE ID                                     31050051
310600             IF ASC-CREATE-ID = SPACES                            31060030
310700                MOVE 'UNKNOWN'                                    31070030
310800                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 31080030
310900             END-IF                                               31090030
311000*                                                                 31100031
311100                                                                  31110018
311200             MOVE ASC-LOAD-STAT                                   31120001
311300                    TO ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) 31130001
311400             IF SUCRDV-ACTV-CDE = 'I'                             31140001
311500                 PERFORM 7000-SELECT-OUTBND-LOC                   31150001
311600                 IF SUT00027-ACTV-CDE = 'I'                       31160001
311700                     MOVE SUCRDV-ACTV-CDE TO                      31170001
311800                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 31180001
311900                 ELSE                                             31190001
312000                     MOVE SPACES TO                               31200001
312100                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 31210001
312200                 END-IF                                           31220001
312300             ELSE                                                 31230001
312400                 MOVE SPACES TO                                   31240001
312500                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 31250001
312600             END-IF                                               31260001
312700                                                                  31270001
313700             IF PC046-BEGIN-DIVERT                                31370001
313800                 MOVE 'DVT B' TO ASC-LOAD-STATUS                  31380001
313900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31390001
314000             ELSE                                                 31400001
314100                 IF PC046-END-DIVERT                              31410001
314200                     MOVE 'DVT E' TO ASC-LOAD-STATUS              31420001
314300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31430001
314400                 END-IF                                           31440001
314500             END-IF                                               31450001
314600                                                                  31460001
314700             MOVE SUCRDV-DIVERT-TMST     TO PV-TMST               31470001
314800             PERFORM 4300A-FORMAT-DATE-TIME                       31480001
314900             STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)             31490001
315000                     DELIMITED BY SIZE                            31500001
315100                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 31510001
315200             MOVE PV-JIS-HH-MM                                    31520023
315300                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 31530001
315400                                                                  31540001
315500             MOVE ASC-TRLR-SRL-NMBR TO                            31550001
315600                      ASC-TRLR-SRL-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 31560001
316800             IF ASC-PO-RCVR-NBR(ASC-BLK-SUB ASC-ITEM-SUB) = SPACES31680001
316900                 SET ASC-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)  31690001
317000                                TO TRUE                           31700001
317100             ELSE                                                 31710001
317600                 SET ASC-NO-MISSING-DATA(ASC-BLK-SUB ASC-ITEM-SUB)31760001
317700                                TO TRUE                           31770001
317800             END-IF                                               31780001
318200         END-IF                                                   31820001
318300     END-PERFORM.                                                 31830001
318400                                                                  31840001
318500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          31850001
318600         MOVE +1               TO ASC-BLK-SUB                     31860001
318700         PERFORM 5100-WRITE-TEMP-STORAGE                          31870001
318800         ADD +1                TO ASC-BLK-SUB                     31880001
318900         PERFORM 5100-WRITE-TEMP-STORAGE                          31890001
319000                                                                  31900001
319100         MOVE 1                TO ASC-BLK-SUB                     31910001
319200                                  PV-BLOCK-NUMBER                 31920001
319300         PERFORM 4410-READ-TEMP-STORAGE                           31930001
319400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             31940001
319500             MOVE 2            TO ASC-BLK-SUB                     31950001
319600                                  PV-BLOCK-NUMBER                 31960001
319700             PERFORM 4410-READ-TEMP-STORAGE                       31970001
319800         END-IF                                                   31980001
319900     END-IF.                                                      31990001
320000                                                                  32000001
320100 EJECT                                                            32010001
320200*----------------------------------------------------------------*32020001
320300*    FETCH THE MESSAGE CURSOR.                                   *32030001
320400*----------------------------------------------------------------*32040001
320500                                                                  32050001
320600 4310-FETCH.                                                      32060001
320700                                                                  32070001
320800                                                                  32080001
320900     EVALUATE TRUE                                                32090001
321000     WHEN ASC-SHOW-NEXT-CARTON                                    32100001
321100         CONTINUE                                                 32110001
321200     WHEN PC049-SHTL-DVRT-CRTN-CSR                                32120001
321300     WHEN PC049-SHIP-DVRT-CRTN-CSR                                32130001
321400         PERFORM P7040-FETCH-DVRT-CRTN-CSR                        32140001
321500     WHEN OTHER                                                   32150001
321600         PERFORM P7270-FETCH-DATE-DVRT-CSR                        32160001
321700     END-EVALUATE.                                                32170001
321800                                                                  32180001
321900     IF  PC049-EOF-DVRT-CRTN                                      32190001
322000     OR  PC049-EOF-DATE-DVRT-CRTN                                 32200001
322100         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      32210001
322200     ELSE                                                         32220001
322300         PERFORM 4350-RETRIEVE-PO-INFO                            32230001
322400     END-IF.                                                      32240001
322500                                                                  32250001
322600*----------------------------------------------------------------*32260001
322700* RETRIEVE DOOR ID DESCRIPTION FROM TCNDCDR TABLE                 32270001
322800*----------------------------------------------------------------*32280001
322900 4320-GET-DOOR-ID-DESC.                                           32290001
323000     EXEC SQL                                                     32300001
323100          SELECT DR.DOOR_LOC_DESC                                 32310001
323200                ,DR.DOOR_TYP_CDE                                  32320001
323300                ,TY.DOOR_TYP_CDE_DESC                             32330001
323400          INTO  :CNDCDR-DOOR-LOC-DESC                             32340001
323500               ,:CNDCDR-DOOR-TYP-CDE                              32350001
323600               ,:CNDRTY-DOOR-TYP-CDE-DESC                         32360001
323700           FROM  TCNDCDR DR                                       32370001
323800               , TCNDRTY TY                                       32380001
323900          WHERE  OPER_UNT_ID  =  :DK-OPER-UNT-ID                  32390001
324000            AND  DOOR_ID      =  :DK-DOOR-ID                      32400001
324100            AND  DR.DOOR_TYP_CDE = TY.DOOR_TYP_CDE                32410001
324200     END-EXEC                                                     32420001
324300     EVALUATE TRUE                                                32430001
324400         WHEN SQLCODE = ZERO                                      32440001
324500             MOVE CNDCDR-DOOR-LOC-DESC TO ASC-DOOR-DESC           32450001
324600             MOVE CNDCDR-DOOR-TYP-CDE  TO ASC-DOOR-TYPE           32460001
324700             MOVE CNDRTY-DOOR-TYP-CDE-DESC TO ASC-DOOR-TYPE-DESC  32470001
324800         WHEN OTHER                                               32480001
324900             MOVE SPACES TO ASC-DOOR-DESC                         32490001
325000     END-EVALUATE.                                                32500001
325100                                                                  32510001
325200*----------------------------------------------------------------*32520001
325300* CALL PCKUT713 TO RETRIEVE PO, RCVR, DEST-OPER-UNT-ID, ETC.      32530049
325400*----------------------------------------------------------------*32540001
325500 4350-RETRIEVE-PO-INFO.                                           32550001
325600     INITIALIZE  PC046-COMMAREA-REC.                              32560001
325700     MOVE SUCRDV-SHIPT-UNT-ID  TO  PC046-CARTON-ID.               32570001
325800                                                                  32580001
325900     CALL PC046-CARTON-STATUS-MODULE                              32590001
326000             USING DFHEIBLK                                       32600001
326100             PC046-COMMAREA                                       32610001
326200             PC046-COMMAREA-REC                                   32620001
326300     END-CALL                                                     32630001
326400                                                                  32640001
326500     PERFORM 4375-VALIDATE-STATUS-CALL.                           32650001
326600                                                                  32660001
326700*----------------------------------------------------------------*32670001
326800* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*32680001
326900*----------------------------------------------------------------*32690001
327000 4375-VALIDATE-STATUS-CALL.                                       32700001
327100                                                                  32710001
327200     IF  PC046-SUCCESSFUL                                         32720001
327300         MOVE  PC046-DEST-OPER-UNT-ID  TO  ASC-STR-NBR            32730001
327400         MOVE  PC046-SHPUNT-SRC-ID     TO  ASC-CREATE-ID          32740001
327500         MOVE  PC046-OTBD-TRIP-ID      TO  ASC-OUTBOUND-TRIP-ID   32750001
327600         MOVE  PC046-TRLR-SRL          TO  ASC-TRLR-SRL-NMBR      32760001
327700         IF PC046-MULT-PO = SPACES                                32770001
327800             IF  PC046-PO-NBR > ZERO                              32780001
327900                 IF ASC-CREATE-ID = 'RDM'                         32790017
328000                     STRING ' ' PC046-TRN-NBR DELIMITED BY SIZE   32800001
328100                             INTO ASC-PO-RCVR                     32810001
328200                 ELSE                                             32820001
328300                 IF ASC-CREATE-ID = 'FXR'                         32830017
328400                     MOVE PC046-TRN-NBR TO PV-DISP-TRN            32840017
328500                     MOVE PV-DISP-TRN-NBR TO ASC-TRN-NBR          32850017
328600                 ELSE                                             32860017
328700                     MOVE PC046-PO-NBR    TO PV-DISP-PO           32870001
328800                     MOVE PC046-RCVR-NBR  TO PV-DISP-RCVR         32880001
328900                     MOVE PV-DISP-PO-RCVR TO  ASC-PO-RCVR         32890001
329000                 END-IF                                           32900001
329100                 END-IF                                           32910017
329200             ELSE                                                 32920001
329300                 MOVE  SPACES        TO  ASC-PO-RCVR              32930001
329400             END-IF                                               32940001
329500         ELSE                                                     32950001
329600             MOVE PC046-MULT-PO      TO  ASC-PO-RCVR              32960001
329700         END-IF                                                   32970001
329800                                                                  32980001
329900         EVALUATE PC046-CRTN-STATUS                               32990001
330000             WHEN '01'                                            33000001
330100                 MOVE 'INVLD' TO ASC-LOAD-STAT                    33010001
330200             WHEN '02'                                            33020001
330300                 MOVE 'INACT' TO ASC-LOAD-STAT                    33030001
330400             WHEN '03'                                            33040001
330500                 MOVE 'SCOFF' TO ASC-LOAD-STAT                    33050001
330600             WHEN '04'                                            33060001
330700                 MOVE 'SCDON' TO ASC-LOAD-STAT                    33070001
330800             WHEN '05'                                            33080001
330900                 MOVE 'DVRTD' TO ASC-LOAD-STAT                    33090001
331000             WHEN '06'                                            33100001
331100                 MOVE 'LOADD' TO ASC-LOAD-STAT                    33110001
331200             WHEN '07'                                            33120001
331300                 MOVE 'CSEPK' TO ASC-LOAD-STAT                    33130001
331400             WHEN '08'                                            33140001
331500                 MOVE 'CHKIN' TO ASC-LOAD-STAT                    33150001
331600             WHEN '09'                                            33160001
331700                 MOVE 'P-2-L' TO ASC-LOAD-STAT                    33170001
331800             WHEN '10'                                            33180001
331900                 MOVE 'CRRDM' TO ASC-LOAD-STAT                    33190001
332000             WHEN '11'                                            33200001
332100                 MOVE 'CRRCV' TO ASC-LOAD-STAT                    33210001
332200             WHEN '12'                                            33220001
332300                 MOVE 'CRASN' TO ASC-LOAD-STAT                    33230001
332400             WHEN '13'                                            33240001
332500                 MOVE 'CRSMT' TO ASC-LOAD-STAT                    33250001
332600             WHEN '14'                                            33260001
332700                 MOVE 'CRXFR' TO ASC-LOAD-STAT                    33270001
332800             WHEN '15'                                            33280001
332900                 MOVE 'CRMST' TO ASC-LOAD-STAT                    33290001
333000             WHEN '16'                                            33300001
333100                 MOVE 'CRBLD' TO ASC-LOAD-STAT                    33310001
333200             WHEN '17'                                            33320027
333300                 MOVE 'JWLRY' TO ASC-LOAD-STAT                    33330027
333400             WHEN '18'                                            33340027
333500                 MOVE 'DMGD ' TO ASC-LOAD-STAT                    33350027
333510             WHEN '19'                                            33351051
333520                 MOVE 'CR3WD' TO ASC-LOAD-STAT                    33352051
333600         END-EVALUATE                                             33360001
333700     ELSE                                                         33370001
333800     IF  PC046-CRTN-STAT-ERROR                                    33380005
333900         MOVE  PC046-DEST-OPER-UNT-ID  TO  ASC-STR-NBR            33390004
334000         MOVE  PC046-SHPUNT-SRC-ID     TO  ASC-CREATE-ID          33400004
334100         MOVE  PC046-OTBD-TRIP-ID      TO  ASC-OUTBOUND-TRIP-ID   33410004
334200         MOVE  PC046-TRLR-SRL          TO  ASC-TRLR-SRL-NMBR      33420004
334300         IF PC046-MULT-PO = SPACES                                33430004
334400             IF  PC046-PO-NBR > ZERO                              33440004
334500                 IF ASC-CREATE-ID = 'FXR' OR 'RDM'                33450004
334600                     STRING ' ' PC046-TRN-NBR DELIMITED BY SIZE   33460004
334700                             INTO ASC-PO-RCVR                     33470004
334800                 ELSE                                             33480004
334900                     MOVE PC046-PO-NBR    TO PV-DISP-PO           33490004
335000                     MOVE PC046-RCVR-NBR  TO PV-DISP-RCVR         33500004
335100                     MOVE PV-DISP-PO-RCVR TO  ASC-PO-RCVR         33510004
335200                 END-IF                                           33520004
335300             ELSE                                                 33530004
335400                 MOVE  SPACES        TO  ASC-PO-RCVR              33540004
335500             END-IF                                               33550004
335600         ELSE                                                     33560004
335700             MOVE PC046-MULT-PO      TO  ASC-PO-RCVR              33570004
335800         END-IF                                                   33580004
335900                                                                  33590004
336000         EVALUATE PC046-CRTN-STATUS                               33600004
336100             WHEN '01'                                            33610004
336200                 MOVE 'INVLD' TO ASC-LOAD-STAT                    33620004
336300             WHEN '02'                                            33630004
336400                 MOVE 'INACT' TO ASC-LOAD-STAT                    33640004
336500             WHEN '03'                                            33650004
336600                 MOVE 'SCOFF' TO ASC-LOAD-STAT                    33660004
336700             WHEN '04'                                            33670004
336800                 MOVE 'SCDON' TO ASC-LOAD-STAT                    33680004
336900             WHEN '05'                                            33690004
337000                 MOVE 'DVRTD' TO ASC-LOAD-STAT                    33700004
337100             WHEN '06'                                            33710004
337200                 MOVE 'LOADD' TO ASC-LOAD-STAT                    33720004
337300             WHEN '07'                                            33730004
337400                 MOVE 'CSEPK' TO ASC-LOAD-STAT                    33740004
337500             WHEN '08'                                            33750004
337600                 MOVE 'CHKIN' TO ASC-LOAD-STAT                    33760004
337700             WHEN '09'                                            33770004
337800                 MOVE 'P-2-L' TO ASC-LOAD-STAT                    33780004
337900             WHEN '10'                                            33790004
338000                 MOVE 'CRRDM' TO ASC-LOAD-STAT                    33800004
338100             WHEN '11'                                            33810004
338200                 MOVE 'CRRCV' TO ASC-LOAD-STAT                    33820004
338300             WHEN '12'                                            33830004
338400                 MOVE 'CRASN' TO ASC-LOAD-STAT                    33840004
338500             WHEN '13'                                            33850004
338600                 MOVE 'CRSMT' TO ASC-LOAD-STAT                    33860004
338700             WHEN '14'                                            33870004
338800                 MOVE 'CRXFR' TO ASC-LOAD-STAT                    33880004
338900             WHEN '15'                                            33890004
339000                 MOVE 'CRMST' TO ASC-LOAD-STAT                    33900004
339100             WHEN '16'                                            33910004
339200                 MOVE 'CRBLD' TO ASC-LOAD-STAT                    33920004
339300             WHEN '17'                                            33930028
339400                 MOVE 'JWLRY' TO ASC-LOAD-STAT                    33940028
339500             WHEN '18'                                            33950028
339600                 MOVE 'DMGD ' TO ASC-LOAD-STAT                    33960028
339610             WHEN '19'                                            33961051
339620                 MOVE 'CR3WD' TO ASC-LOAD-STAT                    33962051
339700         END-EVALUATE                                             33970004
339800         SET  PS-ERROR       TO  TRUE                             33980004
339900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       33990004
340000     ELSE                                                         34000004
340100         SET  PS-ERROR       TO  TRUE                             34010001
340200         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       34020001
340300     END-IF                                                       34030004
340400     END-IF.                                                      34040004
340500                                                                  34050001
340600     IF  SQLCODE EQUAL +100                                       34060001
340700         SET ASC-NO-ITEMS-LEFT-ON-DB                              34070001
340800                                   TO TRUE                        34080001
340900     END-IF.                                                      34090001
341000                                                                  34100001
341100*----------------------------------------------------------------*34110001
341200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *34120001
341300*----------------------------------------------------------------*34130001
341400 4400-MOVE-COMMAREA-TO-SCREEN.                                    34140001
341500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             34150001
341600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          34160001
341700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          34170001
341800             MOVE +1    TO ASC-BLK-SUB                            34180001
341900             PERFORM 5100-WRITE-TEMP-STORAGE                      34190001
342000             ADD +1     TO ASC-BLK-SUB                            34200001
342100             PERFORM 5100-WRITE-TEMP-STORAGE                      34210001
342200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             34220001
342300                 GIVING PV-BLOCK-NUMBER                           34230001
342400                 REMAINDER PV-REMAINDER                           34240001
342500             IF  PV-REMAINDER > ZERO                              34250001
342600                 ADD +1 TO PV-BLOCK-NUMBER                        34260001
342700             END-IF                                               34270001
342800             MOVE +1    TO ASC-BLK-SUB                            34280001
342900             PERFORM 4410-READ-TEMP-STORAGE                       34290001
343000             ADD +1     TO ASC-BLK-SUB                            34300001
343100                           PV-BLOCK-NUMBER                        34310001
343200             PERFORM 4410-READ-TEMP-STORAGE                       34320001
343300     END-IF.                                                      34330001
343400     MOVE +1            TO ASC-BLK-SUB.                           34340001
343500     COMPUTE ASC-ITEM-SUB =                                       34350001
343600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              34360001
343700         + PC-ITEMS-PER-PANEL).                                   34370001
343800*                                                                 34380001
343900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        34390001
344000         ADD +1         TO ASC-BLK-SUB                            34400001
344100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            34410001
344200     END-IF.                                                      34420001
344300*                                                                 34430001
344400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           34440001
344500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                34450001
344600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        34460001
344700     PERFORM 4420-FORMAT-LIST-LINES                               34470001
344800         VARYING PV-SUB                                           34480001
344900         FROM PC-ITEMS-PER-PANEL BY -1                            34490001
345000         UNTIL PV-SUB < +1.                                       34500001
345100*                                                                 34510001
345200     COMPUTE ASC-ITEMS-DISPLAYED =                                34520001
345300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          34530001
345400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    34540001
345500                                      ASTRTITO.                   34550001
345600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    34560001
345700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    34570001
345800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34580001
345900                                   TO ASELITO.                    34590001
346000                                                                  34600051
346100*  HEADING FIELDS AFTER THIS POINT                                34610001
346200                                                                  34620001
346300     MOVE ASC-OPER-UNT-ID            TO  AOPERO.                  34630001
346400     MOVE ASC-OPER-UNT-NAME          TO  AOPRNMEO.                34640001
346500     MOVE ASC-DOOR-ID                TO  ADOORO.                  34650001
346600     MOVE ASC-DOOR-DESC              TO  ADRDESCO.                34660001
346700     MOVE ASC-DOOR-TYPE-DESC         TO  ADRTYPO                  34670001
346800     MOVE ASC-OPEN-OTBND-TRIP        TO  ATRIPO.                  34680001
346900     MOVE ASC-TRIP-DEST-OPER         TO  ADESTO.                  34690001
347000     MOVE ASC-OPEN-TRLR-SRL          TO  ATRLRO.                  34700001
347100                                                                  34710001
347200*                                                                 34720001
347300     IF  DP020-MSG-NUMBER-X = SPACE                               34730001
347400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  34740001
347500*            --- MORE ITEMS TO DISPLAY ----                       34750001
347600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            34760001
347700             SET DP020-MSG-INFORMATIONAL TO TRUE                  34770001
347800         END-IF                                                   34780001
347900     END-IF.                                                      34790001
348000*----------------------------------------------------------------*34800001
348100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *34810001
348200*----------------------------------------------------------------*34820001
348300                                                                  34830001
348400 4410-READ-TEMP-STORAGE.                                          34840001
348500                                                                  34850001
348600     EXEC CICS                                                    34860001
348700         READQ TS                                                 34870001
348800             QUEUE (ASC-LIST-QUEUE-NAME)                          34880001
348900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34890001
349000             ITEM  (PV-BLOCK-NUMBER)                              34900001
349100             RESP  (PV-CICS-RESP)                                 34910001
349200     END-EXEC.                                                    34920001
349300                                                                  34930001
349400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       34940001
349500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     34950001
349600         CONTINUE                                                 34960001
349700     ELSE                                                         34970001
349800         SET DP013-CICS-ABEND     TO TRUE                         34980001
349900         SET DP013-NO-ROLLBACK    TO TRUE                         34990001
350000         MOVE '4410-READ-TEMP-STORAGE'                            35000001
350100                                  TO DP013-PARAGRAPH              35010001
350200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      35020001
350300                                  TO DP013-MESSAGE-TEXT(1)        35030001
350400         PERFORM DP013-0000-PROCESS-ABEND                         35040001
350500     END-IF.                                                      35050001
350600                                                                  35060001
350700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35070001
350800*                                                                 35080001
350900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         35090001
351000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               35100001
351100     END-IF.                                                      35110001
351200                                                                  35120051
351300*----------------------------------------------------------------*35130001
351400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *35140001
351500*----------------------------------------------------------------*35150001
351600                                                                  35160001
351700 4420-FORMAT-LIST-LINES.                                          35170001
351800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      35180001
351900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                35190001
352000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           35200001
352100         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           35210001
352200         MOVE SPACE              TO MR-SELECTI (PV-SUB)           35220001
352300                                    MR-ACTION (PV-SUB)            35230001
352400*    YOUR FIELDS GO AFTER THIS POINT                              35240001
352500                                    MR-SML (PV-SUB)               35250001
352600                                    MR-DEST-NBR (PV-SUB)          35260001
352700                                    MR-CREATE (PV-SUB)            35270001
352800                                    MR-PO-RCVR (PV-SUB)           35280001
352900                                    MR-LOAD-STATUS (PV-SUB)       35290001
353000                                    MR-ACTV-CDE (PV-SUB)          35300001
353100                                    MR-STAT-DATE (PV-SUB)         35310001
353200                                    MR-STAT-TIME (PV-SUB)         35320001
353300                                    MR-TRLR-SRL-NBR (PV-SUB)      35330001
353400     ELSE                                                         35340001
353500         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      35350001
353600                                                   > SPACE        35360001
353700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 35370001
353800                                 TO MR-SELECTI (PV-SUB)           35380001
353900         ELSE                                                     35390001
354000             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      35400001
354100                                 TO MR-SELECTI (PV-SUB)           35410001
354200         END-IF                                                   35420001
354300*                                                                 35430001
354400         IF  DP030-SET-CURSOR-TRAILER                             35440001
354500             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)35450001
354600                 > SPACE)                                         35460001
354700               OR (PV-SUB = 1))                                   35470001
354800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               35480001
354900                MOVE -1          TO MR-SELECTL (PV-SUB)           35490001
355000             END-IF                                               35500001
355100         END-IF                                                   35510001
355200*                                                                 35520001
355300         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           35530001
355400             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           35540001
355500                                 TO MR-ACTION (PV-SUB)            35550001
355600*    AND ALSO HERE                                                35560001
355700                                                                  35570001
355800         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               35580001
355900                                            TO MR-ACTION (PV-SUB) 35590001
356000         MOVE ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB)                  35600001
356100                                               TO MR-SML (PV-SUB) 35610001
356200         MOVE ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             35620001
356300                                          TO MR-DEST-NBR (PV-SUB) 35630001
356400         MOVE ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)               35640001
356500                                            TO MR-CREATE (PV-SUB) 35650001
356600         MOVE ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          35660001
356700                                          TO MR-PO-RCVR (PV-SUB)  35670001
356800         MOVE ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)          35680001
356900                                       TO MR-LOAD-STATUS (PV-SUB) 35690001
357000         MOVE ASC-ACTV-CDE (ASC-BLK-SUB ASC-ITEM-SUB)             35700001
357100                                          TO MR-ACTV-CDE (PV-SUB) 35710001
357200         MOVE ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB)            35720001
357300                                         TO MR-STAT-DATE (PV-SUB) 35730001
357400         MOVE ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            35740001
357500                                         TO MR-STAT-TIME (PV-SUB) 35750001
357600         MOVE ASC-TRLR-SRL-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)       35760001
357700                                      TO MR-TRLR-SRL-NBR (PV-SUB) 35770001
357800         EVALUATE TRUE                                            35780001
357900             WHEN ASC-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)     35790001
358000                   PERFORM 3250-CHANGE-ATTRIBUTES                 35800001
358100             WHEN ASC-NO-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)  35810001
358200                   PERFORM 3255-CHANGE-ATTRIBUTES-BACK            35820001
358300             WHEN ASC-INACTIVE-CRTN (ASC-BLK-SUB ASC-ITEM-SUB)    35830001
358400                   PERFORM 3255-CHANGE-ATTRIBUTES-BACK            35840001
358500                   MOVE DP015-YELLOW TO MR-ACTV-CDEC (PV-SUB)     35850001
358600             WHEN ASC-ACTIVE-CRTN (ASC-BLK-SUB ASC-ITEM-SUB)      35860001
358700                   PERFORM 3255-CHANGE-ATTRIBUTES-BACK            35870001
358800         END-EVALUATE                                             35880001
358900                                                                  35890008
359100         IF   ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) = 'I'        35910008
359200               PERFORM 3250-CHANGE-ATTRIBUTES                     35920008
359300         END-IF                                                   35930008
359500     END-IF.                                                      35950001
359600     SUBTRACT +1 FROM ASC-ITEM-SUB                                35960001
359700     IF  ASC-ITEM-SUB < + 1                                       35970001
359800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  35980001
359900         MOVE +1                 TO ASC-BLK-SUB                   35990001
360000     END-IF.                                                      36000001
360100******************************************************************36010001
360200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **36020001
360300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **36030001
360400** ISSUE A WARNING.                                             **36040001
360500******************************************************************36050001
360600 4430-CHECK-FOR-BEGIN-AND-END.                                    36060001
360700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       36070001
360800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     36080001
360900*            -- NO END-OF-RANGE SPECFIED ---                      36090001
361000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            36100001
361100             SET DP020-MSG-WARNING TO TRUE                        36110001
361200             PERFORM 4431-POSITION-AT-WARNING                     36120001
361300         END-IF                                                   36130001
361400     ELSE                                                         36140001
361500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     36150001
361600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                36160001
361700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            36170001
361800             SET DP020-MSG-WARNING TO TRUE                        36180001
361900             PERFORM 4431-POSITION-AT-WARNING                     36190001
362000         END-IF                                                   36200001
362100     END-IF.                                                      36210001
362200******************************************************************36220001
362300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **36230001
362400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **36240001
362500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **36250001
362600** POSITION THE CURSOR THERE.                                   **36260001
362700******************************************************************36270001
362800 4431-POSITION-AT-WARNING.                                        36280001
362900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 36290001
363000                    - PV-TOP-ITEM + 1.                            36300001
363100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36310001
363200         CONTINUE                                                 36320001
363300     ELSE                                                         36330001
363400         SET DP030-SET-CURSOR-APPL-1                              36340001
363500                                   TO TRUE                        36350001
363600         MOVE -1                   TO MR-SELECTL (PV-SUB)         36360001
363700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         36370001
363800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         36380001
363900     END-IF.                                                      36390001
364000*                                                                 36400001
364100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   36410001
364200                    - PV-TOP-ITEM + 1.                            36420001
364300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36430001
364400         CONTINUE                                                 36440001
364500     ELSE                                                         36450001
364600         SET DP030-SET-CURSOR-APPL-1                              36460001
364700                                   TO TRUE                        36470001
364800         MOVE -1                   TO MR-SELECTL (PV-SUB)         36480001
364900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         36490001
365000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         36500001
365100     END-IF.                                                      36510001
365200                                                                  36520051
365300*----------------------------------------------------------------*36530001
365400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *36540001
365500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *36550001
365600* FOR THE SELECTED ITEMS QUEUE.                                  *36560001
365700*                                                                *36570001
365800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *36580001
365900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *36590001
366000* THE ARRAY IS FULL.                                             *36600001
366100*----------------------------------------------------------------*36610001
366200                                                                  36620001
366300 5000-PREPARE-SEL-QUEUE.                                          36630001
366400                                                                  36640001
366500     MOVE +1                   TO  ASC-BLK-SUB.                   36650001
366600     PERFORM 5100-WRITE-TEMP-STORAGE.                             36660001
366700     ADD +1                    TO  ASC-BLK-SUB.                   36670001
366800     PERFORM 5100-WRITE-TEMP-STORAGE.                             36680001
366900                                                                  36690001
367000     MOVE ASC-SEL-QUEUE-NAME   TO  SU009-SEL-QUEUE-NAME.          36700001
367100     PERFORM 6010-DELETE-SEL-QUEUE.                               36710001
367200                                                                  36720001
367300     SET ASC-UPDATE-TSQ        TO  TRUE.                          36730001
367400                                                                  36740001
367500     SET SU010-IDX             TO  1.                             36750001
367600     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       36760001
367700     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        36770001
367800                                                                  36780001
367900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           36790001
368000             VARYING PV-ITEM                                      36800001
368100             FROM 1 BY 1                                          36810001
368200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     36820001
368300                                                                  36830001
368400     IF  SU010-IDX > 1                                            36840001
368500         PERFORM 5205-WRITE-SEL-QUEUE                             36850001
368600         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        36860001
368700     END-IF.                                                      36870001
368800                                                                  36880051
368900*----------------------------------------------------------------*36890001
369000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *36900001
369100*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *36910001
369200*----------------------------------------------------------------*36920001
369300                                                                  36930001
369400 5100-WRITE-TEMP-STORAGE.                                         36940001
369500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     36950001
369600                                   TO PV-LIST-ITEM-NUMBER.        36960001
369700     COMPUTE PV-BLOCK-NUMBER =                                    36970001
369800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    36980001
369900                                                                  36990001
370000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             37000001
370100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             37010001
370200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      37020001
370300             PERFORM 5105-REWRITE-ASC-LISTQ                       37030001
370400         END-IF                                                   37040001
370500     ELSE                                                         37050001
370600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       37060001
370700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            37070001
370800         PERFORM 5110-WRITE-ASC-LISTQ                             37080001
370900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   37090001
371000     END-IF.                                                      37100001
371100                                                                  37110001
371200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             37120001
371300******************************************************************37130001
371400** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **37140001
371500** SPECIFIC COMMAREA.                                           **37150001
371600******************************************************************37160001
371700 5105-REWRITE-ASC-LISTQ.                                          37170001
371800     EXEC CICS                                                    37180001
371900         WRITEQ TS                                                37190001
372000             QUEUE (ASC-LIST-QUEUE-NAME)                          37200001
372100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37210001
372200             ITEM  (PV-BLOCK-NUMBER)                              37220001
372300             REWRITE                                              37230001
372400             RESP  (PV-CICS-RESP)                                 37240001
372500     END-EXEC.                                                    37250001
372600                                                                  37260001
372700     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           37270001
372800         CONTINUE                                                 37280001
372900     ELSE                                                         37290001
373000         SET DP013-CICS-ABEND            TO TRUE                  37300001
373100         SET DP013-NO-ROLLBACK           TO TRUE                  37310001
373200         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       37320001
373300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     37330001
373400                                         TO DP013-MESSAGE-TEXT(1) 37340001
373500         PERFORM DP013-0000-PROCESS-ABEND                         37350001
373600     END-IF.                                                      37360001
373700                                                                  37370001
373800******************************************************************37380001
373900** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **37390001
374000** SPECIFIC COMMAREA.                                           **37400001
374100******************************************************************37410001
374200 5110-WRITE-ASC-LISTQ.                                            37420001
374300     EXEC CICS                                                    37430001
374400         WRITEQ TS                                                37440001
374500             QUEUE (ASC-LIST-QUEUE-NAME)                          37450001
374600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37460001
374700             ITEM  (PV-BLOCK-NUMBER)                              37470001
374800             RESP  (PV-CICS-RESP)                                 37480001
374900     END-EXEC.                                                    37490001
375000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      37500001
375100         SET DP013-CICS-ABEND      TO TRUE                        37510001
375200         SET DP013-NO-ROLLBACK     TO TRUE                        37520001
375300         MOVE '5110-WRITE-ASC-LISTQ'                              37530001
375400                                   TO DP013-PARAGRAPH             37540001
375500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           37550001
375600                                   TO DP013-MESSAGE-TEXT(1)       37560001
375700         PERFORM DP013-0000-PROCESS-ABEND                         37570001
375800     END-IF.                                                      37580001
375900                                                                  37590051
376000*----------------------------------------------------------------*37600001
376100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *37610001
376200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *37620001
376300*----------------------------------------------------------------*37630001
376400                                                                  37640001
376500 5200-FILL-SEL-QUEUE-RECORD.                                      37650001
376600                                                                  37660001
376700     PERFORM 6112-READ-LIST-QUEUE.                                37670001
376800                                                                  37680001
376900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37690001
377000         PERFORM                                                  37700001
377100         VARYING LQW-IDX                                          37710001
377200         FROM 1 BY 1                                              37720001
377300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37730001
377400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37740001
377500                                                                  37750001
377600             IF  LQW-SELECT (LQW-IDX)                             37760001
377700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              37770001
377800                                   TO SU010-ITEM (SU010-IDX)      37780001
377900*   FILL IN FIELDS HERE                                           37790001
378000                 MOVE LQW-SML (LQW-IDX)  TO SU010-SML (SU010-IDX) 37800001
378100                 MOVE LQW-DEST-NBR (LQW-IDX)  TO                  37810001
378200                                       SU010-DEST-NBR (SU010-IDX) 37820001
378300                 MOVE LQW-CREATE (LQW-IDX) TO                     37830001
378400                                         SU010-CREATE (SU010-IDX) 37840001
378500                 MOVE LQW-PO-RCVR (LQW-IDX)  TO                   37850001
378600                                        SU010-PO-RCVR (SU010-IDX) 37860001
378700                 MOVE LQW-LOAD-STATUS (LQW-IDX)                   37870001
378800                                 TO SU010-LOAD-STAT (SU010-IDX)   37880001
378900                 MOVE LQW-STAT-DATE (LQW-IDX) TO                  37890001
379000                                       SU010-STAT-DATE(SU010-IDX) 37900001
379100                 MOVE LQW-STAT-TIME (LQW-IDX) TO                  37910001
379200                                       SU010-STAT-TIME(SU010-IDX) 37920001
379300                 MOVE LQW-TRLR-SRL-NBR (LQW-IDX) TO               37930001
379400                                   SU010-TRLR-SRL-NBR (SU010-IDX) 37940001
379500                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 37950001
379600                 SET SU010-IDX UP BY 1                            37960001
379700                 IF  SU010-IDX > SU010-MAX-ITEMS                  37970001
379800                     PERFORM 5205-WRITE-SEL-QUEUE                 37980001
379900                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    37990001
380000                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         38000001
380100                     SET SU010-IDX TO  1                          38010001
380200                 END-IF                                           38020001
380300             END-IF                                               38030001
380400         END-PERFORM                                              38040001
380500     END-IF.                                                      38050001
380600                                                                  38060001
380700*----------------------------------------------------------------*38070001
380800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *38080001
380900*----------------------------------------------------------------*38090001
381000                                                                  38100001
381100 5205-WRITE-SEL-QUEUE.                                            38110001
381200                                                                  38120001
381300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38130001
381400                                   TO SU010-SELECTED-ITEMS.       38140001
381500                                                                  38150001
381600     EXEC CICS                                                    38160001
381700          WRITEQ TS                                               38170001
381800              QUEUE (ASC-SEL-QUEUE-NAME)                          38180001
381900              FROM  (SU010-SELECT-RECORD)                         38190001
382000              ITEM  (PV-SEL-QUEUE-ITEM)                           38200001
382100              RESP  (PV-CICS-RESP)                                38210001
382200     END-EXEC.                                                    38220001
382300                                                                  38230001
382400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38240001
382500         CONTINUE                                                 38250001
382600     ELSE                                                         38260001
382700         SET DP013-CICS-ABEND      TO TRUE                        38270001
382800         SET DP013-NO-ROLLBACK     TO TRUE                        38280001
382900         MOVE '5205-WRITE-SEL-QUEUE'                              38290001
383000                                   TO DP013-PARAGRAPH             38300001
383100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          38310001
383200                                   TO DP013-MESSAGE-TEXT(1)       38320001
383300         PERFORM DP013-0000-PROCESS-ABEND                         38330001
383400     END-IF.                                                      38340001
383500                                                                  38350051
383600******************************************************************38360001
383700** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **38370001
383800** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **38380001
383900** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **38390001
384000** THE USER.                                                    **38400001
384100******************************************************************38410001
384200 6000-REFRESH-PANEL-FROM-TEMP.                                    38420001
384300     IF  ASC-UPDATE-TSQ                                           38430001
384400         SET ASC-NO-TSQ-UPDATE TO TRUE                            38440001
384500         MOVE ZERO                 TO PV-SAVE-ITEM                38450001
384600                                      PV-SEL-QUEUE-ITEM           38460001
384700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        38470001
384800                                   TO PV-HOLD-SELECTED-ITEMS      38480001
384900         MOVE +1                   TO PV-ITEMS-PROCESSED          38490001
385000         PERFORM 6100-UPDATE-TSQ                                  38500001
385100             UNTIL PV-ITEMS-PROCESSED >                           38510001
385200                                     PV-HOLD-SELECTED-ITEMS       38520001
385300         PERFORM 6010-DELETE-SEL-QUEUE                            38530001
385400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         38540001
385500                    ASC-BLOCK-ENTRIES (2)                         38550001
385600     END-IF.                                                      38560001
385700                                                                  38570001
385800*----------------------------------------------------------------*38580001
385900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *38590001
386000*----------------------------------------------------------------*38600001
386100 6010-DELETE-SEL-QUEUE.                                           38610001
386200                                                                  38620001
386300     EXEC CICS                                                    38630001
386400         DELETEQ TS                                               38640001
386500             QUEUE (ASC-SEL-QUEUE-NAME)                           38650001
386600             RESP  (PV-CICS-RESP)                                 38660001
386700     END-EXEC.                                                    38670001
386800*                                                                 38680001
386900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      38690001
387000        (PV-CICS-RESP = DFHRESP(QIDERR)))                         38700001
387100         CONTINUE                                                 38710001
387200     ELSE                                                         38720001
387300         SET DP013-CICS-ABEND TO TRUE                             38730001
387400         SET DP013-NO-ROLLBACK TO TRUE                            38740001
387500         MOVE '6010-DELETE-SEL-QUEUE'                             38750001
387600                        TO DP013-PARAGRAPH                        38760001
387700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         38770001
387800                        TO DP013-MESSAGE-TEXT (1)                 38780001
387900         PERFORM DP013-0000-PROCESS-ABEND                         38790001
388000     END-IF.                                                      38800001
388100                                                                  38810001
388200*----------------------------------------------------------------*38820001
388300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *38830001
388400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *38840001
388500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *38850001
388600*    THE TEMP QUEUE.                                             *38860001
388700*----------------------------------------------------------------*38870001
388800                                                                  38880001
388900 6100-UPDATE-TSQ.                                                 38890001
389000                                                                  38900001
389100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             38910001
389200     PERFORM 6105-READ-SEL-QUEUE.                                 38920001
389300     PERFORM                                                      38930001
389400         VARYING SU010-IDX                                        38940001
389500         FROM 1 BY 1                                              38950001
389600         UNTIL ((PV-ITEMS-PROCESSED >                             38960001
389700                              PV-HOLD-SELECTED-ITEMS)             38970001
389800         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             38980001
389900         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  38990001
390000             PERFORM 6110-PROCESS-ITEMS                           39000001
390100         END-IF                                                   39010001
390200         ADD +1                TO PV-ITEMS-PROCESSED              39020001
390300     END-PERFORM.                                                 39030001
390400     PERFORM 6111-WRITE-LIST-QUEUE.                               39040001
390500*----------------------------------------------------------------*39050001
390600*    READ THE LIST QUEUE RECORD.                                 *39060001
390700*----------------------------------------------------------------*39070001
390800                                                                  39080001
390900 6105-READ-SEL-QUEUE.                                             39090001
391000                                                                  39100001
391100     EXEC CICS                                                    39110001
391200          READQ TS                                                39120001
391300              QUEUE (ASC-SEL-QUEUE-NAME)                          39130001
391400              INTO  (SU010-SELECT-RECORD)                         39140001
391500              ITEM  (PV-SEL-QUEUE-ITEM)                           39150001
391600              RESP  (PV-CICS-RESP)                                39160001
391700     END-EXEC.                                                    39170001
391800*                                                                 39180001
391900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39190001
392000         CONTINUE                                                 39200001
392100     ELSE                                                         39210001
392200         SET DP013-CICS-ABEND      TO  TRUE                       39220001
392300         SET DP013-NO-ROLLBACK     TO  TRUE                       39230001
392400         MOVE '6105-READ-SEL-QUEUE'                               39240001
392500                                   TO  DP013-PARAGRAPH            39250001
392600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           39260001
392700                                   TO  DP013-MESSAGE-TEXT(1)      39270001
392800         PERFORM DP013-0000-PROCESS-ABEND                         39280001
392900     END-IF.                                                      39290001
393000                                                                  39300051
393100*----------------------------------------------------------------*39310001
393200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*39320001
393300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*39330001
393400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *39340001
393500*----------------------------------------------------------------*39350001
393600                                                                  39360001
393700 6110-PROCESS-ITEMS.                                              39370001
393800                                                                  39380001
393900     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          39390001
394000                     / PC-ITEMS-PER-PANEL).                       39400001
394100                                                                  39410001
394200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           39420001
394300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          39430001
394400             PERFORM 6111-WRITE-LIST-QUEUE                        39440001
394500         END-IF                                                   39450001
394600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    39460001
394700                                                                  39470001
394800         PERFORM 6112-READ-LIST-QUEUE                             39480001
394900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               39490001
395000             CONTINUE                                             39500001
395100         END-IF                                                   39510001
395200     END-IF.                                                      39520001
395300                                                                  39530001
395400     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     39540001
395500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              39550001
395600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         39560001
395700     MOVE LQW-SELECTED-SW (PV-SUB)                                39570001
395800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  39580001
395900     EVALUATE TRUE                                                39590001
396000         WHEN SU010-INQ (SU010-IDX)                               39600001
396100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             39610001
396200                                                                  39620001
396300         WHEN SU010-UPD (SU010-IDX)                               39630001
396400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             39640001
396500                                                                  39650001
396600         WHEN SU010-DEL (SU010-IDX)                               39660001
396700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             39670001
396800                                                                  39680001
396900         WHEN SU010-ERR (SU010-IDX)                               39690001
397000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             39700001
397100     END-EVALUATE.                                                39710001
397200                                                                  39720001
397300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                39730001
397400                                                                  39740001
397500*----------------------------------------------------------------*39750001
397600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *39760001
397700*----------------------------------------------------------------*39770001
397800                                                                  39780001
397900 6111-WRITE-LIST-QUEUE.                                           39790001
398000                                                                  39800001
398100     EXEC CICS                                                    39810001
398200         WRITEQ TS                                                39820001
398300             QUEUE (ASC-LIST-QUEUE-NAME)                          39830001
398400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     39840001
398500             ITEM  (PV-SAVE-ITEM)                                 39850001
398600             REWRITE                                              39860001
398700             RESP  (PV-CICS-RESP)                                 39870001
398800     END-EXEC.                                                    39880001
398900*                                                                 39890001
399000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39900001
399100         CONTINUE                                                 39910001
399200     ELSE                                                         39920001
399300         SET DP013-CICS-ABEND  TO  TRUE                           39930001
399400         SET DP013-NO-ROLLBACK TO  TRUE                           39940001
399500         MOVE '6111-WRITE-LIST-QUEUE'                             39950001
399600                               TO  DP013-PARAGRAPH                39960001
399700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  39970001
399800                               TO  DP013-MESSAGE-TEXT(1)          39980001
399900         PERFORM DP013-0000-PROCESS-ABEND                         39990001
400000     END-IF.                                                      40000001
400100                                                                  40010001
400200                                                                  40020051
400300*----------------------------------------------------------------*40030001
400400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*40040001
400500*----------------------------------------------------------------*40050001
400600                                                                  40060001
400700 6112-READ-LIST-QUEUE.                                            40070001
400800                                                                  40080001
400900     EXEC CICS                                                    40090001
401000         READQ TS                                                 40100001
401100             QUEUE (ASC-LIST-QUEUE-NAME)                          40110001
401200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     40120001
401300             ITEM  (PV-ITEM)                                      40130001
401400             RESP  (PV-CICS-RESP)                                 40140001
401500     END-EXEC.                                                    40150001
401600*                                                                 40160001
401700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40170001
401800         CONTINUE                                                 40180001
401900     ELSE                                                         40190001
402000         SET DP013-CICS-ABEND        TO TRUE                      40200001
402100         SET DP013-NO-ROLLBACK       TO TRUE                      40210001
402200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           40220001
402300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    40230001
402400                                     TO DP013-MESSAGE-TEXT(1)     40240001
402500         PERFORM DP013-0000-PROCESS-ABEND                         40250001
402600     END-IF.                                                      40260001
402700                                                                  40270001
402800                                                                  40280051
402900 7000-SELECT-OUTBND-LOC.                                          40290001
403000     EXEC SQL                                                     40300001
403100         SELECT UNLO.ACTV_CDE                                     40310001
403200         INTO :SUT00027-ACTV-CDE                                  40320001
403300         FROM SUT_OTBND_LOC UNLO                                  40330001
403400         WHERE UNLO.SHIPT_UNT_ID = :SUCRDV-SHIPT-UNT-ID           40340001
403500           AND UNLO.LOC_NBR      = :DK-OPER-UNT-ID                40350001
403600         AND                                                      40360001
403700             UNLO.CRE_TMST =                                      40370001
403800             (SELECT MAX(UNLO1.CRE_TMST)                          40380001
403900                 FROM SUT_OTBND_LOC UNLO1                         40390001
404000              WHERE UNLO1.SHIPT_UNT_ID = UNLO.SHIPT_UNT_ID        40400001
404100                    AND UNLO1.LOC_NBR      = :DK-OPER-UNT-ID)     40410001
404200     END-EXEC.                                                    40420001
404300                                                                  40430001
404400     EVALUATE TRUE                                                40440001
404500         WHEN SQLCODE = ZERO                                      40450001
404600         WHEN SQLCODE = +100                                      40460001
404700             CONTINUE                                             40470001
404800         WHEN SQLWARN0 NOT = SPACE                                40480001
404900         WHEN SQLCODE NOT = ZERO                                  40490001
405000              MOVE '7000-SELECT-OUTBND-LOC' TO DP013-PARAGRAPH    40500001
405100              MOVE 'GET ACTV-CDE FROM SCANNED CTN'                40510001
405200                               TO DP013-MESSAGE-TEXT (1)          40520001
405300              MOVE SQLCA       TO DP013-SQLCA                     40530001
405400              MOVE 'SUT00027'  TO DP013-DB2-TABLE-NAME (1)        40540001
405500              SET DP013-DB2-ABEND TO TRUE                         40550001
405600              PERFORM DP013-0000-PROCESS-ABEND                    40560001
405700     END-EVALUATE.                                                40570001
405800                                                                  40580001
405900                                                                  40590051
406000 7300-ANY-OTHER-TRLRS-THIS-DOOR.                                  40600001
406100                                                                  40610001
406200*    CHECK TO SEE IF ANY OTHER TRAILERS WERE EVER OPENED AT THIS  40620001
406300*    DOOR.  AND HAD CUTOFFS FROM THE CONVEYOR SYSTEM.             40630001
406400*            IF NONE ARE FOUND, MESSAGE 2794 WILL NOT BE SENT.    40640001
406500*    THERE ARE NO PREVIOUSLY DIVERTED CARTONS BECAUSE THIS IS     40650001
406600*    IN EFFECT A NEW DOOR.  IF PREVIOUS TRAILERS ARE FOUND THEN   40660001
406700*    THE EDITING IS VALID AND THE ERROR WILL BE ISSUED.           40670001
406800*    PV-TRLR-COUNT CAN BE EITHER 1 OR ZERO DEPENDING ON THE       40680001
406900*    RESULT OF THE CALL.                                          40690001
407000                                                                  40700001
407100     MOVE ZERO                        TO PV-TRLR-COUNT            40710001
407200                                                                  40720001
407300     EXEC SQL                                                     40730001
407400                                                                  40740001
407500         SELECT COUNT(DISTINCT(OBTS.OTBND_TRIP_ID))               40750001
407600           INTO :PV-TRLR-COUNT                                    40760001
407700           FROM TSUOBTS OBTS                                      40770001
407800               ,TSUCDOT CDOT                                      40780001
407900         WHERE                                                    40790001
408000             OBTS.STAT_OPER_UNT_ID = :DK-OPER-UNT-ID              40800001
408100         AND OBTS.DOOR_ID          = :DK-DOOR-ID                  40810001
408200         AND OBTS.OTBND_TRIP_ID   <> :DK-OUTBOUND-TRIP-ID         40820001
408300         AND OBTS.OTBND_TRIP_ID    = CDOT.OTBND_TRIP_ID           40830001
408400                                                                  40840001
408500     END-EXEC.                                                    40850001
408600                                                                  40860001
408700     EVALUATE TRUE                                                40870001
408800         WHEN SQLCODE = ZERO                                      40880001
408900         WHEN SQLCODE = +100                                      40890001
409000         WHEN SQLCODE = -305                                      40900001
409100             CONTINUE                                             40910001
409200         WHEN SQLWARN0 NOT = SPACE                                40920001
409300         WHEN SQLCODE NOT = ZERO                                  40930001
409400              MOVE '7300-ANY-OTHER-TRLRS-THIS-DOOR'               40940001
409500                                             TO DP013-PARAGRAPH   40950001
409600              MOVE 'SELECT OTHER TRIPS AT THIS DOOR'              40960001
409700                               TO DP013-MESSAGE-TEXT (1)          40970001
409800              MOVE SQLCA       TO DP013-SQLCA                     40980001
409900              MOVE 'TSUOBTS'   TO DP013-DB2-TABLE-NAME (1)        40990001
410000              MOVE 'TSUCDOT'   TO DP013-DB2-TABLE-NAME (2)        41000001
410100              SET DP013-DB2-ABEND TO TRUE                         41010001
410200              PERFORM DP013-0000-PROCESS-ABEND                    41020001
410300     END-EVALUATE.                                                41030001
410400                                                                  41040001
410500 7310-CHECK-EXISTING-CUTOFFS.                                     41050001
410600     MOVE ZERO                        TO PV-CUTOFF-COUNT          41060001
410700                                                                  41070001
410800     EXEC SQL                                                     41080001
411000         SELECT COUNT(*)                                          41100001
411100         INTO                                                     41110001
411200             :PV-CUTOFF-COUNT                                     41120001
411300         FROM                                                     41130001
411400             TSUCDOT DOT                                          41140001
411500         WHERE                                                    41150001
411600             DOT.OTBND_TRIP_ID   = :DK-OUTBOUND-TRIP-ID           41160001
411700         AND DOT.OPER_UNT_ID     = :DK-OPER-UNT-ID                41170001
411800         AND DOT.DOOR_ID         = :DK-DOOR-ID                    41180001
412000     END-EXEC.                                                    41200001
412100                                                                  41210001
412200     EVALUATE TRUE                                                41220001
412300         WHEN SQLCODE = ZERO                                      41230001
412400         WHEN SQLCODE = +100                                      41240001
412500         WHEN SQLCODE = -305                                      41250001
412600             CONTINUE                                             41260001
412700         WHEN SQLWARN0 NOT = SPACE                                41270001
412800         WHEN SQLCODE NOT = ZERO                                  41280001
412900              MOVE '7310-CHECK-EXISTING-CUTOFFS'                  41290001
413000                                             TO DP013-PARAGRAPH   41300001
413100              MOVE 'SELECT OTHER TRIPS AT THIS DOOR'              41310001
413200                               TO DP013-MESSAGE-TEXT (1)          41320001
413300              MOVE SQLCA       TO DP013-SQLCA                     41330001
413400              MOVE 'TSUCDOT'   TO DP013-DB2-TABLE-NAME (1)        41340001
413500              SET DP013-DB2-ABEND TO TRUE                         41350001
413600              PERFORM DP013-0000-PROCESS-ABEND                    41360001
413700     END-EVALUATE.                                                41370001
413800                                                                  41380001
413900 7320-FIND-LAST-END-CUTOFF.                                       41390001
414000**    FIND LAST CLOSED CUTOFF AT THE GIVEN DOOR                   41400001
414100                                                                  41410001
414200     EXEC SQL                                                     41420001
414300         SELECT MAX(DOT.END_DIVERT_TMST)                          41430001
414400         INTO :SUCDOT-END-DIVERT-TMST                             41440001
414500         FROM                                                     41450001
414600             TSUCDOT DOT                                          41460001
414700         WHERE                                                    41470001
414800                DOT.OPER_UNT_ID     = :DK-OPER-UNT-ID             41480001
414900            AND DOT.DOOR_ID         = :DK-DOOR-ID                 41490001
415000     END-EXEC.                                                    41500001
415100                                                                  41510001
415200     EVALUATE TRUE                                                41520001
415300         WHEN SQLCODE = ZERO                                      41530001
415400             CONTINUE                                             41540001
415500         WHEN SQLCODE = +100                                      41550001
415600         WHEN SQLCODE = -305                                      41560001
415700             MOVE PC-LOW-TMST  TO SUCDOT-END-DIVERT-TMST          41570001
415800         WHEN SQLWARN0 NOT = SPACE                                41580001
415900         WHEN SQLCODE NOT = ZERO                                  41590001
416000              MOVE '7320-FIND-LAST-END-CUTOFF'                    41600001
416100                                             TO DP013-PARAGRAPH   41610001
416200              MOVE 'FIND THE TIMESTAMP FOR LAST CUTOFF'           41620001
416300                               TO DP013-MESSAGE-TEXT (1)          41630001
416400              MOVE SQLCA       TO DP013-SQLCA                     41640001
416500              MOVE 'TSUCDOT'   TO DP013-DB2-TABLE-NAME (1)        41650001
416600              SET DP013-DB2-ABEND TO TRUE                         41660001
416700              PERFORM DP013-0000-PROCESS-ABEND                    41670001
416800     END-EVALUATE.                                                41680001
416900                                                                  41690001
417000 7330-FIND-NEXT-DIVERTED-CTN.                                     41700001
417100                                                                  41710001
417200**    FIND NEXT DIVERTED CARTON AT THE GIVEN DOOR                 41720001
417300**    THE TIMESTAMP IS SELECTED BY THE SQL IN SUK561E PRIOR TO THI41730001
417400                                                                  41740001
417500     EXEC SQL                                                     41750001
417600          SELECT RDV1.SHIPT_UNT_ID                                41760006
417700            INTO :SUCRDV-SHIPT-UNT-ID                             41770006
417800            FROM TSUCRDV RDV1                                     41780006
417900            WHERE RDV1.OPER_UNT_ID  = :DK-OPER-UNT-ID             41790006
418000              AND RDV1.DOOR_ID      = :DK-DOOR-ID                 41800006
418100              AND RDV1.ACTV_CDE     = 'A'                         41810006
418200              AND RDV1.DIVERT_TMST  =                             41820006
418300                  (SELECT MIN(RDV.DIVERT_TMST)                    41830006
418400                     FROM TSUCRDV RDV                             41840006
418500                    WHERE RDV.OPER_UNT_ID = :DK-OPER-UNT-ID       41850006
418600                      AND RDV.DOOR_ID     = :DK-DOOR-ID           41860006
418700                      AND RDV.DIVERT_TMST >                       41870006
418800                                           :SUCDOT-END-DIVERT-TMST41880006
418900                      AND RDV.ACTV_CDE    = 'A'                   41890006
419000                      AND RDV.DIVERT_TMST =                       41900006
419100                          (SELECT MAX(C.DIVERT_TMST)              41910006
419200                             FROM TSUCRDV C                       41920007
419300                            WHERE C.OPER_UNT_ID  = :DK-OPER-UNT-ID41930006
419400                              AND C.DOOR_ID      = :DK-DOOR-ID    41940006
419500                              AND C.SHIPT_UNT_ID =                41950006
419600                                                 RDV.SHIPT_UNT_ID 41960006
419700                              AND C.ACTV_CDE     = 'A')           41970006
419800                  )                                               41980006
419900                                                                  41990001
420000     END-EXEC.                                                    42000001
420100                                                                  42010001
420200     EVALUATE TRUE                                                42020001
420300         WHEN SQLCODE = ZERO                                      42030001
420400             MOVE 1                TO ASC-NUMBER-OF-ITEMS-READ    42040001
420500                                      ASC-LIST-ITEM-NUMBER        42050001
420600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42060001
420700         WHEN SQLCODE = +100                                      42070001
420800         WHEN SQLCODE = -305                                      42080001
420900             MOVE ZERO          TO SUCRDV-SHIPT-UNT-ID            42090001
421000             SET PS-ERROR          TO TRUE                        42100001
421100         WHEN SQLWARN0 NOT = SPACE                                42110001
421200         WHEN SQLCODE NOT = ZERO                                  42120001
421300              MOVE '7330-FIND-NEXT-DIVERTED-CTN'                  42130001
421400                                             TO DP013-PARAGRAPH   42140001
421500              MOVE 'FIND NEXT CTN AFTER CUTOFF'                   42150001
421600                               TO DP013-MESSAGE-TEXT (1)          42160001
421700              MOVE SQLCA       TO DP013-SQLCA                     42170001
421800              MOVE 'TSUCRDV'   TO DP013-DB2-TABLE-NAME (1)        42180001
421900              SET DP013-DB2-ABEND TO TRUE                         42190001
422000              PERFORM DP013-0000-PROCESS-ABEND                    42200001
422100     END-EVALUATE.                                                42210001
422200                                                                  42220001
422300 7340-GET-SUCDRV-INFO.                                            42230001
422400                                                                  42240001
422500**    GET ADDITIONAL INFO FROM THE DIVERTED CARTON                42250001
422600                                                                  42260001
422700     EXEC SQL                                                     42270001
422800        SELECT                                                    42280001
422900            RDV.DEST_OPER_UNT_ID                                  42290001
423000         ,  RDV.DIVERT_TMST                                       42300001
423100             INTO :SUCRDV-DEST-OPER-UNT-ID                        42310001
423200         ,        :SUCRDV-DIVERT-TMST                             42320001
423300            FROM                                                  42330001
423400            TSUCRDV RDV                                           42340001
423500        WHERE                                                     42350001
423600            RDV.SHIPT_UNT_ID    = :SUCRDV-SHIPT-UNT-ID            42360001
423700        AND RDV.ACTV_CDE        = 'A'                             42370001
423800        AND RDV.DIVERT_TMST =                                     42380001
423900         (SELECT MAX(RDV1.DIVERT_TMST)                            42390001
424000             FROM TSUCRDV RDV1                                    42400001
424100             WHERE                                                42410001
424200                RDV1.SHIPT_UNT_ID = RDV.SHIPT_UNT_ID)             42420001
424300     END-EXEC.                                                    42430001
424400                                                                  42440001
424500     EVALUATE TRUE                                                42450001
424600         WHEN SQLCODE = ZERO                                      42460001
424700             MOVE 1                TO ASC-NUMBER-OF-ITEMS-READ    42470001
424800                                      ASC-LIST-ITEM-NUMBER        42480001
424900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42490001
425000         WHEN SQLCODE = +100                                      42500001
425100         WHEN SQLCODE = -305                                      42510001
425200             MOVE ZERO          TO SUCRDV-SHIPT-UNT-ID            42520001
425300         WHEN SQLWARN0 NOT = SPACE                                42530001
425400         WHEN SQLCODE NOT = ZERO                                  42540001
425500              MOVE '7340-GET-SUCDRV-INFO'    TO DP013-PARAGRAPH   42550001
425600              MOVE 'GET MORE INFO FOR DIVERTED CTN'               42560001
425700                               TO DP013-MESSAGE-TEXT (1)          42570001
425800              MOVE SQLCA       TO DP013-SQLCA                     42580001
425900              MOVE 'TSUCRDV'   TO DP013-DB2-TABLE-NAME (1)        42590001
426000              SET DP013-DB2-ABEND TO TRUE                         42600001
426100              PERFORM DP013-0000-PROCESS-ABEND                    42610001
426200     END-EVALUATE.                                                42620001
426300                                                                  42630051
426400 7400-INSERT-WRKR-AUD.                                            42640001
426500     EXEC SQL                                                     42650001
426600         INSERT INTO SUT_TRIP_WRKR_AUD                            42660001
426700             (                                                    42670001
426800               OTBND_TRIP_ID                                      42680001
426900             , USR_ID                                             42690001
427000             , CRE_TMST                                           42700001
427100             , CRE_BY_PGM_NM                                      42710001
427200                 )                                                42720001
427300                                                                  42730001
427400             VALUES                                               42740001
427500                                                                  42750001
427600                 (                                                42760001
427700                 :DK-OUTBOUND-TRIP-ID                             42770001
427800             ,   :DP020-USERID                                    42780001
427900             ,   CURRENT TIMESTAMP                                42790001
428000             ,   :SUT00006-CRE-BY-PGM-NM                          42800001
428100                 )                                                42810001
428200     END-EXEC.                                                    42820001
428300                                                                  42830001
428400         EVALUATE TRUE                                            42840001
428500          WHEN SQLCODE = ZERO                                     42850001
428600             CONTINUE                                             42860001
428700          WHEN SQLCODE = -904                                     42870001
428800          WHEN SQLCODE = -911                                     42880001
428900          WHEN SQLCODE = -913                                     42890001
429000               SET  PS-ERROR                                      42900001
429100                    DP020-MSG-FATAL TO TRUE                       42910001
429200              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          42920001
429300          WHEN OTHER                                              42930001
429400               SET  PS-ERROR                                      42940001
429500                    DP020-MSG-FATAL TO TRUE                       42950001
429600              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          42960001
429700     END-EVALUATE.                                                42970001
429800                                                                  42980051
429900 8000-WRITE-CSSL.                                                 42990001
430000                                                                  43000001
430100     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH       43010001
430200     EXEC CICS                                                    43020001
430300         WRITEQ TD                                                43030001
430400         QUEUE  ('CSSL')                                          43040001
430500         FROM  (PV-CICS-MSG-AREA)                                 43050001
430600         LENGTH  (PV-COMMAREA-LENGTH)                             43060001
430700         RESP  (PV-CICS-RESP)                                     43070001
430800     END-EXEC.                                                    43080001
430900*-----------------------------------------------------------------43090001
431000*  READ THE LIST QUEUE RECORD                                     43100001
431100*-----------------------------------------------------------------43110001
431200 9100-READ-SEL-QUEUE.                                             43120001
431300                                                                  43130001
431400     EXEC CICS                                                    43140001
431500         READQ TS                                                 43150001
431600             QUEUE (ASC-SEL-QUEUE-NAME)                           43160001
431700             INTO  (SU010-SELECT-RECORD)                          43170001
431800             ITEM  (ASC-SEL-ITEM)                                 43180001
431900             RESP  (PV-CICS-RESP)                                 43190001
432000     END-EXEC.                                                    43200001
432100     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        43210001
432200         CONTINUE                                                 43220001
432300     ELSE                                                         43230001
432400         SET DP013-LOGIC-ABEND                                    43240001
432500             DP013-NO-ROLLBACK   TO   TRUE                        43250001
432600         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          43260001
432700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   43270001
432800                                 TO   DP013-MESSAGE-TEXT (1)      43280001
432900         PERFORM DP013-0000-PROCESS-ABEND                         43290001
433000     END-IF.                                                      43300001
433100                                                                  43310001
433200*-----------------------------------------------------------------43320001
433300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *43330001
433400*-----------------------------------------------------------------43340001
433500 9200-REWRITE-SEL-QUEUE.                                          43350001
433600                                                                  43360001
433700     EXEC CICS                                                    43370001
433800          WRITEQ TS                                               43380001
433900              QUEUE  (ASC-SEL-QUEUE-NAME)                         43390001
434000              FROM   (SU010-SELECT-RECORD)                        43400001
434100              ITEM   (ASC-SEL-ITEM)                               43410001
434200              RESP   (PV-CICS-RESP)                               43420001
434300              REWRITE                                             43430001
434400     END-EXEC.                                                    43440001
434500                                                                  43450001
434600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   43460001
434700         SET DP013-CICS-ABEND                                     43470001
434800             DP013-NO-ROLLBACK     TO TRUE                        43480001
434900         MOVE '9200-REWRITE-SEL-QUEUE'                            43490001
435000                                   TO DP013-PARAGRAPH             43500001
435100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   43510001
435200                                   TO DP013-MESSAGE-TEXT (1)      43520001
435300         PERFORM DP013-0000-PROCESS-ABEND                         43530001
435400     END-IF.                                                      43540001
435500                                                                  43550001
435600 9904-WRITE-CRTN-MODULE-MSG.                                      43560001
435700                                                                  43570016
435800     MOVE '4350'                      TO  PV-CTN-PARA             43580016
435900     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          43590016
436000     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           43600016
436100     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        43610016
436200     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      43620016
436300     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             43630016
436400     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        43640016
436500     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      43650016
436600                                                                  43660016
436700     EXEC CICS                                                    43670016
436800         WRITEQ TD                                                43680016
436900             QUEUE  ('CSSL')                                      43690016
437000             FROM   (PV-CARTON-MSG)                               43700016
437100             RESP   (PV-CICS-RESPONSE)                            43710016
437200     END-EXEC.                                                    43720016
437300                                                                  43730016
437400     EXEC CICS                                                    43740001
437500         WRITEQ TD                                                43750001
437600             QUEUE  ('CSSL')                                      43760001
437700             FROM   (PC046-CRA-RET-MSG)                           43770001
437800             RESP   (PV-CICS-RESPONSE)                            43780001
437900     END-EXEC.                                                    43790001
438000                                                                  43800001
438100***************************************************************** 43810001
438200* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 43820001
438300     COPY PCPD049.                                                43830001
438400*----------------------------------------------------------------*43840001
438500*    ABEND PROCESSOR MODULE                                      *43850001
438600*----------------------------------------------------------------*43860001
438700                                                                  43870001
438800     COPY DPPD013.                                                43880001
