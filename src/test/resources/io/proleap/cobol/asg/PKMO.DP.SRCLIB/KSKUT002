000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             KSKUT002.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           08-27-2012.                              00080002
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*                                                                *00120000
001300******************************************************************00130000
001400                                                                  00140000
001500******************************************************************00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700******************************************************************00170000
001800                                                                  00180000
001900 CONFIGURATION SECTION.                                           00190000
002000                                                                  00200000
002100 SOURCE-COMPUTER.        IBM-3090.                                00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT STORE-ORG-HIER-FILE                                   00280000
002900         ASSIGN TO INP01.                                         00290000
003000                                                                  00300000
003100     SELECT STORE-LOCATION-FILE                                   00310000
003200         ASSIGN TO INP02.                                         00320000
003210                                                                  00321000
003220     SELECT TERRITORY-FILE                                        00322000
003230         ASSIGN TO INP03.                                         00323000
003240                                                                  00324000
003250     SELECT REGION-FILE                                           00325000
003260         ASSIGN TO INP04.                                         00326000
003270                                                                  00327000
003280     SELECT DISTRICT-FILE                                         00328000
003290         ASSIGN TO INP05.                                         00329000
003300                                                                  00330000
003400     SELECT SRV-MGT-ORG-HIER-FILE                                 00340001
003500         ASSIGN TO OUT01.                                         00350000
003600                                                                  00360000
003700     SELECT ERROR-WARNING-FILE                                    00370000
003800         ASSIGN TO OUT02.                                         00380000
003900                                                                  00390000
004000******************************************************************00400000
004100 DATA DIVISION.                                                   00410000
004200******************************************************************00420000
004300                                                                  00430000
004400 FILE SECTION.                                                    00440000
004500                                                                  00450000
004600 FD  STORE-ORG-HIER-FILE                                          00460000
004700     RECORDING MODE IS F                                          00470000
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     BLOCK CONTAINS 0 RECORDS                                     00490000
005000     RECORD CONTAINS 40 CHARACTERS                                00500000
005100     DATA RECORD IS SO-STORE-ORG-HIER-RECORD.                     00510000
005200                                                                  00520000
005300 01  SO-STORE-ORG-HIER-RECORD    PIC X(40).                       00530000
005400                                                                  00540000
005500 FD  STORE-LOCATION-FILE                                          00550000
005600     RECORDING MODE IS F                                          00560000
005700     LABEL RECORDS ARE STANDARD                                   00570000
005800     BLOCK CONTAINS 0 RECORDS                                     00580000
005900     RECORD CONTAINS 687 CHARACTERS                               00590000
005910     DATA RECORD IS SL-STORE-LOCATION-RECORD.                     00591000
005920                                                                  00592000
005930 01  SL-STORE-LOCATION-RECORD    PIC X(687).                      00593000
005940                                                                  00594000
005950 FD  TERRITORY-FILE                                               00595000
005960     RECORDING MODE IS F                                          00596000
005970     LABEL RECORDS ARE STANDARD                                   00597000
005980     BLOCK CONTAINS 0 RECORDS                                     00598000
005990     RECORD CONTAINS 57 CHARACTERS                                00599000
006000     DATA RECORD IS TF-TERRITORY-RECORD.                          00600000
006100                                                                  00610000
006200 01  TF-TERRITORY-RECORD         PIC X(57).                       00620000
006300                                                                  00630000
006400 FD  REGION-FILE                                                  00640000
006500     RECORDING MODE IS F                                          00650000
006600     LABEL RECORDS ARE STANDARD                                   00660000
006700     BLOCK CONTAINS 0 RECORDS                                     00670000
006800     RECORD CONTAINS 62 CHARACTERS                                00680000
006900     DATA RECORD IS RF-REGION-RECORD.                             00690000
007000                                                                  00700000
007100 01  RF-REGION-RECORD            PIC X(62).                       00710000
007200                                                                  00720000
007300 FD  DISTRICT-FILE                                                00730000
007400     RECORDING MODE IS F                                          00740000
007500     LABEL RECORDS ARE STANDARD                                   00750000
007600     BLOCK CONTAINS 0 RECORDS                                     00760000
007700     RECORD CONTAINS 62 CHARACTERS                                00770000
007800     DATA RECORD IS DF-DISTRICT-RECORD.                           00780000
007900                                                                  00790000
008000 01  DF-DISTRICT-RECORD          PIC X(62).                       00800000
008100                                                                  00810000
008200 FD  SRV-MGT-ORG-HIER-FILE                                        00820001
008300     RECORDING MODE IS F                                          00830000
008400     LABEL RECORDS ARE STANDARD                                   00840000
008500     BLOCK CONTAINS 0 RECORDS                                     00850000
008600     RECORD CONTAINS 200 CHARACTERS                               00860000
008700     DATA RECORD IS SM-SRV-MGT-ORG-HIER-RECORD.                   00870001
008800                                                                  00880000
008900 01  SM-SRV-MGT-ORG-HIER-RECORD  PIC X(200).                      00890001
009000                                                                  00900000
009100 FD  ERROR-WARNING-FILE                                           00910000
009200     RECORDING MODE IS F                                          00920000
009300     LABEL RECORDS ARE STANDARD                                   00930000
009400     BLOCK CONTAINS 0 RECORDS                                     00940000
009500     RECORD CONTAINS 80 CHARACTERS                                00950000
009600     DATA RECORD IS EW-ERROR-WARNING-RECORD.                      00960000
009700                                                                  00970000
009800 01  EW-ERROR-WARNING-RECORD     PIC X(80).                       00980000
009900                                                                  00990000
010000 WORKING-STORAGE SECTION.                                         01000000
010100                                                                  01010000
010200*                                                                 01020000
010300*  ORGANIZATION HIERARCHY EXTRACT RECORD LAYOUT FOR IDENTITY      01030000
010400*  MANAGEMENT.                                                    01040000
010500*                                                                 01050000
010600                                                                  01060000
010700     COPY SERD006.                                                01070000
010800                                                                  01080000
010900*                                                                 01090000
011000*  RMS SOR EXTRACT FOR STORE/STORE_ATTRIBUTE - STORE              01100000
011100*                                                                 01110000
011200                                                                  01120000
011300     COPY HORD013.                                                01130000
011400                                                                  01140000
011500*                                                                 01150000
011600*  RMS SOR EXTRACT FOR TERRITORIES - AREA TABLE                   01160000
011700*                                                                 01170000
011800                                                                  01180000
011900     COPY HORD010.                                                01190000
012000                                                                  01200000
012100*                                                                 01210000
012200*  RMS SOR EXTRACT FOR REGIONS - REGION TABLE                     01220000
012300*                                                                 01230000
012400                                                                  01240000
012500     COPY HORD011.                                                01250000
012600                                                                  01260000
012700*                                                                 01270000
012800*  RMS SOR EXTRACT FOR DISTRICTS - DISTRICT TABLE                 01280000
012900*                                                                 01290000
013000                                                                  01300000
013100     COPY HORD012.                                                01310000
013200                                                                  01320000
013300*                                                                 01330000
013400*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01340000
013500*                                                                 01350000
013600                                                                  01360000
013700     COPY DPWS500.                                                01370000
013800                                                                  01380000
013900 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          01390000
014000                                              COMP SYNC.          01400000
014100     88  AC-TABLE-OVERFLOW-ERROR              VALUE +4004.        01410000
014200     88  AC-FILE-SEQUENCE-ERROR               VALUE +4007.        01420000
014300     88  AC-INVLD-DATA-ON-DATASET-ERROR       VALUE +4008.        01430000
014400     88  AC-CALENDAR-ROUTINE-ERROR            VALUE +4019.        01440000
014500                                                                  01450000
014600 01  PS-PROGRAM-SWITCHES.                                         01460000
014700     05  PS-END-OF-ORG-HIER-FILE-SW                               01470000
014800                                 PIC X(1)     VALUE 'N'.          01480000
014900         88  PS-END-OF-ORG-HIER-FILE          VALUE 'Y'.          01490000
015000     05  PS-END-OF-STORE-FILE-SW PIC X(1)     VALUE 'N'.          01500000
015100         88  PS-END-OF-STORE-FILE             VALUE 'Y'.          01510000
015200     05  PS-END-OF-TERRITORY-FILE-SW                              01520000
015300                                 PIC X(1)     VALUE 'N'.          01530000
015400         88  PS-END-OF-TERRITORY-FILE         VALUE 'Y'.          01540000
015500     05  PS-END-OF-REGION-FILE-SW                                 01550000
015600                                 PIC X(1)     VALUE 'N'.          01560000
015700         88  PS-END-OF-REGION-FILE            VALUE 'Y'.          01570000
015800     05  PS-END-OF-DISTRICT-FILE-SW                               01580000
015900                                 PIC X(1)     VALUE 'N'.          01590000
016000         88  PS-END-OF-DISTRICT-FILE          VALUE 'Y'.          01600000
016100                                                                  01610000
016200 01  PC-PROGRAM-CONSTANTS.                                        01620000
016300     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'KSKUT002'.   01630000
016400     05  PC-MAXIMUM-STORE-COUNT  PIC S9(4)    VALUE +5000         01640000
016500                                              COMP SYNC.          01650000
016600     05  PC-MAXIMUM-TERRITORY-COUNT                               01660000
016700                                 PIC S9(4)    VALUE +100          01670000
016800                                              COMP SYNC.          01680000
016900     05  PC-MAXIMUM-REGION-COUNT                                  01690000
017000                                 PIC S9(4)    VALUE +250          01700000
017100                                              COMP SYNC.          01710000
017200     05  PC-MAXIMUM-DISTRICT-COUNT                                01720000
017300                                 PIC S9(4)    VALUE +500          01730000
017400                                              COMP SYNC.          01740000
017500     05  PC-ERROR-COMPARE-TIMEFRAME                               01750000
017600                                 PIC S9(4)    VALUE +30           01760000
017700                                              COMP SYNC.          01770000
017800                                                                  01780000
017900 01  PV-PROGRAM-VARIABLES.                                        01790000
018000     05  PV-STORE-COUNT          PIC S9(4)    VALUE ZEROS         01800000
018100                                              COMP SYNC.          01810000
018200     05  PV-TERRITORY-COUNT      PIC S9(4)    VALUE ZEROS         01820000
018300                                              COMP SYNC.          01830000
018400     05  PV-REGION-COUNT         PIC S9(4)    VALUE ZEROS         01840000
018500                                              COMP SYNC.          01850000
018600     05  PV-DISTRICT-COUNT       PIC S9(4)    VALUE ZEROS         01860000
018700                                              COMP SYNC.          01870000
018800     05  PV-ERROR-COMPARE-DATE   PIC X(10)    VALUE SPACES.       01880000
018900     05  PV-CURRENT-DATE         PIC X(10)    VALUE SPACES.       01890000
019000     05  FILLER                  REDEFINES PV-CURRENT-DATE.       01900000
019100         10  PV-CD-YEAR          PIC X(4).                        01910000
019200         10  FILLER              PIC X(1).                        01920000
019300             88  PV-CD-DATE-SEP-1             VALUE '-'.          01930000
019400         10  PV-CD-MONTH         PIC X(2).                        01940000
019500         10  FILLER              PIC X(1).                        01950000
019600             88  PV-CD-DATE-SEP-2             VALUE '-'.          01960000
019700         10  PV-CD-DAY           PIC X(2).                        01970000
019800                                                                  01980000
019900 01  OH-ORG-HIER-EXTRACT-RECORD.                                  01990000
020000     05  OH-LOC-NBR              PIC 9(5)     VALUE ZEROS.        02000000
020100     05  FILLER                  REDEFINES OH-LOC-NBR.            02010000
020200         10  FILLER              PIC X(1).                        02020000
020300         10  OH-LOC-NBR-4        PIC 9(4).                        02030000
020400     05  OH-DIST-NBR             PIC 9(4)     VALUE ZEROS.        02040000
020500         88  OH-DN-UNKNOWN                    VALUE ZEROS.        02050000
020600         88  OH-DN-DEFAULT-ASSIGNMENT         VALUE 98.           02060000
020700     05  OH-DIST-NM              PIC X(20)    VALUE SPACES.       02070000
020800     05  OH-DIST-MGR-NM          PIC X(32)    VALUE SPACES.       02080000
020900     05  OH-REGN-NBR             PIC 9(4)     VALUE ZEROS.        02090000
021000         88  OH-RN-UNKNOWN                    VALUE ZEROS.        02100000
021100         88  OH-RN-DEFAULT-ASSIGNMENT         VALUE 19.           02110000
021200     05  OH-REGN-NM              PIC X(20)    VALUE SPACES.       02120000
021300     05  OH-REGN-MGR-NM          PIC X(32)    VALUE SPACES.       02130000
021400     05  OH-TERR-NBR             PIC 9(4)     VALUE ZEROS.        02140000
021500         88  OH-TN-UNKNOWN                    VALUE ZEROS.        02150000
021600         88  OH-TN-DEFAULT-ASSIGNMENT         VALUE 9.            02160000
021700     05  OH-TERR-NM              PIC X(20)    VALUE SPACES.       02170000
021800     05  OH-TERR-MGR-NM          PIC X(32)    VALUE SPACES.       02180000
021900     05  FILLER                  PIC X(27)    VALUE SPACES.       02190000
022000                                                                  02200000
022100 01  EW-ERROR-WARNING-RCD.                                        02210000
022200     05  EW-ERROR-LEVEL          PIC X(13)    VALUE SPACES.       02220000
022300         88  EW-EL-ERROR                      VALUE               02230000
022400             '** ERROR   - '.                                     02240000
022500         88  EW-EL-WARNING                    VALUE               02250000
022600             '** WARNING - '.                                     02260000
022700     05  EW-ERROR-WARNING-DETAIL PIC X(67)    VALUE SPACES.       02270000
022800                                                                  02280000
022900 01  ST-STORE-TABLE.                                              02290000
023000     05  ST-STORE-ENTRY          OCCURS 5000 TIMES                02300000
023100                                 ASCENDING KEY ST-LOC-NBR         02310000
023200                                 INDEXED BY ST-INDEX.             02320000
023300         10  ST-LOC-NBR          PIC 9(4).                        02330000
023400             88  ST-UNUSED-STR-ENTRY          VALUE 9999.         02340000
023500         10  ST-OPN-DTE          PIC X(10).                       02350000
023600         10  ST-CLS-DTE          PIC X(10).                       02360000
023700         10  ST-E-BUS-IND        PIC X(1).                        02370000
023800             88  ST-E-STORE                   VALUE 'Y'.          02380000
023900                                                                  02390000
024000 01  TT-TERRITORY-TABLE.                                          02400000
024100     05  TT-TERRITORY-ENTRY      OCCURS 100 TIMES                 02410000
024200                                 ASCENDING KEY TT-TERR-NBR        02420000
024300                                 INDEXED BY TT-INDEX.             02430000
024400         10  TT-TERR-NBR         PIC 9(4).                        02440000
024500             88  TT-UNUSED-TERR-ENTRY         VALUE 9999.         02450000
024600         10  TT-TERR-NM          PIC X(20).                       02460000
024700         10  TT-TERR-MGR-NM      PIC X(32).                       02470000
024800                                                                  02480000
024900 01  RT-REGION-TABLE.                                             02490000
025000     05  RT-REGION-ENTRY         OCCURS 200 TIMES                 02500000
025100                                 ASCENDING KEY RT-REGN-NBR        02510000
025200                                 INDEXED BY RT-INDEX.             02520000
025300         10  RT-REGN-NBR         PIC 9(4).                        02530000
025400             88  RT-UNUSED-REGN-ENTRY         VALUE 9999.         02540000
025500         10  RT-REGN-NM          PIC X(20).                       02550000
025600         10  RT-REGN-MGR-NM      PIC X(32).                       02560000
025700                                                                  02570000
025800 01  DT-DISTRICT-TABLE.                                           02580000
025900     05  DT-DISTRICT-ENTRY       OCCURS 500 TIMES                 02590000
026000                                 ASCENDING KEY DT-DIST-NBR        02600000
026100                                 INDEXED BY DT-INDEX.             02610000
026200         10  DT-DIST-NBR         PIC 9(4).                        02620000
026300             88  DT-UNUSED-DIST-ENTRY         VALUE 9999.         02630000
026400         10  DT-DIST-NM          PIC X(20).                       02640000
026500         10  DT-DIST-MGR-NM      PIC X(32).                       02650000
026600                                                                  02660000
026700******************************************************************02670000
026800 PROCEDURE DIVISION.                                              02680000
026900******************************************************************02690000
027000                                                                  02700000
027100 0000-MAINLINE.                                                   02710000
027200                                                                  02720000
027300     PERFORM 1000-INITIALIZE.                                     02730000
027400                                                                  02740000
027500     PERFORM 2000-PROCESS-STORE-LOCATION                          02750000
027600         UNTIL PS-END-OF-ORG-HIER-FILE.                           02760000
027700                                                                  02770000
027800     PERFORM 9000-EOJ-ROUTINE.                                    02780000
027900                                                                  02790000
028000     GOBACK.                                                      02800000
028100                                                                  02810000
028200******************************************************************02820000
028300*                                                                *02830000
028400******************************************************************02840000
028500                                                                  02850000
028600 1000-INITIALIZE.                                                 02860000
028700     OPEN INPUT  STORE-ORG-HIER-FILE                              02870000
028800                 STORE-LOCATION-FILE                              02880000
028900                 TERRITORY-FILE                                   02890000
029000                 REGION-FILE                                      02900000
029100                 DISTRICT-FILE                                    02910000
029200          OUTPUT SRV-MGT-ORG-HIER-FILE                            02920001
029300                 ERROR-WARNING-FILE.                              02930000
029400                                                                  02940000
029500     MOVE FUNCTION CURRENT-DATE (1:4) TO PV-CD-YEAR.              02950000
029600     SET PV-CD-DATE-SEP-1 TO TRUE.                                02960000
029700     MOVE FUNCTION CURRENT-DATE (5:2) TO PV-CD-MONTH.             02970000
029800     SET PV-CD-DATE-SEP-2 TO TRUE.                                02980000
029900     MOVE FUNCTION CURRENT-DATE (7:2) TO PV-CD-DAY.               02990000
030000                                                                  03000000
030100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03010000
030200     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      03020000
030300     SET DPG51-DECREMENT-DATE TO TRUE.                            03030000
030400     MOVE PC-ERROR-COMPARE-TIMEFRAME TO DPG51-INCR-DECR-DAYS-9.   03040000
030500     SET DPG52-LK-DTE-ISO TO TRUE.                                03050000
030600     MOVE FUNCTION CURRENT-DATE (1:8) TO DPG52-DB2-ISO-DATE.      03060000
030700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03070000
030800                                             DPG52                03080000
030900                                             DPG53                03090000
031000                                             DPG54                03100000
031100                                             DPG55                03110000
031200                                             DPG56.               03120000
031300     IF DPG54-NO-ERROR                                            03130000
031400         MOVE DPG55-DB2-ISO-DATE-FMT TO PV-ERROR-COMPARE-DATE     03140000
031500         DISPLAY PC-CURRENT-PROGRAM-NAME ' - COMPARISION DATE '   03150000
031600                   'RELATIVE TO OPEN DATE FOR POSTING MISSING '   03160000
031700                   'ATTRIBUTE WARNING MESSAGES IS '               03170000
031800                   PV-ERROR-COMPARE-DATE                          03180000
031900     ELSE                                                         03190000
032000         DISPLAY '** ABEND **'                                    03200000
032100         DISPLAY PC-CURRENT-PROGRAM-NAME ' - CALENDAR ROUTINE '   03210000
032200                   'ERROR WHEN COMPUTING COMPARISON DATE '        03220000
032300                   'RELATIVE TO OPEN DATE FOR POSTING WARNING '   03230000
032400                   'MESSAGES'                                     03240000
032500         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ERROR MESSAGE = '    03250000
032600                   DPG54-ERROR-MESSAGE                            03260000
032700         SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                    03270000
032800         CALL 'ILBOABN0' USING ABEND-CODE                         03280000
032900     END-IF.                                                      03290000
033000                                                                  03300000
033100     PERFORM 1100-LOAD-STORE-DATA.                                03310000
033200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03320000
033300               'STORES LOADED = '                                 03330000
033400               PV-STORE-COUNT.                                    03340000
033500                                                                  03350000
033600     PERFORM 1200-LOAD-TERRITORY-DATA.                            03360000
033700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03370000
033800               'TERRITORIES LOADED = '                            03380000
033900               PV-TERRITORY-COUNT.                                03390000
034000                                                                  03400000
034100     PERFORM 1300-LOAD-REGION-DATA.                               03410000
034200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03420000
034300               'REGIONS LOADED = '                                03430000
034400               PV-REGION-COUNT.                                   03440000
034500                                                                  03450000
034600     PERFORM 1400-LOAD-DISTRICT-DATA.                             03460000
034700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03470000
034800               'DISTRICTS LOADED = '                              03480000
034900               PV-DISTRICT-COUNT.                                 03490000
035000                                                                  03500000
035100     PERFORM 7000-READ-STORE-OH-FILE.                             03510000
035200*1000-EXIT.                                                       03520000
035300                                                                  03530000
035400******************************************************************03540000
035500*                                                                *03550000
035600******************************************************************03560000
035700                                                                  03570000
035800 1100-LOAD-STORE-DATA.                                            03580000
035900     INITIALIZE ST-STORE-TABLE.                                   03590000
036000                                                                  03600000
036100     INITIALIZE PV-STORE-COUNT.                                   03610000
036200     PERFORM 7100-READ-STORE-FILE.                                03620000
036300                                                                  03630000
036400     PERFORM                                                      03640000
036500             VARYING ST-INDEX                                     03650000
036600             FROM 1 BY 1                                          03660000
036700             UNTIL ((ST-INDEX > PC-MAXIMUM-STORE-COUNT)           03670000
036800                     OR (PS-END-OF-STORE-FILE))                   03680000
036900         ADD +1 TO PV-STORE-COUNT                                 03690000
037000         MOVE HO013-LOC-NBR TO ST-LOC-NBR (ST-INDEX)              03700000
037100         MOVE HO013-LOC-OPEN-DATE TO ST-OPN-DTE (ST-INDEX)        03710000
037200         MOVE HO013-LOC-CLOSE-DATE TO ST-CLS-DTE (ST-INDEX)       03720000
037300         MOVE HO013-LOC-E-BUS-IND TO ST-E-BUS-IND (ST-INDEX)      03730000
037400         PERFORM 7100-READ-STORE-FILE                             03740000
037500         IF ((NOT PS-END-OF-STORE-FILE)                           03750000
037600                 AND (HO013-LOC-NBR < ST-LOC-NBR (ST-INDEX)))     03760000
037700             DISPLAY '** ABEND **'                                03770000
037800             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - STORE '         03780000
037900                       'FILE NOT IN ASCENDING STORE SEQUENCE'     03790000
038000             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  03800000
038100                       'BETWEEN RECORDS FOR STORE '               03810000
038200                       ST-LOC-NBR (ST-INDEX)  ' AND '             03820000
038300                       HO013-LOC-NBR                              03830000
038400             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   03840000
038500             CALL 'ILBOABN0' USING ABEND-CODE                     03850000
038600         END-IF                                                   03860000
038700     END-PERFORM.                                                 03870000
038800                                                                  03880000
038900     IF ((ST-INDEX > PC-MAXIMUM-STORE-COUNT)                      03890000
039000             AND (NOT PS-END-OF-STORE-FILE))                      03900000
039100         DISPLAY '** ABEND **'                                    03910000
039200         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 03920000
039300                   'UNIQUE STORES EXCEEDED'                       03930000
039400         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  03940000
039500                   'AND RERUN'                                    03950000
039600         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      03960000
039700         CALL 'ILBOABN0' USING ABEND-CODE                         03970000
039800     END-IF.                                                      03980000
039900                                                                  03990000
040000     SET ST-INDEX TO PV-STORE-COUNT.                              04000000
040100     SET ST-INDEX UP BY 1.                                        04010000
040200     PERFORM                                                      04020000
040300             UNTIL (ST-INDEX > PC-MAXIMUM-STORE-COUNT)            04030000
040400         SET ST-UNUSED-STR-ENTRY (ST-INDEX) TO TRUE               04040000
040500         SET ST-INDEX UP BY 1                                     04050000
040600     END-PERFORM.                                                 04060000
040700*1100-EXIT.                                                       04070000
040800                                                                  04080000
040900******************************************************************04090000
041000*                                                                *04100000
041100******************************************************************04110000
041200                                                                  04120000
041300 1200-LOAD-TERRITORY-DATA.                                        04130000
041400     INITIALIZE TT-TERRITORY-TABLE.                               04140000
041500                                                                  04150000
041600     INITIALIZE PV-TERRITORY-COUNT.                               04160000
041700     PERFORM 7200-READ-TERRITORY-FILE.                            04170000
041800                                                                  04180000
041900     PERFORM                                                      04190000
042000             VARYING TT-INDEX                                     04200000
042100             FROM 1 BY 1                                          04210000
042200             UNTIL ((TT-INDEX > PC-MAXIMUM-TERRITORY-COUNT)       04220000
042300                     OR (PS-END-OF-TERRITORY-FILE))               04230000
042400         ADD +1 TO PV-TERRITORY-COUNT                             04240000
042500         MOVE HO010-TERR-NBR TO TT-TERR-NBR (TT-INDEX)            04250000
042600         MOVE HO010-TERR-NM TO TT-TERR-NM (TT-INDEX)              04260000
042700         MOVE HO010-TERR-MGR-NM TO TT-TERR-MGR-NM (TT-INDEX)      04270000
042800         PERFORM 7200-READ-TERRITORY-FILE                         04280000
042900         IF ((NOT PS-END-OF-TERRITORY-FILE)                       04290000
043000                 AND (HO010-TERR-NBR < TT-TERR-NBR (TT-INDEX)))   04300000
043001             DISPLAY '** ABEND **'                                04300100
043002             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - TERRITORY '     04300200
043003                       'FILE NOT IN ASCENDING TERRITORY SEQUENCE' 04300300
043004             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  04300400
043005                       'BETWEEN RECORDS FOR TERRITORIES '         04300500
043006                       TT-TERR-NBR (TT-INDEX)  ' AND '            04300600
043007                       HO010-TERR-NBR                             04300700
043008             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   04300800
043009             CALL 'ILBOABN0' USING ABEND-CODE                     04300900
043010         END-IF                                                   04301000
043011     END-PERFORM.                                                 04301100
043012                                                                  04301200
043013     IF ((TT-INDEX > PC-MAXIMUM-TERRITORY-COUNT)                  04301300
043014             AND (NOT PS-END-OF-TERRITORY-FILE))                  04301400
043015         DISPLAY '** ABEND **'                                    04301500
043016         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 04301600
043017                   'UNIQUE TERRITORIES EXCEEDED'                  04301700
043018         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  04301800
043019                   'AND RERUN'                                    04301900
043020         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      04302000
043021         CALL 'ILBOABN0' USING ABEND-CODE                         04302100
043022     END-IF.                                                      04302200
043023                                                                  04302300
043024     SET TT-INDEX TO PV-TERRITORY-COUNT.                          04302400
043025     SET TT-INDEX UP BY 1.                                        04302500
043026     PERFORM                                                      04302600
043027             UNTIL (TT-INDEX > PC-MAXIMUM-TERRITORY-COUNT)        04302700
043028         SET TT-UNUSED-TERR-ENTRY (TT-INDEX) TO TRUE              04302800
043029         SET TT-INDEX UP BY 1                                     04302900
043030     END-PERFORM.                                                 04303000
043031*1200-EXIT.                                                       04303100
043032                                                                  04303200
043033******************************************************************04303300
043034*                                                                *04303400
043035******************************************************************04303500
043036                                                                  04303600
043037 1300-LOAD-REGION-DATA.                                           04303700
043038     INITIALIZE RT-REGION-TABLE.                                  04303800
043039                                                                  04303900
043040     INITIALIZE PV-REGION-COUNT.                                  04304000
043050     PERFORM 7300-READ-REGION-FILE.                               04305000
043060                                                                  04306000
043070     PERFORM                                                      04307000
043080             VARYING RT-INDEX                                     04308000
043090             FROM 1 BY 1                                          04309000
043100             UNTIL ((RT-INDEX > PC-MAXIMUM-REGION-COUNT)          04310000
043200                     OR (PS-END-OF-REGION-FILE))                  04320000
043300         ADD +1 TO PV-REGION-COUNT                                04330000
043400         MOVE HO011-REGN-NBR TO RT-REGN-NBR (RT-INDEX)            04340000
043500         MOVE HO011-REGN-NM TO RT-REGN-NM (RT-INDEX)              04350000
043600         MOVE HO011-REGN-MGR-NM TO RT-REGN-MGR-NM (RT-INDEX)      04360000
043700         PERFORM 7300-READ-REGION-FILE                            04370000
043800         IF ((NOT PS-END-OF-REGION-FILE)                          04380000
043900                 AND (HO011-REGN-NBR < RT-REGN-NBR (RT-INDEX)))   04390000
044000             DISPLAY '** ABEND **'                                04400000
044100             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - REGION '        04410000
044200                       'FILE NOT IN ASCENDING REGION SEQUENCE'    04420000
044300             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  04430000
044400                       'BETWEEN RECORDS FOR REGIONS '             04440000
044500                       RT-REGN-NBR (RT-INDEX)  ' AND '            04450000
044600                       HO011-REGN-NBR                             04460000
044700             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   04470000
044800             CALL 'ILBOABN0' USING ABEND-CODE                     04480000
044900         END-IF                                                   04490000
045000     END-PERFORM.                                                 04500000
045100                                                                  04510000
045200     IF ((RT-INDEX > PC-MAXIMUM-REGION-COUNT)                     04520000
045300             AND (NOT PS-END-OF-REGION-FILE))                     04530000
045400         DISPLAY '** ABEND **'                                    04540000
045500         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 04550000
045600                   'UNIQUE REGIONS EXCEEDED'                      04560000
045700         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  04570000
045800                   'AND RERUN'                                    04580000
045900         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      04590000
046000         CALL 'ILBOABN0' USING ABEND-CODE                         04600000
046100     END-IF.                                                      04610000
046200                                                                  04620000
046300     SET RT-INDEX TO PV-REGION-COUNT.                             04630000
046400     SET RT-INDEX UP BY 1.                                        04640000
046500     PERFORM                                                      04650000
046600             UNTIL (RT-INDEX > PC-MAXIMUM-REGION-COUNT)           04660000
046700         SET RT-UNUSED-REGN-ENTRY (RT-INDEX) TO TRUE              04670000
046800         SET RT-INDEX UP BY 1                                     04680000
046900     END-PERFORM.                                                 04690000
047000*1300-EXIT.                                                       04700000
047100                                                                  04710000
047200******************************************************************04720000
047300*                                                                *04730000
047400******************************************************************04740000
047500                                                                  04750000
047600 1400-LOAD-DISTRICT-DATA.                                         04760000
047700     INITIALIZE DT-DISTRICT-TABLE.                                04770000
047800                                                                  04780000
047900     INITIALIZE PV-DISTRICT-COUNT.                                04790000
048000     PERFORM 7400-READ-DISTRICT-FILE.                             04800000
048100                                                                  04810000
048200     PERFORM                                                      04820000
048300             VARYING DT-INDEX                                     04830000
048400             FROM 1 BY 1                                          04840000
048500             UNTIL ((DT-INDEX > PC-MAXIMUM-DISTRICT-COUNT)        04850000
048600                     OR (PS-END-OF-DISTRICT-FILE))                04860000
048700         ADD +1 TO PV-DISTRICT-COUNT                              04870000
048800         MOVE HO012-DIST-NBR TO DT-DIST-NBR (DT-INDEX)            04880000
048900         MOVE HO012-DIST-NM TO DT-DIST-NM (DT-INDEX)              04890000
049000         MOVE HO012-DIST-MGR-NM TO DT-DIST-MGR-NM (DT-INDEX)      04900000
049100         PERFORM 7400-READ-DISTRICT-FILE                          04910000
049200         IF ((NOT PS-END-OF-DISTRICT-FILE)                        04920000
049300                 AND (HO012-DIST-NBR < DT-DIST-NBR (DT-INDEX)))   04930000
049400             DISPLAY '** ABEND **'                                04940000
049500             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - DISTRICT '      04950000
049600                       'FILE NOT IN ASCENDING DISTRICT SEQUENCE'  04960000
049700             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  04970000
049800                       'BETWEEN RECORDS FOR DISTRICTS '           04980000
049900                       DT-DIST-NBR (DT-INDEX)  ' AND '            04990000
050000                       HO012-DIST-NBR                             05000000
050100             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   05010000
050200             CALL 'ILBOABN0' USING ABEND-CODE                     05020000
050300         END-IF                                                   05030000
050400     END-PERFORM.                                                 05040000
050500                                                                  05050000
050600     IF ((DT-INDEX > PC-MAXIMUM-DISTRICT-COUNT)                   05060000
050700             AND (NOT PS-END-OF-DISTRICT-FILE))                   05070000
050800         DISPLAY '** ABEND **'                                    05080000
050900         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 05090000
051000                   'UNIQUE DISTRICTS EXCEEDED'                    05100000
051100         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  05110000
051200                   'AND RERUN'                                    05120000
051300         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      05130000
051400         CALL 'ILBOABN0' USING ABEND-CODE                         05140000
051500     END-IF.                                                      05150000
051600                                                                  05160000
051700     SET DT-INDEX TO PV-DISTRICT-COUNT.                           05170000
051800     SET DT-INDEX UP BY 1.                                        05180000
051900     PERFORM                                                      05190000
052000             UNTIL (DT-INDEX > PC-MAXIMUM-DISTRICT-COUNT)         05200000
052010         SET DT-UNUSED-DIST-ENTRY (DT-INDEX) TO TRUE              05201000
052011         SET DT-INDEX UP BY 1                                     05201100
052012     END-PERFORM.                                                 05201200
052013*1400-EXIT.                                                       05201300
052014                                                                  05201400
052015******************************************************************05201500
052016*                                                                *05201600
052017******************************************************************05201700
052018                                                                  05201800
052019 2000-PROCESS-STORE-LOCATION.                                     05201900
052020     INITIALIZE OH-ORG-HIER-EXTRACT-RECORD.                       05202000
052030                                                                  05203000
052040     MOVE SE006-LOC-NBR TO OH-LOC-NBR.                            05204000
052050     SEARCH ALL ST-STORE-ENTRY                                    05205000
052060         AT END                                                   05206000
052061             DISPLAY '** ABEND **'                                05206100
052062             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - IDENTITY '      05206200
052063                   'MANAGEMENT STORE ORGANIZATION HIERARCHY '     05206300
052064                   'LOCATION NOT FOUND IN RMS SYSTEM OF RECORD '  05206400
052065                   'EXTRACT'                                      05206500
052066             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - STORE '         05206600
052067                   'LOCATION NUMBER = '  SE006-LOC-NBR            05206700
052068             SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE           05206800
052069             CALL 'ILBOABN0' USING ABEND-CODE                     05206900
052070         WHEN ST-LOC-NBR (ST-INDEX) = OH-LOC-NBR-4                05207000
052080             CONTINUE                                             05208000
052081     END-SEARCH.                                                  05208100
052082                                                                  05208200
052083     IF ((SE006-DIST-UNKNOWN)                                     05208300
052084             OR (SE006-DIST-NBR = ZEROS))                         05208400
052085         INITIALIZE OH-DIST-NBR                                   05208500
052086     ELSE                                                         05208600
052087         MOVE SE006-DIST-NBR-N TO OH-DIST-NBR                     05208700
052088         SEARCH ALL DT-DISTRICT-ENTRY                             05208800
052089             AT END                                               05208900
052090                 DISPLAY '** ABEND **'                            05209000
052100                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - DISTRICT '  05210000
052110                           'INFORMATION NOT FOUND FOR DISTRICT '  05211000
052111                           'IN IDENTITY MANAGEMENT STORE '        05211100
052112                           'ORGANIZATION HIERARCHY EXTRACT'       05211200
052113                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - DISTRICT '  05211300
052114                           'NUMBER = '  SE006-DIST-NBR  '; STORE '05211400
052115                           'LOCATION NUMBER = '  SE006-LOC-NBR    05211500
052116                 SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE       05211600
052117                 CALL 'ILBOABN0' USING ABEND-CODE                 05211700
052118             WHEN DT-DIST-NBR (DT-INDEX) = OH-DIST-NBR            05211800
052119                 MOVE DT-DIST-NM (DT-INDEX) TO OH-DIST-NM         05211900
052120                 MOVE DT-DIST-MGR-NM (DT-INDEX) TO OH-DIST-MGR-NM 05212000
052130         END-SEARCH                                               05213000
052131     END-IF.                                                      05213100
052132                                                                  05213200
052133     IF (OH-DN-UNKNOWN)                                           05213300
052134         INITIALIZE EW-ERROR-WARNING-RCD                          05213400
052135         EVALUATE TRUE                                            05213500
052136             WHEN (ST-CLS-DTE (ST-INDEX) <= PV-CURRENT-DATE)      05213600
052137                 CONTINUE                                         05213700
052138             WHEN (ST-OPN-DTE (ST-INDEX) <= PV-CURRENT-DATE)      05213800
052139                 SET EW-EL-ERROR TO TRUE                          05213900
052140             WHEN (ST-OPN-DTE (ST-INDEX) <= PV-ERROR-COMPARE-DATE)05214000
052141                 SET EW-EL-WARNING TO TRUE                        05214100
052142         END-EVALUATE                                             05214200
052143         IF (EW-ERROR-LEVEL NOT = SPACES)                         05214300
052144             STRING 'STORE '                     DELIMITED BY SIZE05214400
052145                    OH-LOC-NBR-4                 DELIMITED BY SIZE05214500
052146                        ' NOT TIED TO A DISTRICT - OPEN DATE IS ' 05214600
052147                                                 DELIMITED BY SIZE05214700
052148                    ST-OPN-DTE (ST-INDEX)        DELIMITED BY SIZE05214800
052149                 INTO EW-ERROR-WARNING-DETAIL                     05214900
052150             PERFORM 8100-WRITE-ERROR-WARN-RECORD                 05215000
052151         END-IF                                                   05215100
052152     ELSE                                                         05215200
052153         IF ((OH-DN-DEFAULT-ASSIGNMENT)                           05215300
052154                 AND (NOT ST-E-STORE (ST-INDEX)))                 05215400
052155             INITIALIZE EW-ERROR-WARNING-RCD                      05215500
052156             EVALUATE TRUE                                        05215600
052157                 WHEN (ST-CLS-DTE (ST-INDEX) <= PV-CURRENT-DATE)  05215700
052158                     CONTINUE                                     05215800
052159                 WHEN (ST-OPN-DTE (ST-INDEX) <= PV-CURRENT-DATE)  05215900
052160                     SET EW-EL-ERROR TO TRUE                      05216000
052161                 WHEN (ST-OPN-DTE (ST-INDEX) <=                   05216100
052162                                            PV-ERROR-COMPARE-DATE)05216200
052163                     SET EW-EL-WARNING TO TRUE                    05216300
052164             END-EVALUATE                                         05216400
052165             IF (EW-ERROR-LEVEL NOT = SPACES)                     05216500
052166                 STRING 'STORE '                 DELIMITED BY SIZE05216600
052167                        OH-LOC-NBR-4             DELIMITED BY SIZE05216700
052168                        ' TIED TO DEFAULT DIST ' DELIMITED BY SIZE05216800
052169                        OH-DIST-NBR              DELIMITED BY SIZE05216900
052170                        ' - OPEN DATE IS '       DELIMITED BY SIZE05217000
052171                        ST-OPN-DTE (ST-INDEX)    DELIMITED BY SIZE05217100
052172                     INTO EW-ERROR-WARNING-DETAIL                 05217200
052173                 PERFORM 8100-WRITE-ERROR-WARN-RECORD             05217300
052174             END-IF                                               05217400
052175         END-IF                                                   05217500
052176     END-IF.                                                      05217600
052177                                                                  05217700
052178     IF ((SE006-REGN-UNKNOWN)                                     05217800
052179             OR (SE006-REGN-NBR = ZEROS))                         05217900
052180         INITIALIZE OH-REGN-NBR                                   05218000
052181     ELSE                                                         05218100
052182         MOVE SE006-REGN-NBR-N TO OH-REGN-NBR                     05218200
052183         SEARCH ALL RT-REGION-ENTRY                               05218300
052184             AT END                                               05218400
052185                 DISPLAY '** ABEND **'                            05218500
052186                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - REGION '    05218600
052187                           'INFORMATION NOT FOUND FOR REGION '    05218700
052188                           'IN IDENTITY MANAGEMENT STORE '        05218800
052189                           'ORGANIZATION HIERARCHY EXTRACT'       05218900
052190                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - REGION '    05219000
052200                           'NUMBER = '  SE006-REGN-NBR  '; STORE '05220000
052300                           'LOCATION NUMBER = '  SE006-LOC-NBR    05230000
052400                 SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE       05240000
052500                 CALL 'ILBOABN0' USING ABEND-CODE                 05250000
052600             WHEN RT-REGN-NBR (RT-INDEX) = OH-REGN-NBR            05260000
052700                 MOVE RT-REGN-NM (RT-INDEX) TO OH-REGN-NM         05270000
052800                 MOVE RT-REGN-MGR-NM (RT-INDEX) TO OH-REGN-MGR-NM 05280000
052900         END-SEARCH                                               05290000
053000     END-IF.                                                      05300000
053100                                                                  05310000
053200     IF (OH-RN-UNKNOWN)                                           05320000
053300         INITIALIZE EW-ERROR-WARNING-RCD                          05330000
053400         EVALUATE TRUE                                            05340000
053500             WHEN (ST-CLS-DTE (ST-INDEX) <= PV-CURRENT-DATE)      05350000
053600                 CONTINUE                                         05360000
053700             WHEN (ST-OPN-DTE (ST-INDEX) <= PV-CURRENT-DATE)      05370000
053800                 SET EW-EL-ERROR TO TRUE                          05380000
053900             WHEN (ST-OPN-DTE (ST-INDEX) <= PV-ERROR-COMPARE-DATE)05390000
054000                 SET EW-EL-WARNING TO TRUE                        05400000
054100         END-EVALUATE                                             05410000
054200         IF (EW-ERROR-LEVEL NOT = SPACES)                         05420000
054300             STRING 'STORE '                     DELIMITED BY SIZE05430000
054400                    OH-LOC-NBR-4                 DELIMITED BY SIZE05440000
054500                        ' NOT TIED TO A REGION - OPEN DATE IS '   05450000
054600                                                 DELIMITED BY SIZE05460000
054700                    ST-OPN-DTE (ST-INDEX)        DELIMITED BY SIZE05470000
054800                 INTO EW-ERROR-WARNING-DETAIL                     05480000
054900             PERFORM 8100-WRITE-ERROR-WARN-RECORD                 05490000
055000         END-IF                                                   05500000
055100     ELSE                                                         05510000
055200         IF ((OH-RN-DEFAULT-ASSIGNMENT)                           05520000
055300                 AND (NOT ST-E-STORE (ST-INDEX)))                 05530000
055400             INITIALIZE EW-ERROR-WARNING-RCD                      05540000
055500             EVALUATE TRUE                                        05550000
055600                 WHEN (ST-CLS-DTE (ST-INDEX) <= PV-CURRENT-DATE)  05560000
055700                     CONTINUE                                     05570000
055800                 WHEN (ST-OPN-DTE (ST-INDEX) <= PV-CURRENT-DATE)  05580000
055900                     SET EW-EL-ERROR TO TRUE                      05590000
056000                 WHEN (ST-OPN-DTE (ST-INDEX) <=                   05600000
056100                                            PV-ERROR-COMPARE-DATE)05610000
056200                     SET EW-EL-WARNING TO TRUE                    05620000
056300             END-EVALUATE                                         05630000
056400             IF (EW-ERROR-LEVEL NOT = SPACES)                     05640000
056500                 STRING 'STORE '                 DELIMITED BY SIZE05650000
056600                        OH-LOC-NBR-4             DELIMITED BY SIZE05660000
056700                        ' TIED TO DEFAULT REGN ' DELIMITED BY SIZE05670000
056800                        OH-REGN-NBR              DELIMITED BY SIZE05680000
056900                        ' - OPEN DATE IS '       DELIMITED BY SIZE05690000
057000                        ST-OPN-DTE (ST-INDEX)    DELIMITED BY SIZE05700000
057100                     INTO EW-ERROR-WARNING-DETAIL                 05710000
057200                 PERFORM 8100-WRITE-ERROR-WARN-RECORD             05720000
057300             END-IF                                               05730000
057400         END-IF                                                   05740000
057500     END-IF.                                                      05750000
057600                                                                  05760000
057700     IF ((SE006-TERR-UNKNOWN)                                     05770000
057800             OR (SE006-TERR-NBR = ZEROS))                         05780000
057900         INITIALIZE OH-TERR-NBR                                   05790000
058000     ELSE                                                         05800000
058100         MOVE SE006-TERR-NBR-N TO OH-TERR-NBR                     05810000
058200         SEARCH ALL TT-TERRITORY-ENTRY                            05820000
058300             AT END                                               05830000
058400                 DISPLAY '** ABEND **'                            05840000
058500                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - TERRITORY ' 05850000
058600                           'INFORMATION NOT FOUND FOR TERRITORY ' 05860000
058700                           'IN IDENTITY MANAGEMENT STORE '        05870000
058800                           'ORGANIZATION HIERARCHY EXTRACT'       05880000
058900                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - TERRITORY ' 05890000
059000                           'NUMBER = '  SE006-TERR-NBR  '; STORE '05900000
059100                           'LOCATION NUMBER = '  SE006-LOC-NBR    05910000
059200                 SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE       05920000
059300                 CALL 'ILBOABN0' USING ABEND-CODE                 05930000
059400             WHEN TT-TERR-NBR (TT-INDEX) = OH-TERR-NBR            05940000
059410                 MOVE TT-TERR-NM (TT-INDEX) TO OH-TERR-NM         05941000
059420                 MOVE TT-TERR-MGR-NM (TT-INDEX) TO OH-TERR-MGR-NM 05942000
059430         END-SEARCH                                               05943000
059440     END-IF.                                                      05944000
059450                                                                  05945000
059460     IF (OH-TN-UNKNOWN)                                           05946000
059470         INITIALIZE EW-ERROR-WARNING-RCD                          05947000
059480         EVALUATE TRUE                                            05948000
059490             WHEN (ST-CLS-DTE (ST-INDEX) <= PV-CURRENT-DATE)      05949000
059491                 CONTINUE                                         05949100
059492             WHEN (ST-OPN-DTE (ST-INDEX) <= PV-CURRENT-DATE)      05949200
059493                 SET EW-EL-ERROR TO TRUE                          05949300
059494             WHEN (ST-OPN-DTE (ST-INDEX) <= PV-ERROR-COMPARE-DATE)05949400
059495                 SET EW-EL-WARNING TO TRUE                        05949500
059496         END-EVALUATE                                             05949600
059497         IF (EW-ERROR-LEVEL NOT = SPACES)                         05949700
059498             STRING 'STORE '                     DELIMITED BY SIZE05949800
059499                    OH-LOC-NBR-4                 DELIMITED BY SIZE05949900
059500                        ' NOT TIED TO A TERRITORY - OPEN DATE IS '05950000
059501                                                 DELIMITED BY SIZE05950100
059502                    ST-OPN-DTE (ST-INDEX)        DELIMITED BY SIZE05950200
059503                 INTO EW-ERROR-WARNING-DETAIL                     05950300
059504             PERFORM 8100-WRITE-ERROR-WARN-RECORD                 05950400
059505         END-IF                                                   05950500
059506     ELSE                                                         05950600
059507         IF ((OH-TN-DEFAULT-ASSIGNMENT)                           05950700
059508                 AND (NOT ST-E-STORE (ST-INDEX)))                 05950800
059509             INITIALIZE EW-ERROR-WARNING-RCD                      05950900
059510             EVALUATE TRUE                                        05951000
059511                 WHEN (ST-CLS-DTE (ST-INDEX) <= PV-CURRENT-DATE)  05951100
059512                     CONTINUE                                     05951200
059513                 WHEN (ST-OPN-DTE (ST-INDEX) <= PV-CURRENT-DATE)  05951300
059514                     SET EW-EL-ERROR TO TRUE                      05951400
059515                 WHEN (ST-OPN-DTE (ST-INDEX) <=                   05951500
059516                                            PV-ERROR-COMPARE-DATE)05951600
059517                     SET EW-EL-WARNING TO TRUE                    05951700
059518             END-EVALUATE                                         05951800
059519             IF (EW-ERROR-LEVEL NOT = SPACES)                     05951900
059520                 STRING 'STORE '                 DELIMITED BY SIZE05952000
059521                        OH-LOC-NBR-4             DELIMITED BY SIZE05952100
059522                        ' TIED TO DEFAULT TERR ' DELIMITED BY SIZE05952200
059523                        OH-TERR-NBR              DELIMITED BY SIZE05952300
059524                        ' - OPEN DATE IS '       DELIMITED BY SIZE05952400
059525                        ST-OPN-DTE (ST-INDEX)    DELIMITED BY SIZE05952500
059526                     INTO EW-ERROR-WARNING-DETAIL                 05952600
059527                 PERFORM 8100-WRITE-ERROR-WARN-RECORD             05952700
059528             END-IF                                               05952800
059529         END-IF                                                   05952900
059530     END-IF.                                                      05953000
059540                                                                  05954000
059550     PERFORM 8000-WRITE-SRV-MGT-OH-RECORD.                        05955001
059560                                                                  05956000
059570     PERFORM 7000-READ-STORE-OH-FILE.                             05957000
059580*2000-EXIT.                                                       05958000
059590                                                                  05959000
059600******************************************************************05960000
059700*                                                                *05970000
059800******************************************************************05980000
059900                                                                  05990000
060000 7000-READ-STORE-OH-FILE.                                         06000000
060100     READ STORE-ORG-HIER-FILE                                     06010000
060200         INTO SE006-ORG-HIER-EXTRACT-RECORD                       06020000
060300         AT END                                                   06030000
060400             SET PS-END-OF-ORG-HIER-FILE TO TRUE                  06040000
060500     END-READ.                                                    06050000
060600*7000-EXIT.                                                       06060000
060700                                                                  06070000
060800******************************************************************06080000
060900*                                                                *06090000
061000******************************************************************06100000
061100                                                                  06110000
061200 7100-READ-STORE-FILE.                                            06120000
061300     READ STORE-LOCATION-FILE                                     06130000
061400         INTO HO013-LOCATION-DATA                                 06140000
061500         AT END                                                   06150000
061600             SET PS-END-OF-STORE-FILE TO TRUE                     06160000
061700     END-READ.                                                    06170000
061800*7100-EXIT.                                                       06180000
061900                                                                  06190000
062000******************************************************************06200000
062100*                                                                *06210000
062200******************************************************************06220000
062300                                                                  06230000
062400 7200-READ-TERRITORY-FILE.                                        06240000
062500     READ TERRITORY-FILE                                          06250000
062600         INTO HO010-TERRITORY-DATA                                06260000
062700         AT END                                                   06270000
062800             SET PS-END-OF-TERRITORY-FILE TO TRUE                 06280000
062900     END-READ.                                                    06290000
063000*7200-EXIT.                                                       06300000
063100                                                                  06310000
063200******************************************************************06320000
063300*                                                                *06330000
063400******************************************************************06340000
063500                                                                  06350000
063600 7300-READ-REGION-FILE.                                           06360000
063700     READ REGION-FILE                                             06370000
063800         INTO HO011-REGION-DATA                                   06380000
063900         AT END                                                   06390000
064000             SET PS-END-OF-REGION-FILE TO TRUE                    06400000
064100     END-READ.                                                    06410000
064200*7300-EXIT.                                                       06420000
064300                                                                  06430000
064400******************************************************************06440000
064500*                                                                *06450000
064600******************************************************************06460000
064700                                                                  06470000
064800 7400-READ-DISTRICT-FILE.                                         06480000
064900     READ DISTRICT-FILE                                           06490000
065000         INTO HO012-DISTRICT-DATA                                 06500000
065100         AT END                                                   06510000
065200             SET PS-END-OF-DISTRICT-FILE TO TRUE                  06520000
065300     END-READ.                                                    06530000
065400*7400-EXIT.                                                       06540000
065500                                                                  06550000
065600******************************************************************06560000
065700*                                                                *06570000
065800******************************************************************06580000
065900                                                                  06590000
066000 8000-WRITE-SRV-MGT-OH-RECORD.                                    06600001
066100     WRITE SM-SRV-MGT-ORG-HIER-RECORD                             06610001
066200         FROM OH-ORG-HIER-EXTRACT-RECORD.                         06620000
066300*8000-EXIT.                                                       06630000
066400                                                                  06640000
066500******************************************************************06650000
066600*                                                                *06660000
066700******************************************************************06670000
066800                                                                  06680000
066900 8100-WRITE-ERROR-WARN-RECORD.                                    06690000
067000     WRITE EW-ERROR-WARNING-RECORD                                06700000
067100         FROM EW-ERROR-WARNING-RCD.                               06710000
067200*8100-EXIT.                                                       06720000
067300                                                                  06730000
067400******************************************************************06740000
067500*  CLOSE ALL FILES.                                              *06750000
067600******************************************************************06760000
067700                                                                  06770000
067800 9000-EOJ-ROUTINE.                                                06780000
067900     CLOSE STORE-ORG-HIER-FILE                                    06790000
068000           STORE-LOCATION-FILE                                    06800000
068100           TERRITORY-FILE                                         06810000
068200           REGION-FILE                                            06820000
068300           DISTRICT-FILE                                          06830000
068400           SRV-MGT-ORG-HIER-FILE                                  06840001
068500           ERROR-WARNING-FILE.                                    06850000
068600*9000-EXIT.                                                       06860000
