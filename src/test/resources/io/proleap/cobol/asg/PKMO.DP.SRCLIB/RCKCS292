000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.                RCKCS292.                             00050000
000600 AUTHOR.                    MARY SARDINA.                         00060000
000700 INSTALLATION.              KOHLS DEPARTMENT STORES.              00070000
000800 DATE-WRITTEN.              04-30-97.                             00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  CICS PROGRAM - RCKCS292 - E292                                *00120000
001300*                                                                *00130000
001400*      MULTIPLE TICKET TYPE LIST                                 *00140033
001500*                                                                *00150000
001600*  THIS SCREEN WILL BE USED BY THE BUYING OFFICE TO VIEW THE     *00160000
001700*  TICKET TYPE FOR EACH LINE ITEM OF A PURCHASE ORDER.           *00170000
001800******************************************************************00180000
001900* 01/31/19 MADE BY: JIM HUNTER              CHG0217830            00190099
002000*  MAINFRAME REFACTORING - DB2 LUW HANDLES CALLS WITH CHAR        00200099
002100*  FORMATTING OF DECIMAL FIELDS DIFFERENTLY THAN THE MAINFRAME    00210099
002200*  VERSION OF DB2.   REPLACING THE CHAR FORMATTING WITH DIGITS.   00220099
002300*  CHAR RETURNS A LEADING SPACE AND TRAILING DECIMAL POINT        00230099
002400*  AND DIGITS DOESN'T.                                            00240099
002500*  SEE RECITM-CURSOR CURSOR.                                      00250099
002600******************************************************************00260099
002700* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00270099
002800* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00280099
002900* MAKING THE CALL DYNAMIC VS STATIC.                              00290099
002901*---------------------------------------------------------------* 00290199
002902                                                                  00290200
002903 ENVIRONMENT DIVISION.                                            00290300
002904                                                                  00290400
002905 DATA DIVISION.                                                   00290500
002906                                                                  00290600
002907 WORKING-STORAGE SECTION.                                         00290700
002908                                                                  00290800
002909 01  DK-DB2-KEYS.                                                 00290900
002910     05  DK-PO-NUMBER                   PIC S9(09) COMP.          00291000
002920     05  DK-PO-LNE-NBR                  PIC S9(09) COMP.          00292000
003700     05  DK-OPER-UNT-ID                 PIC S9(04) VALUE +0 COMP. 00370033
003900     05  DK-FCLTY-ID                    PIC S9(04) VALUE +0 COMP. 00390033
004100     05  DK-REC-SEQ-NBR                 PIC S9(09) VALUE +0 COMP. 00410033
004200     05  DK-TKT-FMT-ID                  PIC  X(06).               00420099
004300     05  DK-DEPT-NBR                    PIC  X(03).               00430099
004301     05  DK-SUBCLASS-NBR                PIC  X(03).               00430199
004302                                                                  00430200
004303 01  PC-PROGRAM-CONSTANTS.                                        00430300
004900     05  PC-CURRENT-MAP-NAME            PIC  X(08) VALUE          00490000
005000                                                    'RC292A  '.   00500000
005100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08) VALUE          00510000
005200                                                    'RCKM292 '.   00520000
005300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08) VALUE          00530000
005400                                                    'RCKCS292'.   00540000
005700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00570000
005800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00580000
006100     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00610000
006200                                                    COMP SYNC.    00620000
006300     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00630000
006400                                                    COMP SYNC.    00640000
006500     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00650000
006600                                                    +1000000      00660000
006700                                                    COMP-3.       00670000
006800     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00680000
006900                                                    COMP SYNC.    00690000
007000     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00700000
007100                                                    COMP-3.       00710000
007800     05  PC-TSYMSG-NUMBERS.                                       00780000
008000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00800000
008200         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00820000
008400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00840000
008500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00850000
008600         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00860000
008700         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00870000
008800         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00880000
008900         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00890000
009000         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00900000
009200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00920000
009300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00930000
009400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00940000
009700         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00970000
010100         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01010000
013000                                                                  01300000
013100 01  PS-PROGRAM-SWITCHES.                                         01310000
014400     05  PS-RESET-LINES-SW              PIC  X(01)  VALUE 'Y'.    01440000
014500         88  PS-NO-RESET-LINES                      VALUE 'N'.    01450000
014600         88  PS-RESET-LINES                         VALUE 'Y'.    01460000
014700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01470000
014800         88  PS-NO-ERROR                            VALUE 'Y'.    01480000
014900         88  PS-ERROR                               VALUE 'N'.    01490000
016500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01650000
016600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01660000
016700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01670000
016701     05  PS-UPC-SW                      PIC  X(01)  VALUE 'Y'.    01670199
016702         88  PS-UPC-FOUND                           VALUE 'Y'.    01670200
016703         88  PS-NO-UPC-FOUND                        VALUE 'N'.    01670300
017400                                                                  01740000
017500 01  PV-PROGRAM-VARIABLES.                                        01750000
024700     05  PV-PO-LINE-NBR                 PIC 9(03).                02470000
024800     05  PV-SUB                         PIC S9(04)  VALUE +0      02480000
024900                                                    COMP SYNC.    02490000
025000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02500000
025100                                                    COMP SYNC.    02510000
025200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02520000
025300                                                    COMP-3.       02530000
025400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02540000
025500                                                    COMP-3.       02550000
025600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02560000
025700                                                    COMP-3.       02570000
025800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02580000
025900                                                    COMP-3.       02590000
026000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02600000
026100                                                    COMP-3.       02610000
026200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02620000
026300                                                    COMP-3.       02630000
026800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02680000
026900                                                    COMP SYNC.    02690000
027000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02700000
027100                                                    COMP SYNC.    02710000
027200     05  PV-ITEM                        PIC S9(04)  VALUE +0      02720000
027300                                                    COMP SYNC.    02730000
027800     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02780000
027900                                                    COMP SYNC.    02790000
028000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02800000
028100                                                    COMP SYNC.    02810000
028200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02820000
028300                                                    COMP SYNC.    02830000
028400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02840000
028500                                                    COMP SYNC.    02850000
028600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02860000
028700                                                    COMP SYNC.    02870000
028800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02880000
028900                                                    COMP SYNC.    02890000
029000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02900000
029100                                                    COMP SYNC.    02910000
029200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02920000
029300                                                    COMP SYNC.    02930000
029400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02940000
029500                                                    COMP SYNC.    02950000
029600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02960000
029700                                                    COMP SYNC.    02970000
030000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03000000
030100                                                    COMP SYNC.    03010000
030200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03020033
030201                                                    COMP SYNC.    03020133
030202     05  PV-HANG-FOLD                   PIC  X(05)  VALUE SPACE.  03020299
030203     05  PV-HOLD-DEPT                   PIC  X(03).               03020333
030204     05  PV-HOLD-MAJ-CLASS              PIC  X(02).               03020433
030205     05  PV-HOLD-SUB-CLASS              PIC  X(02).               03020533
030206     05  PV-INTR-UPC-ID                 PIC  X(09).               03020633
030207     05  PV-SUBCLASS-NBR.                                         03020799
030208         10  FILLER                     PIC  X(01) VALUE '0'.     03020899
030209         10  PV-SUB-CLASS               PIC  X(02).               03020999
106900                                                                  10690059
106901******************************************************************10690199
106902**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **10690200
106903**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **10690300
106904**  APPLICAT-ON-SPECIFIC COMMAREA.                              **10690400
106905******************************************************************10690500
106906 01  LQW-LIST-QUEUE-WORK-AREA.                                    10690600
106907     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  10690700
106908     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           10690800
106909                                        INDEXED BY LQW-IDX.       10690900
106910         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       10691000
106911         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               10691100
106912         10  LQW-SELECTED-SW            PIC  X(01).               10691200
106913             88  LQW-SELECT                         VALUE 'S'.    10691300
106914             88  LQW-DESELECT                       VALUE ' '.    10691400
106915         10  LQW-PO-LNE-NBR             PIC S9(09) COMP.          10691500
106916         10  LQW-MAJOR-CLASS            PIC  X(02).               10691600
106917         10  LQW-SUB-CLASS              PIC  X(02).               10691700
106918         10  LQW-SKU                    PIC  X(08).               10691800
106919         10  LQW-SKU-DESCRIPTION        PIC  X(14).               10691900
106920         10  LQW-UPC                    PIC  X(15).               10692000
106921         10  LQW-TICKET-TYPE            PIC  X(14).               10692100
106922         10  LQW-HANG-FOLD              PIC  X(05).               10692200
106923                                                                  10692300
106924*---------------------------------------------------------------* 10692400
106925*  RECORD LAYOUT FOR THE LINE SELECTION TEMP STORAGE QUEUE.     * 10692500
106926*---------------------------------------------------------------* 10692600
106927     COPY RCWS016.                                                10692700
106928                                                                  10692800
106929*---------------------------------------------------------------* 10692900
106930*    MAP LAYOUT                                                 * 10693000
106931*---------------------------------------------------------------* 10693100
106932     COPY RCKM292.                                                10693200
106933                                                                  10693300
106934 01  MR-OCCURS-LAYOUT                   REDEFINES  RC292AO.       10693400
106935     05  FILLER                         PIC X(73).                10693533
106936     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          10693600
106937         10  MR-SELECTL                 PIC S9(04) COMP.          10693700
106938         10  MR-SELECTA                 PIC  X(01).               10693800
106939         10  MR-SELECTC                 PIC  X(01).               10693900
106940         10  MR-SELECTH                 PIC  X(01).               10694000
106941         10  MR-SELECTI                 PIC  X(01).               10694100
106942                                                                  10694200
106943         10  FILLER                     PIC  X(05).               10694300
106944         10  MR-PO-LINE-NBR             PIC  X(03).               10694400
106945                                                                  10694500
106946         10  FILLER                     PIC  X(05).               10694600
106947         10  MR-MAJ-CLASS               PIC  X(02).               10694700
106948                                                                  10694800
106949         10  FILLER                     PIC  X(05).               10694900
106950         10  MR-SUB-CLASS               PIC  X(02).               10695000
106951                                                                  10695100
106952         10  FILLER                     PIC  X(05).               10695200
106953         10  MR-SKU-NBR                 PIC  X(08).               10695300
106954                                                                  10695400
106955         10  FILLER                     PIC  X(05).               10695500
106956         10  MR-SKU-DESC                PIC  X(14).               10695600
106957                                                                  10695700
106958         10  FILLER                     PIC  X(05).               10695800
106959         10  MR-UPC                     PIC  X(15).               10695900
106960                                                                  10696000
106961         10  MR-TICKET-TYPEL            PIC S9(04) COMP.          10696100
106962         10  MR-TICKET-TYPEA            PIC  X(01).               10696200
106963         10  MR-TICKET-TYPEC            PIC  X(01).               10696300
106964         10  MR-TICKET-TYPEH            PIC  X(01).               10696400
106965         10  MR-TICKET-TYPE             PIC  X(14).               10696500
106966                                                                  10696600
106967         10  MR-HANG-FOLDL              PIC S9(04) COMP.          10696700
106968         10  MR-HANG-FOLDA              PIC  X(01).               10696800
106969         10  MR-HANG-FOLDC              PIC  X(01).               10696900
106970         10  MR-HANG-FOLDH              PIC  X(01).               10697000
106971         10  MR-HANG-FOLD               PIC  X(05).               10697100
106972                                                                  10697233
106973*---------------------------------------------------------------* 10697300
106974*    ATTRIBUTE SETTINGS COPYBOOK.                               * 10697400
106975*---------------------------------------------------------------* 10697500
106976     COPY DPWS015.                                                10697600
106977                                                                  10697700
106978*---------------------------------------------------------------* 10697800
106979*    FUNCTION KEYS COPYBOOK.                                    * 10697900
106980*---------------------------------------------------------------* 10698000
106981     COPY DPWS016.                                                10698100
106982                                                                  10698200
106983*---------------------------------------------------------------* 10698300
106984*    NUMERIC EDIT LAYOUT.                                       * 10698400
106985*---------------------------------------------------------------* 10698500
106986     COPY DPWS010I.                                               10698600
106987                                                                  10698700
106988******************************************************************10698899
106989** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **10698999
106990** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **10699099
106991******************************************************************10699199
106992     COPY DPWS030.                                                10699299
106993     COPY DPWS930.                                                10699399
106994                                                                  10699499
106995*---------------------------------------------------------------* 10699599
106996*    STANDARD COMMAREA.                                         * 10699699
106997*---------------------------------------------------------------* 10699799
106998     COPY DPWS020.                                                10699899
106999     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                10699999
107000                                                                  10700099
107001*---------------------------------------------------------------* 10700199
107002* INTER-APPLICATION COMMAREA.                                   * 10700299
107003*   RCWS012 - IS THE INPUT LAYOUT WHEN COMING FROM THE PURCHASE * 10700399
107004*             ORDER ADD/UPDATE PROGRAM (POKCS003)               * 10700499
107005*   RCWS012 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 10700599
107006*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 10700699
107007*---------------------------------------------------------------* 10700799
107008         10  INTER-APPL-COMM-AREA       PIC X(200).               10700899
107009     COPY RCWS012.                                                10700999
107010                                                                  10701099
107011*---------------------------------------------------------------* 10701199
107012*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 10701299
107013*---------------------------------------------------------------* 10701399
107014         10  ASC-SPECIFIC-COMMAREA.                               10701499
107015             15  ASC-DEPT-NBR                        PIC 9(03).   10701599
107016             15  ASC-REC-SEQ-NBR                      PIC X(04).  10701699
107017             15  ASC-REC-SEQ-NBR-N REDEFINES                      10701799
107018                     ASC-REC-SEQ-NBR                  PIC 9(04).  10701899
107019             15  ASC-OPER-UNT-ID                 PIC S9(04) COMP. 10701999
107020             15  ASC-FCLTY-ID          PIC S9(04) COMP.           10702099
107021                                                                  10702199
107022             15  ASC-SCREEN-FIELDS.                               10702299
107023                 20  ASC-PO-NUMBER                   PIC S9(09)   10702399
107024                                                     COMP.        10702499
107025                 20  ASC-DEFAULT-QUANTITY            PIC  X(08).  10702599
107026                 20  ASC-DEFAULT-QUANTITY-N REDEFINES             10702699
107027                     ASC-DEFAULT-QUANTITY            PIC  9(08).  10702799
107028             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                10702899
107029                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  10702999
107030                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   10703099
107031                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   10703199
107032                                                                  10703299
107033                 20  ASC-ITEM-ARRAY.                              10703399
107034                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        10703499
107035                         30  ASC-LIST-ITEM-NUMBER                 10703599
107036                                                     PIC S9(09)   10703699
107037                                                     COMP-3.      10703799
107038                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  10703899
107039                             88  ASC-VALID-SELECT    VALUE ' '    10703999
107040                                                           'S'    10704099
107041                                                           'B'    10704199
107042                                                           'E'.   10704299
107043                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   10704399
107044                             88  ASC-TEMP-SELECT     VALUE 'S'.   10704499
107045                             88  ASC-TEMP-BEGIN      VALUE 'B'.   10704599
107046                             88  ASC-TEMP-END        VALUE 'E'.   10704699
107047                         30  ASC-SELECTED-SW         PIC  X(01).  10704799
107048                             88  ASC-NO-SELECT       VALUE ' '.   10704899
107049                             88  ASC-SELECT          VALUE 'S'.   10704999
107050                             88  ASC-BEGIN           VALUE 'B'.   10705099
107051                             88  ASC-END             VALUE 'E'.   10705199
107052                         30  ASC-PO-LINE-NBR         PIC S9(09)   10705299
107053                                                         COMP.    10705399
107054                         30  ASC-MAJ-CLASS           PIC  X(02).  10705499
107055                         30  ASC-SUB-CLASS           PIC  X(02).  10705599
107056                         30  ASC-SKU                 PIC  X(08).  10705699
107057                         30  ASC-SKU-DESC            PIC  X(15).  10705799
107058                         30  ASC-UPC                 PIC  X(15).  10705899
107059                         30  ASC-TICKET-TYPE         PIC  X(15).  10705999
107060                         30  ASC-HANG-FOLD           PIC  X(05).  10706099
107061                                                                  10706199
107062             15  ASC-REQUEST-LINE-COUNT         PIC S9(09) COMP.  10706299
107063             15  ASC-FORMAT-INDICATOR           PIC  X(01) .      10706399
107064                 88 ASC-CRIT-SPEC-FORMAT-IND    VALUE '1',        10706499
107065                                                      '5', '7'.   10706599
107066                 88 ASC-LIST-FORMAT-IND         VALUE '2', '3',   10706699
107067                                                      '6'.        10706799
107068                 88 ASC-UPDATE-FORMAT-IND       VALUE '1', '2',   10706899
107069                                                      '5'.        10706999
107070             15  ASC-BLK-SUB                         PIC S9(04)   10707099
107071                                                          COMP    10707199
107072                                                          SYNC.   10707299
107073             15  ASC-ITEM-SUB                        PIC S9(04)   10707399
107074                                                          COMP    10707499
107075                                                          SYNC.   10707599
107076             15  ASC-SEL-SUB                         PIC S9(04)   10707699
107077                                                         COMP.    10707799
107078             15  ASC-SEL-ITEM                        PIC S9(04)   10707899
107079                                                         COMP.    10707999
107080             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  10708099
107081                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 10708199
107082             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   10708299
107083                                                          COMP-3. 10708399
107084             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   10708499
107085                                                          COMP-3. 10708599
107086             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   10708699
107087                                                          COMP-3. 10708799
107088             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   10708899
107089                                                          COMP-3. 10708999
107090             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   10709099
107091                                                          COMP-3. 10709199
107092             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   10709299
107093                                                          COMP-3. 10709399
107094             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   10709499
107095                                                          COMP    10709599
107096                                                          SYNC.   10709699
107097             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   10709799
107098                                                          COMP-3. 10709899
107099             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   10709999
107100                                                          COMP-3. 10710099
107101             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  10710199
107102                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   10710299
107103                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   10710399
107104             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  10710499
107105                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   10710599
107106                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   10710699
107107             15  ASC-LIST-QUEUE-NAME.                             10710799
107108                 20  ASC-LIST-TERM-ID                PIC  X(04).  10710899
107109                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   10710999
107110                                                          COMP-3. 10711099
107111                 20  ASC-LIST-SEQ                    PIC  9(01).  10711199
107112             15  ASC-SEL-QUEUE-NAME-IN               PIC  X(8).   10711299
107113             15  ASC-SEL-QUEUE-NAME-OUT.                          10711399
107114                 20  ASC-SEL-TERM-ID                 PIC  X(04).  10711499
107115                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   10711599
107116                                                          COMP-3. 10711699
107117                 20  ASC-SEL-SEQ                     PIC  9(01).  10711799
107118             15  ASC-START-ITEM-REQUEST.                          10711899
107119                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  10711999
107120                                                                  10712099
107121*---------------------------------------------------------------* 10712199
107122*    ABEND PROCESSING COPYBOOK.                                 * 10712299
107123*---------------------------------------------------------------* 10712399
107124     COPY DPWS013.                                                10712499
107125                                                                  10712599
107126*---------------------------------------------------------------* 10712699
107127*    DB2 AREA FOR THE TICKET FORMAT TABLE                       * 10712799
107128*---------------------------------------------------------------* 10712899
107129     EXEC SQL                                                     10712999
107130          INCLUDE TTKTFMT                                         10713099
107131     END-EXEC.                                                    10713199
107132*---------------------------------------------------------------* 10713299
107133*    DB2 AREA FOR THE TMDSEAR TABLE                             * 10713399
107134*---------------------------------------------------------------* 10713499
107135     EXEC SQL                                                     10713599
107136          INCLUDE TMDSEAR                                         10713699
107137     END-EXEC.                                                    10713799
107138*---------------------------------------------------------------* 10713899
107139*    DB2 AREA FOR THE TDCVSVL TABLE                             * 10713999
107140*---------------------------------------------------------------* 10714099
107141     EXEC SQL                                                     10714199
107142          INCLUDE TDCVSVL                                         10714299
107143     END-EXEC.                                                    10714399
107144*---------------------------------------------------------------* 10714499
107145*    DB2 AREA FOR THE TVSCHVL TABLE                             * 10714599
107146*---------------------------------------------------------------* 10714699
107147     EXEC SQL                                                     10714799
107148          INCLUDE TVSCHVL                                         10714899
107149     END-EXEC.                                                    10714999
107150*---------------------------------------------------------------* 10715099
107151*    DB2 AREA FOR THE RECEIPT ITEM TABLE                        * 10715199
107152*---------------------------------------------------------------* 10715299
107153     EXEC SQL                                                     10715399
107154          INCLUDE TRECITM                                         10715499
107155     END-EXEC.                                                    10715599
107156                                                                  10715699
107157                                                                  10715799
107158*----------------------------------------------------------------*10715899
107159*    DB2 DCLGEN FOR THE XLT00003 (XLT_SKU) TABLE                  10715999
107160*----------------------------------------------------------------*10716099
107161     EXEC SQL                                                     10716199
107162          INCLUDE XLT00003                                        10716299
107163     END-EXEC.                                                    10716399
107164                                                                  10716499
107165*----------------------------------------------------------------*10716599
107166*    DB2 DCLGEN FOR THE XLT00004 (XLT_VND_STYL) TABLE             10716699
107167*----------------------------------------------------------------*10716799
107168     EXEC SQL                                                     10716899
107169          INCLUDE XLT00004                                        10716999
107170     END-EXEC.                                                    10717099
107171                                                                  10717199
107172*----------------------------------------------------------------*10717299
107173*    DB2 DCLGEN FOR THE XLT00006 (XLT_UPC) TABLE                  10717399
107174*----------------------------------------------------------------*10717499
107175     EXEC SQL                                                     10717599
107176          INCLUDE XLT00006                                        10717699
107177     END-EXEC.                                                    10717799
107178                                                                  10717899
107179*---------------------------------------------------------------* 10717999
107180*    DB2 AREA FOR COMMUNICATIONS                                * 10718099
107181*---------------------------------------------------------------* 10718199
107182     EXEC SQL                                                     10718299
107183          INCLUDE SQLCA                                           10718399
107184     END-EXEC.                                                    10718499
107185                                                                  10718599
107186*---------------------------------------------------------------* 10718699
107187*    RECITM-CURSOR  - GETS ALL THE TICKET TYPES ON TRECITM       *10718799
107188*---------------------------------------------------------------* 10718899
107189     EXEC SQL                                                     10718999
107190          DECLARE RECITM-CURSOR CURSOR                            10719099
107191          FOR SELECT                                              10719199
107192                A.ORD_NBR                                         10719299
107193              , A.ORD_LNE_NBR                                     10719399
107194              , A.PRE_TKT_IND                                     10719499
107195              , A.TKT_FMT_ID                                      10719599
107196              , A.VEND_STYL_NAME                                  10719699
107197              , B.INTR_UPC_ID                                     10719799
107198              , B.SKU_NBR                                         10719899
107199              , B.SKU_DESC                                        10719999
107200              , SUBSTR(DIGITS(C.DEPT_NBR),2,3)                    10720099
107201              , SUBSTR(DIGITS(C.MAJ_CL_NBR),3,2)                  10720199
107202              , SUBSTR(DIGITS(C.SUB_CL_NBR),3,2)                  10720299
107203              , C.ENT_ID                                          10720399
107204              , C.VS_ID                                           10720499
107205              , C.TKT_TYP_DESC                                    10720599
107206              , C.HNG_FOLD_DESC                                   10720699
107207          FROM                                                    10720799
107208                TRECITM A                                         10720899
107209              , XLT_SKU  B                                        10720999
107210              , XLT_VND_STYL C                                    10721099
107211          WHERE                                                   10721199
107212                A.ORD_NBR        = :DK-PO-NUMBER                  10721299
107220            AND A.OPER_UNT_ID    = :DK-OPER-UNT-ID                10722099
107230            AND A.FCLTY_ID       = :DK-FCLTY-ID                   10723099
107231            AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                10723199
107232            AND A.ITM_NBR        = B.ITM_NBR                      10723200
107233            AND B.STYL_ID        = C.STYL_ID                      10723399
107234                                                                  10723499
107235          ORDER BY A.ORD_LNE_NBR                                  10723599
107236     END-EXEC.                                                    10723600
107237                                                                  10723799
107238                                                                  10723800
107239 LINKAGE SECTION.                                                 10723900
107240                                                                  10724000
107241 01  DFHCOMMAREA.                                                 10724100
107242     05  FILLER                         OCCURS  1 TO 4072 TIMES   10724200
107243                                        DEPENDING ON EIBCALEN.    10724300
107244         10  FILLER                     PIC X.                    10724400
107245                                                                  10724500
107246 PROCEDURE DIVISION.                                              10724600
107247******************************************************************10724700
107248**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **10724800
107249**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **10724900
107250**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **10725000
107251******************************************************************10725100
107252 0000-MAIN-MODULE.                                                10725200
107253     INITIALIZE DP030-CICS-API-FIELDS.                            10725300
107254     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       10725400
107255     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          10725500
107256     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         10725600
107257     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       10725700
107258     MOVE LENGTH OF RC292AI        TO DP030-MAP-LENGTH (1).       10725800
107259     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              10725933
107260     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10726033
107261     PERFORM 0001-CALL-CICS-ARCH-API.                             10726100
107262                                                                  10726200
107263     PERFORM 1000-CONTROL-PROCESSING                              10726300
107264                                                                  10726400
107265     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10726500
107266     PERFORM 0001-CALL-CICS-ARCH-API.                             10726600
107267                                                                  10726700
107268******************************************************************10726800
107269**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **10726900
107270**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10727000
107271******************************************************************10727100
107272 0001-CALL-CICS-ARCH-API.                                         10727200
107274     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10727499
107275                                    DFHCOMMAREA                   10727599
107276                                    DP030-CICS-API-FIELDS         10727699
107277                                    DP020-STANDARD-COMMAREA       10727799
107278                                    RC292AI.                      10727899
107279                                                                  10727900
107280     IF  DP030-RC-CALL-SUCCESSFUL                                 10728000
107281         CONTINUE                                                 10728100
107282     ELSE                                                         10728200
107283         SET DP013-NO-ROLLBACK                                    10728300
107284             DP013-XCTL-DISPLAY-RESTART                           10728400
107285             DP013-CICS-ABEND      TO TRUE                        10728500
107286         MOVE '0001-CALL-CICS-ARCH-API'                           10728600
107287                                   TO DP013-PARAGRAPH             10728700
107289         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O10728999
107290-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10729099
107292         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10729200
107293         PERFORM DP013-0000-PROCESS-ABEND                         10729300
107294     END-IF.                                                      10729400
107295*----------------------------------------------------------------*10729500
107296* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10729600
107297* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10729700
107298*                                                                *10729800
107299* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10729900
107300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10730000
107301*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10730100
107302*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10730200
107303*----------------------------------------------------------------*10730300
107304                                                                  10730400
107305 1000-CONTROL-PROCESSING.                                         10730500
107306     EVALUATE TRUE                                                10730600
107307         WHEN DP020-NEXT-ACT-INITIAL                              10730700
107308             INITIALIZE ASC-SPECIFIC-COMMAREA                     10730800
107309             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10730900
107310                                      ASC-SEL-TERM-ID             10731000
107311             MOVE DP020-SRC-TASK-NUMBER                           10731100
107312                                   TO ASC-LIST-TASK-NUMBER        10731200
107313                                      ASC-SEL-TASK-NUMBER         10731300
107314             MOVE DP020-INT-APPL-FORMAT-IND                       10731400
107315                                   TO  ASC-FORMAT-INDICATOR       10731500
107316             MOVE PC-LIST-QUEUE-SEQ                               10731600
107317                                   TO ASC-LIST-SEQ                10731700
107318             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 10731800
107319             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10731900
107320***-----$TEMPLATE NOTE$-------------------------------------------10732000
107321*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,10732100
107322*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  10732200
107323*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.10732300
107324***---------------------------------------------------------------10732400
107325             IF  PS-COMMAREA-NOT-VALID                            10732500
107326                 MOVE PC-TSYMSG-99901                             10732600
107327                                   TO DP020-MSG-NUMBER            10732700
107328                 SET DP020-MSG-FATAL                              10732800
107329                                   TO TRUE                        10732900
107330                 SET DP020-NEXT-ACT-APPL-ERROR                    10733000
107331                                   TO TRUE                        10733100
107332             ELSE                                                 10733200
107333                 PERFORM 4000-BUILD-INITIAL-PANEL                 10733300
107334             END-IF                                               10733400
107335                                                                  10733500
107336         WHEN DP020-NEXT-ACT-READ-MAP                             10733600
107337             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10733700
107338                                   TO PV-TOP-ITEM                 10733800
107339             PERFORM 2000-PROCESS-PANEL                           10733900
107340                                                                  10734000
107341         WHEN DP020-NEXT-ACT-RETURN                               10734100
107342              PERFORM 2050-DELETE-LIST-QUEUE                      10734299
107343              MOVE ASC-OPER-UNT-ID TO                             10734399
107350                            RC012-OPER-UNT-ID                     10735099
107360              MOVE ASC-FCLTY-ID TO                                10736099
107370                          RC012-FCLTY-ID                          10737099
107380              MOVE  ASC-PO-NUMBER                                 10738099
107390                           TO RC012-PO-NBR                        10739099
107400              MOVE ASC-REC-SEQ-NBR-N                              10740099
107500                      TO RC012-REC-SEQ-NBR                        10750099
107600              PERFORM 4000-BUILD-INITIAL-PANEL                    10760099
107700              PERFORM 3200-RESET-ATTRIBUTES                       10770099
107800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10780099
112400                                                                  11240000
112500         WHEN OTHER                                               11250000
112600             SET DP013-LOGIC-ABEND TO TRUE                        11260000
112700             SET DP013-NO-ROLLBACK TO TRUE                        11270000
112800             MOVE '1000-CONTROL-PROCESSING'                       11280000
112900                                   TO DP013-PARAGRAPH             11290000
113000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    11300000
113100                                   TO DP013-MESSAGE-TEXT(1)       11310000
113200             PERFORM DP013-0000-PROCESS-ABEND                     11320000
113300     END-EVALUATE.                                                11330000
113400                                                                  11340000
113600*----------------------------------------------------------------*11360000
113700* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *11370000
113800* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *11380000
113900*----------------------------------------------------------------*11390000
114100 1100-PROCESS-INTER-APPL-COMM.                                    11410000
114300     SET PS-COMMAREA-VALID         TO TRUE.                       11430000
114400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     11440000
114500     EVALUATE TRUE                                                11450000
114600         WHEN ASC-CRIT-SPEC-FORMAT-IND                            11460000
114700                                                                  11470000
114800             MOVE RC012-OPER-UNT-ID                               11480033
114900                                   TO ASC-OPER-UNT-ID             11490033
114910                                      DK-OPER-UNT-ID              11491099
115000             MOVE RC012-FCLTY-ID   TO ASC-FCLTY-ID                11500033
115001                                       DK-FCLTY-ID                11500199
115002             MOVE RC012-PO-NBR     TO ASC-PO-NUMBER               11500233
115003                                      DK-PO-NUMBER                11500315
115004             MOVE RC012-REC-SEQ-NBR                               11500415
115005                                   TO ASC-REC-SEQ-NBR-N           11500533
115006                                      DK-REC-SEQ-NBR              11500615
116000         WHEN ASC-LIST-FORMAT-IND                                 11600000
116001             SET ASC-USE-SELECTION-QUEUE TO TRUE                  11600133
116002             MOVE RC012-NUMBER-OF-SELECTED-ITEMS                  11600213
116003                                   TO ASC-NUMBER-OF-SELECTED-ITEMS11600313
116004             MOVE RC012-NUMBER-OF-TS-ITEMS                        11600413
116005                                   TO ASC-NUMBER-OF-TS-ITEMS      11600513
116006             MOVE RC012-SEL-QUEUE-NAME                            11600613
116007                                   TO ASC-SEL-QUEUE-NAME-IN       11600713
116008             PERFORM 1120-PREPARE-LIST-ENTRY                      11600813
116009                                                                  11600913
116010         WHEN OTHER                                               11601015
116020             SET PS-COMMAREA-NOT-VALID TO TRUE                    11602015
116100             SET ASC-USE-SELECTION-QUEUE TO TRUE                  11610000
116101             MOVE RC012-NUMBER-OF-SELECTED-ITEMS                  11610133
116102                                   TO ASC-NUMBER-OF-SELECTED-ITEMS11610213
116200             MOVE RC012-NUMBER-OF-TS-ITEMS                        11620000
116300                               TO ASC-NUMBER-OF-TS-ITEMS          11630000
116400             MOVE RC012-SEL-QUEUE-NAME                            11640000
116500                               TO ASC-SEL-QUEUE-NAME-IN           11650000
116600             PERFORM 1120-PREPARE-LIST-ENTRY.                     11660000
117600                                                                  11760000
117900*----------------------------------------------------------------*11790000
118000*    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *11800000
118100*----------------------------------------------------------------*11810000
118300 1120-PREPARE-LIST-ENTRY.                                         11830000
118500     MOVE RC016-MAX-ITEMS TO ASC-SEL-SUB.                         11850000
118600     MOVE ZERO            TO ASC-SEL-ITEM.                        11860000
118700     PERFORM 1130-GET-NEXT-MESSAGE.                               11870000
118800                                                                  11880000
118900*----------------------------------------------------------------*11890000
119000*    GET THE NEXT MESSAGE IF A LIST OF MESSAGES IS BEING         *11900000
119100*    PROCESSED.                                                  *11910000
119200*----------------------------------------------------------------*11920000
119400 1130-GET-NEXT-MESSAGE.                                           11940000
119600     ADD +1                       TO ASC-SEL-SUB.                 11960000
119700     IF  ASC-SEL-SUB > RC016-MAX-ITEMS                            11970000
119800         ADD +1                   TO ASC-SEL-ITEM                 11980000
119900         MOVE +1                  TO ASC-SEL-SUB                  11990000
120000     END-IF.                                                      12000000
120100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                12010000
120200         PERFORM 9100-READ-SEL-QUEUE-IN                           12020000
120300         IF  RC016-ITEM (ASC-SEL-SUB) > ZERO                      12030000
120400             MOVE RC016-PO-LNE-NBR (ASC-SEL-SUB)                  12040099
120500                                       TO ASC-PO-LINE-NBR         12050000
489300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48930000
489301                                          DK-PO-LNE-NBR           48930199
489302             SET RC016-INQ (ASC-SEL-SUB) TO TRUE                  48930200
489303             PERFORM 9200-REWRITE-SEL-QUEUE                       48930300
489304         ELSE                                                     48930400
489305             SUBTRACT +1 FROM ASC-SEL-SUB                         48930500
489306             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             48930600
489307             SET DP020-MSG-INFORMATIONAL TO TRUE                  48930700
489308         END-IF                                                   48930800
489309     ELSE                                                         48930900
489310         SUBTRACT +1 FROM ASC-SEL-ITEM                            48931000
489311         MOVE RC016-MAX-ITEMS     TO ASC-SEL-SUB                  48931100
489312         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             48931200
489313         SET DP020-MSG-INFORMATIONAL TO TRUE                      48931300
489314     END-IF.                                                      48931400
489315                                                                  48931500
489316*----------------------------------------------------------------*48931600
489317* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *48931700
489318* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *48931800
489319* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *48931900
489320* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *48932000
489321* FUNCTION KEYS CAN GET THIS FAR.                                *48932100
489322*----------------------------------------------------------------*48932200
489323 2000-PROCESS-PANEL.                                              48932300
489324     EVALUATE TRUE                                                48932400
489325         WHEN DP020-SRC-AID = DP016-CLEAR                         48932500
489326             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    48932600
489327             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   48932700
489328             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 48932800
489329         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    48932900
489330             MOVE ASC-PO-NUMBER    TO DK-PO-NUMBER                48933000
489331             MOVE DP020-INT-APPL-FORMAT-IND                       48933100
489332                                   TO  ASC-FORMAT-INDICATOR       48933200
489333             PERFORM 2050-DELETE-LIST-QUEUE                       48933300
489334             PERFORM 4000-BUILD-INITIAL-PANEL                     48933400
489335         WHEN OTHER                                               48933500
489336             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 48933600
489337             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   48933700
489338             IF  PS-NO-ERROR                                      48933800
489339                 SET DP030-CONTINUE-GO TO TRUE                    48933900
489340                 PERFORM 2100-CHECK-FUNCTION-KEY                  48934000
489341             ELSE                                                 48934100
489342                 SET DP030-OVERRIDE-GO TO TRUE                    48934200
489343             END-IF                                               48934300
489344     END-EVALUATE.                                                48934400
489345                                                                  48934500
489346*----------------------------------------------------------------*48934600
489347*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *48934700
489348*----------------------------------------------------------------*48934800
489349 2050-DELETE-LIST-QUEUE.                                          48934900
489350     EXEC CICS                                                    48935000
489351         DELETEQ TS                                               48935100
489352             QUEUE (ASC-LIST-QUEUE-NAME)                          48935200
489353             RESP  (PV-CICS-RESP)                                 48935300
489354     END-EXEC.                                                    48935400
489355                                                                  48935500
489356     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       48935600
489357        (PV-CICS-RESP = DFHRESP(QIDERR))                          48935700
489358         CONTINUE                                                 48935800
489359     ELSE                                                         48935900
489360         SET DP013-CICS-ABEND      TO TRUE                        48936000
489361         SET DP013-NO-ROLLBACK     TO TRUE                        48936100
489362                                                                  48936200
489363         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         48936300
489364         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    48936400
489365                                   TO DP013-MESSAGE-TEXT (1)      48936500
489366         PERFORM DP013-0000-PROCESS-ABEND                         48936600
489367     END-IF.                                                      48936700
489368                                                                  48936800
489369     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  48936900
489370                                                                  48937000
489371*----------------------------------------------------------------*48937100
489372* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*48937200
489373* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *48937300
489374* CICS ARCHITECTURE API.                                         *48937400
489375*----------------------------------------------------------------*48937500
489376 2100-CHECK-FUNCTION-KEY.                                         48937600
489377     EVALUATE TRUE                                                48937700
489378* ENTER KEY WAS PRESSED                                           48937800
489379         WHEN DP020-SRC-AID = DP016-ENTER                         48937900
489380             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   48938000
489381             IF  PS-ERROR                                         48938100
489382                 CONTINUE                                         48938200
489383             ELSE                                                 48938300
489384                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             48938400
489385             END-IF                                               48938500
489386                                                                  48938600
489387         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  48938700
489388             MOVE +1               TO PV-TOP-ITEM                 48938800
489389             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 48938900
489390                                                                  48939000
489391         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   48939100
489392             PERFORM 2110-BROWSE-BACKWARD                         48939200
489393             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 48939300
489394                                                                  48939400
489395         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   48939500
489396             PERFORM 2120-BROWSE-FORWARD                          48939600
489397             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 48939700
489398                                                                  48939805
489399         WHEN OTHER                                               48939900
489400             SET DP013-NO-ROLLBACK                                48940000
489401                 DP013-XCTL-DISPLAY-RESTART                       48940100
489402                 DP013-CICS-ABEND  TO TRUE                        48940200
489403             MOVE '2100-CHECK-FUNCTION-KEY'                       48940300
489404                                   TO DP013-PARAGRAPH             48940400
489405             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      48940500
489406                                   TO DP013-MESSAGE-TEXT (1)      48940600
489407             PERFORM DP013-0000-PROCESS-ABEND                     48940700
489408     END-EVALUATE.                                                48940800
489409                                                                  48940900
489410*----------------------------------------------------------------*48941000
489411*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *48941100
489412*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *48941200
489413*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *48941300
489414*    MESSAGE.                                                    *48941400
489415*----------------------------------------------------------------*48941500
489416 2110-BROWSE-BACKWARD.                                            48941600
489417     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    48941700
489418         GIVING PV-TOP-ITEM.                                      48941800
489419                                                                  48941900
489420     IF  ((PV-TOP-ITEM < +1)                                      48942000
489421       OR (PV-TOP-ITEM = +1))                                     48942100
489422         MOVE +1                     TO PV-TOP-ITEM               48942200
489423*        -- TOP OF LIST --                                        48942300
489424         MOVE PC-TSYMSG-00069        TO DP020-MSG-NUMBER          48942400
489425         SET DP020-MSG-INFORMATIONAL TO TRUE                      48942500
489426     END-IF.                                                      48942600
489427                                                                  48942700
489428*----------------------------------------------------------------*48942800
489429*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *48942900
489430*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *48943000
489431*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *48943100
489432*----------------------------------------------------------------*48943200
489433 2120-BROWSE-FORWARD.                                             48943300
489434     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              48943400
489435         GIVING PV-TOP-ITEM.                                      48943500
489436     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   48943600
489437         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             48943700
489438*        -- BOTTOM OF LIST --                                     48943800
489439         MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER          48943900
489440         SET DP020-MSG-INFORMATIONAL TO TRUE                      48944000
489441     ELSE                                                         48944100
489442         COMPUTE PV-BOTTOM-ITEM =                                 48944200
489443             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 48944300
489444         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            48944400
489445*            -- BOTTOM OF LIST --                                 48944500
489446             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            48944600
489447             SET DP020-MSG-INFORMATIONAL TO TRUE                  48944700
489448         END-IF                                                   48944800
489449     END-IF.                                                      48944900
489450                                                                  48945000
489451*----------------------------------------------------------------*48945100
489452*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *48945200
489453*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *48945300
489454*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *48945400
489455*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *48945500
489456*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *48945600
489457*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *48945700
489458*----------------------------------------------------------------*48945800
489459 2130-CHECK-FOR-JUMP-BROWSE.                                      48945900
489460     SET PS-NO-ERROR               TO TRUE.                       48946000
489461     IF (ASC-START-ITEM-REQUEST = SPACE)                          48946100
489462         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             48946200
489463     ELSE                                                         48946300
489464         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     48946400
489465         MOVE PC-MSG-NUMBER-LENGTH   TO DP010I-MAXIMUM-DIGITS     48946500
489466         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   48946600
489467         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  48946700
489468         CALL DP010I-NUMERIC-EDIT-ROUTINE                         48946899
489469              USING DP010I-NUMERIC-EDIT-AREA                      48946999
489470                                                                  48947000
489471         IF  NOT DP010I-ERROR-DETECTED                            48947100
489472             MOVE DP010I-NUMERIC-FIELD                            48947200
489473                                   TO  ASC-START-ITEM-REQUEST-N   48947300
489474             IF  ASC-START-ITEM-REQUEST-N > ZERO                  48947400
489475                 IF  ASC-START-ITEM-REQUEST-N >                   48947500
489476                                          ASC-NUMBER-OF-ITEMS-READ48947600
489477                     MOVE SPACE TO ASC-START-ITEM-REQUEST         48947700
489478                     COMPUTE PV-TOP-ITEM =                        48947800
489479                             ASC-NUMBER-OF-ITEMS-READ             48947900
489480                             - PC-ITEMS-PER-PANEL + 1             48948000
489481                     IF  PV-TOP-ITEM < +1                         48948100
489482                         MOVE +1   TO PV-TOP-ITEM                 48948200
489483                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 48948300
489484                         SET DP020-MSG-INFORMATIONAL TO TRUE      48948400
489485                     END-IF                                       48948500
489486                 ELSE                                             48948600
489487                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 48948700
489488                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      48948800
489489                     COMPUTE PV-BOTTOM-ITEM =                     48948900
489490                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     48949000
489491                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ48949100
489492*                        -- BOTTOM OF LIST --                     48949200
489493                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 48949300
489494                         SET DP020-MSG-INFORMATIONAL TO TRUE      48949400
489495                     END-IF                                       48949500
489496                 END-IF                                           48949600
489497             ELSE                                                 48949700
489498*                --- VALUE OUT OF RANGE ----                      48949800
489499                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         48949900
489500                 MOVE -1             TO ASTRTITL                  48950000
489501                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              48950100
489502                 MOVE DP015-REVERSE  TO ASTRTITH                  48950200
489503                 MOVE DP015-RED      TO ASTRTITC                  48950300
489504                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           48950400
489505                 SET DP020-MSG-FATAL TO TRUE                      48950500
489506                 SET PS-ERROR        TO TRUE                      48950600
489507             END-IF                                               48950700
489508         ELSE                                                     48950800
489509             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            48950900
489510             MOVE -1               TO ASTRTITL                    48951000
489511             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  48951100
489512             MOVE DP015-REVERSE    TO ASTRTITH                    48951200
489513             MOVE DP015-RED        TO ASTRTITC                    48951300
489514             MOVE DP015-UNP-NUM-BRT-MDT                           48951400
489515                                   TO ASTRTITA                    48951500
489516             SET DP020-MSG-FATAL   TO TRUE                        48951600
489517             SET PS-ERROR          TO TRUE                        48951700
489518         END-IF                                                   48951800
489519     END-IF.                                                      48951900
489520                                                                  48952000
489521*----------------------------------------------------------------*48952133
489522*   REFRESH COMMAREA                                              48952233
489523* ---------------------------------------------------------------*48952333
489524 2170-REFRESH-COMMAREA.                                           48952433
489525*  RE-READ QUEUE TO REFRESH CURRENT INFORMATION                   48952533
489526     MOVE ASC-LIST-ITEM-NUMBER (1 1)  TO PV-LIST-ITEM-NUMBER      48952633
489527                                  PV-TOP-ITEM                     48952733
489528     COMPUTE PV-BLOCK-NUMBER =                                    48952833
489529        1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL)      48952933
489530                                                                  48953033
489531     MOVE 1                    TO ASC-BLK-SUB                     48953133
489532     PERFORM 4410-READ-TEMP-STORAGE                               48953233
489533     IF ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN PV-BLOCK-NUMBER    48953333
489534         ADD 1                 TO ASC-BLK-SUB                     48953433
489535                                  PV-BLOCK-NUMBER                 48953533
489536         PERFORM 4410-READ-TEMP-STORAGE                           48953633
489537     END-IF.                                                      48953733
489538                                                                  48953833
489539******************************************************************48953900
489540** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **48954000
489541** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **48954100
489542******************************************************************48954200
489543 2200-MOVE-SCREEN-TO-COMMAREA.                                    48954300
489544     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             48954400
489545     MOVE +1                       TO PV-SUB.                     48954500
489546                                                                  48954600
489547     PERFORM 3100-SET-SUBSCRIPTS.                                 48954700
489548     IF  ASTRTITL > ZERO                                          48954800
489549         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          48954900
489550     ELSE                                                         48955000
489551         IF  ASTRTITF = DP015-ERASE-EOF                           48955100
489552             INITIALIZE ASC-START-ITEM-REQUEST                    48955200
489553         END-IF                                                   48955300
489554     END-IF.                                                      48955400
489555                                                                  48955500
489556     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          48955600
489557         VARYING PV-SUB                                           48955700
489558         FROM 1 BY 1                                              48955800
489559         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      48955900
489560                                                                  48956000
489561******************************************************************48956100
489562** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**48956200
489563******************************************************************48956300
489564 2210-MOVE-LINES-TO-COMMAREA.                                     48956400
489565     IF  MR-SELECTL (PV-SUB) > ZERO                               48956500
489566         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             48956600
489567         MOVE MR-SELECTI (PV-SUB) TO ASC-TEMP-SELECTED-SW         48956700
489568                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      48956800
489569     ELSE                                                         48956900
489570         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                48957000
489571                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     48957100
489572                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        48957200
489573                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      48957300
489574         END-IF                                                   48957400
489575     END-IF.                                                      48957500
489576                                                                  48957600
489577     ADD +1                        TO ASC-ITEM-SUB.               48957700
489578     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        48957800
489579         ADD +1                    TO ASC-BLK-SUB                 48957900
489580         MOVE +1                   TO ASC-ITEM-SUB                48958000
489581     END-IF.                                                      48958100
489582                                                                  48958200
489583******************************************************************48958300
489584** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **48958400
489585** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **48958500
489586******************************************************************48958600
489587 3000-EDIT-DATA-IN-COMMAREA.                                      48958700
489588     SET PS-NO-ERROR               TO TRUE.                       48958800
489589     PERFORM 3200-RESET-ATTRIBUTES.                               48958900
489590     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     48959033
489591                                                                  48959133
489592**                                                                48959200
489593* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              48959300
489594* EDITTING IS DONE FROM THE BOTTOM UP.                            48959400
489595**                                                                48959500
489596     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       48959600
489597         ASC-ITEMS-DISPLAYED - 1.                                 48959700
489598     PERFORM 3100-SET-SUBSCRIPTS.                                 48959800
489599     PERFORM 3300-EDIT-SELECTIONS                                 48959900
489600         VARYING PV-SUB                                           48960000
489601         FROM PV-SUB BY -1                                        48960100
489602         UNTIL PV-SUB < +1.                                       48960200
489603                                                                  48960300
489604     IF  PS-NO-ERROR                                              48960400
489605         PERFORM 3400-CHECK-RANGE-SEQUENCE                        48960500
489606     END-IF.                                                      48960600
489607                                                                  48960700
489608     IF  ((PS-NO-ERROR)                                           48960800
489609       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   48960900
489610       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    48961000
489611             PERFORM 3500-MARK-RANGE-AS-SELECTED                  48961100
489612     END-IF.                                                      48961200
489613                                                                  48961300
489614*----------------------------------------------------------------*48961433
489615*    SELECT THE TICKET FORMAT DESCRIPTION                        *48961533
489616*----------------------------------------------------------------*48961633
489617*---THIS PARAGRAPH COMMENTED OUT ON 2/12/03    VML      ---------*48961733
489618*3050-SELECT-TICKET-DESC.                                         48961899
489619*    PERFORM                                                      48961933
489620*        WITH TEST AFTER                                          48962033
489621*        VARYING PV-RETRY-COUNTER                                 48962133
489622*        FROM 1 BY 1                                              48962233
489623*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48962333
489624*                  OR (SQLCODE = ZERO)                            48962433
489625*                  OR (SQLCODE = -811)                            48962533
489626*                  OR (SQLCODE = +100))                           48962633
489627*                                                                 48962733
489628*        EXEC SQL                                                 48962833
489629*            SELECT   TKT_FMT_DESC                                48962933
489630*            INTO    :TKTFMT-TKT-FMT-DESC                         48963033
489631*            FROM    TTKTFMT                                      48963133
489632*            WHERE   TKT_FMT_ID   = :DK-TKT-FMT-ID                48963233
489633*        END-EXEC                                                 48963333
489634*                                                                 48963433
489635*        EVALUATE TRUE                                            48963533
489636*            WHEN SQLCODE = ZERO                                  48963633
489637*            WHEN SQLCODE = -811                                  48963733
489638*                CONTINUE                                         48963833
489639*            WHEN SQLCODE = +100                                  48963933
489640*                MOVE SPACE TO TKTFMT-TKT-FMT-DESC                48964099
489641*            WHEN SQLCODE = -904                                  48964133
489642*            WHEN SQLCODE = -913                                  48964233
489643*                CONTINUE                                         48964333
489644*            WHEN SQLWARN0 NOT = SPACES                           48964433
489645*            WHEN SQLCODE < ZERO                                  48964533
489646*            WHEN SQLCODE > ZERO                                  48964633
489647*                MOVE '3050-SELECT-TICKET-DESC'                   48964733
489648*                                    TO DP013-PARAGRAPH           48964833
489649*                MOVE 'GET TKT DESC' TO DP013-MESSAGE-TEXT (1)    48964933
489650*                MOVE DK-TKT-FMT-ID  TO DP013-MESSAGE-TEXT (2)    48965033
489651*                MOVE SQLCA          TO DP013-SQLCA               48965133
489652*                MOVE 'TTKTFMT '     TO DP013-DB2-TABLE-NAME (1)  48965233
489653*                SET DP013-DB2-ABEND                              48965333
489654*                    DP013-XCTL-DISPLAY-RESTART TO TRUE           48965433
489655*                PERFORM DP013-0000-PROCESS-ABEND                 48965533
489656*        END-EVALUATE                                             48965633
489657*    END-PERFORM.                                                 48965733
489658*                                                                 48965833
489659*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48965933
489660*        MOVE '3050-SELECT-TICKET-DESC  ' TO DP013-PARAGRAPH      48966033
489661*        MOVE 'MAX RETRIES EXCEEDED SELECTING TICKET DESC '       48966133
489662*                                  TO DP013-MESSAGE-TEXT (1)      48966233
489663*        MOVE SQLCA                TO DP013-SQLCA                 48966333
489664*        MOVE 'TTKTFMT '           TO DP013-DB2-TABLE-NAME (1)    48966433
489665*        SET DP013-DB2-ABEND                                      48966533
489666*            DP013-XCTL-DISPLAY-RESTART TO TRUE                   48966633
489667*        PERFORM DP013-0000-PROCESS-ABEND                         48966733
489668*    END-IF.                                                      48966833
489669*                                                                 48966900
489670*----------------------------------------------------------------*48967000
489671*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *48967100
489672*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*48967200
489673*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *48967300
489674*                                                                *48967400
489675*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *48967500
489676*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *48967600
489677*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *48967700
489678*    US IN THE 2ND BLOCK OF THE ARRAY.                           *48967800
489679*----------------------------------------------------------------*48967900
489680 3100-SET-SUBSCRIPTS.                                             48968000
489681     COMPUTE ASC-ITEM-SUB =                                       48968100
489682         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        48968200
489683                                                                  48968300
489684     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         48968400
489685         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            48968500
489686                                                                  48968600
489687         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               48968700
489688     ELSE                                                         48968800
489689         MOVE +1                     TO ASC-BLK-SUB               48968900
489690     END-IF.                                                      48969000
489691                                                                  48969100
489692******************************************************************48969200
489693** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **48969300
489694******************************************************************48969400
489695 3200-RESET-ATTRIBUTES.                                           48969500
489696     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   48969633
489697     MOVE DP015-GREEN              TO ASTRTITC.                   48969733
489698     MOVE DP015-UNDERLINE          TO ASTRTITH.                   48969833
489699                                                                  48969900
489700******************************************************************48970000
489701** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **48970100
489702** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **48970200
489703** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **48970300
489704** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **48970400
489705******************************************************************48970500
489706 3300-EDIT-SELECTIONS.                                            48970600
489707     EVALUATE TRUE                                                48970700
489708         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     48970800
489709             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         48970900
489710                 CONTINUE                                         48971000
489711         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         48971100
489712             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        48971200
489713                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   48971300
489714                 MOVE ASC-TEMP-SELECTED-SW                        48971400
489715                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48971500
489716                                TO ASC-SELECTED-SW                48971600
489717                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48971700
489718             END-IF                                               48971800
489719         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     48971900
489720                 = SPACE                                          48972000
489721             EVALUATE TRUE                                        48972100
489722                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       48972200
489723                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS48972300
489724                     MOVE SPACE TO ASC-SELECTED-SW                48972400
489725                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48972500
489726                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        48972600
489727                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    48972700
489728                     MOVE SPACE TO ASC-SELECTED-SW                48972800
489729                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48972900
489730                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          48973000
489731                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      48973100
489732                     MOVE SPACE TO ASC-SELECTED-SW                48973200
489733                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48973300
489734             END-EVALUATE                                         48973400
489735         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           48973500
489736             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            48973600
489737                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    48973700
489738             END-IF                                               48973800
489739             PERFORM 3310-EDIT-RANGE                              48973900
489740         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             48974000
489741             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            48974100
489742                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    48974200
489743             END-IF                                               48974300
489744             PERFORM 3310-EDIT-RANGE                              48974400
489745         WHEN OTHER                                               48974500
489746             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           48974600
489747             SET DP020-MSG-FATAL    TO TRUE                       48974700
489748             MOVE -1                TO MR-SELECTL (PV-SUB)        48974800
489749             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  48974900
489750             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        48975000
489751             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        48975100
489752             SET PS-ERROR TO TRUE                                 48975200
489753             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            48975300
489754                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     48975400
489755                 MOVE SPACE         TO ASC-SELECTED-SW            48975500
489756                                        (ASC-BLK-SUB ASC-ITEM-SUB)48975600
489757             END-IF                                               48975700
489758     END-EVALUATE.                                                48975800
489759                                                                  48975900
489760     SUBTRACT +1             FROM PV-ITEM-IN-USE                  48976033
489761                                  ASC-ITEM-SUB.                   48976133
489762     IF  ASC-ITEM-SUB < 1                                         48976200
489763         SUBTRACT +1 FROM ASC-BLK-SUB                             48976300
489764         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                48976400
489765     END-IF.                                                      48976500
489766                                                                  48976633
489767******************************************************************48976700
489768** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **48976800
489769** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **48976900
489770** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**48977000
489771** THE ENDING.                                                  **48977100
489772******************************************************************48977200
489773 3310-EDIT-RANGE.                                                 48977300
489774     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                48977400
489775         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   48977500
489776             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)48977600
489777                                   TO ASC-SELECTED-SW             48977700
489778                                        (ASC-BLK-SUB ASC-ITEM-SUB)48977800
489779             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 48977900
489780         ELSE                                                     48978000
489781             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     48978100
489782                 CONTINUE                                         48978200
489783             ELSE                                                 48978300
489784*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        48978400
489785                 MOVE PC-TSYMSG-00054 TO DP020-MSG-NUMBER         48978500
489786                 SET DP020-MSG-FATAL TO TRUE                      48978600
489787                 MOVE -1           TO MR-SELECTL (PV-SUB)         48978700
489788                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              48978800
489789                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         48978900
489790                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      48979000
489791                 SET PS-ERROR      TO TRUE                        48979100
489792             END-IF                                               48979200
489793         END-IF                                                   48979300
489794     ELSE                                                         48979400
489795         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     48979500
489796             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 48979600
489797                                   TO ASC-SELECTED-SW             48979700
489798                                     (ASC-BLK-SUB ASC-ITEM-SUB)   48979800
489799             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   48979900
489800         ELSE                                                     48980000
489801             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       48980100
489802                 CONTINUE                                         48980200
489803             ELSE                                                 48980300
489804*                -- ONLY ONE END-OF-RANGE ALLOWED --              48980400
489805                 MOVE PC-TSYMSG-00055 TO DP020-MSG-NUMBER         48980500
489806                 SET DP020-MSG-FATAL TO TRUE                      48980600
489807                 MOVE -1           TO MR-SELECTL (PV-SUB)         48980700
489808                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              48980800
489809                 SET PS-ERROR      TO TRUE                        48980900
489810             END-IF                                               48981000
489811         END-IF                                                   48981100
489812     END-IF.                                                      48981200
489813                                                                  48981300
489814******************************************************************48981400
489815** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **48981500
489816** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **48981600
489817******************************************************************48981700
489818 3400-CHECK-RANGE-SEQUENCE.                                       48981800
489819     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       48981900
489820       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      48982000
489821       AND  ASC-START-OF-SELECTED-RANGE >                         48982100
489822                                       ASC-END-OF-SELECTED-RANGE  48982200
489823*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                48982300
489824         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 48982400
489825         SET DP020-MSG-FATAL TO TRUE                              48982500
489826         SET PS-ERROR TO TRUE                                     48982600
489827         PERFORM 3410-POSITION-AT-ERROR                           48982700
489828     END-IF.                                                      48982800
489829                                                                  48982900
489830******************************************************************48983000
489831** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **48983100
489832** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **48983200
489833** SHOULD BE POSITIONED ON A RANGE ERROR.                       **48983300
489834******************************************************************48983400
489835 3410-POSITION-AT-ERROR.                                          48983500
489836     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       48983600
489837     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 48983700
489838                    - PV-TOP-ITEM + 1.                            48983800
489839     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      48983900
489840         CONTINUE                                                 48984000
489841     ELSE                                                         48984100
489842         MOVE -1                   TO MR-SELECTL (PV-SUB)         48984200
489843         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         48984300
489844         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         48984400
489845     END-IF.                                                      48984500
489846                                                                  48984600
489847     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   48984700
489848                    - PV-TOP-ITEM + 1.                            48984800
489849     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      48984900
489850         CONTINUE                                                 48985000
489851     ELSE                                                         48985100
489852         MOVE -1                   TO MR-SELECTL (PV-SUB)         48985200
489853         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         48985300
489854         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         48985400
489855     END-IF.                                                      48985500
489856                                                                  48985600
489857*----------------------------------------------------------------*48985700
489858*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *48985800
489859*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *48985900
489860*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *48986000
489861*----------------------------------------------------------------*48986100
489862 3500-MARK-RANGE-AS-SELECTED.                                     48986200
489863     MOVE +1                       TO  ASC-BLK-SUB.               48986300
489864     PERFORM 3510-MARK-SELECTED-INDS                              48986400
489865         VARYING ASC-ITEM-SUB                                     48986500
489866         FROM 1 BY 1                                              48986600
489867         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 48986700
489868                                                                  48986800
489869     ADD +1                        TO ASC-BLK-SUB.                48986900
489870     PERFORM 3510-MARK-SELECTED-INDS                              48987000
489871         VARYING ASC-ITEM-SUB                                     48987100
489872         FROM 1 BY 1                                              48987200
489873         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 48987300
489874                                                                  48987400
489875     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO  PV-LIST-ITEM-NUMBER.      48987500
489876     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            48987600
489877         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         48987700
489878               PC-ITEMS-PER-PANEL).                               48987800
489879                                                                  48987900
489880     MOVE ASC-START-OF-SELECTED-RANGE                             48988000
489881                                   TO PV-START-OF-SELECTED-RANGE. 48988100
489882     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            48988200
489883         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  48988300
489884               PC-ITEMS-PER-PANEL).                               48988400
489885                                                                  48988500
489886     MOVE ASC-END-OF-SELECTED-RANGE                               48988600
489887                                   TO  PV-END-OF-SELECTED-RANGE.  48988700
489888     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             48988800
489889         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    48988900
489890               PC-ITEMS-PER-PANEL).                               48989000
489891     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             48989100
489892         PV-FIRST-BLOCK-IN-ARRAY + 1.                             48989200
489893                                                                  48989300
489894     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    48989400
489895        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        48989500
489896         MOVE +1                   TO ASC-BLK-SUB                 48989600
489897         PERFORM 5100-WRITE-TEMP-STORAGE                          48989700
489898         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         48989800
489899             PV-FIRST-BLOCK-IN-ARRAY - 1                          48989900
489900                                                                  48990000
489901         PERFORM                                                  48990100
489902             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      48990200
489903                   PV-PREV-BLOCK-IN-ARRAY                         48990300
489904             MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER      48990400
489905             PERFORM 4410-READ-TEMP-STORAGE                       48990500
489906             PERFORM 3510-MARK-SELECTED-INDS                      48990600
489907                 VARYING ASC-ITEM-SUB                             48990700
489908                 FROM 1 BY 1                                      48990800
489909                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          48990900
489910             PERFORM 5100-WRITE-TEMP-STORAGE                      48991000
489911             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     48991100
489912         END-PERFORM                                              48991200
489913                                                                  48991300
489914         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         48991400
489915             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     48991500
489916         PERFORM                                                  48991600
489917             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       48991700
489918                   PV-LAST-BLOCK-IN-RANGE                         48991800
489919             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       48991900
489920             PERFORM 4410-READ-TEMP-STORAGE                       48992000
489921             PERFORM 3510-MARK-SELECTED-INDS                      48992100
489922                 VARYING ASC-ITEM-SUB                             48992200
489923                 FROM 1 BY 1                                      48992300
489924                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          48992400
489925             PERFORM 5100-WRITE-TEMP-STORAGE                      48992500
489926             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      48992600
489927         END-PERFORM                                              48992700
489928                                                                  48992800
489929         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          48992900
489930         PERFORM 4410-READ-TEMP-STORAGE                           48993000
489931     END-IF.                                                      48993100
489932                                                                  48993200
489933     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 48993300
489934                                      ASC-END-OF-SELECTED-RANGE.  48993400
489935                                                                  48993500
489936*----------------------------------------------------------------*48993600
489937* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *48993700
489938*----------------------------------------------------------------*48993800
489939 3510-MARK-SELECTED-INDS.                                         48993900
489940     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         48994000
489941         ASC-START-OF-SELECTED-RANGE)                             48994100
489942     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         48994200
489943         ASC-START-OF-SELECTED-RANGE)                             48994300
489944         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     48994400
489945             ASC-END-OF-SELECTED-RANGE)                           48994500
489946         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     48994600
489947             ASC-END-OF-SELECTED-RANGE)                           48994700
489948             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          48994800
489949                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   48994900
489950                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   48995000
489951                               TO TRUE                            48995100
489952                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE      48995200
489953                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    48995300
489954             END-IF                                               48995400
489955         END-IF                                                   48995500
489956     END-IF.                                                      48995600
489957                                                                  48995700
489958*----------------------------------------------------------------*48995800
489959*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *48995900
489960*    INITIALIZE ALL COUNTERS AND FLAGS.                          *48996000
489961*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *48996100
489962*    DISPLAY THE PANEL TO USER.                                  *48996200
489963*----------------------------------------------------------------*48996300
489964 4000-BUILD-INITIAL-PANEL.                                        48996400
489965     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             48996500
489966                                ASC-BLOCK-ENTRIES (2).            48996600
489967     MOVE +1                 TO ASC-BLK-SUB.                      48996700
489968     SET ASC-ITEMS-LEFT-ON-DB TO TRUE                             48996800
489969                                                                  48996900
489970     MOVE +0                 TO ASC-ITEM-SUB                      48997000
489971                                ASC-NUMBER-OF-ITEMS-READ          48997100
489972                                ASC-NUMBER-OF-SELECTED-ITEMS      48997200
489973                                ASC-REQUEST-LINE-COUNT            48997333
489974                                ASC-HIGHEST-BLOCK-WRITTEN         48997400
489975                                ASC-START-OF-SELECTED-RANGE       48997500
489976                                ASC-END-OF-SELECTED-RANGE         48997600
489977                                ASC-ITEM-AT-TOP-OF-PANEL.         48997700
489978     PERFORM 4100-PREPARE-CURSOR.                                 48997800
489979     PERFORM 4010-OPEN-CURSOR.                                    48997933
489980     PERFORM 4300-READ-ITEMS-FROM-DB.                             48998033
489981     PERFORM 4020-CLOSE-CURSOR.                                   48998133
489982     MOVE +1                   TO  PV-TOP-ITEM.                   48998233
489983     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          48998333
489984         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    48998433
489985         SET DP020-MSG-FATAL   TO  TRUE                           48998533
489986         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               48998633
489987     ELSE                                                         48998733
489988         SET DP030-SET-CURSOR-TRAILER TO TRUE                     48998899
489989         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     48998933
489990     END-IF.                                                      48999033
489991                                                                  48999133
489992*----------------------------------------------------------------*48999200
489993* OPEN THE RECITM CURSOR                                          48999300
489994*----------------------------------------------------------------*48999400
489995 4010-OPEN-CURSOR.                                                48999500
489996     PERFORM                                                      48999600
489997         WITH TEST AFTER                                          48999700
489998         VARYING PV-RETRY-COUNTER                                 48999800
489999         FROM 1 BY 1                                              48999900
490000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49000000
490001                   OR (SQLCODE = ZERO))                           49000100
490002                                                                  49000200
490003         EXEC SQL                                                 49000300
490004             OPEN RECITM-CURSOR                                   49000433
490005         END-EXEC                                                 49000500
490006                                                                  49000600
490007         EVALUATE TRUE                                            49000700
490008             WHEN SQLCODE = ZERO                                  49000800
490009             WHEN SQLCODE = -904                                  49000900
490010             WHEN SQLCODE = -913                                  49001000
490011                 CONTINUE                                         49001100
490012             WHEN SQLWARN0 NOT = SPACES                           49001200
490013             WHEN SQLCODE < ZERO                                  49001300
490014             WHEN SQLCODE > ZERO                                  49001400
490015                 MOVE '4010-OPEN-CURSOR'                          49001500
490016                                   TO DP013-PARAGRAPH             49001600
490017                 MOVE 'OPEN DETAIL CURSOR'                        49001700
490018                                   TO DP013-MESSAGE-TEXT (1)      49001800
490019                 MOVE SQLCA        TO DP013-SQLCA                 49001900
490020                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    49002000
490021                 MOVE 'XLT00003'   TO DP013-DB2-TABLE-NAME (2)    49002100
490022                 MOVE 'XLT00004'   TO DP013-DB2-TABLE-NAME (3)    49002200
490023                 SET DP013-DB2-ABEND                              49002300
490024                     DP013-XCTL-DISPLAY-RESTART TO TRUE           49002400
490025                 PERFORM DP013-0000-PROCESS-ABEND                 49002500
490026         END-EVALUATE                                             49002600
490027     END-PERFORM.                                                 49002700
490028                                                                  49002800
490029     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49002900
490030         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             49003000
490031         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       49003100
490032                                   TO DP013-MESSAGE-TEXT (1)      49003200
490033         MOVE SQLCA                TO DP013-SQLCA                 49003300
490034         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    49003400
490035         MOVE 'XLT00003'           TO DP013-DB2-TABLE-NAME (2)    49003500
490036         MOVE 'XLT00004'           TO DP013-DB2-TABLE-NAME (3)    49003600
490037         SET DP013-DB2-ABEND                                      49003700
490038             DP013-XCTL-DISPLAY-RESTART TO TRUE                   49003800
490039         PERFORM DP013-0000-PROCESS-ABEND                         49003900
490040     END-IF.                                                      49004000
490041                                                                  49004100
490042*----------------------------------------------------------------*49004200
490043* CLOSE THE RECITM_CURSOR.                                      * 49004300
490044*----------------------------------------------------------------*49004400
490045 4020-CLOSE-CURSOR.                                               49004500
490046     EXEC SQL                                                     49004600
490047         CLOSE RECITM-CURSOR                                      49004700
490048     END-EXEC                                                     49004800
490049                                                                  49004900
490050     EVALUATE TRUE                                                49005000
490051         WHEN SQLCODE = ZERO                                      49005100
490052             CONTINUE                                             49005200
490053         WHEN SQLWARN0 NOT = SPACES                               49005300
490054         WHEN SQLCODE < ZERO                                      49005400
490055         WHEN SQLCODE > ZERO                                      49005500
490056             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          49005600
490057             MOVE 'CLOSE RECITM_CURSOR'                           49005700
490058                               TO DP013-MESSAGE-TEXT (1)          49005800
490059             MOVE SQLCA        TO DP013-SQLCA                     49005900
490060             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        49006000
490061             MOVE 'XLT00003'   TO DP013-DB2-TABLE-NAME (2)        49006100
490062             MOVE 'XLT00004'   TO DP013-DB2-TABLE-NAME (3)        49006200
490063             SET DP013-DB2-ABEND                                  49006300
490064                 DP013-XCTL-DISPLAY-RESTART TO TRUE               49006400
490065             PERFORM DP013-0000-PROCESS-ABEND                     49006500
490066     END-EVALUATE.                                                49006600
490067                                                                  49006700
490068*----------------------------------------------------------------*49006800
490069*    PREPARE THE CURSOR FOR PROCESSING                            49006900
490070*----------------------------------------------------------------*49007000
490080 4100-PREPARE-CURSOR.                                             49008033
490090     MOVE RC012-OPER-UNT-ID TO ASC-OPER-UNT-ID                    49009099
490100                               DK-OPER-UNT-ID.                    49010099
490101     MOVE RC012-FCLTY-ID    TO ASC-FCLTY-ID                       49010199
490102                               DK-FCLTY-ID.                       49010233
490103     MOVE RC012-PO-NBR      TO ASC-PO-NUMBER                      49010399
490104                               DK-PO-NUMBER.                      49010415
490105     MOVE RC012-REC-SEQ-NBR TO ASC-REC-SEQ-NBR-N                  49010599
490106                               DK-REC-SEQ-NBR.                    49010615
490107                                                                  49010700
490108*----------------------------------------------------------------*49010800
490109*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *49010900
490110*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *49011000
490111*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *49011100
490112*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *49011200
490113*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *49011300
490114*                                                                *49011400
490115*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *49011500
490116*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *49011600
490117*    UPON INITIALIZATION.                                        *49011700
490118*----------------------------------------------------------------*49011800
490119 4300-READ-ITEMS-FROM-DB.                                         49011900
490120     PERFORM                                                      49012000
490121         VARYING PV-READ-COUNT                                    49012100
490122         FROM 1 BY 1                                              49012200
490123         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    49012300
490124            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         49012400
490125                                                                  49012500
490126         PERFORM 4310-FETCH                                       49012600
490127                                                                  49012700
490128         IF  ASC-ITEMS-LEFT-ON-DB                                 49012800
490129             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                49012900
490130                 ADD +1            TO ASC-ITEM-SUB                49013000
490131             ELSE                                                 49013100
490132                 ADD +1            TO ASC-BLK-SUB                 49013200
490133                 MOVE +1           TO ASC-ITEM-SUB                49013300
490134                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         49013400
490135                     MOVE +1       TO ASC-BLK-SUB                 49013500
490136                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           49013600
490137                     PERFORM 5100-WRITE-TEMP-STORAGE              49013700
490138                     MOVE ASC-BLOCK-ENTRIES                       49013800
490139                                   (PC-MAX-BLOCKS-IN-ARRAY)       49013900
490140                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 49014000
490141                     ADD +1     TO ASC-BLK-SUB                    49014100
490142                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   49014200
490143                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     49014300
490144                                TO TRUE                           49014400
490145                 END-IF                                           49014500
490146             END-IF                                               49014600
490147             ADD +1                   TO  ASC-NUMBER-OF-ITEMS-READ49014700
490148             MOVE ASC-NUMBER-OF-ITEMS-READ                        49014800
490149                                      TO  ASC-LIST-ITEM-NUMBER    49014900
490150                                      (ASC-BLK-SUB ASC-ITEM-SUB)  49015000
490151             MOVE RECITM-ORD-LNE-NBR  TO  ASC-PO-LINE-NBR         49015100
490152                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49015200
490153*************** THE PV-HOLD- FIELDS BELOW COME FROM XLT00004 --   49015300
490154***************     XLT_VND_STYL                                  49015400
490155             MOVE PV-HOLD-DEPT        TO  ASC-DEPT-NBR            49015500
490156             MOVE PV-HOLD-MAJ-CLASS   TO  ASC-MAJ-CLASS           49015600
490157                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49015700
490158             MOVE PV-HOLD-SUB-CLASS   TO  ASC-SUB-CLASS           49015800
490159                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49015900
490160             MOVE XLT00003-SKU-NBR    TO  ASC-SKU                 49016000
490161                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49016100
490162             MOVE XLT00003-SKU-DESC   TO  ASC-SKU-DESC            49016200
490163                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49016300
490164             PERFORM 4500-GET-UPC-NBR                             49016400
490165             IF PS-UPC-FOUND                                      49016500
490166                 MOVE XLT00006-UPC-NBR    TO  ASC-UPC             49016600
490167                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49016700
490168             ELSE                                                 49016899
490169                 MOVE '** NOT FOUND **'   TO  ASC-UPC             49016900
490170                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49017000
490171             END-IF                                               49017199
490172                                                                  49017233
490173*VL          MOVE RECITM-TKT-FMT-ID      TO DK-TKT-FMT-ID         49017399
490174*VL          PERFORM 3050-SELECT-TICKET-DESC                      49017499
494502*VL          MOVE TKTFMT-TKT-FMT-DESC    TO ASC-TICKET-TYPE       49450200
494503*** GET TICKET TYPE DESC FROM DOMAIN TABLE INSTEAD OF RECITM      49450399
494504***    AND TKTFMT.  PARAG. 3050- IS COMMENTED OUT                 49450400
494505*** THE VALUE ON THE DOMAIN TABLE IS AT THE STYLE LEVEL   (2/12)  49450500
494506             MOVE XLT00004-TKT-TYP-DESC  TO ASC-TICKET-TYPE       49450600
494507                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49450700
494508*** THE FOLLOWING PARAGRAPH WAS ADDED TO GET THE HANG FOLD AT     49450899
494509*** A DEPT/SUBCLASS LEVEL INSTEAD OF BY STYLE LEVEL (WHICH IS     49450999
494510*** WHAT IS IN THE XLT00004-HNG-FOLD-DESC                         49451099
494520***                                                               49452099
494530*** COMMENTED OUT PARAGRAPH 4305-SELECT-BY-SUBCLASS CALL.  THE    49453099
494540*** HANG/FOLD INDICATOR CAN NOW BE RETRIEVED AT A STYLE LEVEL,    49454099
494550*** WHICH IS IN XLT00004-HNG-FOLD-DESC. -- DAN H (6/15/05)        49455099
494551***          PERFORM 4305-SELECT-BY-SUBCLASS                      49455199
494552             MOVE XLT00004-HNG-FOLD-DESC TO PV-HANG-FOLD          49455200
494553             MOVE PV-HANG-FOLD           TO ASC-HANG-FOLD         49455300
494554                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49455400
494555         END-IF                                                   49455533
495600     END-PERFORM.                                                 49560000
495700                                                                  49570000
495800     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          49580000
495900         MOVE +1               TO ASC-BLK-SUB                     49590000
496000         PERFORM 5100-WRITE-TEMP-STORAGE                          49600000
496100         ADD +1                TO ASC-BLK-SUB                     49610000
496200         PERFORM 5100-WRITE-TEMP-STORAGE                          49620000
496300                                                                  49630000
496400         MOVE 1                TO ASC-BLK-SUB                     49640000
496500                                  PV-BLOCK-NUMBER                 49650000
496600         PERFORM 4410-READ-TEMP-STORAGE                           49660000
496700         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             49670000
496800             MOVE 2            TO ASC-BLK-SUB                     49680000
496900                                  PV-BLOCK-NUMBER                 49690000
497000             PERFORM 4410-READ-TEMP-STORAGE                       49700000
497100         END-IF                                                   49710000
497200     END-IF.                                                      49720000
497300                                                                  49730000
497301*---THIS PARAGRAPH COMMENTED OUT ON 6/15/05   DAN H     ---------*49730199
497302*---THIS INFORMATION IS NOW RETRIEVED AT A STYLE LEVEL  ---------*49730233
497303*---FROM THE XLT_VND_STYL TABLE                         ---------*49730333
497304*                                                                 49730433
497305*4305-SELECT-BY-SUBCLASS.                                         49730533
497306*                                                                 49730633
497307*    MOVE ASC-SUB-CLASS  (ASC-BLK-SUB ASC-ITEM-SUB)               49730700
497308*                                    TO PV-SUB-CLASS.             49730833
497309*    MOVE PV-SUBCLASS-NBR            TO DK-SUBCLASS-NBR.          49730933
497310*                                                                 49731033
497311*    MOVE ASC-DEPT-NBR               TO DK-DEPT-NBR.              49731133
497312*                                                                 49731233
497313*    EXEC SQL                                                     49731333
497314*       SELECT                                                    49731433
497315*            HVL.CHARTC_SEQ_NBR                                   49731533
497316*       INTO                                                      49731633
497317*          :VSCHVL-CHARTC-SEQ-NBR                                 49731733
497318*       FROM                                                      49731833
497319*            TMDSEAR EAR                                          49731933
497320*         ,  TDCVSVL SVL                                          49732033
497321*         ,  TVSCHVL HVL                                          49732133
497322*        WHERE                                                    49732233
497323*            EAR.MDSEAR_DKEY  = SVL.MDSEAR_ID                     49732333
497324*        AND SVL.CHARTC_CDE   = HVL.CHARTC_CDE                    49732433
497325*        AND SVL.CHARTC_SEQ_NBR = HVL.CHARTC_SEQ_NBR              49732533
497326*                                                                 49732633
497327*        AND EAR.OPERCO_NBR   = '03'                              49732733
497328*        AND EAR.MDSELV_CDE   = 'SCL'                             49732833
497329*        AND EAR.DEPT_NBR     = :DK-DEPT-NBR                      49732933
497330*        AND EAR.SUB_CL_NBR   = :DK-SUBCLASS-NBR                  49733033
497331*                                                                 49733133
497332*        AND SVL.CHARTC_CDE   = 10                                49733233
497333*        AND SVL.PRIM_IND     = 'Y'                               49733333
497334*                                                                 49733433
497335*        AND HVL.STAT_CDE     = 'A'                               49733533
497336*    END-EXEC.                                                    49733633
497337*                                                                 49733733
497338*    EVALUATE TRUE                                                49733833
497339*        WHEN SQLCODE = ZERO                                      49733933
497340*        WHEN SQLCODE = -811                                      49734033
497341*           EVALUATE VSCHVL-CHARTC-SEQ-NBR                        49734133
497342*              WHEN 1      MOVE 'HANG' TO PV-HANG-FOLD            49734233
497343*              WHEN 2      MOVE 'FOLD' TO PV-HANG-FOLD            49734333
497344*              WHEN 3      MOVE 'MIXED' TO PV-HANG-FOLD           49734433
497345*           END-EVALUATE                                          49734533
497346*        WHEN SQLCODE = +100                                      49734633
497347*            MOVE SPACES TO PV-HANG-FOLD                          49734733
497348*        WHEN SQLCODE = -904                                      49734833
497349*        WHEN SQLCODE = -913                                      49734933
497350*        WHEN SQLCODE = -911                                      49735033
497351*             MOVE '4305-SELECT-BY-SUBCLASS'                      49735133
497352*                               TO DP013-PARAGRAPH                49735233
497353*             STRING 'DK-DEPT-NBR '       DELIMITED BY SIZE       49735333
497354*                    DK-DEPT-NBR          DELIMITED BY SIZE       49735433
497355*                               INTO DP013-MESSAGE-TEXT (1)       49735533
497356*             STRING 'DK-SUBCLASS-NBR '   DELIMITED BY SIZE       49735633
497357*                    DK-SUBCLASS-NBR      DELIMITED BY SIZE       49735733
497358*                               INTO DP013-MESSAGE-TEXT (2)       49735833
497359*             MOVE 'TMDSEAR '   TO DP013-DB2-TABLE-NAME (1)       49735900
497360*             MOVE 'TDCVSVL '   TO DP013-DB2-TABLE-NAME (2)       49736000
497370*             MOVE 'TVSCHVL '   TO DP013-DB2-TABLE-NAME (3)       49737000
500800*             MOVE SQLCA        TO DP013-SQLCA                    50080000
500900*             SET DP013-DB2-ABEND TO TRUE                         50090000
501100*             PERFORM DP013-0000-PROCESS-ABEND                    50110000
501101*        WHEN SQLWARN0 NOT = SPACES                               50110199
501102*        WHEN SQLCODE NOT EQUAL ZERO                              50110233
501103*             MOVE '4305-SELECT-BY-SUBCLASS'                      50110333
501104*                               TO DP013-PARAGRAPH                50110433
501105*             STRING 'DK-DEPT-NBR '       DELIMITED BY SIZE       50110533
501106*                    DK-DEPT-NBR          DELIMITED BY SIZE       50110633
501107*                               INTO DP013-MESSAGE-TEXT (1)       50110733
501108*             STRING 'DK-SUBCLASS-NBR '   DELIMITED BY SIZE       50110833
501109*                    DK-SUBCLASS-NBR      DELIMITED BY SIZE       50110933
501110*                               INTO DP013-MESSAGE-TEXT (2)       50111033
501111*             MOVE 'TMDSEAR '   TO DP013-DB2-TABLE-NAME (1)       50111100
501112*             MOVE 'TDCVSVL '   TO DP013-DB2-TABLE-NAME (2)       50111200
501113*             MOVE 'TVSCHVL '   TO DP013-DB2-TABLE-NAME (3)       50111300
501114*             MOVE SQLCA        TO DP013-SQLCA                    50111400
501115*             SET DP013-DB2-ABEND TO TRUE                         50111500
501116*             PERFORM DP013-0000-PROCESS-ABEND                    50111600
501117*    END-EVALUATE.                                                50111733
501118*                                                                 50111833
501119*----------------------------------------------------------------*50111900
501120*    FETCH RECITM CURSOR.                                        *50112000
501121*----------------------------------------------------------------*50112100
501122 4310-FETCH.                                                      50112200
501123     EXEC SQL                                                     50112300
501124          FETCH RECITM-CURSOR                                     50112400
501125          INTO :RECITM-ORD-NBR                                    50112533
501126             , :RECITM-ORD-LNE-NBR                                50112633
501127             , :RECITM-PRE-TKT-IND                                50112733
501128             , :RECITM-TKT-FMT-ID                                 50112833
501129             , :RECITM-VEND-STYL-NAME                             50112999
501130             , :XLT00003-INTR-UPC-ID                              50113033
501131             , :XLT00003-SKU-NBR                                  50113133
501132             , :XLT00003-SKU-DESC                                 50113233
501133             , :PV-HOLD-DEPT                                      50113333
501134             , :PV-HOLD-MAJ-CLASS                                 50113433
501135             , :PV-HOLD-SUB-CLASS                                 50113533
501136             , :XLT00004-ENT-ID                                   50113633
501137             , :XLT00004-VS-ID                                    50113733
501138             , :XLT00004-TKT-TYP-DESC                             50113833
501139             , :XLT00004-HNG-FOLD-DESC                            50113933
501140             , :XLT00006-UPC-NBR                                  50114033
501141     END-EXEC                                                     50114100
501142                                                                  50114200
501143     EVALUATE TRUE                                                50114300
501144         WHEN SQLCODE = ZERO                                      50114400
501145             CONTINUE                                             50114500
501146         WHEN SQLCODE = +100                                      50114600
501500             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  50150000
501501         WHEN SQLWARN0 NOT = SPACE                                50150199
501502         WHEN SQLCODE NOT = ZERO                                  50150200
501503              MOVE '4310-FETCH' TO DP013-PARAGRAPH                50150300
501504              MOVE 'FETCH RECITM, XLT_SKU, XLT_VND_STYL'          50150400
501505                                TO DP013-MESSAGE-TEXT (1)         50150500
501506              MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)       50150600
501507              MOVE 'XLT00003'   TO DP013-DB2-TABLE-NAME (2)       50150700
501508              MOVE 'XLT00004'   TO DP013-DB2-TABLE-NAME (3)       50150800
501509              MOVE SQLCA        TO DP013-SQLCA                    50150900
501510              SET DP013-DB2-ABEND TO TRUE                         50151000
501511              PERFORM DP013-0000-PROCESS-ABEND                    50151100
501512     END-EVALUATE.                                                50151200
501513                                                                  50151300
522800*----------------------------------------------------------------*52280000
522900* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *52290000
523000*----------------------------------------------------------------*52300000
523200 4400-MOVE-COMMAREA-TO-SCREEN.                                    52320000
523300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             52330000
523400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          52340000
523500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          52350000
523600             MOVE +1    TO ASC-BLK-SUB                            52360000
523700             PERFORM 5100-WRITE-TEMP-STORAGE                      52370000
523800             ADD +1     TO ASC-BLK-SUB                            52380000
523900             PERFORM 5100-WRITE-TEMP-STORAGE                      52390000
524000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             52400000
524100                 GIVING PV-BLOCK-NUMBER                           52410000
524200                 REMAINDER PV-REMAINDER                           52420000
524300             IF  PV-REMAINDER > ZERO                              52430000
524400                 ADD +1 TO PV-BLOCK-NUMBER                        52440000
524500             END-IF                                               52450000
524600             MOVE +1    TO ASC-BLK-SUB                            52460000
524700             PERFORM 4410-READ-TEMP-STORAGE                       52470000
524800             ADD +1     TO ASC-BLK-SUB                            52480000
524900                           PV-BLOCK-NUMBER                        52490000
525000             PERFORM 4410-READ-TEMP-STORAGE                       52500000
525100     END-IF.                                                      52510000
525200     MOVE +1            TO ASC-BLK-SUB.                           52520000
525300     COMPUTE ASC-ITEM-SUB =                                       52530000
525400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              52540000
525500         + PC-ITEMS-PER-PANEL).                                   52550000
525600                                                                  52560000
525700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        52570000
525800         ADD +1         TO ASC-BLK-SUB                            52580000
525900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            52590000
526000     END-IF.                                                      52600000
526100                                                                  52610000
526200     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           52620000
526300         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                52630000
526400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        52640000
526500     PERFORM 4420-FORMAT-LIST-LINES                               52650000
526600         VARYING PV-SUB                                           52660000
526700         FROM PC-ITEMS-PER-PANEL BY -1                            52670000
526800         UNTIL PV-SUB < +1.                                       52680000
526900     SET PS-NO-RESET-LINES         TO TRUE.                       52690033
527000                                                                  52700000
527100     COMPUTE ASC-ITEMS-DISPLAYED =                                52710000
527200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          52720000
527300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    52730000
527400                                      ASTRTITO.                   52740000
527500     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    52750000
527600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    52760000
527900     MOVE ASC-PO-NUMBER            TO APONBRO.                    52790000
528000     MOVE ASC-REC-SEQ-NBR          TO ARECSEQO.                   52800099
528100     MOVE ASC-DEPT-NBR             TO ADEPTO.                     52810099
528600                                                                  52860000
530900     IF  DP020-MSG-NUMBER-X = SPACE                               53090000
531400          IF  ASC-ITEM-AT-BOT-OF-PANEL                            53140033
531500              < ASC-NUMBER-OF-ITEMS-READ                          53150033
531600*                --- MORE ITEMS TO DISPLAY ----                   53160000
531700              MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER           53170033
531800              SET DP020-MSG-INFORMATIONAL TO TRUE                 53180033
531900          END-IF                                                  53190033
532100     END-IF.                                                      53210000
532500                                                                  53250000
532501*----------------------------------------------------------------*53250199
532502*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *53250200
532503*----------------------------------------------------------------*53250300
532600 4410-READ-TEMP-STORAGE.                                          53260000
532800     EXEC CICS                                                    53280000
532900         READQ TS                                                 53290000
533000             QUEUE (ASC-LIST-QUEUE-NAME)                          53300000
533100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               53310000
533200             ITEM  (PV-BLOCK-NUMBER)                              53320000
533300             RESP  (PV-CICS-RESP)                                 53330000
533400     END-EXEC.                                                    53340000
533500                                                                  53350000
533600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       53360000
533700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     53370000
533800         CONTINUE                                                 53380000
533900     ELSE                                                         53390000
534000         SET DP013-CICS-ABEND     TO TRUE                         53400000
534100         SET DP013-NO-ROLLBACK    TO TRUE                         53410000
534200         MOVE '4410-READ-TEMP-STORAGE'                            53420000
534300                                  TO DP013-PARAGRAPH              53430000
534400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      53440000
534500                                  TO DP013-MESSAGE-TEXT(1)        53450000
534600         PERFORM DP013-0000-PROCESS-ABEND                         53460000
534700     END-IF.                                                      53470000
534800                                                                  53480000
534900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             53490000
535000                                                                  53500000
535100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         53510000
535200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               53520000
535300     END-IF.                                                      53530000
535400                                                                  53540000
535500*----------------------------------------------------------------*53550000
535600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *53560000
535700*----------------------------------------------------------------*53570000
535900 4420-FORMAT-LIST-LINES.                                          53590000
536100     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      53610000
536200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                53620000
536800         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           53680000
536900                                    MR-TICKET-TYPEH (PV-SUB)      53690000
537300         MOVE SPACE              TO MR-SELECTI (PV-SUB)           53730000
537500                                    MR-PO-LINE-NBR (PV-SUB)       53750000
537501                                    MR-MAJ-CLASS (PV-SUB)         53750199
537502                                    MR-SUB-CLASS (PV-SUB)         53750200
537600                                    MR-SKU-NBR (PV-SUB)           53760000
537700                                    MR-SKU-DESC (PV-SUB)          53770000
537800                                    MR-UPC (PV-SUB)               53780099
537900                                    MR-TICKET-TYPE (PV-SUB)       53790000
538000                                    MR-HANG-FOLD (PV-SUB)         53800099
538300     ELSE                                                         53830000
538400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      53840000
538500                                                   > SPACE        53850000
538600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 53860000
538700                                 TO MR-SELECTI (PV-SUB)           53870000
538800         ELSE                                                     53880000
538900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      53890000
539000                                 TO MR-SELECTI (PV-SUB)           53900000
539100         END-IF                                                   53910000
539200                                                                  53920000
539300         IF  DP030-SET-CURSOR-TRAILER                             53930000
539400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)53940000
539500                 > SPACE)                                         53950000
539600               OR (PV-SUB = 1))                                   53960000
539700                SET DP030-SET-CURSOR-TRAILER TO TRUE              53970000
539900             END-IF                                               53990000
540000         END-IF                                                   54000000
540100                                                                  54010000
540200         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           54020000
540300         OR  PS-RESET-LINES                                       54030000
540400             MOVE ASC-PO-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)      54040000
540500                            TO PV-PO-LINE-NBR                     54050000
540600             MOVE PV-PO-LINE-NBR                                  54060000
540700                            TO MR-PO-LINE-NBR (PV-SUB)            54070000
541300             MOVE ASC-MAJ-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)        54130000
541400                            TO MR-MAJ-CLASS (PV-SUB)              54140000
541500             MOVE ASC-SUB-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)        54150000
541600                            TO MR-SUB-CLASS (PV-SUB)              54160000
541800             MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)              54180000
541810                            TO MR-SKU-NBR (PV-SUB)                54181099
541900             MOVE ASC-SKU-DESC (ASC-BLK-SUB ASC-ITEM-SUB)         54190000
542000                            TO MR-SKU-DESC (PV-SUB)               54200000
542001             MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)              54200199
542002                            TO MR-UPC (PV-SUB)                    54200200
542300             MOVE ASC-TICKET-TYPE (ASC-BLK-SUB ASC-ITEM-SUB)      54230000
542400                            TO MR-TICKET-TYPE (PV-SUB)            54240000
542500             MOVE ASC-HANG-FOLD (ASC-BLK-SUB ASC-ITEM-SUB)        54250099
542600                            TO MR-HANG-FOLD (PV-SUB)              54260099
543500         END-IF                                                   54350000
543600     END-IF.                                                      54360000
543700     SUBTRACT +1 FROM ASC-ITEM-SUB                                54370000
543800     IF  ASC-ITEM-SUB < + 1                                       54380000
543900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  54390000
544000         MOVE +1                 TO ASC-BLK-SUB                   54400000
544100     END-IF.                                                      54410000
544110                                                                  54411099
544200******************************************************************54420000
544300** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **54430000
544400** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **54440000
544500** ISSUE A WARNING.                                             **54450000
544600******************************************************************54460000
544700 4430-CHECK-FOR-BEGIN-AND-END.                                    54470000
544800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       54480000
544900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     54490000
545000*            -- NO END-OF-RANGE SPECFIED ---                      54500000
545100             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            54510000
545200             SET DP020-MSG-WARNING TO TRUE                        54520000
545300             PERFORM 4431-POSITION-AT-WARNING                     54530000
545400         END-IF                                                   54540000
545500     ELSE                                                         54550000
545600         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     54560000
545700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                54570000
545800             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            54580000
545900             SET DP020-MSG-WARNING TO TRUE                        54590000
546000             PERFORM 4431-POSITION-AT-WARNING                     54600000
546100         END-IF                                                   54610000
546200     END-IF.                                                      54620000
546210                                                                  54621099
546300******************************************************************54630000
546400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **54640000
546500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **54650000
546600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **54660000
546700** POSITION THE CURSOR THERE.                                   **54670000
546800******************************************************************54680000
546900 4431-POSITION-AT-WARNING.                                        54690000
547000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 54700000
547100                    - PV-TOP-ITEM + 1.                            54710000
547200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      54720000
547300         CONTINUE                                                 54730000
547400     ELSE                                                         54740000
547500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      54750000
547800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         54780000
547900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         54790000
548000     END-IF.                                                      54800000
548100                                                                  54810000
548200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   54820000
548300                    - PV-TOP-ITEM + 1.                            54830000
548400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      54840000
548500         CONTINUE                                                 54850000
548600     ELSE                                                         54860000
548700         SET DP030-SET-CURSOR-TRAILER TO TRUE                     54870099
549000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         54900000
549100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         54910000
549200     END-IF.                                                      54920000
549300                                                                  54930000
549400******************************************************************54940099
549500*  GET UPC -- FROM XLT_UPC DOMAIN TABLE                           54950099
549600*          -- IF NO VENDOR UPC WITH EDI INDICATOR OF 'Y'          54960099
549700*              OR MORE THAN 1 VENDOR UPC IS FOUND                 54970099
549800*             THEN GET THE INTERNAL UPC NBR  (4510-)              54980099
549900*             IF NO INTERNAL UPC IS FOUND, WE WILL DISPLAY THE    54990099
550000*             MESSAGE "NOT FOUND" ON THE SCREEN.                  55000099
550100******************************************************************55010099
550200 4500-GET-UPC-NBR.                                                55020099
550300     EXEC SQL                                                     55030099
550400          SELECT UPC_NBR                                          55040099
550500            INTO :XLT00006-UPC-NBR                                55050099
550600            FROM XLT_UPC UPC                                      55060099
550700           WHERE UPC.INTR_UPC_ID      = :XLT00003-INTR-UPC-ID     55070099
550800             AND UPC.UPC_TYP_CDE      = 'V'                       55080099
550900             AND UPC.EDI_ORD_IND      = 'Y'                       55090099
551000     END-EXEC.                                                    55100099
551100                                                                  55110099
551200     EVALUATE TRUE                                                55120099
551300         WHEN SQLCODE = ZERO                                      55130099
551400             CONTINUE                                             55140099
551500         WHEN SQLCODE = +100                                      55150099
551600         WHEN SQLCODE = -811                                      55160099
551700             PERFORM 4510-GET-INTERNAL-UPC                        55170099
551800         WHEN SQLWARN0 NOT = SPACES                               55180099
551900         WHEN SQLCODE  NOT = ZERO                                 55190099
552000              MOVE '4500-GET-UPC-NBR'    TO DP013-PARAGRAPH       55200099
552100              MOVE XLT00003-INTR-UPC-ID TO PV-INTR-UPC-ID         55210099
552200              MOVE 'ERROR FETCHING UPC NBR'                       55220099
552300                                       TO DP013-MESSAGE-TEXT (1)  55230099
552400              STRING 'INTR UPC ID: '   DELIMITED BY SIZE          55240099
552500                     PV-INTR-UPC-ID    DELIMITED BY SIZE          55250099
552600                                     INTO DP013-MESSAGE-TEXT (2)  55260099
552700              MOVE SQLCA               TO DP013-SQLCA             55270099
552800              MOVE 'XLT_UPC'           TO DP013-DB2-TABLE-NAME (1)55280099
552900              SET DP013-DB2-ABEND                                 55290099
553000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              55300099
553100              PERFORM DP013-0000-PROCESS-ABEND                    55310099
553200     END-EVALUATE.                                                55320099
553300                                                                  55330099
553400******************************************************************55340099
553500*  GET UPC -- LOOK FOR INTERNAL UPC BECAUSE EITHER NO VENDOR UPC *55350099
553600*     WAS FOUND OR THERE WERE MULTIPLE VENDOR UPC'S              *55360099
553700*  IF SQL RETURNS WITH A +100 - NO INTERNAL UPC, THEN DISPLAY    *55370099
553800*     "NOT FOUND"                                                *55380099
553900*  WE ARE USING 'FETCH FIRST ROW ONLY' TO FORCE DB2 TO BRING     *55390099
554000*  BACK ONLY ONE ROW FROM THE QUERY.  THIS METHOD IS MUCH MORE   *55400099
554100*  EFFICIENT THAN CHECKING FOR A -811.  THIS METHOD IS NEW IN    *55410099
554200*  DB2V7.                                                        *55420099
554300******************************************************************55430099
554400 4510-GET-INTERNAL-UPC.                                           55440099
554500     SET PS-UPC-FOUND TO TRUE                                     55450099
554600     EXEC SQL                                                     55460099
554700          SELECT UPC_NBR                                          55470099
554800            INTO :XLT00006-UPC-NBR                                55480099
554900            FROM XLT_UPC UPC                                      55490099
555000           WHERE UPC.INTR_UPC_ID      = :XLT00003-INTR-UPC-ID     55500099
555100             AND UPC.UPC_TYP_CDE      = 'I'                       55510099
555200           FETCH FIRST ROW ONLY                                   55520099
555300     END-EXEC.                                                    55530099
555400                                                                  55540099
555500     EVALUATE TRUE                                                55550099
555600         WHEN SQLCODE = ZERO                                      55560099
555700             SET PS-UPC-FOUND TO TRUE                             55570099
555800         WHEN SQLCODE = +100                                      55580099
555900             SET PS-NO-UPC-FOUND TO TRUE                          55590099
556000         WHEN SQLWARN0 NOT = SPACES                               55600099
556100         WHEN SQLCODE  NOT = ZERO                                 55610099
556200              MOVE '4510-GET-INTERNAL-UPC' TO DP013-PARAGRAPH     55620099
556300              MOVE XLT00003-INTR-UPC-ID TO PV-INTR-UPC-ID         55630099
556400              MOVE 'ERROR FETCHING INTERNAL UPC NBR'              55640099
556500                                       TO DP013-MESSAGE-TEXT (1)  55650099
556600              STRING 'INTR UPC ID: '   DELIMITED BY SIZE          55660099
556700                     PV-INTR-UPC-ID    DELIMITED BY SIZE          55670099
556800                                     INTO DP013-MESSAGE-TEXT (2)  55680099
556900              MOVE SQLCA               TO DP013-SQLCA             55690099
557000              MOVE 'XLT_UPC'           TO DP013-DB2-TABLE-NAME (1)55700099
557100              SET DP013-DB2-ABEND                                 55710099
557200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              55720099
557300              PERFORM DP013-0000-PROCESS-ABEND                    55730099
557400     END-EVALUATE.                                                55740099
557401                                                                  55740199
557402*----------------------------------------------------------------*55740200
557403*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *55740300
557404*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *55740400
557405*----------------------------------------------------------------*55740500
557406 5100-WRITE-TEMP-STORAGE.                                         55740600
557407     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     55740700
557408                                   TO PV-LIST-ITEM-NUMBER.        55740800
557409     COMPUTE PV-BLOCK-NUMBER =                                    55740900
557410         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    55741000
557411                                                                  55741100
557412     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             55741200
557413     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             55741300
557414         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      55741400
557415             PERFORM 5105-REWRITE-ASC-LISTQ                       55741500
557416         END-IF                                                   55741600
557417     ELSE                                                         55741700
557418         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       55741800
557419         ASC-HIGHEST-BLOCK-WRITTEN + 1                            55741900
557420         PERFORM 5110-WRITE-ASC-LISTQ                             55742000
557421         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   55742100
557422     END-IF.                                                      55742200
557423                                                                  55742300
557424     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             55742400
557425                                                                  55742500
557426******************************************************************55742600
557427** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **55742700
557428** SPECIFIC COMMAREA.                                           **55742800
557429******************************************************************55742900
557430 5105-REWRITE-ASC-LISTQ.                                          55743000
557431     EXEC CICS                                                    55743100
557432         WRITEQ TS                                                55743200
557433             QUEUE (ASC-LIST-QUEUE-NAME)                          55743300
557434             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               55743400
557435             ITEM  (PV-BLOCK-NUMBER)                              55743500
557436             REWRITE                                              55743600
557437             RESP  (PV-CICS-RESP)                                 55743700
557438     END-EXEC.                                                    55743800
557439                                                                  55743900
557440     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           55744000
557441         CONTINUE                                                 55744100
557442     ELSE                                                         55744200
557443         SET DP013-CICS-ABEND            TO TRUE                  55744300
557444         SET DP013-NO-ROLLBACK           TO TRUE                  55744400
557445         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       55744500
557500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     55750000
557600                                         TO DP013-MESSAGE-TEXT(1) 55760000
557700         PERFORM DP013-0000-PROCESS-ABEND                         55770000
557800     END-IF.                                                      55780000
557900                                                                  55790000
558000******************************************************************55800000
558100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **55810000
558200** SPECIFIC COMMAREA.                                           **55820000
558300******************************************************************55830000
558400 5110-WRITE-ASC-LISTQ.                                            55840000
558500     EXEC CICS                                                    55850000
558600         WRITEQ TS                                                55860000
558700             QUEUE (ASC-LIST-QUEUE-NAME)                          55870000
558800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               55880000
558900             ITEM  (PV-BLOCK-NUMBER)                              55890000
559000             RESP  (PV-CICS-RESP)                                 55900000
559100     END-EXEC.                                                    55910000
559200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      55920000
559300         SET DP013-CICS-ABEND      TO TRUE                        55930000
559400         SET DP013-NO-ROLLBACK     TO TRUE                        55940000
559500         MOVE '5110-WRITE-ASC-LISTQ' TO DP013-PARAGRAPH           55950000
559700         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE QUEUE'            55970000
559800                                   TO DP013-MESSAGE-TEXT(1)       55980000
559900         PERFORM DP013-0000-PROCESS-ABEND                         55990000
560000     END-IF.                                                      56000000
560100                                                                  56010000
560200*----------------------------------------------------------------*56020000
560300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *56030000
560400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *56040000
560500*----------------------------------------------------------------*56050000
560700 5200-FILL-SEL-QUEUE-RECORD.                                      56070000
560900     PERFORM 6112-READ-LIST-QUEUE.                                56090000
561100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       56110000
561300         PERFORM VARYING LQW-IDX                                  56130000
561400             FROM 1 BY 1                                          56140000
561500             UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL        56150000
561600             OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO        56160000
561900             MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)                  56190000
562000                           TO RC016-ITEM (RC016-IDX)              56200000
562100             MOVE LQW-PO-LNE-NBR (LQW-IDX)                        56210033
562200                           TO RC016-PO-LNE-NBR (RC016-IDX)        56220033
562400             MOVE SPACE    TO RC016-ACTION-SW (RC016-IDX)         56240000
562500             SET RC016-IDX UP BY 1                                56250000
562600             IF RC016-IDX > RC016-MAX-ITEMS                       56260000
562700                 PERFORM 5205-WRITE-SEL-QUEUE                     56270000
562800                 ADD +1         TO RC012-NUMBER-OF-TS-ITEMS       56280000
562900                 INITIALIZE RC016-SELECTED-ITEM-ARRAY             56290000
563000                 SET RC016-IDX TO          1                      56300000
563100             END-IF                                               56310000
563300         END-PERFORM                                              56330000
563400     END-IF.                                                      56340000
563500                                                                  56350000
563600*----------------------------------------------------------------*56360000
563700*    WRITE A RECORD TO THE SELECTION QUEUE THAT IS BEING PASSED  *56370000
563800*    FROM THIS PROGRAM.                                          *56380000
563900*----------------------------------------------------------------*56390000
564100 5205-WRITE-SEL-QUEUE.                                            56410000
564400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC016-SELECTED-ITEMS.   56440000
564600                                                                  56460000
564700     EXEC CICS                                                    56470000
564800          WRITEQ TS                                               56480000
564900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      56490000
565000              FROM  (RC016-DC-SELECT-RECORD)                      56500033
565100              ITEM  (PV-SEL-QUEUE-ITEM)                           56510000
565200              RESP  (PV-CICS-RESP)                                56520000
565300     END-EXEC.                                                    56530000
565400                                                                  56540000
565500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          56550000
565600         CONTINUE                                                 56560000
565700     ELSE                                                         56570000
565800         SET DP013-CICS-ABEND      TO TRUE                        56580000
565900         SET DP013-NO-ROLLBACK     TO TRUE                        56590000
566000         MOVE '5205-WRITE-SEL-QUEUE-OUT' TO DP013-PARAGRAPH       56600000
566200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          56620000
566300                                   TO DP013-MESSAGE-TEXT(1)       56630000
566400         PERFORM DP013-0000-PROCESS-ABEND                         56640000
566500     END-IF.                                                      56650000
566600                                                                  56660099
572230*----------------------------------------------------------------*57223000
572240*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*57224000
572300*----------------------------------------------------------------*57230000
572500 6112-READ-LIST-QUEUE.                                            57250000
572700     EXEC CICS                                                    57270000
572800         READQ TS                                                 57280000
572900             QUEUE (ASC-LIST-QUEUE-NAME)                          57290000
573000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     57300000
573100             ITEM  (PV-ITEM)                                      57310000
573200             RESP  (PV-CICS-RESP)                                 57320000
573300     END-EXEC.                                                    57330000
573400                                                                  57340000
573500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57350000
573600         CONTINUE                                                 57360000
573700     ELSE                                                         57370000
573800         SET DP013-CICS-ABEND        TO TRUE                      57380000
573900         SET DP013-NO-ROLLBACK       TO TRUE                      57390000
574000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           57400000
574100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    57410000
574200                                     TO DP013-MESSAGE-TEXT(1)     57420000
574300         PERFORM DP013-0000-PROCESS-ABEND                         57430000
574400     END-IF.                                                      57440000
574500                                                                  57450033
690600*----------------------------------------------------------------*69060000
690700* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *69070000
690800*----------------------------------------------------------------*69080000
691000 9100-READ-SEL-QUEUE-IN.                                          69100000
691100     EXEC CICS                                                    69110000
691200         READQ TS                                                 69120000
691300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        69130000
691400             INTO  (RC016-DC-SELECT-RECORD)                       69140033
691500             ITEM  (ASC-SEL-ITEM)                                 69150000
691600             RESP  (PV-CICS-RESP)                                 69160000
691700     END-EXEC.                                                    69170000
691800                                                                  69180000
691900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       69190000
692000         CONTINUE                                                 69200000
692100     ELSE                                                         69210000
692200         SET DP013-LOGIC-ABEND                                    69220000
692300             DP013-NO-ROLLBACK     TO TRUE                        69230000
692400         MOVE '9100-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           69240000
692600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   69260000
692700                                   TO DP013-MESSAGE-TEXT (1)      69270000
692800         PERFORM DP013-0000-PROCESS-ABEND                         69280000
692900     END-IF.                                                      69290000
692910                                                                  69291099
693000*----------------------------------------------------------------*69300000
693100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *69310000
693200*----------------------------------------------------------------*69320000
693300 9200-REWRITE-SEL-QUEUE.                                          69330000
693400     EXEC CICS                                                    69340000
693500          WRITEQ TS                                               69350000
693600              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      69360000
693700              FROM   (RC016-DC-SELECT-RECORD)                     69370033
693800              ITEM   (ASC-SEL-ITEM)                               69380000
693900              RESP   (PV-CICS-RESP)                               69390000
694000              REWRITE                                             69400000
694100     END-EXEC.                                                    69410000
694200                                                                  69420000
694300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   69430000
694400         SET DP013-CICS-ABEND                                     69440000
694500             DP013-NO-ROLLBACK     TO TRUE                        69450000
694600         MOVE '9200-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         69460000
694800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   69480000
694900                                   TO DP013-MESSAGE-TEXT (1)      69490000
695000         PERFORM DP013-0000-PROCESS-ABEND                         69500000
695100     END-IF.                                                      69510000
695200                                                                  69520000
695400*----------------------------------------------------------------*69540000
695500*    ABEND PROCESSOR MODULE                                      *69550000
695600*----------------------------------------------------------------*69560000
695800     COPY DPPD013.                                                69580000
