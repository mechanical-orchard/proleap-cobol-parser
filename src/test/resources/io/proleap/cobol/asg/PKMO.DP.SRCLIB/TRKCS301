000100*-----------------------*                                         00010030
000200 IDENTIFICATION DIVISION.                                         00020031
000300*-----------------------*                                         00030031
000400 PROGRAM-ID.    TRKCS301.                                         00040031
000500 AUTHOR.        MARGARET MORRISON.                                00050031
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060031
000700 DATE-WRITTEN.  FEBRUARY 1999.                                    00070031
000800 DATE-COMPILED.                                                   00080031
000900                                                                  00090031
001000*---------------------------------------------------------------* 00100031
001100*    Y301 - IMPORTS CONTAINER HISTORY                           * 00110031
001200*                                                               * 00120031
001300*    THIS PROGRAM DISPLAYS THE HISTORY OF A SELECTED CONTAINER. * 00130031
001400*    THE COLUMN THAT WAS CHANGED, DATE & TIME OF CHANGE, AND    * 00140031
001500*    THE CURRENT AND PREVIOUS VALUES OF THE COLUMN ARE          * 00150031
001600*    DISPLAYED.                                                 * 00160031
001700*                                                               * 00170031
001800*---------------------------------------------------------------* 00180031
001801*  11/04/2003 TKMA643 - VISWA KARUTURI                          * 00182065
001802*     REMOVED LOGIC THAT PERTAINS TO COLUMNS FRGT_CHRG_AMT,     * 00183065
001803*     CONSLR_CHRG_AMT FROM TIMCNTK/TAUCNTK TABLES. ADDED LOGIC  * 00184065
001804*     FRO NEW COLUMNS MOM_FOB_CDE, FDR_FOB_CDE, MOM_POR_CDE AND * 00185067
001805*     FDR_POR_CDE ON TIMCNUP/TAUCNUP TABLES.                    * 00186065
001806*---------------------------------------------------------------* 00187065
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00189070
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00189170
263697* MAKING THE CALL DYNAMIC VS STATIC.                              00189270
263697*---------------------------------------------------------------* 00189370
CICS  * CHANGED  1/16/2023    BY JIM HUNTER      WR: CHG0278495         00189471
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00189571
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00189671
CICS  *-----------------------------------------------------------------00189771
001900                                                                  00190031
002000 ENVIRONMENT DIVISION.                                            00200031
002100                                                                  00210031
002200 DATA DIVISION.                                                   00220031
002300                                                                  00230031
002400 WORKING-STORAGE SECTION.                                         00240031
002500                                                                  00250031
002600 01  DK-DB2-KEYS.                                                 00260031
002700     15  DK-CONTNR-NBR                  PIC  X(12)  VALUE SPACES. 00270031
002800     15  DK-CONTNR-SEQ-NBR              PIC  S9(04) COMP          00280031
002900                                             VALUE ZERO.          00290031
003000                                                                  00300031
003100 01  PC-PROGRAM-CONSTANTS.                                        00310031
003200     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00320031
003300                                                    'TR301A  '.   00330031
003400     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00340031
003500                                                    'TRKM301 '.   00350031
003600     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00360031
003700                                                    'TRKCS301'.   00370031
003800     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00380031
003900     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00390031
004000     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00400031
004100     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '3'.    00410031
004200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     00420031
004300                                                    COMP SYNC.    00430031
004400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00440031
004500                                                    COMP SYNC.    00450031
004600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00460031
004700                                                    +1000000      00470031
004800                                                    COMP-3.       00480031
004900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00490031
005000                                                    COMP SYNC.    00500031
005100     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00510031
005200                                                     COMP-3.      00520031
005300     05  PC-INIT-DATE                   PIC X(10)    VALUE        00530031
005400                                                   '0001-01-01'.  00540031
005500     05  PC-INIT-TIME                   PIC X(05)    VALUE        00550031
005600                                                   '00.00'.       00560031
005700     05  PC-SLASH                       PIC X(01)    VALUE '/'.   00570031
005800     05  PC-COLON                       PIC X(01)    VALUE ':'.   00580031
005900                                                                  00590031
006000 01  PC-TSYMSG-NUMBERS.                                           00600031
006100     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00610031
006200     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00620031
006300     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00630031
006400     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00640031
006500     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00650031
006600     05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  00660031
006700     05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  00670031
006800     05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  00680031
006900                                                                  00690031
007000 01  PS-PROGRAM-SUBSCRIPTS.                                       00700031
007100     05  PS-SUB                         PIC S9(04)   VALUE +0     00710031
007200                                                     COMP SYNC.   00720031
007300                                                                  00730031
007400 01  PS-PROGRAM-SWITCHES.                                         00740031
007500     05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   00750031
007600         88  PS-NO-ERROR                             VALUE 'Y'.   00760031
007700         88  PS-ERROR                                VALUE 'N'.   00770031
007800     05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   00780031
007900         88  PS-COMMAREA-VALID                       VALUE 'Y'.   00790031
008000         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00800031
008100     05  PS-END-OF-TIMCSCN-FETCHES-SW   PIC X(01)    VALUE 'N'.   00810043
008200         88  PS-END-OF-TIMCSCN-FETCHES               VALUE 'Y'.   00820043
008300         88  PS-END-OF-TIMCSCN-FETCHES-NO            VALUE 'N'.   00830043
008400     05  PS-END-OF-TAUCSCN-FETCHES-SW   PIC X(01)    VALUE 'N'.   00840043
008500         88  PS-END-OF-TAUCSCN-FETCHES               VALUE 'Y'.   00850043
008600         88  PS-END-OF-TAUCSCN-FETCHES-NO            VALUE 'N'.   00860043
008700                                                                  00870031
008800 01  PV-PROGRAM-VARIABLES.                                        00880031
008900     05  PV-RETRY-COUNTER               PIC S9(04)   VALUE +0     00890031
009000                                                     COMP SYNC.   00900031
009100     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     00910031
009200                                                     COMP SYNC.   00920031
009300     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     00930031
009400                                                     COMP-3.      00940031
009500     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     00950031
009600                                                     COMP-3.      00960031
009700     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     00970031
009800                                                     COMP-3.      00980031
009900     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     00990031
010000                                                     COMP SYNC.   01000031
010100     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     01010031
010200                                                     COMP SYNC.   01020031
010300     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     01030031
010400                                                     COMP SYNC.   01040031
010500     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     01050031
010600                                                     COMP SYNC.   01060031
010700     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01070031
010800                                                                  01080031
010900     05  PV-FORMAT-DATE.                                          01090031
011000         10  PV-FORMAT-MM               PIC XX.                   01100031
011100         10  PV-FORMAT-SLASH1           PIC X        VALUE '/'.   01110031
011200         10  PV-FORMAT-DD               PIC XX.                   01120031
011300         10  PV-FORMAT-SLASH2           PIC X        VALUE '/'.   01130031
011400         10  PV-FORMAT-YY               PIC XX.                   01140031
011500                                                                  01150031
011600     05  PV-FORMAT-TIME.                                          01160031
011700         10  PV-FORMAT-HOUR             PIC XX.                   01170031
011800         10  PV-FORMAT-COLON            PIC X        VALUE ':'.   01180031
011900         10  PV-FORMAT-MIN              PIC XX.                   01190031
012000                                                                  01200031
012100     05  PV-TMST.                                                 01210031
012200         10  PV-TMST-DATE.                                        01220031
012300             15  PV-TMST-MM            PIC XX.                    01230031
012400             15  PV-TMST-SLASH1        PIC X        VALUE '/'.    01240031
012500             15  PV-TMST-DD            PIC XX.                    01250031
012600             15  PV-TMST-SLASH2        PIC X        VALUE '/'.    01260031
012700             15  PV-TMST-CCYY          PIC X(04).                 01270031
012800             15  FILLER                PIC X(03).                 01280031
012900         10  PV-TMST-TIME.                                        01290031
013000             15  PV-TMST-HOUR          PIC XX.                    01300031
013100             15  PV-TMST-COLON         PIC X        VALUE ':'.    01310031
013200             15  PV-TMST-MIN           PIC XX.                    01320031
013300             15  FILLER                PIC X(12)    VALUE SPACES. 01330031
013400                                                                  01340031
013500     05  PV-HOLD-TMST-UNFORMAT          PIC X(26)    VALUE SPACES.01350031
013600                                                                  01360031
013700     05  PV-HOLD-BEFORE-VALUE           PIC X(30)    VALUE SPACES.01370031
013800     05  PV-HOLD-BEFORE-VALUE-V         PIC Z(08)9.99 VALUE ZERO. 01380031
013900     05  PV-HOLD-BEFORE-VALUE-N         PIC Z(08)9    VALUE ZERO. 01390031
014000     05  PV-HOLD-AFTER-VALUE            PIC X(30)    VALUE SPACES.01400031
014100     05  PV-HOLD-AFTER-VALUE-V          PIC Z(08)9.99 VALUE ZERO. 01410031
014200     05  PV-HOLD-AFTER-VALUE-N          PIC Z(08)9    VALUE ZERO. 01420031
014300     05  PV-HOLD-FIELD-NAME             PIC X(20)    VALUE SPACES.01430031
014400                                                                  01440031
014500     05  PV-PREVIOUS-VALUES.                                      01450031
014600         10  PV-PREV-CONSLR-SCAC-ID     PIC X(04)    VALUE SPACES.01460031
014700         10  PV-PREV-MOM-IMPRT-TRIP-ID  PIC X(10)    VALUE SPACES.01470031
014800         10  PV-PREV-MOM-DPRTR-TMST     PIC X(26)    VALUE SPACES.01480031
014900         10  PV-PREV-MOM-POE-DELY-TMST  PIC X(26)    VALUE SPACES.01490031
015000         10  PV-PREV-MOM-CARR-SCAC-ID   PIC X(04)    VALUE SPACES.01500031
015100         10  PV-PREV-MOM-FOB-CDE        PIC X(05)    VALUE SPACES.01510069
015200         10  PV-PREV-MOM-IMPRT-VEH-NM   PIC X(25)    VALUE SPACES.01520031
015300         10  PV-PREV-MOM-TRIP-TYP-CDE   PIC X(01)    VALUE SPACES.01530031
015400         10  PV-PREV-MOM-DEST-POE-CDE   PIC X(04)    VALUE SPACES.01540031
015500         10  PV-PREV-FDR-IMPRT-TRIP-ID  PIC X(10)    VALUE SPACES.01550031
015600         10  PV-PREV-FDR-DPRTR-TMST     PIC X(26)    VALUE SPACES.01560031
015700         10  PV-PREV-FDR-POE-DELY-TMST  PIC X(26)    VALUE SPACES.01570031
015800         10  PV-PREV-FDR-CARR-SCAC-ID   PIC X(04)    VALUE SPACES.01580031
015900         10  PV-PREV-FDR-FOB-CDE        PIC X(05)    VALUE SPACES.01590069
016000         10  PV-PREV-FDR-IMPRT-VEH-NM   PIC X(25)    VALUE SPACES.01600031
016100         10  PV-PREV-FDR-TRIP-TYP-CDE   PIC X(01)    VALUE SPACES.01610031
016200         10  PV-PREV-FDR-DEST-POE-CDE   PIC X(04)    VALUE SPACES.01620031
016300         10  PV-PREV-SIZE-CDE           PIC X(05)    VALUE SPACES.01630031
016400         10  PV-PREV-CART-CNT           PIC S9(09)      VALUE +0  01640031
016500                                                        COMP.     01650031
016600         10  PV-PREV-CBMT-QTY           PIC S9(09)V9(2) VALUE +0  01660031
016700                                                        COMP-3.   01670031
016800         10  PV-PREV-WT-KGRM-QTY        PIC S9(09)      VALUE +0  01680031
016900                                                        COMP.     01690031
017000         10  PV-PREV-UNT-QTY            PIC S9(09)      VALUE +0  01700031
017100                                                        COMP.     01710031
017600         10  PV-PREV-ORGN-SHPD-FR-CDE   PIC X(03)    VALUE SPACES.01760031
017700         10  PV-PREV-ORGN-SHPD-TO-CDE   PIC X(03)    VALUE SPACES.01770031
017800         10  PV-PREV-EST-LBD-NM         PIC X(30)    VALUE SPACES.01780031
017900         10  PV-PREV-EST-LBD-TMST       PIC X(26)    VALUE SPACES.01790031
018000         10  PV-PREV-RISU-DO-RSN-CDE    PIC X(03)    VALUE SPACES.01800031
018100         10  PV-PREV-BKR-FRGT-RLSE-TMST PIC X(26)    VALUE SPACES.01810031
018300         10  PV-PREV-DO-RCVD-TMST       PIC X(26)    VALUE SPACES.01830031
018400         10  PV-PREV-CONTNR-PU-TMST     PIC X(26)    VALUE SPACES.01840031
018500         10  PV-PREV-DAT-SRC-ENT-ID     PIC S9(09)   VALUE +0     01850031
018600                                                     COMP.        01860031
018700         10  PV-PREV-LAST-UPD-BY-USR-ID PIC X(08)    VALUE SPACES.01870031
018800         10  PV-PREV-LAST-UPD-TMST      PIC X(26)    VALUE SPACES.01880031
018900         10  PV-PREV-ACTL-POE-DELY-TMST PIC X(26)    VALUE SPACES.01890031
019000         10  PV-PREV-ACTL-DEST-POE-CDE  PIC X(04)    VALUE SPACES.01900031
019100         10  PV-PREV-ACTL-LBD-NM        PIC X(30)    VALUE SPACES.01910031
019200         10  PV-PREV-ACTL-LBD-TMST      PIC X(26)    VALUE SPACES.01920031
019300         10  PV-PREV-DO-TO-DCONSLR-TMST PIC X(26)    VALUE SPACES.01930033
019310         10  PV-PREV-LAST-UPD-BY-USR-ID-2 PIC X(08)  VALUE SPACES.01931035
019320         10  PV-PREV-LAST-UPD-TMST-2    PIC X(26)    VALUE SPACES.01932035
019321         10  PV-PREV-DVN-TMST           PIC X(26)    VALUE SPACES.01932154
019322         10  PV-PREV-DCONSLR-SCAC-ID    PIC X(04)    VALUE SPACES.01932258
019323         10  PV-PREV-DCONSLR-RET-TMST   PIC X(26)    VALUE SPACES.01932358
019324         10  PV-PREV-MOM-POL-CDE        PIC X(05)    VALUE SPACES.01932469
019325         10  PV-PREV-FDR-POL-CDE        PIC X(05)    VALUE SPACES.01932569
019326         10  PV-PREV-MOM-POR-CDE        PIC X(05)    VALUE SPACES.01932660
019327         10  PV-PREV-FDR-POR-CDE        PIC X(05)    VALUE SPACES.01932767
019330         10  PV-CURRENT-AUDIT-ENTR-ID   PIC X(12)    VALUE SPACES.01933051
019400                                                                  01940031
019500*---------------------------------------------------------------* 01950031
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01960071
019700*---------------------------------------------------------------* 01970031
019800                                                                  01980031
019900     COPY DPWS030.                                                01990031
CICS       COPY DPWS930.                                                01991071
020000 EJECT                                                            02000031
020100*---------------------------------------------------------------* 02010031
020200*    NUMERIC EDIT LAYOUT.                                       * 02020031
020300*---------------------------------------------------------------* 02030031
020400                                                                  02040031
020500     COPY DPWS010I.                                               02050031
020600                                                                  02060031
020700 EJECT                                                            02070031
020800*---------------------------------------------------------------* 02080031
020900*    STANDARD COMMAREA.                                         * 02090031
021000*---------------------------------------------------------------* 02100031
021100                                                                  02110031
021200     COPY DPWS020.                                                02120031
021300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02130031
021400                                                                  02140031
021500*---------------------------------------------------------------* 02150031
021600* INTER-APPLICATION COMMAREA.                                   * 02160031
021700*   TRWS102 - IS THE INPUT LAYOUT WHEN COMING FROM THE CONTAINER* 02170031
021800*             LIST SCREEN OR THE VESSEL DETAIL SCREEN.          * 02180031
021900*---------------------------------------------------------------* 02190031
022000                                                                  02200031
022100         10  INTER-APPL-COMM-AREA       PIC X(200).               02210031
022200     COPY TRWS102.                                                02220031
022300                                                                  02230031
022400*---------------------------------------------------------------* 02240031
022500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02250031
022600*---------------------------------------------------------------* 02260031
022700         10  ASC-SPECIFIC-COMMAREA.                               02270031
022800             15  ASC-LIST-KEYS.                                   02280031
022900                 20  ASC-KEY-CONTNR-NBR              PIC  X(12).  02290031
023000                 20  ASC-KEY-CONTNR-SEQ-NBR          PIC S9(04)   02300031
023100                                                         COMP.    02310031
023200             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02320031
023300                 20  ASC-ITEM-ARRAY.                              02330031
023400                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        02340031
023500                         30  ASC-LIST-ITEM-NUMBER                 02350031
023600                                                     PIC S9(09)   02360031
023700                                                     COMP-3.      02370031
023800                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  02380031
023900                             88  ASC-VALID-SELECT    VALUE ' '    02390031
024000                                                           'S'    02400031
024100                                                           'B'    02410031
024200                                                           'E'.   02420031
024300                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   02430031
024400                             88  ASC-TEMP-SELECT     VALUE 'S'.   02440031
024500                             88  ASC-TEMP-BEGIN      VALUE 'B'.   02450031
024600                             88  ASC-TEMP-END        VALUE 'E'.   02460031
024700                         30  ASC-SELECTED-SW         PIC  X(01).  02470031
024800                             88  ASC-NO-SELECT       VALUE ' '.   02480031
024900                             88  ASC-SELECT          VALUE 'S'.   02490031
025000                             88  ASC-BEGIN           VALUE 'B'.   02500031
025100                             88  ASC-END             VALUE 'E'.   02510031
025200                         30  ASC-DATA                PIC  X(20).  02520031
025300                         30  ASC-USERID              PIC  X(08).  02530031
025400                         30  ASC-DATE                PIC  X(08).  02540031
025500                         30  ASC-TIME                PIC  X(05).  02550031
025600                         30  ASC-VALUE               PIC  X(30).  02560031
025700                                                                  02570031
025800             15  ASC-BLK-SUB                         PIC S9(04)   02580031
025900                                                         COMP     02590031
026000                                                         SYNC.    02600031
026100             15  ASC-ITEM-SUB                        PIC S9(04)   02610031
026200                                                         COMP     02620031
026300                                                         SYNC.    02630031
026400             15  ASC-SEL-SUB                         PIC S9(04)   02640031
026500                                                         COMP.    02650031
026600             15  ASC-SEL-ITEM                        PIC S9(04)   02660031
026700                                                         COMP.    02670031
026800             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   02680031
026900                                                         COMP-3.  02690031
027000             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   02700031
027100                                                         COMP-3.  02710031
027200             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   02720031
027300                                                         COMP-3.  02730031
027400             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   02740031
027500                                                         COMP-3.  02750031
027600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   02760031
027700                                                         COMP-3.  02770031
027800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   02780031
027900                                                         COMP-3.  02790031
028000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   02800031
028100                                                         COMP     02810031
028200                                                         SYNC.    02820031
028300             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   02830031
028400                                                         COMP-3.  02840031
028500             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   02850031
028600                                                         COMP-3.  02860031
028700             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  02870031
028800                 88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 02880031
028900                 88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 02890031
029000             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  02900031
029100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02910031
029200             15  ASC-DTL-QUEUE-NAME.                              02920031
029300                 20  ASC-DTL-TERM-ID                 PIC  X(04).  02930031
029400                 20  ASC-DTL-TASK-NUMBER             PIC S9(05)   02940031
029500                                                         COMP-3.  02950031
029600                 20  ASC-DTL-SEQ                     PIC  9(01).  02960031
029700                                                                  02970031
029800             15  ASC-START-ITEM-REQUEST.                          02980031
029900                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  02990031
030000                                                                  03000031
030100     EJECT                                                        03010031
030200*---------------------------------------------------------------* 03020031
030300*    ABEND PROCESSING COPYBOOK.                                 * 03030031
030400*---------------------------------------------------------------* 03040031
030500                                                                  03050031
030600     COPY DPWS013.                                                03060031
030700                                                                  03070031
030800     EJECT                                                        03080031
030900*---------------------------------------------------------------* 03090031
031000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03100031
031100*---------------------------------------------------------------* 03110031
031200                                                                  03120031
031300     COPY DPWS015.                                                03130031
031400                                                                  03140031
031500*---------------------------------------------------------------* 03150031
031600*    FUNCTION KEYS COPYBOOK.                                    * 03160031
031700*---------------------------------------------------------------* 03170031
031800                                                                  03180031
031900     COPY DPWS016.                                                03190031
032000                                                                  03200031
032100*---------------------------------------------------------------* 03210031
032200*    MAP LAYOUT                                                 * 03220031
032300*---------------------------------------------------------------* 03230031
032400                                                                  03240031
032500     COPY TRKM301.                                                03250031
032600                                                                  03260031
032700 01  MR-OCCURS-LAYOUT          REDEFINES  TR301AO.                03270031
032800     05  FILLER                PIC X(59).                         03280031
032900     05  MR-SCROLL-AREA OCCURS 12 TIMES.                          03290031
033000         10  MR-DATAL          PIC S9(04) COMP.                   03300031
033100         10  MR-DATAA          PIC  X(01).                        03310031
033200         10  MR-DATAC          PIC  X(01).                        03320031
033300         10  MR-DATAH          PIC  X(01).                        03330031
033400         10  MR-DATA           PIC  X(20).                        03340031
033500                                                                  03350031
033600         10  MR-USERIDL        PIC S9(04) COMP.                   03360031
033700         10  MR-USERIDA        PIC  X(01).                        03370031
033800         10  MR-USERIDC        PIC  X(01).                        03380031
033900         10  MR-USERIDH        PIC  X(01).                        03390031
034000         10  MR-USERID         PIC  X(08).                        03400031
034100                                                                  03410031
034200         10  MR-DATEL          PIC S9(04) COMP.                   03420031
034300         10  MR-DATEA          PIC  X(01).                        03430031
034400         10  MR-DATEC          PIC  X(01).                        03440031
034500         10  MR-DATEH          PIC  X(01).                        03450031
034600         10  MR-DATE           PIC  X(08).                        03460031
034700                                                                  03470031
034800         10  MR-TIMEL          PIC S9(04) COMP.                   03480031
034900         10  MR-TIMEA          PIC  X(01).                        03490031
035000         10  MR-TIMEC          PIC  X(01).                        03500031
035100         10  MR-TIMEH          PIC  X(01).                        03510031
035200         10  MR-TIME           PIC  X(05).                        03520031
035300                                                                  03530031
035400         10  MR-VALUEL         PIC S9(04) COMP.                   03540031
035500         10  MR-VALUEA         PIC  X(01).                        03550031
035600         10  MR-VALUEC         PIC  X(01).                        03560031
035700         10  MR-VALUEH         PIC  X(01).                        03570031
035800         10  MR-VALUE          PIC  X(30).                        03580031
035900                                                                  03590031
036000 EJECT                                                            03600031
036100*---------------------------------------------------------------* 03610031
036200*    DB2 AREA FOR CONTAINER TABLE                               * 03620031
036300*---------------------------------------------------------------* 03630031
036400     EXEC SQL                                                     03640031
036500          INCLUDE TIMCNTK                                         03650031
036600     END-EXEC.                                                    03660031
036700*---------------------------------------------------------------* 03670031
036800*    DB2 AREA FOR CONTAINER AUDIT TABLE                         * 03680031
036900*---------------------------------------------------------------* 03690031
037000     EXEC SQL                                                     03700031
037100          INCLUDE TAUCNTK                                         03710031
037200     END-EXEC.                                                    03720031
037210*---------------------------------------------------------------* 03721040
037220*    DB2 AREA FOR CUSTOMS CONTAINER TABLE                       * 03722040
037230*---------------------------------------------------------------* 03723040
037240     EXEC SQL                                                     03724040
037250          INCLUDE TIMCSCN                                         03725040
037260     END-EXEC.                                                    03726040
037270*---------------------------------------------------------------* 03727040
037280*    DB2 AREA FOR CUSTOMS CONTAINER AUDIT TABLE                 * 03728042
037290*---------------------------------------------------------------* 03729040
037291     EXEC SQL                                                     03729140
037292          INCLUDE TAUCSCN                                         03729240
037293     END-EXEC.                                                    03729340
037294*---------------------------------------------------------------* 03729442
037295*    DB2 AREA FOR CONTAINER PO TABLE                            * 03729542
037296*---------------------------------------------------------------* 03729642
037297     EXEC SQL                                                     03729742
037298          INCLUDE TIMCNPO                                         03729842
037299     END-EXEC.                                                    03729942
037300*---------------------------------------------------------------* 03730031
037400*    DB2 AREA FOR COMMUNICATIONS                                * 03740031
037500*---------------------------------------------------------------* 03750031
037600     EXEC SQL                                                     03760031
037700          INCLUDE SQLCA                                           03770031
037800     END-EXEC.                                                    03780031
037900                                                                  03790031
038000*---------------------------------------------------------------* 03800031
038100*    CURSOR TO OBTAIN CONTAINER HISTORY INFORMATION             * 03810031
038200*---------------------------------------------------------------* 03820031
038300                                                                  03830031
038400     EXEC SQL                                                     03840031
038500         DECLARE CONTNR-CSR CURSOR                                03850031
038600         FOR SELECT CONSLR_SCAC_ID,                               03860031
038700                    MOM_IMPRT_TRIP_ID,                            03870031
038800                    MOM_DPRTR_TMST,                               03880031
038900                    MOM_POE_DELY_TMST,                            03890031
039000                    MOM_CARR_SCAC_ID,                             03900031
039100                    MOM_FOB_CDE,                                  03910069
039200                    MOM_IMPRT_VEH_NM,                             03920031
039300                    MOM_TRIP_TYP_CDE,                             03930031
039400                    MOM_DEST_POE_CDE,                             03940031
039500                    FDR_IMPRT_TRIP_ID,                            03950031
039600                    FDR_DPRTR_TMST,                               03960031
039700                    FDR_POE_DELY_TMST,                            03970031
039800                    FDR_CARR_SCAC_ID,                             03980031
039900                    FDR_FOB_CDE,                                  03990069
040000                    FDR_IMPRT_VEH_NM,                             04000031
040100                    FDR_TRIP_TYP_CDE,                             04010031
040200                    FDR_DEST_POE_CDE,                             04020031
040300                    SIZE_CDE,                                     04030031
040400                    CART_CNT,                                     04040031
040500                    CBMT_QTY,                                     04050031
040600                    WT_KGRM_QTY,                                  04060031
040700                    UNT_QTY,                                      04070031
041000                    ORGN_SHPD_FR_CDE,                             04100031
041100                    ORGN_SHPD_TO_CDE,                             04110031
041200                    EST_LBD_NM,                                   04120031
041300                    EST_LBD_TMST,                                 04130031
041400                    RISU_DO_RSN_CDE,                              04140031
041500                    BKR_FRGT_RLSE_TMST,                           04150031
041700                    DO_RCVD_TMST,                                 04170031
041800                    CONTNR_PU_TMST,                               04180031
041900                    DAT_SRC_ENT_ID,                               04190031
042000                    LAST_UPD_BY_USR_ID,                           04200031
042100                    LAST_UPD_TMST,                                04210031
042200                    ACTL_POE_DELY_TMST,                           04220031
042300                    ACTL_DEST_POE_CDE,                            04230031
042400                    ACTL_LBD_NM,                                  04240031
042500                    ACTL_LBD_TMST,                                04250054
042510                    DVN_TMST,                                     04251058
042520                    DCONSLR_SCAC_ID,                              04252058
042530                    DCONSLR_RET_TMST,                             04253060
042540                    MOM_POL_CDE,                                  04254069
042550                    FDR_POL_CDE,                                  04255069
042560                    MOM_POR_CDE,                                  04256060
042570                    FDR_POR_CDE                                   04257060
042600          FROM                                                    04260031
042700                TAUCNTK  A                                        04270031
042800          WHERE                                                   04280031
042900                A.CONTNR_ID       = :DK-CONTNR-NBR                04290031
043000            AND A.CONTNR_SEQ_NBR  = :DK-CONTNR-SEQ-NBR            04300031
043100          ORDER BY                                                04310031
043200                A.LAST_UPD_TMST DESC                              04320031
043300     END-EXEC.                                                    04330031
043400                                                                  04340031
043500*---------------------------------------------------------------* 04350032
043600*    CURSOR TO OBTAIN CONTAINER HISTORY INFORMATION FOR         * 04360032
043700*    DO_TO_DCONSLR_TMST  FROM TIMCSCN                           * 04370034
043800*---------------------------------------------------------------* 04380032
043900                                                                  04390032
044000     EXEC SQL                                                     04400032
044100         DECLARE TIMCSCN-CSR CURSOR                               04410034
044200         FOR SELECT  C.DO_TO_DCONSLR_TMST                         04420046
044210                   , C.CSTM_ENTR_ID                               04421053
044211                   , C.LAST_UPD_TMST                              04421153
044220                   , C.LAST_UPD_BY_USR_ID                         04422046
044300                FROM TIMCNTK A                                    04430034
044400                   , TIMCNPO B                                    04440036
044500                   , TIMCSCN C                                    04450036
044600               WHERE A.CONTNR_ID      = B.CONTNR_ID               04460039
044700                 AND B.CONTNR_ID      = C.CONTNR_ID               04470039
044800                 AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR          04480039
044900                 AND B.CSTM_ENTR_ID   = C.CSTM_ENTR_ID            04490039
045000                 AND A.CONTNR_ID      = :DK-CONTNR-NBR            04500039
045100                 AND A.CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NBR        04510039
045200            ORDER BY A.LAST_UPD_TMST DESC                         04520039
045300     END-EXEC.                                                    04530032
045400                                                                  04540032
045500*---------------------------------------------------------------* 04550034
045600*    CURSOR TO OBTAIN CONTAINER HISTORY AUDIT INFORMATION FOR   * 04560034
045700*    DO_TO_DCONSLR_TMST  FROM TAUCSCN                           * 04570034
045800*---------------------------------------------------------------* 04580034
045900                                                                  04590034
046000     EXEC SQL                                                     04600034
046100         DECLARE TAUCSCN-CSR CURSOR                               04610034
046200         FOR SELECT C.DO_TO_DCONSLR_TMST                          04620034
046210                  , C.CSTM_ENTR_ID                                04621051
046300                  , C.LAST_UPD_TMST                               04630034
046310                  , C.LAST_UPD_BY_USR_ID                          04631046
046400                FROM TIMCNTK A                                    04640034
046500                  ,  TIMCNPO B                                    04650036
046600                  ,  TAUCSCN C                                    04660036
046700               WHERE A.CONTNR_ID      = B.CONTNR_ID               04670041
046800                 AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR          04680039
046900                 AND B.CSTM_ENTR_ID   = C.CSTM_ENTR_ID            04690039
046910                 AND C.CSTM_ENTR_ID   = :PV-CURRENT-AUDIT-ENTR-ID 04691051
047000                 AND B.CONTNR_ID      = C.CONTNR_ID               04700039
047100                 AND A.CONTNR_ID      = :DK-CONTNR-NBR            04710039
047200                 AND A.CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NBR        04720039
047300          ORDER BY   A.LAST_UPD_TMST DESC                         04730039
047400     END-EXEC.                                                    04740034
047500                                                                  04750034
047600 EJECT                                                            04760034
047700 LINKAGE SECTION.                                                 04770031
047800                                                                  04780031
047900 01  DFHCOMMAREA.                                                 04790031
048000     05  FILLER                         OCCURS  1 TO 4072 TIMES   04800031
048100                                        DEPENDING ON EIBCALEN.    04810031
048200         10  FILLER                     PIC X.                    04820031
048300                                                                  04830031
048400 EJECT                                                            04840031
048500 PROCEDURE DIVISION.                                              04850031
048600                                                                  04860031
048700 0000-MAIN-MODULE.                                                04870031
048800                                                                  04880031
048900     INITIALIZE DP030-CICS-API-FIELDS.                            04890031
049000     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        04900031
049100     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           04910031
049200     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          04920031
049300     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        04930031
049400     MOVE LENGTH OF TR301AI       TO DP030-MAP-LENGTH (1).        04940031
049500     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      04950031
049600     PERFORM 0001-CALL-CICS-ARCH-API.                             04960031
049700                                                                  04970031
049800     PERFORM 1000-CONTROL-PROCESSING.                             04980031
049900                                                                  04990031
050000     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      05000031
050100     PERFORM 0001-CALL-CICS-ARCH-API.                             05010031
050200                                                                  05020031
050300*----------------------------------------------------------------*05030031
050400*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *05040031
050500*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *05050031
050600*----------------------------------------------------------------*05060031
050700                                                                  05070031
050800 0001-CALL-CICS-ARCH-API.                                         05080031
050900                                                                  05090031
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05100071
051100                                    DFHCOMMAREA                   05110071
051200                                    DP030-CICS-API-FIELDS         05120071
051300                                    DP020-STANDARD-COMMAREA       05130071
051400                                    TR301AI.                      05140071
051500                                                                  05150031
051600     IF  DP030-RC-CALL-SUCCESSFUL                                 05160031
051700         CONTINUE                                                 05170031
051800     ELSE                                                         05180031
051900         SET DP013-NO-ROLLBACK TO TRUE                            05190031
052000         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   05200031
052100         SET DP013-CICS-ABEND TO TRUE                             05210031
052200         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        05220031
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05230071
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05240071
052500         MOVE DP030-RETURN-CODE                                   05250031
052600                               TO DP013-MESSAGE-TEXT (3)          05260031
052700         PERFORM DP013-0000-PROCESS-ABEND                         05270031
052800     END-IF.                                                      05280031
052900                                                                  05290031
053000*----------------------------------------------------------------*05300031
053100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05310031
053200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05320031
053300*                                                                *05330031
053400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05340031
053500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05350031
053600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05360031
053700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05370031
053800*----------------------------------------------------------------*05380031
053900                                                                  05390031
054000 1000-CONTROL-PROCESSING.                                         05400031
054100                                                                  05410031
054200     EVALUATE TRUE                                                05420031
054300         WHEN DP020-NEXT-ACT-INITIAL                              05430031
054400             MOVE EIBTRMID          TO ASC-DTL-TERM-ID            05440031
054500             MOVE DP020-SRC-TASK-NUMBER                           05450031
054600                                    TO ASC-DTL-TASK-NUMBER        05460031
054700             MOVE PC-DTL-QUEUE-SEQ  TO ASC-DTL-SEQ                05470031
054800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05480031
054900***-----$TEMPLATE NOTE$-------------------------------------------05490031
055000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05500031
055100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05510031
055200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05520031
055300***---------------------------------------------------------------05530031
055400             IF  PS-COMMAREA-NOT-VALID                            05540031
055500***              MOVE PC-TSYMSG-99901                             05550031
055600***                            TO  DP020-MSG-NUMBER               05560031
055700***              SET DP020-MSG-FATAL                              05570031
055800***                            TO  TRUE                           05580031
055900                 SET DP020-NEXT-ACT-APPL-ERROR                    05590031
056000                               TO  TRUE                           05600031
056100             ELSE                                                 05610031
056200                 PERFORM 2050-DELETE-DETAIL-QUEUE                 05620031
056300                 PERFORM 4000-BUILD-INITIAL-PANEL                 05630031
056400             END-IF                                               05640031
056500                                                                  05650031
056600         WHEN DP020-NEXT-ACT-READ-MAP                             05660031
056700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05670031
056800                               TO PV-TOP-ITEM                     05680031
056900             PERFORM 2000-PROCESS-PANEL                           05690031
057000                                                                  05700031
057100         WHEN DP020-NEXT-ACT-RETURN                               05710031
057200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05720031
057300                               TO PV-TOP-ITEM                     05730031
057400             MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        05740031
057500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05750031
057600                                                                  05760031
057700         WHEN OTHER                                               05770031
057800             SET DP013-LOGIC-ABEND TO TRUE                        05780031
057900             SET DP013-NO-ROLLBACK TO TRUE                        05790031
058000             MOVE '1000-CONTROL-PROCESSING'                       05800031
058100                               TO  DP013-PARAGRAPH                05810031
058200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05820031
058300                               TO  DP013-MESSAGE-TEXT(1)          05830031
058400             PERFORM DP013-0000-PROCESS-ABEND                     05840031
058500     END-EVALUATE.                                                05850031
058600                                                                  05860031
058700 EJECT                                                            05870031
058800*----------------------------------------------------------------*05880031
058900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05890031
059000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05900031
059100*----------------------------------------------------------------*05910031
059200                                                                  05920031
059300 1100-PROCESS-INTER-APPL-COMM.                                    05930031
059400                                                                  05940031
059500     SET PS-COMMAREA-VALID     TO TRUE.                           05950031
059600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05960031
059700     MOVE SPACE                TO ASC-START-ITEM-REQUEST.         05970031
059800                                                                  05980031
059900     EVALUATE DP020-INT-APPL-FORMAT-IND                           05990031
060000         WHEN PC-LIST-FORMAT                                      06000031
060100             MOVE TR102-CONTNR-NO     TO ASC-KEY-CONTNR-NBR       06010031
060200                                         DK-CONTNR-NBR            06020031
060300             MOVE TR102-CONTNR-SEQ-NO TO ASC-KEY-CONTNR-SEQ-NBR   06030031
060400                                         DK-CONTNR-SEQ-NBR        06040031
060500         WHEN OTHER                                               06050031
060600             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            06060031
060700             SET DP020-MSG-FATAL   TO TRUE                        06070031
060800             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                06080031
060900     END-EVALUATE.                                                06090031
061000                                                                  06100031
061100*----------------------------------------------------------------*06110031
061200*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *06120031
061300*    ON WHAT FUNCTION KEY WAS SELECTED.                          *06130031
061400*----------------------------------------------------------------*06140031
061500                                                                  06150031
061600 2000-PROCESS-PANEL.                                              06160031
061700                                                                  06170031
061800     EVALUATE TRUE                                                06180031
061900         WHEN DP020-SRC-AID = DP016-CLEAR                         06190031
062000             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                06200031
062100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06210031
062200             PERFORM 3200-RESET-ATTRIBUTES                        06220031
062300                                                                  06230031
062400         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06240031
062500             MOVE ASC-KEY-CONTNR-NBR     TO DK-CONTNR-NBR         06250031
062600             MOVE ASC-KEY-CONTNR-SEQ-NBR TO DK-CONTNR-SEQ-NBR     06260031
062700             PERFORM 2050-DELETE-DETAIL-QUEUE                     06270031
062800             PERFORM 4000-BUILD-INITIAL-PANEL                     06280031
062900             PERFORM 3200-RESET-ATTRIBUTES                        06290031
063000                                                                  06300031
063100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06310031
063200             MOVE +1 TO PV-TOP-ITEM                               06320031
063300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06330031
063400             PERFORM 3200-RESET-ATTRIBUTES                        06340031
063500                                                                  06350031
063600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06360031
063700             PERFORM 2110-BROWSE-BACKWARD                         06370031
063800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06380031
063900             PERFORM 3200-RESET-ATTRIBUTES                        06390031
064000                                                                  06400031
064100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06410031
064200             PERFORM 2120-BROWSE-FORWARD                          06420031
064300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06430031
064400             PERFORM 3200-RESET-ATTRIBUTES                        06440031
064500                                                                  06450031
064600         WHEN DP020-SRC-AID = DP016-ENTER                         06460031
064700             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06470031
064800             IF  PS-ERROR                                         06480031
064900                 CONTINUE                                         06490031
065000             ELSE                                                 06500031
065100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06510031
065200                 PERFORM 3200-RESET-ATTRIBUTES                    06520031
065300             END-IF                                               06530031
065400                                                                  06540031
065500         WHEN OTHER                                               06550031
065600             SET DP013-NO-ROLLBACK TO TRUE                        06560031
065700             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               06570031
065800             SET DP013-CICS-ABEND TO TRUE                         06580031
065900             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         06590031
066000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06600031
066100                                   TO DP013-MESSAGE-TEXT (1)      06610031
066200             PERFORM DP013-0000-PROCESS-ABEND                     06620031
066300                                                                  06630031
066400     END-EVALUATE.                                                06640031
066500 EJECT                                                            06650031
066600*----------------------------------------------------------------*06660031
066700*    DELETE THE TEMPORARY STORAGE QUEUE.                         *06670031
066800*----------------------------------------------------------------*06680031
066900                                                                  06690031
067000 2050-DELETE-DETAIL-QUEUE.                                        06700031
067100                                                                  06710031
067200     EXEC CICS                                                    06720031
067300         DELETEQ TS                                               06730031
067400             QUEUE (ASC-DTL-QUEUE-NAME)                           06740031
067500             RESP  (PV-CICS-RESP)                                 06750031
067600     END-EXEC.                                                    06760031
067700                                                                  06770031
067800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06780031
067900        (PV-CICS-RESP = DFHRESP(QIDERR))                          06790031
068000         CONTINUE                                                 06800031
068100     ELSE                                                         06810031
068200         SET DP013-CICS-ABEND TO TRUE                             06820031
068300         SET DP013-NO-ROLLBACK TO TRUE                            06830031
068400                                                                  06840031
068500         MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       06850031
068600         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  06860031
068700                        TO DP013-MESSAGE-TEXT (1)                 06870031
068800         PERFORM DP013-0000-PROCESS-ABEND                         06880031
068900     END-IF.                                                      06890031
069000                                                                  06900031
069100     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        06910031
069200 EJECT                                                            06920031
069300*----------------------------------------------------------------*06930031
069400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06940031
069500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06950031
069600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06960031
069700*    MESSAGE.                                                    *06970031
069800*----------------------------------------------------------------*06980031
069900                                                                  06990031
070000 2110-BROWSE-BACKWARD.                                            07000031
070100                                                                  07010031
070200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07020031
070300         GIVING PV-TOP-ITEM.                                      07030031
070400                                                                  07040031
070500     IF  PV-TOP-ITEM < +1                                         07050031
070600         MOVE +1              TO PV-TOP-ITEM                      07060031
070700*        -- TOP OF LIST --                                        07070031
070800         MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 07080031
070900         SET DP020-MSG-INFORMATIONAL TO TRUE                      07090031
071000     END-IF.                                                      07100031
071100                                                                  07110031
071200 EJECT                                                            07120031
071300                                                                  07130031
071400*----------------------------------------------------------------*07140031
071500*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07150031
071600*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07160031
071700*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07170031
071800*----------------------------------------------------------------*07180031
071900                                                                  07190031
072000 2120-BROWSE-FORWARD.                                             07200031
072100                                                                  07210031
072200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07220031
072300         GIVING PV-TOP-ITEM.                                      07230031
072400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07240031
072500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07250031
072600                                   TO PV-TOP-ITEM                 07260031
072700*        -- BOTTOM OF LIST --                                     07270031
072800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07280031
072900         SET DP020-MSG-INFORMATIONAL                              07290031
073000                                   TO TRUE                        07300031
073100     ELSE                                                         07310031
073200         COMPUTE PV-BOTTOM-ITEM =                                 07320031
073300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07330031
073400         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07340031
073500*            -- BOTTOM OF LIST --                                 07350031
073600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07360031
073700             SET DP020-MSG-INFORMATIONAL                          07370031
073800                                   TO TRUE                        07380031
073900         END-IF                                                   07390031
074000     END-IF.                                                      07400031
074100 EJECT                                                            07410031
074200*----------------------------------------------------------------*07420031
074300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07430031
074400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07440031
074500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07450031
074600*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *07460031
074700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07470031
074800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07480031
074900*----------------------------------------------------------------*07490031
075000                                                                  07500031
075100 2130-CHECK-FOR-JUMP-BROWSE.                                      07510031
075200                                                                  07520031
075300     IF ASTRTITL > ZERO                                           07530031
075400         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      07540031
075500     ELSE                                                         07550031
075600         IF ASTRTITF = DP015-ERASE-EOF                            07560031
075700             INITIALIZE ASC-START-ITEM-REQUEST                    07570031
075800         END-IF                                                   07580031
075900     END-IF.                                                      07590031
076000                                                                  07600031
076100     SET PS-NO-ERROR               TO TRUE.                       07610031
076200     IF (ASC-START-ITEM-REQUEST = SPACE)                          07620031
076300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07630031
076400                                   TO PV-TOP-ITEM                 07640031
076500     ELSE                                                         07650031
076600         MOVE ASC-START-ITEM-REQUEST                              07660031
076700                                   TO DP010I-UNEDITED-FIELD       07670031
076800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07680031
076900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07690031
077000         SET DP010I-NEGATIVE-NOT-ALLOWED                          07700031
077100                                   TO TRUE                        07710031
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07721070
263697              USING DP010I-NUMERIC-EDIT-AREA                      07722070
077300                                                                  07730031
077400         IF  NOT DP010I-ERROR-DETECTED                            07740031
077500             MOVE DP010I-NUMERIC-FIELD                            07750031
077600                                   TO  ASC-START-ITEM-REQUEST-N   07760031
077700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07770031
077800                 IF  ASC-START-ITEM-REQUEST-N >                   07780031
077900                                          ASC-NUMBER-OF-ITEMS-READ07790031
078000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07800031
078100                     COMPUTE PV-TOP-ITEM =                        07810031
078200                             ASC-NUMBER-OF-ITEMS-READ             07820031
078300                             - PC-ITEMS-PER-PANEL + 1             07830031
078400                     IF  PV-TOP-ITEM < +1                         07840031
078500                         MOVE +1   TO PV-TOP-ITEM                 07850031
078600                         MOVE PC-TSYMSG-00070                     07860031
078700                                   TO DP020-MSG-NUMBER            07870031
078800                         SET DP020-MSG-INFORMATIONAL              07880031
078900                                   TO TRUE                        07890031
079000                     END-IF                                       07900031
079100                 ELSE                                             07910031
079200                     MOVE ASC-START-ITEM-REQUEST-N                07920031
079300                                   TO PV-TOP-ITEM                 07930031
079400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07940031
079500                     COMPUTE PV-BOTTOM-ITEM =                     07950031
079600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07960031
079700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07970031
079800*                        -- BOTTOM OF LIST --                     07980031
079900                         MOVE PC-TSYMSG-00070                     07990031
080000                                   TO DP020-MSG-NUMBER            08000031
080100                         SET DP020-MSG-INFORMATIONAL              08010031
080200                                   TO TRUE                        08020031
080300                     END-IF                                       08030031
080400                 END-IF                                           08040031
080500             ELSE                                                 08050031
080600*                --- VALUE OUT OF RANGE ----                      08060031
080700                 MOVE PC-TSYMSG-00101                             08070031
080800                                   TO DP020-MSG-NUMBER            08080031
080900                 MOVE -1           TO ASTRTITL                    08090031
081000                 SET DP030-SET-CURSOR-APPL-1                      08100031
081100                                   TO TRUE                        08110031
081200                 MOVE DP015-REVERSE                               08120031
081300                                   TO ASTRTITH                    08130031
081400                 MOVE DP015-RED    TO ASTRTITC                    08140031
081500                 MOVE DP015-UNP-NUM-BRT-MDT                       08150031
081600                                   TO ASTRTITA                    08160031
081700                 SET DP020-MSG-FATAL                              08170031
081800                                   TO TRUE                        08180031
081900                 SET PS-ERROR      TO TRUE                        08190031
082000             END-IF                                               08200031
082100                                                                  08210031
082200         ELSE                                                     08220031
082300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08230031
082400             MOVE -1               TO ASTRTITL                    08240031
082500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08250031
082600             MOVE DP015-REVERSE    TO ASTRTITH                    08260031
082700             MOVE DP015-RED        TO ASTRTITC                    08270031
082800             MOVE DP015-UNP-NUM-BRT-MDT                           08280031
082900                                   TO ASTRTITA                    08290031
083000             SET DP020-MSG-FATAL   TO TRUE                        08300031
083100             SET PS-ERROR          TO TRUE                        08310031
083200         END-IF                                                   08320031
083300     END-IF.                                                      08330031
083400                                                                  08340031
083500*----------------------------------------------------------------*08350031
083600*    RESET THE MAP FIELD ATTRIBUTES.                             *08360031
083700*----------------------------------------------------------------*08370031
083800 3200-RESET-ATTRIBUTES.                                           08380031
083900                                                                  08390031
084000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   08400031
084100     MOVE DP015-GREEN              TO ASTRTITC.                   08410031
084200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   08420031
084300     MOVE -1                       TO ASTRTITL.                   08430031
084400     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       08440031
084500                                                                  08450031
084600*----------------------------------------------------------------*08460031
084700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *08470031
084800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *08480031
084900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *08490031
085000*    DISPLAY THE PANEL TO USER.                                  *08500031
085100*----------------------------------------------------------------*08510031
085200                                                                  08520031
085300 4000-BUILD-INITIAL-PANEL.                                        08530031
085400                                                                  08540031
085500     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            08550031
085600                                 ASC-BLOCK-ENTRIES (2).           08560031
085700     MOVE +1                 TO  ASC-BLK-SUB.                     08570031
085800     SET ASC-ITEMS-LEFT-ON-DB                                     08580031
085900                             TO  TRUE.                            08590031
086000                                                                  08600031
086100     MOVE +0                 TO  ASC-ITEM-SUB                     08610031
086200                                 ASC-NUMBER-OF-ITEMS-READ         08620031
086300                                 ASC-NUMBER-OF-SELECTED-ITEMS     08630031
086400                                 ASC-HIGHEST-BLOCK-WRITTEN        08640031
086500                                 ASC-START-OF-SELECTED-RANGE      08650031
086600                                 ASC-END-OF-SELECTED-RANGE        08660031
086700                                 ASC-ITEM-AT-TOP-OF-PANEL.        08670031
086800                                                                  08680031
086900     PERFORM 4030-SELECT-TIMCNTK.                                 08690031
087000                                                                  08700031
087100     PERFORM 4040-MOVE-TIMCNTK-TO-HOLD.                           08710031
087200                                                                  08720031
087300     PERFORM 4010-OPEN-CURSOR.                                    08730031
087400                                                                  08740031
087500     PERFORM 4300-READ-ITEMS-FROM-DB.                             08750031
087600                                                                  08760031
087700     PERFORM 4020-CLOSE-CURSOR.                                   08770031
087800                                                                  08780031
087900     MOVE +1                 TO  PV-TOP-ITEM.                     08790031
088000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          08800031
088100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    08810031
088200         SET DP020-MSG-FATAL   TO  TRUE                           08820031
088300*--------NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED---   08830031
088400         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               08840031
088500     ELSE                                                         08850031
088600         MOVE -1             TO ASTRTITL                          08860031
088700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08870031
088800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     08880031
088900     END-IF.                                                      08890031
089000 EJECT                                                            08900031
089100*----------------------------------------------------------------*08910031
089200* OPEN THE CONTAINER CURSOR.                                     *08920031
089300*----------------------------------------------------------------*08930031
089400                                                                  08940031
089500 4010-OPEN-CURSOR.                                                08950031
089600                                                                  08960031
089700     EXEC SQL                                                     08970031
089800          OPEN CONTNR-CSR                                         08980031
089900     END-EXEC.                                                    08990031
090000                                                                  09000031
090100     EVALUATE TRUE                                                09010031
090200         WHEN SQLCODE = ZERO                                      09020031
090300              CONTINUE                                            09030031
090400         WHEN SQLWARN0 NOT EQUAL SPACE                            09040031
090500         WHEN SQLCODE NOT EQUAL ZERO                              09050031
090600              MOVE '4010-OPEN-CURSOR'                             09060031
090700                           TO  DP013-PARAGRAPH                    09070031
090800              MOVE 'OPEN CONTAINER CURSOR'                        09080031
090900                           TO  DP013-MESSAGE-TEXT (1)             09090031
091000              MOVE SQLCA   TO  DP013-SQLCA                        09100031
091100              SET DP013-DB2-ABEND                                 09110031
091200                           TO  TRUE                               09120031
091300              PERFORM DP013-0000-PROCESS-ABEND                    09130031
091400     END-EVALUATE.                                                09140031
091500                                                                  09150031
091600 EJECT                                                            09160031
091700*----------------------------------------------------------------*09170031
091800* CLOSE THE CONTAINER CURSOR.                                    *09180031
091900*----------------------------------------------------------------*09190031
092000                                                                  09200031
092100 4020-CLOSE-CURSOR.                                               09210031
092200                                                                  09220031
092300     EXEC SQL                                                     09230031
092400         CLOSE CONTNR-CSR                                         09240031
092500     END-EXEC.                                                    09250031
092600                                                                  09260031
092700     EVALUATE TRUE                                                09270031
092800         WHEN SQLCODE = ZERO                                      09280031
092900              CONTINUE                                            09290031
093000         WHEN SQLWARN0 NOT EQUAL SPACE                            09300031
093100         WHEN SQLCODE NOT EQUAL ZERO                              09310031
093200              MOVE '4020-CLOSE-CURSOR'                            09320031
093300                           TO  DP013-PARAGRAPH                    09330031
093400              MOVE 'CLOSE CONTAINER CURSOR'                       09340031
093500                           TO  DP013-MESSAGE-TEXT (1)             09350031
093600              MOVE SQLCA   TO  DP013-SQLCA                        09360031
093700              SET DP013-DB2-ABEND                                 09370031
093800                           TO  TRUE                               09380031
093900              PERFORM DP013-0000-PROCESS-ABEND                    09390031
094000     END-EVALUATE.                                                09400031
094100                                                                  09410031
094200 EJECT                                                            09420031
094300*----------------------------------------------------------------*09430031
094400* SELECT A ROW FROM THE CONTAINER TABLE (TIMCNTK).               *09440031
094500*----------------------------------------------------------------*09450031
094600 4030-SELECT-TIMCNTK.                                             09460031
094700                                                                  09470031
094800     PERFORM                                                      09480031
094900         WITH TEST AFTER                                          09490031
095000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09500031
095100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09510031
095200                 SQLCODE = ZERO                     OR            09520031
095300                 SQLCODE = +100                                   09530031
095400                                                                  09540031
095500         EXEC SQL                                                 09550031
095600             SELECT CONSLR_SCAC_ID,                               09560031
095700                    MOM_IMPRT_TRIP_ID,                            09570031
095800                    MOM_DPRTR_TMST,                               09580031
095900                    MOM_POE_DELY_TMST,                            09590031
096000                    MOM_CARR_SCAC_ID,                             09600031
096100                    MOM_FOB_CDE,                                  09610069
096200                    MOM_IMPRT_VEH_NM,                             09620031
096300                    MOM_TRIP_TYP_CDE,                             09630031
096400                    MOM_DEST_POE_CDE,                             09640031
096500                    FDR_IMPRT_TRIP_ID,                            09650031
096600                    FDR_DPRTR_TMST,                               09660031
096700                    FDR_POE_DELY_TMST,                            09670031
096800                    FDR_CARR_SCAC_ID,                             09680031
096900                    FDR_FOB_CDE,                                  09690069
097000                    FDR_IMPRT_VEH_NM,                             09700031
097100                    FDR_TRIP_TYP_CDE,                             09710031
097200                    FDR_DEST_POE_CDE,                             09720031
097300                    SIZE_CDE,                                     09730031
097400                    CART_CNT,                                     09740031
097500                    CBMT_QTY,                                     09750031
097600                    WT_KGRM_QTY,                                  09760031
097700                    UNT_QTY,                                      09770031
098000                    ORGN_SHPD_FR_CDE,                             09800031
098100                    ORGN_SHPD_TO_CDE,                             09810031
098200                    EST_LBD_NM,                                   09820031
098300                    EST_LBD_TMST,                                 09830031
098400                    RISU_DO_RSN_CDE,                              09840031
098500                    BKR_FRGT_RLSE_TMST,                           09850031
098700                    DO_RCVD_TMST,                                 09870031
098800                    CONTNR_PU_TMST,                               09880031
098900                    DAT_SRC_ENT_ID,                               09890031
099000                    LAST_UPD_BY_USR_ID,                           09900031
099100                    LAST_UPD_TMST,                                09910031
099200                    ACTL_POE_DELY_TMST,                           09920031
099300                    ACTL_DEST_POE_CDE,                            09930031
099400                    ACTL_LBD_NM,                                  09940031
099500                    ACTL_LBD_TMST,                                09950054
099510                    DVN_TMST,                                     09951058
099520                    DCONSLR_SCAC_ID,                              09952058
099530                    DCONSLR_RET_TMST,                             09953062
099540                    MOM_POL_CDE,                                  09954069
099550                    FDR_POL_CDE,                                  09955069
099560                    MOM_POR_CDE,                                  09956062
099570                    FDR_POR_CDE                                   09957062
099600              INTO :IMCNTK-CONSLR-SCAC-ID,                        09960031
099700                   :IMCNTK-MOM-IMPRT-TRIP-ID,                     09970031
099800                   :IMCNTK-MOM-DPRTR-TMST,                        09980031
099900                   :IMCNTK-MOM-POE-DELY-TMST,                     09990031
100000                   :IMCNTK-MOM-CARR-SCAC-ID,                      10000031
100100                   :IMCNTK-MOM-FOB-CDE,                           10010069
100200                   :IMCNTK-MOM-IMPRT-VEH-NM,                      10020031
100300                   :IMCNTK-MOM-TRIP-TYP-CDE,                      10030031
100400                   :IMCNTK-MOM-DEST-POE-CDE,                      10040031
100500                   :IMCNTK-FDR-IMPRT-TRIP-ID,                     10050031
100600                   :IMCNTK-FDR-DPRTR-TMST,                        10060031
100700                   :IMCNTK-FDR-POE-DELY-TMST,                     10070031
100800                   :IMCNTK-FDR-CARR-SCAC-ID,                      10080031
100900                   :IMCNTK-FDR-FOB-CDE,                           10090069
101000                   :IMCNTK-FDR-IMPRT-VEH-NM,                      10100031
101100                   :IMCNTK-FDR-TRIP-TYP-CDE,                      10110031
101200                   :IMCNTK-FDR-DEST-POE-CDE,                      10120031
101300                   :IMCNTK-SIZE-CDE,                              10130031
101400                   :IMCNTK-CART-CNT,                              10140031
101500                   :IMCNTK-CBMT-QTY,                              10150031
101600                   :IMCNTK-WT-KGRM-QTY,                           10160031
101700                   :IMCNTK-UNT-QTY,                               10170031
102000                   :IMCNTK-ORGN-SHPD-FR-CDE,                      10200031
102100                   :IMCNTK-ORGN-SHPD-TO-CDE,                      10210031
102200                   :IMCNTK-EST-LBD-NM,                            10220031
102300                   :IMCNTK-EST-LBD-TMST,                          10230031
102400                   :IMCNTK-RISU-DO-RSN-CDE,                       10240031
102500                   :IMCNTK-BKR-FRGT-RLSE-TMST,                    10250031
102700                   :IMCNTK-DO-RCVD-TMST,                          10270031
102800                   :IMCNTK-CONTNR-PU-TMST,                        10280031
102900                   :IMCNTK-DAT-SRC-ENT-ID,                        10290031
103000                   :IMCNTK-LAST-UPD-BY-USR-ID,                    10300031
103100                   :IMCNTK-LAST-UPD-TMST,                         10310031
103200                   :IMCNTK-ACTL-POE-DELY-TMST,                    10320031
103300                   :IMCNTK-ACTL-DEST-POE-CDE,                     10330031
103400                   :IMCNTK-ACTL-LBD-NM,                           10340031
103500                   :IMCNTK-ACTL-LBD-TMST,                         10350054
103510                   :IMCNTK-DVN-TMST,                              10351058
103520                   :IMCNTK-DCONSLR-SCAC-ID,                       10352058
103530                   :IMCNTK-DCONSLR-RET-TMST,                      10353062
103540                   :IMCNTK-MOM-POL-CDE,                           10354069
103550                   :IMCNTK-FDR-POL-CDE,                           10355069
103560                   :IMCNTK-MOM-POR-CDE,                           10356062
103570                   :IMCNTK-FDR-POR-CDE                            10357062
103600                                                                  10360031
103700               FROM TIMCNTK                                       10370031
103800              WHERE CONTNR_ID        = :DK-CONTNR-NBR             10380031
103900                AND CONTNR_SEQ_NBR   = :DK-CONTNR-SEQ-NBR         10390031
104000         END-EXEC                                                 10400031
104100                                                                  10410031
104200         EVALUATE TRUE                                            10420031
104300             WHEN SQLCODE = -904                                  10430031
104400             WHEN SQLCODE = -913                                  10440031
104500                 CONTINUE                                         10450031
104600             WHEN SQLCODE = ZERO                                  10460031
104700             WHEN SQLCODE = +100                                  10470031
104800                  CONTINUE                                        10480031
104900             WHEN SQLWARN0 NOT = SPACES                           10490031
105000             WHEN SQLCODE < ZERO                                  10500031
105100             WHEN SQLCODE > ZERO                                  10510031
105200                 MOVE '4030-SELECT-TIMCNTK'                       10520031
105300                                   TO DP013-PARAGRAPH             10530031
105400                 MOVE 'SQL ERROR SELECTING CONTAINER'             10540031
105500                                   TO DP013-MESSAGE-TEXT (1)      10550031
105600                 MOVE SQLCA        TO DP013-SQLCA                 10560031
105700                 MOVE 'TIMCNTK '   TO DP013-DB2-TABLE-NAME (1)    10570031
105800                 SET DP013-DB2-ABEND                              10580031
105900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10590031
106000                 PERFORM DP013-0000-PROCESS-ABEND                 10600031
106100         END-EVALUATE                                             10610031
106200     END-PERFORM.                                                 10620031
106300*                                                                 10630031
106400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10640031
106500         MOVE '4030-SELECT-TIMCNTK'                               10650031
106600                                   TO DP013-PARAGRAPH             10660031
106700         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO SELECT CNTNR'   10670031
106800                                   TO DP013-MESSAGE-TEXT (1)      10680031
106900         MOVE SQLCA                TO DP013-SQLCA                 10690031
107000         MOVE 'TIMCNTK '           TO DP013-DB2-TABLE-NAME (1)    10700031
107100         SET DP013-DB2-ABEND                                      10710031
107200             DP013-XCTL-DISPLAY-RESTART                           10720031
107300                                   TO TRUE                        10730031
107400         PERFORM DP013-0000-PROCESS-ABEND                         10740031
107500     END-IF.                                                      10750031
107600                                                                  10760022
107700 EJECT                                                            10770031
107800*----------------------------------------------------------------*10780031
107900* MOVE SELECTED TIMCNTK VALUES TO HOLD FIELDS FOR COMPARISON.    *10790031
108000*----------------------------------------------------------------*10800031
108100 4040-MOVE-TIMCNTK-TO-HOLD.                                       10810031
108200                                                                  10820031
108300     MOVE IMCNTK-CONSLR-SCAC-ID     TO PV-PREV-CONSLR-SCAC-ID.    10830031
108400     MOVE IMCNTK-MOM-IMPRT-TRIP-ID  TO PV-PREV-MOM-IMPRT-TRIP-ID. 10840031
108500     MOVE IMCNTK-MOM-DPRTR-TMST     TO PV-PREV-MOM-DPRTR-TMST.    10850031
108600     MOVE IMCNTK-MOM-POE-DELY-TMST  TO PV-PREV-MOM-POE-DELY-TMST. 10860031
108700     MOVE IMCNTK-MOM-CARR-SCAC-ID   TO PV-PREV-MOM-CARR-SCAC-ID.  10870031
108800     MOVE IMCNTK-MOM-FOB-CDE        TO PV-PREV-MOM-FOB-CDE.       10880069
108900     MOVE IMCNTK-MOM-IMPRT-VEH-NM   TO PV-PREV-MOM-IMPRT-VEH-NM.  10890031
109000     MOVE IMCNTK-MOM-TRIP-TYP-CDE   TO PV-PREV-MOM-TRIP-TYP-CDE.  10900031
109100     MOVE IMCNTK-MOM-DEST-POE-CDE   TO PV-PREV-MOM-DEST-POE-CDE.  10910031
109200     MOVE IMCNTK-FDR-IMPRT-TRIP-ID  TO PV-PREV-FDR-IMPRT-TRIP-ID. 10920031
109300     MOVE IMCNTK-FDR-DPRTR-TMST     TO PV-PREV-FDR-DPRTR-TMST.    10930031
109400     MOVE IMCNTK-FDR-POE-DELY-TMST  TO PV-PREV-FDR-POE-DELY-TMST. 10940031
109500     MOVE IMCNTK-FDR-CARR-SCAC-ID   TO PV-PREV-FDR-CARR-SCAC-ID.  10950031
109600     MOVE IMCNTK-FDR-FOB-CDE        TO PV-PREV-FDR-FOB-CDE.       10960069
109700     MOVE IMCNTK-FDR-IMPRT-VEH-NM   TO PV-PREV-FDR-IMPRT-VEH-NM.  10970031
109800     MOVE IMCNTK-FDR-TRIP-TYP-CDE   TO PV-PREV-FDR-TRIP-TYP-CDE.  10980031
109900     MOVE IMCNTK-FDR-DEST-POE-CDE   TO PV-PREV-FDR-DEST-POE-CDE.  10990031
110000     MOVE IMCNTK-SIZE-CDE           TO PV-PREV-SIZE-CDE.          11000031
110100     MOVE IMCNTK-CART-CNT           TO PV-PREV-CART-CNT.          11010031
110200     MOVE IMCNTK-CBMT-QTY           TO PV-PREV-CBMT-QTY.          11020031
110300     MOVE IMCNTK-WT-KGRM-QTY        TO PV-PREV-WT-KGRM-QTY.       11030031
110400     MOVE IMCNTK-UNT-QTY            TO PV-PREV-UNT-QTY.           11040031
110700     MOVE IMCNTK-ORGN-SHPD-FR-CDE   TO PV-PREV-ORGN-SHPD-FR-CDE.  11070031
110800     MOVE IMCNTK-ORGN-SHPD-TO-CDE   TO PV-PREV-ORGN-SHPD-TO-CDE.  11080031
110900     MOVE IMCNTK-EST-LBD-NM         TO PV-PREV-EST-LBD-NM.        11090031
111000     MOVE IMCNTK-EST-LBD-TMST       TO PV-PREV-EST-LBD-TMST.      11100031
111100     MOVE IMCNTK-RISU-DO-RSN-CDE    TO PV-PREV-RISU-DO-RSN-CDE.   11110031
111200     MOVE IMCNTK-BKR-FRGT-RLSE-TMST TO PV-PREV-BKR-FRGT-RLSE-TMST.11120031
111400     MOVE IMCNTK-DO-RCVD-TMST       TO PV-PREV-DO-RCVD-TMST.      11140031
111500     MOVE IMCNTK-CONTNR-PU-TMST     TO PV-PREV-CONTNR-PU-TMST.    11150031
111600     MOVE IMCNTK-DAT-SRC-ENT-ID     TO PV-PREV-DAT-SRC-ENT-ID.    11160031
111700     MOVE IMCNTK-LAST-UPD-BY-USR-ID TO                            11170031
111800                                    PV-PREV-LAST-UPD-BY-USR-ID.   11180031
111900     MOVE IMCNTK-LAST-UPD-TMST      TO PV-PREV-LAST-UPD-TMST.     11190031
112000     MOVE IMCNTK-ACTL-POE-DELY-TMST TO PV-PREV-ACTL-POE-DELY-TMST.11200031
112100     MOVE IMCNTK-ACTL-DEST-POE-CDE  TO PV-PREV-ACTL-DEST-POE-CDE. 11210031
112200     MOVE IMCNTK-ACTL-LBD-NM        TO PV-PREV-ACTL-LBD-NM.       11220031
112300     MOVE IMCNTK-ACTL-LBD-TMST      TO PV-PREV-ACTL-LBD-TMST.     11230031
112310     MOVE IMCNTK-DVN-TMST           TO PV-PREV-DVN-TMST.          11231054
112320     MOVE IMCNTK-DCONSLR-SCAC-ID    TO PV-PREV-DCONSLR-SCAC-ID.   11232058
112330     MOVE IMCNTK-DCONSLR-RET-TMST   TO PV-PREV-DCONSLR-RET-TMST.  11233058
112340     MOVE IMCNTK-MOM-POL-CDE        TO PV-PREV-MOM-POL-CDE.       11234069
112350     MOVE IMCNTK-FDR-POL-CDE        TO PV-PREV-FDR-POL-CDE.       11235069
112360     MOVE IMCNTK-MOM-POR-CDE        TO PV-PREV-MOM-POR-CDE.       11236063
112370     MOVE IMCNTK-FDR-POR-CDE        TO PV-PREV-FDR-POR-CDE.       11237063
112400                                                                  11240031
112500*----------------------------------------------------------------*11250033
112600* MOVE SELECTED TIMCSCN VALUES TO HOLD FIELDS FOR COMPARISON.    *11260033
112700* THE PROCESSING FOR THE TIMCSCN/TAUCSCN REQUIRES CURSORS FOR    *11270034
112800* BOTH TABLES. THE PROCESSING FOR TIMCNTK/TAUCNTK IS DIFFERENT   *11280034
112900* BECAUSE ONLY A SELECT IS DONE ON TIMCNTK WITH A CURSOR FOR     *11290034
113000* TAUCNTK. EVEN THOUGH THIS PARAGRAPH ONLY HAS ONE MOVE IN IT,   *11300034
113100* I USE IT TO ATTEMPT TO PRESERVE THE INITIAL STRUCTURE OF THE   *11310034
113200* PROGRAM LOGIC.                                                 *11320034
113300*----------------------------------------------------------------*11330033
113400 4045-MOVE-TIMCSCN-TO-HOLD.                                       11340033
113500                                                                  11350033
113600     MOVE IMCSCN-DO-TO-DCONSLR-TMST TO                            11360035
113610                 PV-PREV-DO-TO-DCONSLR-TMST.                      11361035
113620     MOVE IMCSCN-LAST-UPD-TMST      TO                            11362035
113630                 PV-PREV-LAST-UPD-TMST-2.                         11363035
113640     MOVE IMCSCN-LAST-UPD-BY-USR-ID TO                            11364035
113650                 PV-PREV-LAST-UPD-BY-USR-ID-2.                    11365035
113700                                                                  11370035
113800 EJECT                                                            11380035
113910*----------------------------------------------------------------*11391049
114000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *11400031
114100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *11410031
114200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *11420031
114300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *11430031
114400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *11440031
114500*                                                                *11450031
114600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *11460031
114700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *11470031
114800*    UPON INITIALIZATION.                                        *11480031
114900*----------------------------------------------------------------*11490031
115100 4300-READ-ITEMS-FROM-DB.                                         11510031
115200                                                                  11520031
115300     SET PS-END-OF-TIMCSCN-FETCHES-NO  TO TRUE.                   11530034
115400                                                                  11540034
115410     PERFORM 4301-OPEN-TIMCSCN-CSR.                               11541055
115420     PERFORM 4302-FETCH-TIMCSCN-CSR                               11542057
115430       UNTIL PS-END-OF-TIMCSCN-FETCHES.                           11543057
115440     PERFORM 4306-CLOSE-TIMCSCN-CURSOR.                           11544055
115450                                                                  11545055
115500     PERFORM                                                      11550031
115600         VARYING PV-READ-COUNT                                    11560031
115700         FROM 1 BY 1                                              11570031
115800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    11580031
115900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         11590031
116000                                                                  11600035
116100*        PERFORM 4301-OPEN-TIMCSCN-CSR                            11610055
116200*        PERFORM 4302-FETCH-TIMCSCN-CSR                           11620055
116300*          UNTIL PS-END-OF-TIMCSCN-FETCHES                        11630055
116400*        PERFORM 4306-CLOSE-TIMCSCN-CURSOR                        11640055
116500                                                                  11650035
116600         PERFORM 4310-FETCH                                       11660031
116700                                                                  11670031
116800         IF  ASC-ITEMS-LEFT-ON-DB                                 11680031
116900             PERFORM 4330-CHECK-FOR-CHANGES                       11690031
117000         END-IF                                                   11700031
117100     END-PERFORM.                                                 11710031
117200                                                                  11720031
117300     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           11730031
117400         MOVE +1                       TO  ASC-BLK-SUB            11740031
117500         PERFORM 5100-WRITE-TEMP-STORAGE                          11750031
117600         ADD +1                        TO  ASC-BLK-SUB            11760031
117700         PERFORM 5100-WRITE-TEMP-STORAGE                          11770031
117800                                                                  11780031
117900         MOVE 1                        TO  ASC-BLK-SUB            11790031
118000                                           PV-BLOCK-NUMBER        11800031
118100         PERFORM 4410-READ-TEMP-STORAGE                           11810031
118200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             11820031
118300              MOVE 2                    TO  ASC-BLK-SUB           11830031
118400                                            PV-BLOCK-NUMBER       11840031
118500              PERFORM 4410-READ-TEMP-STORAGE                      11850031
118600         END-IF                                                   11860031
118700     END-IF.                                                      11870031
118800 EJECT                                                            11880031
118900*----------------------------------------------------------------*11890034
119000* OPEN THE CUSTOMS CONTAINER CURSOR.                             *11900034
119100*----------------------------------------------------------------*11910034
119200 4301-OPEN-TIMCSCN-CSR.                                           11920034
119300                                                                  11930034
119400     EXEC SQL                                                     11940034
119500          OPEN TIMCSCN-CSR                                        11950034
119600     END-EXEC.                                                    11960034
119700                                                                  11970034
119800     EVALUATE TRUE                                                11980034
119900         WHEN SQLCODE = ZERO                                      11990034
120000              CONTINUE                                            12000034
120100         WHEN SQLWARN0 NOT EQUAL SPACE                            12010034
120200         WHEN SQLCODE NOT EQUAL ZERO                              12020034
120300              MOVE '4301-OPEN-TIMCSCN-CSR'                        12030034
120400                           TO  DP013-PARAGRAPH                    12040034
120500              MOVE 'OPEN TIMCSCN-CSR CURSOR'                      12050034
120600                           TO  DP013-MESSAGE-TEXT (1)             12060034
120700              MOVE SQLCA   TO  DP013-SQLCA                        12070034
120800              SET DP013-DB2-ABEND                                 12080034
120900                           TO  TRUE                               12090034
121000              PERFORM DP013-0000-PROCESS-ABEND                    12100034
121100     END-EVALUATE.                                                12110034
121200                                                                  12120034
121300 EJECT                                                            12130034
121400*----------------------------------------------------------------*12140031
121500*    FETCH THE TIMCSCN-CSR CURSOR.                               *12150035
121600*----------------------------------------------------------------*12160031
121700 4302-FETCH-TIMCSCN-CSR.                                          12170035
122000                                                                  12200035
122010     SET PS-END-OF-TAUCSCN-FETCHES-NO  TO TRUE.                   12201045
122011     INITIALIZE PV-CURRENT-AUDIT-ENTR-ID.                         12201151
122020                                                                  12202045
122100     PERFORM                                                      12210031
122200         WITH TEST AFTER                                          12220031
122300         VARYING PV-SQL-SUB                                       12230031
122400         FROM 1 BY 1                                              12240031
122500         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             12250031
122600            OR SQLCODE = 0                                        12260031
122700            OR SQLCODE = +100                                     12270031
122800                                                                  12280031
122900         EXEC SQL                                                 12290031
123000              FETCH TIMCSCN-CSR                                   12300035
123100              INTO :IMCSCN-DO-TO-DCONSLR-TMST,                    12310047
123110                   :IMCSCN-CSTM-ENTR-ID,                          12311053
123111                   :IMCSCN-LAST-UPD-TMST,                         12311153
123120                   :IMCSCN-LAST-UPD-BY-USR-ID                     12312048
123200         END-EXEC                                                 12320031
123300                                                                  12330031
123400         EVALUATE TRUE                                            12340031
123500             WHEN SQLCODE = ZERO                                  12350031
123510                  MOVE IMCSCN-CSTM-ENTR-ID TO                     12351053
123520                         PV-CURRENT-AUDIT-ENTR-ID                 12352053
123600                  PERFORM 4045-MOVE-TIMCSCN-TO-HOLD               12360035
123700                  PERFORM 4303-OPEN-TAUCSCN-CSR                   12370035
123800                  PERFORM 4304-FETCH-TAUCSCN-CSR                  12380035
123900                    UNTIL PS-END-OF-TAUCSCN-FETCHES               12390035
124000                  PERFORM 4305-CLOSE-TAUCSCN-CURSOR               12400043
124100             WHEN SQLCODE = +100                                  12410031
124200                  SET PS-END-OF-TIMCSCN-FETCHES TO TRUE           12420035
124300             WHEN SQLCODE = -904                                  12430031
124400             WHEN SQLCODE = -913                                  12440031
124500                  CONTINUE                                        12450035
124600             WHEN SQLWARN0 NOT EQUAL SPACE                        12460031
124700             WHEN SQLCODE NOT EQUAL ZERO                          12470031
124800                  MOVE '4302-FETCH-TIMCSCN-CSR'                   12480035
124900                               TO  DP013-PARAGRAPH                12490031
125000                  MOVE 'FETCH TIMCSCN-CSR CURSOR'                 12500035
125100                               TO  DP013-MESSAGE-TEXT (1)         12510031
125200                  MOVE SQLCA   TO  DP013-SQLCA                    12520031
125300                  SET DP013-DB2-ABEND                             12530031
125400                               TO  TRUE                           12540031
125500                  PERFORM DP013-0000-PROCESS-ABEND                12550031
125600         END-EVALUATE                                             12560031
125700     END-PERFORM.                                                 12570031
125800                                                                  12580031
125900     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   12590031
126000         MOVE '4302-FETCH-TIMCSCN-CSR'                            12600035
126100                               TO  DP013-PARAGRAPH                12610031
126200         MOVE 'MAX RETRIES EXCEEDED FOR FETCH TIMCSCN-CSR CURSOR' 12620035
126300                               TO  DP013-MESSAGE-TEXT (1)         12630031
126400         MOVE SQLCA            TO  DP013-SQLCA                    12640031
126500         SET DP013-DB2-ABEND   TO  TRUE                           12650031
126600         PERFORM DP013-0000-PROCESS-ABEND                         12660031
126700     END-IF.                                                      12670031
126800                                                                  12680031
126900     IF  SQLCODE EQUAL +100                                       12690031
127000         SET PS-END-OF-TIMCSCN-FETCHES TO TRUE                    12700035
127100     END-IF.                                                      12710031
127200                                                                  12720031
127300 EJECT                                                            12730031
127400*----------------------------------------------------------------*12740035
127500* OPEN THE CUSTOMS CONTAINER AUDIT CURSOR.                       *12750035
127600*----------------------------------------------------------------*12760035
127700 4303-OPEN-TAUCSCN-CSR.                                           12770035
127800                                                                  12780035
127900     EXEC SQL                                                     12790035
128000          OPEN TAUCSCN-CSR                                        12800035
128100     END-EXEC.                                                    12810035
128200                                                                  12820035
128300     EVALUATE TRUE                                                12830035
128400         WHEN SQLCODE = ZERO                                      12840035
128500              CONTINUE                                            12850035
128600         WHEN SQLWARN0 NOT EQUAL SPACE                            12860035
128700         WHEN SQLCODE NOT EQUAL ZERO                              12870035
128800              MOVE '4303-OPEN-TAUCSCN-CSR'                        12880035
128900                           TO  DP013-PARAGRAPH                    12890035
129000              MOVE 'OPEN TAUCSCN-CSR CURSOR'                      12900035
129100                           TO  DP013-MESSAGE-TEXT (1)             12910035
129200              MOVE SQLCA   TO  DP013-SQLCA                        12920035
129300              SET DP013-DB2-ABEND                                 12930035
129400                           TO  TRUE                               12940035
129500              PERFORM DP013-0000-PROCESS-ABEND                    12950035
129600     END-EVALUATE.                                                12960035
129700                                                                  12970035
129800 EJECT                                                            12980035
129900*----------------------------------------------------------------*12990035
130000*    FETCH THE TAUCSCN-CSR CURSOR.                               *13000035
130100*----------------------------------------------------------------*13010035
130200 4304-FETCH-TAUCSCN-CSR.                                          13020035
130300                                                                  13030035
130600     PERFORM                                                      13060035
130700         WITH TEST AFTER                                          13070035
130800         VARYING PV-SQL-SUB                                       13080035
130900         FROM 1 BY 1                                              13090035
131000         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             13100035
131100            OR SQLCODE = 0                                        13110035
131200            OR SQLCODE = +100                                     13120035
131300                                                                  13130035
131400         EXEC SQL                                                 13140035
131500              FETCH TAUCSCN-CSR                                   13150035
131600              INTO :AUCSCN-DO-TO-DCONSLR-TMST,                    13160035
131601                   :AUCSCN-CSTM-ENTR-ID,                          13160151
131610                   :AUCSCN-LAST-UPD-TMST,                         13161046
131620                   :AUCSCN-LAST-UPD-BY-USR-ID                     13162046
131700         END-EXEC                                                 13170035
131800                                                                  13180035
131900         EVALUATE TRUE                                            13190035
132000             WHEN SQLCODE = ZERO                                  13200035
132010                  PERFORM 4329-CHECK-FOR-TAUCSCN-CHANGES          13201035
132600             WHEN SQLCODE = +100                                  13260035
132700                  SET PS-END-OF-TAUCSCN-FETCHES TO TRUE           13270035
132800             WHEN SQLCODE = -904                                  13280035
132900             WHEN SQLCODE = -913                                  13290035
133000                  CONTINUE                                        13300035
133100             WHEN SQLWARN0 NOT EQUAL SPACE                        13310035
133200             WHEN SQLCODE NOT EQUAL ZERO                          13320035
133300                  MOVE '4304-FETCH-TAUCSCN-CSR'                   13330035
133400                               TO  DP013-PARAGRAPH                13340035
133500                  MOVE 'FETCH TAUCSCN-CSR CURSOR'                 13350035
133600                               TO  DP013-MESSAGE-TEXT (1)         13360035
133700                  MOVE SQLCA   TO  DP013-SQLCA                    13370035
133800                  SET DP013-DB2-ABEND                             13380035
133900                               TO  TRUE                           13390035
134000                  PERFORM DP013-0000-PROCESS-ABEND                13400035
134100         END-EVALUATE                                             13410035
134200     END-PERFORM.                                                 13420035
134300                                                                  13430035
134400     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   13440035
134500         MOVE '4304-FETCH-TAUCSCN-CSR'                            13450035
134600                               TO  DP013-PARAGRAPH                13460035
134700         MOVE 'MAX RETRIES EXCEEDED FOR FETCH TAUCSCN-CSR CURSOR' 13470035
134800                               TO  DP013-MESSAGE-TEXT (1)         13480035
134900         MOVE SQLCA            TO  DP013-SQLCA                    13490035
135000         SET DP013-DB2-ABEND   TO  TRUE                           13500035
135100         PERFORM DP013-0000-PROCESS-ABEND                         13510035
135200     END-IF.                                                      13520035
135300                                                                  13530035
135800 EJECT                                                            13580035
135810*----------------------------------------------------------------*13581035
135820* CLOSE THE CUSTOMS CONTAINER AUDIT CURSOR.                      *13582035
135830*----------------------------------------------------------------*13583035
135850 4305-CLOSE-TAUCSCN-CURSOR.                                       13585035
135860                                                                  13586035
135870     EXEC SQL                                                     13587035
135880         CLOSE TAUCSCN-CSR                                        13588035
135890     END-EXEC.                                                    13589035
135891                                                                  13589135
135892     EVALUATE TRUE                                                13589235
135893         WHEN SQLCODE = ZERO                                      13589335
135894              CONTINUE                                            13589435
135895         WHEN SQLWARN0 NOT EQUAL SPACE                            13589535
135896         WHEN SQLCODE NOT EQUAL ZERO                              13589635
135897              MOVE '4305-CLOSE-TAUCSCN-CURSOR'                    13589735
135898                           TO  DP013-PARAGRAPH                    13589835
135899              MOVE 'CLOSE TAUCSCN-CSR CURSOR'                     13589935
135900                           TO  DP013-MESSAGE-TEXT (1)             13590035
135901              MOVE SQLCA   TO  DP013-SQLCA                        13590135
135902              SET DP013-DB2-ABEND                                 13590235
135903                           TO  TRUE                               13590335
135904              PERFORM DP013-0000-PROCESS-ABEND                    13590435
135905     END-EVALUATE.                                                13590535
135906                                                                  13590635
135907 EJECT                                                            13590735
135908*----------------------------------------------------------------*13590835
135909* CLOSE THE CUSTOMS CONTAINER CURSOR.                            *13590935
135910*----------------------------------------------------------------*13591035
135911 4306-CLOSE-TIMCSCN-CURSOR.                                       13591135
135912                                                                  13591235
135913     EXEC SQL                                                     13591335
135914         CLOSE TIMCSCN-CSR                                        13591435
135915     END-EXEC.                                                    13591535
135916                                                                  13591635
135917     EVALUATE TRUE                                                13591735
135918         WHEN SQLCODE = ZERO                                      13591835
135919              CONTINUE                                            13591935
135920         WHEN SQLWARN0 NOT EQUAL SPACE                            13592035
135921         WHEN SQLCODE NOT EQUAL ZERO                              13592135
135922              MOVE '4306-CLOSE-TIMCSCN-CURSOR'                    13592235
135923                           TO  DP013-PARAGRAPH                    13592335
135924              MOVE 'CLOSE TIMCSCN-CSR CURSOR'                     13592435
135925                           TO  DP013-MESSAGE-TEXT (1)             13592535
135926              MOVE SQLCA   TO  DP013-SQLCA                        13592635
135927              SET DP013-DB2-ABEND                                 13592735
135928                           TO  TRUE                               13592835
135929              PERFORM DP013-0000-PROCESS-ABEND                    13592935
135930     END-EVALUATE.                                                13593035
135931                                                                  13593135
135932 EJECT                                                            13593235
135940*----------------------------------------------------------------*13594035
136000*    FETCH THE CONTAINER CURSOR.                                 *13600035
136100*----------------------------------------------------------------*13610035
136300 4310-FETCH.                                                      13630035
136400                                                                  13640035
136500     PERFORM                                                      13650035
136600         WITH TEST AFTER                                          13660035
136700         VARYING PV-SQL-SUB                                       13670035
136800         FROM 1 BY 1                                              13680035
136900         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             13690035
137000            OR SQLCODE = 0                                        13700035
137100            OR SQLCODE = +100                                     13710035
137200                                                                  13720035
137300         EXEC SQL                                                 13730035
137400              FETCH CONTNR-CSR                                    13740035
137500              INTO :AUCNTK-CONSLR-SCAC-ID,                        13750035
137600                   :AUCNTK-MOM-IMPRT-TRIP-ID,                     13760035
137700                   :AUCNTK-MOM-DPRTR-TMST,                        13770035
137800                   :AUCNTK-MOM-POE-DELY-TMST,                     13780035
137900                   :AUCNTK-MOM-CARR-SCAC-ID,                      13790035
138000                   :AUCNTK-MOM-FOB-CDE,                           13800069
138100                   :AUCNTK-MOM-IMPRT-VEH-NM,                      13810035
138200                   :AUCNTK-MOM-TRIP-TYP-CDE,                      13820035
138300                   :AUCNTK-MOM-DEST-POE-CDE,                      13830035
138400                   :AUCNTK-FDR-IMPRT-TRIP-ID,                     13840035
138500                   :AUCNTK-FDR-DPRTR-TMST,                        13850035
138600                   :AUCNTK-FDR-POE-DELY-TMST,                     13860035
138700                   :AUCNTK-FDR-CARR-SCAC-ID,                      13870035
138800                   :AUCNTK-FDR-FOB-CDE,                           13880069
138900                   :AUCNTK-FDR-IMPRT-VEH-NM,                      13890035
139000                   :AUCNTK-FDR-TRIP-TYP-CDE,                      13900035
139100                   :AUCNTK-FDR-DEST-POE-CDE,                      13910035
139200                   :AUCNTK-SIZE-CDE,                              13920035
139300                   :AUCNTK-CART-CNT,                              13930035
139400                   :AUCNTK-CBMT-QTY,                              13940035
139500                   :AUCNTK-WT-KGRM-QTY,                           13950035
139600                   :AUCNTK-UNT-QTY,                               13960035
139900                   :AUCNTK-ORGN-SHPD-FR-CDE,                      13990035
140000                   :AUCNTK-ORGN-SHPD-TO-CDE,                      14000035
140100                   :AUCNTK-EST-LBD-NM,                            14010035
140200                   :AUCNTK-EST-LBD-TMST,                          14020035
140300                   :AUCNTK-RISU-DO-RSN-CDE,                       14030035
140400                   :AUCNTK-BKR-FRGT-RLSE-TMST,                    14040035
140600                   :AUCNTK-DO-RCVD-TMST,                          14060035
140700                   :AUCNTK-CONTNR-PU-TMST,                        14070035
140800                   :AUCNTK-DAT-SRC-ENT-ID,                        14080035
140900                   :AUCNTK-LAST-UPD-BY-USR-ID,                    14090035
141000                   :AUCNTK-LAST-UPD-TMST,                         14100035
141100                   :AUCNTK-ACTL-POE-DELY-TMST,                    14110035
141200                   :AUCNTK-ACTL-DEST-POE-CDE,                     14120035
141300                   :AUCNTK-ACTL-LBD-NM,                           14130035
141400                   :AUCNTK-ACTL-LBD-TMST,                         14140054
141410                   :AUCNTK-DVN-TMST,                              14141058
141420                   :AUCNTK-DCONSLR-SCAC-ID,                       14142058
141430                   :AUCNTK-DCONSLR-RET-TMST,                      14143060
141440                   :AUCNTK-MOM-POL-CDE,                           14144069
141450                   :AUCNTK-FDR-POL-CDE,                           14145069
141460                   :AUCNTK-MOM-POR-CDE,                           14146060
141470                   :AUCNTK-FDR-POR-CDE                            14147060
141500         END-EXEC                                                 14150035
141600                                                                  14160035
141700         EVALUATE TRUE                                            14170035
141800             WHEN SQLCODE = ZERO                                  14180035
141900             WHEN SQLCODE = +100                                  14190035
142000             WHEN SQLCODE = -904                                  14200035
142100             WHEN SQLCODE = -913                                  14210035
142200                  CONTINUE                                        14220035
142300             WHEN SQLWARN0 NOT EQUAL SPACE                        14230035
142400             WHEN SQLCODE NOT EQUAL ZERO                          14240035
142500                  MOVE '4310-FETCH-CURSOR'                        14250035
142600                               TO  DP013-PARAGRAPH                14260035
142700                  MOVE 'FETCH PO CURSOR'                          14270035
142800                               TO  DP013-MESSAGE-TEXT (1)         14280035
142900                  MOVE SQLCA   TO  DP013-SQLCA                    14290035
143000                  SET DP013-DB2-ABEND                             14300035
143100                               TO  TRUE                           14310035
143200                  PERFORM DP013-0000-PROCESS-ABEND                14320035
143300         END-EVALUATE                                             14330035
143400     END-PERFORM.                                                 14340035
143500                                                                  14350035
143600     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   14360035
143700         MOVE '4310-FETCH'                                        14370035
143800                               TO  DP013-PARAGRAPH                14380035
143900         MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             14390035
144000                               TO  DP013-MESSAGE-TEXT (1)         14400035
144100         MOVE SQLCA            TO  DP013-SQLCA                    14410035
144200         SET DP013-DB2-ABEND   TO  TRUE                           14420035
144300         PERFORM DP013-0000-PROCESS-ABEND                         14430035
144400     END-IF.                                                      14440035
144500                                                                  14450035
144600     IF  SQLCODE EQUAL +100                                       14460035
144700         SET ASC-NO-ITEMS-LEFT-ON-DB                              14470035
144800                               TO  TRUE                           14480035
144900     END-IF.                                                      14490035
145000                                                                  14500035
145100 EJECT                                                            14510035
145200*----------------------------------------------------------------*14520031
145300*    GET THE CORRECT SUBSCRIPTS FOR PLACING THE TEXT LINE.       *14530031
145400*----------------------------------------------------------------*14540031
145500                                                                  14550031
145600 4320-GET-SUB.                                                    14560031
145700                                                                  14570031
145800     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        14580031
145900         ADD +1            TO  ASC-ITEM-SUB                       14590031
146000     ELSE                                                         14600031
146100         ADD +1            TO  ASC-BLK-SUB                        14610031
146200         MOVE +1           TO  ASC-ITEM-SUB                       14620031
146300                                                                  14630031
146400         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 14640031
146500             MOVE +1       TO  ASC-BLK-SUB                        14650031
146600             PERFORM 5100-WRITE-TEMP-STORAGE                      14660031
146700             MOVE ASC-BLOCK-ENTRIES                               14670031
146800                       (PC-MAX-BLOCKS-IN-ARRAY)                   14680031
146900             TO   ASC-BLOCK-ENTRIES(ASC-BLK-SUB)                  14690031
147000             ADD +1        TO  ASC-BLK-SUB                        14700031
147100             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           14710031
147200         END-IF                                                   14720031
147300     END-IF.                                                      14730031
147400                                                                  14740031
147500     ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               14750031
147600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        14760031
147700                                      (ASC-BLK-SUB                14770031
147800                                       ASC-ITEM-SUB).             14780031
147900                                                                  14790031
148000*----------------------------------------------------------------*14800031
148100*    COMPARE THE PREVIOUS VALUES TO THE CURRENT TAUCSCN VALUES   *14810035
148200*    TO SEE WHAT CHANGES OCCURRED.                               *14820031
148300*----------------------------------------------------------------*14830031
148400 4329-CHECK-FOR-TAUCSCN-CHANGES.                                  14840035
148500                                                                  14850031
148510     IF AUCSCN-DO-TO-DCONSLR-TMST                                 14851035
148511                            NOT EQUAL PV-PREV-DO-TO-DCONSLR-TMST  14851143
148520         MOVE PV-PREV-DO-TO-DCONSLR-TMST TO PV-HOLD-TMST-UNFORMAT 14852035
148530         PERFORM 4350-FORMAT-TMST                                 14853035
148540         MOVE PV-TMST                    TO PV-HOLD-AFTER-VALUE   14854035
148550         MOVE AUCSCN-DO-TO-DCONSLR-TMST  TO PV-HOLD-TMST-UNFORMAT 14855035
148560         PERFORM 4350-FORMAT-TMST                                 14856035
148570         MOVE PV-TMST                    TO PV-HOLD-BEFORE-VALUE  14857035
148580         MOVE 'DO ISSUED DT        '     TO PV-HOLD-FIELD-NAME    14858035
148590         PERFORM 4339-PROCESS-TAUCSCN-CHANGES                     14859043
148591     END-IF.                                                      14859135
148592                                                                  14859235
182900     PERFORM 4344-MOVE-TAUCSCN-TO-HOLD.                           18290035
183000                                                                  18300031
183010*----------------------------------------------------------------*18301035
183020*    COMPARE THE PREVIOUS VALUES TO THE CURRENT TAUCNTK VALUES   *18302035
183030*    TO SEE WHAT CHANGES OCCURRED.                               *18303035
183040*----------------------------------------------------------------*18304035
183050 4330-CHECK-FOR-CHANGES.                                          18305035
183060                                                                  18306035
183100     IF AUCNTK-CONSLR-SCAC-ID NOT EQUAL PV-PREV-CONSLR-SCAC-ID    18310035
183101         MOVE PV-PREV-CONSLR-SCAC-ID    TO PV-HOLD-AFTER-VALUE    18310135
183102         MOVE AUCNTK-CONSLR-SCAC-ID     TO PV-HOLD-BEFORE-VALUE   18310235
183103         MOVE 'CONSLR SCAC         '    TO PV-HOLD-FIELD-NAME     18310335
183104         PERFORM 4340-PROCESS-CHANGES                             18310435
183105     END-IF.                                                      18310535
183106                                                                  18310635
183107     IF AUCNTK-MOM-IMPRT-TRIP-ID NOT EQUAL                        18310735
183108                                 PV-PREV-MOM-IMPRT-TRIP-ID        18310835
183109         MOVE PV-PREV-MOM-IMPRT-TRIP-ID TO PV-HOLD-AFTER-VALUE    18310935
183110         MOVE AUCNTK-MOM-IMPRT-TRIP-ID  TO PV-HOLD-BEFORE-VALUE   18311035
183111         MOVE 'MTHR VOYAGE NO      '    TO PV-HOLD-FIELD-NAME     18311135
183112         PERFORM 4340-PROCESS-CHANGES                             18311235
183113     END-IF.                                                      18311335
183114                                                                  18311435
183115     IF AUCNTK-MOM-DPRTR-TMST NOT EQUAL PV-PREV-MOM-DPRTR-TMST    18311535
183116         MOVE PV-PREV-MOM-DPRTR-TMST    TO PV-HOLD-TMST-UNFORMAT  18311635
183117         PERFORM 4350-FORMAT-TMST                                 18311735
183118         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18311835
183119         MOVE AUCNTK-MOM-DPRTR-TMST     TO PV-HOLD-TMST-UNFORMAT  18311935
183120         PERFORM 4350-FORMAT-TMST                                 18312035
183121         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18312135
183122         MOVE 'MTHR ATD            '    TO PV-HOLD-FIELD-NAME     18312235
183123         PERFORM 4340-PROCESS-CHANGES                             18312335
183124     END-IF.                                                      18312435
183125                                                                  18312535
183126     IF AUCNTK-MOM-POE-DELY-TMST NOT EQUAL                        18312635
183127                                 PV-PREV-MOM-POE-DELY-TMST        18312735
183128         MOVE PV-PREV-MOM-POE-DELY-TMST TO PV-HOLD-TMST-UNFORMAT  18312835
183129         PERFORM 4350-FORMAT-TMST                                 18312935
183130         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18313035
183131         MOVE AUCNTK-MOM-POE-DELY-TMST  TO PV-HOLD-TMST-UNFORMAT  18313135
183132         PERFORM 4350-FORMAT-TMST                                 18313235
183133         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18313335
183134         MOVE 'MTHR ETA            '    TO PV-HOLD-FIELD-NAME     18313435
183135         PERFORM 4340-PROCESS-CHANGES                             18313535
183136     END-IF.                                                      18313635
183137                                                                  18313735
183138     IF AUCNTK-MOM-CARR-SCAC-ID NOT EQUAL                         18313835
183139                                PV-PREV-MOM-CARR-SCAC-ID          18313935
183140         MOVE PV-PREV-MOM-CARR-SCAC-ID  TO PV-HOLD-AFTER-VALUE    18314035
183141         MOVE AUCNTK-MOM-CARR-SCAC-ID   TO PV-HOLD-BEFORE-VALUE   18314135
183142         MOVE 'MTHR CARRIER SCAC   '    TO PV-HOLD-FIELD-NAME     18314235
183143         PERFORM 4340-PROCESS-CHANGES                             18314335
183144     END-IF.                                                      18314435
183145                                                                  18314535
183146     IF AUCNTK-MOM-POL-CDE NOT EQUAL PV-PREV-MOM-POL-CDE          18314635
183147         MOVE PV-PREV-MOM-POL-CDE       TO PV-HOLD-AFTER-VALUE    18314735
183148         MOVE AUCNTK-MOM-POL-CDE        TO PV-HOLD-BEFORE-VALUE   18314835
183149         MOVE 'MTHR POL            '    TO PV-HOLD-FIELD-NAME     18314966
183150         PERFORM 4340-PROCESS-CHANGES                             18315035
183151     END-IF.                                                      18315135
183152                                                                  18315235
183153     IF AUCNTK-MOM-IMPRT-VEH-NM NOT EQUAL                         18315335
183154                                PV-PREV-MOM-IMPRT-VEH-NM          18315435
183155         MOVE PV-PREV-MOM-IMPRT-VEH-NM  TO PV-HOLD-AFTER-VALUE    18315535
183156         MOVE AUCNTK-MOM-IMPRT-VEH-NM   TO PV-HOLD-BEFORE-VALUE   18315635
183157         MOVE 'MTHR VESSEL         '    TO PV-HOLD-FIELD-NAME     18315735
183158         PERFORM 4340-PROCESS-CHANGES                             18315835
183159     END-IF.                                                      18315935
183160                                                                  18316035
183161     IF AUCNTK-MOM-TRIP-TYP-CDE NOT EQUAL                         18316135
183162                                PV-PREV-MOM-TRIP-TYP-CDE          18316235
183163         MOVE PV-PREV-MOM-TRIP-TYP-CDE  TO PV-HOLD-AFTER-VALUE    18316335
183164         MOVE AUCNTK-MOM-TRIP-TYP-CDE   TO PV-HOLD-BEFORE-VALUE   18316435
183165         MOVE 'MTHR TRIP TYPE      '    TO PV-HOLD-FIELD-NAME     18316535
183166         PERFORM 4340-PROCESS-CHANGES                             18316635
183167     END-IF.                                                      18316735
183168                                                                  18316835
183169     IF AUCNTK-MOM-DEST-POE-CDE NOT EQUAL                         18316935
183170                                PV-PREV-MOM-DEST-POE-CDE          18317035
183171         MOVE PV-PREV-MOM-DEST-POE-CDE  TO PV-HOLD-AFTER-VALUE    18317135
183172         MOVE AUCNTK-MOM-DEST-POE-CDE   TO PV-HOLD-BEFORE-VALUE   18317235
183173         MOVE 'MTHR POE CDE        '    TO PV-HOLD-FIELD-NAME     18317335
183174         PERFORM 4340-PROCESS-CHANGES                             18317435
183175     END-IF.                                                      18317535
183176                                                                  18317635
183177     IF AUCNTK-FDR-IMPRT-TRIP-ID NOT EQUAL                        18317735
183178                                 PV-PREV-FDR-IMPRT-TRIP-ID        18317835
183179         MOVE PV-PREV-FDR-IMPRT-TRIP-ID TO PV-HOLD-AFTER-VALUE    18317935
183180         MOVE AUCNTK-FDR-IMPRT-TRIP-ID  TO PV-HOLD-BEFORE-VALUE   18318035
183181         MOVE 'FDR VOYAGE NO       '    TO PV-HOLD-FIELD-NAME     18318135
183182         PERFORM 4340-PROCESS-CHANGES                             18318235
183183     END-IF.                                                      18318335
183184                                                                  18318435
183185     IF AUCNTK-FDR-DPRTR-TMST NOT EQUAL PV-PREV-FDR-DPRTR-TMST    18318535
183186         MOVE PV-PREV-FDR-DPRTR-TMST    TO PV-HOLD-TMST-UNFORMAT  18318635
183187         PERFORM 4350-FORMAT-TMST                                 18318735
183188         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18318835
183189         MOVE AUCNTK-FDR-DPRTR-TMST     TO PV-HOLD-TMST-UNFORMAT  18318935
183190         PERFORM 4350-FORMAT-TMST                                 18319035
183191         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18319135
183192         MOVE 'FDR ATD             '    TO PV-HOLD-FIELD-NAME     18319235
183193         PERFORM 4340-PROCESS-CHANGES                             18319335
183194     END-IF.                                                      18319435
183195                                                                  18319535
183196     IF AUCNTK-FDR-POE-DELY-TMST NOT EQUAL                        18319635
183197                                 PV-PREV-FDR-POE-DELY-TMST        18319735
183198         MOVE PV-PREV-FDR-DPRTR-TMST    TO PV-HOLD-TMST-UNFORMAT  18319835
183199         PERFORM 4350-FORMAT-TMST                                 18319935
183200         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18320035
183201         MOVE AUCNTK-FDR-POE-DELY-TMST  TO PV-HOLD-TMST-UNFORMAT  18320135
183202         PERFORM 4350-FORMAT-TMST                                 18320235
183203         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18320335
183204         MOVE 'FDR ETA             '    TO PV-HOLD-FIELD-NAME     18320435
183205         PERFORM 4340-PROCESS-CHANGES                             18320535
183206     END-IF.                                                      18320635
183207                                                                  18320735
183208     IF AUCNTK-FDR-CARR-SCAC-ID NOT EQUAL                         18320835
183209                                PV-PREV-FDR-CARR-SCAC-ID          18320935
183210         MOVE PV-PREV-FDR-CARR-SCAC-ID  TO PV-HOLD-AFTER-VALUE    18321035
183211         MOVE AUCNTK-FDR-CARR-SCAC-ID   TO PV-HOLD-BEFORE-VALUE   18321135
183212         MOVE 'FDR CARRIER SCAC    '    TO PV-HOLD-FIELD-NAME     18321235
183213         PERFORM 4340-PROCESS-CHANGES                             18321335
183214     END-IF.                                                      18321435
183215                                                                  18321535
183216     IF AUCNTK-FDR-POL-CDE NOT EQUAL PV-PREV-FDR-POL-CDE          18321635
183217         MOVE PV-PREV-FDR-POL-CDE       TO PV-HOLD-AFTER-VALUE    18321735
183218         MOVE AUCNTK-FDR-POL-CDE        TO PV-HOLD-BEFORE-VALUE   18321835
183219         MOVE 'FDR POL             '    TO PV-HOLD-FIELD-NAME     18321966
183220         PERFORM 4340-PROCESS-CHANGES                             18322035
183221     END-IF.                                                      18322135
183222                                                                  18322235
183223     IF AUCNTK-FDR-IMPRT-VEH-NM NOT EQUAL                         18322335
183224                                PV-PREV-FDR-IMPRT-VEH-NM          18322435
183225         MOVE PV-PREV-FDR-IMPRT-VEH-NM  TO PV-HOLD-AFTER-VALUE    18322535
183226         MOVE AUCNTK-FDR-IMPRT-VEH-NM   TO PV-HOLD-BEFORE-VALUE   18322635
183227         MOVE 'FDR VESSEL          '    TO PV-HOLD-FIELD-NAME     18322735
183228         PERFORM 4340-PROCESS-CHANGES                             18322835
183229     END-IF.                                                      18322935
183230                                                                  18323035
183231     IF AUCNTK-FDR-TRIP-TYP-CDE NOT EQUAL                         18323135
183232                                PV-PREV-FDR-TRIP-TYP-CDE          18323235
183233         MOVE PV-PREV-FDR-TRIP-TYP-CDE  TO PV-HOLD-AFTER-VALUE    18323335
183234         MOVE AUCNTK-FDR-TRIP-TYP-CDE   TO PV-HOLD-BEFORE-VALUE   18323435
183235         MOVE 'FDR TRIP TYPE       '    TO PV-HOLD-FIELD-NAME     18323535
183236         PERFORM 4340-PROCESS-CHANGES                             18323635
183237     END-IF.                                                      18323735
183238                                                                  18323835
183239     IF AUCNTK-FDR-DEST-POE-CDE NOT EQUAL                         18323935
183240                                PV-PREV-FDR-DEST-POE-CDE          18324035
183241         MOVE PV-PREV-FDR-DEST-POE-CDE  TO PV-HOLD-AFTER-VALUE    18324135
183242         MOVE AUCNTK-FDR-DEST-POE-CDE   TO PV-HOLD-BEFORE-VALUE   18324235
183243         MOVE 'FDR POE CDE         '    TO PV-HOLD-FIELD-NAME     18324335
183244         PERFORM 4340-PROCESS-CHANGES                             18324435
183245     END-IF.                                                      18324535
183246                                                                  18324635
183247     IF AUCNTK-SIZE-CDE NOT EQUAL PV-PREV-SIZE-CDE                18324735
183248         MOVE PV-PREV-SIZE-CDE          TO PV-HOLD-AFTER-VALUE    18324835
183249         MOVE AUCNTK-SIZE-CDE           TO PV-HOLD-BEFORE-VALUE   18324935
183250         MOVE 'SIZE                '    TO PV-HOLD-FIELD-NAME     18325035
183251         PERFORM 4340-PROCESS-CHANGES                             18325135
183252     END-IF.                                                      18325235
183253                                                                  18325335
183254     IF AUCNTK-CART-CNT NOT EQUAL PV-PREV-CART-CNT                18325435
183255         MOVE PV-PREV-CART-CNT          TO PV-HOLD-AFTER-VALUE-N  18325535
183256         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    18325635
183257         MOVE AUCNTK-CART-CNT           TO PV-HOLD-BEFORE-VALUE-N 18325735
183258         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   18325835
183259         MOVE 'CTN                 '    TO PV-HOLD-FIELD-NAME     18325935
183260         PERFORM 4340-PROCESS-CHANGES                             18326035
183261     END-IF.                                                      18326135
183262                                                                  18326235
183263     IF AUCNTK-CBMT-QTY NOT EQUAL PV-PREV-CBMT-QTY                18326335
183264         MOVE PV-PREV-CBMT-QTY          TO PV-HOLD-AFTER-VALUE-V  18326435
183265         MOVE PV-HOLD-AFTER-VALUE-V     TO PV-HOLD-AFTER-VALUE    18326535
183266         MOVE AUCNTK-CBMT-QTY           TO PV-HOLD-BEFORE-VALUE-V 18326635
183267         MOVE PV-HOLD-BEFORE-VALUE-V    TO PV-HOLD-BEFORE-VALUE   18326735
183268         MOVE 'CBM                 '    TO PV-HOLD-FIELD-NAME     18326835
183269         PERFORM 4340-PROCESS-CHANGES                             18326935
183270     END-IF.                                                      18327035
183271                                                                  18327135
183272     IF AUCNTK-WT-KGRM-QTY NOT EQUAL PV-PREV-WT-KGRM-QTY          18327235
183273         MOVE PV-PREV-WT-KGRM-QTY       TO PV-HOLD-AFTER-VALUE-N  18327335
183274         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    18327435
183275         MOVE AUCNTK-WT-KGRM-QTY        TO PV-HOLD-BEFORE-VALUE-N 18327535
183276         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   18327635
183277         MOVE 'KGS                 '    TO PV-HOLD-FIELD-NAME     18327735
183278         PERFORM 4340-PROCESS-CHANGES                             18327835
183279     END-IF.                                                      18327935
183280                                                                  18328035
183281     IF AUCNTK-UNT-QTY NOT EQUAL PV-PREV-UNT-QTY                  18328135
183282         MOVE PV-PREV-UNT-QTY           TO PV-HOLD-AFTER-VALUE-N  18328235
183283         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    18328335
183284         MOVE AUCNTK-UNT-QTY            TO PV-HOLD-BEFORE-VALUE-N 18328435
183285         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   18328535
183286         MOVE 'UNITS               '    TO PV-HOLD-FIELD-NAME     18328635
183287         PERFORM 4340-PROCESS-CHANGES                             18328735
183288     END-IF.                                                      18328835
183289                                                                  18328935
183308     IF AUCNTK-ORGN-SHPD-FR-CDE NOT EQUAL                         18330835
183309                                PV-PREV-ORGN-SHPD-FR-CDE          18330935
183310         MOVE PV-PREV-ORGN-SHPD-FR-CDE  TO PV-HOLD-AFTER-VALUE    18331035
183311         MOVE AUCNTK-ORGN-SHPD-FR-CDE   TO PV-HOLD-BEFORE-VALUE   18331135
183312         MOVE 'ORGN SHPD FROM TYPE '    TO PV-HOLD-FIELD-NAME     18331235
183313         PERFORM 4340-PROCESS-CHANGES                             18331335
183314     END-IF.                                                      18331435
183315                                                                  18331535
183316     IF AUCNTK-ORGN-SHPD-TO-CDE NOT EQUAL                         18331635
183317                                PV-PREV-ORGN-SHPD-TO-CDE          18331735
183318         MOVE PV-PREV-ORGN-SHPD-TO-CDE  TO PV-HOLD-AFTER-VALUE    18331835
183319         MOVE AUCNTK-ORGN-SHPD-TO-CDE   TO PV-HOLD-BEFORE-VALUE   18331935
183320         MOVE 'DEST SHPD TO TYPE   '    TO PV-HOLD-FIELD-NAME     18332035
183321         PERFORM 4340-PROCESS-CHANGES                             18332135
183322     END-IF.                                                      18332235
183323                                                                  18332335
183324     IF AUCNTK-EST-LBD-NM NOT EQUAL PV-PREV-EST-LBD-NM            18332435
183325         MOVE PV-PREV-EST-LBD-NM        TO PV-HOLD-AFTER-VALUE    18332535
183326         MOVE AUCNTK-EST-LBD-NM         TO PV-HOLD-BEFORE-VALUE   18332635
183327         MOVE 'EST LBD NM          '    TO PV-HOLD-FIELD-NAME     18332735
183328         PERFORM 4340-PROCESS-CHANGES                             18332835
183329     END-IF.                                                      18332935
183330                                                                  18333035
183331     IF AUCNTK-EST-LBD-TMST NOT EQUAL PV-PREV-EST-LBD-TMST        18333135
183332         MOVE PV-PREV-EST-LBD-TMST      TO PV-HOLD-TMST-UNFORMAT  18333235
183333         PERFORM 4350-FORMAT-TMST                                 18333335
183334         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18333435
183335         MOVE AUCNTK-EST-LBD-TMST       TO PV-HOLD-TMST-UNFORMAT  18333535
183336         PERFORM 4350-FORMAT-TMST                                 18333635
183337         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18333735
183338         MOVE 'EST LBD DT          '    TO PV-HOLD-FIELD-NAME     18333835
183339         PERFORM 4340-PROCESS-CHANGES                             18333935
183340     END-IF.                                                      18334035
183341                                                                  18334135
183342     IF AUCNTK-RISU-DO-RSN-CDE NOT EQUAL                          18334235
183343                               PV-PREV-RISU-DO-RSN-CDE            18334335
183344         MOVE PV-PREV-RISU-DO-RSN-CDE   TO PV-HOLD-AFTER-VALUE    18334435
183345         MOVE AUCNTK-RISU-DO-RSN-CDE    TO PV-HOLD-BEFORE-VALUE   18334535
183346         MOVE 'RISU DO RSN CDE     '    TO PV-HOLD-FIELD-NAME     18334635
183347         PERFORM 4340-PROCESS-CHANGES                             18334735
183348     END-IF.                                                      18334835
183349                                                                  18334935
183350     IF AUCNTK-BKR-FRGT-RLSE-TMST NOT EQUAL                       18335035
183351                                  PV-PREV-BKR-FRGT-RLSE-TMST      18335135
183352         MOVE PV-PREV-BKR-FRGT-RLSE-TMST TO PV-HOLD-TMST-UNFORMAT 18335235
183353         PERFORM 4350-FORMAT-TMST                                 18335335
183354         MOVE PV-TMST                    TO PV-HOLD-AFTER-VALUE   18335435
183355         MOVE AUCNTK-BKR-FRGT-RLSE-TMST  TO PV-HOLD-TMST-UNFORMAT 18335535
183356         PERFORM 4350-FORMAT-TMST                                 18335635
183357         MOVE PV-TMST                    TO PV-HOLD-BEFORE-VALUE  18335735
183358         MOVE 'BKR FRGT RLSE DT    '     TO PV-HOLD-FIELD-NAME    18335835
183359         PERFORM 4340-PROCESS-CHANGES                             18335935
183360     END-IF.                                                      18336035
183361                                                                  18336135
183374     IF AUCNTK-DO-RCVD-TMST NOT EQUAL PV-PREV-DO-RCVD-TMST        18337435
183375         MOVE PV-PREV-DO-RCVD-TMST      TO PV-HOLD-TMST-UNFORMAT  18337535
183376         PERFORM 4350-FORMAT-TMST                                 18337635
183377         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18337735
183378         MOVE AUCNTK-DO-RCVD-TMST       TO PV-HOLD-TMST-UNFORMAT  18337835
183379         PERFORM 4350-FORMAT-TMST                                 18337935
183380         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18338035
183381         MOVE 'DO RCVD DT          '    TO PV-HOLD-FIELD-NAME     18338135
183382         PERFORM 4340-PROCESS-CHANGES                             18338235
183383     END-IF.                                                      18338335
183384                                                                  18338435
183385     IF AUCNTK-CONTNR-PU-TMST NOT EQUAL PV-PREV-CONTNR-PU-TMST    18338535
183386         MOVE PV-PREV-CONTNR-PU-TMST    TO PV-HOLD-TMST-UNFORMAT  18338635
183387         PERFORM 4350-FORMAT-TMST                                 18338735
183388         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18338835
183389         MOVE AUCNTK-CONTNR-PU-TMST     TO PV-HOLD-TMST-UNFORMAT  18338935
183390         PERFORM 4350-FORMAT-TMST                                 18339035
183391         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18339135
183392         MOVE 'CONTNR PU DT        '    TO PV-HOLD-FIELD-NAME     18339235
183393         PERFORM 4340-PROCESS-CHANGES                             18339335
183394     END-IF.                                                      18339435
183395                                                                  18339535
183396     IF AUCNTK-DAT-SRC-ENT-ID NOT EQUAL PV-PREV-DAT-SRC-ENT-ID    18339635
183397         MOVE PV-PREV-DAT-SRC-ENT-ID    TO PV-HOLD-AFTER-VALUE-N  18339735
183398         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    18339835
183399         MOVE AUCNTK-DAT-SRC-ENT-ID     TO PV-HOLD-BEFORE-VALUE-N 18339935
183400         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   18340035
183401         MOVE 'DATA SOURCE         '    TO PV-HOLD-FIELD-NAME     18340135
183402         PERFORM 4340-PROCESS-CHANGES                             18340235
183403     END-IF.                                                      18340335
183404                                                                  18340435
183405     IF AUCNTK-ACTL-POE-DELY-TMST NOT EQUAL                       18340535
183406                                  PV-PREV-ACTL-POE-DELY-TMST      18340635
183407         MOVE PV-PREV-ACTL-POE-DELY-TMST TO PV-HOLD-TMST-UNFORMAT 18340735
183408         PERFORM 4350-FORMAT-TMST                                 18340835
183409         MOVE PV-TMST                    TO PV-HOLD-AFTER-VALUE   18340935
183410         MOVE AUCNTK-ACTL-POE-DELY-TMST  TO PV-HOLD-TMST-UNFORMAT 18341035
183411         PERFORM 4350-FORMAT-TMST                                 18341135
183412         MOVE PV-TMST                    TO PV-HOLD-BEFORE-VALUE  18341235
183413         MOVE 'ATA                 '     TO PV-HOLD-FIELD-NAME    18341335
183414         PERFORM 4340-PROCESS-CHANGES                             18341435
183415     END-IF.                                                      18341535
183416                                                                  18341635
183417     IF AUCNTK-ACTL-DEST-POE-CDE NOT EQUAL                        18341735
183418                                 PV-PREV-ACTL-DEST-POE-CDE        18341835
183419         MOVE PV-PREV-ACTL-DEST-POE-CDE TO PV-HOLD-AFTER-VALUE    18341935
183420         MOVE AUCNTK-ACTL-DEST-POE-CDE  TO PV-HOLD-BEFORE-VALUE   18342035
183421         MOVE 'ACTL POE CDE        '    TO PV-HOLD-FIELD-NAME     18342135
183422         PERFORM 4340-PROCESS-CHANGES                             18342235
183423     END-IF.                                                      18342335
183424                                                                  18342435
183425     IF AUCNTK-ACTL-LBD-NM NOT EQUAL PV-PREV-ACTL-LBD-NM          18342535
183426         MOVE PV-PREV-ACTL-LBD-NM       TO PV-HOLD-AFTER-VALUE    18342635
183427         MOVE AUCNTK-ACTL-LBD-NM        TO PV-HOLD-BEFORE-VALUE   18342735
183428         MOVE 'ACTL LBD NM         '    TO PV-HOLD-FIELD-NAME     18342835
183429         PERFORM 4340-PROCESS-CHANGES                             18342935
183430     END-IF.                                                      18343035
183431                                                                  18343135
183432     IF AUCNTK-ACTL-LBD-TMST NOT EQUAL PV-PREV-ACTL-LBD-TMST      18343235
183433         MOVE PV-PREV-ACTL-LBD-TMST     TO PV-HOLD-TMST-UNFORMAT  18343335
183434         PERFORM 4350-FORMAT-TMST                                 18343435
183435         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18343535
183436         MOVE AUCNTK-ACTL-LBD-TMST      TO PV-HOLD-TMST-UNFORMAT  18343635
183437         PERFORM 4350-FORMAT-TMST                                 18343735
183438         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18343835
183439         MOVE 'ACTL LBD DT         '    TO PV-HOLD-FIELD-NAME     18343935
183440         PERFORM 4340-PROCESS-CHANGES                             18344035
183441     END-IF.                                                      18344135
183442                                                                  18344235
183443     IF AUCNTK-DVN-TMST      NOT EQUAL PV-PREV-DVN-TMST           18344354
183444         MOVE PV-PREV-DVN-TMST          TO PV-HOLD-TMST-UNFORMAT  18344454
183445         PERFORM 4350-FORMAT-TMST                                 18344554
183446         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18344654
183447         MOVE AUCNTK-DVN-TMST           TO PV-HOLD-TMST-UNFORMAT  18344754
183448         PERFORM 4350-FORMAT-TMST                                 18344854
183449         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18344954
183450         MOVE 'DEVAN DT            '    TO PV-HOLD-FIELD-NAME     18345054
183451         PERFORM 4340-PROCESS-CHANGES                             18345154
183452     END-IF.                                                      18345254
183453                                                                  18345354
183454     IF AUCNTK-DCONSLR-SCAC-ID  NOT EQUAL                         18345458
183455                                 PV-PREV-DCONSLR-SCAC-ID          18345558
183456         MOVE PV-PREV-DCONSLR-SCAC-ID   TO PV-HOLD-AFTER-VALUE    18345658
183457         MOVE AUCNTK-DCONSLR-SCAC-ID    TO PV-HOLD-BEFORE-VALUE   18345758
183458         MOVE 'DECONSLR SCAC       '    TO PV-HOLD-FIELD-NAME     18345858
183459         PERFORM 4340-PROCESS-CHANGES                             18345958
183460     END-IF.                                                      18346058
183461                                                                  18346158
183465     IF AUCNTK-DCONSLR-RET-TMST NOT EQUAL PV-PREV-DCONSLR-RET-TMST18346558
183466         MOVE PV-PREV-DCONSLR-RET-TMST  TO PV-HOLD-TMST-UNFORMAT  18346658
183467         PERFORM 4350-FORMAT-TMST                                 18346758
183468         MOVE PV-TMST                   TO PV-HOLD-AFTER-VALUE    18346858
183469         MOVE AUCNTK-DCONSLR-RET-TMST   TO PV-HOLD-TMST-UNFORMAT  18346959
183470         PERFORM 4350-FORMAT-TMST                                 18347058
183471         MOVE PV-TMST                   TO PV-HOLD-BEFORE-VALUE   18347158
183472         MOVE 'DECONSLR RET DT     '    TO PV-HOLD-FIELD-NAME     18347258
183473         PERFORM 4340-PROCESS-CHANGES                             18347358
183474     END-IF.                                                      18347458
183475                                                                  18347554
183476     IF AUCNTK-MOM-FOB-CDE      NOT EQUAL                         18348466
183477                                 PV-PREV-MOM-FOB-CDE              18348566
183478         MOVE PV-PREV-MOM-FOB-CDE       TO PV-HOLD-AFTER-VALUE    18348666
183479         MOVE AUCNTK-MOM-FOB-CDE        TO PV-HOLD-BEFORE-VALUE   18348766
183480         MOVE 'MTHR FOB            '    TO PV-HOLD-FIELD-NAME     18348866
183481         PERFORM 4340-PROCESS-CHANGES                             18348964
183482     END-IF.                                                      18349064
183483                                                                  18349164
183484     IF AUCNTK-FDR-FOB-CDE      NOT EQUAL                         18349266
183485                                 PV-PREV-FDR-FOB-CDE              18349366
183486         MOVE PV-PREV-FDR-FOB-CDE       TO PV-HOLD-AFTER-VALUE    18349466
183487         MOVE AUCNTK-FDR-FOB-CDE        TO PV-HOLD-BEFORE-VALUE   18349566
183488         MOVE 'FDR FOB             '    TO PV-HOLD-FIELD-NAME     18349666
183489         PERFORM 4340-PROCESS-CHANGES                             18349764
183490     END-IF.                                                      18349864
183491                                                                  18349964
183492     IF AUCNTK-MOM-POR-CDE      NOT EQUAL                         18350064
183493                                 PV-PREV-MOM-POR-CDE              18350164
183494         MOVE PV-PREV-MOM-POR-CDE       TO PV-HOLD-AFTER-VALUE    18350264
183495         MOVE AUCNTK-MOM-POR-CDE        TO PV-HOLD-BEFORE-VALUE   18350364
183496         MOVE 'MTHR POR            '    TO PV-HOLD-FIELD-NAME     18350464
183497         PERFORM 4340-PROCESS-CHANGES                             18350564
183498     END-IF.                                                      18350664
183499                                                                  18350764
183500     IF AUCNTK-FDR-POR-CDE      NOT EQUAL                         18350864
183501                                 PV-PREV-FDR-POR-CDE              18350964
183502         MOVE PV-PREV-FDR-POR-CDE       TO PV-HOLD-AFTER-VALUE    18351064
183503         MOVE AUCNTK-FDR-POR-CDE        TO PV-HOLD-BEFORE-VALUE   18351164
183504         MOVE 'FDR POR             '    TO PV-HOLD-FIELD-NAME     18351264
183505         PERFORM 4340-PROCESS-CHANGES                             18351364
183506     END-IF.                                                      18351464
183507                                                                  18351564
183508     PERFORM 4345-MOVE-TAUCNTK-TO-HOLD.                           18351664
183509                                                                  18351764
183510*----------------------------------------------------------------*18351864
183511*    FORMAT DATE AND TIME FROM LAST UPDATED TIMESTAMP.           *18351964
183512*    THIS PARAGRAPH IS ONLY FOR THE TIMCSCN COMPARES.            *18352064
183513*----------------------------------------------------------------*18352164
183514 4334-FORMAT-LAST-UPD-TMST-2.                                     18352264
183515                                                                  18353064
183600     IF PV-PREV-LAST-UPD-TMST-2(1:10) EQUAL PC-INIT-DATE          18360035
183700        MOVE SPACES                        TO PV-FORMAT-DATE      18370035
183800     ELSE                                                         18380031
183900        MOVE PV-PREV-LAST-UPD-TMST-2(9:2)  TO PV-FORMAT-DD        18390035
184000        MOVE PV-PREV-LAST-UPD-TMST-2(6:2)  TO PV-FORMAT-MM        18400035
184100        MOVE PV-PREV-LAST-UPD-TMST-2(3:2)  TO PV-FORMAT-YY        18410035
184200        MOVE PC-SLASH                      TO PV-FORMAT-SLASH1    18420035
184300                                              PV-FORMAT-SLASH2    18430035
184400     END-IF.                                                      18440031
184500                                                                  18450031
184600     IF PV-PREV-LAST-UPD-TMST-2(12:5) EQUAL PC-INIT-TIME          18460035
184700        MOVE SPACES                        TO PV-FORMAT-TIME      18470035
184800     ELSE                                                         18480031
184900        MOVE PV-PREV-LAST-UPD-TMST-2(12:2) TO PV-FORMAT-HOUR      18490035
185000        MOVE PV-PREV-LAST-UPD-TMST-2(15:2) TO PV-FORMAT-MIN       18500035
185100        MOVE PC-COLON                      TO PV-FORMAT-COLON     18510035
185200     END-IF.                                                      18520031
185300                                                                  18530031
185310*----------------------------------------------------------------*18531035
185320*    FORMAT DATE AND TIME FROM LAST UPDATED TIMESTAMP.           *18532035
185330*----------------------------------------------------------------*18533035
185340 4335-FORMAT-LAST-UPD-TMST.                                       18534035
185350                                                                  18535035
185360     IF PV-PREV-LAST-UPD-TMST(1:10) EQUAL PC-INIT-DATE            18536035
185370         MOVE SPACES                      TO PV-FORMAT-DATE       18537035
185380     ELSE                                                         18538035
185390         MOVE PV-PREV-LAST-UPD-TMST(9:2)  TO PV-FORMAT-DD         18539035
185391         MOVE PV-PREV-LAST-UPD-TMST(6:2)  TO PV-FORMAT-MM         18539135
185392         MOVE PV-PREV-LAST-UPD-TMST(3:2)  TO PV-FORMAT-YY         18539235
185393         MOVE PC-SLASH                    TO PV-FORMAT-SLASH1     18539335
185394                                             PV-FORMAT-SLASH2     18539435
185395     END-IF.                                                      18539535
185396                                                                  18539635
185397     IF PV-PREV-LAST-UPD-TMST(12:5) EQUAL PC-INIT-TIME            18539735
185398         MOVE SPACES                      TO PV-FORMAT-TIME       18539835
185399     ELSE                                                         18539935
185400         MOVE PV-PREV-LAST-UPD-TMST(12:2) TO PV-FORMAT-HOUR       18540035
185401         MOVE PV-PREV-LAST-UPD-TMST(15:2) TO PV-FORMAT-MIN        18540135
185402         MOVE PC-COLON                    TO PV-FORMAT-COLON      18540235
185403     END-IF.                                                      18540335
185404                                                                  18540435
185410*----------------------------------------------------------------*18541035
185500*    PROCESS THE CHANGES THAT WERE FOUND FOR THE AUDIT ROW.      *18550031
185510*    THIS PARA IS THE SAME AS 4340- EXCEPT THAT THE              *18551035
185520*    PV-PREV-LAST-UPD-BY-USR-ID-2 FOR THE TIMCSCN COMPARES       *18552035
185530*    NEEDED TO BE DIFFERENTIATED FROM THE SAME FIELD USED FOR    *18553035
185540*    THE TIMCNTK COMPARES. NOTICE THE -2 AFTER THE FIELD.        *18554035
185550*    THIS PARA ALSO PERFORMS 4334- INSTEAD OF 4335- AGAIN,       *18555035
185560*    THIS IS TO DIFFERENTIATE THE LAST UPD TMST FIELD.           *18556035
185600*----------------------------------------------------------------*18560031
185700 4339-PROCESS-TAUCSCN-CHANGES.                                    18570043
185800                                                                  18580031
185900     PERFORM 4320-GET-SUB.                                        18590031
186000                                                                  18600031
186100     MOVE PV-HOLD-FIELD-NAME   TO ASC-DATA                        18610031
186200                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18620031
186300     MOVE PV-PREV-LAST-UPD-BY-USR-ID-2 TO                         18630035
186400                                  ASC-USERID                      18640031
186500                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18650031
186600     PERFORM 4334-FORMAT-LAST-UPD-TMST-2.                         18660035
186700     MOVE PV-FORMAT-DATE       TO ASC-DATE                        18670031
186800                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18680031
186900     MOVE PV-FORMAT-TIME       TO ASC-TIME                        18690031
187000                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18700031
187100                                                                  18710031
187200     IF PV-HOLD-AFTER-VALUE = SPACES                              18720031
187300         MOVE 'NO DATA'            TO ASC-VALUE                   18730031
187400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18740031
187500     ELSE                                                         18750031
187600         MOVE PV-HOLD-AFTER-VALUE TO ASC-VALUE                    18760031
187700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18770031
187800     END-IF.                                                      18780031
187900                                                                  18790031
188000     PERFORM 4320-GET-SUB.                                        18800031
188100                                                                  18810031
188200     MOVE SPACES               TO ASC-DATA                        18820031
188300                                 (ASC-BLK-SUB ASC-ITEM-SUB)       18830031
188400                                  ASC-USERID                      18840031
188500                                 (ASC-BLK-SUB ASC-ITEM-SUB)       18850031
188600                                  ASC-DATE                        18860031
188700                                 (ASC-BLK-SUB ASC-ITEM-SUB)       18870031
188800                                  ASC-TIME                        18880031
188900                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18890031
189000                                                                  18900031
189100     IF PV-HOLD-BEFORE-VALUE = SPACES                             18910031
189200         MOVE 'NO DATA'            TO ASC-VALUE                   18920031
189300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18930031
189400     ELSE                                                         18940031
189500         MOVE PV-HOLD-BEFORE-VALUE  TO ASC-VALUE                  18950031
189600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18960031
189700     END-IF.                                                      18970031
189800                                                                  18980031
189810*----------------------------------------------------------------*18981035
189820*    PROCESS THE CHANGES THAT WERE FOUND FOR THE AUDIT ROW.      *18982035
189821*    THIS PROCESSING IS JUST FOR THE TIMCNTK COMPARES.           *18982135
189830*----------------------------------------------------------------*18983035
189840 4340-PROCESS-CHANGES.                                            18984035
189850                                                                  18985035
189860     PERFORM 4320-GET-SUB.                                        18986035
189870                                                                  18987035
189880     MOVE PV-HOLD-FIELD-NAME   TO ASC-DATA                        18988035
189890                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18989035
189891     MOVE PV-PREV-LAST-UPD-BY-USR-ID TO                           18989135
189892                                  ASC-USERID                      18989235
189893                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18989335
189894     PERFORM 4335-FORMAT-LAST-UPD-TMST.                           18989435
189895     MOVE PV-FORMAT-DATE       TO ASC-DATE                        18989535
189896                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18989635
189897     MOVE PV-FORMAT-TIME       TO ASC-TIME                        18989735
189898                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18989835
189899                                                                  18989935
189900     IF PV-HOLD-AFTER-VALUE = SPACES                              18990035
189901         MOVE 'NO DATA'            TO ASC-VALUE                   18990135
189902                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18990235
189903     ELSE                                                         18990335
189904         MOVE PV-HOLD-AFTER-VALUE TO ASC-VALUE                    18990435
189905                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18990535
189906     END-IF.                                                      18990635
189907                                                                  18990735
189908     PERFORM 4320-GET-SUB.                                        18990835
189909                                                                  18990935
189910     MOVE SPACES               TO ASC-DATA                        18991035
189911                                 (ASC-BLK-SUB ASC-ITEM-SUB)       18991135
189912                                  ASC-USERID                      18991235
189913                                 (ASC-BLK-SUB ASC-ITEM-SUB)       18991335
189914                                  ASC-DATE                        18991435
189915                                 (ASC-BLK-SUB ASC-ITEM-SUB)       18991535
189916                                  ASC-TIME                        18991635
189917                                 (ASC-BLK-SUB ASC-ITEM-SUB).      18991735
189918                                                                  18991835
189919     IF PV-HOLD-BEFORE-VALUE = SPACES                             18991935
189920         MOVE 'NO DATA'            TO ASC-VALUE                   18992035
189921                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18992135
189922     ELSE                                                         18992235
189923         MOVE PV-HOLD-BEFORE-VALUE  TO ASC-VALUE                  18992335
189924                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18992435
189925     END-IF.                                                      18992535
189926                                                                  18992635
189930*----------------------------------------------------------------*18993035
190000* MOVE TAUCSCN VALUES TO HOLD FIELDS FOR COMPARISON.             *19000035
190100*----------------------------------------------------------------*19010031
190200 4344-MOVE-TAUCSCN-TO-HOLD.                                       19020035
190300                                                                  19030031
190400     MOVE AUCSCN-DO-TO-DCONSLR-TMST TO                            19040035
190410                       PV-PREV-DO-TO-DCONSLR-TMST.                19041035
190500     MOVE AUCSCN-LAST-UPD-TMST      TO                            19050035
190600                       PV-PREV-LAST-UPD-TMST-2.                   19060035
190700     MOVE AUCSCN-LAST-UPD-BY-USR-ID TO                            19070035
190800                       PV-PREV-LAST-UPD-BY-USR-ID-2.              19080035
194400                                                                  19440035
194500 EJECT                                                            19450035
194510*----------------------------------------------------------------*19451035
194520* MOVE TAUCNTK VALUES TO HOLD FIELDS FOR COMPARISON.             *19452035
194530*----------------------------------------------------------------*19453035
194540 4345-MOVE-TAUCNTK-TO-HOLD.                                       19454035
194550                                                                  19455035
194560     MOVE AUCNTK-CONSLR-SCAC-ID     TO PV-PREV-CONSLR-SCAC-ID.    19456035
194570     MOVE AUCNTK-MOM-IMPRT-TRIP-ID  TO PV-PREV-MOM-IMPRT-TRIP-ID. 19457035
194580     MOVE AUCNTK-MOM-DPRTR-TMST     TO PV-PREV-MOM-DPRTR-TMST.    19458035
194590     MOVE AUCNTK-MOM-POE-DELY-TMST  TO PV-PREV-MOM-POE-DELY-TMST. 19459035
194591     MOVE AUCNTK-MOM-CARR-SCAC-ID   TO PV-PREV-MOM-CARR-SCAC-ID.  19459135
194592     MOVE AUCNTK-MOM-FOB-CDE        TO PV-PREV-MOM-FOB-CDE.       19459269
194593     MOVE AUCNTK-MOM-IMPRT-VEH-NM   TO PV-PREV-MOM-IMPRT-VEH-NM.  19459335
194594     MOVE AUCNTK-MOM-TRIP-TYP-CDE   TO PV-PREV-MOM-TRIP-TYP-CDE.  19459435
194595     MOVE AUCNTK-MOM-DEST-POE-CDE   TO PV-PREV-MOM-DEST-POE-CDE.  19459535
194596     MOVE AUCNTK-FDR-IMPRT-TRIP-ID  TO PV-PREV-FDR-IMPRT-TRIP-ID. 19459635
194597     MOVE AUCNTK-FDR-DPRTR-TMST     TO PV-PREV-FDR-DPRTR-TMST.    19459735
194598     MOVE AUCNTK-FDR-POE-DELY-TMST  TO PV-PREV-FDR-POE-DELY-TMST. 19459835
194599     MOVE AUCNTK-FDR-CARR-SCAC-ID   TO PV-PREV-FDR-CARR-SCAC-ID.  19459935
194600     MOVE AUCNTK-FDR-FOB-CDE        TO PV-PREV-FDR-FOB-CDE.       19460069
194601     MOVE AUCNTK-FDR-IMPRT-VEH-NM   TO PV-PREV-FDR-IMPRT-VEH-NM.  19460135
194602     MOVE AUCNTK-FDR-TRIP-TYP-CDE   TO PV-PREV-FDR-TRIP-TYP-CDE.  19460235
194603     MOVE AUCNTK-FDR-DEST-POE-CDE   TO PV-PREV-FDR-DEST-POE-CDE.  19460335
194604     MOVE AUCNTK-SIZE-CDE           TO PV-PREV-SIZE-CDE.          19460435
194605     MOVE AUCNTK-CART-CNT           TO PV-PREV-CART-CNT.          19460535
194606     MOVE AUCNTK-CBMT-QTY           TO PV-PREV-CBMT-QTY.          19460635
194607     MOVE AUCNTK-WT-KGRM-QTY        TO PV-PREV-WT-KGRM-QTY.       19460735
194608     MOVE AUCNTK-UNT-QTY            TO PV-PREV-UNT-QTY.           19460835
194611     MOVE AUCNTK-ORGN-SHPD-FR-CDE   TO PV-PREV-ORGN-SHPD-FR-CDE.  19461135
194612     MOVE AUCNTK-ORGN-SHPD-TO-CDE   TO PV-PREV-ORGN-SHPD-TO-CDE.  19461235
194613     MOVE AUCNTK-EST-LBD-NM         TO PV-PREV-EST-LBD-NM.        19461335
194614     MOVE AUCNTK-EST-LBD-TMST       TO PV-PREV-EST-LBD-TMST.      19461435
194615     MOVE AUCNTK-RISU-DO-RSN-CDE    TO PV-PREV-RISU-DO-RSN-CDE.   19461535
194616     MOVE AUCNTK-BKR-FRGT-RLSE-TMST TO PV-PREV-BKR-FRGT-RLSE-TMST.19461635
194618     MOVE AUCNTK-DO-RCVD-TMST       TO PV-PREV-DO-RCVD-TMST.      19461835
194619     MOVE AUCNTK-CONTNR-PU-TMST     TO PV-PREV-CONTNR-PU-TMST.    19461935
194620     MOVE AUCNTK-DAT-SRC-ENT-ID     TO PV-PREV-DAT-SRC-ENT-ID.    19462035
194621     MOVE AUCNTK-LAST-UPD-BY-USR-ID TO                            19462135
194622                                    PV-PREV-LAST-UPD-BY-USR-ID.   19462235
194623     MOVE AUCNTK-LAST-UPD-TMST      TO PV-PREV-LAST-UPD-TMST.     19462335
194624     MOVE AUCNTK-ACTL-POE-DELY-TMST TO PV-PREV-ACTL-POE-DELY-TMST.19462435
194625     MOVE AUCNTK-ACTL-DEST-POE-CDE  TO PV-PREV-ACTL-DEST-POE-CDE. 19462535
194626     MOVE AUCNTK-ACTL-LBD-NM        TO PV-PREV-ACTL-LBD-NM.       19462635
194627     MOVE AUCNTK-ACTL-LBD-TMST      TO PV-PREV-ACTL-LBD-TMST.     19462735
194628     MOVE AUCNTK-DVN-TMST           TO PV-PREV-DVN-TMST.          19462854
194629     MOVE AUCNTK-DCONSLR-SCAC-ID    TO PV-PREV-DCONSLR-SCAC-ID.   19462958
194630     MOVE AUCNTK-DCONSLR-RET-TMST   TO PV-PREV-DCONSLR-RET-TMST.  19463058
194640     MOVE AUCNTK-MOM-POL-CDE        TO PV-PREV-MOM-POL-CDE.       19463169
194650     MOVE AUCNTK-FDR-POL-CDE        TO PV-PREV-FDR-POL-CDE.       19463269
194660     MOVE AUCNTK-MOM-POR-CDE        TO PV-PREV-MOM-POR-CDE.       19463361
194661     MOVE AUCNTK-FDR-POR-CDE        TO PV-PREV-FDR-POR-CDE.       19463461
194662                                                                  19463561
194663*----------------------------------------------------------------*19464054
194700*    FORMAT TIMESTAMPS                                           *19470031
194800*----------------------------------------------------------------*19480031
194900 4350-FORMAT-TMST.                                                19490031
195000                                                                  19500031
195100     IF PV-HOLD-TMST-UNFORMAT(1:10) EQUAL PC-INIT-DATE            19510031
195200         MOVE SPACES                      TO PV-TMST-DATE         19520031
195300     ELSE                                                         19530031
195400         MOVE PV-HOLD-TMST-UNFORMAT(9:2)  TO PV-TMST-DD           19540031
195500         MOVE PV-HOLD-TMST-UNFORMAT(6:2)  TO PV-TMST-MM           19550031
195600         MOVE PV-HOLD-TMST-UNFORMAT(1:4)  TO PV-TMST-CCYY         19560031
195700         MOVE PC-SLASH                    TO PV-TMST-SLASH1       19570031
195800                                             PV-TMST-SLASH2       19580031
195900     END-IF.                                                      19590031
196000                                                                  19600031
196100     IF PV-HOLD-TMST-UNFORMAT(12:5) EQUAL PC-INIT-TIME            19610031
196200         MOVE SPACES                      TO PV-TMST-TIME         19620031
196300     ELSE                                                         19630031
196400         MOVE PV-HOLD-TMST-UNFORMAT(12:2) TO PV-TMST-HOUR         19640031
196500         MOVE PV-HOLD-TMST-UNFORMAT(15:2) TO PV-TMST-MIN          19650031
196600         MOVE PC-COLON                    TO PV-TMST-COLON        19660031
196700     END-IF.                                                      19670031
196800                                                                  19680031
196900*----------------------------------------------------------------*19690031
197000*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *19700031
197100*----------------------------------------------------------------*19710031
197200 4400-MOVE-COMMAREA-TO-SCREEN.                                    19720031
197300                                                                  19730031
197400     MOVE ASC-KEY-CONTNR-NBR     TO ACNTNRO.                      19740031
197500                                                                  19750031
197600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             19760031
197700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          19770031
197800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          19780031
197900             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             19790031
198000                 GIVING PV-BLOCK-NUMBER                           19800031
198100                 REMAINDER PV-REMAINDER                           19810031
198200             IF  PV-REMAINDER > ZERO                              19820031
198300                 ADD +1 TO PV-BLOCK-NUMBER                        19830031
198400             END-IF                                               19840031
198500             MOVE +1    TO ASC-BLK-SUB                            19850031
198600             PERFORM 4410-READ-TEMP-STORAGE                       19860031
198700             ADD +1     TO ASC-BLK-SUB                            19870031
198800                           PV-BLOCK-NUMBER                        19880031
198900             PERFORM 4410-READ-TEMP-STORAGE                       19890031
199000     END-IF.                                                      19900031
199100     MOVE +1                       TO ASC-BLK-SUB.                19910031
199200     COMPUTE ASC-ITEM-SUB =                                       19920031
199300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              19930031
199400         + PC-ITEMS-PER-PANEL).                                   19940031
199500                                                                  19950031
199600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19960031
199700         ADD +1   TO ASC-BLK-SUB                                  19970031
199800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19980031
199900     END-IF.                                                      19990031
200000                                                                  20000031
200100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           20010031
200200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                20020031
200300     PERFORM 4420-FORMAT-LIST-LINES                               20030031
200400         VARYING PS-SUB                                           20040031
200500         FROM PC-ITEMS-PER-PANEL BY -1                            20050031
200600         UNTIL PS-SUB < +1.                                       20060031
200700                                                                  20070031
200800     COMPUTE ASC-ITEMS-DISPLAYED =                                20080031
200900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          20090031
201000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    20100031
201100                                      ASTRTITO.                   20110031
201200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    20120031
201300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    20130031
201400                                                                  20140031
201500     IF  DP020-MSG-NUMBER-X = SPACE                               20150031
201600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  20160031
201700*            --- MORE ITEMS TO DISPLAY ----                       20170031
201800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            20180031
201900             SET DP020-MSG-INFORMATIONAL TO TRUE                  20190031
202000         END-IF                                                   20200031
202100     END-IF.                                                      20210031
202200                                                                  20220031
202300*----------------------------------------------------------------*20230031
202400*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *20240031
202500*----------------------------------------------------------------*20250031
202600                                                                  20260031
202700 4410-READ-TEMP-STORAGE.                                          20270031
202800                                                                  20280031
202900     EXEC CICS                                                    20290031
203000         READQ TS                                                 20300031
203100             QUEUE (ASC-DTL-QUEUE-NAME)                           20310031
203200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               20320031
203300             ITEM  (PV-BLOCK-NUMBER)                              20330031
203400             RESP  (PV-CICS-RESP)                                 20340031
203500     END-EXEC.                                                    20350031
203600                                                                  20360031
203700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       20370031
203800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     20380031
203900         CONTINUE                                                 20390031
204000     ELSE                                                         20400031
204100         SET DP013-CICS-ABEND TO  TRUE                            20410031
204200         SET DP013-NO-ROLLBACK TO  TRUE                           20420031
204300         MOVE '4410-READ-TEMP-STORAGE'                            20430031
204400                               TO  DP013-PARAGRAPH                20440031
204500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      20450031
204600                               TO  DP013-MESSAGE-TEXT(1)          20460031
204700         PERFORM DP013-0000-PROCESS-ABEND                         20470031
204800     END-IF.                                                      20480031
204900                                                                  20490031
205000*    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             20500031
205100                                                                  20510031
205200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         20520031
205300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               20530031
205400     END-IF.                                                      20540031
205500 EJECT                                                            20550031
205600*----------------------------------------------------------------*20560031
205700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *20570031
205800*----------------------------------------------------------------*20580031
205900                                                                  20590031
206000 4420-FORMAT-LIST-LINES.                                          20600031
206100                                                                  20610031
206200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      20620031
206300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                20630031
206400         MOVE SPACES            TO MR-DATA   (PS-SUB)             20640031
206500                                   MR-USERID (PS-SUB)             20650031
206600                                   MR-DATE   (PS-SUB)             20660031
206700                                   MR-TIME   (PS-SUB)             20670031
206800                                   MR-VALUE  (PS-SUB)             20680031
206900     ELSE                                                         20690031
207000         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           20700031
207100             MOVE ASC-DATA      (ASC-BLK-SUB ASC-ITEM-SUB)        20710031
207200                                TO MR-DATA (PS-SUB)               20720031
207300             MOVE ASC-USERID    (ASC-BLK-SUB ASC-ITEM-SUB)        20730031
207400                                TO MR-USERID (PS-SUB)             20740031
207500             MOVE ASC-DATE      (ASC-BLK-SUB ASC-ITEM-SUB)        20750031
207600                                TO MR-DATE (PS-SUB)               20760031
207700             MOVE ASC-TIME      (ASC-BLK-SUB ASC-ITEM-SUB)        20770031
207800                                TO MR-TIME (PS-SUB)               20780031
207900             MOVE ASC-VALUE     (ASC-BLK-SUB ASC-ITEM-SUB)        20790031
208000                                TO MR-VALUE (PS-SUB)              20800031
208100         END-IF                                                   20810031
208200     END-IF.                                                      20820031
208300     SUBTRACT +1 FROM ASC-ITEM-SUB.                               20830031
208400     IF  ASC-ITEM-SUB < + 1                                       20840031
208500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20850031
208600         MOVE +1                 TO ASC-BLK-SUB                   20860031
208700     END-IF.                                                      20870031
208800                                                                  20880031
208900*----------------------------------------------------------------*20890031
209000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *20900031
209100*----------------------------------------------------------------*20910031
209200                                                                  20920031
209300 5100-WRITE-TEMP-STORAGE.                                         20930031
209400                                                                  20940031
209500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     20950031
209600                               TO  PV-LIST-ITEM-NUMBER.           20960031
209700     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           20970031
209800         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           20980031
209900                                                                  20990031
210000     EXEC CICS                                                    21000031
210100         WRITEQ TS                                                21010031
210200             QUEUE (ASC-DTL-QUEUE-NAME)                           21020031
210300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21030031
210400             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     21040031
210500             RESP  (PV-CICS-RESP)                                 21050031
210600     END-EXEC.                                                    21060031
210700                                                                  21070031
210800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      21080031
210900         SET DP013-CICS-ABEND                                     21090031
211000                       TO  TRUE                                   21100031
211100         SET DP013-NO-ROLLBACK                                    21110031
211200                       TO  TRUE                                   21120031
211300         MOVE '5100-WRITE-TEMP-STORAGE'                           21130031
211400                       TO  DP013-PARAGRAPH                        21140031
211500         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       21150031
211600                       TO  DP013-MESSAGE-TEXT(1)                  21160031
211700         PERFORM DP013-0000-PROCESS-ABEND                         21170031
211800     END-IF.                                                      21180031
211900     ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             21190031
212000                                                                  21200031
212100 EJECT                                                            21210031
212200*----------------------------------------------------------------*21220031
212300*    ABEND PROCESSOR MODULE                                      *21230031
212400*----------------------------------------------------------------*21240031
212500                                                                  21250031
212600     COPY DPPD013.                                                21260031
