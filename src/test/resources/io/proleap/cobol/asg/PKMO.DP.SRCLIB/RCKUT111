000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    RCKUT111.                                         00040000
000500 AUTHOR.        RON KRIER.                                        00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   AUGUST 2004.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*   THIS PROGRAM WILL TAKE IN A FILE OF EXTRACTED VERIFIED      * 00100000
001100*   RECEIPTS AND RECEIPT ADJUSTMENTS, CHECK THE STORE THAT      * 00110000
001200*   HAD UNITS VERIFIED TO IT AND DETERMINE IF THE RECEIVER      * 00120000
001300*   SHOULD BE SENT TO THE IN-TRANSIT DATABASE TO UPDATE STORE   * 00130000
001400*   EXPECTED QUANTITIES.                                        * 00140000
001500***************************************************************** 00150000
001510*                    C H A N G E     L O G                      * 00151000
001511*                                                               * 00151100
001512* 2012-05-14 CHRISTINE TWIEHAUS      WR41071                    * 00151200
001513*            SELECT AND WRITE TO NEW OUTPUT FILE (OUT02)        * 00151300
001514*            RECEIPTS DESTINED FOR OMS-SIM                      * 00151400
001515*                                                               * 00151500
001516***************************************************************** 00151600
001517*    PROGRAM CREATES ONE OUTPUT FILE                            * 00151701
001518*                                                               * 00151801
001519*    INP01 - INPUT FILE  - LAYOUT IS STOREEXT COPYBOOK          * 00151901
001520*                                                               * 00152001
001530*    OUT01 - OUTPUT FILE - LAYOUT IS PCRD010 COPYBOOK           * 00153001
001540*                          (DATA TO UPDATE STORE EXPECTED)      * 00154001
001550*                                                               * 00155001
001560*    OUT02 - OUTPUT FILE - LAYOUT IS OFRD010 COPYBOOK           * 00156001
001570*                          (DATA TO SEND STORE EXPECTED TO OMS) * 00157001
001580*                                                               * 00158001
001590***************************************************************** 00159001
001600 ENVIRONMENT DIVISION.                                            00160001
001700***************************************************************** 00170001
001800 INPUT-OUTPUT SECTION.                                            00180001
001900*                                                                 00190001
002000 FILE-CONTROL.                                                    00200001
002100                                                                  00210001
002200     SELECT STOREEXT-FILE   ASSIGN TO INP01.                      00220001
002300                                                                  00230001
002400     SELECT STR-EXPECT-FILE ASSIGN TO OUT01.                      00240001
002500                                                                  00250001
002600     SELECT RDC-EXPECT-FILE ASSIGN TO OUT02.                      00260001
002700                                                                  00270001
002800***************************************************************** 00280001
002900 DATA DIVISION.                                                   00290001
003000***************************************************************** 00300001
003100 FILE SECTION.                                                    00310001
003200                                                                  00320001
003300 FD  STOREEXT-FILE                                                00330001
003400     RECORDING MODE IS F                                          00340001
003500     LABEL RECORDS ARE STANDARD                                   00350001
003600     BLOCK CONTAINS 0 RECORDS.                                    00360001
003700 01  STOREEXT-RECORD             PIC X(300).                      00370001
003800                                                                  00380001
003900 FD  STR-EXPECT-FILE                                              00390001
004000     RECORDING MODE IS F                                          00400001
004100     LABEL RECORDS ARE STANDARD                                   00410001
004200     BLOCK CONTAINS 0 RECORDS.                                    00420001
004300 01  STR-EXPECT-RECORD           PIC X(100).                      00430001
004400                                                                  00440001
004500 FD  RDC-EXPECT-FILE                                              00450001
004600     RECORDING MODE IS F                                          00460001
004700     LABEL RECORDS ARE STANDARD                                   00470001
004800     BLOCK CONTAINS 0 RECORDS.                                    00480001
004900 01  RDC-EXPECT-RECORD           PIC X(60).                       00490001
005000                                                                  00500001
005100***************************************************************** 00510000
005200 WORKING-STORAGE SECTION.                                         00520000
005300***************************************************************** 00530000
005400                                                                  00540000
005500 01  PS-PROGRAM-SWITCHES.                                         00550000
005600     05  PS-SHOW-PARAGRAPH-SW         PIC X(01)  VALUE 'N'.       00560000
005700         88  PS-SHOW-PARAGRAPH                   VALUE 'Y'.       00570000
005800         88  PS-DONT-SHOW-PARAGRAPH              VALUE 'N'.       00580000
005900     05  PS-EOF-STOREEXT-SW           PIC X(01)  VALUE 'N'.       00590000
006000         88  PS-EOF-STOREEXT-FILE                VALUE 'Y'.       00600000
006100         88  PS-NOT-EOF-STOREEXT-FILE            VALUE 'N'.       00610000
006200     05  PS-RECV-LOC-UPDATE-SE-SW     PIC X(01)  VALUE 'N'.       00620000
006300         88  PS-RECV-LOC-UPDATE-SE               VALUE 'Y'.       00630000
006400         88  PS-DONT-RECV-LOC-UPDATE-SE          VALUE 'N'.       00640000
006401* WR41071 CT START                                                00640100
006402     05  PS-RDC-RECORD-SW             PIC X(01)  VALUE 'N'.       00640200
006403         88  PS-RDC-RECORD-YES                   VALUE 'Y'.       00640301
006404         88  PS-RDC-RECORD-NO                    VALUE 'N'.       00640401
006405* WR41071 CT END                                                  00640501
006406* WR41071 NEXT 3 LINES ARE NEW - AME                              00640601
006407     05  PS-CURR-LOC-DC-SW            PIC X(01)  VALUE 'N'.       00640701
006408         88  PS-CURR-LOC-DC                      VALUE 'Y'.       00640801
006409         88  PS-CURR-LOC-DC-NO                   VALUE 'N'.       00640901
006410                                                                  00641508
006420 01  PV-PROGRAM-VARIABLES.                                        00642001
006430     05  PV-IN-TRANSIT-CDE            PIC  X(01) VALUE SPACES.    00643001
006440     05  PV-PREV-ORD-NBR              PIC S9(09) COMP   VALUE 0.  00644001
006450     05  PV-PREV-REC-SEQ-NBR          PIC S9(09) COMP   VALUE 0.  00645001
006460     05  PV-PREV-LOC-NBR              PIC S9(04) COMP   VALUE 0.  00646001
006470     05  PV-PCRD010-OUT               PIC S9(07) COMP-3 VALUE 0.  00647001
006480* WR41071 CT START                                                00648001
006490     05  PV-OFRD010-OUT               PIC S9(07) COMP-3 VALUE 0.  00649001
006500     05  PV-CURR-OPER-UNT-ID          PIC S9(04) COMP   VALUE 0.  00650001
006600* WR41071 CT END                                                  00660001
006700     05  PV-INPUT-BYPASSED            PIC S9(07) COMP-3 VALUE 0.  00670001
006800     05  PV-INPUT-BYPASSED-ZERO       PIC S9(07) COMP-3 VALUE 0.  00680001
006900     05  PV-SQL-CHECK-BYPASSED        PIC S9(07) COMP-3 VALUE 0.  00690001
007000     05  PV-SQL-CHECK-DONE            PIC S9(07) COMP-3 VALUE 0.  00700001
007100     05  PV-RECORDS-READ-QTY          PIC S9(09) COMP-3 VALUE 0.  00710001
007200     05  PV-INPUT-RCVG-QTY            PIC S9(09) COMP-3 VALUE 0.  00720001
007300     05  PV-INPUT-ADJ-QTY             PIC S9(09) COMP-3 VALUE 0.  00730001
007400     05  PV-INPUT-ADJ-MATCH-QTY       PIC S9(09) COMP-3 VALUE 0.  00740001
007500     05  PV-INPUT-ADJ-NO-MATCH-QTY    PIC S9(09) COMP-3 VALUE 0.  00750001
007600     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00760000
007700     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      00770000
007701*WR41071-NEXT LINE NEW - AME                                      00770100
007702     05  PV-DUMMY                     PIC S9(4)  COMP VALUE 0.    00770201
007703                                                                  00770301
007704 01 DK-DATABASE-KEYS.                                             00770401
007705     05  DK-ORD-NBR                   PIC S9(09) COMP   VALUE 0.  00770501
007706     05  DK-ORD-LNE-NBR               PIC S9(09) COMP   VALUE 0.  00770601
007707     05  DK-REC-SEQ-NBR               PIC S9(09) COMP   VALUE 0.  00770701
007708     05  DK-LOC-NBR                   PIC S9(04) COMP   VALUE 0.  00770801
007709     05  DK-NOTIF-NBR                 PIC S9(09) COMP   VALUE 0.  00770901
007710     05  DK-ADJ-CYC-NBR               PIC S9(09) COMP   VALUE 0.  00771001
007720*WR41071-2 NEXT LINES NEW - AME                                   00772001
007730     05  DK-LOC-NBR2                  PIC  S9(4) COMP   VALUE 0.  00773001
007740     05  DK-LOC-TYP-CDE               PIC   X(2)   VALUE SPACES.  00774001
007750                                                                  00775001
007760 01 PC-PROGRAM-CONSTANTS.                                         00776001
007770     05  PC-PROGRAM-NAME             PIC X(08)  VALUE 'RCKUT111'. 00777001
007780     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.00778001
007790     05  PC-YES                      PIC X(01) VALUE 'Y'.         00779001
007800     05  PC-NO                       PIC X(01) VALUE 'N'.         00780001
007900     05  PC-DC                       PIC X(02) VALUE 'DC'.        00790001
008000     05  PC-DS                       PIC X(02) VALUE 'DS'.        00800001
008000     05  PC-CS                       PIC X(02) VALUE 'CS'.        00801009
008100     05  PC-KHL                      PIC X(03) VALUE 'KHL'.       00810001
008200     05  PC-ACTIVE                   PIC X(02) VALUE 'AC'.        00820001
008300     05  PC-N                        PIC X(01) VALUE 'N'.         00830001
008400     05  PV-RECORD-STATUS            PIC X(16) VALUE SPACES.      00840001
008500     05  PC-RECORD-FOUND             PIC X(16) VALUE              00850001
008600                                               'RECORD FOUND    '.00860001
008700     05  PC-RECORD-NOT-FOUND         PIC X(16) VALUE              00870001
008800                                               'RECORD NOT FOUND'.00880001
008900                                                                  00890001
009000 01  PV-ABEND-FIELDS.                                             00900001
009100     05  PV-ABEND-CODE               PIC S9(04) VALUE +0 COMP.    00910001
009200     05  PV-ABEND-PROGRAM            PIC  X(08) VALUE 'RCKUT111'. 00920001
009300     05  PV-ABEND-PARAGRAPH          PIC  X(50) VALUE SPACES.     00930001
009400     05  PV-ABEND-OPERATION          PIC  X(51) VALUE SPACES.     00940001
009500******************************************************************00950001
009600*  USED FOR DB2 ERROR MESSAGE BUILDING                            00960001
009700******************************************************************00970001
009800     COPY DPWS004.                                                00980001
009900                                                                  00990001
010000******************************************************************01000001
010100*   DB2 SQL COMMUNICATION AREA                                    01010001
010200******************************************************************01020001
010300     EXEC SQL                                                     01030001
010400          INCLUDE SQLCA                                           01040001
010500     END-EXEC.                                                    01050001
010600                                                                  01060001
010700******************************************************************01070001
010800*    TAURECD - RECEIPT DISTRIBUTION AUDIT TABLE                   01080001
010900******************************************************************01090001
011000     EXEC SQL                                                     01100001
011100          INCLUDE TAURECD                                         01110001
011200     END-EXEC.                                                    01120001
011300                                                                  01130001
011400******************************************************************01140001
011500*    TRECEIV - RECEIVER TABLE.                                    01150001
011600******************************************************************01160001
011700     EXEC SQL                                                     01170001
011800          INCLUDE TRECEIV                                         01180001
011900     END-EXEC.                                                    01190001
012000                                                                  01200001
012100******************************************************************01210001
012200*    XLT_LOC - LOGISTICS DOMAIN LOCATION MASTER TABLE.            01220001
012300******************************************************************01230001
012400     EXEC SQL                                                     01240001
012500          INCLUDE XLT00010                                        01250001
012600     END-EXEC.                                                    01260001
012700                                                                  01270001
012800******************************************************************01280001
012900*    XLT_DC_LOC_ASGMT - LOGISTICS DOMAIN STORE TO DC ASSOCIATION  01290001
013000*                       TABLE.                                    01300001
013100******************************************************************01310001
013200     EXEC SQL                                                     01320001
013300          INCLUDE XLT00014                                        01330001
013400     END-EXEC.                                                    01340001
013500                                                                  01350001
013600******************************************************************01360001
013700*    TKRPRPM - KOHLS TO RETEK PROCESSING PARAMETERS.              01370001
013800******************************************************************01380001
013900     EXEC SQL                                                     01390001
014000          INCLUDE TKRPRPM                                         01400001
014100     END-EXEC.                                                    01410001
014200                                                                  01420001
014300* WR41071 CT START                                                01430001
014400******************************************************************01440001
014500*    TSEASET - SEASONAL SET CODES                                 01450001
014510******************************************************************01451001
014520     EXEC SQL                                                     01452001
014530          INCLUDE TSEASET                                         01453001
014540     END-EXEC.                                                    01454001
014550                                                                  01455001
014560******************************************************************01456001
014570*    TPURCHS - PURCHASE ORDER TABLE                               01457001
014580******************************************************************01458001
014581     EXEC SQL                                                     01458101
014582          INCLUDE TPURCHS                                         01458201
014583     END-EXEC.                                                    01458301
014584                                                                  01458401
014585******************************************************************01458501
014586*    WST00008 - WST_INTGRTN_TYP                                   01458601
014587******************************************************************01458701
014588     EXEC SQL                                                     01458801
014589          INCLUDE WST00008                                        01458901
014590     END-EXEC.                                                    01459001
014591                                                                  01459101
014592******************************************************************01459201
014593*    WST00009 - WST_ATTR_DEFN                                     01459301
014594******************************************************************01459401
014595     EXEC SQL                                                     01459501
014596          INCLUDE WST00009                                        01459601
014597     END-EXEC.                                                    01459701
014598                                                                  01459801
014599******************************************************************01459901
014600*    WST00010 - WST_ATTR_ELEM                                     01460001
014601******************************************************************01460101
014602     EXEC SQL                                                     01460201
014603          INCLUDE WST00010                                        01460301
014604     END-EXEC.                                                    01460401
014605                                                                  01460501
014606* WR41071 CT END                                                  01460601
014607***********************************************************       01460701
014608*  INPUT COPYBOOK - STORE EXTRACT FILE (VERIFIED RECEIPTS)*       01460801
014609***********************************************************       01460901
014610     COPY STOREEXT.                                               01461001
014620                                                                  01462001
014630***********************************************************       01463001
014640*  OUTPUT COPYBOOK - IN-TRANSIT UPDATE FILE               *       01464001
014650***********************************************************       01465001
014660     COPY PCRD010.                                                01466001
014670                                                                  01467001
014680* WR41071 CT START                                                01468001
014690***********************************************************       01469001
014700*  OUTPUT COPYBOOK - IN-TRANSIT RECEIPT FOR OMS FILE      *       01470001
014800***********************************************************       01480001
014900     COPY OFRD010.                                                01490001
015000                                                                  01500001
015100* WR41071 CT END                                                  01510001
015200***********************************************************       01520001
015300*  COPYBOOK FOR XLKUT001 - ITEM BLACK BOX                 *       01530001
015400***********************************************************       01540001
015500     COPY XLWS001.                                                01550001
015600                                                                  01560001
015700***********************************************************       01570001
015800 PROCEDURE DIVISION.                                              01580001
015900***********************************************************       01590001
016000                                                                  01600001
016100     PERFORM 1000-INITIALIZATION.                                 01610001
016200                                                                  01620001
016300     PERFORM 2000-PROCESS-EXTRACTS                                01630001
016400         UNTIL PS-EOF-STOREEXT-FILE.                              01640001
016500                                                                  01650001
016600     PERFORM 9900-EOJ-ROUTINE.                                    01660001
016700                                                                  01670001
016800     GOBACK.                                                      01680001
016900                                                                  01690001
017000****************************************************************  01700001
017100*    FIRST TIME PROGRAM INITIALIZATION TASKS.                  *  01710001
017200****************************************************************  01720001
017300 1000-INITIALIZATION.                                             01730001
017400                                                                  01740001
017500* WR41071 CT START                                                01750001
017600     OPEN INPUT STOREEXT-FILE                                     01760001
017700          OUTPUT STR-EXPECT-FILE                                  01770001
017800          OUTPUT RDC-EXPECT-FILE.                                 01780001
017900* WR41071 CT END                                                  01790001
018000                                                                  01800001
018100     DISPLAY '**************************************'.            01810001
018200     DISPLAY '*        PROGRAM - RCKUT111          *'.            01820001
018300     DISPLAY '**************************************'.            01830001
018400     DISPLAY '                                      '.            01840001
018500                                                                  01850001
018600     SET PS-DONT-SHOW-PARAGRAPH  TO TRUE.                         01860001
018700                                                                  01870001
018800     SET PS-NOT-EOF-STOREEXT-FILE TO TRUE.                        01880001
018900                                                                  01890001
019000     PERFORM 9100-READ-INPUT-FILE.                                01900001
019100                                                                  01910001
019200****************************************************************  01920001
019300*  DETERMINE IF RECEIVER WAS CREATED AFTER THE DC ASSOCIATED   *  01930001
019400*  TO THE RECEIVER STORE HAS BEEN TURNED ON TO UPDATE THE      *  01940001
019500*  STORE EXPECTED QUANTITIES.                                  *  01950001
019600****************************************************************  01960001
019700 2000-PROCESS-EXTRACTS.                                           01970001
019800                                                                  01980001
019900     MOVE '2000-PROCESS-EXTRACTS   ' TO PV-ABEND-PARAGRAPH.       01990001
020000     IF PS-SHOW-PARAGRAPH                                         02000001
020100        DISPLAY '2000-PROCESS-EXTRACTS'                           02010001
020200     END-IF.                                                      02020001
020300                                                                  02030001
020400     MOVE SE-PO                    TO DK-ORD-NBR.                 02040001
020500     MOVE SE-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.             02050001
020600     MOVE SE-LOC-NBR               TO DK-LOC-NBR.                 02060001
020700                                                                  02070001
020800     IF  SE-RETAIL-UNITS-MARK = 0                                 02080001
020810         ADD +1 TO PV-INPUT-BYPASSED-ZERO                         02081001
020820     ELSE                                                         02082001
020830         IF  DK-ORD-NBR          = PV-PREV-ORD-NBR                02083001
020840         AND DK-REC-SEQ-NBR      = PV-PREV-REC-SEQ-NBR            02084001
020850         AND DK-LOC-NBR          = PV-PREV-LOC-NBR                02085001
020860             ADD +1 TO PV-SQL-CHECK-BYPASSED                      02086001
020870             IF  PS-RECV-LOC-UPDATE-SE                            02087001
020880* WR41071 START                                                   02088001
020890                 IF PS-RDC-RECORD-YES                             02089001
020900*WR41071 - NEXT 2 LINES NEW - AME                                 02090001
021000                    PERFORM 2220-GUARANTE-LOC-IS-DC               02100001
021100                    IF PS-CURR-LOC-DC                             02110001
      * BEGIN DRW 06/05/2014                                            02120010
                            IF SE-CS-CONVRSON                           02122022
                                PERFORM 9650-WRITE-OFRD010-RECORD       02123010
                            ELSE                                        02124010
                                PERFORM 9600-WRITE-PCRD010-RECORD       02125010
                            END-IF                                      02126010
      * END DRW                                                         02127010
021300*WR41071 - NEXT 3 LINES NEW - AME                                 02130001
021310                    ELSE                                          02131001
021320                       PERFORM 9600-WRITE-PCRD010-RECORD          02132001
021330                    END-IF                                        02133001
021340                 ELSE                                             02134001
021350                       PERFORM 9600-WRITE-PCRD010-RECORD          02135001
021360                 END-IF                                           02136001
021370* WR41071 END                                                     02137001
021380             ELSE                                                 02138001
021390                 ADD +1 TO PV-INPUT-BYPASSED                      02139001
021400             END-IF                                               02140001
021500         ELSE                                                     02150001
021600             ADD +1 TO PV-SQL-CHECK-DONE                          02160001
021700             MOVE DK-ORD-NBR          TO PV-PREV-ORD-NBR          02170001
021800             MOVE DK-REC-SEQ-NBR      TO PV-PREV-REC-SEQ-NBR      02180001
021900             MOVE DK-LOC-NBR          TO PV-PREV-LOC-NBR          02190001
022000             SET PS-RECV-LOC-UPDATE-SE TO TRUE                    02200001
022100* WR41071 START                                                   02210001
022200             SET PS-RDC-RECORD-NO           TO  TRUE              02220001
022300             PERFORM 2200-CHECK-RECV-LOC-NBR                      02230001
022400*            IF XLT00010-E-BUS-IND = 'Y'                          02240002
022410                 PERFORM 2250-CHECK-FOR-RDC                       02241001
022420*            END-IF                                               02242002
022430                                                                  02243001
022440                                                                  02244001
022450             IF  PS-RECV-LOC-UPDATE-SE                            02245001
022460               IF PS-RDC-RECORD-YES                               02246001
022470*WR41071 - NEXT 2 LINES NEW - AME                                 02247001
022480                  PERFORM 2220-GUARANTE-LOC-IS-DC                 02248001
022490                  IF PS-CURR-LOC-DC                               02249001
      * BEGIN DRW 06/05/2014                                            02249110
                            IF SE-CS-CONVRSON                           02249323
                                PERFORM 9650-WRITE-OFRD010-RECORD       02250010
                            ELSE                                        02250110
                                PERFORM 9600-WRITE-PCRD010-RECORD       02250210
                            END-IF                                      02250310
      * END DRW                                                         02250410
022510*WR41071 - NEXT 3 LINES NEW - AME                                 02251001
022520                  ELSE                                            02252001
022530                     PERFORM 9600-WRITE-PCRD010-RECORD            02253001
022540                  END-IF                                          02254001
022550               ELSE                                               02255001
022551                  PERFORM 9600-WRITE-PCRD010-RECORD               02255101
022552               END-IF                                             02255201
022553* WR41071 END                                                     02255301
022554             ELSE                                                 02255401
022555                 ADD +1 TO PV-INPUT-BYPASSED                      02255501
022556             END-IF                                               02255601
022557         END-IF                                                   02255701
022558     END-IF.                                                      02255801
022559                                                                  02255901
022560     PERFORM 9100-READ-INPUT-FILE.                                02256001
022570                                                                  02257001
022580***************************************************************** 02258001
022590* CHECK TO SEE IF THE DC ASSOCIATED TO THE RECEIVING STORE        02259001
022600* IS SET FOR UPDATE OF STORE EXPECTED.                            02260001
022700* 2006/05 DEANNA BRANTNER THIS PROGRAM WILL NOW LET E-COMMERCE    02270001
022800*                         ORDERS THROUGH.                         02280001
022900***************************************************************** 02290001
023000 2200-CHECK-RECV-LOC-NBR.                                         02300001
023100                                                                  02310001
023200     IF PS-SHOW-PARAGRAPH                                         02320001
023300        DISPLAY '2200-CHECK-RECV-LOC-NBR'                         02330001
023400     END-IF.                                                      02340001
023500                                                                  02350001
023600* WR41071 ADDED E_BUS_IND & CURR_OPER_UNT_ID BELOW                02360001
023700                                                                  02370001
023800     EXEC SQL                                                     02380001
023900         SELECT A.ORD_NBR                                         02390001
024000              , A.VERFYD_TMST                                     02400001
024100              , D.E_BUS_IND                                       02410001
024200              , A.CURR_OPER_UNT_ID                                02420001
024300           INTO :RECEIV-ORD-NBR                                   02430001
024400              , :RECEIV-VERFYD-TMST                               02440001
024500              , :XLT00010-E-BUS-IND                               02450001
024600              , :RECEIV-CURR-OPER-UNT-ID                          02460001
024700         FROM TRECEIV   A                                         02470001
024800            , XLT_DC_LOC_ASGMT   B                                02480001
024900            , TKRPRPM   C                                         02490001
025000            , XLT_LOC   D                                         02500001
025100         WHERE A.ORD_NBR          = :DK-ORD-NBR                   02510001
025200           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               02520001
025300           AND NOT A.REC_TYP_CDE  IN ('AP', 'CD')                 02530001
025400           AND B.LOC_NBR          = :DK-LOC-NBR                   02540001
025500           AND B.EFF_BEG_DTE      =                               02550001
025600                (SELECT MAX(EFF_BEG_DTE)                          02560001
025700                   FROM XLT_DC_LOC_ASGMT Z                        02570001
025800                  WHERE Z.LOC_NBR = B.LOC_NBR                     02580001
025900                    AND EFF_BEG_DTE <= CURRENT DATE)              02590001
026000           AND C.LOC_ID           = B.DC_NBR                      02600001
026100           AND C.INTFC_SYS_CDE    = 'KHL'                         02610001
026200           AND C.SYS_PRC_FUNC_CDE = 'STREXP'                      02620001
026300           AND A.CRE_TMST         >= C.FUNC_BEG_TMST              02630001
026400           AND D.LOC_NBR           = B.LOC_NBR                    02640001
026500*          AND NOT D.E_BUS_IND     = 'Y'                          02650001
026600           AND D.LOC_TYP_CDE       = 'DS'                         02660001
026700       END-EXEC.                                                  02670001
026800                                                                  02680001
026900     EVALUATE TRUE                                                02690001
027000         WHEN SQLCODE = ZERO                                      02700001
027100         WHEN SQLCODE = -811                                      02710001
027200              CONTINUE                                            02720001
027300         WHEN SQLCODE = +100                                      02730001
027400              SET PS-DONT-RECV-LOC-UPDATE-SE TO TRUE              02740001
027500         WHEN SQLCODE = -904                                      02750001
027600         WHEN SQLCODE = -911                                      02760001
027700         WHEN SQLCODE = -913                                      02770001
027800              MOVE SQLCODE TO PV-SQLCODE                          02780001
027900              MOVE '2200-CHECK-RECV-LOC-NBR'                      02790001
028000                                TO PV-ABEND-PARAGRAPH             02800001
028100              MOVE 'CONTENTION PROBLEM'                           02810001
028200                            TO PV-ABEND-OPERATION                 02820001
028300              PERFORM Z999-SQL-ABEND                              02830001
028400         WHEN SQLWARN0 NOT = SPACES                               02840001
028500         WHEN SQLCODE < +0                                        02850001
028600         WHEN SQLCODE > +0                                        02860001
028700              MOVE SQLCODE TO PV-SQLCODE                          02870001
028800              MOVE '2200-CHECK-RECV-LOC-NBR'                      02880001
028900                                TO PV-ABEND-PARAGRAPH             02890001
029000              MOVE 'SQL ERROR PROBLEM'                            02900001
029100                            TO PV-ABEND-OPERATION                 02910001
029200              PERFORM Z999-SQL-ABEND                              02920001
029300      END-EVALUATE.                                               02930001
029400                                                                  02940001
029500***************************************************************** 02950001
029510* CHECK THE OUTPUT CURR_OPER_UNT_ID TO SEE IF IT'S A DC THAT      02951001
029511* SUPPORTS THE STORES & HAS PARM OF 'REDDCS' ETC. ON TKRPRPM TBL. 02951101
029512* THIS IS DONE FOR THE RDC ECOMM ORDER TO BE FULFILLED IN A DC.   02951201
029513* 2012/06 ALICE EBERT FOR WR41071 - NEW PARAGRAPH                 02951301
029514***************************************************************** 02951401
029515 2220-GUARANTE-LOC-IS-DC.                                         02951501
029516                                                                  02951601
029517     IF PS-SHOW-PARAGRAPH                                         02951701
029518        DISPLAY '2220-GUARANTE-LOC-IS-DC'                         02951801
029519     END-IF.                                                      02951901
029520                                                                  02952001
029521     MOVE PV-CURR-OPER-UNT-ID TO DK-LOC-NBR2.                     02952101
029522     MOVE PC-DC               TO DK-LOC-TYP-CDE.                  02952201
029523                                                                  02952301
029524*    DISPLAY 'PS-CURR-LOC-DC SW IN'  PS-CURR-LOC-DC-SW            02952421
029525*    DISPLAY '2220-CURR OPP IN> '    PV-CURR-OPER-UNT-ID          02952521
029526*    DISPLAY '2220-DC >         '    PC-DC                        02952621
029527*    DISPLAY '2220-DK-LOC-NBR2> '    DK-LOC-NBR2                  02952721
029528*    DISPLAY '2220-DK-LOC-TYP-CDE> ' DK-LOC-TYP-CDE               02952821
029529                                                                  02952901
029530     EXEC SQL                                                     02953001
029531         SELECT 1                                                 02953101
029532           INTO   :PV-DUMMY                                       02953201
029533         FROM XLT_LOC   A                                         02953301
029534            , TKRPRPM   B                                         02953401
029535         WHERE A.LOC_NBR          = :DK-LOC-NBR2                  02953501
029536           AND A.LOC_TYP_CDE      = :DK-LOC-TYP-CDE               02953601
029537           AND A.E_BUS_IND        = 'N'                           02953701
029538           AND B.INTFC_SYS_CDE     = 'OMS'                        02953800
029539           AND B.SYS_PRC_FUNC_CDE  = 'REDDCS'                     02953900
029540           AND B.FUNC_PRC_STAT_CDE = 'AC'                         02954000
029550           AND B.FUNC_TXT          = 'Y'                          02955000
029551           AND B.LOC_ID            = A.LOC_NBR                    02955100
029552       END-EXEC.                                                  02955200
029553                                                                  02955300
029554     EVALUATE TRUE                                                02955400
029555         WHEN SQLCODE = ZERO                                      02955500
029556         WHEN SQLCODE = -811                                      02955600
029557              SET PS-CURR-LOC-DC    TO TRUE                       02955700
029558         WHEN SQLCODE = +100                                      02955800
029559              SET PS-CURR-LOC-DC-NO  TO TRUE                      02955906
029560         WHEN SQLCODE = -904                                      02956000
029561         WHEN SQLCODE = -911                                      02956100
029562         WHEN SQLCODE = -913                                      02956200
029563              MOVE SQLCODE TO PV-SQLCODE                          02956300
029564              MOVE '2220-GUARANTE-LOC-IS-DC'                      02956400
029565                                TO PV-ABEND-PARAGRAPH             02956500
029566              MOVE 'CONTENTION PROBLEM'                           02956600
029567                            TO PV-ABEND-OPERATION                 02956700
029568              PERFORM Z999-SQL-ABEND                              02956800
029569         WHEN SQLWARN0 NOT = SPACES                               02956900
029570         WHEN SQLCODE < +0                                        02957000
029571         WHEN SQLCODE > +0                                        02957100
029572              MOVE SQLCODE TO PV-SQLCODE                          02957200
029573              MOVE '2220-GUARANTE-LOC-IS-DC'                      02957300
029574                           TO PV-ABEND-PARAGRAPH                  02957400
029575              MOVE 'SQL ERROR PROBLEM'                            02957500
029576                            TO PV-ABEND-OPERATION                 02957600
029577              PERFORM Z999-SQL-ABEND                              02957700
029578      END-EVALUATE.                                               02957800
029579                                                                  02957900
029580* WR41071 CT START                                                02958000
029579                                                                  02965508
029580* WR41071 CT START                                                02965608
029581***************************************************************** 02965708
029582* CHECK TO SEE IF THE PO IS ING STORE IS SET FOR A SPECIFIC RDC   02965808
029583* SEASONAL SET CODE AND THUS FEED OMS                             02965908
029584***************************************************************** 02966008
029585 2250-CHECK-FOR-RDC.                                              02966108
029586                                                                  02966208
029587     IF PS-SHOW-PARAGRAPH                                         02966308
029588        DISPLAY '2250-CHECK-FOR-RDC'                              02966408
029589     END-IF.                                                      02966508
029590                                                                  02966608
029591     EXEC SQL                                                     02966708
029592         SELECT G.SEASET_SHRT_NM                                  02966808
029593           INTO :SEASET-SEASET-SHRT-NM                            02966908
029594           FROM  WST_INTGRTN_TYP  A                               02967008
029595                ,WST_ATTR_DEFN    B                               02967108
029596                ,WST_ATTR_ELEM    C                               02967208
029597                ,WST_ATTR_ELEM    D                               02967308
029598                ,WST_ATTR_ELEM    E                               02967408
029599                ,WST_ATTR_ELEM    F                               02967508
029600                ,TSEASET          G                               02967608
029601                ,TPURCHS          H                               02967708
029602            WHERE A.INTGRTN_TYP_CDE   = 'EFCATRDC'                02967808
029603              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         02967908
029604              AND B.ATTR_DEFN_SEQ_NBR = 1                         02968008
029605              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         02968108
029606              AND C.ATTR_DEFN_SEQ_NBR = 1                         02968208
029607              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         02968308
029608              AND D.ATTR_DEFN_SEQ_NBR = 2                         02968408
029609              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         02968508
029610              AND E.ATTR_DEFN_SEQ_NBR = 3                         02968608
029611              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         02968708
029612              AND F.ATTR_DEFN_SEQ_NBR = 4                         02968808
029613              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       02968908
029614              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       02969008
029615              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       02969108
029616              AND C.ATTR_ELEM_TXT     = G.SEASET_TYP_CDE          02969208
029617              AND D.ATTR_ELEM_TXT     = 'ACTIVE'                  02969308
029618              AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP         02969408
029619              AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP         02969508
029620              AND G.SEASET_SHRT_NM    = H.SEASET_SHRT_NM          02969608
029621              AND G.SEASET_YR         = H.SEASET_YR               02969708
029622              AND H.PO_NBR            = :DK-ORD-NBR               02969808
029623              AND H.VER_STATUS_CDE    = 'A'                       02969908
029624       END-EXEC.                                                  02970008
029625                                                                  02970108
029626     EVALUATE TRUE                                                02970208
029627         WHEN SQLCODE = ZERO                                      02970308
029628         WHEN SQLCODE = -811                                      02970408
029629              SET PS-RDC-RECORD-YES TO TRUE                       02970508
029630              MOVE RECEIV-CURR-OPER-UNT-ID                        02970608
029631                                         TO PV-CURR-OPER-UNT-ID   02970708
029632         WHEN SQLCODE = +100                                      02970808
029633              SET PS-RDC-RECORD-NO  TO TRUE                       02970908
029634              MOVE ZEROS                 TO PV-CURR-OPER-UNT-ID   02971008
029635         WHEN SQLCODE = -904                                      02971108
029636         WHEN SQLCODE = -911                                      02971208
029637         WHEN SQLCODE = -913                                      02971308
029638              MOVE SQLCODE TO PV-SQLCODE                          02971408
029639              MOVE '2250-CHECK-FOR-RDC'                           02971508
029640                                TO PV-ABEND-PARAGRAPH             02971608
029641              MOVE 'CONTENTION PROBLEM'                           02971708
029642                            TO PV-ABEND-OPERATION                 02971808
029643              PERFORM Z999-SQL-ABEND                              02971908
029644         WHEN SQLWARN0 NOT = SPACES                               02972008
029645         WHEN SQLCODE < +0                                        02972108
029646         WHEN SQLCODE > +0                                        02972208
029647              MOVE SQLCODE TO PV-SQLCODE                          02972308
029648              MOVE '2250-CHECK-FOR-RDC'                           02972408
029649                                TO PV-ABEND-PARAGRAPH             02972508
029650              MOVE 'SQL ERROR PROBLEM'                            02972608
029651                            TO PV-ABEND-OPERATION                 02972708
029652              PERFORM Z999-SQL-ABEND                              02972808
029653      END-EVALUATE.                                               02972908
029654                                                                  02973008
029655* WR41071 CT END                                                  02973108
029656                                                                  02973208
029657***************************************************************** 02973308
029658*  FORMAT THE DATA FOR UPDATE OF THE STORE EXPECTED FOR THE       02973408
029659*  DATA FROM THE INPUT FILE (STOREEXT).                           02973508
029660***************************************************************** 02973608
029670 6000-BUILD-PCRD010-OUTPUT.                                       02973708
029680                                                                  02973808
029690     INITIALIZE PC010-PCT-INTRANSIT-REC.                          02973908
029700                                                                  02974008
029800     PERFORM 6100-CALL-XLKUT-DOMAIN-PGM.                          02980000
029900                                                                  02990000
030000     MOVE SE-PO                    TO PC010-PO-NBR.               03000000
030100     MOVE SE-REC-SEQ-NBR           TO PC010-RCVR-SEQ-NBR.         03010000
030200     MOVE SE-LOC-NBR               TO PC010-STR-NBR.              03020000
030300     MOVE SE-RETAIL-UNITS-MARK     TO PC010-IN-TRNST-QTY.         03030000
030400     MOVE PC-PROGRAM-NAME          TO PC010-UPD-USR-ID.           03040000
030500                                                                  03050000
030600     IF SE-REC-SRC-CDE   = 'R'                                    03060000
030700         MOVE 'AR'                TO PC010-TRN-TYP-CDE            03070000
030800         MOVE RECEIV-VERFYD-TMST  TO PC010-EVENT-TMST             03080000
030900         ADD +1                   TO PV-INPUT-RCVG-QTY            03090000
031000     ELSE                                                         03100000
031100         MOVE 'VA'                TO PC010-TRN-TYP-CDE            03110000
031200         MOVE SE-POLINENO         TO DK-ORD-LNE-NBR               03120000
031300         MOVE SE-NOTIF-NBR        TO DK-NOTIF-NBR                 03130000
031400         MOVE SE-ADJ-CYC-NBR      TO DK-ADJ-CYC-NBR               03140000
031500         PERFORM 6200-GET-ADJUST-TIMESTAMP                        03150000
031600         MOVE AURECD-UPD-TMST     TO PC010-EVENT-TMST             03160000
031610         ADD +1                   TO PV-INPUT-ADJ-QTY             03161000
031620     END-IF.                                                      03162000
031630                                                                  03163000
031640     MOVE ZEROS                    TO PC010-TRIP-ID               03164000
031650                                      PC010-STAT-CDE-DS           03165000
031660                                      PC010-STAT-CDE-SU           03166000
031670                                      PC010-UPC-NBR.              03167000
031680                                                                  03168000
031690     MOVE 'SE'                     TO PC010-TRN-CLSN-CDE.         03169000
031700                                                                  03170000
031800                                                                  03180000
031900* WR41071 CT START                                                03190000
032000***************************************************************** 03200000
032100*  FORMAT THE DATA FOR SENDING TO OMS                             03210000
032200***************************************************************** 03220000
032300 6050-BUILD-OFRD010-OUTPUT.                                       03230000
032400                                                                  03240000
032500     INITIALIZE OF010-PCT-INTRANSIT-REC.                          03250000
032600                                                                  03260000
032700     PERFORM 6100-CALL-XLKUT-DOMAIN-PGM.                          03270000
032710     MOVE PC010-INTR-UPC-ID   TO OF010-INTR-UPC-ID.               03271000
032720                                                                  03272000
032730     MOVE SE-PO                    TO OF010-PO-NBR.               03273000
032740     MOVE SE-REC-SEQ-NBR           TO OF010-RCVR-SEQ-NBR.         03274000
032750     MOVE PV-CURR-OPER-UNT-ID      TO OF010-STR-NBR.              03275000
032760     MOVE SE-RETAIL-UNITS-MARK     TO OF010-IN-TRNST-QTY.         03276000
032770                                                                  03277000
032780     IF SE-REC-SRC-CDE   = 'R'                                    03278000
032790         MOVE 'AR'                TO OF010-TRN-TYP-CDE            03279000
032800         ADD +1                   TO PV-INPUT-RCVG-QTY            03280000
032801     ELSE                                                         03280100
032802         MOVE 'VA'                TO OF010-TRN-TYP-CDE            03280200
032803         MOVE SE-POLINENO         TO DK-ORD-LNE-NBR               03280300
032804         MOVE SE-NOTIF-NBR        TO DK-NOTIF-NBR                 03280400
032805         MOVE SE-ADJ-CYC-NBR      TO DK-ADJ-CYC-NBR               03280500
032806         PERFORM 6200-GET-ADJUST-TIMESTAMP                        03280600
032807         ADD +1                   TO PV-INPUT-ADJ-QTY             03280700
032808     END-IF.                                                      03280800
032809                                                                  03280900
032810     MOVE ZEROS                   TO  OF010-STAT-CDE-DS           03281000
032811                                      OF010-STAT-CDE-SU           03281100
032812                                      OF010-UPC-NBR.              03281200
032813                                                                  03281300
032814     MOVE 'SE'                     TO OF010-TRN-CLSN-CDE.         03281400
032815                                                                  03281500
032816* WR41071 CT END                                                  03281600
032817                                                                  03281700
032818***************************************************************** 03281800
032819* XLKUT DOMAIN PGM IS CALLED                                      03281900
032820***************************************************************** 03282000
032830 6100-CALL-XLKUT-DOMAIN-PGM.                                      03283000
032840                                                                  03284000
032850     IF PS-SHOW-PARAGRAPH                                         03285000
032860        DISPLAY '6100-CALL-XLKUT-DOMAIN-PGM'                      03286000
032870     END-IF.                                                      03287000
032880                                                                  03288000
032890     INITIALIZE XL001-ITEM-COMMAREA.                              03289000
032900                                                                  03290000
033000     MOVE SE-SKU-NBR  TO XL001-KEY-SKU.                           03300000
033100                                                                  03310000
033200     SET  XL001-BY-NUMERIC-SKU                                    03320000
033300          XL001-SELECT-SKU     TO TRUE.                           03330000
033400                                                                  03340000
033500     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                03350000
033600                                                                  03360000
033700     MOVE XL001-SKU-SQLCODE    TO SQLCODE.                        03370000
033800                                                                  03380000
033900     EVALUATE TRUE                                                03390000
034000       WHEN XL001-SKU-SQLCODE = +0                                03400000
034100            MOVE XL001-INTR-UPC-ID    TO PC010-INTR-UPC-ID        03410000
034200       WHEN XL001-SKU-SQLCODE = +100                              03420000
034300            DISPLAY 'SKU NOT FOUND --> ' XL001-KEY-SKU            03430000
034400            MOVE ZEROS                TO PC010-INTR-UPC-ID        03440000
034500       WHEN OTHER                                                 03450000
034600              DISPLAY 'XL001-SKU-SQLCODE ----> '                  03460000
034700                       XL001-SKU-SQLCODE                          03470000
034800                      ' - '                                       03480000
034900                       XL001-KEY-SKU                              03490000
035000              MOVE XL001-SKU-SQLCODE      TO PV-SQLCODE           03500000
035100              MOVE '6100-CALL-XLKUT-DOMAIN-PGM'                   03510000
035200                                TO PV-ABEND-PARAGRAPH             03520000
035300              MOVE 'BAD RETURN FROM XLKUT001'                     03530000
035400                            TO PV-ABEND-OPERATION                 03540000
035500              PERFORM Z999-SQL-ABEND                              03550000
035600     END-EVALUATE.                                                03560000
035700                                                                  03570000
035800***************************************************************** 03580000
035900* THIS WILL BE USED WHEN THE INPUT RECORD IS ASSOCIATED TO A      03590000
036000* POST VERIFY ADJUST.  THIS SQL WILL GET THE TIMESTAMP OF WHEN    03600000
036100* THE ADJUSTMENT TOOK PLACE - THIS TIMESTAMP WILL BE MOVED TO     03610000
036200* THE OUTPUT FILE.                                                03620000
036300***************************************************************** 03630000
036400 6200-GET-ADJUST-TIMESTAMP.                                       03640000
036500                                                                  03650000
036600     IF PS-SHOW-PARAGRAPH                                         03660000
036610        DISPLAY '6200-GET-ADJUST-TIMESTAMP'                       03661000
036620     END-IF.                                                      03662000
036630                                                                  03663000
036640     EXEC SQL                                                     03664000
036650         SELECT MAX(UPD_TMST)                                     03665000
036660           INTO :AURECD-UPD-TMST                                  03666000
036670           FROM TAURECD                                           03667000
036680          WHERE ORD_NBR     = :DK-ORD-NBR                         03668000
036690            AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                     03669000
036700            AND ORD_LNE_NBR = :DK-ORD-LNE-NBR                     03670000
036701            AND STR_NBR     = :DK-LOC-NBR                         03670100
036702            AND NOTIF_NBR   = :DK-NOTIF-NBR                       03670200
036703            AND ADJ_CYC_NBR = :DK-ADJ-CYC-NBR                     03670300
036704       END-EXEC.                                                  03670400
036705                                                                  03670500
036706     EVALUATE TRUE                                                03670600
036707         WHEN SQLCODE = ZERO                                      03670700
036708         WHEN SQLCODE = -811                                      03670800
036709              ADD +1 TO PV-INPUT-ADJ-MATCH-QTY                    03670900
036710         WHEN SQLCODE = +100                                      03671000
036720         WHEN SQLCODE = -305                                      03672000
036730              ADD +1 TO PV-INPUT-ADJ-NO-MATCH-QTY                 03673000
036731              EXEC SQL                                            03673211
036732                   SET :AURECD-UPD-TMST =                         03673311
036733                       CURRENT TIMESTAMP - 12 HOURS               03673411
036734              END-EXEC                                            03673511
036735         WHEN SQLCODE = -904                                      03673700
036736         WHEN SQLCODE = -911                                      03673800
036737         WHEN SQLCODE = -913                                      03673900
036738              MOVE SQLCODE TO PV-SQLCODE                          03674000
036739              MOVE '6200-GET-ADJUST-TIMESTAMP'                    03674100
036740                                TO PV-ABEND-PARAGRAPH             03674200
036741              MOVE 'CONTENTION PROBLEM'                           03674300
036742                            TO PV-ABEND-OPERATION                 03674400
036743              PERFORM Z999-SQL-ABEND                              03674500
036744         WHEN SQLWARN0 NOT = SPACES                               03674600
036745         WHEN SQLCODE < +0                                        03674700
036746         WHEN SQLCODE > +0                                        03674800
036747              MOVE SQLCODE TO PV-SQLCODE                          03674900
036748              MOVE '6200-GET-ADJUST-TIMESTAMP'                    03675000
036749                                TO PV-ABEND-PARAGRAPH             03675100
036750              MOVE 'SQL ERROR PROBLEM'                            03675200
036751                            TO PV-ABEND-OPERATION                 03675300
036752              PERFORM Z999-SQL-ABEND                              03675400
036753      END-EVALUATE.                                               03675500
036754***************************************************************** 03675600
036755 9100-READ-INPUT-FILE.                                            03675700
036756***************************************************************** 03675800
036757                                                                  03675900
036758     READ STOREEXT-FILE INTO STORE-EXTRACT-LINE                   03676000
036759        AT END                                                    03676100
036760           SET PS-EOF-STOREEXT-FILE  TO TRUE                      03676200
036770        NOT AT END                                                03677000
036780            ADD  +1                    TO PV-RECORDS-READ-QTY     03678000
036790     END-READ.                                                    03679000
036800                                                                  03680000
036900***************************************************************** 03690000
037000 9600-WRITE-PCRD010-RECORD.                                       03700000
037100                                                                  03710000
037200     MOVE '9600-WRITE-PCRD010-RECORD' TO PV-ABEND-PARAGRAPH.      03720000
037300                                                                  03730000
037400     PERFORM 6000-BUILD-PCRD010-OUTPUT.                           03740016
037500     WRITE STR-EXPECT-RECORD FROM PC010-PCT-INTRANSIT-REC.        03750016
037600     ADD 1 TO PV-PCRD010-OUT.                                     03760016
037700                                                                  03770000
037800* WR41071 CT START                                                03780000
037900***************************************************************** 03790000
038000 9650-WRITE-OFRD010-RECORD.                                       03800000
038100                                                                  03810000
038200     MOVE '9650-WRITE-OFRD010-RECORD' TO PV-ABEND-PARAGRAPH.      03820000
038300                                                                  03830000
038400     PERFORM 6050-BUILD-OFRD010-OUTPUT.                           03840016
038500     WRITE RDC-EXPECT-RECORD FROM OF010-PCT-INTRANSIT-REC.        03850016
038600     ADD 1 TO PV-OFRD010-OUT.                                     03860000
038610                                                                  03861000
038620* WR41071 CT END                                                  03862000
038630***************************************************************** 03863000
038640 9900-EOJ-ROUTINE.                                                03864000
038650***************************************************************** 03865000
038660                                                                  03866000
038670* WR41071 CT START                                                03867000
038680     CLOSE STOREEXT-FILE                                          03868000
038690           RDC-EXPECT-FILE                                        03869000
038700           STR-EXPECT-FILE.                                       03870000
038800* WR41071 CT END                                                  03880000
038900                                                                  03890000
039000     DISPLAY ' '.                                                 03900000
039100     MOVE PV-RECORDS-READ-QTY TO PV-DISPLAY-COUNT.                03910000
039200     DISPLAY 'NUMBER STOREEXT FILE IN -------> '                  03920000
039300              PV-DISPLAY-COUNT                                    03930000
039400             ' - INP01'.                                          03940000
039500     MOVE PV-INPUT-RCVG-QTY   TO PV-DISPLAY-COUNT.                03950000
039600     DISPLAY 'NUMBER RECEIPT RECORDS IN -----> '                  03960000
039700              PV-DISPLAY-COUNT                                    03970000
039800             ' - INP01'.                                          03980000
039810     MOVE PV-INPUT-ADJ-QTY    TO PV-DISPLAY-COUNT.                03981000
039820     DISPLAY 'NUMBER RECEIPT ADJUSTMENTS IN -> '                  03982000
039830              PV-DISPLAY-COUNT                                    03983000
039840             ' - INP01'.                                          03984000
039850     MOVE PV-INPUT-ADJ-MATCH-QTY                                  03985000
039860                              TO PV-DISPLAY-COUNT.                03986000
039870     DISPLAY 'NUMBER AJDUSTMENTS MATCHED IN -> '                  03987000
039880              PV-DISPLAY-COUNT                                    03988000
039890             ' - INP01'.                                          03989000
039891     MOVE PV-INPUT-ADJ-NO-MATCH-QTY                               03989100
039892                              TO PV-DISPLAY-COUNT.                03989200
039893     DISPLAY 'NUMBER AJDUSTMENTS NO MATCH IN > '                  03989300
039894              PV-DISPLAY-COUNT                                    03989400
039895             ' - INP01'.                                          03989500
039896     MOVE PV-SQL-CHECK-DONE   TO PV-DISPLAY-COUNT.                03989600
039897     DISPLAY 'NUMBER RECORDS SQL DONE -------> '                  03989700
039898              PV-DISPLAY-COUNT                                    03989800
039899             ' - INP01'.                                          03989900
039900     MOVE PV-SQL-CHECK-BYPASSED TO PV-DISPLAY-COUNT.              03990000
040000     DISPLAY 'NUMBER RECORDS SQL BYPASSED ---> '                  04000000
040100              PV-DISPLAY-COUNT                                    04010000
040200             ' - INP01'.                                          04020000
040300     DISPLAY ' '.                                                 04030000
040400     MOVE PV-PCRD010-OUT        TO PV-DISPLAY-COUNT.              04040000
040500     DISPLAY 'NUMBER PCRD010 FILE OUT -------> '                  04050000
040600              PV-DISPLAY-COUNT                                    04060000
040700             ' - OUT01 DD'.                                       04070000
040800* WR41071 CT START                                                04080000
040900     MOVE PV-OFRD010-OUT        TO PV-DISPLAY-COUNT.              04090000
041000     DISPLAY 'NUMBER OFRD010 FILE OUT -------> '                  04100000
041100              PV-DISPLAY-COUNT                                    04110000
041200             ' - OUT02 DD'.                                       04120000
041300* WR41071 CT END                                                  04130000
041400     MOVE PV-INPUT-BYPASSED     TO PV-DISPLAY-COUNT.              04140000
041500     DISPLAY 'NUMBER STOREEXT INPUT BYPASSED > '                  04150000
041600              PV-DISPLAY-COUNT.                                   04160000
041700     MOVE PV-INPUT-BYPASSED-ZERO TO PV-DISPLAY-COUNT.             04170000
041710     DISPLAY 'NUMBER STOREEXT INPUT BYPASS 0 > '                  04171000
041720              PV-DISPLAY-COUNT.                                   04172000
041730                                                                  04173000
041740     DISPLAY ' '.                                                 04174000
041750     DISPLAY '******************'.                                04175000
041760     DISPLAY '*  END RCKUT111  *'.                                04176000
041770     DISPLAY '******************'.                                04177000
041780                                                                  04178000
041790***************************************************************** 04179000
041800 Z999-SQL-ABEND.                                                  04180000
041900***************************************************************** 04190000
042000                                                                  04200000
042100     DISPLAY '*** DB2 ERROR '.                                    04210000
042200     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       04220000
042300     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 04230000
042400     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               04240000
042500     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               04250000
042600                                                                  04260000
042700     COPY DPPD004.                                                04270000
042800                                                                  04280000
042900                                                                  04290000
043000     MOVE +4013                  TO PV-ABEND-CODE.                04300000
043100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         04310000
043200***************************************************************** 04320000
