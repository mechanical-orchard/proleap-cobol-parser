000100 IDENTIFICATION DIVISION.                                         00010085
000200 PROGRAM-ID.    PCKUT063.                                         00020086
000300 AUTHOR.        DEANNA BRANTNER                                   00030086
000400 INSTALLATION.  KOHLS.                                            00040086
000500 DATE-WRITTEN   APRIL, 2006.                                      00050086
000600 DATE-COMPILED.                                                   00060086
000700******************************************************************00070086
000800*   THIS PROGRAM READS THE E-COMMERCE RECEIPT FILE FROM WFK032E,  00080086
000900*   RETRIEVES INTR-UPC-ID AND OTHER INFORMATION AND FORMATS THE   00090086
001000*   OUTPUT INTO COPYBOOK PCRD010 FORMAT.                          00100086
000500*                                                                 00101099
000500* CHANGES:                                                        00102099
000500* 05/15/2020  JEAN KURK  REPLACE WMRD015 WITH CERD015             00103099
001100******************************************************************00110086
001200 ENVIRONMENT DIVISION.                                            00120086
001300 CONFIGURATION SECTION.                                           00130086
001400                                                                  00140086
001500 SOURCE-COMPUTER.        IBM-3090.                                00150086
001600 OBJECT-COMPUTER.        IBM-3090.                                00160086
001700                                                                  00170086
001800 INPUT-OUTPUT SECTION.                                            00180086
001900 FILE-CONTROL.                                                    00190086
002000                                                                  00200086
002100     SELECT CARTON-INPUT-FILE                                     00210086
002200         ASSIGN TO INP01.                                         00220086
002300                                                                  00230086
002400     SELECT CARTON-OUTPUT-FILE                                    00240086
002500         ASSIGN TO OUT01.                                         00250086
002600                                                                  00260086
002610     SELECT OTBND-LOC-FILE                                        00261043
002620         ASSIGN TO OUT02.                                         00262043
002630                                                                  00263043
002631* JAK 05/2007 - ADD NEW OUTPUT FILE FOR VENDOR CARTONS            00263177
002640     SELECT VENDOR-OUTPUT-FILE                                    00264077
002650         ASSIGN TO OUT03.                                         00265079
002660                                                                  00266077
002700******************************************************************00270001
002800 DATA DIVISION.                                                   00280001
002900 FILE SECTION.                                                    00290001
003000                                                                  00300001
003100 FD  CARTON-INPUT-FILE                                            00310001
003200     RECORDING MODE IS F                                          00320001
003300     LABEL RECORDS ARE STANDARD                                   00330001
003400     BLOCK CONTAINS 0 RECORDS.                                    00340001
003500                                                                  00350001
003600 01  CARTON-INPUT-RECORD     PIC  X(158).                         00360001
003700*                                                                 00370001
003800 FD  CARTON-OUTPUT-FILE                                           00380001
003900     RECORDING MODE IS F                                          00390001
004000     LABEL RECORDS ARE STANDARD                                   00400001
004100     BLOCK CONTAINS 0 RECORDS.                                    00410001
004200                                                                  00420001
004300 01  CARTON-OUTPUT-RECORD   PIC  X(100).                          00430001
004400*                                                                 00440001
004410 FD  OTBND-LOC-FILE                                               00441043
004420     RECORDING MODE IS F                                          00442043
004430     LABEL RECORDS ARE STANDARD                                   00443043
004440     BLOCK CONTAINS 0 RECORDS.                                    00444043
004450                                                                  00445043
004460 01  OTBND-LOC-RECORD   PIC  X(158).                              00446043
004470*                                                                 00447043
004480* JAK 05/2007 - ADD NEW OUTPUT FILE FOR VENDOR CARTONS            00448078
004490 FD  VENDOR-OUTPUT-FILE                                           00449078
004491     RECORDING MODE IS F                                          00449178
004492     LABEL RECORDS ARE STANDARD                                   00449278
004493     BLOCK CONTAINS 0 RECORDS.                                    00449378
004494                                                                  00449478
004495 01  VENDOR-OUTPUT-RECORD   PIC  X(158).                          00449578
004496*                                                                 00449678
004500******************************************************************00450001
004600 WORKING-STORAGE SECTION.                                         00460001
004700                                                                  00470001
004800*  CARTON INPUT FILE LAYOUT                                       00480001
004900******************************************************************00490001
005000     COPY CERD015.                                                00500099
005100*                                                                 00510001
005200******************************************************************00520001
005300*  CARTON OUTPUT FILE LAYOUT                                      00530001
005400******************************************************************00540001
005500     COPY PCRD010.                                                00550001
005600*                                                                 00560001
005700******************************************************************00570009
005800*  COPY BOOK FOR INTR-UPC-ID CALLED MODULE PCKUT064               00580009
005900******************************************************************00590009
006000     COPY PCWS064.                                                00600009
006100*                                                                 00610009
006200******************************************************************00620001
006300*  COMMUNICATIONS AREA FOR DB2                                    00630001
006400******************************************************************00640001
006500     EXEC SQL                                                     00650001
006600          INCLUDE SQLCA                                           00660001
006700     END-EXEC.                                                    00670001
006800                                                                  00680001
006820     COPY SQLCA2.                                                 00682072
006830     COPY DPWS004.                                                00683072
006840                                                                  00684072
006900*   SUT_OTBND_CART TABLE                                          00690019
007000******************************************************************00700001
007100     EXEC SQL                                                     00710001
007200          INCLUDE SUT00024                                        00720001
007300     END-EXEC.                                                    00730001
007400                                                                  00740001
007500*  SUT_OTBND_VND                                                  00750019
007600******************************************************************00760019
007700     EXEC SQL                                                     00770019
007800          INCLUDE SUT00026                                        00780019
007900     END-EXEC.                                                    00790019
008000                                                                  00800019
008100*  SUT_OTBND_LOC TABLE                                            00810019
008200******************************************************************00820001
008300     EXEC SQL                                                     00830001
008400          INCLUDE SUT00027                                        00840001
008500     END-EXEC.                                                    00850001
008600                                                                  00860001
008700*  SUT_OTBND_UPC TABLE                                            00870019
008800******************************************************************00880001
008900     EXEC SQL                                                     00890001
009000          INCLUDE SUT00028                                        00900001
009100     END-EXEC.                                                    00910001
009200                                                                  00920001
009300*  XLT_DC_LOC_ASGMT TABLE                                         00930019
009400******************************************************************00940011
009500     EXEC SQL                                                     00950011
009600          INCLUDE XLT00014                                        00960011
009700     END-EXEC.                                                    00970011
009800                                                                  00980011
009900*  XLT_LOC TABLE                                                  00990019
010000******************************************************************01000011
010100     EXEC SQL                                                     01010011
010200          INCLUDE XLT00010                                        01020012
010300     END-EXEC.                                                    01030011
010400                                                                  01040011
010500* TRECEIV TABLE                                                   01050019
010600******************************************************************01060011
010700     EXEC SQL                                                     01070011
010800          INCLUDE TRECEIV                                         01080011
010900     END-EXEC.                                                    01090011
011000                                                                  01100011
011100*  TKRPRPM TABLE                                                  01110019
011200******************************************************************01120011
011300     EXEC SQL                                                     01130011
011400          INCLUDE TKRPRPM                                         01140011
011500     END-EXEC.                                                    01150011
011600                                                                  01160011
011700*  TABLE FOR PACK SLIPS                                           01170019
011800******************************************************************01180019
011900     EXEC SQL                                                     01190019
012000          INCLUDE TPKSLIP                                         01200019
012100     END-EXEC.                                                    01210019
012200                                                                  01220019
012210*  CENTRAL STOCK PULL REQUEST                                     01221099
012230******************************************************************01223099
012240     EXEC SQL                                                     01224099
012250          INCLUDE TCEPLRQ                                         01225099
012260     END-EXEC.                                                    01226099
012270                                                                  01227099
012290*  CENTRAL STOCK PULL STORE                                       01229099
012291******************************************************************01229199
012292     EXEC SQL                                                     01229299
012293          INCLUDE TCEPLST                                         01229399
012294     END-EXEC.                                                    01229499
012295                                                                  01229599
012300******************************************************************01230001
012400 01  PS-PROGRAM-SWITCHES.                                         01240001
012500     05  PS-END-OF-FILE-SW           PIC  X(01)    VALUE 'N'.     01250001
012600         88  PS-END-OF-FILE                        VALUE 'Y'.     01260001
012700         88  PS-NOT-END-OF-FILE                    VALUE 'N'.     01270001
012800     05  PS-END-OF-CSR-SW            PIC  X(01)    VALUE 'N'.     01280009
012900         88  PS-END-OF-CSR                         VALUE 'Y'.     01290009
013000         88  PS-NOT-END-OF-CSR                     VALUE 'N'.     01300009
013100     05  PS-CARTON-VALID-SW          PIC  X(01)    VALUE 'Y'.     01310003
013200         88  PS-CARTON-VALID                       VALUE 'Y'.     01320003
013300         88  PS-CARTON-VALID-NO                    VALUE 'N'.     01330003
013301     05  PS-CARTON-NUMERIC-SW        PIC  X(01)    VALUE 'Y'.     01330199
013302         88  PS-CARTON-NUMERIC                     VALUE 'Y'.     01330299
013303         88  PS-CARTON-NUMERIC-NO                  VALUE 'N'.     01330399
013304     05  PS-NON-NUMERIC-CTN-FOUND-SW PIC  X(01)    VALUE 'N'.     01330499
013305         88  PS-NON-NUMERIC-CTN-FOUND              VALUE 'Y'.     01330599
013306         88  PS-NON-NUMERIC-CTN-FOUND-NO           VALUE 'N'.     01330699
013310     05  PS-FIRST-ITEM-SW            PIC  X(01)    VALUE 'Y'.     01331043
013320         88  PS-FIRST-ITEM-YES                     VALUE 'Y'.     01332043
013330         88  PS-FIRST-ITEM-NO                      VALUE 'N'.     01333043
013340     05  PS-ERRORS-EXIST-SW          PIC  X(01)    VALUE 'N'.     01334054
013350         88  PS-ERRORS-EXIST-YES                   VALUE 'Y'.     01335054
013360         88  PS-ERRORS-EXIST-NO                    VALUE 'N'.     01336054
013370     05  PS-CARTON-SOURCE-SW         PIC  X(01)    VALUE ' '.     01337092
013380         88  PS-VENDOR-CARTON                      VALUE 'V'.     01338092
013390         88  PS-SML-CARTON                         VALUE 'S'.     01339092
013400                                                                  01340001
013500 01  PC-PROGRAM-CONSTANTS.                                        01350001
013600     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08) VALUE 'PCKUT063'. 01360001
013700                                                                  01370001
013800 01  PV-PROGRAM-VARIABLES.                                        01380001
013910     05  PV-ABEND-PARAGRAPH          PIC  X(35) VALUE SPACES.     01391071
013911     05  PV-ABEND-CODE                PIC S9(04) VALUE ZERO       01391171
013912                                                 COMP SYNC.       01391271
013920     05  PV-PARAGRAPH-NAME           PIC  X(30) VALUE SPACES.     01392071
014000     05  PV-READ-COUNTER             PIC  9(5) COMP VALUE ZEROS.  01400001
014100     05  PV-READ-COUNTER-2           PIC  9(5) COMP VALUE ZEROS.  01410045
014200     05  PV-WRITE-COUNTER            PIC  9(5) COMP VALUE ZEROS.  01420001
014201     05  PV-NONUMERIC-COUNTER        PIC  9(5) COMP VALUE ZEROS.  01420199
014202     05  PV-NONUMERIC-WRITE-COUNTER  PIC  9(5) COMP VALUE ZEROS.  01420299
014203     05  PV-VENDOR-COUNTER           PIC  9(5) COMP VALUE ZEROS.  01420399
014210     05  PV-TOTAL-ERROR-CARTONS      PIC  9(5) COMP VALUE ZEROS.  01421045
014300     05  PV-CARTON-NOT-ACTIVE        PIC  9(5) COMP VALUE ZEROS.  01430005
014400     05  PV-STORE-NOT-EXP            PIC  9(5) COMP VALUE ZEROS.  01440024
014410     05  PV-CS-STORE-NOT-EXP         PIC  9(5) COMP VALUE ZEROS.  01441099
014500     05  PV-CARTON-NOT-FOUND         PIC  9(5) COMP VALUE ZEROS.  01450005
014600     05  PV-CARTON-ALREADY-PROCESS   PIC  9(5) COMP VALUE ZEROS.  01460005
014700     05  PV-UNIT-QTY-NOT-EQUAL       PIC  9(5) COMP VALUE ZEROS.  01470047
014710     05  PV-NO-PO-RCVR-FOUND         PIC  9(5) COMP VALUE ZEROS.  01471047
014800     05  PV-MULTIPLE-UPC-NBRS        PIC  9(5) COMP VALUE ZEROS.  01480024
015000     05  PV-NO-INTR-UPC-FOUND        PIC  9(5) COMP VALUE ZEROS.  01500012
015100     05  PV-QTY-EQUAL-0              PIC  9(5) COMP VALUE ZEROS.  01510024
015200     05  PV-TOO-EARLY                PIC  9(5) COMP VALUE ZEROS.  01520008
015210     05  PV-SUB                      PIC  9(5) COMP VALUE ZEROS.  01521099
015300     05  PV-INTR-UPC-ID              PIC S9(9) COMP VALUE ZEROS.  01530001
015310     05  PV-OTBND-QTY                PIC S9(9)V     VALUE ZEROS.  01531047
015320     05  PV-INPUT-QTY                PIC S9(9)V     VALUE ZEROS.  01532047
015400     05  PV-DISPLAY-COUNT            PIC  ZZZ,ZZZ,ZZ9.            01540001
015500     05  PV-DISPLAY-COUNT2           PIC  ZZZ,ZZZ,ZZ9.            01550001
015600     05  PV-DISPLAY-SQLCODE          PIC  +999.                   01560001
015700     05  PV-DISPLAY-CARTON-ID        PIC  Z(20).                  01570005
015800     05  PV-DISPLAY-LOCATION         PIC  Z(04).                  01580023
015900     05  PV-DISPLAY-QUANTITY         PIC  Z(04).                  01590023
015910     05  PV-DISPLAY-QTY              PIC  Z(04).                  01591047
016000     05  PV-DISPLAY-UPC-NBR          PIC  Z(20).                  01600024
016010                                                                  01601091
016020     05  PV-CONTAINER.                                            01602091
016030         10  PV-CONTAINER-1-2       PIC 9(02) VALUE ZEROES.       01603091
016040         10  PV-CONTAINER-18        PIC 9(18) VALUE ZEROES.       01604091
016100                                                                  01610001
016200     05  PV-EVENT-TMST              PIC  X(26).                   01620010
016300     05  FILLER REDEFINES     PV-EVENT-TMST.                      01630010
016400         10 PV-TMST-YY              PIC  9(04).                   01640010
016500         10 PV-DASH-1               PIC  X(01).                   01650013
016600         10 PV-TMST-MM              PIC  9(02).                   01660010
016700         10 PV-DASH-2               PIC  X(01).                   01670013
016800         10 PV-TMST-DD              PIC  9(02).                   01680010
016900         10 PV-DASH-3               PIC  X(01).                   01690013
017000         10 PV-TMST-HH              PIC  9(02).                   01700010
017100         10 PV-PERIOD-1             PIC  X(01).                   01710013
017200         10 PV-TMST-MN              PIC  9(02).                   01720010
017300         10 PV-PERIOD-2             PIC  X(01).                   01730013
017400         10 PV-TMST-SS              PIC  X(09).                   01740012
017410                                                                  01741067
017500******************************************************************01750009
017600* RETRIEVE PO RCVR LINE FROM OTBND_UPC                            01760009
017700******************************************************************01770009
017800     EXEC SQL                                                     01780009
017900          DECLARE PO_RCVR_CSR CURSOR FOR                          01790009
018000          SELECT TRN_NBR                                          01800047
018100               , RCVR_SEQ_NBR                                     01810047
018200               , TRN_LNE_NBR                                      01820047
018210               , TRN_TYP_CDE                                      01821065
018300               , UPC_NBR                                          01830047
018310               , SHPD_UNT_QTY                                     01831047
018400           FROM  SUT_OTBND_UPC                                    01840009
018500          WHERE SHIPT_UNT_ID  =  :SUT00028-SHIPT-UNT-ID           01850009
018510*           AND SHPD_UNT_QTY  >  0                                01851068
018600          WITH UR                                                 01860009
018700     END-EXEC.                                                    01870009
018800                                                                  01880009
018900******************************************************************01890001
019000 PROCEDURE DIVISION.                                              01900001
019100******************************************************************01910001
019200* CONTROLS THE MAIN PROCESSING OF THE  PROGRAM.                   01920002
019300******************************************************************01930001
019400 0000-PROGRAM-MAINLINE.                                           01940001
019500                                                                  01950001
019600     DISPLAY '***** PCKUT063 STARTED *****'.                      01960001
019700                                                                  01970001
019800     PERFORM 1000-INITIALIZE.                                     01980001
019900     PERFORM 2000-PROCESS-CARTON-FILE                             01990001
020000         UNTIL PS-END-OF-FILE.                                    02000001
020100     PERFORM 9500-EOJ-ROUTINE.                                    02010002
020200                                                                  02020001
020300     STOP RUN.                                                    02030001
020400                                                                  02040001
020500******************************************************************02050001
020600*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    02060001
020700*    -- OPEN INPUT FILE                                           02070001
020800*    -- OPEN OUTPUT FILES                                         02080059
020900*    -- READ INPUT FILE                                           02090001
021000******************************************************************02100001
021100 1000-INITIALIZE.                                                 02110001
021200                                                                  02120001
021300     OPEN INPUT  CARTON-INPUT-FILE.                               02130001
021400     OPEN OUTPUT CARTON-OUTPUT-FILE                               02140043
021401                 VENDOR-OUTPUT-FILE                               02140177
021410                 OTBND-LOC-FILE.                                  02141043
021500                                                                  02150001
021600     PERFORM 9000-READ-FILE.                                      02160002
021610     SET PS-ERRORS-EXIST-NO TO TRUE.                              02161054
021700                                                                  02170001
021800******************************************************************02180001
021900*  PROCESS INPUT UNTIL END OF FILE.                               02190001
022000******************************************************************02200001
022100 2000-PROCESS-CARTON-FILE.                                        02210001
022200                                                                  02220001
022300     SET PS-CARTON-VALID  TO  TRUE.                               02230002
022400     PERFORM 3000-CHECK-OTBND-CART.                               02240002
022500     IF PS-CARTON-VALID-NO                                        02250002
022600         CONTINUE                                                 02260002
022700     ELSE                                                         02270001
022800         PERFORM 5000-CHECK-OTBND-LOC                             02280041
022900         IF PS-CARTON-VALID-NO                                    02290041
023000             CONTINUE                                             02300041
023100         ELSE                                                     02310041
023200             PERFORM 6000-GET-OTBND-UPC                           02320041
023300             IF PS-CARTON-VALID-NO                                02330041
023400                 CONTINUE                                         02340041
023500             ELSE                                                 02350041
023600                 IF SUT00028-TRN-TYP-CDE = 'CS'                   02360099
024000                     PERFORM 4100-CHECK-STORE-EXPECTED-CS         02400099
024001                 ELSE                                             02400199
024002                     PERFORM 4000-CHECK-STORE-EXPECTED            02400299
024010                 END-IF                                           02401099
024100                 IF PS-CARTON-VALID-NO                            02410070
024200                     CONTINUE                                     02420070
024300                 ELSE                                             02430070
024400                     PERFORM 8000-CALL-PCKUT064                   02440070
024500                     IF PS-CARTON-VALID-NO                        02450070
024600                         CONTINUE                                 02460070
024700                     ELSE                                         02470070
024710                         PERFORM 8100-FORMAT-OUTPUT               02471074
024800                         PERFORM 9100-WRITE-OUTPUT                02480070
024810                         PERFORM 9200-WRITE-OUTPUT                02481070
025000                     END-IF                                       02500004
025100                 END-IF                                           02510004
025200             END-IF                                               02520004
025300         END-IF                                                   02530004
025400     END-IF.                                                      02540004
025500                                                                  02550004
025600     PERFORM 9000-READ-FILE.                                      02560002
025700                                                                  02570001
025800******************************************************************02580001
025900*  CHECK TO SEE IF THIS CARTON IS ACTIVE ON OTBND-CART.           02590002
026000******************************************************************02600001
026100 3000-CHECK-OTBND-CART.                                           02610002
026200                                                                  02620001
026210     MOVE  SPACES TO  PS-CARTON-SOURCE-SW.                        02621092
026212                                                                  02621292
026213     MOVE '3000-CHECK-OTBND-CART '  TO PV-ABEND-PARAGRAPH.        02621371
026220                                                                  02622071
026221     IF  CE015-CONTAINER-ID IS NOT NUMERIC                        02622199
026222         SET PS-NON-NUMERIC-CTN-FOUND                             02622299
026223             PS-CARTON-NUMERIC-NO TO TRUE                         02622399
026224         ADD 1                    TO PV-NONUMERIC-COUNTER         02622499
026225         DISPLAY '***'                                            02622599
026226         DISPLAY 'CE015-CONTAINER-ID(B4) = ' CE015-CONTAINER-ID   02622699
026227         PERFORM 3050-REMOVE-NON-NUMERIC-CHARS                    02622799
026228         MOVE CE015-CONTAINER-ID TO SUT00024-SHIPT-UNT-ID         02622899
026229         DISPLAY 'CE015-CONTAINER-ID(AFTER) = ' CE015-CONTAINER-ID02622999
026230             '  SUT00024-SHIPT-UNT-ID = ' SUT00024-SHIPT-UNT-ID   02623099
026231     ELSE                                                         02623199
026232         SET PS-CARTON-NUMERIC   TO TRUE                          02623299
026233         MOVE CE015-CONTAINER-ID TO SUT00024-SHIPT-UNT-ID         02623399
026234     END-IF.                                                      02623499
026235                                                                  02623599
026500     EXEC SQL                                                     02650001
026600         SELECT ACTV_IND                                          02660002
026610              , DEST_LOC_NBR                                      02661099
026700           INTO :SUT00024-ACTV-IND                                02670002
026710              , :SUT00024-DEST-LOC-NBR                            02671099
026800           FROM SUT_OTBND_CART                                    02680002
026900          WHERE SHIPT_UNT_ID  =  :SUT00024-SHIPT-UNT-ID           02690005
027000     END-EXEC.                                                    02700001
027100                                                                  02710001
027200     EVALUATE TRUE                                                02720001
027300         WHEN SQLCODE = ZERO                                      02730001
027301              SET  PS-SML-CARTON  TO  TRUE                        02730192
027302                                                                  02730292
027400              IF SUT00024-ACTV-IND  = 'N'                         02740002
027500                  ADD +1  TO  PV-CARTON-NOT-ACTIVE                02750005
027510                  ADD +1  TO  PV-TOTAL-ERROR-CARTONS              02751045
027600                  SET PS-CARTON-VALID-NO                          02760054
027610                      PS-ERRORS-EXIST-YES TO TRUE                 02761054
027700                  MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID 02770099
027800                  MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION  02780099
027900                  MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY  02790099
028000                  DISPLAY 'CARTON NOT ACTIVE - '                  02800023
028100                       'CARTON-ID= '                              02810023
028200                       PV-DISPLAY-CARTON-ID                       02820023
028300                       ' LOCATION= '                              02830026
028400                       PV-DISPLAY-LOCATION                        02840023
028500                       ' QTY= '                                   02850040
028600                       PV-DISPLAY-QUANTITY                        02860023
028700              ELSE                                                02870023
028800                  SET PS-CARTON-VALID TO TRUE                     02880023
028900              END-IF                                              02890023
029000         WHEN SQLCODE = +100                                      02900023
029010* JAK 05/2007 - REPLACE EXISTING LOGIC WITH CALL TO 3100-         02901077
029100              PERFORM 3100-CHECK-ORIG-CART                        02910077
030300         WHEN SQLWARN0 NOT = SPACES                               03030001
030400         WHEN SQLCODE < ZERO                                      03040001
030500         WHEN SQLCODE > ZERO                                      03050001
030510              SET PS-ERRORS-EXIST-YES TO TRUE                     03051059
030600              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03060023
030700              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03070099
030800              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03080099
030900              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03090099
031000              DISPLAY 'OTBND CART NOT AVAILABLE - '               03100023
031100                       'CARTON-ID= '                              03110023
031200                       PV-DISPLAY-CARTON-ID                       03120023
031300                       ' LOCATION= '                              03130026
031400                       PV-DISPLAY-LOCATION                        03140023
031500                       ' QTY= '                                   03150040
031600                       PV-DISPLAY-QUANTITY                        03160023
031700                      ' SQL= ' PV-DISPLAY-SQLCODE                 03170002
031710             PERFORM 9900-SQL-ERROR                               03171071
031800     END-EVALUATE.                                                03180001
031900                                                                  03190001
031911******************************************************************03191177
031920*  REMOVE NON-NUMERIC CHARACTERS FROM THE CE015-CONTAINER-ID      03192099
031921*  FIELD, REPLACING THEM WITH ZEROS.                              03192199
031930******************************************************************03193077
031940 3050-REMOVE-NON-NUMERIC-CHARS.                                   03194099
031950                                                                  03195077
031951     MOVE '3050-REMOVE-NON-NUMERIC-CHARS'                         03195199
031952                                   TO PV-ABEND-PARAGRAPH.         03195299
031953                                                                  03195399
031954     MOVE LENGTH OF CE015-CONTAINER-ID                            03195499
031955                                   TO PV-SUB.                     03195599
031956                                                                  03195699
031957     PERFORM UNTIL PV-SUB < 1                                     03195799
031958         IF  CE015-CONTAINER-ID(PV-SUB:1) IS NOT NUMERIC          03195899
031959             MOVE '0'              TO CE015-CONTAINER-ID(PV-SUB:1)03195999
031960         END-IF                                                   03196099
031961         SUBTRACT 1              FROM PV-SUB                      03196199
031962     END-PERFORM.                                                 03196299
031963                                                                  03196399
031964* JAK 05/2007 - ADD NEW CODE - START                              03196499
031965******************************************************************03196599
031966*  CHECK TO SEE IF THIS CARTON IS ACTIVE ON OTBND-CART.           03196699
031967******************************************************************03196799
031968 3100-CHECK-ORIG-CART.                                            03196899
031969                                                                  03196999
031970     MOVE '3100-CHECK-ORIG-CART '  TO PV-ABEND-PARAGRAPH.         03197099
031971                                                                  03197199
031980***  MOVE CE015-CONTAINER-ID TO SUT00024-SHIPT-UNT-ID.            03198099
031981     MOVE CE015-CONTAINER-ID TO SUT00024-ORIG-CART-ID.            03198199
031990                                                                  03199077
031991     EXEC SQL                                                     03199177
031992         SELECT ACTV_IND                                          03199277
031993              , SHIPT_UNT_ID                                      03199377
031994              , DEST_LOC_NBR                                      03199499
031995           INTO :SUT00024-ACTV-IND                                03199599
031996              , :SUT00024-SHIPT-UNT-ID                            03199699
031997              , :SUT00024-DEST-LOC-NBR                            03199799
031998           FROM SUT_OTBND_CART                                    03199899
031999          WHERE ORIG_CART_ID  =  :SUT00024-ORIG-CART-ID           03199999
032000     END-EXEC.                                                    03200099
032001                                                                  03200199
032002     EVALUATE TRUE                                                03200299
032003         WHEN SQLCODE = ZERO                                      03200399
032004              SET  PS-VENDOR-CARTON  TO  TRUE                     03200499
032005                                                                  03200599
032006              PERFORM 3110-CHECK-OTBND-UPC                        03200699
032007              MOVE ZEROES                TO PV-CONTAINER-1-2      03200799
032008              MOVE SUT00024-SHIPT-UNT-ID TO PV-CONTAINER-18       03200899
032009              MOVE PV-CONTAINER          TO CE015-CONTAINER-ID    03200999
032021         WHEN SQLCODE = +100                                      03202177
032026              MOVE ZEROES  TO  SUT00024-DEST-LOC-NBR              03202699
032027              PERFORM 9300-WRITE-VENDOR                           03202799
032028         WHEN SQLCODE = -811                                      03202899
032029              PERFORM 3105-CHECK-ORIG-CART-ACTIVE                 03202999
032037         WHEN SQLWARN0 NOT = SPACES                               03203777
032038         WHEN SQLCODE < ZERO                                      03203877
032039         WHEN SQLCODE > ZERO                                      03203977
032040              SET PS-ERRORS-EXIST-YES TO TRUE                     03204077
032041              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03204177
032042              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03204299
032043              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03204399
032044              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03204499
032045              DISPLAY 'OTBND CART NOT AVAILABLE - '               03204577
032046                       'CARTON-ID= '                              03204677
032047                       PV-DISPLAY-CARTON-ID                       03204777
032048                       ' LOCATION= '                              03204877
032049                       PV-DISPLAY-LOCATION                        03204977
032050                       ' QTY= '                                   03205077
032051                       PV-DISPLAY-QUANTITY                        03205177
032052                      ' SQL= ' PV-DISPLAY-SQLCODE                 03205277
032053             PERFORM 9900-SQL-ERROR                               03205377
032054     END-EVALUATE.                                                03205477
032055                                                                  03205577
032056******************************************************************03205697
032057*  CHECK TO SEE IF THIS CARTON IS ACTIVE ON OTBND-CART.           03205797
032058******************************************************************03205897
032059 3105-CHECK-ORIG-CART-ACTIVE.                                     03205997
032060                                                                  03206097
032061     MOVE '3105-CHECK-ORIG-CART-ACTIVE '  TO PV-ABEND-PARAGRAPH.  03206197
032062                                                                  03206297
032063***  MOVE CE015-CONTAINER-ID TO SUT00024-SHIPT-UNT-ID.            03206399
032064     MOVE CE015-CONTAINER-ID TO SUT00024-ORIG-CART-ID.            03206499
032065                                                                  03206597
032066     EXEC SQL                                                     03206697
032067         SELECT ACTV_IND                                          03206797
032068              , SHIPT_UNT_ID                                      03206897
032069           INTO :SUT00024-ACTV-IND                                03206997
032070              , :SUT00024-SHIPT-UNT-ID                            03207097
032071           FROM SUT_OTBND_CART                                    03207197
032072          WHERE ORIG_CART_ID  =  :SUT00024-ORIG-CART-ID           03207297
032073            AND ACTV_IND      =  'Y'                              03207397
032074     END-EXEC.                                                    03207497
032075                                                                  03207597
032076     EVALUATE TRUE                                                03207697
032077         WHEN SQLCODE = ZERO                                      03207797
032078              SET  PS-VENDOR-CARTON  TO  TRUE                     03207897
032079                                                                  03207997
032080              PERFORM 3110-CHECK-OTBND-UPC                        03208097
032081              MOVE ZEROES                TO PV-CONTAINER-1-2      03208197
032082              MOVE SUT00024-SHIPT-UNT-ID TO PV-CONTAINER-18       03208297
032083              MOVE PV-CONTAINER          TO CE015-CONTAINER-ID    03208399
032084         WHEN SQLCODE = +100                                      03208497
032085              PERFORM 9300-WRITE-VENDOR                           03208597
032086         WHEN SQLCODE = -811                                      03208699
032087              PERFORM 3107-CHECK-ORIG-CART-W-DEST                 03208799
032088         WHEN SQLWARN0 NOT = SPACES                               03208897
032089         WHEN SQLCODE < ZERO                                      03208997
032090         WHEN SQLCODE > ZERO                                      03209097
032091              SET PS-ERRORS-EXIST-YES TO TRUE                     03209197
032092              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03209297
032093              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03209399
032094              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03209499
032095              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03209599
032096              DISPLAY 'OTBND CART NOT AVAILABLE - '               03209697
032097                       'CARTON-ID= '                              03209797
032098                       PV-DISPLAY-CARTON-ID                       03209897
032099                       ' LOCATION= '                              03209997
032100                       PV-DISPLAY-LOCATION                        03210097
032101                       ' QTY= '                                   03210197
032102                       PV-DISPLAY-QUANTITY                        03210297
032103                      ' SQL= ' PV-DISPLAY-SQLCODE                 03210397
032104             PERFORM 9900-SQL-ERROR                               03210497
032105     END-EVALUATE.                                                03210597
032106                                                                  03210697
032107******************************************************************03210799
032108*  CHECK TO SEE IF THIS CARTON IS ACTIVE ON OTBND-CART.           03210899
032109*  INCLUDE CARTON DESTINATION IN SQL                              03210999
032110******************************************************************03211099
032111 3107-CHECK-ORIG-CART-W-DEST.                                     03211199
032113                                                                  03211399
032114     MOVE '3107-CHECK-ORIG-CART-W-DEST '  TO PV-ABEND-PARAGRAPH.  03211499
032115                                                                  03211599
032117     MOVE CE015-CONTAINER-ID TO SUT00024-ORIG-CART-ID.            03211799
032118     MOVE CE015-LOCATION     TO SUT00024-DEST-LOC-NBR.            03211899
032119                                                                  03211999
032120     EXEC SQL                                                     03212099
032121         SELECT ACTV_IND                                          03212199
032122              , SHIPT_UNT_ID                                      03212299
032123           INTO :SUT00024-ACTV-IND                                03212399
032124              , :SUT00024-SHIPT-UNT-ID                            03212499
032125           FROM SUT_OTBND_CART                                    03212599
032126          WHERE ORIG_CART_ID  =  :SUT00024-ORIG-CART-ID           03212699
032127            AND ACTV_IND      =  'Y'                              03212799
032128            AND DEST_LOC_NBR  =  :SUT00024-DEST-LOC-NBR           03212899
032129     END-EXEC.                                                    03212999
032130                                                                  03213099
032131     EVALUATE TRUE                                                03213199
032132         WHEN SQLCODE = ZERO                                      03213299
032133              SET  PS-VENDOR-CARTON  TO  TRUE                     03213399
032134                                                                  03213499
032135              PERFORM 3110-CHECK-OTBND-UPC                        03213599
032136              MOVE ZEROES                TO PV-CONTAINER-1-2      03213699
032137              MOVE SUT00024-SHIPT-UNT-ID TO PV-CONTAINER-18       03213799
032138              MOVE PV-CONTAINER          TO CE015-CONTAINER-ID    03213899
032139         WHEN SQLCODE = +100                                      03213999
032140              PERFORM 9300-WRITE-VENDOR                           03214099
032141         WHEN SQLCODE = -811                                      03214199
032142              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03214299
032143              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03214399
032144              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03214499
032145              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03214599
032146              DISPLAY 'DUP OTBND CART FOUND     - '               03214699
032147                       'CARTON-ID= '                              03214799
032148                       PV-DISPLAY-CARTON-ID                       03214899
032149                       ' LOCATION= '                              03214999
032150                       PV-DISPLAY-LOCATION                        03215099
032151                       ' QTY= '                                   03215199
032152                       PV-DISPLAY-QUANTITY                        03215299
032153                      ' SQL= ' PV-DISPLAY-SQLCODE                 03215399
032154              PERFORM 9300-WRITE-VENDOR                           03215499
032155         WHEN SQLWARN0 NOT = SPACES                               03215599
032156         WHEN SQLCODE < ZERO                                      03215699
032157         WHEN SQLCODE > ZERO                                      03215799
032158              SET PS-ERRORS-EXIST-YES TO TRUE                     03215899
032159              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03215999
032160              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03216099
032161              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03216199
032162              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03216299
032163              DISPLAY 'OTBND CART NOT AVAILABLE - '               03216399
032164                       'CARTON-ID= '                              03216499
032165                       PV-DISPLAY-CARTON-ID                       03216599
032166                       ' LOCATION= '                              03216699
032167                       PV-DISPLAY-LOCATION                        03216799
032168                       ' QTY= '                                   03216899
032169                       PV-DISPLAY-QUANTITY                        03216999
032170                      ' SQL= ' PV-DISPLAY-SQLCODE                 03217099
032171             PERFORM 9900-SQL-ERROR                               03217199
032172     END-EVALUATE.                                                03217299
032173                                                                  03217399
032174******************************************************************03217499
032175*  CHECK TO SEE IF THIS CARTON IS ACTIVE ON OTBND-CART.           03217599
032176******************************************************************03217699
032177 3110-CHECK-OTBND-UPC.                                            03217799
032178                                                                  03217899
032179     MOVE '3110-CHECK-OTBND-UPC '  TO PV-ABEND-PARAGRAPH.         03217999
032180                                                                  03218099
032181     MOVE SUT00024-SHIPT-UNT-ID TO SUT00028-SHIPT-UNT-ID.         03218199
032182                                                                  03218299
032183     EXEC SQL                                                     03218399
032184         SELECT TRN_NBR                                           03218499
032185           INTO :SUT00028-TRN-NBR                                 03218599
032186           FROM SUT_OTBND_UPC                                     03218699
032187          WHERE SHIPT_UNT_ID  =  :SUT00028-SHIPT-UNT-ID           03218799
032188            AND (TRN_LNE_NBR   =  0  OR                           03218899
032189                 RCVR_SEQ_NBR  =  0)                              03218999
032190     END-EXEC.                                                    03219099
032191                                                                  03219199
032192     EVALUATE TRUE                                                03219299
032193         WHEN SQLCODE = ZERO                                      03219399
032194         WHEN SQLCODE = -811                                      03219499
032195              PERFORM 9300-WRITE-VENDOR                           03219599
032196         WHEN SQLCODE = +100                                      03219699
032197              MOVE ZEROES                TO PV-CONTAINER-1-2      03219799
032198              MOVE SUT00024-SHIPT-UNT-ID TO PV-CONTAINER-18       03219899
032199              MOVE PV-CONTAINER          TO CE015-CONTAINER-ID    03219999
032200         WHEN SQLWARN0 NOT = SPACES                               03220099
032201         WHEN SQLCODE < ZERO                                      03220199
032202         WHEN SQLCODE > ZERO                                      03220299
032203              SET PS-ERRORS-EXIST-YES TO TRUE                     03220399
032204              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03220499
032205              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03220599
032206              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03220699
032207              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03220799
032208              DISPLAY 'OTBND CART NOT AVAILABLE - '               03220899
032209                       'CARTON-ID= '                              03220999
032210                       PV-DISPLAY-CARTON-ID                       03221099
032211                       ' LOCATION= '                              03221199
032212                       PV-DISPLAY-LOCATION                        03221299
032213                       ' QTY= '                                   03221399
032214                       PV-DISPLAY-QUANTITY                        03221499
032215                      ' SQL= ' PV-DISPLAY-SQLCODE                 03221599
032216             PERFORM 9900-SQL-ERROR                               03221699
032217     END-EVALUATE.                                                03221799
032218* JAK 05/2007 - ADD NEW CODE - END                                03221899
032219                                                                  03221999
032220******************************************************************03222099
032221* CHECK TO SEE IF THE DC ASSOCIATED TO THE RECEIVING STORE        03222199
032230* IS SET FOR UPDATE OF STORE EXPECTED.                            03223002
032300******************************************************************03230002
032400 4000-CHECK-STORE-EXPECTED.                                       03240002
032410     MOVE '4000-CHECK-STORE-EXPECTED'  TO PV-ABEND-PARAGRAPH.     03241071
032420                                                                  03242071
032500     MOVE CE015-LOCATION  TO XLT00014-LOC-NBR.                    03250099
032600                                                                  03260002
032700     EXEC SQL                                                     03270002
032800         SELECT A.DC_NBR                                          03280002
032900           INTO :XLT00014-DC-NBR                                  03290002
033000         FROM XLT_DC_LOC_ASGMT   A                                03300002
033100            , TKRPRPM   B                                         03310002
033200            , XLT_LOC   C                                         03320002
033300            , TRECEIV   D                                         03330041
033400         WHERE D.ORD_NBR          = :SUT00028-TRN-NBR             03340041
033500           AND D.REC_SEQ_NBR      = :SUT00028-RCVR-SEQ-NBR        03350041
033600           AND A.LOC_NBR          = :XLT00014-LOC-NBR             03360041
033700           AND A.EFF_BEG_DTE      =                               03370002
033800                (SELECT MAX(EFF_BEG_DTE)                          03380002
033900                   FROM XLT_DC_LOC_ASGMT Z                        03390002
034000                  WHERE Z.LOC_NBR = A.LOC_NBR                     03400002
034100                    AND EFF_BEG_DTE <= CURRENT DATE)              03410002
034200           AND B.LOC_ID           = A.DC_NBR                      03420002
034300           AND B.INTFC_SYS_CDE    = 'KHL'                         03430002
034400           AND B.SYS_PRC_FUNC_CDE = 'STREXP'                      03440002
034500           AND D.CRE_TMST        >=  B.FUNC_BEG_TMST              03450067
034510           AND NOT D.REC_TYP_CDE  IN ('AP', 'CD')                 03451061
034600           AND C.LOC_NBR           = A.LOC_NBR                    03460002
034700           AND C.LOC_TYP_CDE       = 'DS'                         03470002
034800       END-EXEC.                                                  03480002
034900                                                                  03490002
035000     EVALUATE TRUE                                                03500002
035100         WHEN SQLCODE = ZERO                                      03510002
035200              SET PS-CARTON-VALID TO TRUE                         03520002
035300         WHEN SQLCODE = +100                                      03530002
035400              ADD +1  TO  PV-STORE-NOT-EXP                        03540024
035410              ADD +1  TO  PV-TOTAL-ERROR-CARTONS                  03541045
035500              SET PS-CARTON-VALID-NO                              03550054
035510                  PS-ERRORS-EXIST-YES TO TRUE                     03551054
035600              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03560099
035700              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03570099
035800              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03580099
035900              DISPLAY 'STORE EXPECTED NOT ON FOR - '              03590023
036000                       'CARTON-ID= '                              03600023
036100                       PV-DISPLAY-CARTON-ID                       03610023
036200                       ' LOCATION= '                              03620026
036300                       PV-DISPLAY-LOCATION                        03630023
036400                       ' QTY= '                                   03640040
036500                       PV-DISPLAY-QUANTITY                        03650023
036600         WHEN SQLWARN0 NOT = SPACES                               03660002
036700         WHEN SQLCODE < ZERO                                      03670002
036800         WHEN SQLCODE > ZERO                                      03680002
036810              SET PS-ERRORS-EXIST-YES TO TRUE                     03681059
036900              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03690023
037000              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03700099
037100              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03710099
037200              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03720099
037300              DISPLAY 'CHECK FOR STORE EXPECTED FAILED - '        03730023
037400                       'CARTON-ID= '                              03740023
037500                       PV-DISPLAY-CARTON-ID                       03750023
037600                       ' LOCATION= '                              03760026
037700                       PV-DISPLAY-LOCATION                        03770023
037800                       ' QTY= '                                   03780040
037900                       PV-DISPLAY-QUANTITY                        03790023
037910             PERFORM 9900-SQL-ERROR                               03791071
038000     END-EVALUATE.                                                03800002
038100                                                                  03810002
038110******************************************************************03811099
038120* CHECK TO SEE IF THE DC ASSOCIATED TO THE CENTRAL STOCK LOCATION 03812099
038130* IS SET FOR UPDATE OF STORE EXPECTED.                            03813099
038140******************************************************************03814099
038150 4100-CHECK-STORE-EXPECTED-CS.                                    03815099
038160     MOVE '4100-CHECK-STORE-EXPECTED-CS' TO PV-ABEND-PARAGRAPH.   03816099
038170                                                                  03817099
038180     MOVE CE015-LOCATION  TO XLT00014-LOC-NBR.                    03818099
038190                                                                  03819099
038191     EXEC SQL                                                     03819199
038214         SELECT C.DC_NBR                                          03821499
038215           INTO :XLT00014-DC-NBR                                  03821599
038218         FROM TCEPLRQ   A                                         03821899
038219            , TCEPLST   B                                         03821999
038220            , XLT_DC_LOC_ASGMT   C                                03822099
038221            , TKRPRPM   D                                         03822199
038222            , TKRPRPM   E                                         03822299
038223            , XLT_LOC   F                                         03822399
038224         WHERE A.CNSTK_REQ_PL_NBR = :SUT00028-TRN-NBR             03822499
038225           AND B.CNSTK_REQ_PL_NBR = A.CNSTK_REQ_PL_NBR            03822599
038226           AND B.STAT_CDE         = 'NW'                          03822699
038227           AND B.PL_LNE_NBR       = 0                             03822799
038228           AND C.LOC_NBR          = :XLT00014-LOC-NBR             03822899
038229           AND C.EFF_BEG_DTE      =                               03822999
038230                (SELECT MAX(EFF_BEG_DTE)                          03823099
038231                   FROM XLT_DC_LOC_ASGMT Z                        03823199
038232                  WHERE Z.LOC_NBR = C.LOC_NBR                     03823299
038233                    AND EFF_BEG_DTE <= CURRENT DATE)              03823399
038234           AND D.LOC_ID           = C.DC_NBR                      03823499
038235           AND D.INTFC_SYS_CDE    = 'KHL'                         03823599
038236           AND D.SYS_PRC_FUNC_CDE = 'STREXP'                      03823699
038237           AND B.CRE_TMST        >= D.FUNC_BEG_TMST               03823799
038238           AND E.LOC_ID           = A.CNSTK_LOC_ID                03823899
038239           AND E.INTFC_SYS_CDE    = 'RDM'                         03823999
038240           AND E.SYS_PRC_FUNC_CDE = 'RDMCSL'                      03824099
038241           AND E.FUNC_PRC_STAT_CDE = 'AC'                         03824199
038242           AND B.CRE_TMST        >= E.FUNC_BEG_TMST               03824299
038243           AND F.LOC_NBR          = C.LOC_NBR                     03824399
038244           AND F.LOC_TYP_CDE       =  'DS'                        03824499
038245       END-EXEC.                                                  03824599
038246                                                                  03824699
038247     EVALUATE TRUE                                                03824799
038248         WHEN SQLCODE = ZERO                                      03824899
038249              SET PS-CARTON-VALID TO TRUE                         03824999
038250         WHEN SQLCODE = +100                                      03825099
038251              ADD +1  TO  PV-CS-STORE-NOT-EXP                     03825199
038252              ADD +1  TO  PV-TOTAL-ERROR-CARTONS                  03825299
038253              SET PS-CARTON-VALID-NO                              03825399
038254                  PS-ERRORS-EXIST-YES TO TRUE                     03825499
038255              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03825599
038256              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03825699
038257              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03825799
038258              DISPLAY 'CS STORE EXPECTED NOT ON FOR - '           03825899
038259                       'CARTON-ID= '                              03825999
038260                       PV-DISPLAY-CARTON-ID                       03826099
038261                       ' LOCATION= '                              03826199
038262                       PV-DISPLAY-LOCATION                        03826299
038263                       ' QTY= '                                   03826399
038264                       PV-DISPLAY-QUANTITY                        03826499
038265         WHEN SQLWARN0 NOT = SPACES                               03826599
038266         WHEN SQLCODE < ZERO                                      03826699
038267         WHEN SQLCODE > ZERO                                      03826799
038268              SET PS-ERRORS-EXIST-YES TO TRUE                     03826899
038269              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       03826999
038270              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     03827099
038271              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      03827199
038272              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      03827299
038273              DISPLAY 'CHECK FOR CS STORE EXPECTED FAILED - '     03827399
038274                       'CARTON-ID= '                              03827499
038275                       PV-DISPLAY-CARTON-ID                       03827599
038276                       ' LOCATION= '                              03827699
038277                       PV-DISPLAY-LOCATION                        03827799
038278                       ' QTY= '                                   03827899
038279                       PV-DISPLAY-QUANTITY                        03827999
038280             PERFORM 9900-SQL-ERROR                               03828099
038281     END-EVALUATE.                                                03828199
038282                                                                  03828299
038290******************************************************************03829099
038300*  CHECK TO SEE IF THIS CARTON HAS ALREADY BEEN POSTED TO THE     03830002
038400*  IN-TRANSIT TABLES BY PERFORMING A SELECT ON OTBND-LOC WHERE    03840002
038500*  SCN_CDE = ERDM.                                                03850002
038600******************************************************************03860002
038700 5000-CHECK-OTBND-LOC.                                            03870002
038800                                                                  03880002
038810     MOVE '5000-CHECK-OTBND-LOC'  TO PV-ABEND-PARAGRAPH.          03881071
038820                                                                  03882071
038900     MOVE CE015-CONTAINER-ID TO SUT00027-SHIPT-UNT-ID.            03890099
039000                                                                  03900002
039100     EXEC SQL                                                     03910002
039200         SELECT ACTV_CDE                                          03920002
039300           INTO :SUT00027-ACTV-CDE                                03930002
039400           FROM SUT_OTBND_LOC                                     03940002
039500          WHERE SHIPT_UNT_ID  =  :SUT00027-SHIPT-UNT-ID           03950006
039600            AND SCN_CDE       =  'ERDM'                           03960002
039700     END-EXEC.                                                    03970002
039800                                                                  03980002
039900     EVALUATE TRUE                                                03990002
040000         WHEN SQLCODE = ZERO                                      04000002
040010         WHEN SQLCODE = -811                                      04001055
040100              ADD +1  TO  PV-CARTON-ALREADY-PROCESS               04010099
040110              ADD +1  TO  PV-TOTAL-ERROR-CARTONS                  04011099
040200              SET PS-CARTON-VALID-NO                              04020099
040210                  PS-ERRORS-EXIST-YES TO TRUE                     04021099
040300              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     04030099
040400              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      04040099
040500              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      04050099
040600              DISPLAY 'CARTON ALREADY PROCESSED - '               04060099
040700                       'CARTON-ID= '                              04070099
040800                       PV-DISPLAY-CARTON-ID                       04080099
040900                       ' LOCATION= '                              04090099
041000                       PV-DISPLAY-LOCATION                        04100099
041100                       ' QTY= '                                   04110099
041200                       PV-DISPLAY-QUANTITY                        04120099
041300         WHEN SQLCODE = +100                                      04130002
041400              SET PS-CARTON-VALID    TO TRUE                      04140002
041500         WHEN SQLWARN0 NOT = SPACES                               04150002
041600         WHEN SQLCODE < ZERO                                      04160002
041700         WHEN SQLCODE > ZERO                                      04170002
041710              SET PS-ERRORS-EXIST-YES TO TRUE                     04171059
041800              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       04180023
041900              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     04190099
042000              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      04200099
042100              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      04210099
042200              DISPLAY 'CHECK FOR OUTBND LOC ERDM FAILED -'        04220023
042300                       'CARTON-ID= '                              04230023
042400                       PV-DISPLAY-CARTON-ID                       04240023
042500                       ' LOCATION= '                              04250026
042600                       PV-DISPLAY-LOCATION                        04260023
042700                       ' QTY= '                                   04270040
042800                       PV-DISPLAY-QUANTITY                        04280023
042810             PERFORM 9900-SQL-ERROR                               04281071
042900     END-EVALUATE.                                                04290002
043000                                                                  04300002
043100******************************************************************04310002
043200*  GET THE PO/RCVR/LINE FROM OTBND-UPC                            04320002
043300******************************************************************04330002
043400 6000-GET-OTBND-UPC.                                              04340002
043500                                                                  04350002
043510     MOVE '6000-GET-OTBND-UPC'  TO PV-ABEND-PARAGRAPH.            04351071
043520                                                                  04352071
043600     MOVE CE015-CONTAINER-ID TO SUT00028-SHIPT-UNT-ID.            04360099
043700                                                                  04370002
043800     EXEC SQL                                                     04380002
043900         SELECT TRN_NBR                                           04390002
044000              , RCVR_SEQ_NBR                                      04400002
044100              , TRN_LNE_NBR                                       04410002
044101              , TRN_TYP_CDE                                       04410165
044110              , SHPD_UNT_QTY                                      04411047
044200           INTO :SUT00028-TRN-NBR                                 04420002
044300              , :SUT00028-RCVR-SEQ-NBR                            04430002
044400              , :SUT00028-TRN-LNE-NBR                             04440002
044401              , :SUT00028-TRN-TYP-CDE                             04440165
044410              , :SUT00028-SHPD-UNT-QTY                            04441047
044500           FROM SUT_OTBND_UPC                                     04450002
044600          WHERE SHIPT_UNT_ID  =  :SUT00028-SHIPT-UNT-ID           04460006
044610*           AND SHPD_UNT_QTY  >  0                                04461068
044700     END-EXEC.                                                    04470002
044800                                                                  04480002
044900     EVALUATE TRUE                                                04490002
045000         WHEN SQLCODE = ZERO                                      04500002
045010             IF SUT00028-SHPD-UNT-QTY = 0                         04501068
045011                 SET PS-CARTON-VALID-NO TO TRUE                   04501168
045015                 ADD +1  TO  PV-QTY-EQUAL-0                       04501568
045016                 ADD +1  TO  PV-TOTAL-ERROR-CARTONS               04501669
045017                 MOVE CE015-CONTAINER-ID   TO PV-DISPLAY-CARTON-ID04501799
045018                 MOVE CE015-LOCATION        TO PV-DISPLAY-LOCATION04501899
045020                 DISPLAY 'QUANTITY EQUALS 0 - '                   04502068
045021                       'CARTON-ID= '                              04502168
045022                       PV-DISPLAY-CARTON-ID                       04502268
045023                       ' LOCATION= '                              04502368
045024                       PV-DISPLAY-LOCATION                        04502468
045040             ELSE                                                 04504068
045100                 SET PS-CARTON-VALID TO TRUE                      04510068
045200                 MOVE SUT00028-SHPD-UNT-QTY TO PV-OTBND-QTY       04520068
045210                 MOVE CE015-UNIT-QTY        TO PV-INPUT-QTY       04521099
045300                 IF PV-OTBND-QTY  NOT = PV-INPUT-QTY              04530068
045310                     ADD +1  TO  PV-UNIT-QTY-NOT-EQUAL            04531068
045320                   MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID04532099
045330                     MOVE CE015-LOCATION    TO PV-DISPLAY-LOCATION04533099
045340                     MOVE CE015-UNIT-QTY    TO PV-DISPLAY-QUANTITY04534099
045341                     MOVE SUT00028-SHPD-UNT-QTY TO PV-DISPLAY-QTY 04534168
045350                     DISPLAY 'UNIT QTY NOT EQUAL - '              04535068
045360                           'CARTON-ID= '                          04536068
045370                           PV-DISPLAY-CARTON-ID                   04537068
045380                           ' LOCATION= '                          04538068
045390                           PV-DISPLAY-LOCATION                    04539068
045391                           ' INPUT QTY= '                         04539168
045392                           PV-DISPLAY-QUANTITY                    04539268
045393                           ' OTBND QTY= '                         04539368
045394                           PV-DISPLAY-QTY                         04539468
045395                     MOVE SUT00028-SHPD-UNT-QTY TO CE015-UNIT-QTY 04539599
045400                 END-IF                                           04540068
045410                 IF SUT00028-RCVR-SEQ-NBR = 0                     04541068
045411                     IF SUT00028-TRN-TYP-CDE NOT = 'CS'           04541199
045420                         PERFORM 6005-GOTO-PKSLIP                 04542099
045430                     END-IF                                       04543099
045431                 END-IF                                           04543199
045440             END-IF                                               04544068
045500         WHEN SQLCODE = -811                                      04550002
045700             PERFORM 6100-USE-UPC-CURSOR                          04570020
045800         WHEN SQLCODE = +100                                      04580004
045900              ADD +1  TO  PV-NO-PO-RCVR-FOUND                     04590005
045910              ADD +1  TO  PV-TOTAL-ERROR-CARTONS                  04591045
046000              SET PS-CARTON-VALID-NO                              04600054
046010                  PS-ERRORS-EXIST-YES TO TRUE                     04601054
046100              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     04610099
046200              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      04620099
046300              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      04630099
046400              DISPLAY 'NO OTBND UPC FOUND - '                     04640088
046500                       'CARTON-ID='                               04650088
046600                       PV-DISPLAY-CARTON-ID                       04660023
046700                       ' LOCATION='                               04670088
046800                       PV-DISPLAY-LOCATION                        04680023
046900                       ' QTY='                                    04690088
047000                       PV-DISPLAY-QUANTITY                        04700023
047100         WHEN SQLWARN0 NOT = SPACES                               04710002
047200         WHEN SQLCODE < ZERO                                      04720002
047300         WHEN SQLCODE > ZERO                                      04730002
047310              SET PS-ERRORS-EXIST-YES TO TRUE                     04731059
047400              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       04740023
047500              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     04750099
047600              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      04760099
047700              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      04770099
047800              DISPLAY 'OTBND UPC NOT AVAILABLE - '                04780023
047900                       'CARTON-ID= '                              04790023
048000                       PV-DISPLAY-CARTON-ID                       04800023
048100                       ' LOCATION= '                              04810026
048200                       PV-DISPLAY-LOCATION                        04820023
048300                       ' QTY= '                                   04830040
048400                       PV-DISPLAY-QUANTITY                        04840023
048410             PERFORM 9900-SQL-ERROR                               04841071
048500     END-EVALUATE.                                                04850002
048600                                                                  04860002
048700******************************************************************04870019
048800*  IF RCVR-SEQ-NBR = 0 ON OTBND-UPC THEN GO TO PKSLIP TABLE       04880019
048900******************************************************************04890019
049000 6005-GOTO-PKSLIP.                                                04900020
049010     MOVE '6005-GOTO-PKSLIP '  TO PV-ABEND-PARAGRAPH.             04901071
049020                                                                  04902071
049100     MOVE CE015-CONTAINER-ID TO SUT00026-SHIPT-UNT-ID.            04910099
049200                                                                  04920019
049300     EXEC SQL                                                     04930019
049400          SELECT  B.REC_SEQ_NBR                                   04940019
049500            INTO  :PKSLIP-REC-SEQ-NBR                             04950019
049600            FROM  SUT_OTBND_VND A                                 04960019
049700                 ,TPKSLIP B                                       04970019
049800            WHERE A.SHIPT_UNT_ID  =  :SUT00026-SHIPT-UNT-ID       04980019
049900              AND A.PO_NBR        =  :SUT00028-TRN-NBR            04990019
050000              AND A.PO_NBR        =  B.PO_NBR                     05000019
050100              AND A.PKSL_SEQ_NBR  =  B.SEQ_NBR                    05010019
050200              AND B.VER_STAT_CDE  =  'A'                          05020019
050300     END-EXEC.                                                    05030019
050500                                                                  05050019
050600     EVALUATE TRUE                                                05060019
050700         WHEN SQLCODE = ZERO                                      05070019
050800             SET PS-CARTON-VALID TO TRUE                          05080019
050900             MOVE PKSLIP-REC-SEQ-NBR  TO SUT00028-RCVR-SEQ-NBR    05090019
051000         WHEN SQLCODE = +100                                      05100019
051100              ADD +1  TO  PV-NO-PO-RCVR-FOUND                     05110019
051110              ADD +1  TO  PV-TOTAL-ERROR-CARTONS                  05111045
051200              SET PS-CARTON-VALID-NO                              05120054
051210                  PS-ERRORS-EXIST-YES TO TRUE                     05121054
051300              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     05130099
051400              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      05140099
051500              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      05150099
051600              DISPLAY 'PO/RCVR NOT FOUND  - '                     05160023
051700                       'CARTON-ID= '                              05170023
051800                       PV-DISPLAY-CARTON-ID                       05180023
051900                       ' LOCATION= '                              05190026
052000                       PV-DISPLAY-LOCATION                        05200023
052100                       ' QTY= '                                   05210040
052200                       PV-DISPLAY-QUANTITY                        05220023
052300         WHEN SQLWARN0 NOT = SPACES                               05230019
052400         WHEN SQLCODE < ZERO                                      05240019
052500         WHEN SQLCODE > ZERO                                      05250019
052510              SET PS-ERRORS-EXIST-YES TO TRUE                     05251059
052600              MOVE SQLCODE            TO PV-DISPLAY-SQLCODE       05260023
052700              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     05270099
052800              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      05280099
052900              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      05290099
053000              DISPLAY 'TPKSLIP NOT AVAILABLE - '                  05300023
053100                       'CARTON-ID= '                              05310023
053200                       PV-DISPLAY-CARTON-ID                       05320023
053300                       ' LOCATION= '                              05330026
053400                       PV-DISPLAY-LOCATION                        05340023
053500                       ' QTY= '                                   05350040
053600                       PV-DISPLAY-QUANTITY                        05360023
053610             PERFORM 9900-SQL-ERROR                               05361071
053700     END-EVALUATE.                                                05370019
053800                                                                  05380019
053900******************************************************************05390004
054000*  OPEN, FETCH, THEN CLOSE PO/RCVR CURSOR                         05400004
054100******************************************************************05410004
054200 6100-USE-UPC-CURSOR.                                             05420004
054300                                                                  05430004
054400     SET PS-NOT-END-OF-CSR                                        05440043
054410         PS-FIRST-ITEM-YES   TO TRUE.                             05441043
054500     MOVE CE015-CONTAINER-ID TO SUT00028-SHIPT-UNT-ID.            05450099
054600     PERFORM 6200-OPEN-CURSOR.                                    05460009
054700     PERFORM 6300-FETCH-CURSOR UNTIL PS-END-OF-CSR                05470009
054800     PERFORM 6400-CLOSE-CURSOR.                                   05480009
054900                                                                  05490009
055000******************************************************************05500009
055100 6200-OPEN-CURSOR.                                                05510009
055200******************************************************************05520009
055300     EXEC SQL                                                     05530009
055400         OPEN PO_RCVR_CSR                                         05540014
055500     END-EXEC                                                     05550009
055600                                                                  05560009
055700     EVALUATE TRUE                                                05570009
055800         WHEN SQLCODE = ZERO                                      05580009
055900                 CONTINUE                                         05590009
056000         WHEN OTHER                                               05600004
056100             SET PS-END-OF-CSR       TO TRUE                      05610023
056200             SET PS-CARTON-VALID-NO  TO TRUE                      05620023
056210             SET PS-ERRORS-EXIST-YES TO TRUE                      05621059
056300             MOVE SQLCODE            TO PV-DISPLAY-SQLCODE        05630023
056400             MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID      05640099
056500             MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION       05650099
056600             MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY       05660099
056700             DISPLAY 'CANT OPEN PO-RCVR-CSR - '                   05670023
056800                       'CARTON-ID= '                              05680023
056900                       PV-DISPLAY-CARTON-ID                       05690023
057000                       ' LOCATION= '                              05700026
057100                       PV-DISPLAY-LOCATION                        05710023
057200                       ' QTY= '                                   05720040
057300                       PV-DISPLAY-QUANTITY                        05730023
057310             PERFORM 9900-SQL-ERROR                               05731071
057400     END-EVALUATE.                                                05740004
057500                                                                  05750004
057600******************************************************************05760004
057700 6300-FETCH-CURSOR.                                               05770004
057800******************************************************************05780004
057900                                                                  05790004
057910     MOVE '6300-FETCH-CURSOR'  TO PV-ABEND-PARAGRAPH.             05791071
057920                                                                  05792071
058000     EXEC SQL                                                     05800004
058100         FETCH PO_RCVR_CSR                                        05810014
058200         INTO                                                     05820004
058300             :SUT00028-TRN-NBR                                    05830004
058400         ,   :SUT00028-RCVR-SEQ-NBR                               05840004
058500         ,   :SUT00028-TRN-LNE-NBR                                05850004
058510         ,   :SUT00028-TRN-TYP-CDE                                05851065
058600         ,   :SUT00028-UPC-NBR                                    05860024
058610         ,   :SUT00028-SHPD-UNT-QTY                               05861047
058700     END-EXEC                                                     05870024
058800                                                                  05880024
058900     EVALUATE TRUE                                                05890024
059000         WHEN SQLCODE = ZERO                                      05900024
059010             IF SUT00028-SHPD-UNT-QTY = 0                         05901068
059020                 SET PS-CARTON-VALID-NO TO TRUE                   05902068
059092             ELSE                                                 05909268
059570                 MOVE SUT00028-SHPD-UNT-QTY TO CE015-UNIT-QTY     05957099
059580                 IF SUT00028-TRN-TYP-CDE = 'CS'                   05958099
059591                     PERFORM 4100-CHECK-STORE-EXPECTED-CS         05959199
059592                 ELSE                                             05959299
059593                     PERFORM 4000-CHECK-STORE-EXPECTED            05959399
059594                 END-IF                                           05959499
059700                 IF PS-CARTON-VALID-NO                            05970070
059800                     CONTINUE                                     05980070
059810                 ELSE                                             05981070
059900                     PERFORM 8000-CALL-PCKUT064                   05990070
060000                     IF PS-CARTON-VALID-NO                        06000070
060100                         CONTINUE                                 06010070
060200                     ELSE                                         06020070
060300                        SET PS-CARTON-VALID    TO TRUE            06030070
060400                        MOVE CE015-CONTAINER-ID TO                06040099
060500                                              PV-DISPLAY-CARTON-ID06050038
060600                        MOVE CE015-LOCATION TO PV-DISPLAY-LOCATION06060099
060700                        MOVE SUT00028-UPC-NBR TO                  06070070
060710                                                PV-DISPLAY-UPC-NBR06071042
060720                        PERFORM 8100-FORMAT-OUTPUT                06072094
060730                        PERFORM 9100-WRITE-OUTPUT                 06073095
060740                        IF PS-FIRST-ITEM-YES                      06074095
060750                            PERFORM 9200-WRITE-OUTPUT             06075095
060760                            SET PS-FIRST-ITEM-NO TO TRUE          06076095
060770                            ADD +1                                06077095
060780                               TO  PV-MULTIPLE-UPC-NBRS           06078095
060781                        END-IF                                    06078195
060782                        IF  PS-SML-CARTON                         06078294
060783                            DISPLAY 'MULTIPLE UPCS FOUND - '      06078395
060784                                 'CARTON-ID= '                    06078495
060785                                 PV-DISPLAY-CARTON-ID             06078595
060786                                 ' LOCATION= '                    06078695
060787                                 PV-DISPLAY-LOCATION              06078795
060788                                 ' UPC NBR= '                     06078895
060789                                 PV-DISPLAY-UPC-NBR               06078995
060790                         END-IF                                   06079095
060800                     END-IF                                       06080095
060900                 END-IF                                           06090095
061700             END-IF                                               06170038
061800         WHEN SQLCODE = +100                                      06180038
061900             SET PS-CARTON-VALID-NO  TO TRUE                      06190038
062000             SET PS-END-OF-CSR       TO TRUE                      06200038
062100         WHEN SQLWARN0 NOT = SPACES                               06210038
062200         WHEN SQLCODE < ZERO                                      06220038
062300         WHEN SQLCODE > ZERO                                      06230038
062400             SET PS-END-OF-CSR       TO TRUE                      06240059
062410             SET PS-ERRORS-EXIST-YES TO TRUE                      06241059
062500             MOVE SQLCODE            TO PV-DISPLAY-SQLCODE        06250038
062600             MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID      06260099
062700             MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION       06270099
062800             MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY       06280099
062900             DISPLAY 'OTBND UPC NOT AVAILABLE - '                 06290038
063000                       'CARTON-ID= '                              06300038
063100                       PV-DISPLAY-CARTON-ID                       06310038
063200                       ' LOCATION= '                              06320038
063300                       PV-DISPLAY-LOCATION                        06330038
063400                       ' QTY= '                                   06340040
063500                       PV-DISPLAY-QUANTITY                        06350038
063510             PERFORM 9900-SQL-ERROR                               06351071
063600     END-EVALUATE.                                                06360038
063700                                                                  06370038
063800******************************************************************06380038
063900 6400-CLOSE-CURSOR.                                               06390038
064000******************************************************************06400038
064200     EXEC SQL                                                     06420038
064300         CLOSE PO_RCVR_CSR                                        06430038
064400     END-EXEC                                                     06440038
064500                                                                  06450038
064600     EVALUATE TRUE                                                06460038
064700         WHEN SQLCODE = ZERO                                      06470038
064800                 CONTINUE                                         06480038
064900         WHEN OTHER                                               06490038
065000             SET PS-CARTON-VALID-NO  TO TRUE                      06500059
065100             SET PS-END-OF-CSR       TO TRUE                      06510059
065110             SET PS-ERRORS-EXIST-YES TO TRUE                      06511059
065200             MOVE SQLCODE            TO PV-DISPLAY-SQLCODE        06520038
065300             MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID      06530099
065400             MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION       06540099
065500             MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY       06550099
065600             DISPLAY 'CANT CLOSE PO-RCVR-CSR - '                  06560038
065700                       'CARTON-ID= '                              06570038
065800                       PV-DISPLAY-CARTON-ID                       06580038
065900                       ' LOCATION= '                              06590038
066000                       PV-DISPLAY-LOCATION                        06600038
066100                       ' QTY= '                                   06610040
066200                       PV-DISPLAY-QUANTITY                        06620038
066210             PERFORM 9900-SQL-ERROR                               06621071
066300     END-EVALUATE.                                                06630038
066400                                                                  06640038
071800******************************************************************07180038
071900*  GET THE INTR-UPC-ID FROM CALLED MODULE PCKUT064                07190038
072000******************************************************************07200038
072100 8000-CALL-PCKUT064.                                              07210038
072200                                                                  07220038
072210     MOVE '8000-CALL-PCKUT064'  TO PV-ABEND-PARAGRAPH.            07221071
072220                                                                  07222071
072300     INITIALIZE PC064-COMMAREA-REC.                               07230038
072400     MOVE SUT00028-TRN-NBR      TO PC064-ORD-NBR.                 07240038
072500     MOVE SUT00028-RCVR-SEQ-NBR TO PC064-REC-SEQ-NBR.             07250038
072600     MOVE SUT00028-TRN-LNE-NBR  TO PC064-ORD-LNE-NBR.             07260038
072610     MOVE SUT00028-TRN-TYP-CDE  TO PC064-TRN-TYP-CDE.             07261065
072700     MOVE 'PCKUT063'            TO PC064-CALLING-PGM-NME.         07270038
072800                                                                  07280038
072900     CALL PC064-INTR-UPC-ID-MODULE  USING   PC064-COMMAREA-REC.   07290038
073000                                                                  07300038
073100     EVALUATE TRUE                                                07310038
073200         WHEN PC064-SUCCESSFUL                                    07320038
073800              SET PS-CARTON-VALID TO TRUE                         07380075
073900         WHEN PC064-INTR-UPC-ERROR                                07390096
074000              SET PS-CARTON-VALID-NO TO TRUE                      07400097
074100              PERFORM 9300-WRITE-VENDOR                           07410097
075000         WHEN OTHER                                               07500038
075100              ADD +1  TO  PV-NO-INTR-UPC-FOUND                    07510038
075110              ADD +1  TO  PV-TOTAL-ERROR-CARTONS                  07511045
075200              SET PS-CARTON-VALID-NO                              07520054
075201                  PS-ERRORS-EXIST-YES TO TRUE                     07520154
075300              MOVE CE015-CONTAINER-ID TO PV-DISPLAY-CARTON-ID     07530099
075400              MOVE CE015-LOCATION     TO PV-DISPLAY-LOCATION      07540099
075500              MOVE CE015-UNIT-QTY     TO PV-DISPLAY-QUANTITY      07550099
075600              DISPLAY 'INTR UPC NOT FOUND - '                     07560038
075700                       'CARTON-ID= '                              07570038
075800                       PV-DISPLAY-CARTON-ID                       07580038
075900                       ' LOCATION= '                              07590038
076000                       PV-DISPLAY-LOCATION                        07600038
076100                       ' QTY= '                                   07610040
076200                       PV-DISPLAY-QUANTITY                        07620038
076201     DISPLAY 'PC064 RET CDE=' PC064-CRA-RET-CDE                   07620184
076202     DISPLAY 'PC064 RET MGE=' PC064-CRA-RET-MSG                   07620284
076210              PERFORM 9900-SQL-ERROR                              07621071
076300     END-EVALUATE.                                                07630038
076400                                                                  07640038
076500******************************************************************07650038
076600*  FORMAT OUTPUT INTO THE PCRD010 COPYBOOK.                       07660038
076700******************************************************************07670038
076800 8100-FORMAT-OUTPUT.                                              07680038
076900     INITIALIZE PC010-PCT-INTRANSIT-REC.                          07690038
077000     MOVE PC064-INTR-UPC-ID      TO  PC010-INTR-UPC-ID.           07700038
077010*                                                                 07701099
077020* DMH - 10/2/17 BEGIN                                             07702099
077030     IF  SUT00024-DEST-LOC-NBR  >  0                              07703099
077100         MOVE SUT00024-DEST-LOC-NBR  TO  PC010-STR-NBR            07710099
077101     ELSE                                                         07710199
077102         MOVE CE015-LOCATION         TO  PC010-STR-NBR            07710299
077103     END-IF.                                                      07710399
077110* DMH - 10/2/17 END                                               07711099
077120*                                                                 07712099
077200     MOVE 'UN'                   TO  PC010-TRN-TYP-CDE.           07720038
077201     MOVE CE015-UNIT-QTY         TO  PC010-IN-TRNST-QTY.          07720199
077210     MULTIPLY  PC010-IN-TRNST-QTY  BY -1                          07721058
077220       GIVING  PC010-IN-TRNST-QTY.                                07722058
077400     MOVE 'PCKUT063'             TO  PC010-UPD-USR-ID.            07740056
077500     MOVE SUT00028-TRN-NBR       TO  PC010-PO-NBR.                07750038
077600     MOVE SUT00028-RCVR-SEQ-NBR  TO  PC010-RCVR-SEQ-NBR.          07760038
077700     MOVE 0                      TO  PC010-TRIP-ID.               07770038
077800     MOVE 'SE'                   TO  PC010-TRN-CLSN-CDE.          07780038
077900     MOVE 0                      TO  PC010-UPC-NBR.               07790038
078000     MOVE CE015-TRANS-YR         TO  PV-TMST-YY.                  07800099
078100     MOVE CE015-TRANS-MO         TO  PV-TMST-MM.                  07810099
078200     MOVE CE015-TRANS-DA         TO  PV-TMST-DD.                  07820099
078300     MOVE CE015-TRANS-HR         TO  PV-TMST-HH.                  07830099
078400     MOVE CE015-TRANS-MI         TO  PV-TMST-MN.                  07840099
078500     MOVE '00.000001'            TO  PV-TMST-SS.                  07850038
078600     MOVE '-'                    TO  PV-DASH-1.                   07860038
078700     MOVE '-'                    TO  PV-DASH-2.                   07870038
078800     MOVE '-'                    TO  PV-DASH-3.                   07880038
078900     MOVE '.'                    TO  PV-PERIOD-1.                 07890038
079000     MOVE '.'                    TO  PV-PERIOD-2.                 07900038
079100     MOVE PV-EVENT-TMST          TO  PC010-EVENT-TMST.            07910038
079200                                                                  07920038
079300******************************************************************07930038
079400*  READ INPUT FILE.                                               07940038
079500******************************************************************07950038
079600 9000-READ-FILE.                                                  07960038
079700      INITIALIZE CE015-RECEIPT-UPLOAD-RECORD.                     07970099
079800                                                                  07980001
079900      READ CARTON-INPUT-FILE INTO                                 07990001
080000          CE015-RECEIPT-UPLOAD-RECORD                             08000099
080100            AT END SET PS-END-OF-FILE TO TRUE.                    08010001
080200                                                                  08020001
080300      IF PS-END-OF-FILE                                           08030001
080400         CONTINUE                                                 08040001
080500      ELSE                                                        08050001
080600         ADD +1 TO PV-READ-COUNTER                                08060001
080700                   PV-READ-COUNTER-2                              08070001
080800         IF  PV-READ-COUNTER-2  >= 500                            08080064
080900             MOVE PV-READ-COUNTER           TO  PV-DISPLAY-COUNT  08090001
081000             DISPLAY 'RECORDS PROCESSED....: '  PV-DISPLAY-COUNT  08100001
081100             MOVE  ZEROES  TO  PV-READ-COUNTER-2                  08110001
081200         END-IF                                                   08120001
081300      END-IF.                                                     08130001
081400                                                                  08140001
081500******************************************************************08150001
081600*  WRITE OUTPUT FILE.                                             08160001
081700******************************************************************08170001
081800 9100-WRITE-OUTPUT.                                               08180002
081900                                                                  08190001
082000     WRITE CARTON-OUTPUT-RECORD FROM                              08200001
082100         PC010-PCT-INTRANSIT-REC.                                 08210001
082200                                                                  08220001
082300     ADD +1 TO PV-WRITE-COUNTER.                                  08230001
082400                                                                  08240001
082401******************************************************************08240143
082402*  WRITE OUTPUT FILE.                                             08240243
082403******************************************************************08240343
082404 9200-WRITE-OUTPUT.                                               08240443
082405                                                                  08240543
082407     WRITE OTBND-LOC-RECORD FROM                                  08240743
082408         CE015-RECEIPT-UPLOAD-RECORD.                             08240899
082410                                                                  08241043
082420* JAK 05/2007 - ADD PARAGRAPH TO WRITE TO NEW OUTPUT FILE         08242077
082421******************************************************************08242177
082430*  WRITE OUTPUT FILE.                                             08243077
082440******************************************************************08244077
082450 9300-WRITE-VENDOR.                                               08245077
082460                                                                  08246077
082470     WRITE VENDOR-OUTPUT-RECORD FROM                              08247077
082481         CE015-RECEIPT-UPLOAD-RECORD.                             08248199
082490                                                                  08249077
082491     IF PS-CARTON-NUMERIC-NO                                      08249199
082492         ADD 1 TO PV-NONUMERIC-WRITE-COUNTER                      08249299
082493         DISPLAY 'NON-NUMERIC CONTAINER WRITTEN TO RECYCLE FILE: '08249399
082494                 CE015-CONTAINER-ID                               08249499
082495     END-IF.                                                      08249599
082496                                                                  08249699
082497     SET PS-CARTON-VALID-NO TO TRUE.                              08249799
082498     ADD +1 TO PV-VENDOR-COUNTER.                                 08249899
082499                                                                  08249999
082500******************************************************************08250001
082600*  CLOSE INPUT FILE.  DISPLAY COUNTERS.                           08260001
082700******************************************************************08270001
082800 9500-EOJ-ROUTINE.                                                08280002
082900     CLOSE CARTON-INPUT-FILE                                      08290001
083000           CARTON-OUTPUT-FILE                                     08300043
083001           VENDOR-OUTPUT-FILE                                     08300177
083010           OTBND-LOC-FILE.                                        08301043
083100                                                                  08310001
083110       IF PS-ERRORS-EXIST-YES                                     08311054
083111           MOVE 4095 TO RETURN-CODE                               08311154
083112       END-IF.                                                    08311254
083120                                                                  08312054
083200     DISPLAY '      '.                                            08320033
083300                                                                  08330033
083400     MOVE PV-READ-COUNTER                  TO  PV-DISPLAY-COUNT.  08340099
083500     DISPLAY 'TOTAL RECORDS READ..........: '  PV-DISPLAY-COUNT.  08350099
083600                                                                  08360033
083910     MOVE PV-TOTAL-ERROR-CARTONS           TO  PV-DISPLAY-COUNT.  08391099
083920     DISPLAY 'TOTAL CARTONS IN ERROR......: '  PV-DISPLAY-COUNT.  08392099
083930                                                                  08393045
083931     DISPLAY '      '.                                            08393146
083932                                                                  08393246
083940     MOVE PV-WRITE-COUNTER                 TO  PV-DISPLAY-COUNT.  08394099
083950     DISPLAY 'TOTAL RECORDS WRITTEN.......: '  PV-DISPLAY-COUNT.  08395099
083951                                                                  08395185
083952     MOVE PV-VENDOR-COUNTER                TO  PV-DISPLAY-COUNT.  08395299
083953     DISPLAY 'TOT WRAP RECS WRITTEN.......: '  PV-DISPLAY-COUNT.  08395399
083960                                                                  08396046
084000     DISPLAY '      '.                                            08400039
084100                                                                  08410039
084110     DISPLAY 'POSSIBLE PROBLEMS EXIST.  PLEASE REVIEW.'.          08411060
084120                                                                  08412060
084200     MOVE PV-CARTON-NOT-FOUND              TO  PV-DISPLAY-COUNT.  08420099
084300     DISPLAY 'CARTONS NOT FOUND...........: '  PV-DISPLAY-COUNT.  08430099
084400                                                                  08440039
084500     MOVE PV-CARTON-NOT-ACTIVE             TO  PV-DISPLAY-COUNT.  08450099
084600     DISPLAY 'CARTONS NOT ACTIVE..........: '  PV-DISPLAY-COUNT.  08460099
084700                                                                  08470039
085700     MOVE PV-NO-PO-RCVR-FOUND              TO  PV-DISPLAY-COUNT.  08570099
085800     DISPLAY 'PO/RCVR NOT FOUND...........: '  PV-DISPLAY-COUNT.  08580099
085900                                                                  08590024
086600     MOVE PV-NO-INTR-UPC-FOUND             TO  PV-DISPLAY-COUNT.  08660099
086700     DISPLAY 'NO INTR UPC FOUND...........: '  PV-DISPLAY-COUNT.  08670099
086800                                                                  08680012
086900     MOVE PV-STORE-NOT-EXP                 TO  PV-DISPLAY-COUNT.  08690099
087000     DISPLAY 'STORE EXPTD NOT ON FOR DC...: '  PV-DISPLAY-COUNT.  08700099
087010                                                                  08701099
087020     MOVE PV-CS-STORE-NOT-EXP              TO  PV-DISPLAY-COUNT.  08702099
087030     DISPLAY 'CS STORE EXPTD NOT ON FOR DC: '  PV-DISPLAY-COUNT.  08703099
087100                                                                  08710060
087101     DISPLAY '      '.                                            08710145
087103                                                                  08710360
087104     DISPLAY 'INFORMATIONAL:  THESE CARTONS WERE NOT PROCESSED.'. 08710460
087105                                                                  08710560
087106     MOVE PV-CARTON-ALREADY-PROCESS        TO  PV-DISPLAY-COUNT.  08710699
087107     DISPLAY 'CARTONS ALREADY PROCESSED...: '  PV-DISPLAY-COUNT.  08710799
087108                                                                  08710845
087109     MOVE PV-TOO-EARLY                     TO  PV-DISPLAY-COUNT.  08710999
087110     DISPLAY 'CREATE DATE TOO EARLY.......: '  PV-DISPLAY-COUNT.  08711099
087111                                                                  08711160
087112     MOVE PV-QTY-EQUAL-0                   TO  PV-DISPLAY-COUNT.  08711299
087113     DISPLAY 'QUANTITY EQUAL TO 0.........: '  PV-DISPLAY-COUNT.  08711399
087114                                                                  08711460
087115     DISPLAY '      '.                                            08711560
087116                                                                  08711660
087117     DISPLAY 'INFORMATIONAL:  THESE CARTONS WERE PROCESSED.'.     08711760
087118                                                                  08711860
087119     MOVE PV-UNIT-QTY-NOT-EQUAL            TO  PV-DISPLAY-COUNT.  08711999
087120     DISPLAY 'UNIT QTY NOT EQUAL..........: '  PV-DISPLAY-COUNT.  08712099
087130                                                                  08713060
087170     MOVE PV-MULTIPLE-UPC-NBRS             TO  PV-DISPLAY-COUNT.  08717099
087180     DISPLAY 'MULTIPLE UPC NBRS FOUND.....: '  PV-DISPLAY-COUNT.  08718099
087190                                                                  08719060
087200     DISPLAY '      '.                                            08720033
087300                                                                  08730033
087301     IF  PS-NON-NUMERIC-CTN-FOUND                                 08730199
087310         DISPLAY 'INFORMATIONAL:  NON-NUMERIC CARTONS FOUND.'     08731099
087320                                                                  08732099
087330         MOVE PV-NONUMERIC-COUNTER         TO  PV-DISPLAY-COUNT   08733099
087340         DISPLAY 'NON-NUMERIC CARTONS FOUND...............: '     08734099
087341                  PV-DISPLAY-COUNT                                08734199
087350                                                                  08735099
087360         MOVE PV-NONUMERIC-WRITE-COUNTER   TO  PV-DISPLAY-COUNT   08736099
087370         DISPLAY 'NON-NUMERIC CARTONS WRITTEN TO WRAP FILE: '     08737099
087371                  PV-DISPLAY-COUNT                                08737199
087390         DISPLAY '      '                                         08739099
087391     END-IF.                                                      08739199
087392                                                                  08739299
087400     DISPLAY '*****  PCKUT063 ENDED  *****'.                      08740001
087500                                                                  08750001
087600 9900-SQL-ERROR.                                                  08760071
087700                                                                  08770071
087800     MOVE SQLCODE               TO SQLCODE2.                      08780071
087900     MOVE SQLERRD(3)            TO SQLERRD3.                      08790071
088000     DISPLAY '** ABEND **       ** = SQLERROR'.                   08800071
088100     DISPLAY '** PROGRAM        ** = PCKUT063'.                   08810071
088200     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        08820071
088300                                                                  08830071
088400     COPY DPPD004.                                                08840071
088600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08860071
